* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48******************************************************************
    49 ENVIRONMENT DIVISION.
    50
    51 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   3
* EL050.cbl
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55
    56 77  FILLER   PIC X(32) VALUE '********************************'.
    57 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    58 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    59
    60 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    61 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    62                                   USAGE POINTER.
    63 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    64 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    69                                   USAGE IS POINTER.
    70 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    72                                   USAGE IS POINTER.
    73
    74 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    76                                   USAGE IS POINTER.
    77
    78*    COPY ELC50WS.
    79*****************************************************************
    80*                                                               *
    81*                            ELC50WS.                           *
    82*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    83*                            VMOD=2.061.                        *
    84*                                                               *
    85*   THIS IS THE WORKING STORAGE FOR EL050                       *
    86*                                   EL517                       *
    87*****************************************************************
    88******************************************************************
    89*                   C H A N G E   L O G
    90*
    91* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    92*-----------------------------------------------------------------
    93*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    94* EFFECTIVE    NUMBER
    95*-----------------------------------------------------------------
    96* 123102                   PEMA  ADD DCC PROCESSING
    97* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    98* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    99* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   100* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   101* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   102* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   103* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   104* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   105* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   106* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   107* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   108* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   109* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   110* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   4
* EL050.cbl
   111* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   112* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   113* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   114* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   115* 030309  CR2009021700001  PEMA  ADD ER-2883
   116* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   117* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   118* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   119* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   120* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   121* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   122* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   123* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   124* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   126* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   127* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   128* 061412  CR2011022800001  AJRA  NAPERSOFT
   129* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   130* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   131* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   132* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   133* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   134* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   135* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   136*-----------------------------------------------------------------
   137
   138 01  WORK-AREAS.
   139
   140*****************************************************************
   141*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   142*****************************************************************
   143
   144     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   145     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   146     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   147     12  WS-NAME-EDIT-WORK-AREA.
   148         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   149         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   150             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   151         16  WS-WORK-NAME.
   152             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   153             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   154             20  FILLER           PIC X(10)     VALUE SPACES.
   155         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   156             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   157
   158*****************************************************************
   159*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   160*****************************************************************
   161
   162     12  WS-ERRESC-KEY.
   163         16 WS-ERRESC-SEARCH-KEY.
   164             20  WS-ERRESC-COMPANY-CD PIC  X.
   165             20  WS-ERRESC-CARRIER    PIC  X.
   166             20  WS-ERRESC-GROUP      PIC X(6).
   167             20  WS-ERRESC-STATE      PIC XX.
   168             20  WS-ERRESC-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   5
* EL050.cbl
   169         16 WS-ERRESC-RESIDUAL-KEY.
   170             20  WS-ERRESC-AGENT      PIC X(10).
   171             20  WS-ERRESC-RES-STATE  PIC XX.
   172             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   173*                                          YYYYMMDD
   174     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   175     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   176
   177*RESIDENT STATE TAX MASTER(ERRESS)
   178*
   179     12  WS-ERRESS-KEY.
   180         16  WS-ERRESS-COMPANY-CD      PIC  X.
   181         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   182         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   183         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   184*                                          YYYYMMDD
   185
   186     12  WS-CONTRACT-DATE              PIC 9(8).
   187*                                          YYYYMMDD
   188     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   189     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   190         16 WS-YEAR-YY                 PIC   9999.
   191         16 FILLER                     PIC 9(4).
   192*                                          YYYYMMDD
   193     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   194     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   195     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   196     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   197
   198     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   199         88  DPRB-1ST-TIME                      VALUE ' '.
   200
   201*****************************************************************
   202*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   203*****************************************************************
   204
   205     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   206     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   207     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   208     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   209     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   210     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   211     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   212     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   213     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   214     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   215         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   216         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   217     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   218         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   219         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   220     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   221
   222     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   223     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   224
   225     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   226     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   6
* EL050.cbl
   227     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   239     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   240     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   261     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   262     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   263     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   264     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   273     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   274     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   275     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   276     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   277     12  WS-2671-SW               PIC X         VALUE SPACE.
   278     12  WS-2672-SW               PIC X         VALUE SPACE.
   279     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   280         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   281     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   282         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   283     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   284
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   7
* EL050.cbl
   285     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   286         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   287         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   288         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   289         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   290
   291     12  WS-CREDIT-EDIT-CONTROLS.
   292         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   293         16  WS-MIN-AGE           PIC 99                VALUE  0.
   294         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   295         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   296         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   297         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   298
   299     12  WS-AGE-FIELDS.
   300         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   301         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   302         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   303         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   304
   305     12  WS-SAVE-ALLOWABLE-BENEFIT.
   306         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   307         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   308         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   309         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   310         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   311         16  FILLER                      PIC XX.
   312
   313     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   314     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   315     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   316     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   317     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   318     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   319     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   320     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   321     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   322     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   323
   324     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   325     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   326     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   327     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   328     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   329     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   330     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   331     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   332         88  WS-REDUCING              VALUE 'R'.
   333         88  WS-LEVEL                 VALUE 'L' 'P'.
   334     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   335
   336     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   337     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   338     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   339     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   340     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   341     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   342     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   8
* EL050.cbl
   343     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   344     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   345
   346     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   347     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   348     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   349     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   350     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   351     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   352     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   353     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   354     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   355     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   356     12  WS-ACCT-SIG-SW.
   357         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   358         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   359     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   360     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   361     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   362     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   364     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   365     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   366     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   367     12  WS-INITIALS.
   368         16  WS-INIT-1            PIC X         VALUE SPACES.
   369         16  WS-INIT-2            PIC X         VALUE SPACES.
   370
   371     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   372     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   373     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   374     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   375     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   376*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   377     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   378     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   380     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   381     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   382     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   383     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   384     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   385     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   386     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   387     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   388     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   389     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   390     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   391     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   392     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   393     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   396     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   397     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   398     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   399******** FLA
   400     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page   9
* EL050.cbl
   401     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   402     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   404     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   405********
   406     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   407     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   408     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   409     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   410     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   411     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   412     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   413     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   414     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   415     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   416
   417     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   418         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   419                                         '0' THRU '9'.
   420
   421     12  NUMBER-OF-MONTHS.
   422         16  SK-MO OCCURS 12 TIMES PIC X.
   423
   424     12  WS-WORK-DATE.
   425         16  WS-YEAR            PIC 99    VALUE 00.
   426         16  WS-MONTH           PIC 99    VALUE 00.
   427         16  WS-DAY             PIC 99    VALUE 00.
   428
   429     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   430     12  WS-WORK-CRIT-DEV       REDEFINES
   431         WS-WORK-LF-CRIT-PER    PIC X(03).
   432
   433     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   434     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   435
   436     12  WS-WORK-DATE-FROM.
   437         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X  VALUE SPACE.
   439         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-WORK-DATE-THRU.
   444         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   445         16  FILLER             PIC X         VALUE SPACE.
   446         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   447         16  FILLER             PIC X         VALUE SPACE.
   448         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   449
   450     12  WS-LF-INPUT-CD.
   451         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   452         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   453
   454     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   455     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   456         16  WS-AH-INPUT-CD-1   PIC X.
   457         16  WS-AH-INPUT-CD-2-3 PIC XX.
   458
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  10
* EL050.cbl
   459     12  WS-SWITCHES.
   460         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   461         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   462             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   463         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   464             88  BANK-ACCT-FOUND          VALUE 'Y'.
   465         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   466             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   467         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   468             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   469         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   470             88  COMP-MASTER-FOUND        VALUE 'Y'.
   471         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   472             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   473         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   474             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   475         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   476             88  STAT-MASTER-FOUND        VALUE 'Y'.
   477         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   478             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   479         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   480             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   481         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   482             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   483         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   484             88  FORM-MASTER-FOUND        VALUE 'Y'.
   485         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   486             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   487         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   488             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   489         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   490             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   491         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   492             88  NO-BENEFIT-FOUND         VALUE 'N'.
   493         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   494             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   495         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   496             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   497         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   498             88  AH-BENEFIT-FOUND         VALUE ' '.
   499             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   500         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   501             88  LF-BENEFIT-FOUND         VALUE ' '.
   502             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   503         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   504             88  NO-STATE-RECORD          VALUE '1'.
   505         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   506             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   507         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   508             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   509         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   510             88  CERT-WAS-FOUND           VALUE ' '.
   511             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   512         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   513             88  BROWSE-STARTED           VALUE 'Y'.
   514         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   515             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   516         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  11
* EL050.cbl
   517             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   518         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   519             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   520         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   521             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   522         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   523             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   524         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   525             88  APP-CERT-USED            VALUE 'Y' 'A'.
   526         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   527             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   528             88  FIRST-TIME-THROUGH       VALUE '1'.
   529             88  CTBL-NOT-FOUND           VALUE '2'.
   530
   531         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   532             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   533
   534         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   535             88  DLO-ERROR-FOUND          VALUE 'Y'.
   536
   537********FLA
   538     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   539     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   540********
   541     12  RC-SW-1                  PIC X           VALUE '0'.
   542     12  RC-SW-2                  PIC X           VALUE '0'.
   543     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   544     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   545     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   546     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   549     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   550     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   551     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   552     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   553     12  LIT-SPACES               PIC X           VALUE SPACES.
   554     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   555     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   556     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   557     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   558     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   559     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   560     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   561         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   562         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   563     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   564         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   565
   566 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   567     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   568     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   569 01  WS-CRI-SSN-WORK-AREA.
   570     05  WS-CRI-SOC-SEC-NO.
   571         10  WS-SS-REPT-CD       PIC X(5).
   572         10  WS-SS-LAST-NAME     PIC X(5).
   573         10  WS-SS-INITIAL       PIC X.
   574
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  12
* EL050.cbl
   575     05  WS-CRI-REPORT-CODE.
   576         10  FILLER              PIC X(5).
   577         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   578
   579     05  WS-CRI-LAST-NAME.
   580         10  WS-CRI-NAME-MOVE    PIC X(5).
   581         10  FILLER              PIC X(10).
   582
   583 01  WS-NUM-TABLE                PIC X(26)  VALUE
   584     '12345678012345070923456789'.
   585 01  FILLER REDEFINES WS-NUM-TABLE.
   586     05  WS-NUM OCCURS 26        PIC 9.
   587 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   588 01  V1                          PIC S999 COMP-3.
   589 01  V2                          PIC S999 COMP-3.
   590 01  V3                          PIC S999 COMP-3.
   591 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   592 01  FILLER REDEFINES WS-WORK-VIN.
   593     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   594 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   595 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   596 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   597 01  WS-HEX-WORK.
   598     05  FILLER                  PIC X  VALUE LOW-VALUES.
   599     05  WS-HEX-BYTE             PIC X.
   600 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   601 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   602 01  WS-WORK-HIN-ROW-B.
   603     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   604
   605 01  ws-benefit-cd-chg-sw      pic x value spaces.
   606     88  benefit-code-chg           value 'Y'.
   607 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   608 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   609     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   610 01  WS-ROW-D-TABLE.
   611     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   612
   613 01  WS-HIN-TABLE-B.
   614     05  F                       PIC XX VALUE 'A2'.
   615     05  F                       PIC XX VALUE 'B3'.
   616     05  F                       PIC XX VALUE 'C4'.
   617     05  F                       PIC XX VALUE 'D5'.
   618     05  F                       PIC XX VALUE 'E6'.
   619     05  F                       PIC XX VALUE 'F7'.
   620     05  F                       PIC XX VALUE 'G8'.
   621     05  F                       PIC XX VALUE 'H9'.
   622     05  F                       PIC XX VALUE 'I1'.
   623     05  F                       PIC XX VALUE 'J2'.
   624     05  F                       PIC XX VALUE 'K3'.
   625     05  F                       PIC XX VALUE 'L4'.
   626     05  F                       PIC XX VALUE 'M5'.
   627     05  F                       PIC XX VALUE 'N6'.
   628     05  F                       PIC XX VALUE 'O0'.
   629     05  F                       PIC XX VALUE 'P7'.
   630     05  F                       PIC XX VALUE 'Q0'.
   631     05  F                       PIC XX VALUE 'R8'.
   632     05  F                       PIC XX VALUE 'S9'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  13
* EL050.cbl
   633     05  F                       PIC XX VALUE 'T2'.
   634     05  F                       PIC XX VALUE 'U3'.
   635     05  F                       PIC XX VALUE 'V4'.
   636     05  F                       PIC XX VALUE 'W5'.
   637     05  F                       PIC XX VALUE 'X6'.
   638     05  F                       PIC XX VALUE 'Y7'.
   639     05  F                       PIC XX VALUE 'Z8'.
   640 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   641     05  WS-VAL-IN               PIC X.
   642     05  WS-VAL-OUT              PIC 9.
   643 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   644 01  WS-COMPARE-BINARY-DATES.
   645     05  WS-971231                PIC XX VALUE X'92FF'.
   646     05  WS-931231                PIC XX VALUE X'8CFF'.
   647     05  WS-791231                PIC XX VALUE X'77FF'.
   648     05  WS-771001                PIC XX VALUE X'74A1'.
   649     05  WS-820301                PIC XX VALUE X'7B41'.
   650     05  WS-831031                PIC XX VALUE X'7DBF'.
   651     05  WS-831231                PIC XX VALUE X'7DFF'.
   652     05  WS-810831                PIC XX VALUE X'7A7F'.
   653     05  WS-830901                PIC XX VALUE X'7D81'.
   654
   655 01  FILE-ACCESS-IDS.
   656     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   657     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   658     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   659     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   660     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   661     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   662     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   663     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   664     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   665     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   666     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   667     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   668     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   669     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   670     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   671     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   672     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   673 01  DD-IU-SW                    PIC X   VALUE ' '.
   674     88  DD-IU-PRESENT                 VALUE 'Y'.
   675
   676 01  ACCESS-KEYS.
   677     12  ELMSTR-KEY.
   678         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   679         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   680     12  W-CLAIM-KEY.
   681         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   682         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   683
   684     12  ELCNTL-KEY.
   685         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   686         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   687         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   688         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   689
   690     12  ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  14
* EL050.cbl
   691         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   692         16  CERT-CARRIER         PIC X       VALUE SPACE.
   693         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   694         16  CERT-STATE           PIC XX      VALUE SPACES.
   695         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   696         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   697         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   698
   699     12  ELCERT2-KEY.
   700         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   701         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   702
   703     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   704
   705     12  ELCERT-SAVE.
   706         16  FILLER                      PIC XX    VALUE SPACES.
   707
   708         16  WCS-CONTROL-PRIMARY.
   709             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   710             20  WCS-CARRIER             PIC X     VALUE SPACE.
   711             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   712             20  WCS-STATE               PIC XX    VALUE SPACES.
   713             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   714             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   715             20  WCS-CERT-NO.
   716                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   717                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   718
   719         16  CS-CONTROL-BY-NAME.
   720             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   721             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   722             20  CS-INSURED-INITIALS.
   723                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   724                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   725
   726         16  CS-CONTROL-BY-SSN.
   727             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   728             20  CS-SOC-SEC-NO.
   729                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   730                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   731                 24  CS-SSN-LN3.
   732                     28 CS-INSURED-INITIALS-A2   PIC XX
   733                                     VALUE SPACES.
   734                     28 CS-PART-LAST-NAME-A2     PIC X
   735                                     VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-CERT-NO.
   738             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   739             20  CS-CERT-NO-A4           PIC X(11)
   740                                     VALUE SPACES.
   741
   742         16  CS-CONTROL-BY-MEMB.
   743             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   744             20  CS-MEMBER-NO.
   745                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   746                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   747                 24  CS-MEMB-LN4.
   748                     28 CS-INSURED-INITIALS-A5   PIC XX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  15
* EL050.cbl
   749                                      VALUE SPACES.
   750                     28 CS-PART-LAST-NAME-A5     PIC XX
   751                                      VALUE SPACES.
   752
   753         16  FILLER              PIC X(360) VALUE SPACES.
   754
   755     12  ERACCT-KEY.
   756         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   757         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   758         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   759         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   760         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   761         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   762
   763     12  ERCOMP-KEY.
   764         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  COMP-CARRIER         PIC X     VALUE SPACES.
   766         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   767         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   768         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   769         16  COMP-TYPE            PIC X     VALUE SPACES.
   770
   771     12  ERLOFC-KEY.
   772         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   773         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   774         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   775         16  LOFC-STATE           PIC XX    VALUE SPACES.
   776         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   777         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   778
   779     12  WS-ELCRTT-KEY.
   780         16  WS-ELCRTT-PRIMARY       PIC X(33).
   781         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   782
   783     12  ERBXRF-KEY.
   784         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   785         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   786         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   787         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   788
   789     12  ERAGTC-KEY.
   790         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   791         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   792         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   793         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   794         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   795         16  AGTC-TYPE            PIC X     VALUE SPACES.
   796
   797     12  ERPLAN-KEY.
   798         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   800         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   801         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   802         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   803         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   804         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   805         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   806
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  16
* EL050.cbl
   807     12  ERFORM-KEY.
   808         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   809         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   810         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   811         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   812
   813     12  ERREIN-KEY.
   814         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   815         16  REIN-TYPE            PIC X     VALUE SPACES.
   816         16  REIN-TABLE-CO.
   817             20  REIN-CODE-1      PIC X     VALUE SPACE.
   818             20  REIN-CODE-2      PIC X     VALUE SPACE.
   819             20  REIN-CODE-3      PIC X     VALUE SPACE.
   820         16  FILLER               PIC X(3)  VALUE SPACES.
   821
   822     12  ERCTBL-KEY.
   823         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   824         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   825         16  CTBL-CNTRL-2.
   826             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   827             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   828
   829     12  ELCRTO-KEY.
   830         16  ELCRTO-COMPANY-CD       PIC X.
   831         16  ELCRTO-CARRIER          PIC X.
   832         16  ELCRTO-GROUPING         PIC X(6).
   833         16  ELCRTO-STATE            PIC XX.
   834         16  ELCRTO-ACCOUNT          PIC X(10).
   835         16  ELCRTO-CERT-EFF-DT      PIC XX.
   836         16  ELCRTO-CERT-NO.
   837             20  ELCRTO-CERT-PRIME   PIC X(10).
   838             20  ELCRTO-CERT-SFX     PIC X.
   839         16  ELCRTO-RECORD-TYPE      PIC X.
   840         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   841
   842
   843     12  WS-ACCESS.
   844         16  FILLER               PIC XX    VALUE SPACES.
   845         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   846
   847     12  WS-CARR-ACCESS.
   848         16  FILLER               PIC X(3)  VALUE SPACES.
   849         16  WS-CARR              PIC X     VALUE SPACE.
   850*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   851*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   852     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   853         88  WS-DMD-LF-RATING   VALUE 'Y'.
   854         88  WS-DMD-AH-RATING   VALUE 'Y'.
   855         88  WS-DMD-NO-RATING   VALUE 'N'.
   856
   857     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   858         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   859                                         'NJ' 'NL'
   860                                         'PJ' 'PL'
   861                                         'SJ' 'SL'.
   862     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   863         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   864                                         'NI' 'NJ' 'NL' 'NU'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  17
* EL050.cbl
   865                                         'PJ' 'PL' 'PI' 'PU'
   866                                         'SI' 'SJ' 'SL' 'SU'
   867                                         'MX' 'MY' 'MZ'.
   868 01  ERPDEF-KEY-SAVE             PIC X(18).
   869 01  ERPDEF-KEY.
   870     12  ERPDEF-COMPANY-CD       PIC X.
   871     12  ERPDEF-STATE            PIC XX.
   872     12  ERPDEF-PROD-CD          PIC XXX.
   873     12  F                       PIC X(7).
   874     12  ERPDEF-BEN-TYPE         PIC X.
   875     12  ERPDEF-BEN-CODE         PIC XX.
   876     12  ERPDEF-EXP-DT           PIC XX.
   877
   878 01  ELSTAT-KEY-SAVE             PIC X(20).
   879 01  ELSTAT-KEY.
   880     12  ELSTAT-COMPANY-ID       PIC XXX.
   881     12  ELSTAT-CARRIER          PIC X.
   882     12  ELSTAT-GROUP            PIC X(6).
   883     12  ELSTAT-STATE            PIC XX.
   884     12  ELSTAT-EXP-DT           PIC 9(8).
   885 01  WS-ERROR-VALUES.
   886     12  ER-1570                     PIC S9(4)   VALUE +1570.
   887     12  ER-1571                     PIC S9(4)   VALUE +1571.
   888     12  er-1572                     pic s9(4)   value +1572.
   889     12  er-1573                     pic s9(4)   value +1573.
   890     12  er-1574                     pic s9(4)   value +1574.
   891     12  ER-1575                     PIC S9(4)   VALUE +1575.
   892     12  ER-1891                     PIC S9(4)   VALUE +1891.
   893     12  ER-1892                     PIC S9(4)   VALUE +1892.
   894     12  ER-1893                     PIC S9(4)   VALUE +1893.
   895     12  ER-1894                     PIC S9(4)   VALUE +1894.
   896     12  ER-1895                     PIC S9(4)   VALUE +1895.
   897     12  ER-1896                     PIC S9(4)   VALUE +1896.
   898     12  ER-1897                     PIC S9(4)   VALUE +1897.
   899     12  ER-1898                     PIC S9(4)   VALUE +1898.
   900     12  ER-1899                     PIC S9(4)   VALUE +1899.
   901     12  ER-1900                     PIC S9(4)   VALUE +1900.
   902     12  ER-1901                     PIC S9(4)   VALUE +1901.
   903     12  ER-1902                     PIC S9(4)   VALUE +1902.
   904     12  ER-1903                     PIC S9(4)   VALUE +1903.
   905     12  ER-1904                     PIC S9(4)   VALUE +1904.
   906     12  ER-1905                     PIC S9(4)   VALUE +1905.
   907     12  ER-1906                     PIC S9(4)   VALUE +1906.
   908     12  ER-1907                     PIC S9(4)   VALUE +1907.
   909     12  ER-1909                     PIC S9(4)   VALUE +1909.
   910     12  ER-1910                     PIC S9(4)   VALUE +1910.
   911     12  ER-1911                     PIC S9(4)   VALUE +1911.
   912     12  ER-1912                     PIC S9(4)   VALUE +1912.
   913     12  ER-1913                     PIC S9(4)   VALUE +1913.
   914     12  ER-1914                     PIC S9(4)   VALUE +1914.
   915     12  ER-1915                     PIC S9(4)   VALUE +1915.
   916     12  ER-1916                     PIC S9(4)   VALUE +1916.
   917     12  ER-1917                     PIC S9(4)   VALUE +1917.
   918     12  ER-1918                     PIC S9(4)   VALUE +1918.
   919     12  ER-1919                     PIC S9(4)   VALUE +1919.
   920     12  ER-1920                     PIC S9(4)   VALUE +1920.
   921     12  ER-1921                     PIC S9(4)   VALUE +1921.
   922     12  ER-1922                     PIC S9(4)   VALUE +1922.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  18
* EL050.cbl
   923     12  ER-1923                     PIC S9(4)   VALUE +1923.
   924     12  ER-1924                     PIC S9(4)   VALUE +1924.
   925     12  ER-1925                     PIC S9(4)   VALUE +1925.
   926     12  ER-1926                     PIC S9(4)   VALUE +1926.
   927     12  ER-1927                     PIC S9(4)   VALUE +1927.
   928     12  ER-2393                     PIC S9(4)   VALUE +2393.
   929     12  ER-2600                     PIC S9(4)   VALUE +2600.
   930     12  ER-2601                     PIC S9(4)   VALUE +2601.
   931     12  ER-2602                     PIC S9(4)   VALUE +2602.
   932     12  ER-2603                     PIC S9(4)   VALUE +2603.
   933     12  ER-2604                     PIC S9(4)   VALUE +2604.
   934     12  ER-2605                     PIC S9(4)   VALUE +2605.
   935     12  ER-2606                     PIC S9(4)   VALUE +2606.
   936     12  ER-2607                     PIC S9(4)   VALUE +2607.
   937     12  ER-2608                     PIC S9(4)   VALUE +2608.
   938     12  ER-2609                     PIC S9(4)   VALUE +2609.
   939     12  ER-2610                     PIC S9(4)   VALUE +2610.
   940     12  ER-2611                     PIC S9(4)   VALUE +2611.
   941     12  ER-2612                     PIC S9(4)   VALUE +2612.
   942     12  ER-2613                     PIC S9(4)   VALUE +2613.
   943     12  ER-2614                     PIC S9(4)   VALUE +2614.
   944     12  ER-2615                     PIC S9(4)   VALUE +2615.
   945     12  ER-2616                     PIC S9(4)   VALUE +2616.
   946     12  ER-2617                     PIC S9(4)   VALUE +2617.
   947     12  ER-2618                     PIC S9(4)   VALUE +2618.
   948     12  ER-2619                     PIC S9(4)   VALUE +2619.
   949     12  ER-2620                     PIC S9(4)   VALUE +2620.
   950     12  ER-2621                     PIC S9(4)   VALUE +2621.
   951     12  ER-2622                     PIC S9(4)   VALUE +2622.
   952     12  ER-2623                     PIC S9(4)   VALUE +2623.
   953     12  ER-2624                     PIC S9(4)   VALUE +2624.
   954     12  ER-2625                     PIC S9(4)   VALUE +2625.
   955     12  ER-2626                     PIC S9(4)   VALUE +2626.
   956     12  ER-2627                     PIC S9(4)   VALUE +2627.
   957     12  ER-2628                     PIC S9(4)   VALUE +2628.
   958     12  ER-2629                     PIC S9(4)   VALUE +2629.
   959     12  ER-2630                     PIC S9(4)   VALUE +2630.
   960     12  ER-2631                     PIC S9(4)   VALUE +2631.
   961     12  ER-2632                     PIC S9(4)   VALUE +2632.
   962     12  ER-2633                     PIC S9(4)   VALUE +2633.
   963     12  ER-2634                     PIC S9(4)   VALUE +2634.
   964     12  ER-2635                     PIC S9(4)   VALUE +2635.
   965     12  ER-2636                     PIC S9(4)   VALUE +2636.
   966     12  ER-2637                     PIC S9(4)   VALUE +2637.
   967     12  ER-2638                     PIC S9(4)   VALUE +2638.
   968     12  ER-2639                     PIC S9(4)   VALUE +2639.
   969     12  ER-2640                     PIC S9(4)   VALUE +2640.
   970     12  ER-2641                     PIC S9(4)   VALUE +2641.
   971     12  ER-2642                     PIC S9(4)   VALUE +2642.
   972     12  ER-2643                     PIC S9(4)   VALUE +2643.
   973     12  ER-2644                     PIC S9(4)   VALUE +2644.
   974     12  ER-2645                     PIC S9(4)   VALUE +2645.
   975     12  ER-2646                     PIC S9(4)   VALUE +2646.
   976     12  ER-2647                     PIC S9(4)   VALUE +2647.
   977     12  ER-2648                     PIC S9(4)   VALUE +2648.
   978     12  ER-2649                     PIC S9(4)   VALUE +2649.
   979     12  ER-2650                     PIC S9(4)   VALUE +2650.
   980     12  ER-2651                     PIC S9(4)   VALUE +2651.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  19
* EL050.cbl
   981     12  ER-2652                     PIC S9(4)   VALUE +2652.
   982     12  ER-2653                     PIC S9(4)   VALUE +2653.
   983     12  ER-2654                     PIC S9(4)   VALUE +2654.
   984     12  ER-2655                     PIC S9(4)   VALUE +2655.
   985     12  ER-2656                     PIC S9(4)   VALUE +2656.
   986     12  ER-2657                     PIC S9(4)   VALUE +2657.
   987     12  ER-2658                     PIC S9(4)   VALUE +2658.
   988     12  ER-2659                     PIC S9(4)   VALUE +2659.
   989     12  ER-2660                     PIC S9(4)   VALUE +2660.
   990     12  ER-2661                     PIC S9(4)   VALUE +2661.
   991     12  ER-2662                     PIC S9(4)   VALUE +2662.
   992     12  ER-2663                     PIC S9(4)   VALUE +2663.
   993     12  ER-2664                     PIC S9(4)   VALUE +2664.
   994     12  ER-2665                     PIC S9(4)   VALUE +2665.
   995     12  ER-2666                     PIC S9(4)   VALUE +2666.
   996     12  ER-2667                     PIC S9(4)   VALUE +2667.
   997     12  ER-2668                     PIC S9(4)   VALUE +2668.
   998     12  ER-2669                     PIC S9(4)   VALUE +2669.
   999     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1000     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1001     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1002     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1003     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1004     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1005     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1006     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1007     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1008     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1009     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1010     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1011     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1012     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1013     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1014     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1015     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1016     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1017     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1018     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1019     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1020     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1021     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1022     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1023     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1024     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1025     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1026     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1027     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1028     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1029     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1030     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1031     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1032     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1033     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1034     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1035     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1036     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1037     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1038     12  ER-2718                     PIC S9(4)   VALUE +2718.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  20
* EL050.cbl
  1039     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1040     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1041     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1042     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1043     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1044     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1045     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1046     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1047     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1048     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1049     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1050     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1051     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1052     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1053     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1054     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1055     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1056     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1057     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1058     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1059     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1060     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1061     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1062     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1063     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1064     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1065     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1066     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1067     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1068     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1069     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1070     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1071     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1072     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1073     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1074     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1075     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1076     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1077     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1078     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1079     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1080     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1081     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1082     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1083     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1084     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1085     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1086     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1087     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1088     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1089     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1090     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1091     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1092     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1093     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1094     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1095     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1096     12  ER-2777                     PIC S9(4)   VALUE +2777.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  21
* EL050.cbl
  1097     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1098     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1099     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1100     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1101     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1102     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1103     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1104     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1105     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1106     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1107     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1108     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1109     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1110     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1111     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1112     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1113     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1114     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1115     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1116     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1117     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1118     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1119     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1120     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1121     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1122     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1123     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1124     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1125     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1126     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1127     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1128     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1129     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1130     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1131     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1132     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1133     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1134     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1135     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1136     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1137     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1138     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1139     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1140     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1141     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1142     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1143     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1144     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1145     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1146     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1147     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1148     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1149     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1150     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1151     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1152     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1153     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1154     12  ER-7818                     PIC S9(4)   VALUE +7818.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  22
* EL050.cbl
  1155     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1156     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1157     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1158     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1159     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1160     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1161     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1162     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1163     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1164     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1165     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1166     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1167     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1168     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1169     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1170     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1171     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1172     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1173     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1174     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1175     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1176     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1177     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1178     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1179     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1180     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1181     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1182     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1183     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1184     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1185     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1186     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1187     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1188     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1189     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1190     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1191     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1192     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1193     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1194     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1195     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1196     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1197     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1198     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1199     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1200     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1201     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1202     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1203     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1204     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1205     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1206     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1207     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1208     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1209     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1210     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1211     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1212     12  ER-8148                     PIC S9(4)   VALUE +8148.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  23
* EL050.cbl
  1213     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1214     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1215     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1216     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1217     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1218     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1219     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1220     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1221     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1222     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1223     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1224     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1225     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1226     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1227     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1228     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1229     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1230     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1231     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1232******************************************************************
  1233***************   END OF ELC50WS     ****************************
  1234******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  24
* EL050.cbl
  1237 01  WORKING-STORAGE-WORK-AREAS.
  1238     12  WS-RESPONSE             PIC S9(8)  COMP.
  1239         88  WS-RESP-NORMAL           VALUE +00.
  1240         88  WS-RESP-ERROR            VALUE +01.
  1241         88  WS-RESP-NOTFND           VALUE +13.
  1242         88  WS-RESP-DUPREC           VALUE +14.
  1243         88  WS-RESP-ENDFILE          VALUE +20.
  1244     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1245     12  WORK-AREAS.
  1246         16  WK-CONV-GREG.
  1247             24  WCG-CENT             PIC XX.
  1248             24  WCG-REST             PIC X(4).
  1249         16  WORK-GREGORIAN-DATE.
  1250             24  WK-GREG-CENT         PIC XX.
  1251             24  WK-GREG-DATE-YYMMDD.
  1252                 28  WK-GREG-YYMM     PIC X(4).
  1253                 28  WK-GREG-DD       PIC XX.
  1254
  1255         16  WORK-SELECT-DATE.
  1256             24  WK-SELECT-CENT            PIC XX.
  1257             24  WK-SELECT-DATE-YYMMDD.
  1258                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1259                 28  FILLER                PIC XX.
  1260
  1261         16  WK-FORM-NO.
  1262             24  WK-FORM-BANK-ID       PIC X(5).
  1263             24  WK-FORM-UNDRWRTR      PIC X(1).
  1264             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1265
  1266         16  WK-MEMBER-NO.
  1267             24  WK-MEMBER-1-6        PIC X(6).
  1268             24  WK-MEMBER-7-12       PIC X(6).
  1269
  1270         16  WK-FULL-CERT-NO.
  1271             24  WK-CERT-POS-1-2      PIC X(2).
  1272             24  WK-CERT-POS-3        PIC X(1).
  1273             24  WK-CERT-POS-4        PIC X(1).
  1274             24  WK-CERT-POS-5-6      PIC X(2).
  1275             24  WK-CERT-POS-7        PIC X(1).
  1276             24  WK-CERT-POS-8-11     PIC X(4).
  1277
  1278         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1279             88  VALID-RATE-CODE        VALUE 'Y'.
  1280             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1281
  1282         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1283         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1284         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1285         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1286         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1287         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1288         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1289         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1290         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1291         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1292
  1293* DLO001
  1294 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  25
* EL050.cbl
  1295     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1296     12  DMPF-RETURN-CODE          PIC XX.
  1297         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1298         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1299         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1300         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1301         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1302         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1303
  1304* DLO002
  1305 01  WS-DLO-INTERNAL-POLICY-FORM.
  1306     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1307     12  DIPF-RETURN-CODE          PIC XX.
  1308         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1309         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1310         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1311         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1312         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1313         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1314
  1315* DLO003
  1316 01  WS-DLO-VALID-BANK-ID.
  1317     12  DVBI-BANK-ID              PIC X(5).
  1318     12  DVBI-BANK-ID-TYPE         PIC X.
  1319         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1320         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1321         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1322         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1323         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1324     12  DVBI-RETURN-CODE          PIC XX.
  1325         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1326         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1327         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1328         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1329         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1330         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1331         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1332         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1333         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1334
  1335* DLO007
  1336 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1337     12  DCUA-RES-STATE            PIC XX.
  1338     12  DCUA-BEN-TYPE             PIC XX.
  1339     12  DCUA-SYS-IDENT            PIC X.
  1340         88  DCUA-CLAIM                        VALUE 'C'.
  1341         88  DCUA-PREMIUM                      VALUE 'P'.
  1342     12  DCUA-COVERAGE-RULE        PIC X.
  1343     12  DCUA-CLIENT-ID            PIC X(10).
  1344     12  DCUA-EFF-DATE             PIC X(8).
  1345     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1346     12  DCUA-RETURN-CODE          PIC XX.
  1347         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1348     12  DCUA-CERT-NUMBER          PIC X(11).
  1349     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1350     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1351
  1352* DLO011
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  26
* EL050.cbl
  1353 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1354     12  DPRB-RATE-CODE            PIC X(4).
  1355     12  DPRB-COVERAGE-CATEG       PIC X.
  1356     12  DPRB-RETURN-CODE          PIC XX.
  1357         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1358         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1359         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1360         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1361         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1362         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1363         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1364         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1365         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1366     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1367     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1368     12  DPRB-BEN-TYPE             PIC XX.
  1369
  1370* DLO017
  1371 01  WS-DLO-VALID-RATE-CODE.
  1372     12  DVRC-RATE-CODE            PIC X(4).
  1373     12  DVRC-RETURN-CODE          PIC XX.
  1374         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1375         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1376         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1377         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1378         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1379         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1380
  1381* DLO019
  1382 01  WS-DLO-ORIG-COV-CAT.
  1383     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1384     12  DOCC-RETURN-CODE          PIC XX.
  1385     12  DOCC-ORIG-COV-CAT         PIC X.
  1386     12  DOCC-UNDERWITER           PIC XX.
  1387     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1388     12  DOCC-FILLER               PIC X(6).
  1389
  1390* DLO021
  1391 01  WS-DLO-VALID-LOAN-OFFICER.
  1392     12  DVLO-LOAN-OFFICER.
  1393         16  DVLO-BILL-TYPE        PIC X.
  1394         16  DVLO-BILL-SOURCE      PIC X.
  1395         16  DVLO-BATCH-TYPE       PIC X.
  1396     12  DVLO-RETURN-CODE          PIC XX.
  1397         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1398         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1399         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1400         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1401         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1402         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1403
  1404* DLO022
  1405 01  WS-DLO-VALID-STATE-CODE.
  1406     12  DVSC-STATE-CODE           PIC XX.
  1407     12  DVSC-RETURN-CODE          PIC XX.
  1408         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1409
  1410* DLO023
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  27
* EL050.cbl
  1411 01  WS-DLO-VALID-CODE-VALUES.
  1412     12  DVCV-SYSTEM-ID            PIC XX.
  1413         88  DVCV-CLAIMS                       VALUE 'CL'.
  1414         88  DVCV-CREDIT                       VALUE 'CR'.
  1415     12  DVCV-RECORD-TYPE          PIC XX.
  1416         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1417         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1418         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1419         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1420         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1421         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1422         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1423         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1424     12  DVCV-RECORD-KEY           PIC X(6).
  1425     12  DVCV-RETURN-CODE          PIC XX.
  1426         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1427         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1428         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1429         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1430         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1431         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1432         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1433     12  DVCV-CODE-DESC            PIC X(60).
  1434     12  DVCV-GEN-DESC-1           PIC X(20).
  1435     12  DVCV-GEN-DESC-2           PIC X(20).
  1436     12  DVCV-GEN-DESC-3           PIC X(20).
  1437
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  28
* EL050.cbl
  1439*    COPY ERCBXRF.
  1440******************************************************************
  1441*                                                                *
  1442*                                                                *
  1443*                            ERCBXRF                             *
  1444*                                                                *
  1445*   ONLINE CREDIT SYSTEM                                         *
  1446*                                                                *
  1447*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1448*                                                                *
  1449*   FILE TYPE = VSAM,KSDS                                        *
  1450*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1451*                                                                *
  1452*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1453*       ALTERNATE PATH = NONE                                    *
  1454*                                                                *
  1455*   LOG = NO                                                     *
  1456*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1457*                                                                *
  1458******************************************************************
  1459
  1460 01  BANK-CROSS-REFERENCE.
  1461     12  BK-RECORD-ID                PIC XX.
  1462         88  VALID-BK-ID             VALUE 'BK'.
  1463
  1464     12  BK-CONTROL-PRIMARY.
  1465         16  BK-COMPANY-CD           PIC X.
  1466         16  BK-CARRIER              PIC X.
  1467         16  BK-GROUPING             PIC X(6).
  1468         16  BK-BANK-NO              PIC X(10).
  1469
  1470     12  BK-MAINT-INFORMATION.
  1471         16  BK-LAST-MAINT-DT        PIC XX.
  1472         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1473         16  BK-LAST-MAINT-USER      PIC X(4).
  1474         16  FILLER                  PIC X(9).
  1475
  1476     12  FILLER                      PIC X(37).
  1477
  1478     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1479
  1480     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1481                            DEPENDING ON BK-BANK-POINTER-CNT.
  1482         16  BK-AM-ACCOUNT           PIC X(10).
  1483         16  BK-AM-EXP-DT            PIC XX.
  1484         16  BK-AM-EFF-DT            PIC XX.
  1485         16  BK-AM-STATE             PIC XX.
  1486         16  FILLER                  PIC X(20).
  1487
  1488******************************************************************
  1489
  1490*    COPY ERCCOMP.
  1491******************************************************************
  1492*                                                                *
  1493*                                                                *
  1494*                            ERCCOMP                             *
  1495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1496*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  29
* EL050.cbl
  1497*                                                                *
  1498*   ONLINE CREDIT SYSTEM                                         *
  1499*                                                                *
  1500*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1501*                                                                *
  1502*   FILE TYPE = VSAM,KSDS                                        *
  1503*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1504*                                                                *
  1505*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1506*       ALTERNATE PATH = NONE                                    *
  1507*                                                                *
  1508*   LOG = NO                                                     *
  1509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1510*                                                                *
  1511******************************************************************
  1512*                   C H A N G E   L O G
  1513*
  1514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1515*-----------------------------------------------------------------
  1516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1517* EFFECTIVE    NUMBER
  1518*-----------------------------------------------------------------
  1519* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1520* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1521* 092205    2005050300006  PEMA  ADD LEASE FEE
  1522* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1523* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1524* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1526* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1527* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1528******************************************************************
  1529
  1530 01  COMPENSATION-MASTER.
  1531     12  CO-RECORD-ID                          PIC XX.
  1532         88  VALID-CO-ID                          VALUE 'CO'.
  1533
  1534     12  CO-CONTROL-PRIMARY.
  1535         16  CO-COMPANY-CD                     PIC X.
  1536         16  CO-CONTROL.
  1537             20  CO-CTL-1.
  1538                 24  CO-CARR-GROUP.
  1539                     28  CO-CARRIER            PIC X.
  1540                     28  CO-GROUPING.
  1541                         32  CO-GROUP-PREFIX   PIC XXX.
  1542                         32  CO-GROUP-PRIME    PIC XXX.
  1543                 24  CO-RESP-NO.
  1544                     28  CO-RESP-PREFIX        PIC X(4).
  1545                     28  CO-RESP-PRIME         PIC X(6).
  1546             20  CO-CTL-2.
  1547                 24  CO-ACCOUNT.
  1548                     28  CO-ACCT-PREFIX        PIC X(4).
  1549                     28  CO-ACCT-PRIME         PIC X(6).
  1550         16  CO-TYPE                           PIC X.
  1551             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1552             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1553             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1554
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  30
* EL050.cbl
  1555     12  CO-MAINT-INFORMATION.
  1556         16  CO-LAST-MAINT-DT                  PIC XX.
  1557         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1558         16  CO-LAST-MAINT-USER                PIC X(4).
  1559     12  FILLER                                PIC XX.
  1560     12  CO-STMT-TYPE                          PIC XXX.
  1561     12  CO-COMP-TYPE                          PIC X.
  1562         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1563     12  CO-STMT-OWNER                         PIC X(4).
  1564     12  CO-BALANCE-CONTROL                    PIC X.
  1565         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1566         88  CO-NO-BALANCE                        VALUE 'N'.
  1567
  1568     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1569         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1570         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1571         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1572
  1573     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1574         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1575         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1576
  1577     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1578     12  CO-GA-DIRECT-DEP                      PIC X.
  1579     12  CO-FUTURE-SPACE                       PIC X.
  1580         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1581
  1582     12  CO-ACCT-NAME                          PIC X(30).
  1583     12  CO-MAIL-NAME                          PIC X(30).
  1584     12  CO-ADDR-1                             PIC X(30).
  1585     12  CO-ADDR-2                             PIC X(30).
  1586     12  CO-ADDR-3.
  1587         16  CO-ADDR-CITY                      PIC X(27).
  1588         16  CO-ADDR-STATE                     PIC XX.
  1589     12  CO-CSO-1099                           PIC X.
  1590     12  CO-ZIP.
  1591         16  CO-ZIP-PRIME.
  1592             20  CO-ZIP-PRI-1ST                PIC X.
  1593                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1594             20  FILLER                        PIC X(4).
  1595         16  CO-ZIP-PLUS4                      PIC X(4).
  1596     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1597         16  CO-CAN-POSTAL-1                   PIC XXX.
  1598         16  CO-CAN-POSTAL-2                   PIC XXX.
  1599         16  FILLER                            PIC XXX.
  1600     12  CO-SOC-SEC                            PIC X(13).
  1601     12  CO-TELEPHONE.
  1602         16  CO-AREA-CODE                      PIC XXX.
  1603         16  CO-PREFIX                         PIC XXX.
  1604         16  CO-PHONE                          PIC X(4).
  1605
  1606     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1607
  1608     12  CO-AR-BAL-LEVEL                       PIC X.
  1609         88  CO-AR-REF-LVL                        VALUE '1'.
  1610         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1611         88  CO-AR-BILL-LVL                       VALUE '2'.
  1612         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  31
* EL050.cbl
  1613         88  CO-AR-FR-LVL                         VALUE '4'.
  1614
  1615     12  CO-AR-NORMAL-PRINT                    PIC X.
  1616         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1617         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1618
  1619     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1620
  1621     12  CO-AR-REPORTING                       PIC X.
  1622         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1623         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1624
  1625     12  CO-AR-PULL-CHECK                      PIC X.
  1626         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1627         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1628
  1629     12  CO-AR-BALANCE-PRINT                   PIC X.
  1630         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1631
  1632     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1633         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1634         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1635         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1636
  1637     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1638
  1639     12  CO-USER-CODE                          PIC X.
  1640     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1644*    THE LAST MONTH END RUN.
  1645******************************************************************
  1646
  1647     12  CO-LAST-ACTIVITY-DATE.
  1648         16  CO-ACT-YEAR                       PIC 99.
  1649         16  CO-ACT-MONTH                      PIC 99.
  1650         16  CO-ACT-DAY                        PIC 99.
  1651
  1652     12  CO-LAST-STMT-DT.
  1653         16  CO-LAST-STMT-YEAR                 PIC 99.
  1654         16  CO-LAST-STMT-MONTH                PIC 99.
  1655         16  CO-LAST-STMT-DAY                  PIC 99.
  1656
  1657     12  CO-MO-END-TOTALS.
  1658         16  CO-MONTHLY-TOTALS.
  1659             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1660             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1661             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1662             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1663             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1664
  1665         16  CO-AGING-TOTALS.
  1666             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1667             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1668             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1669             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1670
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  32
* EL050.cbl
  1671         16  CO-YTD-TOTALS.
  1672             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1674
  1675         16  CO-OVER-UNDER-TOTALS.
  1676             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1677             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1678
  1679     12  CO-MISCELLANEOUS-TOTALS.
  1680         16  CO-FICA-TOTALS.
  1681             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1682             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1683
  1684         16  CO-CLAIM-TOTALS.
  1685             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1686             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1687
  1688******************************************************************
  1689*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1690*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1691******************************************************************
  1692
  1693     12  CO-CURRENT-TOTALS.
  1694         16  CO-CURRENT-LAST-STMT-DT.
  1695             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1696             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1697             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1698
  1699         16  CO-CURRENT-MONTHLY-TOTALS.
  1700             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1703             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1704             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1705
  1706         16  CO-CURRENT-AGING-TOTALS.
  1707             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1708             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1709             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1710             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1711
  1712         16  CO-CURRENT-YTD-TOTALS.
  1713             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1714             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1715
  1716     12  CO-PAID-COMM-TOTALS.
  1717         16  CO-YTD-PAID-COMMS.
  1718             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1719             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1720
  1721     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1722         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1723         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1724
  1725     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1726         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1727         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1728         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  33
* EL050.cbl
  1729         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1730         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1731         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1732         88  CO-FINAL-LETTER                  VALUE 'F'.
  1733         88  CO-RECONCILING                   VALUE 'R'.
  1734         88  CO-PHONE-CALL                    VALUE 'P'.
  1735         88  CO-LEGAL                         VALUE 'L'.
  1736         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1737         88  CO-WRITE-OFF                     VALUE 'W'.
  1738         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1739
  1740     12  CO-CSR-CODE                       PIC X(4).
  1741
  1742     12  CO-GA-STATUS-INFO.
  1743         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1744         16  CO-GA-TERMINATION-DT          PIC XX.
  1745         16  CO-GA-STATUS-CODE             PIC X.
  1746             88  CO-GA-ACTIVE                 VALUE 'A'.
  1747             88  CO-GA-INACTIVE               VALUE 'I'.
  1748             88  CO-GA-PENDING                VALUE 'P'.
  1749         16  CO-GA-COMMENTS.
  1750             20  CO-GA-COMMENT-1           PIC X(40).
  1751             20  CO-GA-COMMENT-2           PIC X(40).
  1752             20  CO-GA-COMMENT-3           PIC X(40).
  1753             20  CO-GA-COMMENT-4           PIC X(40).
  1754
  1755     12  CO-RPTCD2                         PIC X(10).
  1756     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1757         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1758         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1759
  1760     12  CO-TYPE-AGENT                     PIC X(01).
  1761         88  CO-CORPORATION                   VALUE 'C'.
  1762         88  CO-PARTNERSHIP                   VALUE 'P'.
  1763         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1764         88  CO-TRUST                         VALUE 'T'.
  1765         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1766
  1767     12  CO-FAXNO.
  1768         16  CO-FAX-AREA-CODE                  PIC XXX.
  1769         16  CO-FAX-PREFIX                     PIC XXX.
  1770         16  CO-FAX-PHONE                      PIC X(4).
  1771
  1772     12  CO-BANK-INFORMATION.
  1773         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1774         16  CO-BANK-TRANSIT-NON REDEFINES
  1775             CO-BANK-TRANSIT-NO                PIC 9(8).
  1776
  1777         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1778     12  CO-MISC-DEDUCT-INFO REDEFINES
  1779                  CO-BANK-INFORMATION.
  1780         16  CO-MD-GL-ACCT                     PIC X(10).
  1781         16  CO-MD-DIV                         PIC XX.
  1782         16  CO-MD-CENTER                      PIC X(4).
  1783         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1784         16  CO-CREATE-AP-CHECK                PIC X.
  1785         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1786         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  34
* EL050.cbl
  1787     12  CO-ACH-STATUS                         PIC X.
  1788         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1789         88  CO-ACH-PENDING                        VALUE 'P'.
  1790
  1791     12  CO-BILL-SW                            PIC X.
  1792     12  CO-CONTROL-NAME                       PIC X(30).
  1793     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1794     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1795     12  CO-CLP-STATE                          PIC XX.
  1796     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1797     12  CO-SPP-REFUND-EDIT                    PIC X.
  1798
  1799******************************************************************
  1800
  1801*    COPY ERCAGTC.
  1802******************************************************************
  1803*                                                                *
  1804*                                                                *
  1805*                            ERCAGTC                             *
  1806*                            VMOD=2.001                          *
  1807*                                                                *
  1808*   ONLINE CREDIT SYSTEM                                         *
  1809*                                                                *
  1810*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1811*                                                                *
  1812*   FILE TYPE = VSAM,KSDS                                        *
  1813*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1814*                                                                *
  1815*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1816*       ALTERNATE PATH = NONE                                    *
  1817*                                                                *
  1818*   LOG = NO                                                     *
  1819*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1820*                                                                *
  1821******************************************************************
  1822*                   C H A N G E   L O G
  1823*
  1824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1825*-----------------------------------------------------------------
  1826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1827* EFFECTIVE    NUMBER
  1828*-----------------------------------------------------------------
  1829* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1830* 111004                         NEW FILE AND COPYBOOK
  1831* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1832******************************************************************
  1833 01  AGENT-COMMISSIONS.
  1834     12  AG-RECORD-ID                          PIC XX.
  1835         88  VALID-CO-ID                          VALUE 'AG'.
  1836     12  AG-CONTROL-PRIMARY.
  1837         16  AG-COMPANY-CD                     PIC X.
  1838         16  AG-CONTROL.
  1839             20  AG-CTL-1.
  1840                 24  AG-CARR-GROUP.
  1841                     28  AG-CARRIER            PIC X.
  1842                     28  AG-GROUPING           PIC X(6).
  1843                 24  AG-BANK                   PIC X(10).
  1844             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  35
* EL050.cbl
  1845                 24  AG-EXP-DT                 PIC XX.
  1846         16  AG-TYPE                           PIC X.
  1847             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1848             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1849     12  AG-MAINT-INFORMATION.
  1850         16  AG-LAST-MAINT-DT                  PIC XX.
  1851         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1852         16  AG-LAST-MAINT-USER                PIC X(4).
  1853         16  FILLER                            PIC X(10).
  1854     12  AG-EFF-DT                             PIC XX.
  1855     12  AG-COMM-STRUCTURE.
  1856         16  AG-AGT-COMMS OCCURS 10.
  1857             20  AG-AGT                PIC X(10).
  1858             20  AG-COM-TYP            PIC X.
  1859             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1860             20  AG-RECALC-LV-INDIC    PIC X.
  1861             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1862             20  AG-LRCALC-LV-INDIC    PIC X.
  1863             20  FILLER                PIC X(05).
  1864     12  FILLER                  PIC X(145).
  1865******************************************************************
  1866*    COPY ERCRESS.
  1867******************************************************************
  1868*                                                                *
  1869*                            ERCRESS                             *
  1870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1871*                            VMOD=2.002                          *
  1872*                                                                *
  1873*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1874*                                                                *
  1875*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1876*   VSAM RESIDENT STATE TAX MASTER                              *
  1877*                                                                *
  1878*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1879*                                                                *
  1880*   FILE TYPE = VSAM,KSDS                                        *
  1881*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1882*                                                                *
  1883*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1884*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1885*                                                                *
  1886*   LOG = NO                                                     *
  1887*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1888*                                                                *
  1889*                                                                *
  1890******************************************************************
  1891
  1892 01  RESIDENT-STATE-TAX-MASTER.
  1893
  1894     10  ERRESS-PRIMARY-KEY.
  1895         15  RES-COMPANY-CD        PIC X.
  1896         15  RES-RESIDENT-STATE    PIC XX.
  1897         15  RES-COVERAGE-CATEGORY PIC X.
  1898         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1899*                                      YYYYMMDD
  1900*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1901
  1902     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  36
* EL050.cbl
  1903
  1904         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1905         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1906         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1907         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1908
  1909     10 RES-RECALC-SW              PIC   X.
  1910         88 RECALC                VALUE 'Y'.
  1911         88 NO-RECALC             VALUE 'N'.
  1912     10  RES-MAINT-BY              PIC X(4).
  1913     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1914     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1915*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  37
* EL050.cbl
  1917*    COPY ERCRESC.
  1918******************************************************************
  1919*                                                                *
  1920*                            ERCRESC                             *
  1921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1922*                            VMOD=2.003                          *
  1923*                                                                *
  1924*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1925*                                                                *
  1926*   FILE TYPE = VSAM,KSDS                                        *
  1927*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1928*                                                                *
  1929*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1930*       ALTERNATE PATH1 = NONE                                   *
  1931*                                                                *
  1932*   LOG = NO                                                     *
  1933*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1934*                                                                *
  1935******************************************************************
  1936
  1937 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1938
  1939     10  ERRESC-RECORD-KEY.
  1940         15  RESC-COMPANY-CD           PIC   X.
  1941         15  RESC-CARRIER              PIC   X.
  1942         15  RESC-GROUP                PIC   X(6).
  1943         15  RESC-STATE                PIC   XX.
  1944         15  RESC-ACCOUNT              PIC   X(10).
  1945         15  RESC-AGENT                PIC   X(10).
  1946         15  RESC-RESIDENT-STATE       PIC   XX.
  1947         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1948*                                           YYYYMMDD
  1949     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1950
  1951     10  RESC-COMM-RECORD-DATA.
  1952         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1953             20 RESC-COVERAGE-CAT      PIC    X.
  1954             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1955             20 RESC-COMMISSION-TAB REDEFINES
  1956                RESC-COMMISSION-PER    PIC  XXX.
  1957
  1958     10  RESC-MAINT-BY                 PIC X(4).
  1959     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1960     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1961*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  38
* EL050.cbl
  1963*    COPY ERCPLAN.
  1964******************************************************************
  1965*                                                                *
  1966*                                                                *
  1967*                            ERCPLAN                             *
  1968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1969*                            VMOD=2.003                          *
  1970*                                                                *
  1971*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1972*                                                                *
  1973*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1974*   PLAN MASTER                                                  *
  1975*                                                                *
  1976*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1977*                                                                *
  1978*   FILE TYPE = VSAM,KSDS                                        *
  1979*   RECORD SIZE = 420   RECFORM = FIX                            *
  1980*                                                                *
  1981*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1982*       ALTERNATE PATH1 = N/A                                    *
  1983*                                                                *
  1984*   LOG = NO                                                     *
  1985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1986*                                                                *
  1987*                                                                *
  1988******************************************************************
  1989
  1990 01  PLAN-MASTER.
  1991     12  PL-RECORD-ID                      PIC XX.
  1992         88  VALID-PL-ID                      VALUE 'PL'.
  1993
  1994     12  PL-CONTROL-PRIMARY.
  1995         16  PL-COMPANY-CD                 PIC X.
  1996         16  PL-MSTR-CNTRL.
  1997             20  PL-CONTROL-A.
  1998                 24  PL-CARRIER            PIC X.
  1999                 24  PL-GROUPING           PIC X(6).
  2000                 24  PL-STATE              PIC XX.
  2001                 24  PL-ACCOUNT            PIC X(10).
  2002             20  PL-BENEFIT-TYPE           PIC X.
  2003             20  PL-BENEFIT-CODE           PIC XX.
  2004             20  PL-REVISION-NO            PIC X(3).
  2005
  2006     12  PL-CONTROL-BY-VAR-GRP.
  2007         16  PL-COMPANY-CD-A1              PIC X.
  2008         16  PL-VG-CARRIER                 PIC X.
  2009         16  PL-VG-GROUPING                PIC X(6).
  2010         16  PL-VG-STATE                   PIC XX.
  2011         16  PL-VG-ACCOUNT                 PIC X(10).
  2012         16  PL-BENEFIT-TYPE-A1            PIC X.
  2013         16  PL-BENEFIT-CODE-A1            PIC XX.
  2014         16  PL-REVISION-NO-A1             PIC 999.
  2015
  2016     12  PL-MAINT-INFORMATION.
  2017         16  PL-LAST-MAINT-DT              PIC XX.
  2018         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2019         16  PL-LAST-MAINT-USER            PIC X(4).
  2020         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  39
* EL050.cbl
  2021
  2022     12  PL-LIABILITY-LIMITS.
  2023         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2024         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2025             20  PL-LM-AGE                 PIC S99        COMP-3.
  2026             20  PL-LM-DUR                 PIC S999       COMP-3.
  2027             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2028             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2029
  2030     12  FILLER                            PIC X(30).
  2031
  2032     12  PL-GL-ACCOUNT-NOS.
  2033         16  PL-PREMIUM-GL                 PIC X(8).
  2034         16  PL-COMM-GL                    PIC X(8).
  2035         16  PL-CLAIM-GL                   PIC X(8).
  2036     12  FILLER                            PIC X(24).
  2037     12  PL-TOLERANCES.
  2038         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2039         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2040         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2041         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2042         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2043         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2044     12  PL-OVER-SHORT.
  2045         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2046         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2047     12  FILLER                            PIC X(24).
  2048     12  PLAN-MISC.
  2049         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2050         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2051         16  PL-IG                         PIC X.
  2052         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2053         16  PL-POLICY-FORM                PIC X(12).
  2054         16  PL-EDIT-FOR-FORM              PIC X(01).
  2055         16  PL-DEV-CODE                   PIC XXX.
  2056         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2057         16  PL-CALC-METHOD                PIC X.
  2058         16  PL-BENEFIT-GROUP              PIC X(05).
  2059         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2060
  2061         16  FILLER                        PIC X(99).
  2062******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  40
* EL050.cbl
  2064*    COPY ELCCERT.
  2065******************************************************************
  2066*                                                                *
  2067*                            ELCCERT.                            *
  2068*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2069*                            VMOD=2.013                          *
  2070*                                                                *
  2071*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2072*                                                                *
  2073*   FILE TYPE = VSAM,KSDS                                        *
  2074*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2075*                                                                *
  2076*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2077*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2078*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2079*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2080*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2081*                                                                *
  2082*   LOG = YES                                                    *
  2083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2084******************************************************************
  2085*                   C H A N G E   L O G
  2086*
  2087* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2088*-----------------------------------------------------------------
  2089*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2090* EFFECTIVE    NUMBER
  2091*-----------------------------------------------------------------
  2092* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2093* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2094* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2095* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2096* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2097* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2098* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2099* 032612  CR2011110200001  PEMA  AHL CHANGES
  2100******************************************************************
  2101
  2102 01  CERTIFICATE-MASTER.
  2103     12  CM-RECORD-ID                      PIC XX.
  2104         88  VALID-CM-ID                      VALUE 'CM'.
  2105
  2106     12  CM-CONTROL-PRIMARY.
  2107         16  CM-COMPANY-CD                 PIC X.
  2108         16  CM-CARRIER                    PIC X.
  2109         16  CM-GROUPING.
  2110             20  CM-GROUPING-PREFIX        PIC X(3).
  2111             20  CM-GROUPING-PRIME         PIC X(3).
  2112         16  CM-STATE                      PIC XX.
  2113         16  CM-ACCOUNT.
  2114             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2115             20  CM-ACCOUNT-PRIME          PIC X(6).
  2116         16  CM-CERT-EFF-DT                PIC XX.
  2117         16  CM-CERT-NO.
  2118             20  CM-CERT-PRIME             PIC X(10).
  2119             20  CM-CERT-SFX               PIC X.
  2120
  2121     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  41
* EL050.cbl
  2122         16  CM-COMPANY-CD-A1              PIC X.
  2123         16  CM-INSURED-LAST-NAME          PIC X(15).
  2124         16  CM-INSURED-INITIALS.
  2125             20  CM-INSURED-INITIAL1       PIC X.
  2126             20  CM-INSURED-INITIAL2       PIC X.
  2127
  2128     12  CM-CONTROL-BY-SSN.
  2129         16  CM-COMPANY-CD-A2              PIC X.
  2130         16  CM-SOC-SEC-NO.
  2131             20  CM-SSN-STATE              PIC XX.
  2132             20  CM-SSN-ACCOUNT            PIC X(6).
  2133             20  CM-SSN-LN3.
  2134                 25  CM-INSURED-INITIALS-A2.
  2135                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2136                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2137                 25 CM-PART-LAST-NAME-A2         PIC X.
  2138
  2139     12  CM-CONTROL-BY-CERT-NO.
  2140         16  CM-COMPANY-CD-A4              PIC X.
  2141         16  CM-CERT-NO-A4                 PIC X(11).
  2142
  2143     12  CM-CONTROL-BY-MEMB.
  2144         16  CM-COMPANY-CD-A5              PIC X.
  2145         16  CM-MEMBER-NO.
  2146             20  CM-MEMB-STATE             PIC XX.
  2147             20  CM-MEMB-ACCOUNT           PIC X(6).
  2148             20  CM-MEMB-LN4.
  2149                 25  CM-INSURED-INITIALS-A5.
  2150                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2151                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2152                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2153
  2154     12  CM-INSURED-PROFILE-DATA.
  2155         16  CM-INSURED-FIRST-NAME.
  2156             20  CM-INSURED-1ST-INIT       PIC X.
  2157             20  FILLER                    PIC X(9).
  2158         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2159         16  CM-INSURED-SEX                PIC X.
  2160             88  CM-SEX-MALE                  VALUE 'M'.
  2161             88  CM-SEX-FEMAL                 VALUE 'F'.
  2162         16  CM-INSURED-JOINT-AGE          PIC 99.
  2163         16  CM-JOINT-INSURED-NAME.
  2164             20  CM-JT-LAST-NAME           PIC X(15).
  2165             20  CM-JT-FIRST-NAME.
  2166                 24  CM-JT-1ST-INIT        PIC X.
  2167                 24  FILLER                PIC X(9).
  2168             20  CM-JT-INITIAL             PIC X.
  2169
  2170     12  CM-LIFE-DATA.
  2171         16  CM-LF-BENEFIT-CD              PIC XX.
  2172         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2173         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2174         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2175         16  CM-LF-DEV-CODE                PIC XXX.
  2176         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2177         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2178         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2179         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  42
* EL050.cbl
  2180         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2181         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2182         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2183         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2184         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2185         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2186         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2187         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2188         16  FILLER                        PIC XX.
  2189
  2190     12  CM-AH-DATA.
  2191         16  CM-AH-BENEFIT-CD              PIC XX.
  2192         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2193         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2194         16  CM-AH-DEV-CODE                PIC XXX.
  2195         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2196         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2197         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2198         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2199         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2200         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2201         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2202         16  CM-AH-PAID-THRU-DT            PIC XX.
  2203             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2204         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2205         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2206         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2207         16  FILLER                        PIC X.
  2208
  2209     12  CM-LOAN-INFORMATION.
  2210         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2211         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2212                                           PIC S9(5)V99  COMP-3.
  2213         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2214         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2215         16  CM-PAY-FREQUENCY              PIC S99.
  2216         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2217         16  CM-RATE-CLASS                 PIC XX.
  2218         16  CM-BENEFICIARY                PIC X(25).
  2219         16  CM-POLICY-FORM-NO             PIC X(12).
  2220         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2221         16  CM-LAST-ADD-ON-DT             PIC XX.
  2222         16  CM-DEDUCTIBLE-AMOUNTS.
  2223             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2224             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2225         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2226             20  CM-RESIDENT-STATE         PIC XX.
  2227             20  CM-RATE-CODE              PIC X(4).
  2228             20  FILLER                    PIC XX.
  2229         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2230             20  CM-LOAN-OFFICER           PIC X(5).
  2231             20  FILLER                    PIC XXX.
  2232         16  CM-CSR-CODE                   PIC XXX.
  2233         16  CM-UNDERWRITING-CODE          PIC X.
  2234             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2235         16  CM-POST-CARD-IND              PIC X.
  2236         16  CM-NH-INTERFACE-SW            PIC X.
  2237         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  43
* EL050.cbl
  2238             88  CM-SING-PRM                  VALUE '1'.
  2239             88  CM-O-B-COVERAGE              VALUE '2'.
  2240             88  CM-OPEN-END                  VALUE '3'.
  2241         16  CM-IND-GRP-TYPE               PIC X.
  2242             88  CM-INDIVIDUAL                VALUE 'I'.
  2243             88  CM-GROUP                     VALUE 'G'.
  2244         16  CM-SKIP-CODE                  PIC X.
  2245             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2246             88  SKIP-JULY                    VALUE '1'.
  2247             88  SKIP-AUGUST                  VALUE '2'.
  2248             88  SKIP-SEPTEMBER               VALUE '3'.
  2249             88  SKIP-JULY-AUG                VALUE '4'.
  2250             88  SKIP-AUG-SEPT                VALUE '5'.
  2251             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2252             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2253             88  SKIP-JUNE                    VALUE '8'.
  2254             88  SKIP-JUNE-JULY               VALUE '9'.
  2255             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2256             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2257         16  CM-PAYMENT-MODE               PIC X.
  2258             88  PAY-MONTHLY                  VALUE SPACE.
  2259             88  PAY-WEEKLY                   VALUE '1'.
  2260             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2261             88  PAY-BI-WEEKLY                VALUE '3'.
  2262             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2263         16  CM-LOAN-NUMBER                PIC X(8).
  2264         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2265         16  CM-OLD-LOF                    PIC XXX.
  2266*        16  CM-LOAN-OFFICER               PIC XXX.
  2267         16  CM-REIN-TABLE                 PIC XXX.
  2268         16  CM-SPECIAL-REIN-CODE          PIC X.
  2269         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2270         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2271         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2272
  2273     12  CM-STATUS-DATA.
  2274         16  CM-ENTRY-STATUS               PIC X.
  2275         16  CM-ENTRY-DT                   PIC XX.
  2276
  2277         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2278         16  CM-LF-CANCEL-DT               PIC XX.
  2279         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2280
  2281         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2282         16  CM-LF-DEATH-DT                PIC XX.
  2283         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2284
  2285         16  CM-LF-CURRENT-STATUS          PIC X.
  2286             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2287                                                'M' '4' '5' '9'.
  2288             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2289             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2290             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2291             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2292             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2293             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2294             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2295             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  44
* EL050.cbl
  2296             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2297             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2298             88  CM-LF-DECLINED               VALUE 'D'.
  2299             88  CM-LF-VOIDED                 VALUE 'V'.
  2300
  2301         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2302         16  CM-AH-CANCEL-DT               PIC XX.
  2303         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2304
  2305         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2306         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2307         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2308
  2309         16  CM-AH-CURRENT-STATUS          PIC X.
  2310             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2311                                                'M' '4' '5' '9'.
  2312             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2313             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2314             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2315             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2316             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2317             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2318             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2319             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2320             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2321             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2322             88  CM-AH-DECLINED               VALUE 'D'.
  2323             88  CM-AH-VOIDED                 VALUE 'V'.
  2324
  2325         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2326             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2327             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2328             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2329         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2330
  2331         16  CM-ENTRY-BATCH                PIC X(6).
  2332         16  CM-LF-EXIT-BATCH              PIC X(6).
  2333         16  CM-AH-EXIT-BATCH              PIC X(6).
  2334         16  CM-LAST-MONTH-END             PIC XX.
  2335
  2336     12  CM-NOTE-SW                        PIC X.
  2337         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2338         88  CERT-NOTES-PRESENT               VALUE '1'.
  2339         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2340         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2341         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2342         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2343         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2344         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2345     12  CM-COMP-EXCP-SW                   PIC X.
  2346         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2347         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2348     12  CM-INSURED-ADDRESS-SW             PIC X.
  2349         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2350         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2351
  2352*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2353     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  45
* EL050.cbl
  2354     12  FILLER                            PIC X.
  2355
  2356*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2357     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2358     12  FILLER                            PIC X.
  2359*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2360     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2361
  2362     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2363         88  CERT-ADDED-BATCH                 VALUE ' '.
  2364         88  CERT-ADDED-ONLINE                VALUE '1'.
  2365         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2366         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2367         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2368     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2369         88  CERT-AS-LOADED                   VALUE ' '.
  2370         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2371         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2372         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2373         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2374         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2375         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2376         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2377
  2378     12  CM-ACCOUNT-COMM-PCTS.
  2379         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2380         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2381
  2382     12  CM-USER-FIELD                     PIC X.
  2383     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2384     12  CM-CLP-STATE                      PIC XX.
  2385     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2386     12  CM-USER-RESERVED                  PIC XXX.
  2387     12  FILLER REDEFINES CM-USER-RESERVED.
  2388         16  CM-AH-CLASS-CD                PIC XX.
  2389         16  F                             PIC X.
  2390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  46
* EL050.cbl
  2392*    COPY ERCMAIL.
  2393******************************************************************
  2394*                                                                *
  2395*                                                                *
  2396*                            ERCMAIL                             *
  2397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2398*                            VMOD=2.003                          *
  2399*                                                                *
  2400*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2401*                                                                *
  2402*   FILE TYPE = VSAM,KSDS                                        *
  2403*   RECORD SIZE = 374   RECFORM = FIX                            *
  2404*                                                                *
  2405*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2406*   ALTERNATE PATH    = NOT USED                                 *
  2407*                                                                *
  2408*   LOG = YES                                                    *
  2409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2410******************************************************************
  2411*                   C H A N G E   L O G
  2412*
  2413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2414*-----------------------------------------------------------------
  2415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2416* EFFECTIVE    NUMBER
  2417*-----------------------------------------------------------------
  2418* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2419* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2420* 111108                   PEMA  ADD CRED BENE ADDR2
  2421******************************************************************
  2422
  2423 01  MAILING-DATA.
  2424     12  MA-RECORD-ID                      PIC XX.
  2425         88  VALID-MA-ID                       VALUE 'MA'.
  2426
  2427     12  MA-CONTROL-PRIMARY.
  2428         16  MA-COMPANY-CD                 PIC X.
  2429         16  MA-CARRIER                    PIC X.
  2430         16  MA-GROUPING.
  2431             20  MA-GROUPING-PREFIX        PIC XXX.
  2432             20  MA-GROUPING-PRIME         PIC XXX.
  2433         16  MA-STATE                      PIC XX.
  2434         16  MA-ACCOUNT.
  2435             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2436             20  MA-ACCOUNT-PRIME          PIC X(6).
  2437         16  MA-CERT-EFF-DT                PIC XX.
  2438         16  MA-CERT-NO.
  2439             20  MA-CERT-PRIME             PIC X(10).
  2440             20  MA-CERT-SFX               PIC X.
  2441
  2442     12  FILLER                            PIC XX.
  2443
  2444     12  MA-ACCESS-CONTROL.
  2445         16  MA-SOURCE-SYSTEM              PIC XX.
  2446             88  MA-FROM-CREDIT                VALUE 'CR'.
  2447             88  MA-FROM-VSI                   VALUE 'VS'.
  2448             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2449             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  47
* EL050.cbl
  2450         16  MA-RECORD-ADD-DT              PIC XX.
  2451         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2452         16  MA-LAST-MAINT-DT              PIC XX.
  2453         16  MA-LAST-MAINT-BY              PIC XXXX.
  2454         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2455
  2456     12  MA-PROFILE-INFO.
  2457         16  MA-QUALIFY-CODE-1             PIC XX.
  2458         16  MA-QUALIFY-CODE-2             PIC XX.
  2459         16  MA-QUALIFY-CODE-3             PIC XX.
  2460         16  MA-QUALIFY-CODE-4             PIC XX.
  2461         16  MA-QUALIFY-CODE-5             PIC XX.
  2462
  2463         16  MA-INSURED-LAST-NAME          PIC X(15).
  2464         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2465         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2466         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2467         16  MA-INSURED-BIRTH-DT           PIC XX.
  2468         16  MA-INSURED-SEX                PIC X.
  2469             88  MA-SEX-MALE                   VALUE 'M'.
  2470             88  MA-SEX-FEMALE                 VALUE 'F'.
  2471         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2472
  2473         16  MA-ADDRESS-CORRECTED          PIC X.
  2474         16  MA-JOINT-BIRTH-DT             PIC XX.
  2475*        16  FILLER                        PIC X(12).
  2476
  2477         16  MA-ADDRESS-LINE-1             PIC X(30).
  2478         16  MA-ADDRESS-LINE-2             PIC X(30).
  2479         16  MA-CITY-STATE.
  2480             20  MA-CITY                   PIC X(28).
  2481             20  MA-ADDR-STATE             PIC XX.
  2482         16  MA-ZIP.
  2483             20  MA-ZIP-CODE.
  2484                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2485                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2486                 24  FILLER                PIC X(4).
  2487             20  MA-ZIP-PLUS4              PIC X(4).
  2488         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2489             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2490             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2491             20  FILLER                    PIC X(3).
  2492
  2493         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2494
  2495         16  FILLER                        PIC XXX.
  2496*        16  FILLER                        PIC X(10).
  2497
  2498     12  MA-CRED-BENE-INFO.
  2499         16  MA-CRED-BENE-NAME                 PIC X(25).
  2500         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2501         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2502         16  MA-CRED-BENE-CTYST.
  2503             20  MA-CRED-BENE-CITY             PIC X(28).
  2504             20  MA-CRED-BENE-STATE            PIC XX.
  2505         16  MA-CRED-BENE-ZIP.
  2506             20  MA-CB-ZIP-CODE.
  2507                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  48
* EL050.cbl
  2508                     88  MA-CB-CANADIAN-POST-CODE
  2509                                           VALUE 'A' THRU 'Z'.
  2510                 24  FILLER                    PIC X(4).
  2511             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2512         16  MA-CB-CANADIAN-POSTAL-CODE
  2513                            REDEFINES MA-CRED-BENE-ZIP.
  2514             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2515             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2516             20  FILLER                        PIC X(3).
  2517     12  MA-POST-CARD-MAIL-DATA.
  2518         16  MA-MAIL-DATA OCCURS 7.
  2519             20  MA-MAIL-TYPE              PIC X.
  2520                 88  MA-12MO-MAILING           VALUE '1'.
  2521                 88  MA-EXP-MAILING            VALUE '2'.
  2522             20  MA-MAIL-STATUS            PIC X.
  2523                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2524                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2525                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2526             20  MA-MAIL-DATE              PIC XX.
  2527     12  FILLER                            PIC XX.
  2528     12  FILLER                            PIC XX.
  2529*    12  FILLER                            PIC X(30).
  2530******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  49
* EL050.cbl
  2532*    COPY ERCPNDM.
  2533******************************************************************
  2534*                                                                *
  2535*                                                                *
  2536*                            ERCPNDM                             *
  2537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2538*                            VMOD=2.003                          *
  2539*                                                                *
  2540*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2541*                                                                *
  2542*   FILE TYPE = VSAM,KSDS                                        *
  2543*   RECORD SIZE = 374   RECFORM = FIX                            *
  2544*                                                                *
  2545*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2546*   ALTERNATE PATH    = NOT USED                                 *
  2547*                                                                *
  2548*   LOG = YES                                                    *
  2549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2550******************************************************************
  2551*                   C H A N G E   L O G
  2552*
  2553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2554*-----------------------------------------------------------------
  2555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2556* EFFECTIVE    NUMBER
  2557*-----------------------------------------------------------------
  2558* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2559* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2560* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2561******************************************************************
  2562
  2563 01  PENDING-MAILING-DATA.
  2564     12  PM-RECORD-ID                      PIC XX.
  2565         88  VALID-MA-ID                       VALUE 'PM'.
  2566
  2567     12  PM-CONTROL-PRIMARY.
  2568         16  PM-COMPANY-CD                 PIC X.
  2569         16  PM-ENTRY-BATCH                PIC X(6).
  2570         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2571         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2572
  2573     12  FILLER                            PIC X(14).
  2574
  2575     12  PM-ACCESS-CONTROL.
  2576         16  PM-SOURCE-SYSTEM              PIC XX.
  2577             88  PM-FROM-CREDIT                VALUE 'CR'.
  2578             88  PM-FROM-VSI                   VALUE 'VS'.
  2579             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2580             88  PM-FROM-OTHER                 VALUE 'OT'.
  2581         16  PM-RECORD-ADD-DT              PIC XX.
  2582         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2583         16  PM-LAST-MAINT-DT              PIC XX.
  2584         16  PM-LAST-MAINT-BY              PIC XXXX.
  2585         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2586
  2587     12  PM-PROFILE-INFO.
  2588         16  PM-QUALIFY-CODE-1             PIC XX.
  2589         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  50
* EL050.cbl
  2590         16  PM-QUALIFY-CODE-3             PIC XX.
  2591         16  PM-QUALIFY-CODE-4             PIC XX.
  2592         16  PM-QUALIFY-CODE-5             PIC XX.
  2593
  2594         16  PM-INSURED-LAST-NAME          PIC X(15).
  2595         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2596         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2597         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2598         16  PM-INSURED-BIRTH-DT           PIC XX.
  2599         16  PM-INSURED-SEX                PIC X.
  2600             88  PM-SEX-MALE                   VALUE 'M'.
  2601             88  PM-SEX-FEMALE                 VALUE 'F'.
  2602         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2603
  2604         16  PM-ADDRESS-CORRECTED          PIC X.
  2605         16  PM-JOINT-BIRTH-DT             PIC XX.
  2606*        16  FILLER                        PIC X(12).
  2607
  2608         16  PM-ADDRESS-LINE-1             PIC X(30).
  2609         16  PM-ADDRESS-LINE-2             PIC X(30).
  2610         16  PM-CITY-STATE.
  2611             20  PM-CITY                   PIC X(28).
  2612             20  PM-STATE                  PIC XX.
  2613         16  PM-ZIP.
  2614             20  PM-ZIP-CODE.
  2615                 24  PM-ZIP-1              PIC X.
  2616                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2617                 24  FILLER                PIC X(4).
  2618             20  PM-ZIP-PLUS4              PIC X(4).
  2619         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2620             20  PM-CAN-POST1              PIC XXX.
  2621             20  PM-CAN-POST2              PIC XXX.
  2622             20  FILLER                    PIC XXX.
  2623
  2624         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2625
  2626         16  FILLER                        PIC X(03).
  2627
  2628     12  PM-CRED-BENE-INFO.
  2629         16  PM-CRED-BENE-NAME             PIC X(25).
  2630         16  PM-CRED-BENE-ADDR             PIC X(30).
  2631         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2632         16  PM-CRED-BENE-CTYST.
  2633             20  PM-CRED-BENE-CITY         PIC X(28).
  2634             20  PM-CRED-BENE-STATE        PIC XX.
  2635         16  PM-CRED-BENE-ZIP.
  2636             20  PM-CB-ZIP-CODE.
  2637                 24  PM-CB-ZIP-1           PIC X.
  2638                     88  PM-CB-CANADIAN-POST-CODE
  2639                                  VALUE 'A' THRU 'Z'.
  2640                 24  FILLER                PIC X(4).
  2641             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2642         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2643             20  PM-CB-CAN-POST1           PIC XXX.
  2644             20  PM-CB-CAN-POST2           PIC XXX.
  2645             20  FILLER                    PIC XXX.
  2646     12  PM-POST-CARD-MAIL-DATA.
  2647         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  51
* EL050.cbl
  2648             20  PM-MAIL-TYPE              PIC X.
  2649                 88  PM-12MO-MAILING           VALUE '1'.
  2650                 88  PM-EXP-MAILING            VALUE '2'.
  2651             20  PM-MAIL-STATUS            PIC X.
  2652                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2653                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2654                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2655             20  PM-MAIL-DATE              PIC XX.
  2656     12  FILLER                            PIC XX.
  2657     12  FILLER                            PIC X(12).
  2658*    12  FILLER                            PIC X(30).
  2659
  2660******************************************************************
  2661*                                COPY ERCLOFC.
  2662******************************************************************
  2663*                                                                *
  2664*                                                                *
  2665*                            ERCLOFC                             *
  2666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2667*                            VMOD=2.003                          *
  2668*                                                                *
  2669*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2670*                                                                *
  2671*   FILE TYPE = VSAM,KSDS                                        *
  2672*   RECORD SIZE = 670   RECFORM = FIX                            *
  2673*                                                                *
  2674*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2675*                                                                *
  2676*   LOG = YES                                                    *
  2677*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2678*                                                                *
  2679******************************************************************
  2680
  2681 01  LOAN-OFFICER-MASTER.
  2682     12  LO-RECORD-ID                PIC XX.
  2683         88  VALID-LO-ID                VALUE 'LO'.
  2684
  2685     12  LO-CONTROL-PRIMARY.
  2686         16  LO-COMPANY-CD           PIC X.
  2687         16  LO-CARRIER              PIC X.
  2688         16  LO-GROUPING.
  2689             20  LO-GROUPING-PREFIX  PIC XXX.
  2690             20  LO-GROUPING-PRIME   PIC XXX.
  2691         16  LO-STATE                PIC XX.
  2692         16  LO-ACCOUNT.
  2693             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2694             20  LO-ACCOUNT-PRIME    PIC X(6).
  2695         16  LO-OFFICER-CODE         PIC X(5).
  2696
  2697     12  LO-OFFICER-NAME             PIC X(30).
  2698
  2699     12  LO-LAST-MAINT-DT            PIC XX.
  2700     12  LO-LAST-USER                PIC X(4).
  2701     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2702
  2703     12  LO-COMP-CONTROL             PIC X.
  2704             88  LO-SHOW-COMP           VALUE 'Y'.
  2705             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  52
* EL050.cbl
  2706     12  LO-DETAIL-CONTROL           PIC X.
  2707             88  LO-PRINT-DETAIL        VALUE 'D'.
  2708             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2709
  2710     12  LO-SV-CARRIER               PIC X.
  2711     12  LO-SV-GROUPING              PIC X(6).
  2712     12  LO-SV-STATE                 PIC XX.
  2713
  2714     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2715     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2716
  2717     12  LO-OFFICER-INFO.
  2718         16  FILLER OCCURS 12 TIMES.
  2719             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2720             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2721             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2722             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2723             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2724             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2725             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2726             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2727     12  FILLER                      PIC X(198).
  2728******************************************************************
  2729*                                COPY ERCPDEF.
  2730******************************************************************
  2731*                                                                *
  2732*                                                                *
  2733*                            ERCPDEF.                            *
  2734*                                                                *
  2735*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2736*                                                                *
  2737*    FILE TYPE = VSAM,KSDS                                       *
  2738*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2739*                                                                *
  2740*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2741*                                                                *
  2742*    LOG = YES                                                   *
  2743*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2744******************************************************************
  2745 01  PRODUCT-MASTER.
  2746    12  PD-RECORD-ID                 PIC X(02).
  2747        88  VALID-PD-ID                  VALUE 'PD'.
  2748    12  PD-CONTROL-PRIMARY.
  2749        16  PD-COMPANY-CD            PIC X.
  2750        16  PD-STATE                 PIC XX.
  2751        16  PD-PRODUCT-CD            PIC XXX.
  2752        16  PD-FILLER                PIC X(7).
  2753        16  PD-BEN-TYPE              PIC X.
  2754        16  PD-BEN-CODE              PIC XX.
  2755        16  PD-PROD-EXP-DT           PIC XX.
  2756    12  FILLER                       PIC X(50).
  2757    12  PD-PRODUCT-DATA OCCURS 8.
  2758        16  PD-PROD-CODE             PIC X.
  2759            88  PD-PROD-LIFE           VALUE 'L'.
  2760            88  PD-PROD-PROP           VALUE 'P'.
  2761            88  PD-PROD-AH             VALUE 'A'.
  2762            88  PD-PROD-IU             VALUE 'I'.
  2763            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  53
* EL050.cbl
  2764        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2765        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2766        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2767        16  PD-MAX-TERM              PIC S999        COMP-3.
  2768        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2769        16  FILLER                   PIC X.
  2770        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2771        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2772        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2773        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2774        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2775        16  PD-REC-CRIT-PERIOD       PIC X.
  2776        16  PD-RTW-MOS               PIC 99.
  2777        16  FILLER                   PIC X(5).
  2778    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2779    12  PD-TERM-LIMITS OCCURS 15.
  2780        16  PD-LOW-TERM              PIC S999        COMP-3.
  2781        16  PD-HI-TERM               PIC S999        COMP-3.
  2782*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2783    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2784        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2785        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2786    12  PD-EARN-FACTORS.
  2787        16  FILLER OCCURS 15.
  2788            20  FILLER OCCURS 15.
  2789                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2790    12  PD-PRODUCT-DESC              PIC X(80).
  2791    12  PD-TRUNCATED                 PIC X.
  2792    12  FILLER                       PIC X(59).
  2793    12  PD-MAINT-INFORMATION.
  2794        16  PD-LAST-MAINT-DT         PIC X(02).
  2795        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2796        16  PD-LAST-MAINT-BY         PIC X(04).
  2797*                                COPY ELCSTATE.
  2798******************************************************************
  2799*                                                                *
  2800*                                                                *
  2801*                            ELCSTATE.                           *
  2802*                                                                *
  2803*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2804*                                                                *
  2805*   FILE TYPE = VSAM,KSDS                                        *
  2806*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2807*                                                                *
  2808*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2809*       ALTERNATE INDEX = NONE                                   *
  2810*                                                                *
  2811*   LOG = YES                                                    *
  2812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2813******************************************************************
  2814*                   C H A N G E   L O G
  2815*
  2816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2817*-----------------------------------------------------------------
  2818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2819* EFFECTIVE    NUMBER
  2820*-----------------------------------------------------------------
  2821* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  54
* EL050.cbl
  2822******************************************************************
  2823*
  2824 01  STATE-FILE.
  2825     12  SF-RECORD-ID                       PIC XX.
  2826         88  VALID-CF-ID                        VALUE 'SF'.
  2827     12  SF-CONTROL-PRIMARY.
  2828         16  SF-COMPANY-ID                  PIC XXX.
  2829         16  SF-CARRIER-CODE                PIC X.
  2830         16  SF-GROUPING                    PIC X(6).
  2831         16  SF-STATE-CODE                  PIC XX.
  2832         16  SF-EXPIRE-DATE                 PIC 9(8).
  2833****************************************************************
  2834*             STATE CONTROLS
  2835****************************************************************
  2836     12  SF-LAST-MAINT-DT                   PIC XX.
  2837     12  SF-LAST-MAINT-BY                   PIC X(4).
  2838     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2839     12  SF-STATE-RT-CONTROLS.
  2840         16  SF-ST-RT-CALC                  PIC X.
  2841     12  SF-ST-TAX-CONTROLS.
  2842         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2843         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2844         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2845     12  SF-ST-REFUND-OPTIONS.
  2846         16  SF-ST-RF-LR-CALC               PIC X.
  2847         16  SF-ST-RF-LL-CALC               PIC X.
  2848         16  SF-ST-RF-LN-CALC               PIC X.
  2849         16  SF-ST-RF-AH-CALC               PIC X.
  2850         16  SF-ST-RF-CP-CALC               PIC X.
  2851     12  SF-ST-UNEARN-PREM-OPTIONS.
  2852         16  SF-ST-LUEP-R78                 PIC X.
  2853         16  SF-ST-LUEP-PRO                 PIC X.
  2854         16  SF-ST-LUEP-ST                  PIC X.
  2855         16  SF-ST-LUEP-DOM                 PIC X.
  2856         16  SF-ST-AUEP-R78                 PIC X.
  2857         16  SF-ST-AUEP-PRO                 PIC X.
  2858         16  SF-ST-AUEP-ST                  PIC X.
  2859         16  SF-ST-AUEP-DOM                 PIC X.
  2860         16  SF-ST-CUEP-R78                 PIC X.
  2861         16  SF-ST-CUEP-PRO                 PIC X.
  2862         16  SF-ST-CUEP-ST                  PIC X.
  2863         16  SF-ST-CUEP-DOM                 PIC X.
  2864     12  SF-ST-EARN-PREM-OPTIONS.
  2865         16  SF-ST-LEP-R78                  PIC X.
  2866         16  SF-ST-LEP-PRO                  PIC X.
  2867         16  SF-ST-LEP-ST                   PIC X.
  2868         16  SF-ST-LEP-DOM                  PIC X.
  2869         16  SF-ST-AEP-R78                  PIC X.
  2870         16  SF-ST-AEP-PRO                  PIC X.
  2871         16  SF-ST-AEP-ST                   PIC X.
  2872         16  SF-ST-AEP-DOM                  PIC X.
  2873         16  SF-ST-CEP-R78                  PIC X.
  2874         16  SF-ST-CEP-PRO                  PIC X.
  2875         16  SF-ST-CEP-ST                   PIC X.
  2876         16  SF-ST-CEP-DOM                  PIC X.
  2877     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  55
* EL050.cbl
  2879*    COPY ELCCRTT.
  2880******************************************************************
  2881*                                                                *
  2882*                            ELCCRTT.                            *
  2883*                                                                *
  2884*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2885*                                                                *
  2886*   FILE TYPE = VSAM,KSDS                                        *
  2887*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2888*                                                                *
  2889*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2890*                                                                *
  2891*   LOG = YES                                                    *
  2892*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2893******************************************************************
  2894*                   C H A N G E   L O G
  2895*
  2896* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2897*-----------------------------------------------------------------
  2898*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2899* EFFECTIVE    NUMBER
  2900*-----------------------------------------------------------------
  2901* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2902* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2903* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2904* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2905* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2906******************************************************************
  2907
  2908 01  CERTIFICATE-TRAILERS.
  2909     12  CS-RECORD-ID                      PIC XX.
  2910         88  VALID-CS-ID                      VALUE 'CS'.
  2911
  2912     12  CS-CONTROL-PRIMARY.
  2913         16  CS-COMPANY-CD                 PIC X.
  2914         16  CS-CARRIER                    PIC X.
  2915         16  CS-GROUPING                   PIC X(6).
  2916         16  CS-STATE                      PIC XX.
  2917         16  CS-ACCOUNT                    PIC X(10).
  2918         16  CS-CERT-EFF-DT                PIC XX.
  2919         16  CS-CERT-NO.
  2920             20  CS-CERT-PRIME             PIC X(10).
  2921             20  CS-CERT-SFX               PIC X.
  2922         16  CS-TRAILER-TYPE               PIC X.
  2923             88  COMM-TRLR           VALUE 'A'.
  2924             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2925             88  CERT-DATA-TRLR      VALUE 'C'.
  2926
  2927     12  CS-DATA-AREA                      PIC X(516).
  2928
  2929     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2930         16  CS-BANK-COMMISSION-AREA.
  2931             20  CS-BANK-COMMS       OCCURS 10.
  2932                 24  CS-AGT                PIC X(10).
  2933                 24  CS-COM-TYP            PIC X.
  2934                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2935                 24  CS-RECALC-LV-INDIC    PIC X.
  2936                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  56
* EL050.cbl
  2937         16  FILLER                        PIC X(256).
  2938
  2939     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2940****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2941****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2942         16  CS-MB-CLAIM-DATA OCCURS 2.
  2943             20  FILLER OCCURS 10.
  2944                 24  CS-CLAIM-TYPE         PIC X.
  2945                     88  CS-AH-CLM           VALUE 'A'.
  2946                     88  CS-IU-CLM           VALUE 'I'.
  2947                     88  CS-GP-CLM           VALUE 'G'.
  2948                     88  CS-LF-CLM           VALUE 'L'.
  2949                     88  CS-PR-CLM           VALUE 'P'.
  2950                 24  CS-BANK               PIC S999 COMP-3.
  2951                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2952                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2953                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2954         16  FILLER                        PIC X(216).
  2955     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2956         16  CS-VIN-NUMBER                 PIC X(17).
  2957         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2958         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2959         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2960         16  FILLER                        PIC X(496).
  2961******************************************************************
  2962*    COPY ELCCRTO.
  2963******************************************************************
  2964*                                                                *
  2965*                            ELCCRTO.                            *
  2966*                                                                *
  2967*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2968*                                                                *
  2969*   FILE TYPE = VSAM,KSDS                                        *
  2970*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2971*                                                                *
  2972*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2973*                                                                *
  2974*   LOG = YES                                                    *
  2975*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2976******************************************************************
  2977*                   C H A N G E   L O G
  2978*
  2979* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2980*-----------------------------------------------------------------
  2981*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2982* EFFECTIVE    NUMBER
  2983*-----------------------------------------------------------------
  2984* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2985* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2986* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2987* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2988* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2989******************************************************************
  2990 01  ORIGINAL-CERTIFICATE.
  2991     12  OC-RECORD-ID                      PIC XX.
  2992         88  VALID-OC-ID                      VALUE 'OC'.
  2993     12  OC-CONTROL-PRIMARY.
  2994         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  57
* EL050.cbl
  2995         16  OC-CARRIER                    PIC X.
  2996         16  OC-GROUPING                   PIC X(6).
  2997         16  OC-STATE                      PIC XX.
  2998         16  OC-ACCOUNT                    PIC X(10).
  2999         16  OC-CERT-EFF-DT                PIC XX.
  3000         16  OC-CERT-NO.
  3001             20  OC-CERT-PRIME             PIC X(10).
  3002             20  OC-CERT-SFX               PIC X.
  3003         16  OC-RECORD-TYPE                PIC X.
  3004         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3005     12  OC-LAST-MAINT-DT                  PIC XX.
  3006     12  OC-LAST-MAINT-BY                  PIC X(4).
  3007     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3008     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3009     12  FILLER                            PIC X(49).
  3010     12  OC-ORIG-REC.
  3011         16  OC-INS-LAST-NAME              PIC X(15).
  3012         16  OC-INS-FIRST-NAME             PIC X(10).
  3013         16  OC-INS-MIDDLE-INIT            PIC X.
  3014         16  OC-INS-AGE                    PIC S999     COMP-3.
  3015         16  OC-JNT-LAST-NAME              PIC X(15).
  3016         16  OC-JNT-FIRST-NAME             PIC X(10).
  3017         16  OC-JNT-MIDDLE-INIT            PIC X.
  3018         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3019         16  OC-LF-BENCD                   PIC XX.
  3020         16  OC-LF-TERM                    PIC S999      COMP-3.
  3021         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3022         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3023         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3024         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3025         16  OC-LF-EXP-DT                  PIC XX.
  3026         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3027         16  OC-LF-CANCEL-DT               PIC XX.
  3028         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3029         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3030         16  OC-AH-BENCD                   PIC XX.
  3031         16  OC-AH-TERM                    PIC S999      COMP-3.
  3032         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3033         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3034         16  OC-AH-EXP-DT                  PIC XX.
  3035         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3036         16  OC-AH-CP                      PIC 99.
  3037         16  OC-AH-CANCEL-DT               PIC XX.
  3038         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3039         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3040         16  OC-CRED-BENE-NAME             PIC X(25).
  3041         16  OC-1ST-PMT-DT                 PIC XX.
  3042         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3043         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3044         16  OC-ISSUE-TRAN-IND             PIC X.
  3045         16  OC-CANCEL-TRAN-IND            PIC X.
  3046         16  FILLER                        PIC X(211).
  3047
  3048     12  FILLER                            PIC X(50).
  3049******************************************************************
  3050
  3051*    COPY ELCDATE.
  3052******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  58
* EL050.cbl
  3053*                                                                *
  3054*                                                                *
  3055*                            ELCDATE.                            *
  3056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3057*                            VMOD=2.003
  3058*                                                                *
  3059*                                                                *
  3060*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3061*                 LENGTH = 200                                   *
  3062******************************************************************
  3063
  3064 01  DATE-CONVERSION-DATA.
  3065     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3066     12  DC-OPTION-CODE                PIC X.
  3067         88  BIN-TO-GREG                VALUE ' '.
  3068         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3069         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3070         88  YMD-GREG-TO-BIN            VALUE '3'.
  3071         88  MDY-GREG-TO-BIN            VALUE '4'.
  3072         88  JULIAN-TO-BIN              VALUE '5'.
  3073         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3074         88  FIND-CENTURY               VALUE '7'.
  3075         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3076         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3077         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3078         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3079         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3080         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3081         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3082         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3083         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3084         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3085         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3086         88  BIN-3-TO-GREG              VALUE 'I'.
  3087         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3088         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3089         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3090         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3091         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3092         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3093         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3094         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3095         88  THREE-CHARACTER-BIN
  3096                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3097         88  GREGORIAN-TO-BIN
  3098                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3099         88  BIN-TO-GREGORIAN
  3100                  VALUES ' ' '1' 'I' '8' 'G'.
  3101         88  JULIAN-TO-BINARY
  3102                  VALUES '5' 'C' 'E' 'F'.
  3103     12  DC-ERROR-CODE                 PIC X.
  3104         88  NO-CONVERSION-ERROR        VALUE ' '.
  3105         88  DATE-CONVERSION-ERROR
  3106                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3107         88  DATE-IS-ZERO               VALUE '1'.
  3108         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3109         88  DATE-IS-INVALID            VALUE '3'.
  3110         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  59
* EL050.cbl
  3111         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3112         88  DATE-INVALID-OPTION        VALUE '9'.
  3113         88  INVALID-CENTURY            VALUE 'A'.
  3114         88  ONLY-CENTURY               VALUE 'B'.
  3115         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3116         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3117     12  DC-END-OF-MONTH               PIC X.
  3118         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3119     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3120         88  USE-NORMAL-PROCESS         VALUE ' '.
  3121         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3122         88  ADJUST-UP-100-YRS          VALUE '2'.
  3123     12  FILLER                        PIC X.
  3124     12  DC-CONVERSION-DATES.
  3125         16  DC-BIN-DATE-1             PIC XX.
  3126         16  DC-BIN-DATE-2             PIC XX.
  3127         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3128         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3129                       DC-GREG-DATE-1-EDIT.
  3130             20  DC-EDIT1-MONTH        PIC 99.
  3131             20  SLASH1-1              PIC X.
  3132             20  DC-EDIT1-DAY          PIC 99.
  3133             20  SLASH1-2              PIC X.
  3134             20  DC-EDIT1-YEAR         PIC 99.
  3135         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3136         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3137                     DC-GREG-DATE-2-EDIT.
  3138             20  DC-EDIT2-MONTH        PIC 99.
  3139             20  SLASH2-1              PIC X.
  3140             20  DC-EDIT2-DAY          PIC 99.
  3141             20  SLASH2-2              PIC X.
  3142             20  DC-EDIT2-YEAR         PIC 99.
  3143         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3144         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3145                     DC-GREG-DATE-1-YMD.
  3146             20  DC-YMD-YEAR           PIC 99.
  3147             20  DC-YMD-MONTH          PIC 99.
  3148             20  DC-YMD-DAY            PIC 99.
  3149         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3150         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3151                      DC-GREG-DATE-1-MDY.
  3152             20  DC-MDY-MONTH          PIC 99.
  3153             20  DC-MDY-DAY            PIC 99.
  3154             20  DC-MDY-YEAR           PIC 99.
  3155         16  DC-GREG-DATE-1-ALPHA.
  3156             20  DC-ALPHA-MONTH        PIC X(10).
  3157             20  DC-ALPHA-DAY          PIC 99.
  3158             20  FILLER                PIC XX.
  3159             20  DC-ALPHA-CENTURY.
  3160                 24 DC-ALPHA-CEN-N     PIC 99.
  3161             20  DC-ALPHA-YEAR         PIC 99.
  3162         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3163         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3164         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3165         16  DC-JULIAN-DATE            PIC 9(05).
  3166         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3167                                       PIC 9(05).
  3168         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  60
* EL050.cbl
  3169             20  DC-JULIAN-YEAR        PIC 99.
  3170             20  DC-JULIAN-DAYS        PIC 999.
  3171         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3172         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3173         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3174     12  DATE-CONVERSION-VARIBLES.
  3175         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3176         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3177             20  FILLER                PIC 9(3).
  3178             20  HOLD-CEN-1-CCYY.
  3179                 24  HOLD-CEN-1-CC     PIC 99.
  3180                 24  HOLD-CEN-1-YY     PIC 99.
  3181             20  HOLD-CEN-1-MO         PIC 99.
  3182             20  HOLD-CEN-1-DA         PIC 99.
  3183         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3184             20  HOLD-CEN-1-R-MO       PIC 99.
  3185             20  HOLD-CEN-1-R-DA       PIC 99.
  3186             20  HOLD-CEN-1-R-CCYY.
  3187                 24  HOLD-CEN-1-R-CC   PIC 99.
  3188                 24  HOLD-CEN-1-R-YY   PIC 99.
  3189             20  FILLER                PIC 9(3).
  3190         16  HOLD-CENTURY-1-X.
  3191             20  FILLER                PIC X(3)  VALUE SPACES.
  3192             20  HOLD-CEN-1-X-CCYY.
  3193                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3194                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3195             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3196             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3197         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3198             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3199             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3200             20  HOLD-CEN-1-R-X-CCYY.
  3201                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3202                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3203             20  FILLER                PIC XXX.
  3204         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3205         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3206         16  DC-JULIAN-DATE-1          PIC 9(07).
  3207         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3208             20  DC-JULIAN-1-CCYY.
  3209                 24  DC-JULIAN-1-CC    PIC 99.
  3210                 24  DC-JULIAN-1-YR    PIC 99.
  3211             20  DC-JULIAN-DA-1        PIC 999.
  3212         16  DC-JULIAN-DATE-2          PIC 9(07).
  3213         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3214             20  DC-JULIAN-2-CCYY.
  3215                 24  DC-JULIAN-2-CC    PIC 99.
  3216                 24  DC-JULIAN-2-YR    PIC 99.
  3217             20  DC-JULIAN-DA-2        PIC 999.
  3218         16  DC-GREG-DATE-A-EDIT.
  3219             20  DC-EDITA-MONTH        PIC 99.
  3220             20  SLASHA-1              PIC X VALUE '/'.
  3221             20  DC-EDITA-DAY          PIC 99.
  3222             20  SLASHA-2              PIC X VALUE '/'.
  3223             20  DC-EDITA-CCYY.
  3224                 24  DC-EDITA-CENT     PIC 99.
  3225                 24  DC-EDITA-YEAR     PIC 99.
  3226         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  61
* EL050.cbl
  3227             20  DC-EDITB-MONTH        PIC 99.
  3228             20  SLASHB-1              PIC X VALUE '/'.
  3229             20  DC-EDITB-DAY          PIC 99.
  3230             20  SLASHB-2              PIC X VALUE '/'.
  3231             20  DC-EDITB-CCYY.
  3232                 24  DC-EDITB-CENT     PIC 99.
  3233                 24  DC-EDITB-YEAR     PIC 99.
  3234         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3235         16  DC-GREG-DATE-CYMD-R REDEFINES
  3236                              DC-GREG-DATE-CYMD.
  3237             20  DC-CYMD-CEN           PIC 99.
  3238             20  DC-CYMD-YEAR          PIC 99.
  3239             20  DC-CYMD-MONTH         PIC 99.
  3240             20  DC-CYMD-DAY           PIC 99.
  3241         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3242         16  DC-GREG-DATE-MDCY-R REDEFINES
  3243                              DC-GREG-DATE-MDCY.
  3244             20  DC-MDCY-MONTH         PIC 99.
  3245             20  DC-MDCY-DAY           PIC 99.
  3246             20  DC-MDCY-CEN           PIC 99.
  3247             20  DC-MDCY-YEAR          PIC 99.
  3248    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3249        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3250    12  DC-EL310-DATE                  PIC X(21).
  3251    12  FILLER                         PIC X(28).
  3252
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  62
* EL050.cbl
  3254*    COPY ELCCALC.
  3255******************************************************************
  3256*                                                                *
  3257*                           ELCCALC.                            *
  3258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3259*                            VMOD=2.025                          *
  3260*                                                                *
  3261*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3262*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3263*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3264*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3265*                                                                *
  3266*  PASSED TO ELRTRM                                              *
  3267*  -----------------                                             *
  3268*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3269*  ORIGINAL TERM                                                 *
  3270*  BEGINNING DATE                                                *
  3271*  ENDING DATE                                                   *
  3272*  COMPANY I.D.                                                  *
  3273*  ACCOUNT MASTER USER FIELD                                     *
  3274*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3275*  FREE LOOK DAYS                                                *
  3276*                                                                *
  3277*  RETURNED FROM ELRTRM                                          *
  3278*  ---------------------                                         *
  3279*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3280*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3281*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3282*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3283*----------------------------------------------------------------*
  3284*  PASSED TO ELRAMT                                              *
  3285*  ----------------                                              *
  3286*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3287*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3288*  ORIGINAL AMOUNT                                               *
  3289*  ALTERNATE BENEFIT (BALLON)                                    *
  3290*  A.P.R. - NET PAY ONLY                                         *
  3291*  METHOD
  3292*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3293*  COMPANY I.D.                                                  *
  3294*  BENEFIT TYPE                                                  *
  3295*                                                                *
  3296*  RETURNED FROM ELRAMT                                          *
  3297*  --------------------                                          *
  3298*  REMAINING AMOUNT 1 - CURRENT                                  *
  3299*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3300*  REMAINING AMOUNT FACTOR
  3301*----------------------------------------------------------------*
  3302*  PASSED TO ELRESV                                              *
  3303*  -----------------                                             *
  3304*  CERTIFICATE EFFECTIVE DATE                                    *
  3305*  VALUATION DATE                                                *
  3306*  PAID THRU DATE                                                *
  3307*  BENEFIT                                                       *
  3308*  INCURRED DATE                                                 *
  3309*  REPORTED DATE                                                 *
  3310*  ISSUE AGE                                                     *
  3311*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  63
* EL050.cbl
  3312*  CDT PERCENT                                                   *
  3313*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3314* *CLAIM TYPE (LIFE, A/H)                                        *
  3315* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3316* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3317*                                                                *
  3318*  RETURNED FROM ELRESV                                          *
  3319*  --------------------                                          *
  3320*  CDT TABLE USED                                                *
  3321*  CDT FACTOR USED                                               *
  3322*  PAY TO CURRENT RESERVE                                        *
  3323*  I.B.N.R. - A/H ONLY                                           *
  3324*  FUTURE (ACCRUED) AH ONLY                                      *
  3325*----------------------------------------------------------------*
  3326*  PASSED TO ELRATE                                              *
  3327*  ----------------                                              *
  3328*  CERT ISSUE DATE                                               *
  3329*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3330*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3331*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3332*  STATE CODE (CLIENT DEFINED)                                   *
  3333*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3334*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3335*  DEVIATION CODE                                                *
  3336*  ISSUE AGE                                                     *
  3337*  ORIGINAL BENEFIT AMOUNT                                       *
  3338*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3339*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3340*  BENEFIT KIND (LIFE OR A/H)                                    *
  3341*  A.P.R.                                                        *
  3342*  METHOD
  3343*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3344*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3345*  COMPANY I.D. (3 CHARACTER)                                    *
  3346*  BENEFIT CODE                                                  *
  3347*  BENEFIT OVERRIDE CODE                                         *
  3348*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3349*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3350*  JOINT INDICATOR (CSL ONLY)                                    *
  3351*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3352*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3353*                                                                *
  3354*  RETURNED FROM ELRATE                                          *
  3355*  --------------------                                          *
  3356*  CALCULATED PREMIUM                                            *
  3357*  PREMIUM RATE                                                  *
  3358*  MORTALITY CODE                                                *
  3359*  MAX ATTAINED AGE                                              *
  3360*  MAX AGE                                                       *
  3361*  MAX TERM                                                      *
  3362*  MAX MONTHLY BENEFIT                                           *
  3363*  MAX TOTAL BENIFIT                                             *
  3364*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3365*----------------------------------------------------------------*
  3366*  PASSED TO ELRFND                                              *
  3367*  ----------------                                              *
  3368*  CERT ISSUE DATE                                               *
  3369*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  64
* EL050.cbl
  3370*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3371*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3372*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3373*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3374*  STATE CODE (CLIENT DEFINED)                                   *
  3375*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3376*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3377*  DEVIATION CODE                                                *
  3378*  ISSUE AGE                                                     *
  3379*  ORIGINAL BENEFIT AMOUNT                                       *
  3380*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3381*  PROCESS TYPE (CANCEL)                                         *
  3382*  BENEFIT KIND (LIFE OR A/H)                                    *
  3383*  A.P.R.                                                        *
  3384*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3385*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3386*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3387*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3388*  COMPANY I.D. (3 CHARACTER)                                    *
  3389*  BENEFIT CODE                                                  *
  3390*  BENEFIT OVERRIDE CODE                                         *
  3391*                                                                *
  3392*  RETURNED FROM ELRFND                                          *
  3393*  --------------------                                          *
  3394*  CALCULATED REFUND                                             *
  3395*----------------------------------------------------------------*
  3396*  PASSED TO ELEARN                                              *
  3397*  ----------------                                              *
  3398*  CERT ISSUE DATE                                               *
  3399*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3400*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3401*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3402*  STATE CODE (CLIENT DEFINED)                                   *
  3403*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3404*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3405*  DEVIATION CODE                                                *
  3406*  ISSUE AGE                                                     *
  3407*  ORIGINAL BENEFIT AMOUNT                                       *
  3408*  BENEFIT KIND (LIFE OR A/H)                                    *
  3409*  A.P.R.                                                        *
  3410*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3411*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3412*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3413*  COMPANY I.D. (3 CHARACTER)                                    *
  3414*  BENEFIT CODE                                                  *
  3415*  BENEFIT OVERRIDE CODE                                         *
  3416*                                                                *
  3417*  RETURNED FROM ELEARN                                          *
  3418*  --------------------                                          *
  3419*  INDICATED  EARNINGS                                           *
  3420*----------------------------------------------------------------*
  3421*                 LENGTH = 450                                   *
  3422*                                                                *
  3423******************************************************************
  3424******************************************************************
  3425*                   C H A N G E   L O G
  3426*
  3427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  65
* EL050.cbl
  3428*-----------------------------------------------------------------
  3429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3430* EFFECTIVE    NUMBER
  3431*-----------------------------------------------------------------
  3432* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3433* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3434* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3435* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3436* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3437* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3438* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3439* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3440* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3441******************************************************************
  3442
  3443 01  CALCULATION-PASS-AREA.
  3444     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3445                                     COMP.
  3446
  3447     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3448       88  NO-CP-ERROR                             VALUE ZERO.
  3449       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3450                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3451       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3452       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3453       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3454       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3455       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3456       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3457       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3458       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3459       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3460       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3461       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3462       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3463       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3464       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3465       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3466       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3467       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3468
  3469     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3470       88  NO-CP-ERROR-2                           VALUE ZERO.
  3471***********************  INPUT AREAS ****************************
  3472
  3473     12  CP-CALCULATION-AREA.
  3474         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3475         16  CP-CERT-EFF-DT        PIC XX.
  3476         16  CP-VALUATION-DT       PIC XX.
  3477         16  CP-PAID-THRU-DT       PIC XX.
  3478         16  CP-BENEFIT-TYPE       PIC X.
  3479           88  CP-AH                               VALUE 'A' 'D'
  3480                                                   'I' 'U'.
  3481           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3482           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3483         16  CP-INCURRED-DT        PIC XX.
  3484         16  CP-REPORTED-DT        PIC XX.
  3485         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  66
* EL050.cbl
  3486         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3487         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-CDT-METHOD         PIC X.
  3492           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3493           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3494           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3495         16  CP-CLAIM-TYPE         PIC X.
  3496           88  CP-AH-CLAIM                         VALUE 'A'.
  3497           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3498         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3499                                     COMP-3.
  3500         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3501                                     COMP-3.
  3502         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3503                                     COMP-3.
  3504         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3505                                     COMP-3.
  3506         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3507                                     COMP-3.
  3508         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3509                                     COMP-3.
  3510         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3511                                     COMP-3.
  3512         16  CP-REM-TERM-METHOD    PIC X.
  3513           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3514           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3515           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3516           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3517           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3518           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3519           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3520         16  CP-EARNING-METHOD     PIC X.
  3521           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3522           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3523           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3524           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3525           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3526           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3527           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3528           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3529           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3530           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3531           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3532           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3533           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3534           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3535         16  CP-PROCESS-TYPE       PIC X.
  3536           88  CP-CLAIM                            VALUE '1'.
  3537           88  CP-CANCEL                           VALUE '2'.
  3538           88  CP-ISSUE                            VALUE '3'.
  3539         16  CP-SPECIAL-CALC-CD    PIC X.
  3540           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3541           88  CP-1-MTH-INTEREST               VALUE ' '.
  3542           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3543           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  67
* EL050.cbl
  3544           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3545           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3546           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3547           88  CP-FARM-PLAN                    VALUE 'F'.
  3548           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3549           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3550           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3551           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3552           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3553           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3554           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3555           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3556           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3557           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3558                                                     'W' 'X'.
  3559           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3560           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3561           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3562           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3563           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3564           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3565           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3566           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3567           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3568           88  CP-CSL-METH-1                   VALUE '5'.
  3569           88  CP-CSL-METH-2                   VALUE '6'.
  3570           88  CP-CSL-METH-3                   VALUE '7'.
  3571           88  CP-CSL-METH-4                   VALUE '8'.
  3572
  3573         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3574                                     COMP-3.
  3575         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3576         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3577         16  CP-STATE              PIC XX          VALUE SPACE.
  3578         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3579         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3580           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3581               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3582         16  CP-R78-OPTION         PIC X.
  3583           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3584           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3585
  3586         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3587         16  CP-IBNR-RESERVE-SW    PIC X.
  3588         16  CP-CLAIM-STATUS       PIC X.
  3589         16  CP-RATE-FILE          PIC X.
  3590         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3591                                     COMP-3.
  3592
  3593         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3594         16  CP-AH-OVERRIDE-CODE   PIC X.
  3595
  3596         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3597                                     COMP-3.
  3598         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3599                                   PIC S9(5)V99 COMP-3.
  3600         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3601                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  68
* EL050.cbl
  3602         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3607                                  PIC S9(7)V99 COMP-3.
  3608
  3609         16  CP-PAID-FROM-DATE     PIC X(02).
  3610         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3611         16  CP-EXT-DAYS-CALC      PIC X.
  3612           88  CP-EXT-NO-CHG                   VALUE ' '.
  3613           88  CP-EXT-CHG-LF                   VALUE '1'.
  3614           88  CP-EXT-CHG-AH                   VALUE '2'.
  3615           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3616         16  CP-DOMICILE-STATE     PIC XX.
  3617         16  CP-CARRIER            PIC X.
  3618         16  CP-REIN-FLAG          PIC X.
  3619         16  CP-REM-TRM-CALC-OPTION PIC X.
  3620           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3621                      '2' '3' '4' '5'.
  3622           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3623           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3624           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3625           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3626           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3627           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3628           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3629           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3630         16  CP-SIG-SWITCH         PIC X.
  3631         16  CP-RATING-METHOD      PIC X.
  3632           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3633           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3634           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3635           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3636           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3637           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3638           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3639           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3640           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3641         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3642                                     COMP-3.
  3643         16  CP-BEN-CATEGORY       PIC X.
  3644         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3645         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3646                                   PIC S99V9(5) COMP-3.
  3647         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3648         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3649                                   PIC S99V9(5) COMP-3.
  3650         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3651         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3652         16  CP-EXPIRE-DT          PIC XX.
  3653         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3654         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3655         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3656         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3657         16  CP-DDF-SPEC-CALC      PIC X.
  3658             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3659             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  69
* EL050.cbl
  3660         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3661         16  CP-CANCEL-REASON      PIC X.
  3662         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3663         16  CP-PMT-MODE           PIC X.
  3664         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3665         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3666         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3667         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3668         16  FILLER                PIC X.
  3669
  3670***************    OUTPUT FROM ELRESV   ************************
  3671
  3672         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3673
  3674         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3679                                     COMP-3.
  3680         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3681                                     COMP-3.
  3682         16  FILLER                PIC X(09).
  3683***************    OUTPUT FROM ELRTRM   *************************
  3684
  3685         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3686                                     COMP-3.
  3687         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3690                                     COMP-3.
  3691         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3692                                     COMP-3.
  3693         16  FILLER                PIC X(12).
  3694
  3695***************    OUTPUT FROM ELRAMT   *************************
  3696
  3697         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  FILLER                PIC X(12).
  3702
  3703***************    OUTPUT FROM ELRATE   *************************
  3704
  3705         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-MORTALITY-CODE     PIC X(4).
  3710         16  CP-RATE-EDIT-FLAG     PIC X.
  3711             88  CP-RATES-NEED-APR                  VALUE '1'.
  3712         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3715         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3716         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3717                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  70
* EL050.cbl
  3718         16  FILLER                PIC X(07).
  3719
  3720***************    OUTPUT FROM ELRFND   *************************
  3721
  3722         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-REFUND-TYPE-USED   PIC X.
  3725           88  CP-R-AS-R78                         VALUE '1'.
  3726           88  CP-R-AS-PRORATA                     VALUE '2'.
  3727           88  CP-R-AS-CALIF                       VALUE '3'.
  3728           88  CP-R-AS-TEXAS                       VALUE '4'.
  3729           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3730           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3731           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3732           88  CP-R-AS-MEAN                        VALUE '8'.
  3733           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3734           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3735           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3736           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3737           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3738           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3739         16  FILLER                PIC X(12).
  3740
  3741***************    OUTPUT FROM ELEARN   *************************
  3742
  3743         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3750                                     COMP-3.
  3751         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-EARNING-TYPE-USED  PIC X.
  3756           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3757           88  CP-E-AS-R78                         VALUE '1'.
  3758           88  CP-E-AS-PRORATA                     VALUE '2'.
  3759           88  CP-E-AS-TEXAS                       VALUE '4'.
  3760           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3761           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3762           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3763           88  CP-E-AS-MEAN                        VALUE '8'.
  3764           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3765         16  FILLER                PIC X(12).
  3766
  3767***************    OUTPUT FROM ELPMNT   *************************
  3768
  3769         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(12).
  3774
  3775***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  71
* EL050.cbl
  3776         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3789             88  OPEN-RATE-FILE                   VALUE 'O'.
  3790             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3791             88  IO-ERROR                         VALUE 'E'.
  3792
  3793         16  CP-FIRST-PAY-DATE     PIC XX.
  3794
  3795         16  CP-JOINT-INDICATOR    PIC X.
  3796
  3797         16  CP-RESERVE-REMAINING-TERM
  3798                                   PIC S9(4)V9    VALUE ZERO
  3799                                     COMP-3.
  3800
  3801         16  CP-INSURED-BIRTH-DT   PIC XX.
  3802
  3803         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3804                                     COMP-3.
  3805
  3806         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3807                                     COMP-3.
  3808
  3809         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3810                                     COMP-3.
  3811
  3812         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3813                                     COMP-3.
  3814
  3815         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3816                                     COMP-3.
  3817
  3818         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3819                                     COMP-3.
  3820
  3821         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3822                                     COMP-3.
  3823
  3824         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3825             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3826
  3827         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3830                                     COMP-3.
  3831         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3832         16  FILLER                PIC X(15).
  3833******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  72
* EL050.cbl
  3835******************************************************************
  3836*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3837*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3838*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3839*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3840*** MODIFICATION.                                              ***
  3841*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3842*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3843******************************************************************
  3844*    COPY ERCPNDB.
  3845******************************************************************
  3846*                                                                *
  3847*                                                                *
  3848*                            ERCPNDB.                            *
  3849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3850*                            VMOD=2.025                          *
  3851*                                                                *
  3852*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3853*                                                                *
  3854******************************************************************
  3855*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3856*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3857******************************************************************
  3858*                                                                *
  3859*                                                                *
  3860*   FILE TYPE = VSAM,KSDS                                        *
  3861*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3862*                                                                *
  3863*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3864*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3865*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3866*                                                 RKP=13,LEN=36  *
  3867*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3868*                                      AND CHG-SEQ.)             *
  3869*                                                RKP=49,LEN=11   *
  3870*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3871*                                      AND CHG-SEQ.)             *
  3872*                                                RKP=60,LEN=15   *
  3873*                                                                *
  3874*   LOG = NO                                                     *
  3875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3876******************************************************************
  3877******************************************************************
  3878*                   C H A N G E   L O G
  3879*
  3880* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3881*-----------------------------------------------------------------
  3882*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3883* EFFECTIVE    NUMBER
  3884*-----------------------------------------------------------------
  3885* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3886* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3887* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3888* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3889* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3890* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3891* 032306                   PEMA  ADD BOW LOAN NUMBER
  3892* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  73
* EL050.cbl
  3893* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3894* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3895* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3896* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3897* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3898* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3899* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3900******************************************************************
  3901
  3902 01  PENDING-BUSINESS.
  3903     12  PB-RECORD-ID                     PIC XX.
  3904         88  VALID-PB-ID                        VALUE 'PB'.
  3905
  3906     12  PB-CONTROL-PRIMARY.
  3907         16  PB-COMPANY-CD                PIC X.
  3908         16  PB-ENTRY-BATCH               PIC X(6).
  3909         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3910         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3911
  3912     12  PB-CONTROL-BY-ACCOUNT.
  3913         16  PB-COMPANY-CD-A1             PIC X.
  3914         16  PB-CARRIER                   PIC X.
  3915         16  PB-GROUPING.
  3916             20  PB-GROUPING-PREFIX       PIC XXX.
  3917             20  PB-GROUPING-PRIME        PIC XXX.
  3918         16  PB-STATE                     PIC XX.
  3919         16  PB-ACCOUNT.
  3920             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3921             20  PB-ACCOUNT-PRIME         PIC X(6).
  3922         16  PB-CERT-EFF-DT               PIC XX.
  3923         16  PB-CERT-NO.
  3924             20  PB-CERT-PRIME            PIC X(10).
  3925             20  PB-CERT-SFX              PIC X.
  3926         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3927
  3928         16  PB-RECORD-TYPE               PIC X.
  3929             88  PB-MAILING-DATA                VALUE '0'.
  3930             88  PB-ISSUE                       VALUE '1'.
  3931             88  PB-CANCELLATION                VALUE '2'.
  3932             88  PB-BATCH-TRAILER               VALUE '9'.
  3933
  3934     12  PB-CONTROL-BY-ORIG-BATCH.
  3935         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3936         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3937         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3938         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3939
  3940     12  PB-CONTROL-BY-CSR.
  3941         16  PB-CSR-COMPANY-CD            PIC X.
  3942         16  PB-CSR-ID                    PIC X(4).
  3943         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3944         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3945         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3946******************************************************************
  3947*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3948******************************************************************
  3949
  3950     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  74
* EL050.cbl
  3951     12  PB-LAST-MAINT-BY                 PIC X(4).
  3952     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3953
  3954     12  PB-RECORD-BODY                   PIC X(375).
  3955
  3956     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3957         16  PB-CERT-ORIGIN               PIC X.
  3958             88  CLASIC-CREATED-CERT         VALUE '1'.
  3959         16  PB-I-NAME.
  3960             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3961             20  PB-I-INSURED-FIRST-NAME.
  3962                 24  PB-I-INSURED-1ST-INIT PIC X.
  3963                 24  FILLER                PIC X(9).
  3964             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3965         16  PB-I-AGE                     PIC S99   COMP-3.
  3966         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3967         16  PB-I-BIRTHDAY                PIC XX.
  3968         16  PB-I-INSURED-SEX             PIC X.
  3969             88  PB-SEX-MALE     VALUE 'M'.
  3970             88  PB-SEX-FEMALE   VALUE 'F'.
  3971
  3972         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3973         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3974         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3975         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3976         16  PB-I-SKIP-CODE               PIC X.
  3977             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3978             88  PB-SKIP-JULY              VALUE '1'.
  3979             88  PB-SKIP-AUGUST            VALUE '2'.
  3980             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3981             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3982             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3983             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3984             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3985             88  PB-SKIP-JUNE              VALUE '8'.
  3986             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3987             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3988             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3989         16  PB-I-TERM-TYPE               PIC X.
  3990             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3991             88  PB-PAID-WEEKLY            VALUE 'W'.
  3992             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3993             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3994             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3995         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3996         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3997         16  PB-I-DATA-ENTRY-SW           PIC X.
  3998             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3999             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4000             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4001             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4002         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4003         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4004*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4005         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4006         16  FILLER                       PIC X.
  4007
  4008         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  75
* EL050.cbl
  4009             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4010             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4011                                                   '90' THRU '99'.
  4012         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4013                                          PIC XX.
  4014         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4015         16  PB-I-AMOUNT-FINANCED REDEFINES
  4016                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4017         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4018         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4019                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4020         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4021         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4022         16  PB-I-CLP-AMOUNT REDEFINES
  4023                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4024         16  PB-I-LF-CALC-FLAG            PIC X.
  4025             88 PB-COMP-LF-PREM               VALUE '?'.
  4026         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4027         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4028         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4029         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4030         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4031         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4032         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4033         16  PB-I-LF-ABBR                 PIC XXX.
  4034         16  PB-I-LF-INPUT-CD             PIC XX.
  4035
  4036         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4037             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4038             88  PB-INVALID-AH               VALUE '  ' '00'
  4039                                                   '90' THRU '99'.
  4040         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4041         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4042         16  PB-I-AH-CALC-FLAG            PIC X.
  4043             88 PB-COMP-AH-PREM                  VALUE '?'.
  4044         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4045         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4046         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4047         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4048         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4049         16  PB-I-AH-ABBR                 PIC XXX.
  4050         16  PB-I-AH-INPUT-CD             PIC XXX.
  4051
  4052         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4053         16  PB-I-REIN-TABLE              PIC XXX.
  4054         16  PB-I-BUSINESS-TYPE           PIC 99.
  4055         16  PB-I-INDV-GRP-CD             PIC X.
  4056         16  PB-I-MORT-CODE.
  4057             20  PB-I-TABLE               PIC X.
  4058             20  PB-I-INTEREST            PIC XX.
  4059             20  PB-I-MORT-TYP            PIC X.
  4060         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4061         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4062         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4063         16  PB-I-INDV-GRP-OVRD           PIC X.
  4064         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4065         16  PB-I-SIG-SW                  PIC X.
  4066             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  76
* EL050.cbl
  4067         16  PB-I-RATE-CLASS              PIC XX.
  4068         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4069         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4070         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4071         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4072         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4073         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4074         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4075         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4076         16  PB-I-OB-FLAG                 PIC X.
  4077             88  PB-I-OB                      VALUE 'B'.
  4078             88  PB-I-SUMMARY                 VALUE 'Z'.
  4079         16  PB-I-ENTRY-STATUS            PIC X.
  4080             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4081                                              'M' '5' '9' '2'.
  4082             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4083             88  PB-I-POLICY-PENDING          VALUE '2'.
  4084             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4085             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4086             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4087             88  PB-I-REIN-ONLY               VALUE '9'.
  4088             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4089             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4090             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4091             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4092         16  PB-I-INT-CODE                PIC X.
  4093             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4094             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4095         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4096         16  PB-I-SOC-SEC-NO              PIC X(11).
  4097         16  PB-I-MEMBER-NO               PIC X(12).
  4098         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4099*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4100         16  PB-I-OLD-LOF                 PIC XXX.
  4101         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4102         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4103         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4104         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4105         16  PB-I-LIFE-INDICATOR          PIC X.
  4106             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4107         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4108         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4109                                          PIC S9(5)V99    COMP-3.
  4110         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4111             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4112             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4113         16  PB-I-1ST-PMT-DT              PIC XX.
  4114         16  PB-I-JOINT-INSURED.
  4115             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4116             20 PB-I-JOINT-FIRST-NAME.
  4117                24  PB-I-JOINT-FIRST-INIT PIC X.
  4118                24  FILLER                PIC X(9).
  4119             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4120*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4121         16  PB-I-BENEFICIARY-NAME.
  4122             20  PB-I-BANK-NUMBER         PIC X(10).
  4123             20  FILLER                   PIC X(15).
  4124         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  77
* EL050.cbl
  4125         16  PB-I-REFERENCE               PIC X(12).
  4126         16  FILLER REDEFINES PB-I-REFERENCE.
  4127             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4128             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4129             20  PB-I-CLP-STATE           PIC XX.
  4130         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4131             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4132             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4133             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4134         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4135         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4136         16  PB-I-RESIDENT-STATE          PIC XX.
  4137         16  PB-I-RATE-CODE               PIC X(4).
  4138         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4139         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4140         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4141         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4142         16  PB-I-BANK-NOCHRGB            PIC 99.
  4143         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4144         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4145
  4146     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4147         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4148             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4149         16  PB-C-CANCEL-ORIGIN           PIC X.
  4150             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4151         16  PB-C-LF-CANCEL-DT            PIC XX.
  4152         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4153         16  PB-C-LF-CALC-REQ             PIC X.
  4154             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4155         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4156         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4157         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4158             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4159         16  PB-C-AH-CANCEL-DT            PIC XX.
  4160         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4161         16  PB-C-AH-CALC-REQ             PIC X.
  4162             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4163         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4164         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4165         16  PB-C-LAST-NAME               PIC X(15).
  4166         16  PB-C-REFUND-SW               PIC X.
  4167             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4168             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4169         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4170         16  PB-C-PAYEE-CODE              PIC X(6).
  4171         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4172         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4173         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4174         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4175         16  PB-C-REFERENCE               PIC X(12).
  4176         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4177         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4178         16  PB-C-POST-CARD-IND           PIC X.
  4179         16  PB-C-CANCEL-REASON           PIC X.
  4180         16  PB-C-REF-INTERFACE-SW        PIC X.
  4181         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4182         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  78
* EL050.cbl
  4183         16  FILLER                       PIC X(01).
  4184*        16  FILLER                       PIC X(18).
  4185         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4186*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4187         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4188         16  PB-CANCELED-CERT-DATA.
  4189             20  PB-CI-INSURED-NAME.
  4190                 24  PB-CI-LAST-NAME      PIC X(15).
  4191                 24  PB-CI-INITIALS       PIC XX.
  4192             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4193             20  PB-CI-INSURED-SEX        PIC X.
  4194             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4195             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4196             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4197             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4198             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4199             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4200             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4201             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4202             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4203             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4204             20  PB-CI-RATE-CLASS         PIC XX.
  4205             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4206             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4207             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4208             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4209             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4210             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4211             20  PB-CI-LF-ABBR            PIC X(3).
  4212             20  PB-CI-AH-ABBR            PIC X(3).
  4213             20  PB-CI-OB-FLAG            PIC X.
  4214                 88  PB-CI-OB                VALUE 'B'.
  4215             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4216                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4217                                           'M' '4' '5' '9' '2'.
  4218                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4219                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4220                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4221                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4222                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4223                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4224                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4225                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4226                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4227                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4228                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4229                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4230             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4231                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4232                                           'M' '4' '5' '9' '2'.
  4233                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4234                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4235                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4236                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4237                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4238                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4239                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4240                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  79
* EL050.cbl
  4241                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4242                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4243                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4244                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4245             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4246             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4247             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4248             20  PB-CI-MEMBER-NO          PIC X(12).
  4249             20  PB-CI-INT-CODE           PIC X.
  4250                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4251                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4252             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4253             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4254             20  PB-CI-COMP-EXCP-SW       PIC X.
  4255                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4256                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4257             20  PB-CI-ENTRY-STATUS       PIC X.
  4258             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4259             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4260             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4261             20  PB-CI-DEATH-DT           PIC XX.
  4262             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4263             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4264             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4265             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4266             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4267             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4268             20  PB-CI-ENTRY-DT              PIC XX.
  4269             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4270             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4271             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4272             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4273             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4274             20  PB-CI-OLD-LOF               PIC XXX.
  4275*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4276             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4277             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4278             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4279             20  PB-CI-INDV-GRP-CD           PIC X.
  4280             20  PB-CI-BENEFICIARY-NAME.
  4281                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4282                 24  FILLER                  PIC X(15).
  4283             20  PB-CI-NOTE-SW               PIC X.
  4284             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4285             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4286             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4287             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4288             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4289             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4290             20  PB-CI-FIRST-NAME            PIC X(10).
  4291             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4292
  4293         16  FILLER                       PIC X(13).
  4294*032306  16  FILLER                       PIC X(27).
  4295*        16  FILLER                       PIC X(46).
  4296
  4297     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4298         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  80
* EL050.cbl
  4299         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4300         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4301         16  PB-M-INSURED-MID-INIT        PIC X.
  4302         16  PB-M-INSURED-AGE             PIC 99.
  4303         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4304         16  PB-M-INSURED-SEX             PIC X.
  4305         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4306         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4307         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4308         16  PB-M-INSURED-CITY-STATE.
  4309             20  PB-M-INSURED-CITY        PIC X(28).
  4310             20  PB-M-INSURED-STATE       PIC XX.
  4311         16  PB-M-INSURED-ZIP-CODE.
  4312             20  PB-M-INSURED-ZIP-PRIME.
  4313                 24  PB-M-INSURED-ZIP-1   PIC X.
  4314                     88  PB-M-CANADIAN-POST-CODE
  4315                                             VALUE 'A' THRU 'Z'.
  4316                 24  FILLER               PIC X(4).
  4317             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4318         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4319                                        PB-M-INSURED-ZIP-CODE.
  4320             20  PM-M-INS-CAN-POST1       PIC XXX.
  4321             20  PM-M-INS-CAN-POST2       PIC XXX.
  4322             20  FILLER                   PIC XXX.
  4323         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4324         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4325         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4326         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4327         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4328         16  PB-M-CRED-BENE-CITYST.
  4329             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4330             20  PB-M-CRED-BENE-STATE     PIC XX.
  4331         16  FILLER                       PIC X(92).
  4332
  4333     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4334         16  FILLER                       PIC X(10).
  4335         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4336         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4337         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4338         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4339         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4340         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4341         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4342         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4343         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4344         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4345         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4346         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4347         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4348         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4349         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4350         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4351         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4352         16  PB-ACCOUNT-NAME              PIC X(30).
  4353         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4354         16  PB-REFERENCE                 PIC X(12).
  4355         16  PB-B-RECEIVED-DT             PIC XX.
  4356         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  81
* EL050.cbl
  4357
  4358     12  PB-RECORD-STATUS.
  4359         16  PB-CREDIT-SELECT-DT          PIC XX.
  4360         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4361         16  PB-BILLED-DT                 PIC XX.
  4362         16  PB-BILLING-STATUS            PIC X.
  4363             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4364             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4365             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4366         16  PB-RECORD-BILL               PIC X.
  4367             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4368             88  PB-RECORD-RETURNED           VALUE 'R'.
  4369             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4370             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4371             88  PB-OVERRIDE-AH               VALUE 'A'.
  4372             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4373         16  PB-BATCH-ENTRY               PIC X.
  4374             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4375             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4376             88  PB-REISSUED-CERT             VALUE 'E'.
  4377             88  PB-MONTHLY-CERT              VALUE 'M'.
  4378             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4379             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4380             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4381         16  PB-FORCE-CODE                PIC X.
  4382             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4383             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4384             88  PB-CANCEL-FORCE              VALUE '8'.
  4385             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4386             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4387             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4388             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4389             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4390             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4391             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4392         16  PB-FATAL-FLAG                PIC X.
  4393             88  PB-FATAL-ERRORS              VALUE 'X'.
  4394         16  PB-FORCE-ER-CD               PIC X.
  4395             88  PB-FORCE-ERRORS              VALUE 'F'.
  4396             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4397         16  PB-WARN-ER-CD                PIC X.
  4398             88  PB-WARNING-ERRORS            VALUE 'W'.
  4399         16  FILLER                       PIC X.
  4400         16  PB-OUT-BAL-CD                PIC X.
  4401             88  PB-OUT-OF-BAL                VALUE 'O'.
  4402         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4403         16  PB-AH-OVERRIDE-L1            PIC X.
  4404         16  PB-INPUT-DT                  PIC XX.
  4405         16  PB-INPUT-BY                  PIC X(4).
  4406         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4407         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4408         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4409         16  PB-LF-EARNING-METHOD         PIC X.
  4410         16  PB-AH-EARNING-METHOD         PIC X.
  4411         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4412         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4413         16  PB-REIN-CD                   PIC XXX.
  4414         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  82
* EL050.cbl
  4415         16  PB-AH-REFUND-TYPE            PIC X.
  4416         16  PB-ACCT-EFF-DT               PIC XX.
  4417         16  PB-ACCT-EXP-DT               PIC XX.
  4418         16  PB-COMPANY-ID                PIC X(3).
  4419         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4420         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4421         16  PB-SV-CARRIER                PIC X.
  4422         16  PB-SV-GROUPING               PIC X(6).
  4423         16  PB-SV-STATE                  PIC XX.
  4424         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4425         16  PB-GA-BILLING-INFO.
  4426             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4427                                          PIC XX.
  4428         16  PB-SV-REMIT-TO  REDEFINES
  4429             PB-GA-BILLING-INFO           PIC X(10).
  4430         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4431         16  PB-I-LOAN-OFFICER            PIC X(5).
  4432         16  PB-I-VIN                     PIC X(17).
  4433
  4434         16  FILLER                       PIC X(04).
  4435         16  IMNET-BYPASS-SW              PIC X.
  4436
  4437******************************************************************
  4438*                COMMON EDIT ERRORS                              *
  4439******************************************************************
  4440
  4441     12  PB-COMMON-ERRORS.
  4442         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4443                                           PIC S9(4)     COMP.
  4444
  4445******************************************************************
  4446
  4447* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4448*    COPY ELC50W1.
  4449******************************************************************
  4450*                                                                *
  4451*                                                                *
  4452*                             ELC50W1                            *
  4453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4454*                            VMOD=2.004                          *
  4455*                                                                *
  4456*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4457*                                                                *
  4458*                                                                *
  4459******************************************************************
  4460
  4461     12  WK-WORK-AREA.
  4462         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4463         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4464         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4465         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4466         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4467         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4468         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4469         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4470         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4471         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4472         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  83
* EL050.cbl
  4473         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4474         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4475         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4476         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4477         16  WK-CREDIT-EDIT-CONTROLS.
  4478             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4479             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4480             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4481             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4482             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4483             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4484         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4485         16  WK-SAVE-REIN-DATA.
  4486             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4487             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4488             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4489         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4490             88  ENTRY-FROM-EL6311       VALUE '6'.
  4491         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4492         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4493     12  WK-RECORD-ADDRESSES.
  4494         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4495         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4496         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4497         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4498         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4499         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4500         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4501         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4502     12  WK-OVER-SHORT-AREA.
  4503         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4504         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4505         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4506             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4507         16  FILLER                   PIC X(5) VALUE SPACES.
  4508
  4509*    COPY ELCEDITC.
  4510******************************************************************
  4511*                                                                *
  4512*                                                                *
  4513*                            ELCEDITC                            *
  4514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4515*                            VMOD=2.012                          *
  4516*                                                                *
  4517*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4518*                     EL6313, EL050 AND EL517.                   *
  4519*                                                                *
  4520******************************************************************
  4521******************************************************************
  4522*                   C H A N G E   L O G
  4523*
  4524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4525*-----------------------------------------------------------------
  4526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4527* EFFECTIVE    NUMBER
  4528*-----------------------------------------------------------------
  4529* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4530******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  84
* EL050.cbl
  4531
  4532     12  EDIT-CRITERIA-DATA.
  4533         16  EC-CO-MONTH-END-DT       PIC XX.
  4534         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4535         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4536         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4537         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4538         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4539         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4540         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4541         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4542         16  EC-CO-REM-TERM-CALC      PIC X.
  4543               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4544               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4545               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4546               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4547
  4548         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4549               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4550               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4551               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4552               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4553               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4554               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4555               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4556               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4557               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4558               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4559
  4560         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4561               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4562               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4563               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4564               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4565               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4566               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4567               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4568               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4569
  4570         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4571                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4572                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4573
  4574         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4575                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4576                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4577                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4578                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4579                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4580                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4581                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4582                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4583
  4584         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4585               88  EC-BR-REDUCING                   VALUE 'R'.
  4586               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4587
  4588         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  85
* EL050.cbl
  4589         16  EC-BR-LF-DESC             PIC X(10).
  4590         16  EC-BR-AH-DESC             PIC X(10).
  4591         16  EC-BR-LF-COMMENT          PIC X(10).
  4592         16  EC-BR-AH-COMMENT          PIC X(10).
  4593
  4594         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4595               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4596               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4597               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4598               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4599
  4600         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4601               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4602               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4603               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4604               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4605
  4606         16  EC-BR-LF-REFUND-CALC      PIC X.
  4607                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4608                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4609                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4610                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4611                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4612                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4613                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4614
  4615         16  EC-BR-AH-REFUND-CALC      PIC X.
  4616                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4617                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4618                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4619                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4620                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4621                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4622                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4623                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4624
  4625         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4626                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4627                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4628                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4629
  4630         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4631                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4632                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4633                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4634
  4635         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4636         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4637         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4638         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4639
  4640         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4641         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4642                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4643                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4644                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4645                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4646
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  86
* EL050.cbl
  4647         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4648               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4649               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4650               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4651               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4652               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4653
  4654         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4655               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4656               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4657               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4658               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4659               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4660
  4661         16  EC-ST-LF-REFUND-CALC      PIC X.
  4662                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4663                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4664                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4665                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4666                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4667                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4668                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4669                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4670
  4671         16  EC-ST-AH-REFUND-CALC      PIC X.
  4672                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4673                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4674                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4675                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4676                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4677                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4678                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4679                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4680
  4681         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4682         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4683         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4684         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4685         16  EC-AM-EXPIRATION-DT       PIC XX.
  4686         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4687         16  EC-AM-CLASS-CD            PIC XX.
  4688         16  EC-AM-LF-DEVIATION        PIC XXX.
  4689         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4690         16  EC-AM-AH-DEVIATION        PIC XXX.
  4691         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4692         16  EC-AM-PHONE-NO            PIC X(10).
  4693
  4694         16  EC-AM-LF-REFUND-CALC      PIC X.
  4695                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4696                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4697                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4698                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4699                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4700                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4701                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4702
  4703         16  EC-AM-AH-REFUND-CALC      PIC X.
  4704                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  87
* EL050.cbl
  4705                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4706                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4707                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4708                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4709                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4710                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4711
  4712         16  EC-AM-BEN-I-G-CD          PIC X.
  4713                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4714                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4715                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4716
  4717         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4718         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4719         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4720         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4721         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4722         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4723         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4724         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4725         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4726
  4727         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4728         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4729         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4730         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4731         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4732         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4733         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4734         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4735         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4736         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4737         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4738         16  EC-RT-LF-NSP-ST           PIC XX.
  4739         16  EC-RT-AH-NSP-ST           PIC XX.
  4740         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4741         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4742
  4743         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4744             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4745                                             'M' '5' '9' '2'.
  4746             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4747             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4748             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4749             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4750             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4751             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4752             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4753             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4754             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4755             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4756
  4757         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4758             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4759                                             'M' '5' '9' '2'.
  4760             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4761             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4762             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  88
* EL050.cbl
  4763             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4764             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4765             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4766             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4767             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4768             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4769             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4770
  4771         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4772         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4773         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4774         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4775         16  EC-CM-DEATH-DT            PIC XX.
  4776
  4777*DMD CUSTOM CODING FIELDS BELOW
  4778*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4779         16  EC-BR-DMD-RATING-SW       PIC X.
  4780                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4781                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4782                 88  NO-DMD-RATING               VALUE 'N'.
  4783
  4784         16  EC-NEW-CERT               PIC X(11).
  4785         16  EC-NEW-STATE              PIC XX.
  4786         16  FILLER                    PIC X.
  4787*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4788         16  OVER-SHORT-EDIT-FIELDS.
  4789             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4790             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4791             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4792             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4793             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4794             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4795             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4796             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4797             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4798         16  FILLER                    PIC X(71).
  4799******************************************************************
  4800
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  89
* EL050.cbl
  4802*    COPY ELCDIFRD.
  4803******************************************************************
  4804*                                                                *
  4805*                                                                *
  4806*                            ELCDIFRD.                           *
  4807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4808*                            VMOD=2.004                          *
  4809*                                                                *
  4810*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4811*                                                                *
  4812******************************************************************
  4813*
  4814  01  WS-DIFFERENCE-CALCULATION.
  4815        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4816        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4817        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4818        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4819        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4820        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4821        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4822        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4823        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4824        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4825        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4826
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  90
* EL050.cbl
  4828****************************************************************
  4829*
  4830* Copyright (c) 2007 by Clerity Solutions, Inc.
  4831* All rights reserved.
  4832*
  4833****************************************************************
  4834 01  DFHEIV.
  4835   02  DFHEIV0               PIC X(35).
  4836   02  DFHEIV1               PIC X(08).
  4837   02  DFHEIV2               PIC X(08).
  4838   02  DFHEIV3               PIC X(08).
  4839   02  DFHEIV4               PIC X(06).
  4840   02  DFHEIV5               PIC X(04).
  4841   02  DFHEIV6               PIC X(04).
  4842   02  DFHEIV7               PIC X(02).
  4843   02  DFHEIV8               PIC X(02).
  4844   02  DFHEIV9               PIC X(01).
  4845   02  DFHEIV10              PIC S9(7) COMP-3.
  4846   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4847   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4848   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4849   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4850   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4851   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4852   02  DFHEIV17              PIC X(04).
  4853   02  DFHEIV18              PIC X(04).
  4854   02  DFHEIV19              PIC X(04).
  4855   02  DFHEIV20              USAGE IS POINTER.
  4856   02  DFHEIV21              USAGE IS POINTER.
  4857   02  DFHEIV22              USAGE IS POINTER.
  4858   02  DFHEIV23              USAGE IS POINTER.
  4859   02  DFHEIV24              USAGE IS POINTER.
  4860   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4861   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4862   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4863   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4864   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4865   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4866   02  FILLER                PIC X(02).
  4867   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4868   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4869   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4870   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4871   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4872 LINKAGE  SECTION.
  4873*****************************************************************
  4874*                                                               *
  4875* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4876* All rights reserved.                                          *
  4877*                                                               *
  4878*****************************************************************
  4879 01  dfheiblk.
  4880     02  eibtime          pic s9(7) comp-3.
  4881     02  eibdate          pic s9(7) comp-3.
  4882     02  eibtrnid         pic x(4).
  4883     02  eibtaskn         pic s9(7) comp-3.
  4884     02  eibtrmid         pic x(4).
  4885     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  91
* EL050.cbl
  4886     02  eibcposn         pic s9(4) comp.
  4887     02  eibcalen         pic s9(4) comp.
  4888     02  eibaid           pic x(1).
  4889     02  eibfiller1       pic x(1).
  4890     02  eibfn            pic x(2).
  4891     02  eibfiller2       pic x(2).
  4892     02  eibrcode         pic x(6).
  4893     02  eibfiller3       pic x(2).
  4894     02  eibds            pic x(8).
  4895     02  eibreqid         pic x(8).
  4896     02  eibrsrce         pic x(8).
  4897     02  eibsync          pic x(1).
  4898     02  eibfree          pic x(1).
  4899     02  eibrecv          pic x(1).
  4900     02  eibsend          pic x(1).
  4901     02  eibatt           pic x(1).
  4902     02  eibeoc           pic x(1).
  4903     02  eibfmh           pic x(1).
  4904     02  eibcompl         pic x(1).
  4905     02  eibsig           pic x(1).
  4906     02  eibconf          pic x(1).
  4907     02  eiberr           pic x(1).
  4908     02  eibrldbk         pic x(1).
  4909     02  eiberrcd         pic x(4).
  4910     02  eibsynrb         pic x(1).
  4911     02  eibnodat         pic x(1).
  4912     02  eibfiller5       pic x(2).
  4913     02  eibresp          pic 9(09) comp.
  4914     02  eibresp2         pic 9(09) comp.
  4915     02  dfheigdj         pic s9(4) comp.
  4916     02  dfheigdk         pic s9(4) comp.
  4917
  4918 01  DFHCOMMAREA                   PIC X(1036).
  4919
  4920*01 PARMLIST .
  4921*    02  FILLER                    PIC S9(8)   COMP.
  4922*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4923*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4924*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4925*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4926*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4927*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4928*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4929
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  92
* EL050.cbl
  4931*    COPY ELCCNTL.
  4932******************************************************************
  4933*                                                                *
  4934*                                                                *
  4935*                            ELCCNTL.                            *
  4936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4937*                            VMOD=2.059                          *
  4938*                                                                *
  4939*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4940*                                                                *
  4941*   FILE TYPE = VSAM,KSDS                                        *
  4942*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4943*                                                                *
  4944*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4945*       ALTERNATE INDEX = NONE                                   *
  4946*                                                                *
  4947*   LOG = YES                                                    *
  4948*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4949******************************************************************
  4950*                   C H A N G E   L O G
  4951*
  4952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4953*-----------------------------------------------------------------
  4954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4955* EFFECTIVE    NUMBER
  4956*-----------------------------------------------------------------
  4957* 082503                   PEMA  ADD BENEFIT GROUP
  4958* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4959* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4960* 092705    2005050300006  PEMA  ADD SPP LEASES
  4961* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4962* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4963* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4964* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4965* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4966* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4967* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4968* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4969* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4970******************************************************************
  4971*
  4972 01  CONTROL-FILE.
  4973     12  CF-RECORD-ID                       PIC XX.
  4974         88  VALID-CF-ID                        VALUE 'CF'.
  4975
  4976     12  CF-CONTROL-PRIMARY.
  4977         16  CF-COMPANY-ID                  PIC XXX.
  4978         16  CF-RECORD-TYPE                 PIC X.
  4979             88  CF-COMPANY-MASTER              VALUE '1'.
  4980             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4981             88  CF-STATE-MASTER                VALUE '3'.
  4982             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4983             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4984             88  CF-CARRIER-MASTER              VALUE '6'.
  4985             88  CF-MORTALITY-MASTER            VALUE '7'.
  4986             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4987             88  CF-TERMINAL-MASTER             VALUE '9'.
  4988             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  93
* EL050.cbl
  4989             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4990             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4991             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4992             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4993             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4994             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4995             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4996             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4997         16  CF-ACCESS-CD-GENL              PIC X(4).
  4998         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4999             20  CF-PROCESSOR               PIC X(4).
  5000         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5001             20  CF-STATE-CODE              PIC XX.
  5002             20  FILLER                     PIC XX.
  5003         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5004             20  FILLER                     PIC XX.
  5005             20  CF-HI-BEN-IN-REC           PIC XX.
  5006         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5007             20  FILLER                     PIC XXX.
  5008             20  CF-CARRIER-CNTL            PIC X.
  5009         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5010             20  FILLER                     PIC XX.
  5011             20  CF-HI-TYPE-IN-REC          PIC 99.
  5012         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5013             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5014                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5015             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5016             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5017         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5018             20  FILLER                     PIC X.
  5019             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5020         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5021             20  FILLER                     PIC XX.
  5022             20  CF-MORTGAGE-PLAN           PIC XX.
  5023         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5024
  5025     12  CF-LAST-MAINT-DT                   PIC XX.
  5026     12  CF-LAST-MAINT-BY                   PIC X(4).
  5027     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5028
  5029     12  CF-RECORD-BODY                     PIC X(728).
  5030
  5031
  5032****************************************************************
  5033*             COMPANY MASTER RECORD                            *
  5034****************************************************************
  5035
  5036     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5037         16  CF-COMPANY-ADDRESS.
  5038             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5039             20  CF-CL-IN-CARE-OF           PIC X(30).
  5040             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5041             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5042             20  CF-CL-CITY-STATE           PIC X(30).
  5043             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5044             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5045         16  CF-COMPANY-CD                  PIC X.
  5046         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  94
* EL050.cbl
  5047         16  CF-SECURITY-OPTION             PIC X.
  5048             88  ALL-SECURITY                   VALUE '1'.
  5049             88  COMPANY-VERIFY                 VALUE '2'.
  5050             88  PROCESSOR-VERIFY               VALUE '3'.
  5051             88  NO-SECURITY                    VALUE '4'.
  5052             88  ALL-BUT-TERM                   VALUE '5'.
  5053         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5054             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5055         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5056             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5057         16  CF-INFORCE-LOCATION            PIC X.
  5058             88  CERTS-ARE-ONLINE               VALUE '1'.
  5059             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5060             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5061         16  CF-LOWER-CASE-LETTERS          PIC X.
  5062         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5063             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5064             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5065             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5066             88  CF-ACCNT-CNTL                  VALUE '3'.
  5067             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5068
  5069         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5070         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5071
  5072         16  CF-LGX-CREDIT-USER             PIC X.
  5073             88  CO-IS-NOT-USER                 VALUE 'N'.
  5074             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5075
  5076         16 CF-CREDIT-CALC-CODES.
  5077             20  CF-CR-REM-TERM-CALC PIC X.
  5078               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5079               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5080               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5081               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5082               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5083               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5084               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5085             20  CF-CR-R78-METHOD           PIC X.
  5086               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5087               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5088
  5089         16  CF-CLAIM-CONTROL-COUNTS.
  5090             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5091                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5092
  5093             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5094                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5095
  5096             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5097                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5098
  5099             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5100                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5101
  5102         16  CF-CURRENT-MONTH-END           PIC XX.
  5103
  5104         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  95
* EL050.cbl
  5105             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5106             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5107             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5108             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5109                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5110                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5111             20  CF-CO-PREM-REJECT-SW       PIC X.
  5112                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5113                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5114             20  CF-CO-REF-REJECT-SW        PIC X.
  5115                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5116                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5117
  5118         16  CF-CO-REPORTING-DT             PIC XX.
  5119         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5120         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5121           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5122           88  CF-CO-MONTH-END                  VALUE '1'.
  5123
  5124         16  CF-LGX-CLAIM-USER              PIC X.
  5125             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5126             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5127
  5128         16  CF-CREDIT-EDIT-CONTROLS.
  5129             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5130             20  CF-MIN-AGE                 PIC 99.
  5131             20  CF-DEFAULT-AGE             PIC 99.
  5132             20  CF-MIN-TERM                PIC S999      COMP-3.
  5133             20  CF-MAX-TERM                PIC S999      COMP-3.
  5134             20  CF-DEFAULT-SEX             PIC X.
  5135             20  CF-JOINT-AGE-INPUT         PIC X.
  5136                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5137             20  CF-BIRTH-DATE-INPUT        PIC X.
  5138                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5139             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5140                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5141                 88  CF-ZERO-CARRIER            VALUE '1'.
  5142                 88  CF-ZERO-GROUPING           VALUE '2'.
  5143                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5144             20  CF-EDIT-SW                 PIC X.
  5145                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5146             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5147             20  CF-CR-PR-METHOD            PIC X.
  5148               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5149               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5150             20  FILLER                     PIC X.
  5151
  5152         16  CF-CREDIT-MISC-CONTROLS.
  5153             20  CF-REIN-TABLE-SW           PIC X.
  5154                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5155             20  CF-COMP-TABLE-SW           PIC X.
  5156                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5157             20  CF-EXPERIENCE-RETENTION-AGE
  5158                                            PIC S9        COMP-3.
  5159             20  CF-CONVERSION-DT           PIC XX.
  5160             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5161             20  CF-RUN-FREQUENCY-SW        PIC X.
  5162                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  96
* EL050.cbl
  5163                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5164
  5165             20  CF-CR-CHECK-NO-CONTROL.
  5166                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5167                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5168                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5169                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5170                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5171                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5172
  5173                 24  CF-CR-CHECK-COUNT       REDEFINES
  5174                     CF-CR-CHECK-COUNTER      PIC X(4).
  5175
  5176                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5177                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5178
  5179                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5180                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5181                 24  CF-MAIL-PROCESSING       PIC X.
  5182                     88  MAIL-PROCESSING          VALUE 'Y'.
  5183
  5184         16  CF-MISC-SYSTEM-CONTROL.
  5185             20  CF-SYSTEM-C                 PIC X.
  5186                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5187             20  CF-SYSTEM-D                 PIC X.
  5188                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5189             20  CF-SOC-SEC-NO-SW            PIC X.
  5190                 88  SOC-SEC-NO-USED             VALUE '1'.
  5191             20  CF-MEMBER-NO-SW             PIC X.
  5192                 88  MEMBER-NO-USED              VALUE '1'.
  5193             20  CF-TAX-ID-NUMBER            PIC X(11).
  5194             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5195             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5196                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5197                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5198                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5199                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5200             20  CF-SYSTEM-E                 PIC X.
  5201                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5202
  5203         16  CF-LGX-LIFE-USER               PIC X.
  5204             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5205             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5206
  5207         16  CF-CR-MONTH-END-DT             PIC XX.
  5208
  5209         16  CF-FILE-MAINT-DATES.
  5210             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5211                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5212             20  CF-LAST-BATCH       REDEFINES
  5213                 CF-LAST-BATCH-NO               PIC X(4).
  5214             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5215             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5216             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5217             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5218             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5219             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5220             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  97
* EL050.cbl
  5221             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5222             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5223             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5224
  5225         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5226         16  FILLER                         PIC X.
  5227
  5228         16  CF-ALT-MORT-CODE               PIC X(4).
  5229         16  CF-MEMBER-CAPTION              PIC X(10).
  5230
  5231         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5232             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5233             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5234             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5235             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5236             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5237
  5238         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5239
  5240         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5241         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5242         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5243         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5244
  5245         16  CF-AH-OVERRIDE-L1              PIC X.
  5246         16  CF-AH-OVERRIDE-L2              PIC XX.
  5247         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5248         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5249
  5250         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5251         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5252
  5253         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5254         16  CF-AR-LAST-EL860-DT            PIC XX.
  5255         16  CF-MP-MONTH-END-DT             PIC XX.
  5256
  5257         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5258         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5259             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5260
  5261         16  CF-AR-MONTH-END-DT             PIC XX.
  5262
  5263         16  CF-CRDTCRD-USER                PIC X.
  5264             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5265             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5266
  5267         16  CF-CC-MONTH-END-DT             PIC XX.
  5268
  5269         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5270
  5271         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5272             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5273             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5274             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5275         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5276         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5277         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5278         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  98
* EL050.cbl
  5279             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5280             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5281         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5282         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5283         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5284             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5285         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5286
  5287         16  CF-CL-ZIP-CODE.
  5288             20  CF-CL-ZIP-PRIME.
  5289                 24  CF-CL-ZIP-1ST          PIC X.
  5290                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5291                 24  FILLER                 PIC X(4).
  5292             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5293         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5294             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5295             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5296             20  FILLER                     PIC XXX.
  5297
  5298         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5299         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5300         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5301         16  CF-CO-OPTION-START-DATE        PIC XX.
  5302         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5303           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5304                                                      '3' '4'.
  5305           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5306           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5307           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5308           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5309           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5310           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5311
  5312         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5313
  5314         16  CF-PAYMENT-APPROVAL-LEVELS.
  5315             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5316             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5317             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5318             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5319             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5320             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5321
  5322         16  CF-END-USER-REPORTING-USER     PIC X.
  5323             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5324             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5325
  5326         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5327             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5328             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5329
  5330         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5331
  5332         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5333         16  FILLER                         PIC X.
  5334
  5335         16  CF-CREDIT-ARCHIVE-CNTL.
  5336             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page  99
* EL050.cbl
  5337             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5338             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5339
  5340         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5341
  5342         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5343             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5344             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5345
  5346         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5347             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5348             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5349
  5350         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5351
  5352         16  CF-CO-ACH-ID-CODE              PIC  X.
  5353             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5354             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5355             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5356         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5357         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5358         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5359         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5360         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5361         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5362         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5363         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5364         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5365                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5366         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5367                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5368
  5369         16  CF-CO-OVER-SHORT.
  5370             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5371             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5372
  5373*         16  FILLER                         PIC X(102).
  5374         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5375             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5376             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5377
  5378         16  CF-AH-APPROVAL-DAYS.
  5379             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5380             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5381             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5382             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5383
  5384         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5385
  5386         16  CF-APPROV-LEV-5.
  5387             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5388             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5389             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5390
  5391         16  FILLER                         PIC X(68).
  5392****************************************************************
  5393*             PROCESSOR/USER RECORD                            *
  5394****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 100
* EL050.cbl
  5395
  5396     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5397         16  CF-PROCESSOR-NAME              PIC X(30).
  5398         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5399         16  CF-PROCESSOR-TITLE             PIC X(26).
  5400         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5401                 88  MESSAGE-YES                VALUE 'Y'.
  5402                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5403
  5404*****************************************************
  5405****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5406****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5407****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5408****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5409*****************************************************
  5410
  5411         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5412             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5413             20  CF-APPLICATION-FORCE       PIC X.
  5414             20  CF-INDIVIDUAL-APP.
  5415                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5416                     28  CF-BROWSE-APP      PIC X.
  5417                     28  CF-UPDATE-APP      PIC X.
  5418
  5419         16  CF-CURRENT-TERM-ON             PIC X(4).
  5420         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5421             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5422             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5423             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5424             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5425             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5426             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5427             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5428         16  CF-PROCESSOR-CARRIER           PIC X.
  5429             88  NO-CARRIER-SECURITY            VALUE ' '.
  5430         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5431             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5432         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5433             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5434         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5435             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5436
  5437         16  CF-PROC-SYS-ACCESS-SW.
  5438             20  CF-PROC-CREDIT-CLAIMS-SW.
  5439                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5440                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5441                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5442                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5443             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5444                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5445                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5446             20  CF-PROC-LIFE-GNRLDGR-SW.
  5447                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5448                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5449                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5450                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5451             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5452                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 101
* EL050.cbl
  5453                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5454         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5455             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5456             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5457         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5458
  5459         16  CF-APPROVAL-LEVEL                  PIC X.
  5460             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5461             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5462             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5463             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5464             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5465
  5466         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5467
  5468         16  CF-LANGUAGE-TYPE                   PIC X.
  5469             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5470             88  CF-LANG-IS-FR                      VALUE 'F'.
  5471
  5472         16  CF-CSR-IND                         PIC X.
  5473         16  FILLER                             PIC X(239).
  5474
  5475****************************************************************
  5476*             PROCESSOR/REMINDERS RECORD                       *
  5477****************************************************************
  5478
  5479     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5480         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5481             20  CF-START-REMIND-DT         PIC XX.
  5482             20  CF-END-REMIND-DT           PIC XX.
  5483             20  CF-REMINDER-TEXT           PIC X(50).
  5484         16  FILLER                         PIC X(296).
  5485
  5486
  5487****************************************************************
  5488*             STATE MASTER RECORD                              *
  5489****************************************************************
  5490
  5491     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5492         16  CF-STATE-ABBREVIATION          PIC XX.
  5493         16  CF-STATE-NAME                  PIC X(25).
  5494         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5495         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5496             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5497             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5498             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5499             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5500                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5501                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5502             20  CF-ST-PREM-REJECT-SW       PIC X.
  5503                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5504                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5505             20  CF-ST-REF-REJECT-SW        PIC X.
  5506                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5507                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5508         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5509         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5510         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 102
* EL050.cbl
  5511             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5512             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5513             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5514         16  CF-ST-FST-PMT-EXTENSION.
  5515             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5516             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5517                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5518                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5519                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5520                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5521         16  CF-ST-STATE-CALL.
  5522             20  CF-ST-CALL-UNEARNED        PIC X.
  5523             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5524             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5525         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5526             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5527             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5528         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5529         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5530         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5531         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5532         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5533         16  FILLER                         PIC X.
  5534         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5535             20  CF-ST-BENEFIT-CD           PIC XX.
  5536             20  CF-ST-BENEFIT-KIND         PIC X.
  5537                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5538                 88  CF-ST-AH-KIND              VALUE 'A'.
  5539             20  CF-ST-REM-TERM-CALC        PIC X.
  5540                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5541                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5542                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5543                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5544                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5545                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5546                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5547                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5548
  5549             20  CF-ST-REFUND-CALC          PIC X.
  5550                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5551                 88  ST-REFD-BY-R78             VALUE '1'.
  5552                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5553                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5554                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5555                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5556                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5557                 88  ST-REFD-UTAH               VALUE '7'.
  5558                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5559                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5560                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5561
  5562             20  CF-ST-EARNING-CALC         PIC X.
  5563                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5564                 88  ST-EARN-BY-R78             VALUE '1'.
  5565                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5566                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5567                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5568                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 103
* EL050.cbl
  5569                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5570                 88  ST-EARN-MEAN               VALUE '8'.
  5571                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5572
  5573             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5574                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5575                 88  ST-OVRD-BY-R78             VALUE '1'.
  5576                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5577                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5578                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5579                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5580                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5581                 88  ST-OVRD-MEAN               VALUE '8'.
  5582                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5583             20  FILLER                     PIC X.
  5584
  5585         16  CF-ST-COMMISSION-CAPS.
  5586             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5587             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5588             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5589             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5590         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5591                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5592
  5593         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5594
  5595         16  CF-ST-STATUTORY-INTEREST.
  5596             20  CF-ST-STAT-DATE-FROM       PIC X.
  5597                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5598                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5599             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5600             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5601             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5602             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5603             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5604
  5605         16  CF-ST-OVER-SHORT.
  5606             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5607             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5608
  5609         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5610
  5611         16  CF-ST-RT-CALC                  PIC X.
  5612
  5613         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5614         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5615         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5616         16  CF-ST-RF-LR-CALC               PIC X.
  5617         16  CF-ST-RF-LL-CALC               PIC X.
  5618         16  CF-ST-RF-LN-CALC               PIC X.
  5619         16  CF-ST-RF-AH-CALC               PIC X.
  5620         16  CF-ST-RF-CP-CALC               PIC X.
  5621*        16  FILLER                         PIC X(206).
  5622*CIDMOD         16  FILLER                         PIC X(192).
  5623         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5624             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5625         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5626         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 104
* EL050.cbl
  5627         16  CF-ST-CAUSAL-STATE             PIC X.
  5628         16  FILLER                         PIC X(185).
  5629
  5630****************************************************************
  5631*             BENEFIT MASTER RECORD                            *
  5632****************************************************************
  5633
  5634     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5635         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5636             20  CF-BENEFIT-CODE            PIC XX.
  5637             20  CF-BENEFIT-NUMERIC  REDEFINES
  5638                 CF-BENEFIT-CODE            PIC XX.
  5639             20  CF-BENEFIT-ALPHA           PIC XXX.
  5640             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5641             20  CF-BENEFIT-COMMENT         PIC X(10).
  5642
  5643             20  CF-LF-COVERAGE-TYPE        PIC X.
  5644                 88  CF-REDUCING                VALUE 'R'.
  5645                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5646
  5647             20  CF-SPECIAL-CALC-CD         PIC X.
  5648                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5649                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5650                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5651                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5652                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5653                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5654                 88  CF-FARM-PLAN               VALUE 'F'.
  5655                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5656                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5657                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5658                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5659                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5660                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5661                 88  CF-PRUDENTIAL              VALUE 'P'.
  5662                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5663                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5664                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5665                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5666                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5667                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5668
  5669             20  CF-JOINT-INDICATOR         PIC X.
  5670                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5671
  5672*            20  FILLER                     PIC X(12).
  5673             20  FILLER                     PIC X(11).
  5674             20  CF-BENEFIT-CATEGORY        PIC X.
  5675             20  CF-LOAN-TYPE               PIC X(8).
  5676
  5677             20  CF-CO-REM-TERM-CALC        PIC X.
  5678                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5679                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5680                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5681                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5682                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5683
  5684             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 105
* EL050.cbl
  5685                 88  CO-EARN-BY-R78             VALUE '1'.
  5686                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5687                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5688                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5689                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5690                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5691                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5692                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5693
  5694             20  CF-CO-REFUND-CALC          PIC X.
  5695                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5696                 88  CO-REFD-BY-R78             VALUE '1'.
  5697                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5698                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5699                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5700                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5701                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5702                 88  CO-REFD-MEAN               VALUE '8'.
  5703                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5704                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5705                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5706
  5707             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5708                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5709                 88  CO-OVRD-BY-R78             VALUE '1'.
  5710                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5711                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5712                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5713                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5714                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5715                 88  CO-OVRD-MEAN               VALUE '8'.
  5716                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5717
  5718             20  CF-CO-BEN-I-G-CD           PIC X.
  5719                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5720                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5721                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5722
  5723         16  FILLER                         PIC X(304).
  5724
  5725
  5726****************************************************************
  5727*             CARRIER MASTER RECORD                            *
  5728****************************************************************
  5729
  5730     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5731         16  CF-ADDRESS-DATA.
  5732             20  CF-MAIL-TO-NAME            PIC X(30).
  5733             20  CF-IN-CARE-OF              PIC X(30).
  5734             20  CF-ADDRESS-LINE-1          PIC X(30).
  5735             20  CF-ADDRESS-LINE-2          PIC X(30).
  5736             20  CF-CITY-STATE              PIC X(30).
  5737             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5738             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5739
  5740         16  CF-CLAIM-NO-CONTROL.
  5741             20  CF-CLAIM-NO-METHOD         PIC X.
  5742                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 106
* EL050.cbl
  5743                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5744                 88  CLAIM-NO-SEQ               VALUE '3'.
  5745                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5746             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5747                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5748                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5749                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5750
  5751         16  CF-CHECK-NO-CONTROL.
  5752             20  CF-CHECK-NO-METHOD         PIC X.
  5753                 88  CHECK-NO-MANUAL            VALUE '1'.
  5754                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5755                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5756                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5757             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5758                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5759
  5760         16  CF-DOMICILE-STATE              PIC XX.
  5761
  5762         16  CF-EXPENSE-CONTROLS.
  5763             20  CF-EXPENSE-METHOD          PIC X.
  5764                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5765                 88  DOLLARS-PER-PMT            VALUE '2'.
  5766                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5767                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5768             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5769             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5770
  5771         16  CF-CORRESPONDENCE-CONTROL.
  5772             20  CF-LETTER-RESEND-OPT       PIC X.
  5773                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5774                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5775             20  FILLER                     PIC X(4).
  5776
  5777         16  CF-RESERVE-CONTROLS.
  5778             20  CF-MANUAL-SW               PIC X.
  5779                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5780             20  CF-FUTURE-SW               PIC X.
  5781                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5782             20  CF-PTC-SW                  PIC X.
  5783                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5784             20  CF-IBNR-SW                 PIC X.
  5785                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5786             20  CF-PTC-LF-SW               PIC X.
  5787                 88  CF-LF-PTC-USED             VALUE '1'.
  5788             20  CF-CDT-ACCESS-METHOD       PIC X.
  5789                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5790                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5791                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5792             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5793
  5794         16  CF-CLAIM-CALC-METHOD           PIC X.
  5795             88  360-PLUS-MONTHS                VALUE '1'.
  5796             88  365-PLUS-MONTHS                VALUE '2'.
  5797             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5798             88  360-DAILY                      VALUE '4'.
  5799             88  365-DAILY                      VALUE '5'.
  5800
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 107
* EL050.cbl
  5801         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5802         16  FILLER                         PIC X(11).
  5803
  5804         16  CF-LIMIT-AMOUNTS.
  5805             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5806             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5807             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5808             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5809             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5810             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5811             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5812             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5813             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5814             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5815
  5816         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5817         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5818         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5819
  5820         16  CF-ZIP-CODE.
  5821             20  CF-ZIP-PRIME.
  5822                 24  CF-ZIP-1ST             PIC X.
  5823                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5824                 24  FILLER                 PIC X(4).
  5825             20  CF-ZIP-PLUS4               PIC X(4).
  5826         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5827             20  CF-CAN-POSTAL-1            PIC XXX.
  5828             20  CF-CAN-POSTAL-2            PIC XXX.
  5829             20  FILLER                     PIC XXX.
  5830
  5831         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5832         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5833         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5834
  5835         16  CF-RATING-SWITCH               PIC X.
  5836             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5837             88  CF-NO-RATING                   VALUE 'N'.
  5838
  5839         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5840
  5841         16  CF-CARRIER-OVER-SHORT.
  5842             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5843             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5844
  5845         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5846         16  CF-SECPAY-SWITCH               PIC X.
  5847             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5848             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5849         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5850         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5851         16  FILLER                         PIC X(444).
  5852*        16  FILLER                         PIC X(452).
  5853
  5854
  5855****************************************************************
  5856*             MORTALITY MASTER RECORD                          *
  5857****************************************************************
  5858
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 108
* EL050.cbl
  5859     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5860         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5861                                INDEXED BY CF-MORT-NDX.
  5862             20  CF-MORT-TABLE              PIC X(5).
  5863             20  CF-MORT-TABLE-TYPE         PIC X.
  5864                 88  CF-MORT-JOINT              VALUE 'J'.
  5865                 88  CF-MORT-SINGLE             VALUE 'S'.
  5866                 88  CF-MORT-COMBINED           VALUE 'C'.
  5867                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5868                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5869             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5870             20  CF-MORT-AGE-METHOD         PIC XX.
  5871                 88  CF-AGE-LAST                VALUE 'AL'.
  5872                 88  CF-AGE-NEAR                VALUE 'AN'.
  5873             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5874             20  CF-MORT-ADJUSTMENT-DIRECTION
  5875                                            PIC X.
  5876                 88  CF-MINUS                   VALUE '-'.
  5877                 88  CF-PLUS                    VALUE '+'.
  5878             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5879             20  CF-MORT-JOINT-CODE         PIC X.
  5880                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5881             20  CF-MORT-PC-Q               PIC X.
  5882                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5883             20  CF-MORT-TABLE-CODE         PIC X(4).
  5884             20  CF-MORT-COMMENTS           PIC X(15).
  5885             20  FILLER                     PIC X(14).
  5886
  5887         16  FILLER                         PIC X(251).
  5888
  5889
  5890****************************************************************
  5891*             BUSSINESS TYPE MASTER RECORD                     *
  5892****************************************************************
  5893
  5894     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5895* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5896* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5897* AND RECORD 05 IS TYPES 81-99
  5898         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5899             20  CF-BUSINESS-TITLE          PIC  X(19).
  5900             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5901                                            PIC S9V9(4) COMP-3.
  5902             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5903             20  FILLER                     PIC  X.
  5904         16  FILLER                         PIC  X(248).
  5905
  5906
  5907****************************************************************
  5908*             TERMINAL MASTER RECORD                           *
  5909****************************************************************
  5910
  5911     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5912
  5913         16  CF-COMPANY-TERMINALS.
  5914             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5915                                  PIC X(4).
  5916         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 109
* EL050.cbl
  5917
  5918
  5919****************************************************************
  5920*             LIFE EDIT MASTER RECORD                          *
  5921****************************************************************
  5922
  5923     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5924         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5925             20  CF-LIFE-CODE-IN            PIC XX.
  5926             20  CF-LIFE-CODE-OUT           PIC XX.
  5927         16  FILLER                         PIC X(248).
  5928
  5929
  5930****************************************************************
  5931*             AH EDIT MASTER RECORD                            *
  5932****************************************************************
  5933
  5934     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5935         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5936             20  CF-AH-CODE-IN              PIC XXX.
  5937             20  CF-AH-CODE-OUT             PIC XX.
  5938         16  FILLER                         PIC X(248).
  5939
  5940
  5941****************************************************************
  5942*             CREDIBILITY TABLES                               *
  5943****************************************************************
  5944
  5945     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5946         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5947                             INDEXED BY CF-CRDB-NDX.
  5948             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5949             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5950             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5951         16  FILLER                         PIC  X(332).
  5952
  5953
  5954****************************************************************
  5955*             REPORT CUSTOMIZATION RECORD                      *
  5956****************************************************************
  5957
  5958     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5959         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5960             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5961             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5962             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5963**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5964****       A T-TRANSFER.                                   ****
  5965             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5966
  5967         16  FILLER                         PIC XX.
  5968
  5969         16  CF-CARRIER-CNTL-OPT.
  5970             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5971                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5972                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5973             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5974                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 110
* EL050.cbl
  5975         16  CF-GROUP-CNTL-OPT.
  5976             20  CF-GROUP-OPT-SEQ           PIC 9.
  5977                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5978                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5979             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5980                                            PIC X(6).
  5981         16  CF-STATE-CNTL-OPT.
  5982             20  CF-STATE-OPT-SEQ           PIC 9.
  5983                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5984                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5985             20  CF-STATE-SELECT OCCURS 3 TIMES
  5986                                            PIC XX.
  5987         16  CF-ACCOUNT-CNTL-OPT.
  5988             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5989                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5990                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5991             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5992                                            PIC X(10).
  5993         16  CF-BUS-TYP-CNTL-OPT.
  5994             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5995                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5996                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5997             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5998                                            PIC XX.
  5999         16  CF-LF-TYP-CNTL-OPT.
  6000             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6001                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6002                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6003             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6004                                            PIC XX.
  6005         16  CF-AH-TYP-CNTL-OPT.
  6006             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6007                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6008                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6009             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6010                                            PIC XX.
  6011         16  CF-REPTCD1-CNTL-OPT.
  6012             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6013                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6014                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6015             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6016                                            PIC X(10).
  6017         16  CF-REPTCD2-CNTL-OPT.
  6018             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6019                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6020                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6021             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6022                                            PIC X(10).
  6023         16  CF-USER1-CNTL-OPT.
  6024             20  CF-USER1-OPT-SEQ           PIC 9.
  6025                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6026                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6027             20  CF-USER1-SELECT OCCURS 3 TIMES
  6028                                            PIC X(10).
  6029         16  CF-USER2-CNTL-OPT.
  6030             20  CF-USER2-OPT-SEQ           PIC 9.
  6031                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6032                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 111
* EL050.cbl
  6033             20  CF-USER2-SELECT OCCURS 3 TIMES
  6034                                            PIC X(10).
  6035         16  CF-USER3-CNTL-OPT.
  6036             20  CF-USER3-OPT-SEQ           PIC 9.
  6037                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6038                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6039             20  CF-USER3-SELECT OCCURS 3 TIMES
  6040                                            PIC X(10).
  6041         16  CF-USER4-CNTL-OPT.
  6042             20  CF-USER4-OPT-SEQ           PIC 9.
  6043                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6044                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6045             20  CF-USER4-SELECT OCCURS 3 TIMES
  6046                                            PIC X(10).
  6047         16  CF-USER5-CNTL-OPT.
  6048             20  CF-USER5-OPT-SEQ           PIC 9.
  6049                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6050                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6051             20  CF-USER5-SELECT OCCURS 3 TIMES
  6052                                            PIC X(10).
  6053         16  CF-REINS-CNTL-OPT.
  6054             20  CF-REINS-OPT-SEQ           PIC 9.
  6055                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6056                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6057             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6058                 24  CF-REINS-PRIME         PIC XXX.
  6059                 24  CF-REINS-SUB           PIC XXX.
  6060
  6061         16  CF-AGENT-CNTL-OPT.
  6062             20  CF-AGENT-OPT-SEQ           PIC 9.
  6063                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6064                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6065             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6066                                            PIC X(10).
  6067
  6068         16  FILLER                         PIC X(43).
  6069
  6070         16  CF-LOSS-RATIO-SELECT.
  6071             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6072             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6073         16  CF-ENTRY-DATE-SELECT.
  6074             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6075             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6076         16  CF-EFFECTIVE-DATE-SELECT.
  6077             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6078             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6079
  6080         16  CF-EXCEPTION-LIST-IND          PIC X.
  6081             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6082
  6083         16  FILLER                         PIC X(318).
  6084
  6085****************************************************************
  6086*                  EXCEPTION REPORTING RECORD                  *
  6087****************************************************************
  6088
  6089     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6090         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 112
* EL050.cbl
  6091             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6092
  6093         16  CF-COMBINED-LIFE-AH-OPT.
  6094             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6095             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6096             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6097             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6098
  6099         16  CF-LIFE-OPT.
  6100             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6101             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6102             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6103             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6104             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6105             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6106             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6107             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6108             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6109             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6110
  6111         16  CF-AH-OPT.
  6112             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6113             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6114             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6115             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6116             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6117             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6118             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6119             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6120             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6121             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6122
  6123         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6124             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6125             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6126             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6127
  6128         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6129
  6130         16  FILLER                         PIC X(673).
  6131
  6132
  6133****************************************************************
  6134*             MORTGAGE SYSTEM PLAN RECORD                      *
  6135****************************************************************
  6136
  6137     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6138         16  CF-PLAN-TYPE                   PIC X.
  6139             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6140             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6141             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6142         16  CF-PLAN-ABBREV                 PIC XXX.
  6143         16  CF-PLAN-DESCRIPT               PIC X(10).
  6144         16  CF-PLAN-NOTES                  PIC X(20).
  6145         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6146         16  CF-PLAN-UNDERWRITING.
  6147             20  CF-PLAN-TERM-DATA.
  6148                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 113
* EL050.cbl
  6149                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6150             20  CF-PLAN-AGE-DATA.
  6151                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6152                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6153                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6154             20  CF-PLAN-BENEFIT-DATA.
  6155                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6156                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6157                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6158                                            PIC S9(7)V99  COMP-3.
  6159         16  CF-PLAN-POLICY-FORMS.
  6160             20  CF-POLICY-FORM             PIC X(12).
  6161             20  CF-MASTER-APPLICATION      PIC X(12).
  6162             20  CF-MASTER-POLICY           PIC X(12).
  6163         16  CF-PLAN-RATING.
  6164             20  CF-RATE-CODE               PIC X(5).
  6165             20  CF-SEX-RATING              PIC X.
  6166                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6167                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6168             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6169             20  CF-SUB-STD-TYPE            PIC X.
  6170                 88  CF-PCT-OF-PREM            VALUE '1'.
  6171                 88  CF-PCT-OF-BENE            VALUE '2'.
  6172         16  CF-PLAN-PREM-TOLERANCES.
  6173             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6174             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6175         16  CF-PLAN-PYMT-TOLERANCES.
  6176             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6177             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6178         16  CF-PLAN-MISC-DATA.
  6179             20  FILLER                     PIC X.
  6180             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6181             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6182         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6183         16  CF-PLAN-IND-GRP                PIC X.
  6184             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6185                                                     '1'.
  6186             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6187                                                     '2'.
  6188         16  CF-MIB-SEARCH-SW               PIC X.
  6189             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6190             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6191             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6192             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6193         16  CF-ALPHA-SEARCH-SW             PIC X.
  6194             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6195             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6196             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6197             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6198             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6199             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6200             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6201             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6202             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6203             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6204                                                     'A' 'B' 'C'
  6205                                                     'X' 'Y' 'Z'.
  6206         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 114
* EL050.cbl
  6207             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6208             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6209             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6210             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6211             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6212         16  FILLER                         PIC X(4).
  6213         16  CF-HEALTH-QUESTIONS            PIC X.
  6214             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6215         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6216         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6217         16  CF-PLAN-SNGL-JNT               PIC X.
  6218             88  CF-COMBINED-PLAN              VALUE 'C'.
  6219             88  CF-JNT-PLAN                   VALUE 'J'.
  6220             88  CF-SNGL-PLAN                  VALUE 'S'.
  6221         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6222         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6223         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6224         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6225         16  CF-RERATE-CNTL                 PIC  X.
  6226             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6227             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6228             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6229             88  CF-AUTO-RECALC                 VALUE '4'.
  6230         16  CF-BENEFIT-TYPE                PIC  X.
  6231             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6232             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6233         16  CF-POLICY-FEE                  PIC S999V99
  6234                                                    COMP-3.
  6235         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6236         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6237         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6238         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6239         16  FILLER                         PIC  X(32).
  6240         16  CF-TERMINATION-FORM            PIC  X(04).
  6241         16  FILLER                         PIC  X(08).
  6242         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6243                                                       COMP-3.
  6244         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6245         16  CF-ISSUE-LETTER                PIC  X(4).
  6246         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6247         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6248             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6249             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6250         16  CF-MP-REFUND-CALC              PIC X.
  6251             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6252             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6253             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6254             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6255             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6256             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6257             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6258             88  CF-MP-REFD-MEAN                VALUE '8'.
  6259         16  CF-ALT-RATE-CODE               PIC  X(5).
  6260
  6261
  6262         16  FILLER                         PIC X(498).
  6263****************************************************************
  6264*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 115
* EL050.cbl
  6265****************************************************************
  6266
  6267     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6268         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6269         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6270             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6271             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6272             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6273             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6274             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6275
  6276         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6277         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6278         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6279         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6280         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6281
  6282         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6283             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6284         16  CF-MP-RECON-USE-IND            PIC X(1).
  6285             88  CF-MP-USE-RECON             VALUE 'Y'.
  6286         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6287             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6288         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6289             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6290             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6291         16  FILLER                         PIC X(1).
  6292         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6293             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6294         16  CF-MORTG-MIB-VERSION           PIC X.
  6295             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6296             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6297             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6298         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6299             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6300                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6301             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6302                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6303             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6304                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6305             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6306                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6307             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6308                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6309             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6310                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6311         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6312         16  FILLER                         PIC X(7).
  6313         16  CF-MORTG-DESTINATION-SYMBOL.
  6314             20  CF-MORTG-MIB-COMM          PIC X(5).
  6315             20  CF-MORTG-MIB-TERM          PIC X(5).
  6316         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6317             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6318         16  FILLER                         PIC X(03).
  6319         16  CF-MP-CHECK-NO-CONTROL.
  6320             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6321                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6322                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 116
* EL050.cbl
  6323                                                ' ' LOW-VALUES.
  6324                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6325                                               VALUE '3'.
  6326         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6327         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6328         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6329             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6330                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6331             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6332                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6333             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6334                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6335             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6336                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6337             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6338                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6339             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6340                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6341         16  CF-MORTG-BILLING-AREA.
  6342             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6343                                            PIC X.
  6344         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6345         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6346         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6347         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6348             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6349             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6350         16  FILLER                         PIC X.
  6351         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6352             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6353             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6354         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6355         16  FILLER                         PIC X(8).
  6356         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6357         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6358         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6359         16  CF-ACH-COMPANY-ID.
  6360             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6361                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6362                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6363                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6364             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6365         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6366             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6367         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6368             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6369             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6370         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6371         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6372         16  FILLER                         PIC X(536).
  6373
  6374****************************************************************
  6375*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6376****************************************************************
  6377
  6378     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6379         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6380             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 117
* EL050.cbl
  6381                 24  CF-FEMALE-FT           PIC 99.
  6382                 24  CF-FEMALE-IN           PIC 99.
  6383             20  CF-FEMALE-MIN-WT           PIC 999.
  6384             20  CF-FEMALE-MAX-WT           PIC 999.
  6385         16  FILLER                         PIC X(428).
  6386
  6387     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6388         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6389             20  CF-MALE-HEIGHT.
  6390                 24  CF-MALE-FT             PIC 99.
  6391                 24  CF-MALE-IN             PIC 99.
  6392             20  CF-MALE-MIN-WT             PIC 999.
  6393             20  CF-MALE-MAX-WT             PIC 999.
  6394         16  FILLER                         PIC X(428).
  6395******************************************************************
  6396*             AUTOMATIC ACTIVITY RECORD                          *
  6397******************************************************************
  6398     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6399         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6400             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6401             20  CF-SYS-LETTER-ID           PIC X(04).
  6402             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6403             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6404             20  CF-SYS-RESET-SW            PIC X(01).
  6405             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6406             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6407
  6408         16  FILLER                         PIC X(50).
  6409
  6410         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6411             20  CF-USER-ACTIVE-SW          PIC X(01).
  6412             20  CF-USER-LETTER-ID          PIC X(04).
  6413             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6414             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6415             20  CF-USER-RESET-SW           PIC X(01).
  6416             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6417             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6418             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6419
  6420         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 118
* EL050.cbl
  6422*    COPY ERCACCT.
  6423******************************************************************
  6424*                                                                *
  6425*                                                                *
  6426*                            ERCACCT                             *
  6427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6428*                            VMOD=2.031                          *
  6429*                                                                *
  6430*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6431*                                                                *
  6432*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6433*   VSAM ACCOUNT MASTER FILES.                                   *
  6434*                                                                *
  6435*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6436*                                                                *
  6437*   FILE TYPE = VSAM,KSDS                                        *
  6438*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6439*                                                                *
  6440*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6441*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6442*                                                                *
  6443*   LOG = NO                                                     *
  6444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6445*                                                                *
  6446*                                                                *
  6447******************************************************************
  6448*                   C H A N G E   L O G
  6449*
  6450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6451*-----------------------------------------------------------------
  6452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6453* EFFECTIVE    NUMBER
  6454*-----------------------------------------------------------------
  6455* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6456* 092705    2005050300006  PEMA  ADD SPP LEASES
  6457* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6458* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6459* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6460* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6461* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6462******************************************************************
  6463
  6464 01  ACCOUNT-MASTER.
  6465     12  AM-RECORD-ID                      PIC XX.
  6466         88  VALID-AM-ID                      VALUE 'AM'.
  6467
  6468     12  AM-CONTROL-PRIMARY.
  6469         16  AM-COMPANY-CD                 PIC X.
  6470         16  AM-MSTR-CNTRL.
  6471             20  AM-CONTROL-A.
  6472                 24  AM-CARRIER            PIC X.
  6473                 24  AM-GROUPING.
  6474                     28 AM-GROUPING-PREFIX PIC XXX.
  6475                     28 AM-GROUPING-PRIME  PIC XXX.
  6476                 24  AM-STATE              PIC XX.
  6477                 24  AM-ACCOUNT.
  6478                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6479                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 119
* EL050.cbl
  6480             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6481                                           PIC X(19).
  6482             20  AM-CNTRL-B.
  6483                 24  AM-EXPIRATION-DT      PIC XX.
  6484                 24  FILLER                PIC X(4).
  6485             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6486                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6487
  6488     12  AM-CONTROL-BY-VAR-GRP.
  6489         16  AM-COMPANY-CD-A1              PIC X.
  6490         16  AM-VG-CARRIER                 PIC X.
  6491         16  AM-VG-GROUPING                PIC X(6).
  6492         16  AM-VG-STATE                   PIC XX.
  6493         16  AM-VG-ACCOUNT                 PIC X(10).
  6494         16  AM-VG-DATE.
  6495             20  AM-VG-EXPIRATION-DT       PIC XX.
  6496             20  FILLER                    PIC X(4).
  6497         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6498                                           PIC 9(11)      COMP-3.
  6499     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6500         16  FILLER                        PIC X(10).
  6501         16  AM-VG-KEY3.
  6502             20  AM-VG3-ACCOUNT            PIC X(10).
  6503             20  AM-VG3-EXP-DT             PIC XX.
  6504         16  FILLER                        PIC X(4).
  6505     12  AM-MAINT-INFORMATION.
  6506         16  AM-LAST-MAINT-DT              PIC XX.
  6507         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6508         16  AM-LAST-MAINT-USER            PIC X(4).
  6509         16  FILLER                        PIC XX.
  6510
  6511     12  AM-EFFECTIVE-DT                   PIC XX.
  6512     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6513
  6514     12  AM-PREV-DATES  COMP-3.
  6515         16  AM-PREV-EXP-DT                PIC 9(11).
  6516         16  AM-PREV-EFF-DT                PIC 9(11).
  6517
  6518     12  AM-REPORT-CODE-1                  PIC X(10).
  6519     12  AM-REPORT-CODE-2                  PIC X(10).
  6520
  6521     12  AM-CITY-CODE                      PIC X(4).
  6522     12  AM-COUNTY-PARISH                  PIC X(6).
  6523
  6524     12  AM-NAME                           PIC X(30).
  6525     12  AM-PERSON                         PIC X(30).
  6526     12  AM-ADDRS                          PIC X(30).
  6527     12  AM-CITY.
  6528         16  AM-ADDR-CITY                  PIC X(28).
  6529         16  AM-ADDR-STATE                 PIC XX.
  6530     12  AM-ZIP.
  6531         16  AM-ZIP-PRIME.
  6532             20  AM-ZIP-PRI-1ST            PIC X.
  6533                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6534             20  FILLER                    PIC X(4).
  6535         16  AM-ZIP-PLUS4                  PIC X(4).
  6536     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6537         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 120
* EL050.cbl
  6538         16  AM-CAN-POSTAL-2               PIC XXX.
  6539         16  FILLER                        PIC XXX.
  6540     12  AM-TEL-NO.
  6541         16  AM-AREA-CODE                  PIC 999.
  6542         16  AM-TEL-PRE                    PIC 999.
  6543         16  AM-TEL-NBR                    PIC 9(4).
  6544     12  AM-TEL-LOC                        PIC X.
  6545         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6546         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6547
  6548     12  AM-COMM-STRUCTURE.
  6549         16  AM-DEFN-1.
  6550             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6551                 24  AM-AGT.
  6552                     28  AM-AGT-PREFIX     PIC X(4).
  6553                     28  AM-AGT-PRIME      PIC X(6).
  6554                 24  AM-COM-TYP            PIC X.
  6555                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6556                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6557                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6558                 24  AM-RECALC-LV-INDIC    PIC X.
  6559                 24  AM-RETRO-LV-INDIC     PIC X.
  6560                 24  AM-GL-CODES           PIC X.
  6561                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6562                 24  FILLER                PIC X(01).
  6563         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6564             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6565                 24  FILLER                PIC X(11).
  6566                 24  AM-L-COMA             PIC XXX.
  6567                 24  AM-J-COMA             PIC XXX.
  6568                 24  AM-A-COMA             PIC XXX.
  6569                 24  FILLER                PIC X(6).
  6570
  6571     12  AM-COMM-CHANGE-STATUS             PIC X.
  6572         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6573
  6574     12  AM-CSR-CODE                       PIC X(4).
  6575
  6576     12  AM-BILLING-STATUS                 PIC X.
  6577         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6578         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6579     12  AM-AUTO-REFUND-SW                 PIC X.
  6580         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6581         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6582     12  AM-GPCD                           PIC 99.
  6583     12  AM-IG                             PIC X.
  6584         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6585         88  AM-HAS-GROUP                     VALUE '2'.
  6586     12  AM-STATUS                         PIC X.
  6587         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6588         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6589         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6590         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6591         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6592         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6593     12  AM-REMIT-TO                       PIC 99.
  6594     12  AM-ID-NO                          PIC X(11).
  6595
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 121
* EL050.cbl
  6596     12  AM-CAL-TABLE                      PIC XX.
  6597     12  AM-LF-DEVIATION                   PIC XXX.
  6598     12  AM-AH-DEVIATION                   PIC XXX.
  6599     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6600     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6601     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6602     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6603     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6604     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6605
  6606     12  AM-USER-FIELDS.
  6607         16  AM-FLD-1                      PIC XX.
  6608         16  AM-FLD-2                      PIC XX.
  6609         16  AM-FLD-3                      PIC XX.
  6610         16  AM-FLD-4                      PIC XX.
  6611         16  AM-FLD-5                      PIC XX.
  6612
  6613     12  AM-1ST-PROD-DATE.
  6614         16  AM-1ST-PROD-YR                PIC XX.
  6615         16  AM-1ST-PROD-MO                PIC XX.
  6616         16  AM-1ST-PROD-DA                PIC XX.
  6617     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6618     12  AM-CERTS-PURGED-DATE.
  6619         16  AM-PUR-YR                     PIC XX.
  6620         16  AM-PUR-MO                     PIC XX.
  6621         16  AM-PUR-DA                     PIC XX.
  6622     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6623     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6624     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6625     12  AM-INACTIVE-DATE.
  6626         16  AM-INA-MO                     PIC 99.
  6627         16  AM-INA-DA                     PIC 99.
  6628         16  AM-INA-YR                     PIC 99.
  6629     12  AM-AR-HI-CERT-DATE                PIC XX.
  6630
  6631     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6632     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6633
  6634     12  AM-OB-PAYMENT-MODE                PIC X.
  6635         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6636         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6637         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6638         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6639
  6640     12  AM-AH-ONLY-INDICATOR              PIC X.
  6641         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6642         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6643
  6644     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6645
  6646     12  AM-OVER-SHORT.
  6647         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6648         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6649
  6650     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6651     12  AM-DCC-CLP-STATE                  PIC XX.
  6652
  6653     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 122
* EL050.cbl
  6654     12  AM-RECALC-REIN                    PIC X.
  6655
  6656     12  AM-REI-TABLE                      PIC XXX.
  6657     12  AM-REI-ET-LF                      PIC X.
  6658     12  AM-REI-ET-AH                      PIC X.
  6659     12  AM-REI-PE-LF                      PIC X.
  6660     12  AM-REI-PE-AH                      PIC X.
  6661     12  AM-REI-PRT-ST                     PIC X.
  6662     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6665     12  AM-REI-GROUP-A                    PIC X(6).
  6666     12  AM-REI-MORT                       PIC X(4).
  6667     12  AM-REI-PRT-OW                     PIC X.
  6668     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6669     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6670     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6671     12  AM-REI-GROUP-B                    PIC X(6).
  6672
  6673     12  AM-TRUST-TYPE                     PIC X(2).
  6674
  6675     12  AM-EMPLOYER-STMT-USED             PIC X.
  6676     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6677
  6678     12  AM-STD-AH-TYPE                    PIC XX.
  6679     12  AM-EARN-METHODS.
  6680         16  AM-EARN-METHOD-R              PIC X.
  6681             88 AM-REF-RL-R78                 VALUE 'R'.
  6682             88 AM-REF-RL-PR                  VALUE 'P'.
  6683             88 AM-REF-RL-MEAN                VALUE 'M'.
  6684             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6685         16  AM-EARN-METHOD-L              PIC X.
  6686             88 AM-REF-LL-R78                 VALUE 'R'.
  6687             88 AM-REF-LL-PR                  VALUE 'P'.
  6688             88 AM-REF-LL-MEAN                VALUE 'M'.
  6689             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6690         16  AM-EARN-METHOD-A              PIC X.
  6691             88 AM-REF-AH-R78                 VALUE 'R'.
  6692             88 AM-REF-AH-PR                  VALUE 'P'.
  6693             88 AM-REF-AH-MEAN                VALUE 'M'.
  6694             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6695             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6696             88 AM-REF-AH-NET                 VALUE 'N'.
  6697
  6698     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6699     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6700     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6701
  6702     12  AM-RET-Y-N                        PIC X.
  6703     12  AM-RET-P-E                        PIC X.
  6704     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6705     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6706     12  AM-RET-GRP                        PIC X(6).
  6707     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6708         16  AM-POOL-PRIME                 PIC XXX.
  6709         16  AM-POOL-SUB                   PIC XXX.
  6710     12  AM-RETRO-EARNINGS.
  6711         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 123
* EL050.cbl
  6712         16  AM-RET-EARN-L                 PIC X.
  6713         16  AM-RET-EARN-A                 PIC X.
  6714     12  AM-RET-ST-TAX-USE                 PIC X.
  6715         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6716         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6717     12  AM-RETRO-BEG-EARNINGS.
  6718         16  AM-RET-BEG-EARN-R             PIC X.
  6719         16  AM-RET-BEG-EARN-L             PIC X.
  6720         16  AM-RET-BEG-EARN-A             PIC X.
  6721     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6722     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6723
  6724     12  AM-USER-SELECT-OPTIONS.
  6725         16  AM-USER-SELECT-1              PIC X(10).
  6726         16  AM-USER-SELECT-2              PIC X(10).
  6727         16  AM-USER-SELECT-3              PIC X(10).
  6728         16  AM-USER-SELECT-4              PIC X(10).
  6729         16  AM-USER-SELECT-5              PIC X(10).
  6730
  6731     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6732
  6733     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6734
  6735     12  AM-RPT045A-SWITCH                 PIC X.
  6736         88  RPT045A-OFF                   VALUE 'N'.
  6737
  6738     12  AM-INSURANCE-LIMITS.
  6739         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6740         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6741
  6742     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6743         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6744
  6745     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6746         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6747         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6748
  6749     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6750
  6751     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6752     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6753     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6754     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6755     12  AM-DCC-UEF-STATE                  PIC XX.
  6756     12  FILLER                            PIC XXX.
  6757     12  AM-REPORT-CODE-3                  PIC X(10).
  6758*    12  FILLER                            PIC X(22).
  6759
  6760     12  AM-RESERVE-DATE.
  6761         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6762         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6763         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6764
  6765     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6766     12  AM-NOTIFICATION-TYPES.
  6767         16  AM-NOTIF-OF-LETTERS           PIC X.
  6768         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6769         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 124
* EL050.cbl
  6770         16  AM-NOTIF-OF-STATUS            PIC X.
  6771
  6772     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6773         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6774         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6775         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6776         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6777
  6778     12  AM-BENEFIT-CONTROLS.
  6779         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6780             20  AM-BENEFIT-CODE           PIC XX.
  6781             20  AM-BENEFIT-TYPE           PIC X.
  6782             20  AM-BENEFIT-REVISION       PIC XXX.
  6783             20  AM-BENEFIT-REM-TERM       PIC X.
  6784             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6785             20  FILLER                    PIC XX.
  6786         16  FILLER                        PIC X(80).
  6787
  6788     12  AM-TRANSFER-DATA.
  6789         16  AM-TRANSFERRED-FROM.
  6790             20  AM-TRNFROM-CARRIER        PIC X.
  6791             20  AM-TRNFROM-GROUPING.
  6792                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6793                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6794             20  AM-TRNFROM-STATE          PIC XX.
  6795             20  AM-TRNFROM-ACCOUNT.
  6796                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6797                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6798             20  AM-TRNFROM-DTE            PIC XX.
  6799         16  AM-TRANSFERRED-TO.
  6800             20  AM-TRNTO-CARRIER          PIC X.
  6801             20  AM-TRNTO-GROUPING.
  6802                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6803                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6804             20  AM-TRNTO-STATE            PIC XX.
  6805             20  AM-TRNTO-ACCOUNT.
  6806                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6807                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6808             20  AM-TRNTO-DTE              PIC XX.
  6809         16  FILLER                        PIC X(10).
  6810
  6811     12  AM-SAVED-REMIT-TO                 PIC 99.
  6812
  6813     12  AM-COMM-STRUCTURE-SAVED.
  6814         16  AM-DEFN-1-SAVED.
  6815             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6816                 24  AM-AGT-SV             PIC X(10).
  6817                 24  AM-COM-TYP-SV         PIC X.
  6818                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6819                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6820                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6821                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6822                 24  FILLER                PIC X.
  6823                 24  AM-GL-CODES-SV        PIC X.
  6824                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6825                 24  FILLER                PIC X.
  6826         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6827             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 125
* EL050.cbl
  6828                 24  FILLER                PIC X(11).
  6829                 24  AM-L-COMA-SV          PIC XXX.
  6830                 24  AM-J-COMA-SV          PIC XXX.
  6831                 24  AM-A-COMA-SV          PIC XXX.
  6832                 24  FILLER                PIC X(6).
  6833
  6834     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6835         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6836            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6837            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6838            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6839
  6840     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6841     12  FILLER                            PIC X(120).
  6842
  6843     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6844         16  AM-CONTROL-NAME               PIC X(30).
  6845         16  AM-EXECUTIVE-ONE.
  6846             20  AM-EXEC1-NAME             PIC X(15).
  6847             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6848                                                          COMP-3.
  6849             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6850                                                          COMP-3.
  6851         16  AM-EXECUTIVE-TWO.
  6852             20  AM-EXEC2-NAME             PIC X(15).
  6853             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6854                                                          COMP-3.
  6855             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6856                                                          COMP-3.
  6857
  6858     12  AM-RETRO-ADDITIONAL-DATA.
  6859         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6860         16  AM-RETRO-PREM-P-E             PIC X.
  6861         16  AM-RETRO-CLMS-P-I             PIC X.
  6862         16  AM-RETRO-RET-BRACKET-LF.
  6863             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6864                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6865                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6866             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6867                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6868                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6869             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6870                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6871                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6872         16  AM-RETRO-RET-BRACKET-AH.
  6873             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6874                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6875                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6876                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6877             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6878                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6879                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6880             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6881                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6882                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6883
  6884     12  AM-COMMENTS.
  6885         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 126
* EL050.cbl
  6886
  6887     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6888         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6889         16  AM-FLI-BILLING-CODE           PIC X.
  6890         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6891         16  AM-FLI-UNITED-IDENT           PIC X.
  6892         16  AM-FLI-INTEREST-LOST-DATA.
  6893             20  AM-FLI-BANK-NO            PIC X(5).
  6894             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6895             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6896             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6897         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6898             20  AM-FLI-AGT                PIC X(9).
  6899             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6900             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6901         16  FILLER                        PIC X(102).
  6902
  6903     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6904         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6905             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6906             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6907             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6908             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6909             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6910         16  FILLER                          PIC X(10).
  6911******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 127
* EL050.cbl
  6913*    COPY ERCREIN.
  6914******************************************************************
  6915*                                                                *
  6916*                            ERCREIN                             *
  6917*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6918*                            VMOD=2.010                          *
  6919*                                                                *
  6920*   ONLINE CREDIT SYSTEM                                         *
  6921*                                                                *
  6922*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6923*                                                                *
  6924*   FILE TYPE = VSAM,KSDS                                        *
  6925*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6926*                                                                *
  6927*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6928*       ALTERNATE PATH = NONE                                    *
  6929*                                                                *
  6930*   LOG = NO                                                     *
  6931*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6932*                                                                *
  6933******************************************************************
  6934*                   C H A N G E   L O G
  6935*
  6936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6937*-----------------------------------------------------------------
  6938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6939* EFFECTIVE    NUMBER
  6940*-----------------------------------------------------------------
  6941* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6942* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6943******************************************************************
  6944 01  REINSURANCE-RECORD.
  6945     12  RE-RECORD-ID                      PIC XX.
  6946         88  VALID-RE-ID                      VALUE 'RE'.
  6947
  6948     12  RE-CONTROL-PRIMARY.
  6949         16  RE-COMPANY-CD                 PIC X.
  6950         16  RE-KEY.
  6951             20  RE-CODE                   PIC X.
  6952                 88  RE-TABLE-RECORD          VALUE 'A'.
  6953                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6954             20  RE-TABLE                  PIC XXX.
  6955             20  FILLER                    PIC XXX.
  6956         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6957             20  FILLER                    PIC X.
  6958             20  RE-COMPANY.
  6959                 24  RE-COMP-PRIME         PIC XXX.
  6960                 24  RE-COMP-SUB           PIC XXX.
  6961
  6962     12  RE-MAINT-INFORMATION.
  6963         16  RE-LAST-MAINT-DT              PIC XX.
  6964         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6965         16  RE-LAST-MAINT-USER            PIC X(4).
  6966         16  FILLER                        PIC X(10).
  6967
  6968     12  RE-TABLE-DATA.
  6969         16  RE-100-COMP                   PIC 99.
  6970
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 128
* EL050.cbl
  6971         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6972             20  RE-REI-COMP-NO.
  6973                 24  RE-REI-COMP           PIC XXX.
  6974                 24  RE-REI-COMP-SUB       PIC XXX.
  6975             20  RE-LF-QC                  PIC X.
  6976             20  RE-AH-QC                  PIC X.
  6977             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6978             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6979             20  RE-LFAGE-LO               PIC 99.
  6980             20  RE-LFAGE-HI               PIC 99.
  6981             20  RE-AHAGE-LO               PIC 99.
  6982             20  RE-AHAGE-HI               PIC 99.
  6983             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6984             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6985             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6986             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6987             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6988             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6989             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6990             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6991             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6992             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6993             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6994             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6995             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6996             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6997             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6998             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6999             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7000             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7001             20  RE-LF-BEN-CODE            PIC X.
  7002             20  RE-AH-BEN-CODE            PIC X.
  7003             20  RE-INTERACTIVE            PIC X.
  7004             20  RE-REMAINING              PIC X.
  7005             20  RE-LF-RUNOFF-SW           PIC X.
  7006             20  RE-AH-RUNOFF-SW           PIC X.
  7007             20  FILLER                    PIC X(19).
  7008
  7009         16  RE-COMP-INFO-END              PIC X(6).
  7010         16  RE-NSP-ST-CD-LF               PIC XX.
  7011         16  RE-NSP-ST-CD-AH               PIC XX.
  7012         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7013             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7014
  7015         16  FILLER                        PIC X(27).
  7016
  7017     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7018         16  RE-NAME                       PIC X(30).
  7019         16  RE-LF-PE                      PIC X.
  7020         16  RE-AH-PE                      PIC X.
  7021         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7022         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7023         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7024         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7025         16  RE-PRT-ST                     PIC X.
  7026         16  RE-PRT-OW                     PIC X.
  7027         16  RE-MORT-CODE                  PIC X(4).
  7028         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 129
* EL050.cbl
  7029         16  RE-ZERO-LF-FEE                PIC X.
  7030         16  RE-ZERO-AH-FEE                PIC X.
  7031         16  RE-CEDE-NAME                  PIC X(30).
  7032         16  RE-LF-COMM                    PIC X.
  7033         16  RE-AH-COMM                    PIC X.
  7034         16  RE-LF-TAX                     PIC X.
  7035         16  RE-AH-TAX                     PIC X.
  7036         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7037         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7038         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7039
  7040         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7041             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7042
  7043         16  RE-LF-CEDING-FEE-BRACKETS.
  7044             20  RE-LF-FEE-METHOD          PIC X.
  7045                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7046                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7047                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7048                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7049             20  RE-LF-FEE-BASIS           PIC X.
  7050                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7051                 88  RE-LF-NET-CEDED               VALUE '2'.
  7052                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7053                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7054                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7055                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7056                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7057                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7058             20  FILLER                    PIC XXX.
  7059             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7060                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7061                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7062
  7063         16  RE-AH-CEDING-FEE-BRACKETS.
  7064             20  RE-AH-FEE-METHOD          PIC X.
  7065                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7066                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7067                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7068                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7069             20  RE-AH-FEE-BASIS           PIC X.
  7070                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7071                 88  RE-AH-NET-CEDED               VALUE '2'.
  7072                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7073                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7074                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7075                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7076                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7077                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7078             20  FILLER                    PIC XXX.
  7079             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7080                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7081                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7082
  7083         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7084
  7085         16  RE-OLD-CEDING-STMT            PIC X.
  7086
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 130
* EL050.cbl
  7087         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7088         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7089         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7090         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7091         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7092         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7093         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7094         16  RE-MORT-SW                    PIC X.
  7095         16  RE-CEDING-TYPE-FLAG           PIC X.
  7096             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7097             88  RE-CEDED                          VALUE 'C'.
  7098             88  RE-ASSUMED                        VALUE 'A'.
  7099             88  RE-PHANTOM                        VALUE 'P'.
  7100
  7101         16  RE-CEDING-STMT-OPT-A          PIC X.
  7102             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7103         16  RE-CEDING-STMT-OPT-B          PIC X.
  7104             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7105         16  RE-CEDING-STMT-OPT-C          PIC X.
  7106             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7107         16  RE-CEDING-STMT-OPT-D          PIC X.
  7108             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7109         16  RE-CEDING-STMT-OPT-E          PIC X.
  7110             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7111
  7112         16  RE-PRT-CRSV                   PIC X.
  7113
  7114         16  RE-GL-CENTER                  PIC X(4).
  7115
  7116         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7117
  7118         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7119
  7120         16  RE-EARN-STOP-CODE             PIC X.
  7121             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7122             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7123
  7124         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7125             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7126
  7127         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7128         16  FILLER                        PIC X(2281).
  7129
  7130         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7131
  7132******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 131
* EL050.cbl
  7134*    COPY ERCCTBL.
  7135******************************************************************
  7136*                                                                *
  7137*                                                                *
  7138*                            ERCCTBL                             *
  7139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7140*                            VMOD=2.003
  7141*                                                                *
  7142*   ONLINE CREDIT SYSTEM                                         *
  7143*                                                                *
  7144*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7145*                                                                *
  7146*   FILE TYPE = VSAM,KSDS                                        *
  7147*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7148*                                                                *
  7149*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7150*       ALTERNATE PATH = NONE                                    *
  7151*                                                                *
  7152*   LOG = NO                                                     *
  7153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7154*                                                                *
  7155*                                                                *
  7156******************************************************************
  7157
  7158 01  COMM-TABLE-RECORD.
  7159     12  CT-RECORD-ID                      PIC XX.
  7160         88  VALID-CT-ID                      VALUE 'CT'.
  7161
  7162     12  CT-CONTROL-PRIMARY.
  7163         16  CT-COMPANY-CD                 PIC X.
  7164         16  CT-TABLE                      PIC XXX.
  7165         16  CT-CNTRL-2.
  7166             20  CT-BEN-TYPE               PIC X.
  7167             20  CT-BEN-CODE               PIC XX.
  7168
  7169     12  CT-MAINT-INFORMATION.
  7170         16  CT-LAST-MAINT-DT              PIC XX.
  7171         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7172         16  CT-LAST-MAINT-USER            PIC X(4).
  7173         16  FILLER                        PIC X(31).
  7174
  7175     12  CT-LIMITS.
  7176         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7177
  7178         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7179
  7180         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7181
  7182     12  CT-RATES.
  7183         16  CT-RTX          OCCURS 27 TIMES.
  7184             20  CT-RT                     PIC SV9(5)     COMP-3.
  7185             20  CT-RT-R   REDEFINES
  7186                 CT-RT                     PIC XXX.
  7187
  7188     12  FILLER                            PIC  X(42).
  7189
  7190******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 132
* EL050.cbl
  7192*    COPY ERCFORM.
  7193******************************************************************
  7194*                                                                *
  7195*                                                                *
  7196*                            ERCFORM.                            *
  7197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7198*                            VMOD=2.003                          *
  7199*                                                                *
  7200*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7201*                                                                *
  7202*    FILE TYPE = VSAM,KSDS                                       *
  7203*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7204*                                                                *
  7205*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7206*                                                                *
  7207*    LOG = YES                                                   *
  7208*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7209******************************************************************
  7210 01  FORM-MASTER.
  7211    12  FO-RECORD-ID                 PIC X(02).
  7212        88  VALID-FO-ID                  VALUE 'FO'.
  7213
  7214    12  FO-CONTROL-PRIMARY.
  7215        16  FO-COMPANY-CD            PIC X(01).
  7216        16  FO-STATE                 PIC X(02).
  7217        16  FO-FORM-ID               PIC X(12).
  7218        16  FO-FORM-EXP-DT           PIC X(02).
  7219
  7220    12  FO-POLICY-FORM-DATA.
  7221        16  FO-IND-GRP-CD            PIC X(01).
  7222        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7223        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7224        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7225        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7226        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7227        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7228        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7229        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7230        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7231        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7232        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7233        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7234        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7235        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7236        16  FO-APP-CERT-USE-CD       PIC X(01).
  7237
  7238    12  FILLER                       PIC X(29).
  7239
  7240    12  FO-FORM-PLAN-TABLE.
  7241        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7242            20  FO-PLAN-TYPE         PIC X(01).
  7243            20  FO-PLAN-ID           PIC X(02).
  7244            20  FO-PLAN-TERM         PIC 9(03).
  7245            20  FO-PLAN-REFUND-METHOD
  7246                                     PIC X.
  7247
  7248    12  FILLER                       PIC X(30).
  7249
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 133
* EL050.cbl
  7250    12  FO-COMMENTS-AREA.
  7251        16  FO-COMMENT-LINE-1        PIC X(78).
  7252
  7253    12  FILLER                       PIC X(20).
  7254
  7255    12  FO-MAINT-INFORMATION.
  7256        16  FO-LAST-MAINT-DT         PIC X(02).
  7257        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7258        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 134
* EL050.cbl
  7260*    COPY ELCMSTR.
  7261******************************************************************
  7262*                                                                *
  7263*                            ELCMSTR.                            *
  7264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7265*                            VMOD=2.012                          *
  7266*                                                                *
  7267*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7268*                                                                *
  7269*   FILE TYPE = VSAM,KSDS                                        *
  7270*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7271*                                                                *
  7272*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7273*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7274*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7275*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7276*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7277*                                                 RKP=75,LEN=21  *
  7278*                                                                *
  7279*   **** NOTE ****                                               *
  7280*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7281*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7282*                                                                *
  7283*   LOG = YES                                                    *
  7284*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7285******************************************************************
  7286*                   C H A N G E   L O G
  7287*
  7288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7289*-----------------------------------------------------------------
  7290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7291* EFFECTIVE    NUMBER
  7292*-----------------------------------------------------------------
  7293* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7294* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7295* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7296******************************************************************
  7297 01  CLAIM-MASTER.
  7298     12  CL-RECORD-ID                PIC XX.
  7299         88  VALID-CL-ID         VALUE 'CL'.
  7300
  7301     12  CL-CONTROL-PRIMARY.
  7302         16  CL-COMPANY-CD           PIC X.
  7303         16  CL-CARRIER              PIC X.
  7304         16  CL-CLAIM-NO             PIC X(7).
  7305         16  CL-CERT-NO.
  7306             20  CL-CERT-PRIME       PIC X(10).
  7307             20  CL-CERT-SFX         PIC X.
  7308
  7309     12  CL-CONTROL-BY-NAME.
  7310         16  CL-COMPANY-CD-A1        PIC X.
  7311         16  CL-INSURED-LAST-NAME    PIC X(15).
  7312         16  CL-INSURED-NAME.
  7313             20  CL-INSURED-1ST-NAME PIC X(12).
  7314             20  CL-INSURED-MID-INIT PIC X.
  7315
  7316     12  CL-CONTROL-BY-SSN.
  7317         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 135
* EL050.cbl
  7318         16  CL-SOC-SEC-NO.
  7319             20  CL-SSN-STATE        PIC XX.
  7320             20  CL-SSN-ACCOUNT      PIC X(6).
  7321             20  CL-SSN-LN3          PIC X(3).
  7322
  7323     12  CL-CONTROL-BY-CERT-NO.
  7324         16  CL-COMPANY-CD-A4        PIC X.
  7325         16  CL-CERT-NO-A4.
  7326             20  CL-CERT-A4-PRIME    PIC X(10).
  7327             20  CL-CERT-A4-SFX      PIC X.
  7328
  7329     12  CL-CONTROL-BY-CCN.
  7330         16  CL-COMPANY-CD-A5        PIC X.
  7331         16  CL-CCN-A5.
  7332             20  CL-CCN.
  7333                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7334                 24  CL-CCN-PRIME-A5 PIC X(12).
  7335             20  CL-CCN-FILLER-A5    PIC X(4).
  7336
  7337     12  CL-INSURED-PROFILE-DATA.
  7338         16  CL-INSURED-BIRTH-DT     PIC XX.
  7339         16  CL-INSURED-SEX-CD       PIC X.
  7340             88  INSURED-IS-MALE        VALUE 'M'.
  7341             88  INSURED-IS-FEMALE      VALUE 'F'.
  7342             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7343         16  CL-INSURED-OCC-CD       PIC X(6).
  7344         16  FILLER                  PIC X(5).
  7345
  7346     12  CL-PROCESSING-INFO.
  7347         16  CL-PROCESSOR-ID         PIC X(4).
  7348         16  CL-CLAIM-STATUS         PIC X.
  7349             88  CLAIM-IS-OPEN          VALUE 'O'.
  7350             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7351         16  CL-CLAIM-TYPE           PIC X.
  7352*            88  AH-CLAIM               VALUE 'A'.
  7353*            88  LIFE-CLAIM             VALUE 'L'.
  7354*            88  PROPERTY-CLAIM         VALUE 'P'.
  7355*            88  IUI-CLAIM              VALUE 'I'.
  7356*            88  GAP-CLAIM              VALUE 'G'.
  7357         16  CL-CLAIM-PREM-TYPE      PIC X.
  7358             88  SINGLE-PREMIUM         VALUE '1'.
  7359             88  O-B-COVERAGE           VALUE '2'.
  7360             88  OPEN-END-COVERAGE      VALUE '3'.
  7361         16  CL-INCURRED-DT          PIC XX.
  7362         16  CL-REPORTED-DT          PIC XX.
  7363         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7364         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7365         16  CL-LAST-PMT-DT          PIC XX.
  7366         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7367         16  CL-PAID-THRU-DT         PIC XX.
  7368         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7369         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7370         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7371         16  CL-PMT-CALC-METHOD      PIC X.
  7372             88  CL-360-DAY-YR          VALUE '1'.
  7373             88  CL-365-DAY-YR          VALUE '2'.
  7374             88  CL-FULL-MONTHS         VALUE '3'.
  7375         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 136
* EL050.cbl
  7376
  7377         16  CL-PRIME-CERT-NO.
  7378             20  CL-PRIME-CERT-PRIME PIC X(10).
  7379             20  CL-PRIME-CERT-SFX   PIC X.
  7380
  7381         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7382             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7383             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7384
  7385         16  CL-MICROFILM-NO         PIC X(10).
  7386         16  CL-PROG-FORM-TYPE       PIC X.
  7387         16  CL-LAST-ADD-ON-DT       PIC XX.
  7388
  7389         16  CL-LAST-REOPEN-DT       PIC XX.
  7390         16  CL-LAST-CLOSE-DT        PIC XX.
  7391         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7392             88  FINAL-PAID             VALUE '1'.
  7393             88  CLAIM-DENIED           VALUE '2'.
  7394             88  AUTO-CLOSE             VALUE '3'.
  7395             88  MANUAL-CLOSE           VALUE '4'.
  7396             88  BENEFITS-CHANGED       VALUE 'C'.
  7397             88  SETUP-ERRORS           VALUE 'E'.
  7398         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7399         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7400         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7401             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7402         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7403         16  FILLER                  PIC X.
  7404
  7405     12  CL-CERTIFICATE-DATA.
  7406         16  CL-CERT-ORIGIN          PIC X.
  7407             88  CERT-WAS-ONLINE        VALUE '1'.
  7408             88  CERT-WAS-CREATED       VALUE '2'.
  7409             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7410         16  CL-CERT-KEY-DATA.
  7411             20  CL-CERT-CARRIER     PIC X.
  7412             20  CL-CERT-GROUPING    PIC X(6).
  7413             20  CL-CERT-STATE       PIC XX.
  7414             20  CL-CERT-ACCOUNT.
  7415                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7416                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7417             20  CL-CERT-EFF-DT      PIC XX.
  7418
  7419     12  CL-STATUS-CONTROLS.
  7420         16  CL-PRIORITY-CD          PIC X.
  7421             88  CONFIDENTIAL-DATA      VALUE '8'.
  7422             88  HIGHEST-PRIORITY       VALUE '9'.
  7423         16  CL-SUPV-ATTN-CD         PIC X.
  7424             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7425             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7426         16  CL-PURGED-DT            PIC XX.
  7427         16  CL-RESTORED-DT          PIC XX.
  7428         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7429         16  CL-NEXT-RESEND-DT       PIC XX.
  7430         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7431         16  CL-CRITICAL-PERIOD      PIC 99.
  7432*        16  FILLER                  PIC XX.
  7433         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 137
* EL050.cbl
  7434         16  CL-LAST-MAINT-USER      PIC X(4).
  7435         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7436         16  CL-LAST-MAINT-TYPE      PIC X.
  7437             88  CLAIM-SET-UP           VALUE ' '.
  7438             88  PAYMENT-MADE           VALUE '1'.
  7439             88  LETTER-SENT            VALUE '2'.
  7440             88  MASTER-WAS-ALTERED     VALUE '3'.
  7441             88  MASTER-WAS-RESTORED    VALUE '4'.
  7442             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7443             88  FILE-CONVERTED         VALUE '6'.
  7444             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7445             88  ERROR-CORRECTION       VALUE 'E'.
  7446         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7447         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7448         16  CL-BENEFICIARY          PIC X(10).
  7449         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7450         16  CL-DENIAL-TYPE          PIC X.
  7451             88  CL-TYPE-DENIAL          VALUE '1'.
  7452             88  CL-TYPE-RESCISSION      VALUE '2'.
  7453             88  CL-TYPE-REFORMATION     VALUE '3'.
  7454             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7455             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7456         16  CL-CRIT-PER-RECURRENT   PIC X.
  7457         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7458         16  CL-RTW-DT               PIC XX.
  7459
  7460     12  CL-TRAILER-CONTROLS.
  7461         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7462             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7463             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7464             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7465         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7466         16  FILLER                  PIC XX.
  7467         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7468         16  CL-ADDRESS-TRAILER-CNT.
  7469             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7470                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7471             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7472                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7473             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7474                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7475             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7476                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7477             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7478                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7479             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7480                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7481             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7482                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7483
  7484     12  CL-CV-REFERENCE-NO.
  7485         16  CL-CV-REFNO-PRIME       PIC X(18).
  7486         16  CL-CV-REFNO-SFX         PIC XX.
  7487
  7488     12  CL-FILE-LOCATION            PIC X(4).
  7489
  7490     12  CL-PROCESS-ERRORS.
  7491         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 138
* EL050.cbl
  7492             88  NO-FATAL-ERRORS        VALUE ZERO.
  7493         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7494             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7495
  7496     12  CL-PRODUCT-CD               PIC X.
  7497
  7498     12  CL-CURRENT-KEY-DATA.
  7499         16  CL-CURRENT-CARRIER      PIC X.
  7500         16  CL-CURRENT-GROUPING     PIC X(6).
  7501         16  CL-CURRENT-STATE        PIC XX.
  7502         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7503
  7504     12  CL-ASSOCIATES               PIC X.
  7505         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7506         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7507         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7508         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7509
  7510     12  CL-ACTIVITY-CODE            PIC 99.
  7511     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7512     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7513
  7514     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7515     12  CL-LAG-REPORT-CODE          PIC 9.
  7516     12  CL-LOAN-TYPE                PIC XX.
  7517     12  CL-LEGAL-STATE              PIC XX.
  7518
  7519     12  CL-YESNOSW                  PIC X.
  7520     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7521         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7522         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7523         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7524     12  cl-insured-claim            pic x.
  7525         88  cl-claim-on-primary         value 'P'.
  7526         88  cl-claim-on-secondary       value 'S'.
  7527     12  cl-benefit-expiration-dt    PIC XX.
  7528
  7529 01  PLAN-RECORDS.
  7530     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7531     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7532
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 139
* EL050.cbl
  7534 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7535                          ACCOUNT-MASTER REINSURANCE-RECORD
  7536                          COMM-TABLE-RECORD FORM-MASTER
  7537                          CLAIM-MASTER PLAN-RECORDS.
  7538 0000-DFHEXIT SECTION.
  7539     MOVE '9#                    $   ' TO DFHEIV0.
  7540     MOVE 'EL050' TO DFHEIV1.
  7541     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7542
  7543     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7544
  7545
  7546* EXEC CICS  HANDLE CONDITION
  7547*           ERROR    (9300-ABEND)
  7548*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7549*    END-EXEC.
  7550*    MOVE '"$.J                  ! " #00007541' TO DFHEIV0
  7551     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7553     MOVE X'2220233030303037353431' TO DFHEIV0(25:11)
  7554     CALL 'kxdfhei1' USING DFHEIV0
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7556
  7557
  7558 0000-COPY-PROCEDURE-DIV.
  7559*                          COPY ELC50PD.
  7560******************************************************************
  7561*                                                                *
  7562*                            ELC50PD                             *
  7563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7564*                            VMOD=2.188                          *
  7565*                                                                *
  7566******************************************************************
  7567*                   C H A N G E   L O G
  7568*
  7569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7570*-----------------------------------------------------------------
  7571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7572* EFFECTIVE    NUMBER
  7573*-----------------------------------------------------------------
  7574* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7575* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7576* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7577*                             2709 AND 2718
  7578* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7579* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7580* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7581* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7582* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7583*                                IS OPEN OR CNC DT < PD THRU
  7584* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7585* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7586* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7587* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7588* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7589* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7590* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7591* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 140
* EL050.cbl
  7592* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7593* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7594* 020906                   PEMA  EXPAND LOAN OFFICER
  7595* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7596* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7597* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7598* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7599* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7600* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7601* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7602* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7603* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7604* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7605* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7606* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7607* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7608* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7609* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7610* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7611* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7612* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7613* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7614* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7615* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7616* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7617* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7618* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7619* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7620*                                UPDATE VIN ON CERT TRAILER
  7621* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7622* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7623* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7624* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7625* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7626* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7627* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7628* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7629* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7630* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7631* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7632* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7633* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7634* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7635* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7636* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7637* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7638* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7639* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7640* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7641* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7642* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7643* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7644* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7645* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7646* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7647* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7648* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7649* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 141
* EL050.cbl
  7650* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7651* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7652* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7653* 032912  CR2011110200001  PEMA  AHL CHANGES
  7654* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7655* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7656* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7657* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7658* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7659* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7660* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7661* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7662* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7663* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7664* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7665* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7666* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7667* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7668* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7669* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7670* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7671* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7672* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7673* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7674* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7675******************************************************************
  7676************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7677******************************************************************
  7678
  7679     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7680
  7681     MOVE SPACES                 TO PB-FATAL-FLAG
  7682                                    PB-FORCE-ER-CD
  7683                                    PB-WARN-ER-CD
  7684                                    PB-OUT-BAL-CD.
  7685
  7686     MOVE SPACE                  TO WS-IG-OVRD-AH
  7687                                    WS-IG-OVRD-LF
  7688                                    WS-IG-OVRD-AM
  7689                                    WS-IG-OVRD
  7690                                    WS-IG-OVRD-AH-PL
  7691                                    WS-IG-OVRD-LF-PL
  7692                                    WS-IG-OVRD-AH-BEN
  7693                                    WS-IG-OVRD-LF-BEN.
  7694
  7695******************************************************************
  7696*************       INITIALIZE COMMON ERRORS       ***************
  7697******************************************************************
  7698
  7699     MOVE +0                     TO PB-NO-OF-ERRORS.
  7700     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7701
  7702******************************************************************
  7703
  7704     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7705     SET JULIAN-TO-BIN           TO TRUE.
  7706*    MOVE 5                      TO DC-OPTION-CODE.
  7707     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 142
* EL050.cbl
  7708     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7709
  7710     MOVE ZERO                   TO  SUB4.
  7711
  7712 0040-INITIALIZE-GA-BILL-DT.
  7713
  7714     ADD +1                      TO  SUB4.
  7715
  7716     IF  SUB4 GREATER THAN +5
  7717         GO TO 0050-CHECK-CNTL-FOUND.
  7718
  7719     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7720         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7721
  7722     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7723
  7724 0050-CHECK-CNTL-FOUND.
  7725
  7726     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7727        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7728                                         WS-AH-REM-TERM-CALC
  7729                                         EC-CO-REM-TERM-CALC
  7730        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7731        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7732        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7733                                         WS-TOL-AH-CLAIM
  7734        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7735                                         WS-TOL-AH-PREM
  7736                                         EC-CO-TOL-PREM
  7737        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7738                                         WS-TOL-AH-REFUND
  7739                                         EC-CO-TOL-REFUND
  7740        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7741                                         WS-AH-REFUND-OVS-AMT
  7742                                         EC-CO-OVR-SHT-AMT
  7743        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7744                                         WS-TOL-AH-PREM-PCT
  7745                                         EC-CO-TOL-PREM-PCT
  7746        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7747                                         WS-TOL-AH-REFUND-PCT
  7748                                         EC-CO-TOL-REFUND-PCT
  7749        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7750                                         WS-AH-REFUND-OVS-PCT
  7751                                         EC-CO-OVR-SHT-PCT
  7752        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7753        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7754        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7755        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7756        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7757        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7758        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7759        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7760        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7761        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7762        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7763        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7764                                         EC-CO-MONTH-END-DT
  7765        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 143
* EL050.cbl
  7766          GO TO 0100-READ-ACCT.
  7767
  7768     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7769     MOVE SPACES                 TO CNTL-ACCESS.
  7770     MOVE '1'                    TO CNTL-REC-TYPE.
  7771     MOVE +0                     TO CNTL-SEQ-NO.
  7772
  7773     MOVE '1' TO RC-SW-1.
  7774     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7775     IF NOT CF-COMPANY-MASTER
  7776         MOVE ZEROS             TO WK-CO-TOL-PREM
  7777                                   WK-CO-TOL-CLAIM
  7778                                   WK-CO-TOL-REFUND
  7779                                   WK-REFUND-OVS-AMT
  7780                                   WK-REFUND-OVS-PCT
  7781                                   WK-CO-TOL-PREM-PCT
  7782                                   WK-CO-TOL-REFUND-PCT
  7783                                   WK-DEFAULT-APR
  7784                                   WK-CO-MAX-CAP
  7785        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7786                                   WK-CR-R78-METHOD
  7787                                   WK-CO-REF-REJECT-SW
  7788                                   WK-CO-PREM-REJECT-SW
  7789                                   WK-REM-TRM-CALC-OPTION
  7790                                   WK-BIRTH-DATE-INPUT
  7791                                   WK-JOINT-AGE-INPUT
  7792        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7793        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7794        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7795        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7796          GO TO 0099-COMPANY-NOT-FOUND.
  7797
  7798     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7799        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7800     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7801        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7802     IF CF-CO-TOL-CAP NOT NUMERIC
  7803        MOVE +0                    TO CF-CO-TOL-CAP.
  7804     IF CF-DEFAULT-APR NOT NUMERIC
  7805        MOVE +0                    TO CF-DEFAULT-APR.
  7806
  7807     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7808     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7809     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7810     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7811     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7812     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7813     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7814     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7815     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7816     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7817     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7818     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7819
  7820     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7821          CF-CO-OVR-SHT-AMT > +0
  7822        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7823
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 144
* EL050.cbl
  7824     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7825          CF-CO-OVR-SHT-PCT > +0
  7826        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7827
  7828     IF CF-VALID-REM-TRM-OPTION
  7829         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7830     ELSE
  7831         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7832
  7833     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7834     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7835     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7836     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7837
  7838     GO TO 0050-CHECK-CNTL-FOUND.
  7839
  7840 0099-COMPANY-NOT-FOUND.
  7841
  7842     MOVE ER-2616                TO WS-ERROR.
  7843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7844
  7845 0100-READ-ACCT.
  7846
  7847     MOVE SPACES                 TO DATE-RANGE-SW.
  7848
  7849     IF WK-ACCT-ADDR = ZEROS
  7850        GO TO 0102-ACCT-GETMAIN.
  7851
  7852     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7853     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7854     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7855
  7856     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7857        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7858        GO TO 0105-READ-ACCT
  7859     END-IF
  7860
  7861     IF PB-CARRIER NOT = SPACES
  7862        IF PB-CARRIER NOT = AM-VG-CARRIER
  7863           GO TO 0105-READ-ACCT.
  7864
  7865     IF PB-STATE NOT = SPACES
  7866        IF PB-STATE NOT = AM-VG-STATE
  7867           GO TO 0105-READ-ACCT.
  7868
  7869     IF PB-GROUPING NOT = SPACES
  7870        IF PB-GROUPING NOT = AM-VG-GROUPING
  7871           GO TO 0105-READ-ACCT.
  7872
  7873     MOVE 'X'                 TO DATE-RANGE-SW.
  7874
  7875     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7876        MOVE 'X'                 TO DATE-RANGE-SW
  7877        GO TO 0105-READ-ACCT.
  7878
  7879     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7880        GO TO 0105-READ-ACCT.
  7881
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 145
* EL050.cbl
  7882     GO TO 0180-ACCOUNT-FOUND.
  7883
  7884 0102-ACCT-GETMAIN.
  7885     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7886     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7887
  7888 0105-READ-ACCT.
  7889     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7890     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7891     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7892     MOVE PB-STATE               TO ACCT-STATE.
  7893     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7894     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7895
  7896     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7897
  7898     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7899
  7900 0110-FIND-ACCT-TOLERANCES-LOOP.
  7901     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7902
  7903     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7904        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7905        GO TO 0199-ACCT-NOT-FOUND
  7906     END-IF
  7907     IF PB-CARRIER NOT = SPACES
  7908        IF PB-CARRIER NOT = AM-VG-CARRIER
  7909           GO TO 0199-ACCT-NOT-FOUND.
  7910
  7911     IF PB-STATE NOT = SPACES
  7912        IF PB-STATE NOT = AM-VG-STATE
  7913           GO TO 0199-ACCT-NOT-FOUND.
  7914
  7915     IF PB-GROUPING NOT = SPACES
  7916        IF PB-GROUPING NOT = AM-VG-GROUPING
  7917           GO TO 0199-ACCT-NOT-FOUND.
  7918
  7919     MOVE 'X'                    TO DATE-RANGE-SW.
  7920
  7921     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7922        MOVE 'X'                 TO DATE-RANGE-SW
  7923        GO TO 0199-ACCT-NOT-FOUND.
  7924
  7925     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7926        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7927
  7928 0180-ACCOUNT-FOUND.
  7929     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7930     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7931     MOVE AM-STATE               TO PB-SV-STATE.
  7932     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7933
  7934     IF AM-CANCEL-FEE  NOT NUMERIC
  7935        MOVE ZEROS TO AM-CANCEL-FEE.
  7936
  7937     IF AM-MAX-MON-BEN NOT NUMERIC
  7938        MOVE ZEROS TO AM-MAX-MON-BEN.
  7939
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 146
* EL050.cbl
  7940     IF AM-MAX-TOT-BEN NOT NUMERIC
  7941        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7942
  7943     IF AM-CLP-TOL-PCT NOT NUMERIC
  7944        MOVE +0                  TO AM-CLP-TOL-PCT
  7945     END-IF
  7946     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7947        MOVE +0                  TO AM-SPP-LEASE-COMM
  7948     END-IF
  7949     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7950        MOVE ER-2611             TO   WS-ERROR
  7951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7952
  7953     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7954        MOVE ER-2621             TO   WS-ERROR
  7955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7956
  7957     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7958        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7959        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7960        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7961         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7962
  7963     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7964     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7965     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7966     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7967     IF AM-CLP-TOL-PCT NOT = ZEROS
  7968        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7969     END-IF
  7970     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7971        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7972     END-IF
  7973*    IF PB-COMPANY-ID = 'DCC'
  7974*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7975*                                   WS-ADMIN-FEES
  7976*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7977*          (SUB5 > +10)
  7978*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7979*             AND (AM-A-COM (SUB5) NUMERIC)
  7980*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7981*                + (AM-A-COM (SUB5) * 1000)
  7982*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7983*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7984*                + (AM-A-COM (SUB5) * 1000)
  7985*             END-IF
  7986*             IF AM-COM-TYP (SUB5) = 'N'
  7987*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7988*                + (AM-A-COM (SUB5) * 1000)
  7989*             END-IF
  7990*          END-IF
  7991*       END-PERFORM
  7992*    END-IF
  7993     IF (PB-COMPANY-ID = 'DCC')
  7994        AND (PB-ISSUE)
  7995        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7996        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7997           (SUB5 > +10)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 147
* EL050.cbl
  7998           MOVE +0 TO WS-WK-RATE
  7999           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8000              IF (AM-A-COM (SUB5) NUMERIC)
  8001                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8002                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8003              ELSE
  8004                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8005                 IF PB-ISSUE
  8006                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8007                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8008                 ELSE
  8009                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8010                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8011                 END-IF
  8012                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8013                 MOVE ZEROS             TO WS-SUB1
  8014                                           WS-COMMISSION
  8015                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8016                 MOVE '0530'               TO CTBL-SW
  8017                 MOVE ' '                  TO WS-CTBL-READ-SW
  8018                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8019                 IF FIRST-TIME-THROUGH
  8020                    MOVE 'AA'              TO CTBL-BEN-CODE
  8021                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8022                 END-IF
  8023                 IF CTBL-TABLE-FOUND
  8024                    IF PB-ISSUE
  8025                       COMPUTE WS-COMM-CK-AMT =
  8026                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8027                    ELSE
  8028                       COMPUTE WS-COMM-CK-AMT =
  8029                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8030                    END-IF
  8031                    PERFORM 8800-GET-COMP-RATE
  8032                              THRU 8800-EXIT
  8033                 END-IF
  8034              END-IF
  8035              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8036                + (WS-WK-RATE * 1000)
  8037           END-IF
  8038        END-PERFORM
  8039     END-IF
  8040     IF PB-COMPANY-ID EQUAL 'CRI'
  8041         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8042
  8043     IF PB-COMPANY-ID EQUAL 'NCL'
  8044         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8045     END-IF
  8046
  8047     GO TO 0200-READ-CERT.
  8048
  8049 0199-ACCT-NOT-FOUND.
  8050
  8051     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8052
  8053     IF DATE-RANGE-SW NOT = SPACES
  8054        MOVE ER-2601             TO WS-ERROR
  8055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 148
* EL050.cbl
  8056     ELSE
  8057        MOVE ER-2619             TO WS-ERROR
  8058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8059
  8060     GO TO 9990-RETURN.
  8061
  8062 0200-READ-CERT.
  8063
  8064     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8065     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8066     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8067     MOVE PB-SV-STATE            TO CERT-STATE.
  8068     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8069     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8070     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8071
  8072     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8073
  8074     IF CERT-WAS-NOT-FOUND
  8075        GO TO 0299-CERT-NOT-FOUND.
  8076
  8077     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8078        MOVE ER-2759             TO WS-ERROR
  8079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8080        GO TO 0298-UNLOCK-RETURN.
  8081
  8082     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8083         MOVE ER-2758            TO WS-ERROR
  8084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8085         GO TO 0298-UNLOCK-RETURN.
  8086
  8087     IF PB-ISSUE
  8088        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8089           IF CERT-WAS-CREATED-FOR-CLAIM
  8090              NEXT SENTENCE
  8091            ELSE
  8092              MOVE ER-2626       TO WS-ERROR
  8093              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8094              GO TO 0298-UNLOCK-RETURN.
  8095
  8096     IF NOT PB-CANCELLATION
  8097        GO TO 0300-CONTINUE-EDIT.
  8098
  8099     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8100     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8101     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8102     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8103     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8104     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8105
  8106     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8107     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8108     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8109     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8110     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8111     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8112     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8113     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 149
* EL050.cbl
  8114     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8115
  8116     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8117     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8118     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8119     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8120     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8121     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8122     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8123
  8124     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8125     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8126
  8127     MOVE CM-CREDIT-INTERFACE-SW-1
  8128                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8129     MOVE CM-CREDIT-INTERFACE-SW-2
  8130                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8131
  8132     IF CM-O-B-COVERAGE
  8133         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8134
  8135     IF CM-LIVES NOT NUMERIC
  8136         MOVE ZERO                TO CM-LIVES.
  8137
  8138     IF CM-BILLED NOT NUMERIC
  8139         MOVE ZERO                TO CM-BILLED.
  8140
  8141     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8142         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8143         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8144         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8145         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8146         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8147         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8148         MOVE CM-LIVES             TO PB-CI-LIVES
  8149*The next line causes a problem with my change  I dont think it is
  8150*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8151
  8152     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8153     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8154     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8155     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8156     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8157     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8158
  8159     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8160     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8161     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8162     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8163
  8164     IF CM-LIFE-COMM-PCT NUMERIC
  8165         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8166     ELSE
  8167         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8168
  8169     IF CM-AH-COMM-PCT NUMERIC
  8170         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8171     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 150
* EL050.cbl
  8172         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8173
  8174     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8175
  8176     IF CM-LOAN-APR       NOT NUMERIC
  8177           MOVE ZERO               TO CM-LOAN-APR.
  8178
  8179     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8180           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8181
  8182     IF CM-LOAN-TERM      NOT NUMERIC
  8183           MOVE ZERO               TO CM-LOAN-TERM.
  8184
  8185     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8186           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8187
  8188     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8189           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8190
  8191     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8192     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8193     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8194     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8195     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8196     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8197     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8198     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8199     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8200     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8201     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8202     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8203
  8204     IF CM-STATE = CM-SSN-STATE
  8205         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8206
  8207     IF CM-STATE NOT = CM-MEMB-STATE
  8208         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8209
  8210     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8211
  8212     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8213        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8214        IF CM-ADDL-CLP NOT NUMERIC
  8215           MOVE +0               TO CM-ADDL-CLP
  8216        END-IF
  8217        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8218        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8219           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8220        END-IF
  8221     END-IF
  8222     IF PB-COMPANY-ID = 'DCC'
  8223        MOVE +0                  TO WS-ADMIN-FEES
  8224                                    WS-CSO-ADMIN-FEE
  8225                                    WS-COMM-AND-MFEE
  8226                                    WS-1ST-YR-ALLOW
  8227        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8228           (SUB5 > +10)
  8229           MOVE +0 TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 151
* EL050.cbl
  8230           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8231              IF (AM-A-COM (SUB5) NUMERIC)
  8232                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8233                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8234              ELSE
  8235                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8236                 IF PB-ISSUE
  8237                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8238                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8239                 ELSE
  8240                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8241                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8242                 END-IF
  8243                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8244                 MOVE ZEROS             TO WS-SUB1
  8245                                           WS-COMMISSION
  8246                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8247                 MOVE '0530'               TO CTBL-SW
  8248                 MOVE ' '                  TO WS-CTBL-READ-SW
  8249                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8250                 IF FIRST-TIME-THROUGH
  8251                    MOVE 'AA'              TO CTBL-BEN-CODE
  8252                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8253                 END-IF
  8254                 IF CTBL-TABLE-FOUND
  8255                    IF PB-ISSUE
  8256                       COMPUTE WS-COMM-CK-AMT =
  8257                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8258                    ELSE
  8259                       COMPUTE WS-COMM-CK-AMT =
  8260                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8261                    END-IF
  8262                    PERFORM 8800-GET-COMP-RATE
  8263                              THRU 8800-EXIT
  8264                 END-IF
  8265              END-IF
  8266              IF AM-COM-TYP (SUB5) = 'I'
  8267                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8268                   + (WS-WK-RATE * 1000)
  8269              END-IF
  8270              IF AM-COM-TYP (SUB5) = 'N'
  8271                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8272                   + (WS-WK-RATE * 1000)
  8273              END-IF
  8274              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8275                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8276                   + (WS-WK-RATE * 1000)
  8277              END-IF
  8278              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8279                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8280                   + (WS-WK-RATE * 1000)
  8281              END-IF
  8282           END-IF
  8283        END-PERFORM
  8284     END-IF
  8285     GO TO 0300-CONTINUE-EDIT.
  8286
  8287 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 152
* EL050.cbl
  8288      PERFORM 9250-UNLOCK-RETURN
  8289      GO TO 9990-RETURN.
  8290
  8291 0299-CERT-NOT-FOUND.
  8292
  8293     MOVE '1'                     TO CERT-STATUS-SW.
  8294
  8295     IF PB-COMPANY-ID = 'UCL'
  8296         IF WS-ERROR = ER-2799
  8297             GO TO 3000-CONTINUE-EDIT.
  8298
  8299     IF NOT PB-CANCELLATION
  8300         GO TO 0300-CONTINUE-EDIT.
  8301
  8302     MOVE ER-2726                  TO  WS-ERROR.
  8303     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8304     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8305     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8306                                    PB-CI-LF-TERM
  8307                                    PB-C-LF-REM-TERM
  8308                                    PB-CI-AH-TERM
  8309                                    PB-C-AH-REM-TERM
  8310                                    PB-CI-LF-BENEFIT-CD
  8311                                    PB-CI-LF-BENEFIT-AMT
  8312                                    PB-CI-LF-ALT-BENEFIT-AMT
  8313                                    PB-CI-LF-PREMIUM-AMT
  8314                                    PB-CI-LF-ALT-PREMIUM-AMT
  8315                                    PB-CI-AH-BENEFIT-CD
  8316                                    PB-CI-AH-BENEFIT-AMT
  8317                                    PB-CI-AH-PREMIUM-AMT
  8318                                    PB-CI-PAY-FREQUENCY
  8319                                    PB-CI-LOAN-APR
  8320                                    PB-CI-LOAN-TERM
  8321                                    PB-CI-LIFE-COMMISSION
  8322                                    PB-CI-AH-COMMISSION
  8323                                    PB-CI-CURR-SEQ
  8324                                    PB-CI-AH-CANCEL-AMT
  8325                                    PB-CI-LF-CANCEL-AMT
  8326                                    PB-CI-RATE-DEV-PCT-LF
  8327                                    PB-CI-RATE-DEV-PCT-AH
  8328                                    PB-CI-EXTENTION-DAYS
  8329                                    PB-CI-TERM-IN-DAYS
  8330                                    PB-CI-LIVES
  8331                                    PB-CI-LF-CRIT-PER
  8332                                    PB-CI-AH-CRIT-PER
  8333                                    PB-CI-ADDL-CLP
  8334                                    PB-CI-DDF-IU-RATE-UP.
  8335
  8336     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8337                                    PB-CI-AH-SETTLEMENT-DT
  8338                                    PB-CI-DEATH-DT
  8339                                    PB-CI-LF-PRIOR-CANCEL-DT
  8340                                    PB-CI-AH-PRIOR-CANCEL-DT
  8341                                    PB-CI-ENTRY-DT
  8342                                    PB-CI-LF-EXPIRE-DT
  8343                                    PB-CI-AH-EXPIRE-DT
  8344                                    PB-CI-LOAN-1ST-PMT-DT.
  8345
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 153
* EL050.cbl
  8346     IF ACCOUNT-MAST-FOUND
  8347        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8348        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8349
  8350
  8351 0300-CONTINUE-EDIT.
  8352
  8353     IF PB-ISSUE
  8354        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8355            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8356
  8357     IF PB-ISSUE
  8358        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8359            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8360
  8361     IF PB-ISSUE
  8362       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8363          (AM-NO-AH-ONLY)
  8364           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8365               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8366                   MOVE ER-2679 TO WS-ERROR
  8367                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8368
  8369     IF PB-ISSUE
  8370        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8371        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8372        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8373     ELSE
  8374        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8375        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8376        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8377
  8378     MOVE 'N'                    TO PLAN-MASTER-SW
  8379                                    PLAN-MASTER-LIFE-SW
  8380                                    FORM-MASTER-SW
  8381                                    WS-APP-CERT-SW.
  8382
  8383     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8384                                    WS-PL-TOL-LF-REFUND
  8385                                    WS-PL-REF-OVS-AMT
  8386                                    WS-PL-TOL-LF-PREM-PCT
  8387                                    WS-PL-TOL-LF-REFUND-PCT
  8388                                    WS-PL-REF-OVS-PCT
  8389                                    WS-PL-TOL-LF-CLAIM.
  8390
  8391     IF PB-COMPANY-ID = 'NCL'
  8392       IF PB-ISSUE
  8393         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8394             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8395             IF FORM-MASTER-FOUND
  8396                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8397
  8398     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8399        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8400
  8401********************** MON CODE **********************
  8402     IF PB-COMPANY-ID = 'MON'
  8403     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 154
* EL050.cbl
  8404     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8405        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8406             PB-I-LOAN-APR = ZERO)
  8407               MOVE 14.0         TO PB-I-LOAN-APR.
  8408******************************************************
  8409
  8410     IF PB-COMPANY-ID = 'NCL'
  8411       IF PB-ISSUE
  8412           IF FORM-MASTER-FOUND
  8413             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8414                AM-DISMBR-COVERAGE
  8415                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8416                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8417                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8418                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8419                                           PB-I-LIFE-BENEFIT-CD.
  8420
  8421     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8422
  8423     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8424         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8425         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8426         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8427         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8428         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8429           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8430             GO TO 0301-LIFE-BENEFIT-SEARCH
  8431         ELSE
  8432             NEXT SENTENCE
  8433     ELSE
  8434         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8435
  8436     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8437     MOVE '4'                    TO CNTL-REC-TYPE.
  8438     MOVE +0                     TO CNTL-SEQ-NO.
  8439     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8440
  8441     MOVE '1' TO RC-SW-2.
  8442     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8443
  8444     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8445        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8446         GO TO 0305-BENEFIT-NOT-FOUND.
  8447
  8448     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8449
  8450 0301-LIFE-BENEFIT-SEARCH.
  8451
  8452     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8453
  8454     IF NO-BENEFIT-FOUND
  8455        GO TO 0305-BENEFIT-NOT-FOUND.
  8456
  8457     IF WS-BEN-CD = '99'
  8458        GO TO 0305-BENEFIT-NOT-FOUND.
  8459
  8460     IF PB-COMPANY-ID = 'NCL'
  8461         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 155
* EL050.cbl
  8462             GO TO 0304-LIFE-BENEFIT-FOUND.
  8463
  8464     MOVE +1                     TO SUB5.
  8465     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8466
  8467* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8468* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8469     IF PB-COMPANY-ID = 'DMD'
  8470         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8471
  8472 0302-EDIT-ACCT-LF-BENEFITS.
  8473
  8474     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8475        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8476           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8477                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8478           GO TO 03XX-GET-LIFE-ERPLAN.
  8479
  8480     IF SUB5 LESS THAN +20
  8481        ADD +1                   TO SUB5
  8482        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8483
  8484     MOVE +1                     TO SUB5.
  8485
  8486     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8487        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8488
  8489 0303-EDIT-DMD-EXTRA-BENEFITS.
  8490
  8491     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8492        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8493           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8494                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8495           GO TO 03XX-GET-LIFE-ERPLAN.
  8496
  8497     IF SUB5 LESS THAN +30
  8498        ADD +1                   TO SUB5
  8499        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8500
  8501     MOVE +1                     TO SUB5.
  8502
  8503 03XX-EDIT-FOR-NINETY-LF.
  8504
  8505***************************************************************
  8506*                                                             *
  8507*    NINETY BENEFIT PLAN TYPES:                               *
  8508*                                                             *
  8509*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8510*      92 = ALL GROUP REDUCING BENEFITS                       *
  8511*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8512*      94 = ALL GROUP LEVEL BENEFITS                          *
  8513*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8514*           BENEFIT CONTROLS.                                 *
  8515*      99 = ALL BENEFITS                                      *
  8516*                                                             *
  8517***************************************************************
  8518
  8519     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 156
* EL050.cbl
  8520                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8521
  8522     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8523       AND
  8524        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8525        GO TO 03XX-GET-LIFE-ERPLAN.
  8526
  8527     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8528       AND
  8529        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8530        IF CF-REDUCING (SUB3)
  8531           IF (PB-I-INDV-GRP-OVRD = 'I')
  8532              OR
  8533           ((AM-IG = '1') AND
  8534           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8535              OR
  8536           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8537           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8538           (AM-IG NOT = '2'))
  8539              GO TO 03XX-GET-LIFE-ERPLAN.
  8540
  8541     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8542       AND
  8543        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8544        IF CF-REDUCING (SUB3)
  8545           IF (PB-I-INDV-GRP-OVRD = 'G')
  8546              OR
  8547           ((AM-IG = '2') AND
  8548           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8549              OR
  8550           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8551           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8552           (AM-IG NOT = '1'))
  8553              GO TO 03XX-GET-LIFE-ERPLAN.
  8554
  8555     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8556       AND
  8557        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8558        IF CF-LEVEL    (SUB3)
  8559           IF (PB-I-INDV-GRP-OVRD = 'I')
  8560              OR
  8561           ((AM-IG = '1') AND
  8562           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8563              OR
  8564           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8565           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8566            (AM-IG NOT = '2'))
  8567              GO TO 03XX-GET-LIFE-ERPLAN.
  8568
  8569     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8570       AND
  8571        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8572        IF CF-LEVEL    (SUB3)
  8573           IF (PB-I-INDV-GRP-OVRD = 'G')
  8574              OR
  8575           ((AM-IG = '2') AND
  8576           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8577              OR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 157
* EL050.cbl
  8578           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8579           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8580           (AM-IG NOT = '1'))
  8581              GO TO 03XX-GET-LIFE-ERPLAN.
  8582
  8583     IF SUB5 LESS THAN +20
  8584        ADD +1                   TO SUB5
  8585        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8586
  8587     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8588
  8589     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8590        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8591
  8592     MOVE +1                     TO SUB5.
  8593
  8594 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8595
  8596     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8597                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8598
  8599     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8600       AND
  8601        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8602        GO TO 03XX-GET-LIFE-ERPLAN.
  8603
  8604     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8605       AND
  8606        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8607        IF CF-REDUCING (SUB3)
  8608           IF (PB-I-INDV-GRP-OVRD = 'I')
  8609              OR
  8610           ((AM-IG = '1') AND
  8611           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8612              OR
  8613           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8614           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8615           (AM-IG NOT = '2'))
  8616              GO TO 03XX-GET-LIFE-ERPLAN.
  8617
  8618     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8619       AND
  8620        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8621        IF CF-REDUCING (SUB3)
  8622           IF (PB-I-INDV-GRP-OVRD = 'G')
  8623              OR
  8624           ((AM-IG = '2') AND
  8625           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8626              OR
  8627           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8628           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8629           (AM-IG NOT = '1'))
  8630              GO TO 03XX-GET-LIFE-ERPLAN.
  8631
  8632     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8633       AND
  8634        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8635        IF CF-LEVEL    (SUB3)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 158
* EL050.cbl
  8636           IF (PB-I-INDV-GRP-OVRD = 'I')
  8637              OR
  8638           ((AM-IG = '1') AND
  8639           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8640              OR
  8641           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8642           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8643            (AM-IG NOT = '2'))
  8644              GO TO 03XX-GET-LIFE-ERPLAN.
  8645
  8646     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8647       AND
  8648        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8649        IF CF-LEVEL    (SUB3)
  8650           IF (PB-I-INDV-GRP-OVRD = 'G')
  8651              OR
  8652           ((AM-IG = '2') AND
  8653           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8654              OR
  8655           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8656           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8657           (AM-IG NOT = '1'))
  8658              GO TO 03XX-GET-LIFE-ERPLAN.
  8659
  8660     IF SUB5 LESS THAN +30
  8661        ADD +1                   TO SUB5
  8662        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8663
  8664     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8665
  8666 03XX-EDIT-FOR-NINETY-LF-CONT.
  8667
  8668     MOVE +99                    TO SUB5.
  8669
  8670     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8671        IF PB-ISSUE
  8672           MOVE ER-1924          TO  WS-ERROR
  8673           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8674
  8675     GO TO 0304-LIFE-BENEFIT-FOUND.
  8676
  8677 03XX-GET-LIFE-ERPLAN.
  8678
  8679     IF WK-PLAN-ADDR EQUAL +0
  8680        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8681
  8682     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8683     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8684     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8685     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8686     MOVE 'Y'                    TO PLAN-MASTER-SW
  8687                                    PLAN-MASTER-LIFE-SW.
  8688     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8689
  8690 03XX-ERPLAN-LIFE-GETMAIN.
  8691
  8692     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8693     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 159
* EL050.cbl
  8694
  8695 03XX-ERPLAN-LIFE-READ.
  8696
  8697     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8698     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8699     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8700     MOVE PB-SV-STATE            TO PLAN-STATE.
  8701     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8702     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8703     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8704     MOVE WS-SAVE-BENEFIT-REVISION
  8705                                 TO PLAN-REVISION-NO.
  8706
  8707     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8708     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8709
  8710     IF PB-COMPANY-ID = 'NCL'
  8711       IF NOT LF-PLAN-MASTER-FOUND
  8712         IF NOT PB-POLICY-IS-DECLINED  AND
  8713            NOT PB-POLICY-IS-VOIDED
  8714             MOVE  ER-1921         TO  WS-ERROR
  8715             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8716             GO TO 0304-LIFE-BENEFIT-FOUND.
  8717
  8718     IF NOT LF-PLAN-MASTER-FOUND
  8719        GO TO 0304-LIFE-BENEFIT-FOUND.
  8720
  8721 XXXX-CHECK-LF-PLAN-KEY.
  8722
  8723     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8724        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8725        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8726        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8727        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8728        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8729        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8730        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8731        MOVE 'N'                 TO PLAN-MASTER-SW
  8732          GO TO 03XX-ERPLAN-LIFE-READ.
  8733
  8734     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8735
  8736     IF  PB-CANCELLATION
  8737         GO TO  0303-LF-ACCT-BEN-FOUND.
  8738
  8739     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8740        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8741           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8742           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8743              MOVE ER-2644             TO WS-ERROR
  8744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745           ELSE
  8746              NEXT SENTENCE
  8747        ELSE
  8748           IF PB-COMPANY-ID NOT = 'NCL'
  8749              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8750                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8751
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 160
* EL050.cbl
  8752 0303-LF-ACCT-BEN-FOUND.
  8753
  8754     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8755
  8756     IF PL-DEV-CODE NOT = SPACES
  8757        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8758
  8759     IF PL-DEV-PCT NUMERIC AND
  8760        PL-DEV-PCT NOT = ZEROS
  8761        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8762
  8763     IF PL-TOL-PREM-AMT GREATER THAN +0
  8764        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8765
  8766     IF PL-TOL-REF-AMT GREATER THAN +0
  8767        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8768
  8769     IF PL-TOL-PREM-PCT GREATER THAN +0
  8770        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8771
  8772     IF PL-TOL-REF-PCT GREATER THAN +0
  8773        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8774
  8775     IF PL-TOL-CLM-AMT GREATER THAN +0
  8776        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8777
  8778     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8779                          PL-OVER-SHORT-AMT > +0
  8780        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8781
  8782     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8783                          PL-OVER-SHORT-PCT > +0
  8784        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8785
  8786     IF PL-SALES-TAX NUMERIC AND
  8787                          PL-SALES-TAX > +0
  8788         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8789
  8790     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8791        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8792                                    WS-IG-OVRD-AM.
  8793
  8794 0304-LIFE-BENEFIT-FOUND.
  8795
  8796     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8797
  8798     IF PB-ISSUE
  8799        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8800     ELSE
  8801        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8802
  8803     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8804     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8805     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8806     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8807     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8808                                         WS-LF-REFUND-CALC.
  8809     if (ws-lf-earnings-calc = '5')
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 161
* EL050.cbl
  8810        and (pb-i-loan-apr = zeros)
  8811        and (benefit-code-chg)
  8812        move +99.9999 to pb-i-loan-apr
  8813     end-if
  8814
  8815     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8816        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8817
  8818     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8819        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8820     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8821
  8822     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8823     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8824     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8825     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8826     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8827     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8828
  8829     IF PB-COMPANY-ID = 'NCL'  AND
  8830        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8831         NEXT SENTENCE
  8832     ELSE
  8833         IF SUB5 NOT GREATER THAN +20
  8834            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8835               MOVE WS-SAVE-BENEFIT-REM-TERM
  8836                                      TO WS-AM-LF-BENE-REM-TERM
  8837                                         EC-BR-LF-REM-TERM-CALC.
  8838
  8839     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8840     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8841
  8842     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8843
  8844 0305-BENEFIT-NOT-FOUND.
  8845
  8846     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8847     MOVE ER-2604                TO WS-ERROR.
  8848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8849
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 162
* EL050.cbl
  8851
  8852 0310-FIND-AH-BENEFIT-RECORD.
  8853
  8854     MOVE 'N'                    TO PLAN-MASTER-SW
  8855                                    PLAN-MASTER-AH-SW.
  8856
  8857     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8858                                    WS-PL-TOL-AH-REFUND
  8859                                    WS-AH-PL-REF-OVS-AMT
  8860                                    WS-PL-TOL-AH-PREM-PCT
  8861                                    WS-PL-TOL-AH-REFUND-PCT
  8862                                    WS-AH-PL-REF-OVS-PCT
  8863                                    WS-PL-TOL-AH-CLAIM.
  8864     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8865
  8866
  8867     if pb-issue
  8868        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8869           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8870        end-if
  8871        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8872           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8873           GO TO 0399-BENEFIT-NOT-FOUND
  8874        end-if
  8875     end-if
  8876
  8877     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8878        GO TO 0400-FIND-CARRIER.
  8879
  8880     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8881
  8882     IF WK-AH-BEN-ADDR NOT = ZEROS
  8883         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8884         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8885         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8886         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8887           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8888             GO TO 0311-AH-BENEFIT-SEARCH
  8889         ELSE
  8890             NEXT SENTENCE
  8891     ELSE
  8892         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8893
  8894     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8895     MOVE '5'                    TO CNTL-REC-TYPE.
  8896     MOVE +0                     TO CNTL-SEQ-NO.
  8897     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8898
  8899     MOVE '2' TO RC-SW-2.
  8900     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8901
  8902     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8903        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8904          GO TO 0399-BENEFIT-NOT-FOUND.
  8905
  8906     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8907
  8908 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 163
* EL050.cbl
  8909
  8910     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8911
  8912     IF NO-BENEFIT-FOUND
  8913         GO TO 0399-BENEFIT-NOT-FOUND.
  8914
  8915     IF WS-BEN-CD = '99'
  8916        GO TO 0399-BENEFIT-NOT-FOUND.
  8917
  8918     IF PB-COMPANY-ID  =  'NCL'
  8919         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8920             GO TO 0314-A-H-BENEFIT-FOUND.
  8921
  8922     MOVE +1                     TO SUB5.
  8923     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8924
  8925* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8926* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8927     IF PB-COMPANY-ID = 'DMD'
  8928         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8929
  8930 0312-EDIT-ACCT-AH-BENEFITS.
  8931
  8932     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8933        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8934           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8935                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8936           GO TO 03XX-GET-AH-ERPLAN.
  8937
  8938     IF SUB5 LESS THAN +20
  8939        ADD +1                   TO SUB5
  8940        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8941
  8942     MOVE +1                     TO SUB5.
  8943
  8944     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8945        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8946
  8947 0313-EDIT-DMD-EXTRA-BENEFITS.
  8948
  8949     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8950        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8951           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8952                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8953           GO TO 03XX-GET-AH-ERPLAN.
  8954
  8955     IF SUB5 LESS THAN +30
  8956        ADD +1                   TO SUB5
  8957        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8958
  8959     MOVE +1                     TO SUB5.
  8960
  8961 03XX-EDIT-FOR-NINETY-AH.
  8962
  8963***************************************************************
  8964*                                                             *
  8965*    NINETY BENEFIT PLAN TYPES:                               *
  8966*                                                             *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 164
* EL050.cbl
  8967*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8968*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8969*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8970*           BENEFIT CONTROLS.                                 *
  8971*      99 = ALL BENEFITS.                                     *
  8972*                                                             *
  8973***************************************************************
  8974
  8975     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8976                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8977
  8978     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8979       AND
  8980        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8981        GO TO 03XX-GET-AH-ERPLAN.
  8982
  8983     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8984       AND
  8985        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8986           IF (PB-I-INDV-GRP-OVRD = 'I')
  8987              OR
  8988           ((AM-IG = '1') AND
  8989           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8990              OR
  8991           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8992           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8993           (AM-IG NOT = '2'))
  8994              GO TO 03XX-GET-AH-ERPLAN.
  8995
  8996     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8997       AND
  8998        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8999           IF (PB-I-INDV-GRP-OVRD = 'G')
  9000              OR
  9001           ((AM-IG = '2') AND
  9002           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9003              OR
  9004           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9005           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9006           (AM-IG NOT = '1'))
  9007              GO TO 03XX-GET-AH-ERPLAN.
  9008
  9009     IF SUB5 LESS THAN +20
  9010        ADD +1                   TO SUB5
  9011        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9012
  9013     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9014        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9015
  9016     MOVE +1                    TO SUB5.
  9017
  9018 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9019
  9020     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9021                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9022
  9023     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9024       AND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 165
* EL050.cbl
  9025        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9026        GO TO 03XX-GET-AH-ERPLAN.
  9027
  9028     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9029       AND
  9030        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9031           IF (PB-I-INDV-GRP-OVRD = 'I')
  9032              OR
  9033           ((AM-IG = '1') AND
  9034           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9035              OR
  9036           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9037           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9038           (AM-IG NOT = '2'))
  9039              GO TO 03XX-GET-AH-ERPLAN.
  9040
  9041     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9042       AND
  9043        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9044           IF (PB-I-INDV-GRP-OVRD = 'G')
  9045              OR
  9046           ((AM-IG = '2') AND
  9047           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9048              OR
  9049           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9050           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9051           (AM-IG NOT = '1'))
  9052              GO TO 03XX-GET-AH-ERPLAN.
  9053
  9054     IF SUB5 LESS THAN +30
  9055        ADD +1                   TO SUB5
  9056        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9057
  9058 03XX-EDIT-FOR-NINETY-AH-CONT.
  9059
  9060     MOVE +99                    TO SUB5.
  9061
  9062     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9063
  9064     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9065        IF PB-ISSUE
  9066           MOVE ER-1925          TO  WS-ERROR
  9067           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9068
  9069     GO TO 0314-A-H-BENEFIT-FOUND.
  9070
  9071 03XX-GET-AH-ERPLAN.
  9072
  9073     IF WK-PLAN-ADDR EQUAL +0
  9074         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9075
  9076     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9077     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9078     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9079     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9080     MOVE 'Y'                    TO PLAN-MASTER-SW
  9081                                    PLAN-MASTER-AH-SW.
  9082*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 166
* EL050.cbl
  9083     GO TO 03XX-ERPLAN-AH-READ.
  9084
  9085 03XX-ERPLAN-AH-GETMAIN.
  9086
  9087     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9088     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9089
  9090 03XX-ERPLAN-AH-READ.
  9091
  9092     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9093     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9094     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9095     MOVE PB-SV-STATE            TO PLAN-STATE.
  9096     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9097     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9098     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9099     MOVE WS-SAVE-BENEFIT-REVISION
  9100                                 TO PLAN-REVISION-NO.
  9101
  9102     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9103     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9104
  9105     IF PB-COMPANY-ID = 'NCL'
  9106       IF NOT AH-PLAN-MASTER-FOUND
  9107         IF NOT PB-POLICY-IS-DECLINED  AND
  9108            NOT PB-POLICY-IS-VOIDED
  9109             MOVE  ER-1922         TO  WS-ERROR
  9110             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9111             GO TO 0314-A-H-BENEFIT-FOUND.
  9112
  9113     IF NOT AH-PLAN-MASTER-FOUND
  9114        GO TO 0314-A-H-BENEFIT-FOUND.
  9115
  9116 XXXX-CHECK-AH-PLAN-KEY.
  9117
  9118     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9119        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9120        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9121        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9122        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9123        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9124        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9125        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9126        MOVE 'N'                 TO PLAN-MASTER-SW
  9127          GO TO 03XX-ERPLAN-AH-READ.
  9128
  9129     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9130
  9131     IF  PB-CANCELLATION
  9132         GO TO  0313-AH-ACCT-BEN-FOUND.
  9133
  9134     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9135       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9136          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9137          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9138             MOVE ER-2644             TO WS-ERROR
  9139             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9140          ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 167
* EL050.cbl
  9141             NEXT SENTENCE
  9142       ELSE
  9143          IF PB-COMPANY-ID NOT = 'NCL'
  9144             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9145                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9146
  9147 0313-AH-ACCT-BEN-FOUND.
  9148
  9149     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9150
  9151     IF PL-DEV-CODE NOT = SPACES
  9152        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9153
  9154     IF PL-DEV-PCT NUMERIC AND
  9155        PL-DEV-PCT NOT = ZEROS
  9156        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9157
  9158     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9159        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9160
  9161     IF PL-TOL-REF-AMT NOT EQUAL +0
  9162        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9163
  9164     IF PL-TOL-PREM-PCT GREATER THAN +0
  9165        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9166
  9167     IF PL-TOL-REF-PCT GREATER THAN +0
  9168        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9169
  9170     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9171        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9172
  9173     IF PL-OVER-SHORT-AMT NUMERIC AND
  9174                          PL-OVER-SHORT-AMT > +0
  9175        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9176
  9177     IF PL-OVER-SHORT-PCT NUMERIC AND
  9178                          PL-OVER-SHORT-PCT > +0
  9179        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9180
  9181     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9182        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9183        IF WS-IG-OVRD-AM EQUAL SPACES
  9184            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9185
  9186 0314-A-H-BENEFIT-FOUND.
  9187
  9188     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9189
  9190     IF PB-ISSUE
  9191        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9192       ELSE
  9193        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9194
  9195     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9196     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9197     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9198     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 168
* EL050.cbl
  9199                                         WS-AH-REFUND-CALC.
  9200
  9201     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9202        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9203
  9204     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9205        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9206     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9207
  9208     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9209     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9210     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9211     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9212     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9213     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9214
  9215     IF PB-COMPANY-ID = 'NCL'  AND
  9216        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9217         NEXT SENTENCE
  9218     ELSE
  9219         IF SUB5 NOT GREATER THAN +20
  9220            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9221                MOVE WS-SAVE-BENEFIT-REM-TERM
  9222                                      TO WS-AM-AH-BENE-REM-TERM
  9223                                         EC-BR-AH-REM-TERM-CALC.
  9224
  9225     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9226     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9227
  9228     GO TO 0400-FIND-CARRIER.
  9229
  9230 0399-BENEFIT-NOT-FOUND.
  9231
  9232     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9233     MOVE ER-2605                TO WS-ERROR.
  9234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9235
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 169
* EL050.cbl
  9237
  9238 0400-FIND-CARRIER.
  9239
  9240     MOVE PB-SV-CARRIER          TO WS-CARR.
  9241
  9242     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9243     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9244     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9245     MOVE '6'                    TO CNTL-REC-TYPE.
  9246
  9247*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9248     MOVE SPACE                  TO WS-DMD-RATING-SW
  9249                                    EC-BR-DMD-RATING-SW.
  9250
  9251     MOVE '2'                    TO RC-SW-1.
  9252     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9253
  9254     IF NOT CF-CARRIER-MASTER
  9255        GO TO 0400-CARRIER-NOT-FOUND.
  9256
  9257 0400-BUILD-CARR-TOL.
  9258
  9259     IF CF-CR-TOL-PREM NUMERIC AND
  9260        CF-CR-TOL-PREM GREATER THAN +0
  9261        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9262                                    WS-TOL-AH-PREM.
  9263
  9264     IF CF-CR-TOL-REFUND NUMERIC AND
  9265        CF-CR-TOL-REFUND GREATER THAN +0
  9266        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9267                                    WS-TOL-AH-REFUND.
  9268
  9269     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9270        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9271        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9272                                    WS-AH-REFUND-OVS-AMT.
  9273
  9274     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9275        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9276        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9277                                    WS-AH-REFUND-OVS-PCT.
  9278
  9279     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9280        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9281        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9282                                    WS-TOL-AH-PREM-PCT.
  9283
  9284     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9285        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9286        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9287                                     WS-TOL-AH-REFUND-PCT.
  9288
  9289     IF CF-COMPANY-ID EQUAL 'DMD'
  9290         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9291                                    EC-BR-DMD-RATING-SW.
  9292
  9293     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9294     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 170
* EL050.cbl
  9295        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9296     END-IF
  9297     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9298        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9299     END-IF
  9300     IF WS-TOL-CLP-PCT = ZEROS
  9301        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9302     END-IF
  9303
  9304     IF WS-SPP-LEASE-COMM = ZEROS
  9305        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9306     END-IF
  9307     GO TO 0400-FIND-ERPDEF.
  9308
  9309 0400-CARRIER-NOT-FOUND.
  9310
  9311     MOVE ER-2602                TO WS-ERROR.
  9312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9313
  9314 0400-FIND-ERPDEF.
  9315     IF PB-COMPANY-ID = 'DCC'
  9316        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9317        CONTINUE
  9318     ELSE
  9319        GO TO 0400-FIND-ERCOMP
  9320     END-IF
  9321     MOVE ' '                    TO PDEF-MASTER-SW
  9322     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9323     MOVE PB-STATE               TO ERPDEF-STATE
  9324     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9325     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9326     IF PB-ISSUE
  9327        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9328     ELSE
  9329        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9330     END-IF
  9331     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9332     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9333     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9334     IF PDEF-MASTER-FOUND
  9335        MOVE 'N'                 TO PDEF-MASTER-SW
  9336        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9337        IF PDEF-MASTER-FOUND
  9338           IF (ERPDEF-KEY-SAVE (1:16) =
  9339                        PD-CONTROL-PRIMARY (1:16))
  9340              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9341              CONTINUE
  9342           ELSE
  9343              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9344              IF (ERPDEF-KEY-SAVE (1:16) =
  9345                        PD-CONTROL-PRIMARY (1:16))
  9346                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9347                 CONTINUE
  9348              ELSE
  9349                 MOVE 'N'        TO PDEF-MASTER-SW
  9350              END-IF
  9351           END-IF
  9352        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 171
* EL050.cbl
  9353        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9354     END-IF
  9355     IF PDEF-MASTER-FOUND
  9356        IF PD-TRUNCATED = 'Y'
  9357           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9358        END-IF
  9359     END-IF
  9360     .
  9361 0400-FIND-ERCOMP.
  9362     IF PB-COMPANY-ID = 'DCC'
  9363        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9364           (WS-SUB1 > +10)
  9365           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9366                 OR 'A' OR 'N'
  9367              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9368              MOVE PB-CARRIER    TO COMP-CARRIER
  9369              MOVE PB-GROUPING   TO COMP-GROUPING
  9370              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9371              MOVE AM-AGT (WS-SUB1)
  9372                                 TO COMP-FIN-RESP
  9373              MOVE 'G'           TO COMP-TYPE
  9374              PERFORM 8582-READ-COMPENSATION-MASTER
  9375                                 THRU 8582-EXIT
  9376              IF COMP-MASTER-FOUND
  9377                 IF CO-GA-INACTIVE
  9378                    MOVE ER-2763 TO WS-ERROR
  9379                    PERFORM 9900-ERROR-FORMAT
  9380                                 THRU 9900-EXIT
  9381                    MOVE +11     TO WS-SUB1
  9382                 END-IF
  9383                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9384                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9385                    MOVE ER-2788 TO WS-ERROR
  9386                    PERFORM 9900-ERROR-FORMAT
  9387                                 THRU 9900-EXIT
  9388                    MOVE +11     TO WS-SUB1
  9389                 END-IF
  9390              END-IF
  9391           END-IF
  9392        END-PERFORM
  9393     END-IF
  9394     IF PB-COMPANY-ID = 'DCC'
  9395        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9396           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9397                                    WS-CLP-STATE
  9398        ELSE
  9399           MOVE SPACES           TO PB-I-CLP-STATE
  9400                                    WS-CLP-STATE
  9401        END-IF
  9402     END-IF
  9403
  9404     IF (PB-COMPANY-ID = 'DCC')
  9405        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9406        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9407        CONTINUE
  9408     ELSE
  9409        GO TO 0400-FIND-STATE-RECORD
  9410     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 172
* EL050.cbl
  9411     MOVE SPACES                 TO WS-CLP-STATE
  9412     MOVE +0                     TO WS-BANK-FEE
  9413                                    WS-BANK-LFEE
  9414                                    WS-BANK-NOCHRGB
  9415
  9416     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9417     IF (PB-ISSUE)
  9418        AND (PB-I-BANK-NUMBER NOT =
  9419            SPACES AND ZEROS AND LOW-VALUES)
  9420        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9421     ELSE
  9422        IF (PB-CANCELLATION)
  9423           AND (PB-CI-BANK-NUMBER NOT =
  9424                SPACES AND ZEROS AND LOW-VALUES)
  9425           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9426        END-IF
  9427     END-IF
  9428     IF COMP-FIN-RESP NOT = LOW-VALUES
  9429        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9430        MOVE PB-CARRIER          TO COMP-CARRIER
  9431        MOVE PB-GROUPING         TO COMP-GROUPING
  9432        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9433        MOVE 'B'                 TO COMP-TYPE
  9434        PERFORM 8582-READ-COMPENSATION-MASTER
  9435                                 THRU 8582-EXIT
  9436        IF COMP-MASTER-FOUND
  9437           IF CO-MAX-BANK-FEE NOT NUMERIC
  9438              MOVE +0            TO CO-MAX-BANK-FEE
  9439           END-IF
  9440           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9441              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9442           END-IF
  9443           IF CO-GA-INACTIVE
  9444              MOVE ER-2763       TO WS-ERROR
  9445              PERFORM 9900-ERROR-FORMAT
  9446                                 THRU 9900-EXIT
  9447           END-IF
  9448           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9449              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9450              MOVE ER-2788 TO WS-ERROR
  9451              PERFORM 9900-ERROR-FORMAT
  9452                                 THRU 9900-EXIT
  9453              MOVE +11     TO WS-SUB1
  9454           END-IF
  9455           IF WS-AH-BEN-CATEGORY = 'G'
  9456              MOVE CO-MAX-BANK-FEE
  9457                                 TO WS-BANK-FEE
  9458                                    PB-I-BANK-FEE
  9459           ELSE
  9460              MOVE CO-MAX-BANK-FEE-LEASE
  9461                                 TO WS-BANK-LFEE
  9462                                    PB-I-BANK-FEE
  9463           END-IF
  9464           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9465              AND (WS-AH-REFUND-CALC = 'G'))
  9466                        OR
  9467              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9468              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 173
* EL050.cbl
  9469              CONTINUE
  9470           ELSE
  9471              MOVE ER-2789 TO WS-ERROR
  9472              PERFORM 9900-ERROR-FORMAT
  9473                                 THRU 9900-EXIT
  9474           END-IF
  9475           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9476                                    PB-I-CLP-STATE
  9477           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9478           MOVE CO-CARRIER       TO BXRF-CARRIER
  9479           MOVE CO-GROUPING      TO BXRF-GROUPING
  9480           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9481           MOVE BXRF-MAX-REC-LENGTH
  9482                                 TO BXRF-REC-LENGTH
  9483           PERFORM 8584-READ-BANK-CROSS-REF
  9484                                 THRU 8584-EXIT
  9485           IF BXRF-MASTER-FOUND
  9486              MOVE ' '           TO BANK-ACCT-SW
  9487              MOVE BK-BANK-POINTER-CNT
  9488                                 TO BK-BANK-POINTER-CNT
  9489              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9490                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9491                 OR (BANK-ACCT-FOUND)
  9492                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9493                    AND (BK-AM-EXP-DT (WS-SUB1)
  9494                                 > PB-CERT-EFF-DT)
  9495                    AND (BK-AM-EFF-DT (WS-SUB1)
  9496                                 NOT > PB-CERT-EFF-DT)
  9497                    SET BANK-ACCT-FOUND TO TRUE
  9498                 END-IF
  9499              END-PERFORM
  9500              IF NOT BANK-ACCT-FOUND
  9501                 MOVE ZEROS      TO WS-BANK-FEE
  9502                                    WS-BANK-LFEE
  9503                 MOVE ER-2869    TO WS-ERROR
  9504                 PERFORM 9900-ERROR-FORMAT
  9505                                 THRU 9900-EXIT
  9506              ELSE
  9507                 PERFORM 5000-PROCESS-REPS
  9508                                 THRU 5000-EXIT
  9509                 IF AGENT-MASTER-FOUND
  9510                    MOVE +0      TO WS-BANK-FEE
  9511                                    WS-BANK-LFEE
  9512*                   MOVE AG-SPP-FEES (1)
  9513*                                TO PB-I-BANK-FEE
  9514*                                   WS-BANK-FEE
  9515                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9516                       (WS-SUB1 > +10)
  9517                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9518                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9519                       END-IF
  9520                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9521                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9522                       END-IF
  9523                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9524                          AG-SPP-FEES (WS-SUB1)
  9525                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9526                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 174
* EL050.cbl
  9527                    END-PERFORM
  9528                    IF WS-AH-BEN-CATEGORY = 'G'
  9529                       MOVE WS-BANK-FEE
  9530                                 TO PB-I-BANK-FEE
  9531                    ELSE
  9532                       MOVE WS-BANK-LFEE
  9533                                 TO PB-I-BANK-FEE
  9534                    END-IF
  9535                 END-IF
  9536              END-IF
  9537           END-IF
  9538        ELSE
  9539           MOVE ER-2879          TO WS-ERROR
  9540           PERFORM 9900-ERROR-FORMAT
  9541                                 THRU 9900-EXIT
  9542        END-IF
  9543     ELSE
  9544        MOVE ER-2879             TO WS-ERROR
  9545        PERFORM 9900-ERROR-FORMAT
  9546                                 THRU 9900-EXIT
  9547     END-IF
  9548     IF WS-AH-BEN-CATEGORY = 'G'
  9549        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9550        + WS-BANK-FEE
  9551     ELSE
  9552        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9553        + WS-BANK-LFEE
  9554     END-IF
  9555     .
  9556 0400-FIND-STATE-RECORD.
  9557
  9558     IF WK-STATE-ADDR NOT = ZEROS
  9559         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9560         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9561         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9562         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9563         IF PB-SV-STATE = CF-STATE-CODE
  9564             GO TO 0405-CONTINUE-EDIT
  9565         ELSE
  9566             NEXT SENTENCE
  9567     ELSE
  9568         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9569
  9570     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9571     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9572     MOVE '3'                    TO CNTL-REC-TYPE.
  9573     MOVE +0                     TO CNTL-SEQ-NO.
  9574
  9575     MOVE '3'                    TO RC-SW-2.
  9576     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9577
  9578     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9579        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9580        PB-SV-STATE   NOT = CF-STATE-CODE)
  9581        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9582                                    WS-TOL-AH-CLAIM
  9583                                    WS-MINIMUM-REFUND
  9584                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 175
* EL050.cbl
  9585                                    WS-TOL-AH-PREM
  9586                                    WS-TOL-LF-REFUND
  9587                                    WS-TOL-AH-REFUND
  9588                                    EC-ST-TOL-PREM-PCT
  9589                                    WS-TOL-LF-PREM-PCT
  9590                                    WS-TOL-AH-PREM-PCT
  9591                                    EC-ST-TOL-REFUND-PCT
  9592                                    WS-TOL-LF-REFUND-PCT
  9593                                    WS-TOL-AH-REFUND-PCT
  9594                                    EC-ST-TOL-PREM
  9595                                    EC-ST-TOL-REFUND
  9596                                    EC-ST-FST-PMT-DAYS-MAX
  9597                                    WS-FREE-LOOK-PERIOD
  9598                                    WS-ST-LF-PREM-TAX
  9599                                    WS-ST-AH-PREM-TAX-I
  9600                                    WS-ST-AH-PREM-TAX-G
  9601                                    WS-BANK-FEE
  9602                                    WS-BANK-LFEE
  9603                                    WS-TOL-CLP-PCT
  9604                                    WS-SPP-LEASE-COMM
  9605        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9606                                    EC-ST-FST-PMT-DAYS-CHG
  9607                                    WS-LF-REM-TERM-CALC
  9608                                    WS-LF-REFUND-CALC
  9609                                    EC-ST-LF-REM-TERM-CALC
  9610                                    EC-ST-LF-REFUND-CALC
  9611                                    WS-AH-REM-TERM-CALC
  9612                                    WS-AH-REFUND-CALC
  9613                                    WS-LF-BEN-CATEGORY
  9614                                    WS-AH-BEN-CATEGORY
  9615                                    WS-CLP-STATE
  9616                                    WS-ST-REFUND-CLAIM-FLAG
  9617                                    EC-ST-AH-REM-TERM-CALC
  9618                                    EC-ST-AH-REFUND-CALC
  9619          GO TO 0499-STATE-NOT-FOUND.
  9620
  9621     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9622
  9623 0405-CONTINUE-EDIT.
  9624
  9625     if pb-company-id = 'AHL'
  9626        continue
  9627     else
  9628        IF PB-CERT-PRIME NOT NUMERIC
  9629           MOVE ER-2722          TO WS-ERROR
  9630           PERFORM 9900-ERROR-FORMAT
  9631                                 THRU 9900-EXIT
  9632        end-if
  9633     END-IF
  9634*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9635*       MOVE +0                  TO SUB3
  9636*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9637*       IF SUB3 > +0
  9638*          MOVE ER-2722          TO WS-ERROR
  9639*          PERFORM 9900-ERROR-FORMAT
  9640*                                THRU 9900-EXIT
  9641*       END-IF
  9642*    END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 176
* EL050.cbl
  9643*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9644*       IF PB-CERT-PRIME NOT NUMERIC
  9645*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9646*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9647*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9648*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9649*
  9650*          MOVE ER-2722          TO WS-ERROR
  9651*          PERFORM 9900-ERROR-FORMAT
  9652*                                THRU 9900-EXIT
  9653*       END-IF
  9654*    END-IF
  9655
  9656     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9657
  9658     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9659        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9660                                    WS-TOL-AH-CLAIM.
  9661
  9662     IF CF-ST-REFUND-MIN NOT NUMERIC
  9663        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9664
  9665     IF CF-ST-REFUND-MIN NOT = ZEROS
  9666        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9667
  9668     IF CF-ST-TOL-PREM  NOT = ZEROS
  9669        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9670                                    WS-TOL-AH-PREM
  9671        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9672
  9673     IF CF-ST-TOL-REFUND NOT = ZEROS
  9674        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9675                                    WS-TOL-AH-REFUND
  9676        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9677
  9678     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9679        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9680        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9681                                    WS-AH-REFUND-OVS-AMT
  9682                                    EC-ST-OVR-SHT-AMT.
  9683
  9684     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9685        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9686        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9687                                    WS-TOL-LF-PREM-PCT
  9688                                    WS-TOL-AH-PREM-PCT.
  9689
  9690     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9691        CF-ST-TOL-REF-PCT GREATER THAN +0
  9692        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9693                                    WS-TOL-LF-REFUND-PCT
  9694                                    WS-TOL-AH-REFUND-PCT.
  9695
  9696     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9697        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9698        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9699                                    WS-AH-REFUND-OVS-PCT
  9700                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 177
* EL050.cbl
  9701
  9702     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9703     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9704
  9705     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9706          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9707
  9708     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9709     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9710     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9711
  9712     IF CF-ST-LF-PREM-TAX NUMERIC
  9713        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9714     END-IF
  9715     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9716        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9717     END-IF
  9718     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9719        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9720     END-IF
  9721
  9722     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9723         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9724     END-IF.
  9725
  9726     IF WS-LF-BENEFIT-CD = ZEROS
  9727        GO TO 0410-CHECK-AH.
  9728
  9729     IF CF-ST-RT-CALC NOT = SPACES
  9730        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9731                                    EC-ST-LF-REM-TERM-CALC
  9732     END-IF
  9733
  9734     IF WS-LF-COVERAGE-TYPE = 'R'
  9735        IF WS-LF-EARNINGS-CALC = '5'
  9736           IF CF-ST-RF-LN-CALC > '0'
  9737              MOVE CF-ST-RF-LN-CALC
  9738                                 TO WS-LF-REFUND-CALC
  9739                                    EC-ST-LF-REFUND-CALC
  9740           END-IF
  9741        ELSE
  9742           IF CF-ST-RF-LR-CALC > '0'
  9743              MOVE CF-ST-RF-LR-CALC
  9744                                 TO WS-LF-REFUND-CALC
  9745                                    EC-ST-LF-REFUND-CALC
  9746           END-IF
  9747        END-IF
  9748     ELSE
  9749        IF CF-ST-RF-LL-CALC > '0'
  9750           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9751                                    EC-ST-LF-REFUND-CALC
  9752        END-IF
  9753     END-IF
  9754
  9755     IF CF-ST-RT-CALC NOT = SPACES
  9756        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9757                                    EC-ST-LF-REM-TERM-CALC
  9758     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 178
* EL050.cbl
  9759
  9760     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9761     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9762
  9763     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9764
  9765     IF NO-BENEFIT-FOUND
  9766        GO TO 0410-CHECK-AH.
  9767
  9768     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9769        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9770                                 TO EC-ST-LF-REM-TERM-CALC
  9771                                    WS-LF-REM-TERM-CALC
  9772     END-IF
  9773
  9774     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9775        MOVE CF-ST-REFUND-CALC (SUB3)
  9776                                 TO WS-LF-REFUND-CALC
  9777                                    EC-ST-LF-REFUND-CALC
  9778     END-IF
  9779*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9780
  9781     .
  9782 0410-CHECK-AH.
  9783
  9784     IF WS-AH-BENEFIT-CD = ZEROS
  9785        GO TO 0500-SET-ACCOUNT.
  9786
  9787     IF CF-ST-RT-CALC NOT = SPACES
  9788        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9789                                    EC-ST-AH-REM-TERM-CALC
  9790     END-IF
  9791
  9792     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9793        IF CF-ST-RF-CP-CALC > '0'
  9794           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9795                                    EC-ST-AH-REFUND-CALC
  9796        END-IF
  9797     ELSE
  9798        IF CF-ST-RF-AH-CALC > '0'
  9799           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9800                                    EC-ST-AH-REFUND-CALC
  9801        END-IF
  9802     END-IF
  9803     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9804     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9805
  9806     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9807
  9808     IF NO-BENEFIT-FOUND
  9809        GO TO 0500-SET-ACCOUNT.
  9810
  9811     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9812        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9813                                 TO WS-AH-REM-TERM-CALC
  9814                                    EC-ST-AH-REM-TERM-CALC
  9815     END-IF
  9816
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 179
* EL050.cbl
  9817     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9818        MOVE CF-ST-REFUND-CALC (SUB3)
  9819                                 TO WS-AH-REFUND-CALC
  9820                                    EC-ST-AH-REFUND-CALC
  9821     END-IF
  9822
  9823*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9824
  9825     GO TO 0500-SET-ACCOUNT.
  9826
  9827 0499-STATE-NOT-FOUND.
  9828
  9829     MOVE ER-2603                TO WS-ERROR.
  9830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9831
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 180
* EL050.cbl
  9833
  9834 0500-SET-ACCOUNT.
  9835*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9836     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9837        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9838        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9839        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9840        MOVE '3'                 TO CNTL-REC-TYPE
  9841        MOVE +0                  TO CNTL-SEQ-NO
  9842
  9843        MOVE '3'                 TO RC-SW-2
  9844        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9845
  9846        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9847           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9848           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9849           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9850                                    WS-ST-AH-PREM-TAX-I
  9851                                    WS-ST-AH-PREM-TAX-G
  9852        ELSE
  9853           IF CF-ST-LF-PREM-TAX NUMERIC
  9854              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9855           END-IF
  9856           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9857              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9858           END-IF
  9859           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9860              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9861           END-IF
  9862        END-IF
  9863        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9864     END-IF
  9865*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9866*  FOR DCC ONLY
  9867     IF PB-COMPANY-ID = 'DCC'
  9868
  9869     MOVE ' '                    TO STAT-MASTER-SW
  9870     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9871     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9872     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9873     MOVE PB-STATE               TO ELSTAT-STATE
  9874     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9875        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9876     END-IF
  9877
  9878     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9879     SET BIN-TO-GREG             TO TRUE
  9880     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9881     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9882     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9883
  9884     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9885     IF STAT-MASTER-FOUND
  9886        MOVE 'N'                 TO STAT-MASTER-SW
  9887        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9888        IF STAT-MASTER-FOUND
  9889           IF (ELSTAT-KEY-SAVE (1:12) =
  9890                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 181
* EL050.cbl
  9891              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9892                 MOVE 'F'        TO STAT-MASTER-SW
  9893              ELSE
  9894                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9895                 IF (STAT-MASTER-FOUND)
  9896                    AND (ELSTAT-KEY-SAVE (1:12) =
  9897                        SF-CONTROL-PRIMARY (1:12))
  9898                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9899                    MOVE 'F'     TO STAT-MASTER-SW
  9900                 END-IF
  9901              END-IF
  9902           END-IF
  9903        END-IF
  9904     END-IF
  9905
  9906     IF STAT-MASTER-SW = 'F'
  9907        IF SF-ST-LF-PREM-TAX NUMERIC
  9908           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9909        END-IF
  9910        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9911           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9912        END-IF
  9913        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9914           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9915        END-IF
  9916     END-IF
  9917
  9918     END-IF
  9919     IF (PB-COMPANY-ID = 'DCC')
  9920        AND (PB-ISSUE)
  9921        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9922        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9923        AND (AM-GPCD = 06)
  9924        MOVE 'Y'                 TO WS-GOOD-HIN
  9925        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9926           MOVE PB-I-VIN         TO WS-WORK-VIN
  9927           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9928              (V1 > 16)
  9929              IF WS-WORK-VIN (V1:1) NUMERIC
  9930                 MOVE WS-WORK-VIN-N (V1)
  9931                                 TO WS-ROW-B-VAL (V1)
  9932              ELSE
  9933                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9934                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9935                    OR (V2 > 26)
  9936                 END-PERFORM
  9937                 IF V2 < 27
  9938                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9939                 ELSE
  9940                    MOVE 'N'     TO WS-GOOD-HIN
  9941                 END-IF
  9942              END-IF
  9943              COMPUTE WS-ROW-D-VAL (V1) =
  9944                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9945              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9946                 WS-ROW-D-VAL (V1)
  9947           END-PERFORM
  9948           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 182
* EL050.cbl
  9949           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9950             REMAINDER WS-VIN-REMAINDER
  9951           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9952              CONTINUE
  9953           ELSE
  9954              MOVE 'N'           TO WS-GOOD-HIN
  9955           END-IF
  9956        ELSE
  9957           MOVE 'N'              TO WS-GOOD-HIN
  9958        END-IF
  9959        IF WS-GOOD-HIN NOT = 'Y'
  9960           MOVE ER-3826           TO WS-ERROR
  9961           PERFORM 9900-ERROR-FORMAT
  9962                                 THRU 9900-EXIT
  9963        END-IF
  9964     END-IF
  9965     IF (PB-COMPANY-ID = 'DCC')
  9966        AND (PB-ISSUE)
  9967        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9968        AND (AM-GPCD NOT = 06)
  9969        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9970          MOVE PB-I-VIN          TO WS-WORK-VIN
  9971          MOVE +8                TO V2
  9972          MOVE ZEROS             TO WS-VIN-TOTAL
  9973          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9974           (V1 > 17)
  9975             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9976                MOVE ER-3825     TO WS-ERROR
  9977                PERFORM 9900-ERROR-FORMAT
  9978                                 THRU 9900-EXIT
  9979             ELSE
  9980                IF V1 = 8
  9981                   MOVE 10       TO V2
  9982                END-IF
  9983                IF V1 = 9
  9984                   MOVE 0        TO V2
  9985                END-IF
  9986                IF V1 = 10
  9987                   MOVE 9        TO V2
  9988                END-IF
  9989                IF WS-WORK-VIN (V1:1) NUMERIC
  9990                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9991                    + (WS-WORK-VIN-N (V1) * V2)
  9992                ELSE
  9993                   MOVE WS-WORK-VIN (V1:1)
  9994                                 TO WS-HEX-BYTE
  9995                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9996                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9997                    + (WS-NUM (V3) * V2)
  9998                END-IF
  9999                COMPUTE V2 = V2 - 1
 10000             END-IF
 10001          END-PERFORM
 10002          MOVE ZEROS TO WS-VIN-REMAINDER
 10003          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10004             REMAINDER WS-VIN-REMAINDER
 10005          IF ((WS-WORK-VIN (9:1) = 'X')
 10006             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 183
* EL050.cbl
 10007                     OR
 10008             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10009             CONTINUE
 10010          ELSE
 10011             MOVE ER-3826        TO WS-ERROR
 10012             PERFORM 9900-ERROR-FORMAT
 10013                                 THRU 9900-EXIT
 10014          END-IF
 10015        ELSE
 10016          MOVE ER-3826           TO WS-ERROR
 10017          PERFORM 9900-ERROR-FORMAT
 10018                                 THRU 9900-EXIT
 10019        END-IF
 10020     END-IF
 10021******************************************************************
 10022******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10023******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10024******* METHODS.
 10025******************************************************************
 10026     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10027        IF PB-CANCELLATION
 10028           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10029              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10030                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10031                IF FORM-MASTER-FOUND
 10032                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10033******************************************************************
 10034
 10035     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10036     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10037
 10038     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10039     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10040     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10041     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10042
 10043
 10044     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10045     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10046     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10047
 10048     IF AM-LF-OB-RATE NOT NUMERIC
 10049         MOVE ZERO               TO AM-LF-OB-RATE.
 10050
 10051     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10052         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10053
 10054     IF AM-AH-OB-RATE NOT NUMERIC
 10055         MOVE ZERO               TO AM-AH-OB-RATE.
 10056
 10057     IF WS-LF-JOINT-INDICATOR = 'J'
 10058         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10059     ELSE
 10060         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10061
 10062     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10063
 10064     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 184
* EL050.cbl
 10065         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10066
 10067     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10068         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10069                                       WS-IG-OVRD
 10070     ELSE
 10071         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10072             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10073                                       WS-IG-OVRD
 10074         ELSE
 10075             MOVE AM-IG             TO WS-IG-OVRD-AH
 10076                                       WS-IG-OVRD.
 10077
 10078     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10079         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10080                                       WS-IG-OVRD
 10081     ELSE
 10082         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10083             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10084                                       WS-IG-OVRD
 10085         ELSE
 10086             MOVE AM-IG             TO WS-IG-OVRD-LF
 10087                                       WS-IG-OVRD.
 10088
 10089     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10090     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10091     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10092     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10093     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10094
 10095     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10096     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10097     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10098     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10099
 10100     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10101     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10102     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10103     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10104     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10105     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10106     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10107
 10108     IF WS-ACCT-AH-DEV-PCT > +0
 10109        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10110     ELSE
 10111        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10112
 10113     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10114        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10115     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10116        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10117
 10118        IF AM-EARN-METHOD-L = 'S'
 10119            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10120                                        WS-LF-REFUND-CALC.
 10121
 10122        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 185
* EL050.cbl
 10123            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10124                                        WS-LF-REFUND-CALC.
 10125
 10126     IF WS-LF-COVERAGE-TYPE = 'R'
 10127         IF AM-EARN-METHOD-R = 'R'
 10128            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10129                                    WS-LF-REFUND-CALC.
 10130     IF WS-LF-COVERAGE-TYPE = 'R'
 10131         IF AM-EARN-METHOD-R = 'P'
 10132            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10133                                    WS-LF-REFUND-CALC.
 10134     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10135         IF AM-EARN-METHOD-L = 'R'
 10136            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10137                                    WS-LF-REFUND-CALC.
 10138     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10139         IF AM-EARN-METHOD-L = 'P'
 10140            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10141                                    WS-LF-REFUND-CALC.
 10142     IF WS-LF-COVERAGE-TYPE = 'R'
 10143         IF AM-EARN-METHOD-R = 'A'
 10144            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10145                                    WS-LF-REFUND-CALC.
 10146     IF WS-LF-COVERAGE-TYPE = 'R'
 10147         IF AM-EARN-METHOD-R = 'M'
 10148            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10149                                    WS-LF-REFUND-CALC.
 10150     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10151         IF AM-EARN-METHOD-L = 'A'
 10152            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10153                                    WS-LF-REFUND-CALC.
 10154     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10155         IF AM-EARN-METHOD-L = 'M'
 10156            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10157                                    WS-LF-REFUND-CALC.
 10158
 10159     IF AM-EARN-METHOD-A = 'R'
 10160        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10161                                    WS-AH-REFUND-CALC.
 10162     IF AM-EARN-METHOD-A = 'P'
 10163        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10164                                    WS-AH-REFUND-CALC.
 10165     IF AM-EARN-METHOD-A = 'C'
 10166        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10167                                    WS-AH-REFUND-CALC.
 10168     IF AM-EARN-METHOD-A = 'A'
 10169        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10170                                    WS-AH-REFUND-CALC.
 10171     IF AM-EARN-METHOD-A = 'M'
 10172        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10173                                    WS-AH-REFUND-CALC.
 10174     IF AM-EARN-METHOD-A = 'N'
 10175        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10176                                    WS-AH-REFUND-CALC.
 10177     IF AM-EARN-METHOD-A = 'S'
 10178        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10179                                    WS-AH-REFUND-CALC.
 10180
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 186
* EL050.cbl
 10181     IF AM-TOL-PREM NOT = ZEROS
 10182        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10183                                    WS-TOL-AH-PREM.
 10184
 10185     IF AM-OVR-SHT-AMT NUMERIC AND
 10186                  AM-OVR-SHT-AMT > 0
 10187        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10188                                    EC-AM-LF-OVR-SHT-AMT
 10189                                    WS-AH-REFUND-OVS-AMT
 10190                                    EC-AM-AH-OVR-SHT-AMT.
 10191
 10192     IF AM-OVR-SHT-PCT NUMERIC AND
 10193                    AM-OVR-SHT-PCT > 0
 10194        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10195                                    EC-AM-LF-OVR-SHT-PCT
 10196                                    WS-AH-REFUND-OVS-PCT
 10197                                    EC-AM-AH-OVR-SHT-PCT.
 10198
 10199     IF AM-TOL-REF-PCT NUMERIC AND
 10200                  AM-TOL-REF-PCT > 0
 10201        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10202                                    WS-TOL-AH-REFUND-PCT.
 10203
 10204     IF AM-TOL-REF  NOT = ZEROS  AND
 10205                  AM-TOL-REF NUMERIC
 10206        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10207                                    EC-AM-LF-TOL-REFUND
 10208                                    WS-TOL-AH-REFUND
 10209                                    EC-AM-AH-TOL-REFUND.
 10210
 10211     IF AM-TOL-CLM  NOT = ZEROS
 10212        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10213                                    WS-TOL-AH-CLAIM.
 10214
 10215     IF AM-CLP-TOL-PCT NOT NUMERIC
 10216        MOVE +0                  TO AM-CLP-TOL-PCT
 10217     END-IF
 10218
 10219     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10220        MOVE +0                  TO AM-SPP-LEASE-COMM
 10221     END-IF
 10222     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10223        MOVE WS-PL-TOL-LF-PREM-PCT
 10224                                 TO WS-TOL-LF-PREM-PCT.
 10225
 10226     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10227        MOVE WS-PL-TOL-AH-PREM-PCT
 10228                                 TO WS-TOL-AH-PREM-PCT.
 10229
 10230     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10231        MOVE WS-PL-TOL-LF-REFUND-PCT
 10232                                 TO WS-TOL-LF-REFUND-PCT.
 10233
 10234     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10235        MOVE WS-PL-TOL-AH-REFUND-PCT
 10236                                 TO WS-TOL-AH-REFUND-PCT.
 10237
 10238     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 187
* EL050.cbl
 10239        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10240
 10241     IF WS-PL-REF-OVS-PCT > +0
 10242        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10243
 10244     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10245        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10246     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10247        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10248     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10249        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10250     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10251        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10252     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10253        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10254     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10255        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10256
 10257     IF WS-AH-PL-REF-OVS-AMT > +0
 10258        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10259
 10260     IF WS-AH-PL-REF-OVS-PCT > +0
 10261        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10262
 10263     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10264     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10265
 10266     IF PB-CANCELLATION
 10267        GO TO 3000-CONTINUE-EDIT.
 10268
 10269     MOVE +1 TO SUB1.
 10270     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10271     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10272
 10273     IF CF-COMPANY-ID = 'DMD'
 10274       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10275         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10276        ELSE
 10277         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10278
 10279  0525-FIND-ACCT-COMM.
 10280     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10281        NEXT SENTENCE
 10282      ELSE
 10283         ADD +1 TO SUB1
 10284         IF SUB1 LESS +11
 10285            GO TO 0525-FIND-ACCT-COMM
 10286          ELSE
 10287             GO TO 0560-EDIT-CONTINUE.
 10288
 10289     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10290     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10291                                    PB-I-LIFE-COMMISSION.
 10292***  IF PB-COMPANY-ID = 'CRI'
 10293     IF PB-PREM-ACCTNG-ONLY
 10294         GO TO 0560-EDIT-CONTINUE.
 10295
 10296     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 188
* EL050.cbl
 10297     MOVE ' '    TO WS-CTBL-READ-SW.
 10298
 10299
 10300 0530-GET-AH-COMP.
 10301     IF NO-AH-COVERAGE  OR
 10302        NO-AH-BENEFIT-MATCH
 10303           GO TO 0540-NEXT-READ-STEP.
 10304
 10305     IF AM-A-COM (SUB1) NUMERIC
 10306        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10307         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10308         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10309         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10310         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10311     ELSE
 10312          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10313          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10314          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10315          MOVE ZEROS             TO WS-SUB1
 10316                                    WS-COMMISSION
 10317          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10318          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10319          IF WS-COMMISSION > ZEROS
 10320             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10321             GO TO 0540-NEXT-READ-STEP
 10322          END-IF
 10323          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10324          IF CTBL-TABLE-FOUND
 10325             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10326                                        PB-I-AH-TERM
 10327             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10328             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10329             GO TO 0540-NEXT-READ-STEP
 10330          ELSE
 10331             IF FIRST-TIME-THROUGH
 10332                 GO TO 0530-GET-AH-COMP
 10333             ELSE
 10334                 MOVE ER-2609                TO WS-ERROR
 10335                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10336
 10337 0540-NEXT-READ-STEP.
 10338     MOVE '0540' TO CTBL-SW.
 10339     MOVE ' '    TO WS-CTBL-READ-SW.
 10340
 10341 0540-GET-LF-COMP.
 10342     IF NO-LIFE-COVERAGE  OR
 10343        NO-LF-BENEFIT-MATCH
 10344           GO TO 0560-EDIT-CONTINUE.
 10345
 10346     IF WS-LF-JOINT-INDICATOR = 'J'
 10347        IF AM-J-COM (SUB1) NUMERIC
 10348           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10349           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10350           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10351           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10352           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10353        ELSE
 10354           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 189
* EL050.cbl
 10355           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10356           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10357           MOVE ZEROS                TO WS-SUB1
 10358                                        WS-COMMISSION
 10359           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10360           IF WS-COMMISSION > ZEROS
 10361              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10362              GO TO 0560-EDIT-CONTINUE
 10363           END-IF
 10364           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10365           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10366           IF CTBL-TABLE-FOUND
 10367              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10368              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10369              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10370              GO TO 0560-EDIT-CONTINUE
 10371           ELSE
 10372              IF FIRST-TIME-THROUGH
 10373                  GO TO 0540-GET-LF-COMP
 10374              ELSE
 10375                  MOVE ER-2609                TO WS-ERROR
 10376                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10377                  GO TO 0560-EDIT-CONTINUE.
 10378
 10379     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10380        IF AM-L-COM (SUB1) NUMERIC
 10381           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10382           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10383           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10384           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10385           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10386        ELSE
 10387           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10388           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10389           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10390           MOVE ZEROS                TO WS-SUB1
 10391                                        WS-COMMISSION
 10392           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10393           IF WS-COMMISSION IS GREATER THAN ZEROS
 10394              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10395              GO TO 0560-EDIT-CONTINUE
 10396           END-IF
 10397           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10398           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10399           IF CTBL-TABLE-FOUND
 10400              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10401              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10402              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10403              GO TO 0560-EDIT-CONTINUE
 10404           ELSE
 10405              IF FIRST-TIME-THROUGH
 10406                  GO TO 0540-GET-LF-COMP
 10407              ELSE
 10408                  MOVE ER-2609                TO WS-ERROR
 10409                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10410
 10411*    GO TO 0560-EDIT-CONTINUE.
 10412
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 190
* EL050.cbl
 10413 0560-EDIT-CONTINUE.
 10414     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10415                                    WS-AH-PMF-COMM
 10416*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10417*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10418     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10419        (SUB1 > +10)
 10420        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10421           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10422           MOVE '0530'           TO CTBL-SW
 10423           MOVE ' '              TO WS-CTBL-READ-SW
 10424           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10425           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10426           MOVE '0540'           TO CTBL-SW
 10427           MOVE ' '              TO WS-CTBL-READ-SW
 10428           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10429        END-IF
 10430     END-PERFORM
 10431     GO TO 0564-EDIT-CONTINUE
 10432     .
 10433 0561-CHECK-AH.
 10434     IF (NO-AH-COVERAGE)
 10435        OR (NO-AH-BENEFIT-MATCH)
 10436        CONTINUE
 10437     ELSE
 10438        IF (AM-A-COM (SUB1) NUMERIC)
 10439           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10440           IF (AM-COM-TYP (SUB1) = 'A')
 10441              AND (WS-AH-PMF-COMM = ZEROS)
 10442              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10443           END-IF
 10444           CONTINUE
 10445        ELSE
 10446           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10447           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10448           MOVE PB-AH-OVERRIDE-L1
 10449                                 TO CTBL-BEN-TYPE
 10450           MOVE ZEROS            TO WS-SUB1
 10451                                    WS-COMMISSION
 10452           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10453           PERFORM 8300-READ-CTBL-TABLE
 10454                                 THRU 8300-EXIT
 10455           IF CTBL-TABLE-FOUND
 10456              IF (AM-COM-TYP (SUB1) = 'A')
 10457                 AND (WS-AH-PMF-COMM = ZEROS)
 10458                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10459                                        PB-I-AH-TERM
 10460                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10461                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10462              END-IF
 10463              CONTINUE
 10464           ELSE
 10465              IF FIRST-TIME-THROUGH
 10466                 GO TO 0561-CHECK-AH
 10467              ELSE
 10468                 MOVE ER-2609    TO WS-ERROR
 10469                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10470              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 191
* EL050.cbl
 10471           END-IF
 10472        END-IF
 10473     END-IF
 10474     .
 10475 0561-EXIT.
 10476     EXIT.
 10477 0563-CHECK-LF.
 10478     IF (NO-LIFE-COVERAGE)
 10479        OR (NO-LF-BENEFIT-MATCH)
 10480        CONTINUE
 10481     ELSE
 10482        IF WS-LF-JOINT-INDICATOR = 'J'
 10483           IF AM-J-COM (SUB1) NUMERIC
 10484              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10485              IF (AM-COM-TYP (SUB1) = 'A')
 10486                 AND (WS-LF-PMF-COMM = ZEROS)
 10487                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10488              END-IF
 10489              CONTINUE
 10490           ELSE
 10491              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10492              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10493              MOVE PB-LIFE-OVERRIDE-L1
 10494                                 TO CTBL-BEN-TYPE
 10495              MOVE ZEROS         TO WS-SUB1
 10496                                    WS-COMMISSION
 10497              MOVE AM-J-COMA (SUB1)
 10498                                 TO CTBL-TABLE
 10499              PERFORM 8300-READ-CTBL-TABLE
 10500                                 THRU 8300-EXIT
 10501              IF CTBL-TABLE-FOUND
 10502                 IF (AM-COM-TYP (SUB1) = 'A')
 10503                    AND (WS-LF-PMF-COMM = ZEROS)
 10504                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10505                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10506                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10507                 END-IF
 10508                 CONTINUE
 10509              ELSE
 10510                 IF FIRST-TIME-THROUGH
 10511                    GO TO 0563-CHECK-LF
 10512                 ELSE
 10513                    MOVE ER-2609 TO WS-ERROR
 10514                    PERFORM 9900-ERROR-FORMAT
 10515                                 THRU 9900-EXIT
 10516*                   GO TO 0560-EDIT-CONTINUE
 10517                 END-IF
 10518              END-IF
 10519           END-IF
 10520        ELSE
 10521           IF AM-L-COM (SUB1) NUMERIC
 10522              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10523              IF (AM-COM-TYP (SUB1) = 'A')
 10524                 AND (WS-LF-PMF-COMM = ZEROS)
 10525                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10526              END-IF
 10527              CONTINUE
 10528           ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 192
* EL050.cbl
 10529              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10530              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10531              MOVE PB-LIFE-OVERRIDE-L1
 10532                                 TO CTBL-BEN-TYPE
 10533              MOVE ZEROS         TO WS-SUB1
 10534                                    WS-COMMISSION
 10535              MOVE AM-L-COMA (SUB1)
 10536                                 TO CTBL-TABLE
 10537              PERFORM 8300-READ-CTBL-TABLE
 10538                                 THRU 8300-EXIT
 10539              IF CTBL-TABLE-FOUND
 10540                 CONTINUE
 10541              ELSE
 10542                 IF FIRST-TIME-THROUGH
 10543                    GO TO 0563-CHECK-LF
 10544                 ELSE
 10545                    MOVE ER-2609 TO WS-ERROR
 10546                    PERFORM 9900-ERROR-FORMAT
 10547                                 THRU 9900-EXIT
 10548                 END-IF
 10549              END-IF
 10550           END-IF
 10551        END-IF
 10552     END-IF
 10553     .
 10554 0563-EXIT.
 10555     EXIT.
 10556 0564-EDIT-CONTINUE.
 10557
 10558     IF  PB-COMPANY-ID EQUAL 'DMD'
 10559         IF PB-I-NUM-BILLED EQUAL ZEROS
 10560            MOVE ER-8148       TO WS-ERROR
 10561            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10562
 10563*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10564*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10565*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10566*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10567*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10568*         IF NO-CONVERSION-ERROR
 10569*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10570*         ELSE
 10571*             IF PB-COMPANY-ID EQUAL 'HAN'
 10572*                 MOVE ZEROS     TO PB-I-AGE.
 10573     IF PB-I-BIRTHDAY > LOW-VALUES
 10574        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10575        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10576        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10577        PERFORM 8500-DATE-CONVERT
 10578                                 THRU 8500-EXIT
 10579        IF NO-CONVERSION-ERROR
 10580           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10581           IF PB-I-AGE > ZEROS
 10582              IF WS-WORK-AGE NOT = PB-I-AGE
 10583                 MOVE ER-9501    TO WS-ERROR
 10584                 PERFORM 9900-ERROR-FORMAT
 10585                                 THRU 9900-EXIT
 10586              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 193
* EL050.cbl
 10587           ELSE
 10588              MOVE WS-WORK-AGE   TO PB-I-AGE
 10589           END-IF
 10590        END-IF
 10591     END-IF
 10592     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10593                                   WS-INS-AGE-SET
 10594     IF PB-I-AGE = ZEROS
 10595        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10596           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10597                                   WS-INS-AGE-SET
 10598           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10599
 10600     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10601                                   WS-AH-EDIT-AGE.
 10602
 10603     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10604        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10605        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10606        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10607        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10608        IF NO-CONVERSION-ERROR
 10609           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10610           IF PB-I-JOINT-AGE > 0
 10611              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10612                 MOVE ER-9503    TO WS-ERROR
 10613                 PERFORM 9900-ERROR-FORMAT
 10614                                 THRU 9900-EXIT
 10615              END-IF
 10616           ELSE
 10617              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10618           END-IF
 10619        ELSE
 10620           MOVE ZEROS            TO PB-I-JOINT-AGE
 10621        END-IF
 10622     END-IF
 10623     IF PB-I-JOINT-AGE NOT NUMERIC
 10624        MOVE ZERO               TO PB-I-JOINT-AGE.
 10625
 10626     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10627                                   WS-JNT-AGE-SET
 10628     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10629        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10630           (WS-AH-JOINT-INDICATOR = 'J')
 10631           IF PB-I-JOINT-AGE = ZEROS
 10632               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10633                                          WS-JNT-AGE-SET
 10634               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10635           END-IF
 10636        END-IF
 10637     END-IF
 10638
 10639     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10640     IF WS-LF-JOINT-INDICATOR = 'J'
 10641        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10642        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10643            IF  PB-I-JOINT-AGE = ZERO
 10644                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 194
* EL050.cbl
 10645                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10646            ELSE
 10647                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10648                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10649                    IF PB-COMPANY-ID NOT = 'LBL'
 10650                        MOVE ER-2685    TO WS-ERROR
 10651                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10652
 10653     IF WS-AH-JOINT-INDICATOR = 'J'
 10654        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10655            IF  PB-I-JOINT-AGE = ZERO
 10656                MOVE ER-2686       TO WS-ERROR
 10657                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10658            ELSE
 10659                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10660                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10661                                           WS-EDIT-AGE
 10662                    IF PB-COMPANY-ID NOT = 'LBL'
 10663                        MOVE ER-2685    TO WS-ERROR
 10664                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10665
 10666******************************************************************
 10667*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10668******************************************************************
 10669
 10670     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10671        (WS-AH-SPECIAL-CALC-CD = 'O')
 10672        NEXT SENTENCE
 10673     ELSE
 10674        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10675          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10676           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10677            WS-AH-JOINT-INDICATOR = 'J')  AND
 10678           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10679            MOVE ER-2627             TO WS-ERROR
 10680            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10681
 10682     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10683        (WS-AH-SPECIAL-CALC-CD = 'O')
 10684         NEXT SENTENCE
 10685     ELSE
 10686         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10687            WS-AH-JOINT-INDICATOR = 'J'
 10688             IF PB-I-JOINT-INSURED = SPACES
 10689                 IF PB-COMPANY-ID NOT = 'JAL'
 10690                     MOVE ER-2696    TO WS-ERROR
 10691                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10692
 10693     IF PB-COMPANY-ID NOT = 'BOA'
 10694        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10695           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10696           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10697               PB-I-JOINT-INSURED NOT = SPACES)
 10698                MOVE ER-2691         TO WS-ERROR
 10699                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
 10701     IF PB-COMPANY-ID = 'BOA'
 10702        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 195
* EL050.cbl
 10703           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10704            IF PB-I-JOINT-AGE NOT = ZEROS
 10705                MOVE ER-2691         TO WS-ERROR
 10706                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10707
 10708     IF PB-COMPANY-ID = 'CRI'
 10709        IF PB-I-SIG-SW = 'J'
 10710           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10711              WS-AH-JOINT-INDICATOR NOT = 'J'
 10712              MOVE ER-2675       TO WS-ERROR
 10713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10714
 10715     IF PB-COMPANY-ID = 'CRI'
 10716        IF PB-I-SIG-SW = 'S'
 10717           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10718              WS-AH-JOINT-INDICATOR = 'J'
 10719              MOVE ER-2676       TO WS-ERROR
 10720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10721
 10722     IF PB-COMPANY-ID = 'CVL'
 10723         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10724            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10725              MOVE ER-2783           TO WS-ERROR
 10726              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10727     IF (WS-LF-JOINT-INDICATOR = 'J')
 10728        AND (WS-AH-JOINT-INDICATOR = 'J')
 10729        AND (PB-I-LF-TERM > 120)
 10730        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10731        MOVE ER-2783             TO WS-ERROR
 10732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10733     END-IF
 10734     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10735
 10736     IF PB-I-INDV-GRP-OVRD = 'I'
 10737        MOVE ER-2666             TO WS-ERROR
 10738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10739        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10740
 10741     IF PB-I-INDV-GRP-OVRD = 'G'
 10742        MOVE ER-2666             TO WS-ERROR
 10743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10744        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10745
 10746     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10747        NEXT SENTENCE
 10748     ELSE
 10749        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10750
 10751     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10752        IF WS-ERROR = ER-2666
 10753           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10754           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10755
 10756     IF PB-COMPANY-ID = 'CID'
 10757        IF PB-STATE = 'UT' OR 'MO'
 10758           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10759                 OR '76' OR '77')
 10760                      OR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 196
* EL050.cbl
 10761               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10762                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10763                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10764                   OR '2K' OR '2L'))
 10765              AND PB-I-INDV-GRP-CD = 'I'
 10766              MOVE ER-2721             TO WS-ERROR
 10767              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10768           END-IF
 10769        END-IF
 10770     END-IF
 10771
 10772     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10773     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10774        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10775     ELSE
 10776        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10777     END-IF
 10778
 10779*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10780*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10781     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10782                                    ACCOUNT-AH-CK-SW.
 10783
 10784     IF PB-REISSUED-CERT       OR
 10785        PB-REIN-ONLY-CERT      OR
 10786        PB-POLICY-IS-DECLINED  OR
 10787        PB-POLICY-IS-VOIDED
 10788*       OR PB-MONTHLY-CERT
 10789         GO TO 3000-CONTINUE-EDIT.
 10790
 10791     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10792        IF WS-EDIT-AGE           > +65
 10793           MOVE ER-2709          TO WS-ERROR
 10794           PERFORM 9900-ERROR-FORMAT
 10795                                 THRU 9900-EXIT
 10796        ELSE
 10797           IF WS-EDIT-AGE        > +55
 10798              MOVE ER-2718       TO WS-ERROR
 10799              PERFORM 9900-ERROR-FORMAT
 10800                                 THRU 9900-EXIT
 10801           END-IF
 10802        END-IF
 10803     IF PB-COMPANY-ID = 'DCC'
 10804        IF WS-EDIT-AGE           > +65
 10805           MOVE ER-2709          TO WS-ERROR
 10806           PERFORM 9900-ERROR-FORMAT
 10807                                 THRU 9900-EXIT
 10808        END-IF
 10809     END-IF
 10810     .
 10811
 10812 0565-LIFE-PLAN-LIMIT-EDITS.
 10813
 10814     IF NOT LF-PLAN-MASTER-FOUND
 10815        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10816                                    EC-AM-LF-MAX-TOT-BEN
 10817        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10818
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 197
* EL050.cbl
 10819     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10820
 10821     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10822         IF PL-LM-AGE (1) = ZEROS
 10823             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10824
 10825     IF NO-LF-BENEFIT-MATCH          OR
 10826        WS-LF-BENEFIT-CD = ZEROS     OR
 10827        WS-LF-SPECIAL-CALC-CD = 'M'
 10828        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10829
 10830     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10831     MOVE +1                     TO SUB2.
 10832
 10833     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10834        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10835           MOVE +5   TO SUB2
 10836           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10837              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10838              (PL-LM-AGE (SUB2) EQUAL +0)
 10839              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10840              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10841
 10842     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10843
 10844     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10845                               + PB-I-LF-ALT-BENEFIT-AMT.
 10846
 10847 0568-CHECK-LIFE-ATT-AGE.
 10848
 10849     IF PL-ATT-AGE NUMERIC AND
 10850        PL-ATT-AGE > +0
 10851        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10852     END-IF
 10853*    IF PL-ATT-AGE NUMERIC AND
 10854*       PL-ATT-AGE > +0
 10855*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10856*       IF PB-I-BIRTHDAY > LOW-VALUES
 10857*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10858*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10859*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10860*          SET BIN-PLUS-ELAPSED  TO TRUE
 10861*          PERFORM 8500-DATE-CONVERT
 10862*                                THRU 8500-EXIT
 10863*          IF NO-CONVERSION-ERROR
 10864*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10865*             MOVE ER-2669       TO WS-ERROR
 10866*             PERFORM 9900-ERROR-FORMAT
 10867*                                THRU 9900-EXIT
 10868*          END-IF
 10869*       ELSE
 10870*          IF WS-ATT-AGE >= PL-ATT-AGE
 10871*             MOVE ER-2669       TO WS-ERROR
 10872*             PERFORM 9900-ERROR-FORMAT
 10873*                                THRU 9900-EXIT
 10874*          END-IF
 10875*       END-IF
 10876*    END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 198
* EL050.cbl
 10877     .
 10878 0570-CHECK-LIFE-LIMITS.
 10879
 10880     IF PB-COMPANY-ID EQUAL 'CRI'
 10881        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10882           IF SUB2 GREATER THAN +4
 10883              MOVE ER-2637 TO WS-ERROR
 10884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10885              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10886
 10887     IF PB-COMPANY-ID  =  'NCL'
 10888        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10889            SUB2 GREATER THAN +8
 10890             MOVE 'U'         TO PB-BATCH-ENTRY
 10891             MOVE ER-2637     TO WS-ERROR
 10892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10894
 10895     IF SUB2 > +8
 10896        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10897           AND (PB-I-SIG-SW = 'Y')
 10898           CONTINUE
 10899        ELSE
 10900           MOVE ER-2637          TO WS-ERROR
 10901           PERFORM 9900-ERROR-FORMAT
 10902                                 THRU 9900-EXIT
 10903        END-IF
 10904        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10905     END-IF
 10906     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10907     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10908     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10909
 10910     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10911        ADD +1  TO SUB2
 10912        GO TO 0570-CHECK-LIFE-LIMITS.
 10913
 10914     IF PB-COMPANY-ID = 'NCL'
 10915         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10916
 10917     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10918        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10919        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10920           AND (PB-I-SIG-SW = 'Y')
 10921           CONTINUE
 10922        ELSE
 10923           MOVE ER-2637          TO WS-ERROR
 10924           PERFORM 9900-ERROR-FORMAT
 10925                                 THRU 9900-EXIT
 10926        END-IF
 10927     END-IF
 10928     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10929
 10930
 10931 0570-CHECK-NCL-LIFE-LIMITS.
 10932
 10933     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10934        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 199
* EL050.cbl
 10935         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10936
 10937     IF APP-CERT-USED
 10938         IF SUB2  LESS THAN  +5
 10939             MOVE +5          TO SUB2
 10940             GO TO 0570-CHECK-LIFE-LIMITS.
 10941
 10942     MOVE ER-2637             TO WS-ERROR.
 10943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10944
 10945     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10946
 10947 0575-CHECK-NCL-SIG-SWITCH.
 10948
 10949     IF NOT APP-CERT-USED
 10950         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10951
 10952     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10953        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10954        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10955        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10956         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10957
 10958     IF SUB2 GREATER THAN +4
 10959         IF PL-LM-AGE (5) = ZEROS  AND
 10960            PL-LM-AGE (6) = ZEROS  AND
 10961            PL-LM-AGE (7) = ZEROS  AND
 10962            PL-LM-AGE (8) = ZEROS
 10963             MOVE  ER-1927        TO WS-ERROR
 10964             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10965             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10966         ELSE
 10967             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10968                 MOVE  ER-1920    TO WS-ERROR
 10969                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10970
 10971     IF PB-I-SIG-SW  = 'Y'
 10972       IF NOT PB-I-POLICY-ACCEPTED  AND
 10973          NOT PB-I-POLICY-DECLINED
 10974           MOVE 'U'               TO PB-BATCH-ENTRY
 10975           MOVE  ER-1926          TO WS-ERROR
 10976           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10977
 10978
 10979 0580-AH-PLAN-LIMIT-EDITS.
 10980
 10981     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10982        IF PB-I-AH-BENEFIT-AMT > +1250
 10983           MOVE ER-2702          TO WS-ERROR
 10984           PERFORM 9900-ERROR-FORMAT
 10985                                 THRU 9900-EXIT
 10986        END-IF
 10987     END-IF
 10988
 10989     IF (PB-COMPANY-ID = 'DCC')
 10990        AND (PB-MONTHLY-CERT)
 10991        IF PB-I-AH-BENEFIT-AMT > +3000
 10992           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 200
* EL050.cbl
 10993           PERFORM 9900-ERROR-FORMAT
 10994                                 THRU 9900-EXIT
 10995        END-IF
 10996     END-IF
 10997     IF NOT AH-PLAN-MASTER-FOUND
 10998        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10999        GO TO 3000-CONTINUE-EDIT.
 11000
 11001     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11002
 11003     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11004         IF PL-LM-AGE (1) = ZEROS
 11005             GO TO 3000-CONTINUE-EDIT.
 11006
 11007     IF NO-AH-BENEFIT-MATCH          OR
 11008        WS-AH-BENEFIT-CD = ZEROS     OR
 11009        WS-AH-SPECIAL-CALC-CD = 'M'
 11010        GO TO 3000-CONTINUE-EDIT.
 11011
 11012     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11013     MOVE +1                     TO SUB2.
 11014
 11015     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11016        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11017           MOVE +5 TO SUB2
 11018           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11019              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11020              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11021              (PL-LM-AGE (SUB2) EQUAL +0)
 11022              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11023              GO TO 3000-CONTINUE-EDIT.
 11024
 11025     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11026
 11027 0590-CHECK-AH-ATT-AGE.
 11028
 11029     IF PL-ATT-AGE NUMERIC AND
 11030        PL-ATT-AGE GREATER THAN +0
 11031        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11032     END-IF
 11033*       IF WS-ATT-AGE >= PL-ATT-AGE
 11034*          MOVE ER-3054          TO WS-ERROR
 11035*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11036     .
 11037 0597-CHECK-AH-LIMITS.
 11038
 11039     IF PB-COMPANY-ID EQUAL 'CRI'
 11040        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11041           IF SUB2 GREATER THAN +4
 11042              MOVE ER-2638       TO WS-ERROR
 11043              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11044              GO TO 3000-CONTINUE-EDIT.
 11045
 11046     IF PB-COMPANY-ID  =  'NCL'
 11047        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11048            SUB2 GREATER THAN +8
 11049             MOVE 'U'            TO PB-BATCH-ENTRY
 11050             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 201
* EL050.cbl
 11051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11052             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11053
 11054     IF SUB2 > +8
 11055        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11056           AND (PB-I-SIG-SW = 'Y')
 11057           CONTINUE
 11058        ELSE
 11059           MOVE ER-2638          TO WS-ERROR
 11060           PERFORM 9900-ERROR-FORMAT
 11061                                 THRU 9900-EXIT
 11062        END-IF
 11063        GO TO 3000-CONTINUE-EDIT
 11064     END-IF
 11065
 11066     IF PB-COMPANY-ID = 'CRI'
 11067        IF WS-ERROR = ER-2638
 11068           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11069
 11070     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11071     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11072     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11073     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11074
 11075     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11076        ADD +1                   TO SUB2
 11077        GO TO 0597-CHECK-AH-LIMITS.
 11078
 11079     IF PB-COMPANY-ID = 'NCL'
 11080         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11081
 11082     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11083        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11084        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11085                                 > PL-LM-AMT (SUB2))
 11086        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11087           AND (PB-I-SIG-SW = 'Y')
 11088           CONTINUE
 11089        ELSE
 11090           MOVE ER-2638          TO WS-ERROR
 11091           PERFORM 9900-ERROR-FORMAT
 11092                                 THRU 9900-EXIT
 11093        END-IF
 11094     END-IF
 11095
 11096     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11097         IF  WS-ERROR    EQUAL    ER-2638
 11098             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11099                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11100                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11101                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11102                MOVE  ER-1910    TO  WS-ERROR
 11103                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11104
 11105     IF PB-COMPANY-ID = 'CRI'
 11106        IF WS-ERROR = ER-2638
 11107            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11108            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 202
* EL050.cbl
 11109            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11110
 11111     GO TO 3000-CONTINUE-EDIT.
 11112
 11113 0597-CHECK-NCL-AH-LIMITS.
 11114
 11115     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11116        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11117        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11118                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11119         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11120
 11121     IF APP-CERT-USED
 11122         IF SUB2  LESS THAN  +5
 11123             MOVE +5             TO SUB2
 11124             GO TO 0597-CHECK-AH-LIMITS.
 11125
 11126     MOVE ER-2638                TO WS-ERROR.
 11127     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11128
 11129     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11130
 11131 0599-CHECK-NCL-SIG-SWITCH.
 11132
 11133     IF NOT APP-CERT-USED
 11134         GO TO 3000-CONTINUE-EDIT.
 11135
 11136     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11137        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11138        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11139        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11140         GO TO 3000-CONTINUE-EDIT.
 11141
 11142     IF SUB2 GREATER THAN +4
 11143         IF PL-LM-AGE (5) = ZEROS  AND
 11144            PL-LM-AGE (6) = ZEROS  AND
 11145            PL-LM-AGE (7) = ZEROS  AND
 11146            PL-LM-AGE (8) = ZEROS
 11147             MOVE  ER-1927        TO WS-ERROR
 11148             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11149             GO TO 3000-CONTINUE-EDIT
 11150         ELSE
 11151             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11152                 MOVE  ER-1920    TO WS-ERROR
 11153                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11154
 11155     IF PB-I-SIG-SW  = 'Y'
 11156       IF NOT PB-I-POLICY-ACCEPTED  AND
 11157          NOT PB-I-POLICY-DECLINED
 11158           MOVE 'U'               TO PB-BATCH-ENTRY
 11159           MOVE  ER-1926          TO WS-ERROR
 11160           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11161
 11162******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 203
* EL050.cbl
 11164
 11165 3000-CONTINUE-EDIT.
 11166
 11167     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11168     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11169     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11170     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11171     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11172
 11173     IF BROWSE-STARTED
 11174        PERFORM 9990-RETURN THRU 9990-EXIT
 11175        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11176
 11177     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11178        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11179        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11180        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11181*       MOVE 1                   TO DC-OPTION-CODE
 11182        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11183        IF DATE-CONVERSION-ERROR
 11184           MOVE ER-2622          TO WS-ERROR
 11185           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11186        ELSE
 11187           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11188              MOVE ER-2623       TO WS-ERROR
 11189              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11190           ELSE
 11191              MOVE ER-2622       TO WS-ERROR
 11192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11193
 11194     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11195     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11196     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11197*    MOVE 1                      TO DC-OPTION-CODE.
 11198     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11199     IF DATE-CONVERSION-ERROR
 11200        GO TO 3005-EDIT-CONTINUE
 11201     ELSE
 11202        IF DC-ELAPSED-DAYS GREATER +180
 11203           MOVE ER-2613          TO WS-ERROR
 11204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205        ELSE
 11206           IF DC-ELAPSED-DAYS GREATER +90
 11207              MOVE ER-2612       TO WS-ERROR
 11208              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11209           ELSE
 11210             IF DC-ELAPSED-DAYS GREATER +60
 11211                MOVE ER-2614     TO WS-ERROR
 11212                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11213
 11214 3005-EDIT-CONTINUE.
 11215
 11216     IF PB-CANCELLATION
 11217         GO TO 3700-EDIT-CANCEL.
 11218
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 204
* EL050.cbl
 11220******************************************************************
 11221*                  E D I T   I S S U E                           *
 11222******************************************************************
 11223
 11224 3020-EDIT-ISSUE.
 11225
 11226      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11227      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11228      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11229      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11230      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11231
 11232     IF PB-ISSUE-FORCE
 11233        OR PB-ISSUE-DATE-FORCED
 11234        OR PB-FORCE-OFF
 11235        OR PB-OVERCHARGE-FORCE
 11236        CONTINUE
 11237     ELSE
 11238        MOVE ER-2670             TO WS-ERROR
 11239        PERFORM 9900-ERROR-FORMAT
 11240                                 THRU 9900-EXIT
 11241     END-IF
 11242     .
 11243 3022-SET-POLICY-STATUS.
 11244
 11245     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11246
 11247     IF (PB-REISSUED-CERT)
 11248             OR
 11249        ((PB-COMPANY-ID NOT = 'DCC')
 11250         AND (PB-MONTHLY-CERT))
 11251         MOVE '5'                TO PB-I-ENTRY-STATUS
 11252         MOVE 'E'                TO PB-BATCH-ENTRY
 11253     END-IF
 11254
 11255     IF PB-COMPANY-ID = 'DCC'
 11256        IF PB-MONTHLY-CERT
 11257           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11258        END-IF
 11259     END-IF
 11260     IF PB-POLICY-IS-DECLINED
 11261         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11262     IF PB-POLICY-IS-VOIDED
 11263         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11264     IF PB-NEEDS-UNDERWRITING
 11265         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11266     IF PB-REIN-ONLY-CERT
 11267         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11268     IF PB-PREM-ACCTNG-ONLY
 11269         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11270
 11271     MOVE SPACE                  TO PB-I-OB-FLAG.
 11272
 11273     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11274         MOVE ER-2665            TO WS-ERROR
 11275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11276         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11277
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 205
* EL050.cbl
 11278     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11279        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11280           MOVE 'Z'             TO PB-I-OB-FLAG.
 11281
 11282     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11283        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11284           MOVE 'Z'             TO PB-I-OB-FLAG.
 11285
 11286     IF ACCOUNT-MAST-FOUND
 11287         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11288         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11289         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11290         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11291         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11292         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11293         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11294     END-IF
 11295
 11296     IF ACCOUNT-MAST-FOUND
 11297        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11298         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11299
 11300     IF (ACCOUNT-MAST-FOUND)
 11301        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11302        IF PB-REISSUED-CERT
 11303           CONTINUE
 11304        ELSE
 11305           MOVE ER-2608          TO WS-ERROR
 11306           PERFORM 9900-ERROR-FORMAT
 11307                                 THRU 9900-EXIT
 11308         END-IF
 11309     END-IF
 11310
 11311     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11312        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11313        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11314
 11315**********   DMD CUSTOM CODE FOLLOWS  **********
 11316 3024-EDIT-DMD-FIELDS.
 11317     IF PB-COMPANY-ID NOT = 'DMD'
 11318        GO TO 3025-EDIT-REINSURANCE.
 11319
 11320*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11321*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11322*** ERROR IF THEY ARE NOT EQUAL.
 11323
 11324     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11325     SET BIN-TO-GREG               TO TRUE.
 11326     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11327     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11328**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11329
 11330     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11331     SET BIN-TO-GREG               TO TRUE.
 11332     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11333     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11334**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11335
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 206
* EL050.cbl
 11336     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11337        MOVE ER-8116               TO WS-ERROR
 11338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11339
 11340     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11341
 11342     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11343                                      WK-FULL-CERT-NO.
 11344     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11345
 11346     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11347
 11348     IF PB-VALID-LIFE
 11349        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11350     ELSE
 11351        IF PB-VALID-AH
 11352          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11353
 11354
 11355     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11356     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11357     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11358                                      DCUA-UNDRWRTR-CODE
 11359                                      DCUA-UNDRWRTR-GROUP-CODE
 11360                                      DCUA-RETURN-CODE.
 11361
 11362****************************************************************
 11363*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11364***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11365***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11366***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11367***   TO THIS RECORD.                                        ***
 11368****************************************************************
 11369     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11370     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11371     IF DCUA-SUCCESSFUL-PROCESS
 11372        GO TO 3024-EDIT-DL7-CONT.
 11373
 11374     IF DCUA-RETURN-CODE EQUAL '01'
 11375        MOVE ER-8110               TO WS-ERROR
 11376        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11378        GO TO 3024-EDIT-DL7-CONT.
 11379
 11380     IF DCUA-RETURN-CODE EQUAL '02'
 11381        MOVE ER-8111               TO WS-ERROR
 11382        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11384        GO TO 3024-EDIT-DL7-CONT.
 11385
 11386     IF DCUA-RETURN-CODE EQUAL '03'
 11387        MOVE ER-8074               TO WS-ERROR
 11388        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390        GO TO 3024-EDIT-DL7-CONT.
 11391
 11392     IF DCUA-RETURN-CODE EQUAL '04'
 11393        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 207
* EL050.cbl
 11394        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11396        GO TO 3024-EDIT-DL7-CONT.
 11397
 11398     IF DCUA-RETURN-CODE EQUAL '05'
 11399        MOVE ER-8076               TO WS-ERROR
 11400        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11402        GO TO 3024-EDIT-DL7-CONT.
 11403
 11404     IF DCUA-RETURN-CODE EQUAL '06'
 11405        MOVE ER-8077               TO WS-ERROR
 11406        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11408        GO TO 3024-EDIT-DL7-CONT.
 11409
 11410     IF DCUA-RETURN-CODE EQUAL '07'
 11411        MOVE ER-8078               TO WS-ERROR
 11412        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11414        GO TO 3024-EDIT-DL7-CONT.
 11415
 11416     IF DCUA-RETURN-CODE EQUAL 'E1'
 11417        MOVE ER-8079               TO WS-ERROR
 11418        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11420        GO TO 3024-EDIT-DL7-CONT.
 11421
 11422     IF DCUA-RETURN-CODE EQUAL 'E2'
 11423        MOVE ER-8080               TO WS-ERROR
 11424        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11426        GO TO 3024-EDIT-DL7-CONT.
 11427
 11428     IF DCUA-RETURN-CODE EQUAL 'E3'
 11429        MOVE ER-8098               TO WS-ERROR
 11430        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432        GO TO 3024-EDIT-DL7-CONT.
 11433
 11434     IF DCUA-RETURN-CODE EQUAL 'C1'
 11435        MOVE ER-8099               TO WS-ERROR
 11436        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11438        GO TO 3024-EDIT-DL7-CONT.
 11439
 11440     IF DCUA-RETURN-CODE EQUAL 'U1'
 11441        MOVE ER-8109               TO WS-ERROR
 11442        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 3024-EDIT-DL7-CONT.
 11445
 11446     IF DCUA-RETURN-CODE EQUAL 'N1'
 11447        MOVE ER-8112               TO WS-ERROR
 11448        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11450        GO TO 3024-EDIT-DL7-CONT.
 11451
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 208
* EL050.cbl
 11452     IF DCUA-RETURN-CODE EQUAL 'N2'
 11453        MOVE ER-8113               TO WS-ERROR
 11454        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11456        GO TO 3024-EDIT-DL7-CONT.
 11457
 11458     IF DCUA-RETURN-CODE EQUAL 'N3'
 11459        MOVE ER-8114               TO WS-ERROR
 11460        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11462        GO TO 3024-EDIT-DL7-CONT.
 11463
 11464     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11465     MOVE ER-8097                  TO WS-ERROR.
 11466     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11467     GO TO 3024-EDIT-DL7-CONT.
 11468
 11469 3024-EDIT-DL7-CONT.
 11470
 11471     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11472     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11473     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11474        NEXT SENTENCE
 11475     ELSE
 11476        MOVE ER-9263               TO WS-ERROR
 11477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11478
 11479******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11480******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11481     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11482        NEXT SENTENCE
 11483     ELSE
 11484        MOVE ER-8039               TO WS-ERROR
 11485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11486
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 209
* EL050.cbl
 11488****************************************************************
 11489*** VALIDATE STATE  : DLO022                                 ***
 11490****************************************************************
 11491     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11492     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11493
 11494     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11495     IF DVSC-SUCCESSFUL-EDIT
 11496        GO TO 3024-EDIT-DL22-CONT.
 11497
 11498     IF DVSC-RETURN-CODE EQUAL '01'
 11499        MOVE ER-8300               TO WS-ERROR
 11500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11501        GO TO 3024-EDIT-DL22-CONT.
 11502
 11503     IF DVSC-RETURN-CODE EQUAL '02'
 11504        MOVE ER-8301               TO WS-ERROR
 11505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11506        GO TO 3024-EDIT-DL22-CONT.
 11507
 11508     IF DVSC-RETURN-CODE EQUAL '03'
 11509        MOVE ER-8302               TO WS-ERROR
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511        GO TO 3024-EDIT-DL22-CONT.
 11512
 11513     IF DVSC-RETURN-CODE EQUAL 'N1'
 11514        MOVE ER-8304               TO WS-ERROR
 11515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11516        GO TO 3024-EDIT-DL22-CONT.
 11517
 11518     MOVE ER-8303                  TO WS-ERROR
 11519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11520
 11521 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 210
* EL050.cbl
 11523****************************************************************
 11524*** VALIDATE LOAN OFFICER : DLO021                           ***
 11525****************************************************************
 11526
 11527     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11528     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11529     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11530     IF DVLO-SUCCESSFUL-EDIT
 11531        GO TO 3024-EDIT-DL21-CONT.
 11532
 11533     IF DVLO-RETURN-CODE EQUAL '01'
 11534        MOVE ER-8081               TO WS-ERROR
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL21-CONT.
 11537
 11538     IF DVLO-RETURN-CODE EQUAL '02'
 11539        MOVE ER-8082               TO WS-ERROR
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL21-CONT.
 11542
 11543     IF DVLO-RETURN-CODE EQUAL '03'
 11544        MOVE ER-8083               TO WS-ERROR
 11545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546        GO TO 3024-EDIT-DL21-CONT.
 11547
 11548     IF DVLO-RETURN-CODE EQUAL '04'
 11549        MOVE ER-8084               TO WS-ERROR
 11550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11551        GO TO 3024-EDIT-DL21-CONT.
 11552
 11553     IF DVLO-RETURN-CODE EQUAL '05'
 11554        MOVE ER-8085               TO WS-ERROR
 11555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11556        GO TO 3024-EDIT-DL21-CONT.
 11557
 11558     MOVE ER-7825                  TO WS-ERROR
 11559     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11560     GO TO 3024-EDIT-DL21-CONT.
 11561
 11562 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 211
* EL050.cbl
 11564
 11565****************************************************************
 11566*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11567****************************************************************
 11568
 11569     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11570     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11571     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11572     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11573     IF DIPF-SUCCESSFUL-EDIT
 11574        GO TO 3024-EDIT-DL02-CONT.
 11575
 11576     IF DIPF-RETURN-CODE EQUAL '01'
 11577        MOVE ER-8086               TO WS-ERROR
 11578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579        GO TO 3024-EDIT-DL02-CONT.
 11580
 11581     IF DIPF-RETURN-CODE EQUAL '02'
 11582        MOVE ER-8087               TO WS-ERROR
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL02-CONT.
 11585
 11586     IF DIPF-RETURN-CODE EQUAL '03'
 11587        MOVE ER-8088               TO WS-ERROR
 11588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11589        GO TO 3024-EDIT-DL02-CONT.
 11590
 11591     MOVE ER-8095                  TO WS-ERROR
 11592     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11593     GO TO 3024-EDIT-DL02-CONT.
 11594
 11595 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 212
* EL050.cbl
 11597
 11598****************************************************************
 11599*** VALIDATE BANK ID : DLO003                                ***
 11600****************************************************************
 11601
 11602     MOVE WK-GREG-CENT           TO WCG-CENT.
 11603     MOVE WK-GREG-YYMM           TO WCG-REST.
 11604     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11605        MOVE ER-8040               TO WS-ERROR
 11606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11607
 11608     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11609     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11610     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11611     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11612     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11613     IF DVBI-SUCCESSFUL-EDIT
 11614        GO TO 3024-EDIT-DL03-CONT.
 11615
 11616     IF DVBI-RETURN-CODE EQUAL '01'
 11617        MOVE ER-8089               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL03-CONT.
 11620
 11621     IF DVBI-RETURN-CODE EQUAL '02'
 11622        MOVE ER-8090               TO WS-ERROR
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL03-CONT.
 11625
 11626     IF DVBI-RETURN-CODE EQUAL '03'
 11627        MOVE ER-8091               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11629        GO TO 3024-EDIT-DL03-CONT.
 11630
 11631     IF DVBI-RETURN-CODE EQUAL '04'
 11632        MOVE ER-8092               TO WS-ERROR
 11633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11634        GO TO 3024-EDIT-DL03-CONT.
 11635
 11636     IF DVBI-RETURN-CODE EQUAL '05'
 11637        MOVE ER-8093               TO WS-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11639        GO TO 3024-EDIT-DL03-CONT.
 11640
 11641     IF DVBI-RETURN-CODE EQUAL '06'
 11642        MOVE ER-8094               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL03-CONT.
 11645
 11646     MOVE ER-8096                  TO WS-ERROR
 11647     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11648     GO TO 3024-EDIT-DL03-CONT.
 11649
 11650 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 213
* EL050.cbl
 11652
 11653     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11654        NEXT SENTENCE
 11655     ELSE
 11656        MOVE ER-8042               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11658
 11659     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11660     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11661     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11662
 11663     IF DMPF-RETURN-CODE = '01'
 11664        MOVE ER-8067               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666        GO TO 3024-EDIT-DL01-CONT.
 11667
 11668     IF DMPF-RETURN-CODE = '02'
 11669        MOVE ER-8068               TO WS-ERROR
 11670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11671        GO TO 3024-EDIT-DL01-CONT.
 11672
 11673     IF DMPF-RETURN-CODE = '03'
 11674        MOVE ER-8069               TO WS-ERROR
 11675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11676        GO TO 3024-EDIT-DL01-CONT.
 11677
 11678     IF DMPF-RETURN-CODE = 'E1'
 11679        MOVE ER-8070               TO WS-ERROR
 11680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11681        GO TO 3024-EDIT-DL01-CONT.
 11682
 11683     IF DMPF-RETURN-CODE = 'N1'
 11684        MOVE ER-8071               TO WS-ERROR
 11685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11686        GO TO 3024-EDIT-DL01-CONT.
 11687
 11688     IF DMPF-RETURN-CODE NOT = 'OK'
 11689        MOVE ER-8072               TO WS-ERROR
 11690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11691
 11692 3024-EDIT-DL01-CONT.
 11693******************************************************************
 11694***  VALIDATES RATE CODES : DLO017                             ***
 11695******************************************************************
 11696
 11697      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11698      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11699      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11700      IF DVRC-SUCCESSFUL-EDIT
 11701        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11702        GO TO 3024-CHECK-VALID-RATE.
 11703
 11704      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11705
 11706      IF DVRC-RETURN-CODE EQUAL '01'
 11707         MOVE ER-7817                   TO WS-ERROR
 11708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 214
* EL050.cbl
 11710
 11711      IF DVRC-RETURN-CODE EQUAL '02'
 11712         MOVE ER-7818                   TO WS-ERROR
 11713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11714         GO TO 3025-EDIT-REINSURANCE.
 11715
 11716      IF DVRC-RETURN-CODE EQUAL '03'
 11717         MOVE ER-7819                   TO WS-ERROR
 11718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11719         GO TO 3025-EDIT-REINSURANCE.
 11720
 11721       MOVE ER-7820                     TO WS-ERROR.
 11722       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11723       GO TO 3025-EDIT-REINSURANCE.
 11724
 11725******************************************************************
 11726***  GET PREMIUM RATES : DLO011                                ***
 11727******************************************************************
 11728
 11729 3024-CHECK-VALID-RATE.
 11730
 11731     IF VALID-RATE-CODE
 11732        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11733        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11734        MOVE SPACES                TO DPRB-RETURN-CODE
 11735        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11736     ELSE
 11737         GO TO 3025-EDIT-REINSURANCE.
 11738
 11739      IF DPRB-SUCCESSFUL-PROCESS
 11740         IF PB-VALID-LIFE
 11741             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11742             GO TO 3025-EDIT-REINSURANCE
 11743         ELSE
 11744             IF PB-VALID-AH
 11745                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11746                 GO TO 3025-EDIT-REINSURANCE.
 11747
 11748      IF DPRB-RETURN-CODE EQUAL '01'
 11749         MOVE ER-7812                   TO WS-ERROR
 11750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11751         GO TO 3025-EDIT-REINSURANCE.
 11752
 11753      IF DPRB-RETURN-CODE EQUAL '02'
 11754         MOVE ER-7813                   TO WS-ERROR
 11755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11756         GO TO 3025-EDIT-REINSURANCE.
 11757
 11758      IF DPRB-RETURN-CODE EQUAL '03'
 11759         MOVE ER-7814                   TO WS-ERROR
 11760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11761         GO TO 3025-EDIT-REINSURANCE.
 11762
 11763      IF DPRB-RETURN-CODE EQUAL '04'
 11764         IF NOT DPRB-1ST-TIME
 11765            MOVE ER-7815                   TO WS-ERROR
 11766            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 215
* EL050.cbl
 11768          ELSE
 11769         IF PB-VALID-LIFE
 11770            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11771          ELSE
 11772            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11773         END-IF
 11774         MOVE SPACES                TO DOCC-RETURN-CODE
 11775         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11776         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11777         IF DOCC-RETURN-CODE = 'OK'
 11778             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11779             GO TO 3024-CHECK-VALID-RATE
 11780           ELSE
 11781             MOVE ER-7823               TO WS-ERROR
 11782             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11783             GO TO 3025-EDIT-REINSURANCE.
 11784
 11785       MOVE ER-7816                     TO WS-ERROR.
 11786       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11787       GO TO 3025-EDIT-REINSURANCE.
 11788
 11789**********   DMD CUSTOM CODE ABOVE    **********
 11790
 11791 3025-EDIT-REINSURANCE.
 11792     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11793         GO TO 3027-EDIT-CONTINUE.
 11794
 11795     MOVE LOW-VALUES               TO ERREIN-KEY.
 11796     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11797     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11798                                      REIN-CODE-2
 11799                                      REIN-CODE-3.
 11800     MOVE 'A'                      TO REIN-TYPE.
 11801
 11802     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11803
 11804     MOVE '3026' TO REIN-SW.
 11805     MOVE ' '                   TO WS-REIN-READ-SW.
 11806
 11807     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11808     IF REIN-TABLE-NOT-FOUND
 11809         GO TO 3026-NO-SPEC-TABLE.
 11810
 11811     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11812     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11813                                   WS-NSP-ST-CD-LF.
 11814     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11815                                   WS-NSP-ST-CD-AH.
 11816
 11817     GO TO 3040-EDIT-CONTINUE.
 11818
 11819 3026-NO-SPEC-TABLE.
 11820
 11821     MOVE ER-2664                TO WS-ERROR.
 11822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11823     GO TO 3040-EDIT-CONTINUE.
 11824
 11825 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 216
* EL050.cbl
 11826
 11827     IF PB-I-REIN-TABLE = SPACES
 11828       GO TO 3040-EDIT-CONTINUE.
 11829
 11830     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11831          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11832          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11833           GO TO 3040-EDIT-CONTINUE.
 11834
 11835     MOVE LOW-VALUES            TO ERREIN-KEY.
 11836     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11837     MOVE 'A'                   TO REIN-TYPE.
 11838     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11839
 11840     MOVE '3028'                TO REIN-SW.
 11841     MOVE ' '                   TO WS-REIN-READ-SW.
 11842
 11843     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11844     IF REIN-TABLE-NOT-FOUND
 11845         GO TO 3028-NO-REIN-TABLE.
 11846
 11847     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11848     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11849                                   WS-NSP-ST-CD-LF.
 11850     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11851                                   WS-NSP-ST-CD-AH.
 11852
 11853     GO TO 3040-EDIT-CONTINUE.
 11854
 11855 3028-NO-REIN-TABLE.
 11856
 11857     MOVE ER-2615                TO WS-ERROR.
 11858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11859     GO TO 3040-EDIT-CONTINUE.
 11860
 11861 3040-EDIT-CONTINUE.
 11862
 11863     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11864         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11865
 11866     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11867         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11868
 11869     IF (NOT PB-REISSUED-CERT)
 11870        AND (NOT PB-MONTHLY-CERT)
 11871        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11872            MOVE '001'           TO PB-I-LF-TERM
 11873            MOVE 'M'             TO PB-I-INSURED-SEX.
 11874
 11875     IF (NOT PB-REISSUED-CERT)
 11876        AND (NOT PB-MONTHLY-CERT)
 11877        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11878            MOVE '001'           TO PB-I-AH-TERM
 11879            MOVE 'M'             TO PB-I-INSURED-SEX.
 11880
 11881 3040-EDIT-1ST-PMT-DT.
 11882     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11883     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 217
* EL050.cbl
 11884         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11885
 11886******************************************************************
 11887*                                                                *
 11888*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11889*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11890*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11891*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11892*                                                                *
 11893******************************************************************
 11894
 11895     IF PB-EFF-DT-PROCESSING
 11896        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11897                                    PB-I-LF-EXPIRE-DT
 11898                                    PB-I-AH-EXPIRE-DT
 11899        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11900        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11901        MOVE ZERO                TO DC-ELAPSED-DAYS
 11902        MOVE +1                  TO DC-ELAPSED-MONTHS
 11903        SET BIN-PLUS-ELAPSED     TO TRUE
 11904*       MOVE 6                   TO DC-OPTION-CODE
 11905        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11906        IF NO-CONVERSION-ERROR
 11907           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11908
 11909******************************************************************
 11910*                                                                *
 11911*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11912*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11913*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11914*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11915*                                                                *
 11916******************************************************************
 11917
 11918     IF PB-EXT-DAYS-PROCESSING
 11919          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11920                                         PB-I-LF-EXPIRE-DT
 11921                                         PB-I-AH-EXPIRE-DT
 11922          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11923          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11924          MOVE +1                     TO DC-ELAPSED-MONTHS
 11925          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11926          SET BIN-PLUS-ELAPSED        TO TRUE
 11927*         MOVE 6                      TO DC-OPTION-CODE
 11928          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11929          IF NO-CONVERSION-ERROR
 11930             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11931
 11932******************************************************************
 11933*                                                                *
 11934*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11935*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11936*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11937*        (EXPIRE DATE - (TERM -1))  *  -1.
 11938*                                                                *
 11939******************************************************************
 11940
 11941     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 218
* EL050.cbl
 11942        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11943           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11944              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11945              MOVE PB-I-AH-TERM      TO WS-TERM
 11946           ELSE
 11947              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11948              MOVE PB-I-LF-TERM      TO WS-TERM
 11949        ELSE
 11950           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11951              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11952              MOVE PB-I-LF-TERM      TO WS-TERM
 11953           ELSE
 11954              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11955              MOVE PB-I-AH-TERM      TO WS-TERM.
 11956
 11957     IF PB-EXPIRE-DT-PROCESSING
 11958        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11959        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11960        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11961        MOVE ZERO                TO DC-ELAPSED-DAYS
 11962                                    DC-ODD-DAYS-OVER
 11963          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11964          SET BIN-PLUS-ELAPSED    TO TRUE
 11965*         MOVE 6                  TO DC-OPTION-CODE
 11966          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11967          IF NO-CONVERSION-ERROR
 11968             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11969
 11970******************************************************************
 11971*                                                                *
 11972*            1ST PAYMENT DATE PROCESSING                         *
 11973*                                                                *
 11974******************************************************************
 11975
 11976     IF PB-1ST-PMT-DT-PROCESSING
 11977        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11978                                    PB-I-AH-EXPIRE-DT
 11979        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11980
 11981     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11982         NEXT SENTENCE
 11983     ELSE
 11984         MOVE ER-2680                 TO WS-ERROR
 11985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986         GO TO 3060-ORIG-TERM-CHECK.
 11987
 11988     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11989     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11990     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11991*    MOVE 1                      TO DC-OPTION-CODE.
 11992     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11993                                    DC-ELAPSED-DAYS
 11994                                    DC-ODD-DAYS-OVER.
 11995
 11996     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11997
 11998     IF DATE-CONVERSION-ERROR
 11999        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 219
* EL050.cbl
 12000
 12001     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12002     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12003        AND (WS-LF-COVERAGE-TYPE = 'L')
 12004        IF (DC-ELAPSED-MONTHS > 1)
 12005                      OR
 12006           ((DC-ELAPSED-MONTHS = 1)
 12007           AND (DC-ODD-DAYS-OVER > 0))
 12008           MOVE ER-2882          TO WS-ERROR
 12009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12010        END-IF
 12011     END-IF
 12012     if dc-elapsed-months > 0
 12013        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12014        + dc-odd-days-over
 12015     end-if
 12016     IF PB-EXT-DAYS-PROCESSING
 12017        CONTINUE
 12018     ELSE
 12019        IF DC-ELAPSED-MONTHS = +0
 12020           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12021        ELSE
 12022           IF (WS-LF-EARNINGS-CALC = '4')
 12023              AND (DC-ELAPSED-MONTHS > ZERO)
 12024              AND (DC-ELAPSED-DAYS > ZERO)
 12025              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12026           ELSE
 12027              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12028                                 THRU 6499-EXIT
 12029              MOVE WS-ODD-DAYS-OVER
 12030                                 TO PB-I-EXTENTION-DAYS
 12031           END-IF
 12032        END-IF
 12033     END-IF
 12034******************************************************************
 12035*                                                                *
 12036*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12037*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12038*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12039*            AND ANY ODD DAYS.                                   *
 12040*                                                                *
 12041******************************************************************
 12042
 12043     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12044                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12045     IF WS-LF-EARNINGS-CALC NOT = '4'
 12046        IF DC-ELAPSED-DAYS > ZEROS
 12047           MOVE ER-2681          TO WS-ERROR
 12048           PERFORM 9900-ERROR-FORMAT
 12049                                 THRU 9900-EXIT
 12050        END-IF
 12051     END-IF
 12052
 12053     IF WS-LF-EARNINGS-CALC NOT = '4'
 12054        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12055           MOVE ER-2681          TO WS-ERROR
 12056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12057
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 220
* EL050.cbl
 12058     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12059        (PB-I-LF-TERM NOT = ZERO) AND
 12060         NOT NO-LIFE-COVERAGE
 12061          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12062          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12063          IF WS-LF-EARNINGS-CALC = '4'
 12064             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12065             PB-I-PAY-FREQUENCY
 12066          END-IF
 12067          MOVE ZERO              TO DC-ELAPSED-DAYS
 12068                                    DC-ODD-DAYS-OVER
 12069          MOVE 1                 TO DC-END-OF-MONTH
 12070          SET BIN-PLUS-ELAPSED        TO TRUE
 12071*         MOVE 6                 TO DC-OPTION-CODE
 12072          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12073          IF NO-CONVERSION-ERROR
 12074             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12075             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12076                (WS-LF-SPECIAL-CALC-CD = 'L')
 12077                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12078                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12079                  MOVE +1             TO DC-ELAPSED-MONTHS
 12080                  SET BIN-PLUS-ELAPSED  TO TRUE
 12081*                 MOVE 6              TO DC-OPTION-CODE
 12082                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12083                  IF NO-CONVERSION-ERROR
 12084                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12085
 12086* okay, i had to move the new att age edit down here because the
 12087* expiration date could get recalculated and i need the exp date
 12088     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12089        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12090        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12091        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12092           AND ZEROS
 12093           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12094           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12095           SET ELAPSED-BETWEEN-BIN TO TRUE
 12096           PERFORM 8500-DATE-CONVERT
 12097                                 THRU 8500-EXIT
 12098           IF NO-CONVERSION-ERROR
 12099              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12100                 MOVE ER-2669       TO WS-ERROR
 12101*                PERFORM 9900-ERROR-FORMAT
 12102*                                THRU 9900-EXIT
 12103              END-IF
 12104           END-IF
 12105        ELSE
 12106           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12107           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12108              MOVE ER-2669       TO WS-ERROR
 12109*             PERFORM 9900-ERROR-FORMAT
 12110*                                THRU 9900-EXIT
 12111           ELSE
 12112              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12113                 MOVE ER-1570    TO WS-ERROR
 12114                 PERFORM 9900-ERROR-FORMAT
 12115                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 221
* EL050.cbl
 12116              END-IF
 12117           END-IF
 12118        END-IF
 12119        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12120           AND ZEROS
 12121           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12122           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12123           SET ELAPSED-BETWEEN-BIN TO TRUE
 12124           PERFORM 8500-DATE-CONVERT
 12125                                 THRU 8500-EXIT
 12126           IF NO-CONVERSION-ERROR
 12127              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12128                 MOVE ER-2669       TO WS-ERROR
 12129*                PERFORM 9900-ERROR-FORMAT
 12130*                                THRU 9900-EXIT
 12131              END-IF
 12132           END-IF
 12133        ELSE
 12134           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12135             (PB-I-LF-TERM / 12)
 12136           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12137              MOVE ER-2669       TO WS-ERROR
 12138*             PERFORM 9900-ERROR-FORMAT
 12139*                                THRU 9900-EXIT
 12140           ELSE
 12141              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12142                 MOVE ER-1571    TO WS-ERROR
 12143                 PERFORM 9900-ERROR-FORMAT
 12144                                 THRU 9900-EXIT
 12145              END-IF
 12146           END-IF
 12147        END-IF
 12148        IF WS-ERROR = ER-2669
 12149           PERFORM 9900-ERROR-FORMAT
 12150                                 THRU 9900-EXIT
 12151        END-IF
 12152     END-IF
 12153     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12154        (PB-I-AH-TERM NOT = ZERO) AND
 12155         NOT NO-AH-COVERAGE
 12156          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12157             AND (PB-COMPANY-ID = 'DCC')
 12158             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12159             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12160          ELSE
 12161             IF WS-LF-EARNINGS-CALC = '4'
 12162                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12163                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12164                PB-I-PAY-FREQUENCY
 12165             ELSE
 12166                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12167                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12168             END-IF
 12169          END-IF
 12170          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12171                                         DC-ODD-DAYS-OVER
 12172          MOVE 1                      TO DC-END-OF-MONTH
 12173          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 222
* EL050.cbl
 12174*         MOVE 6                      TO DC-OPTION-CODE
 12175          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12176          IF NO-CONVERSION-ERROR
 12177             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12178     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12179        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12180        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12181        IF PB-I-BIRTHDAY > LOW-VALUES
 12182           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12183           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12184           SET ELAPSED-BETWEEN-BIN TO TRUE
 12185           PERFORM 8500-DATE-CONVERT
 12186                                 THRU 8500-EXIT
 12187           IF NO-CONVERSION-ERROR
 12188              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12189                 MOVE ER-3054       TO WS-ERROR
 12190*                PERFORM 9900-ERROR-FORMAT
 12191*                                THRU 9900-EXIT
 12192              END-IF
 12193           END-IF
 12194        ELSE
 12195           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12196           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12197              MOVE ER-3054       TO WS-ERROR
 12198*             PERFORM 9900-ERROR-FORMAT
 12199*                                THRU 9900-EXIT
 12200           END-IF
 12201        END-IF
 12202        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12203           AND ZEROS
 12204           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12205           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12206           SET ELAPSED-BETWEEN-BIN TO TRUE
 12207           PERFORM 8500-DATE-CONVERT
 12208                                 THRU 8500-EXIT
 12209           IF NO-CONVERSION-ERROR
 12210              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12211                 MOVE ER-3054       TO WS-ERROR
 12212*                PERFORM 9900-ERROR-FORMAT
 12213*                                THRU 9900-EXIT
 12214              END-IF
 12215           END-IF
 12216        ELSE
 12217           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12218             (PB-I-AH-TERM / 12)
 12219           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12220              MOVE ER-3054       TO WS-ERROR
 12221*             PERFORM 9900-ERROR-FORMAT
 12222*                                THRU 9900-EXIT
 12223           END-IF
 12224        END-IF
 12225        IF WS-ERROR = ER-3054
 12226           PERFORM 9900-ERROR-FORMAT
 12227                                 THRU 9900-EXIT
 12228        END-IF
 12229     END-IF
 12230     MOVE SPACE                       TO DC-END-OF-MONTH.
 12231
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 223
* EL050.cbl
 12232     IF PB-COMPANY-ID = 'NCB'
 12233        GO TO 3040-EDIT-EXTENSION-DAYS.
 12234
 12235     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12236       AND
 12237        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12238        NEXT SENTENCE
 12239     ELSE
 12240        GO TO 3040-EDIT-EXTENSION-DAYS.
 12241
 12242     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12243        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12244        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12245     ELSE
 12246        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12247        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12248
 12249     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12250*    MOVE '1'      TO DC-OPTION-CODE
 12251     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12252     IF (NO-CONVERSION-ERROR)
 12253        AND (DC-ELAPSED-MONTHS > +1)
 12254        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12255        MOVE ER-2668   TO WS-ERROR
 12256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12257
 12258 3040-EDIT-EXTENSION-DAYS.
 12259
 12260     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12261        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12262         GO TO 3050-EDIT-TERM-IN-DAYS
 12263     ELSE
 12264         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12265
 12266     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12267         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12268     ELSE
 12269        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12270           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12271           MOVE ER-2681         TO WS-ERROR
 12272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12273
 12274     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12275        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12276        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12277         GO TO 3060-ORIG-TERM-CHECK.
 12278
 12279     GO TO 3060-ORIG-TERM-CHECK.
 12280
 12281 3050-EDIT-TERM-IN-DAYS.
 12282
 12283     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12284
 12285     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12286         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12287     ELSE
 12288         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12289            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 224
* EL050.cbl
 12290            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291
 12292     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12293                                       REMAINDER WS-WORK-TERM.
 12294     IF WS-WORK-TERM GREATER THAN ZERO
 12295         ADD +1 TO PB-I-LF-TERM.
 12296
 12297     IF NOT NO-AH-COVERAGE
 12298         MOVE ER-2684            TO WS-ERROR
 12299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12300
 12301
 12302 3060-ORIG-TERM-CHECK.
 12303
 12304******************************************************************
 12305*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12306******************************************************************
 12307
 12308     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12309        NEXT SENTENCE
 12310     ELSE
 12311        IF NOT NO-LIFE-COVERAGE
 12312           IF PB-I-LF-TERM NUMERIC
 12313              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12314              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12315              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12316                  NEXT SENTENCE
 12317           ELSE
 12318              MOVE ER-2647       TO WS-ERROR
 12319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12320
 12321     IF NOT NO-AH-COVERAGE
 12322         IF PB-I-AH-TERM NUMERIC
 12323            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12324            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12325            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12326             NEXT SENTENCE
 12327          ELSE
 12328              MOVE ER-2658       TO WS-ERROR
 12329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12330
 12331     IF PB-COMPANY-ID = 'NCB'
 12332        GO TO 3070-LOAN-TERM-CHECK.
 12333
 12334     IF POLICY-HAS-AH
 12335       AND
 12336        POLICY-HAS-LIFE
 12337       AND
 12338        PB-I-LF-TERM NUMERIC
 12339       AND
 12340        PB-I-AH-TERM NUMERIC
 12341        NEXT SENTENCE
 12342     ELSE
 12343        GO TO 3070-LOAN-TERM-CHECK.
 12344
 12345     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12346     IF WS-TEX-FACT-2 LESS THAN +0
 12347        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 225
* EL050.cbl
 12348
 12349     IF WS-TEX-FACT-2 GREATER THAN +1
 12350        MOVE ER-2668             TO WS-ERROR
 12351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12352
 12353 3070-LOAN-TERM-CHECK.
 12354
 12355     IF (WS-LF-BENEFIT-CD = ZERO)
 12356         OR (NO-LF-BENEFIT-MATCH)
 12357            GO TO 3125-EDIT-PMT-FREQ.
 12358*    IF PB-COMPANY-ID NOT = 'DCC'
 12359*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12360*          AND 'V' AND 'W' AND 'X'
 12361*          GO TO 3125-EDIT-PMT-FREQ
 12362*       END-IF
 12363*    ELSE
 12364*       IF WS-AH-DCC-TRUNC = 'T'
 12365*          CONTINUE
 12366*       ELSE
 12367*          GO TO 3125-EDIT-PMT-FREQ
 12368*       END-IF
 12369*    END-IF
 12370     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12371                    OR
 12372        ((PB-COMPANY-ID = 'DCC')
 12373        AND (WS-AH-DCC-TRUNC = 'T'))
 12374        CONTINUE
 12375     ELSE
 12376        GO TO 3125-EDIT-PMT-FREQ
 12377     END-IF
 12378     IF PB-I-LOAN-TERM NOT NUMERIC
 12379         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12380
 12381     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12382        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12383*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12384        PB-I-LOAN-TERM NOT GREATER THAN +360
 12385         NEXT SENTENCE
 12386     ELSE
 12387         MOVE ER-2648            TO WS-ERROR
 12388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12389
 12390     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12391        MOVE ER-3058             TO WS-ERROR
 12392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12393     end-if
 12394
 12395     IF WS-STATE-ABBREVIATION = 'NC'
 12396        IF PB-I-LOAN-TERM > +59
 12397           CONTINUE
 12398        ELSE
 12399           MOVE ER-2792          TO WS-ERROR
 12400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12401        END-IF
 12402     END-IF
 12403
 12404     .
 12405 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 226
* EL050.cbl
 12406     IF (WS-LF-BENEFIT-CD = ZERO)
 12407         OR (NO-LF-BENEFIT-MATCH)
 12408            GO TO 3127-EDIT-LOAN-OFFICER.
 12409     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12410                    OR
 12411        ((PB-COMPANY-ID = 'DCC')
 12412        AND (WS-AH-DCC-TRUNC = 'T'))
 12413                    OR
 12414         (PB-COMPANY-ID = 'AHL')
 12415        CONTINUE
 12416     ELSE
 12417        IF (PB-I-LOAN-TERM > ZEROS)
 12418           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12419           MOVE ER-1575          TO WS-ERROR
 12420           PERFORM 9900-ERROR-FORMAT
 12421                                 THRU 9900-EXIT
 12422        END-IF
 12423     END-IF
 12424     IF WS-LF-EARNINGS-CALC NOT = '4'
 12425         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12426            MOVE ER-2653         TO WS-ERROR
 12427            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12428            GO TO 3127-EDIT-LOAN-OFFICER
 12429         ELSE
 12430            GO TO 3127-EDIT-LOAN-OFFICER.
 12431
 12432     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12433         MOVE ER-2655            TO WS-ERROR
 12434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12435         GO TO 3127-EDIT-LOAN-OFFICER.
 12436
 12437     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12438         MOVE ER-2654            TO WS-ERROR
 12439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12440         GO TO 3127-EDIT-LOAN-OFFICER.
 12441
 12442     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12443         GIVING WS-TEX-FACT-2
 12444             REMAINDER WS-TEX-FACT-3.
 12445
 12446*    IF WS-TEX-FACT-3 NOT = ZERO
 12447*       MOVE ER-2654             TO WS-ERROR
 12448*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449
 12450
 12451 3127-EDIT-LOAN-OFFICER.
 12452
 12453     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12454        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12455           MOVE ER-2690          TO WS-ERROR
 12456           PERFORM 9900-ERROR-FORMAT
 12457                                 THRU 9900-EXIT
 12458        ELSE
 12459           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12460           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12461           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12462           MOVE PB-SV-STATE      TO LOFC-STATE
 12463           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 227
* EL050.cbl
 12464           MOVE PB-I-LOAN-OFFICER
 12465                                 TO LOFC-CODE
 12466           PERFORM 8586-READ-LOAN-OFFICER
 12467                                 THRU 8586-EXIT
 12468           IF (NOT LOFC-MASTER-FOUND)
 12469              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12470              MOVE ER-3006       TO WS-ERROR
 12471              PERFORM 9900-ERROR-FORMAT
 12472                                 THRU 9900-EXIT
 12473           END-IF
 12474        END-IF
 12475     END-IF
 12476     .
 12477 3129-EDIT-APR.
 12478
 12479     IF (WS-LF-BENEFIT-CD = ZERO)
 12480        OR (NO-LF-BENEFIT-MATCH)
 12481        IF PB-COMPANY-ID NOT = 'DCC'
 12482           GO TO 3130-EDIT-AGE
 12483*       ELSE
 12484*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12485*             GO TO 3130-EDIT-AGE
 12486*          END-IF
 12487        END-IF
 12488     END-IF
 12489
 12490     IF (WS-STATE-ABBREVIATION = 'OH')
 12491         AND (PB-I-RATE-CLASS NOT = 'L ')
 12492         AND (PB-I-LF-TERM GREATER THAN 60)
 12493         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12494         GO TO 3129-APR-CONT.
 12495
 12496     IF (WS-STATE-ABBREVIATION = 'RI')
 12497         AND (PB-I-LF-TERM GREATER THAN 60)
 12498         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12499         GO TO 3129-APR-CONT.
 12500
 12501     IF (WS-STATE-ABBREVIATION = 'UT')
 12502         AND (PB-I-LF-TERM GREATER THAN 62)
 12503         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12504         AND (PB-CERT-EFF-DT LESS WS-830901)
 12505         GO TO 3129-APR-CONT.
 12506
 12507     IF PB-COMPANY-ID = 'LAP'
 12508        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12509           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12510              MOVE ER-2656         TO WS-ERROR
 12511              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12512              GO TO 3130-EDIT-AGE.
 12513
 12514     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12515        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12516        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12517        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12518        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12519        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12520         GO TO 3130-EDIT-AGE.
 12521
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 228
* EL050.cbl
 12522 3129-APR-CONT.
 12523     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12524         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12525         GO TO 3130-EDIT-AGE.
 12526
 12527     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12528         WS-AH-BENEFIT-CD (1:1) = 'S')
 12529        AND (PB-COMPANY-ID = 'DCC')
 12530        AND (PB-I-LOAN-APR = ZERO)
 12531        MOVE ER-2657             TO WS-ERROR
 12532        PERFORM 9900-ERROR-FORMAT
 12533                                 THRU 9900-EXIT
 12534        GO TO 3130-EDIT-AGE
 12535     END-IF
 12536*    IF PB-I-LOAN-APR = ZERO
 12537*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12538*    END-IF
 12539
 12540     if pb-i-loan-apr = +99.9999
 12541        move er-2656             to ws-error
 12542        PERFORM 9900-ERROR-FORMAT
 12543                                 THRU 9900-EXIT
 12544        GO TO 3130-EDIT-AGE
 12545     end-if
 12546*    IF PB-I-LOAN-APR = ZERO
 12547*       MOVE ER-2656             TO WS-ERROR
 12548*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12549*       GO TO 3130-EDIT-AGE.
 12550
 12551*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12552     if pb-i-loan-apr not = +99.9999
 12553        IF PB-I-LOAN-APR > +30.000
 12554           MOVE ER-2657          TO WS-ERROR
 12555           PERFORM 9900-ERROR-FORMAT
 12556                                 THRU 9900-EXIT
 12557        end-if
 12558     end-if
 12559     .
 12560 3130-EDIT-AGE.
 12561
 12562******************************************************************
 12563*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12564******************************************************************
 12565
 12566     IF NOT NO-LIFE-COVERAGE
 12567        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12568           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12569               MOVE ER-2628             TO WS-ERROR
 12570               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12571
 12572     IF NOT NO-AH-COVERAGE
 12573        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12574           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12575               MOVE ER-2628         TO WS-ERROR
 12576               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12577
 12578 3133-SEX-CODE.
 12579     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 229
* EL050.cbl
 12580         IF WS-DEFAULT-SEX = 'M'
 12581             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12582          ELSE
 12583             IF WS-DEFAULT-SEX = 'F'
 12584             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12585
 12586     IF PB-I-INSURED-SEX = '1'
 12587         MOVE 'M' TO PB-I-INSURED-SEX.
 12588
 12589     IF PB-I-INSURED-SEX = '2'
 12590         MOVE 'F' TO PB-I-INSURED-SEX.
 12591
 12592 3134-SIG-SW-EDIT.
 12593     IF PB-I-SIG-SW = SPACE
 12594         MOVE 'N'                TO  PB-I-SIG-SW.
 12595
 12596     IF PB-COMPANY-ID = 'NCL'
 12597         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12598             NEXT SENTENCE
 12599         ELSE
 12600             MOVE ER-1923        TO  WS-ERROR
 12601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12602     ELSE
 12603     IF PB-COMPANY-ID = 'CRI'
 12604         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12605             NEXT SENTENCE
 12606         ELSE
 12607             MOVE ER-2606        TO  WS-ERROR
 12608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12609     ELSE
 12610     IF PB-COMPANY-ID = 'TMS'
 12611         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12612             NEXT SENTENCE
 12613         ELSE
 12614             MOVE ER-2689        TO  WS-ERROR
 12615             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12616     ELSE
 12617         IF PB-I-SIG-SW = 'Y' OR 'N'
 12618             NEXT SENTENCE
 12619         ELSE
 12620             MOVE ER-2651        TO  WS-ERROR
 12621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12622
 12623     IF PB-COMPANY-ID = 'FLA'
 12624         IF (WS-EDIT-AGE GREATER 54  OR
 12625             WS-AH-EDIT-AGE GREATER 54)  AND
 12626            PB-I-SIG-SW = 'N'
 12627            MOVE ER-2651         TO  WS-ERROR
 12628            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12629
 12630 3135-NAME-EDIT.
 12631
 12632     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12633        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12634        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12635           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12636                                 TO PB-I-JOINT-FIRST-NAME
 12637        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 230
* EL050.cbl
 12638     END-IF
 12639     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12640        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12641        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12642           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12643                                 TO PB-I-JOINT-LAST-NAME
 12644        END-PERFORM
 12645     END-IF
 12646     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12647        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12648        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12649           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12650                                 TO PB-I-INSURED-FIRST-NAME
 12651        END-PERFORM
 12652     END-IF
 12653     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12654        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12655        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12656           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12657                                 TO PB-I-INSURED-LAST-NAME
 12658        END-PERFORM
 12659     END-IF
 12660     IF PB-I-INSURED-LAST-NAME = SPACES
 12661       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12662       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12663           MOVE ER-2660    TO WS-ERROR
 12664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12665
 12666 3136-EDIT-SEX.
 12667
 12668******************************************************************
 12669*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12670******************************************************************
 12671
 12672     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12673        (WS-AH-SPECIAL-CALC-CD = 'O')
 12674        NEXT SENTENCE
 12675     ELSE
 12676        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12677           NEXT SENTENCE
 12678        ELSE
 12679           MOVE ER-2629            TO WS-ERROR
 12680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12681
 12682 3137-EDIT-EFF-DATE.
 12683
 12684     IF PB-REISSUED-CERT       OR
 12685        PB-POLICY-IS-DECLINED  OR
 12686        PB-POLICY-IS-VOIDED
 12687         GO TO 3139-EDIT-COVERAGE-CODES.
 12688
 12689     MOVE SPACE                  TO WS-2671-SW
 12690                                    WS-2672-SW.
 12691
 12692     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12693         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12694             MOVE ER-2703        TO WS-ERROR
 12695             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 231
* EL050.cbl
 12696             GO TO 3139-EDIT-COVERAGE-CODES.
 12697
 12698     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12699         GO TO 3139-EDIT-COVERAGE-CODES.
 12700
 12701     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12702     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12703*    MOVE '1'                    TO DC-OPTION-CODE.
 12704     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12705     MOVE +0                     TO DC-ELAPSED-MONTHS
 12706                                    DC-ELAPSED-DAYS.
 12707     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12708
 12709     IF DATE-CONVERSION-ERROR
 12710         GO TO 3139-EDIT-COVERAGE-CODES.
 12711
 12712     IF DC-ELAPSED-DAYS GREATER +180
 12713         MOVE ER-2672            TO WS-ERROR
 12714         MOVE 'Y'                TO WS-2672-SW
 12715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12716     END-IF
 12717
 12718     IF WS-ERROR = ER-2671  AND
 12719        PB-COMPANY-ID  = 'LBL'
 12720        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12721        MOVE SPACE               TO WS-2671-SW
 12722        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12723
 12724     IF PB-ISSUE-DATE-FORCED  AND
 12725      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12726         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12727         MOVE ER-2673            TO WS-ERROR
 12728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12729         MOVE SPACE              TO WS-2671-SW
 12730                                    WS-2672-SW.
 12731
 12732     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12733         IF PB-ISSUE-DATE-FORCED
 12734             MOVE ER-2600          TO  WS-ERROR
 12735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12736         ELSE
 12737             MOVE ER-2692          TO  WS-ERROR
 12738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12739
 12740
 12741 3139-EDIT-COVERAGE-CODES.
 12742
 12743     if pb-company-id not = 'AHL'
 12744        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12745           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12746           MOVE ER-2787          TO WS-ERROR
 12747           PERFORM 9900-ERROR-FORMAT
 12748                                 THRU 9900-EXIT
 12749        END-IF
 12750     end-if
 12751     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12752        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12753                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 232
* EL050.cbl
 12754           MOVE ER-2719          TO WS-ERROR
 12755           PERFORM 9900-ERROR-FORMAT
 12756                                 THRU 9900-EXIT
 12757        END-IF
 12758     END-IF
 12759
 12760     IF PB-POLICY-IS-DECLINED  OR
 12761        PB-POLICY-IS-VOIDED
 12762         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12763
 12764     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12765        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12766         MOVE ER-2630                TO WS-ERROR
 12767         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12768
 12769     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12770        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12771        PB-I-LF-PREMIUM-AMT = ZERO
 12772         GO TO 3140-CHECK-AH-FOR-ZERO.
 12773
 12774     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12775        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12776        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12777         GO TO 3140-CHECK-AH-FOR-ZERO.
 12778
 12779     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12780        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12781        MOVE ER-2631             TO WS-ERROR
 12782        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12783     END-IF
 12784
 12785
 12786******************************************************************
 12787*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12788******************************************************************
 12789
 12790     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12791        NEXT SENTENCE
 12792     ELSE
 12793        IF PB-I-LF-BENEFIT-AMT = ZERO
 12794           MOVE ER-2632             TO WS-ERROR
 12795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12796
 12797
 12798******************************************************************
 12799*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12800******************************************************************
 12801
 12802     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12803        CONTINUE
 12804     ELSE
 12805        IF PB-I-LF-PREMIUM-AMT = ZERO
 12806           IF (NOT PB-COMP-LF-PREM)
 12807              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12808              MOVE ER-2633       TO WS-ERROR
 12809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12810           END-IF
 12811        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 233
* EL050.cbl
 12812     END-IF
 12813     .
 12814 3140-CHECK-AH-FOR-ZERO.
 12815
 12816     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12817        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12818        PB-I-AH-PREMIUM-AMT = ZERO
 12819         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12820
 12821     IF PB-COMPANY-ID = 'CSL'  AND
 12822        PB-I-AH-BENEFIT-CD = ZERO  AND
 12823        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12824        PB-I-AH-PREMIUM-AMT = ZERO
 12825         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12826
 12827     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12828        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12829        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12830         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12831
 12832     IF PB-I-AH-BENEFIT-CD = ZERO
 12833         MOVE ER-2634            TO WS-ERROR
 12834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12835
 12836******************************************************************
 12837*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12838******************************************************************
 12839
 12840     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12841        NEXT SENTENCE
 12842     ELSE
 12843        IF PB-I-AH-BENEFIT-AMT = ZERO
 12844           MOVE ER-2635             TO WS-ERROR
 12845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12846
 12847******************************************************************
 12848*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12849******************************************************************
 12850
 12851     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12852        NEXT SENTENCE
 12853     ELSE
 12854        IF PB-I-AH-PREMIUM-AMT = ZERO
 12855            IF NOT PB-COMP-AH-PREM
 12856                MOVE ER-2636    TO WS-ERROR
 12857                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12858
 12859
 12860 3140-EDIT-MAX-AMT-SIZES.
 12861* CUSTOM CODE FOR CLIENT    'DMD'
 12862     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12863                                     WS-RES-MUNI-TAX
 12864                                     PB-I-STATE-TAX
 12865                                     PB-I-MUNI-TAX.
 12866
 12867     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12868
 12869     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 234
* EL050.cbl
 12870        GO TO 3150-RATE-OUTSTAND-BAL.
 12871
 12872     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12873        GO TO 3150-RATE-OUTSTAND-BAL.
 12874
 12875     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12876        GO TO 3150-RATE-OUTSTAND-BAL.
 12877
 12878     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12879                             OR 'RIC')
 12880        GO TO 3150-RATE-OUTSTAND-BAL.
 12881
 12882     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12883        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12884            GO TO 3150-RATE-OUTSTAND-BAL
 12885        ELSE
 12886           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12887               GO TO 3150-RATE-OUTSTAND-BAL.
 12888
 12889     IF NOT PB-NO-MONTHS-SKIPPED
 12890        GO TO 3150-RATE-OUTSTAND-BAL.
 12891
 12892     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12893        GO TO 3150-RATE-OUTSTAND-BAL.
 12894
 12895     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12896        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12897           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12898             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12899           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12900           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12901              MOVE ER-2693     TO WS-ERROR
 12902              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12903              GO TO 3150-RATE-OUTSTAND-BAL
 12904           ELSE
 12905              GO TO 3150-RATE-OUTSTAND-BAL.
 12906
 12907 3150-RATE-OUTSTAND-BAL.
 12908
 12909* DMD RATING TEST
 12910     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12911         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12912         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12913         MOVE ER-2687                 TO WS-ERROR
 12914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12915         MOVE 'B'                     TO PB-I-OB-FLAG
 12916         GO TO 3260-EDIT-CONTINUE.
 12917
 12918     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12919         IF  WS-ERROR    EQUAL    ER-2693
 12920             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12921                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12922                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12923                 MOVE  +0            TO  WS-ERROR.
 12924
 12925     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12926         IF  WS-ERROR    EQUAL    ER-2693
 12927             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 235
* EL050.cbl
 12928                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12929                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12930                 MOVE  +0            TO  WS-ERROR.
 12931
 12932     IF PLAN-MASTER-AH-SW = 'Y'
 12933        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12934            IF  WS-ERROR    EQUAL    ER-2693
 12935              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12936                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12937                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12938                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12939                 MOVE  ER-1910           TO  WS-ERROR
 12940                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12941
 12942     IF PLAN-MASTER-AH-SW = 'Y'
 12943        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12944            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12945               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12946               MOVE  ER-1910           TO  WS-ERROR
 12947               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12948
 12949     IF PLAN-MASTER-AH-SW = 'Y'
 12950        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12951            IF  WS-ERROR    EQUAL    ER-2693
 12952                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12953                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12954                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12955                 MOVE  +0       TO  WS-ERROR.
 12956
 12957     IF WS-ERROR = ER-2693
 12958        IF PB-COMPANY-ID = 'JAL' AND
 12959           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12960           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12961           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12962
 12963     IF WS-ERROR = ER-2693
 12964        IF PB-COMPANY-ID = 'NCL'  AND
 12965           PB-I-AH-BENEFIT-CD = 'OA'
 12966           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12967           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12968
 12969     IF WS-ERROR = ER-2693
 12970        IF PB-COMPANY-ID = 'CNL' AND
 12971           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12972           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12973           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12974
 12975     IF WS-ERROR = ER-2693
 12976        IF PB-COMPANY-ID = 'HER'
 12977           IF WS-LEVEL
 12978              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12979              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12980
 12981     IF ((LF-BENEFIT-FOUND) AND
 12982         (NOT NO-LIFE-COVERAGE)  AND
 12983         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12984       OR   ((AH-BENEFIT-FOUND) AND
 12985             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 236
* EL050.cbl
 12986             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12987         NEXT SENTENCE
 12988     ELSE
 12989         GO TO 3215-EDIT-RATES.
 12990
 12991     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12992        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12993           MOVE ER-2674          TO WS-ERROR
 12994           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12995           GO TO 3215-EDIT-RATES.
 12996
 12997     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12998        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12999           MOVE ER-2674          TO WS-ERROR
 13000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001           GO TO 3215-EDIT-RATES.
 13002
 13003     MOVE 'B'                    TO PB-I-OB-FLAG.
 13004
 13005     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13006         NEXT SENTENCE
 13007     ELSE
 13008         IF NOT NO-LIFE-COVERAGE
 13009             IF WS-ACCT-LF-OB-RT = ZERO
 13010                MOVE ER-2641    TO WS-ERROR
 13011                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13012
 13013     IF PB-COMPANY-ID = 'CRI'
 13014       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13015         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13016         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13017         IF WS-ERROR = ER-2675
 13018            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13019            MOVE ER-2687              TO WS-ERROR
 13020            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13021         ELSE
 13022            MOVE ER-2687              TO WS-ERROR
 13023            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13024
 13025
 13026     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13027         NEXT SENTENCE
 13028     ELSE
 13029       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13030            NEXT SENTENCE
 13031       ELSE
 13032         IF NOT NO-AH-COVERAGE
 13033             IF WS-ACCT-AH-OB-RT = ZERO
 13034                MOVE ER-2642    TO WS-ERROR
 13035                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13036
 13037     IF PB-COMPANY-ID = 'CRI'
 13038       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13039         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13040         IF WS-ERROR = ER-2676
 13041            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13042            MOVE ER-2687              TO WS-ERROR
 13043            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 237
* EL050.cbl
 13044         ELSE
 13045            MOVE ER-2687              TO WS-ERROR
 13046            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13047
 13048     IF PB-COMPANY-ID NOT = 'GIC'
 13049         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13050            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13051     ELSE
 13052         IF PB-I-LF-PREM-CALC = ZEROS
 13053             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13054                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13055
 13056     IF PB-COMPANY-ID NOT = 'GIC'
 13057         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13058            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13059     ELSE
 13060         IF PB-I-AH-PREM-CALC = ZEROS
 13061             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13062                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13063
 13064     MOVE ZEROS TO PB-I-MORT-CODE.
 13065
 13066     GO TO 3260-EDIT-CONTINUE.
 13067
 13068
 13069 3215-EDIT-RATES.
 13070     IF ACCOUNT-MAST-FOUND
 13071         NEXT SENTENCE
 13072     ELSE
 13073         GO TO 3999-END-EDIT.
 13074
 13075 3220-CHECK-LF-RATES.
 13076
 13077     IF PB-COMPANY-ID = 'DCC'
 13078        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13079        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13080        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13081           AND (NOT WS-LF-CASH))
 13082                           OR
 13083           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13084           AND (NOT WS-AH-CASH)))
 13085                       AND
 13086           (PB-I-ENTRY-STATUS NOT = '5')
 13087           MOVE 'M'              TO PB-BATCH-ENTRY
 13088                                    PB-I-ENTRY-STATUS
 13089        END-IF
 13090     END-IF
 13091     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13092                                    PB-I-AH-PREM-CALC
 13093                                    PB-I-LF-ALT-PREM-CALC
 13094                                    PB-I-LF-ALT-RATE
 13095                                    PB-I-LF-REI-RATE
 13096                                    PB-I-LF-ALT-REI-RATE
 13097                                    PB-I-AH-REI-RATE
 13098                                    PB-I-TOT-FEES-CALC.
 13099
 13100     IF PB-COMPANY-ID EQUAL 'DMD'
 13101        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 238
* EL050.cbl
 13102     ELSE
 13103        MOVE ZEROS               TO PB-I-LF-RATE
 13104                                    PB-I-AH-RATE.
 13105
 13106     IF PB-I-TOT-FEES NOT NUMERIC
 13107        MOVE ZEROS               TO PB-I-TOT-FEES
 13108     END-IF
 13109     IF PB-I-LIVES NOT NUMERIC
 13110         MOVE ZERO               TO PB-I-LIVES.
 13111
 13112     IF PB-I-NUM-BILLED NOT NUMERIC
 13113         MOVE ZERO               TO PB-I-NUM-BILLED.
 13114
 13115     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13116        MOVE +0                  TO PB-I-LF-PREM-TAX
 13117     END-IF
 13118
 13119     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13120        MOVE +0                  TO PB-I-AH-PREM-TAX
 13121     END-IF
 13122
 13123     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13124        PB-I-PAY-FREQUENCY = ZEROS
 13125            MOVE 12 TO CP-PAY-FREQUENCY
 13126     ELSE
 13127            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13128
 13129     IF PB-I-STATE-TAX NOT NUMERIC
 13130         MOVE ZEROS               TO PB-I-STATE-TAX.
 13131
 13132     IF PB-I-MUNI-TAX NOT NUMERIC
 13133         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13134
 13135     MOVE SPACES                 TO CP-BEN-CATEGORY
 13136     IF PB-COMPANY-ID  = 'CSL'  AND
 13137        PB-I-LF-TERM NOT = ZERO
 13138        COMPUTE WS-PAYMENT-AMT =
 13139             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13140        COMPUTE WS-CSL-AMT1 =
 13141             PB-I-LF-TERM * AM-MAX-MON-BEN
 13142        COMPUTE WS-CSL-AMT2 =
 13143             WS-PAYMENT-AMT * PB-I-LF-TERM
 13144        IF CP-PAY-FREQUENCY NOT = 12
 13145           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13146           MOVE '8' TO WS-CSL-CALC-CD
 13147        ELSE
 13148           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13149              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13150               AM-MAX-TOT-BEN
 13151               MOVE '6' TO WS-CSL-CALC-CD
 13152           ELSE
 13153              IF (WS-CSL-AMT1  GREATER THAN
 13154                 AM-MAX-TOT-BEN) AND
 13155                 (WS-CSL-AMT2  GREATER THAN
 13156                 AM-MAX-TOT-BEN)
 13157                 MOVE '7' TO WS-CSL-CALC-CD
 13158              ELSE
 13159                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 239
* EL050.cbl
 13160
 13161     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13162         NEXT SENTENCE
 13163     ELSE
 13164         GO TO 3300-CHECK-AH-RATES.
 13165
 13166*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13167
 13168     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13169        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13170              OR
 13171           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13172           MOVE ER-2618          TO WS-ERROR
 13173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174           GO TO 3300-CHECK-AH-RATES.
 13175
 13176     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13177           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13178                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13179
 13180     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13181         MOVE ER-2687             TO WS-ERROR
 13182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13183         MOVE 'Z000'              TO PB-I-MORT-CODE
 13184         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13185         GO TO 3300-CHECK-AH-RATES.
 13186
 13187     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13188        IF PB-I-LIVES = ZERO
 13189           MOVE ER-2688          TO WS-ERROR
 13190           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13191
 13192     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13193
 13194     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13195     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13196     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13197     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13198     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13199     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13200     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13201     MOVE '3'                    TO CP-PROCESS-TYPE.
 13202     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13203     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13204
 13205******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13206     IF PB-COMPANY-ID EQUAL 'CDL'
 13207         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13208            CP-EARN-AS-NET-PAY)
 13209             IF PB-CERT-EFF-DT GREATER  WS-931231
 13210                 MOVE '1'        TO CP-EARNING-METHOD.
 13211*******
 13212
 13213     MOVE PB-SV-STATE            TO CP-STATE.
 13214     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13215     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13216     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13217     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 240
* EL050.cbl
 13218     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13219                                    CP-RATING-BENEFIT-AMT.
 13220     IF CP-STATE-STD-ABBRV = 'OR'
 13221         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13222                                         PB-I-LF-ALT-BENEFIT-AMT.
 13223     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13224     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13225     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13226     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13227     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13228     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13229     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13230     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13231     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13232                                    CP-REMAINING-TERM
 13233                                    CP-LOAN-TERM.
 13234
 13235     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13236         NEXT SENTENCE
 13237     ELSE
 13238         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13239             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13240                                           PB-I-LF-PREMIUM-AMT.
 13241
 13242     IF PB-COMPANY-ID EQUAL 'CSL'
 13243        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13244           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13245                                         PB-I-LF-PREMIUM-AMT.
 13246
 13247     IF PB-COMPANY-ID EQUAL 'NCB'
 13248         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13249            CP-EARN-AS-NET-PAY
 13250             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13251                 PB-I-LF-PREMIUM-AMT.
 13252
 13253     IF (CP-TRUNCATED-LIFE)
 13254        or ((pb-company-id = 'AHL')
 13255           and (pb-i-loan-term > pb-i-lf-term))
 13256        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13257
 13258     IF PB-COMPANY-ID EQUAL 'CRI'
 13259        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13260
 13261     IF CP-TERM-IS-DAYS
 13262         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13263     ELSE
 13264         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13265     IF PB-COMPANY-ID = 'DCC'
 13266        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13267        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13268        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13269        IF WS-LF-BEN-CATEGORY = 'D'
 13270           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13271           MOVE PB-I-LIFE-COMMISSION
 13272                                 TO CP-DCC-ACT-COMM
 13273           MOVE WS-LF-BEN-CATEGORY
 13274                                 TO CP-BEN-CATEGORY
 13275        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 241
* EL050.cbl
 13276        IF (CP-BENEFIT-CD (1:1) = 'P')
 13277           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13278           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13279           add pb-i-ah-premium-amt to cp-original-premium
 13280        END-IF
 13281     END-IF
 13282     IF PB-COMPANY-ID = 'CSL'
 13283         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13284         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13285         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13286
 13287     IF PB-COMPANY-ID = 'CSL'
 13288        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13289
 13290     IF (CP-SPECIAL-CALC-CD = 'H')
 13291        OR (PB-COMPANY-ID = 'DCC')
 13292         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13293                                    TO CP-ALTERNATE-BENEFIT
 13294         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13295
 13296     IF (PB-COMPANY-ID = 'CID')
 13297        AND (WS-LF-EARNINGS-CALC = 'B')
 13298        AND (CP-STATE-STD-ABBRV = 'MN')
 13299        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13300                                 TO CP-ALTERNATE-BENEFIT
 13301        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13302     END-IF
 13303     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13304     MOVE 'R'                   TO CP-RATE-FILE.
 13305     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13306
 13307     IF CP-ERROR-RATE-NOT-FOUND
 13308        MOVE ER-2641            TO WS-ERROR
 13309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13310        GO TO 3300-CHECK-AH-RATES.
 13311
 13312     IF PB-COMPANY-ID EQUAL 'CRI'
 13313        IF CP-ERROR-NO-LIMITS-CRI
 13314           IF NOT ACCOUNT-LIFE-CHECKED
 13315              MOVE ER-2607      TO WS-ERROR
 13316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13317
 13318******************************************************************
 13319*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13320*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13321******************************************************************
 13322
 13323* CALC LIFE AGE AT EXPIRATION.
 13324
 13325     COMPUTE WS-AGE-AT-EXPIRE =
 13326          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13327
 13328*    IF PB-STATE = 'CO' OR 'UT'
 13329*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13330*        MOVE 'F'            TO PB-FATAL-FLAG
 13331*        MOVE ER-2709        TO WS-ERROR
 13332*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13333*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 242
* EL050.cbl
 13334
 13335*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13336*        MOVE 'X'            TO PB-FATAL-FLAG
 13337*        MOVE ER-2718        TO WS-ERROR
 13338*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13339*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13340
 13341* CALC A & H AGE AT EXPIRATION.
 13342
 13343     COMPUTE WS-AGE-AT-EXPIRE =
 13344          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13345
 13346*    IF PB-STATE = 'CO' OR 'UT'
 13347*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13348*        MOVE 'F'            TO PB-FATAL-FLAG
 13349*        MOVE ER-2709        TO WS-ERROR
 13350*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13351*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13352
 13353*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13354*        MOVE 'X'            TO PB-FATAL-FLAG
 13355*        MOVE ER-2718        TO WS-ERROR
 13356*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13357*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13358
 13359     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13360        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13361
 13362     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13363        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13364     end-if
 13365
 13366     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13367        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13368
 13369     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13370         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13371         MOVE ER-2639        TO WS-ERROR
 13372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13373
 13374
 13375******************************************************************
 13376*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13377******************************************************************
 13378
 13379 PREMIUM-EDITING-IS-BYPASSED.
 13380     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13381        AND (CP-R-MAX-ATT-AGE > +0)
 13382        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13383        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13384           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13385           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13386           MOVE '1'              TO DC-OPTION-CODE
 13387           PERFORM 8500-DATE-CONVERT
 13388                                 THRU 8500-EXIT
 13389           IF NO-CONVERSION-ERROR
 13390              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13391                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 243
* EL050.cbl
 13392*                PERFORM 9900-ERROR-FORMAT
 13393*                                THRU 9900-EXIT
 13394              END-IF
 13395           END-IF
 13396        ELSE
 13397           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13398           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13399              MOVE ER-2661       TO WS-ERROR
 13400*             PERFORM 9900-ERROR-FORMAT
 13401*                                THRU 9900-EXIT
 13402           ELSE
 13403              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13404                 MOVE ER-1570    TO WS-ERROR
 13405                 PERFORM 9900-ERROR-FORMAT
 13406                                 THRU 9900-EXIT
 13407              END-IF
 13408           END-IF
 13409        END-IF
 13410        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13411           MOVE PB-I-JOINT-BIRTHDAY
 13412                                 TO DC-BIN-DATE-1
 13413           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13414           MOVE '1'              TO DC-OPTION-CODE
 13415           PERFORM 8500-DATE-CONVERT
 13416                                 THRU 8500-EXIT
 13417           IF NO-CONVERSION-ERROR
 13418              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13419                 MOVE ER-2661       TO WS-ERROR
 13420*                PERFORM 9900-ERROR-FORMAT
 13421*                                THRU 9900-EXIT
 13422              END-IF
 13423           ELSE
 13424              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13425           END-IF
 13426        ELSE
 13427           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13428             (PB-I-LF-TERM / 12)
 13429           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13430              MOVE ER-2661       TO WS-ERROR
 13431*             PERFORM 9900-ERROR-FORMAT
 13432*                                THRU 9900-EXIT
 13433           ELSE
 13434              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13435                 MOVE ER-1571    TO WS-ERROR
 13436                 PERFORM 9900-ERROR-FORMAT
 13437                                 THRU 9900-EXIT
 13438              END-IF
 13439           END-IF
 13440        END-IF
 13441        IF WS-ERROR = ER-2661
 13442           PERFORM 9900-ERROR-FORMAT
 13443                                 THRU 9900-EXIT
 13444        END-IF
 13445     END-IF
 13446*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13447*       MOVE ER-2661             TO WS-ERROR
 13448*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 244
* EL050.cbl
 13450     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13451        MOVE ER-2662             TO WS-ERROR
 13452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13453
 13454     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13455        MOVE ER-2677             TO WS-ERROR
 13456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13457
 13458     IF CP-ERROR-LOAN-TERM
 13459        MOVE ER-2648             TO WS-ERROR
 13460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13461
 13462 3221-CHECK-ERROR-RATE-OPEN.
 13463
 13464     IF CP-ERROR-RATE-FILE-NOTOPEN
 13465         GO TO 3990-FILES-NOT-OPEN.
 13466
 13467     IF PB-COMPANY-ID NOT = 'DMD'
 13468        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13469     END-IF
 13470     .
 13471 3221-CONTINUE.
 13472     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13473                                    WS-DCC-AH-RATE
 13474     IF PB-COMPANY-ID = 'DCC'
 13475        IF WS-LF-BEN-CATEGORY = 'D'
 13476           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13477              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13478        END-IF
 13479     END-IF
 13480     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13481*   X'A4FF' = 12/31/2009
 13482     IF (PB-COMPANY-ID = 'CID')
 13483        AND (WS-LF-EARNINGS-CALC = 'B')
 13484        AND (CP-STATE-STD-ABBRV = 'MN')
 13485        AND (PB-CERT-EFF-DT > X'A4FF')
 13486        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13487     END-IF
 13488     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13489
 13490     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13491     IF (PB-COMPANY-ID = 'DCC')
 13492        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13493        AND (PB-I-POLICY-IS-MONTHLY)
 13494        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13495        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13496     END-IF
 13497     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13498     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13499     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13500     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13501     IF (PB-COMPANY-ID = 'DCC')
 13502        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13503        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13504        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13505        MOVE ER-2786             TO WS-ERROR
 13506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13507     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 245
* EL050.cbl
 13508
 13509     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13510
 13511******************************************************************
 13512*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13513******************************************************************
 13514     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13515        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13516
 13517     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13518        GO TO 3225-CHECK-ALT-LIFE-RATE
 13519     ELSE
 13520       IF PB-I-LF-RATE = ZERO
 13521          MOVE ER-2641          TO WS-ERROR
 13522          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13523
 13524 3225-CHECK-ALT-LIFE-RATE.
 13525
 13526     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13527        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13528        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13529         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13530
 13531     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13532         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13533             AND PB-COMPANY-ID NOT = 'DCC')
 13534                   OR
 13535              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13536              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13537              AND PB-COMPANY-ID NOT = 'DCC')
 13538             MOVE ER-2720        TO  WS-ERROR
 13539             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540             GO TO 3225-RATING-CONT
 13541         ELSE
 13542             GO TO 3225-RATING-CONT.
 13543     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13544        AND (AM-GPCD = 01 OR 06 OR 15)
 13545        MOVE ER-2798             TO WS-ERROR
 13546        PERFORM 9900-ERROR-FORMAT
 13547                                 THRU 9900-EXIT
 13548*       GO TO 3225-RATING-CONT
 13549     END-IF
 13550     IF (PB-COMPANY-ID = 'CID')
 13551        AND (WS-LF-EARNINGS-CALC = 'B')
 13552        AND (CP-STATE-STD-ABBRV = 'MN')
 13553        AND (PB-CERT-EFF-DT > X'A4FF')
 13554        GO TO 3225-RATING-CONT
 13555     END-IF
 13556     IF PB-COMPANY-ID = 'DCC'
 13557        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13558           AND (PB-I-POLICY-IS-MONTHLY)
 13559           GO TO 3225-RATING-CONT
 13560        END-IF
 13561     END-IF
 13562
 13563     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13564        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13565        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 246
* EL050.cbl
 13566        NEXT SENTENCE
 13567     ELSE
 13568        MOVE '2'                 TO CP-EARNING-METHOD.
 13569
 13570 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13571
 13572     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13573
 13574     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13575        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13576        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13577         NEXT SENTENCE
 13578     ELSE
 13579         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13580
 13581     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13582     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13583     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13584                                     CP-RATING-BENEFIT-AMT.
 13585     IF CP-STATE-STD-ABBRV = 'OR'
 13586         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13587                                         PB-I-LF-ALT-BENEFIT-AMT.
 13588     IF PB-COMPANY-ID = 'DCC'
 13589        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13590     END-IF
 13591     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13592     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13593     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13594                                    CP-REMAINING-TERM
 13595                                    CP-LOAN-TERM.
 13596     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13597        ADD +1                   TO CP-ORIGINAL-TERM
 13598                                    CP-REMAINING-TERM
 13599                                    CP-LOAN-TERM.
 13600
 13601     MOVE 'R'                   TO CP-RATE-FILE.
 13602     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13603
 13604     IF CP-ERROR-RATE-NOT-FOUND
 13605         MOVE ER-2641            TO WS-ERROR
 13606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13607         GO TO 3300-CHECK-AH-RATES.
 13608
 13609     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13610     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13611
 13612     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13613         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13614
 13615     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13616                               + PB-I-LF-ALT-BENEFIT-AMT.
 13617
 13618     IF ACCOUNT-LIFE-CHECKED  OR
 13619        PB-POLICY-IS-VOIDED   OR
 13620        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13621        GO TO 3225-CONTINUE.
 13622
 13623     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 247
* EL050.cbl
 13624        GO TO 3225-CONTINUE.
 13625
 13626     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13627                             EC-RT-LF-MAX-TOT-BEN
 13628        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13629        MOVE ER-2639       TO WS-ERROR
 13630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13631
 13632 3225-CONTINUE.
 13633     IF PB-I-LF-ALT-RATE = ZERO
 13634         MOVE ER-2659            TO WS-ERROR
 13635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13636
 13637     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13638        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13639        MOVE ER-2698             TO WS-ERROR
 13640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13641
 13642 3225-RATING-CONT.
 13643
 13644     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13645         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13646         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13647         IF (PB-COMPANY-ID = 'DCC')
 13648            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13649            CONTINUE
 13650         ELSE
 13651            MOVE ER-2687         TO WS-ERROR
 13652            PERFORM 9900-ERROR-FORMAT
 13653                                 THRU 9900-EXIT
 13654         END-IF
 13655         GO TO 3290-EDIT-LF-REIN-RATE
 13656     END-IF
 13657
 13658* DMD RATING TEST
 13659     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13660         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13661         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13662         MOVE ER-2687                 TO WS-ERROR
 13663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13664         GO TO 3290-EDIT-LF-REIN-RATE.
 13665
 13666 3230-CLIENT-MORT-CD-SPECIALS.
 13667
 13668     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13669     SET BIN-TO-GREG          TO TRUE.
 13670*    MOVE ' '                 TO DC-OPTION-CODE.
 13671     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13672     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13673
 13674 C-POS-3230-MORT-CD.
 13675     IF PB-COMPANY-ID = 'POS' AND
 13676        PB-SV-CARRIER = '2'
 13677         NEXT SENTENCE
 13678     ELSE
 13679         GO TO C-POS-3240-MORT-CD.
 13680
 13681     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 248
* EL050.cbl
 13682        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13683         MOVE '2350' TO PB-I-MORT-CODE
 13684      ELSE
 13685         MOVE '3300' TO PB-I-MORT-CODE.
 13686
 13687
 13688 C-POS-3240-MORT-CD.
 13689     IF PB-COMPANY-ID = 'POS' AND
 13690        PB-SV-CARRIER = '1'
 13691         NEXT SENTENCE
 13692     ELSE
 13693         GO TO 3230-CONTINUE.
 13694
 13695     IF PB-SV-STATE = '45' OR '47'
 13696        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13697         MOVE '5200' TO PB-I-MORT-CODE
 13698     ELSE
 13699         MOVE '8300' TO PB-I-MORT-CODE.
 13700
 13701 3230-CONTINUE.
 13702
 13703     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13704        GO TO 3240-CONTINUE
 13705     END-IF
 13706
 13707     IF PB-CERT-EFF-DT > WS-971231
 13708        GO TO 3240-CONTINUE
 13709     END-IF
 13710
 13711     IF LF-BENEFIT-FOUND AND
 13712        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13713         MOVE 'F250'       TO PB-I-MORT-CODE
 13714     ELSE
 13715         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13716             MOVE '7250'   TO PB-I-MORT-CODE
 13717         ELSE
 13718             MOVE '4251'   TO PB-I-MORT-CODE
 13719         END-IF
 13720     END-IF
 13721
 13722     .
 13723 3240-CONTINUE.
 13724
 13725     IF PB-COMPANY-ID NOT = 'GNL'
 13726         GO TO 3256-CONTINUE.
 13727
 13728     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13729         MOVE 'A300' TO PB-I-MORT-CODE
 13730     ELSE
 13731         MOVE '8350' TO PB-I-MORT-CODE.
 13732
 13733 3256-CONTINUE.
 13734     IF PB-COMPANY-ID NOT = 'ABL'
 13735         GO TO 3260-EDIT-CONTINUE.
 13736
 13737     IF PB-I-LF-TERM GREATER THAN 59
 13738         MOVE 'F550' TO PB-I-MORT-CODE
 13739     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 249
* EL050.cbl
 13740         MOVE 'E550' TO PB-I-MORT-CODE.
 13741
 13742 3260-EDIT-CONTINUE.
 13743     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13744
 13745 3290-EDIT-LF-REIN-RATE.
 13746     IF LF-REIN-NSP-NOT-USED
 13747         GO TO 3290-RATING-CONT.
 13748
 13749     IF PB-COMPANY-ID = 'DCC'
 13750        GO TO 3290-RATING-CONT.
 13751     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13752     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13753     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13754     MOVE '3'                   TO CP-PROCESS-TYPE.
 13755     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13756
 13757******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13758     IF PB-COMPANY-ID EQUAL 'CDL'
 13759         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13760            CP-EARN-AS-NET-PAY)
 13761             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13762*            MOVE SPACE          TO DC-OPTION-CODE
 13763             SET BIN-TO-GREG     TO TRUE
 13764             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13765***  Y2K PROJ 7744
 13766             IF DC-GREG-DATE-CYMD GREATER 19931231
 13767                 MOVE '1'        TO CP-EARNING-METHOD.
 13768***  Y2K PROJ 7744
 13769*******
 13770
 13771     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13772     MOVE PB-SV-STATE           TO CP-STATE.
 13773     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13774     MOVE ZERO                  TO CP-DEVIATION-CODE
 13775                                   CP-RATE-DEV-PCT.
 13776     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13777     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13778                                   CP-RATING-BENEFIT-AMT.
 13779
 13780************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13781     IF PB-COMPANY-ID EQUAL 'NCB'
 13782         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13783            CP-EARN-AS-NET-PAY
 13784             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13785                 PB-I-LF-PREMIUM-AMT.
 13786************
 13787
 13788     IF CP-STATE-STD-ABBRV = 'OR'
 13789         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13790                                         PB-I-LF-ALT-BENEFIT-AMT.
 13791     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13792     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13793     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13794     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13795     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13796     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13797     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 250
* EL050.cbl
 13798     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13799                                   CP-REMAINING-TERM
 13800                                   CP-LOAN-TERM.
 13801     IF CP-TRUNCATED-LIFE
 13802        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13803
 13804     IF CP-TERM-IS-DAYS
 13805         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13806     ELSE
 13807         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13808
 13809     IF PB-COMPANY-ID = 'DCC'
 13810        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13811     END-IF
 13812     IF PB-COMPANY-ID NOT = 'TIC'
 13813          MOVE ZERO          TO CP-CLASS-CODE.
 13814
 13815     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13816
 13817     MOVE 'R'                   TO CP-RATE-FILE.
 13818     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13819
 13820     IF CP-ERROR-RATE-NOT-FOUND
 13821        IF PB-I-OB
 13822           MOVE ER-2625      TO WS-ERROR
 13823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13824           GO TO 3299-EDIT-CONTINUE
 13825        ELSE
 13826           MOVE ER-2643      TO WS-ERROR
 13827           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13828           GO TO 3299-EDIT-CONTINUE.
 13829
 13830     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13831
 13832     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13833     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13834
 13835     IF PB-I-LF-REI-RATE = ZERO
 13836         MOVE ER-2643        TO WS-ERROR
 13837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13838
 13839 3290-CHECK-ALT-REIN-RATE.
 13840
 13841     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13842        GO TO 3290-RATING-CONT.
 13843
 13844     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13845     MOVE '2'                    TO CP-EARNING-METHOD.
 13846     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13847     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13848     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13849     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13850                                     CP-RATING-BENEFIT-AMT.
 13851     IF CP-STATE-STD-ABBRV = 'OR'
 13852         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13853                                         PB-I-LF-ALT-BENEFIT-AMT.
 13854     IF PB-COMPANY-ID = 'DCC'
 13855        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 251
* EL050.cbl
 13856     END-IF
 13857     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13858     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13859     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13860                                    CP-REMAINING-TERM
 13861                                    CP-LOAN-TERM.
 13862     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13863        ADD +1                   TO CP-ORIGINAL-TERM
 13864                                    CP-REMAINING-TERM
 13865                                    CP-LOAN-TERM.
 13866
 13867     MOVE 'R'                   TO CP-RATE-FILE.
 13868     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13869
 13870     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13871
 13872     IF PB-I-LF-ALT-REI-RATE = ZERO
 13873         MOVE ER-2643            TO WS-ERROR
 13874         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13875
 13876 3290-RATING-CONT.
 13877
 13878     IF PB-I-OB
 13879*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13880        GO TO 3300-CHECK-AH-RATES.
 13881
 13882 3299-EDIT-CONTINUE.
 13883
 13884     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13885         NEXT SENTENCE
 13886     ELSE
 13887         MOVE ER-2620           TO WS-ERROR
 13888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13889
 13890 3300-CHECK-AH-RATES.
 13891     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13892         NEXT SENTENCE
 13893     ELSE
 13894         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13895
 13896     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13897        ((CF-COMPANY-ID = 'DMD') AND
 13898                (NO-DMD-RATING))
 13899         IF (PB-COMPANY-ID = 'DCC')
 13900            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13901            CONTINUE
 13902         ELSE
 13903            MOVE ER-2687         TO WS-ERROR
 13904            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13905         END-IF
 13906         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13907         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13908     END-IF
 13909
 13910     IF PB-I-OB
 13911        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13912
 13913     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 252
* EL050.cbl
 13914         MOVE ER-2687             TO WS-ERROR
 13915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13916         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13917         GO TO 3999-END-EDIT.
 13918
 13919*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13920     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13921        IF PB-I-AH-CRIT-PER = ZERO
 13922           IF PB-COMPANY-ID = 'DCC'
 13923              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13924              CONTINUE
 13925           ELSE
 13926              MOVE ER-2618       TO WS-ERROR
 13927              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13928              GO TO 3999-END-EDIT
 13929           END-IF
 13930        END-IF
 13931     END-IF
 13932     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13933     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13934     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13935     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13936     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13937     MOVE PB-SV-STATE            TO CP-STATE.
 13938     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13939     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13940     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13941*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13942     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13943     MOVE '3'                    TO CP-PROCESS-TYPE.
 13944     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13945     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13946                                    CP-RATING-BENEFIT-AMT.
 13947     IF PB-COMPANY-ID = 'CID'
 13948               OR
 13949        CP-STATE-STD-ABBRV = 'OR'
 13950         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13951                                         PB-I-AH-TERM.
 13952     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13953        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13954           AND (PB-I-POLICY-IS-MONTHLY)
 13955           MOVE PB-I-LF-BENEFIT-AMT
 13956                                 TO CP-NET-BENEFIT-AMT
 13957           move pb-i-ah-premium-amt to cp-original-premium
 13958           add pb-i-lf-premium-amt to cp-original-premium
 13959        END-IF
 13960     END-IF
 13961     MOVE SPACES                 TO CP-BEN-CATEGORY
 13962     IF PB-COMPANY-ID = 'DCC'
 13963        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13964        EVALUATE TRUE
 13965           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13966              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13967              MOVE PB-I-LF-BENEFIT-AMT
 13968                                 TO CP-RATING-BENEFIT-AMT
 13969              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13970           WHEN WS-AH-BEN-CATEGORY = 'G'
 13971              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 253
* EL050.cbl
 13972                                 TO CP-RATING-BENEFIT-AMT
 13973           WHEN WS-AH-BEN-CATEGORY = 'D'
 13974              MOVE WS-AH-PMF-COMM
 13975                                 TO CP-DCC-PMF-COMM
 13976              MOVE PB-I-AH-COMMISSION
 13977                                 TO CP-DCC-ACT-COMM
 13978        END-EVALUATE
 13979     END-IF
 13980     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13981     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13982     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13983     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13984     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13985     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13986     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13987                                    CP-REMAINING-TERM
 13988                                    WS-WORK-TERM.
 13989     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13990
 13991     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13992     SET BIN-TO-GREG             TO TRUE.
 13993*    MOVE ' '                    TO DC-OPTION-CODE.
 13994     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13995     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13996
 13997     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13998     IF NOT VALID-SKIP-CODE
 13999         MOVE ER-2683            TO WS-ERROR
 14000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14001         GO TO 3320-RATE-CONTINUE.
 14002
 14003     IF PB-NO-MONTHS-SKIPPED
 14004         GO TO 3320-RATE-CONTINUE.
 14005
 14006     MOVE SPACE TO NUMBER-OF-MONTHS.
 14007
 14008     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14009         MOVE 'S'                TO SK-MO (6).
 14010     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14011         MOVE 'S'                TO SK-MO (7).
 14012     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14013         MOVE 'S'                TO SK-MO (8).
 14014     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14015         MOVE 'S'                TO SK-MO (9).
 14016     IF PB-I-SKIP-CODE = 'A'
 14017         MOVE 'S'                TO SK-MO (10).
 14018
 14019     MOVE 1                      TO SUB2.
 14020     MOVE PB-I-AH-TERM           TO SUB3.
 14021     MOVE WS-MONTH               TO SUB1.
 14022     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14023     GO TO 3320-RATE-CONTINUE.
 14024
 14025 3310-GET-SKIP-MO.
 14026     IF SUB1 = 13
 14027         MOVE 1                  TO SUB1.
 14028
 14029     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 254
* EL050.cbl
 14030         SUBTRACT 1 FROM WS-WORK-TERM.
 14031
 14032     ADD 1 TO SUB2
 14033              SUB1.
 14034
 14035 3320-RATE-CONTINUE.
 14036
 14037     IF WS-WORK-TERM = ZERO
 14038         MOVE 1                  TO WS-WORK-TERM.
 14039
 14040     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14041                                    CP-LOAN-TERM.
 14042
 14043     IF PB-COMPANY-ID EQUAL 'DMD'
 14044         NEXT SENTENCE
 14045     ELSE
 14046         MOVE ZERO               TO PB-I-AH-RATE
 14047                                    PB-I-AH-REI-RATE.
 14048
 14049
 14050     IF PB-COMPANY-ID EQUAL 'CRI'
 14051        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14052
 14053     IF PB-COMPANY-ID = 'CSL'
 14054         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14055         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14056         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14057         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14058
 14059     IF PB-COMPANY-ID = 'DCC'
 14060        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14061           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14062              PB-I-RATE-DEV-PCT-LF
 14063        END-IF
 14064        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14065                                 TO CP-ALTERNATE-BENEFIT
 14066        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14067        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14068        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14069     END-IF
 14070     IF (PB-COMPANY-ID = 'CID')
 14071        AND (WS-LF-EARNINGS-CALC = 'B')
 14072        AND (CP-STATE-STD-ABBRV = 'MN')
 14073        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14074     ELSE
 14075        MOVE ' '                 TO CP-AH-BALLOON-SW
 14076     END-IF
 14077     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14078     MOVE 'R'                   TO CP-RATE-FILE.
 14079     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14080
 14081     IF CP-ERROR-RATE-NOT-FOUND
 14082        IF PB-I-OB
 14083           MOVE ER-2624          TO WS-ERROR
 14084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14085           GO TO 3340-CALCULATE-PREMIUM-AMT
 14086        ELSE
 14087          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 255
* EL050.cbl
 14088              NEXT SENTENCE
 14089          ELSE
 14090           MOVE ER-2642          TO WS-ERROR
 14091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14092           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14093
 14094     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14095        CP-ERROR-DIV-BY-ZERO
 14096           MOVE ER-3782          TO WS-ERROR
 14097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14098
 14099     IF PB-COMPANY-ID EQUAL 'CRI'
 14100        IF CP-ERROR-NO-LIMITS-CRI
 14101           IF NOT ACCOUNT-AH-CHECKED
 14102              MOVE ER-2607          TO WS-ERROR
 14103              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14104
 14105     IF ACCOUNT-AH-CHECKED
 14106        NEXT SENTENCE
 14107     ELSE
 14108       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14109          MOVE ER-2640           TO WS-ERROR
 14110          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14111
 14112     IF PB-COMPANY-ID = 'CRI'
 14113         IF WS-ERROR = ER-2640
 14114             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14115     IF ACCOUNT-AH-CHECKED
 14116        CONTINUE
 14117     ELSE
 14118        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14119           AND (CP-R-MAX-ATT-AGE > +0)
 14120           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14121           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14122              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14123              MOVE PB-I-AH-EXPIRE-DT
 14124                                 TO DC-BIN-DATE-2
 14125              MOVE '1'           TO DC-OPTION-CODE
 14126              PERFORM 8500-DATE-CONVERT
 14127                                 THRU 8500-EXIT
 14128              IF NO-CONVERSION-ERROR
 14129                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14130                    MOVE ER-2661       TO WS-ERROR
 14131*                   PERFORM 9900-ERROR-FORMAT
 14132*                                THRU 9900-EXIT
 14133                 END-IF
 14134              END-IF
 14135           ELSE
 14136              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14137              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14138                 MOVE ER-2661    TO WS-ERROR
 14139*                PERFORM 9900-ERROR-FORMAT
 14140*                                THRU 9900-EXIT
 14141              ELSE
 14142                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14143                    MOVE ER-1570 TO WS-ERROR
 14144                    PERFORM 9900-ERROR-FORMAT
 14145                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 256
* EL050.cbl
 14146                 END-IF
 14147              END-IF
 14148           END-IF
 14149           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14150              MOVE PB-I-JOINT-BIRTHDAY
 14151                                    TO DC-BIN-DATE-1
 14152              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14153              MOVE '1'              TO DC-OPTION-CODE
 14154              PERFORM 8500-DATE-CONVERT
 14155                                    THRU 8500-EXIT
 14156              IF NO-CONVERSION-ERROR
 14157                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14158                    MOVE ER-2661       TO WS-ERROR
 14159*                   PERFORM 9900-ERROR-FORMAT
 14160*                                   THRU 9900-EXIT
 14161                 END-IF
 14162              END-IF
 14163           ELSE
 14164              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14165                (PB-I-AH-TERM / 12)
 14166              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14167                 MOVE ER-2661       TO WS-ERROR
 14168*                PERFORM 9900-ERROR-FORMAT
 14169*                                   THRU 9900-EXIT
 14170              ELSE
 14171                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14172                    MOVE ER-1571 TO WS-ERROR
 14173                    PERFORM 9900-ERROR-FORMAT
 14174                                 THRU 9900-EXIT
 14175                 END-IF
 14176              END-IF
 14177           END-IF
 14178           IF WS-ERROR = ER-2661
 14179              PERFORM 9900-ERROR-FORMAT
 14180                                    THRU 9900-EXIT
 14181           END-IF
 14182        END-IF
 14183     END-IF
 14184*    IF ACCOUNT-AH-CHECKED
 14185*       NEXT SENTENCE
 14186*    ELSE
 14187*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14188*          MOVE ER-2661          TO WS-ERROR
 14189*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14190
 14191     IF ACCOUNT-AH-CHECKED
 14192        NEXT SENTENCE
 14193     ELSE
 14194        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14195           MOVE ER-2663          TO WS-ERROR
 14196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14197
 14198     IF ACCOUNT-AH-CHECKED OR
 14199        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14200         PB-POLICY-IS-VOIDED
 14201        NEXT SENTENCE
 14202     ELSE
 14203        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 257
* EL050.cbl
 14204           MOVE ER-2667            TO WS-ERROR
 14205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14206
 14207     IF PB-COMPANY-ID = 'CRI'
 14208         IF WS-ERROR = ER-2667
 14209             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14210
 14211     IF ACCOUNT-AH-CHECKED
 14212        NEXT SENTENCE
 14213     ELSE
 14214        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14215           MOVE ER-2678            TO WS-ERROR
 14216           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14217
 14218     IF CP-ERROR-RATE-FILE-NOTOPEN
 14219         GO TO 3990-FILES-NOT-OPEN.
 14220
 14221 3321-CONTINUE.
 14222     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14223     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14224     IF (PB-COMPANY-ID = 'DCC')
 14225        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14226        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14227                                    PB-I-LF-ALT-PREM-CALC
 14228        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14229        IF WS-AH-BEN-CATEGORY = 'G'
 14230           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14231           + PB-I-ADDL-CLP)
 14232           * (1 + WS-TOL-CLP-PCT)
 14233*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14234        ELSE
 14235           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14236           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14237*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14238        END-IF
 14239        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14240                                 TO PB-I-AH-PREM-CALC
 14241        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14242           MOVE ER-8152          TO WS-ERROR
 14243           PERFORM 9900-ERROR-FORMAT
 14244                                 THRU 9900-EXIT
 14245        ELSE
 14246           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14247                 PB-I-ADDL-CLP)
 14248              MOVE ER-8148       TO WS-ERROR
 14249              PERFORM 9900-ERROR-FORMAT
 14250                                 THRU 9900-EXIT
 14251           END-IF
 14252        END-IF
 14253     END-IF
 14254     IF (PB-COMPANY-ID = 'DCC')
 14255        AND (PB-I-POLICY-IS-MONTHLY)
 14256        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14257        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14258        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14259           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14260        END-IF
 14261     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 258
* EL050.cbl
 14262     IF (PB-COMPANY-ID = 'DCC')
 14263        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14264        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14265        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14266        MOVE ER-2786             TO WS-ERROR
 14267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14268     END-IF
 14269     MOVE +0                     TO PB-I-AH-CLP
 14270     IF PB-COMPANY-ID = 'DCC'
 14271        IF WS-AH-BEN-CATEGORY = 'D'
 14272           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14273              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14274        ELSE
 14275           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14276              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14277           END-IF
 14278        END-IF
 14279     END-IF
 14280     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14281
 14282     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14283         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14284
 14285     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14286         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14287
 14288     IF PB-COMPANY-ID = 'CRI'
 14289         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14290            PB-I-PAYMENT-AMOUNT = ZERO
 14291             NEXT SENTENCE
 14292         ELSE
 14293             COMPUTE PB-I-AH-PREM-CALC =
 14294                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14295                 (CP-PREMIUM-RATE / 100)
 14296             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14297                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14298                                             PB-I-RATE-DEV-PCT-AH.
 14299
 14300     IF PB-I-AH-RATE  = ZERO
 14301       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14302           NEXT SENTENCE
 14303       ELSE
 14304         MOVE ER-2642            TO WS-ERROR
 14305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14306
 14307     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14308     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14309     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14310     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14311     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14312     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14313
 14314     IF (PB-COMPANY-ID = 'DCC')
 14315        AND (WS-AH-BEN-CATEGORY = 'G')
 14316        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14317        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14318        IF CP-DEVIATION-CODE NOT = '000'
 14319           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 259
* EL050.cbl
 14320           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14321           IF NO-CP-ERROR
 14322              COMPUTE PB-I-DDF-IU-RATE-UP =
 14323              PB-I-AH-CLP - CP-CALC-PREMIUM
 14324           ELSE
 14325              MOVE ER-3057        TO WS-ERROR
 14326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14327           END-IF
 14328        END-IF
 14329     END-IF
 14330     .
 14331 3335-EDIT-AH-REIN-NSP-RATE.
 14332     IF AH-REIN-NSP-NOT-USED
 14333         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14334
 14335     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14336     IF PB-COMPANY-ID = 'DCC'
 14337         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14338     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14339     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14340     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14341     MOVE PB-SV-STATE            TO CP-STATE.
 14342     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14343     MOVE ZERO                   TO CP-DEVIATION-CODE
 14344                                    CP-RATE-DEV-PCT.
 14345*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14346     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14347     MOVE '3'                    TO CP-PROCESS-TYPE.
 14348     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14349     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14350                                    CP-RATING-BENEFIT-AMT.
 14351     IF CP-STATE-STD-ABBRV = 'OR'
 14352         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14353                                         PB-I-AH-TERM.
 14354     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14355     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14356     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14357     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14358     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14359     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14360                                    CP-REMAINING-TERM
 14361                                    WS-WORK-TERM.
 14362     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14363     IF PB-COMPANY-ID = 'DCC'
 14364        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14365     END-IF
 14366     IF  PB-COMPANY-ID = 'TIC'
 14367         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14368            MOVE ZERO TO CP-CLASS-CODE.
 14369
 14370     IF PB-COMPANY-ID NOT = 'TIC'
 14371          MOVE ZERO          TO CP-CLASS-CODE.
 14372
 14373     MOVE ZERO               TO CP-DEVIATION-CODE.
 14374
 14375     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14376
 14377     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 260
* EL050.cbl
 14378
 14379     MOVE 'R'                   TO CP-RATE-FILE.
 14380     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14381
 14382     IF CP-ERROR-RATE-NOT-FOUND
 14383         MOVE ER-2645        TO WS-ERROR
 14384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14385         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14386
 14387     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14388
 14389     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14390     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14391
 14392     IF PB-I-AH-REI-RATE = ZERO
 14393         MOVE ER-2645        TO WS-ERROR
 14394         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14395
 14396
 14397 3340-CALCULATE-PREMIUM-AMT.
 14398
 14399     IF PB-COMPANY-ID = 'NCL'
 14400         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14401             WS-AH-SPECIAL-CALC-CD = 'O')
 14402             GO TO 3999-END-EDIT.
 14403
 14404     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14405                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14406                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14407                         OR 'AHL'
 14408         NEXT SENTENCE
 14409     ELSE
 14410         IF WS-STATE-ABBREVIATION = 'CT'
 14411             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14412                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14413                 COMPUTE PB-I-LF-PREM-CALC =
 14414                                     PB-I-LF-PREM-CALC * .90
 14415                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14416                                     PB-I-LF-ALT-PREM-CALC * .90
 14417                 COMPUTE PB-I-AH-PREM-CALC =
 14418                                     PB-I-AH-PREM-CALC * .90.
 14419
 14420     IF PB-COMP-LF-PREM
 14421        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14422        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14423
 14424     IF PB-COMP-AH-PREM
 14425        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14426
 14427 3340-CHECK-DCC-TOT-FEES.
 14428     IF (PB-COMPANY-ID = 'DCC')
 14429        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14430        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14431        AND (PB-I-POLICY-IS-MONTHLY)
 14432        CONTINUE
 14433     ELSE
 14434        GO TO 3340-EDIT-LF-AH-TOL
 14435     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 261
* EL050.cbl
 14436     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14437     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14438     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14439        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14440           PB-I-RATE-DEV-PCT-LF
 14441     END-IF
 14442     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14443        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14444           PB-I-RATE-DEV-PCT-AH
 14445     END-IF
 14446     MOVE 'N'                    TO CP-BEN-CATEGORY
 14447     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14448
 14449     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14450     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14451     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14452     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14453     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14454     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14455     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14456     MOVE '3'                    TO CP-PROCESS-TYPE.
 14457     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14458     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14459
 14460     MOVE PB-SV-STATE            TO CP-STATE.
 14461     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14462     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14463     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14464     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14465     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14466                                    CP-RATING-BENEFIT-AMT.
 14467     IF CP-STATE-STD-ABBRV = 'OR'
 14468         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14469                                         PB-I-LF-ALT-BENEFIT-AMT.
 14470     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14471     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14472     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14473     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14474     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14475     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14476     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14477     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14478     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14479                                    CP-REMAINING-TERM
 14480                                    CP-LOAN-TERM.
 14481     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14482        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14483           PB-I-LF-PREMIUM-AMT
 14484     end-if
 14485
 14486     IF CP-TRUNCATED-LIFE
 14487        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14488
 14489     IF CP-TERM-IS-DAYS
 14490         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14491     ELSE
 14492         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14493
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 262
* EL050.cbl
 14494     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14495     IF CP-SPECIAL-CALC-CD = 'H'
 14496         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14497                                    TO CP-ALTERNATE-BENEFIT
 14498         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14499     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14500     MOVE 'R'                    TO CP-RATE-FILE
 14501     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14502     IF NOT CP-ERROR-RATE-NOT-FOUND
 14503        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14504        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14505           AND (CP-BENEFIT-CD (1:1) = 'S')
 14506           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14507                                    PB-I-LF-PREMIUM-AMT
 14508        END-IF
 14509     ELSE
 14510        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14511     END-IF
 14512     .
 14513 3340-EDIT-LF-AH-TOL.
 14514
 14515***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14516***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14517***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14518***
 14519     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14520         PB-I-AH-PREMIUM-AMT
 14521          GIVING WS-CALC-WORK.
 14522
 14523     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14524        AND WS-CALC-WORK NOT = ZERO
 14525         MOVE ER-2649            TO WS-ERROR
 14526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14527
 14528     SUBTRACT PB-I-LF-PREM-CALC
 14529             FROM PB-I-LF-PREMIUM-AMT
 14530                 GIVING WS-UNSIGN-WRK1.
 14531
 14532     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14533             FROM PB-I-LF-ALT-PREMIUM-AMT
 14534                 GIVING WS-UNSIGN-WRK4.
 14535
 14536     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14537                                + WS-UNSIGN-WRK4.
 14538
 14539     SUBTRACT PB-I-AH-PREM-CALC
 14540             FROM PB-I-AH-PREMIUM-AMT
 14541                 GIVING WS-UNSIGN-WRK2.
 14542
 14543******************************************************************
 14544*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14545******************************************************************
 14546
 14547     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14548         MOVE ZERO TO WS-UNSIGN-WRK1.
 14549
 14550     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14551         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 263
* EL050.cbl
 14552
 14553     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14554             GIVING WS-UNSIGN-WRK3.
 14555
 14556 3342-CONTINUE.
 14557
 14558     IF (PB-I-LF-RATE = ZERO  AND
 14559         PB-I-AH-RATE = ZERO)
 14560         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14561            WS-AH-SPECIAL-CALC-CD = 'O'
 14562              NEXT SENTENCE
 14563         ELSE
 14564             GO TO 3345-EDIT-CONTINUE.
 14565
 14566     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14567         NEXT SENTENCE
 14568     ELSE
 14569     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14570        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14571           IF (PB-REISSUED-CERT         OR
 14572               PB-POLICY-IS-DECLINED    OR
 14573               PB-POLICY-IS-VOIDED)
 14574              NEXT SENTENCE
 14575           ELSE
 14576              IF WS-PREM-REJECT-SW = SPACE
 14577                 MOVE ER-2652    TO WS-ERROR
 14578                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14579                 GO TO 3344-CHECK-AH
 14580              ELSE
 14581                 MOVE ER-2650    TO WS-ERROR
 14582                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14583                 GO TO 3344-CHECK-AH.
 14584
 14585***
 14586***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14587***
 14588
 14589     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14590         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14591            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14592             (1 + WS-TOL-LF-PREM-PCT)
 14593         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14594            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14595             (1 - WS-TOL-LF-PREM-PCT)
 14596     ELSE
 14597         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14598         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14599
 14600***
 14601***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14602***
 14603
 14604     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14605         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14606          WS-TOL-LF-PREM.
 14607
 14608     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14609         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 264
* EL050.cbl
 14610          WS-TOL-LF-PREM.
 14611
 14612     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14613        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14614
 14615     IF PB-REISSUED-CERT
 14616        or PB-POLICY-IS-DECLINED
 14617        or PB-POLICY-IS-VOIDED
 14618        continue
 14619     ELSE
 14620        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14621              > WS-TOL-LF-HIGH-PREM-AMT)
 14622           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14623              < WS-TOL-LF-LOW-PREM-AMT))
 14624                      or
 14625           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14626              > WS-TOL-LF-HIGH-PREM-PCT)
 14627           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14628              < WS-TOL-LF-LOW-PREM-PCT))
 14629           IF WS-PREM-REJECT-SW = SPACE
 14630              MOVE ER-2652       TO WS-ERROR
 14631              PERFORM 9900-ERROR-FORMAT
 14632                                 THRU 9900-EXIT
 14633           ELSE
 14634              MOVE ER-2650       TO WS-ERROR
 14635              PERFORM 9900-ERROR-FORMAT
 14636                                 THRU 9900-EXIT
 14637           end-if
 14638        end-if
 14639     end-if
 14640
 14641*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14642*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14643*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14644*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14645
 14646     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14647        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14648                      OR
 14649           ((PB-COMPANY-ID = 'DCC')
 14650           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14651           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14652           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14653        END-IF
 14654     END-IF
 14655
 14656     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14657        IF WS-COMP-MAX-CAP GREATER THAN +0
 14658           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14659              IF (PB-REISSUED-CERT         OR
 14660                  PB-POLICY-IS-DECLINED    OR
 14661                  PB-POLICY-IS-VOIDED)
 14662                 NEXT SENTENCE
 14663              ELSE
 14664                  MOVE ER-2646   TO  WS-ERROR
 14665                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14666
 14667 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 265
* EL050.cbl
 14668
 14669      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14670          GO TO 3344-CHECK-AH.
 14671
 14672      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14673          GO TO 3344-CHECK-AH.
 14674
 14675      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14676                                     WS-UNSIGN-WRK6.
 14677
 14678      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14679          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14680                                 + PB-I-LF-PREMIUM-AMT
 14681                                 - PB-I-LF-PREM-CALC.
 14682
 14683      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14684          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14685                                 + PB-I-LF-ALT-PREMIUM-AMT
 14686                                 - PB-I-LF-ALT-PREM-CALC.
 14687
 14688      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14689          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14690              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14691                 MOVE ER-2652    TO  WS-ERROR
 14692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693              ELSE
 14694                 MOVE ER-2650    TO  WS-ERROR
 14695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14696
 14697      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14698          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14699              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14700                 MOVE ER-2652    TO  WS-ERROR
 14701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14702              ELSE
 14703                 MOVE ER-2650    TO  WS-ERROR
 14704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14705
 14706 3344-CHECK-AH.
 14707
 14708****************************************************************
 14709***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14710***
 14711
 14712     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14713         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14714             (1 + WS-TOL-AH-PREM-PCT)
 14715         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14716             (1 - WS-TOL-AH-PREM-PCT)
 14717     ELSE
 14718         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14719         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14720
 14721***
 14722***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14723***
 14724
 14725     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 266
* EL050.cbl
 14726         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14727
 14728     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14729         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14730
 14731     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14732        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14733
 14734     IF (PB-REISSUED-CERT)
 14735        OR (PB-POLICY-IS-DECLINED)
 14736        OR (PB-POLICY-IS-VOIDED)
 14737        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14738        CONTINUE
 14739     ELSE
 14740        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14741              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14742                          or
 14743           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14744              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14745           IF WS-PREM-REJECT-SW = SPACE
 14746              MOVE ER-3052       TO WS-ERROR
 14747              PERFORM 9900-ERROR-FORMAT
 14748                                 THRU 9900-EXIT
 14749           ELSE
 14750              MOVE ER-3050       TO WS-ERROR
 14751              PERFORM 9900-ERROR-FORMAT
 14752                                 THRU 9900-EXIT
 14753           END-IF
 14754        END-IF
 14755     END-IF
 14756     if (pb-company-id = 'DCC')
 14757        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14758        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14759        and (pb-i-policy-is-monthly)
 14760        compute ws-tol-ah-high-prem-amt =
 14761           pb-i-tot-fees-calc + ws-tol-ah-prem
 14762        compute ws-tol-ah-low-prem-amt =
 14763           pb-i-tot-fees-calc - ws-tol-ah-prem
 14764        if ws-tol-ah-prem-pct > zeros
 14765           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14766              (1 + ws-tol-ah-prem-pct)
 14767           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14768              (1 - ws-tol-ah-prem-pct)
 14769        else
 14770           move +9999999.99      to ws-tol-ah-high-prem-pct
 14771           move +0               to ws-tol-ah-low-prem-pct
 14772        end-if
 14773        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14774            or
 14775           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14776                          or
 14777           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14778           or
 14779           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14780            move er-3049         to ws-error
 14781           perform 9900-error-format
 14782                                 thru 9900-exit
 14783
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 267
* EL050.cbl
 14784        end-if
 14785     end-if
 14786     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14787         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14788             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14789             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14790
 14791     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14792        IF WS-COMP-MAX-CAP GREATER THAN +0
 14793           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14794              IF (PB-REISSUED-CERT         OR
 14795                  PB-POLICY-IS-DECLINED    OR
 14796                  PB-POLICY-IS-VOIDED)
 14797                 NEXT SENTENCE
 14798              ELSE
 14799                  MOVE ER-2646   TO  WS-ERROR
 14800                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14801
 14802     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14803        (WS-COMP-MAX-CAP EQUAL +0)
 14804           GO TO 3345-EDIT-CONTINUE.
 14805
 14806     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14807        GREATER THAN WS-COMP-MAX-CAP
 14808           MOVE ER-2646          TO  WS-ERROR
 14809           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14810
 14811 3345-EDIT-CONTINUE.
 14812
 14813*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14814*       IF PB-ENTRY-BATCH   NUMERIC
 14815*          IF PB-ISSUE
 14816*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14817*          ELSE
 14818*              IF PB-CANCELLATION
 14819*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14820
 14821*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14822*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14823*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14824*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14825*        ELSE
 14826*            MOVE  ER-1909            TO  WS-ERROR
 14827*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14828
 14829     IF PB-I-POLICY-ACCEPTED
 14830        IF PB-POLICY-IS-DECLINED  OR
 14831           PB-REISSUED-CERT  OR
 14832           PB-REIN-ONLY-CERT  OR
 14833           PB-POLICY-IS-VOIDED
 14834            MOVE  ER-1891         TO  WS-ERROR
 14835            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14836        ELSE
 14837            MOVE SPACE            TO  PB-BATCH-ENTRY
 14838            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14839
 14840     IF PB-I-POLICY-DECLINED
 14841        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 268
* EL050.cbl
 14842           PB-REIN-ONLY-CERT  OR
 14843           PB-POLICY-IS-VOIDED
 14844            MOVE  ER-1906         TO  WS-ERROR
 14845            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14846        ELSE
 14847            MOVE  'D'             TO  PB-BATCH-ENTRY
 14848                                      PB-I-ENTRY-STATUS.
 14849
 14850     IF PB-I-NEEDS-UNDERWRITING
 14851        IF PB-POLICY-IS-DECLINED OR
 14852           PB-REISSUED-CERT  OR
 14853           PB-REIN-ONLY-CERT  OR
 14854           PB-POLICY-IS-VOIDED
 14855            MOVE  ER-1907         TO  WS-ERROR
 14856            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14857        ELSE
 14858            MOVE 'U'              TO  PB-BATCH-ENTRY
 14859                                      PB-I-ENTRY-STATUS.
 14860
 14861     IF PB-NEEDS-UNDERWRITING
 14862        MOVE  ER-1901             TO  WS-ERROR
 14863        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14864     IF PB-COMPANY-ID = 'DCC'
 14865        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14866        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14867        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14868           AND (NOT WS-LF-CASH))
 14869                           OR
 14870           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14871           AND (NOT WS-AH-CASH)))
 14872                       AND
 14873           (PB-I-ENTRY-STATUS NOT = '5')
 14874           MOVE 'M'              TO PB-BATCH-ENTRY
 14875                                    PB-I-ENTRY-STATUS
 14876        END-IF
 14877     END-IF
 14878     IF  PB-COMPANY-ID NOT = 'NCL'
 14879         GO TO 3999-END-EDIT.
 14880
 14881     IF PB-REISSUED-CERT  OR
 14882        PB-POLICY-IS-DECLINED  OR
 14883        PB-POLICY-IS-VOIDED  OR
 14884        PB-I-OB
 14885         GO TO 3999-END-EDIT.
 14886
 14887     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14888         MOVE  ER-2644            TO  WS-ERROR
 14889         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14890         GO TO 3999-END-EDIT.
 14891
 14892     MOVE 'N'                     TO  FORM-MASTER-SW.
 14893     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14894
 14895     IF NOT FORM-MASTER-FOUND
 14896         GO TO 3999-END-EDIT.
 14897
 14898     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14899                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 269
* EL050.cbl
 14900
 14901     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14902         MOVE  +1                 TO SUB6
 14903         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14904
 14905     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14906         MOVE  +1                 TO SUB6
 14907         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14908
 14909     IF LF-FORM-MASTER-FOUND  OR
 14910        AH-FORM-MASTER-FOUND
 14911         GO TO 3360-CHECK-FORM-LIMITS
 14912     ELSE
 14913         GO TO 3999-END-EDIT.
 14914
 14915******************************************************************
 14916*                  3350-GET-ERFORM                               *
 14917*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14918*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14919******************************************************************
 14920
 14921 3350-GET-ERFORM.
 14922
 14923     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14924         GO TO  3350-ERFORM-GETMAIN.
 14925
 14926     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14927     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14928     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14929     MOVE 'Y'                     TO FORM-MASTER-SW.
 14930
 14931     IF PB-CANCELLATION
 14932         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14933            PB-SV-STATE          EQUAL   FO-STATE       AND
 14934            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14935              GO TO 3350-EXIT
 14936         ELSE
 14937             NEXT SENTENCE
 14938     ELSE
 14939         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14940            PB-SV-STATE          EQUAL   FO-STATE       AND
 14941            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14942              GO TO 3350-EXIT.
 14943
 14944 3350-ERFORM-GETMAIN.
 14945
 14946     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14947     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14948
 14949 3350-ERFORM-READ.
 14950
 14951     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14952     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14953     IF PB-CANCELLATION
 14954         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14955     ELSE
 14956         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14957     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 270
* EL050.cbl
 14958
 14959     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14960
 14961     IF FORM-MASTER-FOUND
 14962       IF PB-CANCELLATION
 14963          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14964             PB-SV-STATE          EQUAL   FO-STATE       AND
 14965             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14966              GO  TO 3350-EXIT
 14967          ELSE
 14968              NEXT SENTENCE
 14969       ELSE
 14970          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14971             PB-SV-STATE          EQUAL   FO-STATE       AND
 14972             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14973              GO  TO 3350-EXIT.
 14974
 14975     MOVE  'N'                    TO  FORM-MASTER-SW.
 14976     MOVE  ER-1895                TO  WS-ERROR.
 14977     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14978
 14979 3350-EXIT.
 14980      EXIT.
 14981
 14982******************************************************************
 14983*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14984*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14985*   VALID FOR THE POLICY FORM USED.                              *
 14986******************************************************************
 14987
 14988 3355-EDIT-FORM-LF-BENEFITS.
 14989
 14990     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14991        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14992         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14993         GO TO   3355-EXIT.
 14994
 14995     IF  SUB6    LESS THAN   +40
 14996         ADD  +1      TO  SUB6
 14997         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14998
 14999     MOVE  ER-1896         TO  WS-ERROR.
 15000     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15001
 15002 3355-EXIT.
 15003      EXIT.
 15004
 15005******************************************************************
 15006*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15007*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15008*   VALID FOR THE POLICY FORM USED.                              *
 15009******************************************************************
 15010
 15011 3356-EDIT-FORM-AH-BENEFITS.
 15012
 15013     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15014        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15015         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 271
* EL050.cbl
 15016         GO TO  3356-EXIT.
 15017
 15018      IF  SUB6    LESS THAN     +40
 15019          ADD  +1      TO  SUB6
 15020          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15021
 15022     MOVE  ER-1897         TO  WS-ERROR.
 15023     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15024
 15025 3356-EXIT.
 15026      EXIT.
 15027
 15028******************************************************************
 15029*                  3357-BENEFIT-SEARCH                           *
 15030*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15031*   CANCELLATIONS ONLY.                                          *
 15032******************************************************************
 15033 3357-BENEFIT-SEARCH.
 15034     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15035         MOVE +1                          TO SUB6
 15036         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15037
 15038     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15039         MOVE +1                          TO SUB6
 15040         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15041
 15042 3357-EXIT.
 15043     EXIT.
 15044
 15045******************************************************************
 15046*                  3358-BENEFIT-LIFE-SEARCH                      *
 15047*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15048*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15049*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15050******************************************************************
 15051 3358-BENEFIT-LIFE-SEARCH.
 15052     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15053       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15054         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15055           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15056              IF FO-PLAN-REFUND-METHOD (SUB6)
 15057                     IS GREATER THAN SPACES
 15058                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15059                                          WS-LF-REFUND-CALC
 15060                 GO TO 3358-EXIT.
 15061
 15062     IF SUB6 LESS THAN +40
 15063         ADD +1                 TO SUB6
 15064         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15065
 15066 3358-EXIT.
 15067     EXIT.
 15068******************************************************************
 15069*                  3359-BENEFIT-AH-SEARCH                        *
 15070*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15071*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15072*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 272
* EL050.cbl
 15074 3359-BENEFIT-AH-SEARCH.
 15075     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15076       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15077         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15078           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15079              IF FO-PLAN-REFUND-METHOD (SUB6)
 15080                      IS GREATER THAN SPACES
 15081                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15082                                          WS-AH-REFUND-CALC
 15083                 GO TO 3359-EXIT.
 15084
 15085     IF SUB6 LESS THAN +40
 15086         ADD +1                 TO SUB6
 15087         GO TO 3359-BENEFIT-AH-SEARCH.
 15088
 15089 3359-EXIT.
 15090     EXIT.
 15091
 15092******************************************************************
 15093*                  3360-CHECK-FORM-LIMITS                        *
 15094*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15095*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15096******************************************************************
 15097
 15098 3360-CHECK-FORM-LIMITS.
 15099
 15100     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15101         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15102
 15103     IF NOT LF-FORM-MASTER-FOUND
 15104         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15105
 15106 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15107
 15108     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15109       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15110        WS-LF-JOINT-INDICATOR = 'J'  AND
 15111        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15112         IF PB-COMPANY-ID = 'NCL'
 15113            MOVE  ER-1911          TO  WS-ERROR
 15114            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15115         ELSE
 15116            MOVE  ER-1892          TO  WS-ERROR
 15117            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15118
 15119 3360-CHECK-FORM-LF-ATT-AGE.
 15120
 15121     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15122
 15123     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15124         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15125         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15126            IF PB-COMPANY-ID = 'NCL'
 15127                MOVE  ER-1913      TO  WS-ERROR
 15128                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15129            ELSE
 15130                MOVE  ER-1894      TO  WS-ERROR
 15131                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 273
* EL050.cbl
 15132
 15133 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15134
 15135     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15136         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15137         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15138            IF PB-COMPANY-ID = 'NCL'
 15139                MOVE  ER-1914      TO  WS-ERROR
 15140                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15141            ELSE
 15142                MOVE  ER-1899      TO  WS-ERROR
 15143                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15144
 15145 3360-CHECK-FORM-LF-TERM-BAMT.
 15146
 15147     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15148         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15149         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15150           IF  PB-COMPANY-ID = 'NCL'
 15151               MOVE  ER-1916       TO  WS-ERROR
 15152               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15153           ELSE
 15154               MOVE  ER-1902       TO  WS-ERROR
 15155               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15156
 15157     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15158                                    PB-I-LF-ALT-BENEFIT-AMT.
 15159
 15160     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15161         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15162         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15163             IF  PB-COMPANY-ID = 'NCL'
 15164                 MOVE  ER-1918     TO  WS-ERROR
 15165                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15166             ELSE
 15167                 MOVE  ER-1904     TO  WS-ERROR
 15168                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15169
 15170******************************************************************
 15171*                  3360-CHECK-FORM-AH-LIMITS                     *
 15172*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15173*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15174******************************************************************
 15175
 15176 3360-CHECK-FORM-AH-LIMITS.
 15177
 15178     IF NOT AH-FORM-MASTER-FOUND
 15179         GO TO 3999-END-EDIT.
 15180
 15181 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15182
 15183     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15184       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15185        WS-AH-JOINT-INDICATOR = 'J'  AND
 15186        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15187         IF PB-COMPANY-ID = 'NCL'
 15188            MOVE  ER-1912          TO  WS-ERROR
 15189            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 274
* EL050.cbl
 15190         ELSE
 15191            MOVE  ER-1893          TO  WS-ERROR
 15192            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15193
 15194 3360-CHECK-FORM-AH-ATT-AGE.
 15195
 15196     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15197
 15198     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15199         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15200         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15201            IF PB-COMPANY-ID = 'NCL'
 15202                MOVE  ER-1913      TO  WS-ERROR
 15203                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15204            ELSE
 15205                MOVE  ER-1894      TO  WS-ERROR
 15206                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15207
 15208 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15209
 15210     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15211         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15212         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15213            IF PB-COMPANY-ID = 'NCL'
 15214                MOVE  ER-1915      TO  WS-ERROR
 15215                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15216            ELSE
 15217                MOVE  ER-1900      TO  WS-ERROR
 15218                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15219
 15220 3360-CHECK-FORM-AH-TERM-BAMT.
 15221
 15222     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15223         FO-AH-MAX-TERM    GREATER THAN  +0
 15224         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15225             IF  PB-COMPANY-ID = 'NCL'
 15226                 MOVE  ER-1917     TO  WS-ERROR
 15227                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15228             ELSE
 15229                  MOVE  ER-1903    TO  WS-ERROR
 15230                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15231
 15232     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15233         FO-MAX-AH-AMT    GREATER THAN  +0
 15234         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15235             IF  PB-COMPANY-ID = 'NCL'
 15236                 MOVE  ER-1919     TO  WS-ERROR
 15237                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15238             ELSE
 15239                 MOVE  ER-1905     TO  WS-ERROR
 15240                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15241
 15242     GO TO 3999-END-EDIT.
 15243
 15244******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 275
* EL050.cbl
 15246******************************************************************
 15247*                  E D I T   C A N C E L                         *
 15248******************************************************************
 15249
 15250 3700-EDIT-CANCEL.
 15251     IF PB-COMPANY-ID = 'DMD'
 15252         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15253                                         WS-RES-MUNI-TAX
 15254                                         PB-CI-STATE-TAX
 15255                                         PB-CI-MUNI-TAX
 15256         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15257
 15258*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15259*       IF PB-ENTRY-BATCH  NUMERIC
 15260*          IF PB-CANCELLATION
 15261*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15262*          ELSE
 15263*             IF PB-ISSUE
 15264*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15265
 15266     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15267        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15268     END-IF
 15269*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15270*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15271
 15272     IF CM-ENTRY-STATUS = 'V'
 15273        MOVE ER-2780             TO WS-ERROR
 15274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15275        GO TO 3999-END-EDIT.
 15276
 15277     IF CM-ENTRY-STATUS = 'D'
 15278        MOVE ER-2781             TO WS-ERROR
 15279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15280        GO TO 3999-END-EDIT.
 15281
 15282     IF CM-ENTRY-STATUS = 'U'
 15283        MOVE ER-2782             TO WS-ERROR
 15284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15285
 15286***************************************************************
 15287*                                                             *
 15288*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15289*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15290*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15291*   OF ANOTHER COVERAGE.                                      *
 15292*                                                             *
 15293***************************************************************
 15294
 15295     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15296                                    PB-C-AH-CANCEL-VOID-SW.
 15297
 15298     IF PB-C-LF-CANCEL-AMT = ZERO
 15299        NEXT SENTENCE
 15300     ELSE
 15301        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15302           AND
 15303           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 276
* EL050.cbl
 15304               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15305               MOVE ER-2745           TO WS-ERROR
 15306               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15307
 15308     IF PB-C-AH-CANCEL-AMT = ZERO
 15309        NEXT SENTENCE
 15310     ELSE
 15311        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15312           AND
 15313           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15314               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15315               MOVE ER-2745           TO WS-ERROR
 15316               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15317
 15318     IF WS-LF-EARNINGS-CALC = '4'
 15319        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15320
 15321     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15322     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15323     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15324     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15325     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15326     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15327
 15328     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15329                                      PB-C-AH-REF-CALC.
 15330     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15331
 15332******************************************************************
 15333*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15334*             TO VALIDATE COVERAGE.                              *
 15335******************************************************************
 15336
 15337     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15338        PB-C-LF-CANCEL-AMT = ZEROS
 15339          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15340      ELSE
 15341          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15342
 15343     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15344        PB-C-AH-CANCEL-AMT = ZEROS
 15345          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15346      ELSE
 15347          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15348
 15349     EVALUATE TRUE
 15350         WHEN PB-CANCEL-FORCE             OR
 15351              PB-CANCEL-DATE-FORCED       OR
 15352              PB-FORCE-OFF
 15353                  IF PB-COMPANY-ID = 'ACE'
 15354                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15355                  END-IF
 15356         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15357               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15358              (PB-COMPANY-ID = 'ACE' )
 15359                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15360         WHEN OTHER
 15361              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 277
* EL050.cbl
 15362                 MOVE ER-2794              TO WS-ERROR
 15363              ELSE
 15364                 MOVE ER-2749              TO WS-ERROR
 15365              END-IF
 15366              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15367     END-EVALUATE.
 15368
 15369
 15370*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15371*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15372*            MOVE  ER-1909            TO  WS-ERROR
 15373*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15374*        ELSE
 15375*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15376
 15377     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15378     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15379        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15380     ELSE
 15381        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15382     END-IF
 15383     .
 15384 3705-EDIT-CANCEL-DT.
 15385
 15386     IF LF-COVERAGE-CANCELLED
 15387        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15388         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15389         MOVE WS-CURRENT-MONTH-END
 15390                                 TO DC-BIN-DATE-2
 15391         SET ELAPSED-BETWEEN-BIN TO TRUE
 15392*        MOVE 1                  TO DC-OPTION-CODE
 15393         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15394         IF DATE-CONVERSION-ERROR
 15395            NEXT SENTENCE
 15396          ELSE
 15397             IF DC-ELAPSED-DAYS GREATER +180
 15398                IF PB-CANCEL-DATE-FORCED  OR
 15399                   PB-CANCEL-DATE-FORCED-NO-FEE
 15400                      MOVE ER-2751  TO WS-ERROR
 15401                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15402                 ELSE
 15403                   MOVE ER-2752  TO WS-ERROR
 15404                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15405
 15406     IF AH-COVERAGE-CANCELLED
 15407        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15408         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15409         MOVE WS-CURRENT-MONTH-END
 15410                                 TO DC-BIN-DATE-2
 15411         SET ELAPSED-BETWEEN-BIN TO TRUE
 15412*        MOVE 1                  TO DC-OPTION-CODE
 15413         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15414         IF DATE-CONVERSION-ERROR
 15415            NEXT SENTENCE
 15416          ELSE
 15417             IF DC-ELAPSED-DAYS GREATER +180
 15418                IF PB-CANCEL-DATE-FORCED OR
 15419                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 278
* EL050.cbl
 15420                      MOVE ER-2751  TO WS-ERROR
 15421                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15422                 ELSE
 15423                   MOVE ER-2752  TO WS-ERROR
 15424                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15425
 15426     IF WS-ERROR = ER-2752
 15427        AND (PB-COMPANY-ID = 'ABL'
 15428         OR  PB-COMPANY-ID = 'FGL'
 15429         OR  PB-COMPANY-ID = 'IST'
 15430         OR  PB-COMPANY-ID = 'JHL'
 15431         OR  PB-COMPANY-ID = 'LAP'
 15432         OR  PB-COMPANY-ID = 'LBL'
 15433         OR  PB-COMPANY-ID = 'NCB'
 15434         OR  PB-COMPANY-ID = 'NLI'
 15435         OR  PB-COMPANY-ID = 'OFI'
 15436         OR  PB-COMPANY-ID = 'PLI'
 15437         OR  PB-COMPANY-ID = 'TAO'
 15438         OR  PB-COMPANY-ID = 'TIC'
 15439         OR  PB-COMPANY-ID = 'HER'
 15440         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15441         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15442            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15443            MOVE ER-2762     TO WS-ERROR
 15444            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15445
 15446     IF LF-COVERAGE-CANCELLED
 15447        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15448        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15449             MOVE ER-2733         TO WS-ERROR
 15450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15451
 15452     IF AH-COVERAGE-CANCELLED
 15453        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15454        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15455              MOVE ER-2733        TO WS-ERROR
 15456              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15457
 15458     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15459        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15460        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15461           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15462            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15463              IF PB-COMPANY-ID NOT = 'LAP'
 15464               MOVE ER-2704            TO WS-ERROR
 15465               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15466
 15467     IF CERT-WAS-NOT-FOUND
 15468         GO TO 3999-END-EDIT.
 15469
 15470     IF PB-COMPANY-ID EQUAL 'CDC'
 15471        IF LF-COVERAGE-CANCELLED
 15472           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15473            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15474            MOVE PB-C-LF-CANCEL-DT
 15475                                 TO DC-BIN-DATE-2
 15476            SET ELAPSED-BETWEEN-BIN TO TRUE
 15477*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 279
* EL050.cbl
 15478            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15479            IF DATE-CONVERSION-ERROR
 15480               NEXT SENTENCE
 15481             ELSE
 15482                IF DC-ELAPSED-DAYS GREATER +60
 15483                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15484
 15485     IF PB-COMPANY-ID EQUAL 'CDC'
 15486        IF AH-COVERAGE-CANCELLED
 15487           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15488            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15489            MOVE PB-C-AH-CANCEL-DT
 15490                                 TO DC-BIN-DATE-2
 15491            MOVE +0              TO DC-ELAPSED-DAYS
 15492                                    DC-ELAPSED-MONTHS
 15493            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15494*           MOVE 1               TO DC-OPTION-CODE
 15495            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15496            IF DATE-CONVERSION-ERROR
 15497               NEXT SENTENCE
 15498             ELSE
 15499                IF DC-ELAPSED-DAYS GREATER +60
 15500                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15501
 15502     MOVE +0                     TO DC-ELAPSED-DAYS
 15503                                    DC-ELAPSED-MONTHS.
 15504
 15505     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15506        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15507          MOVE 'Z'                TO PB-CI-OB-FLAG
 15508          MOVE ER-2767            TO WS-ERROR
 15509          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15510          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15511          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15512          GO TO 3775-OVER-REF-CHK
 15513        ELSE
 15514          MOVE ZEROS              TO PB-CI-LIVES
 15515                                     PB-C-LIVES
 15516          IF PB-CI-OB-FLAG NOT = 'B'
 15517             MOVE SPACE           TO PB-CI-OB-FLAG.
 15518
 15519     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15520         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15521     ELSE
 15522         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15523
 15524     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15525        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15526            MOVE ER-2760         TO WS-ERROR
 15527            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15528
 15529     IF LF-COVERAGE-CANCELLED
 15530        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15531         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15532            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15533               MOVE ER-2774       TO WS-ERROR
 15534               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15535
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 280
* EL050.cbl
 15536     IF AH-COVERAGE-CANCELLED
 15537        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15538         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15539            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15540               MOVE ER-2775       TO WS-ERROR
 15541               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15542
 15543     IF LF-COVERAGE-CANCELLED
 15544        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15545         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15546            MOVE ER-2776         TO WS-ERROR
 15547            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15548
 15549     IF AH-COVERAGE-CANCELLED
 15550        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15551         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15552            MOVE ER-2777         TO WS-ERROR
 15553            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15554
 15555     IF LF-COVERAGE-CANCELLED
 15556        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15557        if pb-ci-lf-expire-dt = low-values or spaces
 15558           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15559           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15560           MOVE PB-CI-EXTENTION-DAYS
 15561                                 TO DC-ELAPSED-DAYS
 15562           SET BIN-PLUS-ELAPSED  TO TRUE
 15563           PERFORM 8500-DATE-CONVERT
 15564                                 THRU 8500-EXIT
 15565           IF DATE-CONVERSION-ERROR
 15566              move low-values    to dc-bin-date-2
 15567           end-if
 15568        else
 15569           move pb-ci-lf-expire-dt
 15570                                 to dc-bin-date-2
 15571        end-if
 15572        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15573           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15574                             OR  'FIA'
 15575              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15576           ELSE
 15577              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15578              MOVE ER-2731       TO WS-ERROR
 15579              PERFORM 9900-ERROR-FORMAT
 15580                                 THRU 9900-EXIT
 15581           end-if
 15582        end-if
 15583     end-if
 15584*    IF LF-COVERAGE-CANCELLED
 15585*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15586*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15587*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15588*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15589*        SET BIN-PLUS-ELAPSED      TO TRUE
 15590*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15591*        IF DATE-CONVERSION-ERROR
 15592*           NEXT SENTENCE
 15593*         ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 281
* EL050.cbl
 15594*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15595*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15596*                            OR  'FIA'
 15597*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15598*              ELSE
 15599*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15600*               MOVE ER-2731       TO WS-ERROR
 15601*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15602     .
 15603 3705-EDIT-AH-CANCEL-DT.
 15604     IF AH-COVERAGE-CANCELLED
 15605        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15606        if pb-ci-AH-expire-dt = low-values or spaces
 15607           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15608           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15609           MOVE PB-CI-EXTENTION-DAYS
 15610                                 TO DC-ELAPSED-DAYS
 15611           SET BIN-PLUS-ELAPSED  TO TRUE
 15612           PERFORM 8500-DATE-CONVERT
 15613                                 THRU 8500-EXIT
 15614           IF DATE-CONVERSION-ERROR
 15615              move low-values    to dc-bin-date-2
 15616           end-if
 15617        else
 15618           move pb-ci-ah-expire-dt
 15619                                 to dc-bin-date-2
 15620        end-if
 15621        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15622           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15623                             OR  'FIA'
 15624              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15625           ELSE
 15626              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15627              MOVE ER-2771       TO WS-ERROR
 15628              PERFORM 9900-ERROR-FORMAT
 15629                                 THRU 9900-EXIT
 15630           end-if
 15631        end-if
 15632     end-if
 15633*    IF AH-COVERAGE-CANCELLED
 15634*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15635*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15636*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15637*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15638**       MOVE 6                    TO DC-OPTION-CODE
 15639*        SET BIN-PLUS-ELAPSED      TO TRUE
 15640*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15641*        IF DATE-CONVERSION-ERROR
 15642*           NEXT SENTENCE
 15643*         ELSE
 15644*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15645*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15646*                             OR 'FIA'
 15647*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15648*             ELSE
 15649*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15650*              MOVE ER-2771       TO WS-ERROR
 15651*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 282
* EL050.cbl
 15652     .
 15653 3705-EDIT-CONTINUED.
 15654
 15655*    IF LF-COVERAGE-CANCELLED
 15656*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15657*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15658*            MOVE ER-2727         TO WS-ERROR
 15659*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15660*
 15661*    IF AH-COVERAGE-CANCELLED
 15662*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15663*        IF PB-COMPANY-ID = 'ACE'
 15664*           MOVE ER-2727        TO WS-ERROR
 15665*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15666*        ELSE
 15667*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15668*              MOVE ER-2727     TO WS-ERROR
 15669*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670
 15671     IF PB-COMPANY-ID = 'ACE'
 15672       IF AH-COVERAGE-CANCELLED
 15673         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15674           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15675              MOVE ER-2732      TO WS-ERROR
 15676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15677
 15678     IF PB-COMPANY-ID      EQUAL   'HER'
 15679        IF WS-ERROR        EQUAL   ER-2727
 15680            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15681            MOVE  ER-2725          TO  WS-ERROR
 15682            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15683
 15684     IF PB-C-CLAIM-CREATED-CANCEL
 15685            MOVE ER-2748         TO WS-ERROR
 15686            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15687
 15688     IF PB-C-LAST-NAME NOT = SPACES
 15689         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15690            MOVE ER-2747         TO WS-ERROR
 15691            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15692
 15693 3710-EDIT-LUMP-SUM-PRIOR.
 15694
 15695     IF AH-COVERAGE-CANCELLED
 15696         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15697             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15698                MOVE ER-2735    TO WS-ERROR
 15699                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15700
 15701     IF LF-COVERAGE-CANCELLED
 15702         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15703             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15704                MOVE ER-2735    TO WS-ERROR
 15705                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15706
 15707 3710-EDIT-PRIOR-DEATH.
 15708
 15709*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 283
* EL050.cbl
 15710*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15711*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15712*           (NOT PB-CI-OB)
 15713*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15714*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15715*                   MOVE ER-2732  TO WS-ERROR
 15716*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15717*
 15718*    IF AH-COVERAGE-CANCELLED
 15719*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15720*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15721*           (NOT PB-CI-OB)
 15722*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15723*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15724*                   MOVE ER-2732  TO WS-ERROR
 15725*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15726
 15727     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15728         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15729            (NOT PB-COMP-LF-CANCEL)
 15730             NEXT SENTENCE
 15731         ELSE
 15732           IF PB-C-LF-CANCEL-VOIDED
 15733              NEXT SENTENCE
 15734           ELSE
 15735              MOVE ER-2753      TO WS-ERROR
 15736              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15737
 15738     IF CANCEL-FUTURE-DT
 15739         GO TO 3999-END-EDIT.
 15740
 15741 3715-GET-REMAIN-TERM-LF.
 15742
 15743     IF NO-LF-BENEFIT-MATCH  OR
 15744        WS-LF-BENEFIT-CD = ZEROS
 15745        GO TO 3730-GET-AH-REMAIN-TERM.
 15746
 15747     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15748     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15749     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15750     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15751     MOVE PB-SV-STATE            TO CP-STATE.
 15752     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15753     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15754     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15755     MOVE '2'                    TO CP-PROCESS-TYPE.
 15756     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15757     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15758     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15759     IF (PB-COMPANY-ID = 'CID')
 15760        AND (CP-STATE-STD-ABBRV = 'WI')
 15761        MOVE '7'                 TO CP-REM-TERM-METHOD
 15762        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15763     ELSE
 15764        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15765        MOVE WS-REM-TRM-CALC-OPTION
 15766                                 TO CP-REM-TRM-CALC-OPTION
 15767     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 284
* EL050.cbl
 15768**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15769     IF (PB-COMPANY-ID = 'CID')
 15770        AND (CP-STATE-STD-ABBRV = 'MO')
 15771        AND (PB-CERT-EFF-DT >= X'9B41')
 15772        AND (PB-CERT-EFF-DT <= X'A2FB')
 15773        MOVE '7'                 TO CP-REM-TERM-METHOD
 15774        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15775     END-IF
 15776     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15777                                    CP-LOAN-TERM.
 15778     IF CP-TRUNCATED-LIFE
 15779        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15780
 15781     IF CP-TERM-IS-DAYS
 15782         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15783     ELSE
 15784         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15785
 15786     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15787
 15788     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15789
 15790     IF LF-COVERAGE-CANCELLED
 15791        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15792        NEXT SENTENCE
 15793      ELSE
 15794          GO TO 3730-GET-AH-REMAIN-TERM.
 15795
 15796 3720-GET-LF-REFUND.
 15797
 15798     IF PB-C-LF-CANCEL-VOIDED OR
 15799        PB-C-AH-CANCEL-VOIDED
 15800        GO TO 3780-UPDATE-CANCEL-CERT.
 15801
 15802     IF PB-COMPANY-ID EQUAL 'BOA'
 15803         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15804         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15805         GO TO 3730-GET-AH-REMAIN-TERM.
 15806
 15807     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15808        (WS-AH-SPECIAL-CALC-CD = 'M')
 15809         MOVE ER-2767            TO WS-ERROR
 15810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15811         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15812         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15813         GO TO 3780-UPDATE-CANCEL-CERT.
 15814
 15815*    if (ws-lf-earnings-calc = '6')
 15816*       or (pb-c-lf-refund-override = '6')
 15817*       move cp-remaining-term-1 to cp-remaining-term-2
 15818*    end-if
 15819     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15820
 15821     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15822     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15823     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15824     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15825     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 285
* EL050.cbl
 15826     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15827     IF (PB-COMPANY-ID = 'DCC')
 15828        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15829        IF PDEF-MASTER-FOUND
 15830           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15831              (V1 > +8)
 15832              OR (PD-PROD-CODE (V1) = 'L')
 15833           END-PERFORM
 15834           IF V1 < +9
 15835              MOVE PD-MAX-AMT (V1)
 15836                           TO CP-R-MAX-TOT-BEN
 15837                              EC-AM-LF-MAX-TOT-BEN
 15838           END-IF
 15839        ELSE
 15840        MOVE ' '                 TO PDEF-MASTER-SW
 15841        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15842        MOVE PB-STATE            TO ERPDEF-STATE
 15843        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15844        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15845        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15846        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15847        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15848        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15849        IF PDEF-MASTER-FOUND
 15850           MOVE 'N'              TO PDEF-MASTER-SW
 15851           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15852           IF PDEF-MASTER-FOUND
 15853              IF (ERPDEF-KEY-SAVE (1:16) =
 15854                           PD-CONTROL-PRIMARY (1:16))
 15855                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15856                 CONTINUE
 15857              ELSE
 15858                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15859                 IF (ERPDEF-KEY-SAVE (1:16) =
 15860                           PD-CONTROL-PRIMARY (1:16))
 15861                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15862                    CONTINUE
 15863                 ELSE
 15864                    MOVE 'N'     TO PDEF-MASTER-SW
 15865                 END-IF
 15866              END-IF
 15867              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15868
 15869              IF PDEF-MASTER-FOUND
 15870                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15871                    (V1 > +8)
 15872                    OR (PD-PROD-CODE (V1) = 'L')
 15873                 END-PERFORM
 15874                 IF V1 < +9
 15875                    MOVE PD-MAX-AMT (V1)
 15876                                 TO CP-R-MAX-TOT-BEN
 15877                                    EC-AM-LF-MAX-TOT-BEN
 15878                 END-IF
 15879              END-IF
 15880           END-IF
 15881           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15882        END-IF
 15883        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 286
* EL050.cbl
 15884     END-IF
 15885     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15886
 15887     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15888
 15889     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15890                                    PB-C-LF-REM-TERM.
 15891
 15892     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15893     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15894
 15895     IF PB-COMPANY-ID EQUAL 'FLC'
 15896        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15897           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15898           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15899                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15900                    - CM-LF-ITD-DEATH-AMT
 15901           IF PB-C-LF-REF-CALC LESS THAN +0
 15902              MOVE +0            TO PB-C-LF-REF-CALC
 15903              GO TO 3730-GET-AH-REMAIN-TERM
 15904           ELSE
 15905              GO TO 3730-GET-AH-REMAIN-TERM.
 15906
 15907     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15908                            OR '4' OR '5' OR '6' OR '8'
 15909                            OR '9' OR 'G'
 15910        MOVE PB-C-LF-REFUND-OVERRIDE
 15911                                 TO CP-EARNING-METHOD.
 15912
 15913     if pb-company-id = 'AHL'
 15914        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15915        if cp-class-code = spaces
 15916           move zeros            to cp-class-code
 15917        end-if
 15918     ELSE
 15919        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15920     END-IF
 15921*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15922     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15923     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15924                                    CP-RATING-BENEFIT-AMT.
 15925     IF CP-STATE-STD-ABBRV = 'OR'
 15926         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15927                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15928     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15929     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15930     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15931     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15932     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15933     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15934     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15935     IF WS-DEFAULT-APR NOT NUMERIC
 15936         MOVE ZEROS TO WS-DEFAULT-APR.
 15937****   N O T E   ****
 15938*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15939*      THE OH HARD CODING IN ELCRFNDP
 15940
 15941     IF PB-COMPANY-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 287
* EL050.cbl
 15942        IF CP-STATE-STD-ABBRV = 'OH'
 15943           MOVE WS-LF-EARNINGS-CALC
 15944                                 TO CP-EARNING-METHOD
 15945        END-IF
 15946     END-IF
 15947
 15948****   N O T E   ****
 15949
 15950     IF CP-EARN-AS-NET-PAY
 15951         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15952            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15953                MOVE WS-DEFAULT-APR
 15954                                 TO  CP-LOAN-APR
 15955                MOVE ER-3780     TO  WS-ERROR
 15956                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15957            ELSE
 15958                MOVE ER-3781     TO  WS-ERROR
 15959                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15960*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15961     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15962
 15963     IF CP-REFUND-TYPE-USED NOT = SPACE
 15964         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15965
 15966     IF CP-ERROR-RATE-IS-ZERO OR
 15967        CP-ERROR-RATE-NOT-FOUND
 15968        MOVE ER-2740             TO WS-ERROR
 15969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970
 15971     IF CP-ERROR-RATE-FILE-NOTOPEN
 15972        MOVE ER-2617             TO WS-ERROR
 15973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15974
 15975     IF PB-COMPANY-ID = 'DCC'
 15976        AND PB-CI-ENTRY-STATUS = 'M'
 15977        MOVE +0                  TO PB-C-LF-REF-CALC
 15978     ELSE
 15979        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15980     END-IF
 15981
 15982     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15983         GO TO 3730-GET-AH-REMAIN-TERM.
 15984
 15985*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15986*       ADD +1                   TO PB-C-LF-REM-TERM
 15987*                                   CP-REMAINING-TERM
 15988*                                   CP-ORIGINAL-TERM.
 15989
 15990     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15991     MOVE '2'                    TO CP-EARNING-METHOD
 15992                                    CP-RATING-METHOD.
 15993     IF PB-COMPANY-ID = 'CID'
 15994        IF (CP-STATE-STD-ABBRV = 'MN')
 15995           AND (PB-CERT-EFF-DT > X'A4FF')
 15996           AND (WS-LF-EARNINGS-CALC = 'B')
 15997           MOVE '5'              TO CP-EARNING-METHOD
 15998           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15999        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 288
* EL050.cbl
 16000     END-IF
 16001     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16002                                        CP-REMAINING-BENEFIT
 16003                                        CP-RATING-BENEFIT-AMT.
 16004     IF CP-STATE-STD-ABBRV = 'OR'
 16005         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16006                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16007     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16008     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16009
 16010     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16011
 16012     IF CP-ERROR-RATE-IS-ZERO OR
 16013        CP-ERROR-RATE-NOT-FOUND
 16014        MOVE ER-2740             TO WS-ERROR
 16015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16016
 16017     IF CP-ERROR-RATE-FILE-NOTOPEN
 16018        MOVE ER-2617             TO WS-ERROR
 16019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16020
 16021     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16022
 16023******************************************************************
 16024
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 289
* EL050.cbl
 16026 3730-GET-AH-REMAIN-TERM.
 16027     IF NO-AH-BENEFIT-MATCH  OR
 16028        WS-AH-BENEFIT-CD = ZEROS
 16029         GO TO 3770-CHECK-REFUNDS.
 16030
 16031     IF PB-CI-AH-LUMP-SUM-DISAB
 16032         IF  PB-C-AH-CANCEL-AMT = ZERO
 16033            IF NOT PB-COMP-AH-CANCEL
 16034             GO TO 3770-CHECK-REFUNDS.
 16035
 16036     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16037     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16038     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16039     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16040     MOVE PB-SV-STATE            TO CP-STATE.
 16041     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16042     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16043     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16044     MOVE '2'                    TO CP-PROCESS-TYPE.
 16045     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16046     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16047     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16048     IF (PB-COMPANY-ID = 'CID')
 16049        AND (CP-STATE-STD-ABBRV = 'WI')
 16050        MOVE '7'                 TO CP-REM-TERM-METHOD
 16051        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16052     ELSE
 16053        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16054        MOVE WS-REM-TRM-CALC-OPTION
 16055                                 TO CP-REM-TRM-CALC-OPTION
 16056     END-IF
 16057     IF (PB-COMPANY-ID = 'CID')
 16058        AND (CP-STATE-STD-ABBRV = 'MO')
 16059        AND (PB-CERT-EFF-DT >= X'9B41')
 16060        AND (PB-CERT-EFF-DT <= X'A2FB')
 16061        MOVE '7'                 TO CP-REM-TERM-METHOD
 16062        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16063     END-IF
 16064     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16065                                    CP-LOAN-TERM.
 16066     IF NOT CP-TERM-IS-DAYS
 16067         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16068
 16069     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16070
 16071     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16072
 16073     IF AH-COVERAGE-CANCELLED
 16074        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16075        NEXT SENTENCE
 16076      ELSE
 16077         GO TO 3770-CHECK-REFUNDS.
 16078
 16079 3740-GET-AH-REFUND.
 16080
 16081     IF PB-C-LF-CANCEL-VOIDED OR
 16082        PB-C-AH-CANCEL-VOIDED
 16083        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 290
* EL050.cbl
 16084
 16085     IF PB-COMPANY-ID = 'BOA'
 16086         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16087         GO TO 3770-CHECK-REFUNDS.
 16088
 16089     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16090*    MOVE ' '                    TO DC-OPTION-CODE
 16091     SET BIN-TO-GREG             TO TRUE
 16092     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16093     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16094                                    PB-C-AH-REM-TERM.
 16095     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16096     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16097
 16098     IF PB-COMPANY-ID EQUAL 'FLC'
 16099        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16100           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16101           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16102                    - CM-AH-ITD-AH-PMT)
 16103           IF PB-C-AH-REF-CALC LESS THAN +0
 16104              MOVE +0            TO PB-C-AH-REF-CALC
 16105              GO TO 3770-CHECK-REFUNDS
 16106           ELSE
 16107              GO TO 3770-CHECK-REFUNDS.
 16108
 16109     IF PB-COMPANY-ID = 'DCC'
 16110        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16111            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16112           MOVE 'S'              TO CP-EARNING-METHOD
 16113        END-IF
 16114     END-IF
 16115     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16116                            OR '4' OR '5' OR '6' OR '8'
 16117                            OR '9' OR 'G' OR 'S'
 16118        MOVE PB-C-AH-REFUND-OVERRIDE
 16119                                 TO CP-EARNING-METHOD.
 16120
 16121     if pb-company-id = 'AHL'
 16122        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16123        if cp-class-code = spaces
 16124           move zeros            to cp-class-code
 16125        end-if
 16126     ELSE
 16127        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16128     END-IF
 16129*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16130     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16131     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16132                                    CP-RATING-BENEFIT-AMT.
 16133     IF CP-STATE-STD-ABBRV = 'OR'
 16134         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16135                                         PB-CI-AH-TERM.
 16136     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16137     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16138     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16139     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16140     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16141     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 291
* EL050.cbl
 16142
 16143     IF CP-STATE-STD-ABBRV = 'OH'
 16144        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16145                                AND 'CID' AND 'DCC' AND 'AHL')
 16146           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16147              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16148              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16149              MOVE '6' TO CP-EARNING-METHOD
 16150           END-IF
 16151        END-IF
 16152        IF PB-COMPANY-ID = 'CID'
 16153           IF NO-LIFE-COVERAGE
 16154              IF CP-CRITICAL-PERIOD
 16155                 MOVE '2'       TO CP-EARNING-METHOD
 16156              ELSE
 16157                 MOVE '6'       TO CP-EARNING-METHOD
 16158              END-IF
 16159           ELSE
 16160              IF WS-LF-COVERAGE-TYPE = 'L'
 16161                 MOVE '2'       TO CP-EARNING-METHOD
 16162              ELSE
 16163                 IF (PB-CI-LF-TERM > +60) OR
 16164                    (WS-LF-EARNINGS-CALC = '5')
 16165                    IF CP-CRITICAL-PERIOD
 16166                       MOVE '2'  TO CP-EARNING-METHOD
 16167                    ELSE
 16168                       MOVE '6'  TO CP-EARNING-METHOD
 16169                    END-IF
 16170                 ELSE
 16171                    MOVE '1'     TO CP-EARNING-METHOD
 16172                 END-IF
 16173              END-IF
 16174           END-IF
 16175        END-IF
 16176     END-IF
 16177
 16178*    IF CP-STATE-STD-ABBRV = 'VA'
 16179*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16180*          IF CP-ORIGINAL-TERM GREATER 61
 16181*             MOVE '6' TO CP-EARNING-METHOD
 16182*          ELSE
 16183*             MOVE '1' TO CP-EARNING-METHOD.
 16184
 16185     IF WS-DEFAULT-APR NOT NUMERIC
 16186         MOVE ZEROS TO WS-DEFAULT-APR.
 16187     IF CP-EARN-AS-NET-PAY
 16188         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16189            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16190                MOVE WS-DEFAULT-APR
 16191                                 TO  CP-LOAN-APR
 16192                MOVE ER-3780     TO  WS-ERROR
 16193                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16194            ELSE
 16195                MOVE ER-3781     TO  WS-ERROR
 16196                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16197     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16198     IF PB-COMPANY-ID = 'DCC'
 16199        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 292
* EL050.cbl
 16200        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16201        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16202     END-IF
 16203     IF PB-COMPANY-ID = 'DCC'
 16204        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16205        AND (CP-EARNING-METHOD = 'D')
 16206        AND (CP-CANCEL-REASON NOT = 'R')
 16207        CONTINUE
 16208     ELSE
 16209        GO TO 3750-CONTINUE
 16210     END-IF
 16211     MOVE ' '                    TO DD-IU-SW
 16212     IF NOT PDEF-MASTER-FOUND
 16213        MOVE ' '                 TO PDEF-MASTER-SW
 16214        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16215        MOVE PB-STATE            TO ERPDEF-STATE
 16216        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16217        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16218        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16219        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16220        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16221        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16222        IF PDEF-MASTER-FOUND
 16223           MOVE 'N'              TO PDEF-MASTER-SW
 16224           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16225           IF PDEF-MASTER-FOUND
 16226              IF (ERPDEF-KEY-SAVE (1:16) =
 16227                           PD-CONTROL-PRIMARY (1:16))
 16228                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16229                 CONTINUE
 16230              ELSE
 16231                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16232                 IF (ERPDEF-KEY-SAVE (1:16) =
 16233                           PD-CONTROL-PRIMARY (1:16))
 16234                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16235                    CONTINUE
 16236                 ELSE
 16237                    MOVE ER-2740 TO WS-ERROR
 16238                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16239                    GO TO 3770-CHECK-REFUNDS
 16240                 END-IF
 16241              END-IF
 16242           END-IF
 16243           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16244        END-IF
 16245     END-IF
 16246     IF PDEF-MASTER-FOUND
 16247        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16248           (V1 > +8)
 16249           OR (PD-PROD-CODE (V1) = 'I')
 16250        END-PERFORM
 16251        IF V1 < +9
 16252           SET DD-IU-PRESENT        TO TRUE
 16253        END-IF
 16254        IF WS-AH-DCC-TRUNC = 'T'
 16255           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16256        ELSE
 16257           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 293
* EL050.cbl
 16258        END-IF
 16259        EVALUATE TRUE
 16260           WHEN WS-TERM > +168
 16261              MOVE 15               TO V1
 16262           WHEN WS-TERM > +156
 16263              MOVE 14               TO V1
 16264           WHEN WS-TERM > +144
 16265              MOVE 13               TO V1
 16266           WHEN WS-TERM > +132
 16267              MOVE 12               TO V1
 16268           WHEN WS-TERM > +120
 16269              MOVE 11               TO V1
 16270           WHEN WS-TERM > +108
 16271              MOVE 10               TO V1
 16272           WHEN WS-TERM > +96
 16273              MOVE 9                TO V1
 16274           WHEN WS-TERM > +84
 16275              MOVE 8                TO V1
 16276           WHEN WS-TERM > +72
 16277              MOVE 7                TO V1
 16278           WHEN WS-TERM > +60
 16279              MOVE 6                TO V1
 16280           WHEN WS-TERM > +48
 16281              MOVE 5                TO V1
 16282           WHEN WS-TERM > +36
 16283              MOVE 4                TO V1
 16284           WHEN WS-TERM > +24
 16285              MOVE 3                TO V1
 16286           WHEN WS-TERM > +12
 16287              MOVE 2                TO V1
 16288           WHEN OTHER
 16289              MOVE 1                TO V1
 16290        END-EVALUATE
 16291
 16292        EVALUATE TRUE
 16293*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16294*             < +13)
 16295*             AND (DD-IU-PRESENT)
 16296*             MOVE 2                TO V2
 16297*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16298*             MOVE 1                TO V2
 16299           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16300              MOVE 2                TO V2
 16301           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16302              MOVE 3                TO V2
 16303           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16304              MOVE 4                TO V2
 16305           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16306              MOVE 5                TO V2
 16307           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16308              MOVE 6                TO V2
 16309           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16310              MOVE 7                TO V2
 16311           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16312              MOVE 8                TO V2
 16313           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16314              MOVE 9                TO V2
 16315           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 294
* EL050.cbl
 16316              MOVE 10               TO V2
 16317           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16318              MOVE 11               TO V2
 16319           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16320              MOVE 12               TO V2
 16321           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16322              MOVE 13               TO V2
 16323           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16324              MOVE 14               TO V2
 16325           WHEN OTHER
 16326              MOVE 15               TO V2
 16327        END-EVALUATE
 16328
 16329        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16330                                 TO CP-DDF-LO-FACT
 16331        MOVE PD-UEP-FACTOR (V1 V2)
 16332                                 TO CP-DDF-HI-FACT
 16333
 16334        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16335        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16336        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16337           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16338        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16339        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16340        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16341           + PD-1ST-YR-ADMIN-ALLOW
 16342
 16343        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16344*       IF PI-CLP-YN = 'Y'
 16345*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16346*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16347*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16348*       END-IF
 16349
 16350        IF DD-IU-PRESENT
 16351           MOVE 'I'              TO CP-EARNING-METHOD
 16352        END-IF
 16353        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16354                                     CP-CLP-RATE-UP
 16355        IF CP-IU-RATE-UP NOT = ZEROS
 16356           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16357              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16358           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16359              / (1 - WS-WORK-FACT)
 16360        END-IF
 16361     END-IF
 16362     .
 16363 3750-CONTINUE.
 16364     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16365
 16366     IF CP-REFUND-TYPE-USED NOT = SPACE
 16367         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16368
 16369     IF CP-ERROR-RATE-IS-ZERO OR
 16370        CP-ERROR-RATE-NOT-FOUND
 16371        MOVE ER-2740             TO WS-ERROR
 16372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16373
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 295
* EL050.cbl
 16374     IF CP-ERROR-RATE-FILE-NOTOPEN
 16375        MOVE ER-2617             TO WS-ERROR
 16376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16377     IF PB-COMPANY-ID = 'DCC'
 16378        AND PB-CI-ENTRY-STATUS = 'M'
 16379        MOVE +0                  TO PB-C-AH-REF-CALC
 16380     ELSE
 16381        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16382     END-IF
 16383     IF PB-COMPANY-ID = 'DCC'
 16384        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16385        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16386        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16387        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16388        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16389        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16390        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16391        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16392        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16393     END-IF
 16394     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 296
* EL050.cbl
 16396
 16397 3770-CHECK-REFUNDS.
 16398
 16399     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16400        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16401           MOVE ER-2766          TO WS-ERROR
 16402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16403           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16404           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16405              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16406
 16407     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16408        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16409           MOVE ER-2766          TO WS-ERROR
 16410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16411           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16412           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16413              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16414
 16415     IF PB-COMP-LF-CANCEL
 16416        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16417        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16418           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16419              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16420
 16421     IF PB-COMP-AH-CANCEL
 16422        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16423        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16424           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16425              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16426
 16427     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16428             GIVING WS-UNSIGN-WRK1
 16429     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16430             GIVING WS-UNSIGN-WRK2.
 16431
 16432     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16433         MOVE ZERO TO WS-UNSIGN-WRK1.
 16434
 16435     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16436         MOVE ZERO TO WS-UNSIGN-WRK2.
 16437
 16438     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16439
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 297
* EL050.cbl
 16441
 16442 3772-CONTINUE.
 16443
 16444**********************************
 16445*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16446*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16447*** DOUBLES THE TOLERANCE AMOUNT.
 16448***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16449**********************************
 16450     IF PB-COMPANY-ID = 'MON'
 16451     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16452         IF WS-REF-REJECT-SW = SPACE
 16453             MOVE ER-2754        TO WS-ERROR
 16454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16455           ELSE
 16456             MOVE ER-2736        TO WS-ERROR
 16457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16458**********************************
 16459
 16460 3773-CONTINUE.
 16461
 16462     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16463        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16464           MOVE ER-2723          TO WS-ERROR
 16465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16466
 16467     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16468        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16469           MOVE ER-2724          TO WS-ERROR
 16470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16471
 16472     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16473         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16474             (1 + WS-LF-REFUND-OVS-PCT)
 16475     ELSE
 16476         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16477
 16478     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16479         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16480             (1 - WS-TOL-LF-REFUND-PCT)
 16481     ELSE
 16482         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16483
 16484     IF (PB-COMPANY-ID = 'DCC')
 16485        AND (PB-CI-ENTRY-STATUS = 'M')
 16486        AND (PB-C-LF-CANCEL-AMT > +0)
 16487        MOVE ER-3843             TO WS-ERROR
 16488        PERFORM 9900-ERROR-FORMAT
 16489                                 THRU 9900-EXIT
 16490     END-IF
 16491     EVALUATE TRUE
 16492        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16493           CONTINUE
 16494        WHEN PB-C-LF-CANCEL-AMT = +0
 16495                 AND PB-C-LF-REF-CALC > +0
 16496           CONTINUE
 16497        WHEN WS-LF-REFUND-OVS-AMT = 0
 16498                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 298
* EL050.cbl
 16499           CONTINUE
 16500        WHEN OTHER
 16501           IF WS-TOL-LF-REFUND  = +0
 16502              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16503           END-IF
 16504           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16505                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16506                          (PB-C-LF-CANCEL-AMT))
 16507              CONTINUE
 16508           ELSE
 16509              IF WS-LF-REFUND-OVS-AMT = +0
 16510                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16511              END-IF
 16512              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16513                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16514                                       PB-C-LF-CANCEL-AMT)
 16515                 CONTINUE
 16516              ELSE
 16517                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16518                   MOVE ER-2754   TO  WS-ERROR
 16519                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16520                 ELSE
 16521                    MOVE ER-2736   TO  WS-ERROR
 16522                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16523                 END-IF
 16524              END-IF
 16525           END-IF
 16526     END-EVALUATE.
 16527
 16528     EVALUATE TRUE
 16529        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16530           CONTINUE
 16531        WHEN PB-C-LF-CANCEL-AMT = +0
 16532                 AND PB-C-LF-REF-CALC > +0
 16533           CONTINUE
 16534        WHEN OTHER
 16535           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16536               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16537              CONTINUE
 16538           ELSE
 16539              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16540               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16541                CONTINUE
 16542              ELSE
 16543                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16544                     MOVE ER-2754   TO  WS-ERROR
 16545                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16546                 ELSE
 16547                     MOVE ER-2736   TO  WS-ERROR
 16548                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16549                 END-IF
 16550              END-IF
 16551           END-IF
 16552     END-EVALUATE.
 16553
 16554     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16555         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16556             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 299
* EL050.cbl
 16557     ELSE
 16558         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16559
 16560     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16561         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16562             (1 - WS-TOL-AH-REFUND-PCT)
 16563     ELSE
 16564         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16565
 16566     IF (PB-COMPANY-ID = 'DCC')
 16567        AND (PB-CI-ENTRY-STATUS = 'M')
 16568        AND (PB-C-AH-CANCEL-AMT > +0)
 16569        MOVE ER-3843             TO WS-ERROR
 16570        PERFORM 9900-ERROR-FORMAT
 16571                                 THRU 9900-EXIT
 16572     END-IF
 16573     EVALUATE TRUE
 16574        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16575           CONTINUE
 16576*       WHEN PB-C-AH-REF-CALC = +0 AND
 16577*                  PB-C-AH-CANCEL-AMT > +0
 16578        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16579                   PB-C-AH-REF-CALC > +0
 16580           CONTINUE
 16581        WHEN WS-AH-REFUND-OVS-AMT = +0
 16582                AND WS-TOL-AH-REFUND = +0
 16583           CONTINUE
 16584        WHEN OTHER
 16585           IF WS-TOL-AH-REFUND = +0
 16586              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16587           END-IF
 16588           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16589               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16590                                         PB-C-AH-CANCEL-AMT)
 16591              CONTINUE
 16592           ELSE
 16593              IF WS-AH-REFUND-OVS-AMT = +0
 16594                 MOVE +9999999.99 TO
 16595                         WS-AH-REFUND-OVS-AMT
 16596              END-IF
 16597              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16598                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16599                                         PB-C-AH-CANCEL-AMT)
 16600                 CONTINUE
 16601              ELSE
 16602                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16603                    MOVE ER-2754   TO  WS-ERROR
 16604                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16605                 ELSE
 16606                    MOVE ER-2736   TO  WS-ERROR
 16607                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16608                 END-IF
 16609              END-IF
 16610           END-IF
 16611     END-EVALUATE.
 16612
 16613     EVALUATE TRUE
 16614        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 300
* EL050.cbl
 16615           CONTINUE
 16616*       WHEN PB-C-AH-REF-CALC > +0 AND
 16617*                  PB-C-AH-CANCEL-AMT = +0
 16618        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16619                   PB-C-AH-REF-CALC = +0
 16620           CONTINUE
 16621        WHEN OTHER
 16622           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16623               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16624              CONTINUE
 16625           ELSE
 16626              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16627                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16628                 CONTINUE
 16629              ELSE
 16630                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16631                     MOVE ER-2754   TO  WS-ERROR
 16632                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633                 ELSE
 16634                     MOVE ER-2736   TO  WS-ERROR
 16635                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16636                 END-IF
 16637              END-IF
 16638           END-IF
 16639     END-EVALUATE.
 16640
 16641     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16642        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16643        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16644           AND  PB-C-LF-REF-CALC < +1.00
 16645           AND  PB-C-AH-REF-CALC < +1.00
 16646           CONTINUE
 16647        ELSE
 16648           IF (PB-COMPANY-ID = 'DCC')
 16649              AND (PB-CI-ENTRY-STATUS = 'M')
 16650              CONTINUE
 16651           ELSE
 16652              MOVE ER-2741       TO WS-ERROR
 16653              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16654           END-IF
 16655        END-IF
 16656     END-IF
 16657
 16658     IF (PB-C-LF-CANCEL-AMT = ZERO
 16659        AND WS-LF-BENEFIT-CD NOT = ZERO
 16660        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16661        AND PB-C-LF-REF-CALC NOT = ZERO)
 16662        OR
 16663        (PB-C-LF-CANCEL-AMT = ZERO
 16664        AND WS-LF-BENEFIT-CD NOT = ZERO
 16665        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16666             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16667                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16668                NEXT SENTENCE
 16669             ELSE
 16670                MOVE ER-2739        TO WS-ERROR
 16671                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16672
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 301
* EL050.cbl
 16673     IF (PB-C-AH-CANCEL-AMT = ZERO
 16674        AND WS-AH-BENEFIT-CD NOT = ZERO
 16675        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16676        AND PB-C-AH-REF-CALC NOT = ZERO)
 16677        OR
 16678        (PB-C-AH-CANCEL-AMT = ZERO
 16679        AND WS-AH-BENEFIT-CD NOT = ZERO
 16680        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16681             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16682                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16683                NEXT SENTENCE
 16684             ELSE
 16685                MOVE ER-2738        TO WS-ERROR
 16686                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16687
 16688 3775-OVER-REF-CHK.
 16689
 16690     IF PB-CI-ENTRY-STATUS = '5'
 16691        GO TO 3780-UPDATE-CANCEL-CERT.
 16692
 16693     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16694                              PB-CI-LF-ALT-PREMIUM-AMT.
 16695
 16696     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16697        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16698                                 PB-C-LF-REF-CALC
 16699      ELSE
 16700        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16701                                 PB-C-LF-CANCEL-AMT.
 16702
 16703     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16704        MOVE ER-2755             TO WS-ERROR
 16705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16706
 16707     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16708
 16709     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16710        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16711                                 PB-C-AH-REF-CALC
 16712      ELSE
 16713        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16714                                 PB-C-AH-CANCEL-AMT.
 16715
 16716     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16717        MOVE ER-2778             TO WS-ERROR
 16718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16719
 16720     IF PB-CI-OB-FLAG NOT = 'Z'
 16721        NEXT SENTENCE
 16722       ELSE
 16723         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16724            MOVE ER-2757           TO WS-ERROR
 16725            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16726
 16727 3780-UPDATE-CANCEL-CERT.
 16728
 16729     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16730        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 302
* EL050.cbl
 16731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16732
 16733     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16734         MOVE ER-2729              TO WS-ERROR
 16735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16736
 16737     IF PB-CI-LF-BENEFIT-CD = ZERO
 16738         GO TO 3780-UPDATE-CONT-1.
 16739
 16740     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16741         GO TO 3780-UPDATE-CONT-1.
 16742
 16743     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16744       AND
 16745        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16746       AND
 16747        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16748       AND
 16749        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16750            NEXT SENTENCE
 16751       ELSE
 16752        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16753          AND
 16754***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16755***       AND
 16756           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16757            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16758               MOVE ER-2730      TO WS-ERROR
 16759               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16760               GO TO 3999-END-EDIT
 16761            ELSE
 16762               GO TO 3999-END-EDIT
 16763        ELSE
 16764            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16765               MOVE ER-2765           TO WS-ERROR
 16766               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16767               GO TO 3785-CHECK-NH.
 16768*              GO TO 3999-END-EDIT.
 16769
 16770 3780-UPDATE-CONT-1.
 16771     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16772
 16773     IF PB-CI-AH-BENEFIT-CD = ZERO
 16774         GO TO 3780-UPDATE-CONT-2.
 16775
 16776     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16777         GO TO 3780-UPDATE-CONT-2.
 16778
 16779     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16780
 16781     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16782       AND
 16783        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16784       AND
 16785        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16786       AND
 16787        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16788            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 303
* EL050.cbl
 16789       ELSE
 16790        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16791          AND
 16792***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16793***       AND
 16794           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16795           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16796            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16797               MOVE ER-2773      TO WS-ERROR
 16798               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16799               GO TO 3999-END-EDIT
 16800            ELSE
 16801               GO TO 3999-END-EDIT
 16802            END-IF
 16803           ELSE
 16804             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16805                MOVE ER-2890 TO WS-ERROR
 16806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16807                GO TO 3999-END-EDIT
 16808             ELSE
 16809                GO TO 3785-CHECK-NH
 16810             END-IF
 16811           END-IF
 16812          ELSE
 16813            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16814              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16815                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16816                   MOVE ER-2890 TO WS-ERROR
 16817                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16818                   GO TO 3999-END-EDIT
 16819                ELSE
 16820                   MOVE ER-2765 TO WS-ERROR
 16821                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16822                   GO TO 3785-CHECK-NH
 16823                END-IF
 16824              ELSE
 16825               MOVE ER-2765      TO WS-ERROR
 16826               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16827               GO TO 3785-CHECK-NH.
 16828*              GO TO 3999-END-EDIT.
 16829
 16830 3780-UPDATE-CONT-2.
 16831
 16832     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16833        AND WS-LF-BENEFIT-CD = ZERO
 16834           MOVE ER-2743           TO WS-ERROR
 16835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16836
 16837     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16838        AND WS-AH-BENEFIT-CD = ZERO
 16839           MOVE ER-2744           TO WS-ERROR
 16840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16841
 16842     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16843        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16844        AND
 16845        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16846         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 304
* EL050.cbl
 16847           MOVE ER-2746           TO WS-ERROR
 16848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16849
 16850     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16851       AND
 16852        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16853             MOVE ER-2737        TO WS-ERROR
 16854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16855
 16856     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16857       AND
 16858        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16859             MOVE ER-2737        TO WS-ERROR
 16860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16861
 16862     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16863         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16864             OR 'CID' OR 'DCC' OR 'AHL'
 16865             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16866         ELSE
 16867             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16868                 MOVE ER-2768    TO WS-ERROR
 16869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16870             ELSE
 16871                 MOVE ER-2756    TO WS-ERROR
 16872                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16873
 16874     IF CERT-PEND-ISSUE-RETURNED
 16875        MOVE ER-2772             TO WS-ERROR
 16876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16877 3785-CHECK-NH.
 16878     IF PB-STATE NOT = 'NH'
 16879        GO TO 3999-END-EDIT
 16880     END-IF
 16881
 16882     MOVE ER-2796                TO WS-ERROR
 16883     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16884     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16885        OR (CM-NH-INTERFACE-SW = 'Y')
 16886        MOVE ER-2793             TO WS-ERROR
 16887        PERFORM 9900-ERROR-FORMAT
 16888                                 THRU 9900-EXIT
 16889     END-IF
 16890     MOVE +0                     TO WS-PAYMENT-AMT
 16891     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16892        GO TO 3999-END-EDIT
 16893     END-IF
 16894     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16895        GO TO 3999-END-EDIT
 16896     END-IF
 16897     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16898     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16899     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16900        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16901     END-IF
 16902     MOVE '1'                    TO DC-OPTION-CODE
 16903     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16904     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 305
* EL050.cbl
 16905        IF DC-ELAPSED-DAYS < +16
 16906           GO TO 3999-END-EDIT
 16907        END-IF
 16908     END-IF
 16909     MOVE +0                     TO DC-ELAPSED-DAYS
 16910     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16911     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16912     MOVE '1'                    TO DC-OPTION-CODE
 16913     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16914     IF NO-CONVERSION-ERROR
 16915        IF DC-ELAPSED-DAYS > +30
 16916           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16917        ELSE
 16918           GO TO 3999-END-EDIT
 16919        END-IF
 16920     ELSE
 16921        GO TO 3999-END-EDIT
 16922     END-IF
 16923     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16924        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16925           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16926     IF WS-PAYMENT-AMT < 600.00
 16927        GO TO 3999-END-EDIT
 16928     END-IF
 16929     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16930
 16931     IF (ERMAIL-FOUND = ' ')
 16932         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16933         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16934        GO TO 3999-END-EDIT
 16935     END-IF
 16936     MOVE ER-2795                TO WS-ERROR
 16937     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16938
 16939     GO TO 3999-END-EDIT.
 16940******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 306
* EL050.cbl
 16942 3990-FILES-NOT-OPEN.
 16943
 16944     MOVE ER-2617                TO WS-ERROR.
 16945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16946     GO TO 9990-RETURN.
 16947
 16948 3999-END-EDIT.
 16949
 16950     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16951
 16952     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16953         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16954         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16955             PERFORM 9250-UNLOCK-RETURN
 16956             GO TO 9990-RETURN
 16957          ELSE
 16958             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16959             GO TO 9990-RETURN.
 16960
 16961     IF PB-CANCELLATION
 16962          GO TO 9990-RETURN.
 16963
 16964     IF CERT-WAS-NOT-FOUND
 16965        MOVE SPACES              TO CERTIFICATE-MASTER.
 16966
 16967     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16968
 16969     IF CERT-WAS-FOUND
 16970         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16971             PERFORM 9250-UNLOCK-RETURN
 16972          ELSE
 16973            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16974      ELSE
 16975         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16976
 16977     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16978        IF PB-COMPANY-ID = 'DCC' AND
 16979           (PB-CARRIER = '2' OR '4' OR '6')
 16980              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16981        END-IF
 16982     END-IF.
 16983
 16984     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16985         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16986     END-IF.
 16987     move ' '                    to ws-ins-age-defaulted
 16988     perform 8150-read-elcrtt    thru 8150-exit
 16989     if ws-ins-age-defaulted = 'Y'
 16990        move er-1573             to ws-error
 16991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16992     end-if
 16993
 16994     if ws-jnt-age-defaulted = 'Y'
 16995        move er-1574             to ws-error
 16996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16997     end-if
 16998
 16999     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 307
* EL050.cbl
 17000     IF ((PB-COMPANY-ID = 'DCC')
 17001        AND (WS-NO-SECURE-PAY))
 17002                  OR
 17003        (WS-LF-SPECIAL-CALC-CD = 'O'
 17004        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17005        SET SKIP-ADDR-EDIT       TO TRUE
 17006     END-IF
 17007     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17008        AND (NOT SKIP-ADDR-EDIT)
 17009        MOVE ER-2963             TO WS-ERROR
 17010        PERFORM 9900-ERROR-FORMAT
 17011                                 THRU 9900-EXIT
 17012        GO TO 9990-RETURN
 17013     END-IF
 17014     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17015     IF ERPNDM-FOUND NOT = 'X'
 17016        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17017           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17018           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17019           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17020           AND (NOT SKIP-ADDR-EDIT)
 17021           MOVE ER-2694          TO WS-ERROR
 17022           PERFORM 9900-ERROR-FORMAT
 17023                                 THRU 9900-EXIT
 17024        END-IF
 17025        MOVE ' '                 TO STATE-RECORD-ERROR
 17026        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17027        MOVE PM-STATE            TO CNTL-ACCESS
 17028        MOVE '3'                 TO CNTL-REC-TYPE
 17029        MOVE +0                  TO CNTL-SEQ-NO
 17030        MOVE '0'                 TO RC-SW-2
 17031        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17032        IF (NO-STATE-RECORD)
 17033           OR (CF-RECORD-TYPE NOT = '3')
 17034           OR (PM-STATE NOT = CF-STATE-CODE)
 17035           IF (PM-STATE = SPACES)
 17036              AND (SKIP-ADDR-EDIT)
 17037              CONTINUE
 17038           ELSE
 17039              MOVE ER-2963       TO WS-ERROR
 17040              PERFORM 9900-ERROR-FORMAT
 17041                                 THRU 9900-EXIT
 17042           END-IF
 17043        END-IF
 17044        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17045           MOVE ER-2883          TO WS-ERROR
 17046           PERFORM 9900-ERROR-FORMAT
 17047                                 THRU 9900-EXIT
 17048        END-IF
 17049        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17050           MOVE ' '                 TO STATE-RECORD-ERROR
 17051           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17052           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17053           MOVE '3'                 TO CNTL-REC-TYPE
 17054           MOVE +0                  TO CNTL-SEQ-NO
 17055           MOVE '0'                 TO RC-SW-2
 17056           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17057           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 308
* EL050.cbl
 17058              OR (CF-RECORD-TYPE NOT = '3')
 17059              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17060              MOVE ER-2964          TO WS-ERROR
 17061              PERFORM 9900-ERROR-FORMAT
 17062                                    THRU 9900-EXIT
 17063           END-IF
 17064        END-IF
 17065     ELSE
 17066        IF NOT SKIP-ADDR-EDIT
 17067           MOVE ER-2393          TO WS-ERROR
 17068           PERFORM 9900-ERROR-FORMAT
 17069                                 THRU 9900-EXIT
 17070        END-IF
 17071     END-IF
 17072
 17073     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17074
 17075     IF (ERMAIL-FOUND = ' ' AND
 17076        ERPNDM-FOUND = ' ')
 17077        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17078           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17079           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17080          OR
 17081           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17082          OR
 17083           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17084           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17085           GO TO 3999-UNLOCK-ERMAIL.
 17086
 17087     IF ERPNDM-FOUND = 'X'
 17088        GO TO 3999-UNLOCK-ERMAIL.
 17089
 17090     IF PM-INSURED-LAST-NAME      = SPACES
 17091        AND PM-INSURED-FIRST-NAME = SPACES
 17092        AND PM-ADDRESS-LINE-1     = SPACES
 17093        AND PM-ADDRESS-LINE-2     = SPACES
 17094        AND PM-CITY-STATE         = SPACES
 17095        AND PM-CRED-BENE-NAME     = SPACES
 17096        AND PM-CRED-BENE-ADDR     = SPACES
 17097        AND PM-CRED-BENE-CTYST    = SPACES
 17098        GO TO 3999-UNLOCK-ERMAIL
 17099     END-IF
 17100
 17101     MOVE SPACES                 TO MAILING-DATA.
 17102
 17103     MOVE 'MA'                   TO MA-RECORD-ID.
 17104     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17105     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17106     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17107     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17108     MOVE PB-SV-STATE            TO MA-STATE.
 17109     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17110     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17111
 17112     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17113     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17114
 17115     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 309
* EL050.cbl
 17116        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17117     ELSE
 17118        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17119        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17120        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17121
 17122     GO TO 9990-RETURN.
 17123
 17124 3999-UNLOCK-ERMAIL.
 17125     IF ERMAIL-FOUND = ' '
 17126        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17127
 17128     GO TO 9990-RETURN.
 17129******************************************************************
 17130
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 310
* EL050.cbl
 17132 4000-UPDATE-CANCELLED-CERT.
 17133     IF CERT-WAS-NOT-FOUND
 17134        GO TO 4299-EXIT.
 17135
 17136*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17137     IF PB-C-NH-INT-ON-REFS > ZEROS
 17138        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17139     END-IF
 17140     IF PB-C-REF-INTERFACE-SW = 'Y'
 17141        MOVE PB-C-REF-INTERFACE-SW
 17142                                 TO CM-NH-INTERFACE-SW
 17143     END-IF
 17144     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17145     IF ERMAIL-FOUND = 'X'
 17146        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17147        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17148        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17149        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17150           MOVE ER-2694          TO WS-ERROR
 17151           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17152     END-IF
 17153
 17154     IF PB-C-POST-CARD-IND = 'Y'
 17155        MOVE +8                  TO SUB
 17156*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17157        IF ERMAIL-FOUND = ' '
 17158           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17159              (SUB > +7)
 17160              OR (MA-MAIL-STATUS (SUB) = '1')
 17161           END-PERFORM
 17162        END-IF
 17163        IF (SUB > +7)
 17164           OR (ERMAIL-FOUND = 'X')
 17165           MOVE ER-3789          TO WS-ERROR
 17166           PERFORM 9900-ERROR-FORMAT
 17167                                 THRU 9900-EXIT
 17168        END-IF
 17169     ELSE
 17170        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17171     END-IF
 17172
 17173     IF ERMAIL-FOUND = ' '
 17174        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17175     END-IF.
 17176
 17177     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17178
 17179     IF PB-CI-OB-FLAG = 'Z'
 17180        GO TO 4150-SUMMARY-CERT-CANCEL.
 17181
 17182     IF PB-C-LF-CANCEL-VOIDED
 17183         PERFORM 4200-REVERSE-LF-CANCEL.
 17184     IF PB-C-AH-CANCEL-VOIDED
 17185         PERFORM 4200-REVERSE-AH-CANCEL.
 17186
 17187 4100-APPLY-LF-CANCEL.
 17188
 17189     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 311
* EL050.cbl
 17190
 17191 4100-CHECK-LF-ERRORS.
 17192
 17193     ADD +1                       TO WS-SUB.
 17194
 17195     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17196        IF LF-COVERAGE-CANCELLED
 17197           GO TO 4100-LF-CANCEL-CONT
 17198        ELSE
 17199           GO TO 4100-UPDATE-LF-COVERAGE.
 17200
 17201     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17202                                   ER-2729 OR
 17203                                   ER-2730 OR
 17204                                   ER-2731 OR
 17205                                   ER-2732 OR
 17206                                   ER-2737 OR
 17207                                   ER-2740 OR
 17208                                   ER-2743 OR
 17209                                   ER-2749 OR
 17210                                   ER-2750 OR
 17211                                   ER-2755 OR
 17212                                   ER-2757 OR
 17213                                   ER-2760 OR
 17214                                   ER-2772 OR
 17215                                   ER-2774 OR
 17216                                   ER-2776 OR
 17217                                   ER-2794
 17218        GO TO 4100-UPDATE-LF-COVERAGE.
 17219
 17220     GO TO 4100-CHECK-LF-ERRORS.
 17221
 17222 4100-UPDATE-LF-COVERAGE.
 17223
 17224     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17225     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17226     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17227        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17228     END-IF
 17229     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17230                                      TO CM-CREDIT-INTERFACE-SW-2.
 17231     IF CM-LF-CANCEL-DT = LOW-VALUE
 17232         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17233
 17234     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17235         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17236                                         CM-LF-STATUS-AT-CANCEL.
 17237
 17238     GO TO 4100-APPLY-AH-CANCEL.
 17239
 17240 4100-LF-CANCEL-CONT.
 17241     IF PB-C-LF-CANCEL-VOIDED
 17242         GO TO 4100-APPLY-AH-CANCEL.
 17243
 17244     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17245         GO TO 4100-APPLY-AH-CANCEL.
 17246
 17247     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 312
* EL050.cbl
 17248        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17249           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17250        ELSE
 17251           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17252
 17253     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17254     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17255
 17256     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17257         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17258
 17259     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17260        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17261         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17262         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17263
 17264     IF PB-RECORD-RETURNED
 17265        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17266      ELSE
 17267        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17268
 17269 4100-APPLY-AH-CANCEL.
 17270
 17271     MOVE +0                      TO WS-SUB.
 17272
 17273 4100-CHECK-AH-ERRORS.
 17274
 17275     ADD +1                       TO WS-SUB.
 17276
 17277     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17278        IF AH-COVERAGE-CANCELLED
 17279           GO TO 4100-AH-CANCEL-CONT
 17280        ELSE
 17281           GO TO 4100-UPDATE-AH-COVERAGE.
 17282
 17283     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17284                                   ER-2729 OR
 17285                                   ER-2732 OR
 17286                                   ER-2737 OR
 17287                                   ER-2740 OR
 17288                                   ER-2744 OR
 17289                                   ER-2749 OR
 17290                                   ER-2750 OR
 17291                                   ER-2755 OR
 17292                                   ER-2757 OR
 17293                                   ER-2760 OR
 17294                                   ER-2771 OR
 17295                                   ER-2772 OR
 17296                                   ER-2773 OR
 17297                                   ER-2775 OR
 17298                                   ER-2777 OR
 17299                                   ER-2794
 17300        GO TO 4100-UPDATE-AH-COVERAGE.
 17301
 17302     GO TO 4100-CHECK-AH-ERRORS.
 17303
 17304 4100-UPDATE-AH-COVERAGE.
 17305
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 313
* EL050.cbl
 17306     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17307     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17308     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17309     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17310                                      TO CM-CREDIT-INTERFACE-SW-2.
 17311     IF CM-AH-CANCEL-DT = LOW-VALUE
 17312         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17313
 17314     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17315         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17316                                         CM-AH-STATUS-AT-CANCEL.
 17317
 17318     IF LF-COVERAGE-CANCELLED
 17319         IF PB-RECORD-RETURNED
 17320              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17321          ELSE
 17322              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17323
 17324     GO TO 4299-EXIT.
 17325
 17326 4100-AH-CANCEL-CONT.
 17327     IF PB-C-AH-CANCEL-VOIDED
 17328         GO TO 4299-EXIT.
 17329
 17330     if cm-credit-interface-sw-2 = ' '
 17331        if pb-fatal-errors or pb-unforced-errors
 17332           move '4'              to cm-credit-interface-sw-2
 17333        else
 17334           move '1'              to cm-credit-interface-sw-2
 17335        end-if
 17336     end-if
 17337     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17338         GO TO 4299-EXIT.
 17339
 17340     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17341        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17342           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17343        ELSE
 17344           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17345
 17346     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17347     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17348
 17349     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17350         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17351
 17352     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17353         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17354         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17355
 17356     IF PB-RECORD-RETURNED
 17357        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17358      ELSE
 17359        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17360
 17361     GO TO 4299-EXIT.
 17362
 17363 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 314
* EL050.cbl
 17364     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17365
 17366     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17367        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17368                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17369     ELSE
 17370        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17371                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17372
 17373     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17374        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17375                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17376     ELSE
 17377        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17378                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17379
 17380     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17381        NEXT SENTENCE
 17382     ELSE
 17383        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17384
 17385     GO TO 4299-EXIT.
 17386
 17387 4200-REVERSE-LF-CANCEL.
 17388     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17389
 17390     IF CM-LF-CANCEL-APPLIED
 17391        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17392        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17393        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17394
 17395     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17396
 17397     IF PB-RECORD-RETURNED
 17398        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17399       ELSE
 17400        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17401
 17402 4200-REVERSE-LF-EXIT.
 17403       EXIT.
 17404
 17405 4200-REVERSE-AH-CANCEL.
 17406     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17407
 17408     IF CM-AH-CANCEL-APPLIED
 17409        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17410        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17411        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17412
 17413     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17414
 17415     IF PB-RECORD-RETURNED
 17416        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17417       ELSE
 17418        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17419
 17420 4200-REVERSE-AH-EXIT.
 17421       EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 315
* EL050.cbl
 17422
 17423 4299-EXIT.
 17424       EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 316
* EL050.cbl
 17426
 17427 4500-UPDATE-NEW-CERT.
 17428     IF CERT-WAS-FOUND
 17429         NEXT SENTENCE
 17430       ELSE
 17431         GO TO 4520-BUILD-NEW-KEY.
 17432
 17433     IF  CLASIC-CREATED-CERT
 17434         GO TO 4999-EXIT.
 17435
 17436     IF  CERT-WAS-CREATED-FOR-CLAIM
 17437         GO TO 4520-BUILD-NEW-KEY.
 17438
 17439     IF CERT-ADDED-BATCH
 17440        IF CM-RECORD-ID = 'CM'
 17441            GO TO 4999-EXIT.
 17442
 17443 4520-BUILD-NEW-KEY.
 17444* BUILD CONTROL PRIMARY
 17445
 17446     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17447                                       CM-COMPANY-CD-A1
 17448                                       CM-COMPANY-CD-A2
 17449                                       CM-COMPANY-CD-A4
 17450                                       CM-COMPANY-CD-A5.
 17451
 17452     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17453     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17454     MOVE PB-SV-STATE               TO CM-STATE.
 17455     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17456     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17457     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17458     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17459
 17460     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17461
 17462     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17463     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17464     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17465     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17466
 17467     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17468        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17469
 17470     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17471         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17472         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17473         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17474         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17475     ELSE
 17476         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17477
 17478     IF PB-COMPANY-ID   EQUAL  'CRI'
 17479         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17480         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17481         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17482         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17483         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 317
* EL050.cbl
 17484
 17485     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17486        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17487         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17488
 17489     IF PB-COMPANY-ID  = 'LBL'
 17490        IF PB-I-JOINT-COVERAGE
 17491            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17492                                           PB-I-MEMBER-NO
 17493            GO TO 4550-CONT-CERT-PROCESS.
 17494
 17495     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17496        NEXT SENTENCE
 17497     ELSE
 17498        GO TO 4540-BUILD-MEMBER-NO.
 17499
 17500******************************************************************
 17501*                                                                *
 17502*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17503*    FOR 'MON'.                                                  *
 17504*                                                                *
 17505******************************************************************
 17506
 17507     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17508     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17509     MOVE +1                     TO WS-SUB1
 17510                                    WS-SUB2.
 17511
 17512 4530-EDIT-MEMB-NAME.
 17513
 17514     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17515        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17516        ADD +1                       TO WS-SUB2.
 17517
 17518     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17519        ADD +1                       TO WS-SUB1
 17520        GO TO 4530-EDIT-MEMB-NAME.
 17521
 17522     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17523     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17524     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17525*    MOVE SPACE                      TO DC-OPTION-CODE.
 17526     SET  BIN-TO-GREG                TO TRUE.
 17527     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17528     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17529
 17530     GO TO 4550-CONT-CERT-PROCESS.
 17531
 17532******************************************************************
 17533*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17534******************************************************************
 17535
 17536 4540-BUILD-MEMBER-NO.
 17537
 17538     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17539         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17540         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17541         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 318
* EL050.cbl
 17542         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17543     ELSE
 17544         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17545
 17546     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17547        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17548         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17549
 17550 4550-CONT-CERT-PROCESS.
 17551
 17552*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17553*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17554*    ELSE
 17555*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17556
 17557     IF CERT-WAS-CREATED-FOR-CLAIM
 17558        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17559        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17560
 17561     IF CERT-AND-CLAIM-ONLINE
 17562        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17563        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17564
 17565     MOVE 'CM'                     TO CM-RECORD-ID.
 17566     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17567
 17568     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17569        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17570        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17571     ELSE
 17572        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17573        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17574
 17575     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17576     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17577     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17578     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17579     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17580     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17581     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17582                                      CM-LF-ITD-CANCEL-AMT
 17583                                      CM-LF-ITD-DEATH-AMT
 17584                                      CM-AH-ITD-AH-PMT
 17585                                      CM-AH-ITD-LUMP-PMT
 17586                                      CM-AH-ITD-CANCEL-AMT
 17587                                      CM-LF-NSP-PREMIUM-AMT
 17588                                      CM-AH-NSP-PREMIUM-AMT.
 17589*                                     CM-CLAIM-DEDUCT-WITHHELD
 17590*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17591     if pb-i-loan-apr = +99.9999
 17592        move zeros                 to cm-loan-apr
 17593     else
 17594        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17595     end-if
 17596     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17597     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17598     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17599     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 319
* EL050.cbl
 17600     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17601     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17602     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17603     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17604     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17605     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17606     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17607
 17608     IF PB-I-LIVES NOT NUMERIC
 17609         MOVE ZERO                 TO PB-I-LIVES.
 17610
 17611     IF PB-I-NUM-BILLED NOT NUMERIC
 17612         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17613
 17614     MOVE PB-I-LIVES               TO CM-LIVES.
 17615     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17616
 17617     IF PB-COMPANY-ID EQUAL  'DMD'
 17618         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17619         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17620
 17621     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17622     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17623     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17624     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17625     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17626     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17627
 17628     IF PB-I-LF-POLICY-FEE NUMERIC
 17629        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17630     ELSE
 17631        MOVE +0                    TO CM-LF-POLICY-FEE.
 17632
 17633     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17634        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17635        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17636     ELSE
 17637        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17638
 17639     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17640     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17641     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17642     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17643     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17644     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17645     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17646     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17647     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17648
 17649     IF PB-I-AH-POLICY-FEE NUMERIC
 17650        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17651     ELSE
 17652        MOVE +0                    TO CM-AH-POLICY-FEE.
 17653
 17654     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17655        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17656     ELSE
 17657        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 320
* EL050.cbl
 17658
 17659     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17660     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17661
 17662     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17663                                      CM-LF-DEATH-EXIT-DT
 17664                                      CM-AH-SETTLEMENT-EXIT-DT.
 17665
 17666*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17667*                       'TIH' OR 'OFL' OR 'FLA' OR
 17668*                       'TII' OR 'TMS' OR 'CRI' OR
 17669*                       'NCL'
 17670     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17671
 17672     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17673         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17674            MOVE '2'                TO CM-PREMIUM-TYPE.
 17675
 17676     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17677         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17678            MOVE '2'                TO CM-PREMIUM-TYPE.
 17679
 17680     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17681         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17682     ELSE
 17683         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17684         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17685
 17686     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17687     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17688     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17689     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17690     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17691     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17692     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17693     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17694
 17695     IF PB-NO-MONTHS-SKIPPED
 17696         MOVE SPACE                 TO CM-SKIP-CODE
 17697     ELSE
 17698         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17699
 17700     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17701     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17702                                       CM-LF-STATUS-AT-CANCEL.
 17703
 17704     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17705     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17706                                       CM-AH-STATUS-AT-CANCEL.
 17707
 17708     MOVE '1'                       TO CM-ENTRY-STATUS.
 17709
 17710     IF PB-REISSUED-CERT
 17711        MOVE '5'                    TO CM-ENTRY-STATUS.
 17712
 17713     IF PB-MONTHLY-CERT
 17714        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17715
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 321
* EL050.cbl
 17716     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17717     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17718     IF PB-POLICY-IS-DECLINED
 17719        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17720
 17721     IF PB-POLICY-IS-VOIDED
 17722        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17723
 17724     IF PB-NEEDS-UNDERWRITING
 17725        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17726
 17727     IF PB-REIN-ONLY-CERT
 17728        MOVE '9'                    TO CM-ENTRY-STATUS.
 17729
 17730     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17731         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17732     ELSE
 17733         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17734
 17735     IF PB-RECORD-RETURNED
 17736        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17737      ELSE
 17738        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17739
 17740     IF PB-I-MAIL-ADDRS-PRESENT
 17741        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17742
 17743     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17744                                       CM-ENTRY-DT.
 17745
 17746 4999-EXIT.
 17747     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 322
* EL050.cbl
 17749
 17750 5000-PROCESS-REPS.
 17751     MOVE ' '                    TO AGTC-MASTER-SW
 17752     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17753     MOVE CO-TYPE                TO AGTC-TYPE
 17754     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17755     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17756     IF (AGTC-MASTER-SW NOT = 'N')
 17757        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17758        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17759        PERFORM 8583-READ-ERAGTC-NEXT
 17760                                 THRU 8583-EXIT
 17761     END-IF
 17762     IF AGTC-MASTER-SW = 'N'
 17763        CONTINUE
 17764     ELSE
 17765        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17766           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17767              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17768              MOVE 'Y'           TO AGTC-MASTER-SW
 17769           END-IF
 17770        END-IF
 17771     END-IF
 17772     .
 17773 5000-EXIT.
 17774     EXIT.
 17775 6370-EDIT-INPUT-LF-CODE.
 17776     move ' ' to ws-benefit-cd-chg-sw
 17777     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17778        MOVE +1                  TO SUB
 17779        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17780        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17781        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17782        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17783        GO TO 6370-SEARCH-LOOP.
 17784
 17785     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17786
 17787     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17788     MOVE SPACES                 TO CNTL-ACCESS.
 17789*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17790     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17791     MOVE +0                     TO CNTL-SEQ-NO.
 17792     MOVE '4' TO RC-SW-2.
 17793     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17794
 17795     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17796        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17797        GO TO 6370-NO-LF-FOUND.
 17798
 17799     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17800     MOVE +1                     TO SUB.
 17801
 17802 6370-SEARCH-LOOP.
 17803     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17804         GO TO 6370-NO-LF-FOUND.
 17805
 17806     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 323
* EL050.cbl
 17807        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17808           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17809           set benefit-code-chg to true
 17810        end-if
 17811        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17812        GO TO 6370-HER-NET-PAY-CHECK.
 17813
 17814     ADD 1   TO SUB.
 17815*    IF SUB GREATER 120
 17816     IF SUB GREATER 200
 17817         GO TO 6370-NO-LF-FOUND.
 17818
 17819     GO TO 6370-SEARCH-LOOP.
 17820
 17821 6370-NO-LF-FOUND.
 17822
 17823     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17824        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17825        set benefit-code-chg to true
 17826     end-if
 17827     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17828
 17829 6370-HER-NET-PAY-CHECK.
 17830
 17831     IF PB-COMPANY-ID = 'CID'
 17832        IF PB-SV-STATE = 'CA' OR 'MN'
 17833           IF PB-I-LF-BENEFIT-CD = '02'
 17834              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17835           ELSE
 17836              IF PB-I-LF-BENEFIT-CD = '04'
 17837                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17838              END-IF
 17839           END-IF
 17840        END-IF
 17841     END-IF
 17842
 17843     IF PB-COMPANY-ID NOT = 'HER'
 17844         GO TO 6370-EXIT.
 17845
 17846     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17847         GO TO 6370-EXIT.
 17848
 17849     IF PB-I-LF-TERM NOT NUMERIC
 17850         MOVE ZEROS              TO PB-I-LF-TERM.
 17851
 17852     IF PB-I-LOAN-TERM NOT NUMERIC
 17853         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17854
 17855     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17856         GO TO 6370-EXIT.
 17857
 17858     IF PB-I-LF-BENEFIT-CD = '33'
 17859         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17860
 17861     IF PB-I-LF-BENEFIT-CD = '34'
 17862         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17863
 17864 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 324
* EL050.cbl
 17865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 325
* EL050.cbl
 17867
 17868 6380-EDIT-INPUT-AH-CODE.
 17869     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17870        MOVE +1                  TO SUB
 17871        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17872        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17873        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17874        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17875        GO TO 6380-SEARCH-LOOP.
 17876
 17877     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17878
 17879     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17880     MOVE SPACES                 TO CNTL-ACCESS.
 17881     MOVE 'A'                    TO CNTL-REC-TYPE.
 17882*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17883     MOVE +0                     TO CNTL-SEQ-NO.
 17884     MOVE '5' TO RC-SW-2.
 17885     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17886
 17887     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17888        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17889        GO TO 6380-NO-AH-FOUND.
 17890
 17891     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17892     MOVE +1 TO SUB.
 17893
 17894 6380-SEARCH-LOOP.
 17895     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17896         GO TO 6380-NO-AH-FOUND.
 17897
 17898     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17899         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17900         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17901
 17902     ADD 1   TO SUB.
 17903     IF SUB GREATER THAN 96
 17904*    IF SUB GREATER THAN 300
 17905         GO TO 6380-NO-AH-FOUND.
 17906
 17907     GO TO 6380-SEARCH-LOOP.
 17908
 17909 6380-NO-AH-FOUND.
 17910
 17911     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17912
 17913     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17914         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17915     ELSE
 17916         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17917
 17918 6380-CSO-AH-ONLY-CHECKS.
 17919
 17920     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17921        NEXT SENTENCE
 17922      ELSE
 17923        GO TO 6380-EXIT.
 17924
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 326
* EL050.cbl
 17925     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17926         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17927
 17928
 17929     GO TO 6380-EXIT
 17930     .
 17931 6380-CSO-LIFE-WITH-AH-CHECKS.
 17932
 17933
 17934     .
 17935 6380-EXIT.
 17936     EXIT.
 17937
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 327
* EL050.cbl
 17939
 17940 6400-COMPUTE-EXTENSION-DAYS.
 17941
 17942******************************************************************
 17943*                                                                *
 17944*                   COMPUTE EXTENSION DAYS                       *
 17945*                                                                *
 17946*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17947*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17948*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17949*    THE EXTENSION DAYS.                                         *
 17950*                                                                *
 17951******************************************************************
 17952
 17953     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17954     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17955
 17956******************************************************************
 17957*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17958*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17959******************************************************************
 17960
 17961     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17962        COMPUTE WS-ODD-DAYS-OVER =
 17963               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17964     ELSE
 17965        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17966
 17967     IF WS-ODD-DAYS-OVER = ZEROS
 17968           GO TO 6499-EXIT
 17969     ELSE
 17970        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17971           IF WS-WDF-MONTH = 02
 17972              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17973              ADD 2       TO  WS-ODD-DAYS-OVER
 17974              GO TO 6499-EXIT
 17975           ELSE
 17976              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17977                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17978                 GO TO 6499-EXIT
 17979               ELSE
 17980                 GO TO 6499-EXIT
 17981        ELSE
 17982           GO TO 6499-EXIT.
 17983
 17984 6412-CHECK-TO-DAY.
 17985
 17986        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17987           IF WS-WDT-DAY = 28
 17988              ADD 2              TO WS-ODD-DAYS-OVER
 17989           ELSE
 17990              IF WS-WDT-DAY = 29
 17991                 ADD 1           TO WS-ODD-DAYS-OVER
 17992              ELSE
 17993                 NEXT SENTENCE
 17994        ELSE
 17995           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17996              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 328
* EL050.cbl
 17997
 17998     GO TO 6499-EXIT.
 17999
 18000
 18001 6415-CHECK-LEAP-YEAR.
 18002
 18003     IF DC-DAYS-IN-MONTH = 29
 18004        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18005
 18006 6415-EXIT.
 18007     EXIT.
 18008
 18009 6499-EXIT.
 18010      EXIT.
 18011
 18012 6500-END.
 18013     EXIT.
 18014
 18015
 18016******************************************************************
 18017************* PROCEDURE DIVISION FOR EL050 ***********************
 18018********************** ELC50PD END *******************************
 18019
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 329
* EL050.cbl
 18021
 18022**START***********************************************************
 18023*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18024*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18025******************************************************************
 18026*
 18027 6600-GET-STATE-MUNICIPAL-TAX.
 18028
 18029     IF PB-COMPANY-ID NOT = 'DMD'
 18030         GO TO 6640-EXIT.
 18031
 18032     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18033     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18034     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18035*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18036*
 18037***  Y2K PROJ 7744
 18038     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18039     SET BIN-TO-GREG          TO TRUE.
 18040     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18041
 18042     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18043
 18044     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18045     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18046
 18047
 18048* EXEC CICS HANDLE CONDITION
 18049*        INVREQ    (6610-START-BROWSE)
 18050*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18051*        NOTFND    (6630-END-OF-FILE)
 18052*    END-EXEC.
 18053*    MOVE '"$8JI                 ! # #00018035' TO DFHEIV0
 18054     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18056     MOVE X'2320233030303138303335' TO DFHEIV0(25:11)
 18057     CALL 'kxdfhei1' USING DFHEIV0
 18058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18059
 18060
 18061 6610-START-BROWSE.
 18062
 18063
 18064* EXEC CICS HANDLE CONDITION
 18065*        NOTFND    (6630-END-OF-FILE)
 18066*        DISABLED  (6630-ERRESS-PROBLEM)
 18067*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18068*        ENDFILE   (6630-END-OF-FILE)
 18069*    END-EXEC.
 18070*    MOVE '"$IcJ''                ! $ #00018043' TO DFHEIV0
 18071     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18073     MOVE X'2420233030303138303433' TO DFHEIV0(25:11)
 18074     CALL 'kxdfhei1' USING DFHEIV0
 18075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18076
 18077
 18078
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 330
* EL050.cbl
 18079* EXEC CICS STARTBR
 18080*        DATASET (FILE-ID-ERRESS)
 18081*        RIDFLD  (WS-ERRESS-KEY)
 18082*        GTEQ
 18083*    END-EXEC.
 18084     MOVE 0
 18085       TO DFHEIV11
 18086*    MOVE '&,         G          &   #00018050' TO DFHEIV0
 18087     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18089     MOVE X'2020233030303138303530' TO DFHEIV0(25:11)
 18090     CALL 'kxdfhei1' USING DFHEIV0,
 18091           FILE-ID-ERRESS,
 18092           WS-ERRESS-KEY,
 18093           DFHEIV99,
 18094           DFHEIV11,
 18095           DFHEIV99
 18096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18097
 18098
 18099 6620-READ-NEXT-ERRESS-MASTER.
 18100
 18101
 18102* EXEC CICS HANDLE CONDITION
 18103*        NOTFND    (6630-END-OF-FILE)
 18104*        ENDFILE   (6630-END-OF-FILE)
 18105*        DISABLED  (6630-ERRESS-PROBLEM)
 18106*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18107*    END-EXEC.
 18108*    MOVE '"$I''cJ                ! % #00018058' TO DFHEIV0
 18109     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18111     MOVE X'2520233030303138303538' TO DFHEIV0(25:11)
 18112     CALL 'kxdfhei1' USING DFHEIV0
 18113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18114
 18115
 18116
 18117* EXEC CICS READNEXT
 18118*        DATASET (FILE-ID-ERRESS)
 18119*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18120*        RIDFLD  (WS-ERRESS-KEY)
 18121*    END-EXEC.
 18122     MOVE LENGTH OF
 18123      RESIDENT-STATE-TAX-MASTER
 18124       TO DFHEIV12
 18125     MOVE 0
 18126       TO DFHEIV11
 18127*    MOVE '&.IL                  )   #00018065' TO DFHEIV0
 18128     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18129     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18130     MOVE X'2020233030303138303635' TO DFHEIV0(25:11)
 18131     CALL 'kxdfhei1' USING DFHEIV0,
 18132           FILE-ID-ERRESS,
 18133           RESIDENT-STATE-TAX-MASTER,
 18134           DFHEIV12,
 18135           WS-ERRESS-KEY,
 18136           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 331
* EL050.cbl
 18137           DFHEIV11,
 18138           DFHEIV99,
 18139           DFHEIV99
 18140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18141
 18142
 18143     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18144
 18145* EXEC CICS ENDBR
 18146*            DATASET (FILE-ID-ERRESS)
 18147*       END-EXEC
 18148     MOVE 0
 18149       TO DFHEIV11
 18150*    MOVE '&2                    $   #00018072' TO DFHEIV0
 18151     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18152     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18153     MOVE X'2020233030303138303732' TO DFHEIV0(25:11)
 18154     CALL 'kxdfhei1' USING DFHEIV0,
 18155           FILE-ID-ERRESS,
 18156           DFHEIV11,
 18157           DFHEIV99
 18158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18159        GO TO 6630-END-OF-FILE.
 18160
 18161     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18162        NEXT SENTENCE
 18163      ELSE
 18164        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18165
 18166*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18167*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18168*
 18169     MOVE +2                     TO WS-SUB1.
 18170
 18171     IF PB-ISSUE
 18172     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18173        MOVE +1                  TO WS-SUB1.
 18174
 18175     IF PB-CANCELLATION
 18176     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18177        MOVE +1                  TO WS-SUB1.
 18178*
 18179*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18180*
 18181***  Y2K PROJ 7744
 18182     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18183***  Y2K PROJ 7744
 18184
 18185*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18186* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18187* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18188
 18189     ADD 1                    TO WS-YEAR-YY.
 18190
 18191     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18192         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18193                              TO WS-RES-STATE-TAX
 18194         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 332
* EL050.cbl
 18195                              TO WS-RES-MUNI-TAX
 18196     ELSE
 18197         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18198                              TO WS-RES-STATE-TAX
 18199         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18200                              TO WS-RES-MUNI-TAX.
 18201
 18202*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18203
 18204     IF PB-CANCELLATION
 18205         GO TO 6640-CANCEL-TAX.
 18206
 18207     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18208         COMPUTE PB-I-STATE-TAX ROUNDED =
 18209                                   PB-I-LF-PREMIUM-AMT
 18210                                 * WS-RES-STATE-TAX
 18211         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18212                                   PB-I-LF-PREMIUM-AMT
 18213                                 * WS-RES-MUNI-TAX
 18214     ELSE
 18215     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18216         COMPUTE PB-I-STATE-TAX ROUNDED =
 18217                                   PB-I-AH-PREMIUM-AMT
 18218                                 * WS-RES-STATE-TAX
 18219         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18220                                   PB-I-AH-PREMIUM-AMT
 18221                                 * WS-RES-MUNI-TAX.
 18222
 18223
 18224* EXEC CICS ENDBR
 18225*         DATASET (FILE-ID-ERRESS)
 18226*    END-EXEC.
 18227     MOVE 0
 18228       TO DFHEIV11
 18229*    MOVE '&2                    $   #00018139' TO DFHEIV0
 18230     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18232     MOVE X'2020233030303138313339' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0,
 18234           FILE-ID-ERRESS,
 18235           DFHEIV11,
 18236           DFHEIV99
 18237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18238
 18239
 18240     GO TO 6640-EXIT.
 18241
 18242 6640-CANCEL-TAX.
 18243     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18244
 18245     IF PB-C-LF-CANCEL-AMT > ZEROS
 18246         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18247                                   PB-C-LF-CANCEL-AMT
 18248                                 * WS-RES-STATE-TAX
 18249         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18250                                   PB-C-LF-CANCEL-AMT
 18251                                *  WS-RES-MUNI-TAX
 18252     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 333
* EL050.cbl
 18253     IF PB-C-AH-CANCEL-AMT > ZEROS
 18254         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18255                                   PB-C-AH-CANCEL-AMT
 18256                                 * WS-RES-STATE-TAX
 18257         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18258                                   PB-C-AH-CANCEL-AMT
 18259                                *  WS-RES-MUNI-TAX.
 18260
 18261
 18262* EXEC CICS ENDBR
 18263*         DATASET (FILE-ID-ERRESS)
 18264*    END-EXEC.
 18265     MOVE 0
 18266       TO DFHEIV11
 18267*    MOVE '&2                    $   #00018164' TO DFHEIV0
 18268     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18270     MOVE X'2020233030303138313634' TO DFHEIV0(25:11)
 18271     CALL 'kxdfhei1' USING DFHEIV0,
 18272           FILE-ID-ERRESS,
 18273           DFHEIV11,
 18274           DFHEIV99
 18275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18276
 18277
 18278     GO TO 6640-EXIT.
 18279
 18280 6630-END-OF-FILE.
 18281     MOVE ER-8002              TO WS-ERROR.
 18282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18283
 18284     GO TO 6640-EXIT.
 18285
 18286 6630-ERRESS-PROBLEM.
 18287     MOVE ER-8044              TO WS-ERROR.
 18288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18289
 18290 6640-EXIT.
 18291     EXIT.
 18292
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 334
* EL050.cbl
 18294 6650-GET-RES-STATE-COMM.
 18295
 18296     IF PB-COMPANY-ID NOT = 'DMD'
 18297         GO TO 6700-COMM-EXIT.
 18298
 18299     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18300     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18301     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18302     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18303     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18304     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18305     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18306
 18307*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18308*
 18309***  Y2K PROJ 7744
 18310     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18311     SET BIN-TO-GREG          TO TRUE.
 18312     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18313
 18314     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18315***  Y2K PROJ 7744
 18316
 18317     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18318
 18319
 18320* EXEC CICS HANDLE CONDITION
 18321*        INVREQ    (6660-START-BROWSE)
 18322*        DISABLED  (6690-ERRESC-PROBLEM)
 18323*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18324*        NOTFND    (6690-END-OF-FILE)
 18325*    END-EXEC.
 18326*    MOVE '"$8cJI                ! & #00018209' TO DFHEIV0
 18327     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18329     MOVE X'2620233030303138323039' TO DFHEIV0(25:11)
 18330     CALL 'kxdfhei1' USING DFHEIV0
 18331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18332
 18333
 18334
 18335* EXEC CICS RESETBR
 18336*        DATASET (FILE-ID-ERRESC)
 18337*        RIDFLD  (WS-ERRESC-KEY)
 18338*    END-EXEC.
 18339     MOVE 0
 18340       TO DFHEIV11
 18341*    MOVE '&4         G          &   #00018216' TO DFHEIV0
 18342     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303138323136' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           FILE-ID-ERRESC,
 18347           WS-ERRESC-KEY,
 18348           DFHEIV99,
 18349           DFHEIV11,
 18350           DFHEIV99
 18351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 335
* EL050.cbl
 18352
 18353
 18354 6660-START-BROWSE.
 18355
 18356
 18357* EXEC CICS HANDLE CONDITION
 18358*        NOTFND    (6690-END-OF-FILE)
 18359*        DISABLED  (6690-ERRESC-PROBLEM)
 18360*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18361*        ENDFILE   (6690-END-OF-FILE)
 18362*    END-EXEC.
 18363*    MOVE '"$IcJ''                ! '' #00018223' TO DFHEIV0
 18364     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18366     MOVE X'2720233030303138323233' TO DFHEIV0(25:11)
 18367     CALL 'kxdfhei1' USING DFHEIV0
 18368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18369
 18370
 18371
 18372* EXEC CICS STARTBR
 18373*        DATASET (FILE-ID-ERRESC)
 18374*        RIDFLD  (WS-ERRESC-KEY)
 18375*        GTEQ
 18376*    END-EXEC.
 18377     MOVE 0
 18378       TO DFHEIV11
 18379*    MOVE '&,         G          &   #00018230' TO DFHEIV0
 18380     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18382     MOVE X'2020233030303138323330' TO DFHEIV0(25:11)
 18383     CALL 'kxdfhei1' USING DFHEIV0,
 18384           FILE-ID-ERRESC,
 18385           WS-ERRESC-KEY,
 18386           DFHEIV99,
 18387           DFHEIV11,
 18388           DFHEIV99
 18389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18390
 18391
 18392     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18393
 18394 6670-READ-NEXT-ERRESC-MASTER.
 18395
 18396
 18397* EXEC CICS HANDLE CONDITION
 18398*        NOTFND    (6690-END-OF-FILE)
 18399*        DISABLED  (6690-ERRESC-PROBLEM)
 18400*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18401*        ENDFILE   (6690-END-OF-FILE)
 18402*    END-EXEC.
 18403*    MOVE '"$IcJ''                ! ( #00018240' TO DFHEIV0
 18404     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18406     MOVE X'2820233030303138323430' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0
 18408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18409
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 336
* EL050.cbl
 18410
 18411
 18412* EXEC CICS READNEXT
 18413*        DATASET (FILE-ID-ERRESC)
 18414*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18415*        RIDFLD  (ERRESC-RECORD-KEY)
 18416*    END-EXEC.
 18417     MOVE LENGTH OF
 18418      ACCOUNT-RESIDENT-ST-COMMISSION
 18419       TO DFHEIV12
 18420     MOVE 0
 18421       TO DFHEIV11
 18422*    MOVE '&.IL                  )   #00018247' TO DFHEIV0
 18423     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18424     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18425     MOVE X'2020233030303138323437' TO DFHEIV0(25:11)
 18426     CALL 'kxdfhei1' USING DFHEIV0,
 18427           FILE-ID-ERRESC,
 18428           ACCOUNT-RESIDENT-ST-COMMISSION,
 18429           DFHEIV12,
 18430           ERRESC-RECORD-KEY,
 18431           DFHEIV99,
 18432           DFHEIV11,
 18433           DFHEIV99,
 18434           DFHEIV99
 18435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18436
 18437
 18438     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18439        NEXT SENTENCE
 18440     ELSE
 18441
 18442* EXEC CICS ENDBR
 18443*            DATASET (FILE-ID-ERRESC)
 18444*       END-EXEC
 18445     MOVE 0
 18446       TO DFHEIV11
 18447*    MOVE '&2                    $   #00018256' TO DFHEIV0
 18448     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18449     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18450     MOVE X'2020233030303138323536' TO DFHEIV0(25:11)
 18451     CALL 'kxdfhei1' USING DFHEIV0,
 18452           FILE-ID-ERRESC,
 18453           DFHEIV11,
 18454           DFHEIV99
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18456        GO TO 6690-END-OF-FILE.
 18457
 18458     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18459
 18460* EXEC CICS ENDBR
 18461*            DATASET (FILE-ID-ERRESC)
 18462*       END-EXEC
 18463     MOVE 0
 18464       TO DFHEIV11
 18465*    MOVE '&2                    $   #00018262' TO DFHEIV0
 18466     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 337
* EL050.cbl
 18468     MOVE X'2020233030303138323632' TO DFHEIV0(25:11)
 18469     CALL 'kxdfhei1' USING DFHEIV0,
 18470           FILE-ID-ERRESC,
 18471           DFHEIV11,
 18472           DFHEIV99
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18474        GO TO 6690-END-OF-FILE.
 18475
 18476     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18477        NEXT SENTENCE
 18478      ELSE
 18479        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18480
 18481* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18482*
 18483     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18484
 18485     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18486
 18487     IF WS-SUB1 > ZERO
 18488         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18489             PERFORM 6680-SET-COMMISSION
 18490         ELSE
 18491             PERFORM 6680-SET-TABLE-CODE.
 18492
 18493
 18494* EXEC CICS ENDBR
 18495*         DATASET (FILE-ID-ERRESC)
 18496*    END-EXEC.
 18497     MOVE 0
 18498       TO DFHEIV11
 18499*    MOVE '&2                    $   #00018284' TO DFHEIV0
 18500     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18501     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18502     MOVE X'2020233030303138323834' TO DFHEIV0(25:11)
 18503     CALL 'kxdfhei1' USING DFHEIV0,
 18504           FILE-ID-ERRESC,
 18505           DFHEIV11,
 18506           DFHEIV99
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18508
 18509
 18510     GO TO 6700-COMM-EXIT.
 18511
 18512 6680-SET-TABLE-CODE.
 18513     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18514        MOVE ZEROS             TO WS-SUB1
 18515     ELSE
 18516* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18517* TO COMPUTE AH COMMISSION.
 18518        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18519        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18520        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18521        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18522        PERFORM 6680-READ-CTBL-TABLE
 18523        IF WS-CTBL-READ-SW NOT = 'Y'
 18524           MOVE ZEROS          TO WS-SUB1.
 18525
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 338
* EL050.cbl
 18526 6680-READ-CTBL-TABLE.
 18527*
 18528* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18529* TO COMPUTE LIFE COMMISSION
 18530
 18531     IF CTBL-SW = '0540'
 18532        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18533        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18534        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18535
 18536     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18537
 18538     IF CTBL-TABLE-FOUND
 18539        IF CTBL-SW = '0530'
 18540             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18541                                    * PB-I-AH-TERM
 18542             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18543             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18544        ELSE
 18545             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18546             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18547             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18548     ELSE
 18549        IF FIRST-TIME-THROUGH
 18550            GO TO 6680-READ-CTBL-TABLE
 18551        ELSE
 18552            MOVE ZEROS         TO WS-SUB1.
 18553
 18554 6680-SET-COMMISSION.
 18555     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18556           MOVE ZEROS          TO WS-SUB1
 18557       ELSE
 18558           MOVE RESC-COMMISSION-PER (WS-SUB)
 18559                               TO WS-COMMISSION
 18560           IF CTBL-SW = '0530'
 18561               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18562           ELSE
 18563               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18564
 18565 6680-SEARCH-CATEGORY.
 18566     ADD +1                   TO WS-SUB.
 18567     IF WS-SUB > +12
 18568         GO TO 6680-EXIT.
 18569
 18570     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18571          MOVE WS-SUB         TO WS-SUB1
 18572          GO TO 6680-EXIT.
 18573
 18574     GO TO 6680-SEARCH-CATEGORY.
 18575
 18576 6680-EXIT.
 18577     EXIT.
 18578
 18579 6690-END-OF-FILE.
 18580     GO TO 6700-COMM-EXIT.
 18581
 18582 6690-ERRESC-PROBLEM.
 18583      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 339
* EL050.cbl
 18584      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18585
 18586      GO TO 6700-COMM-EXIT.
 18587
 18588 6700-COMM-EXIT.
 18589     EXIT.
 18590
 18591 7000-GET-RATE.
 18592
 18593* EXEC CICS LINK
 18594*        PROGRAM    ('ELRATE')
 18595*        COMMAREA   (CALCULATION-PASS-AREA)
 18596*        LENGTH     (CP-COMM-LENGTH)
 18597*    END-EXEC.
 18598     MOVE 'ELRATE' TO DFHEIV1
 18599*    MOVE '."C                   (   #00018370' TO DFHEIV0
 18600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18602     MOVE X'2020233030303138333730' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0,
 18604           DFHEIV1,
 18605           CALCULATION-PASS-AREA,
 18606           CP-COMM-LENGTH,
 18607           DFHEIV99,
 18608           DFHEIV99,
 18609           DFHEIV99,
 18610           DFHEIV99
 18611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18612
 18613
 18614 7000-EXIT.
 18615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 340
* EL050.cbl
 18617 7100-FIND-BENEFIT-IN-STATE.
 18618     MOVE 'N'                    TO BEN-SEARCH-SW.
 18619
 18620     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18621         VARYING SUB3 FROM 1 BY 1 UNTIL
 18622            ((SUB3 GREATER 50) OR
 18623              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18624               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18625
 18626     IF SUB3 NOT = 51
 18627         MOVE 'Y'                TO BEN-SEARCH-SW.
 18628
 18629     GO TO 7199-EXIT.
 18630
 18631 7100-BENEFIT-DUMMY.
 18632
 18633 7100-DUMMY-EXIT.
 18634     EXIT.
 18635
 18636 7199-EXIT.
 18637     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 341
* EL050.cbl
 18639 7200-FIND-BENEFIT.
 18640     MOVE 'N'                    TO BEN-SEARCH-SW.
 18641
 18642     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18643         VARYING SUB3 FROM 1 BY 1 UNTIL
 18644            ((SUB3 GREATER 8) OR
 18645            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18646
 18647     IF SUB3 NOT = 9
 18648         MOVE 'Y'                TO BEN-SEARCH-SW.
 18649
 18650     GO TO 7200-EXIT.
 18651
 18652 7200-BENEFIT-DUMMY.
 18653
 18654 7200-DUMMY-EXIT.
 18655     EXIT.
 18656
 18657 7200-EXIT.
 18658     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 342
* EL050.cbl
 18660 7250-LOOK-FOR-RESCINDED-CLAIM.
 18661     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18662                                    W-CL-COMP-CD.
 18663     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18664                                    W-CL-CERT-NO.
 18665
 18666
 18667* EXEC CICS HANDLE CONDITION
 18668*        NOTFND  (7250-CONTINUE)
 18669*        ENDFILE (7250-CONTINUE)
 18670*    END-EXEC.
 18671*    MOVE '"$I''                  ! ) #00018428' TO DFHEIV0
 18672     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18674     MOVE X'2920233030303138343238' TO DFHEIV0(25:11)
 18675     CALL 'kxdfhei1' USING DFHEIV0
 18676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18677
 18678
 18679
 18680* EXEC CICS IGNORE CONDITION
 18681*        DUPKEY
 18682*    END-EXEC.
 18683*    MOVE '"*$                   !   #00018433' TO DFHEIV0
 18684     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18686     MOVE X'2020233030303138343333' TO DFHEIV0(25:11)
 18687     CALL 'kxdfhei1' USING DFHEIV0
 18688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18689
 18690
 18691
 18692* EXEC CICS STARTBR
 18693*        DATASET   (CLMS-ID)
 18694*        RIDFLD    (ELMSTR-KEY)
 18695*        GENERIC   EQUAL
 18696*        KEYLENGTH (ELMSTR-LENGTH)
 18697*    END-EXEC.
 18698     MOVE 0
 18699       TO DFHEIV11
 18700*    MOVE '&,   KG    E          &   #00018437' TO DFHEIV0
 18701     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18702     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18703     MOVE X'2020233030303138343337' TO DFHEIV0(25:11)
 18704     CALL 'kxdfhei1' USING DFHEIV0,
 18705           CLMS-ID,
 18706           ELMSTR-KEY,
 18707           ELMSTR-LENGTH,
 18708           DFHEIV11,
 18709           DFHEIV99
 18710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18711
 18712
 18713     MOVE 'Y'                    TO W-BROWSE-SW.
 18714
 18715 7250-NEXT-CLAIM.
 18716
 18717
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 343
* EL050.cbl
 18718* EXEC CICS READNEXT
 18719*        DATASET   (CLMS-ID)
 18720*        RIDFLD    (ELMSTR-KEY)
 18721*        SET       (ADDRESS OF CLAIM-MASTER)
 18722*    END-EXEC.
 18723     MOVE 0
 18724       TO DFHEIV11
 18725*    MOVE '&.S                   )   #00018448' TO DFHEIV0
 18726     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18727     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18728     MOVE X'2020233030303138343438' TO DFHEIV0(25:11)
 18729     CALL 'kxdfhei1' USING DFHEIV0,
 18730           CLMS-ID,
 18731           DFHEIV20,
 18732           DFHEIV99,
 18733           ELMSTR-KEY,
 18734           DFHEIV99,
 18735           DFHEIV11,
 18736           DFHEIV99,
 18737           DFHEIV99
 18738     SET ADDRESS OF CLAIM-MASTER TO
 18739         DFHEIV20
 18740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18741
 18742
 18743     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18744        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18745         GO TO 7250-CONTINUE
 18746     END-IF.
 18747
 18748     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18749        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18750        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18751        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18752        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18753         GO TO 7250-NEXT-CLAIM
 18754     END-IF.
 18755
 18756     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18757        OR (CL-CLAIM-TYPE = 'I')
 18758        OR (CL-CLAIM-TYPE = 'G')
 18759          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18760              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18761              GO TO 7250-CONTINUE
 18762          END-IF
 18763     END-IF.
 18764
 18765     GO TO 7250-NEXT-CLAIM.
 18766
 18767 7250-CONTINUE.
 18768
 18769     IF W-BROWSE-SW = 'Y'
 18770
 18771* EXEC CICS ENDBR
 18772*            DATASET   (CLMS-ID)
 18773*        END-EXEC
 18774     MOVE 0
 18775       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 344
* EL050.cbl
 18776*    MOVE '&2                    $   #00018481' TO DFHEIV0
 18777     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18778     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18779     MOVE X'2020233030303138343831' TO DFHEIV0(25:11)
 18780     CALL 'kxdfhei1' USING DFHEIV0,
 18781           CLMS-ID,
 18782           DFHEIV11,
 18783           DFHEIV99
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18785         MOVE 'N' TO W-BROWSE-SW
 18786     END-IF.
 18787
 18788 7250-EXIT.
 18789     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 345
* EL050.cbl
 18791 7300-CHECK-FOR-OPEN-CLMS.
 18792
 18793*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18794*    MOVE SPACES                 TO CNTL-ACCESS.
 18795*    MOVE '1'                    TO CNTL-REC-TYPE.
 18796*    MOVE +0                     TO CNTL-SEQ-NO.
 18797
 18798*    MOVE '3'                    TO RC-SW-1.
 18799*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18800
 18801*    IF NOT CF-COMPANY-MASTER
 18802*         PERFORM 0099-COMPANY-NOT-FOUND
 18803*         GO TO 7300-EXIT.
 18804
 18805     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18806                                    W-CL-COMP-CD.
 18807     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18808                                    W-CL-CERT-NO.
 18809
 18810
 18811* EXEC CICS HANDLE CONDITION
 18812*        NOTFND  (7300-CONTINUE)
 18813*        ENDFILE (7300-CONTINUE)
 18814*    END-EXEC.
 18815*    MOVE '"$I''                  ! * #00018509' TO DFHEIV0
 18816     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18818     MOVE X'2A20233030303138353039' TO DFHEIV0(25:11)
 18819     CALL 'kxdfhei1' USING DFHEIV0
 18820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18821
 18822
 18823
 18824* EXEC CICS IGNORE CONDITION
 18825*        DUPKEY
 18826*    END-EXEC.
 18827*    MOVE '"*$                   !   #00018514' TO DFHEIV0
 18828     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18830     MOVE X'2020233030303138353134' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835
 18836* EXEC CICS STARTBR
 18837*        DATASET   (CLMS-ID)
 18838*        RIDFLD    (ELMSTR-KEY)
 18839*        GENERIC   EQUAL
 18840*        KEYLENGTH (ELMSTR-LENGTH)
 18841*    END-EXEC.
 18842     MOVE 0
 18843       TO DFHEIV11
 18844*    MOVE '&,   KG    E          &   #00018518' TO DFHEIV0
 18845     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18847     MOVE X'2020233030303138353138' TO DFHEIV0(25:11)
 18848     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 346
* EL050.cbl
 18849           CLMS-ID,
 18850           ELMSTR-KEY,
 18851           ELMSTR-LENGTH,
 18852           DFHEIV11,
 18853           DFHEIV99
 18854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18855
 18856
 18857     MOVE 'Y'                    TO W-BROWSE-SW.
 18858
 18859 7300-NEXT-CLAIM.
 18860
 18861
 18862* EXEC CICS READNEXT
 18863*        DATASET   (CLMS-ID)
 18864*        RIDFLD    (ELMSTR-KEY)
 18865*        SET       (ADDRESS OF CLAIM-MASTER)
 18866*    END-EXEC.
 18867     MOVE 0
 18868       TO DFHEIV11
 18869*    MOVE '&.S                   )   #00018529' TO DFHEIV0
 18870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18872     MOVE X'2020233030303138353239' TO DFHEIV0(25:11)
 18873     CALL 'kxdfhei1' USING DFHEIV0,
 18874           CLMS-ID,
 18875           DFHEIV20,
 18876           DFHEIV99,
 18877           ELMSTR-KEY,
 18878           DFHEIV99,
 18879           DFHEIV11,
 18880           DFHEIV99,
 18881           DFHEIV99
 18882     SET ADDRESS OF CLAIM-MASTER TO
 18883         DFHEIV20
 18884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18885
 18886
 18887     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18888        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18889         GO TO 7300-CONTINUE.
 18890
 18891     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18892        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18893        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18894        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18895        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18896         GO TO 7300-NEXT-CLAIM.
 18897
 18898*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18899     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18900        OR (CL-CLAIM-TYPE = 'I')
 18901        OR (CL-CLAIM-TYPE = 'G')
 18902        IF CLAIM-IS-OPEN
 18903           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18904             AND PB-C-AH-CANCEL-DT > SPACES
 18905              MOVE ER-2896        TO WS-ERROR
 18906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 347
* EL050.cbl
 18907           END-IF
 18908           EVALUATE TRUE
 18909             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18910                 MOVE ER-2884      TO WS-ERROR
 18911             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18912                 MOVE ER-2887      TO WS-ERROR
 18913             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18914                 MOVE ER-2886      TO WS-ERROR
 18915             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18916                 MOVE ER-2888      TO WS-ERROR
 18917             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18918                 MOVE ER-2885      TO WS-ERROR
 18919             WHEN OTHER
 18920                 MOVE ER-2768      TO WS-ERROR
 18921           END-EVALUATE
 18922           IF PB-C-AH-CANCEL-VOIDED OR
 18923              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18924                NOT AH-COVERAGE-CANCELLED)
 18925               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18926               MOVE ER-2768      TO WS-ERROR
 18927           END-IF
 18928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18929           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18930              PB-FORCE-CODE NOT EQUAL '8'
 18931               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18932           END-IF
 18933           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18934           GO TO 7300-NEXT-CLAIM
 18935        ELSE
 18936           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18937*****THIS IS A RESCISSION OR REFORMATION
 18938              IF (AH-COVERAGE-CANCELLED AND
 18939                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18940                    MOVE ER-2890 TO WS-ERROR
 18941                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18942                    GO TO 7300-NEXT-CLAIM
 18943              END-IF
 18944           ELSE
 18945              IF CL-DENIAL-TYPE = '1'  AND
 18946                 CL-TOTAL-PAID-AMT = 0
 18947                    GO TO 7300-NEXT-CLAIM
 18948              END-IF
 18949              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18950               AND PB-C-AH-CANCEL-DT > SPACES
 18951                 MOVE ER-2756        TO WS-ERROR
 18952                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18953                 GO TO 7300-NEXT-CLAIM
 18954              END-IF
 18955           END-IF
 18956        END-IF
 18957     ELSE
 18958*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18959        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18960           IF CLAIM-IS-OPEN
 18961              MOVE ER-2889      TO WS-ERROR
 18962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18963              GO TO 7300-NEXT-CLAIM
 18964           ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 348
* EL050.cbl
 18965              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18966*****THIS IS A RESCISSION OR REFORMATION
 18967                 IF (LF-COVERAGE-CANCELLED AND
 18968                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18969                       MOVE ER-2890 TO WS-ERROR
 18970                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18971                       GO TO 7300-NEXT-CLAIM
 18972                 END-IF
 18973              ELSE
 18974                 IF CL-DENIAL-TYPE = '1'  AND
 18975                    CL-TOTAL-PAID-AMT = 0
 18976                       GO TO 7300-NEXT-CLAIM
 18977                 END-IF
 18978                 IF (AH-COVERAGE-CANCELLED AND
 18979                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18980                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18981                    (LF-COVERAGE-CANCELLED AND
 18982                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18983                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18984                       MOVE ER-2965 TO WS-ERROR
 18985                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18986                       GO TO 7300-NEXT-CLAIM
 18987                 END-IF
 18988                 IF LF-COVERAGE-CANCELLED
 18989                  IF CL-TOTAL-PAID-AMT > 0
 18990                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18991                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18992                        MOVE ER-2891 TO WS-ERROR
 18993                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18994                        GO TO 7300-NEXT-CLAIM
 18995                      END-IF
 18996                    ELSE
 18997                      MOVE ER-2892 TO WS-ERROR
 18998                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18999                      GO TO 7300-NEXT-CLAIM
 19000                    END-IF
 19001                  END-IF
 19002                 END-IF
 19003              END-IF
 19004           END-IF
 19005        END-IF
 19006     END-IF
 19007
 19008     GO TO 7300-NEXT-CLAIM.
 19009
 19010 7300-CONTINUE.
 19011
 19012     IF W-BROWSE-SW = 'Y'
 19013
 19014* EXEC CICS ENDBR
 19015*            DATASET   (CLMS-ID)
 19016*        END-EXEC.
 19017     MOVE 0
 19018       TO DFHEIV11
 19019*    MOVE '&2                    $   #00018661' TO DFHEIV0
 19020     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19022     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 349
* EL050.cbl
 19023     CALL 'kxdfhei1' USING DFHEIV0,
 19024           CLMS-ID,
 19025           DFHEIV11,
 19026           DFHEIV99
 19027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19028
 19029
 19030 7300-EXIT.
 19031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 350
* EL050.cbl
 19033
 19034 7400-GET-REMAIN-TERM.
 19035
 19036* EXEC CICS LINK
 19037*        PROGRAM    ('ELRTRM')
 19038*        COMMAREA   (CALCULATION-PASS-AREA)
 19039*        LENGTH     (CP-COMM-LENGTH)
 19040*    END-EXEC.
 19041     MOVE 'ELRTRM' TO DFHEIV1
 19042*    MOVE '."C                   (   #00018670' TO DFHEIV0
 19043     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19045     MOVE X'2020233030303138363730' TO DFHEIV0(25:11)
 19046     CALL 'kxdfhei1' USING DFHEIV0,
 19047           DFHEIV1,
 19048           CALCULATION-PASS-AREA,
 19049           CP-COMM-LENGTH,
 19050           DFHEIV99,
 19051           DFHEIV99,
 19052           DFHEIV99,
 19053           DFHEIV99
 19054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19055
 19056
 19057 7400-EXIT.
 19058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 351
* EL050.cbl
 19060
 19061 7500-GET-REMAIN-AMOUNT.
 19062
 19063* EXEC CICS LINK
 19064*        PROGRAM    ('ELRAMT')
 19065*        COMMAREA   (CALCULATION-PASS-AREA)
 19066*        LENGTH     (CP-COMM-LENGTH)
 19067*    END-EXEC.
 19068     MOVE 'ELRAMT' TO DFHEIV1
 19069*    MOVE '."C                   (   #00018681' TO DFHEIV0
 19070     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19071     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303138363831' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           DFHEIV1,
 19075           CALCULATION-PASS-AREA,
 19076           CP-COMM-LENGTH,
 19077           DFHEIV99,
 19078           DFHEIV99,
 19079           DFHEIV99,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19082
 19083
 19084 7500-EXIT.
 19085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 352
* EL050.cbl
 19087
 19088 7600-GET-REFUND.
 19089
 19090* EXEC CICS LINK
 19091*        PROGRAM    ('ELRFND')
 19092*        COMMAREA   (CALCULATION-PASS-AREA)
 19093*        LENGTH     (CP-COMM-LENGTH)
 19094*    END-EXEC.
 19095     MOVE 'ELRFND' TO DFHEIV1
 19096*    MOVE '."C                   (   #00018692' TO DFHEIV0
 19097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303138363932' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           DFHEIV1,
 19102           CALCULATION-PASS-AREA,
 19103           CP-COMM-LENGTH,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99,
 19107           DFHEIV99
 19108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19109
 19110
 19111 7600-EXIT.
 19112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 353
* EL050.cbl
 19114 7700-CALL-DL1.
 19115
 19116* EXEC CICS LINK
 19117*        PROGRAM    ('DLO001')
 19118*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19119*        LENGTH     (DLO001-COMM-LENGTH)
 19120*    END-EXEC.
 19121     MOVE 'DLO001' TO DFHEIV1
 19122*    MOVE '."C                   (   #00018702' TO DFHEIV0
 19123     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303138373032' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           DFHEIV1,
 19128           WS-DLO-MASTER-POLICY-FORM,
 19129           DLO001-COMM-LENGTH,
 19130           DFHEIV99,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99
 19134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19135
 19136
 19137 7700-EXIT.
 19138     EXIT.
 19139
 19140 7710-CALL-DL2.
 19141
 19142* EXEC CICS LINK
 19143*        PROGRAM    ('DLO002')
 19144*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19145*        LENGTH     (DLO002-COMM-LENGTH)
 19146*    END-EXEC.
 19147     MOVE 'DLO002' TO DFHEIV1
 19148*    MOVE '."C                   (   #00018712' TO DFHEIV0
 19149     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19151     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19152     CALL 'kxdfhei1' USING DFHEIV0,
 19153           DFHEIV1,
 19154           WS-DLO-INTERNAL-POLICY-FORM,
 19155           DLO002-COMM-LENGTH,
 19156           DFHEIV99,
 19157           DFHEIV99,
 19158           DFHEIV99,
 19159           DFHEIV99
 19160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19161
 19162
 19163 7710-EXIT.
 19164     EXIT.
 19165
 19166 7720-CALL-DL3.
 19167
 19168* EXEC CICS LINK
 19169*        PROGRAM    ('DLO003')
 19170*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19171*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 354
* EL050.cbl
 19172*    END-EXEC.
 19173     MOVE 'DLO003' TO DFHEIV1
 19174*    MOVE '."C                   (   #00018722' TO DFHEIV0
 19175     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19177     MOVE X'2020233030303138373232' TO DFHEIV0(25:11)
 19178     CALL 'kxdfhei1' USING DFHEIV0,
 19179           DFHEIV1,
 19180           WS-DLO-VALID-BANK-ID,
 19181           DLO003-COMM-LENGTH,
 19182           DFHEIV99,
 19183           DFHEIV99,
 19184           DFHEIV99,
 19185           DFHEIV99
 19186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19187
 19188
 19189 7720-EXIT.
 19190     EXIT.
 19191
 19192 7730-CALL-DL7.
 19193
 19194* EXEC CICS LINK
 19195*        PROGRAM    ('DLO007')
 19196*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19197*        LENGTH     (DLO007-COMM-LENGTH)
 19198*    END-EXEC.
 19199     MOVE 'DLO007' TO DFHEIV1
 19200*    MOVE '."C                   (   #00018732' TO DFHEIV0
 19201     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19203     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0,
 19205           DFHEIV1,
 19206           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19207           DLO007-COMM-LENGTH,
 19208           DFHEIV99,
 19209           DFHEIV99,
 19210           DFHEIV99,
 19211           DFHEIV99
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 7730-EXIT.
 19216     EXIT.
 19217
 19218 7740-CALL-DL11.
 19219
 19220* EXEC CICS LINK
 19221*        PROGRAM    ('DLO011')
 19222*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19223*        LENGTH     (DLO011-COMM-LENGTH)
 19224*    END-EXEC.
 19225     MOVE 'DLO011' TO DFHEIV1
 19226*    MOVE '."C                   (   #00018742' TO DFHEIV0
 19227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19229     MOVE X'2020233030303138373432' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 355
* EL050.cbl
 19230     CALL 'kxdfhei1' USING DFHEIV0,
 19231           DFHEIV1,
 19232           WS-DLO-PREM-RATES-BEN-TYPE,
 19233           DLO011-COMM-LENGTH,
 19234           DFHEIV99,
 19235           DFHEIV99,
 19236           DFHEIV99,
 19237           DFHEIV99
 19238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19239
 19240
 19241 7740-EXIT.
 19242     EXIT.
 19243
 19244 7750-CALL-DL17.
 19245
 19246* EXEC CICS LINK
 19247*        PROGRAM    ('DLO017')
 19248*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19249*        LENGTH     (DLO017-COMM-LENGTH)
 19250*    END-EXEC.
 19251     MOVE 'DLO017' TO DFHEIV1
 19252*    MOVE '."C                   (   #00018752' TO DFHEIV0
 19253     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19255     MOVE X'2020233030303138373532' TO DFHEIV0(25:11)
 19256     CALL 'kxdfhei1' USING DFHEIV0,
 19257           DFHEIV1,
 19258           WS-DLO-VALID-RATE-CODE,
 19259           DLO017-COMM-LENGTH,
 19260           DFHEIV99,
 19261           DFHEIV99,
 19262           DFHEIV99,
 19263           DFHEIV99
 19264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19265
 19266
 19267 7750-EXIT.
 19268     EXIT.
 19269
 19270 7755-CALL-DL19.
 19271
 19272* EXEC CICS LINK
 19273*        PROGRAM    ('DLO019')
 19274*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19275*        LENGTH     (DLO019-COMM-LENGTH)
 19276*    END-EXEC.
 19277     MOVE 'DLO019' TO DFHEIV1
 19278*    MOVE '."C                   (   #00018762' TO DFHEIV0
 19279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19281     MOVE X'2020233030303138373632' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0,
 19283           DFHEIV1,
 19284           WS-DLO-ORIG-COV-CAT,
 19285           DLO019-COMM-LENGTH,
 19286           DFHEIV99,
 19287           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 356
* EL050.cbl
 19288           DFHEIV99,
 19289           DFHEIV99
 19290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19291
 19292
 19293 7755-EXIT.
 19294     EXIT.
 19295
 19296 7760-CALL-DL21.
 19297
 19298* EXEC CICS LINK
 19299*        PROGRAM    ('DLO021')
 19300*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19301*        LENGTH     (DLO021-COMM-LENGTH)
 19302*    END-EXEC.
 19303     MOVE 'DLO021' TO DFHEIV1
 19304*    MOVE '."C                   (   #00018772' TO DFHEIV0
 19305     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19307     MOVE X'2020233030303138373732' TO DFHEIV0(25:11)
 19308     CALL 'kxdfhei1' USING DFHEIV0,
 19309           DFHEIV1,
 19310           WS-DLO-VALID-LOAN-OFFICER,
 19311           DLO021-COMM-LENGTH,
 19312           DFHEIV99,
 19313           DFHEIV99,
 19314           DFHEIV99,
 19315           DFHEIV99
 19316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19317
 19318
 19319 7760-EXIT.
 19320     EXIT.
 19321
 19322 7770-CALL-DL22.
 19323
 19324* EXEC CICS LINK
 19325*        PROGRAM    ('DLO022')
 19326*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19327*        LENGTH     (DLO022-COMM-LENGTH)
 19328*    END-EXEC.
 19329     MOVE 'DLO022' TO DFHEIV1
 19330*    MOVE '."C                   (   #00018782' TO DFHEIV0
 19331     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19333     MOVE X'2020233030303138373832' TO DFHEIV0(25:11)
 19334     CALL 'kxdfhei1' USING DFHEIV0,
 19335           DFHEIV1,
 19336           WS-DLO-VALID-STATE-CODE,
 19337           DLO022-COMM-LENGTH,
 19338           DFHEIV99,
 19339           DFHEIV99,
 19340           DFHEIV99,
 19341           DFHEIV99
 19342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19343
 19344
 19345 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 357
* EL050.cbl
 19346     EXIT.
 19347
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 358
* EL050.cbl
 19349
 19350 7800-REWRITE-CERT.
 19351******************************************************************
 19352*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19353*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19354******************************************************************
 19355
 19356     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19357        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19358        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19359        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19360
 19361* EXEC CICS REWRITE
 19362*                  DATASET (CERT-ID)
 19363*                  FROM    (CERTIFICATE-MASTER)
 19364*              END-EXEC
 19365     MOVE LENGTH OF
 19366      CERTIFICATE-MASTER
 19367       TO DFHEIV11
 19368*    MOVE '&& L                  %   #00018803' TO DFHEIV0
 19369     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19370     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19371     MOVE X'2020233030303138383033' TO DFHEIV0(25:11)
 19372     CALL 'kxdfhei1' USING DFHEIV0,
 19373           CERT-ID,
 19374           CERTIFICATE-MASTER,
 19375           DFHEIV11,
 19376           DFHEIV99
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19378        GO TO 7800-EXIT.
 19379
 19380       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19381       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19382
 19383 7800-EXIT.
 19384      EXIT.
 19385
 19386 7900-DELETE-CERT.
 19387
 19388* EXEC CICS DELETE
 19389*        DATASET (CERT-ID)
 19390*    END-EXEC.
 19391*    MOVE '&(                    &   #00018816' TO DFHEIV0
 19392     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19393     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19394     MOVE X'2020233030303138383136' TO DFHEIV0(25:11)
 19395     CALL 'kxdfhei1' USING DFHEIV0,
 19396           CERT-ID,
 19397           DFHEIV99,
 19398           DFHEIV99,
 19399           DFHEIV99,
 19400           DFHEIV99
 19401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19402
 19403
 19404 7900-EXIT.
 19405     EXIT.
 19406
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 359
* EL050.cbl
 19407 8000-WRITE-CERT.
 19408
 19409* EXEC CICS HANDLE CONDITION
 19410*        DUPKEY    (8000-FREE-MAIN)
 19411*    END-EXEC.
 19412*    MOVE '"$$                   ! + #00018824' TO DFHEIV0
 19413     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19415     MOVE X'2B20233030303138383234' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420
 19421* EXEC CICS WRITE
 19422*        DATASET     (CERT-ID)
 19423*        FROM        (CERTIFICATE-MASTER)
 19424*        RIDFLD      (ELCERT-KEY)
 19425*    END-EXEC.
 19426     MOVE LENGTH OF
 19427      CERTIFICATE-MASTER
 19428       TO DFHEIV11
 19429*    MOVE '&$ L                  ''   #00018828' TO DFHEIV0
 19430     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19432     MOVE X'2020233030303138383238' TO DFHEIV0(25:11)
 19433     CALL 'kxdfhei1' USING DFHEIV0,
 19434           CERT-ID,
 19435           CERTIFICATE-MASTER,
 19436           DFHEIV11,
 19437           ELCERT-KEY,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19441
 19442
 19443 8000-FREE-MAIN.
 19444
 19445 8000-EXIT.
 19446      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 360
* EL050.cbl
 19448
 19449 8100-READ-ERPNDM.
 19450
 19451* EXEC CICS HANDLE CONDITION
 19452*         NOTFND     (8100-NOTFND)
 19453*         ENDFILE    (8100-NOTFND)
 19454*    END-EXEC.
 19455*    MOVE '"$I''                  ! , #00018841' TO DFHEIV0
 19456     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19458     MOVE X'2C20233030303138383431' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0
 19460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19461
 19462
 19463     MOVE SPACES                 TO ERPNDM-FOUND.
 19464     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19465
 19466
 19467* EXEC CICS READ
 19468*         DATASET   (FILE-ERPNDM)
 19469*         RIDFLD    (PM-CONTROL-PRIMARY)
 19470*         INTO      (PENDING-MAILING-DATA)
 19471*    END-EXEC.
 19472     MOVE LENGTH OF
 19473      PENDING-MAILING-DATA
 19474       TO DFHEIV11
 19475*    MOVE '&"IL       E          (   #00018849' TO DFHEIV0
 19476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19478     MOVE X'2020233030303138383439' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0,
 19480           FILE-ERPNDM,
 19481           PENDING-MAILING-DATA,
 19482           DFHEIV11,
 19483           PM-CONTROL-PRIMARY,
 19484           DFHEIV99,
 19485           DFHEIV99,
 19486           DFHEIV99
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490     GO TO 8100-EXIT.
 19491
 19492 8100-NOTFND.
 19493
 19494     MOVE 'X'                    TO ERPNDM-FOUND.
 19495     MOVE ER-2694                TO WS-ERROR.
 19496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19497     MOVE ER-2883                TO WS-ERROR
 19498     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19499     .
 19500 8100-EXIT.
 19501     EXIT.
 19502
 19503 8110-READ-ERMAIL.
 19504
 19505* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 361
* EL050.cbl
 19506*         NOTFND     (8110-NOTFND)
 19507*         ENDFILE    (8110-NOTFND)
 19508*    END-EXEC.
 19509*    MOVE '"$I''                  ! - #00018869' TO DFHEIV0
 19510     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19512     MOVE X'2D20233030303138383639' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517     MOVE SPACES                 TO ERMAIL-FOUND.
 19518     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19519     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19520     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19521     MOVE PB-SV-STATE            TO MA-STATE.
 19522
 19523
 19524* EXEC CICS READ
 19525*         UPDATE
 19526*         DATASET   (FILE-ERMAIL)
 19527*         RIDFLD    (MA-CONTROL-PRIMARY)
 19528*         INTO      (MAILING-DATA)
 19529*    END-EXEC.
 19530     MOVE LENGTH OF
 19531      MAILING-DATA
 19532       TO DFHEIV11
 19533*    MOVE '&"IL       EU         (   #00018880' TO DFHEIV0
 19534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19536     MOVE X'2020233030303138383830' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0,
 19538           FILE-ERMAIL,
 19539           MAILING-DATA,
 19540           DFHEIV11,
 19541           MA-CONTROL-PRIMARY,
 19542           DFHEIV99,
 19543           DFHEIV99,
 19544           DFHEIV99
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19546
 19547
 19548     GO TO 8110-EXIT.
 19549
 19550 8110-NOTFND.
 19551     MOVE 'X'                    TO ERMAIL-FOUND.
 19552
 19553 8110-EXIT.
 19554     EXIT.
 19555
 19556 8120-REWRITE-ERMAIL.
 19557
 19558* EXEC CICS REWRITE
 19559*         DATASET    (FILE-ERMAIL)
 19560*         FROM       (MAILING-DATA)
 19561*    END-EXEC.
 19562     MOVE LENGTH OF
 19563      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 362
* EL050.cbl
 19564       TO DFHEIV11
 19565*    MOVE '&& L                  %   #00018896' TO DFHEIV0
 19566     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19567     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19568     MOVE X'2020233030303138383936' TO DFHEIV0(25:11)
 19569     CALL 'kxdfhei1' USING DFHEIV0,
 19570           FILE-ERMAIL,
 19571           MAILING-DATA,
 19572           DFHEIV11,
 19573           DFHEIV99
 19574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19575
 19576
 19577 8120-EXIT.
 19578     EXIT.
 19579
 19580 8130-WRITE-ERMAIL.
 19581
 19582* EXEC CICS HANDLE CONDITION
 19583*         DUPKEY   (8130-EXIT)
 19584*    END-EXEC.
 19585*    MOVE '"$$                   ! . #00018905' TO DFHEIV0
 19586     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19588     MOVE X'2E20233030303138393035' TO DFHEIV0(25:11)
 19589     CALL 'kxdfhei1' USING DFHEIV0
 19590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19591
 19592
 19593
 19594* EXEC CICS WRITE
 19595*         DATASET     (FILE-ERMAIL)
 19596*         RIDFLD      (MA-CONTROL-PRIMARY)
 19597*         FROM        (MAILING-DATA)
 19598*    END-EXEC.
 19599     MOVE LENGTH OF
 19600      MAILING-DATA
 19601       TO DFHEIV11
 19602*    MOVE '&$ L                  ''   #00018909' TO DFHEIV0
 19603     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19605     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0,
 19607           FILE-ERMAIL,
 19608           MAILING-DATA,
 19609           DFHEIV11,
 19610           MA-CONTROL-PRIMARY,
 19611           DFHEIV99,
 19612           DFHEIV99
 19613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19614
 19615
 19616 8130-EXIT.
 19617     EXIT.
 19618
 19619 8140-UNLOCK-ERMAIL.
 19620
 19621* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 363
* EL050.cbl
 19622*         DATASET   (FILE-ERMAIL)
 19623*    END-EXEC.
 19624*    MOVE '&*                    #   #00018919' TO DFHEIV0
 19625     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19626     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19627     MOVE X'2020233030303138393139' TO DFHEIV0(25:11)
 19628     CALL 'kxdfhei1' USING DFHEIV0,
 19629           FILE-ERMAIL,
 19630           DFHEIV99
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19632
 19633
 19634 8140-EXIT.
 19635     EXIT.
 19636
 19637 8150-read-elcrtt.
 19638
 19639
 19640* EXEC CICS HANDLE CONDITION
 19641*        NOTFND   (8150-exit)
 19642*    END-EXEC
 19643*    MOVE '"$I                   ! / #00018928' TO DFHEIV0
 19644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19646     MOVE X'2F20233030303138393238' TO DFHEIV0(25:11)
 19647     CALL 'kxdfhei1' USING DFHEIV0
 19648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19649
 19650     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19651     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19652
 19653
 19654* EXEC CICS READ
 19655*        DATASET  (CRTT-ID)
 19656*        RIDFLD   (WS-ELCRTT-KEY)
 19657*        INTO     (CERTIFICATE-TRAILERS)
 19658*    END-EXEC
 19659     MOVE LENGTH OF
 19660      CERTIFICATE-TRAILERS
 19661       TO DFHEIV11
 19662*    MOVE '&"IL       E          (   #00018935' TO DFHEIV0
 19663     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19665     MOVE X'2020233030303138393335' TO DFHEIV0(25:11)
 19666     CALL 'kxdfhei1' USING DFHEIV0,
 19667           CRTT-ID,
 19668           CERTIFICATE-TRAILERS,
 19669           DFHEIV11,
 19670           WS-ELCRTT-KEY,
 19671           DFHEIV99,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19675
 19676     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19677     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19678
 19679     .
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 364
* EL050.cbl
 19680 8150-exit.
 19681     exit.
 19682 8180-UPDATE-VIN-NUMBER.
 19683
 19684* EXEC CICS HANDLE CONDITION
 19685*        NOTFND   (8180-NOTFND)
 19686*    END-EXEC.
 19687*    MOVE '"$I                   ! 0 #00018948' TO DFHEIV0
 19688     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19690     MOVE X'3020233030303138393438' TO DFHEIV0(25:11)
 19691     CALL 'kxdfhei1' USING DFHEIV0
 19692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19693
 19694
 19695     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19696     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19697
 19698
 19699* EXEC CICS READ
 19700*        UPDATE
 19701*        DATASET  (CRTT-ID)
 19702*        RIDFLD   (WS-ELCRTT-KEY)
 19703*        INTO     (CERTIFICATE-TRAILERS)
 19704*    END-EXEC.
 19705     MOVE LENGTH OF
 19706      CERTIFICATE-TRAILERS
 19707       TO DFHEIV11
 19708*    MOVE '&"IL       EU         (   #00018955' TO DFHEIV0
 19709     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19710     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19711     MOVE X'2020233030303138393535' TO DFHEIV0(25:11)
 19712     CALL 'kxdfhei1' USING DFHEIV0,
 19713           CRTT-ID,
 19714           CERTIFICATE-TRAILERS,
 19715           DFHEIV11,
 19716           WS-ELCRTT-KEY,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV99
 19720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19721
 19722
 19723     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19724         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19725
 19726* EXEC CICS REWRITE
 19727*           DATASET  (CRTT-ID)
 19728*           FROM     (CERTIFICATE-TRAILERS)
 19729*        END-EXEC
 19730     MOVE LENGTH OF
 19731      CERTIFICATE-TRAILERS
 19732       TO DFHEIV11
 19733*    MOVE '&& L                  %   #00018964' TO DFHEIV0
 19734     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19735     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19736     MOVE X'2020233030303138393634' TO DFHEIV0(25:11)
 19737     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 365
* EL050.cbl
 19738           CRTT-ID,
 19739           CERTIFICATE-TRAILERS,
 19740           DFHEIV11,
 19741           DFHEIV99
 19742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19743     ELSE
 19744
 19745* EXEC CICS UNLOCK
 19746*          DATASET  (CRTT-ID)
 19747*       END-EXEC
 19748*    MOVE '&*                    #   #00018969' TO DFHEIV0
 19749     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19750     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19751     MOVE X'2020233030303138393639' TO DFHEIV0(25:11)
 19752     CALL 'kxdfhei1' USING DFHEIV0,
 19753           CRTT-ID,
 19754           DFHEIV99
 19755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19756     END-IF.
 19757
 19758     GO TO 8180-EXIT.
 19759
 19760 8180-NOTFND.
 19761
 19762     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19763     MOVE 'CS'         TO CS-RECORD-ID.
 19764     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19765     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19766     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19767     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19768
 19769* EXEC CICS WRITE
 19770*       DATASET  (CRTT-ID)
 19771*       RIDFLD   (WS-ELCRTT-KEY)
 19772*       FROM     (CERTIFICATE-TRAILERS)
 19773*    END-EXEC.
 19774     MOVE LENGTH OF
 19775      CERTIFICATE-TRAILERS
 19776       TO DFHEIV11
 19777*    MOVE '&$ L                  ''   #00018984' TO DFHEIV0
 19778     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19780     MOVE X'2020233030303138393834' TO DFHEIV0(25:11)
 19781     CALL 'kxdfhei1' USING DFHEIV0,
 19782           CRTT-ID,
 19783           CERTIFICATE-TRAILERS,
 19784           DFHEIV11,
 19785           WS-ELCRTT-KEY,
 19786           DFHEIV99,
 19787           DFHEIV99
 19788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19789
 19790
 19791 8180-EXIT.
 19792     EXIT.
 19793
 19794 8190-UPDATE-REFUND-CLAIM-FLAG.
 19795
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 366
* EL050.cbl
 19796* EXEC CICS HANDLE CONDITION
 19797*        NOTFND   (8190-NOTFND)
 19798*    END-EXEC.
 19799*    MOVE '"$I                   ! 1 #00018994' TO DFHEIV0
 19800     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19802     MOVE X'3120233030303138393934' TO DFHEIV0(25:11)
 19803     CALL 'kxdfhei1' USING DFHEIV0
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19808     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19809
 19810
 19811* EXEC CICS READ
 19812*        UPDATE
 19813*        DATASET  (CRTT-ID)
 19814*        RIDFLD   (WS-ELCRTT-KEY)
 19815*        INTO     (CERTIFICATE-TRAILERS)
 19816*    END-EXEC.
 19817     MOVE LENGTH OF
 19818      CERTIFICATE-TRAILERS
 19819       TO DFHEIV11
 19820*    MOVE '&"IL       EU         (   #00019001' TO DFHEIV0
 19821     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19822     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19823     MOVE X'2020233030303139303031' TO DFHEIV0(25:11)
 19824     CALL 'kxdfhei1' USING DFHEIV0,
 19825           CRTT-ID,
 19826           CERTIFICATE-TRAILERS,
 19827           DFHEIV11,
 19828           WS-ELCRTT-KEY,
 19829           DFHEIV99,
 19830           DFHEIV99,
 19831           DFHEIV99
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19833
 19834
 19835     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19836
 19837* EXEC CICS REWRITE
 19838*       DATASET  (CRTT-ID)
 19839*       FROM     (CERTIFICATE-TRAILERS)
 19840*    END-EXEC.
 19841     MOVE LENGTH OF
 19842      CERTIFICATE-TRAILERS
 19843       TO DFHEIV11
 19844*    MOVE '&& L                  %   #00019009' TO DFHEIV0
 19845     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19847     MOVE X'2020233030303139303039' TO DFHEIV0(25:11)
 19848     CALL 'kxdfhei1' USING DFHEIV0,
 19849           CRTT-ID,
 19850           CERTIFICATE-TRAILERS,
 19851           DFHEIV11,
 19852           DFHEIV99
 19853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 367
* EL050.cbl
 19854
 19855
 19856     GO TO 8190-EXIT.
 19857
 19858 8190-NOTFND.
 19859
 19860     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19861     MOVE 'CS'         TO CS-RECORD-ID.
 19862     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19863     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19864     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19865     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19866
 19867* EXEC CICS WRITE
 19868*       DATASET  (CRTT-ID)
 19869*       RIDFLD   (WS-ELCRTT-KEY)
 19870*       FROM     (CERTIFICATE-TRAILERS)
 19871*    END-EXEC.
 19872     MOVE LENGTH OF
 19873      CERTIFICATE-TRAILERS
 19874       TO DFHEIV11
 19875*    MOVE '&$ L                  ''   #00019024' TO DFHEIV0
 19876     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19878     MOVE X'2020233030303139303234' TO DFHEIV0(25:11)
 19879     CALL 'kxdfhei1' USING DFHEIV0,
 19880           CRTT-ID,
 19881           CERTIFICATE-TRAILERS,
 19882           DFHEIV11,
 19883           WS-ELCRTT-KEY,
 19884           DFHEIV99,
 19885           DFHEIV99
 19886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19887
 19888
 19889 8190-EXIT.
 19890     EXIT.
 19891
 19892 8195-UPDATE-AGE-FLAGS.
 19893
 19894* EXEC CICS HANDLE CONDITION
 19895*        NOTFND   (8195-NOTFND)
 19896*    END-EXEC.
 19897*    MOVE '"$I                   ! 2 #00019034' TO DFHEIV0
 19898     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19900     MOVE X'3220233030303139303334' TO DFHEIV0(25:11)
 19901     CALL 'kxdfhei1' USING DFHEIV0
 19902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19903
 19904
 19905     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19906     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19907
 19908
 19909* EXEC CICS READ
 19910*        UPDATE
 19911*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 368
* EL050.cbl
 19912*        RIDFLD   (WS-ELCRTT-KEY)
 19913*        INTO     (CERTIFICATE-TRAILERS)
 19914*    END-EXEC.
 19915     MOVE LENGTH OF
 19916      CERTIFICATE-TRAILERS
 19917       TO DFHEIV11
 19918*    MOVE '&"IL       EU         (   #00019041' TO DFHEIV0
 19919     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19921     MOVE X'2020233030303139303431' TO DFHEIV0(25:11)
 19922     CALL 'kxdfhei1' USING DFHEIV0,
 19923           CRTT-ID,
 19924           CERTIFICATE-TRAILERS,
 19925           DFHEIV11,
 19926           WS-ELCRTT-KEY,
 19927           DFHEIV99,
 19928           DFHEIV99,
 19929           DFHEIV99
 19930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19931
 19932
 19933     IF WS-INS-AGE-SET = 'Y'
 19934        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19935     END-IF
 19936     IF WS-JNT-AGE-SET = 'Y'
 19937        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19938     END-IF
 19939
 19940
 19941* EXEC CICS REWRITE
 19942*       DATASET  (CRTT-ID)
 19943*       FROM     (CERTIFICATE-TRAILERS)
 19944*    END-EXEC.
 19945     MOVE LENGTH OF
 19946      CERTIFICATE-TRAILERS
 19947       TO DFHEIV11
 19948*    MOVE '&& L                  %   #00019055' TO DFHEIV0
 19949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303139303535' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           CRTT-ID,
 19954           CERTIFICATE-TRAILERS,
 19955           DFHEIV11,
 19956           DFHEIV99
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959
 19960     GO TO 8195-EXIT.
 19961
 19962 8195-NOTFND.
 19963
 19964     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19965     MOVE 'CS'         TO CS-RECORD-ID.
 19966     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19967     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19968     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19969     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 369
* EL050.cbl
 19970     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19971
 19972* EXEC CICS WRITE
 19973*       DATASET  (CRTT-ID)
 19974*       RIDFLD   (WS-ELCRTT-KEY)
 19975*       FROM     (CERTIFICATE-TRAILERS)
 19976*    END-EXEC.
 19977     MOVE LENGTH OF
 19978      CERTIFICATE-TRAILERS
 19979       TO DFHEIV11
 19980*    MOVE '&$ L                  ''   #00019071' TO DFHEIV0
 19981     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19983     MOVE X'2020233030303139303731' TO DFHEIV0(25:11)
 19984     CALL 'kxdfhei1' USING DFHEIV0,
 19985           CRTT-ID,
 19986           CERTIFICATE-TRAILERS,
 19987           DFHEIV11,
 19988           WS-ELCRTT-KEY,
 19989           DFHEIV99,
 19990           DFHEIV99
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994 8195-EXIT.
 19995     EXIT.
 19996
 19997 8200-READ-REIN-TABLE.
 19998
 19999* EXEC CICS HANDLE CONDITION
 20000*         NOTFND   (8200-NOTFND)
 20001*    END-EXEC.
 20002*    MOVE '"$I                   ! 3 #00019081' TO DFHEIV0
 20003     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20005     MOVE X'3320233030303139303831' TO DFHEIV0(25:11)
 20006     CALL 'kxdfhei1' USING DFHEIV0
 20007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20008
 20009
 20010
 20011* EXEC CICS READ
 20012*        DATASET     (REIN-ID)
 20013*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20014*        RIDFLD      (ERREIN-KEY)
 20015*    END-EXEC.
 20016*    MOVE '&"S        E          (   #00019085' TO DFHEIV0
 20017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20019     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
 20020     CALL 'kxdfhei1' USING DFHEIV0,
 20021           REIN-ID,
 20022           DFHEIV20,
 20023           DFHEIV99,
 20024           ERREIN-KEY,
 20025           DFHEIV99,
 20026           DFHEIV99,
 20027           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 370
* EL050.cbl
 20028     SET ADDRESS OF REINSURANCE-RECORD TO
 20029         DFHEIV20
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033     GO TO 8200-EXIT.
 20034
 20035 8200-NOTFND.
 20036     MOVE 'N'             TO WS-REIN-READ-SW.
 20037
 20038 8200-EXIT.
 20039      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 371
* EL050.cbl
 20041
 20042 8300-READ-CTBL-TABLE.
 20043
 20044* EXEC CICS HANDLE CONDITION
 20045*        NOTFND    (8300-NOTFND)
 20046*        DISABLED  (8300-ERRESS-PROBLEM)
 20047*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20048*        ENDFILE   (8300-NOTFND)
 20049*    END-EXEC.
 20050*    MOVE '"$IcJ''                ! 4 #00019101' TO DFHEIV0
 20051     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20053     MOVE X'3420233030303139313031' TO DFHEIV0(25:11)
 20054     CALL 'kxdfhei1' USING DFHEIV0
 20055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20056
 20057
 20058
 20059* EXEC CICS READ
 20060*        DATASET     (CTBL-ID)
 20061*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20062*        RIDFLD      (ERCTBL-KEY)
 20063*    END-EXEC.
 20064*    MOVE '&"S        E          (   #00019108' TO DFHEIV0
 20065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20067     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0,
 20069           CTBL-ID,
 20070           DFHEIV20,
 20071           DFHEIV99,
 20072           ERCTBL-KEY,
 20073           DFHEIV99,
 20074           DFHEIV99,
 20075           DFHEIV99
 20076     SET ADDRESS OF COMM-TABLE-RECORD TO
 20077         DFHEIV20
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20082
 20083     GO TO 8300-EXIT.
 20084
 20085 8300-NOTFND.
 20086
 20087     IF CTBL-SW = '0530'
 20088         MOVE 'AA'                     TO WS-AH-COMP-CD
 20089         MOVE '0550'                   TO CTBL-SW
 20090         MOVE '1'                      TO WS-CTBL-READ-SW
 20091         GO TO 8300-EXIT.
 20092
 20093     IF CTBL-SW = '0540'
 20094         MOVE 'AA'                     TO WS-LF-COMP-CD
 20095         MOVE '0550'                   TO CTBL-SW
 20096         MOVE '1'                      TO WS-CTBL-READ-SW
 20097         GO TO 8300-EXIT.
 20098
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 372
* EL050.cbl
 20099     IF CTBL-SW = '0550'
 20100         MOVE '2'                      TO WS-CTBL-READ-SW
 20101         GO TO 8300-EXIT.
 20102
 20103     GO TO 8300-EXIT.
 20104
 20105 8300-ERRESS-PROBLEM.
 20106
 20107      MOVE ER-8050              TO WS-ERROR.
 20108      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20109
 20110     GO TO 8300-EXIT.
 20111
 20112 8300-EXIT.
 20113      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 373
* EL050.cbl
 20115
 20116
 20117 8400-GETMAIN-ERFORM.
 20118
 20119
 20120* EXEC CICS   GETMAIN
 20121*        LENGTH  (500)
 20122*        SET     (ADDRESS OF FORM-MASTER)
 20123*    END-EXEC.
 20124     MOVE 500
 20125       TO DFHEIV11
 20126*    MOVE '," L                  $   #00019152' TO DFHEIV0
 20127     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20128     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20129     MOVE X'2020233030303139313532' TO DFHEIV0(25:11)
 20130     CALL 'kxdfhei1' USING DFHEIV0,
 20131           DFHEIV20,
 20132           DFHEIV11,
 20133           DFHEIV99
 20134     SET ADDRESS OF FORM-MASTER TO
 20135         DFHEIV20
 20136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20137
 20138
 20139     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20140
 20141 8400-EXIT.
 20142      EXIT.
 20143
 20144 8450-READ-FORM-MASTER.
 20145
 20146
 20147* EXEC CICS  HANDLE CONDITION
 20148*        NOTFND   (8450-FORM-NOT-FOUND)
 20149*        ENDFILE  (8450-FORM-NOT-FOUND)
 20150*    END-EXEC.
 20151*    MOVE '"$I''                  ! 5 #00019164' TO DFHEIV0
 20152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20154     MOVE X'3520233030303139313634' TO DFHEIV0(25:11)
 20155     CALL 'kxdfhei1' USING DFHEIV0
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159
 20160* EXEC CICS   READ
 20161*        DATASET   (FORM-ID)
 20162*        RIDFLD    (ERFORM-KEY)
 20163*        INTO      (FORM-MASTER)
 20164*        GTEQ
 20165*    END-EXEC.
 20166     MOVE LENGTH OF
 20167      FORM-MASTER
 20168       TO DFHEIV11
 20169*    MOVE '&"IL       G          (   #00019169' TO DFHEIV0
 20170     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20172     MOVE X'2020233030303139313639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 374
* EL050.cbl
 20173     CALL 'kxdfhei1' USING DFHEIV0,
 20174           FORM-ID,
 20175           FORM-MASTER,
 20176           DFHEIV11,
 20177           ERFORM-KEY,
 20178           DFHEIV99,
 20179           DFHEIV99,
 20180           DFHEIV99
 20181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20182
 20183
 20184     MOVE  'Y'           TO  FORM-MASTER-SW.
 20185
 20186     GO TO  8450-EXIT.
 20187
 20188 8450-FORM-NOT-FOUND.
 20189
 20190     MOVE  'N'           TO  FORM-MASTER-SW.
 20191
 20192 8450-EXIT.
 20193      EXIT.
 20194
 20195 8500-DATE-CONVERT.
 20196
 20197* EXEC CICS LINK
 20198*        PROGRAM    ('ELDATCV')
 20199*        COMMAREA   (DATE-CONVERSION-DATA)
 20200*        LENGTH     (DC-COMM-LENGTH)
 20201*    END-EXEC.
 20202     MOVE 'ELDATCV' TO DFHEIV1
 20203*    MOVE '."C                   (   #00019188' TO DFHEIV0
 20204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20206     MOVE X'2020233030303139313838' TO DFHEIV0(25:11)
 20207     CALL 'kxdfhei1' USING DFHEIV0,
 20208           DFHEIV1,
 20209           DATE-CONVERSION-DATA,
 20210           DC-COMM-LENGTH,
 20211           DFHEIV99,
 20212           DFHEIV99,
 20213           DFHEIV99,
 20214           DFHEIV99
 20215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20216
 20217
 20218 8500-EXIT.
 20219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 375
* EL050.cbl
 20221
 20222 8555-RELOAD-CONTROL-FILE.
 20223     CONTINUE.
 20224
 20225 8555-EXIT.
 20226     EXIT.
 20227
 20228 8557-GETMAIN-ERPLAN.
 20229
 20230
 20231* EXEC CICS GETMAIN
 20232*        LENGTH    (840)
 20233*        SET       (ADDRESS OF PLAN-RECORDS)
 20234*    END-EXEC.
 20235     MOVE 840
 20236       TO DFHEIV11
 20237*    MOVE '," L                  $   #00019206' TO DFHEIV0
 20238     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20240     MOVE X'2020233030303139323036' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0,
 20242           DFHEIV20,
 20243           DFHEIV11,
 20244           DFHEIV99
 20245     SET ADDRESS OF PLAN-RECORDS TO
 20246         DFHEIV20
 20247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20248
 20249
 20250     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20251
 20252 8557-EXIT.
 20253     EXIT.
 20254
 20255 8560-GETMAIN.
 20256
 20257* EXEC CICS GETMAIN
 20258*        LENGTH    (2000)
 20259*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20260*    END-EXEC.
 20261     MOVE 2000
 20262       TO DFHEIV11
 20263*    MOVE '," L                  $   #00019217' TO DFHEIV0
 20264     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20266     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
 20267     CALL 'kxdfhei1' USING DFHEIV0,
 20268           DFHEIV20,
 20269           DFHEIV11,
 20270           DFHEIV99
 20271     SET ADDRESS OF ACCOUNT-MASTER TO
 20272         DFHEIV20
 20273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20274
 20275
 20276     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20277
 20278 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 376
* EL050.cbl
 20279     EXIT.
 20280
 20281 8570-START-ACCOUNT-MASTER.
 20282
 20283* EXEC CICS HANDLE CONDITION
 20284*        NOTFND    (0199-ACCT-NOT-FOUND)
 20285*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20286*    END-EXEC.
 20287*    MOVE '"$I''                  ! 6 #00019228' TO DFHEIV0
 20288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20290     MOVE X'3620233030303139323238' TO DFHEIV0(25:11)
 20291     CALL 'kxdfhei1' USING DFHEIV0
 20292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20293
 20294
 20295
 20296* EXEC CICS STARTBR
 20297*        DATASET    (ACCT-ID)
 20298*        RIDFLD     (ERACCT-KEY)
 20299*        GTEQ
 20300*    END-EXEC.
 20301     MOVE 0
 20302       TO DFHEIV11
 20303*    MOVE '&,         G          &   #00019233' TO DFHEIV0
 20304     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           ACCT-ID,
 20309           ERACCT-KEY,
 20310           DFHEIV99,
 20311           DFHEIV11,
 20312           DFHEIV99
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316 8570-EXIT.
 20317     EXIT.
 20318
 20319 8580-READ-ACCOUNT-MASTER.
 20320
 20321* EXEC CICS HANDLE CONDITION
 20322*        NOTFND    (0199-ACCT-NOT-FOUND)
 20323*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20324*    END-EXEC.
 20325*    MOVE '"$I''                  ! 7 #00019243' TO DFHEIV0
 20326     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20328     MOVE X'3720233030303139323433' TO DFHEIV0(25:11)
 20329     CALL 'kxdfhei1' USING DFHEIV0
 20330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20331
 20332
 20333
 20334* EXEC CICS READNEXT
 20335*        DATASET     (ACCT-ID)
 20336*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 377
* EL050.cbl
 20337*        RIDFLD      (ERACCT-KEY)
 20338*    END-EXEC.
 20339     MOVE LENGTH OF
 20340      ACCOUNT-MASTER
 20341       TO DFHEIV12
 20342     MOVE 0
 20343       TO DFHEIV11
 20344*    MOVE '&.IL                  )   #00019248' TO DFHEIV0
 20345     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139323438' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           ACCT-ID,
 20350           ACCOUNT-MASTER,
 20351           DFHEIV12,
 20352           ERACCT-KEY,
 20353           DFHEIV99,
 20354           DFHEIV11,
 20355           DFHEIV99,
 20356           DFHEIV99
 20357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20358
 20359
 20360 8580-EXIT.
 20361     EXIT.
 20362
 20363 8582-READ-COMPENSATION-MASTER.
 20364
 20365* EXEC CICS HANDLE CONDITION
 20366*        NOTFND    (8582-COMP-NOT-FOUND)
 20367*        ENDFILE   (8582-COMP-NOT-FOUND)
 20368*    END-EXEC.
 20369*    MOVE '"$I''                  ! 8 #00019258' TO DFHEIV0
 20370     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20372     MOVE X'3820233030303139323538' TO DFHEIV0(25:11)
 20373     CALL 'kxdfhei1' USING DFHEIV0
 20374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20375
 20376
 20377
 20378* EXEC CICS READ
 20379*        DATASET     (COMP-ID)
 20380*        INTO        (COMPENSATION-MASTER)
 20381*        RIDFLD      (ERCOMP-KEY)
 20382*    END-EXEC.
 20383     MOVE LENGTH OF
 20384      COMPENSATION-MASTER
 20385       TO DFHEIV11
 20386*    MOVE '&"IL       E          (   #00019263' TO DFHEIV0
 20387     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20389     MOVE X'2020233030303139323633' TO DFHEIV0(25:11)
 20390     CALL 'kxdfhei1' USING DFHEIV0,
 20391           COMP-ID,
 20392           COMPENSATION-MASTER,
 20393           DFHEIV11,
 20394           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 378
* EL050.cbl
 20395           DFHEIV99,
 20396           DFHEIV99,
 20397           DFHEIV99
 20398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20399
 20400
 20401     MOVE 'Y'                    TO COMP-MASTER-SW
 20402
 20403     GO TO 8582-EXIT
 20404     .
 20405 8582-COMP-NOT-FOUND.
 20406
 20407     MOVE 'N'                    TO COMP-MASTER-SW.
 20408
 20409 8582-EXIT.
 20410     EXIT.
 20411
 20412 8583-READ-ERAGTC.
 20413
 20414* EXEC CICS HANDLE CONDITION
 20415*        NOTFND    (8583-AGTC-NOT-FOUND)
 20416*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20417*    END-EXEC.
 20418*    MOVE '"$I''                  ! 9 #00019281' TO DFHEIV0
 20419     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20421     MOVE X'3920233030303139323831' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0
 20423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20424
 20425
 20426
 20427* EXEC CICS STARTBR
 20428*        DATASET    (AGTC-ID)
 20429*        RIDFLD     (ERAGTC-KEY)
 20430*        GTEQ
 20431*    END-EXEC.
 20432     MOVE 0
 20433       TO DFHEIV11
 20434*    MOVE '&,         G          &   #00019286' TO DFHEIV0
 20435     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20436     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20437     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 20438     CALL 'kxdfhei1' USING DFHEIV0,
 20439           AGTC-ID,
 20440           ERAGTC-KEY,
 20441           DFHEIV99,
 20442           DFHEIV11,
 20443           DFHEIV99
 20444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20445
 20446
 20447 8583-READ-ERAGTC-NEXT.
 20448
 20449* EXEC CICS READNEXT
 20450*        DATASET     (AGTC-ID)
 20451*        INTO        (AGENT-COMMISSIONS)
 20452*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 379
* EL050.cbl
 20453*    END-EXEC.
 20454     MOVE LENGTH OF
 20455      AGENT-COMMISSIONS
 20456       TO DFHEIV12
 20457     MOVE 0
 20458       TO DFHEIV11
 20459*    MOVE '&.IL                  )   #00019293' TO DFHEIV0
 20460     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20462     MOVE X'2020233030303139323933' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0,
 20464           AGTC-ID,
 20465           AGENT-COMMISSIONS,
 20466           DFHEIV12,
 20467           ERAGTC-KEY,
 20468           DFHEIV99,
 20469           DFHEIV11,
 20470           DFHEIV99,
 20471           DFHEIV99
 20472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20473
 20474
 20475*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20476
 20477     GO TO 8583-EXIT
 20478     .
 20479 8583-AGTC-NOT-FOUND.
 20480
 20481     MOVE 'N'                    TO AGTC-MASTER-SW.
 20482
 20483 8583-EXIT.
 20484     EXIT.
 20485
 20486 8584-READ-BANK-CROSS-REF.
 20487
 20488* EXEC CICS HANDLE CONDITION
 20489*        NOTFND    (8584-BXRF-NOT-FOUND)
 20490*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20491*    END-EXEC.
 20492*    MOVE '"$I''                  ! : #00019311' TO DFHEIV0
 20493     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20495     MOVE X'3A20233030303139333131' TO DFHEIV0(25:11)
 20496     CALL 'kxdfhei1' USING DFHEIV0
 20497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20498
 20499
 20500
 20501* EXEC CICS READ
 20502*        DATASET     (BXRF-ID)
 20503*        INTO        (BANK-CROSS-REFERENCE)
 20504*        RIDFLD      (ERBXRF-KEY)
 20505*        LENGTH      (BXRF-REC-LENGTH)
 20506*    END-EXEC.
 20507*    MOVE '&"IL       E          (   #00019316' TO DFHEIV0
 20508     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20510     MOVE X'2020233030303139333136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 380
* EL050.cbl
 20511     CALL 'kxdfhei1' USING DFHEIV0,
 20512           BXRF-ID,
 20513           BANK-CROSS-REFERENCE,
 20514           BXRF-REC-LENGTH,
 20515           ERBXRF-KEY,
 20516           DFHEIV99,
 20517           DFHEIV99,
 20518           DFHEIV99
 20519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20520
 20521
 20522     MOVE 'Y'                    TO BXRF-MASTER-SW
 20523
 20524     GO TO 8584-EXIT
 20525     .
 20526 8584-BXRF-NOT-FOUND.
 20527
 20528     MOVE 'N'                    TO BXRF-MASTER-SW.
 20529
 20530 8584-EXIT.
 20531     EXIT.
 20532
 20533 8585-READ-PLAN-MASTER.
 20534
 20535
 20536* EXEC CICS HANDLE CONDITION
 20537*        NOTFND    (8585-PLAN-NOT-FOUND)
 20538*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20539*    END-EXEC.
 20540*    MOVE '"$I''                  ! ; #00019336' TO DFHEIV0
 20541     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20543     MOVE X'3B20233030303139333336' TO DFHEIV0(25:11)
 20544     CALL 'kxdfhei1' USING DFHEIV0
 20545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20546
 20547
 20548
 20549* EXEC CICS READ
 20550*        DATASET     (PLAN-ID)
 20551*        INTO        (PLAN-MASTER)
 20552*        RIDFLD      (ERPLAN-KEY)
 20553*    END-EXEC.
 20554     MOVE LENGTH OF
 20555      PLAN-MASTER
 20556       TO DFHEIV11
 20557*    MOVE '&"IL       E          (   #00019341' TO DFHEIV0
 20558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20560     MOVE X'2020233030303139333431' TO DFHEIV0(25:11)
 20561     CALL 'kxdfhei1' USING DFHEIV0,
 20562           PLAN-ID,
 20563           PLAN-MASTER,
 20564           DFHEIV11,
 20565           ERPLAN-KEY,
 20566           DFHEIV99,
 20567           DFHEIV99,
 20568           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 381
* EL050.cbl
 20569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20570
 20571
 20572     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20573
 20574     GO TO 8585-EXIT.
 20575
 20576 8585-PLAN-NOT-FOUND.
 20577
 20578     MOVE 'N'                    TO PLAN-MASTER-SW.
 20579
 20580 8585-EXIT.
 20581     EXIT.
 20582
 20583 8586-READ-LOAN-OFFICER.
 20584
 20585* EXEC CICS READ
 20586*        DATASET     (LOFC-ID)
 20587*        INTO        (LOAN-OFFICER-MASTER)
 20588*        RIDFLD      (ERLOFC-KEY)
 20589*        RESP        (WS-RESPONSE)
 20590*    END-EXEC
 20591     MOVE LENGTH OF
 20592      LOAN-OFFICER-MASTER
 20593       TO DFHEIV11
 20594*    MOVE '&"IL       E          (  N#00019359' TO DFHEIV0
 20595     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20597     MOVE X'204E233030303139333539' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0,
 20599           LOFC-ID,
 20600           LOAN-OFFICER-MASTER,
 20601           DFHEIV11,
 20602           ERLOFC-KEY,
 20603           DFHEIV99,
 20604           DFHEIV99,
 20605           DFHEIV99
 20606     MOVE EIBRESP  TO WS-RESPONSE
 20607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20608
 20609     IF WS-RESP-NORMAL
 20610        MOVE 'Y'                 TO LOFC-MASTER-SW
 20611     ELSE
 20612        MOVE 'N'                 TO LOFC-MASTER-SW
 20613     END-IF
 20614     .
 20615 8586-EXIT.
 20616     EXIT.
 20617 8587-START-ERPDEF.
 20618
 20619* EXEC CICS STARTBR
 20620*       DATASET   (PDEF-ID)
 20621*       RIDFLD    (ERPDEF-KEY)
 20622*       GTEQ
 20623*       RESP      (WS-RESPONSE)
 20624*    END-EXEC
 20625     MOVE 0
 20626       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 382
* EL050.cbl
 20627*    MOVE '&,         G          &  N#00019375' TO DFHEIV0
 20628     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20629     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20630     MOVE X'204E233030303139333735' TO DFHEIV0(25:11)
 20631     CALL 'kxdfhei1' USING DFHEIV0,
 20632           PDEF-ID,
 20633           ERPDEF-KEY,
 20634           DFHEIV99,
 20635           DFHEIV11,
 20636           DFHEIV99
 20637     MOVE EIBRESP  TO WS-RESPONSE
 20638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20639     IF WS-RESP-NORMAL
 20640        MOVE 'Y'                 TO PDEF-MASTER-SW
 20641     ELSE
 20642        MOVE 'N'                 TO PDEF-MASTER-SW
 20643     END-IF
 20644     .
 20645 8587-EXIT.
 20646     EXIT.
 20647 8588-READ-ERPDEF.
 20648
 20649* EXEC CICS READNEXT
 20650*       DATASET   (PDEF-ID)
 20651*       RIDFLD    (ERPDEF-KEY)
 20652*       INTO      (PRODUCT-MASTER)
 20653*       RESP      (WS-RESPONSE)
 20654*    END-EXEC
 20655     MOVE LENGTH OF
 20656      PRODUCT-MASTER
 20657       TO DFHEIV12
 20658     MOVE 0
 20659       TO DFHEIV11
 20660*    MOVE '&.IL                  )  N#00019390' TO DFHEIV0
 20661     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20663     MOVE X'204E233030303139333930' TO DFHEIV0(25:11)
 20664     CALL 'kxdfhei1' USING DFHEIV0,
 20665           PDEF-ID,
 20666           PRODUCT-MASTER,
 20667           DFHEIV12,
 20668           ERPDEF-KEY,
 20669           DFHEIV99,
 20670           DFHEIV11,
 20671           DFHEIV99,
 20672           DFHEIV99
 20673     MOVE EIBRESP  TO WS-RESPONSE
 20674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20675     IF WS-RESP-NORMAL
 20676        MOVE 'Y'                 TO PDEF-MASTER-SW
 20677     ELSE
 20678        MOVE 'N'                 TO PDEF-MASTER-SW
 20679     END-IF
 20680     .
 20681 8588-EXIT.
 20682     EXIT.
 20683 8589-ENDBR-ERPDEF.
 20684
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 383
* EL050.cbl
 20685* EXEC CICS ENDBR
 20686*       DATASET   (PDEF-ID)
 20687*    END-EXEC
 20688     MOVE 0
 20689       TO DFHEIV11
 20690*    MOVE '&2                    $   #00019405' TO DFHEIV0
 20691     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20693     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 20694     CALL 'kxdfhei1' USING DFHEIV0,
 20695           PDEF-ID,
 20696           DFHEIV11,
 20697           DFHEIV99
 20698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20699     .
 20700 8589-EXIT.
 20701     EXIT.
 20702 8590-READ-CERT-MASTER.
 20703     IF PB-COMPANY-ID = 'UCL'
 20704         GO TO 8690-READ-CERT-MASTER-UCL.
 20705
 20706
 20707* EXEC CICS HANDLE CONDITION
 20708*         NOTFND    (0299-CERT-NOT-FOUND)
 20709*    END-EXEC.
 20710*    MOVE '"$I                   ! < #00019415' TO DFHEIV0
 20711     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20713     MOVE X'3C20233030303139343135' TO DFHEIV0(25:11)
 20714     CALL 'kxdfhei1' USING DFHEIV0
 20715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20716
 20717
 20718
 20719* EXEC CICS READ
 20720*        DATASET     (CERT-ID)
 20721*        INTO        (CERTIFICATE-MASTER)
 20722*        RIDFLD      (ELCERT-KEY)
 20723*        UPDATE
 20724*    END-EXEC.
 20725     MOVE LENGTH OF
 20726      CERTIFICATE-MASTER
 20727       TO DFHEIV11
 20728*    MOVE '&"IL       EU         (   #00019419' TO DFHEIV0
 20729     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20730     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20731     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 20732     CALL 'kxdfhei1' USING DFHEIV0,
 20733           CERT-ID,
 20734           CERTIFICATE-MASTER,
 20735           DFHEIV11,
 20736           ELCERT-KEY,
 20737           DFHEIV99,
 20738           DFHEIV99,
 20739           DFHEIV99
 20740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20741
 20742
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 384
* EL050.cbl
 20743 8590-EXIT.
 20744     EXIT.
 20745
 20746 8690-READ-CERT-MASTER-UCL.
 20747
 20748* EXEC CICS HANDLE CONDITION
 20749*         NOTFND    (8700-READ-CERT-MASTER)
 20750*    END-EXEC.
 20751*    MOVE '"$I                   ! = #00019430' TO DFHEIV0
 20752     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20754     MOVE X'3D20233030303139343330' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0
 20756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20757
 20758
 20759 8690-READ-CERT-CONT.
 20760
 20761* EXEC CICS READ
 20762*        DATASET     (CERT-ID)
 20763*        INTO        (CERTIFICATE-MASTER)
 20764*        RIDFLD      (ELCERT-KEY)
 20765*        UPDATE
 20766*    END-EXEC.
 20767     MOVE LENGTH OF
 20768      CERTIFICATE-MASTER
 20769       TO DFHEIV11
 20770*    MOVE '&"IL       EU         (   #00019435' TO DFHEIV0
 20771     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20772     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20773     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 20774     CALL 'kxdfhei1' USING DFHEIV0,
 20775           CERT-ID,
 20776           CERTIFICATE-MASTER,
 20777           DFHEIV11,
 20778           ELCERT-KEY,
 20779           DFHEIV99,
 20780           DFHEIV99,
 20781           DFHEIV99
 20782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20783
 20784
 20785     GO TO 8590-EXIT.
 20786
 20787 8700-READ-CERT-MASTER.
 20788     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20789     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20790
 20791* EXEC CICS HANDLE CONDITION
 20792*         DUPKEY    (8720-COMP-ACCOUNTS)
 20793*         ENDFILE   (8730-END-BROWSE)
 20794*         NOTFND    (8740-NOT-FOUND)
 20795*    END-EXEC.
 20796*    MOVE '"$$''I                 ! > #00019447' TO DFHEIV0
 20797     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20799     MOVE X'3E20233030303139343437' TO DFHEIV0(25:11)
 20800     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 385
* EL050.cbl
 20801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20802
 20803
 20804
 20805* EXEC CICS STARTBR
 20806*        DATASET     ('ELCERT5')
 20807*        RIDFLD      (ELCERT2-KEY)
 20808*        EQUAL
 20809*    END-EXEC.
 20810     MOVE 'ELCERT5' TO DFHEIV1
 20811     MOVE 0
 20812       TO DFHEIV11
 20813*    MOVE '&,         E          &   #00019453' TO DFHEIV0
 20814     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20815     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20816     MOVE X'2020233030303139343533' TO DFHEIV0(25:11)
 20817     CALL 'kxdfhei1' USING DFHEIV0,
 20818           DFHEIV1,
 20819           ELCERT2-KEY,
 20820           DFHEIV99,
 20821           DFHEIV11,
 20822           DFHEIV99
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20824
 20825
 20826 8710-READ-NEXT.
 20827
 20828* EXEC CICS READNEXT
 20829*        DATASET     ('ELCERT5')
 20830*        INTO        (CERTIFICATE-MASTER)
 20831*        RIDFLD      (ELCERT2-KEY)
 20832*    END-EXEC.
 20833     MOVE LENGTH OF
 20834      CERTIFICATE-MASTER
 20835       TO DFHEIV12
 20836     MOVE 'ELCERT5' TO DFHEIV1
 20837     MOVE 0
 20838       TO DFHEIV11
 20839*    MOVE '&.IL                  )   #00019460' TO DFHEIV0
 20840     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20841     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20842     MOVE X'2020233030303139343630' TO DFHEIV0(25:11)
 20843     CALL 'kxdfhei1' USING DFHEIV0,
 20844           DFHEIV1,
 20845           CERTIFICATE-MASTER,
 20846           DFHEIV12,
 20847           ELCERT2-KEY,
 20848           DFHEIV99,
 20849           DFHEIV11,
 20850           DFHEIV99,
 20851           DFHEIV99
 20852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20853
 20854
 20855 8720-COMP-ACCOUNTS.
 20856
 20857* EXEC CICS ENTER
 20858*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 386
* EL050.cbl
 20859*         FROM (PB-C-LAST-NAME)
 20860*    END-EXEC.
 20861     MOVE 001
 20862       TO DFHEIV11
 20863*    MOVE ':$F                   %   #00019467' TO DFHEIV0
 20864     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20866     MOVE X'2020233030303139343637' TO DFHEIV0(25:11)
 20867     CALL 'kxdfhei1' USING DFHEIV0,
 20868           DFHEIV11,
 20869           PB-C-LAST-NAME,
 20870           DFHEIV99,
 20871           DFHEIV99
 20872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20873
 20874
 20875
 20876* EXEC CICS ENTER
 20877*         TRACEID (002)
 20878*         FROM (CM-INSURED-LAST-NAME)
 20879*    END-EXEC.
 20880     MOVE 002
 20881       TO DFHEIV11
 20882*    MOVE ':$F                   %   #00019472' TO DFHEIV0
 20883     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303139343732' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           DFHEIV11,
 20888           CM-INSURED-LAST-NAME,
 20889           DFHEIV99,
 20890           DFHEIV99
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894     IF PB-CERT-NO NOT = CM-CERT-NO
 20895         GO TO 8730-END-BROWSE.
 20896
 20897     IF PB-ACCOUNT = CM-ACCOUNT
 20898         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20899             MOVE ER-2799        TO WS-ERROR
 20900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20901             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20902             GO TO 8730-END-BROWSE.
 20903
 20904     GO TO 8710-READ-NEXT.
 20905
 20906 8730-END-BROWSE.
 20907
 20908* EXEC CICS ENDBR
 20909*         DATASET    ('ELCERT5')
 20910*    END-EXEC.
 20911     MOVE 'ELCERT5' TO DFHEIV1
 20912     MOVE 0
 20913       TO DFHEIV11
 20914*    MOVE '&2                    $   #00019490' TO DFHEIV0
 20915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 387
* EL050.cbl
 20917     MOVE X'2020233030303139343930' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0,
 20919           DFHEIV1,
 20920           DFHEIV11,
 20921           DFHEIV99
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925 8740-NOT-FOUND.
 20926     GO TO 0299-CERT-NOT-FOUND.
 20927
 20928 8750-START-ELSTAT.
 20929
 20930* EXEC CICS STARTBR
 20931*       DATASET   (STAT-ID)
 20932*       RIDFLD    (ELSTAT-KEY)
 20933*       GTEQ
 20934*       RESP      (WS-RESPONSE)
 20935*    END-EXEC
 20936     MOVE 0
 20937       TO DFHEIV11
 20938*    MOVE '&,         G          &  N#00019498' TO DFHEIV0
 20939     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20940     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20941     MOVE X'204E233030303139343938' TO DFHEIV0(25:11)
 20942     CALL 'kxdfhei1' USING DFHEIV0,
 20943           STAT-ID,
 20944           ELSTAT-KEY,
 20945           DFHEIV99,
 20946           DFHEIV11,
 20947           DFHEIV99
 20948     MOVE EIBRESP  TO WS-RESPONSE
 20949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20950     IF WS-RESP-NORMAL
 20951        MOVE 'Y'                 TO STAT-MASTER-SW
 20952     ELSE
 20953        MOVE 'N'                 TO STAT-MASTER-SW
 20954     END-IF
 20955     .
 20956 8750-EXIT.
 20957     EXIT.
 20958 8752-READ-ELSTAT.
 20959
 20960* EXEC CICS READNEXT
 20961*       DATASET   (STAT-ID)
 20962*       RIDFLD    (ELSTAT-KEY)
 20963*       INTO      (STATE-FILE)
 20964*       RESP      (WS-RESPONSE)
 20965*    END-EXEC
 20966     MOVE LENGTH OF
 20967      STATE-FILE
 20968       TO DFHEIV12
 20969     MOVE 0
 20970       TO DFHEIV11
 20971*    MOVE '&.IL                  )  N#00019513' TO DFHEIV0
 20972     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20973     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20974     MOVE X'204E233030303139353133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 388
* EL050.cbl
 20975     CALL 'kxdfhei1' USING DFHEIV0,
 20976           STAT-ID,
 20977           STATE-FILE,
 20978           DFHEIV12,
 20979           ELSTAT-KEY,
 20980           DFHEIV99,
 20981           DFHEIV11,
 20982           DFHEIV99,
 20983           DFHEIV99
 20984     MOVE EIBRESP  TO WS-RESPONSE
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20986     IF WS-RESP-NORMAL
 20987        MOVE 'Y'                 TO STAT-MASTER-SW
 20988     ELSE
 20989        MOVE 'N'                 TO STAT-MASTER-SW
 20990     END-IF
 20991     .
 20992 8752-EXIT.
 20993     EXIT.
 20994 8800-GET-COMP-RATE.
 20995     MOVE +1 TO IB.
 20996     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20997         ADD +9 TO IB
 20998         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20999             ADD +9 TO IB
 21000             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21001                MOVE ZEROS       TO WS-WK-RATE
 21002                GO TO 8800-EXIT.
 21003
 21004     IF PB-I-AGE GREATER CT-AGE (1)
 21005         ADD +3 TO IB
 21006         IF PB-I-AGE GREATER CT-AGE (2)
 21007             ADD +3 TO IB
 21008             IF PB-I-AGE GREATER CT-AGE (3)
 21009                MOVE ZEROS       TO WS-WK-RATE
 21010                GO TO 8800-EXIT.
 21011
 21012     IF WS-WORK-TERM GREATER CT-TRM (1)
 21013         ADD +1 TO IB
 21014         IF WS-WORK-TERM GREATER CT-TRM (2)
 21015             ADD +1 TO IB
 21016             IF WS-WORK-TERM GREATER CT-TRM (3)
 21017                MOVE ZEROS       TO WS-WK-RATE
 21018                GO TO 8800-EXIT.
 21019
 21020     IF CT-RT (IB) NOT NUMERIC
 21021         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21022         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21023         GO TO 8800-GET-COMP-RATE.
 21024
 21025     MOVE CT-RT (IB) TO WS-WK-RATE.
 21026
 21027 8800-EXIT.
 21028     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 389
* EL050.cbl
 21030 8900-ADDRESS-FILE.
 21031     IF ERACCT-FILE-ADDRESSED
 21032         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21033         GO TO 8900-ADDRESS-EXIT.
 21034
 21035     IF ELCNTL-FILE-ADDRESSED
 21036         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21037         GO TO 8900-ADDRESS-EXIT.
 21038
 21039     IF ERPLAN-FILE-ADDRESSED
 21040         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21041         GO TO 8900-ADDRESS-EXIT.
 21042
 21043     IF ERFORM-FILE-ADDRESSED
 21044         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21045         GO TO 8900-ADDRESS-EXIT.
 21046
 21047 8900-ADDRESS-EXIT.
 21048     EXIT.
 21049
 21050 9000-READ-CONTROL.
 21051
 21052* EXEC CICS HANDLE CONDITION
 21053*        NOTFND    (9000-NOTFND)
 21054*    END-EXEC.
 21055*    MOVE '"$I                   ! ? #00019584' TO DFHEIV0
 21056     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21058     MOVE X'3F20233030303139353834' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0
 21060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21061
 21062
 21063
 21064* EXEC CICS READ
 21065*        DATASET     (CNTL-ID)
 21066*        SET         (ADDRESS OF CONTROL-FILE)
 21067*        RIDFLD      (ELCNTL-KEY)
 21068*        GTEQ
 21069*    END-EXEC.
 21070*    MOVE '&"S        G          (   #00019588' TO DFHEIV0
 21071     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21073     MOVE X'2020233030303139353838' TO DFHEIV0(25:11)
 21074     CALL 'kxdfhei1' USING DFHEIV0,
 21075           CNTL-ID,
 21076           DFHEIV20,
 21077           DFHEIV99,
 21078           ELCNTL-KEY,
 21079           DFHEIV99,
 21080           DFHEIV99,
 21081           DFHEIV99
 21082     SET ADDRESS OF CONTROL-FILE TO
 21083         DFHEIV20
 21084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21085
 21086
 21087     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 390
* EL050.cbl
 21088
 21089 9000-NOTFND.
 21090     IF RC-SW-1 = '1'
 21091        MOVE ER-2616              TO WS-ERROR
 21092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21093        GO TO 9000-EXIT.
 21094
 21095     IF RC-SW-1 = '2'
 21096        MOVE ER-2602              TO WS-ERROR
 21097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21098
 21099 9000-EXIT.
 21100      EXIT.
 21101
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 391
* EL050.cbl
 21103 9100-READ-CONTROL.
 21104
 21105* EXEC CICS HANDLE CONDITION
 21106*        NOTFND  (9100-NOTFND)
 21107*        ENDFILE (9100-NOTFND)
 21108*    END-EXEC.
 21109*    MOVE '"$I''                  ! @ #00019612' TO DFHEIV0
 21110     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21112     MOVE X'4020233030303139363132' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117
 21118* EXEC CICS READ
 21119*        DATASET     (CNTL-ID)
 21120*        INTO        (CONTROL-FILE)
 21121*        RIDFLD      (ELCNTL-KEY)
 21122*        GTEQ
 21123*    END-EXEC.
 21124     MOVE LENGTH OF
 21125      CONTROL-FILE
 21126       TO DFHEIV11
 21127*    MOVE '&"IL       G          (   #00019617' TO DFHEIV0
 21128     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21130     MOVE X'2020233030303139363137' TO DFHEIV0(25:11)
 21131     CALL 'kxdfhei1' USING DFHEIV0,
 21132           CNTL-ID,
 21133           CONTROL-FILE,
 21134           DFHEIV11,
 21135           ELCNTL-KEY,
 21136           DFHEIV99,
 21137           DFHEIV99,
 21138           DFHEIV99
 21139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21140
 21141
 21142     GO TO 9100-EXIT.
 21143
 21144 9100-NOTFND.
 21145     IF RC-SW-2 = '0'
 21146        MOVE '1'                  TO STATE-RECORD-ERROR
 21147        GO TO 9100-EXIT
 21148     END-IF
 21149     IF RC-SW-2 = '1'
 21150        MOVE '1'                  TO LF-BENEFIT-ERROR
 21151        MOVE ER-2604              TO WS-ERROR
 21152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21153        GO TO 9100-EXIT.
 21154
 21155     IF RC-SW-2 = '2'
 21156        MOVE '1'                  TO AH-BENEFIT-ERROR
 21157        MOVE ER-2605              TO WS-ERROR
 21158        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21159        GO TO 9100-EXIT.
 21160
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 392
* EL050.cbl
 21161     IF RC-SW-2 = '3'
 21162         MOVE ER-2603           TO WS-ERROR
 21163         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21164         GO TO 9100-EXIT.
 21165
 21166     IF RC-SW-2 = '4'
 21167         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21168         GO TO 9100-EXIT.
 21169
 21170     IF RC-SW-2 = '5'
 21171         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21172         IF WS-AH-INPUT-CD-1 = SPACE
 21173             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21174         ELSE
 21175             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21176
 21177 9100-EXIT.
 21178      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 393
* EL050.cbl
 21180 9200-CONTROL-GETMAIN.
 21181
 21182* EXEC CICS GETMAIN
 21183*         LENGTH   (750)
 21184*         SET      (ADDRESS OF CONTROL-FILE)
 21185*    END-EXEC.
 21186     MOVE 750
 21187       TO DFHEIV11
 21188*    MOVE '," L                  $   #00019663' TO DFHEIV0
 21189     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21190     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21191     MOVE X'2020233030303139363633' TO DFHEIV0(25:11)
 21192     CALL 'kxdfhei1' USING DFHEIV0,
 21193           DFHEIV20,
 21194           DFHEIV11,
 21195           DFHEIV99
 21196     SET ADDRESS OF CONTROL-FILE TO
 21197         DFHEIV20
 21198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21199
 21200
 21201     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21202
 21203 9200-EXIT.
 21204     EXIT.
 21205
 21206 9250-UNLOCK-RETURN.
 21207
 21208* EXEC CICS UNLOCK
 21209*        DATASET   (CERT-ID)
 21210*    END-EXEC.
 21211*    MOVE '&*                    #   #00019674' TO DFHEIV0
 21212     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21213     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21214     MOVE X'2020233030303139363734' TO DFHEIV0(25:11)
 21215     CALL 'kxdfhei1' USING DFHEIV0,
 21216           CERT-ID,
 21217           DFHEIV99
 21218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21219
 21220
 21221 9300-ABEND.
 21222     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21223
 21224
 21225* EXEC CICS LINK
 21226*        PROGRAM   ('EL004')
 21227*        COMMAREA  (WS-ERROR-LINE)
 21228*        LENGTH    (72)
 21229*    END-EXEC.
 21230     MOVE 'EL004' TO DFHEIV1
 21231     MOVE 72
 21232       TO DFHEIV11
 21233*    MOVE '."C                   (   #00019681' TO DFHEIV0
 21234     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21236     MOVE X'2020233030303139363831' TO DFHEIV0(25:11)
 21237     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 394
* EL050.cbl
 21238           DFHEIV1,
 21239           WS-ERROR-LINE,
 21240           DFHEIV11,
 21241           DFHEIV99,
 21242           DFHEIV99,
 21243           DFHEIV99,
 21244           DFHEIV99
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21246
 21247
 21248     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21249
 21250
 21251* EXEC CICS ABEND
 21252*        ABCODE ('EL50')
 21253*    END-EXEC.
 21254     MOVE 'EL50' TO DFHEIV5
 21255*    MOVE '.,A                   "   #00019689' TO DFHEIV0
 21256     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21257     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21258     MOVE X'2020233030303139363839' TO DFHEIV0(25:11)
 21259     CALL 'kxdfhei1' USING DFHEIV0,
 21260           DFHEIV5
 21261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21262
 21263
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 395
* EL050.cbl
 21265
 21266******************************************************************
 21267*                                                                *
 21268*            E R R O R   F O R M A T   R O U T I N E             *
 21269*                                                                *
 21270******************************************************************
 21271
 21272 9900-ERROR-FORMAT.
 21273
 21274     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21275                    PB-COMMON-ERROR (2) OR
 21276                    PB-COMMON-ERROR (3) OR
 21277                    PB-COMMON-ERROR (4) OR
 21278                    PB-COMMON-ERROR (5) OR
 21279                    PB-COMMON-ERROR (6) OR
 21280                    PB-COMMON-ERROR (7) OR
 21281                    PB-COMMON-ERROR (8) OR
 21282                    PB-COMMON-ERROR (9) OR
 21283                    PB-COMMON-ERROR (10)
 21284        GO TO 9900-EXIT.
 21285
 21286     IF PB-NO-OF-ERRORS = +10
 21287        GO TO 9900-EXIT.
 21288
 21289     ADD +1  TO PB-NO-OF-ERRORS.
 21290     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21291                                       (PB-NO-OF-ERRORS).
 21292 9900-EXIT.
 21293     EXIT.
 21294
 21295 9990-RETURN.
 21296     IF BROWSE-STARTED
 21297
 21298* EXEC CICS ENDBR
 21299*            DATASET  (ACCT-ID)
 21300*       END-EXEC.
 21301     MOVE 0
 21302       TO DFHEIV11
 21303*    MOVE '&2                    $   #00019726' TO DFHEIV0
 21304     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21305     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21306     MOVE X'2020233030303139373236' TO DFHEIV0(25:11)
 21307     CALL 'kxdfhei1' USING DFHEIV0,
 21308           ACCT-ID,
 21309           DFHEIV11,
 21310           DFHEIV99
 21311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21312
 21313
 21314 9990-EXIT.
 21315     EXIT.
 21316
 21317
 21318****Check for CRTO record, add one if not found.
 21319 9991-CHECK-FOR-ELCRTO.
 21320
 21321* EXEC CICS HANDLE CONDITION
 21322*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 396
* EL050.cbl
 21323*         ENDFILE (9991-CRTO-NOT-FOUND)
 21324*     END-EXEC.
 21325*    MOVE '"$I''                  ! A #00019736' TO DFHEIV0
 21326     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21328     MOVE X'4120233030303139373336' TO DFHEIV0(25:11)
 21329     CALL 'kxdfhei1' USING DFHEIV0
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21331
 21332     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21333     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21334     MOVE +0                     TO ELCRTO-SEQ-NO
 21335
 21336
 21337* EXEC CICS READ
 21338*       DATASET   ('ELCRTO')
 21339*       INTO      (ORIGINAL-CERTIFICATE)
 21340*       RIDFLD    (ELCRTO-KEY)
 21341*       GTEQ
 21342*       RESP      (WS-RESPONSE)
 21343*    END-EXEC
 21344     MOVE LENGTH OF
 21345      ORIGINAL-CERTIFICATE
 21346       TO DFHEIV11
 21347     MOVE 'ELCRTO' TO DFHEIV1
 21348*    MOVE '&"IL       G          (  N#00019744' TO DFHEIV0
 21349     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21351     MOVE X'204E233030303139373434' TO DFHEIV0(25:11)
 21352     CALL 'kxdfhei1' USING DFHEIV0,
 21353           DFHEIV1,
 21354           ORIGINAL-CERTIFICATE,
 21355           DFHEIV11,
 21356           ELCRTO-KEY,
 21357           DFHEIV99,
 21358           DFHEIV99,
 21359           DFHEIV99
 21360     MOVE EIBRESP  TO WS-RESPONSE
 21361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21362
 21363     IF WS-RESP-NORMAL
 21364        AND (OC-CONTROL-PRIMARY (1:33) =
 21365                 PB-CONTROL-BY-ACCOUNT (1:33))
 21366        AND (OC-RECORD-TYPE =  'I')
 21367           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21368               GO TO 9991-CHECK-INDICATORS
 21369           ELSE
 21370               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21371               GO TO 9991-CRTO-ADD-REC
 21372           END-IF
 21373     END-IF.
 21374
 21375 9991-CRTO-NOT-FOUND.
 21376
 21377     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21378     MOVE 'OC'                TO OC-RECORD-ID
 21379     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21380                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 397
* EL050.cbl
 21381     MOVE +4096               TO OC-KEY-SEQ-NO.
 21382
 21383 9991-CRTO-ADD-REC.
 21384
 21385     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21386     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21387     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21388     MOVE 'I'                 TO OC-RECORD-TYPE
 21389     IF PB-ISSUE
 21390         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21391         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21392         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21393         MOVE PB-I-AGE               TO OC-INS-AGE
 21394         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21395         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21396         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21397         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21398         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21399         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21400         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21401         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21402         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21403         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21404         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21405         IF PB-I-JOINT-COMMISSION > +0
 21406             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21407         ELSE
 21408             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21409         END-IF
 21410         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21411         MOVE +0                     TO OC-LF-CANCEL-AMT
 21412                                        OC-LF-ITD-CANCEL-AMT
 21413         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21414         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21415         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21416         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21417         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21418         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21419         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21420         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21421         MOVE +0                     TO OC-AH-CANCEL-AMT
 21422                                        OC-AH-ITD-CANCEL-AMT
 21423         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21424         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21425         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21426     ELSE
 21427         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21428         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21429         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21430         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21431         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21432         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21433         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21434         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21435         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21436          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21437             MOVE SPACES             TO OC-LF-BENCD
 21438             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 398
* EL050.cbl
 21439                                        OC-LF-BEN-AMT
 21440                                        OC-LF-PRM-AMT
 21441                                        OC-LF-ALT-BEN-AMT
 21442                                        OC-LF-ALT-PRM-AMT
 21443                                        OC-LF-COMM-PCT
 21444                                        OC-LF-CANCEL-AMT
 21445             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21446             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21447         ELSE
 21448             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21449             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21450             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21451             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21452             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21453             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21454             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21455             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21456             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21457             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21458         END-IF
 21459         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21460         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21461          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21462             MOVE SPACES             TO OC-AH-BENCD
 21463             MOVE ZEROS              TO OC-AH-TERM
 21464                                        OC-AH-BEN-AMT
 21465                                        OC-AH-PRM-AMT
 21466                                        OC-AH-COMM-PCT
 21467                                        OC-AH-CANCEL-AMT
 21468                                        OC-AH-CP
 21469             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21470             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21471         ELSE
 21472             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21473             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21474             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21475             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21476             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21477             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21478             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21479             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21480             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21481         END-IF
 21482         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21483         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21484         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21485         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21486     END-IF
 21487     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21488
 21489     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21490
 21491
 21492* EXEC CICS READ
 21493*         DATASET   (FILE-ERMAIL)
 21494*         RIDFLD    (MA-CONTROL-PRIMARY)
 21495*         INTO      (MAILING-DATA)
 21496*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 399
* EL050.cbl
 21497*    END-EXEC
 21498     MOVE LENGTH OF
 21499      MAILING-DATA
 21500       TO DFHEIV11
 21501*    MOVE '&"IL       E          (  N#00019880' TO DFHEIV0
 21502     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21504     MOVE X'204E233030303139383830' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0,
 21506           FILE-ERMAIL,
 21507           MAILING-DATA,
 21508           DFHEIV11,
 21509           MA-CONTROL-PRIMARY,
 21510           DFHEIV99,
 21511           DFHEIV99,
 21512           DFHEIV99
 21513     MOVE EIBRESP  TO WS-RESPONSE
 21514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21515
 21516     IF WS-RESP-NORMAL
 21517         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21518     END-IF.
 21519
 21520     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21521     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21522
 21523
 21524* EXEC CICS READ
 21525*         DATASET  (CRTT-ID)
 21526*         RIDFLD   (WS-ELCRTT-KEY)
 21527*         INTO     (CERTIFICATE-TRAILERS)
 21528*         RESP     (WS-RESPONSE)
 21529*    END-EXEC
 21530     MOVE LENGTH OF
 21531      CERTIFICATE-TRAILERS
 21532       TO DFHEIV11
 21533*    MOVE '&"IL       E          (  N#00019894' TO DFHEIV0
 21534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21536     MOVE X'204E233030303139383934' TO DFHEIV0(25:11)
 21537     CALL 'kxdfhei1' USING DFHEIV0,
 21538           CRTT-ID,
 21539           CERTIFICATE-TRAILERS,
 21540           DFHEIV11,
 21541           WS-ELCRTT-KEY,
 21542           DFHEIV99,
 21543           DFHEIV99,
 21544           DFHEIV99
 21545     MOVE EIBRESP  TO WS-RESPONSE
 21546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21547
 21548     IF WS-RESP-NORMAL
 21549         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21550         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21551     END-IF.
 21552
 21553
 21554* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 400
* EL050.cbl
 21555*       DATASET   ('ELCRTO')
 21556*       FROM      (ORIGINAL-CERTIFICATE)
 21557*       RIDFLD    (OC-CONTROL-PRIMARY)
 21558*       RESP      (WS-RESPONSE)
 21559*    END-EXEC.
 21560     MOVE LENGTH OF
 21561      ORIGINAL-CERTIFICATE
 21562       TO DFHEIV11
 21563     MOVE 'ELCRTO' TO DFHEIV1
 21564*    MOVE '&$ L                  ''  N#00019906' TO DFHEIV0
 21565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21567     MOVE X'204E233030303139393036' TO DFHEIV0(25:11)
 21568     CALL 'kxdfhei1' USING DFHEIV0,
 21569           DFHEIV1,
 21570           ORIGINAL-CERTIFICATE,
 21571           DFHEIV11,
 21572           OC-CONTROL-PRIMARY,
 21573           DFHEIV99,
 21574           DFHEIV99
 21575     MOVE EIBRESP  TO WS-RESPONSE
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21577
 21578
 21579     GO TO 9991-EXIT.
 21580
 21581 9991-CHECK-INDICATORS.
 21582
 21583     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21584         GO TO 9991-EXIT
 21585     END-IF.
 21586
 21587     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21588         GO TO 9991-EXIT
 21589     END-IF.
 21590
 21591
 21592* EXEC CICS READ
 21593*       DATASET   ('ELCRTO')
 21594*       INTO      (ORIGINAL-CERTIFICATE)
 21595*       RIDFLD    (OC-CONTROL-PRIMARY)
 21596*       UPDATE
 21597*       RESP      (WS-RESPONSE)
 21598*    END-EXEC
 21599     MOVE LENGTH OF
 21600      ORIGINAL-CERTIFICATE
 21601       TO DFHEIV11
 21602     MOVE 'ELCRTO' TO DFHEIV1
 21603*    MOVE '&"IL       EU         (  N#00019925' TO DFHEIV0
 21604     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21606     MOVE X'204E233030303139393235' TO DFHEIV0(25:11)
 21607     CALL 'kxdfhei1' USING DFHEIV0,
 21608           DFHEIV1,
 21609           ORIGINAL-CERTIFICATE,
 21610           DFHEIV11,
 21611           OC-CONTROL-PRIMARY,
 21612           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 401
* EL050.cbl
 21613           DFHEIV99,
 21614           DFHEIV99
 21615     MOVE EIBRESP  TO WS-RESPONSE
 21616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21617     IF WS-RESP-NORMAL
 21618        IF PB-ISSUE
 21619          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21620          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21621          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21622          MOVE PB-I-AGE               TO OC-INS-AGE
 21623          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21624          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21625          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21626          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21627          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21628          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21629          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21630          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21631          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21632          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21633          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21634          IF PB-I-JOINT-COMMISSION > +0
 21635              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21636          ELSE
 21637              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21638          END-IF
 21639          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21640          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21641          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21642          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21643          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21644          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21645          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21646          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21647          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21648
 21649          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21650
 21651* EXEC CICS READ
 21652*             DATASET   (FILE-ERMAIL)
 21653*             RIDFLD    (MA-CONTROL-PRIMARY)
 21654*             INTO      (MAILING-DATA)
 21655*             RESP      (WS-RESPONSE)
 21656*         END-EXEC
 21657     MOVE LENGTH OF
 21658      MAILING-DATA
 21659       TO DFHEIV11
 21660*    MOVE '&"IL       E          (  N#00019965' TO DFHEIV0
 21661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21663     MOVE X'204E233030303139393635' TO DFHEIV0(25:11)
 21664     CALL 'kxdfhei1' USING DFHEIV0,
 21665           FILE-ERMAIL,
 21666           MAILING-DATA,
 21667           DFHEIV11,
 21668           MA-CONTROL-PRIMARY,
 21669           DFHEIV99,
 21670           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 402
* EL050.cbl
 21671           DFHEIV99
 21672     MOVE EIBRESP  TO WS-RESPONSE
 21673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21674          IF WS-RESP-NORMAL
 21675             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21676          END-IF
 21677
 21678          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21679          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21680
 21681* EXEC CICS READ
 21682*             DATASET  (CRTT-ID)
 21683*             RIDFLD   (WS-ELCRTT-KEY)
 21684*             INTO     (CERTIFICATE-TRAILERS)
 21685*             RESP     (WS-RESPONSE)
 21686*         END-EXEC
 21687     MOVE LENGTH OF
 21688      CERTIFICATE-TRAILERS
 21689       TO DFHEIV11
 21690*    MOVE '&"IL       E          (  N#00019977' TO DFHEIV0
 21691     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21693     MOVE X'204E233030303139393737' TO DFHEIV0(25:11)
 21694     CALL 'kxdfhei1' USING DFHEIV0,
 21695           CRTT-ID,
 21696           CERTIFICATE-TRAILERS,
 21697           DFHEIV11,
 21698           WS-ELCRTT-KEY,
 21699           DFHEIV99,
 21700           DFHEIV99,
 21701           DFHEIV99
 21702     MOVE EIBRESP  TO WS-RESPONSE
 21703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21704          IF WS-RESP-NORMAL
 21705             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21706                               OC-INS-AGE-DEFAULT-FLAG
 21707             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21708                               OC-JNT-AGE-DEFAULT-FLAG
 21709          END-IF
 21710
 21711        ELSE
 21712          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21713             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21714             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21715             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21716          END-IF
 21717          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21718             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21719             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21720             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21721          END-IF
 21722          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21723        END-IF
 21724
 21725* EXEC CICS REWRITE
 21726*          DATASET   ('ELCRTO')
 21727*          FROM      (ORIGINAL-CERTIFICATE)
 21728*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 403
* EL050.cbl
 21729*       END-EXEC
 21730     MOVE LENGTH OF
 21731      ORIGINAL-CERTIFICATE
 21732       TO DFHEIV11
 21733     MOVE 'ELCRTO' TO DFHEIV1
 21734*    MOVE '&& L                  %  N#00020003' TO DFHEIV0
 21735     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21736     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21737     MOVE X'204E233030303230303033' TO DFHEIV0(25:11)
 21738     CALL 'kxdfhei1' USING DFHEIV0,
 21739           DFHEIV1,
 21740           ORIGINAL-CERTIFICATE,
 21741           DFHEIV11,
 21742           DFHEIV99
 21743     MOVE EIBRESP  TO WS-RESPONSE
 21744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21745     END-IF.
 21746
 21747 9991-EXIT.
 21748     EXIT.
 21749
 21750
 21751 9999-RETURN.
 21752     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21753
 21754
 21755* EXEC CICS RETURN
 21756*    END-EXEC.
 21757*    MOVE '.(                    ''   #00020017' TO DFHEIV0
 21758     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21760     MOVE X'2020233030303230303137' TO DFHEIV0(25:11)
 21761     CALL 'kxdfhei1' USING DFHEIV0,
 21762           DFHEIV99,
 21763           DFHEIV99,
 21764           DFHEIV99,
 21765           DFHEIV99,
 21766           DFHEIV99,
 21767           DFHEIV99
 21768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21769
 21770
 21771
 21772* GOBACK.
 21773     MOVE '9%                    "   ' TO DFHEIV0
 21774     MOVE 'EL050' TO DFHEIV1
 21775     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21776     GOBACK.
 21777
 21778 9999-DFHBACK SECTION.
 21779     MOVE '9%                    "   ' TO DFHEIV0
 21780     MOVE 'EL050' TO DFHEIV1
 21781     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21782     GOBACK.
 21783 9999-DFHEXIT.
 21784     IF DFHEIGDJ EQUAL 0001
 21785         NEXT SENTENCE
 21786     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 404
* EL050.cbl
 21787         GO TO 9300-ABEND,
 21788               3990-FILES-NOT-OPEN
 21789         DEPENDING ON DFHEIGDI
 21790     ELSE IF DFHEIGDJ EQUAL 3
 21791         GO TO 6610-START-BROWSE,
 21792               6630-ERRESS-PROBLEM,
 21793               6630-END-OF-FILE
 21794         DEPENDING ON DFHEIGDI
 21795     ELSE IF DFHEIGDJ EQUAL 4
 21796         GO TO 6630-END-OF-FILE,
 21797               6630-ERRESS-PROBLEM,
 21798               6630-ERRESS-PROBLEM,
 21799               6630-END-OF-FILE
 21800         DEPENDING ON DFHEIGDI
 21801     ELSE IF DFHEIGDJ EQUAL 5
 21802         GO TO 6630-END-OF-FILE,
 21803               6630-END-OF-FILE,
 21804               6630-ERRESS-PROBLEM,
 21805               6630-ERRESS-PROBLEM
 21806         DEPENDING ON DFHEIGDI
 21807     ELSE IF DFHEIGDJ EQUAL 6
 21808         GO TO 6660-START-BROWSE,
 21809               6690-ERRESC-PROBLEM,
 21810               6690-ERRESC-PROBLEM,
 21811               6690-END-OF-FILE
 21812         DEPENDING ON DFHEIGDI
 21813     ELSE IF DFHEIGDJ EQUAL 7
 21814         GO TO 6690-END-OF-FILE,
 21815               6690-ERRESC-PROBLEM,
 21816               6690-ERRESC-PROBLEM,
 21817               6690-END-OF-FILE
 21818         DEPENDING ON DFHEIGDI
 21819     ELSE IF DFHEIGDJ EQUAL 8
 21820         GO TO 6690-END-OF-FILE,
 21821               6690-ERRESC-PROBLEM,
 21822               6690-ERRESC-PROBLEM,
 21823               6690-END-OF-FILE
 21824         DEPENDING ON DFHEIGDI
 21825     ELSE IF DFHEIGDJ EQUAL 9
 21826         GO TO 7250-CONTINUE,
 21827               7250-CONTINUE
 21828         DEPENDING ON DFHEIGDI
 21829     ELSE IF DFHEIGDJ EQUAL 10
 21830         GO TO 7300-CONTINUE,
 21831               7300-CONTINUE
 21832         DEPENDING ON DFHEIGDI
 21833     ELSE IF DFHEIGDJ EQUAL 11
 21834         GO TO 8000-FREE-MAIN
 21835         DEPENDING ON DFHEIGDI
 21836     ELSE IF DFHEIGDJ EQUAL 12
 21837         GO TO 8100-NOTFND,
 21838               8100-NOTFND
 21839         DEPENDING ON DFHEIGDI
 21840     ELSE IF DFHEIGDJ EQUAL 13
 21841         GO TO 8110-NOTFND,
 21842               8110-NOTFND
 21843         DEPENDING ON DFHEIGDI
 21844     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 405
* EL050.cbl
 21845         GO TO 8130-EXIT
 21846         DEPENDING ON DFHEIGDI
 21847     ELSE IF DFHEIGDJ EQUAL 15
 21848         GO TO 8150-exit
 21849         DEPENDING ON DFHEIGDI
 21850     ELSE IF DFHEIGDJ EQUAL 16
 21851         GO TO 8180-NOTFND
 21852         DEPENDING ON DFHEIGDI
 21853     ELSE IF DFHEIGDJ EQUAL 17
 21854         GO TO 8190-NOTFND
 21855         DEPENDING ON DFHEIGDI
 21856     ELSE IF DFHEIGDJ EQUAL 18
 21857         GO TO 8195-NOTFND
 21858         DEPENDING ON DFHEIGDI
 21859     ELSE IF DFHEIGDJ EQUAL 19
 21860         GO TO 8200-NOTFND
 21861         DEPENDING ON DFHEIGDI
 21862     ELSE IF DFHEIGDJ EQUAL 20
 21863         GO TO 8300-NOTFND,
 21864               8300-ERRESS-PROBLEM,
 21865               8300-ERRESS-PROBLEM,
 21866               8300-NOTFND
 21867         DEPENDING ON DFHEIGDI
 21868     ELSE IF DFHEIGDJ EQUAL 21
 21869         GO TO 8450-FORM-NOT-FOUND,
 21870               8450-FORM-NOT-FOUND
 21871         DEPENDING ON DFHEIGDI
 21872     ELSE IF DFHEIGDJ EQUAL 22
 21873         GO TO 0199-ACCT-NOT-FOUND,
 21874               0199-ACCT-NOT-FOUND
 21875         DEPENDING ON DFHEIGDI
 21876     ELSE IF DFHEIGDJ EQUAL 23
 21877         GO TO 0199-ACCT-NOT-FOUND,
 21878               0199-ACCT-NOT-FOUND
 21879         DEPENDING ON DFHEIGDI
 21880     ELSE IF DFHEIGDJ EQUAL 24
 21881         GO TO 8582-COMP-NOT-FOUND,
 21882               8582-COMP-NOT-FOUND
 21883         DEPENDING ON DFHEIGDI
 21884     ELSE IF DFHEIGDJ EQUAL 25
 21885         GO TO 8583-AGTC-NOT-FOUND,
 21886               8583-AGTC-NOT-FOUND
 21887         DEPENDING ON DFHEIGDI
 21888     ELSE IF DFHEIGDJ EQUAL 26
 21889         GO TO 8584-BXRF-NOT-FOUND,
 21890               8584-BXRF-NOT-FOUND
 21891         DEPENDING ON DFHEIGDI
 21892     ELSE IF DFHEIGDJ EQUAL 27
 21893         GO TO 8585-PLAN-NOT-FOUND,
 21894               8585-PLAN-NOT-FOUND
 21895         DEPENDING ON DFHEIGDI
 21896     ELSE IF DFHEIGDJ EQUAL 28
 21897         GO TO 0299-CERT-NOT-FOUND
 21898         DEPENDING ON DFHEIGDI
 21899     ELSE IF DFHEIGDJ EQUAL 29
 21900         GO TO 8700-READ-CERT-MASTER
 21901         DEPENDING ON DFHEIGDI
 21902     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:47 Page 406
* EL050.cbl
 21903         GO TO 8720-COMP-ACCOUNTS,
 21904               8730-END-BROWSE,
 21905               8740-NOT-FOUND
 21906         DEPENDING ON DFHEIGDI
 21907     ELSE IF DFHEIGDJ EQUAL 31
 21908         GO TO 9000-NOTFND
 21909         DEPENDING ON DFHEIGDI
 21910     ELSE IF DFHEIGDJ EQUAL 32
 21911         GO TO 9100-NOTFND,
 21912               9100-NOTFND
 21913         DEPENDING ON DFHEIGDI
 21914     ELSE IF DFHEIGDJ EQUAL 33
 21915         GO TO 9991-CRTO-NOT-FOUND,
 21916               9991-CRTO-NOT-FOUND
 21917         DEPENDING ON DFHEIGDI.
 21918     MOVE '9%                    "   ' TO DFHEIV0
 21919     MOVE 'EL050' TO DFHEIV1
 21920     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21921     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40016     Code:       88391
