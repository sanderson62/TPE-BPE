* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    38*-----------------------------------------------------------------
    39*REMARKS.
    40*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   3
* EL6317.cbl
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    48 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    49 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    50 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    51 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    52 77  s1                          pic s999 comp-3 value +0.
    53 77  s2                          pic s999 comp-3 value +0.
    54 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    55 77  WS-REASON-SW                PIC X  VALUE ' '.
    56     88  REASONS-FOUND                  VALUE 'Y'.
    57     88  REASONS-NOT-FOUND              VALUE 'N'.
    58 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    59     88  NO-CERT-RW                 VALUE 'N'.
    60     88  CERT-RW                    VALUE 'Y'.
    61 01  P pointer.
    62 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    63 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    64 01  var-ptr pointer.
    65 01  env-var-len                 pic 9(4)  binary.
    66 01  rc                          pic 9(9)  binary.
    67 01  WS-KIXHOST                  PIC X(10).
    68 01  WS-KIXSYS.
    69     05  WS-KIX-FIL1             PIC X(10).
    70     05  WS-KIX-APPS             PIC X(10).
    71     05  WS-KIX-ENV              PIC X(10).
    72     05  WS-KIX-MYENV            PIC X(10).
    73     05  WS-KIX-SYS              PIC X(10).
    74*                                COPY ELCSCTM.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCTM                             *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-MESSAGE.
    85     12  FILLER                          PIC X(30)
    86            VALUE '** LOGIC SECURITY VIOLATION -'.
    87     12  SM-READ                         PIC X(6).
    88     12  FILLER                          PIC X(5)
    89            VALUE ' PGM='.
    90     12  SM-PGM                          PIC X(6).
    91     12  FILLER                          PIC X(5)
    92            VALUE ' OPR='.
    93     12  SM-PROCESSOR-ID                 PIC X(4).
    94     12  FILLER                          PIC X(6)
    95            VALUE ' TERM='.
    96     12  SM-TERMID                       PIC X(4).
    97     12  FILLER                          PIC XX   VALUE SPACE.
    98     12  SM-JUL-DATE                     PIC 9(5).
    99     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   4
* EL6317.cbl
   100     12  SM-TIME                         PIC 99.99.
   101
   102*                                COPY ELCSCRTY.
   103******************************************************************
   104*                                                                *
   105*                                                                *
   106*                            ELCSCRTY                            *
   107*                            VMOD=2.001                          *
   108*                                                                *
   109*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   110*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   111*        SAVED IN PI-SECURITY-ADDRESS.                           *
   112*                                                                *
   113******************************************************************
   114 01  SECURITY-CONTROL.
   115     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   116     12  FILLER                       PIC XX    VALUE 'SC'.
   117     12  SC-CREDIT-CODES.
   118         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   119             20  SC-CREDIT-DISPLAY    PIC X.
   120             20  SC-CREDIT-UPDATE     PIC X.
   121     12  SC-CLAIMS-CODES.
   122         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   123             20  SC-CLAIMS-DISPLAY    PIC X.
   124             20  SC-CLAIMS-UPDATE     PIC X.
   125 01 srch-commarea.
   126*                                copy ELCADLTRSPI.
   127******************************************************************
   128*                   C H A N G E   L O G
   129*
   130* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   131*-----------------------------------------------------------------
   132*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   133* EFFECTIVE    NUMBER
   134*-----------------------------------------------------------------
   135* 060611    2011022800001  PEMA  NEW COPYBOOK
   136* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   137* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   138******************************************************************
   139****************************************
   140*  commarea for NaperSoft On Demand Admin services letters
   141*  (business logic input & output)
   142****************************************
   143     03  BL-INPUT.
   144         05  BL-DATA-SRCE        PIC X.
   145         05  BL-LETTER-ID        PIC XXXX.
   146         05  BL-CARRIER          PIC X.
   147         05  BL-GROUP            PIC X(6).
   148         05  BL-STATE            PIC XX.
   149         05  BL-ACCOUNT          PIC X(10).
   150         05  BL-EFF-DT           PIC X(10).
   151         05  BL-CERT-NO          PIC X(11).
   152         05  BL-BATCH-NO         PIC X(6).
   153         05  BL-BATCH-SEQ        PIC 9(8).
   154         05  BL-RESP-NO          PIC X(10).
   155         05  BL-NO-OF-COPIES     PIC 99.
   156         05  BL-PROC-ID          PIC XXXX.
   157         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   5
* EL6317.cbl
   158         05  BL-PRINT-NOW-SW     PIC X.
   159         05  BL-ENC-CD           PIC XXX.
   160         05  BL-RESEND-DT        PIC X(10).
   161         05  BL-FOLLOW-UP-DT     PIC X(10).
   162         05  BL-ARCHIVE-NO       PIC 9(8).
   163         05  BL-FUNC             PIC X(8).
   164         05  BL-COMMENTS         PIC X(100).
   165         05  FILLER REDEFINES BL-COMMENTS.
   166             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   167             10  BL-LETTER-TO-ACCT PIC X.
   168             10  BL-LETTER-TO-BENE PIC X.
   169             10  BL-WRITE-ERARCH   PIC X.
   170                 88  ERARCH-QWS      VALUE 'Q'.
   171                 88  ERARCH-BATCH    VALUE 'B'.
   172                 88  ERARCH-TEMP     VALUE 'T'.
   173             10  BL-PROCESS-TYPE PIC X(07).
   174             10  BL-CERT-FORM-ID PIC X(05).
   175             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   176             10  BL-SOURCE-SCREEN PIC X(8).
   177             10  FILLER          PIC X(25).
   178     03  BL-OUTPUT.
   179         05  BL-STATUS                   PIC X.
   180             88  BL-OK                      VALUE "P".
   181             88  BL-FAIL                  VALUE "F".
   182         05  BL-MESSAGE          PIC X(50).
   183     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   184     03  FILLER                  PIC X(31).
   185
   186*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   187*                                COPY ELCZREC.
   188******************************************************************
   189*                                                                *
   190*                                                                *
   191*                            ELCZREC.                            *
   192*                                                                *
   193*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   194*                                                                *
   195******************************************************************
   196*-----------------------------------------------------------------
   197*                   C H A N G E   L O G
   198*
   199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   200*-----------------------------------------------------------------
   201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   202* EFFECTIVE    NUMBER
   203*-----------------------------------------------------------------
   204* 122011    2011022800001  AJRA  NEW FILE
   205* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   206* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   207*-----------------------------------------------------------------
   208 01  W-Z-CONTROL-DATA.
   209     05  W-NUMBER-OF-COPIES      PIC  9.
   210     05  FILLER                  PIC  X.
   211     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   212     05  FILLER                  PIC  X.
   213     05  W-DAYS-TO-RESEND        PIC  999.
   214     05  FILLER                  PIC  X.
   215     05  W-FORM-TO-RESEND        PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   6
* EL6317.cbl
   216     05  FILLER                  PIC  X.
   217     05  W-PROMPT-LETTER         PIC  X.
   218     05  FILLER                  PIC  X.
   219     05  W-ENCLOSURE-CD          PIC  XXX.
   220     05  FILLER                  PIC  X.
   221     05  W-AUTO-CLOSE-IND        PIC  X.
   222     05  FILLER                  PIC  X.
   223     05  W-LETTER-TO-BENE        PIC  X.
   224     05  FILLER                  PIC  X.
   225     05  W-LETTER-TO-ACCT        PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-LETTER-TYPE           PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-PRINT-CERTIFICATE     PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-REFUND-REQUIRED       PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-ONBASE-CODE           PIC  XX.
   234     05  FILLER                  PIC  X.
   235     05  W-ACCT-SUMM             PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-CSO-SUMM              PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-REASONS-REQUIRED      PIC  X.
   240     05  FILLER                  PIC  X(29).
   241 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   242 01  STANDARD-AREAS.
   243     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   244     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   245                                 PIC  X(08).
   246     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   247     12  QID.
   248         16  QID-TERM        PIC X(4)    VALUE SPACES.
   249         16  FILLER          PIC X(4)    VALUE '631J'.
   250     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   251     12  TIME-MT                 PIC S9(7).
   252     12  TIME-MT-R  REDEFINES TIME-MT.
   253         16  FILLER              PIC X.
   254         16  TIME-LMT            PIC 99V99.
   255         16  FILLER              PIC X(2).
   256     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   257     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   258     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   259     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   260     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   261     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   262     12  W-CNTL-KEY.
   263         16  W-CNTL-COMPANY-ID   PIC  X(03).
   264         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   265         16  W-CNTL-GENL.
   266             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   267             20  W-CNTL-GEN2.
   268                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   269                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   270         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   271     12  WS-ELCERT-KEY.
   272         16  W-CERT-COMPANY-CD   PIC X.
   273         16  W-CERT-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   7
* EL6317.cbl
   274         16  W-CERT-GROUPING     PIC X(6).
   275         16  W-CERT-STATE        PIC XX.
   276         16  W-CERT-ACCOUNT      PIC X(10).
   277         16  W-CERT-CERT-EFF-DT  PIC XX.
   278         16  W-CERT-CERT-PRIME   PIC X(10).
   279         16  W-CERT-CERT-SFX     PIC X.
   280
   281     12  WS-ELCRTT-KEY.
   282         16  WS-ELCRTT-PRIMARY   PIC X(33).
   283         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   284     12  ELCRTT-RECORD-LENGTH    PIC S9(4) COMP VALUE +552.
   285     12  ELCRTT-JOURNAL-LENGTH   PIC S9(4) COMP VALUE +575.
   286
   287     12  WS-ELEOBC-KEY.
   288         16  WS-EOBC-COMPANY-CD  PIC X.
   289         16  WS-EOBC-REC-TYPE    PIC X.
   290         16  WS-EOBC-CODE        PIC X(4).
   291         16  FILLER              PIC X(9).
   292     12  WS-ERNOTE-KEY.
   293         16  W-NOTE-COMPANY-CD   PIC X.
   294         16  W-NOTE-CARRIER      PIC X.
   295         16  W-NOTE-GROUPING     PIC X(6).
   296         16  W-NOTE-STATE        PIC XX.
   297         16  W-NOTE-ACCOUNT      PIC X(10).
   298         16  W-NOTE-CERT-EFF-DT  PIC XX.
   299         16  W-NOTE-CERT-PRIME   PIC X(10).
   300         16  W-NOTE-CERT-SFX     PIC X.
   301     12  ELLETR-KEY.
   302         16  LETR-PART-KEY.
   303             20  LETR-COMPANY-CD PIC X.
   304             20  LETR-LETTER-ID  PIC X(4).
   305         16  LETR-FILLER         PIC X(8).
   306         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   307     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   308     12  ERPNDB2-KEY.
   309         16  PNDB2-COMPANY-CD    PIC X.
   310         16  PNDB2-CARRIER       PIC X.
   311         16  PNDB2-GROUPING      PIC X(6).
   312         16  PNDB2-STATE         PIC XX.
   313         16  PNDB2-ACCOUNT       PIC X(10).
   314         16  PNDB2-CERT-EFF-DT   PIC XX.
   315         16  PNDB2-CERT-PRIME    PIC X(10).
   316         16  PNDB2-CERT-SFX      PIC X.
   317         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   318         16  PNDB2-RECORD-TYPE   PIC X.
   319     12  ERPNDB-KEY.
   320         16  PNDB-COMPANY-CD     PIC X.
   321         16  PNDB-BATCH-NO       PIC X(6).
   322         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   323         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   324     12  ERENDT-KEY.
   325         16  ENDT-COMPANY-CD       PIC X.
   326         16  ENDT-CARRIER          PIC X.
   327         16  ENDT-GROUPING         PIC X(6).
   328         16  ENDT-STATE            PIC XX.
   329         16  ENDT-ACCOUNT          PIC X(10).
   330         16  ENDT-CERT-EFF-DT      PIC XX.
   331         16  ENDT-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   8
* EL6317.cbl
   332         16  ENDT-CERT-SFX         PIC X.
   333         16  ENDT-RECORD-TYPE      PIC X.
   334         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   335     12  ELCRTO-KEY.
   336         16  CRTO-COMPANY-CD     PIC X.
   337         16  CRTO-CARRIER        PIC X.
   338         16  CRTO-GROUPING       PIC X(6).
   339         16  CRTO-STATE          PIC XX.
   340         16  CRTO-ACCOUNT        PIC X(10).
   341         16  CRTO-CERT-EFF-DT    PIC XX.
   342         16  CRTO-CERT-PRIME     PIC X(10).
   343         16  CRTO-CERT-SFX       PIC X.
   344         16  CRTO-RECORD-TYPE    PIC X.
   345         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   346     12  WS-ERMAIL-KEY.
   347         16  MAIL-COMPANY-CD     PIC X.
   348         16  MAIL-CARRIER        PIC X.
   349         16  MAIL-GROUPING       PIC X(6).
   350         16  MAIL-STATE          PIC XX.
   351         16  MAIL-ACCOUNT        PIC X(10).
   352         16  MAIL-CERT-EFF-DT    PIC XX.
   353         16  MAIL-CERT-PRIME     PIC X(10).
   354         16  MAIL-CERT-SFX       PIC X.
   355     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   356     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   357     12  WS-CURRENT-DT.
   358         16  FILLER              PIC X(6)    VALUE SPACES.
   359         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   360     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   361     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   362         88  CANCEL-REC            VALUE 'C'.
   363         88  ISSUE-REC             VALUE 'I'.
   364     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   365     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   366     12  ELCNTL-KEY.
   367         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   368         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   369         16  CNTL-ACCESS.
   370             20  CNTL-STATE      PIC XX    VALUE SPACES.
   371             20  FILLER          PIC X     VALUE SPACES.
   372             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   373         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   374     12  ERACCT-KEY.
   375         16  ERACCT-COMP-KEY.
   376             20  ACCT-CO         PIC X     VALUE SPACES.
   377             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   378             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   379             20  ACCT-STATE      PIC XX    VALUE SPACES.
   380             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   381         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   382         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   383     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   384     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   385     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   386     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   387     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   388     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   389     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   9
* EL6317.cbl
   390     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   391     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   392     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   393     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   394     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   395     12  WS-RESPONSE             PIC S9(8)   COMP.
   396         88  RESP-NORMAL                  VALUE +00.
   397         88  RESP-NOTFND                  VALUE +13.
   398         88  RESP-DUPREC                  VALUE +14.
   399         88  RESP-DUPKEY                  VALUE +15.
   400         88  RESP-NOTOPEN                 VALUE +19.
   401         88  RESP-ENDFILE                 VALUE +20.
   402     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   403     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   404     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   405     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   406     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   407     12  PGM-NAME            PIC X(8).
   408     12  TIME-IN             PIC S9(7).
   409     12  TIME-OUT-R  REDEFINES TIME-IN.
   410         16  FILLER          PIC X.
   411         16  TIME-OUT        PIC 99V99.
   412         16  FILLER          PIC X(2).
   413     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   414     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   415     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   416     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   417     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   418     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   419     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   420     12  WS-PHONE.
   421         16  WS-PH1              PIC XXX.
   422         16  WS-PH2              PIC XXX.
   423         16  WS-PH3              PIC XXXX.
   424     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   425     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   426
   427     12  WS-BILLING-NOTE.
   428         16  WS-BN-NOTE          PIC X(25).
   429         16  WS-BN-LTRID         PIC X(4).
   430         16  FILLER              PIC X(3).
   431         16  WS-BN-DATE          PIC X(8).
   432         16  FILLER              PIC X(3).
   433         16  WS-BN-USERID        PIC X(4).
   434         16  FILLER              PIC X(30).
   435     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   436         16  WS-MAN-BN-NOTE      PIC X(63).
   437         16  FILLER              PIC X(14).
   438     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   439
   440 01  NEW-ELCRTO-REC.
   441     12  NEW-ELCRTO-KEY.
   442         16  NCRTO-COMPANY-CD      PIC X.
   443         16  NCRTO-CARRIER         PIC X.
   444         16  NCRTO-GROUPING        PIC X(6).
   445         16  NCRTO-STATE           PIC XX.
   446         16  NCRTO-ACCOUNT         PIC X(10).
   447         16  NCRTO-CERT-EFF-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  10
* EL6317.cbl
   448         16  NCRTO-CERT-PRIME      PIC X(10).
   449         16  NCRTO-CERT-SFX        PIC X.
   450         16  NCRTO-RECORD-TYPE     PIC X.
   451         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   452     12  NEW-ORIG-REC.
   453         16  NCRTO-INS-LAST-NAME   PIC X(15).
   454         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   455         16  NCRTO-INS-MIDDLE-INIT PIC X.
   456         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   457         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   458         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   459         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   460         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   461         16  NCRTO-LF-BENCD        PIC XX.
   462         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   463         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   464         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   465         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   466         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   467         16  NCRTO-LF-EXP-DT       PIC XX.
   468         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   469         16  NCRTO-LF-CANCEL-DT    PIC XX.
   470         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   471         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   472         16  NCRTO-AH-BENCD        PIC XX.
   473         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   474         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   475         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   476         16  NCRTO-AH-EXP-DT       PIC XX.
   477         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   478         16  NCRTO-AH-CP           PIC 99.
   479         16  NCRTO-AH-CANCEL-DT    PIC XX.
   480         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   481         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   482         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   483         16  NCRTO-1ST-PMT-DT      PIC XX.
   484         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   485         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   486         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   487         16  NCRTO-CANCEL-TRAN-IND PIC X.
   488         16  FILLER                PIC X(235).
   489
   490 01  CERT-NOTE-ENTRIES.
   491     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   492         16  CERT-NT-TEXT                PIC X(63).
   493         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   494         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   495         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   496
   497 01  ERCNOT-AREA.
   498     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   499     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   500     12  ERCNOT-KEY.
   501         16  ERCNOT-PARTIAL-KEY.
   502             20 ERCNOT-COMPANY-CD    PIC X.
   503             20 ERCNOT-CARRIER       PIC X.
   504             20 ERCNOT-GROUPING      PIC X(06).
   505             20 ERCNOT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  11
* EL6317.cbl
   506             20 ERCNOT-ACCOUNT       PIC X(10).
   507             20 ERCNOT-EFF-DT        PIC XX.
   508             20 ERCNOT-CERT-NO.
   509                25 ERCNOT-CERT-PRIME PIC X(10).
   510                25 ERCNOT-CERT-SFX   PIC X.
   511             20 ERCNOT-REC-TYP       PIC X.
   512         16 ERCNOT-SEQ           PIC S9(4) COMP.
   513     12  SV-PARTIAL-KEY.
   514         20 SV-COMPANY-CD            PIC X.
   515         20 SV-CARRIER               PIC X.
   516         20 SV-GROUPING              PIC X(06).
   517         20 SV-STATE                 PIC XX.
   518         20 SV-ACCOUNT               PIC X(10).
   519         20 SV-EFF-DT                PIC XX.
   520         20 SV-CERT-NO.
   521            25 SV-CERT-PRIME         PIC X(10).
   522            25 SV-CERT-SFX           PIC X(1).
   523         20 SV-REC-TYP               PIC X.
   524 01  ERROR-MESSAGES.
   525     12  ER-0000                 PIC X(4)  VALUE '0000'.
   526     12  ER-0004                 PIC X(4)  VALUE '0004'.
   527     12  ER-0008                 PIC X(4)  VALUE '0008'.
   528     12  ER-0023                 PIC X(4)  VALUE '0023'.
   529     12  ER-0029                 PIC X(4)  VALUE '0029'.
   530     12  ER-0068                 PIC X(4)  VALUE '0068'.
   531     12  ER-0132                 PIC X(4)  VALUE '0132'.
   532     12  ER-0142                 PIC X(4)  VALUE '0142'.
   533     12  ER-0148                 PIC X(4)  VALUE '0148'.
   534     12  ER-0215                 PIC X(4)  VALUE '0215'.
   535     12  ER-0280                 PIC X(4)  VALUE '0280'.
   536     12  ER-0348                 PIC X(4)  VALUE '0348'.
   537     12  ER-0419                 PIC X(4)  VALUE '0419'.
   538     12  ER-0894                 PIC X(4)  VALUE '0894'.
   539     12  ER-1101                 PIC X(4)  VALUE '1101'.
   540     12  ER-1236                 PIC X(4)  VALUE '1236'.
   541     12  ER-1818                 PIC X(4)  VALUE '1818'.
   542     12  ER-1820                 PIC X(4)  VALUE '1820'.
   543     12  ER-2056                 PIC X(4)  VALUE '2056'.
   544     12  ER-2079                 PIC X(4)  VALUE '2079'.
   545     12  ER-2208                 PIC X(4)  VALUE '2208'.
   546     12  ER-2209                 PIC X(4)  VALUE '2209'.
   547     12  ER-2237                 PIC X(4)  VALUE '2237'.
   548     12  ER-2238                 PIC X(4)  VALUE '2238'.
   549     12  ER-2253                 PIC X(4)  VALUE '2253'.
   550     12  ER-2619                 PIC X(4)  VALUE '2619'.
   551     12  ER-2651                 PIC X(4)  VALUE '2651'.
   552     12  ER-2784                 PIC X(4)  VALUE '2784'.
   553     12  ER-2785                 PIC X(4)  VALUE '2785'.
   554     12  ER-2786                 PIC X(4)  VALUE '2786'.
   555     12  ER-2791                 PIC X(4)  VALUE '2791'.
   556     12  ER-2845                 PIC X(4)  VALUE '2845'.
   557     12  ER-2848                 PIC X(4)  VALUE '2848'.
   558     12  ER-2851                 PIC X(4)  VALUE '2851'.
   559     12  ER-3830                 PIC X(4)  VALUE '3830'.
   560     12  ER-3833                 PIC X(4)  VALUE '3833'.
   561     12  ER-7345                 PIC X(4)  VALUE '7345'.
   562     12  ER-7638                 PIC X(4)  VALUE '7638'.
   563     12  ER-8888                 PIC X(4)  VALUE '8888'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  12
* EL6317.cbl
   564     12  ER-9999                 PIC X(4)  VALUE '9999'.
   565*    COPY ELCDATE.
   566******************************************************************
   567*                                                                *
   568*                                                                *
   569*                            ELCDATE.                            *
   570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   571*                            VMOD=2.003
   572*                                                                *
   573*                                                                *
   574*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   575*                 LENGTH = 200                                   *
   576******************************************************************
   577
   578 01  DATE-CONVERSION-DATA.
   579     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   580     12  DC-OPTION-CODE                PIC X.
   581         88  BIN-TO-GREG                VALUE ' '.
   582         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   583         88  EDIT-GREG-TO-BIN           VALUE '2'.
   584         88  YMD-GREG-TO-BIN            VALUE '3'.
   585         88  MDY-GREG-TO-BIN            VALUE '4'.
   586         88  JULIAN-TO-BIN              VALUE '5'.
   587         88  BIN-PLUS-ELAPSED           VALUE '6'.
   588         88  FIND-CENTURY               VALUE '7'.
   589         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   590         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   591         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   592         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   593         88  JULIAN-TO-BIN-3            VALUE 'C'.
   594         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   595         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   596         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   597         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   598         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   599         88  CHECK-LEAP-YEAR            VALUE 'H'.
   600         88  BIN-3-TO-GREG              VALUE 'I'.
   601         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   602         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   603         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   604         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   605         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   606         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   607         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   608         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   609         88  THREE-CHARACTER-BIN
   610                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   611         88  GREGORIAN-TO-BIN
   612                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   613         88  BIN-TO-GREGORIAN
   614                  VALUES ' ' '1' 'I' '8' 'G'.
   615         88  JULIAN-TO-BINARY
   616                  VALUES '5' 'C' 'E' 'F'.
   617     12  DC-ERROR-CODE                 PIC X.
   618         88  NO-CONVERSION-ERROR        VALUE ' '.
   619         88  DATE-CONVERSION-ERROR
   620                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   621         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  13
* EL6317.cbl
   622         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   623         88  DATE-IS-INVALID            VALUE '3'.
   624         88  DATE1-GREATER-DATE2        VALUE '4'.
   625         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   626         88  DATE-INVALID-OPTION        VALUE '9'.
   627         88  INVALID-CENTURY            VALUE 'A'.
   628         88  ONLY-CENTURY               VALUE 'B'.
   629         88  ONLY-LEAP-YEAR             VALUE 'C'.
   630         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   631     12  DC-END-OF-MONTH               PIC X.
   632         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   633     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   634         88  USE-NORMAL-PROCESS         VALUE ' '.
   635         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   636         88  ADJUST-UP-100-YRS          VALUE '2'.
   637     12  FILLER                        PIC X.
   638     12  DC-CONVERSION-DATES.
   639         16  DC-BIN-DATE-1             PIC XX.
   640         16  DC-BIN-DATE-2             PIC XX.
   641         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   642         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   643                       DC-GREG-DATE-1-EDIT.
   644             20  DC-EDIT1-MONTH        PIC 99.
   645             20  SLASH1-1              PIC X.
   646             20  DC-EDIT1-DAY          PIC 99.
   647             20  SLASH1-2              PIC X.
   648             20  DC-EDIT1-YEAR         PIC 99.
   649         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   650         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   651                     DC-GREG-DATE-2-EDIT.
   652             20  DC-EDIT2-MONTH        PIC 99.
   653             20  SLASH2-1              PIC X.
   654             20  DC-EDIT2-DAY          PIC 99.
   655             20  SLASH2-2              PIC X.
   656             20  DC-EDIT2-YEAR         PIC 99.
   657         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   658         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   659                     DC-GREG-DATE-1-YMD.
   660             20  DC-YMD-YEAR           PIC 99.
   661             20  DC-YMD-MONTH          PIC 99.
   662             20  DC-YMD-DAY            PIC 99.
   663         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   664         16  DC-GREG-DATE-1-MDY-R REDEFINES
   665                      DC-GREG-DATE-1-MDY.
   666             20  DC-MDY-MONTH          PIC 99.
   667             20  DC-MDY-DAY            PIC 99.
   668             20  DC-MDY-YEAR           PIC 99.
   669         16  DC-GREG-DATE-1-ALPHA.
   670             20  DC-ALPHA-MONTH        PIC X(10).
   671             20  DC-ALPHA-DAY          PIC 99.
   672             20  FILLER                PIC XX.
   673             20  DC-ALPHA-CENTURY.
   674                 24 DC-ALPHA-CEN-N     PIC 99.
   675             20  DC-ALPHA-YEAR         PIC 99.
   676         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   677         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   678         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   679         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  14
* EL6317.cbl
   680         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   681                                       PIC 9(05).
   682         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   683             20  DC-JULIAN-YEAR        PIC 99.
   684             20  DC-JULIAN-DAYS        PIC 999.
   685         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   686         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   687         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   688     12  DATE-CONVERSION-VARIBLES.
   689         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   690         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   691             20  FILLER                PIC 9(3).
   692             20  HOLD-CEN-1-CCYY.
   693                 24  HOLD-CEN-1-CC     PIC 99.
   694                 24  HOLD-CEN-1-YY     PIC 99.
   695             20  HOLD-CEN-1-MO         PIC 99.
   696             20  HOLD-CEN-1-DA         PIC 99.
   697         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   698             20  HOLD-CEN-1-R-MO       PIC 99.
   699             20  HOLD-CEN-1-R-DA       PIC 99.
   700             20  HOLD-CEN-1-R-CCYY.
   701                 24  HOLD-CEN-1-R-CC   PIC 99.
   702                 24  HOLD-CEN-1-R-YY   PIC 99.
   703             20  FILLER                PIC 9(3).
   704         16  HOLD-CENTURY-1-X.
   705             20  FILLER                PIC X(3)  VALUE SPACES.
   706             20  HOLD-CEN-1-X-CCYY.
   707                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   708                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   709             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   710             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   711         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   712             20  HOLD-CEN-1-R-X-MO     PIC XX.
   713             20  HOLD-CEN-1-R-X-DA     PIC XX.
   714             20  HOLD-CEN-1-R-X-CCYY.
   715                 24  HOLD-CEN-1-R-X-CC PIC XX.
   716                 24  HOLD-CEN-1-R-X-YY PIC XX.
   717             20  FILLER                PIC XXX.
   718         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   719         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   720         16  DC-JULIAN-DATE-1          PIC 9(07).
   721         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   722             20  DC-JULIAN-1-CCYY.
   723                 24  DC-JULIAN-1-CC    PIC 99.
   724                 24  DC-JULIAN-1-YR    PIC 99.
   725             20  DC-JULIAN-DA-1        PIC 999.
   726         16  DC-JULIAN-DATE-2          PIC 9(07).
   727         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   728             20  DC-JULIAN-2-CCYY.
   729                 24  DC-JULIAN-2-CC    PIC 99.
   730                 24  DC-JULIAN-2-YR    PIC 99.
   731             20  DC-JULIAN-DA-2        PIC 999.
   732         16  DC-GREG-DATE-A-EDIT.
   733             20  DC-EDITA-MONTH        PIC 99.
   734             20  SLASHA-1              PIC X VALUE '/'.
   735             20  DC-EDITA-DAY          PIC 99.
   736             20  SLASHA-2              PIC X VALUE '/'.
   737             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  15
* EL6317.cbl
   738                 24  DC-EDITA-CENT     PIC 99.
   739                 24  DC-EDITA-YEAR     PIC 99.
   740         16  DC-GREG-DATE-B-EDIT.
   741             20  DC-EDITB-MONTH        PIC 99.
   742             20  SLASHB-1              PIC X VALUE '/'.
   743             20  DC-EDITB-DAY          PIC 99.
   744             20  SLASHB-2              PIC X VALUE '/'.
   745             20  DC-EDITB-CCYY.
   746                 24  DC-EDITB-CENT     PIC 99.
   747                 24  DC-EDITB-YEAR     PIC 99.
   748         16  DC-GREG-DATE-CYMD         PIC 9(08).
   749         16  DC-GREG-DATE-CYMD-R REDEFINES
   750                              DC-GREG-DATE-CYMD.
   751             20  DC-CYMD-CEN           PIC 99.
   752             20  DC-CYMD-YEAR          PIC 99.
   753             20  DC-CYMD-MONTH         PIC 99.
   754             20  DC-CYMD-DAY           PIC 99.
   755         16  DC-GREG-DATE-MDCY         PIC 9(08).
   756         16  DC-GREG-DATE-MDCY-R REDEFINES
   757                              DC-GREG-DATE-MDCY.
   758             20  DC-MDCY-MONTH         PIC 99.
   759             20  DC-MDCY-DAY           PIC 99.
   760             20  DC-MDCY-CEN           PIC 99.
   761             20  DC-MDCY-YEAR          PIC 99.
   762    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   763        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   764    12  DC-EL310-DATE                  PIC X(21).
   765    12  FILLER                         PIC X(28).
   766*    COPY ELCTEXT.
   767******************************************************************
   768*                                                                *
   769*                                                                *
   770*                            ELCTEXT.                            *
   771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   772*                            VMOD=2.008                          *
   773*                                                                *
   774*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   775*                                     FORM LETTERS,              *
   776*                                     CERT FORM DISPLAY.
   777*                                                                *
   778*   FILE TYPE = VSAM,KSDS                                        *
   779*   RECORD SIZE = 100   RECFORM = FIXED                          *
   780*                                                                *
   781*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   782*       ALTERNATE INDEX = NONE                                   *
   783*                                                                *
   784*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   785*       ALTERNATE INDEX = NONE                                   *
   786*                                                                *
   787*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   788*       ALTERNATE INDEX = NONE                                   *
   789*                                                                *
   790*   LOG = NO                                                     *
   791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   792******************************************************************
   793 01  TEXT-FILES.
   794     12  TEXT-FILE-ID                PIC XX.
   795         88  FORMS-FILE-TEXT            VALUE 'TF'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  16
* EL6317.cbl
   796         88  LETTER-FILE-TEXT           VALUE 'TL'.
   797         88  HELP-FILE-TEXT             VALUE 'TH'.
   798
   799     12  TX-CONTROL-PRIMARY.
   800         16  TX-COMPANY-CD           PIC X.
   801             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   802         16  TX-ACCESS-CD-GENL       PIC X(12).
   803
   804         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   805             20  TX-LETTER-NO        PIC X(4).
   806             20  FILLER              PIC X(8).
   807
   808         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   809             20  TX-FORM-NO          PIC X(12).
   810
   811         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   812             20  TX-HELP-TYPE        PIC X.
   813                 88  HELP-FOR-GENERAL   VALUE ' '.
   814                 88  HELP-BY-SCREEN     VALUE 'S'.
   815                 88  HELP-BY-ERROR      VALUE 'E'.
   816             20  TX-SCREEN-OR-ERROR  PIC X(4).
   817                 88  GENERAL-INFO-HELP  VALUE '0000'.
   818             20  TX-HELP-FOR-COMPANY  PIC XXX.
   819                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   820             20  FILLER              PIC X(4).
   821
   822         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   823
   824     12  TX-PROCESS-CONTROL          PIC XX.
   825         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   826
   827     12  TX-TEXT-LINE                PIC X(70).
   828
   829     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   830         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   831         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   832         88  TX-VALID-FORM-SQUEEZE-VALUE
   833                                        VALUE 'Y' ' '.
   834
   835     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   836         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   837         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   838         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   839         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   840         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   841         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   842         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   843                                              'K' 'N' ' '
   844                                              'Z'.
   845
   846     12  TX-ARCHIVE-SW               PIC X.
   847         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   848         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   849         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   850
   851     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   852     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   853
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  17
* EL6317.cbl
   854     12  TX-BSR-CODE                 PIC X.
   855         88  TX-BSR-LETTER              VALUE 'B'.
   856         88  TX-NON-BSR-LETTER          VALUE ' '.
   857
   858     12  FILLER                      PIC X.
   859*****************************************************************
   860*    COPY ELCLOGOF.
   861******************************************************************
   862*                                                                *
   863*                                                                *
   864*                            ELCLOGOF.                           *
   865*                            VMOD=2.001                          *
   866*                                                                *
   867*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   868*                                                                *
   869******************************************************************
   870 01  CLASIC-LOGOFF.
   871     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   872     12  LOGOFF-TEXT.
   873         16  FILLER          PIC X(5)    VALUE SPACES.
   874         16  LOGOFF-MSG.
   875             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   876             20  FILLER      PIC X       VALUE SPACES.
   877             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   878         16  FILLER          PIC X(80)
   879           VALUE '* YOU ARE NOW LOGGED OFF'.
   880         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   881         16  FILLER          PIC X       VALUE QUOTE.
   882         16  LOGOFF-SYS-MSG  PIC X(17)
   883           VALUE 'S CLAS-IC SYSTEM '.
   884     12  TEXT-MESSAGES.
   885         16  UNACCESS-MSG    PIC X(29)
   886             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   887         16  PGMIDERR-MSG    PIC X(17)
   888             VALUE 'PROGRAM NOT FOUND'.
   889*    COPY ELCATTR.
   890******************************************************************
   891*                                                                *
   892*                            ELCATTR.                            *
   893*                            VMOD=2.001                          *
   894*                                                                *
   895*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   896*                                                                *
   897*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   898*                                                                *
   899*                   POS 1   P=PROTECTED                          *
   900*                           U=UNPROTECTED                        *
   901*                           S=ASKIP                              *
   902*                   POS 2   A=ALPHA/NUMERIC                      *
   903*                           N=NUMERIC                            *
   904*                   POS 3   N=NORMAL                             *
   905*                           B=BRIGHT                             *
   906*                           D=DARK                               *
   907*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   908*                           OF=MODIFIED DATA TAG OFF             *
   909*                                                                *
   910*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   911******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  18
* EL6317.cbl
   912 01  ATTRIBUTE-LIST.
   913     12  AL-PABOF            PIC X       VALUE 'Y'.
   914     12  AL-PABON            PIC X       VALUE 'Z'.
   915     12  AL-PADOF            PIC X       VALUE '%'.
   916     12  AL-PADON            PIC X       VALUE '_'.
   917     12  AL-PANOF            PIC X       VALUE '-'.
   918     12  AL-PANON            PIC X       VALUE '/'.
   919     12  AL-SABOF            PIC X       VALUE '8'.
   920     12  AL-SABON            PIC X       VALUE '9'.
   921     12  AL-SADOF            PIC X       VALUE '@'.
   922     12  AL-SADON            PIC X       VALUE QUOTE.
   923     12  AL-SANOF            PIC X       VALUE '0'.
   924     12  AL-SANON            PIC X       VALUE '1'.
   925     12  AL-UABOF            PIC X       VALUE 'H'.
   926     12  AL-UABON            PIC X       VALUE 'I'.
   927     12  AL-UADOF            PIC X       VALUE '<'.
   928     12  AL-UADON            PIC X       VALUE '('.
   929     12  AL-UANOF            PIC X       VALUE ' '.
   930     12  AL-UANON            PIC X       VALUE 'A'.
   931     12  AL-UNBOF            PIC X       VALUE 'Q'.
   932     12  AL-UNBON            PIC X       VALUE 'R'.
   933     12  AL-UNDOF            PIC X       VALUE '*'.
   934     12  AL-UNDON            PIC X       VALUE ')'.
   935     12  AL-UNNOF            PIC X       VALUE '&'.
   936     12  AL-UNNON            PIC X       VALUE 'J'.
   937*    COPY ELCEMIB.
   938******************************************************************
   939*                                                                *
   940*                                                                *
   941*                            ELCEMIB.                            *
   942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   943*                            VMOD=2.005                          *
   944*                                                                *
   945*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   946*                                                                *
   947******************************************************************
   948 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   949     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   950     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   951     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   952     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   953     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   954     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   955     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   956     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   957     12  EMI-SWITCH1             PIC X        VALUE '1'.
   958         88  EMI-NO-ERRORS                    VALUE '1'.
   959         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   960         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   961     12  EMI-SWITCH2             PIC X        VALUE '1'.
   962         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   963     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   964         88  EMI-AREA1-EMPTY                  VALUE '1'.
   965         88  EMI-AREA1-FULL                   VALUE '2'.
   966     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   967         88  EMI-AREA2-EMPTY                  VALUE '1'.
   968         88  EMI-AREA2-FULL                   VALUE '2'.
   969     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  19
* EL6317.cbl
   970         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   971         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   972         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   973         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   974         88  EMI-BYPASS-FATALS                VALUE 'X'.
   975     12  EMI-ERROR-LINES.
   976         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   977         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   978         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   979         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   980             20  EMI-ERR-CODES OCCURS 10 TIMES.
   981                 24  EMI-ERR-NUM         PIC X(4).
   982                 24  EMI-FILLER          PIC X.
   983                 24  EMI-SEV             PIC X.
   984                 24  FILLER              PIC X.
   985             20  FILLER                  PIC X(02).
   986     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   987         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   988             20  EMI-ERROR-NUMBER    PIC X(4).
   989             20  EMI-FILL            PIC X.
   990             20  EMI-SEVERITY        PIC X.
   991             20  FILLER              PIC X.
   992             20  EMI-ERROR-TEXT.
   993                 24  EMI-TEXT-VARIABLE   PIC X(10).
   994                 24  FILLER          PIC X(55).
   995     12  EMI-SEVERITY-SAVE           PIC X.
   996         88  EMI-NOTE                    VALUE 'N'.
   997         88  EMI-WARNING                 VALUE 'W'.
   998         88  EMI-FORCABLE                VALUE 'F'.
   999         88  EMI-FATAL                   VALUE 'X'.
  1000     12  EMI-MESSAGE-FLAG            PIC X.
  1001         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1002         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1003     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1004     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1005         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1006         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1007         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1008     12  FILLER                      PIC X(137)  VALUE SPACES.
  1009     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1010     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1011     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1012     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1013*    COPY ELCINTF.
  1014******************************************************************
  1015*                                                                *
  1016*                                                                *
  1017*                            ELCINTF.                            *
  1018*                            VMOD=2.017                          *
  1019*                                                                *
  1020*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1021*                                                                *
  1022*       LENGTH = 1024                                            *
  1023*                                                                *
  1024******************************************************************
  1025*                   C H A N G E   L O G
  1026*
  1027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  20
* EL6317.cbl
  1028*-----------------------------------------------------------------
  1029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1030* EFFECTIVE    NUMBER
  1031*-----------------------------------------------------------------
  1032* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1033******************************************************************
  1034 01  PROGRAM-INTERFACE-BLOCK.
  1035     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1036     12  PI-CALLING-PROGRAM              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1038     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1039     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1040     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1041     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1042     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1043     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1044     12  PI-COMPANY-ID                   PIC XXX.
  1045     12  PI-COMPANY-CD                   PIC X.
  1046
  1047     12  PI-COMPANY-PASSWORD             PIC X(8).
  1048
  1049     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1050
  1051     12  PI-CONTROL-IN-PROGRESS.
  1052         16  PI-CARRIER                  PIC X.
  1053         16  PI-GROUPING                 PIC X(6).
  1054         16  PI-STATE                    PIC XX.
  1055         16  PI-ACCOUNT                  PIC X(10).
  1056         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1057                                         PIC X(10).
  1058         16  PI-CLAIM-CERT-GRP.
  1059             20  PI-CLAIM-NO             PIC X(7).
  1060             20  PI-CERT-NO.
  1061                 25  PI-CERT-PRIME       PIC X(10).
  1062                 25  PI-CERT-SFX         PIC X.
  1063             20  PI-CERT-EFF-DT          PIC XX.
  1064         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1065             20  PI-PLAN-CODE            PIC X(2).
  1066             20  PI-REVISION-NUMBER      PIC X(3).
  1067             20  PI-PLAN-EFF-DT          PIC X(2).
  1068             20  PI-PLAN-EXP-DT          PIC X(2).
  1069             20  FILLER                  PIC X(11).
  1070         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1071             20  PI-OE-REFERENCE-1.
  1072                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1073                 25  PI-OE-REF-1-SUFF    PIC XX.
  1074
  1075     12  PI-SESSION-IN-PROGRESS          PIC X.
  1076         88  CLAIM-SESSION                   VALUE '1'.
  1077         88  CREDIT-SESSION                  VALUE '2'.
  1078         88  WARRANTY-SESSION                VALUE '3'.
  1079         88  MORTGAGE-SESSION                VALUE '4'.
  1080         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1081
  1082
  1083*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1084
  1085     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  21
* EL6317.cbl
  1086     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1087
  1088     12  PI-CREDIT-USER                  PIC X.
  1089         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1090         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1091
  1092     12  PI-CLAIM-USER                   PIC X.
  1093         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1094         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1095
  1096     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1097         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1098         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1099         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1100         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1101         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1102
  1103     12  PI-PROCESSOR-ID                 PIC X(4).
  1104
  1105     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1106
  1107     12  PI-MEMBER-CAPTION               PIC X(10).
  1108
  1109     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1110         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1111
  1112     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1113     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1114     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1115     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1116
  1117     12  PI-AH-OVERRIDE-L1               PIC X.
  1118     12  PI-AH-OVERRIDE-L2               PIC XX.
  1119     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1120     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1121
  1122     12  PI-NEW-SYSTEM                   PIC X(2).
  1123
  1124     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1125     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1126         88  PI-USES-PAID-TO                 VALUE '1'.
  1127     12  PI-CRDTCRD-SYSTEM.
  1128         16  PI-CRDTCRD-USER             PIC X.
  1129             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1130             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1131         16  PI-CC-MONTH-END-DT          PIC XX.
  1132     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1133
  1134     12  PI-OE-REFERENCE-2.
  1135         16  PI-OE-REF-2-PRIME           PIC X(10).
  1136         16  PI-OE-REF-2-SUFF            PIC X.
  1137
  1138     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1139
  1140     12  PI-LANGUAGE-TYPE                PIC X.
  1141             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1142             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1143             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  22
* EL6317.cbl
  1144
  1145     12  PI-POLICY-LINKAGE-IND           PIC X.
  1146         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1147         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1148                                                   LOW-VALUES.
  1149
  1150     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1151     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1152         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1153         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1154
  1155     12  PI-PROCESSOR-CSR-IND            PIC X.
  1156         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1157         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1158
  1159     12  FILLER                          PIC X(3).
  1160
  1161     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1162
  1163     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1164         PI-SYSTEM-LEVEL.
  1165
  1166         16  PI-ENTRY-CODES.
  1167             20  PI-ENTRY-CD-1           PIC X.
  1168             20  PI-ENTRY-CD-2           PIC X.
  1169
  1170         16  PI-RETURN-CODES.
  1171             20  PI-RETURN-CD-1          PIC X.
  1172             20  PI-RETURN-CD-2          PIC X.
  1173
  1174         16  PI-UPDATE-STATUS-SAVE.
  1175             20  PI-UPDATE-BY            PIC X(4).
  1176             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1177
  1178         16  PI-LOWER-CASE-LETTERS       PIC X.
  1179             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1180
  1181*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1182*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1183*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1184
  1185         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1186             88  ST-ACCNT-CNTL               VALUE ' '.
  1187             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1188             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1189             88  ACCNT-CNTL                  VALUE '3'.
  1190             88  CARR-ACCNT-CNTL             VALUE '4'.
  1191
  1192         16  PI-PROCESSOR-CAP-LIST.
  1193             20  PI-SYSTEM-CONTROLS.
  1194                24 PI-SYSTEM-DISPLAY     PIC X.
  1195                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1196                24 PI-SYSTEM-MODIFY      PIC X.
  1197                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1198             20  FILLER                  PIC XX.
  1199             20  PI-DISPLAY-CAP          PIC X.
  1200                 88  DISPLAY-CAP             VALUE 'Y'.
  1201             20  PI-MODIFY-CAP           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  23
* EL6317.cbl
  1202                 88  MODIFY-CAP              VALUE 'Y'.
  1203             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1204                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1205             20  PI-FORCE-CAP            PIC X.
  1206                 88  FORCE-CAP               VALUE 'Y'.
  1207
  1208         16  PI-PROGRAM-CONTROLS.
  1209             20  PI-PGM-PRINT-OPT        PIC X.
  1210             20  PI-PGM-FORMAT-OPT       PIC X.
  1211             20  PI-PGM-PROCESS-OPT      PIC X.
  1212             20  PI-PGM-TOTALS-OPT       PIC X.
  1213
  1214         16  PI-HELP-INTERFACE.
  1215             20  PI-LAST-ERROR-NO        PIC X(4).
  1216             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1217
  1218         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1219             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1220
  1221         16  PI-CR-CONTROL-IN-PROGRESS.
  1222             20  PI-CR-CARRIER           PIC X.
  1223             20  PI-CR-GROUPING          PIC X(6).
  1224             20  PI-CR-STATE             PIC XX.
  1225             20  PI-CR-ACCOUNT           PIC X(10).
  1226             20  PI-CR-FIN-RESP          PIC X(10).
  1227             20  PI-CR-TYPE              PIC X.
  1228
  1229         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1230
  1231         16  PI-CR-MONTH-END-DT          PIC XX.
  1232
  1233         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1234             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1235             88  PI-ZERO-CARRIER             VALUE '1'.
  1236             88  PI-ZERO-GROUPING            VALUE '2'.
  1237             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1238
  1239         16  PI-CARRIER-SECURITY         PIC X.
  1240             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1241
  1242         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1243             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1244             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1245
  1246         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1247             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1248                                         INDEXED BY PI-ACCESS-NDX
  1249                                         PIC X.
  1250
  1251         16  PI-GA-BILLING-CONTROL       PIC X.
  1252             88  PI-GA-BILLING               VALUE '1'.
  1253
  1254         16  PI-MAIL-PROCESSING          PIC X.
  1255             88  PI-MAIL-YES                 VALUE 'Y'.
  1256
  1257         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1258
  1259         16  PI-AR-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  24
* EL6317.cbl
  1260             20  PI-AR-PROCESSING-CNTL   PIC X.
  1261                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1262             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1263             20  PI-AR-MONTH-END-DT      PIC XX.
  1264
  1265         16  PI-MP-SYSTEM.
  1266             20  PI-MORTGAGE-USER            PIC X.
  1267                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1268                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1269             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1270                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1271                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1272                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1273                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1274                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1275             20  PI-MP-MONTH-END-DT          PIC XX.
  1276             20  PI-MP-REFERENCE-NO.
  1277                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1278                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1279
  1280         16  PI-LABEL-CONTROL            PIC X(01).
  1281             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1282             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1283
  1284         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1285             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1286
  1287         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1288             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1289             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1290
  1291         16  FILLER                      PIC X(14).
  1292
  1293     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1294******************************************************************
  1295     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1296        16  PI-ISS-CAN-SW           PIC X.
  1297        16  PI-ERENDT-KEY.
  1298            20  PI-ENDT-COMPANY-CD  PIC X.
  1299            20  PI-ENDT-CARRIER     PIC X.
  1300            20  PI-ENDT-GROUPING    PIC X(6).
  1301            20  PI-ENDT-STATE       PIC XX.
  1302            20  PI-ENDT-ACCOUNT     PIC X(10).
  1303            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1304            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1305            20  PI-ENDT-CERT-SFX    PIC X.
  1306            20  PI-ENDT-RECORD-TYPE PIC X.
  1307            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1308        16  PI-ELCRTO-KEY.
  1309            20  PI-CRTO-COMPANY-CD  PIC X.
  1310            20  PI-CRTO-CARRIER     PIC X.
  1311            20  PI-CRTO-GROUPING    PIC X(6).
  1312            20  PI-CRTO-STATE       PIC XX.
  1313            20  PI-CRTO-ACCOUNT     PIC X(10).
  1314            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1315            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1316            20  PI-CRTO-CERT-SFX    PIC X.
  1317            20  PI-CRTO-RECORD-TYPE PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  25
* EL6317.cbl
  1318            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1319        16  PI-ERPNDB-KEY           PIC X(11).
  1320        16  PI-DOCUMENT-PROCESSED   PIC X.
  1321            88  PI-VERI-PROCESSED      VALUE 'V'.
  1322            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1323        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1324        16  PI-RES-REF-CLM-TYPE     PIC X.
  1325        16  PI-CLM-REFORM-IND       PIC X.
  1326        16  PI-CLEAR-ERROR-SW       PIC X.
  1327            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1328        16  PI-PRINT-CERTIFICATE    PIC X.
  1329        16  PI-ENTERED.
  1330            20  PI-PRTSW-ENTERED    PIC X.
  1331            20  PI-SIGREQ-ENTERED   PIC X.
  1332            20  PI-MONEY-ENTERED    PIC X.
  1333            20  PI-LTRID-ENTERED    PIC X(4).
  1334            20  PI-REASONS-ENTERED  PIC X(84).
  1335            20  PI-CERTNT1-ENTERED  PIC X(63).
  1336            20  PI-CERTNT2-ENTERED  PIC X(63).
  1337        16  FILLER                  PIC X(17).
  1338        16  PI-FINALIZED-IND        PIC X.
  1339        16  PI-BILLNT1-ENTERED      PIC X(63).
  1340        16  PI-BILLNT2-ENTERED      PIC X(63).
  1341        16  FILLER                  PIC X(154).
  1342    12  FILLER                      PIC X(276).
  1343*    COPY ELCAID.
  1344******************************************************************
  1345*                                                                *
  1346*                            ELCAID.                             *
  1347*                            VMOD=2.001                          *
  1348*                                                                *
  1349*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1350*                                                                *
  1351*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1352*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1353******************************************************************
  1354
  1355 01  DFHAID.
  1356   02  DFHNULL   PIC  X  VALUE  ' '.
  1357   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1358   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1359   02  DFHPEN    PIC  X  VALUE  '='.
  1360   02  DFHOPID   PIC  X  VALUE  'W'.
  1361   02  DFHPA1    PIC  X  VALUE  '%'.
  1362   02  DFHPA2    PIC  X  VALUE  '>'.
  1363   02  DFHPA3    PIC  X  VALUE  ','.
  1364   02  DFHPF1    PIC  X  VALUE  '1'.
  1365   02  DFHPF2    PIC  X  VALUE  '2'.
  1366   02  DFHPF3    PIC  X  VALUE  '3'.
  1367   02  DFHPF4    PIC  X  VALUE  '4'.
  1368   02  DFHPF5    PIC  X  VALUE  '5'.
  1369   02  DFHPF6    PIC  X  VALUE  '6'.
  1370   02  DFHPF7    PIC  X  VALUE  '7'.
  1371   02  DFHPF8    PIC  X  VALUE  '8'.
  1372   02  DFHPF9    PIC  X  VALUE  '9'.
  1373   02  DFHPF10   PIC  X  VALUE  ':'.
  1374   02  DFHPF11   PIC  X  VALUE  '#'.
  1375   02  DFHPF12   PIC  X  VALUE  '@'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  26
* EL6317.cbl
  1376   02  DFHPF13   PIC  X  VALUE  'A'.
  1377   02  DFHPF14   PIC  X  VALUE  'B'.
  1378   02  DFHPF15   PIC  X  VALUE  'C'.
  1379   02  DFHPF16   PIC  X  VALUE  'D'.
  1380   02  DFHPF17   PIC  X  VALUE  'E'.
  1381   02  DFHPF18   PIC  X  VALUE  'F'.
  1382   02  DFHPF19   PIC  X  VALUE  'G'.
  1383   02  DFHPF20   PIC  X  VALUE  'H'.
  1384   02  DFHPF21   PIC  X  VALUE  'I'.
  1385*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1386   02  DFHPF22   PIC  X  VALUE  '['.
  1387   02  DFHPF23   PIC  X  VALUE  '.'.
  1388   02  DFHPF24   PIC  X  VALUE  '<'.
  1389   02  DFHMSRE   PIC  X  VALUE  'X'.
  1390   02  DFHSTRF   PIC  X  VALUE  'h'.
  1391   02  DFHTRIG   PIC  X  VALUE  '"'.
  1392 01  FILLER    REDEFINES DFHAID.
  1393     12  FILLER              PIC X(8).
  1394     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1395*   COPY EL6317S.
  1396 01  EL631JI.
  1397     05  FILLER            PIC  X(0012).
  1398*    -------------------------------
  1399     05  DATEL PIC S9(0004) COMP.
  1400     05  DATEF PIC  X(0001).
  1401     05  FILLER REDEFINES DATEF.
  1402         10  DATEA PIC  X(0001).
  1403     05  DATEI PIC  X(0008).
  1404*    -------------------------------
  1405     05  TIMEL PIC S9(0004) COMP.
  1406     05  TIMEF PIC  X(0001).
  1407     05  FILLER REDEFINES TIMEF.
  1408         10  TIMEA PIC  X(0001).
  1409     05  TIMEI PIC  X(0005).
  1410*    -------------------------------
  1411     05  PROCIDL PIC S9(0004) COMP.
  1412     05  PROCIDF PIC  X(0001).
  1413     05  FILLER REDEFINES PROCIDF.
  1414         10  PROCIDA PIC  X(0001).
  1415     05  PROCIDI PIC  X(0004).
  1416*    -------------------------------
  1417     05  HOSTL PIC S9(0004) COMP.
  1418     05  HOSTF PIC  X(0001).
  1419     05  FILLER REDEFINES HOSTF.
  1420         10  HOSTA PIC  X(0001).
  1421     05  HOSTI PIC  X(0009).
  1422*    -------------------------------
  1423     05  SYSL PIC S9(0004) COMP.
  1424     05  SYSF PIC  X(0001).
  1425     05  FILLER REDEFINES SYSF.
  1426         10  SYSA PIC  X(0001).
  1427     05  SYSI PIC  X(0005).
  1428*    -------------------------------
  1429     05  COMPANYL PIC S9(0004) COMP.
  1430     05  COMPANYF PIC  X(0001).
  1431     05  FILLER REDEFINES COMPANYF.
  1432         10  COMPANYA PIC  X(0001).
  1433     05  COMPANYI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  27
* EL6317.cbl
  1434*    -------------------------------
  1435     05  DATASORL PIC S9(0004) COMP.
  1436     05  DATASORF PIC  X(0001).
  1437     05  FILLER REDEFINES DATASORF.
  1438         10  DATASORA PIC  X(0001).
  1439     05  DATASORI PIC  X(0001).
  1440*    -------------------------------
  1441     05  BATCHNOL PIC S9(0004) COMP.
  1442     05  BATCHNOF PIC  X(0001).
  1443     05  FILLER REDEFINES BATCHNOF.
  1444         10  BATCHNOA PIC  X(0001).
  1445     05  BATCHNOI PIC  X(0006).
  1446*    -------------------------------
  1447     05  BSEQNOL PIC S9(0004) COMP.
  1448     05  BSEQNOF PIC  X(0001).
  1449     05  FILLER REDEFINES BSEQNOF.
  1450         10  BSEQNOA PIC  X(0001).
  1451     05  BSEQNOI PIC  X(0008).
  1452*    -------------------------------
  1453     05  ARCHNOL PIC S9(0004) COMP.
  1454     05  ARCHNOF PIC  X(0001).
  1455     05  FILLER REDEFINES ARCHNOF.
  1456         10  ARCHNOA PIC  X(0001).
  1457     05  ARCHNOI PIC  X(0008).
  1458*    -------------------------------
  1459     05  PRTSWL PIC S9(0004) COMP.
  1460     05  PRTSWF PIC  X(0001).
  1461     05  FILLER REDEFINES PRTSWF.
  1462         10  PRTSWA PIC  X(0001).
  1463     05  PRTSWI PIC  X(0001).
  1464*    -------------------------------
  1465     05  CARRL PIC S9(0004) COMP.
  1466     05  CARRF PIC  X(0001).
  1467     05  FILLER REDEFINES CARRF.
  1468         10  CARRA PIC  X(0001).
  1469     05  CARRI PIC  X(0001).
  1470*    -------------------------------
  1471     05  GROUPL PIC S9(0004) COMP.
  1472     05  GROUPF PIC  X(0001).
  1473     05  FILLER REDEFINES GROUPF.
  1474         10  GROUPA PIC  X(0001).
  1475     05  GROUPI PIC  X(0006).
  1476*    -------------------------------
  1477     05  STATEL PIC S9(0004) COMP.
  1478     05  STATEF PIC  X(0001).
  1479     05  FILLER REDEFINES STATEF.
  1480         10  STATEA PIC  X(0001).
  1481     05  STATEI PIC  X(0002).
  1482*    -------------------------------
  1483     05  ACCTL PIC S9(0004) COMP.
  1484     05  ACCTF PIC  X(0001).
  1485     05  FILLER REDEFINES ACCTF.
  1486         10  ACCTA PIC  X(0001).
  1487     05  ACCTI PIC  X(0010).
  1488*    -------------------------------
  1489     05  EFFDTL PIC S9(0004) COMP.
  1490     05  EFFDTF PIC  X(0001).
  1491     05  FILLER REDEFINES EFFDTF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  28
* EL6317.cbl
  1492         10  EFFDTA PIC  X(0001).
  1493     05  EFFDTI PIC  X(0008).
  1494*    -------------------------------
  1495     05  CERTNOL PIC S9(0004) COMP.
  1496     05  CERTNOF PIC  X(0001).
  1497     05  FILLER REDEFINES CERTNOF.
  1498         10  CERTNOA PIC  X(0001).
  1499     05  CERTNOI PIC  X(0010).
  1500*    -------------------------------
  1501     05  CRTSFXL PIC S9(0004) COMP.
  1502     05  CRTSFXF PIC  X(0001).
  1503     05  FILLER REDEFINES CRTSFXF.
  1504         10  CRTSFXA PIC  X(0001).
  1505     05  CRTSFXI PIC  X(0001).
  1506*    -------------------------------
  1507     05  SEQNOL PIC S9(0004) COMP.
  1508     05  SEQNOF PIC  X(0001).
  1509     05  FILLER REDEFINES SEQNOF.
  1510         10  SEQNOA PIC  X(0001).
  1511     05  SEQNOI PIC  X(0006).
  1512*    -------------------------------
  1513     05  SIGREQL PIC S9(0004) COMP.
  1514     05  SIGREQF PIC  X(0001).
  1515     05  FILLER REDEFINES SIGREQF.
  1516         10  SIGREQA PIC  X(0001).
  1517     05  SIGREQI PIC  X(0001).
  1518*    -------------------------------
  1519     05  LTRIDL PIC S9(0004) COMP.
  1520     05  LTRIDF PIC  X(0001).
  1521     05  FILLER REDEFINES LTRIDF.
  1522         10  LTRIDA PIC  X(0001).
  1523     05  LTRIDI PIC  X(0004).
  1524*    -------------------------------
  1525     05  RCD01L PIC S9(0004) COMP.
  1526     05  RCD01F PIC  X(0001).
  1527     05  FILLER REDEFINES RCD01F.
  1528         10  RCD01A PIC  X(0001).
  1529     05  RCD01I PIC  X(0004).
  1530*    -------------------------------
  1531     05  RCD02L PIC S9(0004) COMP.
  1532     05  RCD02F PIC  X(0001).
  1533     05  FILLER REDEFINES RCD02F.
  1534         10  RCD02A PIC  X(0001).
  1535     05  RCD02I PIC  X(0004).
  1536*    -------------------------------
  1537     05  RCD03L PIC S9(0004) COMP.
  1538     05  RCD03F PIC  X(0001).
  1539     05  FILLER REDEFINES RCD03F.
  1540         10  RCD03A PIC  X(0001).
  1541     05  RCD03I PIC  X(0004).
  1542*    -------------------------------
  1543     05  RCD04L PIC S9(0004) COMP.
  1544     05  RCD04F PIC  X(0001).
  1545     05  FILLER REDEFINES RCD04F.
  1546         10  RCD04A PIC  X(0001).
  1547     05  RCD04I PIC  X(0004).
  1548*    -------------------------------
  1549     05  RCD05L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  29
* EL6317.cbl
  1550     05  RCD05F PIC  X(0001).
  1551     05  FILLER REDEFINES RCD05F.
  1552         10  RCD05A PIC  X(0001).
  1553     05  RCD05I PIC  X(0004).
  1554*    -------------------------------
  1555     05  RCD06L PIC S9(0004) COMP.
  1556     05  RCD06F PIC  X(0001).
  1557     05  FILLER REDEFINES RCD06F.
  1558         10  RCD06A PIC  X(0001).
  1559     05  RCD06I PIC  X(0004).
  1560*    -------------------------------
  1561     05  RCD07L PIC S9(0004) COMP.
  1562     05  RCD07F PIC  X(0001).
  1563     05  FILLER REDEFINES RCD07F.
  1564         10  RCD07A PIC  X(0001).
  1565     05  RCD07I PIC  X(0004).
  1566*    -------------------------------
  1567     05  RCD08L PIC S9(0004) COMP.
  1568     05  RCD08F PIC  X(0001).
  1569     05  FILLER REDEFINES RCD08F.
  1570         10  RCD08A PIC  X(0001).
  1571     05  RCD08I PIC  X(0004).
  1572*    -------------------------------
  1573     05  RCD09L PIC S9(0004) COMP.
  1574     05  RCD09F PIC  X(0001).
  1575     05  FILLER REDEFINES RCD09F.
  1576         10  RCD09A PIC  X(0001).
  1577     05  RCD09I PIC  X(0004).
  1578*    -------------------------------
  1579     05  RCD10L PIC S9(0004) COMP.
  1580     05  RCD10F PIC  X(0001).
  1581     05  FILLER REDEFINES RCD10F.
  1582         10  RCD10A PIC  X(0001).
  1583     05  RCD10I PIC  X(0004).
  1584*    -------------------------------
  1585     05  RCD11L PIC S9(0004) COMP.
  1586     05  RCD11F PIC  X(0001).
  1587     05  FILLER REDEFINES RCD11F.
  1588         10  RCD11A PIC  X(0001).
  1589     05  RCD11I PIC  X(0004).
  1590*    -------------------------------
  1591     05  RCD12L PIC S9(0004) COMP.
  1592     05  RCD12F PIC  X(0001).
  1593     05  FILLER REDEFINES RCD12F.
  1594         10  RCD12A PIC  X(0001).
  1595     05  RCD12I PIC  X(0004).
  1596*    -------------------------------
  1597     05  CRTNT1L PIC S9(0004) COMP.
  1598     05  CRTNT1F PIC  X(0001).
  1599     05  FILLER REDEFINES CRTNT1F.
  1600         10  CRTNT1A PIC  X(0001).
  1601     05  CRTNT1I PIC  X(0063).
  1602*    -------------------------------
  1603     05  CRTNT2L PIC S9(0004) COMP.
  1604     05  CRTNT2F PIC  X(0001).
  1605     05  FILLER REDEFINES CRTNT2F.
  1606         10  CRTNT2A PIC  X(0001).
  1607     05  CRTNT2I PIC  X(0063).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  30
* EL6317.cbl
  1608*    -------------------------------
  1609     05  BILNT1L PIC S9(0004) COMP.
  1610     05  BILNT1F PIC  X(0001).
  1611     05  FILLER REDEFINES BILNT1F.
  1612         10  BILNT1A PIC  X(0001).
  1613     05  BILNT1I PIC  X(0063).
  1614*    -------------------------------
  1615     05  BILNT2L PIC S9(0004) COMP.
  1616     05  BILNT2F PIC  X(0001).
  1617     05  FILLER REDEFINES BILNT2F.
  1618         10  BILNT2A PIC  X(0001).
  1619     05  BILNT2I PIC  X(0063).
  1620*    -------------------------------
  1621     05  ERRMSG1L PIC S9(0004) COMP.
  1622     05  ERRMSG1F PIC  X(0001).
  1623     05  FILLER REDEFINES ERRMSG1F.
  1624         10  ERRMSG1A PIC  X(0001).
  1625     05  ERRMSG1I PIC  X(0075).
  1626*    -------------------------------
  1627     05  ERRMSG2L PIC S9(0004) COMP.
  1628     05  ERRMSG2F PIC  X(0001).
  1629     05  FILLER REDEFINES ERRMSG2F.
  1630         10  ERRMSG2A PIC  X(0001).
  1631     05  ERRMSG2I PIC  X(0075).
  1632*    -------------------------------
  1633     05  PFENTRL PIC S9(0004) COMP.
  1634     05  PFENTRF PIC  X(0001).
  1635     05  FILLER REDEFINES PFENTRF.
  1636         10  PFENTRA PIC  X(0001).
  1637     05  PFENTRI PIC  9(2).
  1638 01  EL631JO REDEFINES EL631JI.
  1639     05  FILLER            PIC  X(0012).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  DATEO PIC  X(0008).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  TIMEO PIC  99.99.
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  PROCIDO PIC  X(0004).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  HOSTO PIC  X(0009).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  SYSO PIC  X(0005).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  COMPANYO PIC  X(0003).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  DATASORO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  BATCHNOO PIC  X(0006).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  31
* EL6317.cbl
  1666     05  BSEQNOO PIC  X(0008).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  ARCHNOO PIC  X(0008).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  PRTSWO PIC  X(0001).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  CARRO PIC  X(0001).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  GROUPO PIC  X(0006).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  STATEO PIC  X(0002).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  ACCTO PIC  X(0010).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  EFFDTO PIC  X(0008).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  CERTNOO PIC  X(0010).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  CRTSFXO PIC  X(0001).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  SEQNOO PIC  999999.
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  SIGREQO PIC  X(0001).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  LTRIDO PIC  X(0004).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  RCD01O PIC  X(0004).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  RCD02O PIC  X(0004).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  RCD03O PIC  X(0004).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  RCD04O PIC  X(0004).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  RCD05O PIC  X(0004).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  RCD06O PIC  X(0004).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  RCD07O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  32
* EL6317.cbl
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  RCD08O PIC  X(0004).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RCD09O PIC  X(0004).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  RCD10O PIC  X(0004).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  RCD11O PIC  X(0004).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  RCD12O PIC  X(0004).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CRTNT1O PIC  X(0063).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  CRTNT2O PIC  X(0063).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  BILNT1O PIC  X(0063).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  BILNT2O PIC  X(0063).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  ERRMSG1O PIC  X(0075).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  ERRMSG2O PIC  X(0075).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  PFENTRO PIC  X(0002).
  1760*    -------------------------------
  1761 01  filler redefines el631ji.
  1762     12  filler                   pic x(182).
  1763     12  REASONCDS.
  1764         16  filler occurs 12.
  1765             20  reacdl       pic s9(4) comp.
  1766             20  reacda       pic x.
  1767             20  reacd-in     pic x(4).
  1768    12  FILLER                   PIC X(293).
  1769****************************************************************
  1770*
  1771* Copyright (c) 2007 by Clerity Solutions, Inc.
  1772* All rights reserved.
  1773*
  1774****************************************************************
  1775 01  DFHEIV.
  1776   02  DFHEIV0               PIC X(35).
  1777   02  DFHEIV1               PIC X(08).
  1778   02  DFHEIV2               PIC X(08).
  1779   02  DFHEIV3               PIC X(08).
  1780   02  DFHEIV4               PIC X(06).
  1781   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  33
* EL6317.cbl
  1782   02  DFHEIV6               PIC X(04).
  1783   02  DFHEIV7               PIC X(02).
  1784   02  DFHEIV8               PIC X(02).
  1785   02  DFHEIV9               PIC X(01).
  1786   02  DFHEIV10              PIC S9(7) COMP-3.
  1787   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1788   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1789   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1790   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1791   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1792   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1793   02  DFHEIV17              PIC X(04).
  1794   02  DFHEIV18              PIC X(04).
  1795   02  DFHEIV19              PIC X(04).
  1796   02  DFHEIV20              USAGE IS POINTER.
  1797   02  DFHEIV21              USAGE IS POINTER.
  1798   02  DFHEIV22              USAGE IS POINTER.
  1799   02  DFHEIV23              USAGE IS POINTER.
  1800   02  DFHEIV24              USAGE IS POINTER.
  1801   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1802   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1803   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1804   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1805   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1806   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1807   02  FILLER                PIC X(02).
  1808   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1809   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1810   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1811   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1812   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1813 LINKAGE  SECTION.
  1814*****************************************************************
  1815*                                                               *
  1816* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1817* All rights reserved.                                          *
  1818*                                                               *
  1819*****************************************************************
  1820 01  dfheiblk.
  1821     02  eibtime          pic s9(7) comp-3.
  1822     02  eibdate          pic s9(7) comp-3.
  1823     02  eibtrnid         pic x(4).
  1824     02  eibtaskn         pic s9(7) comp-3.
  1825     02  eibtrmid         pic x(4).
  1826     02  dfheigdi         pic s9(4) comp.
  1827     02  eibcposn         pic s9(4) comp.
  1828     02  eibcalen         pic s9(4) comp.
  1829     02  eibaid           pic x(1).
  1830     02  eibfiller1       pic x(1).
  1831     02  eibfn            pic x(2).
  1832     02  eibfiller2       pic x(2).
  1833     02  eibrcode         pic x(6).
  1834     02  eibfiller3       pic x(2).
  1835     02  eibds            pic x(8).
  1836     02  eibreqid         pic x(8).
  1837     02  eibrsrce         pic x(8).
  1838     02  eibsync          pic x(1).
  1839     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  34
* EL6317.cbl
  1840     02  eibrecv          pic x(1).
  1841     02  eibsend          pic x(1).
  1842     02  eibatt           pic x(1).
  1843     02  eibeoc           pic x(1).
  1844     02  eibfmh           pic x(1).
  1845     02  eibcompl         pic x(1).
  1846     02  eibsig           pic x(1).
  1847     02  eibconf          pic x(1).
  1848     02  eiberr           pic x(1).
  1849     02  eibrldbk         pic x(1).
  1850     02  eiberrcd         pic x(4).
  1851     02  eibsynrb         pic x(1).
  1852     02  eibnodat         pic x(1).
  1853     02  eibfiller5       pic x(2).
  1854     02  eibresp          pic 9(09) comp.
  1855     02  eibresp2         pic 9(09) comp.
  1856     02  dfheigdj         pic s9(4) comp.
  1857     02  dfheigdk         pic s9(4) comp.
  1858 01  DFHCOMMAREA                 PIC X(1300).
  1859 01  var  pic x(30).
  1860*                                COPY ERCACCT.
  1861******************************************************************
  1862*                                                                *
  1863*                                                                *
  1864*                            ERCACCT                             *
  1865*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1866*                            VMOD=2.031                          *
  1867*                                                                *
  1868*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1869*                                                                *
  1870*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1871*   VSAM ACCOUNT MASTER FILES.                                   *
  1872*                                                                *
  1873*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1874*                                                                *
  1875*   FILE TYPE = VSAM,KSDS                                        *
  1876*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1877*                                                                *
  1878*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1879*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1880*                                                                *
  1881*   LOG = NO                                                     *
  1882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1883*                                                                *
  1884*                                                                *
  1885******************************************************************
  1886*                   C H A N G E   L O G
  1887*
  1888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1889*-----------------------------------------------------------------
  1890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1891* EFFECTIVE    NUMBER
  1892*-----------------------------------------------------------------
  1893* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1894* 092705    2005050300006  PEMA  ADD SPP LEASES
  1895* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1896* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1897* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  35
* EL6317.cbl
  1898* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1899* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1900******************************************************************
  1901
  1902 01  ACCOUNT-MASTER.
  1903     12  AM-RECORD-ID                      PIC XX.
  1904         88  VALID-AM-ID                      VALUE 'AM'.
  1905
  1906     12  AM-CONTROL-PRIMARY.
  1907         16  AM-COMPANY-CD                 PIC X.
  1908         16  AM-MSTR-CNTRL.
  1909             20  AM-CONTROL-A.
  1910                 24  AM-CARRIER            PIC X.
  1911                 24  AM-GROUPING.
  1912                     28 AM-GROUPING-PREFIX PIC XXX.
  1913                     28 AM-GROUPING-PRIME  PIC XXX.
  1914                 24  AM-STATE              PIC XX.
  1915                 24  AM-ACCOUNT.
  1916                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1917                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1918             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1919                                           PIC X(19).
  1920             20  AM-CNTRL-B.
  1921                 24  AM-EXPIRATION-DT      PIC XX.
  1922                 24  FILLER                PIC X(4).
  1923             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1924                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1925
  1926     12  AM-CONTROL-BY-VAR-GRP.
  1927         16  AM-COMPANY-CD-A1              PIC X.
  1928         16  AM-VG-CARRIER                 PIC X.
  1929         16  AM-VG-GROUPING                PIC X(6).
  1930         16  AM-VG-STATE                   PIC XX.
  1931         16  AM-VG-ACCOUNT                 PIC X(10).
  1932         16  AM-VG-DATE.
  1933             20  AM-VG-EXPIRATION-DT       PIC XX.
  1934             20  FILLER                    PIC X(4).
  1935         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1936                                           PIC 9(11)      COMP-3.
  1937     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1938         16  FILLER                        PIC X(10).
  1939         16  AM-VG-KEY3.
  1940             20  AM-VG3-ACCOUNT            PIC X(10).
  1941             20  AM-VG3-EXP-DT             PIC XX.
  1942         16  FILLER                        PIC X(4).
  1943     12  AM-MAINT-INFORMATION.
  1944         16  AM-LAST-MAINT-DT              PIC XX.
  1945         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1946         16  AM-LAST-MAINT-USER            PIC X(4).
  1947         16  FILLER                        PIC XX.
  1948
  1949     12  AM-EFFECTIVE-DT                   PIC XX.
  1950     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1951
  1952     12  AM-PREV-DATES  COMP-3.
  1953         16  AM-PREV-EXP-DT                PIC 9(11).
  1954         16  AM-PREV-EFF-DT                PIC 9(11).
  1955
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  36
* EL6317.cbl
  1956     12  AM-REPORT-CODE-1                  PIC X(10).
  1957     12  AM-REPORT-CODE-2                  PIC X(10).
  1958
  1959     12  AM-CITY-CODE                      PIC X(4).
  1960     12  AM-COUNTY-PARISH                  PIC X(6).
  1961
  1962     12  AM-NAME                           PIC X(30).
  1963     12  AM-PERSON                         PIC X(30).
  1964     12  AM-ADDRS                          PIC X(30).
  1965     12  AM-CITY.
  1966         16  AM-ADDR-CITY                  PIC X(28).
  1967         16  AM-ADDR-STATE                 PIC XX.
  1968     12  AM-ZIP.
  1969         16  AM-ZIP-PRIME.
  1970             20  AM-ZIP-PRI-1ST            PIC X.
  1971                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1972             20  FILLER                    PIC X(4).
  1973         16  AM-ZIP-PLUS4                  PIC X(4).
  1974     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1975         16  AM-CAN-POSTAL-1               PIC XXX.
  1976         16  AM-CAN-POSTAL-2               PIC XXX.
  1977         16  FILLER                        PIC XXX.
  1978     12  AM-TEL-NO.
  1979         16  AM-AREA-CODE                  PIC 999.
  1980         16  AM-TEL-PRE                    PIC 999.
  1981         16  AM-TEL-NBR                    PIC 9(4).
  1982     12  AM-TEL-LOC                        PIC X.
  1983         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1984         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1985
  1986     12  AM-COMM-STRUCTURE.
  1987         16  AM-DEFN-1.
  1988             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1989                 24  AM-AGT.
  1990                     28  AM-AGT-PREFIX     PIC X(4).
  1991                     28  AM-AGT-PRIME      PIC X(6).
  1992                 24  AM-COM-TYP            PIC X.
  1993                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1994                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1995                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1996                 24  AM-RECALC-LV-INDIC    PIC X.
  1997                 24  AM-RETRO-LV-INDIC     PIC X.
  1998                 24  AM-GL-CODES           PIC X.
  1999                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2000                 24  FILLER                PIC X(01).
  2001         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2002             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2003                 24  FILLER                PIC X(11).
  2004                 24  AM-L-COMA             PIC XXX.
  2005                 24  AM-J-COMA             PIC XXX.
  2006                 24  AM-A-COMA             PIC XXX.
  2007                 24  FILLER                PIC X(6).
  2008
  2009     12  AM-COMM-CHANGE-STATUS             PIC X.
  2010         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2011
  2012     12  AM-CSR-CODE                       PIC X(4).
  2013
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  37
* EL6317.cbl
  2014     12  AM-BILLING-STATUS                 PIC X.
  2015         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2016         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2017     12  AM-AUTO-REFUND-SW                 PIC X.
  2018         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2019         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2020     12  AM-GPCD                           PIC 99.
  2021     12  AM-IG                             PIC X.
  2022         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2023         88  AM-HAS-GROUP                     VALUE '2'.
  2024     12  AM-STATUS                         PIC X.
  2025         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2026         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2027         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2028         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2029         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2030         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2031     12  AM-REMIT-TO                       PIC 99.
  2032     12  AM-ID-NO                          PIC X(11).
  2033
  2034     12  AM-CAL-TABLE                      PIC XX.
  2035     12  AM-LF-DEVIATION                   PIC XXX.
  2036     12  AM-AH-DEVIATION                   PIC XXX.
  2037     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2038     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2039     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2040     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2041     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2042     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2043
  2044     12  AM-USER-FIELDS.
  2045         16  AM-FLD-1                      PIC XX.
  2046         16  AM-FLD-2                      PIC XX.
  2047         16  AM-FLD-3                      PIC XX.
  2048         16  AM-FLD-4                      PIC XX.
  2049         16  AM-FLD-5                      PIC XX.
  2050
  2051     12  AM-1ST-PROD-DATE.
  2052         16  AM-1ST-PROD-YR                PIC XX.
  2053         16  AM-1ST-PROD-MO                PIC XX.
  2054         16  AM-1ST-PROD-DA                PIC XX.
  2055     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2056     12  AM-CERTS-PURGED-DATE.
  2057         16  AM-PUR-YR                     PIC XX.
  2058         16  AM-PUR-MO                     PIC XX.
  2059         16  AM-PUR-DA                     PIC XX.
  2060     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2061     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2062     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2063     12  AM-INACTIVE-DATE.
  2064         16  AM-INA-MO                     PIC 99.
  2065         16  AM-INA-DA                     PIC 99.
  2066         16  AM-INA-YR                     PIC 99.
  2067     12  AM-AR-HI-CERT-DATE                PIC XX.
  2068
  2069     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2070     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2071
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  38
* EL6317.cbl
  2072     12  AM-OB-PAYMENT-MODE                PIC X.
  2073         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2074         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2075         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2076         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2077
  2078     12  AM-AH-ONLY-INDICATOR              PIC X.
  2079         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2080         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2081
  2082     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2083
  2084     12  AM-OVER-SHORT.
  2085         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2086         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2087
  2088     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2089     12  AM-DCC-CLP-STATE                  PIC XX.
  2090
  2091     12  AM-RECALC-COMM                    PIC X.
  2092     12  AM-RECALC-REIN                    PIC X.
  2093
  2094     12  AM-REI-TABLE                      PIC XXX.
  2095     12  AM-REI-ET-LF                      PIC X.
  2096     12  AM-REI-ET-AH                      PIC X.
  2097     12  AM-REI-PE-LF                      PIC X.
  2098     12  AM-REI-PE-AH                      PIC X.
  2099     12  AM-REI-PRT-ST                     PIC X.
  2100     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2101     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2102     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2103     12  AM-REI-GROUP-A                    PIC X(6).
  2104     12  AM-REI-MORT                       PIC X(4).
  2105     12  AM-REI-PRT-OW                     PIC X.
  2106     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2107     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2108     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2109     12  AM-REI-GROUP-B                    PIC X(6).
  2110
  2111     12  AM-TRUST-TYPE                     PIC X(2).
  2112
  2113     12  AM-EMPLOYER-STMT-USED             PIC X.
  2114     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2115
  2116     12  AM-STD-AH-TYPE                    PIC XX.
  2117     12  AM-EARN-METHODS.
  2118         16  AM-EARN-METHOD-R              PIC X.
  2119             88 AM-REF-RL-R78                 VALUE 'R'.
  2120             88 AM-REF-RL-PR                  VALUE 'P'.
  2121             88 AM-REF-RL-MEAN                VALUE 'M'.
  2122             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2123         16  AM-EARN-METHOD-L              PIC X.
  2124             88 AM-REF-LL-R78                 VALUE 'R'.
  2125             88 AM-REF-LL-PR                  VALUE 'P'.
  2126             88 AM-REF-LL-MEAN                VALUE 'M'.
  2127             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2128         16  AM-EARN-METHOD-A              PIC X.
  2129             88 AM-REF-AH-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  39
* EL6317.cbl
  2130             88 AM-REF-AH-PR                  VALUE 'P'.
  2131             88 AM-REF-AH-MEAN                VALUE 'M'.
  2132             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2133             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2134             88 AM-REF-AH-NET                 VALUE 'N'.
  2135
  2136     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2137     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2138     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2139
  2140     12  AM-RET-Y-N                        PIC X.
  2141     12  AM-RET-P-E                        PIC X.
  2142     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2143     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2144     12  AM-RET-GRP                        PIC X(6).
  2145     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2146         16  AM-POOL-PRIME                 PIC XXX.
  2147         16  AM-POOL-SUB                   PIC XXX.
  2148     12  AM-RETRO-EARNINGS.
  2149         16  AM-RET-EARN-R                 PIC X.
  2150         16  AM-RET-EARN-L                 PIC X.
  2151         16  AM-RET-EARN-A                 PIC X.
  2152     12  AM-RET-ST-TAX-USE                 PIC X.
  2153         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2154         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2155     12  AM-RETRO-BEG-EARNINGS.
  2156         16  AM-RET-BEG-EARN-R             PIC X.
  2157         16  AM-RET-BEG-EARN-L             PIC X.
  2158         16  AM-RET-BEG-EARN-A             PIC X.
  2159     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2160     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2161
  2162     12  AM-USER-SELECT-OPTIONS.
  2163         16  AM-USER-SELECT-1              PIC X(10).
  2164         16  AM-USER-SELECT-2              PIC X(10).
  2165         16  AM-USER-SELECT-3              PIC X(10).
  2166         16  AM-USER-SELECT-4              PIC X(10).
  2167         16  AM-USER-SELECT-5              PIC X(10).
  2168
  2169     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2170
  2171     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2172
  2173     12  AM-RPT045A-SWITCH                 PIC X.
  2174         88  RPT045A-OFF                   VALUE 'N'.
  2175
  2176     12  AM-INSURANCE-LIMITS.
  2177         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2178         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2179
  2180     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2181         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2182
  2183     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2184         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2185         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2186
  2187     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  40
* EL6317.cbl
  2188
  2189     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2190     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2191     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2192     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2193     12  AM-DCC-UEF-STATE                  PIC XX.
  2194     12  FILLER                            PIC XXX.
  2195     12  AM-REPORT-CODE-3                  PIC X(10).
  2196*    12  FILLER                            PIC X(22).
  2197
  2198     12  AM-RESERVE-DATE.
  2199         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2200         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2201         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2202
  2203     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2204     12  AM-NOTIFICATION-TYPES.
  2205         16  AM-NOTIF-OF-LETTERS           PIC X.
  2206         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2207         16  AM-NOTIF-OF-REPORTS           PIC X.
  2208         16  AM-NOTIF-OF-STATUS            PIC X.
  2209
  2210     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2211         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2212         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2213         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2214         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2215
  2216     12  AM-BENEFIT-CONTROLS.
  2217         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2218             20  AM-BENEFIT-CODE           PIC XX.
  2219             20  AM-BENEFIT-TYPE           PIC X.
  2220             20  AM-BENEFIT-REVISION       PIC XXX.
  2221             20  AM-BENEFIT-REM-TERM       PIC X.
  2222             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2223             20  FILLER                    PIC XX.
  2224         16  FILLER                        PIC X(80).
  2225
  2226     12  AM-TRANSFER-DATA.
  2227         16  AM-TRANSFERRED-FROM.
  2228             20  AM-TRNFROM-CARRIER        PIC X.
  2229             20  AM-TRNFROM-GROUPING.
  2230                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2231                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2232             20  AM-TRNFROM-STATE          PIC XX.
  2233             20  AM-TRNFROM-ACCOUNT.
  2234                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2235                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2236             20  AM-TRNFROM-DTE            PIC XX.
  2237         16  AM-TRANSFERRED-TO.
  2238             20  AM-TRNTO-CARRIER          PIC X.
  2239             20  AM-TRNTO-GROUPING.
  2240                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2241                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2242             20  AM-TRNTO-STATE            PIC XX.
  2243             20  AM-TRNTO-ACCOUNT.
  2244                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2245                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  41
* EL6317.cbl
  2246             20  AM-TRNTO-DTE              PIC XX.
  2247         16  FILLER                        PIC X(10).
  2248
  2249     12  AM-SAVED-REMIT-TO                 PIC 99.
  2250
  2251     12  AM-COMM-STRUCTURE-SAVED.
  2252         16  AM-DEFN-1-SAVED.
  2253             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2254                 24  AM-AGT-SV             PIC X(10).
  2255                 24  AM-COM-TYP-SV         PIC X.
  2256                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2257                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2258                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2259                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2260                 24  FILLER                PIC X.
  2261                 24  AM-GL-CODES-SV        PIC X.
  2262                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2263                 24  FILLER                PIC X.
  2264         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2265             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2266                 24  FILLER                PIC X(11).
  2267                 24  AM-L-COMA-SV          PIC XXX.
  2268                 24  AM-J-COMA-SV          PIC XXX.
  2269                 24  AM-A-COMA-SV          PIC XXX.
  2270                 24  FILLER                PIC X(6).
  2271
  2272     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2273         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2274            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2275            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2276            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2277
  2278     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2279     12  FILLER                            PIC X(120).
  2280
  2281     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2282         16  AM-CONTROL-NAME               PIC X(30).
  2283         16  AM-EXECUTIVE-ONE.
  2284             20  AM-EXEC1-NAME             PIC X(15).
  2285             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2286                                                          COMP-3.
  2287             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2288                                                          COMP-3.
  2289         16  AM-EXECUTIVE-TWO.
  2290             20  AM-EXEC2-NAME             PIC X(15).
  2291             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2292                                                          COMP-3.
  2293             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2294                                                          COMP-3.
  2295
  2296     12  AM-RETRO-ADDITIONAL-DATA.
  2297         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2298         16  AM-RETRO-PREM-P-E             PIC X.
  2299         16  AM-RETRO-CLMS-P-I             PIC X.
  2300         16  AM-RETRO-RET-BRACKET-LF.
  2301             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2302                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2303                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  42
* EL6317.cbl
  2304             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2305                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2306                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2307             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2308                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2309                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2310         16  AM-RETRO-RET-BRACKET-AH.
  2311             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2312                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2313                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2314                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2315             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2316                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2317                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2318             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2319                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2320                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2321
  2322     12  AM-COMMENTS.
  2323         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2324
  2325     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2326         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2327         16  AM-FLI-BILLING-CODE           PIC X.
  2328         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2329         16  AM-FLI-UNITED-IDENT           PIC X.
  2330         16  AM-FLI-INTEREST-LOST-DATA.
  2331             20  AM-FLI-BANK-NO            PIC X(5).
  2332             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2333             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2334             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2335         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2336             20  AM-FLI-AGT                PIC X(9).
  2337             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2338             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2339         16  FILLER                        PIC X(102).
  2340
  2341     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2342         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2343             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2344             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2345             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2346             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2347             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2348         16  FILLER                          PIC X(10).
  2349******************************************************************
  2350*                                COPY ELCCNTL.
  2351******************************************************************
  2352*                                                                *
  2353*                                                                *
  2354*                            ELCCNTL.                            *
  2355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2356*                            VMOD=2.059                          *
  2357*                                                                *
  2358*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2359*                                                                *
  2360*   FILE TYPE = VSAM,KSDS                                        *
  2361*   RECORD SIZE = 750  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  43
* EL6317.cbl
  2362*                                                                *
  2363*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2364*       ALTERNATE INDEX = NONE                                   *
  2365*                                                                *
  2366*   LOG = YES                                                    *
  2367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2368******************************************************************
  2369*                   C H A N G E   L O G
  2370*
  2371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2372*-----------------------------------------------------------------
  2373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2374* EFFECTIVE    NUMBER
  2375*-----------------------------------------------------------------
  2376* 082503                   PEMA  ADD BENEFIT GROUP
  2377* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2378* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2379* 092705    2005050300006  PEMA  ADD SPP LEASES
  2380* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2381* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2382* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2383* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2384* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2385* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2386******************************************************************
  2387*
  2388 01  CONTROL-FILE.
  2389     12  CF-RECORD-ID                       PIC XX.
  2390         88  VALID-CF-ID                        VALUE 'CF'.
  2391
  2392     12  CF-CONTROL-PRIMARY.
  2393         16  CF-COMPANY-ID                  PIC XXX.
  2394         16  CF-RECORD-TYPE                 PIC X.
  2395             88  CF-COMPANY-MASTER              VALUE '1'.
  2396             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2397             88  CF-STATE-MASTER                VALUE '3'.
  2398             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2399             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2400             88  CF-CARRIER-MASTER              VALUE '6'.
  2401             88  CF-MORTALITY-MASTER            VALUE '7'.
  2402             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2403             88  CF-TERMINAL-MASTER             VALUE '9'.
  2404             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2405             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2406             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2407             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2408             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2409             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2410             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2411             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2412             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2413         16  CF-ACCESS-CD-GENL              PIC X(4).
  2414         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2415             20  CF-PROCESSOR               PIC X(4).
  2416         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2417             20  CF-STATE-CODE              PIC XX.
  2418             20  FILLER                     PIC XX.
  2419         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  44
* EL6317.cbl
  2420             20  FILLER                     PIC XX.
  2421             20  CF-HI-BEN-IN-REC           PIC XX.
  2422         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2423             20  FILLER                     PIC XXX.
  2424             20  CF-CARRIER-CNTL            PIC X.
  2425         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2426             20  FILLER                     PIC XX.
  2427             20  CF-HI-TYPE-IN-REC          PIC 99.
  2428         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2429             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2430                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2431             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2432             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2433         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2434             20  FILLER                     PIC X.
  2435             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2436         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2437             20  FILLER                     PIC XX.
  2438             20  CF-MORTGAGE-PLAN           PIC XX.
  2439         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2440
  2441     12  CF-LAST-MAINT-DT                   PIC XX.
  2442     12  CF-LAST-MAINT-BY                   PIC X(4).
  2443     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2444
  2445     12  CF-RECORD-BODY                     PIC X(728).
  2446
  2447
  2448****************************************************************
  2449*             COMPANY MASTER RECORD                            *
  2450****************************************************************
  2451
  2452     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2453         16  CF-COMPANY-ADDRESS.
  2454             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2455             20  CF-CL-IN-CARE-OF           PIC X(30).
  2456             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2457             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2458             20  CF-CL-CITY-STATE           PIC X(30).
  2459             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2460             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2461         16  CF-COMPANY-CD                  PIC X.
  2462         16  CF-COMPANY-PASSWORD            PIC X(8).
  2463         16  CF-SECURITY-OPTION             PIC X.
  2464             88  ALL-SECURITY                   VALUE '1'.
  2465             88  COMPANY-VERIFY                 VALUE '2'.
  2466             88  PROCESSOR-VERIFY               VALUE '3'.
  2467             88  NO-SECURITY                    VALUE '4'.
  2468             88  ALL-BUT-TERM                   VALUE '5'.
  2469         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2470             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2471         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2472             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2473         16  CF-INFORCE-LOCATION            PIC X.
  2474             88  CERTS-ARE-ONLINE               VALUE '1'.
  2475             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2476             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2477         16  CF-LOWER-CASE-LETTERS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  45
* EL6317.cbl
  2478         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2479             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2480             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2481             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2482             88  CF-ACCNT-CNTL                  VALUE '3'.
  2483             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2484
  2485         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2486         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2487
  2488         16  CF-LGX-CREDIT-USER             PIC X.
  2489             88  CO-IS-NOT-USER                 VALUE 'N'.
  2490             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2491
  2492         16 CF-CREDIT-CALC-CODES.
  2493             20  CF-CR-REM-TERM-CALC PIC X.
  2494               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2495               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2496               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2497               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2498               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2499               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2500               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2501             20  CF-CR-R78-METHOD           PIC X.
  2502               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2503               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2504
  2505         16  CF-CLAIM-CONTROL-COUNTS.
  2506             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2507                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2508
  2509             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2510                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2511
  2512             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2513                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2514
  2515             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2516                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2517
  2518         16  CF-CURRENT-MONTH-END           PIC XX.
  2519
  2520         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2521             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2522             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2523             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2524             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2525                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2526                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2527             20  CF-CO-PREM-REJECT-SW       PIC X.
  2528                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2529                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2530             20  CF-CO-REF-REJECT-SW        PIC X.
  2531                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2532                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2533
  2534         16  CF-CO-REPORTING-DT             PIC XX.
  2535         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  46
* EL6317.cbl
  2536         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2537           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2538           88  CF-CO-MONTH-END                  VALUE '1'.
  2539
  2540         16  CF-LGX-CLAIM-USER              PIC X.
  2541             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2542             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2543
  2544         16  CF-CREDIT-EDIT-CONTROLS.
  2545             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2546             20  CF-MIN-AGE                 PIC 99.
  2547             20  CF-DEFAULT-AGE             PIC 99.
  2548             20  CF-MIN-TERM                PIC S999      COMP-3.
  2549             20  CF-MAX-TERM                PIC S999      COMP-3.
  2550             20  CF-DEFAULT-SEX             PIC X.
  2551             20  CF-JOINT-AGE-INPUT         PIC X.
  2552                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2553             20  CF-BIRTH-DATE-INPUT        PIC X.
  2554                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2555             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2556                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2557                 88  CF-ZERO-CARRIER            VALUE '1'.
  2558                 88  CF-ZERO-GROUPING           VALUE '2'.
  2559                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2560             20  CF-EDIT-SW                 PIC X.
  2561                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2562             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2563             20  CF-CR-PR-METHOD            PIC X.
  2564               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2565               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2566             20  FILLER                     PIC X.
  2567
  2568         16  CF-CREDIT-MISC-CONTROLS.
  2569             20  CF-REIN-TABLE-SW           PIC X.
  2570                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2571             20  CF-COMP-TABLE-SW           PIC X.
  2572                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2573             20  CF-EXPERIENCE-RETENTION-AGE
  2574                                            PIC S9        COMP-3.
  2575             20  CF-CONVERSION-DT           PIC XX.
  2576             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2577             20  CF-RUN-FREQUENCY-SW        PIC X.
  2578                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2579                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2580
  2581             20  CF-CR-CHECK-NO-CONTROL.
  2582                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2583                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2584                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2585                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2586                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2587                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2588
  2589                 24  CF-CR-CHECK-COUNT       REDEFINES
  2590                     CF-CR-CHECK-COUNTER      PIC X(4).
  2591
  2592                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2593                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  47
* EL6317.cbl
  2594
  2595                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2596                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2597                 24  CF-MAIL-PROCESSING       PIC X.
  2598                     88  MAIL-PROCESSING          VALUE 'Y'.
  2599
  2600         16  CF-MISC-SYSTEM-CONTROL.
  2601             20  CF-SYSTEM-C                 PIC X.
  2602                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2603             20  CF-SYSTEM-D                 PIC X.
  2604                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2605             20  CF-SOC-SEC-NO-SW            PIC X.
  2606                 88  SOC-SEC-NO-USED             VALUE '1'.
  2607             20  CF-MEMBER-NO-SW             PIC X.
  2608                 88  MEMBER-NO-USED              VALUE '1'.
  2609             20  CF-TAX-ID-NUMBER            PIC X(11).
  2610             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2611             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2612                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2613                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2614                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2615                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2616             20  CF-SYSTEM-E                 PIC X.
  2617                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2618
  2619         16  CF-LGX-LIFE-USER               PIC X.
  2620             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2621             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2622
  2623         16  CF-CR-MONTH-END-DT             PIC XX.
  2624
  2625         16  CF-FILE-MAINT-DATES.
  2626             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2627                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2628             20  CF-LAST-BATCH       REDEFINES
  2629                 CF-LAST-BATCH-NO               PIC X(4).
  2630             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2631             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2632             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2633             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2634             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2635             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2636             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2637             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2638             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2639             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2640
  2641         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2642         16  FILLER                         PIC X.
  2643
  2644         16  CF-ALT-MORT-CODE               PIC X(4).
  2645         16  CF-MEMBER-CAPTION              PIC X(10).
  2646
  2647         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2648             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2649             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2650             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2651             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  48
* EL6317.cbl
  2652             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2653
  2654         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2655
  2656         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2657         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2658         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2659         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2660
  2661         16  CF-AH-OVERRIDE-L1              PIC X.
  2662         16  CF-AH-OVERRIDE-L2              PIC XX.
  2663         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2664         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2665
  2666         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2667         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2668
  2669         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2670         16  CF-AR-LAST-EL860-DT            PIC XX.
  2671         16  CF-MP-MONTH-END-DT             PIC XX.
  2672
  2673         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2674         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2675             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2676
  2677         16  CF-AR-MONTH-END-DT             PIC XX.
  2678
  2679         16  CF-CRDTCRD-USER                PIC X.
  2680             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2681             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2682
  2683         16  CF-CC-MONTH-END-DT             PIC XX.
  2684
  2685         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2686
  2687         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2688             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2689             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2690             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2691         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2692         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2693         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2694         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2695             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2696             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2697         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2698         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2699         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2700             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2701         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2702
  2703         16  CF-CL-ZIP-CODE.
  2704             20  CF-CL-ZIP-PRIME.
  2705                 24  CF-CL-ZIP-1ST          PIC X.
  2706                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2707                 24  FILLER                 PIC X(4).
  2708             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2709         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  49
* EL6317.cbl
  2710             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2711             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2712             20  FILLER                     PIC XXX.
  2713
  2714         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2715         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2716         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2717         16  CF-CO-OPTION-START-DATE        PIC XX.
  2718         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2719           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2720                                                      '3' '4'.
  2721           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2722           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2723           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2724           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2725           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2726           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2727
  2728         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2729
  2730         16  CF-PAYMENT-APPROVAL-LEVELS.
  2731             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2732             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2733             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2734             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2735             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2736             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2737
  2738         16  CF-END-USER-REPORTING-USER     PIC X.
  2739             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2740             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2741
  2742         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2743             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2744             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2745
  2746         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2747
  2748         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2749         16  FILLER                         PIC X.
  2750
  2751         16  CF-CREDIT-ARCHIVE-CNTL.
  2752             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2753             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2754             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2755
  2756         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2757
  2758         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2759             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2760             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2761
  2762         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2763             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2764             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2765
  2766         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2767
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  50
* EL6317.cbl
  2768         16  CF-CO-ACH-ID-CODE              PIC  X.
  2769             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2770             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2771             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2772         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2773         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2774         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2775         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2776         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2777         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2778         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2779         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2780         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2781                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2782         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2783                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2784
  2785         16  CF-CO-OVER-SHORT.
  2786             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2787             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2788
  2789*         16  FILLER                         PIC X(102).
  2790         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2791             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2792             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2793
  2794         16  CF-AH-APPROVAL-DAYS.
  2795             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2796             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2797             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2798             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2799
  2800         16  FILLER                         PIC X(82).
  2801****************************************************************
  2802*             PROCESSOR/USER RECORD                            *
  2803****************************************************************
  2804
  2805     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2806         16  CF-PROCESSOR-NAME              PIC X(30).
  2807         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2808         16  CF-PROCESSOR-TITLE             PIC X(26).
  2809         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2810                 88  MESSAGE-YES                VALUE 'Y'.
  2811                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2812
  2813*****************************************************
  2814****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2815****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2816****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2817****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2818*****************************************************
  2819
  2820         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2821             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2822             20  CF-APPLICATION-FORCE       PIC X.
  2823             20  CF-INDIVIDUAL-APP.
  2824                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2825                     28  CF-BROWSE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  51
* EL6317.cbl
  2826                     28  CF-UPDATE-APP      PIC X.
  2827
  2828         16  CF-CURRENT-TERM-ON             PIC X(4).
  2829         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2830             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2831             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2832             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2833             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2834             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2835             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2836             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2837         16  CF-PROCESSOR-CARRIER           PIC X.
  2838             88  NO-CARRIER-SECURITY            VALUE ' '.
  2839         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2840             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2841         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2842             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2843         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2844             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2845
  2846         16  CF-PROC-SYS-ACCESS-SW.
  2847             20  CF-PROC-CREDIT-CLAIMS-SW.
  2848                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2849                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2850                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2851                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2852             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2853                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2854                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2855             20  CF-PROC-LIFE-GNRLDGR-SW.
  2856                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2857                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2858                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2859                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2860             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2861                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2862                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2863         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2864             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2865             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2866         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2867
  2868         16  CF-APPROVAL-LEVEL                  PIC X.
  2869             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2870             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2871             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2872             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2873
  2874         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2875
  2876         16  CF-LANGUAGE-TYPE                   PIC X.
  2877             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2878             88  CF-LANG-IS-FR                      VALUE 'F'.
  2879
  2880         16  CF-CSR-IND                         PIC X.
  2881         16  FILLER                             PIC X(239).
  2882
  2883****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  52
* EL6317.cbl
  2884*             PROCESSOR/REMINDERS RECORD                       *
  2885****************************************************************
  2886
  2887     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2888         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2889             20  CF-START-REMIND-DT         PIC XX.
  2890             20  CF-END-REMIND-DT           PIC XX.
  2891             20  CF-REMINDER-TEXT           PIC X(50).
  2892         16  FILLER                         PIC X(296).
  2893
  2894
  2895****************************************************************
  2896*             STATE MASTER RECORD                              *
  2897****************************************************************
  2898
  2899     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2900         16  CF-STATE-ABBREVIATION          PIC XX.
  2901         16  CF-STATE-NAME                  PIC X(25).
  2902         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2903         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2904             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2905             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2906             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2907             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2908                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2909                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2910             20  CF-ST-PREM-REJECT-SW       PIC X.
  2911                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2912                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2913             20  CF-ST-REF-REJECT-SW        PIC X.
  2914                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2915                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2916         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2917         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2918         16  CF-ST-REFUND-RULES.
  2919             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2920             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2921             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2922         16  CF-ST-FST-PMT-EXTENSION.
  2923             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2924             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2925                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2926                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2927                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2928                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2929         16  CF-ST-STATE-CALL.
  2930             20  CF-ST-CALL-UNEARNED        PIC X.
  2931             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2932             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2933         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2934             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2935             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2936         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2937         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2938         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2939         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2940         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2941         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  53
* EL6317.cbl
  2942         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2943             20  CF-ST-BENEFIT-CD           PIC XX.
  2944             20  CF-ST-BENEFIT-KIND         PIC X.
  2945                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2946                 88  CF-ST-AH-KIND              VALUE 'A'.
  2947             20  CF-ST-REM-TERM-CALC        PIC X.
  2948                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2949                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2950                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2951                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2952                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2953                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2954                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2955                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2956
  2957             20  CF-ST-REFUND-CALC          PIC X.
  2958                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2959                 88  ST-REFD-BY-R78             VALUE '1'.
  2960                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2961                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2962                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2963                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2964                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2965                 88  ST-REFD-UTAH               VALUE '7'.
  2966                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2967                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2968                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2969
  2970             20  CF-ST-EARNING-CALC         PIC X.
  2971                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2972                 88  ST-EARN-BY-R78             VALUE '1'.
  2973                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2974                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2975                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2976                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2977                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2978                 88  ST-EARN-MEAN               VALUE '8'.
  2979                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2980
  2981             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2982                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2983                 88  ST-OVRD-BY-R78             VALUE '1'.
  2984                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2985                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2986                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2987                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2988                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2989                 88  ST-OVRD-MEAN               VALUE '8'.
  2990                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2991             20  FILLER                     PIC X.
  2992
  2993         16  CF-ST-COMMISSION-CAPS.
  2994             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2995             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2996             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2997             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2998         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2999                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  54
* EL6317.cbl
  3000
  3001         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3002
  3003         16  CF-ST-STATUTORY-INTEREST.
  3004             20  CF-ST-STAT-DATE-FROM       PIC X.
  3005                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3006                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3007             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3008             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3009             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3010             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3011             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3012
  3013         16  CF-ST-OVER-SHORT.
  3014             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3015             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3016
  3017         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3018
  3019         16  CF-ST-RT-CALC                  PIC X.
  3020
  3021         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3022         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3023         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3024         16  CF-ST-RF-LR-CALC               PIC X.
  3025         16  CF-ST-RF-LL-CALC               PIC X.
  3026         16  CF-ST-RF-LN-CALC               PIC X.
  3027         16  CF-ST-RF-AH-CALC               PIC X.
  3028         16  CF-ST-RF-CP-CALC               PIC X.
  3029*        16  FILLER                         PIC X(206).
  3030*CIDMOD         16  FILLER                         PIC X(192).
  3031         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3032             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3033         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3034         16  CF-ST-VFY-2ND-BENE             PIC X.
  3035         16  FILLER                         PIC X(186).
  3036
  3037****************************************************************
  3038*             BENEFIT MASTER RECORD                            *
  3039****************************************************************
  3040
  3041     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3042         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3043             20  CF-BENEFIT-CODE            PIC XX.
  3044             20  CF-BENEFIT-NUMERIC  REDEFINES
  3045                 CF-BENEFIT-CODE            PIC XX.
  3046             20  CF-BENEFIT-ALPHA           PIC XXX.
  3047             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3048             20  CF-BENEFIT-COMMENT         PIC X(10).
  3049
  3050             20  CF-LF-COVERAGE-TYPE        PIC X.
  3051                 88  CF-REDUCING                VALUE 'R'.
  3052                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3053
  3054             20  CF-SPECIAL-CALC-CD         PIC X.
  3055                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3056                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3057                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  55
* EL6317.cbl
  3058                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3059                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3060                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3061                 88  CF-FARM-PLAN               VALUE 'F'.
  3062                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3063                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3064                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3065                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3066                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3067                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3068                 88  CF-PRUDENTIAL              VALUE 'P'.
  3069                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3070                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3071                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3072                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3073                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3074                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3075
  3076             20  CF-JOINT-INDICATOR         PIC X.
  3077                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3078
  3079*            20  FILLER                     PIC X(12).
  3080             20  FILLER                     PIC X(11).
  3081             20  CF-BENEFIT-CATEGORY        PIC X.
  3082             20  CF-LOAN-TYPE               PIC X(8).
  3083
  3084             20  CF-CO-REM-TERM-CALC        PIC X.
  3085                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3086                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3087                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3088                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3089                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3090
  3091             20  CF-CO-EARNINGS-CALC        PIC X.
  3092                 88  CO-EARN-BY-R78             VALUE '1'.
  3093                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3094                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3095                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3096                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3097                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3098                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3099                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3100
  3101             20  CF-CO-REFUND-CALC          PIC X.
  3102                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3103                 88  CO-REFD-BY-R78             VALUE '1'.
  3104                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3105                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3106                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3107                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3108                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3109                 88  CO-REFD-MEAN               VALUE '8'.
  3110                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3111                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3112                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3113
  3114             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3115                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  56
* EL6317.cbl
  3116                 88  CO-OVRD-BY-R78             VALUE '1'.
  3117                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3118                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3119                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3120                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3121                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3122                 88  CO-OVRD-MEAN               VALUE '8'.
  3123                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3124
  3125             20  CF-CO-BEN-I-G-CD           PIC X.
  3126                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3127                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3128                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3129
  3130         16  FILLER                         PIC X(304).
  3131
  3132
  3133****************************************************************
  3134*             CARRIER MASTER RECORD                            *
  3135****************************************************************
  3136
  3137     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3138         16  CF-ADDRESS-DATA.
  3139             20  CF-MAIL-TO-NAME            PIC X(30).
  3140             20  CF-IN-CARE-OF              PIC X(30).
  3141             20  CF-ADDRESS-LINE-1          PIC X(30).
  3142             20  CF-ADDRESS-LINE-2          PIC X(30).
  3143             20  CF-CITY-STATE              PIC X(30).
  3144             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3145             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3146
  3147         16  CF-CLAIM-NO-CONTROL.
  3148             20  CF-CLAIM-NO-METHOD         PIC X.
  3149                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3150                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3151                 88  CLAIM-NO-SEQ               VALUE '3'.
  3152                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3153             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3154                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3155                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3156                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3157
  3158         16  CF-CHECK-NO-CONTROL.
  3159             20  CF-CHECK-NO-METHOD         PIC X.
  3160                 88  CHECK-NO-MANUAL            VALUE '1'.
  3161                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3162                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3163                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3164             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3165                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3166
  3167         16  CF-DOMICILE-STATE              PIC XX.
  3168
  3169         16  CF-EXPENSE-CONTROLS.
  3170             20  CF-EXPENSE-METHOD          PIC X.
  3171                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3172                 88  DOLLARS-PER-PMT            VALUE '2'.
  3173                 88  PERCENT-OF-PAYMENT         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  57
* EL6317.cbl
  3174                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3175             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3176             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3177
  3178         16  CF-CORRESPONDENCE-CONTROL.
  3179             20  CF-LETTER-RESEND-OPT       PIC X.
  3180                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3181                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3182             20  FILLER                     PIC X(4).
  3183
  3184         16  CF-RESERVE-CONTROLS.
  3185             20  CF-MANUAL-SW               PIC X.
  3186                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3187             20  CF-FUTURE-SW               PIC X.
  3188                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3189             20  CF-PTC-SW                  PIC X.
  3190                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3191             20  CF-IBNR-SW                 PIC X.
  3192                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3193             20  CF-PTC-LF-SW               PIC X.
  3194                 88  CF-LF-PTC-USED             VALUE '1'.
  3195             20  CF-CDT-ACCESS-METHOD       PIC X.
  3196                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3197                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3198                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3199             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3200
  3201         16  CF-CLAIM-CALC-METHOD           PIC X.
  3202             88  360-PLUS-MONTHS                VALUE '1'.
  3203             88  365-PLUS-MONTHS                VALUE '2'.
  3204             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3205             88  360-DAILY                      VALUE '4'.
  3206             88  365-DAILY                      VALUE '5'.
  3207
  3208         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3209         16  FILLER                         PIC X(11).
  3210
  3211         16  CF-LIMIT-AMOUNTS.
  3212             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3213             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3214             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3215             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3216             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3217             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3218             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3219             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3220             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3221             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3222
  3223         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3224         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3225         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3226
  3227         16  CF-ZIP-CODE.
  3228             20  CF-ZIP-PRIME.
  3229                 24  CF-ZIP-1ST             PIC X.
  3230                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3231                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  58
* EL6317.cbl
  3232             20  CF-ZIP-PLUS4               PIC X(4).
  3233         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3234             20  CF-CAN-POSTAL-1            PIC XXX.
  3235             20  CF-CAN-POSTAL-2            PIC XXX.
  3236             20  FILLER                     PIC XXX.
  3237
  3238         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3239         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3240         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3241
  3242         16  CF-RATING-SWITCH               PIC X.
  3243             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3244             88  CF-NO-RATING                   VALUE 'N'.
  3245
  3246         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3247
  3248         16  CF-CARRIER-OVER-SHORT.
  3249             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3250             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3251
  3252         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3253         16  CF-SECPAY-SWITCH               PIC X.
  3254             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3255             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3256         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3257         16  FILLER                         PIC X(448).
  3258*        16  FILLER                         PIC X(452).
  3259
  3260
  3261****************************************************************
  3262*             MORTALITY MASTER RECORD                          *
  3263****************************************************************
  3264
  3265     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3266         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3267                                INDEXED BY CF-MORT-NDX.
  3268             20  CF-MORT-TABLE              PIC X(5).
  3269             20  CF-MORT-TABLE-TYPE         PIC X.
  3270                 88  CF-MORT-JOINT              VALUE 'J'.
  3271                 88  CF-MORT-SINGLE             VALUE 'S'.
  3272                 88  CF-MORT-COMBINED           VALUE 'C'.
  3273                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3274                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3275             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3276             20  CF-MORT-AGE-METHOD         PIC XX.
  3277                 88  CF-AGE-LAST                VALUE 'AL'.
  3278                 88  CF-AGE-NEAR                VALUE 'AN'.
  3279             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3280             20  CF-MORT-ADJUSTMENT-DIRECTION
  3281                                            PIC X.
  3282                 88  CF-MINUS                   VALUE '-'.
  3283                 88  CF-PLUS                    VALUE '+'.
  3284             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3285             20  CF-MORT-JOINT-CODE         PIC X.
  3286                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3287             20  CF-MORT-PC-Q               PIC X.
  3288                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3289             20  CF-MORT-TABLE-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  59
* EL6317.cbl
  3290             20  CF-MORT-COMMENTS           PIC X(15).
  3291             20  FILLER                     PIC X(14).
  3292
  3293         16  FILLER                         PIC X(251).
  3294
  3295
  3296****************************************************************
  3297*             BUSSINESS TYPE MASTER RECORD                     *
  3298****************************************************************
  3299
  3300     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3301* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3302* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3303* AND RECORD 05 IS TYPES 81-99
  3304         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3305             20  CF-BUSINESS-TITLE          PIC  X(19).
  3306             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3307                                            PIC S9V9(4) COMP-3.
  3308             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3309             20  FILLER                     PIC  X.
  3310         16  FILLER                         PIC  X(248).
  3311
  3312
  3313****************************************************************
  3314*             TERMINAL MASTER RECORD                           *
  3315****************************************************************
  3316
  3317     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3318
  3319         16  CF-COMPANY-TERMINALS.
  3320             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3321                                  PIC X(4).
  3322         16  FILLER               PIC X(248).
  3323
  3324
  3325****************************************************************
  3326*             LIFE EDIT MASTER RECORD                          *
  3327****************************************************************
  3328
  3329     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3330         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3331             20  CF-LIFE-CODE-IN            PIC XX.
  3332             20  CF-LIFE-CODE-OUT           PIC XX.
  3333         16  FILLER                         PIC X(248).
  3334
  3335
  3336****************************************************************
  3337*             AH EDIT MASTER RECORD                            *
  3338****************************************************************
  3339
  3340     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3341         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3342             20  CF-AH-CODE-IN              PIC XXX.
  3343             20  CF-AH-CODE-OUT             PIC XX.
  3344         16  FILLER                         PIC X(248).
  3345
  3346
  3347****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  60
* EL6317.cbl
  3348*             CREDIBILITY TABLES                               *
  3349****************************************************************
  3350
  3351     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3352         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3353                             INDEXED BY CF-CRDB-NDX.
  3354             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3355             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3356             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3357         16  FILLER                         PIC  X(332).
  3358
  3359
  3360****************************************************************
  3361*             REPORT CUSTOMIZATION RECORD                      *
  3362****************************************************************
  3363
  3364     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3365         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3366             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3367             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3368             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3369**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3370****       A T-TRANSFER.                                   ****
  3371             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3372
  3373         16  FILLER                         PIC XX.
  3374
  3375         16  CF-CARRIER-CNTL-OPT.
  3376             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3377                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3378                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3379             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3380                                            PIC X.
  3381         16  CF-GROUP-CNTL-OPT.
  3382             20  CF-GROUP-OPT-SEQ           PIC 9.
  3383                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3384                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3385             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3386                                            PIC X(6).
  3387         16  CF-STATE-CNTL-OPT.
  3388             20  CF-STATE-OPT-SEQ           PIC 9.
  3389                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3390                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3391             20  CF-STATE-SELECT OCCURS 3 TIMES
  3392                                            PIC XX.
  3393         16  CF-ACCOUNT-CNTL-OPT.
  3394             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3395                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3396                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3397             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3398                                            PIC X(10).
  3399         16  CF-BUS-TYP-CNTL-OPT.
  3400             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3401                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3402                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3403             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3404                                            PIC XX.
  3405         16  CF-LF-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  61
* EL6317.cbl
  3406             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3407                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3408                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3409             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3410                                            PIC XX.
  3411         16  CF-AH-TYP-CNTL-OPT.
  3412             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3413                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3414                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3415             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3416                                            PIC XX.
  3417         16  CF-REPTCD1-CNTL-OPT.
  3418             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3419                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3420                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3421             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3422                                            PIC X(10).
  3423         16  CF-REPTCD2-CNTL-OPT.
  3424             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3425                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3426                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3427             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3428                                            PIC X(10).
  3429         16  CF-USER1-CNTL-OPT.
  3430             20  CF-USER1-OPT-SEQ           PIC 9.
  3431                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3432                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3433             20  CF-USER1-SELECT OCCURS 3 TIMES
  3434                                            PIC X(10).
  3435         16  CF-USER2-CNTL-OPT.
  3436             20  CF-USER2-OPT-SEQ           PIC 9.
  3437                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3438                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3439             20  CF-USER2-SELECT OCCURS 3 TIMES
  3440                                            PIC X(10).
  3441         16  CF-USER3-CNTL-OPT.
  3442             20  CF-USER3-OPT-SEQ           PIC 9.
  3443                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3444                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3445             20  CF-USER3-SELECT OCCURS 3 TIMES
  3446                                            PIC X(10).
  3447         16  CF-USER4-CNTL-OPT.
  3448             20  CF-USER4-OPT-SEQ           PIC 9.
  3449                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3450                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3451             20  CF-USER4-SELECT OCCURS 3 TIMES
  3452                                            PIC X(10).
  3453         16  CF-USER5-CNTL-OPT.
  3454             20  CF-USER5-OPT-SEQ           PIC 9.
  3455                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3456                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3457             20  CF-USER5-SELECT OCCURS 3 TIMES
  3458                                            PIC X(10).
  3459         16  CF-REINS-CNTL-OPT.
  3460             20  CF-REINS-OPT-SEQ           PIC 9.
  3461                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3462                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3463             20  CF-REINS-SELECT OCCURS 3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  62
* EL6317.cbl
  3464                 24  CF-REINS-PRIME         PIC XXX.
  3465                 24  CF-REINS-SUB           PIC XXX.
  3466
  3467         16  CF-AGENT-CNTL-OPT.
  3468             20  CF-AGENT-OPT-SEQ           PIC 9.
  3469                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3470                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3471             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3472                                            PIC X(10).
  3473
  3474         16  FILLER                         PIC X(43).
  3475
  3476         16  CF-LOSS-RATIO-SELECT.
  3477             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3478             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3479         16  CF-ENTRY-DATE-SELECT.
  3480             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3481             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3482         16  CF-EFFECTIVE-DATE-SELECT.
  3483             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3484             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3485
  3486         16  CF-EXCEPTION-LIST-IND          PIC X.
  3487             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3488
  3489         16  FILLER                         PIC X(318).
  3490
  3491****************************************************************
  3492*                  EXCEPTION REPORTING RECORD                  *
  3493****************************************************************
  3494
  3495     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3496         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3497             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3498
  3499         16  CF-COMBINED-LIFE-AH-OPT.
  3500             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3501             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3502             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3503             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3504
  3505         16  CF-LIFE-OPT.
  3506             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3507             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3508             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3509             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3510             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3511             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3512             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3513             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3514             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3515             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3516
  3517         16  CF-AH-OPT.
  3518             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3519             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3520             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3521             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  63
* EL6317.cbl
  3522             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3523             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3524             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3525             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3526             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3527             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3528
  3529         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3530             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3531             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3532             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3533
  3534         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3535
  3536         16  FILLER                         PIC X(673).
  3537
  3538
  3539****************************************************************
  3540*             MORTGAGE SYSTEM PLAN RECORD                      *
  3541****************************************************************
  3542
  3543     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3544         16  CF-PLAN-TYPE                   PIC X.
  3545             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3546             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3547             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3548         16  CF-PLAN-ABBREV                 PIC XXX.
  3549         16  CF-PLAN-DESCRIPT               PIC X(10).
  3550         16  CF-PLAN-NOTES                  PIC X(20).
  3551         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3552         16  CF-PLAN-UNDERWRITING.
  3553             20  CF-PLAN-TERM-DATA.
  3554                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3555                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3556             20  CF-PLAN-AGE-DATA.
  3557                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3558                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3559                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3560             20  CF-PLAN-BENEFIT-DATA.
  3561                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3562                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3563                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3564                                            PIC S9(7)V99  COMP-3.
  3565         16  CF-PLAN-POLICY-FORMS.
  3566             20  CF-POLICY-FORM             PIC X(12).
  3567             20  CF-MASTER-APPLICATION      PIC X(12).
  3568             20  CF-MASTER-POLICY           PIC X(12).
  3569         16  CF-PLAN-RATING.
  3570             20  CF-RATE-CODE               PIC X(5).
  3571             20  CF-SEX-RATING              PIC X.
  3572                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3573                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3574             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3575             20  CF-SUB-STD-TYPE            PIC X.
  3576                 88  CF-PCT-OF-PREM            VALUE '1'.
  3577                 88  CF-PCT-OF-BENE            VALUE '2'.
  3578         16  CF-PLAN-PREM-TOLERANCES.
  3579             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  64
* EL6317.cbl
  3580             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3581         16  CF-PLAN-PYMT-TOLERANCES.
  3582             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3583             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3584         16  CF-PLAN-MISC-DATA.
  3585             20  FILLER                     PIC X.
  3586             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3587             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3588         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3589         16  CF-PLAN-IND-GRP                PIC X.
  3590             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3591                                                     '1'.
  3592             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3593                                                     '2'.
  3594         16  CF-MIB-SEARCH-SW               PIC X.
  3595             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3596             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3597             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3598             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3599         16  CF-ALPHA-SEARCH-SW             PIC X.
  3600             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3601             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3602             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3603             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3604             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3605             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3606             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3607             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3608             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3609             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3610                                                     'A' 'B' 'C'
  3611                                                     'X' 'Y' 'Z'.
  3612         16  CF-EFF-DT-RULE-SW              PIC X.
  3613             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3614             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3615             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3616             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3617             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3618         16  FILLER                         PIC X(4).
  3619         16  CF-HEALTH-QUESTIONS            PIC X.
  3620             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3621         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3622         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3623         16  CF-PLAN-SNGL-JNT               PIC X.
  3624             88  CF-COMBINED-PLAN              VALUE 'C'.
  3625             88  CF-JNT-PLAN                   VALUE 'J'.
  3626             88  CF-SNGL-PLAN                  VALUE 'S'.
  3627         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3628         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3629         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3630         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3631         16  CF-RERATE-CNTL                 PIC  X.
  3632             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3633             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3634             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3635             88  CF-AUTO-RECALC                 VALUE '4'.
  3636         16  CF-BENEFIT-TYPE                PIC  X.
  3637             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  65
* EL6317.cbl
  3638             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3639         16  CF-POLICY-FEE                  PIC S999V99
  3640                                                    COMP-3.
  3641         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3642         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3643         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3644         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3645         16  FILLER                         PIC  X(32).
  3646         16  CF-TERMINATION-FORM            PIC  X(04).
  3647         16  FILLER                         PIC  X(08).
  3648         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3649                                                       COMP-3.
  3650         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3651         16  CF-ISSUE-LETTER                PIC  X(4).
  3652         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3653         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3654             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3655             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3656         16  CF-MP-REFUND-CALC              PIC X.
  3657             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3658             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3659             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3660             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3661             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3662             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3663             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3664             88  CF-MP-REFD-MEAN                VALUE '8'.
  3665         16  CF-ALT-RATE-CODE               PIC  X(5).
  3666
  3667
  3668         16  FILLER                         PIC X(498).
  3669****************************************************************
  3670*             MORTGAGE COMPANY MASTER RECORD                   *
  3671****************************************************************
  3672
  3673     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3674         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3675         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3676             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3677             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3678             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3679             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3680             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3681
  3682         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3683         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3684         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3685         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3686         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3687
  3688         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3689             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3690         16  CF-MP-RECON-USE-IND            PIC X(1).
  3691             88  CF-MP-USE-RECON             VALUE 'Y'.
  3692         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3693             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3694         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3695             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  66
* EL6317.cbl
  3696             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3697         16  FILLER                         PIC X(1).
  3698         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3699             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3700         16  CF-MORTG-MIB-VERSION           PIC X.
  3701             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3702             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3703             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3704         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3705             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3706                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3707             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3708                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3709             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3710                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3711             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3712                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3713             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3714                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3715             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3716                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3717         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3718         16  FILLER                         PIC X(7).
  3719         16  CF-MORTG-DESTINATION-SYMBOL.
  3720             20  CF-MORTG-MIB-COMM          PIC X(5).
  3721             20  CF-MORTG-MIB-TERM          PIC X(5).
  3722         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3723             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3724         16  FILLER                         PIC X(03).
  3725         16  CF-MP-CHECK-NO-CONTROL.
  3726             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3727                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3728                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3729                                                ' ' LOW-VALUES.
  3730                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3731                                               VALUE '3'.
  3732         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3733         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3734         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3735             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3736                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3737             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3738                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3739             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3740                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3741             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3742                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3743             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3744                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3745             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3746                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3747         16  CF-MORTG-BILLING-AREA.
  3748             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3749                                            PIC X.
  3750         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3751         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3752         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3753         16  CF-MORTG-MIB-DEST-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  67
* EL6317.cbl
  3754             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3755             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3756         16  FILLER                         PIC X.
  3757         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3758             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3759             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3760         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3761         16  FILLER                         PIC X(8).
  3762         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3763         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3764         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3765         16  CF-ACH-COMPANY-ID.
  3766             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3767                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3768                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3769                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3770             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3771         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3772             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3773         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3774             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3775             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3776         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3777         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3778         16  FILLER                         PIC X(536).
  3779
  3780****************************************************************
  3781*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3782****************************************************************
  3783
  3784     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3785         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3786             20  CF-FEMALE-HEIGHT.
  3787                 24  CF-FEMALE-FT           PIC 99.
  3788                 24  CF-FEMALE-IN           PIC 99.
  3789             20  CF-FEMALE-MIN-WT           PIC 999.
  3790             20  CF-FEMALE-MAX-WT           PIC 999.
  3791         16  FILLER                         PIC X(428).
  3792
  3793     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3794         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3795             20  CF-MALE-HEIGHT.
  3796                 24  CF-MALE-FT             PIC 99.
  3797                 24  CF-MALE-IN             PIC 99.
  3798             20  CF-MALE-MIN-WT             PIC 999.
  3799             20  CF-MALE-MAX-WT             PIC 999.
  3800         16  FILLER                         PIC X(428).
  3801******************************************************************
  3802*             AUTOMATIC ACTIVITY RECORD                          *
  3803******************************************************************
  3804     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3805         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3806             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3807             20  CF-SYS-LETTER-ID           PIC X(04).
  3808             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3809             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3810             20  CF-SYS-RESET-SW            PIC X(01).
  3811             20  CF-SYS-REPORT-DAYS         PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  68
* EL6317.cbl
  3812             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3813
  3814         16  FILLER                         PIC X(50).
  3815
  3816         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3817             20  CF-USER-ACTIVE-SW          PIC X(01).
  3818             20  CF-USER-LETTER-ID          PIC X(04).
  3819             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3820             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3821             20  CF-USER-RESET-SW           PIC X(01).
  3822             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3823             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3824             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3825
  3826         16  FILLER                         PIC X(246).
  3827*                                COPY ERCPNDB.
  3828******************************************************************
  3829*                                                                *
  3830*                                                                *
  3831*                            ERCPNDB.                            *
  3832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3833*                            VMOD=2.025                          *
  3834*                                                                *
  3835*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3836*                                                                *
  3837******************************************************************
  3838*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3839*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3840******************************************************************
  3841*                                                                *
  3842*                                                                *
  3843*   FILE TYPE = VSAM,KSDS                                        *
  3844*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3845*                                                                *
  3846*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3847*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3848*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3849*                                                 RKP=13,LEN=36  *
  3850*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3851*                                      AND CHG-SEQ.)             *
  3852*                                                RKP=49,LEN=11   *
  3853*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3854*                                      AND CHG-SEQ.)             *
  3855*                                                RKP=60,LEN=15   *
  3856*                                                                *
  3857*   LOG = NO                                                     *
  3858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3859******************************************************************
  3860******************************************************************
  3861*                   C H A N G E   L O G
  3862*
  3863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3864*-----------------------------------------------------------------
  3865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3866* EFFECTIVE    NUMBER
  3867*-----------------------------------------------------------------
  3868* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3869* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  69
* EL6317.cbl
  3870* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3871* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3872* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3873* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3874* 032306                   PEMA  ADD BOW LOAN NUMBER
  3875* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3876* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3877* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3878* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3879* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3880* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3881* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3882* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3883******************************************************************
  3884
  3885 01  PENDING-BUSINESS.
  3886     12  PB-RECORD-ID                     PIC XX.
  3887         88  VALID-PB-ID                        VALUE 'PB'.
  3888
  3889     12  PB-CONTROL-PRIMARY.
  3890         16  PB-COMPANY-CD                PIC X.
  3891         16  PB-ENTRY-BATCH               PIC X(6).
  3892         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3893         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3894
  3895     12  PB-CONTROL-BY-ACCOUNT.
  3896         16  PB-COMPANY-CD-A1             PIC X.
  3897         16  PB-CARRIER                   PIC X.
  3898         16  PB-GROUPING.
  3899             20  PB-GROUPING-PREFIX       PIC XXX.
  3900             20  PB-GROUPING-PRIME        PIC XXX.
  3901         16  PB-STATE                     PIC XX.
  3902         16  PB-ACCOUNT.
  3903             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3904             20  PB-ACCOUNT-PRIME         PIC X(6).
  3905         16  PB-CERT-EFF-DT               PIC XX.
  3906         16  PB-CERT-NO.
  3907             20  PB-CERT-PRIME            PIC X(10).
  3908             20  PB-CERT-SFX              PIC X.
  3909         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3910
  3911         16  PB-RECORD-TYPE               PIC X.
  3912             88  PB-MAILING-DATA                VALUE '0'.
  3913             88  PB-ISSUE                       VALUE '1'.
  3914             88  PB-CANCELLATION                VALUE '2'.
  3915             88  PB-BATCH-TRAILER               VALUE '9'.
  3916
  3917     12  PB-CONTROL-BY-ORIG-BATCH.
  3918         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3919         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3920         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3921         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3922
  3923     12  PB-CONTROL-BY-CSR.
  3924         16  PB-CSR-COMPANY-CD            PIC X.
  3925         16  PB-CSR-ID                    PIC X(4).
  3926         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3927         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  70
* EL6317.cbl
  3928         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3929******************************************************************
  3930*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3931******************************************************************
  3932
  3933     12  PB-LAST-MAINT-DT                 PIC XX.
  3934     12  PB-LAST-MAINT-BY                 PIC X(4).
  3935     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3936
  3937     12  PB-RECORD-BODY                   PIC X(375).
  3938
  3939     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3940         16  PB-CERT-ORIGIN               PIC X.
  3941             88  CLASIC-CREATED-CERT         VALUE '1'.
  3942         16  PB-I-NAME.
  3943             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3944             20  PB-I-INSURED-FIRST-NAME.
  3945                 24  PB-I-INSURED-1ST-INIT PIC X.
  3946                 24  FILLER                PIC X(9).
  3947             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3948         16  PB-I-AGE                     PIC S99   COMP-3.
  3949         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3950         16  PB-I-BIRTHDAY                PIC XX.
  3951         16  PB-I-INSURED-SEX             PIC X.
  3952             88  PB-SEX-MALE     VALUE 'M'.
  3953             88  PB-SEX-FEMALE   VALUE 'F'.
  3954
  3955         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3956         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3957         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3958         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3959         16  PB-I-SKIP-CODE               PIC X.
  3960             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3961             88  PB-SKIP-JULY              VALUE '1'.
  3962             88  PB-SKIP-AUGUST            VALUE '2'.
  3963             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3964             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3965             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3966             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3967             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3968             88  PB-SKIP-JUNE              VALUE '8'.
  3969             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3970             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3971             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3972         16  PB-I-TERM-TYPE               PIC X.
  3973             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3974             88  PB-PAID-WEEKLY            VALUE 'W'.
  3975             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3976             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3977             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3978         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3979         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3980         16  PB-I-DATA-ENTRY-SW           PIC X.
  3981             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3982             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3983             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3984             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3985         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  71
* EL6317.cbl
  3986         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3987*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3988         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3989         16  FILLER                       PIC X.
  3990
  3991         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3992             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3993             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3994                                                   '90' THRU '99'.
  3995         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3996                                          PIC XX.
  3997         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3998         16  PB-I-AMOUNT-FINANCED REDEFINES
  3999                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4000         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4001         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4002                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4003         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4004         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4005         16  PB-I-CLP-AMOUNT REDEFINES
  4006                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4007         16  PB-I-LF-CALC-FLAG            PIC X.
  4008             88 PB-COMP-LF-PREM               VALUE '?'.
  4009         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4010         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4011         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4012         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4013         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4014         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4015         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4016         16  PB-I-LF-ABBR                 PIC XXX.
  4017         16  PB-I-LF-INPUT-CD             PIC XX.
  4018
  4019         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4020             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4021             88  PB-INVALID-AH               VALUE '  ' '00'
  4022                                                   '90' THRU '99'.
  4023         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4024         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4025         16  PB-I-AH-CALC-FLAG            PIC X.
  4026             88 PB-COMP-AH-PREM                  VALUE '?'.
  4027         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4028         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4029         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4030         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4031         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4032         16  PB-I-AH-ABBR                 PIC XXX.
  4033         16  PB-I-AH-INPUT-CD             PIC XXX.
  4034
  4035         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4036         16  PB-I-REIN-TABLE              PIC XXX.
  4037         16  PB-I-BUSINESS-TYPE           PIC 99.
  4038         16  PB-I-INDV-GRP-CD             PIC X.
  4039         16  PB-I-MORT-CODE.
  4040             20  PB-I-TABLE               PIC X.
  4041             20  PB-I-INTEREST            PIC XX.
  4042             20  PB-I-MORT-TYP            PIC X.
  4043         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  72
* EL6317.cbl
  4044         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4045         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4046         16  PB-I-INDV-GRP-OVRD           PIC X.
  4047         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4048         16  PB-I-SIG-SW                  PIC X.
  4049             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4050         16  PB-I-RATE-CLASS              PIC XX.
  4051         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4052         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4053         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4054         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4055         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4056         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4057         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4058         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4059         16  PB-I-OB-FLAG                 PIC X.
  4060             88  PB-I-OB                      VALUE 'B'.
  4061             88  PB-I-SUMMARY                 VALUE 'Z'.
  4062         16  PB-I-ENTRY-STATUS            PIC X.
  4063             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4064                                              'M' '5' '9' '2'.
  4065             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4066             88  PB-I-POLICY-PENDING          VALUE '2'.
  4067             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4068             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4069             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4070             88  PB-I-REIN-ONLY               VALUE '9'.
  4071             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4072             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4073             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4074             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4075         16  PB-I-INT-CODE                PIC X.
  4076             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4077             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4078         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4079         16  PB-I-SOC-SEC-NO              PIC X(11).
  4080         16  PB-I-MEMBER-NO               PIC X(12).
  4081         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4082*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4083         16  PB-I-OLD-LOF                 PIC XXX.
  4084         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4085         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4086         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4087         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4088         16  PB-I-LIFE-INDICATOR          PIC X.
  4089             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4090         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4091         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4092                                          PIC S9(5)V99    COMP-3.
  4093         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4094             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4095             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4096         16  PB-I-1ST-PMT-DT              PIC XX.
  4097         16  PB-I-JOINT-INSURED.
  4098             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4099             20 PB-I-JOINT-FIRST-NAME.
  4100                24  PB-I-JOINT-FIRST-INIT PIC X.
  4101                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  73
* EL6317.cbl
  4102             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4103*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4104         16  PB-I-BENEFICIARY-NAME.
  4105             20  PB-I-BANK-NUMBER         PIC X(10).
  4106             20  FILLER                   PIC X(15).
  4107         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4108         16  PB-I-REFERENCE               PIC X(12).
  4109         16  FILLER REDEFINES PB-I-REFERENCE.
  4110             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4111             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4112             20  PB-I-CLP-STATE           PIC XX.
  4113         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4114             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4115             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4116             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4117         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4118         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4119         16  PB-I-RESIDENT-STATE          PIC XX.
  4120         16  PB-I-RATE-CODE               PIC X(4).
  4121         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4122         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4123         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4124         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4125         16  PB-I-BANK-NOCHRGB            PIC 99.
  4126         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4127         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4128
  4129     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4130         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4131             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4132         16  PB-C-CANCEL-ORIGIN           PIC X.
  4133             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4134         16  PB-C-LF-CANCEL-DT            PIC XX.
  4135         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4136         16  PB-C-LF-CALC-REQ             PIC X.
  4137             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4138         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4139         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4140         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4141             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4142         16  PB-C-AH-CANCEL-DT            PIC XX.
  4143         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4144         16  PB-C-AH-CALC-REQ             PIC X.
  4145             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4146         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4147         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4148         16  PB-C-LAST-NAME               PIC X(15).
  4149         16  PB-C-REFUND-SW               PIC X.
  4150             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4151             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4152         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4153         16  PB-C-PAYEE-CODE              PIC X(6).
  4154         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4155         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4156         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4157         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4158         16  PB-C-REFERENCE               PIC X(12).
  4159         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  74
* EL6317.cbl
  4160         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4161         16  PB-C-POST-CARD-IND           PIC X.
  4162         16  PB-C-CANCEL-REASON           PIC X.
  4163         16  PB-C-REF-INTERFACE-SW        PIC X.
  4164         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4165         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4166         16  FILLER                       PIC X(01).
  4167*        16  FILLER                       PIC X(18).
  4168         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4169*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4170         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4171         16  PB-CANCELED-CERT-DATA.
  4172             20  PB-CI-INSURED-NAME.
  4173                 24  PB-CI-LAST-NAME      PIC X(15).
  4174                 24  PB-CI-INITIALS       PIC XX.
  4175             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4176             20  PB-CI-INSURED-SEX        PIC X.
  4177             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4178             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4179             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4180             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4181             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4182             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4183             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4184             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4185             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4186             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4187             20  PB-CI-RATE-CLASS         PIC XX.
  4188             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4189             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4190             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4191             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4192             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4193             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4194             20  PB-CI-LF-ABBR            PIC X(3).
  4195             20  PB-CI-AH-ABBR            PIC X(3).
  4196             20  PB-CI-OB-FLAG            PIC X.
  4197                 88  PB-CI-OB                VALUE 'B'.
  4198             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4199                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4200                                           'M' '4' '5' '9' '2'.
  4201                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4202                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4203                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4204                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4205                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4206                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4207                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4208                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4209                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4210                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4211                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4212                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4213             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4214                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4215                                           'M' '4' '5' '9' '2'.
  4216                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4217                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  75
* EL6317.cbl
  4218                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4219                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4220                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4221                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4222                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4223                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4224                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4225                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4226                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4227                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4228             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4229             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4230             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4231             20  PB-CI-MEMBER-NO          PIC X(12).
  4232             20  PB-CI-INT-CODE           PIC X.
  4233                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4234                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4235             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4236             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4237             20  PB-CI-COMP-EXCP-SW       PIC X.
  4238                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4239                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4240             20  PB-CI-ENTRY-STATUS       PIC X.
  4241             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4242             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4243             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4244             20  PB-CI-DEATH-DT           PIC XX.
  4245             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4246             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4247             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4248             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4249             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4250             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4251             20  PB-CI-ENTRY-DT              PIC XX.
  4252             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4253             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4254             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4255             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4256             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4257             20  PB-CI-OLD-LOF               PIC XXX.
  4258*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4259             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4260             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4261             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4262             20  PB-CI-INDV-GRP-CD           PIC X.
  4263             20  PB-CI-BENEFICIARY-NAME.
  4264                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4265                 24  FILLER                  PIC X(15).
  4266             20  PB-CI-NOTE-SW               PIC X.
  4267             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4268             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4269             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4270             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4271             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4272             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4273             20  PB-CI-FIRST-NAME            PIC X(10).
  4274             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4275
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  76
* EL6317.cbl
  4276         16  FILLER                       PIC X(13).
  4277*032306  16  FILLER                       PIC X(27).
  4278*        16  FILLER                       PIC X(46).
  4279
  4280     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4281         16  FILLER                       PIC X(10).
  4282         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4283         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4284         16  PB-M-INSURED-MID-INIT        PIC X.
  4285         16  PB-M-INSURED-AGE             PIC 99.
  4286         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4287         16  PB-M-INSURED-SEX             PIC X.
  4288         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4289         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4290         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4291         16  PB-M-INSURED-CITY-STATE.
  4292             20  PB-M-INSURED-CITY        PIC X(28).
  4293             20  PB-M-INSURED-STATE       PIC XX.
  4294         16  PB-M-INSURED-ZIP-CODE.
  4295             20  PB-M-INSURED-ZIP-PRIME.
  4296                 24  PB-M-INSURED-ZIP-1   PIC X.
  4297                     88  PB-M-CANADIAN-POST-CODE
  4298                                             VALUE 'A' THRU 'Z'.
  4299                 24  FILLER               PIC X(4).
  4300             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4301         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4302                                        PB-M-INSURED-ZIP-CODE.
  4303             20  PM-M-INS-CAN-POST1       PIC XXX.
  4304             20  PM-M-INS-CAN-POST2       PIC XXX.
  4305             20  FILLER                   PIC XXX.
  4306         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4307         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4308         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4309         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4310         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4311         16  PB-M-CRED-BENE-CITYST.
  4312             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4313             20  PB-M-CRED-BENE-STATE     PIC XX.
  4314         16  FILLER                       PIC X(92).
  4315
  4316     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4317         16  FILLER                       PIC X(10).
  4318         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4319         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4320         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4321         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4322         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4323         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4324         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4325         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4326         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4327         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4330         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4331         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4332         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4333         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  77
* EL6317.cbl
  4334         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4335         16  PB-ACCOUNT-NAME              PIC X(30).
  4336         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4337         16  PB-REFERENCE                 PIC X(12).
  4338         16  PB-B-RECEIVED-DT             PIC XX.
  4339         16  FILLER                       PIC X(234).
  4340
  4341     12  PB-RECORD-STATUS.
  4342         16  PB-CREDIT-SELECT-DT          PIC XX.
  4343         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4344         16  PB-BILLED-DT                 PIC XX.
  4345         16  PB-BILLING-STATUS            PIC X.
  4346             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4347             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4348             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4349         16  PB-RECORD-BILL               PIC X.
  4350             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4351             88  PB-RECORD-RETURNED           VALUE 'R'.
  4352             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4353             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4354             88  PB-OVERRIDE-AH               VALUE 'A'.
  4355             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4356         16  PB-BATCH-ENTRY               PIC X.
  4357             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4358             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4359             88  PB-REISSUED-CERT             VALUE 'E'.
  4360             88  PB-MONTHLY-CERT              VALUE 'M'.
  4361             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4362             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4363             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4364         16  PB-FORCE-CODE                PIC X.
  4365             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4366             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4367             88  PB-CANCEL-FORCE              VALUE '8'.
  4368             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4369             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4370             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4371             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4372             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4373             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4374             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4375         16  PB-FATAL-FLAG                PIC X.
  4376             88  PB-FATAL-ERRORS              VALUE 'X'.
  4377         16  PB-FORCE-ER-CD               PIC X.
  4378             88  PB-FORCE-ERRORS              VALUE 'F'.
  4379             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4380         16  PB-WARN-ER-CD                PIC X.
  4381             88  PB-WARNING-ERRORS            VALUE 'W'.
  4382         16  FILLER                       PIC X.
  4383         16  PB-OUT-BAL-CD                PIC X.
  4384             88  PB-OUT-OF-BAL                VALUE 'O'.
  4385         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4386         16  PB-AH-OVERRIDE-L1            PIC X.
  4387         16  PB-INPUT-DT                  PIC XX.
  4388         16  PB-INPUT-BY                  PIC X(4).
  4389         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4390         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4391         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  78
* EL6317.cbl
  4392         16  PB-LF-EARNING-METHOD         PIC X.
  4393         16  PB-AH-EARNING-METHOD         PIC X.
  4394         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4395         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4396         16  PB-REIN-CD                   PIC XXX.
  4397         16  PB-LF-REFUND-TYPE            PIC X.
  4398         16  PB-AH-REFUND-TYPE            PIC X.
  4399         16  PB-ACCT-EFF-DT               PIC XX.
  4400         16  PB-ACCT-EXP-DT               PIC XX.
  4401         16  PB-COMPANY-ID                PIC X(3).
  4402         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4403         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4404         16  PB-SV-CARRIER                PIC X.
  4405         16  PB-SV-GROUPING               PIC X(6).
  4406         16  PB-SV-STATE                  PIC XX.
  4407         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4408         16  PB-GA-BILLING-INFO.
  4409             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4410                                          PIC XX.
  4411         16  PB-SV-REMIT-TO  REDEFINES
  4412             PB-GA-BILLING-INFO           PIC X(10).
  4413         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4414         16  PB-I-LOAN-OFFICER            PIC X(5).
  4415         16  PB-I-VIN                     PIC X(17).
  4416
  4417         16  FILLER                       PIC X(04).
  4418         16  IMNET-BYPASS-SW              PIC X.
  4419
  4420******************************************************************
  4421*                COMMON EDIT ERRORS                              *
  4422******************************************************************
  4423
  4424     12  PB-COMMON-ERRORS.
  4425         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4426                                           PIC S9(4)     COMP.
  4427
  4428******************************************************************
  4429*                                COPY ELCCERT.
  4430******************************************************************
  4431*                                                                *
  4432*                            ELCCERT.                            *
  4433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4434*                            VMOD=2.013                          *
  4435*                                                                *
  4436*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4437*                                                                *
  4438*   FILE TYPE = VSAM,KSDS                                        *
  4439*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4440*                                                                *
  4441*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4442*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4443*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4444*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4445*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4446*                                                                *
  4447*   LOG = YES                                                    *
  4448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4449******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  79
* EL6317.cbl
  4450*                   C H A N G E   L O G
  4451*
  4452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4453*-----------------------------------------------------------------
  4454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4455* EFFECTIVE    NUMBER
  4456*-----------------------------------------------------------------
  4457* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4458* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4459* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4460* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4461* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4462* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4463* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4464* 032612  CR2011110200001  PEMA  AHL CHANGES
  4465******************************************************************
  4466
  4467 01  CERTIFICATE-MASTER.
  4468     12  CM-RECORD-ID                      PIC XX.
  4469         88  VALID-CM-ID                      VALUE 'CM'.
  4470
  4471     12  CM-CONTROL-PRIMARY.
  4472         16  CM-COMPANY-CD                 PIC X.
  4473         16  CM-CARRIER                    PIC X.
  4474         16  CM-GROUPING.
  4475             20  CM-GROUPING-PREFIX        PIC X(3).
  4476             20  CM-GROUPING-PRIME         PIC X(3).
  4477         16  CM-STATE                      PIC XX.
  4478         16  CM-ACCOUNT.
  4479             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4480             20  CM-ACCOUNT-PRIME          PIC X(6).
  4481         16  CM-CERT-EFF-DT                PIC XX.
  4482         16  CM-CERT-NO.
  4483             20  CM-CERT-PRIME             PIC X(10).
  4484             20  CM-CERT-SFX               PIC X.
  4485
  4486     12  CM-CONTROL-BY-NAME.
  4487         16  CM-COMPANY-CD-A1              PIC X.
  4488         16  CM-INSURED-LAST-NAME          PIC X(15).
  4489         16  CM-INSURED-INITIALS.
  4490             20  CM-INSURED-INITIAL1       PIC X.
  4491             20  CM-INSURED-INITIAL2       PIC X.
  4492
  4493     12  CM-CONTROL-BY-SSN.
  4494         16  CM-COMPANY-CD-A2              PIC X.
  4495         16  CM-SOC-SEC-NO.
  4496             20  CM-SSN-STATE              PIC XX.
  4497             20  CM-SSN-ACCOUNT            PIC X(6).
  4498             20  CM-SSN-LN3.
  4499                 25  CM-INSURED-INITIALS-A2.
  4500                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4501                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4502                 25 CM-PART-LAST-NAME-A2         PIC X.
  4503
  4504     12  CM-CONTROL-BY-CERT-NO.
  4505         16  CM-COMPANY-CD-A4              PIC X.
  4506         16  CM-CERT-NO-A4                 PIC X(11).
  4507
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  80
* EL6317.cbl
  4508     12  CM-CONTROL-BY-MEMB.
  4509         16  CM-COMPANY-CD-A5              PIC X.
  4510         16  CM-MEMBER-NO.
  4511             20  CM-MEMB-STATE             PIC XX.
  4512             20  CM-MEMB-ACCOUNT           PIC X(6).
  4513             20  CM-MEMB-LN4.
  4514                 25  CM-INSURED-INITIALS-A5.
  4515                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4516                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4517                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4518
  4519     12  CM-INSURED-PROFILE-DATA.
  4520         16  CM-INSURED-FIRST-NAME.
  4521             20  CM-INSURED-1ST-INIT       PIC X.
  4522             20  FILLER                    PIC X(9).
  4523         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4524         16  CM-INSURED-SEX                PIC X.
  4525             88  CM-SEX-MALE                  VALUE 'M'.
  4526             88  CM-SEX-FEMAL                 VALUE 'F'.
  4527         16  CM-INSURED-JOINT-AGE          PIC 99.
  4528         16  CM-JOINT-INSURED-NAME.
  4529             20  CM-JT-LAST-NAME           PIC X(15).
  4530             20  CM-JT-FIRST-NAME.
  4531                 24  CM-JT-1ST-INIT        PIC X.
  4532                 24  FILLER                PIC X(9).
  4533             20  CM-JT-INITIAL             PIC X.
  4534
  4535     12  CM-LIFE-DATA.
  4536         16  CM-LF-BENEFIT-CD              PIC XX.
  4537         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4538         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4539         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4540         16  CM-LF-DEV-CODE                PIC XXX.
  4541         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4542         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4543         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4544         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4545         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4546         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4547         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4548         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4549         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4550         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4551         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4552         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4553         16  FILLER                        PIC XX.
  4554
  4555     12  CM-AH-DATA.
  4556         16  CM-AH-BENEFIT-CD              PIC XX.
  4557         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4558         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4559         16  CM-AH-DEV-CODE                PIC XXX.
  4560         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4561         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4562         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4563         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4564         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4565         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  81
* EL6317.cbl
  4566         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4567         16  CM-AH-PAID-THRU-DT            PIC XX.
  4568             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4569         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4570         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4571         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4572         16  FILLER                        PIC X.
  4573
  4574     12  CM-LOAN-INFORMATION.
  4575         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4576         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4577                                           PIC S9(5)V99  COMP-3.
  4578         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4579         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4580         16  CM-PAY-FREQUENCY              PIC S99.
  4581         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4582         16  CM-RATE-CLASS                 PIC XX.
  4583         16  CM-BENEFICIARY                PIC X(25).
  4584         16  CM-POLICY-FORM-NO             PIC X(12).
  4585         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4586         16  CM-LAST-ADD-ON-DT             PIC XX.
  4587         16  CM-DEDUCTIBLE-AMOUNTS.
  4588             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4589             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4590         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4591             20  CM-RESIDENT-STATE         PIC XX.
  4592             20  CM-RATE-CODE              PIC X(4).
  4593             20  FILLER                    PIC XX.
  4594         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4595             20  CM-LOAN-OFFICER           PIC X(5).
  4596             20  FILLER                    PIC XXX.
  4597         16  CM-CSR-CODE                   PIC XXX.
  4598         16  CM-UNDERWRITING-CODE          PIC X.
  4599             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4600         16  CM-POST-CARD-IND              PIC X.
  4601         16  CM-NH-INTERFACE-SW            PIC X.
  4602         16  CM-PREMIUM-TYPE               PIC X.
  4603             88  CM-SING-PRM                  VALUE '1'.
  4604             88  CM-O-B-COVERAGE              VALUE '2'.
  4605             88  CM-OPEN-END                  VALUE '3'.
  4606         16  CM-IND-GRP-TYPE               PIC X.
  4607             88  CM-INDIVIDUAL                VALUE 'I'.
  4608             88  CM-GROUP                     VALUE 'G'.
  4609         16  CM-SKIP-CODE                  PIC X.
  4610             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4611             88  SKIP-JULY                    VALUE '1'.
  4612             88  SKIP-AUGUST                  VALUE '2'.
  4613             88  SKIP-SEPTEMBER               VALUE '3'.
  4614             88  SKIP-JULY-AUG                VALUE '4'.
  4615             88  SKIP-AUG-SEPT                VALUE '5'.
  4616             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4617             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4618             88  SKIP-JUNE                    VALUE '8'.
  4619             88  SKIP-JUNE-JULY               VALUE '9'.
  4620             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4621             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4622         16  CM-PAYMENT-MODE               PIC X.
  4623             88  PAY-MONTHLY                  VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  82
* EL6317.cbl
  4624             88  PAY-WEEKLY                   VALUE '1'.
  4625             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4626             88  PAY-BI-WEEKLY                VALUE '3'.
  4627             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4628         16  CM-LOAN-NUMBER                PIC X(8).
  4629         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4630         16  CM-OLD-LOF                    PIC XXX.
  4631*        16  CM-LOAN-OFFICER               PIC XXX.
  4632         16  CM-REIN-TABLE                 PIC XXX.
  4633         16  CM-SPECIAL-REIN-CODE          PIC X.
  4634         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4635         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4636         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4637
  4638     12  CM-STATUS-DATA.
  4639         16  CM-ENTRY-STATUS               PIC X.
  4640         16  CM-ENTRY-DT                   PIC XX.
  4641
  4642         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4643         16  CM-LF-CANCEL-DT               PIC XX.
  4644         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4645
  4646         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4647         16  CM-LF-DEATH-DT                PIC XX.
  4648         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4649
  4650         16  CM-LF-CURRENT-STATUS          PIC X.
  4651             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4652                                                'M' '4' '5' '9'.
  4653             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4654             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4655             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4656             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4657             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4658             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4659             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4660             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4661             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4662             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4663             88  CM-LF-DECLINED               VALUE 'D'.
  4664             88  CM-LF-VOIDED                 VALUE 'V'.
  4665
  4666         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4667         16  CM-AH-CANCEL-DT               PIC XX.
  4668         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4669
  4670         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4671         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4672         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4673
  4674         16  CM-AH-CURRENT-STATUS          PIC X.
  4675             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4676                                                'M' '4' '5' '9'.
  4677             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4678             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4679             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4680             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4681             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  83
* EL6317.cbl
  4682             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4683             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4684             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4685             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4686             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4687             88  CM-AH-DECLINED               VALUE 'D'.
  4688             88  CM-AH-VOIDED                 VALUE 'V'.
  4689
  4690         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4691             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4692             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4693             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4694         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4695
  4696         16  CM-ENTRY-BATCH                PIC X(6).
  4697         16  CM-LF-EXIT-BATCH              PIC X(6).
  4698         16  CM-AH-EXIT-BATCH              PIC X(6).
  4699         16  CM-LAST-MONTH-END             PIC XX.
  4700
  4701     12  CM-NOTE-SW                        PIC X.
  4702         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4703         88  CERT-NOTES-PRESENT               VALUE '1'.
  4704         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4705         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4706         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4707         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4708         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4709         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4710     12  CM-COMP-EXCP-SW                   PIC X.
  4711         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4712         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4713     12  CM-INSURED-ADDRESS-SW             PIC X.
  4714         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4715         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4716
  4717*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4718     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4719     12  FILLER                            PIC X.
  4720
  4721*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4722     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4723     12  FILLER                            PIC X.
  4724*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4725     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4726
  4727     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4728         88  CERT-ADDED-BATCH                 VALUE ' '.
  4729         88  CERT-ADDED-ONLINE                VALUE '1'.
  4730         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4731         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4732         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4733     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4734         88  CERT-AS-LOADED                   VALUE ' '.
  4735         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4736         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4737         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4738         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4739         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  84
* EL6317.cbl
  4740         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4741         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4742
  4743     12  CM-ACCOUNT-COMM-PCTS.
  4744         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4745         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4746
  4747     12  CM-USER-FIELD                     PIC X.
  4748     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4749     12  CM-CLP-STATE                      PIC XX.
  4750     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4751     12  CM-USER-RESERVED                  PIC XXX.
  4752     12  FILLER REDEFINES CM-USER-RESERVED.
  4753         16  CM-AH-CLASS-CD                PIC XX.
  4754         16  F                             PIC X.
  4755******************************************************************
  4756*                                COPY ELCCRTO.
  4757******************************************************************
  4758*                                                                *
  4759*                            ELCCRTO.                            *
  4760*                                                                *
  4761*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4762*                                                                *
  4763*   FILE TYPE = VSAM,KSDS                                        *
  4764*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4765*                                                                *
  4766*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4767*                                                                *
  4768*   LOG = YES                                                    *
  4769*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4770******************************************************************
  4771*                   C H A N G E   L O G
  4772*
  4773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4774*-----------------------------------------------------------------
  4775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4776* EFFECTIVE    NUMBER
  4777*-----------------------------------------------------------------
  4778* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4779* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4780* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4781* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4782* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4783******************************************************************
  4784 01  ORIGINAL-CERTIFICATE.
  4785     12  OC-RECORD-ID                      PIC XX.
  4786         88  VALID-OC-ID                      VALUE 'OC'.
  4787     12  OC-CONTROL-PRIMARY.
  4788         16  OC-COMPANY-CD                 PIC X.
  4789         16  OC-CARRIER                    PIC X.
  4790         16  OC-GROUPING                   PIC X(6).
  4791         16  OC-STATE                      PIC XX.
  4792         16  OC-ACCOUNT                    PIC X(10).
  4793         16  OC-CERT-EFF-DT                PIC XX.
  4794         16  OC-CERT-NO.
  4795             20  OC-CERT-PRIME             PIC X(10).
  4796             20  OC-CERT-SFX               PIC X.
  4797         16  OC-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  85
* EL6317.cbl
  4798         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4799     12  OC-LAST-MAINT-DT                  PIC XX.
  4800     12  OC-LAST-MAINT-BY                  PIC X(4).
  4801     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4802     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4803     12  FILLER                            PIC X(49).
  4804     12  OC-ORIG-REC.
  4805         16  OC-INS-LAST-NAME              PIC X(15).
  4806         16  OC-INS-FIRST-NAME             PIC X(10).
  4807         16  OC-INS-MIDDLE-INIT            PIC X.
  4808         16  OC-INS-AGE                    PIC S999     COMP-3.
  4809         16  OC-JNT-LAST-NAME              PIC X(15).
  4810         16  OC-JNT-FIRST-NAME             PIC X(10).
  4811         16  OC-JNT-MIDDLE-INIT            PIC X.
  4812         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4813         16  OC-LF-BENCD                   PIC XX.
  4814         16  OC-LF-TERM                    PIC S999      COMP-3.
  4815         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4816         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4817         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4818         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4819         16  OC-LF-EXP-DT                  PIC XX.
  4820         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4821         16  OC-LF-CANCEL-DT               PIC XX.
  4822         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4823         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4824         16  OC-AH-BENCD                   PIC XX.
  4825         16  OC-AH-TERM                    PIC S999      COMP-3.
  4826         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4827         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4828         16  OC-AH-EXP-DT                  PIC XX.
  4829         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4830         16  OC-AH-CP                      PIC 99.
  4831         16  OC-AH-CANCEL-DT               PIC XX.
  4832         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4833         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4834         16  OC-CRED-BENE-NAME             PIC X(25).
  4835         16  OC-1ST-PMT-DT                 PIC XX.
  4836         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4837         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4838         16  OC-ISSUE-TRAN-IND             PIC X.
  4839         16  OC-CANCEL-TRAN-IND            PIC X.
  4840         16  FILLER                        PIC X(211).
  4841
  4842     12  FILLER                            PIC X(50).
  4843******************************************************************
  4844*                                COPY ERCENDT.
  4845******************************************************************
  4846*                                                                *
  4847*                                                                *
  4848*                            ERCENDT.                            *
  4849*                            VMOD=2.001                          *
  4850*                                                                *
  4851*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4852*                                                                *
  4853*   FILE TYPE = VSAM,KSDS                                        *
  4854*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4855*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  86
* EL6317.cbl
  4856*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4857*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4858*                                                                *
  4859*   LOG = NO                                                     *
  4860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4861******************************************************************
  4862*-----------------------------------------------------------------
  4863*                   C H A N G E   L O G
  4864*
  4865* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4866*-----------------------------------------------------------------
  4867*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4868* EFFECTIVE    NUMBER
  4869*-----------------------------------------------------------------
  4870* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4871*                                WITH OPEN CLAIMS
  4872* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4873* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4874* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4875*-----------------------------------------------------------------
  4876 01  ENDORSEMENT-RECORD.
  4877     12  EN-RECORD-ID                PIC XX.
  4878         88  VALID-EN-ID                VALUE 'EN'.
  4879     12  EN-CONTROL-PRIMARY.
  4880         16  EN-COMPANY-CD           PIC X.
  4881         16  EN-CARRIER              PIC X.
  4882         16  EN-GROUPING             PIC X(6).
  4883         16  EN-STATE                PIC XX.
  4884         16  EN-ACCOUNT              PIC X(10).
  4885         16  EN-CERT-EFF-DT          PIC XX.
  4886         16  EN-CERT-NO.
  4887             20  EN-CERT-PRIME       PIC X(10).
  4888             20  EN-CERT-SFX         PIC X.
  4889         16  EN-REC-TYPE             PIC X.
  4890             88  EN-ISSUE               VALUE 'I'.
  4891             88  EN-CANCELLATION        VALUE 'C'.
  4892         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4893     12  EN-CONTROL-BY-ARCH-NO.
  4894         16  EN-COMPANY-CD-A1              PIC X.
  4895         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4896     12  EN-LAST-MAINT-DT            PIC XX.
  4897     12  EN-LAST-MAINT-BY            PIC X(4).
  4898     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4899     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4900     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4901         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4902         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4903         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4904         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4905         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4906         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4907         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4908         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4909         16  EN-LF-ORIG-BENCD        PIC XX.
  4910         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4911         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4912         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4913         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  87
* EL6317.cbl
  4914         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4915         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4916*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4917         16  EN-ORIG-CRED-BENE       PIC X(25).
  4918         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4919         16  FILLER                  PIC X.
  4920         16  EN-AH-ORIG-BENCD        PIC XX.
  4921         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4922         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4923         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4924         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4925*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4926*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4927         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4928         16  F                       PIC X(09).
  4929         16  EN-AH-ORIG-CP           PIC 99.
  4930         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4931         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4932         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4933         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4934         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4935         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4936         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4937         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4938         16  EN-LF-NEW-BENCD         PIC XX.
  4939         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4940         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4941         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4942         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4943         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4944         16  EN-LF-NEW-EXP-DT        PIC XX.
  4945         16  EN-NEW-CRED-BENE        PIC X(25).
  4946         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4947         16  FILLER                  PIC X.
  4948         16  EN-AH-NEW-BENCD         PIC XX.
  4949         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4950         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4951         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4952         16  EN-AH-NEW-EXP-DT        PIC XX.
  4953*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4954*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4955*        16  F                       PIC X(12).
  4956         16  EN-AH-NEW-CP            PIC 99.
  4957         16  EN-SIG-SW               PIC X.
  4958         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4959         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  4960         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  4961         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  4962         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  4963         16  FILLER                  PIC X(33).
  4964     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4965         16  EN-LF-ORIG-REF-DT       PIC XX.
  4966         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4967         16  EN-AH-ORIG-REF-DT       PIC XX.
  4968         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4969         16  EN-LF-NEW-REF-DT        PIC XX.
  4970         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4971         16  EN-AH-NEW-REF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  88
* EL6317.cbl
  4972         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4973         16  EN-FLAG-CERT            PIC X.
  4974         16  EN-INS-LAST-NAME        PIC X(15).
  4975         16  EN-INS-FIRST-NAME       PIC X(10).
  4976         16  EN-INS-MIDDLE-INIT      PIC X.
  4977         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4978         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4979         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4980         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4981         16  FILLER                  PIC X(262).
  4982     12  EN-MONEY-SW             PIC X.
  4983     12  EN-HEALTH-APP           PIC X.
  4984     12  EN-VOUCHER-SW           PIC X.
  4985     12  EN-PAYEE                PIC X(14).
  4986     12  EN-INPUT-DT             PIC XX.
  4987     12  EN-PROCESS-DT           PIC XX.
  4988     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4989     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4990     12  EN-REASON-CODES.
  4991         16  F OCCURS 12.
  4992             20  EN-REASON-CODE  PIC X(4).
  4993     12  EN-TEMPLATE-USED        PIC X(8).
  4994     12  EN-DOCU-TYPE            PIC X.
  4995         88  EN-VERI-DOCU          VALUE 'V'.
  4996         88  EN-GCE-DOCU           VALUE 'G'.
  4997         88  EN-CANC-DOCU          VALUE 'C'.
  4998     12  EN-COMMENTS1            PIC X(13).
  4999     12  EN-COMMENTS2            PIC X(70).
  5000     12  EN-COMM-CHGBK           PIC X.
  5001         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5002         88  EN-CHG-ACCT           VALUE 'Y'.
  5003     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5004     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5005     12  EN-BATCH-NUMBER         PIC X(6).
  5006     12  EN-ACCT-SUMM            PIC X.
  5007     12  EN-CSO-SUMM             PIC X.
  5008     12  FILLER                  PIC X(13).
  5009******************************************************************
  5010*                                COPY ERCNOTE.
  5011******************************************************************
  5012*                                                                *
  5013*                                                                *
  5014*                            ERCNOTE                             *
  5015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5016*                            VMOD=2.003                          *
  5017*                                                                *
  5018*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5019*                                                                *
  5020*        FILE TYPE= VSAM,KSDS                                    *
  5021*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5022*                                                                *
  5023*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5024*                                                                *
  5025*        LOG = YES                                               *
  5026*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5027*                                                                *
  5028******************************************************************
  5029*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  89
* EL6317.cbl
  5030*
  5031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5032*-----------------------------------------------------------------
  5033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5034* EFFECTIVE    NUMBER
  5035*-----------------------------------------------------------------
  5036* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5037*                                FILE WILL CONTAIN BILLING NOTES O
  5038******************************************************************
  5039
  5040 01  CERTIFICATE-NOTE.
  5041     12  CN-RECORD-ID                PIC  XX.
  5042         88  VALID-CN-ID                  VALUE 'CN'.
  5043
  5044     12  CN-CONTROL-PRIMARY.
  5045         16  CN-COMPANY-CD           PIC X.
  5046         16  CN-CARRIER              PIC X.
  5047         16  CN-GROUPING.
  5048             20 CN-GROUPING-PREFIX   PIC XXX.
  5049             20 CN-GROUPING-PRIME    PIC XXX.
  5050         16  CN-STATE                PIC XX.
  5051         16  CN-ACCOUNT.
  5052             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5053             20 CN-ACCOUNT-PRIME     PIC X(6).
  5054         16  CN-CERT-EFF-DT          PIC XX.
  5055         16  CN-CERT-NO.
  5056             20  CN-CERT-PRIME       PIC X(10).
  5057             20  CN-CERT-SFX         PIC X.
  5058
  5059     12  CN-BILLING-START-LINE-NO    PIC 99.
  5060     12  CN-BILLING-END-LINE-NO      PIC 99.
  5061
  5062     12  CN-LINES.
  5063         16  CN-LINE OCCURS 10       PIC X(77).
  5064
  5065     12  CN-LAST-MAINT-DT            PIC XX.
  5066     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5067     12  CN-LAST-MAINT-USER          PIC X(4).
  5068     12  FILLER                      PIC X(6).
  5069******************************************************************
  5070*                                COPY ERCMAIL.
  5071******************************************************************
  5072*                                                                *
  5073*                                                                *
  5074*                            ERCMAIL                             *
  5075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5076*                            VMOD=2.003                          *
  5077*                                                                *
  5078*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5079*                                                                *
  5080*   FILE TYPE = VSAM,KSDS                                        *
  5081*   RECORD SIZE = 374   RECFORM = FIX                            *
  5082*                                                                *
  5083*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5084*   ALTERNATE PATH    = NOT USED                                 *
  5085*                                                                *
  5086*   LOG = YES                                                    *
  5087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  90
* EL6317.cbl
  5088******************************************************************
  5089*                   C H A N G E   L O G
  5090*
  5091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5092*-----------------------------------------------------------------
  5093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5094* EFFECTIVE    NUMBER
  5095*-----------------------------------------------------------------
  5096* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5097* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5098* 111108                   PEMA  ADD CRED BENE ADDR2
  5099******************************************************************
  5100
  5101 01  MAILING-DATA.
  5102     12  MA-RECORD-ID                      PIC XX.
  5103         88  VALID-MA-ID                       VALUE 'MA'.
  5104
  5105     12  MA-CONTROL-PRIMARY.
  5106         16  MA-COMPANY-CD                 PIC X.
  5107         16  MA-CARRIER                    PIC X.
  5108         16  MA-GROUPING.
  5109             20  MA-GROUPING-PREFIX        PIC XXX.
  5110             20  MA-GROUPING-PRIME         PIC XXX.
  5111         16  MA-STATE                      PIC XX.
  5112         16  MA-ACCOUNT.
  5113             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5114             20  MA-ACCOUNT-PRIME          PIC X(6).
  5115         16  MA-CERT-EFF-DT                PIC XX.
  5116         16  MA-CERT-NO.
  5117             20  MA-CERT-PRIME             PIC X(10).
  5118             20  MA-CERT-SFX               PIC X.
  5119
  5120     12  FILLER                            PIC XX.
  5121
  5122     12  MA-ACCESS-CONTROL.
  5123         16  MA-SOURCE-SYSTEM              PIC XX.
  5124             88  MA-FROM-CREDIT                VALUE 'CR'.
  5125             88  MA-FROM-VSI                   VALUE 'VS'.
  5126             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5127             88  MA-FROM-OTHER                 VALUE 'OT'.
  5128         16  MA-RECORD-ADD-DT              PIC XX.
  5129         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5130         16  MA-LAST-MAINT-DT              PIC XX.
  5131         16  MA-LAST-MAINT-BY              PIC XXXX.
  5132         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5133
  5134     12  MA-PROFILE-INFO.
  5135         16  MA-QUALIFY-CODE-1             PIC XX.
  5136         16  MA-QUALIFY-CODE-2             PIC XX.
  5137         16  MA-QUALIFY-CODE-3             PIC XX.
  5138         16  MA-QUALIFY-CODE-4             PIC XX.
  5139         16  MA-QUALIFY-CODE-5             PIC XX.
  5140
  5141         16  MA-INSURED-LAST-NAME          PIC X(15).
  5142         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5143         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5144         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5145         16  MA-INSURED-BIRTH-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  91
* EL6317.cbl
  5146         16  MA-INSURED-SEX                PIC X.
  5147             88  MA-SEX-MALE                   VALUE 'M'.
  5148             88  MA-SEX-FEMALE                 VALUE 'F'.
  5149         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5150
  5151         16  MA-ADDRESS-CORRECTED          PIC X.
  5152         16  MA-JOINT-BIRTH-DT             PIC XX.
  5153*        16  FILLER                        PIC X(12).
  5154
  5155         16  MA-ADDRESS-LINE-1             PIC X(30).
  5156         16  MA-ADDRESS-LINE-2             PIC X(30).
  5157         16  MA-CITY-STATE.
  5158             20  MA-CITY                   PIC X(28).
  5159             20  MA-ADDR-STATE             PIC XX.
  5160         16  MA-ZIP.
  5161             20  MA-ZIP-CODE.
  5162                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5163                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5164                 24  FILLER                PIC X(4).
  5165             20  MA-ZIP-PLUS4              PIC X(4).
  5166         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5167             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5168             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5169             20  FILLER                    PIC X(3).
  5170
  5171         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5172
  5173         16  FILLER                        PIC XXX.
  5174*        16  FILLER                        PIC X(10).
  5175
  5176     12  MA-CRED-BENE-INFO.
  5177         16  MA-CRED-BENE-NAME                 PIC X(25).
  5178         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5179         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5180         16  MA-CRED-BENE-CTYST.
  5181             20  MA-CRED-BENE-CITY             PIC X(28).
  5182             20  MA-CRED-BENE-STATE            PIC XX.
  5183         16  MA-CRED-BENE-ZIP.
  5184             20  MA-CB-ZIP-CODE.
  5185                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5186                     88  MA-CB-CANADIAN-POST-CODE
  5187                                           VALUE 'A' THRU 'Z'.
  5188                 24  FILLER                    PIC X(4).
  5189             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5190         16  MA-CB-CANADIAN-POSTAL-CODE
  5191                            REDEFINES MA-CRED-BENE-ZIP.
  5192             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5193             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5194             20  FILLER                        PIC X(3).
  5195     12  MA-POST-CARD-MAIL-DATA.
  5196         16  MA-MAIL-DATA OCCURS 7.
  5197             20  MA-MAIL-TYPE              PIC X.
  5198                 88  MA-12MO-MAILING           VALUE '1'.
  5199                 88  MA-EXP-MAILING            VALUE '2'.
  5200             20  MA-MAIL-STATUS            PIC X.
  5201                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5202                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5203                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  92
* EL6317.cbl
  5204             20  MA-MAIL-DATE              PIC XX.
  5205     12  FILLER                            PIC XX.
  5206     12  FILLER                            PIC XX.
  5207*    12  FILLER                            PIC X(30).
  5208******************************************************************
  5209*                                COPY ERCARCH.
  5210******************************************************************
  5211*                                                                *
  5212*                            ERCARCH.                            *
  5213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5214*                            VMOD=2.002                          *
  5215*                                                                *
  5216*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5217*                                                                *
  5218*   FILE TYPE = VSAM,KSDS                                        *
  5219*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5220*                                                                *
  5221*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5222*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5223*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5224*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5225*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5226*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5227*                                                                *
  5228*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5229******************************************************************
  5230*                   C H A N G E   L O G
  5231*
  5232* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5233*-----------------------------------------------------------------
  5234*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5235* EFFECTIVE    NUMBER
  5236*-----------------------------------------------------------------
  5237* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5238* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5239* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5240******************************************************************
  5241 01  LETTER-ARCHIVE.
  5242     12  LA-RECORD-ID                PIC  X(02).
  5243         88  LA-VALID-ID                VALUE 'LA'.
  5244
  5245     12  LA-CONTROL-PRIMARY.
  5246         16  LA-COMPANY-CD           PIC  X(01).
  5247         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5248
  5249     12  LA-CONTROL-BY-CERT-RESP.
  5250         16  LA-COMPANY-CD-A2        PIC  X(01).
  5251         16  LA-CERT-NO-A2.
  5252             20  LA-CERT-PRIME-A2    PIC  X(10).
  5253             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5254         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5255             20  LA-RESP-PERSON-A2   PIC  X(10).
  5256             20  LA-TYPE-A2          PIC  X(01).
  5257         16  LA-CARRIER-A2           PIC  X(01).
  5258         16  LA-GROUPING-A2          PIC  X(06).
  5259         16  LA-STATE-A2             PIC  X(02).
  5260         16  LA-ACCOUNT-A2           PIC  X(10).
  5261         16  LA-EFFECT-DATE-A2       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  93
* EL6317.cbl
  5262         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5263
  5264     12  LA-CONTROL-BY-FORM.
  5265         16  LA-COMPANY-CD-A3        PIC  X(01).
  5266         16  LA-FORM-A3              PIC  X(04).
  5267         16  LA-CARRIER-A3           PIC  X(01).
  5268         16  LA-GROUPING-A3          PIC  X(06).
  5269         16  LA-STATE-A3             PIC  X(02).
  5270         16  LA-ACCOUNT-A3           PIC  X(10).
  5271         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5272
  5273     12  LA-CONTROL-BY-PROCESSOR.
  5274         16  LA-COMPANY-CD-A4        PIC  X(01).
  5275         16  LA-PROCESSOR-CD         PIC  X(04).
  5276         16  LA-CARRIER-A4           PIC  X(01).
  5277         16  LA-GROUPING-A4          PIC  X(06).
  5278         16  LA-STATE-A4             PIC  X(02).
  5279         16  LA-ACCOUNT-A4           PIC  X(10).
  5280         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5281
  5282     12  LA-CONTROL-BY-KEY-FIELDS.
  5283         16  LA-COMPANY-CD-A5        PIC  X(01).
  5284         16  LA-CARRIER-A5           PIC  X(01).
  5285         16  LA-GROUPING-A5          PIC  X(06).
  5286         16  LA-STATE-A5             PIC  X(02).
  5287         16  LA-ACCOUNT-A5           PIC  X(10).
  5288         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5289
  5290     12  LA-CONTROL-BY-GROUP-CODE.
  5291         16  LA-COMPANY-CD-A6        PIC  X(01).
  5292         16  LA-ENTRY-A6.
  5293             20  LA-FILLER           PIC  X(02).
  5294             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5295         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5296
  5297     12  FILLER                      PIC  X(09).
  5298
  5299     12  LA-HEADER-RECORD.
  5300         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5301         16  LA-CREATION-DATE        PIC  X(02).
  5302         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5303         16  LA-FINAL-ACT-DATE       REDEFINES
  5304               LA-FOLLOW-UP-DATE     PIC  X(02).
  5305         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5306         16  LA-NO-OF-COPIES         PIC S9(01).
  5307         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5308         16  LA-REPLY-DATE           PIC  X(02).
  5309         16  LA-RESEND-DATES.
  5310             20  LA-RESEND-DATE      PIC  X(02).
  5311             20  LA-SENT-DATE        PIC  X(02).
  5312             20  FILLER              PIC  X(08).
  5313         16  LA-SOURCE-INFORMATION.
  5314             20  LA-DATA-SOURCE      PIC  X(01).
  5315             20  LA-ADDR-SOURCE      PIC  X(01).
  5316         16  LA-STATUS               PIC  X(01).
  5317             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5318             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5319             88  LA-STATUS-ON-HOLD        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  94
* EL6317.cbl
  5320             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5321             88  LA-STATUS-PURGED         VALUE 'P'.
  5322             88  LA-STATUS-VOIDED         VALUE 'V'.
  5323         16  LA-LAST-RESENT-PRINT-DATE
  5324                                     PIC  X(02).
  5325         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5326             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5327                                          VALUE 'C'.
  5328             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5329                                          VALUE 'F'.
  5330             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5331                                          VALUE 'P'.
  5332         16  LA-PURGED-DATE          PIC  X(02).
  5333         16  LA-VOIDED-DATE          PIC  X(02).
  5334         16  LA-RESEND-LETR          PIC  X(4).
  5335         16  FILLER                  PIC  X(08).
  5336*        16  LA-RESEND-LETR-2        PIC  X(4).
  5337*        16  LA-RESEND-LETR-3        PIC  X(4).
  5338*        16  FILLER                  PIC  X(59).
  5339         16  LA-ARCHIVE-STATUS       PIC  X.
  5340             88  LA-TEMP                VALUE 'T'.
  5341             88  LA-QWS                 VALUE 'Q'.
  5342             88  LA-BATCH               VALUE 'B'.
  5343         16  LA-FINAL-ACT-IND        PIC  X(1).
  5344         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5345         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5346         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5347                                     PIC X(4).
  5348         16  FILLER                  PIC  X(42).
  5349*        16  FILLER                  PIC  X(71).
  5350         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5351         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5352         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5353                                     PIC  X(4).
  5354         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5355
  5356******************************************************************
  5357*                                COPY ERCCNOT.
  5358******************************************************************
  5359*                                                                *
  5360*                            ERCCNOT                             *
  5361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5362*                            VMOD=2.003                          *
  5363*                                                                *
  5364*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5365*                                                                *
  5366*        FILE TYPE= VSAM,KSDS                                    *
  5367*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5368*                                                                *
  5369*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5370*                                                                *
  5371*        LOG = YES                                               *
  5372*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5373*                                                                *
  5374******************************************************************
  5375*                   C H A N G E   L O G
  5376*
  5377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  95
* EL6317.cbl
  5378*-----------------------------------------------------------------
  5379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5380* EFFECTIVE    NUMBER
  5381*-----------------------------------------------------------------
  5382* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5383******************************************************************
  5384
  5385 01  CERT-NOTE-FILE.
  5386     12  CZ-RECORD-ID                PIC  XX.
  5387         88  VALID-CZ-ID                  VALUE 'CZ'.
  5388
  5389     12  CZ-CONTROL-PRIMARY.
  5390         16  CZ-COMPANY-CD           PIC X.
  5391         16  CZ-CARRIER              PIC X.
  5392         16  CZ-GROUPING.
  5393             20 CZ-GROUPING-PREFIX   PIC XXX.
  5394             20 CZ-GROUPING-PRIME    PIC XXX.
  5395         16  CZ-STATE                PIC XX.
  5396         16  CZ-ACCOUNT.
  5397             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5398             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5399         16  CZ-CERT-EFF-DT          PIC XX.
  5400         16  CZ-CERT-NO.
  5401             20  CZ-CERT-PRIME       PIC X(10).
  5402             20  CZ-CERT-SFX         PIC X.
  5403         16  CZ-RECORD-TYPE          PIC X.
  5404             88  CERT-NOTE           VALUE '1'.
  5405             88  CLAIM-CERT-NOTE     VALUE '2'.
  5406         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5407
  5408     12  CZ-LAST-MAINT-DT            PIC XX.
  5409     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5410     12  CZ-LAST-MAINT-USER          PIC X(4).
  5411
  5412     12  CZ-NOTE-INFORMATION.
  5413         16  CZ-NOTE                 PIC X(63).
  5414         16  FILLER                  PIC X(39).
  5415******************************************************************
  5416*                                COPY ELCEOBC.
  5417******************************************************************
  5418*                                                                *
  5419*                                                                *
  5420*                            ELCEOBC                             *
  5421*                            VMOD=2.001                          *
  5422*                                                                *
  5423*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5424*                                                                *
  5425*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5426*   VSAM EOB CODE TABLE                                          *
  5427*                                                                *
  5428*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5429*                                                                *
  5430*   FILE TYPE = VSAM,KSDS                                        *
  5431*   RECORD SIZE = 350   RECFORM = FIX                            *
  5432*                                                                *
  5433*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5434*                                                                *
  5435*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  96
* EL6317.cbl
  5436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5437*                                                                *
  5438*                                                                *
  5439******************************************************************
  5440*                   C H A N G E   L O G
  5441*
  5442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5443*-----------------------------------------------------------------
  5444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5445* EFFECTIVE    NUMBER
  5446*-----------------------------------------------------------------
  5447* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5448* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5449******************************************************************
  5450 01  EOB-CODES.
  5451     12  EO-RECORD-ID                      PIC XX.
  5452         88  VALID-DN-ID                      VALUE 'EO'.
  5453     12  EO-CONTROL-PRIMARY.
  5454         16  EO-COMPANY-CD                 PIC X.
  5455         16  EO-RECORD-TYPE                PIC X.
  5456             88  EO-EOB-RECS                  VALUE '1'.
  5457             88  EO-VERIF-RECS                VALUE '2'.
  5458             88  EO-GCE-RECS                  VALUE '3'.
  5459         16  EO-EOB-CODE                   PIC X(4).
  5460         16  FILLER                        PIC X(9).
  5461     12  EO-MAINT-INFORMATION.
  5462         16  EO-LAST-MAINT-DT              PIC XX.
  5463         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5464         16  EO-LAST-MAINT-USER            PIC X(4).
  5465         16  FILLER                        PIC XX.
  5466     12  EO-DESCRIPTION                    PIC X(275).
  5467     12  FILLER                            PIC X(46).
  5468******************************************************************
  5469*                                COPY ELCCRTT.
  5470******************************************************************
  5471*                                                                *
  5472*                            ELCCRTT.                            *
  5473*                                                                *
  5474*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5475*                                                                *
  5476*   FILE TYPE = VSAM,KSDS                                        *
  5477*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5478*                                                                *
  5479*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5480*                                                                *
  5481*   LOG = YES                                                    *
  5482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5483******************************************************************
  5484*                   C H A N G E   L O G
  5485*
  5486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5487*-----------------------------------------------------------------
  5488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5489* EFFECTIVE    NUMBER
  5490*-----------------------------------------------------------------
  5491* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5492* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5493* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  97
* EL6317.cbl
  5494* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5495******************************************************************
  5496
  5497 01  CERTIFICATE-TRAILERS.
  5498     12  CS-RECORD-ID                      PIC XX.
  5499         88  VALID-CS-ID                      VALUE 'CS'.
  5500
  5501     12  CS-CONTROL-PRIMARY.
  5502         16  CS-COMPANY-CD                 PIC X.
  5503         16  CS-CARRIER                    PIC X.
  5504         16  CS-GROUPING                   PIC X(6).
  5505         16  CS-STATE                      PIC XX.
  5506         16  CS-ACCOUNT                    PIC X(10).
  5507         16  CS-CERT-EFF-DT                PIC XX.
  5508         16  CS-CERT-NO.
  5509             20  CS-CERT-PRIME             PIC X(10).
  5510             20  CS-CERT-SFX               PIC X.
  5511         16  CS-TRAILER-TYPE               PIC X.
  5512             88  COMM-TRLR           VALUE 'A'.
  5513             88  FUTURE-TRLR         VALUE 'B'.
  5514             88  CERT-DATA-TRLR      VALUE 'C'.
  5515
  5516     12  CS-DATA-AREA                      PIC X(516).
  5517
  5518     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5519         16  CS-BANK-COMMISSION-AREA.
  5520             20  CS-BANK-COMMS       OCCURS 10.
  5521                 24  CS-AGT                PIC X(10).
  5522                 24  CS-COM-TYP            PIC X.
  5523                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5524                 24  CS-RECALC-LV-INDIC    PIC X.
  5525                 24  FILLER                PIC X(10).
  5526         16  FILLER                        PIC X(256).
  5527
  5528     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5529         16  CS-VIN-NUMBER                 PIC X(17).
  5530         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5531         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5532         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5533         16  FILLER                        PIC X(496).
  5534******************************************************************
  5535 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5536                          ACCOUNT-MASTER CONTROL-FILE
  5537                          PENDING-BUSINESS CERTIFICATE-MASTER
  5538                          ORIGINAL-CERTIFICATE
  5539                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5540                          MAILING-DATA LETTER-ARCHIVE
  5541                          CERT-NOTE-FILE EOB-CODES
  5542                          CERTIFICATE-TRAILERS.
  5543 0000-DFHEXIT SECTION.
  5544     MOVE '9#                    $   ' TO DFHEIV0.
  5545     MOVE 'EL6317' TO DFHEIV1.
  5546     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5547     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5548     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5549     MOVE '5'                    TO DC-OPTION-CODE
  5550     PERFORM 9700-DATE-LINK
  5551     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  98
* EL6317.cbl
  5552     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5553     MOVE EIBTRMID               TO QID-TERM
  5554     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5555     IF EIBCALEN = 0
  5556        GO TO 8800-UNAUTHORIZED-ACCESS
  5557     END-IF
  5558     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5559     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5560        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5561           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5562           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5563           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5564           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5565           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5566           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5567           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5568           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5569           MOVE LOW-VALUES           TO EL631JI
  5570           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5571           GO TO 0350-BUILD-INIT-MAP
  5572        END-IF
  5573     END-IF
  5574     IF PI-CALLING-PROGRAM = 'EL614'
  5575        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5576                                 TO WS-PASSED-REASON-CODES
  5577        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5578        IF WS-PASSED-REASON-CODES NOT = SPACES
  5579           MOVE 'Y'              TO WS-SET-CODES-MDT
  5580        ELSE
  5581           MOVE 'N'              TO WS-SET-CODES-MDT
  5582        END-IF
  5583        PERFORM 0600-RECOVER-TEMP-STORAGE
  5584                                 THRU 0600-EXIT
  5585        GO TO 0350-BUILD-INIT-MAP
  5586     END-IF
  5587     IF EIBAID = DFHCLEAR
  5588        IF PI-CLEAR-ERROR
  5589           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5590           MOVE ER-3833           TO EMI-ERROR
  5591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5592           GO TO 0350-BUILD-INIT-MAP
  5593        ELSE
  5594           GO TO 9400-CLEAR
  5595        END-IF
  5596     END-IF
  5597     .
  5598 0200-RECEIVE.
  5599     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5600        MOVE ER-0008             TO EMI-ERROR
  5601        PERFORM 9900-ERROR-FORMAT
  5602                                 THRU 9900-EXIT
  5603        MOVE -1                  TO PFENTRL
  5604        GO TO 8100-SEND-INITIAL-MAP
  5605     END-IF
  5606
  5607* EXEC CICS RECEIVE
  5608*        MAP      (MAP-NAME)
  5609*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  99
* EL6317.cbl
  5610*        INTO     (EL631JI)
  5611*    END-EXEC
  5612     MOVE LENGTH OF
  5613      EL631JI
  5614       TO DFHEIV11
  5615*    MOVE '8"T I  L              ''   #00005602' TO DFHEIV0
  5616     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5618     MOVE X'2020233030303035363032' TO DFHEIV0(25:11)
  5619     CALL 'kxdfhei1' USING DFHEIV0,
  5620           MAP-NAME,
  5621           EL631JI,
  5622           DFHEIV11,
  5623           MAPSET-NAME,
  5624           DFHEIV99,
  5625           DFHEIV99
  5626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5627     IF PFENTRL = 0
  5628         GO TO 0300-CHECK-PFKEYS
  5629     END-IF
  5630     IF EIBAID NOT = DFHENTER
  5631         MOVE ER-0004            TO EMI-ERROR
  5632         GO TO 0320-INPUT-ERROR
  5633     END-IF
  5634     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5635        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5636     ELSE
  5637        MOVE ER-0029            TO EMI-ERROR
  5638        GO TO 0320-INPUT-ERROR
  5639     END-IF
  5640     .
  5641 0300-CHECK-PFKEYS.
  5642     IF EIBAID = DFHPF3
  5643        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5644        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5645        MOVE 'EL614'             TO PGM-NAME
  5646        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5647        move +1                  to s2
  5648        perform varying s1 from +1 by +1 until s1 > +12
  5649           if reacd-in (s1) not = spaces and low-values
  5650              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5651              add +5 to s2
  5652           end-if
  5653        END-perform
  5654        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5655        GO TO 9300-XCTL
  5656     END-IF
  5657     IF EIBAID = DFHPF4 OR DFHPF8
  5658        GO TO 0360-FINALIZE
  5659     END-IF
  5660     IF EIBAID = DFHPF23
  5661        IF PI-CLEAR-ERROR
  5662           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5663           MOVE ER-3833           TO EMI-ERROR
  5664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5665           GO TO 0350-BUILD-INIT-MAP
  5666        ELSE
  5667           GO TO 8810-PF23
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 100
* EL6317.cbl
  5668        END-IF
  5669     END-IF
  5670     IF EIBAID = DFHPF24
  5671        IF PI-CLEAR-ERROR
  5672           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5673           MOVE ER-3833           TO EMI-ERROR
  5674           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5675           GO TO 0350-BUILD-INIT-MAP
  5676        ELSE
  5677           GO TO 9200-RETURN-MAIN-MENU
  5678        END-IF
  5679     END-IF
  5680     IF EIBAID = DFHPF12
  5681        GO TO 9500-PF12
  5682     END-IF
  5683     IF EIBAID = DFHENTER
  5684        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5685        GO TO 0325-EDIT-SCREEN
  5686     END-IF
  5687     MOVE ER-0029                TO EMI-ERROR
  5688     .
  5689 0320-INPUT-ERROR.
  5690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5691     MOVE AL-UNBON               TO PFENTRA
  5692     MOVE -1                     TO PFENTRL
  5693     GO TO 8200-SEND-DATAONLY
  5694     .
  5695 0325-EDIT-SCREEN.
  5696     if prtswl > zeros
  5697        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5698*          MOVE AL-UANON       TO PRTSWA
  5699*          IF PRTSWI = ' '
  5700              MOVE 'P'         TO PRTSWI
  5701*          END-IF
  5702*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5703        END-IF
  5704     END-IF
  5705     IF (SIGREQL > ZEROS)
  5706        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5707        MOVE AL-UANON         TO SIGREQA
  5708        IF SIGREQI = ' '
  5709           MOVE 'N'           TO SIGREQI
  5710        END-IF
  5711        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5712     ELSE
  5713        MOVE ER-2651          TO EMI-ERROR
  5714        MOVE -1               TO SIGREQL
  5715        MOVE AL-UABON         TO SIGREQA
  5716        PERFORM 9900-ERROR-FORMAT
  5717                                 THRU 9900-EXIT
  5718     END-IF
  5719     IF LTRIDL > ZEROS
  5720        AND LTRIDI > SPACES
  5721        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5722        MOVE LTRIDI              TO LETR-LETTER-ID
  5723                                    PI-LTRID-ENTERED
  5724        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5725        MOVE SPACES              TO LETR-FILLER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 101
* EL6317.cbl
  5726        MOVE 0                   TO LETR-SEQ-NO
  5727        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5728     ELSE
  5729        MOVE ER-1236          TO EMI-ERROR
  5730        MOVE -1               TO LTRIDL
  5731        MOVE AL-UABON         TO LTRIDA
  5732        PERFORM 9900-ERROR-FORMAT
  5733                                 THRU 9900-EXIT
  5734     END-IF
  5735
  5736     IF W-PROMPT-LETTER EQUAL 'Y'
  5737         MOVE ER-0894            TO EMI-ERROR
  5738         MOVE -1                 TO LTRIDL
  5739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5740     END-IF
  5741     SET REASONS-NOT-FOUND TO TRUE
  5742     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5743        IF REACDL (S1) = +4 OR
  5744          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5745              MOVE AL-SANON     TO REACDA (S1)
  5746              SET REASONS-FOUND TO TRUE
  5747        END-IF
  5748     END-PERFORM
  5749
  5750     IF REASONS-NOT-FOUND
  5751        MOVE ER-1820             TO EMI-ERROR
  5752        MOVE -1                  TO PFENTRL
  5753        PERFORM 9900-ERROR-FORMAT
  5754                                 THRU 9900-EXIT
  5755     ELSE
  5756        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5757     END-IF
  5758
  5759     IF CRTNT1L > ZEROS
  5760        IF CRTNT1I > SPACES
  5761           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5762        END-IF
  5763     END-IF
  5764
  5765     IF CRTNT2L > ZEROS
  5766        IF CRTNT2I > SPACES
  5767           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5768        END-IF
  5769     END-IF
  5770
  5771     IF BILNT1L > ZEROS
  5772        IF BILNT1I > SPACES
  5773           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5774        END-IF
  5775     END-IF
  5776
  5777     IF BILNT2L > ZEROS
  5778        IF BILNT2I > SPACES
  5779           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5780        END-IF
  5781     END-IF
  5782
  5783     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 102
* EL6317.cbl
  5784 0325-EXIT.
  5785     EXIT.
  5786
  5787 0326-GET-Z-RECORD.
  5788
  5789     MOVE SPACES  TO W-Z-CONTROL-DATA
  5790
  5791
  5792* EXEC CICS STARTBR
  5793*         DATASET    ('ELLETR')
  5794*         RIDFLD     (ELLETR-KEY)
  5795*         GTEQ
  5796*         RESP      (WS-RESPONSE)
  5797*    END-EXEC.
  5798     MOVE 'ELLETR' TO DFHEIV1
  5799     MOVE 0
  5800       TO DFHEIV11
  5801*    MOVE '&,         G          &  N#00005771' TO DFHEIV0
  5802     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5803     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5804     MOVE X'204E233030303035373731' TO DFHEIV0(25:11)
  5805     CALL 'kxdfhei1' USING DFHEIV0,
  5806           DFHEIV1,
  5807           ELLETR-KEY,
  5808           DFHEIV99,
  5809           DFHEIV11,
  5810           DFHEIV99
  5811     MOVE EIBRESP  TO WS-RESPONSE
  5812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5813
  5814     IF NOT RESP-NORMAL
  5815         MOVE ER-1236          TO EMI-ERROR
  5816         MOVE -1               TO LTRIDL
  5817         MOVE AL-UABON         TO LTRIDA
  5818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5819         GO TO 0326-ENDBR
  5820     END-IF.
  5821
  5822 0326-READNEXT.
  5823
  5824
  5825* EXEC CICS READNEXT
  5826*        DATASET   ('ELLETR')
  5827*        INTO      (TEXT-FILES)
  5828*        RIDFLD    (ELLETR-KEY)
  5829*        RESP      (WS-RESPONSE)
  5830*    END-EXEC
  5831     MOVE LENGTH OF
  5832      TEXT-FILES
  5833       TO DFHEIV12
  5834     MOVE 'ELLETR' TO DFHEIV1
  5835     MOVE 0
  5836       TO DFHEIV11
  5837*    MOVE '&.IL                  )  N#00005787' TO DFHEIV0
  5838     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5839     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5840     MOVE X'204E233030303035373837' TO DFHEIV0(25:11)
  5841     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 103
* EL6317.cbl
  5842           DFHEIV1,
  5843           TEXT-FILES,
  5844           DFHEIV12,
  5845           ELLETR-KEY,
  5846           DFHEIV99,
  5847           DFHEIV11,
  5848           DFHEIV99,
  5849           DFHEIV99
  5850     MOVE EIBRESP  TO WS-RESPONSE
  5851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5852     IF RESP-NORMAL
  5853        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5854           MOVE ER-1236          TO EMI-ERROR
  5855           MOVE -1               TO LTRIDL
  5856           MOVE AL-UABON         TO LTRIDA
  5857           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5858           GO TO 0326-ENDBR
  5859        END-IF
  5860
  5861        MOVE AL-UANON         TO LTRIDA
  5862        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5863           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5864        ELSE
  5865           GO TO 0326-READNEXT
  5866        END-IF
  5867     ELSE
  5868        MOVE ER-1236          TO EMI-ERROR
  5869        MOVE -1               TO LTRIDL
  5870        MOVE AL-UABON         TO LTRIDA
  5871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5872        GO TO 0326-ENDBR
  5873     END-IF.
  5874
  5875 0326-ENDBR.
  5876
  5877
  5878* EXEC CICS ENDBR
  5879*        DATASET     ('ELLETR')
  5880*    END-EXEC.
  5881     MOVE 'ELLETR' TO DFHEIV1
  5882     MOVE 0
  5883       TO DFHEIV11
  5884*    MOVE '&2                    $   #00005818' TO DFHEIV0
  5885     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5887     MOVE X'2020233030303035383138' TO DFHEIV0(25:11)
  5888     CALL 'kxdfhei1' USING DFHEIV0,
  5889           DFHEIV1,
  5890           DFHEIV11,
  5891           DFHEIV99
  5892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5893
  5894
  5895 0326-EXIT.
  5896      EXIT.
  5897 0330-CHECK-ERRORS.
  5898     IF EMI-NO-ERRORS
  5899        GO TO 0350-BUILD-INIT-MAP
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 104
* EL6317.cbl
  5900     ELSE
  5901        GO TO 8200-SEND-DATAONLY
  5902     END-IF
  5903     .
  5904 0330-EXIT.
  5905     EXIT.
  5906 0350-BUILD-INIT-MAP.
  5907
  5908     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5909        display 'coming from el1273 '
  5910        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5911        MOVE PI-CARRIER             TO CRTO-CARRIER
  5912        MOVE PI-GROUPING            TO CRTO-GROUPING
  5913        MOVE PI-STATE               TO CRTO-STATE
  5914        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5915        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5916        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5917        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5918        MOVE 'I'                    TO CRTO-RECORD-TYPE
  5919        MOVE ZEROS                  TO CRTO-SEQ-NO
  5920        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5921                                       PI-ERENDT-KEY
  5922     END-IF
  5923     MOVE PI-CRTO-CARRIER        TO CARRO
  5924     MOVE PI-CRTO-GROUPING       TO GROUPO
  5925     MOVE PI-CRTO-STATE          TO STATEO
  5926     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5927     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5928     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5929     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5930     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5931     MOVE ' '                    TO DC-OPTION-CODE
  5932     PERFORM 9700-DATE-LINK
  5933     IF NO-CONVERSION-ERROR
  5934        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5935     END-IF
  5936
  5937*    IF PI-PRTSW-ENTERED > SPACES
  5938*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5939*       MOVE AL-UANON            TO PRTSWA
  5940*       MOVE +1                  TO PRTSWL
  5941*    END-IF
  5942
  5943     IF PI-SIGREQ-ENTERED > SPACES
  5944        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5945        MOVE AL-UANON            TO SIGREQA
  5946        MOVE +1                  TO SIGREQL
  5947     END-IF
  5948
  5949     IF PI-LTRID-ENTERED > SPACES
  5950        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5951        MOVE AL-UANON            TO LTRIDA
  5952        MOVE +4                  TO LTRIDL
  5953     END-IF
  5954
  5955     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5956     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5957        IF REACDL (S1) = +4 OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 105
* EL6317.cbl
  5958          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5959              MOVE AL-SANON      TO REACDA (S1)
  5960              MOVE +4            TO REACDL (S1)
  5961              SET REASONS-FOUND  TO TRUE
  5962        END-IF
  5963     END-PERFORM
  5964
  5965     IF PI-CERTNT1-ENTERED > SPACES
  5966        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5967        MOVE AL-UANON            TO CRTNT1A
  5968        MOVE +63                 TO CRTNT1L
  5969     END-IF
  5970
  5971     IF PI-CERTNT2-ENTERED > SPACES
  5972        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5973        MOVE AL-UANON            TO CRTNT2A
  5974        MOVE +63                 TO CRTNT2L
  5975     END-IF
  5976
  5977     IF PI-BILLNT1-ENTERED > SPACES
  5978        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5979        MOVE AL-UANON            TO BILNT1A
  5980        MOVE +63                 TO BILNT1L
  5981     END-IF
  5982
  5983     IF PI-BILLNT2-ENTERED > SPACES
  5984        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  5985        MOVE AL-UANON            TO BILNT2A
  5986        MOVE +63                 TO BILNT2L
  5987     END-IF
  5988
  5989     GO TO 8100-SEND-INITIAL-MAP
  5990     .
  5991 0360-FINALIZE.
  5992     display ' made it to 0360 '
  5993     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  5994     IF NOT EMI-NO-ERRORS
  5995       AND EIBAID = DFHPF4
  5996        GO TO 8200-SEND-DATAONLY
  5997     END-IF
  5998     set P to address of KIXSYS
  5999     CALL "getenv" using by value P returning var-ptr
  6000     if var-ptr = null then
  6001        display ' kixsys not set '
  6002     else
  6003        set address of var to var-ptr
  6004        move 0 to env-var-len
  6005        inspect var tallying env-var-len
  6006          for characters before X'00'
  6007*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6008        unstring var (1:env-var-len) delimited by '/'
  6009           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6010              WS-KIX-SYS
  6011        end-unstring
  6012*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6013*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6014     end-if
  6015     set P to address of KIXHOST
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 106
* EL6317.cbl
  6016     CALL "getenv" using by value P returning var-ptr
  6017     if var-ptr = null then
  6018        display ' kixhost not set '
  6019     else
  6020        set address of var to var-ptr
  6021        move 0 to env-var-len
  6022        inspect var tallying env-var-len
  6023          for characters before X'00'
  6024*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6025        MOVE var(1:env-var-len)  to ws-kixhost
  6026        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6027     end-if
  6028     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6029     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6030     IF RESP-NORMAL
  6031        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6032        DISPLAY ' RESP NORMAL AND = '
  6033        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  6034                               PI-CRTO-SEQ-NO
  6035        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  6036        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  6037        SUBTRACT +1         FROM NCRTO-SEQ-NO
  6038        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6039*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6040        PERFORM 1100-CALL-NS-BUS-LOGIC
  6041                                 THRU 1100-EXIT
  6042        IF BL-OK
  6043           CONTINUE
  6044        ELSE
  6045           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6046           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6047           MOVE -1               TO CARRL
  6048        END-IF
  6049     ELSE
  6050        MOVE ER-9999             TO EMI-ERROR
  6051        PERFORM 9900-ERROR-FORMAT
  6052                                 THRU 9900-EXIT
  6053        MOVE -1                  TO CARRL
  6054        GO TO 8100-SEND-INITIAL-MAP
  6055     END-IF
  6056     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6057                                 TO SYSO
  6058     MOVE WS-KIXHOST             TO HOSTO
  6059     MOVE PI-COMPANY-ID          TO COMPANYO
  6060     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6061         MOVE '2'                TO DATASORO
  6062     ELSE
  6063         MOVE '4'                TO DATASORO
  6064     END-IF
  6065     MOVE BL-BATCH-NO            TO BATCHNOO
  6066     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6067     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6068     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6069*    MOVE -1                     TO PRTSWL
  6070*    MOVE AL-UANON               TO PRTSWA
  6071     MOVE -1                     TO SIGREQL
  6072     MOVE AL-UANON               TO SIGREQA
  6073     IF EIBAID = DFHPF4
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 107
* EL6317.cbl
  6074        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6075        MOVE ER-0280             TO EMI-ERROR
  6076        PERFORM 9900-ERROR-FORMAT
  6077                                 THRU 9900-EXIT
  6078        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6079        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6080        MOVE 'Y'                 TO PI-FINALIZED-IND
  6081        GO TO 9400-CLEAR
  6082     ELSE
  6083        MOVE ER-1818             TO EMI-ERROR
  6084        PERFORM 9900-ERROR-FORMAT
  6085                                 THRU 9900-EXIT
  6086     END-IF
  6087     GO TO 0350-BUILD-INIT-MAP
  6088     .
  6089 0360-EXIT.
  6090     EXIT.
  6091 0362-READ-ELCRTO.
  6092     display ' made it to 0362 '
  6093
  6094* EXEC CICS READ
  6095*        DATASET   (WS-ELCRTO-FILE-ID)
  6096*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6097*        RIDFLD    (ELCRTO-KEY)
  6098*        GTEQ
  6099*        RESP      (WS-RESPONSE)
  6100*    END-EXEC
  6101*    MOVE '&"S        G          (  N#00006020' TO DFHEIV0
  6102     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6104     MOVE X'204E233030303036303230' TO DFHEIV0(25:11)
  6105     CALL 'kxdfhei1' USING DFHEIV0,
  6106           WS-ELCRTO-FILE-ID,
  6107           DFHEIV20,
  6108           DFHEIV99,
  6109           ELCRTO-KEY,
  6110           DFHEIV99,
  6111           DFHEIV99,
  6112           DFHEIV99
  6113     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6114         DFHEIV20
  6115     MOVE EIBRESP  TO WS-RESPONSE
  6116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6117     .
  6118 0362-EXIT.
  6119     EXIT.
  6120 0363-READ-ELCRTO-UPD.
  6121     display ' made it to 0363 '
  6122
  6123* EXEC CICS READ
  6124*        DATASET   (WS-ELCRTO-FILE-ID)
  6125*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6126*        RIDFLD    (ELCRTO-KEY)
  6127*        UPDATE
  6128*        RESP      (WS-RESPONSE)
  6129*    END-EXEC
  6130*    MOVE '&"S        EU         (  N#00006032' TO DFHEIV0
  6131     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 108
* EL6317.cbl
  6132     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6133     MOVE X'204E233030303036303332' TO DFHEIV0(25:11)
  6134     CALL 'kxdfhei1' USING DFHEIV0,
  6135           WS-ELCRTO-FILE-ID,
  6136           DFHEIV20,
  6137           DFHEIV99,
  6138           ELCRTO-KEY,
  6139           DFHEIV99,
  6140           DFHEIV99,
  6141           DFHEIV99
  6142     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6143         DFHEIV20
  6144     MOVE EIBRESP  TO WS-RESPONSE
  6145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6146     .
  6147 0363-EXIT.
  6148     EXIT.
  6149 0365-READ-ERENDT.
  6150
  6151* EXEC CICS READ
  6152*        DATASET   (WS-ERENDT-FILE-ID)
  6153*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6154*        RIDFLD    (ERENDT-KEY)
  6155*        RESP      (WS-RESPONSE)
  6156*    END-EXEC
  6157*    MOVE '&"S        E          (  N#00006043' TO DFHEIV0
  6158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6160     MOVE X'204E233030303036303433' TO DFHEIV0(25:11)
  6161     CALL 'kxdfhei1' USING DFHEIV0,
  6162           WS-ERENDT-FILE-ID,
  6163           DFHEIV20,
  6164           DFHEIV99,
  6165           ERENDT-KEY,
  6166           DFHEIV99,
  6167           DFHEIV99,
  6168           DFHEIV99
  6169     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6170         DFHEIV20
  6171     MOVE EIBRESP  TO WS-RESPONSE
  6172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6173     .
  6174 0365-EXIT.
  6175     EXIT.
  6176 0400-ADD-ERENDT.
  6177     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6178     display ' made it to 0400 '
  6179
  6180* EXEC CICS GETMAIN
  6181*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6182*         LENGTH   (ERENDT-LENGTH)
  6183*         INITIMG  (GETMAIN-SPACE)
  6184*    END-EXEC
  6185*    MOVE ',"IL                  $   #00006055' TO DFHEIV0
  6186     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6187     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6188     MOVE X'2020233030303036303535' TO DFHEIV0(25:11)
  6189     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 109
* EL6317.cbl
  6190           DFHEIV20,
  6191           ERENDT-LENGTH,
  6192           GETMAIN-SPACE
  6193     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6194         DFHEIV20
  6195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6196     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6197     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6198     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6199     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6200                                    EN-INPUT-DT
  6201                                    EN-PROCESS-DT
  6202
  6203     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6204     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6205     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6206     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6207     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6208     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6209     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6210     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6211     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6212     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6213     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6214     IF OC-LF-BENCD NOT = '00' AND '  '
  6215        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6216        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6217        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6218        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6219        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6220        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6221        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6222     END-IF
  6223     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6224     IF OC-AH-BENCD NOT = '00' AND '  '
  6225        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6226        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6227        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6228        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6229        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6230        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6231     END-IF
  6232     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6233
  6234     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6235         display 'from el1273, using crto for new crto'
  6236
  6237        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6238                                     NCRTO-INS-FIRST-NAME
  6239        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6240                                     NCRTO-INS-MIDDLE-INIT
  6241        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6242                                     NCRTO-INS-LAST-NAME
  6243        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6244                                     NCRTO-INS-AGE
  6245        MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6246                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6247        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 110
* EL6317.cbl
  6248                                     NCRTO-JNT-FIRST-NAME
  6249        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6250                                     NCRTO-JNT-MIDDLE-INIT
  6251        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6252                                     NCRTO-JNT-LAST-NAME
  6253        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6254                                     NCRTO-JNT-AGE
  6255        MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6256                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6257        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6258                                     NCRTO-LF-BENCD
  6259        IF OC-LF-BENCD NOT = '00' AND '  '
  6260           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6261                                       NCRTO-LF-BEN-AMT
  6262           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6263                                       NCRTO-LF-PRM-AMT
  6264           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6265                                       NCRTO-LF-ALT-BEN-AMT
  6266           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6267                                       NCRTO-LF-ALT-PRM-AMT
  6268           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6269                                       NCRTO-LF-TERM
  6270           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6271                                       NCRTO-LF-EXP-DT
  6272           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6273                                       NCRTO-LF-COMM-PCT
  6274           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6275           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6276           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6277        END-IF
  6278        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6279                                     NCRTO-AH-BENCD
  6280        IF OC-AH-BENCD NOT = '00' AND '  '
  6281           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6282                                       NCRTO-AH-BEN-AMT
  6283           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6284                                       NCRTO-AH-PRM-AMT
  6285           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6286                                       NCRTO-AH-TERM
  6287           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6288                                       NCRTO-AH-EXP-DT
  6289           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6290                                       NCRTO-AH-CP
  6291           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6292                                       NCRTO-AH-COMM-PCT
  6293           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6294           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6295           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6296        END-IF
  6297        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6298                                       NCRTO-CRED-BENE-NAME
  6299
  6300        GO TO 0400-WRITE-ENDT
  6301     END-IF
  6302
  6303* EXEC CICS GETMAIN
  6304*         SET      (ADDRESS OF PENDING-BUSINESS)
  6305*         LENGTH   (ERPNDB-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 111
* EL6317.cbl
  6306*         INITIMG  (GETMAIN-SPACE)
  6307*    END-EXEC
  6308*    MOVE ',"IL                  $   #00006166' TO DFHEIV0
  6309     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6311     MOVE X'2020233030303036313636' TO DFHEIV0(25:11)
  6312     CALL 'kxdfhei1' USING DFHEIV0,
  6313           DFHEIV20,
  6314           ERPNDB-LENGTH,
  6315           GETMAIN-SPACE
  6316     SET ADDRESS OF PENDING-BUSINESS TO
  6317         DFHEIV20
  6318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6319     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6320     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6321
  6322* EXEC CICS READ
  6323*        DATASET   (WS-ERPNDB-FILE-ID)
  6324*        INTO      (PENDING-BUSINESS)
  6325*        RIDFLD    (ERPNDB-KEY)
  6326*        RESP      (WS-RESPONSE)
  6327*    END-EXEC
  6328     MOVE LENGTH OF
  6329      PENDING-BUSINESS
  6330       TO DFHEIV11
  6331*    MOVE '&"IL       E          (  N#00006173' TO DFHEIV0
  6332     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6334     MOVE X'204E233030303036313733' TO DFHEIV0(25:11)
  6335     CALL 'kxdfhei1' USING DFHEIV0,
  6336           WS-ERPNDB-FILE-ID,
  6337           PENDING-BUSINESS,
  6338           DFHEIV11,
  6339           ERPNDB-KEY,
  6340           DFHEIV99,
  6341           DFHEIV99,
  6342           DFHEIV99
  6343     MOVE EIBRESP  TO WS-RESPONSE
  6344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6345     IF NOT RESP-NORMAL
  6346        GO TO 0400-EXIT
  6347     END-IF
  6348*    set found-pndb to true
  6349     display ' good read on erpndb '
  6350     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6351                                      NCRTO-INS-FIRST-NAME
  6352     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6353                                      NCRTO-INS-MIDDLE-INIT
  6354     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6355                                      NCRTO-INS-LAST-NAME
  6356     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6357                                      NCRTO-INS-AGE
  6358     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6359                                      NCRTO-JNT-FIRST-NAME
  6360     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6361                                      NCRTO-JNT-MIDDLE-INIT
  6362     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6363                                      NCRTO-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 112
* EL6317.cbl
  6364     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6365                                      NCRTO-JNT-AGE
  6366     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6367                                      NCRTO-LF-BENCD
  6368     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6369        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6370                                      NCRTO-LF-BEN-AMT
  6371        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6372                                      NCRTO-LF-PRM-AMT
  6373        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6374                                      NCRTO-LF-ALT-BEN-AMT
  6375        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6376                                      NCRTO-LF-ALT-PRM-AMT
  6377        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6378                                      NCRTO-LF-TERM
  6379        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6380                                      NCRTO-LF-EXP-DT
  6381        IF PB-I-JOINT-COMMISSION > +0
  6382           MOVE PB-I-JOINT-COMMISSION
  6383                                   TO EN-LF-NEW-COMM-PCT
  6384                                      NCRTO-LF-COMM-PCT
  6385        ELSE
  6386           MOVE PB-I-LIFE-COMMISSION
  6387                                   TO EN-LF-NEW-COMM-PCT
  6388                                      NCRTO-LF-COMM-PCT
  6389        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6390        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6391                                      NCRTO-LF-ITD-CANCEL-AMT
  6392        END-IF
  6393     END-IF
  6394     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6395                                      NCRTO-AH-BENCD
  6396     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6397        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6398                                      NCRTO-AH-BEN-AMT
  6399        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6400                                      NCRTO-AH-PRM-AMT
  6401        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6402                                      NCRTO-AH-TERM
  6403        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6404                                      NCRTO-AH-EXP-DT
  6405        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6406                                      NCRTO-AH-CP
  6407        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6408                                      NCRTO-AH-COMM-PCT
  6409        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6410        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6411                                      NCRTO-AH-ITD-CANCEL-AMT
  6412     END-IF
  6413     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6414     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6415     move pb-control-by-account (1:33)
  6416                                 to ws-ermail-key
  6417
  6418* EXEC CICS READ
  6419*        DATASET   ('ERMAIL')
  6420*        SET       (ADDRESS OF MAILING-DATA)
  6421*        RIDFLD    (WS-ERMAIL-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 113
* EL6317.cbl
  6422*        RESP      (WS-RESPONSE)
  6423*    END-EXEC
  6424     MOVE 'ERMAIL' TO DFHEIV1
  6425*    MOVE '&"S        E          (  N#00006251' TO DFHEIV0
  6426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6428     MOVE X'204E233030303036323531' TO DFHEIV0(25:11)
  6429     CALL 'kxdfhei1' USING DFHEIV0,
  6430           DFHEIV1,
  6431           DFHEIV20,
  6432           DFHEIV99,
  6433           WS-ERMAIL-KEY,
  6434           DFHEIV99,
  6435           DFHEIV99,
  6436           DFHEIV99
  6437     SET ADDRESS OF MAILING-DATA TO
  6438         DFHEIV20
  6439     MOVE EIBRESP  TO WS-RESPONSE
  6440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6441     IF RESP-NORMAL
  6442        DISPLAY ' FOUND ERMAIL '
  6443        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6444                                    NCRTO-CRED-BENE-NAME
  6445     ELSE
  6446        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6447     END-IF
  6448
  6449     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6450     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6451
  6452
  6453* EXEC CICS READ
  6454*         DATASET  (WS-ELCRTT-FILE-ID)
  6455*         RIDFLD   (WS-ELCRTT-KEY)
  6456*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6457*         RESP     (WS-RESPONSE)
  6458*    END-EXEC
  6459*    MOVE '&"S        E          (  N#00006268' TO DFHEIV0
  6460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6462     MOVE X'204E233030303036323638' TO DFHEIV0(25:11)
  6463     CALL 'kxdfhei1' USING DFHEIV0,
  6464           WS-ELCRTT-FILE-ID,
  6465           DFHEIV20,
  6466           DFHEIV99,
  6467           WS-ELCRTT-KEY,
  6468           DFHEIV99,
  6469           DFHEIV99,
  6470           DFHEIV99
  6471     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6472         DFHEIV20
  6473     MOVE EIBRESP  TO WS-RESPONSE
  6474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6475
  6476     IF RESP-NORMAL
  6477        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6478                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6479        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 114
* EL6317.cbl
  6480                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6481     END-IF.
  6482      .
  6483 0400-WRITE-ENDT.
  6484
  6485     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6486        IF REACD-IN (S1) NOT = LOW-VALUES
  6487           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6488        END-IF
  6489     END-PERFORM
  6490     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6491     MOVE 'V'                    TO EN-DOCU-TYPE
  6492     MOVE ' '                    TO EN-MONEY-SW
  6493     MOVE SIGREQI                TO EN-SIG-SW
  6494     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6495     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6496     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6497*    IF NOT EMI-NO-ERRORS
  6498*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6499*       GO TO 8200-SEND-DATAONLY
  6500*    END-IF
  6501     DISPLAY ' 0400 EXIT '
  6502     .
  6503 0400-EXIT.
  6504     EXIT.
  6505 0410-INIT-ERENDT.
  6506     display ' made it to 0410 '
  6507     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6508     MOVE ZEROS                  TO ENDT-SEQ-NO
  6509
  6510* EXEC CICS READ
  6511*        DATASET    (WS-ERENDT-FILE-ID)
  6512*        RIDFLD     (ERENDT-KEY)
  6513*        INTO       (ENDORSEMENT-RECORD)
  6514*        RESP       (WS-RESPONSE)
  6515*        GTEQ
  6516*    END-EXEC
  6517     MOVE LENGTH OF
  6518      ENDORSEMENT-RECORD
  6519       TO DFHEIV11
  6520*    MOVE '&"IL       G          (  N#00006308' TO DFHEIV0
  6521     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6523     MOVE X'204E233030303036333038' TO DFHEIV0(25:11)
  6524     CALL 'kxdfhei1' USING DFHEIV0,
  6525           WS-ERENDT-FILE-ID,
  6526           ENDORSEMENT-RECORD,
  6527           DFHEIV11,
  6528           ERENDT-KEY,
  6529           DFHEIV99,
  6530           DFHEIV99,
  6531           DFHEIV99
  6532     MOVE EIBRESP  TO WS-RESPONSE
  6533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6534     IF RESP-NORMAL
  6535        AND (EN-CONTROL-PRIMARY (1:34) =
  6536           OC-CONTROL-PRIMARY (1:34))
  6537        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 115
* EL6317.cbl
  6538     ELSE
  6539        MOVE +4096               TO WS-SEQ-NO
  6540     END-IF
  6541     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6542     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6543     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6544     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6545     INITIALIZE EN-ISSUE-RECORD
  6546     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6547                                    EN-AH-ORIG-EXP-DT
  6548                                    EN-LF-NEW-EXP-DT
  6549                                    EN-AH-NEW-EXP-DT
  6550                                    EN-PROCESS-DT
  6551     .
  6552 0410-EXIT.
  6553     EXIT.
  6554 0420-UPDATE-ELCRTO.
  6555     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6556     IF RESP-NORMAL
  6557        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6558                                    OC-LAST-MAINT-DT
  6559        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6560        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6561
  6562* EXEC CICS REWRITE
  6563*          FROM     (ORIGINAL-CERTIFICATE)
  6564*          DATASET  ('ELCRTO')
  6565*       END-EXEC
  6566     MOVE LENGTH OF
  6567      ORIGINAL-CERTIFICATE
  6568       TO DFHEIV11
  6569     MOVE 'ELCRTO' TO DFHEIV1
  6570*    MOVE '&& L                  %   #00006342' TO DFHEIV0
  6571     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6572     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6573     MOVE X'2020233030303036333432' TO DFHEIV0(25:11)
  6574     CALL 'kxdfhei1' USING DFHEIV0,
  6575           DFHEIV1,
  6576           ORIGINAL-CERTIFICATE,
  6577           DFHEIV11,
  6578           DFHEIV99
  6579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6580     END-IF
  6581     .
  6582 0420-EXIT.
  6583     EXIT.
  6584
  6585 0425-ADD-NEW-ELCRTO.
  6586     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6587     MOVE 'OC'                   TO OC-RECORD-ID
  6588     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6589     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6590     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6591     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6592     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6593     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6594     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6595     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 116
* EL6317.cbl
  6596     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6597     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6598     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6599     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6600     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6601     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6602     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6603     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6604     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6605     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6606     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6607     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6608     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6609     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6610     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6611     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6612     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6613     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6614     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6615     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6616     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6617     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6618     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6619     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6620     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6621     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6622     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6623     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6624     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6625     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6626     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6627     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6628     .
  6629 0425-WRITE-ELCRTO.
  6630
  6631
  6632* EXEC CICS WRITE
  6633*       DATASET   ('ELCRTO')
  6634*       FROM      (ORIGINAL-CERTIFICATE)
  6635*       RIDFLD    (OC-CONTROL-PRIMARY)
  6636*       RESP      (WS-RESPONSE)
  6637*    END-EXEC
  6638     MOVE LENGTH OF
  6639      ORIGINAL-CERTIFICATE
  6640       TO DFHEIV11
  6641     MOVE 'ELCRTO' TO DFHEIV1
  6642*    MOVE '&$ L                  ''  N#00006397' TO DFHEIV0
  6643     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6644     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6645     MOVE X'204E233030303036333937' TO DFHEIV0(25:11)
  6646     CALL 'kxdfhei1' USING DFHEIV0,
  6647           DFHEIV1,
  6648           ORIGINAL-CERTIFICATE,
  6649           DFHEIV11,
  6650           OC-CONTROL-PRIMARY,
  6651           DFHEIV99,
  6652           DFHEIV99
  6653     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 117
* EL6317.cbl
  6654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6655
  6656     display ' just wrote new crto ' ws-response
  6657                           ' ' oc-key-seq-no
  6658     IF RESP-DUPKEY
  6659        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6660        GO TO 0425-WRITE-ELCRTO
  6661     ELSE
  6662        IF NOT RESP-NORMAL
  6663           MOVE -1               TO SIGREQL
  6664           MOVE ER-3830          TO EMI-ERROR
  6665           PERFORM 9900-ERROR-FORMAT
  6666                                 THRU 9900-EXIT
  6667        ELSE
  6668           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6669        END-IF
  6670     END-IF
  6671
  6672     .
  6673 0425-EXIT.
  6674     EXIT.
  6675
  6676 0426-ADD-CERT-NOTES.
  6677
  6678     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6679     SET TB-INDX TO 1
  6680
  6681     IF PI-CERTNT1-ENTERED > SPACES
  6682         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6683         MOVE PI-PROCESSOR-ID    TO
  6684                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6685         MOVE EIBTIME            TO
  6686                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6687         MOVE WS-CURRENT-BIN-DT  TO
  6688                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6689         SET TB-INDX UP BY +1
  6690     END-IF
  6691
  6692     IF PI-CERTNT2-ENTERED > SPACES
  6693         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6694         MOVE PI-PROCESSOR-ID    TO
  6695                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6696         MOVE EIBTIME            TO
  6697                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6698         MOVE WS-CURRENT-BIN-DT  TO
  6699                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6700         SET TB-INDX UP BY +1
  6701     END-IF
  6702
  6703     IF CERT-NOTE-ENTRIES > SPACES
  6704         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6705         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6706     END-IF
  6707
  6708     IF PI-BILLNT1-ENTERED > SPACES
  6709         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6710         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6711         MOVE +63 TO WS-LEN
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 118
* EL6317.cbl
  6712         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6713     END-IF
  6714
  6715     IF PI-BILLNT2-ENTERED > SPACES
  6716         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6717         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6718         MOVE +63 TO WS-LEN
  6719         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6720     END-IF
  6721
  6722     .
  6723 0426-EXIT.
  6724     EXIT.
  6725
  6726 0427-LOAD-CURRENT-CERT-NOTES.
  6727
  6728     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6729     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6730     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6731     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6732     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6733     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6734     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6735     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6736     MOVE '1'                 TO ERCNOT-REC-TYP
  6737     MOVE +0                  TO ERCNOT-SEQ
  6738     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6739
  6740
  6741* EXEC CICS STARTBR
  6742*         DATASET(WS-ERCNOT-FILE-ID)
  6743*         RIDFLD(ERCNOT-KEY)
  6744*         KEYLENGTH(ERCNOT-START-LENGTH)
  6745*         RESP      (WS-RESPONSE)
  6746*         GENERIC
  6747*         GTEQ
  6748*    END-EXEC.
  6749     MOVE 0
  6750       TO DFHEIV11
  6751*    MOVE '&,   KG    G          &  N#00006488' TO DFHEIV0
  6752     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6754     MOVE X'204E233030303036343838' TO DFHEIV0(25:11)
  6755     CALL 'kxdfhei1' USING DFHEIV0,
  6756           WS-ERCNOT-FILE-ID,
  6757           ERCNOT-KEY,
  6758           ERCNOT-START-LENGTH,
  6759           DFHEIV11,
  6760           DFHEIV99
  6761     MOVE EIBRESP  TO WS-RESPONSE
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765     IF NOT RESP-NORMAL
  6766        GO TO 0427-ENDBR
  6767     END-IF.
  6768
  6769 0427-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 119
* EL6317.cbl
  6770
  6771* EXEC CICS READNEXT
  6772*         SET(ADDRESS OF CERT-NOTE-FILE)
  6773*         DATASET(WS-ERCNOT-FILE-ID)
  6774*         RIDFLD(ERCNOT-KEY)
  6775*    END-EXEC.
  6776     MOVE 0
  6777       TO DFHEIV11
  6778*    MOVE '&.S                   )   #00006502' TO DFHEIV0
  6779     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6780     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6781     MOVE X'2020233030303036353032' TO DFHEIV0(25:11)
  6782     CALL 'kxdfhei1' USING DFHEIV0,
  6783           WS-ERCNOT-FILE-ID,
  6784           DFHEIV20,
  6785           DFHEIV99,
  6786           ERCNOT-KEY,
  6787           DFHEIV99,
  6788           DFHEIV11,
  6789           DFHEIV99,
  6790           DFHEIV99
  6791     SET ADDRESS OF CERT-NOTE-FILE TO
  6792         DFHEIV20
  6793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6794
  6795
  6796     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6797         GO TO 0427-ENDBR
  6798     END-IF.
  6799
  6800     IF (CZ-CARRIER = SV-CARRIER)
  6801        AND (CZ-GROUPING = SV-GROUPING)
  6802        AND (CZ-STATE = SV-STATE)
  6803        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6804        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6805        AND (CZ-CERT-NO = SV-CERT-NO)
  6806        AND (CZ-RECORD-TYPE = '1')
  6807          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6808          MOVE CZ-LAST-MAINT-USER TO
  6809                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6810          MOVE CZ-LAST-MAINT-DT TO
  6811                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6812          MOVE CZ-LAST-MAINT-HHMMSS TO
  6813                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6814          SET TB-INDX UP BY 1
  6815          GO TO 0427-LOOP
  6816     END-IF.
  6817
  6818 0427-ENDBR.
  6819
  6820
  6821* EXEC CICS ENDBR
  6822*         DATASET(WS-ERCNOT-FILE-ID)
  6823*    END-EXEC.
  6824     MOVE 0
  6825       TO DFHEIV11
  6826*    MOVE '&2                    $   #00006532' TO DFHEIV0
  6827     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 120
* EL6317.cbl
  6828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6829     MOVE X'2020233030303036353332' TO DFHEIV0(25:11)
  6830     CALL 'kxdfhei1' USING DFHEIV0,
  6831           WS-ERCNOT-FILE-ID,
  6832           DFHEIV11,
  6833           DFHEIV99
  6834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6835
  6836
  6837     .
  6838 0427-EXIT.
  6839     EXIT.
  6840
  6841 0430-WRITE-ERENDT.
  6842     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6843     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6844     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6845
  6846* EXEC CICS WRITE
  6847*         DATASET   (WS-ERENDT-FILE-ID)
  6848*         FROM      (ENDORSEMENT-RECORD)
  6849*         RIDFLD    (EN-CONTROL-PRIMARY)
  6850*         RESP      (WS-RESPONSE)
  6851*    END-EXEC
  6852     MOVE LENGTH OF
  6853      ENDORSEMENT-RECORD
  6854       TO DFHEIV11
  6855*    MOVE '&$ L                  ''  N#00006544' TO DFHEIV0
  6856     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6857     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6858     MOVE X'204E233030303036353434' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0,
  6860           WS-ERENDT-FILE-ID,
  6861           ENDORSEMENT-RECORD,
  6862           DFHEIV11,
  6863           EN-CONTROL-PRIMARY,
  6864           DFHEIV99,
  6865           DFHEIV99
  6866     MOVE EIBRESP  TO WS-RESPONSE
  6867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6868     IF RESP-NORMAL
  6869        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  6870        display ' good write erendt '
  6871        IF EIBAID = DFHPF4
  6872           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6873           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6874           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6875           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6876        END-IF
  6877     ELSE
  6878        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6879        MOVE -1                  TO CARRL
  6880        MOVE ER-0132             TO EMI-ERROR
  6881        MOVE AL-UABON            TO CARRA
  6882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6883     END-IF
  6884     .
  6885 0430-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 121
* EL6317.cbl
  6886     EXIT.
  6887 0440-ADD-BILLING-NOTE.
  6888
  6889* EXEC CICS GETMAIN
  6890*         SET      (ADDRESS OF EOB-CODES)
  6891*         LENGTH   (ELEOBC-LENGTH)
  6892*         INITIMG  (GETMAIN-SPACE)
  6893*    END-EXEC
  6894*    MOVE ',"IL                  $   #00006570' TO DFHEIV0
  6895     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6896     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6897     MOVE X'2020233030303036353730' TO DFHEIV0(25:11)
  6898     CALL 'kxdfhei1' USING DFHEIV0,
  6899           DFHEIV20,
  6900           ELEOBC-LENGTH,
  6901           GETMAIN-SPACE
  6902     SET ADDRESS OF EOB-CODES TO
  6903         DFHEIV20
  6904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6905
  6906     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6907     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6908     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6909
  6910
  6911* EXEC CICS STARTBR
  6912*        DATASET   ('ELEOBC')
  6913*        RIDFLD    (WS-ELEOBC-KEY)
  6914*        GTEQ
  6915*        RESP      (WS-RESPONSE)
  6916*    END-EXEC
  6917     MOVE 'ELEOBC' TO DFHEIV1
  6918     MOVE 0
  6919       TO DFHEIV11
  6920*    MOVE '&,         G          &  N#00006580' TO DFHEIV0
  6921     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6923     MOVE X'204E233030303036353830' TO DFHEIV0(25:11)
  6924     CALL 'kxdfhei1' USING DFHEIV0,
  6925           DFHEIV1,
  6926           WS-ELEOBC-KEY,
  6927           DFHEIV99,
  6928           DFHEIV11,
  6929           DFHEIV99
  6930     MOVE EIBRESP  TO WS-RESPONSE
  6931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6932
  6933     IF NOT RESP-NORMAL
  6934        GO TO 0440-EXIT
  6935     END-IF
  6936      .
  6937 0440-READNEXT-ELEOBC.
  6938
  6939
  6940* EXEC CICS READNEXT
  6941*       INTO    (EOB-CODES)
  6942*       DATASET ('ELEOBC')
  6943*       RIDFLD  (WS-ELEOBC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 122
* EL6317.cbl
  6944*       RESP    (WS-RESPONSE)
  6945*    END-EXEC
  6946     MOVE LENGTH OF
  6947      EOB-CODES
  6948       TO DFHEIV12
  6949     MOVE 'ELEOBC' TO DFHEIV1
  6950     MOVE 0
  6951       TO DFHEIV11
  6952*    MOVE '&.IL                  )  N#00006593' TO DFHEIV0
  6953     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6954     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6955     MOVE X'204E233030303036353933' TO DFHEIV0(25:11)
  6956     CALL 'kxdfhei1' USING DFHEIV0,
  6957           DFHEIV1,
  6958           EOB-CODES,
  6959           DFHEIV12,
  6960           WS-ELEOBC-KEY,
  6961           DFHEIV99,
  6962           DFHEIV11,
  6963           DFHEIV99,
  6964           DFHEIV99
  6965     MOVE EIBRESP  TO WS-RESPONSE
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6967
  6968     IF RESP-NORMAL
  6969         IF EO-RECORD-TYPE NOT = '5'
  6970             GO TO 0440-EXIT
  6971         END-IF
  6972     ELSE
  6973         GO TO 0440-EXIT
  6974     END-IF
  6975
  6976     IF EO-RECORD-TYPE = '5' AND
  6977        EO-EOB-CODE = PI-LTRID-ENTERED
  6978           CONTINUE
  6979     ELSE
  6980         GO TO 0440-READNEXT-ELEOBC
  6981     END-IF
  6982
  6983     MOVE SPACES TO WS-BILLING-NOTE
  6984     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6985     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6986     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6987     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6988     MOVE +25 TO WS-LEN
  6989
  6990     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6991     .
  6992 0440-EXIT.
  6993     EXIT.
  6994
  6995 0441-UPDATE-BILLING-NOTE.
  6996
  6997
  6998* EXEC CICS GETMAIN
  6999*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7000*         LENGTH   (ERNOTE-LENGTH)
  7001*         INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 123
* EL6317.cbl
  7002*    END-EXEC
  7003*    MOVE ',"IL                  $   #00006629' TO DFHEIV0
  7004     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7005     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7006     MOVE X'2020233030303036363239' TO DFHEIV0(25:11)
  7007     CALL 'kxdfhei1' USING DFHEIV0,
  7008           DFHEIV20,
  7009           ERNOTE-LENGTH,
  7010           GETMAIN-SPACE
  7011     SET ADDRESS OF CERTIFICATE-NOTE TO
  7012         DFHEIV20
  7013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7014
  7015     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7016
  7017
  7018* EXEC CICS READ
  7019*       DATASET    (WS-ERNOTE-FILE-ID)
  7020*       RIDFLD     (WS-ERNOTE-KEY)
  7021*       INTO       (CERTIFICATE-NOTE)
  7022*       RESP       (WS-RESPONSE)
  7023*       UPDATE
  7024*    END-EXEC
  7025     MOVE LENGTH OF
  7026      CERTIFICATE-NOTE
  7027       TO DFHEIV11
  7028*    MOVE '&"IL       EU         (  N#00006637' TO DFHEIV0
  7029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7031     MOVE X'204E233030303036363337' TO DFHEIV0(25:11)
  7032     CALL 'kxdfhei1' USING DFHEIV0,
  7033           WS-ERNOTE-FILE-ID,
  7034           CERTIFICATE-NOTE,
  7035           DFHEIV11,
  7036           WS-ERNOTE-KEY,
  7037           DFHEIV99,
  7038           DFHEIV99,
  7039           DFHEIV99
  7040     MOVE EIBRESP  TO WS-RESPONSE
  7041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7042
  7043     IF RESP-NORMAL
  7044       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7045          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7046       END-IF
  7047       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7048          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7049       END-IF
  7050       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7051           (NOTE-SUB > +10) OR
  7052           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7053                             WS-BILLING-NOTE (1:WS-LEN))
  7054       END-PERFORM
  7055       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7056                              WS-BILLING-NOTE (1:WS-LEN)
  7057
  7058* EXEC CICS UNLOCK
  7059*           DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 124
* EL6317.cbl
  7060*        END-EXEC
  7061*    MOVE '&*                    #   #00006659' TO DFHEIV0
  7062     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7063     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7064     MOVE X'2020233030303036363539' TO DFHEIV0(25:11)
  7065     CALL 'kxdfhei1' USING DFHEIV0,
  7066           WS-ERNOTE-FILE-ID,
  7067           DFHEIV99
  7068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7069       ELSE
  7070         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7071           (NOTE-SUB > +10) OR
  7072           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7073         END-PERFORM
  7074         IF (NOTE-SUB < +11)
  7075           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7076              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7077                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7078           ELSE
  7079             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7080              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7081                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7082                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7083             ELSE
  7084               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7085                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7086                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7087                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7088               ELSE
  7089                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7090                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7091                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7092                                       CN-BILLING-START-LINE-NO
  7093                 ELSE
  7094                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7095                 END-IF
  7096               END-IF
  7097             END-IF
  7098           END-IF
  7099           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7100           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7101           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7102
  7103* EXEC CICS REWRITE
  7104*             DATASET    (WS-ERNOTE-FILE-ID)
  7105*             FROM       (CERTIFICATE-NOTE)
  7106*             RESP       (WS-RESPONSE)
  7107*          END-EXEC
  7108     MOVE LENGTH OF
  7109      CERTIFICATE-NOTE
  7110       TO DFHEIV11
  7111*    MOVE '&& L                  %  N#00006695' TO DFHEIV0
  7112     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7114     MOVE X'204E233030303036363935' TO DFHEIV0(25:11)
  7115     CALL 'kxdfhei1' USING DFHEIV0,
  7116           WS-ERNOTE-FILE-ID,
  7117           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 125
* EL6317.cbl
  7118           DFHEIV11,
  7119           DFHEIV99
  7120     MOVE EIBRESP  TO WS-RESPONSE
  7121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7122           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7123         END-IF
  7124       END-IF
  7125     ELSE
  7126        MOVE SPACES              TO CERTIFICATE-NOTE
  7127        MOVE 'CN'                TO CN-RECORD-ID
  7128        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7129                                     WS-ERNOTE-KEY
  7130        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7131                                    CN-BILLING-END-LINE-NO
  7132        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7133        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7134        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7135        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7136
  7137* EXEC CICS WRITE
  7138*          DATASET    (WS-ERNOTE-FILE-ID)
  7139*          FROM       (CERTIFICATE-NOTE)
  7140*          RIDFLD     (WS-ERNOTE-KEY)
  7141*          RESP       (WS-RESPONSE)
  7142*       END-EXEC
  7143     MOVE LENGTH OF
  7144      CERTIFICATE-NOTE
  7145       TO DFHEIV11
  7146*    MOVE '&$ L                  ''  N#00006714' TO DFHEIV0
  7147     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7149     MOVE X'204E233030303036373134' TO DFHEIV0(25:11)
  7150     CALL 'kxdfhei1' USING DFHEIV0,
  7151           WS-ERNOTE-FILE-ID,
  7152           CERTIFICATE-NOTE,
  7153           DFHEIV11,
  7154           WS-ERNOTE-KEY,
  7155           DFHEIV99,
  7156           DFHEIV99
  7157     MOVE EIBRESP  TO WS-RESPONSE
  7158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7159
  7160        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7161     END-IF
  7162
  7163     .
  7164 0441-EXIT.
  7165     EXIT.
  7166
  7167
  7168 0442-SQUEEZE-IT-IN.
  7169
  7170     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7171        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7172           NOTE-SUB = +10
  7173           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7174           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7175             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 126
* EL6317.cbl
  7176             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7177             MOVE +9 TO NOTE-SUB
  7178           END-IF
  7179        END-PERFORM
  7180     ELSE
  7181        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7182           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7183             UNTIL NOTE-SUB = +1
  7184             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7185             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7186                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7187                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7188                MOVE +2          TO NOTE-SUB
  7189             END-IF
  7190           END-PERFORM
  7191        END-IF
  7192     END-IF
  7193
  7194     .
  7195 0442-EXIT.
  7196     EXIT.
  7197
  7198 0445-CERTIFICATE-UPDATE.
  7199    display 'billing note written, updating cert'
  7200     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7201     IF RESP-NORMAL
  7202        EVALUATE CM-NOTE-SW
  7203           WHEN '2'
  7204           WHEN '3'
  7205           WHEN '6'
  7206           WHEN '7'
  7207              SET NO-CERT-RW     TO TRUE
  7208           WHEN ' '
  7209              MOVE '2'           TO CM-NOTE-SW
  7210           WHEN '1'
  7211              MOVE '3'           TO CM-NOTE-SW
  7212           WHEN '4'
  7213              MOVE '6'           TO CM-NOTE-SW
  7214           WHEN '5'
  7215              MOVE '7'           TO CM-NOTE-SW
  7216        END-EVALUATE
  7217     END-IF
  7218     IF NOT NO-CERT-RW
  7219        PERFORM 1810-REWRITE-ELCERT
  7220                                 THRU 1810-EXIT
  7221     ELSE
  7222
  7223* EXEC CICS UNLOCK
  7224*          DATASET    (WS-ELCERT-FILE-ID)
  7225*       END-EXEC
  7226*    MOVE '&*                    #   #00006783' TO DFHEIV0
  7227     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7228     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7229     MOVE X'2020233030303036373833' TO DFHEIV0(25:11)
  7230     CALL 'kxdfhei1' USING DFHEIV0,
  7231           WS-ELCERT-FILE-ID,
  7232           DFHEIV99
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 127
* EL6317.cbl
  7234     END-IF
  7235
  7236     .
  7237 0445-EXIT.
  7238     EXIT.
  7239
  7240 0500-CREATE-TEMP-STORAGE.
  7241     display ' about to write pi ' program-interface-block
  7242
  7243* EXEC CICS WRITEQ TS
  7244*        QUEUE (QID)
  7245*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7246*        LENGTH(PI-COMM-LENGTH)
  7247*    END-EXEC
  7248*    MOVE '*"                    ''   #00006794' TO DFHEIV0
  7249     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7251     MOVE X'2020233030303036373934' TO DFHEIV0(25:11)
  7252     CALL 'kxdfhei1' USING DFHEIV0,
  7253           QID,
  7254           PROGRAM-INTERFACE-BLOCK,
  7255           PI-COMM-LENGTH,
  7256           DFHEIV99,
  7257           DFHEIV99,
  7258           DFHEIV99
  7259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7260     display ' about to write map ' el631ji
  7261
  7262* EXEC CICS WRITEQ TS
  7263*        QUEUE (QID)
  7264*        FROM  (EL631JI)
  7265*        LENGTH(MAP-LENGTH)
  7266*    END-EXEC.
  7267*    MOVE '*"                    ''   #00006800' TO DFHEIV0
  7268     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7270     MOVE X'2020233030303036383030' TO DFHEIV0(25:11)
  7271     CALL 'kxdfhei1' USING DFHEIV0,
  7272           QID,
  7273           EL631JI,
  7274           MAP-LENGTH,
  7275           DFHEIV99,
  7276           DFHEIV99,
  7277           DFHEIV99
  7278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7279
  7280 0500-EXIT.
  7281      EXIT.
  7282 0600-RECOVER-TEMP-STORAGE.
  7283     display ' about to recover pi '
  7284
  7285* EXEC CICS READQ TS
  7286*        QUEUE (QID)
  7287*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7288*        LENGTH(PI-COMM-LENGTH)
  7289*    END-EXEC
  7290*    MOVE '*$I    L              ''   #00006809' TO DFHEIV0
  7291     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 128
* EL6317.cbl
  7292     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7293     MOVE X'2020233030303036383039' TO DFHEIV0(25:11)
  7294     CALL 'kxdfhei1' USING DFHEIV0,
  7295           QID,
  7296           PROGRAM-INTERFACE-BLOCK,
  7297           PI-COMM-LENGTH,
  7298           DFHEIV99,
  7299           DFHEIV99,
  7300           DFHEIV99
  7301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7302     display ' pi ' pi-program-work-area
  7303     display ' about to recover map '
  7304
  7305* EXEC CICS READQ TS
  7306*        QUEUE (QID)
  7307*        INTO  (EL631JI)
  7308*        LENGTH(MAP-LENGTH)
  7309*    END-EXEC
  7310*    MOVE '*$I    L              ''   #00006816' TO DFHEIV0
  7311     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7313     MOVE X'2020233030303036383136' TO DFHEIV0(25:11)
  7314     CALL 'kxdfhei1' USING DFHEIV0,
  7315           QID,
  7316           EL631JI,
  7317           MAP-LENGTH,
  7318           DFHEIV99,
  7319           DFHEIV99,
  7320           DFHEIV99
  7321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7322     display ' map ' el631ji
  7323     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7324     MOVE AL-UANON            TO SIGREQA
  7325     MOVE AL-UANON            TO LTRIDA
  7326     IF WS-SET-CODES-MDT = 'Y'
  7327        move +1                  to s2
  7328        perform varying s1 from +1 by +5 until s1 > +60
  7329           MOVE WS-PASSED-REASON-CODES (s1:4)
  7330                                 TO reacd-in (s2)
  7331           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7332               MOVE AL-SANON     TO REACDA (S2)
  7333               MOVE +4           TO REACDL (S2)
  7334           END-IF
  7335           add +1                to s2
  7336        end-perform
  7337        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7338     END-IF
  7339
  7340     IF CRTNT1I > SPACES
  7341         MOVE AL-UANON       TO CRTNT1A
  7342     END-IF
  7343
  7344     IF CRTNT2I > SPACES
  7345         MOVE AL-UANON       TO CRTNT2A
  7346     END-IF
  7347
  7348     IF BILNT1I > SPACES
  7349         MOVE AL-UANON       TO BILNT1A
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 129
* EL6317.cbl
  7350     END-IF
  7351     .
  7352 0600-EXIT.
  7353      EXIT.
  7354 0800-DELETE-TS.
  7355
  7356* EXEC CICS DELETEQ TS
  7357*        QUEUE(QID)
  7358*    END-EXEC
  7359*    MOVE '*&                    #   #00006854' TO DFHEIV0
  7360     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7361     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7362     MOVE X'2020233030303036383534' TO DFHEIV0(25:11)
  7363     CALL 'kxdfhei1' USING DFHEIV0,
  7364           QID,
  7365           DFHEIV99
  7366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7367     .
  7368 0800-EXIT.
  7369      EXIT.
  7370 1000-BUILD-ERARCH.
  7371     display ' made it to 1000 '
  7372     MOVE SPACES                 TO W-CNTL-KEY
  7373     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7374     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7375     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7376
  7377* EXEC CICS READ
  7378*         DATASET    (WS-ELCNTL-FILE-ID)
  7379*         SET        (ADDRESS OF CONTROL-FILE)
  7380*         RIDFLD     (W-CNTL-KEY)
  7381*         UPDATE
  7382*         RESP       (WS-RESPONSE)
  7383*    END-EXEC
  7384*    MOVE '&"S        EU         (  N#00006866' TO DFHEIV0
  7385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7386     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7387     MOVE X'204E233030303036383636' TO DFHEIV0(25:11)
  7388     CALL 'kxdfhei1' USING DFHEIV0,
  7389           WS-ELCNTL-FILE-ID,
  7390           DFHEIV20,
  7391           DFHEIV99,
  7392           W-CNTL-KEY,
  7393           DFHEIV99,
  7394           DFHEIV99,
  7395           DFHEIV99
  7396     SET ADDRESS OF CONTROL-FILE TO
  7397         DFHEIV20
  7398     MOVE EIBRESP  TO WS-RESPONSE
  7399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7400     IF RESP-NORMAL
  7401        display ' good read elcntl '
  7402        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7403           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7404        END-IF
  7405        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7406        MOVE CF-CREDIT-LAST-ARCH-NUM
  7407                                 TO W-ARCH-NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 130
* EL6317.cbl
  7408
  7409* EXEC CICS REWRITE
  7410*          FROM      (CONTROL-FILE)
  7411*          DATASET   (WS-ELCNTL-FILE-ID)
  7412*       END-EXEC
  7413     MOVE LENGTH OF
  7414      CONTROL-FILE
  7415       TO DFHEIV11
  7416*    MOVE '&& L                  %   #00006881' TO DFHEIV0
  7417     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7418     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7419     MOVE X'2020233030303036383831' TO DFHEIV0(25:11)
  7420     CALL 'kxdfhei1' USING DFHEIV0,
  7421           WS-ELCNTL-FILE-ID,
  7422           CONTROL-FILE,
  7423           DFHEIV11,
  7424           DFHEIV99
  7425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7426     END-IF
  7427
  7428* EXEC CICS GETMAIN
  7429*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7430*       LENGTH   (W-ARCH-LENGTH)
  7431*    END-EXEC
  7432*    MOVE '," L                  $   #00006886' TO DFHEIV0
  7433     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7434     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7435     MOVE X'2020233030303036383836' TO DFHEIV0(25:11)
  7436     CALL 'kxdfhei1' USING DFHEIV0,
  7437           DFHEIV20,
  7438           W-ARCH-LENGTH,
  7439           DFHEIV99
  7440     SET ADDRESS OF LETTER-ARCHIVE TO
  7441         DFHEIV20
  7442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7443     MOVE 'LA'                   TO LETTER-ARCHIVE
  7444     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7445                                    LA-ARCHIVE-NO-A2
  7446                                    LA-ARCHIVE-NO-A3
  7447                                    LA-ARCHIVE-NO-A4
  7448                                    LA-ARCHIVE-NO-A5
  7449                                    LA-ARCHIVE-NO-A6
  7450     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7451                                    LA-COMPANY-CD-A2
  7452                                    LA-COMPANY-CD-A3
  7453                                    LA-COMPANY-CD-A4
  7454                                    LA-COMPANY-CD-A5
  7455                                    LA-COMPANY-CD-A6
  7456     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7457                                    LA-CARRIER-A3
  7458                                    LA-CARRIER-A4
  7459                                    LA-CARRIER-A5
  7460     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7461     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7462                                    LA-GROUPING-A3
  7463                                    LA-GROUPING-A4
  7464                                    LA-GROUPING-A5
  7465     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 131
* EL6317.cbl
  7466                                    LA-ACCOUNT-A3
  7467                                    LA-ACCOUNT-A4
  7468                                    LA-ACCOUNT-A5
  7469     MOVE PB-STATE               TO LA-STATE-A2
  7470                                    LA-STATE-A3
  7471                                    LA-STATE-A4
  7472                                    LA-STATE-A5
  7473     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7474     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7475     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7476     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7477     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7478                                    LA-INITIAL-PRINT-DATE
  7479                                    LA-SENT-DATE
  7480                                    LA-REPLY-DATE
  7481                                    LA-RESEND-DATE
  7482                                    LA-FOLLOW-UP-DATE
  7483     MOVE 'A'                    TO LA-STATUS
  7484     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7485     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7486     MOVE LTRIDI                 TO LA-FORM-A3
  7487     MOVE '4'                    TO LA-DATA-SOURCE
  7488     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7489     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7490                                    LA-NO-OF-TEXT-RECORDS
  7491
  7492* EXEC CICS WRITE
  7493*         DATASET   ('ERARCH')
  7494*         FROM      (LETTER-ARCHIVE)
  7495*         RIDFLD    (LA-CONTROL-PRIMARY)
  7496*         RESP      (WS-RESPONSE)
  7497*    END-EXEC
  7498     MOVE LENGTH OF
  7499      LETTER-ARCHIVE
  7500       TO DFHEIV11
  7501     MOVE 'ERARCH' TO DFHEIV1
  7502*    MOVE '&$ L                  ''  N#00006938' TO DFHEIV0
  7503     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7504     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7505     MOVE X'204E233030303036393338' TO DFHEIV0(25:11)
  7506     CALL 'kxdfhei1' USING DFHEIV0,
  7507           DFHEIV1,
  7508           LETTER-ARCHIVE,
  7509           DFHEIV11,
  7510           LA-CONTROL-PRIMARY,
  7511           DFHEIV99,
  7512           DFHEIV99
  7513     MOVE EIBRESP  TO WS-RESPONSE
  7514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7515     IF RESP-NORMAL
  7516        display ' good write erarch '
  7517        MOVE ER-0280             TO EMI-ERROR
  7518        MOVE -1                  TO SIGREQL
  7519        PERFORM 9900-ERROR-FORMAT
  7520                                 THRU 9900-EXIT
  7521        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7522        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7523     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 132
* EL6317.cbl
  7524        MOVE ER-7345             TO EMI-ERROR
  7525        MOVE -1                  TO SIGREQL
  7526        PERFORM 9900-ERROR-FORMAT
  7527                                 THRU 9900-EXIT
  7528     END-IF
  7529     .
  7530 1000-EXIT.
  7531     EXIT.
  7532 1100-CALL-NS-BUS-LOGIC.
  7533     DISPLAY ' MADE IT TO 1100 '
  7534     MOVE SPACES                 TO BL-INPUT
  7535     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7536     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7537         MOVE '2'                TO BL-DATA-SRCE
  7538         MOVE SPACES             TO BL-BATCH-NO
  7539         MOVE ZEROS              TO BL-BATCH-SEQ
  7540     ELSE
  7541         MOVE '4'                TO BL-DATA-SRCE
  7542         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7543         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7544     END-IF
  7545     MOVE PI-CARRIER             TO BL-CARRIER
  7546     MOVE PI-GROUPING            TO BL-GROUP
  7547     MOVE PI-STATE               TO BL-STATE
  7548     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7549     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7550        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7551        MOVE ' '                 TO DC-OPTION-CODE
  7552        PERFORM 9700-date-link
  7553        IF NO-CONVERSION-ERROR
  7554           MOVE DC-GREG-DATE-1-EDIT
  7555                                 TO BL-EFF-DT
  7556        END-IF
  7557     END-IF
  7558     MOVE PI-CERT-NO             TO BL-CERT-NO
  7559     MOVE SPACES                 TO BL-RESP-NO
  7560     MOVE LTRIDI                 TO BL-LETTER-ID
  7561     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7562     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7563     MOVE 'CrtVerif'               TO BL-FUNC
  7564*    MOVE 'ALWA'                 TO BL-PROC-ID
  7565     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7566*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7567*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7568     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7569     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7570     IF EIBAID = DFHPF4
  7571        MOVE 'B'                 TO BL-WRITE-ERARCH
  7572     ELSE
  7573        MOVE 'T'                 TO BL-WRITE-ERARCH
  7574     END-IF
  7575     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7576        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7577     END-PERFORM
  7578    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7579*****************************************
  7580* Invoke the LETTER business logic
  7581*****************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 133
* EL6317.cbl
  7582
  7583* exec cics link
  7584*       program('NSRASBL')
  7585*       commarea(srch-commarea)
  7586*    end-exec.
  7587     MOVE LENGTH OF
  7588      srch-commarea
  7589       TO DFHEIV11
  7590     MOVE 'NSRASBL' TO DFHEIV1
  7591*    MOVE '."C                   (   #00007011' TO DFHEIV0
  7592     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7594     MOVE X'2020233030303037303131' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0,
  7596           DFHEIV1,
  7597           srch-commarea,
  7598           DFHEIV11,
  7599           DFHEIV99,
  7600           DFHEIV99,
  7601           DFHEIV99,
  7602           DFHEIV99
  7603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7604
  7605     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7606        BL-MESSAGE
  7607     .
  7608 1100-EXIT.
  7609     EXIT.
  7610 1500-GET-ARCH-NO.
  7611     display ' made it to 1500 '
  7612     MOVE SPACES                 TO ELCNTL-KEY
  7613     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7614     MOVE '1'                    TO CNTL-REC-TYPE
  7615     MOVE ZEROS                  TO CNTL-SEQ
  7616
  7617* EXEC CICS READ
  7618*         DATASET    (WS-ELCNTL-FILE-ID)
  7619*         SET        (ADDRESS OF CONTROL-FILE)
  7620*         RIDFLD     (ELCNTL-KEY)
  7621*         UPDATE
  7622*         RESP       (WS-RESPONSE)
  7623*    END-EXEC
  7624*    MOVE '&"S        EU         (  N#00007026' TO DFHEIV0
  7625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7626     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7627     MOVE X'204E233030303037303236' TO DFHEIV0(25:11)
  7628     CALL 'kxdfhei1' USING DFHEIV0,
  7629           WS-ELCNTL-FILE-ID,
  7630           DFHEIV20,
  7631           DFHEIV99,
  7632           ELCNTL-KEY,
  7633           DFHEIV99,
  7634           DFHEIV99,
  7635           DFHEIV99
  7636     SET ADDRESS OF CONTROL-FILE TO
  7637         DFHEIV20
  7638     MOVE EIBRESP  TO WS-RESPONSE
  7639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 134
* EL6317.cbl
  7640     IF RESP-NORMAL
  7641        display ' good read elcntl '
  7642        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7643           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7644        END-IF
  7645        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7646        MOVE CF-CREDIT-LAST-ARCH-NUM
  7647                                 TO W-ARCH-NUMBER
  7648        display ' new arch number ' w-arch-number
  7649
  7650* EXEC CICS REWRITE
  7651*          FROM      (CONTROL-FILE)
  7652*          DATASET   (WS-ELCNTL-FILE-ID)
  7653*       END-EXEC
  7654     MOVE LENGTH OF
  7655      CONTROL-FILE
  7656       TO DFHEIV11
  7657*    MOVE '&& L                  %   #00007042' TO DFHEIV0
  7658     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7659     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7660     MOVE X'2020233030303037303432' TO DFHEIV0(25:11)
  7661     CALL 'kxdfhei1' USING DFHEIV0,
  7662           WS-ELCNTL-FILE-ID,
  7663           CONTROL-FILE,
  7664           DFHEIV11,
  7665           DFHEIV99
  7666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7667     END-IF
  7668     .
  7669 1500-EXIT.
  7670     EXIT.
  7671
  7672
  7673 1700-WRITE-CERT-NOTE      SECTION.
  7674
  7675
  7676     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7677     MOVE ZERO           TO ERCNOT-SEQ.
  7678     SET TB-INDX         DOWN BY 1.
  7679     SET TB-INDX1        TO TB-INDX.
  7680
  7681****DELETE CURRENT CERT NOTES
  7682 1700-LOOP.
  7683
  7684* EXEC CICS READ
  7685*        DATASET (WS-ERCNOT-FILE-ID)
  7686*        RIDFLD  (ERCNOT-KEY)
  7687*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7688*        RESP    (WS-RESPONSE)
  7689*        GTEQ
  7690*    END-EXEC.
  7691*    MOVE '&"S        G          (  N#00007062' TO DFHEIV0
  7692     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7694     MOVE X'204E233030303037303632' TO DFHEIV0(25:11)
  7695     CALL 'kxdfhei1' USING DFHEIV0,
  7696           WS-ERCNOT-FILE-ID,
  7697           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 135
* EL6317.cbl
  7698           DFHEIV99,
  7699           ERCNOT-KEY,
  7700           DFHEIV99,
  7701           DFHEIV99,
  7702           DFHEIV99
  7703     SET ADDRESS OF CERT-NOTE-FILE TO
  7704         DFHEIV20
  7705     MOVE EIBRESP  TO WS-RESPONSE
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709     IF NOT RESP-NORMAL
  7710        GO TO 1700-ENDDEL
  7711     END-IF
  7712
  7713     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7714
  7715     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7716         GO TO 1700-ENDDEL
  7717     END-IF.
  7718
  7719
  7720* EXEC CICS DELETE
  7721*        DATASET (WS-ERCNOT-FILE-ID)
  7722*        RIDFLD  (ERCNOT-KEY)
  7723*    END-EXEC.
  7724*    MOVE '&(  R                 &   #00007080' TO DFHEIV0
  7725     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7726     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7727     MOVE X'2020233030303037303830' TO DFHEIV0(25:11)
  7728     CALL 'kxdfhei1' USING DFHEIV0,
  7729           WS-ERCNOT-FILE-ID,
  7730           ERCNOT-KEY,
  7731           DFHEIV99,
  7732           DFHEIV99,
  7733           DFHEIV99
  7734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7735
  7736
  7737     GO TO 1700-LOOP.
  7738
  7739 1700-ENDDEL.
  7740
  7741
  7742* EXEC CICS GETMAIN
  7743*         LENGTH(ERCNOT-LENGTH)
  7744*         SET(ADDRESS OF CERT-NOTE-FILE)
  7745*         INITIMG(GETMAIN-SPACE)
  7746*    END-EXEC.
  7747*    MOVE ',"IL                  $   #00007089' TO DFHEIV0
  7748     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7750     MOVE X'2020233030303037303839' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0,
  7752           DFHEIV20,
  7753           ERCNOT-LENGTH,
  7754           GETMAIN-SPACE
  7755     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 136
* EL6317.cbl
  7756         DFHEIV20
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7758
  7759
  7760     SET TB-INDX TO 1.
  7761     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7762     MOVE +0             TO ERCNOT-SEQ
  7763
  7764     PERFORM VARYING TB-INDX FROM 1 BY 1
  7765             UNTIL TB-INDX > TB-INDX1
  7766        MOVE SPACES                 TO  CERT-NOTE-FILE
  7767        ADD 1                       TO  ERCNOT-SEQ
  7768        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7769        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7770        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7771        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7772                                    TO  CZ-LAST-MAINT-USER
  7773        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7774                                    TO  CZ-LAST-MAINT-HHMMSS
  7775        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7776                                    TO  CZ-LAST-MAINT-DT
  7777
  7778
  7779* EXEC CICS WRITE
  7780*            DATASET(WS-ERCNOT-FILE-ID)
  7781*            FROM(CERT-NOTE-FILE)
  7782*            RIDFLD(ERCNOT-KEY)
  7783*       END-EXEC
  7784     MOVE LENGTH OF
  7785      CERT-NOTE-FILE
  7786       TO DFHEIV11
  7787*    MOVE '&$ L                  ''   #00007113' TO DFHEIV0
  7788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7790     MOVE X'2020233030303037313133' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0,
  7792           WS-ERCNOT-FILE-ID,
  7793           CERT-NOTE-FILE,
  7794           DFHEIV11,
  7795           ERCNOT-KEY,
  7796           DFHEIV99,
  7797           DFHEIV99
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7799     END-PERFORM
  7800
  7801     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7802     IF RESP-NORMAL
  7803        EVALUATE CM-NOTE-SW
  7804           WHEN '1'
  7805           WHEN '3'
  7806           WHEN '5'
  7807           WHEN '7'
  7808              SET NO-CERT-RW     TO TRUE
  7809           WHEN ' '
  7810              MOVE '1'           TO CM-NOTE-SW
  7811           WHEN '2'
  7812              MOVE '3'           TO CM-NOTE-SW
  7813           WHEN '4'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 137
* EL6317.cbl
  7814              MOVE '5'           TO CM-NOTE-SW
  7815           WHEN '6'
  7816              MOVE '7'           TO CM-NOTE-SW
  7817        END-EVALUATE
  7818     END-IF
  7819     IF NOT NO-CERT-RW
  7820        PERFORM 1810-REWRITE-ELCERT
  7821                                 THRU 1810-EXIT
  7822     ELSE
  7823
  7824* EXEC CICS UNLOCK
  7825*          DATASET    (WS-ELCERT-FILE-ID)
  7826*       END-EXEC
  7827*    MOVE '&*                    #   #00007142' TO DFHEIV0
  7828     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           WS-ELCERT-FILE-ID,
  7833           DFHEIV99
  7834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7835     END-IF
  7836
  7837     .
  7838 1799-EXIT.
  7839     EXIT.
  7840
  7841 1800-READ-ELCERT-UPDATE.
  7842
  7843     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7844     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7845     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7846     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7847     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7848     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7849     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7850     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7851
  7852
  7853* EXEC CICS READ
  7854*        UPDATE
  7855*        DATASET  (WS-ELCERT-FILE-ID)
  7856*        RIDFLD   (WS-ELCERT-KEY)
  7857*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7858*        RESP     (WS-RESPONSE)
  7859*    END-EXEC
  7860*    MOVE '&"S        EU         (  N#00007162' TO DFHEIV0
  7861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7863     MOVE X'204E233030303037313632' TO DFHEIV0(25:11)
  7864     CALL 'kxdfhei1' USING DFHEIV0,
  7865           WS-ELCERT-FILE-ID,
  7866           DFHEIV20,
  7867           DFHEIV99,
  7868           WS-ELCERT-KEY,
  7869           DFHEIV99,
  7870           DFHEIV99,
  7871           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 138
* EL6317.cbl
  7872     SET ADDRESS OF CERTIFICATE-MASTER TO
  7873         DFHEIV20
  7874     MOVE EIBRESP  TO WS-RESPONSE
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7876
  7877     .
  7878 1800-EXIT.
  7879     EXIT.
  7880
  7881 1810-REWRITE-ELCERT.
  7882
  7883
  7884* EXEC CICS REWRITE
  7885*        FROM     (CERTIFICATE-MASTER)
  7886*        DATASET  (WS-ELCERT-FILE-ID)
  7887*        RESP     (WS-RESPONSE)
  7888*    END-EXEC.
  7889     MOVE LENGTH OF
  7890      CERTIFICATE-MASTER
  7891       TO DFHEIV11
  7892*    MOVE '&& L                  %  N#00007176' TO DFHEIV0
  7893     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7894     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7895     MOVE X'204E233030303037313736' TO DFHEIV0(25:11)
  7896     CALL 'kxdfhei1' USING DFHEIV0,
  7897           WS-ELCERT-FILE-ID,
  7898           CERTIFICATE-MASTER,
  7899           DFHEIV11,
  7900           DFHEIV99
  7901     MOVE EIBRESP  TO WS-RESPONSE
  7902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7903
  7904
  7905     .
  7906 1810-EXIT.
  7907     EXIT.
  7908
  7909 8100-SEND-INITIAL-MAP.
  7910     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7911     MOVE '5'                    TO DC-OPTION-CODE.
  7912     PERFORM 9700-DATE-LINK.
  7913     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7914     MOVE EIBTIME                TO TIME-IN.
  7915     MOVE TIME-OUT               TO TIMEO.
  7916     MOVE -1                     TO SIGREQL.
  7917     IF PI-PROCESSOR-IS-CSR-SUPER
  7918        perform varying s1 from +1 by +1 until
  7919           s1 > +12
  7920           MOVE AL-UANON            TO reacda (s1)
  7921        end-perform
  7922     END-IF
  7923     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  7924     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  7925
  7926* EXEC CICS SEND
  7927*        MAP      (MAP-NAME)
  7928*        MAPSET   (MAPSET-NAME)
  7929*        FROM     (EL631JO)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 139
* EL6317.cbl
  7930*        ERASE
  7931*        CURSOR
  7932*    END-EXEC.
  7933     MOVE LENGTH OF
  7934      EL631JO
  7935       TO DFHEIV12
  7936     MOVE -1
  7937       TO DFHEIV11
  7938*    MOVE '8$     CT  E    H L F ,   #00007202' TO DFHEIV0
  7939     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7940     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037323032' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           MAP-NAME,
  7944           EL631JO,
  7945           DFHEIV12,
  7946           MAPSET-NAME,
  7947           DFHEIV99,
  7948           DFHEIV99,
  7949           DFHEIV99,
  7950           DFHEIV11,
  7951           DFHEIV99,
  7952           DFHEIV99,
  7953           DFHEIV99
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7955
  7956     GO TO 9100-RETURN-TRAN.
  7957 8200-SEND-DATAONLY.
  7958     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7959     MOVE '5'                    TO DC-OPTION-CODE.
  7960     PERFORM 9700-DATE-LINK.
  7961     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7962     MOVE EIBTIME                TO TIME-IN.
  7963     MOVE TIME-OUT               TO TIMEO.
  7964     MOVE -1                     TO PFENTRL
  7965     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  7966     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  7967
  7968* EXEC CICS SEND
  7969*        MAP      (MAP-NAME)
  7970*        MAPSET   (MAPSET-NAME)
  7971*        FROM     (EL631JO)
  7972*        DATAONLY
  7973*        ERASEAUP
  7974*        CURSOR
  7975*    END-EXEC.
  7976     MOVE LENGTH OF
  7977      EL631JO
  7978       TO DFHEIV12
  7979     MOVE -1
  7980       TO DFHEIV11
  7981*    MOVE '8$D    CT  A    H L F ,   #00007220' TO DFHEIV0
  7982     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7983     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037323230' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           MAP-NAME,
  7987           EL631JO,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 140
* EL6317.cbl
  7988           DFHEIV12,
  7989           MAPSET-NAME,
  7990           DFHEIV99,
  7991           DFHEIV99,
  7992           DFHEIV99,
  7993           DFHEIV11,
  7994           DFHEIV99,
  7995           DFHEIV99,
  7996           DFHEIV99
  7997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7998
  7999     GO TO 9100-RETURN-TRAN.
  8000 8300-SEND-TEXT.
  8001
  8002* EXEC CICS SEND TEXT
  8003*        FROM     (LOGOFF-TEXT)
  8004*        LENGTH   (LOGOFF-LENGTH)
  8005*        ERASE
  8006*        FREEKB
  8007*    END-EXEC.
  8008*    MOVE '8&      T  E F  H   F -   #00007230' TO DFHEIV0
  8009     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8010     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8011     MOVE X'2020233030303037323330' TO DFHEIV0(25:11)
  8012     CALL 'kxdfhei1' USING DFHEIV0,
  8013           LOGOFF-TEXT,
  8014           LOGOFF-LENGTH,
  8015           DFHEIV99,
  8016           DFHEIV99,
  8017           DFHEIV99,
  8018           DFHEIV99,
  8019           DFHEIV99,
  8020           DFHEIV99,
  8021           DFHEIV99,
  8022           DFHEIV99,
  8023           DFHEIV99,
  8024           DFHEIV99
  8025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8026
  8027
  8028* EXEC CICS RETURN
  8029*    END-EXEC.
  8030*    MOVE '.(                    ''   #00007236' TO DFHEIV0
  8031     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8033     MOVE X'2020233030303037323336' TO DFHEIV0(25:11)
  8034     CALL 'kxdfhei1' USING DFHEIV0,
  8035           DFHEIV99,
  8036           DFHEIV99,
  8037           DFHEIV99,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99
  8041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8042
  8043 8800-UNAUTHORIZED-ACCESS.
  8044     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8045     GO TO 8300-SEND-TEXT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 141
* EL6317.cbl
  8046 8810-PF23.
  8047     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8048     MOVE XCTL-005               TO PGM-NAME.
  8049     GO TO 9300-XCTL.
  8050 9000-RETURN-CICS.
  8051
  8052* EXEC CICS RETURN
  8053*    END-EXEC.
  8054*    MOVE '.(                    ''   #00007246' TO DFHEIV0
  8055     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8056     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8057     MOVE X'2020233030303037323436' TO DFHEIV0(25:11)
  8058     CALL 'kxdfhei1' USING DFHEIV0,
  8059           DFHEIV99,
  8060           DFHEIV99,
  8061           DFHEIV99,
  8062           DFHEIV99,
  8063           DFHEIV99,
  8064           DFHEIV99
  8065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8066
  8067 9100-RETURN-TRAN.
  8068     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8069     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8070
  8071* EXEC CICS RETURN
  8072*        TRANSID    (TRANS-ID)
  8073*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8074*        LENGTH     (PI-COMM-LENGTH)
  8075*    END-EXEC.
  8076*    MOVE '.(CT                  ''   #00007251' TO DFHEIV0
  8077     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8079     MOVE X'2020233030303037323531' TO DFHEIV0(25:11)
  8080     CALL 'kxdfhei1' USING DFHEIV0,
  8081           TRANS-ID,
  8082           PROGRAM-INTERFACE-BLOCK,
  8083           PI-COMM-LENGTH,
  8084           DFHEIV99,
  8085           DFHEIV99,
  8086           DFHEIV99
  8087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8088
  8089 9200-RETURN-MAIN-MENU.
  8090     MOVE XCTL-626               TO PGM-NAME.
  8091     GO TO 9300-XCTL.
  8092 9300-XCTL.
  8093
  8094* EXEC CICS XCTL
  8095*        PROGRAM    (PGM-NAME)
  8096*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8097*        LENGTH     (PI-COMM-LENGTH)
  8098*    END-EXEC.
  8099*    MOVE '.$C                   %   #00007260' TO DFHEIV0
  8100     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8102     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
  8103     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 142
* EL6317.cbl
  8104           PGM-NAME,
  8105           PROGRAM-INTERFACE-BLOCK,
  8106           PI-COMM-LENGTH,
  8107           DFHEIV99
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8109
  8110 9400-CLEAR.
  8111     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8112
  8113* EXEC CICS XCTL
  8114*        PROGRAM    (PGM-NAME)
  8115*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8116*        LENGTH     (PI-COMM-LENGTH)
  8117*    END-EXEC.
  8118*    MOVE '.$C                   %   #00007267' TO DFHEIV0
  8119     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8120     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8121     MOVE X'2020233030303037323637' TO DFHEIV0(25:11)
  8122     CALL 'kxdfhei1' USING DFHEIV0,
  8123           PGM-NAME,
  8124           PROGRAM-INTERFACE-BLOCK,
  8125           PI-COMM-LENGTH,
  8126           DFHEIV99
  8127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8128
  8129 9500-PF12.
  8130     MOVE XCTL-010               TO PGM-NAME.
  8131     GO TO 9300-XCTL.
  8132 9600-PGMID-ERROR.
  8133
  8134* EXEC CICS HANDLE CONDITION
  8135*        PGMIDERR    (8300-SEND-TEXT)
  8136*    END-EXEC.
  8137*    MOVE '"$L                   ! " #00007276' TO DFHEIV0
  8138     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8140     MOVE X'2220233030303037323736' TO DFHEIV0(25:11)
  8141     CALL 'kxdfhei1' USING DFHEIV0
  8142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8143
  8144     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8145     MOVE ' '                    TO PI-ENTRY-CD-1.
  8146     MOVE XCTL-005               TO PGM-NAME.
  8147     MOVE PGM-NAME               TO LOGOFF-PGM.
  8148     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8149     GO TO 9300-XCTL.
  8150 9700-DATE-LINK.
  8151     MOVE LINK-ELDATCV           TO PGM-NAME.
  8152
  8153* EXEC CICS LINK
  8154*        PROGRAM    (PGM-NAME)
  8155*        COMMAREA   (DATE-CONVERSION-DATA)
  8156*        LENGTH     (DC-COMM-LENGTH)
  8157*    END-EXEC.
  8158*    MOVE '."C                   (   #00007287' TO DFHEIV0
  8159     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8161     MOVE X'2020233030303037323837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 143
* EL6317.cbl
  8162     CALL 'kxdfhei1' USING DFHEIV0,
  8163           PGM-NAME,
  8164           DATE-CONVERSION-DATA,
  8165           DC-COMM-LENGTH,
  8166           DFHEIV99,
  8167           DFHEIV99,
  8168           DFHEIV99,
  8169           DFHEIV99
  8170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8171
  8172 9900-ERROR-FORMAT.
  8173     IF NOT EMI-ERRORS-COMPLETE
  8174        MOVE LINK-001            TO PGM-NAME
  8175
  8176* EXEC CICS LINK
  8177*           PROGRAM    (PGM-NAME)
  8178*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8179*           LENGTH     (EMI-COMM-LENGTH)
  8180*       END-EXEC
  8181*    MOVE '."C                   (   #00007295' TO DFHEIV0
  8182     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8184     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  8185     CALL 'kxdfhei1' USING DFHEIV0,
  8186           PGM-NAME,
  8187           ERROR-MESSAGE-INTERFACE-BLOCK,
  8188           EMI-COMM-LENGTH,
  8189           DFHEIV99,
  8190           DFHEIV99,
  8191           DFHEIV99,
  8192           DFHEIV99
  8193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8194     END-IF
  8195     .
  8196 9900-EXIT.
  8197     EXIT.
  8198 9990-ABEND.
  8199     MOVE LINK-004               TO PGM-NAME.
  8200     MOVE DFHEIBLK               TO EMI-LINE1.
  8201
  8202* EXEC CICS LINK
  8203*        PROGRAM   (PGM-NAME)
  8204*        COMMAREA  (EMI-LINE1)
  8205*        LENGTH    (72)
  8206*    END-EXEC.
  8207     MOVE 72
  8208       TO DFHEIV11
  8209*    MOVE '."C                   (   #00007307' TO DFHEIV0
  8210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8212     MOVE X'2020233030303037333037' TO DFHEIV0(25:11)
  8213     CALL 'kxdfhei1' USING DFHEIV0,
  8214           PGM-NAME,
  8215           EMI-LINE1,
  8216           DFHEIV11,
  8217           DFHEIV99,
  8218           DFHEIV99,
  8219           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 144
* EL6317.cbl
  8220           DFHEIV99
  8221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8222
  8223     GO TO 8200-SEND-DATAONLY.
  8224
  8225* GOBACK.
  8226     MOVE '9%                    "   ' TO DFHEIV0
  8227     MOVE 'EL6317' TO DFHEIV1
  8228     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8229     GOBACK.
  8230 9995-SECURITY-VIOLATION.
  8231*                            COPY ELCSCTP.
  8232******************************************************************
  8233*                                                                *
  8234*                            ELCSCTP                             *
  8235*                            VMOD=2.001                          *
  8236*                                                                *
  8237*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8238******************************************************************
  8239
  8240
  8241     MOVE EIBDATE          TO SM-JUL-DATE.
  8242     MOVE EIBTRMID         TO SM-TERMID.
  8243     MOVE THIS-PGM         TO SM-PGM.
  8244     MOVE EIBTIME          TO TIME-IN.
  8245     MOVE TIME-OUT         TO SM-TIME.
  8246     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8247
  8248
  8249* EXEC CICS LINK
  8250*         PROGRAM  ('EL003')
  8251*         COMMAREA (SECURITY-MESSAGE)
  8252*         LENGTH   (80)
  8253*    END-EXEC.
  8254     MOVE 'EL003' TO DFHEIV1
  8255     MOVE 80
  8256       TO DFHEIV11
  8257*    MOVE '."C                   (   #00007332' TO DFHEIV0
  8258     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8260     MOVE X'2020233030303037333332' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0,
  8262           DFHEIV1,
  8263           SECURITY-MESSAGE,
  8264           DFHEIV11,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99,
  8268           DFHEIV99
  8269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8270
  8271
  8272******************************************************************
  8273
  8274 9995-EXIT.
  8275     EXIT.
  8276
  8277 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 145
* EL6317.cbl
  8278     MOVE '9%                    "   ' TO DFHEIV0
  8279     MOVE 'EL6317' TO DFHEIV1
  8280     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8281     GOBACK.
  8282 9999-DFHEXIT.
  8283     IF DFHEIGDJ EQUAL 0001
  8284         NEXT SENTENCE
  8285     ELSE IF DFHEIGDJ EQUAL 2
  8286         GO TO 8300-SEND-TEXT
  8287         DEPENDING ON DFHEIGDI.
  8288     MOVE '9%                    "   ' TO DFHEIV0
  8289     MOVE 'EL6317' TO DFHEIV1
  8290     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8291     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34536     Code:       18519
