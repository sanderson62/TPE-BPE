* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   1
* EL055.cbl
* Options: int("EL055.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL055.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL055.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL055.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 identification division.
     2 program-id. EL055.
     3******************************************************************
     4*                   C H A N G E   L O G
     5*
     6* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     7*-----------------------------------------------------------------
     8*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
     9* EFFECTIVE    NUMBER
    10*-----------------------------------------------------------------
    11* 052020  CR2019111300001  PEMA  New program for 'K' transaction
    12******************************************************************
    13 environment division.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   2
* EL055.cbl
    14 data division.
    15 working-storage section.
    16 01  DFH-START PIC X(04).
    17 77  s1                          pic s999 comp-3 value +0.
    18 77  ns1                         pic s9(5) comp-3 value +0.
    19 77  nscntr                      pic s999 comp-3 value +0.
    20 77  ws-eof-sw                   pic x  value spaces.
    21     88  end-of-input                  value 'Y'.
    22 77  ws-error-sw                 pic x  value spaces.
    23     88  error-found               value 'Y'.
    24 77  ws-string-len               pic s999 comp-3 value zeros.
    25 77  ws-startbr-ind              pic x value spaces.
    26 77  ws-NS-startbr-ind           pic x value spaces.
    27 01  P pointer.
    28 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    29 01  var-ptr pointer.
    30 01  env-var-len                 pic 9(4)  binary.
    31 01  rc                          pic 9(9)  binary.
    32 01  ws-new-greg-eff-date        pic x(10).
    33 01  ws-old-greg-eff-date        pic x(10).
    34 01  WS-KIXSYS.
    35     05  WS-KIX-FIL1             PIC X(10).
    36     05  WS-KIX-APPS             PIC X(10).
    37     05  WS-KIX-ENV              PIC X(10).
    38     05  WS-KIX-MYENV            PIC X(10).
    39     05  WS-KIX-SYS              PIC X(10).
    40*                                copy ERCPNDB.
    41******************************************************************
    42*                                                                *
    43*                                                                *
    44*                            ERCPNDB.                            *
    45*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    46*                            VMOD=2.025                          *
    47*                                                                *
    48*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
    49*                                                                *
    50******************************************************************
    51*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
    52*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*   FILE TYPE = VSAM,KSDS                                        *
    57*   RECORD SIZE = 585  RECFORM = FIXED                           *
    58*                                                                *
    59*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
    60*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
    61*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
    62*                                                 RKP=13,LEN=36  *
    63*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
    64*                                      AND CHG-SEQ.)             *
    65*                                                RKP=49,LEN=11   *
    66*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
    67*                                      AND CHG-SEQ.)             *
    68*                                                RKP=60,LEN=15   *
    69*                                                                *
    70*   LOG = NO                                                     *
    71*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   3
* EL055.cbl
    72******************************************************************
    73******************************************************************
    74*                   C H A N G E   L O G
    75*
    76* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    77*-----------------------------------------------------------------
    78*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    79* EFFECTIVE    NUMBER
    80*-----------------------------------------------------------------
    81* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    82* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    83* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    84* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    85* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
    86* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    87* 032306                   PEMA  ADD BOW LOAN NUMBER
    88* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
    89* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    90* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    91* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    92* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
    93* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
    94* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    95* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    96* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
    97* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
    98* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
    99* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   100* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   101******************************************************************
   102
   103 01  PENDING-BUSINESS.
   104     12  PB-RECORD-ID                     PIC XX.
   105         88  VALID-PB-ID                        VALUE 'PB'.
   106
   107     12  PB-CONTROL-PRIMARY.
   108         16  PB-COMPANY-CD                PIC X.
   109         16  PB-ENTRY-BATCH               PIC X(6).
   110         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   111         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   112
   113     12  PB-CONTROL-BY-ACCOUNT.
   114         16  PB-COMPANY-CD-A1             PIC X.
   115         16  PB-CARRIER                   PIC X.
   116         16  PB-GROUPING.
   117             20  PB-GROUPING-PREFIX       PIC XXX.
   118             20  PB-GROUPING-PRIME        PIC XXX.
   119         16  PB-STATE                     PIC XX.
   120         16  PB-ACCOUNT.
   121             20  PB-ACCOUNT-PREFIX        PIC X(4).
   122             20  PB-ACCOUNT-PRIME         PIC X(6).
   123         16  PB-CERT-EFF-DT               PIC XX.
   124         16  PB-CERT-NO.
   125             20  PB-CERT-PRIME            PIC X(10).
   126             20  PB-CERT-SFX              PIC X.
   127         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   128
   129         16  PB-RECORD-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   4
* EL055.cbl
   130             88  PB-MAILING-DATA                VALUE '0'.
   131             88  PB-ISSUE                       VALUE '1'.
   132             88  PB-CANCELLATION                VALUE '2'.
   133             88  PB-BATCH-TRAILER               VALUE '9'.
   134
   135     12  PB-CONTROL-BY-ORIG-BATCH.
   136         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   137         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   138         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   139         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   140
   141     12  PB-CONTROL-BY-CSR.
   142         16  PB-CSR-COMPANY-CD            PIC X.
   143         16  PB-CSR-ID                    PIC X(4).
   144         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   145         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   146         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   147******************************************************************
   148*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   149******************************************************************
   150
   151     12  PB-LAST-MAINT-DT                 PIC XX.
   152     12  PB-LAST-MAINT-BY                 PIC X(4).
   153     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   154
   155     12  PB-RECORD-BODY                   PIC X(375).
   156
   157     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   158         16  PB-CERT-ORIGIN               PIC X.
   159             88  CLASIC-CREATED-CERT         VALUE '1'.
   160         16  PB-I-NAME.
   161             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   162             20  PB-I-INSURED-FIRST-NAME.
   163                 24  PB-I-INSURED-1ST-INIT PIC X.
   164                 24  FILLER                PIC X(9).
   165             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   166         16  PB-I-AGE                     PIC S99   COMP-3.
   167         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   168         16  PB-I-BIRTHDAY                PIC XX.
   169         16  PB-I-INSURED-SEX             PIC X.
   170             88  PB-SEX-MALE     VALUE 'M'.
   171             88  PB-SEX-FEMALE   VALUE 'F'.
   172
   173         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   174         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   175         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   176         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   177         16  PB-I-SKIP-CODE               PIC X.
   178             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   179             88  PB-SKIP-JULY              VALUE '1'.
   180             88  PB-SKIP-AUGUST            VALUE '2'.
   181             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   182             88  PB-SKIP-JULY-AUG          VALUE '4'.
   183             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   184             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   185             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   186             88  PB-SKIP-JUNE              VALUE '8'.
   187             88  PB-SKIP-JUNE-JULY         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   5
* EL055.cbl
   188             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   189             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   190         16  PB-I-TERM-TYPE               PIC X.
   191             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   192             88  PB-PAID-WEEKLY            VALUE 'W'.
   193             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   194             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   195             88  PB-PAID-13-YEARLY         VALUE 'T'.
   196         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   197         16  PB-I-POLICY-FORM-NO          PIC X(12).
   198         16  PB-I-DATA-ENTRY-SW           PIC X.
   199             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   200             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   201             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   202             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   203         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   204         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   205*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   206         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   207         16  PB-I-LETTER-REQD             PIC X.
   208
   209         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   210             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   211             88  PB-INVALID-LIFE             VALUE '  ' '00'
   212                                                   '90' THRU '99'.
   213         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   214                                          PIC XX.
   215         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   216         16  PB-I-AMOUNT-FINANCED REDEFINES
   217                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   218         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   219         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   220                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   221         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   222         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   223         16  PB-I-CLP-AMOUNT REDEFINES
   224                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   225         16  PB-I-LF-CALC-FLAG            PIC X.
   226             88 PB-COMP-LF-PREM               VALUE '?'.
   227         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   228         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   229         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   230         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   231         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   232         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   233         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   234         16  PB-I-LF-ABBR                 PIC XXX.
   235         16  PB-I-LF-INPUT-CD             PIC XX.
   236
   237         16  PB-I-AH-BENEFIT-CD           PIC XX.
   238             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   239             88  PB-INVALID-AH               VALUE '  ' '00'
   240                                                   '90' THRU '99'.
   241         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   242         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   243         16  PB-I-AH-CALC-FLAG            PIC X.
   244             88 PB-COMP-AH-PREM                  VALUE '?'.
   245         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   6
* EL055.cbl
   246         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   247         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
   248         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   249         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   250         16  PB-I-AH-ABBR                 PIC XXX.
   251         16  PB-I-AH-INPUT-CD             PIC XXX.
   252
   253         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   254         16  PB-I-REIN-TABLE              PIC XXX.
   255         16  PB-I-BUSINESS-TYPE           PIC 99.
   256         16  PB-I-INDV-GRP-CD             PIC X.
   257         16  PB-I-MORT-CODE.
   258             20  PB-I-TABLE               PIC X.
   259             20  PB-I-INTEREST            PIC XX.
   260             20  PB-I-MORT-TYP            PIC X.
   261         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   262         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   263         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   264         16  PB-I-INDV-GRP-OVRD           PIC X.
   265         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   266         16  PB-I-SIG-SW                  PIC X.
   267             88  PB-POLICY-SIGNED             VALUE 'Y'.
   268         16  PB-I-RATE-CLASS              PIC XX.
   269         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   270         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   271         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   272         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   273         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   274         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   275         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   276         16  PB-I-BENEFIT-TYPE            PIC XXX.
   277         16  PB-I-OB-FLAG                 PIC X.
   278             88  PB-I-OB                      VALUE 'B'.
   279             88  PB-I-SUMMARY                 VALUE 'Z'.
   280         16  PB-I-ENTRY-STATUS            PIC X.
   281             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   282                                              'M' '5' '9' '2'.
   283             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   284             88  PB-I-POLICY-PENDING          VALUE '2'.
   285             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   286             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   287             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   288             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   289             88  PB-I-REIN-ONLY               VALUE '9'.
   290             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   291             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   292             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   293             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   294         16  PB-I-INT-CODE                PIC X.
   295             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   296             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   297         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   298         16  PB-I-SOC-SEC-NO              PIC X(11).
   299         16  PB-I-MEMBER-NO               PIC X(12).
   300         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   301*        16  PB-I-LOAN-OFFICER            PIC XXX.
   302         16  PB-I-OLD-LOF                 PIC XXX.
   303         16  PB-I-LF-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   7
* EL055.cbl
   304         16  PB-I-AH-EXPIRE-DT            PIC XX.
   305         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   306         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   307         16  PB-I-LIFE-INDICATOR          PIC X.
   308             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   309         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   310         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   311                                          PIC S9(5)V99    COMP-3.
   312         16  PB-I-MAIL-ADDRS-SW           PIC X.
   313             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   314             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   315         16  PB-I-1ST-PMT-DT              PIC XX.
   316         16  PB-I-JOINT-INSURED.
   317             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   318             20 PB-I-JOINT-FIRST-NAME.
   319                24  PB-I-JOINT-FIRST-INIT PIC X.
   320                24  FILLER                PIC X(9).
   321             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   322*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   323         16  PB-I-BENEFICIARY-NAME.
   324             20  PB-I-BANK-NUMBER         PIC X(10).
   325             20  FILLER                   PIC X(15).
   326         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   327         16  PB-I-REFERENCE               PIC X(12).
   328         16  FILLER REDEFINES PB-I-REFERENCE.
   329             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   330             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   331             20  PB-I-CLP-STATE           PIC XX.
   332         16  PB-I-UNDERWRITING-STATUS     PIC X.
   333             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   334             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   335             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   336         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   337         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   338         16  PB-I-RESIDENT-STATE          PIC XX.
   339         16  PB-I-RATE-CODE               PIC X(4).
   340         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   341         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   342         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   343         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   344         16  PB-I-BANK-NOCHRGB            PIC 99.
   345         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   346         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   347
   348     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   349         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   350             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   351         16  PB-C-CANCEL-ORIGIN           PIC X.
   352             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   353         16  PB-C-LF-CANCEL-DT            PIC XX.
   354         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   355         16  PB-C-LF-CALC-REQ             PIC X.
   356             88 PB-COMP-LF-CANCEL            VALUE '?'.
   357         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   358         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   359         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   360             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   361         16  PB-C-AH-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   8
* EL055.cbl
   362         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   363         16  PB-C-AH-CALC-REQ             PIC X.
   364             88 PB-COMP-AH-CANCEL            VALUE '?'.
   365         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   366         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   367         16  PB-C-LAST-NAME               PIC X(15).
   368         16  PB-C-REFUND-SW               PIC X.
   369             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   370             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   371         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   372         16  PB-C-PAYEE-CODE              PIC X(6).
   373         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   374         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   375         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   376         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   377         16  PB-C-REFERENCE               PIC X(12).
   378         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   379         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   380         16  PB-C-POST-CARD-IND           PIC X.
   381         16  PB-C-CANCEL-REASON           PIC X.
   382         16  PB-C-REF-INTERFACE-SW        PIC X.
   383         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   384         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   385         16  FILLER                       PIC X(01).
   386*        16  FILLER                       PIC X(18).
   387         16  PB-C-POLICY-FORM-NO          PIC X(12).
   388*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   389         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
   390         16  PB-CANCELED-CERT-DATA.
   391             20  PB-CI-INSURED-NAME.
   392                 24  PB-CI-LAST-NAME      PIC X(15).
   393                 24  PB-CI-INITIALS       PIC XX.
   394             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   395             20  PB-CI-INSURED-SEX        PIC X.
   396             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   397             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   398             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   399             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   400             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   401             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   402             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   403             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   404             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   405             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   406             20  PB-CI-RATE-CLASS         PIC XX.
   407             20  PB-CI-RATE-DEV-LF        PIC XXX.
   408             20  PB-CI-RATE-DEV-AH        PIC XXX.
   409             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   410             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   411             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   412             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   413             20  PB-CI-LF-ABBR            PIC X(3).
   414             20  PB-CI-AH-ABBR            PIC X(3).
   415             20  PB-CI-OB-FLAG            PIC X.
   416                 88  PB-CI-OB                VALUE 'B'.
   417             20  PB-CI-LF-POLICY-STATUS   PIC X.
   418                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   419                                           'M' '4' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page   9
* EL055.cbl
   420                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   421                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   422                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   423                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   424                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   425                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   426                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   427                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   428                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   429                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   430                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   431                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   432                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   433             20  PB-CI-AH-POLICY-STATUS   PIC X.
   434                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   435                                           'M' '4' '5' '9' '2'.
   436                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   437                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   438                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   439                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   440                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   441                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   442                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   443                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   444                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   445                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   446                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   447                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   448                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   449             20  PB-CI-PAY-FREQUENCY      PIC 99.
   450             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   451             20  PB-CI-SOC-SEC-NO         PIC X(11).
   452             20  PB-CI-MEMBER-NO          PIC X(12).
   453             20  PB-CI-INT-CODE           PIC X.
   454                 88  PB-CI-ADD-ON                  VALUE 'A'.
   455                 88  PB-CI-SIMPLE                  VALUE 'S'.
   456             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   457             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   458             20  PB-CI-COMP-EXCP-SW       PIC X.
   459                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   460                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   461             20  PB-CI-ENTRY-STATUS       PIC X.
   462             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   463             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   464             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   465             20  PB-CI-DEATH-DT           PIC XX.
   466             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   467             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   468             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   469             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   470             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   471             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   472             20  PB-CI-ENTRY-DT              PIC XX.
   473             20  PB-CI-ENTRY-BATCH           PIC X(6).
   474             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   475             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   476             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   477             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  10
* EL055.cbl
   478             20  PB-CI-OLD-LOF               PIC XXX.
   479*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   480             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   481             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   482             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   483             20  PB-CI-INDV-GRP-CD           PIC X.
   484             20  PB-CI-BENEFICIARY-NAME.
   485                 24  PB-CI-BANK-NUMBER       PIC X(10).
   486                 24  FILLER                  PIC X(15).
   487             20  PB-CI-NOTE-SW               PIC X.
   488             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   489             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   490             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   491             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   492             20  PB-CI-LOAN-OFFICER          PIC X(5).
   493             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   494             20  PB-CI-FIRST-NAME            PIC X(10).
   495             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   496
   497         16  FILLER                       PIC X(13).
   498*032306  16  FILLER                       PIC X(27).
   499*        16  FILLER                       PIC X(46).
   500
   501     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   502         16  FILLER                       PIC X(10).
   503         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   504         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   505         16  PB-M-INSURED-MID-INIT        PIC X.
   506         16  PB-M-INSURED-AGE             PIC 99.
   507         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   508         16  PB-M-INSURED-SEX             PIC X.
   509         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   510         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   511         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   512         16  PB-M-INSURED-CITY-STATE.
   513             20  PB-M-INSURED-CITY        PIC X(28).
   514             20  PB-M-INSURED-STATE       PIC XX.
   515         16  PB-M-INSURED-ZIP-CODE.
   516             20  PB-M-INSURED-ZIP-PRIME.
   517                 24  PB-M-INSURED-ZIP-1   PIC X.
   518                     88  PB-M-CANADIAN-POST-CODE
   519                                             VALUE 'A' THRU 'Z'.
   520                 24  FILLER               PIC X(4).
   521             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   522         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   523                                        PB-M-INSURED-ZIP-CODE.
   524             20  PM-M-INS-CAN-POST1       PIC XXX.
   525             20  PM-M-INS-CAN-POST2       PIC XXX.
   526             20  FILLER                   PIC XXX.
   527         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   528         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   529         16  PB-M-CRED-BENE-NAME          PIC X(30).
   530         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   531         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   532         16  PB-M-CRED-BENE-CITYST.
   533             20  PB-M-CRED-BENE-CITY      PIC X(28).
   534             20  PB-M-CRED-BENE-STATE     PIC XX.
   535         16  FILLER                       PIC X(92).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  11
* EL055.cbl
   536
   537     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   538         16  FILLER                       PIC X(10).
   539         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   540         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   541         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   542         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   543         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   544         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   545         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   546         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   547         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   548         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   549         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   550         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   551         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   552         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   553         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   554         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   555         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   556         16  PB-ACCOUNT-NAME              PIC X(30).
   557         16  PB-PREM-REF-RPT-FLAG         PIC X.
   558         16  PB-REFERENCE                 PIC X(12).
   559         16  PB-B-RECEIVED-DT             PIC XX.
   560         16  FILLER                       PIC X(234).
   561
   562     12  PB-RECORD-STATUS.
   563         16  PB-CREDIT-SELECT-DT          PIC XX.
   564         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   565         16  PB-BILLED-DT                 PIC XX.
   566         16  PB-BILLING-STATUS            PIC X.
   567             88  PB-ENTRY-REVERSED            VALUE 'R'.
   568             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   569             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   570         16  PB-RECORD-BILL               PIC X.
   571             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   572             88  PB-RECORD-RETURNED           VALUE 'R'.
   573             88  PB-RECORD-ENDORSED           VALUE 'E'.
   574             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   575             88  PB-OVERRIDE-AH               VALUE 'A'.
   576             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   577         16  PB-BATCH-ENTRY               PIC X.
   578             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   579             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   580             88  PB-REISSUED-CERT             VALUE 'E'.
   581             88  PB-CASH-CERT                 VALUE 'C'.
   582             88  PB-MONTHLY-CERT              VALUE 'M'.
   583             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   584             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   585             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   586         16  PB-FORCE-CODE                PIC X.
   587             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   588             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   589             88  PB-CANCEL-FORCE              VALUE '8'.
   590             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   591             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   592             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   593             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  12
* EL055.cbl
   594             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   595             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   596             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
   597             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   598         16  PB-FATAL-FLAG                PIC X.
   599             88  PB-FATAL-ERRORS              VALUE 'X'.
   600         16  PB-FORCE-ER-CD               PIC X.
   601             88  PB-FORCE-ERRORS              VALUE 'F'.
   602             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   603         16  PB-WARN-ER-CD                PIC X.
   604             88  PB-WARNING-ERRORS            VALUE 'W'.
   605         16  FILLER                       PIC X.
   606         16  PB-OUT-BAL-CD                PIC X.
   607             88  PB-OUT-OF-BAL                VALUE 'O'.
   608         16  PB-LIFE-OVERRIDE-L1          PIC X.
   609         16  PB-AH-OVERRIDE-L1            PIC X.
   610         16  PB-INPUT-DT                  PIC XX.
   611         16  PB-INPUT-BY                  PIC X(4).
   612         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   613         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   614         16  PB-TOLERANCE-REJECT-SW       PIC X.
   615         16  PB-LF-EARNING-METHOD         PIC X.
   616         16  PB-AH-EARNING-METHOD         PIC X.
   617         16  PB-LF-TERM-CALC-METHOD       PIC X.
   618         16  PB-AH-TERM-CALC-METHOD       PIC X.
   619         16  PB-REIN-CD                   PIC XXX.
   620         16  PB-LF-REFUND-TYPE            PIC X.
   621         16  PB-AH-REFUND-TYPE            PIC X.
   622         16  PB-ACCT-EFF-DT               PIC XX.
   623         16  PB-ACCT-EXP-DT               PIC XX.
   624         16  PB-COMPANY-ID                PIC X(3).
   625         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   626         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   627         16  PB-SV-CARRIER                PIC X.
   628         16  PB-SV-GROUPING               PIC X(6).
   629         16  PB-SV-STATE                  PIC XX.
   630         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   631         16  PB-GA-BILLING-INFO.
   632             20  PB-GA-BILL-DT OCCURS 5 TIMES
   633                                          PIC XX.
   634         16  PB-SV-REMIT-TO  REDEFINES
   635             PB-GA-BILLING-INFO           PIC X(10).
   636         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   637         16  PB-I-LOAN-OFFICER            PIC X(5).
   638         16  PB-I-VIN                     PIC X(17).
   639
   640         16  FILLER                       PIC X(04).
   641         16  IMNET-BYPASS-SW              PIC X.
   642
   643******************************************************************
   644*                COMMON EDIT ERRORS                              *
   645******************************************************************
   646
   647     12  PB-COMMON-ERRORS.
   648         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   649                                           PIC S9(4)     COMP.
   650
   651******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  13
* EL055.cbl
   652*                                copy ELCCERT.
   653******************************************************************
   654*                                                                *
   655*                            ELCCERT.                            *
   656*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   657*                            VMOD=2.013                          *
   658*                                                                *
   659*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   660*                                                                *
   661*   FILE TYPE = VSAM,KSDS                                        *
   662*   RECORD SIZE = 450  RECFORM = FIXED                           *
   663*                                                                *
   664*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   665*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   666*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   667*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   668*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   669*                                                                *
   670*   LOG = YES                                                    *
   671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   672******************************************************************
   673*                   C H A N G E   L O G
   674*
   675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   676*-----------------------------------------------------------------
   677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   678* EFFECTIVE    NUMBER
   679*-----------------------------------------------------------------
   680* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   681* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   682* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   683* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   684* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   685* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   686* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   687* 032612  CR2011110200001  PEMA  AHL CHANGES
   688* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   689* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   690* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   691******************************************************************
   692
   693 01  CERTIFICATE-MASTER.
   694     12  CM-RECORD-ID                      PIC XX.
   695         88  VALID-CM-ID                      VALUE 'CM'.
   696
   697     12  CM-CONTROL-PRIMARY.
   698         16  CM-COMPANY-CD                 PIC X.
   699         16  CM-CARRIER                    PIC X.
   700         16  CM-GROUPING.
   701             20  CM-GROUPING-PREFIX        PIC X(3).
   702             20  CM-GROUPING-PRIME         PIC X(3).
   703         16  CM-STATE                      PIC XX.
   704         16  CM-ACCOUNT.
   705             20  CM-ACCOUNT-PREFIX         PIC X(4).
   706             20  CM-ACCOUNT-PRIME          PIC X(6).
   707         16  CM-CERT-EFF-DT                PIC XX.
   708         16  CM-CERT-NO.
   709             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  14
* EL055.cbl
   710             20  CM-CERT-SFX               PIC X.
   711
   712     12  CM-CONTROL-BY-NAME.
   713         16  CM-COMPANY-CD-A1              PIC X.
   714         16  CM-INSURED-LAST-NAME          PIC X(15).
   715         16  CM-INSURED-INITIALS.
   716             20  CM-INSURED-INITIAL1       PIC X.
   717             20  CM-INSURED-INITIAL2       PIC X.
   718
   719     12  CM-CONTROL-BY-SSN.
   720         16  CM-COMPANY-CD-A2              PIC X.
   721         16  CM-SOC-SEC-NO.
   722             20  CM-SSN-STATE              PIC XX.
   723             20  CM-SSN-ACCOUNT            PIC X(6).
   724             20  CM-SSN-LN3.
   725                 25  CM-INSURED-INITIALS-A2.
   726                     30 CM-INSURED-INITIAL1-A2   PIC X.
   727                     30 CM-INSURED-INITIAL2-A2   PIC X.
   728                 25 CM-PART-LAST-NAME-A2         PIC X.
   729
   730     12  CM-CONTROL-BY-CERT-NO.
   731         16  CM-COMPANY-CD-A4              PIC X.
   732         16  CM-CERT-NO-A4                 PIC X(11).
   733
   734     12  CM-CONTROL-BY-MEMB.
   735         16  CM-COMPANY-CD-A5              PIC X.
   736         16  CM-MEMBER-NO.
   737             20  CM-MEMB-STATE             PIC XX.
   738             20  CM-MEMB-ACCOUNT           PIC X(6).
   739             20  CM-MEMB-LN4.
   740                 25  CM-INSURED-INITIALS-A5.
   741                     30 CM-INSURED-INITIAL1-A5   PIC X.
   742                     30 CM-INSURED-INITIAL2-A5   PIC X.
   743                 25 CM-PART-LAST-NAME-A5         PIC XX.
   744
   745     12  CM-INSURED-PROFILE-DATA.
   746         16  CM-INSURED-FIRST-NAME.
   747             20  CM-INSURED-1ST-INIT       PIC X.
   748             20  FILLER                    PIC X(9).
   749         16  CM-INSURED-ISSUE-AGE          PIC 99.
   750         16  CM-INSURED-SEX                PIC X.
   751             88  CM-SEX-MALE                  VALUE 'M'.
   752             88  CM-SEX-FEMAL                 VALUE 'F'.
   753         16  CM-INSURED-JOINT-AGE          PIC 99.
   754         16  CM-JOINT-INSURED-NAME.
   755             20  CM-JT-LAST-NAME           PIC X(15).
   756             20  CM-JT-FIRST-NAME.
   757                 24  CM-JT-1ST-INIT        PIC X.
   758                 24  FILLER                PIC X(9).
   759             20  CM-JT-INITIAL             PIC X.
   760
   761     12  CM-LIFE-DATA.
   762         16  CM-LF-BENEFIT-CD              PIC XX.
   763         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   764         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   765         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   766         16  CM-LF-DEV-CODE                PIC XXX.
   767         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  15
* EL055.cbl
   768         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   769         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   770         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   771         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   772         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   773         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   774         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   775         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   776         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   777         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   778         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   779         16  cm-temp-epiq                  pic xx.
   780             88  EPIQ-CLASS                  value 'EQ'.
   781*        16  FILLER                        PIC XX.
   782
   783     12  CM-AH-DATA.
   784         16  CM-AH-BENEFIT-CD              PIC XX.
   785         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   786         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   787         16  CM-AH-DEV-CODE                PIC XXX.
   788         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   789         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   790         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   791         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   792         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   793         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   794         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   795         16  CM-AH-PAID-THRU-DT            PIC XX.
   796             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   797         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   798         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   799         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   800         16  FILLER                        PIC X.
   801
   802     12  CM-LOAN-INFORMATION.
   803         16  CM-LIVES                      PIC S9(7)     COMP-3.
   804         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   805                                           PIC S9(5)V99  COMP-3.
   806         16  CM-BILLED                     PIC S9(7)     COMP-3.
   807         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   808         16  CM-PAY-FREQUENCY              PIC S99.
   809         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   810         16  CM-RATE-CLASS                 PIC XX.
   811         16  CM-BENEFICIARY                PIC X(25).
   812         16  CM-POLICY-FORM-NO             PIC X(12).
   813         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   814         16  CM-LAST-ADD-ON-DT             PIC XX.
   815         16  CM-DEDUCTIBLE-AMOUNTS.
   816             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   817             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   818         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   819             20  CM-RESIDENT-STATE         PIC XX.
   820             20  CM-RATE-CODE              PIC X(4).
   821             20  FILLER                    PIC XX.
   822         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   823             20  CM-LOAN-OFFICER           PIC X(5).
   824             20  FILLER                    PIC XXX.
   825         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  16
* EL055.cbl
   826         16  CM-UNDERWRITING-CODE          PIC X.
   827             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   828         16  CM-POST-CARD-IND              PIC X.
   829         16  CM-REF-INTERFACE-SW           PIC X.
   830         16  CM-PREMIUM-TYPE               PIC X.
   831             88  CM-SING-PRM                  VALUE '1'.
   832             88  CM-O-B-COVERAGE              VALUE '2'.
   833             88  CM-OPEN-END                  VALUE '3'.
   834         16  CM-IND-GRP-TYPE               PIC X.
   835             88  CM-INDIVIDUAL                VALUE 'I'.
   836             88  CM-GROUP                     VALUE 'G'.
   837         16  CM-SKIP-CODE                  PIC X.
   838             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   839             88  SKIP-JULY                    VALUE '1'.
   840             88  SKIP-AUGUST                  VALUE '2'.
   841             88  SKIP-SEPTEMBER               VALUE '3'.
   842             88  SKIP-JULY-AUG                VALUE '4'.
   843             88  SKIP-AUG-SEPT                VALUE '5'.
   844             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   845             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   846             88  SKIP-JUNE                    VALUE '8'.
   847             88  SKIP-JUNE-JULY               VALUE '9'.
   848             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   849             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   850         16  CM-PAYMENT-MODE               PIC X.
   851             88  PAY-MONTHLY                  VALUE SPACE.
   852             88  PAY-WEEKLY                   VALUE '1'.
   853             88  PAY-SEMI-MONTHLY             VALUE '2'.
   854             88  PAY-BI-WEEKLY                VALUE '3'.
   855             88  PAY-SEMI-ANUALLY             VALUE '4'.
   856         16  CM-LOAN-NUMBER                PIC X(8).
   857         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   858         16  CM-OLD-LOF                    PIC XXX.
   859*        16  CM-LOAN-OFFICER               PIC XXX.
   860         16  CM-REIN-TABLE                 PIC XXX.
   861         16  CM-SPECIAL-REIN-CODE          PIC X.
   862         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   863         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   864         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   865
   866     12  CM-STATUS-DATA.
   867         16  CM-ENTRY-STATUS               PIC X.
   868         16  CM-ENTRY-DT                   PIC XX.
   869
   870         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   871         16  CM-LF-CANCEL-DT               PIC XX.
   872         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   873
   874         16  CM-LF-STATUS-AT-DEATH         PIC X.
   875         16  CM-LF-DEATH-DT                PIC XX.
   876         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   877
   878         16  CM-LF-CURRENT-STATUS          PIC X.
   879             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   880                                                'M' '4' '5' '9'.
   881             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   882             88  CM-LF-POLICY-PENDING         VALUE '2'.
   883             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  17
* EL055.cbl
   884             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   885             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   886             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   887             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   888             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   889             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   890             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   891             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   892             88  CM-LF-DECLINED               VALUE 'D'.
   893             88  CM-LF-VOIDED                 VALUE 'V'.
   894
   895         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   896         16  CM-AH-CANCEL-DT               PIC XX.
   897         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   898
   899         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   900         16  CM-AH-SETTLEMENT-DT           PIC XX.
   901         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   902
   903         16  CM-AH-CURRENT-STATUS          PIC X.
   904             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   905                                                'M' '4' '5' '9'.
   906             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   907             88  CM-AH-POLICY-PENDING         VALUE '2'.
   908             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   909             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   910             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   911             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   912             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   913             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   914             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   915             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   916             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   917             88  CM-AH-DECLINED               VALUE 'D'.
   918             88  CM-AH-VOIDED                 VALUE 'V'.
   919
   920         16  CM-CLAIM-INTERFACE-SW         PIC X.
   921             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   922             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   923             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   924         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   925
   926         16  CM-ENTRY-BATCH                PIC X(6).
   927         16  CM-LF-EXIT-BATCH              PIC X(6).
   928         16  CM-AH-EXIT-BATCH              PIC X(6).
   929         16  CM-LAST-MONTH-END             PIC XX.
   930
   931     12  CM-NOTE-SW                        PIC X.
   932         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   933         88  CERT-NOTES-PRESENT               VALUE '1'.
   934         88  BILLING-NOTES-PRESENT            VALUE '2'.
   935         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   936         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   937         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   938         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   939         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   940     12  CM-COMP-EXCP-SW                   PIC X.
   941         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  18
* EL055.cbl
   942         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   943     12  CM-INSURED-ADDRESS-SW             PIC X.
   944         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   945         88  INSURED-ADDR-PRESENT             VALUE '1'.
   946
   947*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   948     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   949     12  FILLER                            PIC X.
   950
   951*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   952     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   953     12  FILLER                            PIC X.
   954*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   955     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   956
   957     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   958         88  CERT-ADDED-BATCH                 VALUE ' '.
   959         88  CERT-ADDED-ONLINE                VALUE '1'.
   960         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   961         88  CERT-PURGED-OFFLINE              VALUE '3'.
   962         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   963     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   964         88  CERT-AS-LOADED                   VALUE ' '.
   965         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   966         88  CERT-CLAIM-ONLINE                VALUE '2'.
   967         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   968         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   969         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   970         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   971         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   972
   973     12  CM-ACCOUNT-COMM-PCTS.
   974         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   975         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   976
   977     12  CM-USER-FIELD                     PIC X.
   978     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   979     12  CM-CLP-STATE                      PIC XX.
   980     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   981     12  CM-USER-RESERVED                  PIC XXX.
   982     12  FILLER REDEFINES CM-USER-RESERVED.
   983         16  CM-AH-CLASS-CD                PIC XX.
   984         16  F                             PIC X.
   985******************************************************************
   986*                                copy ELCCRTO.
   987******************************************************************
   988*                                                                *
   989*                            ELCCRTO.                            *
   990*                                                                *
   991*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
   992*                                                                *
   993*   FILE TYPE = VSAM,KSDS                                        *
   994*   RECORD SIZE = 524  RECFORM = FIXED                           *
   995*                                                                *
   996*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
   997*                                                                *
   998*   LOG = YES                                                    *
   999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  19
* EL055.cbl
  1000******************************************************************
  1001*                   C H A N G E   L O G
  1002*
  1003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1004*-----------------------------------------------------------------
  1005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1006* EFFECTIVE    NUMBER
  1007*-----------------------------------------------------------------
  1008* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1009* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1010* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1011* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1012* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1013******************************************************************
  1014 01  ORIGINAL-CERTIFICATE.
  1015     12  OC-RECORD-ID                      PIC XX.
  1016         88  VALID-OC-ID                      VALUE 'OC'.
  1017     12  OC-CONTROL-PRIMARY.
  1018         16  OC-COMPANY-CD                 PIC X.
  1019         16  OC-CARRIER                    PIC X.
  1020         16  OC-GROUPING                   PIC X(6).
  1021         16  OC-STATE                      PIC XX.
  1022         16  OC-ACCOUNT                    PIC X(10).
  1023         16  OC-CERT-EFF-DT                PIC XX.
  1024         16  OC-CERT-NO.
  1025             20  OC-CERT-PRIME             PIC X(10).
  1026             20  OC-CERT-SFX               PIC X.
  1027         16  OC-RECORD-TYPE                PIC X.
  1028         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1029     12  OC-LAST-MAINT-DT                  PIC XX.
  1030     12  OC-LAST-MAINT-BY                  PIC X(4).
  1031     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1032     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1033     12  FILLER                            PIC X(49).
  1034     12  OC-ORIG-REC.
  1035         16  OC-INS-LAST-NAME              PIC X(15).
  1036         16  OC-INS-FIRST-NAME             PIC X(10).
  1037         16  OC-INS-MIDDLE-INIT            PIC X.
  1038         16  OC-INS-AGE                    PIC S999     COMP-3.
  1039         16  OC-JNT-LAST-NAME              PIC X(15).
  1040         16  OC-JNT-FIRST-NAME             PIC X(10).
  1041         16  OC-JNT-MIDDLE-INIT            PIC X.
  1042         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1043         16  OC-LF-BENCD                   PIC XX.
  1044         16  OC-LF-TERM                    PIC S999      COMP-3.
  1045         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1046         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1047         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1048         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1049         16  OC-LF-EXP-DT                  PIC XX.
  1050         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1051         16  OC-LF-CANCEL-DT               PIC XX.
  1052         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1053         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1054         16  OC-AH-BENCD                   PIC XX.
  1055         16  OC-AH-TERM                    PIC S999      COMP-3.
  1056         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1057         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  20
* EL055.cbl
  1058         16  OC-AH-EXP-DT                  PIC XX.
  1059         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1060         16  OC-AH-CP                      PIC 99.
  1061         16  OC-AH-CANCEL-DT               PIC XX.
  1062         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1063         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1064         16  OC-CRED-BENE-NAME             PIC X(25).
  1065         16  OC-1ST-PMT-DT                 PIC XX.
  1066         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1067         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1068         16  OC-ISSUE-TRAN-IND             PIC X.
  1069         16  OC-CANCEL-TRAN-IND            PIC X.
  1070         16  FILLER                        PIC X(211).
  1071
  1072     12  FILLER                            PIC X(50).
  1073******************************************************************
  1074*                                copy ELCCRTT.
  1075******************************************************************
  1076*                                                                *
  1077*                            ELCCRTT.                            *
  1078*                                                                *
  1079*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1080*                                                                *
  1081*   FILE TYPE = VSAM,KSDS                                        *
  1082*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1083*                                                                *
  1084*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1085*                                                                *
  1086*   LOG = YES                                                    *
  1087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1088******************************************************************
  1089*                   C H A N G E   L O G
  1090*
  1091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1092*-----------------------------------------------------------------
  1093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1094* EFFECTIVE    NUMBER
  1095*-----------------------------------------------------------------
  1096* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1097* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1098* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1099* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1100* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1101* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1102* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1103* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1104* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1105* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1106* 091318  CR2018073000001  PEMA  ADD Refund methods
  1107* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1108******************************************************************
  1109
  1110 01  CERTIFICATE-TRAILERS.
  1111     12  CS-RECORD-ID                      PIC XX.
  1112         88  VALID-CS-ID                      VALUE 'CS'.
  1113
  1114     12  CS-CONTROL-PRIMARY.
  1115         16  CS-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  21
* EL055.cbl
  1116         16  CS-CARRIER                    PIC X.
  1117         16  CS-GROUPING                   PIC X(6).
  1118         16  CS-STATE                      PIC XX.
  1119         16  CS-ACCOUNT                    PIC X(10).
  1120         16  CS-CERT-EFF-DT                PIC XX.
  1121         16  CS-CERT-NO.
  1122             20  CS-CERT-PRIME             PIC X(10).
  1123             20  CS-CERT-SFX               PIC X.
  1124         16  CS-TRAILER-TYPE               PIC X.
  1125             88  COMM-TRLR           VALUE 'A'.
  1126             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1127             88  CERT-DATA-TRLR      VALUE 'C'.
  1128
  1129     12  CS-DATA-AREA                      PIC X(516).
  1130
  1131     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1132         16  CS-BANK-COMMISSION-AREA.
  1133             20  CS-BANK-COMMS       OCCURS 10.
  1134                 24  CS-AGT                PIC X(10).
  1135                 24  CS-COM-TYP            PIC X.
  1136                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1137                 24  CS-RECALC-LV-INDIC    PIC X.
  1138                 24  FILLER                PIC X(10).
  1139         16  FILLER                        PIC X(256).
  1140
  1141     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1142****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1143         16  CS-MB-CLAIM-DATA OCCURS 24.
  1144             20  CS-CLAIM-NO               PIC X(7).
  1145             20  CS-CLAIM-TYPE             PIC X.
  1146                 88  CS-AH-CLM               VALUE 'A'.
  1147                 88  CS-IU-CLM               VALUE 'I'.
  1148                 88  CS-GP-CLM               VALUE 'G'.
  1149                 88  CS-LF-CLM               VALUE 'L'.
  1150                 88  CS-PR-CLM               VALUE 'P'.
  1151                 88  CS-FL-CLM               VALUE 'F'.
  1152                 88  CS-OT-CLM               VALUE 'O'.
  1153             20  CS-INSURED-TYPE           PIC X.
  1154                 88  CS-PRIM-INSURED          VALUE 'P'.
  1155                 88  CS-CO-BORROWER           VALUE 'C'.
  1156             20  CS-BENEFIT-PERIOD         PIC 99.
  1157             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1158             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1159             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1160         16  FILLER                        PIC X(12).
  1161     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1162         16  CS-VIN-NUMBER                 PIC X(17).
  1163         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1164         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1165         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1166         16  cs-agent-name.
  1167             20  cs-agent-fname            pic x(20).
  1168             20  cs-agent-mi               pic x.
  1169             20  cs-agent-lname            pic x(25).
  1170         16  cs-license-no                 pic x(15).
  1171         16  cs-npn-number                 pic x(10).
  1172         16  cs-agent-edit-status          pic x.
  1173             88  cs-ae-refer-to-manager      value 'M'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  22
* EL055.cbl
  1174             88  cs-ae-cover-sheet           value 'C'.
  1175             88  cs-ae-sig-form              value 'S'.
  1176             88  cs-ae-verified              value 'V'.
  1177             88  cs-unidentified-signature   value 'U'.
  1178             88  cs-cert-returned            value 'R'.
  1179             88  cs-accept-no-commission     value 'N'.
  1180         16  cs-year                       pic 9999.
  1181         16  cs-make                       pic x(20).
  1182         16  cs-model                      pic x(20).
  1183         16  cs-future                     pic x(20).
  1184         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1185         16  cs-claim-verification-status  pic x.
  1186             88  cs-clm-ver-eligible         value 'A'.
  1187             88  cs-clm-ver-partial-elig     value 'B'.
  1188             88  cs-clm-ver-not-eligible     value 'C'.
  1189             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1190             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1191             88  cs-clm-ver-ND-CERT          value 'F'.
  1192             88  cs-clm-ver-spec-other       value 'G'.
  1193             88  cs-clam-ver-pratial-corrected
  1194                                             value 'H'.
  1195             88  cs-clm-ver-no-matches       value 'I'.
  1196             88  cs-clm-ver-not-elig-corrected
  1197                                             value 'J'.
  1198             88  cs-clm-ver-needs-review     value 'R'.
  1199             88  cs-clm-ver-sent-to-claims   value 'W'.
  1200         16  CS-LF-REFUND-METHOD           PIC X.
  1201         16  CS-AH-REFUND-METHOD           PIC X.
  1202         16  FILLER                        PIC X(353). *> was 420
  1203*        16  FILLER                        PIC X(496).
  1204*                                copy ERCARCH.
  1205******************************************************************
  1206*                                                                *
  1207*                            ERCARCH.                            *
  1208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1209*                            VMOD=2.002                          *
  1210*                                                                *
  1211*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1212*                                                                *
  1213*   FILE TYPE = VSAM,KSDS                                        *
  1214*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1215*                                                                *
  1216*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1217*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1218*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1219*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1220*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1221*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1222*                                                                *
  1223*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1224******************************************************************
  1225*                   C H A N G E   L O G
  1226*
  1227* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1228*-----------------------------------------------------------------
  1229*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1230* EFFECTIVE    NUMBER
  1231*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  23
* EL055.cbl
  1232* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1233* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1234* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1235* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  1236******************************************************************
  1237 01  LETTER-ARCHIVE.
  1238     12  LA-RECORD-ID                PIC  X(02).
  1239         88  LA-VALID-ID                VALUE 'LA'.
  1240
  1241     12  LA-CONTROL-PRIMARY.
  1242         16  LA-COMPANY-CD           PIC  X(01).
  1243         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1244
  1245     12  LA-CONTROL-BY-CERT-RESP.
  1246         16  LA-COMPANY-CD-A2        PIC  X(01).
  1247         16  LA-CERT-NO-A2.
  1248             20  LA-CERT-PRIME-A2    PIC  X(10).
  1249             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1250         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1251             20  LA-RESP-PERSON-A2   PIC  X(10).
  1252             20  LA-TYPE-A2          PIC  X(01).
  1253         16  LA-CARRIER-A2           PIC  X(01).
  1254         16  LA-GROUPING-A2          PIC  X(06).
  1255         16  LA-STATE-A2             PIC  X(02).
  1256         16  LA-ACCOUNT-A2           PIC  X(10).
  1257         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1258         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1259
  1260     12  LA-CONTROL-BY-FORM.
  1261         16  LA-COMPANY-CD-A3        PIC  X(01).
  1262         16  LA-FORM-A3              PIC  X(04).
  1263         16  LA-CARRIER-A3           PIC  X(01).
  1264         16  LA-GROUPING-A3          PIC  X(06).
  1265         16  LA-STATE-A3             PIC  X(02).
  1266         16  LA-ACCOUNT-A3           PIC  X(10).
  1267         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1268
  1269     12  LA-CONTROL-BY-PROCESSOR.
  1270         16  LA-COMPANY-CD-A4        PIC  X(01).
  1271         16  LA-PROCESSOR-CD         PIC  X(04).
  1272         16  LA-CARRIER-A4           PIC  X(01).
  1273         16  LA-GROUPING-A4          PIC  X(06).
  1274         16  LA-STATE-A4             PIC  X(02).
  1275         16  LA-ACCOUNT-A4           PIC  X(10).
  1276         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1277
  1278     12  LA-CONTROL-BY-KEY-FIELDS.
  1279         16  LA-COMPANY-CD-A5        PIC  X(01).
  1280         16  LA-CARRIER-A5           PIC  X(01).
  1281         16  LA-GROUPING-A5          PIC  X(06).
  1282         16  LA-STATE-A5             PIC  X(02).
  1283         16  LA-ACCOUNT-A5           PIC  X(10).
  1284         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1285
  1286     12  LA-CONTROL-BY-GROUP-CODE.
  1287         16  LA-COMPANY-CD-A6        PIC  X(01).
  1288         16  LA-ENTRY-A6.
  1289             20  LA-FILLER           PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  24
* EL055.cbl
  1290             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1291         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1292
  1293     12  FILLER                      PIC  X(09).
  1294
  1295     12  LA-HEADER-RECORD.
  1296         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1297         16  LA-CREATION-DATE        PIC  X(02).
  1298         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1299         16  LA-FINAL-ACT-DATE       REDEFINES
  1300               LA-FOLLOW-UP-DATE     PIC  X(02).
  1301         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1302         16  LA-NO-OF-COPIES         PIC S9(01).
  1303         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1304         16  LA-REPLY-DATE           PIC  X(02).
  1305         16  LA-RESEND-DATES.
  1306             20  LA-RESEND-DATE      PIC  X(02).
  1307             20  LA-SENT-DATE        PIC  X(02).
  1308             20  FILLER              PIC  X(08).
  1309         16  LA-SOURCE-INFORMATION.
  1310             20  LA-DATA-SOURCE      PIC  X(01).
  1311             20  LA-ADDR-SOURCE      PIC  X(01).
  1312         16  LA-STATUS               PIC  X(01).
  1313             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1314             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1315             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1316             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1317             88  LA-STATUS-PURGED         VALUE 'P'.
  1318             88  LA-STATUS-VOIDED         VALUE 'V'.
  1319         16  LA-LAST-RESENT-PRINT-DATE
  1320                                     PIC  X(02).
  1321         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1322             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1323                                          VALUE 'C'.
  1324             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1325                                          VALUE 'F'.
  1326             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1327                                          VALUE 'P'.
  1328         16  LA-PURGED-DATE          PIC  X(02).
  1329         16  LA-VOIDED-DATE          PIC  X(02).
  1330         16  LA-RESEND-LETR          PIC  X(4).
  1331         16  LA-VOID-ONBASE-YN       PIC  X.
  1332         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  1333         16  FILLER                  PIC  X(04).
  1334*        16  LA-RESEND-LETR-2        PIC  X(4).
  1335*        16  LA-RESEND-LETR-3        PIC  X(4).
  1336*        16  FILLER                  PIC  X(59).
  1337         16  LA-ARCHIVE-STATUS       PIC  X.
  1338             88  LA-TEMP                VALUE 'T'.
  1339             88  LA-QWS                 VALUE 'Q'.
  1340             88  LA-BATCH               VALUE 'B'.
  1341         16  LA-FINAL-ACT-IND        PIC  X(1).
  1342         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1343         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1344         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1345                                     PIC X(4).
  1346         16  FILLER                  PIC  X(42).
  1347*        16  FILLER                  PIC  X(71).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  25
* EL055.cbl
  1348         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1349         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1350         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1351                                     PIC  X(4).
  1352         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1353
  1354******************************************************************
  1355*                                copy NSCASEXTR.
  1356******************************************************************
  1357*                                                                *
  1358*                                                                *
  1359*                            NSCASEXTR.                          *
  1360*                            VMOD=2.001                          *
  1361*                                                                *
  1362*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  1363*                                                                *
  1364*   FILE TYPE = VSAM,KSDS                                        *
  1365*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  1366*                                                                *
  1367*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  1368*                                                                *
  1369*   LOG = NO                                                     *
  1370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1371******************************************************************
  1372*-----------------------------------------------------------------
  1373*                   C H A N G E   L O G
  1374*
  1375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1376*-----------------------------------------------------------------
  1377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1378* EFFECTIVE    NUMBER
  1379*-----------------------------------------------------------------
  1380* 072211    2011022800001  PEMA  NEW FILE
  1381*-----------------------------------------------------------------
  1382 01 NSAS-EXTRACT-RECORD.
  1383    05  NSAS-CONTROL-PRIMARY.
  1384        10  NSAS-COMPANY-CD      PIC X.
  1385        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  1386        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  1387    05  NSAS-LETTER-VARIABLES    PIC X(4350).
  1388    05  FILLER                   PIC X(143).
  1389*                                copy ERCCHEK.
  1390******************************************************************
  1391*                                                                *
  1392*                                                                *
  1393*                            ERCCHEK                             *
  1394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1395*                            VMOD=2.008                          *
  1396*                                                                *
  1397*   FILE DESCRIPTION = CHECK RECORDS                             *
  1398*                                                                *
  1399*   FILE TYPE = VSAM,KSDS                                        *
  1400*   RECORD SIZE = 600    RECFORM = FIXED                         *
  1401*                                                                *
  1402*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  1403*       ALTERNATE INDEX = NONE                                   *
  1404*                                                                *
  1405*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  26
* EL055.cbl
  1406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1407******************************************************************
  1408*                   C H A N G E   L O G
  1409*
  1410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1411*-----------------------------------------------------------------
  1412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1413* EFFECTIVE    NUMBER
  1414*-----------------------------------------------------------------
  1415* 021414    2003053000001  PEMA  changes for auto chk request
  1416******************************************************************
  1417 01  CHECK-RECORDS.
  1418     12  CH-RECORD-ID                      PIC XX.
  1419         88  VALID-CH-ID                      VALUE 'CH'.
  1420
  1421     12  CH-CONTROL-PRIMARY.
  1422         16  CH-COMPANY-CD                 PIC X.
  1423         16  CH-CARRIER                    PIC X.
  1424         16  CH-GROUPING                   PIC X(6).
  1425         16  CH-STATE                      PIC XX.
  1426         16  CH-ACCOUNT                    PIC X(10).
  1427         16  CH-CERT-EFF-DT                PIC XX.
  1428         16  CH-CERT-NO.
  1429             20  CH-CERT-PRIME             PIC X(10).
  1430             20  CH-CERT-SFX               PIC X.
  1431         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  1432
  1433     12  CH-RECORDED-DT                    PIC XX.
  1434     12  CH-RECORDED-BY                    PIC X(4).
  1435     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1436
  1437     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  1438     12  CH-CHECK-NO                       PIC X(7).
  1439     12  CH-REASON-FOR-CHECK               PIC X(25).
  1440     12  CH-CHECK-WRITTEN-DT               PIC XX.
  1441     12  FILLER                            PIC X.
  1442
  1443     12  CH-PAYEE-INFO.
  1444         16  CH-PAYEE-NAME-1               PIC X(30).
  1445         16  CH-PAYEE-NAME-2               PIC X(30).
  1446         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  1447         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  1448         16  CH-PAYEE-CITY-ST.
  1449             20  CH-PAYEE-CITY             PIC X(28).
  1450             20  CH-PAYEE-STATE            PIC XX.
  1451         16  CH-PAYEE-ZIP-CODE.
  1452             20  CH-PAYEE-ZIP.
  1453                 24  CH-ZIP-PRI-1ST        PIC X.
  1454                     88  CH-CANADIAN-POST-CODE
  1455                                           VALUES 'A' THRU 'Z'.
  1456                 24  FILLER                PIC X(4).
  1457             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  1458         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  1459             20  CH-CAN-POSTAL-1           PIC XXX.
  1460             20  CH-CAN-POSTAL-2           PIC XXX.
  1461             20  FILLER                    PIC XXX.
  1462
  1463     12  CH-CHECK-STUB-TEXT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  27
* EL055.cbl
  1464         16  CH-STUB-LINE-1                PIC X(30).
  1465         16  CH-TEXT-LINE-1                PIC X(50).
  1466         16  CH-TEXT-LINE-2                PIC X(50).
  1467         16  CH-TEXT-LINE-3                PIC X(40).
  1468     12  CH-RETURN-TO                      PIC X(30).
  1469
  1470     12  CH-COMPENSATION-CONTROL.
  1471         16  CH-COMP-CARRIER               PIC X.
  1472         16  CH-COMP-GROUPING              PIC X(6).
  1473         16  CH-COMP-FIN-RESP              PIC X(10).
  1474         16  CH-COMP-ACCOUNT               PIC X(10).
  1475
  1476     12  CH-CREDIT-SELECT-DT               PIC XX.
  1477     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  1478     12  CH-PAYEE-CODE                     PIC X(6).
  1479
  1480     12  CH-VOID-DATA.
  1481         20  CH-VOID-DT                    PIC XX.
  1482         20  CH-VOID-BY                    PIC X(4).
  1483         20  CH-VOID-REASON                PIC X(25).
  1484
  1485     12  CH-APPROVAL-DATA.
  1486         20  CH-APPROVAL-DT                PIC XX.
  1487         20  CH-APPROVAL-STATUS            PIC X.
  1488             88  CH-IN-LIMBO                  VALUE ' '.
  1489             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  1490             88  CH-APPROVED                  VALUE 'A'.
  1491             88  CH-DENIED                    VALUE 'D'.
  1492         20  CH-APPROVED-BY                PIC XXXX.
  1493     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  1494             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1495     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  1496
  1497     12  ch-released-dt                    pic xx.
  1498     12  ch-check-cashed-dt                pic xx.
  1499     12  FILLER                            PIC X.
  1500*    12  CH-CHECK-REFERENCE                PIC X(12).
  1501     12  CH-CHECK-ORIGIN-SW                PIC X.
  1502             88  CH-REFUND-CHECK              VALUE 'R'.
  1503             88  CH-MAINT-CHECK               VALUE 'M'.
  1504
  1505     12  CH-CANC-DT                        PIC XX.
  1506     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  1507     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  1508
  1509     12  CH-INSURED-NAME                   PIC X(28).
  1510
  1511     12  ch-released-by                    pic x(4).
  1512     12  ch-csr                            pic x(4).
  1513     12  ch-deduct-commission              pic x.
  1514         88  ch-deduct-comm                  value 'Y'.
  1515         88  ch-do-not-deduct-comm           value 'N'.
  1516
  1517     12  FILLER                            PIC X(11).
  1518*    12  CH-LETTER-TABLE.
  1519*        16  CH-LETTERS OCCURS 3 TIMES
  1520*                       INDEXED BY CH-LT-NDX
  1521*                                          PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  28
* EL055.cbl
  1522
  1523     12  FILLER                            PIC X(07).
  1524
  1525*                                copy ERCCNOT.
  1526******************************************************************
  1527*                                                                *
  1528*                            ERCCNOT                             *
  1529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1530*                            VMOD=2.003                          *
  1531*                                                                *
  1532*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1533*                                                                *
  1534*        FILE TYPE= VSAM,KSDS                                    *
  1535*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1536*                                                                *
  1537*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1538*                                                                *
  1539*        LOG = YES                                               *
  1540*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1541*                                                                *
  1542******************************************************************
  1543*                   C H A N G E   L O G
  1544*
  1545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1546*-----------------------------------------------------------------
  1547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1548* EFFECTIVE    NUMBER
  1549*-----------------------------------------------------------------
  1550* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1551******************************************************************
  1552
  1553 01  CERT-NOTE-FILE.
  1554     12  CZ-RECORD-ID                PIC  XX.
  1555         88  VALID-CZ-ID                  VALUE 'CZ'.
  1556
  1557     12  CZ-CONTROL-PRIMARY.
  1558         16  CZ-COMPANY-CD           PIC X.
  1559         16  CZ-CARRIER              PIC X.
  1560         16  CZ-GROUPING.
  1561             20 CZ-GROUPING-PREFIX   PIC XXX.
  1562             20 CZ-GROUPING-PRIME    PIC XXX.
  1563         16  CZ-STATE                PIC XX.
  1564         16  CZ-ACCOUNT.
  1565             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1566             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1567         16  CZ-CERT-EFF-DT          PIC XX.
  1568         16  CZ-CERT-NO.
  1569             20  CZ-CERT-PRIME       PIC X(10).
  1570             20  CZ-CERT-SFX         PIC X.
  1571         16  CZ-RECORD-TYPE          PIC X.
  1572             88  CERT-NOTE           VALUE '1'.
  1573             88  CLAIM-CERT-NOTE     VALUE '2'.
  1574         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1575
  1576     12  CZ-LAST-MAINT-DT            PIC XX.
  1577     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1578     12  CZ-LAST-MAINT-USER          PIC X(4).
  1579
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  29
* EL055.cbl
  1580     12  CZ-NOTE-INFORMATION.
  1581         16  CZ-NOTE                 PIC X(63).
  1582         16  FILLER                  PIC X(39).
  1583******************************************************************
  1584*                                copy ERCNOTE.
  1585******************************************************************
  1586*                                                                *
  1587*                                                                *
  1588*                            ERCNOTE                             *
  1589*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1590*                            VMOD=2.003                          *
  1591*                                                                *
  1592*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1593*                                                                *
  1594*        FILE TYPE= VSAM,KSDS                                    *
  1595*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1596*                                                                *
  1597*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  1598*                                                                *
  1599*        LOG = YES                                               *
  1600*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1601*                                                                *
  1602******************************************************************
  1603*                   C H A N G E   L O G
  1604*
  1605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1606*-----------------------------------------------------------------
  1607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1608* EFFECTIVE    NUMBER
  1609*-----------------------------------------------------------------
  1610* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1611*                                FILE WILL CONTAIN BILLING NOTES O
  1612******************************************************************
  1613
  1614 01  CERTIFICATE-NOTE.
  1615     12  CN-RECORD-ID                PIC  XX.
  1616         88  VALID-CN-ID                  VALUE 'CN'.
  1617
  1618     12  CN-CONTROL-PRIMARY.
  1619         16  CN-COMPANY-CD           PIC X.
  1620         16  CN-CARRIER              PIC X.
  1621         16  CN-GROUPING.
  1622             20 CN-GROUPING-PREFIX   PIC XXX.
  1623             20 CN-GROUPING-PRIME    PIC XXX.
  1624         16  CN-STATE                PIC XX.
  1625         16  CN-ACCOUNT.
  1626             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1627             20 CN-ACCOUNT-PRIME     PIC X(6).
  1628         16  CN-CERT-EFF-DT          PIC XX.
  1629         16  CN-CERT-NO.
  1630             20  CN-CERT-PRIME       PIC X(10).
  1631             20  CN-CERT-SFX         PIC X.
  1632
  1633     12  CN-BILLING-START-LINE-NO    PIC 99.
  1634     12  CN-BILLING-END-LINE-NO      PIC 99.
  1635
  1636     12  CN-LINES.
  1637         16  CN-LINE OCCURS 10       PIC X(77).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  30
* EL055.cbl
  1638
  1639     12  CN-LAST-MAINT-DT            PIC XX.
  1640     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1641     12  CN-LAST-MAINT-USER          PIC X(4).
  1642     12  FILLER                      PIC X(6).
  1643******************************************************************
  1644*                                copy ERCMAIL.
  1645******************************************************************
  1646*                                                                *
  1647*                                                                *
  1648*                            ERCMAIL                             *
  1649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1650*                            VMOD=2.003                          *
  1651*                                                                *
  1652*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1653*                                                                *
  1654*   FILE TYPE = VSAM,KSDS                                        *
  1655*   RECORD SIZE = 374   RECFORM = FIX                            *
  1656*                                                                *
  1657*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1658*   ALTERNATE PATH    = NOT USED                                 *
  1659*                                                                *
  1660*   LOG = YES                                                    *
  1661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1662******************************************************************
  1663*                   C H A N G E   L O G
  1664*
  1665* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1666*-----------------------------------------------------------------
  1667*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1668* EFFECTIVE    NUMBER
  1669*-----------------------------------------------------------------
  1670* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1671* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1672* 111108                   PEMA  ADD CRED BENE ADDR2
  1673******************************************************************
  1674
  1675 01  MAILING-DATA.
  1676     12  MA-RECORD-ID                      PIC XX.
  1677         88  VALID-MA-ID                       VALUE 'MA'.
  1678
  1679     12  MA-CONTROL-PRIMARY.
  1680         16  MA-COMPANY-CD                 PIC X.
  1681         16  MA-CARRIER                    PIC X.
  1682         16  MA-GROUPING.
  1683             20  MA-GROUPING-PREFIX        PIC XXX.
  1684             20  MA-GROUPING-PRIME         PIC XXX.
  1685         16  MA-STATE                      PIC XX.
  1686         16  MA-ACCOUNT.
  1687             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1688             20  MA-ACCOUNT-PRIME          PIC X(6).
  1689         16  MA-CERT-EFF-DT                PIC XX.
  1690         16  MA-CERT-NO.
  1691             20  MA-CERT-PRIME             PIC X(10).
  1692             20  MA-CERT-SFX               PIC X.
  1693
  1694     12  FILLER                            PIC XX.
  1695
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  31
* EL055.cbl
  1696     12  MA-ACCESS-CONTROL.
  1697         16  MA-SOURCE-SYSTEM              PIC XX.
  1698             88  MA-FROM-CREDIT                VALUE 'CR'.
  1699             88  MA-FROM-VSI                   VALUE 'VS'.
  1700             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1701             88  MA-FROM-OTHER                 VALUE 'OT'.
  1702         16  MA-RECORD-ADD-DT              PIC XX.
  1703         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1704         16  MA-LAST-MAINT-DT              PIC XX.
  1705         16  MA-LAST-MAINT-BY              PIC XXXX.
  1706         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1707
  1708     12  MA-PROFILE-INFO.
  1709         16  MA-QUALIFY-CODE-1             PIC XX.
  1710         16  MA-QUALIFY-CODE-2             PIC XX.
  1711         16  MA-QUALIFY-CODE-3             PIC XX.
  1712         16  MA-QUALIFY-CODE-4             PIC XX.
  1713         16  MA-QUALIFY-CODE-5             PIC XX.
  1714
  1715         16  MA-INSURED-LAST-NAME          PIC X(15).
  1716         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1717         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1718         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1719         16  MA-INSURED-BIRTH-DT           PIC XX.
  1720         16  MA-INSURED-SEX                PIC X.
  1721             88  MA-SEX-MALE                   VALUE 'M'.
  1722             88  MA-SEX-FEMALE                 VALUE 'F'.
  1723         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1724
  1725         16  MA-ADDRESS-CORRECTED          PIC X.
  1726         16  MA-JOINT-BIRTH-DT             PIC XX.
  1727*        16  FILLER                        PIC X(12).
  1728
  1729         16  MA-ADDRESS-LINE-1             PIC X(30).
  1730         16  MA-ADDRESS-LINE-2             PIC X(30).
  1731         16  MA-CITY-STATE.
  1732             20  MA-CITY                   PIC X(28).
  1733             20  MA-ADDR-STATE             PIC XX.
  1734         16  MA-ZIP.
  1735             20  MA-ZIP-CODE.
  1736                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1737                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1738                 24  FILLER                PIC X(4).
  1739             20  MA-ZIP-PLUS4              PIC X(4).
  1740         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1741             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1742             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1743             20  FILLER                    PIC X(3).
  1744
  1745         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1746
  1747         16  FILLER                        PIC XXX.
  1748*        16  FILLER                        PIC X(10).
  1749
  1750     12  MA-CRED-BENE-INFO.
  1751         16  MA-CRED-BENE-NAME                 PIC X(25).
  1752         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1753         16  MA-CRED-BENE-ADDR2                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  32
* EL055.cbl
  1754         16  MA-CRED-BENE-CTYST.
  1755             20  MA-CRED-BENE-CITY             PIC X(28).
  1756             20  MA-CRED-BENE-STATE            PIC XX.
  1757         16  MA-CRED-BENE-ZIP.
  1758             20  MA-CB-ZIP-CODE.
  1759                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1760                     88  MA-CB-CANADIAN-POST-CODE
  1761                                           VALUE 'A' THRU 'Z'.
  1762                 24  FILLER                    PIC X(4).
  1763             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1764         16  MA-CB-CANADIAN-POSTAL-CODE
  1765                            REDEFINES MA-CRED-BENE-ZIP.
  1766             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1767             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1768             20  FILLER                        PIC X(3).
  1769     12  MA-POST-CARD-MAIL-DATA.
  1770         16  MA-MAIL-DATA OCCURS 7.
  1771             20  MA-MAIL-TYPE              PIC X.
  1772                 88  MA-12MO-MAILING           VALUE '1'.
  1773                 88  MA-EXP-MAILING            VALUE '2'.
  1774             20  MA-MAIL-STATUS            PIC X.
  1775                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1776                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1777                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1778             20  MA-MAIL-DATE              PIC XX.
  1779     12  FILLER                            PIC XX.
  1780     12  FILLER                            PIC XX.
  1781*    12  FILLER                            PIC X(30).
  1782******************************************************************
  1783*                                copy ERCENDR.
  1784******************************************************************
  1785*                                                                *
  1786*                                                                *
  1787*                            ERCENDR.                            *
  1788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1789*                            VMOD=2.001                          *
  1790*                                                                *
  1791*   FILE DESCRIPTION = ENDORSEMENT SUMMARY BY ACCOUNT            *
  1792*                                                                *
  1793*                                                                *
  1794*                                                                *
  1795*   FILE TYPE = VSAM,KSDS                                        *
  1796*   RECORD SIZE = 513  RECFORM = FIXED                           *
  1797*                                                                *
  1798*   BASE CLUSTER = ERENDR                         RKP=2,LEN=36   *
  1799*                                                                *
  1800*   LOG = NO                                                     *
  1801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1802******************************************************************
  1803*-----------------------------------------------------------------
  1804*                   C H A N G E   L O G
  1805*
  1806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1807*-----------------------------------------------------------------
  1808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1809* EFFECTIVE    NUMBER
  1810*-----------------------------------------------------------------
  1811* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  33
* EL055.cbl
  1812*                                WITH OPEN CLAIMS
  1813*-----------------------------------------------------------------
  1814 01  ENDORSEMENT-RECORD.
  1815     12  EN-RECORD-ID            PIC XX.
  1816         88  VALID-EN-ID             VALUE 'EN'.
  1817     12  EN-CONTROL-PRIMARY.
  1818         16  EN-COMPANY-CD       PIC X.
  1819         16  EN-CARRIER          PIC X.
  1820         16  EN-GROUPING         PIC X(6).
  1821         16  EN-STATE            PIC XX.
  1822         16  EN-ACCOUNT          PIC X(10).
  1823         16  EN-CERT-EFF-DT      PIC XX.
  1824         16  EN-CERT-NO.
  1825             20  EN-CERT-PRIME   PIC X(10).
  1826             20  EN-CERT-SFX     PIC X.
  1827         16  EN-SEQ-NO           PIC S9(04) COMP.
  1828         16  EN-REC-TYPE         PIC X.
  1829             88  EN-ISSUE             VALUE '1'.
  1830             88  EN-CANCELLATION      VALUE '2'.
  1831     12  EN-LAST-MAINT-DT        PIC XX.
  1832     12  EN-LAST-MAINT-BY        PIC X(4).
  1833     12  EN-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1834     12  EN-LAST-NAME            PIC X(15).
  1835     12  EN-FIRST-NAME           PIC X(10).
  1836     12  EN-MIDDLE-INIT          PIC X.
  1837     12  EN-JOINT-LAST-NAME      PIC X(15).
  1838     12  EN-JOINT-FIRST-NAME     PIC X(10).
  1839     12  EN-JOINT-MIDDLE-INIT    PIC X.
  1840     12  EN-LF-TERM              PIC S999      COMP-3.
  1841     12  EN-AH-TERM              PIC S999      COMP-3.
  1842     12  EN-LF-BEN-ENT-AMT       PIC S9(9)V99  COMP-3.
  1843     12  EN-AH-BEN-ENT-AMT       PIC S9(7)V99  COMP-3.
  1844     12  EN-LF-BEN-CAL-AMT       PIC S9(9)V99  COMP-3.
  1845     12  EN-AH-BEN-CAL-AMT       PIC S9(7)V99  COMP-3.
  1846     12  EN-LF-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1847     12  EN-AH-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1848     12  EN-LF-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1849     12  EN-AH-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1850     12  EN-LF-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1851     12  EN-AH-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1852     12  EN-LF-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1853     12  EN-AH-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1854     12  EN-LF-CANC-DT           PIC XX.
  1855     12  EN-AH-CANC-DT           PIC XX.
  1856     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1857     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1858     12  EN-LF-BEN-CD            PIC XX.
  1859     12  EN-AH-BEN-CD            PIC XX.
  1860*           12  FILLER                  PIC X(18).
  1861     12  FILLER                  PIC X(17).
  1862     12  EN-FLAG-CERT            PIC X.
  1863     12  EN-INPUT-DT             PIC XX.
  1864     12  EN-PRINT-DT             PIC XX.
  1865     12  EN-SIG-SW               PIC X.
  1866     12  EN-COMMENTS1            PIC X(70).
  1867     12  EN-COMMENTS2            PIC X(70).
  1868     12  EN-COMMENTS3            PIC X(70).
  1869     12  EN-COMMENTS4            PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  34
* EL055.cbl
  1870     12  FILLER                  PIC X(30).
  1871******************************************************************
  1872*                                copy ERCENDT replacing
  1873*          ENDORSEMENT-RECORD by ENDT-RECORD
  1874*          LEADING ==EN-== BY ==ET-==.
  1875******************************************************************
  1876*                                                                *
  1877*                                                                *
  1878*                            ERCENDT.                            *
  1879*                            VMOD=2.001                          *
  1880*                                                                *
  1881*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1882*                                                                *
  1883*   FILE TYPE = VSAM,KSDS                                        *
  1884*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1885*                                                                *
  1886*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1887*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1888*                                                                *
  1889*   LOG = NO                                                     *
  1890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1891******************************************************************
  1892*-----------------------------------------------------------------
  1893*                   C H A N G E   L O G
  1894*
  1895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1896*-----------------------------------------------------------------
  1897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1898* EFFECTIVE    NUMBER
  1899*-----------------------------------------------------------------
  1900* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1901*                                WITH OPEN CLAIMS
  1902* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1903* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1904* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1905* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1906*-----------------------------------------------------------------
  1907 01  ENDT-RECORD.
  1908     12  ET-RECORD-ID                PIC XX.
  1909         88  VALID-EN-ID                VALUE 'EN'.
  1910     12  ET-CONTROL-PRIMARY.
  1911         16  ET-COMPANY-CD           PIC X.
  1912         16  ET-CARRIER              PIC X.
  1913         16  ET-GROUPING             PIC X(6).
  1914         16  ET-STATE                PIC XX.
  1915         16  ET-ACCOUNT              PIC X(10).
  1916         16  ET-CERT-EFF-DT          PIC XX.
  1917         16  ET-CERT-NO.
  1918             20  ET-CERT-PRIME       PIC X(10).
  1919             20  ET-CERT-SFX         PIC X.
  1920         16  ET-REC-TYPE             PIC X.
  1921             88  ET-ISSUE               VALUE 'I'.
  1922             88  ET-CANCELLATION        VALUE 'C'.
  1923         16  ET-SEQ-NO               PIC 9(04) BINARY.
  1924     12  ET-CONTROL-BY-ARCH-NO.
  1925         16  ET-COMPANY-CD-A1              PIC X.
  1926         16  ET-ARCHIVE-NO                 PIC 9(8) BINARY.
  1927     12  ET-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  35
* EL055.cbl
  1928     12  ET-LAST-MAINT-BY            PIC X(4).
  1929     12  ET-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1930     12  ET-ENDORSEMENT-RECORD       PIC X(329).
  1931     12  ET-ISSUE-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  1932         16  ET-INS-ORIG-LAST-NAME   PIC X(15).
  1933         16  ET-INS-ORIG-FIRST-NAME  PIC X(10).
  1934         16  ET-INS-ORIG-MIDDLE-INIT PIC X.
  1935         16  ET-INS-ORIG-AGE         PIC S999     COMP-3.
  1936         16  ET-JNT-ORIG-LAST-NAME   PIC X(15).
  1937         16  ET-JNT-ORIG-FIRST-NAME  PIC X(10).
  1938         16  ET-JNT-ORIG-MIDDLE-INIT PIC X.
  1939         16  ET-JNT-ORIG-AGE         PIC S999     COMP-3.
  1940         16  ET-LF-ORIG-BENCD        PIC XX.
  1941         16  ET-LF-ORIG-TERM         PIC S999      COMP-3.
  1942         16  ET-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1943         16  ET-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1944         16  ET-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1945         16  ET-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1946         16  ET-LF-ORIG-EXP-DT       PIC XX.
  1947*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1948         16  ET-ORIG-CRED-BENE       PIC X(25).
  1949         16  ET-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1950         16  FILLER                  PIC X.
  1951         16  ET-AH-ORIG-BENCD        PIC XX.
  1952         16  ET-AH-ORIG-TERM         PIC S999      COMP-3.
  1953         16  ET-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1954         16  ET-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1955         16  ET-AH-ORIG-EXP-DT       PIC XX.
  1956*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1957*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1958         16  ET-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1959         16  F                       PIC X(09).
  1960         16  ET-AH-ORIG-CP           PIC 99.
  1961         16  ET-INS-NEW-LAST-NAME    PIC X(15).
  1962         16  ET-INS-NEW-FIRST-NAME   PIC X(10).
  1963         16  ET-INS-NEW-MIDDLE-INIT  PIC X.
  1964         16  ET-INS-NEW-AGE          PIC S999     COMP-3.
  1965         16  ET-JNT-NEW-LAST-NAME    PIC X(15).
  1966         16  ET-JNT-NEW-FIRST-NAME   PIC X(10).
  1967         16  ET-JNT-NEW-MIDDLE-INIT  PIC X.
  1968         16  ET-JNT-NEW-AGE          PIC S999     COMP-3.
  1969         16  ET-LF-NEW-BENCD         PIC XX.
  1970         16  ET-LF-NEW-TERM          PIC S999      COMP-3.
  1971         16  ET-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1972         16  ET-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1973         16  ET-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1974         16  ET-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1975         16  ET-LF-NEW-EXP-DT        PIC XX.
  1976         16  ET-NEW-CRED-BENE        PIC X(25).
  1977         16  ET-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1978         16  FILLER                  PIC X.
  1979         16  ET-AH-NEW-BENCD         PIC XX.
  1980         16  ET-AH-NEW-TERM          PIC S999      COMP-3.
  1981         16  ET-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1982         16  ET-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1983         16  ET-AH-NEW-EXP-DT        PIC XX.
  1984*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1985*        16  EN-AH-NEW-WAIT-PER      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  36
* EL055.cbl
  1986*        16  F                       PIC X(12).
  1987         16  ET-AH-NEW-CP            PIC 99.
  1988         16  ET-SIG-SW               PIC X.
  1989         16  ET-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1990         16  ET-INS-ORIG-AGE-DEF-FLAG PIC X.
  1991         16  ET-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1992         16  ET-INS-NEW-AGE-DEF-FLAG PIC X.
  1993         16  ET-JNT-NEW-AGE-DEF-FLAG PIC X.
  1994         16  FILLER                  PIC X(33).
  1995     12  ET-CANCEL-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  1996         16  ET-LF-ORIG-REF-DT       PIC XX.
  1997         16  ET-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1998         16  ET-AH-ORIG-REF-DT       PIC XX.
  1999         16  ET-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  2000         16  ET-LF-NEW-REF-DT        PIC XX.
  2001         16  ET-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2002         16  ET-AH-NEW-REF-DT        PIC XX.
  2003         16  ET-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2004         16  ET-FLAG-CERT            PIC X.
  2005         16  ET-INS-LAST-NAME        PIC X(15).
  2006         16  ET-INS-FIRST-NAME       PIC X(10).
  2007         16  ET-INS-MIDDLE-INIT      PIC X.
  2008         16  ET-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2009         16  ET-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2010         16  ET-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2011         16  ET-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2012         16  FILLER                  PIC X(262).
  2013     12  ET-MONEY-SW             PIC X.
  2014     12  ET-HEALTH-APP           PIC X.
  2015     12  ET-VOUCHER-SW           PIC X.
  2016     12  ET-PAYEE                PIC X(14).
  2017     12  ET-INPUT-DT             PIC XX.
  2018     12  ET-PROCESS-DT           PIC XX.
  2019     12  ET-LF-COMMISSION        PIC SV9(5)    COMP-3.
  2020     12  ET-AH-COMMISSION        PIC SV9(5)    COMP-3.
  2021     12  ET-REASON-CODES.
  2022         16  F OCCURS 12.
  2023             20  ET-REASON-CODE  PIC X(4).
  2024     12  ET-TEMPLATE-USED        PIC X(8).
  2025     12  ET-DOCU-TYPE            PIC X.
  2026         88  ET-VERI-DOCU          VALUE 'V'.
  2027         88  ET-GCE-DOCU           VALUE 'G'.
  2028         88  ET-CANC-DOCU          VALUE 'C'.
  2029     12  ET-COMMENTS1            PIC X(13).
  2030     12  ET-COMMENTS2            PIC X(70).
  2031     12  ET-COMM-CHGBK           PIC X.
  2032         88  ET-DO-NOT-CHG-ACCT    VALUE 'N'.
  2033         88  ET-CHG-ACCT           VALUE 'Y'.
  2034     12  ET-CSO-PORTION          PIC S9(5)V99  COMP-3.
  2035     12  ET-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  2036     12  ET-BATCH-NUMBER         PIC X(6).
  2037     12  ET-ACCT-SUMM            PIC X.
  2038     12  ET-CSO-SUMM             PIC X.
  2039     12  en-check-type           pic x.
  2040     12  FILLER                  PIC X(12).
  2041******************************************************************
  2042 01  ws-dummy-area               pic x(1000).
  2043 01  ws-misc.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  37
* EL055.cbl
  2044     05  ws-old-pndb-key.
  2045         10  opk-company-cd      pic x.
  2046         10  opk-carrier         pic x.
  2047         10  opk-group           pic x(6).
  2048         10  opk-state           pic xx.
  2049         10  opk-account         pic x(10).
  2050         10  opk-eff-dt          pic xx.
  2051         10  opk-cert-no         pic x(11).
  2052         10  opk-seq-no          pic xx.
  2053         10  opk-rec-type        pic x.
  2054 01  ws-disp-code                pic s9(11).
  2055 01  WS-RESPONSE2                PIC S9(8) COMP VALUE +0.
  2056 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
  2057     88  RESP-NORMAL                    VALUE +0.
  2058     88  resp-file-notfnd               value +12.
  2059     88  RESP-NOTFND                    VALUE +13.
  2060     88  resp-duprec                    value +14.
  2061     88  resp-dupkey                    value +15.
  2062     88  resp-invreq                    value +16.
  2063     88  RESP-NOTOPEN                   VALUE +19.
  2064     88  RESP-ENDFILE                   VALUE +20.
  2065     88  resp-lengtherr                 value +22.
  2066 01  erpndb-ridfld               pic x(11).
  2067 01  erpndb2-ridfld              pic x(36).
  2068 01  elcert-ridfld               pic x(33).
  2069 01  elcrto-ridfld.
  2070     05  filler                  pic x(33).
  2071     05  elcrto-rec-type         pic x.
  2072     05  elcrto-seq-no           pic s9(4) comp.
  2073 01  nsasextr-ridfld.
  2074     05  filler                  pic x(5).
  2075     05  nsasextr-seq-no         pic s9(4) comp.
  2076 01  elcrtt-ridfld.
  2077     05  filler                  pic x(33).
  2078     05  elcrtt-rec-type         pic x.
  2079 01  erarch-ridfld               pic x(5).
  2080 01  erarch2-ridfld.  *>  pic x(37).
  2081     05  erarch2-company-cd      pic x.
  2082     05  erarch2-cert-no         pic x(11).
  2083     05  erarch2-carrier         pic x.
  2084     05  erarch2-group           pic x(6).
  2085     05  erarch2-state           pic xx.
  2086     05  erarch2-account         pic x(10).
  2087     05  erarch2-eff-dt          pic xx.
  2088     05  erarch2-arch-no         pic s9(8) comp.
  2089 01  erchek-ridfld.
  2090     05  filler                  pic x(33).
  2091     05  erchek-seq-no           pic s9(4) comp.
  2092 01  ercnot-ridfld.
  2093     05  filler                  pic x(33).
  2094     05  ercnot-rec-type         pic x.
  2095     05  ercnot-seq-no           pic s9(4) comp.
  2096 01  ernote-ridfld               pic x(33).
  2097 01  ermail-ridfld               pic x(33).
  2098 01  erendr-ridfld.
  2099     05  filler                  pic x(33).
  2100     05  erendr-seq-no           pic s9(4) comp.
  2101     05  erendr-rec-type         pic x.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  38
* EL055.cbl
  2102 01  erendt-ridfld.
  2103     05  filler                  pic x(33).
  2104     05  erendt-rec-type         pic x.
  2105     05  erendt-seq-no           pic s9(4) comp.
  2106 01  msg-error.
  2107     05  filler                  pic x(08) value ' error- '.
  2108     05  me-response             pic 9(5)  value zeros.
  2109     05  filler                  pic xx value spaces.
  2110     05  me-response2            pic 9(5)  value zeros.
  2111     05  filler                  pic x(5)  value spaces.
  2112     05  me-command              pic x(20) value spaces.
  2113 01  WS-PASS-AREA.
  2114     05  PA-ERPNDB-KEY           PIC X(11).
  2115     05  pa-new-pndb-key.
  2116         10  filler              pic x(20).
  2117         10  pa-new-eff-dt       pic xx.
  2118         10  pa-new-cert-no      pic x(11).
  2119         10  filler              pic xxx.
  2120     05  pa-return-area.
  2121         10  ra-status-code      pic 9(4).
  2122         10  ra-message          pic x(205).
  2123*                                COPY ELCDATE.
  2124******************************************************************
  2125*                                                                *
  2126*                                                                *
  2127*                            ELCDATE.                            *
  2128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2129*                            VMOD=2.003
  2130*                                                                *
  2131*                                                                *
  2132*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2133*                 LENGTH = 200                                   *
  2134******************************************************************
  2135
  2136 01  DATE-CONVERSION-DATA.
  2137     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2138     12  DC-OPTION-CODE                PIC X.
  2139         88  BIN-TO-GREG                VALUE ' '.
  2140         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2141         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2142         88  YMD-GREG-TO-BIN            VALUE '3'.
  2143         88  MDY-GREG-TO-BIN            VALUE '4'.
  2144         88  JULIAN-TO-BIN              VALUE '5'.
  2145         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2146         88  FIND-CENTURY               VALUE '7'.
  2147         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2148         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2149         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2150         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2151         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2152         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2153         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2154         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2155         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2156         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2157         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2158         88  BIN-3-TO-GREG              VALUE 'I'.
  2159         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  39
* EL055.cbl
  2160         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2161         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2162         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2163         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2164         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2165         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2166         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2167         88  THREE-CHARACTER-BIN
  2168                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2169         88  GREGORIAN-TO-BIN
  2170                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2171         88  BIN-TO-GREGORIAN
  2172                  VALUES ' ' '1' 'I' '8' 'G'.
  2173         88  JULIAN-TO-BINARY
  2174                  VALUES '5' 'C' 'E' 'F'.
  2175     12  DC-ERROR-CODE                 PIC X.
  2176         88  NO-CONVERSION-ERROR        VALUE ' '.
  2177         88  DATE-CONVERSION-ERROR
  2178                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2179         88  DATE-IS-ZERO               VALUE '1'.
  2180         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2181         88  DATE-IS-INVALID            VALUE '3'.
  2182         88  DATE1-GREATER-DATE2        VALUE '4'.
  2183         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2184         88  DATE-INVALID-OPTION        VALUE '9'.
  2185         88  INVALID-CENTURY            VALUE 'A'.
  2186         88  ONLY-CENTURY               VALUE 'B'.
  2187         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2188         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2189     12  DC-END-OF-MONTH               PIC X.
  2190         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2191     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2192         88  USE-NORMAL-PROCESS         VALUE ' '.
  2193         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2194         88  ADJUST-UP-100-YRS          VALUE '2'.
  2195     12  FILLER                        PIC X.
  2196     12  DC-CONVERSION-DATES.
  2197         16  DC-BIN-DATE-1             PIC XX.
  2198         16  DC-BIN-DATE-2             PIC XX.
  2199         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2200         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2201                       DC-GREG-DATE-1-EDIT.
  2202             20  DC-EDIT1-MONTH        PIC 99.
  2203             20  SLASH1-1              PIC X.
  2204             20  DC-EDIT1-DAY          PIC 99.
  2205             20  SLASH1-2              PIC X.
  2206             20  DC-EDIT1-YEAR         PIC 99.
  2207         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2208         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2209                     DC-GREG-DATE-2-EDIT.
  2210             20  DC-EDIT2-MONTH        PIC 99.
  2211             20  SLASH2-1              PIC X.
  2212             20  DC-EDIT2-DAY          PIC 99.
  2213             20  SLASH2-2              PIC X.
  2214             20  DC-EDIT2-YEAR         PIC 99.
  2215         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2216         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2217                     DC-GREG-DATE-1-YMD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  40
* EL055.cbl
  2218             20  DC-YMD-YEAR           PIC 99.
  2219             20  DC-YMD-MONTH          PIC 99.
  2220             20  DC-YMD-DAY            PIC 99.
  2221         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2222         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2223                      DC-GREG-DATE-1-MDY.
  2224             20  DC-MDY-MONTH          PIC 99.
  2225             20  DC-MDY-DAY            PIC 99.
  2226             20  DC-MDY-YEAR           PIC 99.
  2227         16  DC-GREG-DATE-1-ALPHA.
  2228             20  DC-ALPHA-MONTH        PIC X(10).
  2229             20  DC-ALPHA-DAY          PIC 99.
  2230             20  FILLER                PIC XX.
  2231             20  DC-ALPHA-CENTURY.
  2232                 24 DC-ALPHA-CEN-N     PIC 99.
  2233             20  DC-ALPHA-YEAR         PIC 99.
  2234         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2235         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2236         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2237         16  DC-JULIAN-DATE            PIC 9(05).
  2238         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2239                                       PIC 9(05).
  2240         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2241             20  DC-JULIAN-YEAR        PIC 99.
  2242             20  DC-JULIAN-DAYS        PIC 999.
  2243         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2244         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2245         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2246     12  DATE-CONVERSION-VARIBLES.
  2247         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2248         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2249             20  FILLER                PIC 9(3).
  2250             20  HOLD-CEN-1-CCYY.
  2251                 24  HOLD-CEN-1-CC     PIC 99.
  2252                 24  HOLD-CEN-1-YY     PIC 99.
  2253             20  HOLD-CEN-1-MO         PIC 99.
  2254             20  HOLD-CEN-1-DA         PIC 99.
  2255         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2256             20  HOLD-CEN-1-R-MO       PIC 99.
  2257             20  HOLD-CEN-1-R-DA       PIC 99.
  2258             20  HOLD-CEN-1-R-CCYY.
  2259                 24  HOLD-CEN-1-R-CC   PIC 99.
  2260                 24  HOLD-CEN-1-R-YY   PIC 99.
  2261             20  FILLER                PIC 9(3).
  2262         16  HOLD-CENTURY-1-X.
  2263             20  FILLER                PIC X(3)  VALUE SPACES.
  2264             20  HOLD-CEN-1-X-CCYY.
  2265                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2266                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2267             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2268             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2269         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2270             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2271             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2272             20  HOLD-CEN-1-R-X-CCYY.
  2273                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2274                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2275             20  FILLER                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  41
* EL055.cbl
  2276         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2277         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2278         16  DC-JULIAN-DATE-1          PIC 9(07).
  2279         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2280             20  DC-JULIAN-1-CCYY.
  2281                 24  DC-JULIAN-1-CC    PIC 99.
  2282                 24  DC-JULIAN-1-YR    PIC 99.
  2283             20  DC-JULIAN-DA-1        PIC 999.
  2284         16  DC-JULIAN-DATE-2          PIC 9(07).
  2285         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2286             20  DC-JULIAN-2-CCYY.
  2287                 24  DC-JULIAN-2-CC    PIC 99.
  2288                 24  DC-JULIAN-2-YR    PIC 99.
  2289             20  DC-JULIAN-DA-2        PIC 999.
  2290         16  DC-GREG-DATE-A-EDIT.
  2291             20  DC-EDITA-MONTH        PIC 99.
  2292             20  SLASHA-1              PIC X VALUE '/'.
  2293             20  DC-EDITA-DAY          PIC 99.
  2294             20  SLASHA-2              PIC X VALUE '/'.
  2295             20  DC-EDITA-CCYY.
  2296                 24  DC-EDITA-CENT     PIC 99.
  2297                 24  DC-EDITA-YEAR     PIC 99.
  2298         16  DC-GREG-DATE-B-EDIT.
  2299             20  DC-EDITB-MONTH        PIC 99.
  2300             20  SLASHB-1              PIC X VALUE '/'.
  2301             20  DC-EDITB-DAY          PIC 99.
  2302             20  SLASHB-2              PIC X VALUE '/'.
  2303             20  DC-EDITB-CCYY.
  2304                 24  DC-EDITB-CENT     PIC 99.
  2305                 24  DC-EDITB-YEAR     PIC 99.
  2306         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2307         16  DC-GREG-DATE-CYMD-R REDEFINES
  2308                              DC-GREG-DATE-CYMD.
  2309             20  DC-CYMD-CEN           PIC 99.
  2310             20  DC-CYMD-YEAR          PIC 99.
  2311             20  DC-CYMD-MONTH         PIC 99.
  2312             20  DC-CYMD-DAY           PIC 99.
  2313         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2314         16  DC-GREG-DATE-MDCY-R REDEFINES
  2315                              DC-GREG-DATE-MDCY.
  2316             20  DC-MDCY-MONTH         PIC 99.
  2317             20  DC-MDCY-DAY           PIC 99.
  2318             20  DC-MDCY-CEN           PIC 99.
  2319             20  DC-MDCY-YEAR          PIC 99.
  2320    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2321        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2322    12  DC-EL310-DATE                  PIC X(21).
  2323    12  FILLER                         PIC X(28).
  2324****************************************************************
  2325*
  2326* Copyright (c) 2007-2013 Dell Inc.
  2327* All rights reserved.
  2328*
  2329****************************************************************
  2330 01  DFHEIV.
  2331   02  DFHEIV0               PIC X(35).
  2332   02  DFHEIV1               PIC X(08).
  2333   02  DFHEIV2               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  42
* EL055.cbl
  2334   02  DFHEIV3               PIC X(08).
  2335   02  DFHEIV4               PIC X(06).
  2336   02  DFHEIV5               PIC X(04).
  2337   02  DFHEIV6               PIC X(04).
  2338   02  DFHEIV7               PIC X(02).
  2339   02  DFHEIV8               PIC X(02).
  2340   02  DFHEIV9               PIC X(01).
  2341   02  DFHEIV10              PIC S9(7) COMP-3.
  2342   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2343   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2344   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2345   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2346   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2347   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2348   02  DFHEIV17              PIC X(04).
  2349   02  DFHEIV18              PIC X(04).
  2350   02  DFHEIV19              PIC X(04).
  2351   02  DFHEIV20              USAGE IS POINTER.
  2352   02  DFHEIV21              USAGE IS POINTER.
  2353   02  DFHEIV22              USAGE IS POINTER.
  2354   02  DFHEIV23              USAGE IS POINTER.
  2355   02  DFHEIV24              USAGE IS POINTER.
  2356   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2357   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2358   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2359   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2360   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2361   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2362   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2363   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2364   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2365   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2366   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2367   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2368   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2369   02  FILLER                PIC X(02).
  2370   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2371   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2372   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2373   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2374   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2375   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2376   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2377 LINKAGE  SECTION.
  2378*****************************************************************
  2379*                                                               *
  2380* Copyright (c) 2007-2013 Dell Inc.                             *
  2381* All rights reserved.                                          *
  2382*                                                               *
  2383*****************************************************************
  2384 01  dfheiblk.
  2385     02  eibtime          pic s9(7) comp-3.
  2386     02  eibdate          pic s9(7) comp-3.
  2387     02  eibtrnid         pic x(4).
  2388     02  eibtaskn         pic s9(7) comp-3.
  2389     02  eibtrmid         pic x(4).
  2390     02  dfheigdi         pic s9(4) comp.
  2391     02  eibcposn         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  43
* EL055.cbl
  2392     02  eibcalen         pic s9(4) comp.
  2393     02  eibaid           pic x(1).
  2394     02  eibfiller1       pic x(1).
  2395     02  eibfn            pic x(2).
  2396     02  eibfiller2       pic x(2).
  2397     02  eibrcode         pic x(6).
  2398     02  eibfiller3       pic x(2).
  2399     02  eibds            pic x(8).
  2400     02  eibreqid         pic x(8).
  2401     02  eibrsrce         pic x(8).
  2402     02  eibsync          pic x(1).
  2403     02  eibfree          pic x(1).
  2404     02  eibrecv          pic x(1).
  2405     02  eibsend          pic x(1).
  2406     02  eibatt           pic x(1).
  2407     02  eibeoc           pic x(1).
  2408     02  eibfmh           pic x(1).
  2409     02  eibcompl         pic x(1).
  2410     02  eibsig           pic x(1).
  2411     02  eibconf          pic x(1).
  2412     02  eiberr           pic x(1).
  2413     02  eibrldbk         pic x(1).
  2414     02  eiberrcd         pic x(4).
  2415     02  eibsynrb         pic x(1).
  2416     02  eibnodat         pic x(1).
  2417     02  eibfiller5       pic x(2).
  2418     02  eibresp          pic s9(8) comp.
  2419     02  eibresp2         pic s9(8) comp.
  2420     02  dfheigdj         pic s9(4) comp.
  2421     02  dfheigdk         pic s9(4) comp.
  2422 01  DFHCOMMAREA                 PIC X(256).
  2423 01  var  pic x(30).
  2424 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2425 0000-DFHEXIT SECTION.
  2426     MOVE '9#                    $   ' TO DFHEIV0.
  2427     MOVE 'EL055' TO DFHEIV1.
  2428     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2429     display ' entering program EL055'
  2430     perform 0010-init           thru 0010-exit
  2431     perform 0100-check-validity thru 0100-exit
  2432     perform 0200-convert-key    thru 0200-exit
  2433     perform 0050-bld-return-area thru 0050-exit
  2434     .
  2435 0000-return.
  2436     move ws-pass-area           to dfhcommarea
  2437
  2438* exec cics return
  2439*    end-exec
  2440*    MOVE '.(                    ''   #00002433' TO DFHEIV0
  2441     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2443     MOVE X'2020233030303032343333' TO DFHEIV0(25:11)
  2444     CALL 'kxdfhei1' USING DFHEIV0,
  2445           DFHEIV99,
  2446           DFHEIV99,
  2447           DFHEIV99,
  2448           DFHEIV99,
  2449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  44
* EL055.cbl
  2450           DFHEIV99
  2451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2452
  2453* GOBACK
  2454
  2455     MOVE '9%                    "   ' TO DFHEIV0
  2456     MOVE 'EL055' TO DFHEIV1
  2457     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2458     GOBACK
  2459     .
  2460 0010-init.
  2461     move dfhcommarea            to ws-pass-AREA
  2462     set P to address of KIXSYS
  2463     CALL "getenv" using by value P returning var-ptr
  2464     if var-ptr = null then
  2465        display ' kixsys not set '
  2466     else
  2467        set address of var to var-ptr
  2468        move 0 to env-var-len
  2469        inspect var tallying env-var-len
  2470          for characters before X'00'
  2471        unstring var (1:env-var-len) delimited by '/'
  2472           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2473              WS-KIX-SYS
  2474        end-unstring
  2475     end-if
  2476     .
  2477 0010-exit.
  2478     exit.
  2479 0050-bld-return-area.
  2480     move zeros                  to ra-status-code
  2481     move 'SUCCESS'              to ra-message
  2482     .
  2483 0050-exit.
  2484     exit.
  2485 0100-check-validity.
  2486**** ======================================================== ****
  2487****                                                          ****
  2488****    Make sure Key to change exists on ERPNDB              ****
  2489****                                                          ****
  2490**** ======================================================== ****
  2491     move PA-ERPNDB-KEY          to erpndb-ridfld
  2492
  2493* exec cics read
  2494*       dataset    ('ERPNDB')
  2495*       ridfld     (erpndb-ridfld)
  2496*       into       (pending-business)
  2497*       resp       (ws-response)
  2498*    end-exec
  2499     MOVE LENGTH OF
  2500      pending-business
  2501       TO DFHEIV11
  2502     MOVE 'ERPNDB' TO DFHEIV1
  2503*    MOVE '&"IL       E          (  N#00002469' TO DFHEIV0
  2504     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2506     MOVE X'204E233030303032343639' TO DFHEIV0(25:11)
  2507     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  45
* EL055.cbl
  2508           DFHEIV1,
  2509           pending-business,
  2510           DFHEIV11,
  2511           erpndb-ridfld,
  2512           DFHEIV99,
  2513           DFHEIV99,
  2514           DFHEIV99
  2515     MOVE EIBRESP  TO ws-response
  2516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2517     if not resp-normal
  2518        move ws-response         to ra-status-code
  2519        move ' erpndb read error '
  2520                                 to ra-message
  2521        display 'error-erpndb-read ' ws-response
  2522        go to 0000-return
  2523     end-if
  2524     move pb-control-by-account  to ws-old-pndb-key
  2525     move pb-cert-eff-dt         to dc-bin-date-1
  2526     move ' '                    to dc-option-code
  2527     perform 8500-date-convert   thru 8500-exit
  2528     if no-conversion-error
  2529        string
  2530           dc-cymd-cen
  2531           dc-cymd-year   '-'
  2532           dc-cymd-month  '-'
  2533           dc-cymd-day delimited by size
  2534              into ws-old-greg-eff-date
  2535        end-string
  2536     else
  2537        display ' Bad eff date convert ' pb-cert-no
  2538        go to 0000-return
  2539     end-if
  2540***  Might as well convert the new effective dt while we're at it
  2541     move pa-new-eff-dt          to dc-bin-date-1
  2542     move ' '                    to dc-option-code
  2543     perform 8500-date-convert   thru 8500-exit
  2544     if no-conversion-error
  2545        string
  2546           dc-cymd-cen
  2547           dc-cymd-year   '-'
  2548           dc-cymd-month  '-'
  2549           dc-cymd-day delimited by size
  2550              into ws-new-greg-eff-date
  2551        end-string
  2552     else
  2553        display ' Bad new eff date convert ' pb-cert-no
  2554        go to 0000-return
  2555     end-if
  2556**** ======================================================== ****
  2557**** ======================================================== ****
  2558****                                                          ****
  2559****    Make sure Key to change exists on ELCERT              ****
  2560****                                                          ****
  2561**** ======================================================== ****
  2562     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2563
  2564* exec cics read
  2565*       dataset    ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  46
* EL055.cbl
  2566*       ridfld     (elcert-ridfld)
  2567*       into       (certificate-master)
  2568*       resp       (ws-response)
  2569*    end-exec
  2570     MOVE LENGTH OF
  2571      certificate-master
  2572       TO DFHEIV11
  2573     MOVE 'ELCERT' TO DFHEIV1
  2574*    MOVE '&"IL       E          (  N#00002521' TO DFHEIV0
  2575     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2577     MOVE X'204E233030303032353231' TO DFHEIV0(25:11)
  2578     CALL 'kxdfhei1' USING DFHEIV0,
  2579           DFHEIV1,
  2580           certificate-master,
  2581           DFHEIV11,
  2582           elcert-ridfld,
  2583           DFHEIV99,
  2584           DFHEIV99,
  2585           DFHEIV99
  2586     MOVE EIBRESP  TO ws-response
  2587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2588     if not resp-normal
  2589        move ws-response         to ra-status-code
  2590        move ' elcert read error '
  2591                                 to ra-message
  2592        display 'error-elcert-read ' ws-response
  2593        go to 0000-return
  2594     end-if
  2595     if (cert-added-batch)
  2596        or (cert-and-claim-online)
  2597        or (cert-was-created-for-claim)
  2598        move +99                 to ra-status-code
  2599        move 'Claim Exists '     to ra-message
  2600        go to 0000-return
  2601     end-if
  2602**** ======================================================== ****
  2603**** ======================================================== ****
  2604****                                                          ****
  2605****    Make sure new key does NOT exist on ERPNDB2           ****
  2606****                                                          ****
  2607**** ======================================================== ****
  2608     move PA-new-pndb-key        to erpndb2-ridfld
  2609
  2610* exec cics read
  2611*       dataset    ('ERPNDB2')
  2612*       ridfld     (erpndb2-ridfld)
  2613*       into       (ws-dummy-area)
  2614*       resp       (ws-response)
  2615*    end-exec
  2616     MOVE LENGTH OF
  2617      ws-dummy-area
  2618       TO DFHEIV11
  2619     MOVE 'ERPNDB2' TO DFHEIV1
  2620*    MOVE '&"IL       E          (  N#00002548' TO DFHEIV0
  2621     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2623     MOVE X'204E233030303032353438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  47
* EL055.cbl
  2624     CALL 'kxdfhei1' USING DFHEIV0,
  2625           DFHEIV1,
  2626           ws-dummy-area,
  2627           DFHEIV11,
  2628           erpndb2-ridfld,
  2629           DFHEIV99,
  2630           DFHEIV99,
  2631           DFHEIV99
  2632     MOVE EIBRESP  TO ws-response
  2633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2634     if (not RESP-NOTFND)
  2635        and (not resp-endfile)
  2636        move +88                 to ra-status-code
  2637        move ' pndb already exists '
  2638                                 to ra-message
  2639        display 'error-erpndb2-read ' ws-response
  2640        go to 0000-return
  2641     end-if
  2642**** ======================================================== ****
  2643**** ======================================================== ****
  2644****                                                          ****
  2645****    Make sure new key does NOT exist on ELCERT            ****
  2646****                                                          ****
  2647**** ======================================================== ****
  2648     move PA-new-pndb-key(1:33)  to elcert-ridfld
  2649
  2650* exec cics read
  2651*       dataset    ('ELCERT')
  2652*       ridfld     (elcert-ridfld)
  2653*       into       (ws-dummy-area)
  2654*       resp       (ws-response)
  2655*    end-exec
  2656     MOVE LENGTH OF
  2657      ws-dummy-area
  2658       TO DFHEIV11
  2659     MOVE 'ELCERT' TO DFHEIV1
  2660*    MOVE '&"IL       E          (  N#00002569' TO DFHEIV0
  2661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2663     MOVE X'204E233030303032353639' TO DFHEIV0(25:11)
  2664     CALL 'kxdfhei1' USING DFHEIV0,
  2665           DFHEIV1,
  2666           ws-dummy-area,
  2667           DFHEIV11,
  2668           elcert-ridfld,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99
  2672     MOVE EIBRESP  TO ws-response
  2673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2674     if (not RESP-NOTFND)
  2675        and (not resp-endfile)
  2676        display ' setting status to 88 '
  2677        move +88                 to ra-status-code
  2678        move ' elcert already exist '
  2679                                 to ra-message
  2680        display 'error-elcert-read-exists ' ws-response
  2681        go to 0000-return
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  48
* EL055.cbl
  2682     end-if
  2683**** ======================================================== ****
  2684**** ======================================================== ****
  2685****                                                          ****
  2686****    Right here, 1)rewrite erpndb with new key, 2)delete   ****
  2687****  elcert.                                                 ****
  2688****                                                          ****
  2689**** ======================================================== ****
  2690** 1)  Rewrite erpndb with new key
  2691     move PA-ERPNDB-KEY          to erpndb-ridfld
  2692
  2693* exec cics read update
  2694*       dataset    ('ERPNDB')
  2695*       ridfld     (erpndb-ridfld)
  2696*       into       (pending-business)
  2697*       resp       (ws-response)
  2698*    end-exec
  2699     MOVE LENGTH OF
  2700      pending-business
  2701       TO DFHEIV11
  2702     MOVE 'ERPNDB' TO DFHEIV1
  2703*    MOVE '&"IL       EU         (  N#00002593' TO DFHEIV0
  2704     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2705     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2706     MOVE X'204E233030303032353933' TO DFHEIV0(25:11)
  2707     CALL 'kxdfhei1' USING DFHEIV0,
  2708           DFHEIV1,
  2709           pending-business,
  2710           DFHEIV11,
  2711           erpndb-ridfld,
  2712           DFHEIV99,
  2713           DFHEIV99,
  2714           DFHEIV99
  2715     MOVE EIBRESP  TO ws-response
  2716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2717     if not resp-normal
  2718        move ws-response         to ra-status-code
  2719        move ' erpndb read update error '
  2720                                 to ra-message
  2721        display 'error-erpndb-read update ' ws-response
  2722        go to 0000-return
  2723     end-if
  2724     move pa-new-eff-dt          to pb-cert-eff-dt
  2725     move pa-new-cert-no         to pb-cert-no
  2726
  2727* exec cics rewrite
  2728*       dataset  ('ERPNDB')
  2729*       from     (pending-business)
  2730*       resp     (ws-response)
  2731*    end-exec
  2732     MOVE LENGTH OF
  2733      pending-business
  2734       TO DFHEIV11
  2735     MOVE 'ERPNDB' TO DFHEIV1
  2736*    MOVE '&& L                  %  N#00002608' TO DFHEIV0
  2737     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2738     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2739     MOVE X'204E233030303032363038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  49
* EL055.cbl
  2740     CALL 'kxdfhei1' USING DFHEIV0,
  2741           DFHEIV1,
  2742           pending-business,
  2743           DFHEIV11,
  2744           DFHEIV99
  2745     MOVE EIBRESP  TO ws-response
  2746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2747     if not resp-normal
  2748        move ws-response         to ra-status-code
  2749        move ' erpndb rewrite error '
  2750                                 to ra-message
  2751        display 'error-erpndb-rewrite ' ws-response
  2752        go to 0000-return
  2753     end-if
  2754     .
  2755 0100-check-for-claim.
  2756     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2757
  2758* exec cics read update
  2759*       dataset    ('ELCERT')
  2760*       ridfld     (elcert-ridfld)
  2761*       into       (certificate-master)
  2762*       resp       (ws-response)
  2763*    end-exec
  2764     MOVE LENGTH OF
  2765      certificate-master
  2766       TO DFHEIV11
  2767     MOVE 'ELCERT' TO DFHEIV1
  2768*    MOVE '&"IL       EU         (  N#00002623' TO DFHEIV0
  2769     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2770     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2771     MOVE X'204E233030303032363233' TO DFHEIV0(25:11)
  2772     CALL 'kxdfhei1' USING DFHEIV0,
  2773           DFHEIV1,
  2774           certificate-master,
  2775           DFHEIV11,
  2776           elcert-ridfld,
  2777           DFHEIV99,
  2778           DFHEIV99,
  2779           DFHEIV99
  2780     MOVE EIBRESP  TO ws-response
  2781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2782     if (cert-added-batch)
  2783        or (cert-and-claim-online)
  2784        or (cert-was-created-for-claim)
  2785        continue
  2786     else
  2787        go to 0100-delete-elcert
  2788     end-if
  2789     if (no-claim-attached)
  2790        or (cert-added-batch)
  2791        continue
  2792     else
  2793        move spaces              to cm-credit-interface-sw-1
  2794        move '2'                 to cm-claim-interface-sw
  2795     end-if
  2796
  2797* exec cics rewrite
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  50
* EL055.cbl
  2798*       dataset   ('ELCERT')
  2799*       from      (certificate-master)
  2800*    end-exec
  2801     MOVE LENGTH OF
  2802      certificate-master
  2803       TO DFHEIV11
  2804     MOVE 'ELCERT' TO DFHEIV1
  2805*    MOVE '&& L                  %   #00002643' TO DFHEIV0
  2806     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2807     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2808     MOVE X'2020233030303032363433' TO DFHEIV0(25:11)
  2809     CALL 'kxdfhei1' USING DFHEIV0,
  2810           DFHEIV1,
  2811           certificate-master,
  2812           DFHEIV11,
  2813           DFHEIV99
  2814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2815     if not resp-normal
  2816        move ws-response         to ra-status-code
  2817        move ' elcert rewrite error clm '
  2818                                 to ra-message
  2819        display 'error-elcert-rewrite ' ws-response
  2820        go to 0000-return
  2821     end-if
  2822     go to 0100-write-new-elcert
  2823     .
  2824 0100-delete-elcert.
  2825** 2)  Delete ELCERT (old key)
  2826     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2827
  2828* exec cics delete
  2829*       dataset  ('ELCERT')
  2830*       resp     (ws-response)
  2831*    end-exec
  2832     MOVE 'ELCERT' TO DFHEIV1
  2833*    MOVE '&(                    &  N#00002659' TO DFHEIV0
  2834     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2836     MOVE X'204E233030303032363539' TO DFHEIV0(25:11)
  2837     CALL 'kxdfhei1' USING DFHEIV0,
  2838           DFHEIV1,
  2839           DFHEIV99,
  2840           DFHEIV99,
  2841           DFHEIV99,
  2842           DFHEIV99
  2843     MOVE EIBRESP  TO ws-response
  2844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2845     if not resp-normal
  2846        move ws-response         to ra-status-code
  2847        move ' elcert delete error '
  2848                                 to ra-message
  2849        display 'error-elcert-delete  ' ws-response
  2850        go to 0000-return
  2851     end-if
  2852     .
  2853 0100-write-new-elcert.
  2854**  This is commented out because I want EL6311 to write
  2855**    the new ELCERT record.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  51
* EL055.cbl
  2856** 3)  Write new ELCERT record
  2857**  Not now. Let el6311 write the new one??
  2858**   move pa-new-eff-dt          to cm-cert-eff-dt
  2859**   move pa-new-cert-no         to cm-cert-no
  2860**
  2861**   exec cics write
  2862**      dataset  ('ELCERT')
  2863**      from     (certificate-master)
  2864**      ridfld   (cm-control-primary)
  2865**      resp     (ws-response)
  2866**   end-exec
  2867**
  2868**   if not resp-normal
  2869**      move ws-response         to ra-status-code
  2870**                               to ra-message
  2871**      display 'error-elcert-write   ' ws-response
  2872**      go to 0000-return
  2873**   end-if
  2874**** ======================================================== ****
  2875****                                                          ****
  2876****    Check for ELCRTO records                              ****
  2877****                                                          ****
  2878**** ======================================================== ****
  2879     move ' '                    to ws-startbr-ind
  2880     move ws-old-pndb-key(1:33)  to elcrto-ridfld(1:33)
  2881     move opk-rec-type           to elcrto-rec-type
  2882     move +0                     to elcrto-seq-no
  2883
  2884* exec cics startbr
  2885*       dataset    ('ELCRTO')
  2886*       ridfld     (elcrto-ridfld)
  2887*       gteq
  2888*       resp       (ws-response)
  2889*    end-exec
  2890     MOVE 'ELCRTO' TO DFHEIV1
  2891     MOVE 0
  2892       TO DFHEIV11
  2893*    MOVE '&,         G          &  N#00002702' TO DFHEIV0
  2894     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2896     MOVE X'204E233030303032373032' TO DFHEIV0(25:11)
  2897     CALL 'kxdfhei1' USING DFHEIV0,
  2898           DFHEIV1,
  2899           elcrto-ridfld,
  2900           DFHEIV99,
  2901           DFHEIV11,
  2902           DFHEIV99
  2903     MOVE EIBRESP  TO ws-response
  2904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2905     if RESP-NOTFND or resp-endfile
  2906        go to 0100-end-elcrto
  2907     else
  2908        if not resp-normal
  2909           move ws-response      to ra-status-code
  2910           move ' elcrto error startbr '
  2911                                 to ra-message
  2912           display 'error-elcrto-startbr ' ws-response
  2913           go to 0000-return
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  52
* EL055.cbl
  2914        end-if
  2915     end-if
  2916     move 'Y'                    to ws-startbr-ind
  2917     .
  2918 0100-elcrto-loop.
  2919
  2920* exec cics readnext
  2921*       dataset    ('ELCRTO')
  2922*       ridfld     (elcrto-ridfld)
  2923*       into       (original-certificate)
  2924*       resp       (ws-response)
  2925*    end-exec
  2926     MOVE LENGTH OF
  2927      original-certificate
  2928       TO DFHEIV12
  2929     MOVE 'ELCRTO' TO DFHEIV1
  2930     MOVE 0
  2931       TO DFHEIV11
  2932*    MOVE '&.IL                  )  N#00002722' TO DFHEIV0
  2933     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2934     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2935     MOVE X'204E233030303032373232' TO DFHEIV0(25:11)
  2936     CALL 'kxdfhei1' USING DFHEIV0,
  2937           DFHEIV1,
  2938           original-certificate,
  2939           DFHEIV12,
  2940           elcrto-ridfld,
  2941           DFHEIV99,
  2942           DFHEIV11,
  2943           DFHEIV99,
  2944           DFHEIV99
  2945     MOVE EIBRESP  TO ws-response
  2946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2947     if (RESP-NOTFND)
  2948        or (resp-endfile)
  2949        or (elcrto-ridfld(1:33) <> ws-old-pndb-key(1:33))
  2950        go to 0100-end-elcrto
  2951     else
  2952        if not resp-normal
  2953           move ws-response      to ra-status-code
  2954           move ' elcrto error readnext '
  2955                                 to ra-message
  2956           display 'error-elcrto-readnext ' ws-response
  2957           go to 0000-return
  2958        end-if
  2959     end-if
  2960     if opk-rec-type <> oc-record-type
  2961        go to 0100-elcrto-loop
  2962     end-if
  2963***  delete and add with new key right here!!!
  2964
  2965* exec cics delete
  2966*       dataset  ('ELCRTO')
  2967*       ridfld   (elcrto-ridfld)
  2968*       resp     (ws-response)
  2969*    end-exec
  2970     MOVE 'ELCRTO' TO DFHEIV1
  2971*    MOVE '&(  R                 &  N#00002745' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  53
* EL055.cbl
  2972     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2973     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2974     MOVE X'204E233030303032373435' TO DFHEIV0(25:11)
  2975     CALL 'kxdfhei1' USING DFHEIV0,
  2976           DFHEIV1,
  2977           elcrto-ridfld,
  2978           DFHEIV99,
  2979           DFHEIV99,
  2980           DFHEIV99
  2981     MOVE EIBRESP  TO ws-response
  2982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2983     if not resp-normal
  2984        move ws-response         to ra-status-code
  2985        move ' elcrto delete error '
  2986                                 to ra-message
  2987        display 'error-elcrto-delete  ' ws-response
  2988        go to 0000-return
  2989     end-if
  2990     move pa-new-eff-dt          to oc-cert-eff-dt
  2991     move pa-new-cert-no         to oc-cert-no
  2992
  2993* exec cics write
  2994*       dataset  ('ELCRTO')
  2995*       from     (original-certificate)
  2996*       ridfld   (oc-control-primary)
  2997*       resp     (ws-response)
  2998*    end-exec
  2999     MOVE LENGTH OF
  3000      original-certificate
  3001       TO DFHEIV11
  3002     MOVE 'ELCRTO' TO DFHEIV1
  3003*    MOVE '&$ L                  ''  N#00002759' TO DFHEIV0
  3004     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3006     MOVE X'204E233030303032373539' TO DFHEIV0(25:11)
  3007     CALL 'kxdfhei1' USING DFHEIV0,
  3008           DFHEIV1,
  3009           original-certificate,
  3010           DFHEIV11,
  3011           oc-control-primary,
  3012           DFHEIV99,
  3013           DFHEIV99
  3014     MOVE EIBRESP  TO ws-response
  3015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3016     if not resp-normal
  3017        move ws-response         to ra-status-code
  3018        move ' elcrto write  error '
  3019                                 to ra-message
  3020        display 'error-elcrto-write   ' ws-response
  3021        go to 0000-return
  3022     end-if
  3023     go to 0100-elcrto-loop
  3024     .
  3025 0100-end-elcrto.
  3026     if ws-startbr-ind = 'Y'
  3027
  3028* exec cics endbr
  3029*          dataset     ('ELCRTO')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  54
* EL055.cbl
  3030*       end-exec
  3031     MOVE 'ELCRTO' TO DFHEIV1
  3032     MOVE 0
  3033       TO DFHEIV11
  3034*    MOVE '&2                    $   #00002776' TO DFHEIV0
  3035     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3036     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3037     MOVE X'2020233030303032373736' TO DFHEIV0(25:11)
  3038     CALL 'kxdfhei1' USING DFHEIV0,
  3039           DFHEIV1,
  3040           DFHEIV11,
  3041           DFHEIV99
  3042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3043     end-if
  3044      .
  3045 0100-elcrtt.
  3046**** ======================================================== ****
  3047****                                                          ****
  3048****    Check for ELCRTT records                              ****
  3049****                                                          ****
  3050**** ======================================================== ****
  3051     move ' '                    to ws-startbr-ind
  3052     move ws-old-pndb-key(1:33)  to elcrtt-ridfld(1:33)
  3053     move ' '                    to elcrtt-rec-type
  3054
  3055* exec cics startbr
  3056*       dataset    ('ELCRTT')
  3057*       ridfld     (elcrtt-ridfld)
  3058*       gteq
  3059*       resp       (ws-response)
  3060*    end-exec
  3061     MOVE 'ELCRTT' TO DFHEIV1
  3062     MOVE 0
  3063       TO DFHEIV11
  3064*    MOVE '&,         G          &  N#00002790' TO DFHEIV0
  3065     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3066     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3067     MOVE X'204E233030303032373930' TO DFHEIV0(25:11)
  3068     CALL 'kxdfhei1' USING DFHEIV0,
  3069           DFHEIV1,
  3070           elcrtt-ridfld,
  3071           DFHEIV99,
  3072           DFHEIV11,
  3073           DFHEIV99
  3074     MOVE EIBRESP  TO ws-response
  3075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3076     if RESP-NOTFND or resp-endfile
  3077        go to 0100-end-elcrtt
  3078     else
  3079        if not resp-normal
  3080           move ws-response      to ra-status-code
  3081           move ' elcrtt error startbr '
  3082                                 to ra-message
  3083           display 'error-elcrtt-startbr ' ws-response
  3084           go to 0000-return
  3085        end-if
  3086     end-if
  3087     move 'Y'                    to ws-startbr-ind
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  55
* EL055.cbl
  3088     .
  3089 0100-elcrtt-loop.
  3090
  3091* exec cics readnext
  3092*       dataset    ('ELCRTT')
  3093*       ridfld     (elcrtt-ridfld)
  3094*       into       (certificate-trailers)
  3095*       resp       (ws-response)
  3096*    end-exec
  3097     MOVE LENGTH OF
  3098      certificate-trailers
  3099       TO DFHEIV12
  3100     MOVE 'ELCRTT' TO DFHEIV1
  3101     MOVE 0
  3102       TO DFHEIV11
  3103*    MOVE '&.IL                  )  N#00002810' TO DFHEIV0
  3104     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3105     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3106     MOVE X'204E233030303032383130' TO DFHEIV0(25:11)
  3107     CALL 'kxdfhei1' USING DFHEIV0,
  3108           DFHEIV1,
  3109           certificate-trailers,
  3110           DFHEIV12,
  3111           elcrtt-ridfld,
  3112           DFHEIV99,
  3113           DFHEIV11,
  3114           DFHEIV99,
  3115           DFHEIV99
  3116     MOVE EIBRESP  TO ws-response
  3117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3118     if (RESP-NOTFND)
  3119        or (resp-endfile)
  3120        or (elcrtt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3121        go to 0100-end-elcrtt
  3122     else
  3123        if not resp-normal
  3124           move ws-response      to ra-status-code
  3125           move ' elcrtt error readnext '
  3126                                 to ra-message
  3127           display 'error-elcrtt-readnext ' ws-response
  3128           go to 0000-return
  3129        end-if
  3130     end-if
  3131***  delete and add with new key right here!!!
  3132
  3133* exec cics delete
  3134*       dataset  ('ELCRTT')
  3135*       ridfld   (elcrtt-ridfld)
  3136*       resp     (ws-response)
  3137*    end-exec
  3138     MOVE 'ELCRTT' TO DFHEIV1
  3139*    MOVE '&(  R                 &  N#00002830' TO DFHEIV0
  3140     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3141     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3142     MOVE X'204E233030303032383330' TO DFHEIV0(25:11)
  3143     CALL 'kxdfhei1' USING DFHEIV0,
  3144           DFHEIV1,
  3145           elcrtt-ridfld,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  56
* EL055.cbl
  3146           DFHEIV99,
  3147           DFHEIV99,
  3148           DFHEIV99
  3149     MOVE EIBRESP  TO ws-response
  3150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3151     if not resp-normal
  3152        move ws-response         to ra-status-code
  3153        move ' elcrtt delete error '
  3154                                 to ra-message
  3155        display 'error-elcrtt-delete  ' ws-response
  3156        go to 0000-return
  3157     end-if
  3158     move pa-new-eff-dt          to cs-cert-eff-dt
  3159     move pa-new-cert-no         to cs-cert-no
  3160
  3161* exec cics write
  3162*       dataset  ('ELCRTT')
  3163*       from     (certificate-trailers)
  3164*       ridfld   (cs-control-primary)
  3165*       resp     (ws-response)
  3166*    end-exec
  3167     MOVE LENGTH OF
  3168      certificate-trailers
  3169       TO DFHEIV11
  3170     MOVE 'ELCRTT' TO DFHEIV1
  3171*    MOVE '&$ L                  ''  N#00002844' TO DFHEIV0
  3172     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3174     MOVE X'204E233030303032383434' TO DFHEIV0(25:11)
  3175     CALL 'kxdfhei1' USING DFHEIV0,
  3176           DFHEIV1,
  3177           certificate-trailers,
  3178           DFHEIV11,
  3179           cs-control-primary,
  3180           DFHEIV99,
  3181           DFHEIV99
  3182     MOVE EIBRESP  TO ws-response
  3183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3184     if not resp-normal
  3185        move ws-response         to ra-status-code
  3186        move ' elcrtt write  error '
  3187                                 to ra-message
  3188        display 'error-elcrtt-write   ' ws-response
  3189        go to 0000-return
  3190     end-if
  3191     go to 0100-elcrtt-loop
  3192     .
  3193 0100-end-elcrtt.
  3194     if ws-startbr-ind = 'Y'
  3195
  3196* exec cics endbr
  3197*          dataset     ('ELCRTT')
  3198*       end-exec
  3199     MOVE 'ELCRTT' TO DFHEIV1
  3200     MOVE 0
  3201       TO DFHEIV11
  3202*    MOVE '&2                    $   #00002861' TO DFHEIV0
  3203     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  57
* EL055.cbl
  3204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3205     MOVE X'2020233030303032383631' TO DFHEIV0(25:11)
  3206     CALL 'kxdfhei1' USING DFHEIV0,
  3207           DFHEIV1,
  3208           DFHEIV11,
  3209           DFHEIV99
  3210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3211     end-if
  3212     .
  3213 0100-erarch.
  3214**** ======================================================== ****
  3215****                                                          ****
  3216****    Check for ERARCH records                              ****
  3217****                                                          ****
  3218**** ======================================================== ****
  3219     move ' '                    to ws-startbr-ind
  3220     move opk-company-cd         to erarch2-company-cd
  3221     move opk-cert-no            to erarch2-cert-no
  3222     move ws-old-pndb-key(1:21)  to erarch2-ridfld(13:21)
  3223     move +0                     to erarch2-arch-no
  3224
  3225* exec cics startbr
  3226*       dataset    ('ERARCH2')
  3227*       ridfld     (erarch2-ridfld)
  3228*       gteq
  3229*       resp       (ws-response)
  3230*    end-exec
  3231     MOVE 'ERARCH2' TO DFHEIV1
  3232     MOVE 0
  3233       TO DFHEIV11
  3234*    MOVE '&,         G          &  N#00002877' TO DFHEIV0
  3235     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3236     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3237     MOVE X'204E233030303032383737' TO DFHEIV0(25:11)
  3238     CALL 'kxdfhei1' USING DFHEIV0,
  3239           DFHEIV1,
  3240           erarch2-ridfld,
  3241           DFHEIV99,
  3242           DFHEIV11,
  3243           DFHEIV99
  3244     MOVE EIBRESP  TO ws-response
  3245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3246     if RESP-NOTFND or resp-endfile
  3247        go to 0100-end-erarch
  3248     else
  3249        if not resp-normal
  3250           move ws-response      to ra-status-code
  3251           move ' erarch2 error startbr '
  3252                                 to ra-message
  3253           display 'error-erarch2-startbr ' ws-response
  3254           go to 0000-return
  3255        end-if
  3256     end-if
  3257     move 'Y'                    to ws-startbr-ind
  3258     .
  3259 0100-erarch-loop.
  3260
  3261* exec cics readnext
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  58
* EL055.cbl
  3262*       dataset    ('ERARCH2')
  3263*       ridfld     (erarch2-ridfld)
  3264*       into       (letter-archive)
  3265*       resp       (ws-response)
  3266*    end-exec
  3267     MOVE LENGTH OF
  3268      letter-archive
  3269       TO DFHEIV12
  3270     MOVE 'ERARCH2' TO DFHEIV1
  3271     MOVE 0
  3272       TO DFHEIV11
  3273*    MOVE '&.IL                  )  N#00002897' TO DFHEIV0
  3274     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3275     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3276     MOVE X'204E233030303032383937' TO DFHEIV0(25:11)
  3277     CALL 'kxdfhei1' USING DFHEIV0,
  3278           DFHEIV1,
  3279           letter-archive,
  3280           DFHEIV12,
  3281           erarch2-ridfld,
  3282           DFHEIV99,
  3283           DFHEIV11,
  3284           DFHEIV99,
  3285           DFHEIV99
  3286     MOVE EIBRESP  TO ws-response
  3287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3288     if (RESP-NOTFND)
  3289        or (resp-endfile)
  3290        or (erarch2-company-cd <> opk-company-cd)
  3291        or (erarch2-cert-no <> opk-cert-no)
  3292        go to 0100-end-erarch
  3293     else
  3294        if not resp-normal
  3295           move ws-response      to ra-status-code
  3296           move ' erarch2 error readnext '
  3297                                 to ra-message
  3298           display 'error-erarch2-readnext ' ws-response
  3299           go to 0000-return
  3300        end-if
  3301     end-if
  3302     if (opk-carrier <> la-carrier-a2)
  3303        or (opk-group <> la-grouping-a2)
  3304        or (opk-state <> la-state-a2)
  3305        or (opk-account <> la-account-a2)
  3306        or (opk-eff-dt <> la-effect-date-a2)
  3307        go to 0100-erarch-loop
  3308     end-if
  3309***  Do rewrites to base cluster right here!!!
  3310     move la-control-primary     to erarch-ridfld
  3311                                    nsasextr-ridfld
  3312
  3313* exec cics read update
  3314*       dataset  ('ERARCH')
  3315*       into     (letter-archive)
  3316*       ridfld   (erarch-ridfld)
  3317*       resp     (ws-response)
  3318*    end-exec
  3319     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  59
* EL055.cbl
  3320      letter-archive
  3321       TO DFHEIV11
  3322     MOVE 'ERARCH' TO DFHEIV1
  3323*    MOVE '&"IL       EU         (  N#00002927' TO DFHEIV0
  3324     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3325     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3326     MOVE X'204E233030303032393237' TO DFHEIV0(25:11)
  3327     CALL 'kxdfhei1' USING DFHEIV0,
  3328           DFHEIV1,
  3329           letter-archive,
  3330           DFHEIV11,
  3331           erarch-ridfld,
  3332           DFHEIV99,
  3333           DFHEIV99,
  3334           DFHEIV99
  3335     MOVE EIBRESP  TO ws-response
  3336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3337     if not resp-normal
  3338        move ws-response         to ra-status-code
  3339        move ' erarch read update error '
  3340                                 to ra-message
  3341        display 'error-erarch-read update ' ws-response
  3342        go to 0000-return
  3343     end-if
  3344     move pa-new-eff-dt          to la-effect-date-a2
  3345     move pa-new-cert-no         to la-cert-no-a2
  3346
  3347* exec cics rewrite
  3348*       dataset  ('ERARCH')
  3349*       from     (letter-archive)
  3350*       resp     (ws-response)
  3351*    end-exec
  3352     MOVE LENGTH OF
  3353      letter-archive
  3354       TO DFHEIV11
  3355     MOVE 'ERARCH' TO DFHEIV1
  3356*    MOVE '&& L                  %  N#00002942' TO DFHEIV0
  3357     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3358     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3359     MOVE X'204E233030303032393432' TO DFHEIV0(25:11)
  3360     CALL 'kxdfhei1' USING DFHEIV0,
  3361           DFHEIV1,
  3362           letter-archive,
  3363           DFHEIV11,
  3364           DFHEIV99
  3365     MOVE EIBRESP  TO ws-response
  3366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3367     if not resp-normal
  3368        move ws-response         to ra-status-code
  3369        move ' erarch write  error '
  3370                                 to ra-message
  3371        display 'error-erarch-write   ' ws-response
  3372        go to 0000-return
  3373     end-if
  3374     perform 0500-process-nsasextr thru 0500-exit
  3375     go to 0100-erarch-loop
  3376     .
  3377 0100-end-erarch.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  60
* EL055.cbl
  3378     if ws-startbr-ind = 'Y'
  3379
  3380* exec cics endbr
  3381*          dataset     ('ERARCH2')
  3382*       end-exec
  3383     MOVE 'ERARCH2' TO DFHEIV1
  3384     MOVE 0
  3385       TO DFHEIV11
  3386*    MOVE '&2                    $   #00002959' TO DFHEIV0
  3387     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3388     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3389     MOVE X'2020233030303032393539' TO DFHEIV0(25:11)
  3390     CALL 'kxdfhei1' USING DFHEIV0,
  3391           DFHEIV1,
  3392           DFHEIV11,
  3393           DFHEIV99
  3394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3395     end-if
  3396     .
  3397 0100-erchek.
  3398**** ======================================================== ****
  3399****                                                          ****
  3400****    Check for ERCHEK records                              ****
  3401****                                                          ****
  3402**** ======================================================== ****
  3403     move ' '                    to ws-startbr-ind
  3404     move ws-old-pndb-key(1:33)  to erchek-ridfld(1:33)
  3405     move +0                     to erchek-seq-no
  3406
  3407* exec cics startbr
  3408*       dataset    ('ERCHEK')
  3409*       ridfld     (erchek-ridfld)
  3410*       gteq
  3411*       resp       (ws-response)
  3412*    end-exec
  3413     MOVE 'ERCHEK' TO DFHEIV1
  3414     MOVE 0
  3415       TO DFHEIV11
  3416*    MOVE '&,         G          &  N#00002973' TO DFHEIV0
  3417     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3418     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3419     MOVE X'204E233030303032393733' TO DFHEIV0(25:11)
  3420     CALL 'kxdfhei1' USING DFHEIV0,
  3421           DFHEIV1,
  3422           erchek-ridfld,
  3423           DFHEIV99,
  3424           DFHEIV11,
  3425           DFHEIV99
  3426     MOVE EIBRESP  TO ws-response
  3427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3428     if RESP-NOTFND or resp-endfile
  3429        go to 0100-end-erchek
  3430     else
  3431        if not resp-normal
  3432           move ws-response      to ra-status-code
  3433           move ' erchek error startbr '
  3434                                 to ra-message
  3435           display 'error-erchek-startbr ' ws-response
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  61
* EL055.cbl
  3436           go to 0000-return
  3437        end-if
  3438     end-if
  3439     move 'Y'                    to ws-startbr-ind
  3440     .
  3441 0100-erchek-loop.
  3442
  3443* exec cics readnext
  3444*       dataset    ('ERCHEK')
  3445*       ridfld     (erchek-ridfld)
  3446*       into       (check-records)
  3447*       resp       (ws-response)
  3448*    end-exec
  3449     MOVE LENGTH OF
  3450      check-records
  3451       TO DFHEIV12
  3452     MOVE 'ERCHEK' TO DFHEIV1
  3453     MOVE 0
  3454       TO DFHEIV11
  3455*    MOVE '&.IL                  )  N#00002993' TO DFHEIV0
  3456     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3457     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3458     MOVE X'204E233030303032393933' TO DFHEIV0(25:11)
  3459     CALL 'kxdfhei1' USING DFHEIV0,
  3460           DFHEIV1,
  3461           check-records,
  3462           DFHEIV12,
  3463           erchek-ridfld,
  3464           DFHEIV99,
  3465           DFHEIV11,
  3466           DFHEIV99,
  3467           DFHEIV99
  3468     MOVE EIBRESP  TO ws-response
  3469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3470     if (RESP-NOTFND)
  3471        or (resp-endfile)
  3472        or (erchek-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3473        go to 0100-end-erchek
  3474     else
  3475        if not resp-normal
  3476           move ws-response      to ra-status-code
  3477           move ' erchek error readnext '
  3478                                 to ra-message
  3479           display 'error-erchek-readnext ' ws-response
  3480           go to 0000-return
  3481        end-if
  3482     end-if
  3483***  delete and add with new key right here!!!
  3484
  3485* exec cics delete
  3486*       dataset  ('ERCHEK')
  3487*       ridfld   (erchek-ridfld)
  3488*       resp     (ws-response)
  3489*    end-exec
  3490     MOVE 'ERCHEK' TO DFHEIV1
  3491*    MOVE '&(  R                 &  N#00003013' TO DFHEIV0
  3492     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  62
* EL055.cbl
  3494     MOVE X'204E233030303033303133' TO DFHEIV0(25:11)
  3495     CALL 'kxdfhei1' USING DFHEIV0,
  3496           DFHEIV1,
  3497           erchek-ridfld,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99
  3501     MOVE EIBRESP  TO ws-response
  3502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3503     if not resp-normal
  3504        move ws-response         to ra-status-code
  3505        move ' erchek delete error '
  3506                                 to ra-message
  3507        display 'error-erchek-delete  ' ws-response
  3508        go to 0000-return
  3509     end-if
  3510     move pa-new-eff-dt          to ch-cert-eff-dt
  3511     move pa-new-cert-no         to ch-cert-no
  3512
  3513* exec cics write
  3514*       dataset  ('ERCHEK')
  3515*       from     (check-records)
  3516*       ridfld   (ch-control-primary)
  3517*       resp     (ws-response)
  3518*    end-exec
  3519     MOVE LENGTH OF
  3520      check-records
  3521       TO DFHEIV11
  3522     MOVE 'ERCHEK' TO DFHEIV1
  3523*    MOVE '&$ L                  ''  N#00003027' TO DFHEIV0
  3524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3526     MOVE X'204E233030303033303237' TO DFHEIV0(25:11)
  3527     CALL 'kxdfhei1' USING DFHEIV0,
  3528           DFHEIV1,
  3529           check-records,
  3530           DFHEIV11,
  3531           ch-control-primary,
  3532           DFHEIV99,
  3533           DFHEIV99
  3534     MOVE EIBRESP  TO ws-response
  3535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3536     if not resp-normal
  3537        move ws-response         to ra-status-code
  3538        move ' erchek write  error '
  3539                                 to ra-message
  3540        display 'error-erchek-write   ' ws-response
  3541        go to 0000-return
  3542     end-if
  3543     go to 0100-erchek-loop
  3544     .
  3545 0100-end-erchek.
  3546     if ws-startbr-ind = 'Y'
  3547
  3548* exec cics endbr
  3549*          dataset     ('ERCHEK')
  3550*       end-exec
  3551     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  63
* EL055.cbl
  3552     MOVE 0
  3553       TO DFHEIV11
  3554*    MOVE '&2                    $   #00003044' TO DFHEIV0
  3555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3557     MOVE X'2020233030303033303434' TO DFHEIV0(25:11)
  3558     CALL 'kxdfhei1' USING DFHEIV0,
  3559           DFHEIV1,
  3560           DFHEIV11,
  3561           DFHEIV99
  3562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3563     end-if
  3564     .
  3565 0100-ercnot.
  3566**** ======================================================== ****
  3567****                                                          ****
  3568****    Check for ERCNOT records                              ****
  3569****                                                          ****
  3570**** ======================================================== ****
  3571     move ' '                    to ws-startbr-ind
  3572     move ws-old-pndb-key(1:33)  to ercnot-ridfld(1:33)
  3573     move opk-rec-type           to ercnot-rec-type
  3574     move +0                     to ercnot-seq-no
  3575
  3576* exec cics startbr
  3577*       dataset    ('ERCNOT')
  3578*       ridfld     (ercnot-ridfld)
  3579*       gteq
  3580*       resp       (ws-response)
  3581*    end-exec
  3582     MOVE 'ERCNOT' TO DFHEIV1
  3583     MOVE 0
  3584       TO DFHEIV11
  3585*    MOVE '&,         G          &  N#00003059' TO DFHEIV0
  3586     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3587     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3588     MOVE X'204E233030303033303539' TO DFHEIV0(25:11)
  3589     CALL 'kxdfhei1' USING DFHEIV0,
  3590           DFHEIV1,
  3591           ercnot-ridfld,
  3592           DFHEIV99,
  3593           DFHEIV11,
  3594           DFHEIV99
  3595     MOVE EIBRESP  TO ws-response
  3596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3597     if RESP-NOTFND or resp-endfile
  3598        go to 0100-end-ercnot
  3599     else
  3600        if not resp-normal
  3601           move ws-response      to ra-status-code
  3602           move ' ercnot error startbr '
  3603                                 to ra-message
  3604           display 'error-ercnot-startbr ' ws-response
  3605           go to 0000-return
  3606        end-if
  3607     end-if
  3608     move 'Y'                    to ws-startbr-ind
  3609     .
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  64
* EL055.cbl
  3610 0100-ercnot-loop.
  3611
  3612* exec cics readnext
  3613*       dataset    ('ERCNOT')
  3614*       ridfld     (ercnot-ridfld)
  3615*       into       (cert-note-file)
  3616*       resp       (ws-response)
  3617*    end-exec
  3618     MOVE LENGTH OF
  3619      cert-note-file
  3620       TO DFHEIV12
  3621     MOVE 'ERCNOT' TO DFHEIV1
  3622     MOVE 0
  3623       TO DFHEIV11
  3624*    MOVE '&.IL                  )  N#00003079' TO DFHEIV0
  3625     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3626     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3627     MOVE X'204E233030303033303739' TO DFHEIV0(25:11)
  3628     CALL 'kxdfhei1' USING DFHEIV0,
  3629           DFHEIV1,
  3630           cert-note-file,
  3631           DFHEIV12,
  3632           ercnot-ridfld,
  3633           DFHEIV99,
  3634           DFHEIV11,
  3635           DFHEIV99,
  3636           DFHEIV99
  3637     MOVE EIBRESP  TO ws-response
  3638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3639     if (RESP-NOTFND)
  3640        or (resp-endfile)
  3641        or (ercnot-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3642        go to 0100-end-ercnot
  3643     else
  3644        if not resp-normal
  3645           move ws-response      to ra-status-code
  3646           move ' ercnot error readnext '
  3647                                 to ra-message
  3648           display 'error-ercnot-readnext ' ws-response
  3649           go to 0000-return
  3650        end-if
  3651     end-if
  3652     if cz-record-type <> '1'  *>  cert note
  3653        go to 0100-ercnot-loop
  3654     end-if
  3655***  delete and add with new key right here!!!
  3656
  3657* exec cics delete
  3658*       dataset  ('ERCNOT')
  3659*       ridfld   (ercnot-ridfld)
  3660*       resp     (ws-response)
  3661*    end-exec
  3662     MOVE 'ERCNOT' TO DFHEIV1
  3663*    MOVE '&(  R                 &  N#00003102' TO DFHEIV0
  3664     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3666     MOVE X'204E233030303033313032' TO DFHEIV0(25:11)
  3667     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  65
* EL055.cbl
  3668           DFHEIV1,
  3669           ercnot-ridfld,
  3670           DFHEIV99,
  3671           DFHEIV99,
  3672           DFHEIV99
  3673     MOVE EIBRESP  TO ws-response
  3674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3675     if not resp-normal
  3676        move ws-response         to ra-status-code
  3677        move ' ercnot delete error '
  3678                                 to ra-message
  3679        display 'error-ercnot-delete  ' ws-response
  3680        go to 0000-return
  3681     end-if
  3682     move pa-new-eff-dt          to cz-cert-eff-dt
  3683     move pa-new-cert-no         to cz-cert-no
  3684
  3685* exec cics write
  3686*       dataset  ('ERCNOT')
  3687*       from     (cert-note-file)
  3688*       ridfld   (cz-control-primary)
  3689*       resp     (ws-response)
  3690*    end-exec
  3691     MOVE LENGTH OF
  3692      cert-note-file
  3693       TO DFHEIV11
  3694     MOVE 'ERCNOT' TO DFHEIV1
  3695*    MOVE '&$ L                  ''  N#00003116' TO DFHEIV0
  3696     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3697     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3698     MOVE X'204E233030303033313136' TO DFHEIV0(25:11)
  3699     CALL 'kxdfhei1' USING DFHEIV0,
  3700           DFHEIV1,
  3701           cert-note-file,
  3702           DFHEIV11,
  3703           cz-control-primary,
  3704           DFHEIV99,
  3705           DFHEIV99
  3706     MOVE EIBRESP  TO ws-response
  3707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3708     if not resp-normal
  3709        move ws-response         to ra-status-code
  3710        move ' ercnot write  error '
  3711                                 to ra-message
  3712        display 'error-ercnot-write   ' ws-response
  3713        go to 0000-return
  3714     end-if
  3715     go to 0100-ercnot-loop
  3716     .
  3717 0100-end-ercnot.
  3718     if ws-startbr-ind = 'Y'
  3719
  3720* exec cics endbr
  3721*          dataset     ('ERCNOT')
  3722*       end-exec
  3723     MOVE 'ERCNOT' TO DFHEIV1
  3724     MOVE 0
  3725       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  66
* EL055.cbl
  3726*    MOVE '&2                    $   #00003133' TO DFHEIV0
  3727     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3729     MOVE X'2020233030303033313333' TO DFHEIV0(25:11)
  3730     CALL 'kxdfhei1' USING DFHEIV0,
  3731           DFHEIV1,
  3732           DFHEIV11,
  3733           DFHEIV99
  3734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3735     end-if
  3736      .
  3737 0100-ernote.
  3738**** ======================================================== ****
  3739****                                                          ****
  3740****    Check for ERNOTE record.                              ****
  3741****                                                          ****
  3742**** ======================================================== ****
  3743     move ws-old-pndb-key(1:33)  to ernote-ridfld
  3744
  3745* exec cics read
  3746*       dataset    ('ERNOTE')
  3747*       ridfld     (ernote-ridfld)
  3748*       into       (certificate-note)
  3749*       resp       (ws-response)
  3750*    end-exec
  3751     MOVE LENGTH OF
  3752      certificate-note
  3753       TO DFHEIV11
  3754     MOVE 'ERNOTE' TO DFHEIV1
  3755*    MOVE '&"IL       E          (  N#00003145' TO DFHEIV0
  3756     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3758     MOVE X'204E233030303033313435' TO DFHEIV0(25:11)
  3759     CALL 'kxdfhei1' USING DFHEIV0,
  3760           DFHEIV1,
  3761           certificate-note,
  3762           DFHEIV11,
  3763           ernote-ridfld,
  3764           DFHEIV99,
  3765           DFHEIV99,
  3766           DFHEIV99
  3767     MOVE EIBRESP  TO ws-response
  3768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3769     if (RESP-NOTFND)
  3770        or (resp-endfile)
  3771        go to 0100-end-ernote
  3772     else
  3773        if not resp-normal
  3774           move ws-response      to ra-status-code
  3775           move ' ernote error readnext '
  3776                                 to ra-message
  3777           display 'error-ernote-readnext ' ws-response
  3778           go to 0000-return
  3779        end-if
  3780     end-if
  3781***  delete and add with new key right here!!!
  3782** 1)  Delete ERNOTE (old key)
  3783
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  67
* EL055.cbl
  3784* exec cics delete
  3785*       dataset  ('ERNOTE')
  3786*       ridfld   (ernote-ridfld)
  3787*       resp     (ws-response)
  3788*    end-exec
  3789     MOVE 'ERNOTE' TO DFHEIV1
  3790*    MOVE '&(  R                 &  N#00003165' TO DFHEIV0
  3791     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3793     MOVE X'204E233030303033313635' TO DFHEIV0(25:11)
  3794     CALL 'kxdfhei1' USING DFHEIV0,
  3795           DFHEIV1,
  3796           ernote-ridfld,
  3797           DFHEIV99,
  3798           DFHEIV99,
  3799           DFHEIV99
  3800     MOVE EIBRESP  TO ws-response
  3801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3802     if not resp-normal
  3803        move ws-response         to ra-status-code
  3804        move ' ernote delete error '
  3805                                 to ra-message
  3806        display 'error-ernote-delete  ' ws-response
  3807        go to 0000-return
  3808     end-if
  3809** 2)  Write new ERNOTE record
  3810     move pa-new-eff-dt          to cn-cert-eff-dt
  3811     move pa-new-cert-no         to cn-cert-no
  3812
  3813* exec cics write
  3814*       dataset  ('ERNOTE')
  3815*       from     (certificate-note)
  3816*       ridfld   (cn-control-primary)
  3817*       resp     (ws-response)
  3818*    end-exec
  3819     MOVE LENGTH OF
  3820      certificate-note
  3821       TO DFHEIV11
  3822     MOVE 'ERNOTE' TO DFHEIV1
  3823*    MOVE '&$ L                  ''  N#00003180' TO DFHEIV0
  3824     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3825     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3826     MOVE X'204E233030303033313830' TO DFHEIV0(25:11)
  3827     CALL 'kxdfhei1' USING DFHEIV0,
  3828           DFHEIV1,
  3829           certificate-note,
  3830           DFHEIV11,
  3831           cn-control-primary,
  3832           DFHEIV99,
  3833           DFHEIV99
  3834     MOVE EIBRESP  TO ws-response
  3835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3836     if not resp-normal
  3837        move ws-response         to ra-status-code
  3838        move ' ernote write  error '
  3839                                 to ra-message
  3840        display 'error-ernote-write   ' ws-response
  3841        go to 0000-return
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  68
* EL055.cbl
  3842     end-if
  3843     .
  3844 0100-end-ernote.
  3845     .
  3846 0100-ermail.
  3847**** ======================================================== ****
  3848****                                                          ****
  3849****    Check for ERMAIL record.                              ****
  3850****                                                          ****
  3851**** ======================================================== ****
  3852     move ws-old-pndb-key(1:33)  to ermail-ridfld
  3853
  3854* exec cics read
  3855*       dataset    ('ERMAIL')
  3856*       ridfld     (ermail-ridfld)
  3857*       into       (mailing-data)
  3858*       resp       (ws-response)
  3859*    end-exec
  3860     MOVE LENGTH OF
  3861      mailing-data
  3862       TO DFHEIV11
  3863     MOVE 'ERMAIL' TO DFHEIV1
  3864*    MOVE '&"IL       E          (  N#00003203' TO DFHEIV0
  3865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3867     MOVE X'204E233030303033323033' TO DFHEIV0(25:11)
  3868     CALL 'kxdfhei1' USING DFHEIV0,
  3869           DFHEIV1,
  3870           mailing-data,
  3871           DFHEIV11,
  3872           ermail-ridfld,
  3873           DFHEIV99,
  3874           DFHEIV99,
  3875           DFHEIV99
  3876     MOVE EIBRESP  TO ws-response
  3877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3878     if (RESP-NOTFND)
  3879        or (resp-endfile)
  3880        go to 0100-end-ermail
  3881     else
  3882        if not resp-normal
  3883           move ws-response      to ra-status-code
  3884           move ' ermail error readnext '
  3885                                 to ra-message
  3886           display 'error-ermail-readnext ' ws-response
  3887           go to 0000-return
  3888        end-if
  3889     end-if
  3890***  delete and add with new key right here!!!
  3891** 1)  Delete ERMAIL (old key)
  3892
  3893* exec cics delete
  3894*       dataset  ('ERMAIL')
  3895*       ridfld   (ermail-ridfld)
  3896*       resp     (ws-response)
  3897*    end-exec
  3898     MOVE 'ERMAIL' TO DFHEIV1
  3899*    MOVE '&(  R                 &  N#00003223' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  69
* EL055.cbl
  3900     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3902     MOVE X'204E233030303033323233' TO DFHEIV0(25:11)
  3903     CALL 'kxdfhei1' USING DFHEIV0,
  3904           DFHEIV1,
  3905           ermail-ridfld,
  3906           DFHEIV99,
  3907           DFHEIV99,
  3908           DFHEIV99
  3909     MOVE EIBRESP  TO ws-response
  3910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3911     if not resp-normal
  3912        move ws-response         to ra-status-code
  3913        move ' ermail delete error '
  3914                                 to ra-message
  3915        display 'error-ermail-delete  ' ws-response
  3916        go to 0000-return
  3917     end-if
  3918** 2)  Write new ERMAIL record
  3919     move pa-new-eff-dt          to ma-cert-eff-dt
  3920     move pa-new-cert-no         to ma-cert-no
  3921
  3922* exec cics write
  3923*       dataset  ('ERMAIL')
  3924*       from     (mailing-data)
  3925*       ridfld   (ma-control-primary)
  3926*       resp     (ws-response)
  3927*    end-exec
  3928     MOVE LENGTH OF
  3929      mailing-data
  3930       TO DFHEIV11
  3931     MOVE 'ERMAIL' TO DFHEIV1
  3932*    MOVE '&$ L                  ''  N#00003238' TO DFHEIV0
  3933     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3934     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3935     MOVE X'204E233030303033323338' TO DFHEIV0(25:11)
  3936     CALL 'kxdfhei1' USING DFHEIV0,
  3937           DFHEIV1,
  3938           mailing-data,
  3939           DFHEIV11,
  3940           ma-control-primary,
  3941           DFHEIV99,
  3942           DFHEIV99
  3943     MOVE EIBRESP  TO ws-response
  3944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3945     if not resp-normal
  3946        move ws-response         to ra-status-code
  3947        move ' ermail write  error '
  3948                                 to ra-message
  3949        display 'error-ermail-write   ' ws-response
  3950        go to 0000-return
  3951     end-if
  3952     .
  3953 0100-end-ermail.
  3954     .
  3955 0100-erendr.
  3956**** ======================================================== ****
  3957****                                                          ****
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  70
* EL055.cbl
  3958****    Check for ERENDR records                              ****
  3959****                                                          ****
  3960**** ======================================================== ****
  3961     move ' '                    to ws-startbr-ind
  3962     move ws-old-pndb-key(1:33)  to erendr-ridfld(1:33)
  3963     move +0                     to erendr-seq-no
  3964     move ' '                    to erendr-rec-type
  3965
  3966* exec cics startbr
  3967*       dataset    ('ERENDR')
  3968*       ridfld     (erendr-ridfld)
  3969*       gteq
  3970*       resp       (ws-response)
  3971*    end-exec
  3972     MOVE 'ERENDR' TO DFHEIV1
  3973     MOVE 0
  3974       TO DFHEIV11
  3975*    MOVE '&,         G          &  N#00003264' TO DFHEIV0
  3976     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3978     MOVE X'204E233030303033323634' TO DFHEIV0(25:11)
  3979     CALL 'kxdfhei1' USING DFHEIV0,
  3980           DFHEIV1,
  3981           erendr-ridfld,
  3982           DFHEIV99,
  3983           DFHEIV11,
  3984           DFHEIV99
  3985     MOVE EIBRESP  TO ws-response
  3986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3987     if RESP-NOTFND or resp-endfile
  3988        go to 0100-end-erendr
  3989     else
  3990        if not resp-normal
  3991           move ws-response      to ra-status-code
  3992           move ' erendr error startbr '
  3993                                 to ra-message
  3994           display 'error-erendr-startbr ' ws-response
  3995           go to 0000-return
  3996        end-if
  3997     end-if
  3998     move 'Y'                    to ws-startbr-ind
  3999     .
  4000 0100-erendr-loop.
  4001
  4002* exec cics readnext
  4003*       dataset    ('ERENDR')
  4004*       ridfld     (erendr-ridfld)
  4005*       into       (endorsement-record)
  4006*       resp       (ws-response)
  4007*    end-exec
  4008     MOVE LENGTH OF
  4009      endorsement-record
  4010       TO DFHEIV12
  4011     MOVE 'ERENDR' TO DFHEIV1
  4012     MOVE 0
  4013       TO DFHEIV11
  4014*    MOVE '&.IL                  )  N#00003284' TO DFHEIV0
  4015     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  71
* EL055.cbl
  4016     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4017     MOVE X'204E233030303033323834' TO DFHEIV0(25:11)
  4018     CALL 'kxdfhei1' USING DFHEIV0,
  4019           DFHEIV1,
  4020           endorsement-record,
  4021           DFHEIV12,
  4022           erendr-ridfld,
  4023           DFHEIV99,
  4024           DFHEIV11,
  4025           DFHEIV99,
  4026           DFHEIV99
  4027     MOVE EIBRESP  TO ws-response
  4028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4029     if (RESP-NOTFND)
  4030        or (resp-endfile)
  4031        or (erendr-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4032        go to 0100-end-erendr
  4033     else
  4034        if not resp-normal
  4035           move ws-response      to ra-status-code
  4036           move ' erendr error readnext '
  4037                                 to ra-message
  4038           display 'error-erendr-readnext ' ws-response
  4039           go to 0000-return
  4040        end-if
  4041     end-if
  4042     if en-rec-type <> '1'  *>  Issue record
  4043        go to 0100-erendr-loop
  4044     end-if
  4045***  delete and add with new key right here!!!
  4046
  4047* exec cics delete
  4048*       dataset  ('ERENDR')
  4049*       ridfld   (erendr-ridfld)
  4050*       resp     (ws-response)
  4051*    end-exec
  4052     MOVE 'ERENDR' TO DFHEIV1
  4053*    MOVE '&(  R                 &  N#00003307' TO DFHEIV0
  4054     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4055     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4056     MOVE X'204E233030303033333037' TO DFHEIV0(25:11)
  4057     CALL 'kxdfhei1' USING DFHEIV0,
  4058           DFHEIV1,
  4059           erendr-ridfld,
  4060           DFHEIV99,
  4061           DFHEIV99,
  4062           DFHEIV99
  4063     MOVE EIBRESP  TO ws-response
  4064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4065     if not resp-normal
  4066        move ws-response         to ra-status-code
  4067        move ' erendr delete error '
  4068                                 to ra-message
  4069        display 'error-erendr-delete  ' ws-response
  4070        go to 0000-return
  4071     end-if
  4072     move pa-new-eff-dt          to en-cert-eff-dt
  4073     move pa-new-cert-no         to en-cert-no
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  72
* EL055.cbl
  4074
  4075* exec cics write
  4076*       dataset  ('ERENDR')
  4077*       from     (ENDORSEMENT-RECORD)
  4078*       ridfld   (en-control-primary)
  4079*       resp     (ws-response)
  4080*    end-exec
  4081     MOVE LENGTH OF
  4082      ENDORSEMENT-RECORD
  4083       TO DFHEIV11
  4084     MOVE 'ERENDR' TO DFHEIV1
  4085*    MOVE '&$ L                  ''  N#00003321' TO DFHEIV0
  4086     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4088     MOVE X'204E233030303033333231' TO DFHEIV0(25:11)
  4089     CALL 'kxdfhei1' USING DFHEIV0,
  4090           DFHEIV1,
  4091           ENDORSEMENT-RECORD,
  4092           DFHEIV11,
  4093           en-control-primary,
  4094           DFHEIV99,
  4095           DFHEIV99
  4096     MOVE EIBRESP  TO ws-response
  4097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4098     if not resp-normal
  4099        move ws-response         to ra-status-code
  4100        move ' erendr write  error '
  4101                                 to ra-message
  4102        display 'error-erendr-write   ' ws-response
  4103        go to 0000-return
  4104     end-if
  4105     go to 0100-erendr-loop
  4106     .
  4107 0100-end-erendr.
  4108     if ws-startbr-ind = 'Y'
  4109
  4110* exec cics endbr
  4111*          dataset     ('ERENDR')
  4112*       end-exec
  4113     MOVE 'ERENDR' TO DFHEIV1
  4114     MOVE 0
  4115       TO DFHEIV11
  4116*    MOVE '&2                    $   #00003338' TO DFHEIV0
  4117     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4118     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4119     MOVE X'2020233030303033333338' TO DFHEIV0(25:11)
  4120     CALL 'kxdfhei1' USING DFHEIV0,
  4121           DFHEIV1,
  4122           DFHEIV11,
  4123           DFHEIV99
  4124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4125     end-if
  4126     .
  4127 0100-erendt.
  4128**** ======================================================== ****
  4129****                                                          ****
  4130****    Check for ERENDT records                              ****
  4131****                                                          ****
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  73
* EL055.cbl
  4132**** ======================================================== ****
  4133     move ' '                    to ws-startbr-ind
  4134     move ws-old-pndb-key(1:33)  to erendt-ridfld(1:33)
  4135     move ' '                    to erendt-rec-type
  4136     move +0                     to erendt-seq-no
  4137
  4138* exec cics startbr
  4139*       dataset    ('ERENDT')
  4140*       ridfld     (erendt-ridfld)
  4141*       gteq
  4142*       resp       (ws-response)
  4143*    end-exec
  4144     MOVE 'ERENDT' TO DFHEIV1
  4145     MOVE 0
  4146       TO DFHEIV11
  4147*    MOVE '&,         G          &  N#00003353' TO DFHEIV0
  4148     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4149     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4150     MOVE X'204E233030303033333533' TO DFHEIV0(25:11)
  4151     CALL 'kxdfhei1' USING DFHEIV0,
  4152           DFHEIV1,
  4153           erendt-ridfld,
  4154           DFHEIV99,
  4155           DFHEIV11,
  4156           DFHEIV99
  4157     MOVE EIBRESP  TO ws-response
  4158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4159     if RESP-NOTFND or resp-endfile
  4160        go to 0100-end-erendt
  4161     else
  4162        if not resp-normal
  4163           move ws-response      to ra-status-code
  4164           move ' erendt error startbr '
  4165                                 to ra-message
  4166           display 'error-erendt-startbr ' ws-response
  4167           go to 0000-return
  4168        end-if
  4169     end-if
  4170     move 'Y'                    to ws-startbr-ind
  4171     .
  4172 0100-erendt-loop.
  4173
  4174* exec cics readnext
  4175*       dataset    ('ERENDT')
  4176*       ridfld     (erendt-ridfld)
  4177*       into       (endt-record)
  4178*       resp       (ws-response)
  4179*    end-exec
  4180     MOVE LENGTH OF
  4181      endt-record
  4182       TO DFHEIV12
  4183     MOVE 'ERENDT' TO DFHEIV1
  4184     MOVE 0
  4185       TO DFHEIV11
  4186*    MOVE '&.IL                  )  N#00003373' TO DFHEIV0
  4187     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4188     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4189     MOVE X'204E233030303033333733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  74
* EL055.cbl
  4190     CALL 'kxdfhei1' USING DFHEIV0,
  4191           DFHEIV1,
  4192           endt-record,
  4193           DFHEIV12,
  4194           erendt-ridfld,
  4195           DFHEIV99,
  4196           DFHEIV11,
  4197           DFHEIV99,
  4198           DFHEIV99
  4199     MOVE EIBRESP  TO ws-response
  4200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4201     if (RESP-NOTFND)
  4202        or (resp-endfile)
  4203        or (erendt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4204        go to 0100-end-erendt
  4205     else
  4206        if not resp-normal
  4207           move ws-response      to ra-status-code
  4208           move ' erendt error readnext '
  4209                                 to ra-message
  4210           display 'error-erendt-readnext ' ws-response
  4211           go to 0000-return
  4212        end-if
  4213     end-if
  4214     if et-rec-type <> 'I'  *>  Issue record
  4215        go to 0100-erendt-loop
  4216     end-if
  4217***  delete and add with new key right here!!!
  4218
  4219* exec cics delete
  4220*       dataset  ('ERENDT')
  4221*       ridfld   (erendt-ridfld)
  4222*       resp     (ws-response)
  4223*    end-exec
  4224     MOVE 'ERENDT' TO DFHEIV1
  4225*    MOVE '&(  R                 &  N#00003396' TO DFHEIV0
  4226     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4228     MOVE X'204E233030303033333936' TO DFHEIV0(25:11)
  4229     CALL 'kxdfhei1' USING DFHEIV0,
  4230           DFHEIV1,
  4231           erendt-ridfld,
  4232           DFHEIV99,
  4233           DFHEIV99,
  4234           DFHEIV99
  4235     MOVE EIBRESP  TO ws-response
  4236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4237     if not resp-normal
  4238        move ws-response         to ra-status-code
  4239        move ' erendt delete error '
  4240                                 to ra-message
  4241        display 'error-erendt-delete  ' ws-response
  4242        go to 0000-return
  4243     end-if
  4244     move pa-new-eff-dt          to et-cert-eff-dt
  4245     move pa-new-cert-no         to et-cert-no
  4246
  4247* exec cics write
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  75
* EL055.cbl
  4248*       dataset  ('ERENDT')
  4249*       from     (ENDT-RECORD)
  4250*       ridfld   (et-control-primary)
  4251*       resp     (ws-response)
  4252*    end-exec
  4253     MOVE LENGTH OF
  4254      ENDT-RECORD
  4255       TO DFHEIV11
  4256     MOVE 'ERENDT' TO DFHEIV1
  4257*    MOVE '&$ L                  ''  N#00003410' TO DFHEIV0
  4258     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4259     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4260     MOVE X'204E233030303033343130' TO DFHEIV0(25:11)
  4261     CALL 'kxdfhei1' USING DFHEIV0,
  4262           DFHEIV1,
  4263           ENDT-RECORD,
  4264           DFHEIV11,
  4265           et-control-primary,
  4266           DFHEIV99,
  4267           DFHEIV99
  4268     MOVE EIBRESP  TO ws-response
  4269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4270     if not resp-normal
  4271        move ws-response         to ra-status-code
  4272        move ' erendt write  error '
  4273                                 to ra-message
  4274        display 'error-erendt-write   ' ws-response
  4275        go to 0000-return
  4276     end-if
  4277     go to 0100-erendt-loop
  4278     .
  4279 0100-end-erendt.
  4280     if ws-startbr-ind = 'Y'
  4281
  4282* exec cics endbr
  4283*          dataset     ('ERENDT')
  4284*       end-exec
  4285     MOVE 'ERENDT' TO DFHEIV1
  4286     MOVE 0
  4287       TO DFHEIV11
  4288*    MOVE '&2                    $   #00003427' TO DFHEIV0
  4289     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4290     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4291     MOVE X'2020233030303033343237' TO DFHEIV0(25:11)
  4292     CALL 'kxdfhei1' USING DFHEIV0,
  4293           DFHEIV1,
  4294           DFHEIV11,
  4295           DFHEIV99
  4296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4297     end-if
  4298     .
  4299 0100-exit.
  4300     exit.
  4301 0200-convert-key.
  4302     .
  4303 0200-exit.
  4304     exit.
  4305 0500-process-nsasextr.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  76
* EL055.cbl
  4306**** ======================================================== ****
  4307****                                                          ****
  4308****    Check for NSASEXTR records                            ****
  4309****                                                          ****
  4310**** ======================================================== ****
  4311     move ' '                    to ws-NS-startbr-ind
  4312     move +0                     to nsasextr-seq-no
  4313
  4314* exec cics startbr
  4315*       dataset    ('NSASEXTR')
  4316*       ridfld     (nsasextr-ridfld)
  4317*       gteq
  4318*       resp       (ws-response)
  4319*    end-exec
  4320     MOVE 'NSASEXTR' TO DFHEIV1
  4321     MOVE 0
  4322       TO DFHEIV11
  4323*    MOVE '&,         G          &  N#00003446' TO DFHEIV0
  4324     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4325     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4326     MOVE X'204E233030303033343436' TO DFHEIV0(25:11)
  4327     CALL 'kxdfhei1' USING DFHEIV0,
  4328           DFHEIV1,
  4329           nsasextr-ridfld,
  4330           DFHEIV99,
  4331           DFHEIV11,
  4332           DFHEIV99
  4333     MOVE EIBRESP  TO ws-response
  4334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4335     if RESP-NOTFND or resp-endfile
  4336        go to 0500-end-nsasextr
  4337     else
  4338        if not resp-normal
  4339           move ws-response      to ra-status-code
  4340           move ' nsasextr error startbr '
  4341                                 to ra-message
  4342           display 'error-nsasextr-startbr ' ws-response
  4343           go to 0000-return
  4344        end-if
  4345     end-if
  4346     move 'Y'                    to ws-NS-startbr-ind
  4347     .
  4348 0500-nsasextr-loop.
  4349
  4350* exec cics readnext
  4351*       dataset    ('NSASEXTR')
  4352*       ridfld     (nsasextr-ridfld)
  4353*       into       (nsas-extract-record)
  4354*       resp       (ws-response)
  4355*    end-exec
  4356     MOVE LENGTH OF
  4357      nsas-extract-record
  4358       TO DFHEIV12
  4359     MOVE 'NSASEXTR' TO DFHEIV1
  4360     MOVE 0
  4361       TO DFHEIV11
  4362*    MOVE '&.IL                  )  N#00003466' TO DFHEIV0
  4363     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  77
* EL055.cbl
  4364     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4365     MOVE X'204E233030303033343636' TO DFHEIV0(25:11)
  4366     CALL 'kxdfhei1' USING DFHEIV0,
  4367           DFHEIV1,
  4368           nsas-extract-record,
  4369           DFHEIV12,
  4370           nsasextr-ridfld,
  4371           DFHEIV99,
  4372           DFHEIV11,
  4373           DFHEIV99,
  4374           DFHEIV99
  4375     MOVE EIBRESP  TO ws-response
  4376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4377     if (RESP-NOTFND)
  4378        or (resp-endfile)
  4379        or (nsas-company-cd <> opk-company-cd)
  4380        or (nsas-archive-no <> la-archive-no)
  4381        go to 0500-end-nsasextr
  4382     else
  4383        if not resp-normal
  4384           move ws-response      to ra-status-code
  4385           move ' nsasextr error readnext '
  4386                                 to ra-message
  4387           display 'error-nsasextr-readnext ' ws-response
  4388           go to 0000-return
  4389        end-if
  4390     end-if
  4391     move nsas-control-primary   to nsasextr-ridfld
  4392
  4393* exec cics read update
  4394*       dataset  ('NSASEXTR')
  4395*       into     (nsas-extract-record)
  4396*       ridfld   (nsasextr-ridfld)
  4397*       resp     (ws-response)
  4398*    end-exec
  4399     MOVE LENGTH OF
  4400      nsas-extract-record
  4401       TO DFHEIV11
  4402     MOVE 'NSASEXTR' TO DFHEIV1
  4403*    MOVE '&"IL       EU         (  N#00003487' TO DFHEIV0
  4404     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4405     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4406     MOVE X'204E233030303033343837' TO DFHEIV0(25:11)
  4407     CALL 'kxdfhei1' USING DFHEIV0,
  4408           DFHEIV1,
  4409           nsas-extract-record,
  4410           DFHEIV11,
  4411           nsasextr-ridfld,
  4412           DFHEIV99,
  4413           DFHEIV99,
  4414           DFHEIV99
  4415     MOVE EIBRESP  TO ws-response
  4416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4417     if not resp-normal
  4418        move ws-response         to ra-status-code
  4419        move ' nsasextr read update error '
  4420                                 to ra-message
  4421        display 'error-nsasextr-read update ' ws-response
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  78
* EL055.cbl
  4422        go to 0000-return
  4423     end-if
  4424     move zeros                  to nscntr
  4425     perform varying ns1 from +1 by +1 until
  4426        nscntr = +10
  4427        if nsas-letter-variables(ns1:1) = '~'
  4428           compute nscntr = nscntr + 1
  4429        end-if
  4430     end-perform
  4431     if nscntr = +10
  4432        if (nsas-letter-variables(ns1:10) =
  4433              ws-old-greg-eff-date)
  4434           and (nsas-letter-variables(ns1:10) <>
  4435              ws-new-greg-eff-date)
  4436           move ws-new-greg-eff-date
  4437                                 to nsas-letter-variables(ns1:10)
  4438        end-if
  4439        perform varying ns1 from ns1 by +1
  4440           until (nsas-letter-variables(ns1:1) = '~')
  4441              or (ns1 > +4000)
  4442        end-perform
  4443        compute ns1 = ns1 + 1
  4444        if ns1 < +4000
  4445           if (nsas-letter-variables(ns1:11) =
  4446                 opk-cert-no)
  4447              and (nsas-letter-variables(ns1:11) <>
  4448                 pa-new-cert-no)
  4449              move pa-new-cert-no to
  4450                 nsas-letter-variables(ns1:11)
  4451           end-if
  4452        end-if
  4453     end-if
  4454
  4455* exec cics rewrite
  4456*       dataset  ('NSASEXTR')
  4457*       from     (nsas-extract-record)
  4458*       resp     (ws-response)
  4459*    end-exec
  4460     MOVE LENGTH OF
  4461      nsas-extract-record
  4462       TO DFHEIV11
  4463     MOVE 'NSASEXTR' TO DFHEIV1
  4464*    MOVE '&& L                  %  N#00003530' TO DFHEIV0
  4465     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4466     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4467     MOVE X'204E233030303033353330' TO DFHEIV0(25:11)
  4468     CALL 'kxdfhei1' USING DFHEIV0,
  4469           DFHEIV1,
  4470           nsas-extract-record,
  4471           DFHEIV11,
  4472           DFHEIV99
  4473     MOVE EIBRESP  TO ws-response
  4474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4475     if not resp-normal
  4476        move ws-response         to ra-status-code
  4477        move ' nsasextr write  error '
  4478                                 to ra-message
  4479        display 'error-nsasextr-write   ' ws-response
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  79
* EL055.cbl
  4480        go to 0000-return
  4481     end-if
  4482     go to 0500-nsasextr-loop
  4483     .
  4484 0500-end-nsasextr.
  4485     if ws-NS-startbr-ind = 'Y'
  4486
  4487* exec cics endbr
  4488*          dataset     ('NSASEXTR')
  4489*       end-exec
  4490     MOVE 'NSASEXTR' TO DFHEIV1
  4491     MOVE 0
  4492       TO DFHEIV11
  4493*    MOVE '&2                    $   #00003546' TO DFHEIV0
  4494     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4496     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  4497     CALL 'kxdfhei1' USING DFHEIV0,
  4498           DFHEIV1,
  4499           DFHEIV11,
  4500           DFHEIV99
  4501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4502     end-if
  4503     .
  4504 0500-exit.
  4505     exit.
  4506 8500-DATE-CONVERT.
  4507
  4508* EXEC CICS LINK
  4509*        PROGRAM  ('ELDATCV')
  4510*        COMMAREA (DATE-CONVERSION-DATA)
  4511*        LENGTH   (DC-COMM-LENGTH)
  4512*    END-EXEC
  4513     MOVE 'ELDATCV' TO DFHEIV1
  4514*    MOVE '."C                   (   #00003554' TO DFHEIV0
  4515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4517     MOVE X'2020233030303033353534' TO DFHEIV0(25:11)
  4518     CALL 'kxdfhei1' USING DFHEIV0,
  4519           DFHEIV1,
  4520           DATE-CONVERSION-DATA,
  4521           DC-COMM-LENGTH,
  4522           DFHEIV99,
  4523           DFHEIV99,
  4524           DFHEIV99,
  4525           DFHEIV99
  4526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4527     .
  4528 8500-EXIT.
  4529     EXIT.
  4530
  4531 9999-DFHBACK SECTION.
  4532     MOVE '9%                    "   ' TO DFHEIV0
  4533     MOVE 'EL055' TO DFHEIV1
  4534     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4535     GOBACK.
  4536 9999-DFHEXIT.
  4537     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 10-Jul-20 12:00 Page  80
* EL055.cbl
  4538         NEXT SENTENCE.
  4539     MOVE '9%                    "   ' TO DFHEIV0
  4540     MOVE 'EL055' TO DFHEIV1
  4541     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4542     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13688     Code:       15975
