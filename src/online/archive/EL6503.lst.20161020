* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6503.cbl
* Options: int("EL6503.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6503.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6503.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6503.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6503.
     3*                            VMOD=2.001.
     4*AUTHOR.    PABLO.
     5*           OMAHA, NEBRASKA.
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6503.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE BRANCH LOCATION AND SHIPPING ADDRESSES FOR PRODUCERS
    19*
    20*    SCREENS     - EL650I - BRANCH LOCAL AND SHIPPING ADDR MAINT
    21*
    22*    ENTERED BY  - EL650 - ACCOUNT MAINTENANCE MENU
    23*
    24*    EXIT TO     - EL650 - ACCOUNT MAINTENANCE MENU
    25*
    26*    COMMAREA    - PASSED
    27*
    28*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL650.  ON
    29*                  FIRST ENTRY, READ ERACNT TO DISPLAY INFO,  THE
    30*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    31*                  ENTRIES (XCTL FROM CICS VIA EXC7) THE SCREEN
    32*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    33*                  MAINTENANCE TYPE INDICATED.
    34******************************************************************
    35*                   C H A N G E   L O G
    36*
    37* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    38*-----------------------------------------------------------------
    39*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    40* EFFECTIVE    NUMBER
    41*-----------------------------------------------------------------
    42* 110706  CR2006071700004  PEMA  NEW PROGRAM
    43* 111407  CR2007010300001  PEMA  USE ACCT SEC FOR THIS PROGRAM
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*   EL6503 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    52 77  CI1                PIC S999  COMP-3 VALUE +0.
    53 77  B1                 PIC S999  COMP-3 VALUE +0.
    54 77  WS-BROWSE-SW                PIC X   VALUE SPACES.
    55     88  ERACNT-BROWSE-STARTED         VALUE 'Y'.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6503.cbl
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-DATE-AREA.
   108     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   109     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   110 01  WS-INC-DATE                 PIC XX  VALUE LOW-VALUES.
   111 01  WS-RPT-DATE                 PIC XX  VALUE LOW-VALUES.
   112 01  WS-EST-DATE                 PIC XX  VALUE LOW-VALUES.
   113 01  WS-PRF-DATE                 PIC XX  VALUE LOW-VALUES.
   114 01  WS-LSTPD-DATE               PIC XX  VALUE LOW-VALUES.
   115 01  FILLER                          COMP-3.
   116     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   117     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   118     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   119     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   120     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   121       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   122       88  INITIAL-TRANSACTION                       VALUE +2.
   123       88  CHANGE-SUCCESSFUL                         VALUE +3.
   124     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   125     05  TIME-OUT                    REDEFINES
   126         TIME-IN                     PIC S9(3)V9(4).
   127 01  FILLER                          COMP SYNC.
   128     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   129     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6503.cbl
   130     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   131     05  ERACNT-LENGTH               PIC S9(4)   VALUE +120.
   132     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   133 01  FILLER.
   134     12  DEEDIT-FIELD        PIC  X(10).
   135     12  DEEDIT-FIELD-V0  REDEFINES
   136         DEEDIT-FIELD        PIC S9(10).
   137     12  DEEDIT-FIELD-V2  REDEFINES
   138         DEEDIT-FIELD        PIC 9(8)V99.
   139     05  WS-BIN-DATES OCCURS 10.
   140         10  WS-BIN-DATE         PIC XX.
   141     05  WS-RESPONSE             PIC S9(8)   COMP.
   142         88  RESP-NORMAL              VALUE +00.
   143         88  RESP-ERROR               VALUE +01.
   144         88  RESP-NOTFND              VALUE +13.
   145         88  RESP-NOTOPEN             VALUE +19.
   146         88  RESP-ENDFILE             VALUE +20.
   147     05  WS-SAVE-ERACNT-KEY      PIC X(23)   VALUE LOW-VALUES.
   148     05  WS-CONTROL-PRIMARY.
   149         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   150         10  WS-CARRIER              PIC X      VALUE SPACES.
   151         10  WS-GROUPING             PIC X(6)   VALUE SPACES.
   152         10  WS-STATE                PIC XX     VALUE SPACES.
   153         10  WS-ACCOUNT              PIC X(10)  VALUE SPACES.
   154         10  WS-REC-TYPE             PIC X      VALUE SPACES.
   155         10  WS-SEQ-NO               PIC S9(4)  VALUE +0 COMP.
   156     05  WS-CONTROL-FILE-KEY.
   157         10  WS-CFK-COMPANY-ID       PIC X(3)    VALUE SPACES.
   158         10  WS-CFK-RECORD-TYPE      PIC X       VALUE SPACES.
   159         10  WS-CFK-STATE            PIC XX      VALUE SPACES.
   160         10  WS-CFK-BENEFIT-CD       PIC XX      VALUE SPACES.
   161         10  WS-CFK-SEQUENCE-NO      PIC S9(4)   VALUE ZERO COMP.
   162     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL6503S'.
   163     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL6503A'.
   164     05  FILLER                      REDEFINES
   165         WS-MAP-NAME.
   166         10  FILLER                  PIC XX.
   167         10  WS-MAP-NUMBER           PIC X(4).
   168         10  FILLER                  PIC XX.
   169     05  THIS-PGM                    PIC X(8)  VALUE 'EL6503'.
   170     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   171     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   172     05  WS-SPACE                    PIC X       VALUE SPACE.
   173     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXC7'.
   174     05  WS-TEMP-STORAGE-KEY.
   175         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   176         10  FILLER                  PIC X(4)    VALUE '6503'.
   177     05  WS-ERROR-MESSAGE-AREA.
   178         10  ER-0000                 PIC 9(4)   VALUE 0000.
   179         10  ER-0004                 PIC 9(4)   VALUE 0004.
   180         10  ER-0006                 PIC 9(4)   VALUE 0006.
   181         10  ER-0008                 PIC 9(4)   VALUE 0008.
   182         10  ER-0023                 PIC 9(4)   VALUE 0023.
   183         10  ER-0029                 PIC 9(4)   VALUE 0029.
   184         10  ER-0070                 PIC 9(4)   VALUE 0070.
   185         10  ER-0150                 PIC 9(4)   VALUE 0150.
   186         10  ER-0196                 PIC 9(4)   VALUE 0196.
   187         10  ER-0419                 PIC 9(4)   VALUE 0419.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6503.cbl
   188         10  ER-0491                 PIC 9(4)   VALUE 0491.
   189         10  ER-1079                 PIC 9(4)   VALUE 1079.
   190         10  ER-1257                 PIC 9(4)   VALUE 1257.
   191         10  ER-1258                 PIC 9(4)   VALUE 1258.
   192         10  ER-2261                 PIC 9(4)   VALUE 2261.
   193         10  ER-3800                 PIC 9(4)   VALUE 3800.
   194         10  ER-3801                 PIC 9(4)   VALUE 3801.
   195         10  ER-3802                 PIC 9(4)   VALUE 3802.
   196         10  ER-3803                 PIC 9(4)   VALUE 3803.
   197         10  ER-3804                 PIC 9(4)   VALUE 3804.
   198         10  ER-3805                 PIC 9(4)   VALUE 3805.
   199         10  ER-3806                 PIC 9(4)   VALUE 3806.
   200         10  ER-3807                 PIC 9(4)   VALUE 3807.
   201         10  ER-3810                 PIC 9(4)   VALUE 3810.
   202         10  ER-3811                 PIC 9(4)   VALUE 3811.
   203         10  ER-3812                 PIC 9(4)   VALUE 3812.
   204         10  ER-3813                 PIC 9(4)   VALUE 3813.
   205         10  ER-3814                 PIC 9(4)   VALUE 3814.
   206         10  ER-3815                 PIC 9(4)   VALUE 3815.
   207         10  ER-3816                 PIC 9(4)   VALUE 3816.
   208         10  ER-3817                 PIC 9(4)   VALUE 3817.
   209         10  ER-3818                 PIC 9(4)   VALUE 3818.
   210         10  ER-3819                 PIC 9(4)   VALUE 3819.
   211         10  ER-7220                 PIC 9(4)   VALUE 7220.
   212         10  ER-7698                 PIC 9(4)   VALUE 7698.
   213         10  ER-9999                 PIC 9(4)   VALUE 9999.
   214*                                COPY ELCINTF.
   215******************************************************************
   216*                                                                *
   217*                                                                *
   218*                            ELCINTF.                            *
   219*                            VMOD=2.017                          *
   220*                                                                *
   221*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   222*                                                                *
   223*       LENGTH = 1024                                            *
   224*                                                                *
   225******************************************************************
   226 01  PROGRAM-INTERFACE-BLOCK.
   227     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   228     12  PI-CALLING-PROGRAM              PIC X(8).
   229     12  PI-SAVED-PROGRAM-1              PIC X(8).
   230     12  PI-SAVED-PROGRAM-2              PIC X(8).
   231     12  PI-SAVED-PROGRAM-3              PIC X(8).
   232     12  PI-SAVED-PROGRAM-4              PIC X(8).
   233     12  PI-SAVED-PROGRAM-5              PIC X(8).
   234     12  PI-SAVED-PROGRAM-6              PIC X(8).
   235     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   236     12  PI-COMPANY-ID                   PIC XXX.
   237     12  PI-COMPANY-CD                   PIC X.
   238
   239     12  PI-COMPANY-PASSWORD             PIC X(8).
   240
   241     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   242
   243     12  PI-CONTROL-IN-PROGRESS.
   244         16  PI-CARRIER                  PIC X.
   245         16  PI-GROUPING                 PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6503.cbl
   246         16  PI-STATE                    PIC XX.
   247         16  PI-ACCOUNT                  PIC X(10).
   248         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   249                                         PIC X(10).
   250         16  PI-CLAIM-CERT-GRP.
   251             20  PI-CLAIM-NO             PIC X(7).
   252             20  PI-CERT-NO.
   253                 25  PI-CERT-PRIME       PIC X(10).
   254                 25  PI-CERT-SFX         PIC X.
   255             20  PI-CERT-EFF-DT          PIC XX.
   256         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   257             20  PI-PLAN-CODE            PIC X(2).
   258             20  PI-REVISION-NUMBER      PIC X(3).
   259             20  PI-PLAN-EFF-DT          PIC X(2).
   260             20  PI-PLAN-EXP-DT          PIC X(2).
   261             20  FILLER                  PIC X(11).
   262         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   263             20  PI-OE-REFERENCE-1.
   264                 25  PI-OE-REF-1-PRIME   PIC X(18).
   265                 25  PI-OE-REF-1-SUFF    PIC XX.
   266
   267     12  PI-SESSION-IN-PROGRESS          PIC X.
   268         88  CLAIM-SESSION                   VALUE '1'.
   269         88  CREDIT-SESSION                  VALUE '2'.
   270         88  WARRANTY-SESSION                VALUE '3'.
   271         88  MORTGAGE-SESSION                VALUE '4'.
   272         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   273
   274
   275*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   276
   277     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   278     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   279
   280     12  PI-CREDIT-USER                  PIC X.
   281         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   282         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   283
   284     12  PI-CLAIM-USER                   PIC X.
   285         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   286         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   287
   288     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   289         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   290         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   291         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   292         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   293         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   294
   295     12  PI-PROCESSOR-ID                 PIC X(4).
   296
   297     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   298
   299     12  PI-MEMBER-CAPTION               PIC X(10).
   300
   301     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   302         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   303
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6503.cbl
   304     12  PI-LIFE-OVERRIDE-L1             PIC X.
   305     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   306     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   307     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   308
   309     12  PI-AH-OVERRIDE-L1               PIC X.
   310     12  PI-AH-OVERRIDE-L2               PIC XX.
   311     12  PI-AH-OVERRIDE-L6               PIC X(6).
   312     12  PI-AH-OVERRIDE-L12              PIC X(12).
   313
   314     12  PI-NEW-SYSTEM                   PIC X(2).
   315
   316     12  PI-PRIMARY-CERT-NO              PIC X(11).
   317     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   318         88  PI-USES-PAID-TO                 VALUE '1'.
   319     12  PI-CRDTCRD-SYSTEM.
   320         16  PI-CRDTCRD-USER             PIC X.
   321             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   322             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   323         16  PI-CC-MONTH-END-DT          PIC XX.
   324     12  PI-PROCESSOR-PRINTER            PIC X(4).
   325
   326     12  PI-OE-REFERENCE-2.
   327         16  PI-OE-REF-2-PRIME           PIC X(10).
   328         16  PI-OE-REF-2-SUFF            PIC X.
   329
   330     12  PI-REM-TRM-CALC-OPTION          PIC X.
   331
   332     12  PI-LANGUAGE-TYPE                PIC X.
   333             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   334             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   335             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   336
   337     12  PI-POLICY-LINKAGE-IND           PIC X.
   338         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   339         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   340                                                   LOW-VALUES.
   341
   342     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   343     12  PI-CLAIM-PW-SESSION             PIC X(1).
   344         88  PI-CLAIM-CREDIT                 VALUE '1'.
   345         88  PI-CLAIM-CONVEN                 VALUE '2'.
   346     12  FILLER                          PIC X(4).
   347
   348     12  PI-SYSTEM-LEVEL                 PIC X(145).
   349
   350     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   351         PI-SYSTEM-LEVEL.
   352
   353         16  PI-ENTRY-CODES.
   354             20  PI-ENTRY-CD-1           PIC X.
   355             20  PI-ENTRY-CD-2           PIC X.
   356
   357         16  PI-RETURN-CODES.
   358             20  PI-RETURN-CD-1          PIC X.
   359             20  PI-RETURN-CD-2          PIC X.
   360
   361         16  PI-UPDATE-STATUS-SAVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6503.cbl
   362             20  PI-UPDATE-BY            PIC X(4).
   363             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   364
   365         16  PI-LOWER-CASE-LETTERS       PIC X.
   366             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   367
   368*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   369*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   370*            88  CARRIER-CLM-CNTL            VALUE '2'.
   371
   372         16  PI-CERT-ACCESS-CONTROL      PIC X.
   373             88  ST-ACCNT-CNTL               VALUE ' '.
   374             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   375             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   376             88  ACCNT-CNTL                  VALUE '3'.
   377             88  CARR-ACCNT-CNTL             VALUE '4'.
   378
   379         16  PI-PROCESSOR-CAP-LIST.
   380             20  PI-SYSTEM-CONTROLS.
   381                24 PI-SYSTEM-DISPLAY     PIC X.
   382                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   383                24 PI-SYSTEM-MODIFY      PIC X.
   384                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   385             20  FILLER                  PIC XX.
   386             20  PI-DISPLAY-CAP          PIC X.
   387                 88  DISPLAY-CAP             VALUE 'Y'.
   388             20  PI-MODIFY-CAP           PIC X.
   389                 88  MODIFY-CAP              VALUE 'Y'.
   390             20  PI-MSG-AT-LOGON-CAP     PIC X.
   391                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   392             20  PI-FORCE-CAP            PIC X.
   393                 88  FORCE-CAP               VALUE 'Y'.
   394
   395         16  PI-PROGRAM-CONTROLS.
   396             20  PI-PGM-PRINT-OPT        PIC X.
   397             20  PI-PGM-FORMAT-OPT       PIC X.
   398             20  PI-PGM-PROCESS-OPT      PIC X.
   399             20  PI-PGM-TOTALS-OPT       PIC X.
   400
   401         16  PI-HELP-INTERFACE.
   402             20  PI-LAST-ERROR-NO        PIC X(4).
   403             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   404
   405         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   406             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   407
   408         16  PI-CR-CONTROL-IN-PROGRESS.
   409             20  PI-CR-CARRIER           PIC X.
   410             20  PI-CR-GROUPING          PIC X(6).
   411             20  PI-CR-STATE             PIC XX.
   412             20  PI-CR-ACCOUNT           PIC X(10).
   413             20  PI-CR-FIN-RESP          PIC X(10).
   414             20  PI-CR-TYPE              PIC X.
   415
   416         16  PI-CR-BATCH-NUMBER          PIC X(6).
   417
   418         16  PI-CR-MONTH-END-DT          PIC XX.
   419
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6503.cbl
   420         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   421             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   422             88  PI-ZERO-CARRIER             VALUE '1'.
   423             88  PI-ZERO-GROUPING            VALUE '2'.
   424             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   425
   426         16  PI-CARRIER-SECURITY         PIC X.
   427             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   428
   429         16  PI-ACCOUNT-SECURITY         PIC X(10).
   430             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   431             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   432
   433         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   434             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   435                                         INDEXED BY PI-ACCESS-NDX
   436                                         PIC X.
   437
   438         16  PI-GA-BILLING-CONTROL       PIC X.
   439             88  PI-GA-BILLING               VALUE '1'.
   440
   441         16  PI-MAIL-PROCESSING          PIC X.
   442             88  PI-MAIL-YES                 VALUE 'Y'.
   443
   444         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   445
   446         16  PI-AR-SYSTEM.
   447             20  PI-AR-PROCESSING-CNTL   PIC X.
   448                 88  PI-AR-PROCESSING        VALUE 'Y'.
   449             20  PI-AR-SUMMARY-CODE      PIC X(6).
   450             20  PI-AR-MONTH-END-DT      PIC XX.
   451
   452         16  PI-MP-SYSTEM.
   453             20  PI-MORTGAGE-USER            PIC X.
   454                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   455                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   456             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   457                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   458                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   459                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   460                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   461                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   462             20  PI-MP-MONTH-END-DT          PIC XX.
   463             20  PI-MP-REFERENCE-NO.
   464                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   465                 24  PI-MP-REFERENCE-SFX     PIC XX.
   466
   467         16  PI-LABEL-CONTROL            PIC X(01).
   468             88  PI-CREATE-LABELS                    VALUE 'Y'.
   469             88  PI-BYPASS-LABELS                    VALUE 'N'.
   470
   471         16  PI-BILL-GROUPING-CODE       PIC X(01).
   472             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   473
   474         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   475             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   476             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   477
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6503.cbl
   478         16  FILLER                      PIC X(14).
   479
   480     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   481******************************************************************
   482*                                COPY ELC650PI.
   483******************************************************************
   484*
   485*                            ELC650PI.
   486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   487*                            VMOD=2.007
   488*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   489*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   490* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   491*
   492******************************************************************
   493
   494     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   495         16  PI-MAINT                   PIC X.
   496         16  PI-PREV-ACCOUNT            PIC X(20).
   497         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   498         16  PI-ACCT-KEY.
   499             20  PI-ACCT-CCGSA-KEY.
   500                 24  PI-ACCT-CO             PIC X.
   501                 24  PI-ACCT-CARRIER        PIC X.
   502                 24  PI-ACCT-GROUPING       PIC X(6).
   503                 24  PI-ACCT-STATE          PIC XX.
   504                 24  PI-ACCT-ACCOUNT        PIC X(10).
   505             20  PI-ACCT-EXP-DT           PIC XX.
   506             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   507         16  PI-ACCT-ID                 PIC X(8).
   508         16  PI-PLAN-KEY.
   509             20  PI-PLAN-ACCT-KEY.
   510                 24  PI-PLAN-COMPANY-CD PIC X.
   511                 24  PI-PLAN-CARRIER    PIC X.
   512                 24  PI-PLAN-GROUP      PIC X(6).
   513                 24  PI-PLAN-STATE      PIC X(2).
   514                 24  PI-PLAN-ACCOUNT    PIC X(10).
   515             20  PI-PLAN-BEN-TYPE       PIC X.
   516             20  PI-PLAN-BEN            PIC XX.
   517             20  PI-PLAN-REVISION       PIC X(3).
   518         16  PI-WS-STATE                PIC XX.
   519         16  PI-WS-CLASS                PIC XX.
   520         16  PI-WS-DEV                  PIC X(3).
   521         16  PI-WS-TYPE                 PIC X.
   522         16  PI-WS-PLAN                 PIC XX.
   523
   524         16  PI-ERPNDB-ALT-KEY.
   525             20  PI-PB-COMPANY-CD-A1    PIC X.
   526             20  PI-PB-CARRIER          PIC X.
   527             20  PI-PB-GROUPING         PIC X(6).
   528             20  PI-PB-STATE            PIC XX.
   529             20  PI-PB-ACCOUNT          PIC X(10).
   530             20  PI-PB-CERT-EFF-DT      PIC XX.
   531             20  PI-PB-CERT-NO          PIC X(10).
   532             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   533             20  PI-PB-RECORD-TYPE      PIC X.
   534
   535         16  PI-DATE-RANGE-TABLE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6503.cbl
   536             20  PI-TABLE-ENT OCCURS 32 TIMES
   537                            INDEXED BY T-INDEX.
   538                 24  PI-BIN-EFF-DT          PIC XX.
   539                 24  PI-BIN-EXP-DT          PIC XX.
   540                 24  PI-BIN-MAINT-DT        PIC XX.
   541                 24  PI-BIN-LO-CERT         PIC XX.
   542                 24  PI-BIN-AR-HI-CERT      PIC XX.
   543                 24  PI-BIN-HI-CERT         PIC XX.
   544         16  PI-PAGE-NUMBER             PIC S9.
   545             88  PI-FST-PAGE               VALUE +1.
   546             88  PI-2ND-PAGE               VALUE +2.
   547             88  PI-3RD-PAGE               VALUE +3.
   548             88  PI-LST-PAGE               VALUE +4.
   549         16  PI-TOTAL-LINES             PIC S99.
   550         16  PI-LINE-SELECTED    PIC S9.
   551***  Y2K PROJ 7744
   552         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   553         16  BIN-EFFCHG-SAVE     PIC XX.
   554         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   555***  Y2K PROJ 7744
   556         16  BIN-EXPCHG-SAVE     PIC XX.
   557         16  PI-RECORD-ADDED-SW  PIC X.
   558             88  PI-RECORD-ADDED            VALUE '1'.
   559             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   560         16  PI-ACCNAME          PIC X(30).
   561         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   562         16  PI-SV-MAINT         PIC X.
   563         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   564         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   565         16  PI-UPDATE-SW        PIC X.
   566             88  PI-CHANGES-MADE             VALUE '1'.
   567         16  PI-NOTE-TYPE        PIC X.
   568             88  PI-ACCT-NOTE                VALUE '1'.
   569         16  PI-DMD-FILE-SW      PIC X.
   570             88  END-OF-FILE                 VALUE 'E'.
   571             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   572             88  FIRST-OCCURS                VALUE 'F'.
   573         16  PI-DMD-OCCURS       PIC S999.
   574         16  PI-DMD-SCREEN       PIC X.
   575             88  SCREEN-1-DISPLAYED  VALUE '1'.
   576             88  SCREEN-2-DISPLAYED  VALUE '2'.
   577             88  SCREEN-3-DISPLAYED  VALUE '3'.
   578         16  PI-NAMEFLG          PIC X.
   579         16  PI-EL650-DEL-SW     PIC X.
   580         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6503.cbl
   582*                                COPY EL6503S.
   583 01  EL6503AI.
   584     05  FILLER            PIC  X(0012).
   585*    -------------------------------
   586     05  RUNDATEL PIC S9(0004) COMP.
   587     05  RUNDATEF PIC  X(0001).
   588     05  FILLER REDEFINES RUNDATEF.
   589         10  RUNDATEA PIC  X(0001).
   590     05  RUNDATEI PIC  X(0008).
   591*    -------------------------------
   592     05  RUNTIMEL PIC S9(0004) COMP.
   593     05  RUNTIMEF PIC  X(0001).
   594     05  FILLER REDEFINES RUNTIMEF.
   595         10  RUNTIMEA PIC  X(0001).
   596     05  RUNTIMEI PIC  X(0005).
   597*    -------------------------------
   598     05  CMPNYIDL PIC S9(0004) COMP.
   599     05  CMPNYIDF PIC  X(0001).
   600     05  FILLER REDEFINES CMPNYIDF.
   601         10  CMPNYIDA PIC  X(0001).
   602     05  CMPNYIDI PIC  X(0003).
   603*    -------------------------------
   604     05  USERIDL PIC S9(0004) COMP.
   605     05  USERIDF PIC  X(0001).
   606     05  FILLER REDEFINES USERIDF.
   607         10  USERIDA PIC  X(0001).
   608     05  USERIDI PIC  X(0004).
   609*    -------------------------------
   610     05  MAINTYPL PIC S9(0004) COMP.
   611     05  MAINTYPF PIC  X(0001).
   612     05  FILLER REDEFINES MAINTYPF.
   613         10  MAINTYPA PIC  X(0001).
   614     05  MAINTYPI PIC  X(0001).
   615*    -------------------------------
   616     05  LSTDTEL PIC S9(0004) COMP.
   617     05  LSTDTEF PIC  X(0001).
   618     05  FILLER REDEFINES LSTDTEF.
   619         10  LSTDTEA PIC  X(0001).
   620     05  LSTDTEI PIC  X(0008).
   621*    -------------------------------
   622     05  LSTTIMEL PIC S9(0004) COMP.
   623     05  LSTTIMEF PIC  X(0001).
   624     05  FILLER REDEFINES LSTTIMEF.
   625         10  LSTTIMEA PIC  X(0001).
   626     05  LSTTIMEI PIC  X(0005).
   627*    -------------------------------
   628     05  LSTUSRL PIC S9(0004) COMP.
   629     05  LSTUSRF PIC  X(0001).
   630     05  FILLER REDEFINES LSTUSRF.
   631         10  LSTUSRA PIC  X(0001).
   632     05  LSTUSRI PIC  X(0004).
   633*    -------------------------------
   634     05  CARRIERL PIC S9(0004) COMP.
   635     05  CARRIERF PIC  X(0001).
   636     05  FILLER REDEFINES CARRIERF.
   637         10  CARRIERA PIC  X(0001).
   638     05  CARRIERI PIC  X(0001).
   639*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6503.cbl
   640     05  GROUPL PIC S9(0004) COMP.
   641     05  GROUPF PIC  X(0001).
   642     05  FILLER REDEFINES GROUPF.
   643         10  GROUPA PIC  X(0001).
   644     05  GROUPI PIC  X(0006).
   645*    -------------------------------
   646     05  STATEL PIC S9(0004) COMP.
   647     05  STATEF PIC  X(0001).
   648     05  FILLER REDEFINES STATEF.
   649         10  STATEA PIC  X(0001).
   650     05  STATEI PIC  X(0002).
   651*    -------------------------------
   652     05  ACCTNOL PIC S9(0004) COMP.
   653     05  ACCTNOF PIC  X(0001).
   654     05  FILLER REDEFINES ACCTNOF.
   655         10  ACCTNOA PIC  X(0001).
   656     05  ACCTNOI PIC  X(0010).
   657*    -------------------------------
   658     05  BLINE1L PIC S9(0004) COMP.
   659     05  BLINE1F PIC  X(0001).
   660     05  FILLER REDEFINES BLINE1F.
   661         10  BLINE1A PIC  X(0001).
   662     05  BLINE1I PIC  X(0060).
   663*    -------------------------------
   664     05  BLINE2L PIC S9(0004) COMP.
   665     05  BLINE2F PIC  X(0001).
   666     05  FILLER REDEFINES BLINE2F.
   667         10  BLINE2A PIC  X(0001).
   668     05  BLINE2I PIC  X(0060).
   669*    -------------------------------
   670     05  SNAME1L PIC S9(0004) COMP.
   671     05  SNAME1F PIC  X(0001).
   672     05  FILLER REDEFINES SNAME1F.
   673         10  SNAME1A PIC  X(0001).
   674     05  SNAME1I PIC  X(0060).
   675*    -------------------------------
   676     05  SNAME2L PIC S9(0004) COMP.
   677     05  SNAME2F PIC  X(0001).
   678     05  FILLER REDEFINES SNAME2F.
   679         10  SNAME2A PIC  X(0001).
   680     05  SNAME2I PIC  X(0060).
   681*    -------------------------------
   682     05  SADDR1L PIC S9(0004) COMP.
   683     05  SADDR1F PIC  X(0001).
   684     05  FILLER REDEFINES SADDR1F.
   685         10  SADDR1A PIC  X(0001).
   686     05  SADDR1I PIC  X(0060).
   687*    -------------------------------
   688     05  SADDR2L PIC S9(0004) COMP.
   689     05  SADDR2F PIC  X(0001).
   690     05  FILLER REDEFINES SADDR2F.
   691         10  SADDR2A PIC  X(0001).
   692     05  SADDR2I PIC  X(0060).
   693*    -------------------------------
   694     05  SADDR3L PIC S9(0004) COMP.
   695     05  SADDR3F PIC  X(0001).
   696     05  FILLER REDEFINES SADDR3F.
   697         10  SADDR3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6503.cbl
   698     05  SADDR3I PIC  X(0060).
   699*    -------------------------------
   700     05  SCITYL PIC S9(0004) COMP.
   701     05  SCITYF PIC  X(0001).
   702     05  FILLER REDEFINES SCITYF.
   703         10  SCITYA PIC  X(0001).
   704     05  SCITYI PIC  X(0060).
   705*    -------------------------------
   706     05  SSTATEL PIC S9(0004) COMP.
   707     05  SSTATEF PIC  X(0001).
   708     05  FILLER REDEFINES SSTATEF.
   709         10  SSTATEA PIC  X(0001).
   710     05  SSTATEI PIC  X(0002).
   711*    -------------------------------
   712     05  SZIPL PIC S9(0004) COMP.
   713     05  SZIPF PIC  X(0001).
   714     05  FILLER REDEFINES SZIPF.
   715         10  SZIPA PIC  X(0001).
   716     05  SZIPI PIC  X(0010).
   717*    -------------------------------
   718     05  ERRMSG1L PIC S9(0004) COMP.
   719     05  ERRMSG1F PIC  X(0001).
   720     05  FILLER REDEFINES ERRMSG1F.
   721         10  ERRMSG1A PIC  X(0001).
   722     05  ERRMSG1I PIC  X(0072).
   723*    -------------------------------
   724     05  PFKEYL PIC S9(0004) COMP.
   725     05  PFKEYF PIC  X(0001).
   726     05  FILLER REDEFINES PFKEYF.
   727         10  PFKEYA PIC  X(0001).
   728     05  PFKEYI PIC  99.
   729 01  EL6503AO REDEFINES EL6503AI.
   730     05  FILLER            PIC  X(0012).
   731*    -------------------------------
   732     05  FILLER            PIC  X(0003).
   733     05  RUNDATEO PIC  X(0008).
   734*    -------------------------------
   735     05  FILLER            PIC  X(0003).
   736     05  RUNTIMEO PIC  99.99.
   737*    -------------------------------
   738     05  FILLER            PIC  X(0003).
   739     05  CMPNYIDO PIC  X(0003).
   740*    -------------------------------
   741     05  FILLER            PIC  X(0003).
   742     05  USERIDO PIC  X(0004).
   743*    -------------------------------
   744     05  FILLER            PIC  X(0003).
   745     05  MAINTYPO PIC  X(0001).
   746*    -------------------------------
   747     05  FILLER            PIC  X(0003).
   748     05  LSTDTEO PIC  X(0008).
   749*    -------------------------------
   750     05  FILLER            PIC  X(0003).
   751     05  LSTTIMEO PIC  99.99.
   752*    -------------------------------
   753     05  FILLER            PIC  X(0003).
   754     05  LSTUSRO PIC  X(0004).
   755*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6503.cbl
   756     05  FILLER            PIC  X(0003).
   757     05  CARRIERO PIC  X(0001).
   758*    -------------------------------
   759     05  FILLER            PIC  X(0003).
   760     05  GROUPO PIC  X(0006).
   761*    -------------------------------
   762     05  FILLER            PIC  X(0003).
   763     05  STATEO PIC  X(0002).
   764*    -------------------------------
   765     05  FILLER            PIC  X(0003).
   766     05  ACCTNOO PIC  X(0010).
   767*    -------------------------------
   768     05  FILLER            PIC  X(0003).
   769     05  BLINE1O PIC  X(0060).
   770*    -------------------------------
   771     05  FILLER            PIC  X(0003).
   772     05  BLINE2O PIC  X(0060).
   773*    -------------------------------
   774     05  FILLER            PIC  X(0003).
   775     05  SNAME1O PIC  X(0060).
   776*    -------------------------------
   777     05  FILLER            PIC  X(0003).
   778     05  SNAME2O PIC  X(0060).
   779*    -------------------------------
   780     05  FILLER            PIC  X(0003).
   781     05  SADDR1O PIC  X(0060).
   782*    -------------------------------
   783     05  FILLER            PIC  X(0003).
   784     05  SADDR2O PIC  X(0060).
   785*    -------------------------------
   786     05  FILLER            PIC  X(0003).
   787     05  SADDR3O PIC  X(0060).
   788*    -------------------------------
   789     05  FILLER            PIC  X(0003).
   790     05  SCITYO PIC  X(0060).
   791*    -------------------------------
   792     05  FILLER            PIC  X(0003).
   793     05  SSTATEO PIC  X(0002).
   794*    -------------------------------
   795     05  FILLER            PIC  X(0003).
   796     05  SZIPO PIC  X(0010).
   797*    -------------------------------
   798     05  FILLER            PIC  X(0003).
   799     05  ERRMSG1O PIC  X(0072).
   800*    -------------------------------
   801     05  FILLER            PIC  X(0003).
   802     05  PFKEYO PIC  X(0002).
   803*    -------------------------------
   804*                                COPY ELCJPFX.
   805******************************************************************
   806*                                                                *
   807*                                                                *
   808*                            ELCJPFX.                            *
   809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   810*                            VMOD=2.002                          *
   811*                                                                *
   812*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   813*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6503.cbl
   814*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   815*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   816*        ELCNTL - CONTROL FILE                                   *
   817*        ELMSTR - CLAIM MASTERS                                  *
   818*        ELTRLR - ACTIVITY TRAILERS                              *
   819*        ELCHKQ - CHECK QUE                                      *
   820******************************************************************
   821 01  JOURNAL-RECORD.
   822     12  JP-USER-ID                  PIC X(4).
   823     12  JP-FILE-ID                  PIC X(8).
   824     12  JP-PROGRAM-ID               PIC X(8).
   825     12  JP-RECORD-TYPE              PIC X.
   826         88 JP-ADD              VALUE 'A'.
   827         88 JP-BEFORE-CHANGE    VALUE 'B'.
   828         88 JP-AFTER-CHANGE     VALUE 'C'.
   829         88 JP-DELETE           VALUE 'D'.
   830         88 JP-GENERIC-DELETE   VALUE 'G'.
   831         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   832         88 JP-KEY-CHG-ADD      VALUE 'N'.
   833     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   834     12  JP-RECORD-AREA
   835
   836
   837                                 PIC X(750).
   838*                                COPY ELCEMIB.
   839******************************************************************
   840*                                                                *
   841*                                                                *
   842*                            ELCEMIB.                            *
   843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   844*                            VMOD=2.005                          *
   845*                                                                *
   846*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   847*                                                                *
   848******************************************************************
   849 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   850     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   851     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   852     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   853     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   854     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   855     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   856     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   857     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   858     12  EMI-SWITCH1             PIC X        VALUE '1'.
   859         88  EMI-NO-ERRORS                    VALUE '1'.
   860         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   861         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   862     12  EMI-SWITCH2             PIC X        VALUE '1'.
   863         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   864     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   865         88  EMI-AREA1-EMPTY                  VALUE '1'.
   866         88  EMI-AREA1-FULL                   VALUE '2'.
   867     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   868         88  EMI-AREA2-EMPTY                  VALUE '1'.
   869         88  EMI-AREA2-FULL                   VALUE '2'.
   870     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   871         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6503.cbl
   872         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   873         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   874         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   875         88  EMI-BYPASS-FATALS                VALUE 'X'.
   876     12  EMI-ERROR-LINES.
   877         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   878         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   879         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   880         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   881             20  EMI-ERR-CODES OCCURS 10 TIMES.
   882                 24  EMI-ERR-NUM         PIC X(4).
   883                 24  EMI-FILLER          PIC X.
   884                 24  EMI-SEV             PIC X.
   885                 24  FILLER              PIC X.
   886             20  FILLER                  PIC X(02).
   887     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   888         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   889             20  EMI-ERROR-NUMBER    PIC X(4).
   890             20  EMI-FILL            PIC X.
   891             20  EMI-SEVERITY        PIC X.
   892             20  FILLER              PIC X.
   893             20  EMI-ERROR-TEXT.
   894                 24  EMI-TEXT-VARIABLE   PIC X(10).
   895                 24  FILLER          PIC X(55).
   896     12  EMI-SEVERITY-SAVE           PIC X.
   897         88  EMI-NOTE                    VALUE 'N'.
   898         88  EMI-WARNING                 VALUE 'W'.
   899         88  EMI-FORCABLE                VALUE 'F'.
   900         88  EMI-FATAL                   VALUE 'X'.
   901     12  EMI-MESSAGE-FLAG            PIC X.
   902         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   903         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   904     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   905     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   906         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   907         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   908         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   909     12  FILLER                      PIC X(137)  VALUE SPACES.
   910     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   911     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   912     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   913     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   914*                                COPY ELCDATE.
   915******************************************************************
   916*                                                                *
   917*                                                                *
   918*                            ELCDATE.                            *
   919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   920*                            VMOD=2.003
   921*                                                                *
   922*                                                                *
   923*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   924*                 LENGTH = 200                                   *
   925******************************************************************
   926
   927 01  DATE-CONVERSION-DATA.
   928     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   929     12  DC-OPTION-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6503.cbl
   930         88  BIN-TO-GREG                VALUE ' '.
   931         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   932         88  EDIT-GREG-TO-BIN           VALUE '2'.
   933         88  YMD-GREG-TO-BIN            VALUE '3'.
   934         88  MDY-GREG-TO-BIN            VALUE '4'.
   935         88  JULIAN-TO-BIN              VALUE '5'.
   936         88  BIN-PLUS-ELAPSED           VALUE '6'.
   937         88  FIND-CENTURY               VALUE '7'.
   938         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   939         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   940         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   941         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   942         88  JULIAN-TO-BIN-3            VALUE 'C'.
   943         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   944         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   945         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   946         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   947         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   948         88  CHECK-LEAP-YEAR            VALUE 'H'.
   949         88  BIN-3-TO-GREG              VALUE 'I'.
   950         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   951         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   952         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   953         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   954         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   955         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   956         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   957         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   958         88  THREE-CHARACTER-BIN
   959                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   960         88  GREGORIAN-TO-BIN
   961                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   962         88  BIN-TO-GREGORIAN
   963                  VALUES ' ' '1' 'I' '8' 'G'.
   964         88  JULIAN-TO-BINARY
   965                  VALUES '5' 'C' 'E' 'F'.
   966     12  DC-ERROR-CODE                 PIC X.
   967         88  NO-CONVERSION-ERROR        VALUE ' '.
   968         88  DATE-CONVERSION-ERROR
   969                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   970         88  DATE-IS-ZERO               VALUE '1'.
   971         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   972         88  DATE-IS-INVALID            VALUE '3'.
   973         88  DATE1-GREATER-DATE2        VALUE '4'.
   974         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   975         88  DATE-INVALID-OPTION        VALUE '9'.
   976         88  INVALID-CENTURY            VALUE 'A'.
   977         88  ONLY-CENTURY               VALUE 'B'.
   978         88  ONLY-LEAP-YEAR             VALUE 'C'.
   979         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   980     12  DC-END-OF-MONTH               PIC X.
   981         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   982     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   983         88  USE-NORMAL-PROCESS         VALUE ' '.
   984         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   985         88  ADJUST-UP-100-YRS          VALUE '2'.
   986     12  FILLER                        PIC X.
   987     12  DC-CONVERSION-DATES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6503.cbl
   988         16  DC-BIN-DATE-1             PIC XX.
   989         16  DC-BIN-DATE-2             PIC XX.
   990         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   991         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   992                       DC-GREG-DATE-1-EDIT.
   993             20  DC-EDIT1-MONTH        PIC 99.
   994             20  SLASH1-1              PIC X.
   995             20  DC-EDIT1-DAY          PIC 99.
   996             20  SLASH1-2              PIC X.
   997             20  DC-EDIT1-YEAR         PIC 99.
   998         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   999         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1000                     DC-GREG-DATE-2-EDIT.
  1001             20  DC-EDIT2-MONTH        PIC 99.
  1002             20  SLASH2-1              PIC X.
  1003             20  DC-EDIT2-DAY          PIC 99.
  1004             20  SLASH2-2              PIC X.
  1005             20  DC-EDIT2-YEAR         PIC 99.
  1006         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1007         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1008                     DC-GREG-DATE-1-YMD.
  1009             20  DC-YMD-YEAR           PIC 99.
  1010             20  DC-YMD-MONTH          PIC 99.
  1011             20  DC-YMD-DAY            PIC 99.
  1012         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1013         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1014                      DC-GREG-DATE-1-MDY.
  1015             20  DC-MDY-MONTH          PIC 99.
  1016             20  DC-MDY-DAY            PIC 99.
  1017             20  DC-MDY-YEAR           PIC 99.
  1018         16  DC-GREG-DATE-1-ALPHA.
  1019             20  DC-ALPHA-MONTH        PIC X(10).
  1020             20  DC-ALPHA-DAY          PIC 99.
  1021             20  FILLER                PIC XX.
  1022             20  DC-ALPHA-CENTURY.
  1023                 24 DC-ALPHA-CEN-N     PIC 99.
  1024             20  DC-ALPHA-YEAR         PIC 99.
  1025         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1026         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1027         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1028         16  DC-JULIAN-DATE            PIC 9(05).
  1029         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1030                                       PIC 9(05).
  1031         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1032             20  DC-JULIAN-YEAR        PIC 99.
  1033             20  DC-JULIAN-DAYS        PIC 999.
  1034         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1035         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1036         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1037     12  DATE-CONVERSION-VARIBLES.
  1038         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1039         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1040             20  FILLER                PIC 9(3).
  1041             20  HOLD-CEN-1-CCYY.
  1042                 24  HOLD-CEN-1-CC     PIC 99.
  1043                 24  HOLD-CEN-1-YY     PIC 99.
  1044             20  HOLD-CEN-1-MO         PIC 99.
  1045             20  HOLD-CEN-1-DA         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6503.cbl
  1046         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1047             20  HOLD-CEN-1-R-MO       PIC 99.
  1048             20  HOLD-CEN-1-R-DA       PIC 99.
  1049             20  HOLD-CEN-1-R-CCYY.
  1050                 24  HOLD-CEN-1-R-CC   PIC 99.
  1051                 24  HOLD-CEN-1-R-YY   PIC 99.
  1052             20  FILLER                PIC 9(3).
  1053         16  HOLD-CENTURY-1-X.
  1054             20  FILLER                PIC X(3)  VALUE SPACES.
  1055             20  HOLD-CEN-1-X-CCYY.
  1056                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1057                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1058             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1059             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1060         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1061             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1062             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1063             20  HOLD-CEN-1-R-X-CCYY.
  1064                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1065                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1066             20  FILLER                PIC XXX.
  1067         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1068         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1069         16  DC-JULIAN-DATE-1          PIC 9(07).
  1070         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1071             20  DC-JULIAN-1-CCYY.
  1072                 24  DC-JULIAN-1-CC    PIC 99.
  1073                 24  DC-JULIAN-1-YR    PIC 99.
  1074             20  DC-JULIAN-DA-1        PIC 999.
  1075         16  DC-JULIAN-DATE-2          PIC 9(07).
  1076         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1077             20  DC-JULIAN-2-CCYY.
  1078                 24  DC-JULIAN-2-CC    PIC 99.
  1079                 24  DC-JULIAN-2-YR    PIC 99.
  1080             20  DC-JULIAN-DA-2        PIC 999.
  1081         16  DC-GREG-DATE-A-EDIT.
  1082             20  DC-EDITA-MONTH        PIC 99.
  1083             20  SLASHA-1              PIC X VALUE '/'.
  1084             20  DC-EDITA-DAY          PIC 99.
  1085             20  SLASHA-2              PIC X VALUE '/'.
  1086             20  DC-EDITA-CCYY.
  1087                 24  DC-EDITA-CENT     PIC 99.
  1088                 24  DC-EDITA-YEAR     PIC 99.
  1089         16  DC-GREG-DATE-B-EDIT.
  1090             20  DC-EDITB-MONTH        PIC 99.
  1091             20  SLASHB-1              PIC X VALUE '/'.
  1092             20  DC-EDITB-DAY          PIC 99.
  1093             20  SLASHB-2              PIC X VALUE '/'.
  1094             20  DC-EDITB-CCYY.
  1095                 24  DC-EDITB-CENT     PIC 99.
  1096                 24  DC-EDITB-YEAR     PIC 99.
  1097         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1098         16  DC-GREG-DATE-CYMD-R REDEFINES
  1099                              DC-GREG-DATE-CYMD.
  1100             20  DC-CYMD-CEN           PIC 99.
  1101             20  DC-CYMD-YEAR          PIC 99.
  1102             20  DC-CYMD-MONTH         PIC 99.
  1103             20  DC-CYMD-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6503.cbl
  1104         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1105         16  DC-GREG-DATE-MDCY-R REDEFINES
  1106                              DC-GREG-DATE-MDCY.
  1107             20  DC-MDCY-MONTH         PIC 99.
  1108             20  DC-MDCY-DAY           PIC 99.
  1109             20  DC-MDCY-CEN           PIC 99.
  1110             20  DC-MDCY-YEAR          PIC 99.
  1111    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1112        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1113    12  DC-EL310-DATE                  PIC X(21).
  1114    12  FILLER                         PIC X(28).
  1115*                                COPY ELCLOGOF.
  1116******************************************************************
  1117*                                                                *
  1118*                                                                *
  1119*                            ELCLOGOF.                           *
  1120*                            VMOD=2.001                          *
  1121*                                                                *
  1122*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1123*                                                                *
  1124******************************************************************
  1125 01  CLASIC-LOGOFF.
  1126     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1127     12  LOGOFF-TEXT.
  1128         16  FILLER          PIC X(5)    VALUE SPACES.
  1129         16  LOGOFF-MSG.
  1130             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1131             20  FILLER      PIC X       VALUE SPACES.
  1132             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1133         16  FILLER          PIC X(80)
  1134           VALUE '* YOU ARE NOW LOGGED OFF'.
  1135         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1136         16  FILLER          PIC X       VALUE QUOTE.
  1137         16  LOGOFF-SYS-MSG  PIC X(17)
  1138           VALUE 'S CLAS-IC SYSTEM '.
  1139     12  TEXT-MESSAGES.
  1140         16  UNACCESS-MSG    PIC X(29)
  1141             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1142         16  PGMIDERR-MSG    PIC X(17)
  1143             VALUE 'PROGRAM NOT FOUND'.
  1144*                                COPY ELCATTR.
  1145******************************************************************
  1146*                                                                *
  1147*                            ELCATTR.                            *
  1148*                            VMOD=2.001                          *
  1149*                                                                *
  1150*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1151*                                                                *
  1152*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1153*                                                                *
  1154*                   POS 1   P=PROTECTED                          *
  1155*                           U=UNPROTECTED                        *
  1156*                           S=ASKIP                              *
  1157*                   POS 2   A=ALPHA/NUMERIC                      *
  1158*                           N=NUMERIC                            *
  1159*                   POS 3   N=NORMAL                             *
  1160*                           B=BRIGHT                             *
  1161*                           D=DARK                               *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6503.cbl
  1162*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1163*                           OF=MODIFIED DATA TAG OFF             *
  1164*                                                                *
  1165*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1166******************************************************************
  1167 01  ATTRIBUTE-LIST.
  1168     12  AL-PABOF            PIC X       VALUE 'Y'.
  1169     12  AL-PABON            PIC X       VALUE 'Z'.
  1170     12  AL-PADOF            PIC X       VALUE '%'.
  1171     12  AL-PADON            PIC X       VALUE '_'.
  1172     12  AL-PANOF            PIC X       VALUE '-'.
  1173     12  AL-PANON            PIC X       VALUE '/'.
  1174     12  AL-SABOF            PIC X       VALUE '8'.
  1175     12  AL-SABON            PIC X       VALUE '9'.
  1176     12  AL-SADOF            PIC X       VALUE '@'.
  1177     12  AL-SADON            PIC X       VALUE QUOTE.
  1178     12  AL-SANOF            PIC X       VALUE '0'.
  1179     12  AL-SANON            PIC X       VALUE '1'.
  1180     12  AL-UABOF            PIC X       VALUE 'H'.
  1181     12  AL-UABON            PIC X       VALUE 'I'.
  1182     12  AL-UADOF            PIC X       VALUE '<'.
  1183     12  AL-UADON            PIC X       VALUE '('.
  1184     12  AL-UANOF            PIC X       VALUE ' '.
  1185     12  AL-UANON            PIC X       VALUE 'A'.
  1186     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1187     12  AL-UNBON            PIC X       VALUE 'R'.
  1188     12  AL-UNDOF            PIC X       VALUE '*'.
  1189     12  AL-UNDON            PIC X       VALUE ')'.
  1190     12  AL-UNNOF            PIC X       VALUE '&'.
  1191     12  AL-UNNON            PIC X       VALUE 'J'.
  1192*                                COPY ELCAID.
  1193******************************************************************
  1194*                                                                *
  1195*                            ELCAID.                             *
  1196*                            VMOD=2.001                          *
  1197*                                                                *
  1198*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1199*                                                                *
  1200*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1201*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1202******************************************************************
  1203
  1204 01  DFHAID.
  1205   02  DFHNULL   PIC  X  VALUE  ' '.
  1206   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1207   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1208   02  DFHPEN    PIC  X  VALUE  '='.
  1209   02  DFHOPID   PIC  X  VALUE  'W'.
  1210   02  DFHPA1    PIC  X  VALUE  '%'.
  1211   02  DFHPA2    PIC  X  VALUE  '>'.
  1212   02  DFHPA3    PIC  X  VALUE  ','.
  1213   02  DFHPF1    PIC  X  VALUE  '1'.
  1214   02  DFHPF2    PIC  X  VALUE  '2'.
  1215   02  DFHPF3    PIC  X  VALUE  '3'.
  1216   02  DFHPF4    PIC  X  VALUE  '4'.
  1217   02  DFHPF5    PIC  X  VALUE  '5'.
  1218   02  DFHPF6    PIC  X  VALUE  '6'.
  1219   02  DFHPF7    PIC  X  VALUE  '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6503.cbl
  1220   02  DFHPF8    PIC  X  VALUE  '8'.
  1221   02  DFHPF9    PIC  X  VALUE  '9'.
  1222   02  DFHPF10   PIC  X  VALUE  ':'.
  1223   02  DFHPF11   PIC  X  VALUE  '#'.
  1224   02  DFHPF12   PIC  X  VALUE  '@'.
  1225   02  DFHPF13   PIC  X  VALUE  'A'.
  1226   02  DFHPF14   PIC  X  VALUE  'B'.
  1227   02  DFHPF15   PIC  X  VALUE  'C'.
  1228   02  DFHPF16   PIC  X  VALUE  'D'.
  1229   02  DFHPF17   PIC  X  VALUE  'E'.
  1230   02  DFHPF18   PIC  X  VALUE  'F'.
  1231   02  DFHPF19   PIC  X  VALUE  'G'.
  1232   02  DFHPF20   PIC  X  VALUE  'H'.
  1233   02  DFHPF21   PIC  X  VALUE  'I'.
  1234*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1235   02  DFHPF22   PIC  X  VALUE  '['.
  1236   02  DFHPF23   PIC  X  VALUE  '.'.
  1237   02  DFHPF24   PIC  X  VALUE  '<'.
  1238   02  DFHMSRE   PIC  X  VALUE  'X'.
  1239   02  DFHSTRF   PIC  X  VALUE  'h'.
  1240   02  DFHTRIG   PIC  X  VALUE  '"'.
  1241 01  FILLER    REDEFINES DFHAID.
  1242     05  FILLER                      PIC X(8).
  1243     05  PF-VALUES                   PIC X
  1244         OCCURS 24 TIMES.
  1245*                                COPY ERCACNT.
  1246******************************************************************
  1247*                                                                *
  1248*                                                                *
  1249*                            ERCACNT.                            *
  1250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1251*                            VMOD=2.002                          *
  1252*                                                                *
  1253*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1254*                                                                *
  1255*   FILE TYPE = VSAM,KSDS                                        *
  1256*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1257*                                                                *
  1258*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1259*       ALTERNATE INDEX = NONE                                   *
  1260*                                                                *
  1261*                                                                *
  1262*   LOG = YES                                                    *
  1263*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1264******************************************************************
  1265*                   C H A N G E   L O G
  1266*
  1267* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1268*-----------------------------------------------------------------
  1269*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1270* EFFECTIVE    NUMBER
  1271*-----------------------------------------------------------------
  1272* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1273*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1274******************************************************************
  1275 01  NOTE-FILE.
  1276     12  NT-FILE-ID                  PIC XX.
  1277         88  VALID-NOTE-ID              VALUE 'NT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6503.cbl
  1278
  1279     12  NT-CONTROL-PRIMARY.
  1280         16  NT-COMPANY-CD           PIC X.
  1281         16  NT-ACCT-NOTE-KEY.
  1282             18  NT-CARRIER              PIC X.
  1283             18  NT-GROUPING             PIC X(06).
  1284             18  NT-STATE                PIC XX.
  1285             18  NT-ACCOUNT              PIC X(10).
  1286         16  NT-RECORD-TYPE          PIC X.
  1287              88  ACCT-NOTE          VALUE '1'.
  1288              88  ACCT-BRANCH-LOC    VALUE '2'.
  1289              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1290         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1291
  1292     12  NT-LAST-MAINT-DT            PIC XX.
  1293     12  NT-LAST-MAINT-BY            PIC X(4).
  1294     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1295
  1296*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1297*     SEQUENCE NUMBERS
  1298     12  NT-NOTE-INFORMATION.
  1299         16  NT-NOTE-LINE            PIC X(60).
  1300         16  FILLER                  PIC X(25).
  1301*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1302     12  NT-LOCATION-INFORMATION REDEFINES
  1303                         NT-NOTE-INFORMATION.
  1304         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1305         16  FILLER                  PIC X(25).
  1306*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1307*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1308*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1309*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1310*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1311*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1312*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1313     12  NT-SHIPPING-INFORMATION REDEFINES
  1314                         NT-NOTE-INFORMATION.
  1315         16  NT-SHIPPING-LINE        PIC X(60).
  1316         16  NT-SHIP-STATE           PIC XX.
  1317         16  NT-SHIP-ZIP             PIC X(10).
  1318         16  FILLER                  PIC X(13).
  1319*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6503.cbl
  1321****************************************************************
  1322*
  1323* Copyright (c) 2007 by Clerity Solutions, Inc.
  1324* All rights reserved.
  1325*
  1326****************************************************************
  1327 01  DFHEIV.
  1328   02  DFHEIV0               PIC X(35).
  1329   02  DFHEIV1               PIC X(08).
  1330   02  DFHEIV2               PIC X(08).
  1331   02  DFHEIV3               PIC X(08).
  1332   02  DFHEIV4               PIC X(06).
  1333   02  DFHEIV5               PIC X(04).
  1334   02  DFHEIV6               PIC X(04).
  1335   02  DFHEIV7               PIC X(02).
  1336   02  DFHEIV8               PIC X(02).
  1337   02  DFHEIV9               PIC X(01).
  1338   02  DFHEIV10              PIC S9(7) COMP-3.
  1339   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1340   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1341   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1342   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1343   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1344   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1345   02  DFHEIV17              PIC X(04).
  1346   02  DFHEIV18              PIC X(04).
  1347   02  DFHEIV19              PIC X(04).
  1348   02  DFHEIV20              USAGE IS POINTER.
  1349   02  DFHEIV21              USAGE IS POINTER.
  1350   02  DFHEIV22              USAGE IS POINTER.
  1351   02  DFHEIV23              USAGE IS POINTER.
  1352   02  DFHEIV24              USAGE IS POINTER.
  1353   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1354   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1355   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1356   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1357   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1358   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1359   02  FILLER                PIC X(02).
  1360   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1361   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1362   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1363   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1364   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1365 LINKAGE  SECTION.
  1366*****************************************************************
  1367*                                                               *
  1368* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1369* All rights reserved.                                          *
  1370*                                                               *
  1371*****************************************************************
  1372 01  dfheiblk.
  1373     02  eibtime          pic s9(7) comp-3.
  1374     02  eibdate          pic s9(7) comp-3.
  1375     02  eibtrnid         pic x(4).
  1376     02  eibtaskn         pic s9(7) comp-3.
  1377     02  eibtrmid         pic x(4).
  1378     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6503.cbl
  1379     02  eibcposn         pic s9(4) comp.
  1380     02  eibcalen         pic s9(4) comp.
  1381     02  eibaid           pic x(1).
  1382     02  eibfiller1       pic x(1).
  1383     02  eibfn            pic x(2).
  1384     02  eibfiller2       pic x(2).
  1385     02  eibrcode         pic x(6).
  1386     02  eibfiller3       pic x(2).
  1387     02  eibds            pic x(8).
  1388     02  eibreqid         pic x(8).
  1389     02  eibrsrce         pic x(8).
  1390     02  eibsync          pic x(1).
  1391     02  eibfree          pic x(1).
  1392     02  eibrecv          pic x(1).
  1393     02  eibsend          pic x(1).
  1394     02  eibatt           pic x(1).
  1395     02  eibeoc           pic x(1).
  1396     02  eibfmh           pic x(1).
  1397     02  eibcompl         pic x(1).
  1398     02  eibsig           pic x(1).
  1399     02  eibconf          pic x(1).
  1400     02  eiberr           pic x(1).
  1401     02  eibrldbk         pic x(1).
  1402     02  eiberrcd         pic x(4).
  1403     02  eibsynrb         pic x(1).
  1404     02  eibnodat         pic x(1).
  1405     02  eibfiller5       pic x(2).
  1406     02  eibresp          pic 9(09) comp.
  1407     02  eibresp2         pic 9(09) comp.
  1408     02  dfheigdj         pic s9(4) comp.
  1409     02  dfheigdk         pic s9(4) comp.
  1410 01  DFHCOMMAREA                 PIC X(1024).
  1411 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1412 0000-DFHEXIT SECTION.
  1413     MOVE '9#                    $   ' TO DFHEIV0.
  1414     MOVE 'EL6503' TO DFHEIV1.
  1415     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1416     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1417     MOVE '5'                    TO DC-OPTION-CODE
  1418     PERFORM 8500-DATE-CONVERSION
  1419                                 THRU 8500-EXIT
  1420     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1421     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1422     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1423     MOVE +1                     TO EMI-NUMBER-OF-LINES
  1424                                    EMI-SWITCH2
  1425     IF EIBCALEN NOT > ZERO
  1426        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1427        GO TO 8300-SEND-TEXT
  1428     END-IF
  1429
  1430* EXEC CICS HANDLE CONDITION
  1431*        PGMIDERR (9600-PGMIDERR)
  1432*        ERROR    (9990-ERROR)
  1433*    END-EXEC
  1434*    MOVE '"$L.                  ! " #00001425' TO DFHEIV0
  1435     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6503.cbl
  1437     MOVE X'2220233030303031343235' TO DFHEIV0(25:11)
  1438     CALL 'kxdfhei1' USING DFHEIV0
  1439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1440     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1441        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1442           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1443           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1444           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1445           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1446           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1447           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1448           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1449           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1450        ELSE
  1451           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1452           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1453           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1454           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1455           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1456           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1457           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1458           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1459        END-IF
  1460     END-IF
  1461     IF EIBTRNID NOT = WS-TRANS-ID
  1462        GO TO 1000-INITIAL-SCREEN
  1463     END-IF
  1464     IF EIBAID = DFHCLEAR
  1465        GO TO 9400-CLEAR
  1466     END-IF
  1467     IF NOT DISPLAY-CAP
  1468        MOVE 'READ'              TO SM-READ
  1469        PERFORM 9995-SECURITY-VIOLATION
  1470        MOVE ER-0070             TO EMI-ERROR
  1471        PERFORM 9900-ERROR-FORMAT
  1472                                 THRU 9900-EXIT
  1473        GO TO 8100-SEND-INITIAL-MAP
  1474     END-IF
  1475     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1476        MOVE LOW-VALUES          TO EL6503AO
  1477        MOVE -1                  TO PFKEYL
  1478        MOVE ER-0008             TO EMI-ERROR
  1479        GO TO 8200-SEND-DATAONLY
  1480     END-IF
  1481
  1482* EXEC CICS RECEIVE
  1483*        INTO   (EL6503AI)
  1484*        MAPSET (WS-MAPSET-NAME)
  1485*        MAP    (WS-MAP-NAME)
  1486*    END-EXEC
  1487     MOVE LENGTH OF
  1488      EL6503AI
  1489       TO DFHEIV11
  1490*    MOVE '8"T I  L              ''   #00001470' TO DFHEIV0
  1491     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1493     MOVE X'2020233030303031343730' TO DFHEIV0(25:11)
  1494     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6503.cbl
  1495           WS-MAP-NAME,
  1496           EL6503AI,
  1497           DFHEIV11,
  1498           WS-MAPSET-NAME,
  1499           DFHEIV99,
  1500           DFHEIV99
  1501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1502     IF PFKEYL > ZERO
  1503        IF EIBAID NOT = DFHENTER
  1504           MOVE ER-0004          TO EMI-ERROR
  1505           MOVE AL-UNBOF         TO PFKEYA
  1506           MOVE -1               TO PFKEYL
  1507           GO TO 8200-SEND-DATAONLY
  1508        ELSE
  1509           IF PFKEYO NUMERIC AND
  1510              (PFKEYO > ZERO AND LESS '25')
  1511              MOVE PF-VALUES (PFKEYI)
  1512                                 TO  EIBAID
  1513           ELSE
  1514              MOVE ER-0029       TO  EMI-ERROR
  1515              MOVE AL-UNBOF      TO  PFKEYA
  1516              MOVE -1            TO  PFKEYL
  1517              GO TO 8200-SEND-DATAONLY
  1518           END-IF
  1519        END-IF
  1520     END-IF
  1521     IF EIBAID = DFHPF12
  1522        MOVE 'EL010'             TO THIS-PGM
  1523        GO TO 9300-XCTL
  1524     END-IF
  1525     IF EIBAID = DFHPF23
  1526        GO TO 9000-RETURN-CICS
  1527     END-IF
  1528     IF EIBAID = DFHPF24
  1529        IF CREDIT-SESSION
  1530           MOVE 'EL626'          TO THIS-PGM
  1531           GO TO 9300-XCTL
  1532        ELSE
  1533           MOVE 'EL126'          TO THIS-PGM
  1534           GO TO 9300-XCTL
  1535        END-IF
  1536     END-IF
  1537     IF EIBAID = DFHENTER
  1538        CONTINUE
  1539     ELSE
  1540        MOVE ER-0008             TO EMI-ERROR
  1541        MOVE -1                  TO PFKEYL
  1542        GO TO 8200-SEND-DATAONLY
  1543     END-IF
  1544     IF NOT MODIFY-CAP
  1545        MOVE 'UPDATE'            TO SM-READ
  1546        PERFORM 9995-SECURITY-VIOLATION
  1547                                 THRU 9995-EXIT
  1548        MOVE ER-0070             TO EMI-ERROR
  1549        PERFORM 9900-ERROR-FORMAT
  1550                                 THRU 9900-EXIT
  1551        MOVE AL-UANON            TO CARRIERA GROUPA
  1552                                    STATEA  ACCTNOA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6503.cbl
  1553        GO TO 8100-SEND-INITIAL-MAP
  1554     END-IF
  1555     EVALUATE MAINTYPI
  1556        WHEN 'D'
  1557           PERFORM 2000-DELETE-ERACNT
  1558                                 THRU 2000-EXIT
  1559           MOVE ER-0000          TO EMI-ERROR
  1560           PERFORM 9900-ERROR-FORMAT
  1561                                 THRU 9900-EXIT
  1562           GO TO 8100-SEND-INITIAL-MAP
  1563        WHEN 'C'
  1564           PERFORM 3000-CHANGE-ERACNT
  1565                                 THRU 3000-EXIT
  1566           MOVE ER-0000          TO EMI-ERROR
  1567           PERFORM 9900-ERROR-FORMAT
  1568                                 THRU 9900-EXIT
  1569        WHEN 'A'
  1570           PERFORM 4000-ADD-ERACNT
  1571                                 THRU 4000-EXIT
  1572           MOVE ER-0000          TO EMI-ERROR
  1573           PERFORM 9900-ERROR-FORMAT
  1574                                 THRU 9900-EXIT
  1575        WHEN OTHER
  1576           MOVE ER-0023          TO EMI-ERROR
  1577           PERFORM 9900-ERROR-FORMAT
  1578                                 THRU 9900-EXIT
  1579           MOVE -1               TO MAINTYPL
  1580           MOVE AL-UABON         TO MAINTYPA
  1581     END-EVALUATE
  1582     .
  1583 1000-INITIAL-SCREEN.
  1584*    MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1585     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1586     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  1587                                    CARRIERO
  1588     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  1589                                    GROUPO
  1590     MOVE PI-ACCT-STATE          TO WS-STATE
  1591                                    STATEO
  1592     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  1593                                    ACCTNOO
  1594     MOVE AL-UANON               TO CARRIERA
  1595                                    GROUPA
  1596                                    STATEA
  1597                                    ACCTNOA
  1598     MOVE ' '                    TO MAINTYPO
  1599     MOVE -1                     TO MAINTYPL
  1600     MOVE '2'                    TO WS-REC-TYPE
  1601     MOVE +0                     TO WS-SEQ-NO
  1602     MOVE WS-CONTROL-PRIMARY     TO WS-SAVE-ERACNT-KEY
  1603
  1604* EXEC CICS STARTBR
  1605*        DATASET   ('ERACNT')
  1606*        RIDFLD    (WS-CONTROL-PRIMARY)
  1607*        GTEQ
  1608*        RESP      (WS-RESPONSE)
  1609*    END-EXEC
  1610     MOVE 'ERACNT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6503.cbl
  1611     MOVE 0
  1612       TO DFHEIV11
  1613*    MOVE '&,         G          &  N#00001576' TO DFHEIV0
  1614     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1616     MOVE X'204E233030303031353736' TO DFHEIV0(25:11)
  1617     CALL 'kxdfhei1' USING DFHEIV0,
  1618           DFHEIV1,
  1619           WS-CONTROL-PRIMARY,
  1620           DFHEIV99,
  1621           DFHEIV11,
  1622           DFHEIV99
  1623     MOVE EIBRESP  TO WS-RESPONSE
  1624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1625     IF NOT RESP-NORMAL
  1626        GO TO 8100-SEND-INITIAL-MAP
  1627     END-IF
  1628     SET ERACNT-BROWSE-STARTED   TO TRUE
  1629
  1630* EXEC CICS READNEXT
  1631*        DATASET  ('ERACNT')
  1632*        INTO     (NOTE-FILE)
  1633*        RIDFLD   (WS-CONTROL-PRIMARY)
  1634*        RESP     (WS-RESPONSE)
  1635*    END-EXEC
  1636     MOVE LENGTH OF
  1637      NOTE-FILE
  1638       TO DFHEIV12
  1639     MOVE 'ERACNT' TO DFHEIV1
  1640     MOVE 0
  1641       TO DFHEIV11
  1642*    MOVE '&.IL                  )  N#00001586' TO DFHEIV0
  1643     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1645     MOVE X'204E233030303031353836' TO DFHEIV0(25:11)
  1646     CALL 'kxdfhei1' USING DFHEIV0,
  1647           DFHEIV1,
  1648           NOTE-FILE,
  1649           DFHEIV12,
  1650           WS-CONTROL-PRIMARY,
  1651           DFHEIV99,
  1652           DFHEIV11,
  1653           DFHEIV99,
  1654           DFHEIV99
  1655     MOVE EIBRESP  TO WS-RESPONSE
  1656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1657     IF (RESP-NORMAL)
  1658        AND (WS-CONTROL-PRIMARY (1:20) =
  1659           WS-SAVE-ERACNT-KEY (1:20))
  1660        IF (WS-REC-TYPE = '2')
  1661           AND (WS-SEQ-NO = 1)
  1662           MOVE NT-BRANCH-LOC-LINE
  1663                                 TO BLINE1O
  1664           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1665                                 THRU 1010-EXIT
  1666
  1667* EXEC CICS READNEXT
  1668*             DATASET  ('ERACNT')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6503.cbl
  1669*             INTO     (NOTE-FILE)
  1670*             RIDFLD   (WS-CONTROL-PRIMARY)
  1671*             RESP     (WS-RESPONSE)
  1672*          END-EXEC
  1673     MOVE LENGTH OF
  1674      NOTE-FILE
  1675       TO DFHEIV12
  1676     MOVE 'ERACNT' TO DFHEIV1
  1677     MOVE 0
  1678       TO DFHEIV11
  1679*    MOVE '&.IL                  )  N#00001601' TO DFHEIV0
  1680     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1681     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1682     MOVE X'204E233030303031363031' TO DFHEIV0(25:11)
  1683     CALL 'kxdfhei1' USING DFHEIV0,
  1684           DFHEIV1,
  1685           NOTE-FILE,
  1686           DFHEIV12,
  1687           WS-CONTROL-PRIMARY,
  1688           DFHEIV99,
  1689           DFHEIV11,
  1690           DFHEIV99,
  1691           DFHEIV99
  1692     MOVE EIBRESP  TO WS-RESPONSE
  1693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1694        END-IF
  1695     ELSE
  1696        MOVE ER-0006             TO EMI-ERROR
  1697        PERFORM 9900-ERROR-FORMAT
  1698                                 THRU 9900-EXIT
  1699     END-IF
  1700     IF (RESP-NORMAL)
  1701        AND (WS-CONTROL-PRIMARY (1:20) =
  1702           WS-SAVE-ERACNT-KEY (1:20))
  1703        IF (WS-REC-TYPE = '2')
  1704           AND (WS-SEQ-NO = 2)
  1705           MOVE NT-BRANCH-LOC-LINE
  1706                                 TO BLINE2O
  1707           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1708                                 THRU 1010-EXIT
  1709
  1710* EXEC CICS READNEXT
  1711*             DATASET  ('ERACNT')
  1712*             INTO     (NOTE-FILE)
  1713*             RIDFLD   (WS-CONTROL-PRIMARY)
  1714*             RESP     (WS-RESPONSE)
  1715*          END-EXEC
  1716     MOVE LENGTH OF
  1717      NOTE-FILE
  1718       TO DFHEIV12
  1719     MOVE 'ERACNT' TO DFHEIV1
  1720     MOVE 0
  1721       TO DFHEIV11
  1722*    MOVE '&.IL                  )  N#00001622' TO DFHEIV0
  1723     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1724     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1725     MOVE X'204E233030303031363232' TO DFHEIV0(25:11)
  1726     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6503.cbl
  1727           DFHEIV1,
  1728           NOTE-FILE,
  1729           DFHEIV12,
  1730           WS-CONTROL-PRIMARY,
  1731           DFHEIV99,
  1732           DFHEIV11,
  1733           DFHEIV99,
  1734           DFHEIV99
  1735     MOVE EIBRESP  TO WS-RESPONSE
  1736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1737        END-IF
  1738     END-IF
  1739     IF (RESP-NORMAL)
  1740        AND (WS-CONTROL-PRIMARY (1:20) =
  1741           WS-SAVE-ERACNT-KEY (1:20))
  1742        IF (WS-REC-TYPE = '3')
  1743           AND (WS-SEQ-NO = 1)
  1744           MOVE NT-SHIPPING-LINE TO SNAME1O
  1745           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1746                                 THRU 1010-EXIT
  1747
  1748* EXEC CICS READNEXT
  1749*             DATASET  ('ERACNT')
  1750*             INTO     (NOTE-FILE)
  1751*             RIDFLD   (WS-CONTROL-PRIMARY)
  1752*             RESP     (WS-RESPONSE)
  1753*          END-EXEC
  1754     MOVE LENGTH OF
  1755      NOTE-FILE
  1756       TO DFHEIV12
  1757     MOVE 'ERACNT' TO DFHEIV1
  1758     MOVE 0
  1759       TO DFHEIV11
  1760*    MOVE '&.IL                  )  N#00001638' TO DFHEIV0
  1761     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1762     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1763     MOVE X'204E233030303031363338' TO DFHEIV0(25:11)
  1764     CALL 'kxdfhei1' USING DFHEIV0,
  1765           DFHEIV1,
  1766           NOTE-FILE,
  1767           DFHEIV12,
  1768           WS-CONTROL-PRIMARY,
  1769           DFHEIV99,
  1770           DFHEIV11,
  1771           DFHEIV99,
  1772           DFHEIV99
  1773     MOVE EIBRESP  TO WS-RESPONSE
  1774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1775        END-IF
  1776     END-IF
  1777     IF (RESP-NORMAL)
  1778        AND (WS-CONTROL-PRIMARY (1:20) =
  1779           WS-SAVE-ERACNT-KEY (1:20))
  1780        IF (WS-REC-TYPE = '3')
  1781           AND (WS-SEQ-NO = 2)
  1782           MOVE NT-SHIPPING-LINE TO SNAME2O
  1783           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1784                                 THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6503.cbl
  1785
  1786* EXEC CICS READNEXT
  1787*             DATASET  ('ERACNT')
  1788*             INTO     (NOTE-FILE)
  1789*             RIDFLD   (WS-CONTROL-PRIMARY)
  1790*             RESP     (WS-RESPONSE)
  1791*          END-EXEC
  1792     MOVE LENGTH OF
  1793      NOTE-FILE
  1794       TO DFHEIV12
  1795     MOVE 'ERACNT' TO DFHEIV1
  1796     MOVE 0
  1797       TO DFHEIV11
  1798*    MOVE '&.IL                  )  N#00001654' TO DFHEIV0
  1799     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1801     MOVE X'204E233030303031363534' TO DFHEIV0(25:11)
  1802     CALL 'kxdfhei1' USING DFHEIV0,
  1803           DFHEIV1,
  1804           NOTE-FILE,
  1805           DFHEIV12,
  1806           WS-CONTROL-PRIMARY,
  1807           DFHEIV99,
  1808           DFHEIV11,
  1809           DFHEIV99,
  1810           DFHEIV99
  1811     MOVE EIBRESP  TO WS-RESPONSE
  1812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1813        END-IF
  1814     END-IF
  1815     IF (RESP-NORMAL)
  1816        AND (WS-CONTROL-PRIMARY (1:20) =
  1817           WS-SAVE-ERACNT-KEY (1:20))
  1818        IF (WS-REC-TYPE = '3')
  1819           AND (WS-SEQ-NO = 3)
  1820           MOVE NT-SHIPPING-LINE TO SADDR1O
  1821           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1822                                 THRU 1010-EXIT
  1823
  1824* EXEC CICS READNEXT
  1825*             DATASET  ('ERACNT')
  1826*             INTO     (NOTE-FILE)
  1827*             RIDFLD   (WS-CONTROL-PRIMARY)
  1828*             RESP     (WS-RESPONSE)
  1829*          END-EXEC
  1830     MOVE LENGTH OF
  1831      NOTE-FILE
  1832       TO DFHEIV12
  1833     MOVE 'ERACNT' TO DFHEIV1
  1834     MOVE 0
  1835       TO DFHEIV11
  1836*    MOVE '&.IL                  )  N#00001670' TO DFHEIV0
  1837     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1839     MOVE X'204E233030303031363730' TO DFHEIV0(25:11)
  1840     CALL 'kxdfhei1' USING DFHEIV0,
  1841           DFHEIV1,
  1842           NOTE-FILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6503.cbl
  1843           DFHEIV12,
  1844           WS-CONTROL-PRIMARY,
  1845           DFHEIV99,
  1846           DFHEIV11,
  1847           DFHEIV99,
  1848           DFHEIV99
  1849     MOVE EIBRESP  TO WS-RESPONSE
  1850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1851        END-IF
  1852     END-IF
  1853     IF (RESP-NORMAL)
  1854        AND (WS-CONTROL-PRIMARY (1:20) =
  1855           WS-SAVE-ERACNT-KEY (1:20))
  1856        IF (WS-REC-TYPE = '3')
  1857           AND (WS-SEQ-NO = 4)
  1858           MOVE NT-SHIPPING-LINE TO SADDR2O
  1859           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1860                                 THRU 1010-EXIT
  1861
  1862* EXEC CICS READNEXT
  1863*             DATASET  ('ERACNT')
  1864*             INTO     (NOTE-FILE)
  1865*             RIDFLD   (WS-CONTROL-PRIMARY)
  1866*             RESP     (WS-RESPONSE)
  1867*          END-EXEC
  1868     MOVE LENGTH OF
  1869      NOTE-FILE
  1870       TO DFHEIV12
  1871     MOVE 'ERACNT' TO DFHEIV1
  1872     MOVE 0
  1873       TO DFHEIV11
  1874*    MOVE '&.IL                  )  N#00001686' TO DFHEIV0
  1875     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1876     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1877     MOVE X'204E233030303031363836' TO DFHEIV0(25:11)
  1878     CALL 'kxdfhei1' USING DFHEIV0,
  1879           DFHEIV1,
  1880           NOTE-FILE,
  1881           DFHEIV12,
  1882           WS-CONTROL-PRIMARY,
  1883           DFHEIV99,
  1884           DFHEIV11,
  1885           DFHEIV99,
  1886           DFHEIV99
  1887     MOVE EIBRESP  TO WS-RESPONSE
  1888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1889        END-IF
  1890     END-IF
  1891     IF (RESP-NORMAL)
  1892        AND (WS-CONTROL-PRIMARY (1:20) =
  1893           WS-SAVE-ERACNT-KEY (1:20))
  1894        IF (WS-REC-TYPE = '3')
  1895           AND (WS-SEQ-NO = 5)
  1896           MOVE NT-SHIPPING-LINE TO SADDR3O
  1897           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1898                                 THRU 1010-EXIT
  1899
  1900* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6503.cbl
  1901*             DATASET  ('ERACNT')
  1902*             INTO     (NOTE-FILE)
  1903*             RIDFLD   (WS-CONTROL-PRIMARY)
  1904*             RESP     (WS-RESPONSE)
  1905*          END-EXEC
  1906     MOVE LENGTH OF
  1907      NOTE-FILE
  1908       TO DFHEIV12
  1909     MOVE 'ERACNT' TO DFHEIV1
  1910     MOVE 0
  1911       TO DFHEIV11
  1912*    MOVE '&.IL                  )  N#00001702' TO DFHEIV0
  1913     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1914     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1915     MOVE X'204E233030303031373032' TO DFHEIV0(25:11)
  1916     CALL 'kxdfhei1' USING DFHEIV0,
  1917           DFHEIV1,
  1918           NOTE-FILE,
  1919           DFHEIV12,
  1920           WS-CONTROL-PRIMARY,
  1921           DFHEIV99,
  1922           DFHEIV11,
  1923           DFHEIV99,
  1924           DFHEIV99
  1925     MOVE EIBRESP  TO WS-RESPONSE
  1926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1927        END-IF
  1928     END-IF
  1929     IF (RESP-NORMAL)
  1930        AND (WS-CONTROL-PRIMARY (1:20) =
  1931           WS-SAVE-ERACNT-KEY (1:20))
  1932        IF (WS-REC-TYPE = '3')
  1933           AND (WS-SEQ-NO = 6)
  1934           MOVE NT-SHIPPING-LINE TO SCITYO
  1935           MOVE NT-SHIP-STATE    TO SSTATEO
  1936           MOVE NT-SHIP-ZIP      TO SZIPO
  1937           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1938                                 THRU 1010-EXIT
  1939        END-IF
  1940     END-IF
  1941     IF ERACNT-BROWSE-STARTED
  1942
  1943* EXEC CICS ENDBR
  1944*          DATASET    ('ERACNT')
  1945*       END-EXEC
  1946     MOVE 'ERACNT' TO DFHEIV1
  1947     MOVE 0
  1948       TO DFHEIV11
  1949*    MOVE '&2                    $   #00001723' TO DFHEIV0
  1950     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1952     MOVE X'2020233030303031373233' TO DFHEIV0(25:11)
  1953     CALL 'kxdfhei1' USING DFHEIV0,
  1954           DFHEIV1,
  1955           DFHEIV11,
  1956           DFHEIV99
  1957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1958     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6503.cbl
  1959     MOVE -1                     TO MAINTYPL
  1960     GO TO 8100-SEND-INITIAL-MAP
  1961     .
  1962 1000-EXIT.
  1963     EXIT.
  1964 1010-BUILD-LAST-MAINT-INFO.
  1965     MOVE NT-LAST-MAINT-BY       TO LSTUSRO
  1966     MOVE NT-LAST-MAINT-HHMMSS   TO TIME-IN
  1967     MOVE TIME-OUT               TO LSTTIMEO
  1968     MOVE NT-LAST-MAINT-DT       TO DC-BIN-DATE-1
  1969     MOVE ' '                    TO DC-OPTION-CODE
  1970     PERFORM 8500-DATE-CONVERSION
  1971                                 THRU 8500-EXIT
  1972     IF NO-CONVERSION-ERROR
  1973        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  1974     END-IF
  1975     .
  1976 1010-EXIT.
  1977     EXIT.
  1978 2000-DELETE-ERACNT.
  1979     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1980     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  1981     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  1982     MOVE PI-ACCT-STATE          TO WS-STATE
  1983     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  1984     MOVE '2'                    TO WS-REC-TYPE
  1985     MOVE +1                     TO WS-SEQ-NO
  1986
  1987* EXEC CICS READ
  1988*       UPDATE
  1989*       DATASET  ('ERACNT')
  1990*       INTO     (NOTE-FILE)
  1991*       RIDFLD   (WS-CONTROL-PRIMARY)
  1992*       RESP     (WS-RESPONSE)
  1993*    END-EXEC
  1994     MOVE LENGTH OF
  1995      NOTE-FILE
  1996       TO DFHEIV11
  1997     MOVE 'ERACNT' TO DFHEIV1
  1998*    MOVE '&"IL       EU         (  N#00001754' TO DFHEIV0
  1999     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2000     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2001     MOVE X'204E233030303031373534' TO DFHEIV0(25:11)
  2002     CALL 'kxdfhei1' USING DFHEIV0,
  2003           DFHEIV1,
  2004           NOTE-FILE,
  2005           DFHEIV11,
  2006           WS-CONTROL-PRIMARY,
  2007           DFHEIV99,
  2008           DFHEIV99,
  2009           DFHEIV99
  2010     MOVE EIBRESP  TO WS-RESPONSE
  2011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2012     IF RESP-NORMAL
  2013
  2014* EXEC CICS DELETE
  2015*          DATASET    ('ERACNT')
  2016*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6503.cbl
  2017*       END-EXEC
  2018     MOVE 'ERACNT' TO DFHEIV1
  2019*    MOVE '&(                    &  N#00001762' TO DFHEIV0
  2020     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2021     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2022     MOVE X'204E233030303031373632' TO DFHEIV0(25:11)
  2023     CALL 'kxdfhei1' USING DFHEIV0,
  2024           DFHEIV1,
  2025           DFHEIV99,
  2026           DFHEIV99,
  2027           DFHEIV99,
  2028           DFHEIV99
  2029     MOVE EIBRESP  TO WS-RESPONSE
  2030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2031     END-IF
  2032     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2033     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2034     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2035     MOVE PI-ACCT-STATE          TO WS-STATE
  2036     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2037     MOVE '2'                    TO WS-REC-TYPE
  2038     MOVE +2                     TO WS-SEQ-NO
  2039
  2040* EXEC CICS READ
  2041*       UPDATE
  2042*       DATASET  ('ERACNT')
  2043*       INTO     (NOTE-FILE)
  2044*       RIDFLD   (WS-CONTROL-PRIMARY)
  2045*       RESP     (WS-RESPONSE)
  2046*    END-EXEC
  2047     MOVE LENGTH OF
  2048      NOTE-FILE
  2049       TO DFHEIV11
  2050     MOVE 'ERACNT' TO DFHEIV1
  2051*    MOVE '&"IL       EU         (  N#00001774' TO DFHEIV0
  2052     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2053     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2054     MOVE X'204E233030303031373734' TO DFHEIV0(25:11)
  2055     CALL 'kxdfhei1' USING DFHEIV0,
  2056           DFHEIV1,
  2057           NOTE-FILE,
  2058           DFHEIV11,
  2059           WS-CONTROL-PRIMARY,
  2060           DFHEIV99,
  2061           DFHEIV99,
  2062           DFHEIV99
  2063     MOVE EIBRESP  TO WS-RESPONSE
  2064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2065     IF RESP-NORMAL
  2066
  2067* EXEC CICS DELETE
  2068*          DATASET    ('ERACNT')
  2069*          RESP       (WS-RESPONSE)
  2070*       END-EXEC
  2071     MOVE 'ERACNT' TO DFHEIV1
  2072*    MOVE '&(                    &  N#00001782' TO DFHEIV0
  2073     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6503.cbl
  2075     MOVE X'204E233030303031373832' TO DFHEIV0(25:11)
  2076     CALL 'kxdfhei1' USING DFHEIV0,
  2077           DFHEIV1,
  2078           DFHEIV99,
  2079           DFHEIV99,
  2080           DFHEIV99,
  2081           DFHEIV99
  2082     MOVE EIBRESP  TO WS-RESPONSE
  2083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2084     END-IF
  2085     PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  2086        (B1 > +6)
  2087        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2088        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2089        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2090        MOVE PI-ACCT-STATE       TO WS-STATE
  2091        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2092        MOVE '3'                 TO WS-REC-TYPE
  2093        MOVE B1                  TO WS-SEQ-NO
  2094
  2095* EXEC CICS READ
  2096*          UPDATE
  2097*          DATASET  ('ERACNT')
  2098*          INTO     (NOTE-FILE)
  2099*          RIDFLD   (WS-CONTROL-PRIMARY)
  2100*          RESP     (WS-RESPONSE)
  2101*       END-EXEC
  2102     MOVE LENGTH OF
  2103      NOTE-FILE
  2104       TO DFHEIV11
  2105     MOVE 'ERACNT' TO DFHEIV1
  2106*    MOVE '&"IL       EU         (  N#00001796' TO DFHEIV0
  2107     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2108     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2109     MOVE X'204E233030303031373936' TO DFHEIV0(25:11)
  2110     CALL 'kxdfhei1' USING DFHEIV0,
  2111           DFHEIV1,
  2112           NOTE-FILE,
  2113           DFHEIV11,
  2114           WS-CONTROL-PRIMARY,
  2115           DFHEIV99,
  2116           DFHEIV99,
  2117           DFHEIV99
  2118     MOVE EIBRESP  TO WS-RESPONSE
  2119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2120        IF RESP-NORMAL
  2121
  2122* EXEC CICS DELETE
  2123*             DATASET    ('ERACNT')
  2124*             RESP       (WS-RESPONSE)
  2125*          END-EXEC
  2126     MOVE 'ERACNT' TO DFHEIV1
  2127*    MOVE '&(                    &  N#00001804' TO DFHEIV0
  2128     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2130     MOVE X'204E233030303031383034' TO DFHEIV0(25:11)
  2131     CALL 'kxdfhei1' USING DFHEIV0,
  2132           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6503.cbl
  2133           DFHEIV99,
  2134           DFHEIV99,
  2135           DFHEIV99,
  2136           DFHEIV99
  2137     MOVE EIBRESP  TO WS-RESPONSE
  2138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2139        END-IF
  2140     END-PERFORM
  2141     .
  2142 2000-EXIT.
  2143     EXIT.
  2144 3000-CHANGE-ERACNT.
  2145     IF BLINE1L > ZEROS
  2146        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2147        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2148        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2149        MOVE PI-ACCT-STATE       TO WS-STATE
  2150        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2151        MOVE '2'                 TO WS-REC-TYPE
  2152        MOVE +1                  TO WS-SEQ-NO
  2153
  2154* EXEC CICS READ
  2155*          UPDATE
  2156*          DATASET  ('ERACNT')
  2157*          INTO     (NOTE-FILE)
  2158*          RIDFLD   (WS-CONTROL-PRIMARY)
  2159*          RESP     (WS-RESPONSE)
  2160*       END-EXEC
  2161     MOVE LENGTH OF
  2162      NOTE-FILE
  2163       TO DFHEIV11
  2164     MOVE 'ERACNT' TO DFHEIV1
  2165*    MOVE '&"IL       EU         (  N#00001822' TO DFHEIV0
  2166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2168     MOVE X'204E233030303031383232' TO DFHEIV0(25:11)
  2169     CALL 'kxdfhei1' USING DFHEIV0,
  2170           DFHEIV1,
  2171           NOTE-FILE,
  2172           DFHEIV11,
  2173           WS-CONTROL-PRIMARY,
  2174           DFHEIV99,
  2175           DFHEIV99,
  2176           DFHEIV99
  2177     MOVE EIBRESP  TO WS-RESPONSE
  2178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2179        IF RESP-NORMAL
  2180           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2181           PERFORM 5020-REWRITE-ERACNT
  2182                                 THRU 5020-EXIT
  2183        ELSE
  2184           PERFORM 4010-ADD-BLINE1
  2185                                 THRU 4010-EXIT
  2186        END-IF
  2187     END-IF
  2188     IF BLINE2L > ZEROS
  2189        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2190        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6503.cbl
  2191        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2192        MOVE PI-ACCT-STATE       TO WS-STATE
  2193        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2194        MOVE '2'                 TO WS-REC-TYPE
  2195        MOVE +2                  TO WS-SEQ-NO
  2196
  2197* EXEC CICS READ
  2198*          UPDATE
  2199*          DATASET  ('ERACNT')
  2200*          INTO     (NOTE-FILE)
  2201*          RIDFLD   (WS-CONTROL-PRIMARY)
  2202*          RESP     (WS-RESPONSE)
  2203*       END-EXEC
  2204     MOVE LENGTH OF
  2205      NOTE-FILE
  2206       TO DFHEIV11
  2207     MOVE 'ERACNT' TO DFHEIV1
  2208*    MOVE '&"IL       EU         (  N#00001846' TO DFHEIV0
  2209     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2210     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2211     MOVE X'204E233030303031383436' TO DFHEIV0(25:11)
  2212     CALL 'kxdfhei1' USING DFHEIV0,
  2213           DFHEIV1,
  2214           NOTE-FILE,
  2215           DFHEIV11,
  2216           WS-CONTROL-PRIMARY,
  2217           DFHEIV99,
  2218           DFHEIV99,
  2219           DFHEIV99
  2220     MOVE EIBRESP  TO WS-RESPONSE
  2221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2222        IF RESP-NORMAL
  2223           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
  2224           PERFORM 5020-REWRITE-ERACNT
  2225                                 THRU 5020-EXIT
  2226        ELSE
  2227           PERFORM 4012-ADD-BLINE2
  2228                                 THRU 4012-EXIT
  2229        END-IF
  2230     END-IF
  2231     IF SNAME1L > ZEROS
  2232        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2233        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2234        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2235        MOVE PI-ACCT-STATE       TO WS-STATE
  2236        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2237        MOVE '3'                 TO WS-REC-TYPE
  2238        MOVE +1                  TO WS-SEQ-NO
  2239
  2240* EXEC CICS READ
  2241*          UPDATE
  2242*          DATASET  ('ERACNT')
  2243*          INTO     (NOTE-FILE)
  2244*          RIDFLD   (WS-CONTROL-PRIMARY)
  2245*          RESP     (WS-RESPONSE)
  2246*       END-EXEC
  2247     MOVE LENGTH OF
  2248      NOTE-FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6503.cbl
  2249       TO DFHEIV11
  2250     MOVE 'ERACNT' TO DFHEIV1
  2251*    MOVE '&"IL       EU         (  N#00001870' TO DFHEIV0
  2252     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2253     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2254     MOVE X'204E233030303031383730' TO DFHEIV0(25:11)
  2255     CALL 'kxdfhei1' USING DFHEIV0,
  2256           DFHEIV1,
  2257           NOTE-FILE,
  2258           DFHEIV11,
  2259           WS-CONTROL-PRIMARY,
  2260           DFHEIV99,
  2261           DFHEIV99,
  2262           DFHEIV99
  2263     MOVE EIBRESP  TO WS-RESPONSE
  2264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2265        IF RESP-NORMAL
  2266           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2267           PERFORM 5020-REWRITE-ERACNT
  2268                                 THRU 5020-EXIT
  2269        ELSE
  2270           PERFORM 4014-ADD-SNAME1
  2271                                 THRU 4014-EXIT
  2272        END-IF
  2273     END-IF
  2274     IF SNAME2L > ZEROS
  2275        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2276        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2277        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2278        MOVE PI-ACCT-STATE       TO WS-STATE
  2279        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2280        MOVE '3'                 TO WS-REC-TYPE
  2281        MOVE +2                  TO WS-SEQ-NO
  2282
  2283* EXEC CICS READ
  2284*          UPDATE
  2285*          DATASET  ('ERACNT')
  2286*          INTO     (NOTE-FILE)
  2287*          RIDFLD   (WS-CONTROL-PRIMARY)
  2288*          RESP     (WS-RESPONSE)
  2289*       END-EXEC
  2290     MOVE LENGTH OF
  2291      NOTE-FILE
  2292       TO DFHEIV11
  2293     MOVE 'ERACNT' TO DFHEIV1
  2294*    MOVE '&"IL       EU         (  N#00001894' TO DFHEIV0
  2295     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2297     MOVE X'204E233030303031383934' TO DFHEIV0(25:11)
  2298     CALL 'kxdfhei1' USING DFHEIV0,
  2299           DFHEIV1,
  2300           NOTE-FILE,
  2301           DFHEIV11,
  2302           WS-CONTROL-PRIMARY,
  2303           DFHEIV99,
  2304           DFHEIV99,
  2305           DFHEIV99
  2306     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6503.cbl
  2307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2308        IF RESP-NORMAL
  2309           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2310           PERFORM 5020-REWRITE-ERACNT
  2311                                 THRU 5020-EXIT
  2312        ELSE
  2313           PERFORM 4016-ADD-SNAME2
  2314                                 THRU 4016-EXIT
  2315        END-IF
  2316     END-IF
  2317     IF SADDR1L > ZEROS
  2318        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2319        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2320        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2321        MOVE PI-ACCT-STATE       TO WS-STATE
  2322        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2323        MOVE '3'                 TO WS-REC-TYPE
  2324        MOVE +3                  TO WS-SEQ-NO
  2325
  2326* EXEC CICS READ
  2327*          UPDATE
  2328*          DATASET  ('ERACNT')
  2329*          INTO     (NOTE-FILE)
  2330*          RIDFLD   (WS-CONTROL-PRIMARY)
  2331*          RESP     (WS-RESPONSE)
  2332*       END-EXEC
  2333     MOVE LENGTH OF
  2334      NOTE-FILE
  2335       TO DFHEIV11
  2336     MOVE 'ERACNT' TO DFHEIV1
  2337*    MOVE '&"IL       EU         (  N#00001918' TO DFHEIV0
  2338     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2340     MOVE X'204E233030303031393138' TO DFHEIV0(25:11)
  2341     CALL 'kxdfhei1' USING DFHEIV0,
  2342           DFHEIV1,
  2343           NOTE-FILE,
  2344           DFHEIV11,
  2345           WS-CONTROL-PRIMARY,
  2346           DFHEIV99,
  2347           DFHEIV99,
  2348           DFHEIV99
  2349     MOVE EIBRESP  TO WS-RESPONSE
  2350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2351        IF RESP-NORMAL
  2352           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2353           PERFORM 5020-REWRITE-ERACNT
  2354                                 THRU 5020-EXIT
  2355        ELSE
  2356           PERFORM 4018-ADD-SADDR1
  2357                                 THRU 4018-EXIT
  2358        END-IF
  2359     END-IF
  2360     IF SADDR2L > ZEROS
  2361        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2362        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2363        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2364        MOVE PI-ACCT-STATE       TO WS-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6503.cbl
  2365        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2366        MOVE '3'                 TO WS-REC-TYPE
  2367        MOVE +4                  TO WS-SEQ-NO
  2368
  2369* EXEC CICS READ
  2370*          UPDATE
  2371*          DATASET  ('ERACNT')
  2372*          INTO     (NOTE-FILE)
  2373*          RIDFLD   (WS-CONTROL-PRIMARY)
  2374*          RESP     (WS-RESPONSE)
  2375*       END-EXEC
  2376     MOVE LENGTH OF
  2377      NOTE-FILE
  2378       TO DFHEIV11
  2379     MOVE 'ERACNT' TO DFHEIV1
  2380*    MOVE '&"IL       EU         (  N#00001942' TO DFHEIV0
  2381     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2382     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2383     MOVE X'204E233030303031393432' TO DFHEIV0(25:11)
  2384     CALL 'kxdfhei1' USING DFHEIV0,
  2385           DFHEIV1,
  2386           NOTE-FILE,
  2387           DFHEIV11,
  2388           WS-CONTROL-PRIMARY,
  2389           DFHEIV99,
  2390           DFHEIV99,
  2391           DFHEIV99
  2392     MOVE EIBRESP  TO WS-RESPONSE
  2393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2394        IF RESP-NORMAL
  2395           MOVE SADDR2I          TO NT-SHIPPING-LINE
  2396           PERFORM 5020-REWRITE-ERACNT
  2397                                 THRU 5020-EXIT
  2398        ELSE
  2399           PERFORM 4020-ADD-SADDR2
  2400                                 THRU 4020-EXIT
  2401        END-IF
  2402     END-IF
  2403     IF SADDR3L    > ZEROS
  2404        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2405        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2406        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2407        MOVE PI-ACCT-STATE       TO WS-STATE
  2408        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2409        MOVE '3'                 TO WS-REC-TYPE
  2410        MOVE +5                  TO WS-SEQ-NO
  2411
  2412* EXEC CICS READ
  2413*          UPDATE
  2414*          DATASET  ('ERACNT')
  2415*          INTO     (NOTE-FILE)
  2416*          RIDFLD   (WS-CONTROL-PRIMARY)
  2417*          RESP     (WS-RESPONSE)
  2418*       END-EXEC
  2419     MOVE LENGTH OF
  2420      NOTE-FILE
  2421       TO DFHEIV11
  2422     MOVE 'ERACNT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6503.cbl
  2423*    MOVE '&"IL       EU         (  N#00001966' TO DFHEIV0
  2424     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2425     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2426     MOVE X'204E233030303031393636' TO DFHEIV0(25:11)
  2427     CALL 'kxdfhei1' USING DFHEIV0,
  2428           DFHEIV1,
  2429           NOTE-FILE,
  2430           DFHEIV11,
  2431           WS-CONTROL-PRIMARY,
  2432           DFHEIV99,
  2433           DFHEIV99,
  2434           DFHEIV99
  2435     MOVE EIBRESP  TO WS-RESPONSE
  2436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2437        IF RESP-NORMAL
  2438           MOVE SADDR3I          TO NT-SHIPPING-LINE
  2439           PERFORM 5020-REWRITE-ERACNT
  2440                                 THRU 5020-EXIT
  2441        ELSE
  2442           PERFORM 4022-ADD-SADDR3
  2443                                 THRU 4022-EXIT
  2444        END-IF
  2445     END-IF
  2446     IF (SCITYL     > ZEROS)
  2447        OR (SSTATEL > ZEROS)
  2448        OR (SZIPL   > ZEROS)
  2449        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2450        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2451        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2452        MOVE PI-ACCT-STATE       TO WS-STATE
  2453        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2454        MOVE '3'                 TO WS-REC-TYPE
  2455        MOVE +6                  TO WS-SEQ-NO
  2456
  2457* EXEC CICS READ
  2458*          UPDATE
  2459*          DATASET  ('ERACNT')
  2460*          INTO     (NOTE-FILE)
  2461*          RIDFLD   (WS-CONTROL-PRIMARY)
  2462*          RESP     (WS-RESPONSE)
  2463*       END-EXEC
  2464     MOVE LENGTH OF
  2465      NOTE-FILE
  2466       TO DFHEIV11
  2467     MOVE 'ERACNT' TO DFHEIV1
  2468*    MOVE '&"IL       EU         (  N#00001992' TO DFHEIV0
  2469     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2470     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2471     MOVE X'204E233030303031393932' TO DFHEIV0(25:11)
  2472     CALL 'kxdfhei1' USING DFHEIV0,
  2473           DFHEIV1,
  2474           NOTE-FILE,
  2475           DFHEIV11,
  2476           WS-CONTROL-PRIMARY,
  2477           DFHEIV99,
  2478           DFHEIV99,
  2479           DFHEIV99
  2480     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6503.cbl
  2481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2482        IF RESP-NORMAL
  2483           IF SCITYL > ZEROS
  2484              MOVE SCITYI        TO NT-SHIPPING-LINE
  2485           END-IF
  2486           IF SSTATEL > ZEROS
  2487              MOVE SSTATEI       TO NT-SHIP-STATE
  2488           END-IF
  2489           IF SZIPL > ZEROS
  2490              MOVE SZIPI         TO NT-SHIP-ZIP
  2491           END-IF
  2492           PERFORM 5020-REWRITE-ERACNT
  2493                                 THRU 5020-EXIT
  2494        ELSE
  2495           PERFORM 4024-ADD-SCITYSTZP
  2496                                 THRU 4024-EXIT
  2497        END-IF
  2498     END-IF
  2499     .
  2500 3000-EXIT.
  2501     EXIT.
  2502 4000-ADD-ERACNT.
  2503     PERFORM 4010-ADD-BLINE1     THRU 4010-EXIT
  2504     PERFORM 4012-ADD-BLINE2     THRU 4012-EXIT
  2505     PERFORM 4014-ADD-SNAME1     THRU 4014-EXIT
  2506     PERFORM 4016-ADD-SNAME2     THRU 4016-EXIT
  2507     PERFORM 4018-ADD-SADDR1     THRU 4018-EXIT
  2508     PERFORM 4020-ADD-SADDR2     THRU 4020-EXIT
  2509     PERFORM 4022-ADD-SADDR3     THRU 4022-EXIT
  2510     PERFORM 4024-ADD-SCITYSTZP  THRU 4024-EXIT
  2511     .
  2512 4000-EXIT.
  2513     EXIT.
  2514 4010-ADD-BLINE1.
  2515     IF BLINE1L > ZEROS
  2516        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2517        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2518        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2519        MOVE PI-ACCT-STATE       TO WS-STATE
  2520        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2521        MOVE '2'                 TO WS-REC-TYPE
  2522        MOVE +1                  TO WS-SEQ-NO
  2523
  2524* EXEC CICS READ
  2525*          DATASET  ('ERACNT')
  2526*          INTO     (NOTE-FILE)
  2527*          RIDFLD   (WS-CONTROL-PRIMARY)
  2528*          RESP     (WS-RESPONSE)
  2529*       END-EXEC
  2530     MOVE LENGTH OF
  2531      NOTE-FILE
  2532       TO DFHEIV11
  2533     MOVE 'ERACNT' TO DFHEIV1
  2534*    MOVE '&"IL       E          (  N#00002040' TO DFHEIV0
  2535     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2537     MOVE X'204E233030303032303430' TO DFHEIV0(25:11)
  2538     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6503.cbl
  2539           DFHEIV1,
  2540           NOTE-FILE,
  2541           DFHEIV11,
  2542           WS-CONTROL-PRIMARY,
  2543           DFHEIV99,
  2544           DFHEIV99,
  2545           DFHEIV99
  2546     MOVE EIBRESP  TO WS-RESPONSE
  2547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2548        IF RESP-NOTFND
  2549           PERFORM 5010-BUILD-ERACNT
  2550                                 THRU 5010-EXIT
  2551           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2552           PERFORM 5000-WRITE-ERACNT
  2553                                 THRU 5000-EXIT
  2554        END-IF
  2555     END-IF
  2556     .
  2557 4010-EXIT.
  2558     EXIT.
  2559 4012-ADD-BLINE2.
  2560     IF BLINE2L > ZEROS
  2561        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2562        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2563        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2564        MOVE PI-ACCT-STATE       TO WS-STATE
  2565        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2566        MOVE '2'                 TO WS-REC-TYPE
  2567        MOVE +2                  TO WS-SEQ-NO
  2568
  2569* EXEC CICS READ
  2570*          DATASET  ('ERACNT')
  2571*          INTO     (NOTE-FILE)
  2572*          RIDFLD   (WS-CONTROL-PRIMARY)
  2573*          RESP     (WS-RESPONSE)
  2574*       END-EXEC
  2575     MOVE LENGTH OF
  2576      NOTE-FILE
  2577       TO DFHEIV11
  2578     MOVE 'ERACNT' TO DFHEIV1
  2579*    MOVE '&"IL       E          (  N#00002066' TO DFHEIV0
  2580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2582     MOVE X'204E233030303032303636' TO DFHEIV0(25:11)
  2583     CALL 'kxdfhei1' USING DFHEIV0,
  2584           DFHEIV1,
  2585           NOTE-FILE,
  2586           DFHEIV11,
  2587           WS-CONTROL-PRIMARY,
  2588           DFHEIV99,
  2589           DFHEIV99,
  2590           DFHEIV99
  2591     MOVE EIBRESP  TO WS-RESPONSE
  2592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2593        IF RESP-NOTFND
  2594           PERFORM 5010-BUILD-ERACNT
  2595                                 THRU 5010-EXIT
  2596           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6503.cbl
  2597           PERFORM 5000-WRITE-ERACNT
  2598                                 THRU 5000-EXIT
  2599        END-IF
  2600     END-IF
  2601     .
  2602 4012-EXIT.
  2603     EXIT.
  2604 4014-ADD-SNAME1.
  2605     IF SNAME1L > ZEROS
  2606        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2607        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2608        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2609        MOVE PI-ACCT-STATE       TO WS-STATE
  2610        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2611        MOVE '3'                 TO WS-REC-TYPE
  2612        MOVE +1                  TO WS-SEQ-NO
  2613
  2614* EXEC CICS READ
  2615*          DATASET  ('ERACNT')
  2616*          INTO     (NOTE-FILE)
  2617*          RIDFLD   (WS-CONTROL-PRIMARY)
  2618*          RESP     (WS-RESPONSE)
  2619*       END-EXEC
  2620     MOVE LENGTH OF
  2621      NOTE-FILE
  2622       TO DFHEIV11
  2623     MOVE 'ERACNT' TO DFHEIV1
  2624*    MOVE '&"IL       E          (  N#00002092' TO DFHEIV0
  2625     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2627     MOVE X'204E233030303032303932' TO DFHEIV0(25:11)
  2628     CALL 'kxdfhei1' USING DFHEIV0,
  2629           DFHEIV1,
  2630           NOTE-FILE,
  2631           DFHEIV11,
  2632           WS-CONTROL-PRIMARY,
  2633           DFHEIV99,
  2634           DFHEIV99,
  2635           DFHEIV99
  2636     MOVE EIBRESP  TO WS-RESPONSE
  2637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2638        IF RESP-NOTFND
  2639           PERFORM 5010-BUILD-ERACNT
  2640                                 THRU 5010-EXIT
  2641           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2642           PERFORM 5000-WRITE-ERACNT
  2643                                 THRU 5000-EXIT
  2644        END-IF
  2645     END-IF
  2646     .
  2647 4014-EXIT.
  2648     EXIT.
  2649 4016-ADD-SNAME2.
  2650     IF SNAME2L > ZEROS
  2651        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2652        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2653        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2654        MOVE PI-ACCT-STATE       TO WS-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6503.cbl
  2655        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2656        MOVE '3'                 TO WS-REC-TYPE
  2657        MOVE +2                  TO WS-SEQ-NO
  2658
  2659* EXEC CICS READ
  2660*          DATASET  ('ERACNT')
  2661*          INTO     (NOTE-FILE)
  2662*          RIDFLD   (WS-CONTROL-PRIMARY)
  2663*          RESP     (WS-RESPONSE)
  2664*       END-EXEC
  2665     MOVE LENGTH OF
  2666      NOTE-FILE
  2667       TO DFHEIV11
  2668     MOVE 'ERACNT' TO DFHEIV1
  2669*    MOVE '&"IL       E          (  N#00002118' TO DFHEIV0
  2670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2672     MOVE X'204E233030303032313138' TO DFHEIV0(25:11)
  2673     CALL 'kxdfhei1' USING DFHEIV0,
  2674           DFHEIV1,
  2675           NOTE-FILE,
  2676           DFHEIV11,
  2677           WS-CONTROL-PRIMARY,
  2678           DFHEIV99,
  2679           DFHEIV99,
  2680           DFHEIV99
  2681     MOVE EIBRESP  TO WS-RESPONSE
  2682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2683        IF RESP-NOTFND
  2684           PERFORM 5010-BUILD-ERACNT
  2685                                 THRU 5010-EXIT
  2686           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2687           PERFORM 5000-WRITE-ERACNT
  2688                                 THRU 5000-EXIT
  2689        END-IF
  2690     END-IF
  2691     .
  2692 4016-EXIT.
  2693     EXIT.
  2694 4018-ADD-SADDR1.
  2695     IF SADDR1L > ZEROS
  2696        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2697        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2698        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2699        MOVE PI-ACCT-STATE       TO WS-STATE
  2700        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2701        MOVE '3'                 TO WS-REC-TYPE
  2702        MOVE +3                  TO WS-SEQ-NO
  2703
  2704* EXEC CICS READ
  2705*          DATASET  ('ERACNT')
  2706*          INTO     (NOTE-FILE)
  2707*          RIDFLD   (WS-CONTROL-PRIMARY)
  2708*          RESP     (WS-RESPONSE)
  2709*       END-EXEC
  2710     MOVE LENGTH OF
  2711      NOTE-FILE
  2712       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6503.cbl
  2713     MOVE 'ERACNT' TO DFHEIV1
  2714*    MOVE '&"IL       E          (  N#00002144' TO DFHEIV0
  2715     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2717     MOVE X'204E233030303032313434' TO DFHEIV0(25:11)
  2718     CALL 'kxdfhei1' USING DFHEIV0,
  2719           DFHEIV1,
  2720           NOTE-FILE,
  2721           DFHEIV11,
  2722           WS-CONTROL-PRIMARY,
  2723           DFHEIV99,
  2724           DFHEIV99,
  2725           DFHEIV99
  2726     MOVE EIBRESP  TO WS-RESPONSE
  2727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2728        IF RESP-NOTFND
  2729           PERFORM 5010-BUILD-ERACNT
  2730                                 THRU 5010-EXIT
  2731           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2732           PERFORM 5000-WRITE-ERACNT
  2733                                 THRU 5000-EXIT
  2734        END-IF
  2735     END-IF
  2736     .
  2737 4018-EXIT.
  2738     EXIT.
  2739 4020-ADD-SADDR2.
  2740     IF SADDR2L > ZEROS
  2741        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2742        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2743        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2744        MOVE PI-ACCT-STATE       TO WS-STATE
  2745        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2746        MOVE '3'                 TO WS-REC-TYPE
  2747        MOVE +4                  TO WS-SEQ-NO
  2748
  2749* EXEC CICS READ
  2750*          DATASET  ('ERACNT')
  2751*          INTO     (NOTE-FILE)
  2752*          RIDFLD   (WS-CONTROL-PRIMARY)
  2753*          RESP     (WS-RESPONSE)
  2754*       END-EXEC
  2755     MOVE LENGTH OF
  2756      NOTE-FILE
  2757       TO DFHEIV11
  2758     MOVE 'ERACNT' TO DFHEIV1
  2759*    MOVE '&"IL       E          (  N#00002170' TO DFHEIV0
  2760     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2762     MOVE X'204E233030303032313730' TO DFHEIV0(25:11)
  2763     CALL 'kxdfhei1' USING DFHEIV0,
  2764           DFHEIV1,
  2765           NOTE-FILE,
  2766           DFHEIV11,
  2767           WS-CONTROL-PRIMARY,
  2768           DFHEIV99,
  2769           DFHEIV99,
  2770           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6503.cbl
  2771     MOVE EIBRESP  TO WS-RESPONSE
  2772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2773        IF RESP-NOTFND
  2774           PERFORM 5010-BUILD-ERACNT
  2775                                 THRU 5010-EXIT
  2776           MOVE SADDR2I          TO NT-SHIPPING-LINE
  2777           PERFORM 5000-WRITE-ERACNT
  2778                                 THRU 5000-EXIT
  2779        END-IF
  2780     END-IF
  2781    .
  2782 4020-EXIT.
  2783     EXIT.
  2784 4022-ADD-SADDR3.
  2785     IF SADDR3L    > ZEROS
  2786        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2787        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2788        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2789        MOVE PI-ACCT-STATE       TO WS-STATE
  2790        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2791        MOVE '3'                 TO WS-REC-TYPE
  2792        MOVE +5                  TO WS-SEQ-NO
  2793
  2794* EXEC CICS READ
  2795*          DATASET  ('ERACNT')
  2796*          INTO     (NOTE-FILE)
  2797*          RIDFLD   (WS-CONTROL-PRIMARY)
  2798*          RESP     (WS-RESPONSE)
  2799*       END-EXEC
  2800     MOVE LENGTH OF
  2801      NOTE-FILE
  2802       TO DFHEIV11
  2803     MOVE 'ERACNT' TO DFHEIV1
  2804*    MOVE '&"IL       E          (  N#00002196' TO DFHEIV0
  2805     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2807     MOVE X'204E233030303032313936' TO DFHEIV0(25:11)
  2808     CALL 'kxdfhei1' USING DFHEIV0,
  2809           DFHEIV1,
  2810           NOTE-FILE,
  2811           DFHEIV11,
  2812           WS-CONTROL-PRIMARY,
  2813           DFHEIV99,
  2814           DFHEIV99,
  2815           DFHEIV99
  2816     MOVE EIBRESP  TO WS-RESPONSE
  2817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2818        IF RESP-NOTFND
  2819           PERFORM 5010-BUILD-ERACNT
  2820                                 THRU 5010-EXIT
  2821           MOVE SADDR3I          TO NT-SHIPPING-LINE
  2822           PERFORM 5000-WRITE-ERACNT
  2823                                 THRU 5000-EXIT
  2824        END-IF
  2825     END-IF
  2826     .
  2827 4022-EXIT.
  2828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6503.cbl
  2829 4024-ADD-SCITYSTZP.
  2830     IF (SCITYL     > ZEROS)
  2831        OR (SSTATEL > ZEROS)
  2832        OR (SZIPL   > ZEROS)
  2833        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2834        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2835        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2836        MOVE PI-ACCT-STATE       TO WS-STATE
  2837        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2838        MOVE '3'                 TO WS-REC-TYPE
  2839        MOVE +6                  TO WS-SEQ-NO
  2840
  2841* EXEC CICS READ
  2842*          DATASET  ('ERACNT')
  2843*          INTO     (NOTE-FILE)
  2844*          RIDFLD   (WS-CONTROL-PRIMARY)
  2845*          RESP     (WS-RESPONSE)
  2846*       END-EXEC
  2847     MOVE LENGTH OF
  2848      NOTE-FILE
  2849       TO DFHEIV11
  2850     MOVE 'ERACNT' TO DFHEIV1
  2851*    MOVE '&"IL       E          (  N#00002224' TO DFHEIV0
  2852     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2854     MOVE X'204E233030303032323234' TO DFHEIV0(25:11)
  2855     CALL 'kxdfhei1' USING DFHEIV0,
  2856           DFHEIV1,
  2857           NOTE-FILE,
  2858           DFHEIV11,
  2859           WS-CONTROL-PRIMARY,
  2860           DFHEIV99,
  2861           DFHEIV99,
  2862           DFHEIV99
  2863     MOVE EIBRESP  TO WS-RESPONSE
  2864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2865        IF RESP-NOTFND
  2866           PERFORM 5010-BUILD-ERACNT
  2867                                 THRU 5010-EXIT
  2868           IF SCITYL > ZEROS
  2869              MOVE SCITYI        TO NT-SHIPPING-LINE
  2870           END-IF
  2871           IF SSTATEL > ZEROS
  2872              MOVE SSTATEI       TO NT-SHIP-STATE
  2873           END-IF
  2874           IF SZIPL > ZEROS
  2875              MOVE SZIPI         TO NT-SHIP-ZIP
  2876           END-IF
  2877           PERFORM 5000-WRITE-ERACNT
  2878                                 THRU 5000-EXIT
  2879        END-IF
  2880     END-IF
  2881     .
  2882 4024-EXIT.
  2883     EXIT.
  2884 5000-WRITE-ERACNT.
  2885     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2886     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6503.cbl
  2887     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2888
  2889* EXEC CICS WRITE
  2890*         FROM    (NOTE-FILE)
  2891*         DATASET ('ERACNT')
  2892*         RIDFLD  (WS-CONTROL-PRIMARY)
  2893*         RESP    (WS-RESPONSE)
  2894*    END-EXEC
  2895     MOVE LENGTH OF
  2896      NOTE-FILE
  2897       TO DFHEIV11
  2898     MOVE 'ERACNT' TO DFHEIV1
  2899*    MOVE '&$ L                  ''  N#00002253' TO DFHEIV0
  2900     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2902     MOVE X'204E233030303032323533' TO DFHEIV0(25:11)
  2903     CALL 'kxdfhei1' USING DFHEIV0,
  2904           DFHEIV1,
  2905           NOTE-FILE,
  2906           DFHEIV11,
  2907           WS-CONTROL-PRIMARY,
  2908           DFHEIV99,
  2909           DFHEIV99
  2910     MOVE EIBRESP  TO WS-RESPONSE
  2911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2912     .
  2913 5000-EXIT.
  2914     EXIT.
  2915 5010-BUILD-ERACNT.
  2916     MOVE SPACES                 TO NOTE-FILE
  2917     MOVE 'NT'                   TO NT-FILE-ID
  2918     MOVE WS-CONTROL-PRIMARY     TO NT-CONTROL-PRIMARY
  2919     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2920     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  2921     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2922     .
  2923 5010-EXIT.
  2924     EXIT.
  2925 5020-REWRITE-ERACNT.
  2926     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2927     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  2928     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2929
  2930* EXEC CICS REWRITE
  2931*         FROM    (NOTE-FILE)
  2932*         DATASET ('ERACNT')
  2933*         RESP    (WS-RESPONSE)
  2934*    END-EXEC
  2935     MOVE LENGTH OF
  2936      NOTE-FILE
  2937       TO DFHEIV11
  2938     MOVE 'ERACNT' TO DFHEIV1
  2939*    MOVE '&& L                  %  N#00002276' TO DFHEIV0
  2940     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2941     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2942     MOVE X'204E233030303032323736' TO DFHEIV0(25:11)
  2943     CALL 'kxdfhei1' USING DFHEIV0,
  2944           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6503.cbl
  2945           NOTE-FILE,
  2946           DFHEIV11,
  2947           DFHEIV99
  2948     MOVE EIBRESP  TO WS-RESPONSE
  2949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2950     .
  2951 5020-EXIT.
  2952     EXIT.
  2953 8100-SEND-INITIAL-MAP.
  2954     MOVE -1                     TO  MAINTYPL
  2955     MOVE SAVE-DATE              TO  RUNDATEO
  2956     MOVE EIBTIME                TO  TIME-IN
  2957     MOVE TIME-OUT               TO  RUNTIMEO
  2958     IF EMI-ERROR NOT = ZERO
  2959         PERFORM 9900-ERROR-FORMAT
  2960     END-IF
  2961     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  2962
  2963* EXEC CICS SEND
  2964*        FROM   (EL6503AO)
  2965*        MAPSET (WS-MAPSET-NAME)
  2966*        MAP    (WS-MAP-NAME)
  2967*        CURSOR ERASE
  2968*    END-EXEC.
  2969     MOVE LENGTH OF
  2970      EL6503AO
  2971       TO DFHEIV12
  2972     MOVE -1
  2973       TO DFHEIV11
  2974*    MOVE '8$     CT  E    H L F ,   #00002293' TO DFHEIV0
  2975     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2976     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2977     MOVE X'2020233030303032323933' TO DFHEIV0(25:11)
  2978     CALL 'kxdfhei1' USING DFHEIV0,
  2979           WS-MAP-NAME,
  2980           EL6503AO,
  2981           DFHEIV12,
  2982           WS-MAPSET-NAME,
  2983           DFHEIV99,
  2984           DFHEIV99,
  2985           DFHEIV99,
  2986           DFHEIV11,
  2987           DFHEIV99,
  2988           DFHEIV99,
  2989           DFHEIV99
  2990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2991
  2992     GO TO 9100-RETURN-TRAN
  2993     .
  2994 8100-EXIT.
  2995      EXIT.
  2996 8200-SEND-DATAONLY.
  2997     MOVE SAVE-DATE              TO  RUNDATEO
  2998     MOVE EIBTIME                TO  TIME-IN
  2999     MOVE TIME-OUT               TO  RUNTIMEO
  3000     IF EMI-ERROR NOT = ZERO
  3001        PERFORM 9900-ERROR-FORMAT
  3002     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6503.cbl
  3003     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3004
  3005* EXEC CICS SEND DATAONLY
  3006*        FROM   (EL6503AO)
  3007*        MAPSET (WS-MAPSET-NAME)
  3008*        MAP    (WS-MAP-NAME)
  3009*        CURSOR
  3010*    END-EXEC.
  3011     MOVE LENGTH OF
  3012      EL6503AO
  3013       TO DFHEIV12
  3014     MOVE -1
  3015       TO DFHEIV11
  3016*    MOVE '8$D    CT       H L F ,   #00002311' TO DFHEIV0
  3017     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3018     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3019     MOVE X'2020233030303032333131' TO DFHEIV0(25:11)
  3020     CALL 'kxdfhei1' USING DFHEIV0,
  3021           WS-MAP-NAME,
  3022           EL6503AO,
  3023           DFHEIV12,
  3024           WS-MAPSET-NAME,
  3025           DFHEIV99,
  3026           DFHEIV99,
  3027           DFHEIV99,
  3028           DFHEIV11,
  3029           DFHEIV99,
  3030           DFHEIV99,
  3031           DFHEIV99
  3032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3033
  3034     GO TO 9100-RETURN-TRAN
  3035     .
  3036 8200-EXIT.
  3037      EXIT.
  3038 8300-SEND-TEXT.
  3039
  3040* EXEC CICS SEND TEXT
  3041*        FROM   (LOGOFF-TEXT)
  3042*        LENGTH (LOGOFF-LENGTH)
  3043*        ERASE  FREEKB
  3044*    END-EXEC.
  3045*    MOVE '8&      T  E F  H   F -   #00002322' TO DFHEIV0
  3046     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3047     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3048     MOVE X'2020233030303032333232' TO DFHEIV0(25:11)
  3049     CALL 'kxdfhei1' USING DFHEIV0,
  3050           LOGOFF-TEXT,
  3051           LOGOFF-LENGTH,
  3052           DFHEIV99,
  3053           DFHEIV99,
  3054           DFHEIV99,
  3055           DFHEIV99,
  3056           DFHEIV99,
  3057           DFHEIV99,
  3058           DFHEIV99,
  3059           DFHEIV99,
  3060           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6503.cbl
  3061           DFHEIV99
  3062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3063
  3064
  3065* EXEC CICS RETURN
  3066*    END-EXEC.
  3067*    MOVE '.(                    &   #00002327' TO DFHEIV0
  3068     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3069     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3070     MOVE X'2020233030303032333237' TO DFHEIV0(25:11)
  3071     CALL 'kxdfhei1' USING DFHEIV0,
  3072           DFHEIV99,
  3073           DFHEIV99,
  3074           DFHEIV99,
  3075           DFHEIV99,
  3076           DFHEIV99
  3077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3078
  3079 8300-EXIT.
  3080      EXIT.
  3081 8400-LOG-JOURNAL-RECORD.
  3082     IF PI-JOURNAL-FILE-ID = 0
  3083        GO TO 8400-EXIT
  3084     END-IF
  3085     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  3086     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  3087     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  3088*    EXEC CICS JOURNAL
  3089*        JFILEID (PI-JOURNAL-FILE-ID)
  3090*        JTYPEID (WS-JOURNAL-TYPE-ID)
  3091*        FROM    (JOURNAL-RECORD)
  3092*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  3093*    END-EXEC.
  3094 8400-EXIT.
  3095      EXIT.
  3096 8500-DATE-CONVERSION.
  3097
  3098* EXEC CICS LINK
  3099*        PROGRAM  ('ELDATCV')
  3100*        COMMAREA (DATE-CONVERSION-DATA)
  3101*        LENGTH   (DC-COMM-LENGTH)
  3102*    END-EXEC.
  3103     MOVE 'ELDATCV' TO DFHEIV1
  3104*    MOVE '."C                   ''   #00002347' TO DFHEIV0
  3105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3106     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3107     MOVE X'2020233030303032333437' TO DFHEIV0(25:11)
  3108     CALL 'kxdfhei1' USING DFHEIV0,
  3109           DFHEIV1,
  3110           DATE-CONVERSION-DATA,
  3111           DC-COMM-LENGTH,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99
  3115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3116
  3117 8500-EXIT.
  3118      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6503.cbl
  3119 9000-RETURN-CICS.
  3120     MOVE 'EL005'                TO  THIS-PGM.
  3121     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  3122     PERFORM 9300-XCTL.
  3123 9000-EXIT.
  3124      EXIT.
  3125 9100-RETURN-TRAN.
  3126     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  3127     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  3128
  3129* EXEC CICS RETURN
  3130*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3131*        LENGTH   (PI-COMM-LENGTH)
  3132*        TRANSID  (WS-TRANS-ID)
  3133*    END-EXEC.
  3134*    MOVE '.(CT                  &   #00002363' TO DFHEIV0
  3135     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3137     MOVE X'2020233030303032333633' TO DFHEIV0(25:11)
  3138     CALL 'kxdfhei1' USING DFHEIV0,
  3139           WS-TRANS-ID,
  3140           PROGRAM-INTERFACE-BLOCK,
  3141           PI-COMM-LENGTH,
  3142           DFHEIV99,
  3143           DFHEIV99
  3144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3145
  3146 9100-EXIT.
  3147      EXIT.
  3148*****************************************************************
  3149 9300-XCTL.
  3150*****************************************************************
  3151     MOVE DFHENTER               TO  EIBAID.
  3152
  3153* EXEC CICS XCTL
  3154*        PROGRAM  (THIS-PGM)
  3155*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3156*        LENGTH   (PI-COMM-LENGTH)
  3157*    END-EXEC.
  3158*    MOVE '.$C                   $   #00002374' TO DFHEIV0
  3159     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3160     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3161     MOVE X'2020233030303032333734' TO DFHEIV0(25:11)
  3162     CALL 'kxdfhei1' USING DFHEIV0,
  3163           THIS-PGM,
  3164           PROGRAM-INTERFACE-BLOCK,
  3165           PI-COMM-LENGTH
  3166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3167
  3168 9300-EXIT.
  3169      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6503.cbl
  3171*****************************************************************
  3172 9400-CLEAR.
  3173*****************************************************************
  3174     MOVE PI-RETURN-TO-PROGRAM   TO THIS-PGM
  3175     PERFORM 9300-XCTL
  3176     .
  3177 9400-EXIT.
  3178      EXIT.
  3179*****************************************************************
  3180 9600-PGMIDERR.
  3181*****************************************************************
  3182
  3183* EXEC CICS HANDLE CONDITION
  3184*        PGMIDERR (8300-SEND-TEXT)
  3185*    END-EXEC.
  3186*    MOVE '"$L                   ! # #00002393' TO DFHEIV0
  3187     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3189     MOVE X'2320233030303032333933' TO DFHEIV0(25:11)
  3190     CALL 'kxdfhei1' USING DFHEIV0
  3191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3192
  3193     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  3194                                     LOGOFF-PGM.
  3195     MOVE 'EL005'                TO  THIS-PGM.
  3196     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3197     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3198     PERFORM 9300-XCTL.
  3199 9600-EXIT.
  3200      EXIT.
  3201*****************************************************************
  3202 9900-ERROR-FORMAT.
  3203*****************************************************************
  3204     IF EMI-ERRORS-COMPLETE
  3205         ADD +1             TO  EMI-FATAL-CTR
  3206         MOVE ZERO          TO  EMI-ERROR
  3207         GO TO 9900-EXIT.
  3208
  3209* EXEC CICS LINK
  3210*        PROGRAM  ('EL001')
  3211*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3212*        LENGTH   (EMI-COMM-LENGTH)
  3213*    END-EXEC.
  3214     MOVE 'EL001' TO DFHEIV1
  3215*    MOVE '."C                   ''   #00002411' TO DFHEIV0
  3216     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3218     MOVE X'2020233030303032343131' TO DFHEIV0(25:11)
  3219     CALL 'kxdfhei1' USING DFHEIV0,
  3220           DFHEIV1,
  3221           ERROR-MESSAGE-INTERFACE-BLOCK,
  3222           EMI-COMM-LENGTH,
  3223           DFHEIV99,
  3224           DFHEIV99,
  3225           DFHEIV99
  3226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3227
  3228     MOVE ZERO              TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6503.cbl
  3229 9900-EXIT.
  3230      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6503.cbl
  3232*****************************************************************
  3233 9990-ERROR.
  3234*****************************************************************
  3235     MOVE DFHEIBLK               TO EMI-LINE1.
  3236
  3237* EXEC CICS LINK
  3238*        PROGRAM   ('EL004')
  3239*        COMMAREA  (EMI-LINE1)
  3240*        LENGTH    (72)
  3241*    END-EXEC.
  3242     MOVE 'EL004' TO DFHEIV1
  3243     MOVE 72
  3244       TO DFHEIV11
  3245*    MOVE '."C                   ''   #00002424' TO DFHEIV0
  3246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3247     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3248     MOVE X'2020233030303032343234' TO DFHEIV0(25:11)
  3249     CALL 'kxdfhei1' USING DFHEIV0,
  3250           DFHEIV1,
  3251           EMI-LINE1,
  3252           DFHEIV11,
  3253           DFHEIV99,
  3254           DFHEIV99,
  3255           DFHEIV99
  3256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3257
  3258     PERFORM 8200-SEND-DATAONLY.
  3259     GO TO 9100-RETURN-TRAN.
  3260 9990-EXIT.
  3261      EXIT.
  3262*****************************************************************
  3263 9995-SECURITY-VIOLATION.
  3264*****************************************************************
  3265*           COPY ELCSCTP.
  3266******************************************************************
  3267*                                                                *
  3268*                            ELCSCTP                             *
  3269*                            VMOD=2.001                          *
  3270*                                                                *
  3271*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3272******************************************************************
  3273
  3274
  3275     MOVE EIBDATE          TO SM-JUL-DATE.
  3276     MOVE EIBTRMID         TO SM-TERMID.
  3277     MOVE THIS-PGM         TO SM-PGM.
  3278     MOVE EIBTIME          TO TIME-IN.
  3279     MOVE TIME-OUT         TO SM-TIME.
  3280     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3281
  3282
  3283* EXEC CICS LINK
  3284*         PROGRAM  ('EL003')
  3285*         COMMAREA (SECURITY-MESSAGE)
  3286*         LENGTH   (80)
  3287*    END-EXEC.
  3288     MOVE 'EL003' TO DFHEIV1
  3289     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6503.cbl
  3290       TO DFHEIV11
  3291*    MOVE '."C                   ''   #00002453' TO DFHEIV0
  3292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3293     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3294     MOVE X'2020233030303032343533' TO DFHEIV0(25:11)
  3295     CALL 'kxdfhei1' USING DFHEIV0,
  3296           DFHEIV1,
  3297           SECURITY-MESSAGE,
  3298           DFHEIV11,
  3299           DFHEIV99,
  3300           DFHEIV99,
  3301           DFHEIV99
  3302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3303
  3304
  3305******************************************************************
  3306
  3307 9995-EXIT.
  3308      EXIT.
  3309 9999-LAST-PARAGRAPH.
  3310
  3311* GOBACK.
  3312     MOVE '9%                    "   ' TO DFHEIV0
  3313     MOVE 'EL6503' TO DFHEIV1
  3314     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3315     GOBACK.
  3316
  3317 9999-DFHBACK SECTION.
  3318     MOVE '9%                    "   ' TO DFHEIV0
  3319     MOVE 'EL6503' TO DFHEIV1
  3320     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3321     GOBACK.
  3322 9999-DFHEXIT.
  3323     IF DFHEIGDJ EQUAL 0001
  3324         NEXT SENTENCE
  3325     ELSE IF DFHEIGDJ EQUAL 2
  3326         GO TO 9600-PGMIDERR,
  3327               9990-ERROR
  3328         DEPENDING ON DFHEIGDI
  3329     ELSE IF DFHEIGDJ EQUAL 3
  3330         GO TO 8300-SEND-TEXT
  3331         DEPENDING ON DFHEIGDI.
  3332     MOVE '9%                    "   ' TO DFHEIV0
  3333     MOVE 'EL6503' TO DFHEIV1
  3334     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3335     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5212     Code:       10658
