* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43******************************************************************
    44
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   3
* EL156.cbl
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
    49
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER  PIC X(32)  VALUE '********************************'.
    54 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    55 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    56 77  WS-SSN  PIC X(9) VALUE ZEROS.
    57 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    58
    59*    COPY ELCSCTM.
    60******************************************************************
    61*                                                                *
    62*                                                                *
    63*                            ELCSCTM                             *
    64*                            VMOD=2.001                          *
    65*                                                                *
    66*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    67*                                                                *
    68******************************************************************
    69 01  SECURITY-MESSAGE.
    70     12  FILLER                          PIC X(30)
    71            VALUE '** LOGIC SECURITY VIOLATION -'.
    72     12  SM-READ                         PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' PGM='.
    75     12  SM-PGM                          PIC X(6).
    76     12  FILLER                          PIC X(5)
    77            VALUE ' OPR='.
    78     12  SM-PROCESSOR-ID                 PIC X(4).
    79     12  FILLER                          PIC X(6)
    80            VALUE ' TERM='.
    81     12  SM-TERMID                       PIC X(4).
    82     12  FILLER                          PIC XX   VALUE SPACE.
    83     12  SM-JUL-DATE                     PIC 9(5).
    84     12  FILLER                          PIC X    VALUE SPACE.
    85     12  SM-TIME                         PIC 99.99.
    86
    87
    88*    COPY ELCSCRTY.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCRTY                            *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    96*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    97*        SAVED IN PI-SECURITY-ADDRESS.                           *
    98*                                                                *
    99******************************************************************
   100 01  SECURITY-CONTROL.
   101     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   102     12  FILLER                       PIC XX    VALUE 'SC'.
   103     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   4
* EL156.cbl
   104         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   105             20  SC-CREDIT-DISPLAY    PIC X.
   106             20  SC-CREDIT-UPDATE     PIC X.
   107     12  SC-CLAIMS-CODES.
   108         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   109             20  SC-CLAIMS-DISPLAY    PIC X.
   110             20  SC-CLAIMS-UPDATE     PIC X.
   111
   112 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   113 01  WS-DATE-AREA.
   114     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   115     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   116     12  SAVE-DATE-CCYYMMDD.
   117         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   118         16  SAVE-DATE-YMD.
   119             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   120             20  FILLER              PIC X(04)   VALUE SPACES.
   121
   122 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   123 01  STANDARD-AREAS.
   124     12  WS-RESPONSE         PIC S9(8)   COMP.
   125         88  WS-RESP-NORMAL              VALUE +00.
   126         88  WS-RESP-ERROR               VALUE +01.
   127         88  WS-RESP-NOTFND              VALUE +13.
   128         88  WS-RESP-DUPREC              VALUE +14.
   129         88  WS-RESP-ENDFILE             VALUE +20.
   130     12  PMT-HEAD-A.
   131         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   132         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   133         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   134-        '     RESERVES  TYPE    AMOUNT'.
   135     12  PMT-HEAD-B.
   136         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   137         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   138         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   139     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   140     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   141     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   142     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   143     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   144     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   145     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   146     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   147     12  PGM-NAME            PIC X(8).
   148     12  TIME-IN             PIC S9(7).
   149     12  TIME-OUT-R  REDEFINES TIME-IN.
   150         16  FILLER          PIC X.
   151         16  TIME-OUT        PIC 99V99.
   152         16  FILLER          PIC XX.
   153     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   154     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   155     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   156     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   157     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   158     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   159     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   160     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   161     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   5
* EL156.cbl
   162     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   163     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   164     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   165     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   166     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   167     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   168     12  WS-BLANK            PIC X       VALUE ' '.
   169
   170 01  MISC-WORK-AREAS.
   171     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   172     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   173     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   174     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   175     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   176     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   177     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   178     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   179     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   180     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   181     12  W-CALLED-NAME           PIC X(08).
   182     12  W-EOB-CODES.
   183         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   184             20  W-EOB-CODE      PIC XXX.
   185             20  W-EOB-FILLER    PIC X.
   186     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   187     12  W-NAME-LAST             PIC X(15).
   188     12  W-NAME-FIRST            PIC X(15).
   189     12  W-NAME-MIDDLE.
   190         16  FILLER              PIC X.
   191         16  W-NAME-MIDDLE-2     PIC X.
   192         16  FILLER              PIC X(13).
   193     12  W-DMD-CHECK-NO.
   194         16  W-DMD-CHECK-NO-1    PIC X(4).
   195         16  W-DMD-CHECK-NO-2    PIC X.
   196         16  W-DMD-CHECK-NO-3    PIC XX.
   197
   198     12  WS-COMPUTE-FROM-DT  PIC XX.
   199     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   200     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   201     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   202     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   203     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   204     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   205         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   206         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   207     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   208         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   209     12  WS-UPDATE-SW        PIC X VALUE ' '.
   210     12  WS-GROUPING.
   211         16  WS-GROUP-1      PIC X VALUE SPACES.
   212         16  FILLER          PIC X(05) VALUE SPACES.
   213     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   214     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   215     12  WS-WORK-STATE-ACCT.
   216         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   217         16  FILLER          PIC X       VALUE '/'.
   218         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   219     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   6
* EL156.cbl
   220     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   221     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   222     12  QID.
   223         16  QID-TERM        PIC X(4)    VALUE SPACES.
   224         16  FILLER          PIC X(4)    VALUE '156A'.
   225     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   226     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   227     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   228     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   229     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   230     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   231     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   232     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   233     12  WS-STATUS           PIC X       VALUE SPACES.
   234     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   235     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   236     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   237     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   238     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   239     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   240     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   241     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   242     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   243     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   244     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   245     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   246     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   247     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   248     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   249     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   250     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   251     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   252     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   253     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   254     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   255     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   256     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   257     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   258     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   259     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   260     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   261     12  WORK-DATE-FROM.
   262         16  WDF-MONTH       PIC 99        VALUE ZERO.
   263         16  WDF-DAY         PIC 99        VALUE ZERO.
   264         16  WDF-YEAR        PIC 99        VALUE ZERO.
   265     12  WORK-DATE-THRU.
   266         16  WDT-MONTH       PIC 99        VALUE ZERO.
   267         16  WDT-DAY         PIC 99        VALUE ZERO.
   268         16  WDT-YEAR        PIC 99        VALUE ZERO.
   269     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   270     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   271     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   272     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   273     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   274     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   275     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   276     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   277     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   7
* EL156.cbl
   278     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   279     12  WS-PY-WK REDEFINES WS-PY-WORK.
   280         16  WS-PY-NUM       PIC S9(7)V99.
   281         16  WS-PY-SIGN      PIC X.
   282     12  WS-DY-WORK          PIC S9(5).
   283     12  WS-DY-WK REDEFINES WS-DY-WORK.
   284         16  WS-DY-NUM       PIC S9(4).
   285         16  WS-DY-SIGN      PIC X.
   286     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   287         88  COMP-REC-FOUND              VALUE 'Y'.
   288     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   289         88  BENEFIT-FOUND       VALUE 'Y'.
   290         88  NO-BENEFIT-FOUND    VALUE 'N'.
   291     12  WS-TERMS.
   292         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   293         16  FILLER          PIC X       VALUE '/'.
   294         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   295         16  WST-REM-DAYS-GRP.
   296             20  WST-SLASH   PIC X       VALUE '/'.
   297             20  WST-REM-DAYS
   298                             PIC --9.
   299     12  WS-ACCESS.
   300         16  FILLER          PIC XX      VALUE SPACES.
   301         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   302     12  WS-STATE-ACCESS.
   303         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   304         16  FILLER          PIC XX      VALUE SPACES.
   305     12  WS-CARR-ACCESS.
   306         16  FILLER          PIC X(3)    VALUE SPACES.
   307         16  WS-CARR         PIC X       VALUE SPACES.
   308     12  DATE-WORK.
   309         16  FILLER          PIC XX      VALUE SPACES.
   310         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   311     12  WS-SAVE-INPUT.
   312         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   313         16  WS-PAYEE        PIC XX      VALUE SPACE.
   314         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   315         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   316         16  WS-OFFLINE      PIC X       VALUE SPACE.
   317         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   318         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   319         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   320         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   321         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   322         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   323         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   324         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   325         16  WS-ETYPE        PIC X       VALUE SPACE.
   326         16  WS-CASH         PIC X       VALUE SPACE.
   327         16  WS-GROUPED      PIC X       VALUE SPACE.
   328         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   329         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   330         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   331         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   332         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   333         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   334         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   335     12  LAST-ERROR-LINE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   8
* EL156.cbl
   336         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   337         16  FILLER              PIC X(30)
   338             VALUE ' FATAL ERRORS ENCOUNTERED'.
   339         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   340         16  FILLER              PIC X(28)
   341             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   342     12  WS-CHECK-AREA.
   343         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   344         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   345     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   346     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   347         16  FILLER              PIC XX.
   348         16  WS-A-CHECK-NUM-5    PIC 9(5).
   349     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   350         16  FILLER              PIC X.
   351         16  WS-A-CHECK-NUM-6    PIC 9(6).
   352     12  OPTION-1-SAVE-AREA.
   353         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   354         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   355     12  WS-WORK-ZIP.
   356         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   357         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   358     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   359                                 PIC 9(9).
   360     12  WS-FLI-PMTNOTE.
   361         16  WS-PMTOPTION        PIC XX.
   362         16  WS-DOCNAME          PIC X(28).
   363         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   364             20  WS-AMOUNT       PIC X(8).
   365             20  FILLER          PIC X(20).
   366         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   367             20  WS-NUM-AMT      PIC 9(6)V99.
   368             20  FILLER          PIC X(20).
   369
   370     12  WS-HAN-PMTNOTE.
   371         16  WS-HAN-PMT-CODE     PIC X.
   372         16  WS-HAN-PMT-NOTE     PIC X(39).
   373
   374     12  WS-NCL-PMT-OPTION       PIC XX.
   375         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   376
   377     12  WS-CLAIM-SEQUENCE.
   378         16  FILLER              PIC X VALUE '('.
   379         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   380         16  FILLER              PIC X(04) VALUE ' OF '.
   381         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   382         16  FILLER              PIC X VALUE ')'.
   383
   384     12  WS-REFUND-AMT           PIC Z(7).99.
   385     12  WS-CALC-INT             PIC S9(7)V99.
   386     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   387
   388     12  SUB                     PIC 99 VALUE ZEROS.
   389
   390     12  WS-BOANOTE1.
   391         16  WS-BOANOTE1-DESC    PIC X(11).
   392         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   393         16  FILLER              PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page   9
* EL156.cbl
   394     12  WS-BOANOTE2.
   395         16  WS-BOANOTE2-DESC    PIC X(11).
   396         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   397         16  FILLER              PIC X(17).
   398
   399     12  WS-NCLNOTE1.
   400         16  WS-NCLNOTE1-DESC    PIC X(11).
   401         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   402         16  FILLER              PIC X(17).
   403     12  WS-NCLNOTE2.
   404         16  WS-NCLNOTE2-DESC    PIC X(11).
   405         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   406         16  FILLER              PIC X(17).
   407
   408     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   409     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   410     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   411     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   412     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   413     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   414     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   415     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   416     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   417     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   418
   419     12  WS-AIG-WORK-AREAS.
   420         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   421             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   422         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   423             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   424         16  WS-FROM-DATE-MDY.
   425             20  WS-FROM-MO      PIC 99.
   426             20  WS-FROM-DA      PIC 99.
   427             20  WS-FROM-YR      PIC 99.
   428         16  WS-TEMP-DATE-MDY.
   429             20  WS-TEMP-MO      PIC 99.
   430             20  WS-TEMP-DA      PIC 99.
   431             20  WS-TEMP-YR      PIC 99.
   432         16  WS-BIN-FROM-DT      PIC XX.
   433         16  WS-TEMP-INC-MDY.
   434             20  WS-TEMP-INC-MO  PIC 99.
   435             20  WS-TEMP-INC-DA  PIC 99.
   436             20  WS-TEMP-INC-YR  PIC 99.
   437         16  WS-PMT-DUE-MDY.
   438             20  WS-PMT-DUE-MO   PIC 99.
   439             20  WS-PMT-DUE-DA   PIC 99.
   440             20  WS-PMT-DUE-YR   PIC 99.
   441         16  WS-PMT-DUE-DT       PIC XX.
   442         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   443         16  WS-RETRO-ELIM-DT    PIC XX.
   444         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   445             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   446         16  WS-SAVE-DUE-DA      PIC 99.
   447         16  WS-CDAYS            PIC S9(05).
   448         16  WS-DAYS-OFF         PIC S9(05).
   449         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   450             88  ELIM-SATISFIED            VALUE 'Y'.
   451         16  WS-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  10
* EL156.cbl
   452             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   453             20  WS-A-CHECKNO-3-7.
   454                 24  FILLER              PIC X(3)    VALUE SPACES.
   455                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   456                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   457         16  WS-AIG-GROUPING.
   458             20  WS-A-BENE               PIC XXX.
   459             20  FILLER                  PIC XXX.
   460         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   461             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   462             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   463         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   464                 VALUE 'UNEMPLOYMENT PAYMENT'.
   465         16  WS-CHK-THRU-DT              PIC XX.
   466         16  WS-HOLD-BIN-DATE-1          PIC XX.
   467
   468 01  MISC-CSO-AREA.
   469     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   470         88  APPROVAL-NEEDED                        VALUE 'Y'.
   471     12  WS-APPROV-NOTE                  PIC X(43)
   472         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   473     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   474     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   475     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   476     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   477     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   478     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   479     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   480         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   481     12  WS-PAYEE-CITY-STATE     PIC X(30).
   482     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   483         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   484     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   485     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   486     12  WS-WORK-NAME            PIC X(30).
   487     12  FILLER  REDEFINES WS-WORK-NAME.
   488         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   489     12  WS-INSURED-NAME         PIC X(30).
   490     12  FILLER  REDEFINES WS-INSURED-NAME.
   491         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   492     12  WS-PAYEE-NAME           PIC X(30).
   493     12  FILLER  REDEFINES WS-PAYEE-NAME.
   494         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   495
   496 01  ERROR-MESSAGES.
   497     12  ER-0000                 PIC X(4)  VALUE '0000'.
   498     12  ER-0004                 PIC X(4)  VALUE '0004'.
   499     12  ER-0008                 PIC X(4)  VALUE '0008'.
   500     12  ER-0019                 PIC X(4)  VALUE '0019'.
   501     12  ER-0029                 PIC X(4)  VALUE '0029'.
   502     12  ER-0042                 PIC X(4)  VALUE '0042'.
   503     12  ER-0070                 PIC X(4)  VALUE '0070'.
   504     12  ER-0130                 PIC X(4)  VALUE '0130'.
   505     12  ER-0149                 PIC X(4)  VALUE '0149'.
   506     12  ER-0154                 PIC X(4)  VALUE '0154'.
   507     12  ER-0168                 PIC X(4)  VALUE '0168'.
   508     12  ER-0169                 PIC X(4)  VALUE '0169'.
   509     12  ER-0172                 PIC X(4)  VALUE '0174'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  11
* EL156.cbl
   510     12  ER-0198                 PIC X(4)  VALUE '0198'.
   511     12  ER-0204                 PIC X(4)  VALUE '0204'.
   512     12  ER-0206                 PIC X(4)  VALUE '0206'.
   513     12  ER-0252                 PIC X(4)  VALUE '0252'.
   514     12  ER-0254                 PIC X(4)  VALUE '0254'.
   515     12  ER-0282                 PIC X(4)  VALUE '0282'.
   516     12  ER-0283                 PIC X(4)  VALUE '0283'.
   517     12  ER-0294                 PIC X(4)  VALUE '0294'.
   518     12  ER-0338                 PIC X(4)  VALUE '0338'.
   519     12  ER-0419                 PIC X(4)  VALUE '0419'.
   520     12  ER-0420                 PIC X(4)  VALUE '0420'.
   521     12  ER-0421                 PIC X(4)  VALUE '0421'.
   522     12  ER-0422                 PIC X(4)  VALUE '0422'.
   523     12  ER-0433                 PIC X(4)  VALUE '0433'.
   524     12  ER-0436                 PIC X(4)  VALUE '0436'.
   525     12  ER-0437                 PIC X(4)  VALUE '0437'.
   526     12  ER-0438                 PIC X(4)  VALUE '0438'.
   527     12  ER-0439                 PIC X(4)  VALUE '0439'.
   528     12  ER-0440                 PIC X(4)  VALUE '0440'.
   529     12  ER-0441                 PIC X(4)  VALUE '0441'.
   530     12  ER-0442                 PIC X(4)  VALUE '0442'.
   531     12  ER-0443                 PIC X(4)  VALUE '0443'.
   532     12  ER-0444                 PIC X(4)  VALUE '0444'.
   533     12  ER-0445                 PIC X(4)  VALUE '0445'.
   534     12  ER-0446                 PIC X(4)  VALUE '0446'.
   535     12  ER-0447                 PIC X(4)  VALUE '0447'.
   536     12  ER-0448                 PIC X(4)  VALUE '0448'.
   537     12  ER-0449                 PIC X(4)  VALUE '0449'.
   538     12  ER-0452                 PIC X(4)  VALUE '0452'.
   539     12  ER-0458                 PIC X(4)  VALUE '0458'.
   540     12  ER-0459                 PIC X(4)  VALUE '0459'.
   541     12  ER-0460                 PIC X(4)  VALUE '0460'.
   542     12  ER-0461                 PIC X(4)  VALUE '0461'.
   543     12  ER-0462                 PIC X(4)  VALUE '0462'.
   544     12  ER-0463                 PIC X(4)  VALUE '0463'.
   545     12  ER-0464                 PIC X(4)  VALUE '0464'.
   546     12  ER-0465                 PIC X(4)  VALUE '0465'.
   547     12  ER-0466                 PIC X(4)  VALUE '0466'.
   548     12  ER-0467                 PIC X(4)  VALUE '0467'.
   549     12  ER-0468                 PIC X(4)  VALUE '0468'.
   550     12  ER-0469                 PIC X(4)  VALUE '0469'.
   551     12  ER-0473                 PIC X(4)  VALUE '0473'.
   552     12  ER-0474                 PIC X(4)  VALUE '0474'.
   553     12  ER-0475                 PIC X(4)  VALUE '0475'.
   554     12  ER-0476                 PIC X(4)  VALUE '0476'.
   555     12  ER-0477                 PIC X(4)  VALUE '0477'.
   556     12  ER-0478                 PIC X(4)  VALUE '0478'.
   557     12  ER-0479                 PIC X(4)  VALUE '0479'.
   558     12  ER-0481                 PIC X(4)  VALUE '0481'.
   559     12  ER-0491                 PIC X(4)  VALUE '0491'.
   560     12  ER-0492                 PIC X(4)  VALUE '0492'.
   561     12  ER-0493                 PIC X(4)  VALUE '0493'.
   562     12  ER-0494                 PIC X(4)  VALUE '0494'.
   563     12  ER-0495                 PIC X(4)  VALUE '0495'.
   564     12  ER-0499                 PIC X(4)  VALUE '0499'.
   565     12  ER-0500                 PIC X(4)  VALUE '0500'.
   566     12  ER-0501                 PIC X(4)  VALUE '0501'.
   567     12  ER-0502                 PIC X(4)  VALUE '0502'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  12
* EL156.cbl
   568     12  ER-0508                 PIC X(4)  VALUE '0508'.
   569     12  ER-0513                 PIC X(4)  VALUE '0513'.
   570     12  ER-0518                 PIC X(4)  VALUE '0518'.
   571     12  ER-0524                 PIC X(4)  VALUE '0524'.
   572     12  ER-0525                 PIC X(4)  VALUE '0525'.
   573     12  ER-0526                 PIC X(4)  VALUE '0526'.
   574     12  ER-0530                 PIC X(4)  VALUE '0530'.
   575     12  ER-0540                 PIC X(4)  VALUE '0540'.
   576     12  ER-0541                 PIC X(4)  VALUE '0541'.
   577     12  ER-0542                 PIC X(4)  VALUE '0542'.
   578     12  ER-0543                 PIC X(4)  VALUE '0543'.
   579     12  ER-0545                 PIC X(4)  VALUE '0545'.
   580     12  ER-0552                 PIC X(4)  VALUE '0552'.
   581     12  ER-0555                 PIC X(4)  VALUE '0555'.
   582     12  ER-0556                 PIC X(4)  VALUE '0556'.
   583     12  ER-0557                 PIC X(4)  VALUE '0557'.
   584     12  ER-0572                 PIC X(4)  VALUE '0572'.
   585     12  ER-0573                 PIC X(4)  VALUE '0573'.
   586     12  ER-0594                 PIC X(4)  VALUE '0594'.
   587     12  ER-0616                 PIC X(4)  VALUE '0616'.
   588     12  ER-0617                 PIC X(4)  VALUE '0617'.
   589     12  ER-0618                 PIC X(4)  VALUE '0618'.
   590     12  ER-0657                 PIC X(4)  VALUE '0657'.
   591     12  ER-0658                 PIC X(4)  VALUE '0658'.
   592     12  ER-0699                 PIC X(4)  VALUE '0699'.
   593     12  ER-0730                 PIC X(4)  VALUE '0730'.
   594     12  ER-0737                 PIC X(4)  VALUE '0737'.
   595     12  ER-0760                 PIC X(4)  VALUE '0760'.
   596     12  ER-0768                 PIC X(4)  VALUE '0768'.
   597     12  ER-0769                 PIC X(4)  VALUE '0769'.
   598     12  ER-0770                 PIC X(4)  VALUE '0770'.
   599     12  ER-0802                 PIC X(4)  VALUE '0802'.
   600     12  ER-0803                 PIC X(4)  VALUE '0803'.
   601     12  ER-0819                 PIC X(4)  VALUE '0819'.
   602     12  ER-0834                 PIC X(4)  VALUE '0834'.
   603     12  ER-0836                 PIC X(4)  VALUE '0836'.
   604     12  ER-0844                 PIC X(4)  VALUE '0844'.
   605     12  ER-0845                 PIC X(4)  VALUE '0845'.
   606     12  ER-0846                 PIC X(4)  VALUE '0846'.
   607     12  ER-0849                 PIC X(4)  VALUE '0849'.
   608     12  ER-0851                 PIC X(4)  VALUE '0851'.
   609     12  ER-0872                 PIC X(4)  VALUE '0872'.
   610     12  ER-0873                 PIC X(4)  VALUE '0873'.
   611     12  ER-0874                 PIC X(4)  VALUE '0874'.
   612     12  ER-0879                 PIC X(4)  VALUE '0879'.
   613     12  ER-0919                 PIC X(4)  VALUE '0919'.
   614     12  ER-0921                 PIC X(4)  VALUE '0921'.
   615     12  ER-0923                 PIC X(4)  VALUE '0923'.
   616     12  ER-0925                 PIC X(4)  VALUE '0925'.
   617     12  ER-0944                 PIC X(4)  VALUE '0944'.
   618     12  ER-0945                 PIC X(4)  VALUE '0945'.
   619     12  ER-0946                 PIC X(4)  VALUE '0946'.
   620     12  ER-0947                 PIC X(4)  VALUE '0947'.
   621     12  ER-0948                 PIC X(4)  VALUE '0948'.
   622     12  ER-0949                 PIC X(4)  VALUE '0949'.
   623     12  ER-0950                 PIC X(4)  VALUE '0950'.
   624     12  ER-0951                 PIC X(4)  VALUE '0951'.
   625     12  ER-0954                 PIC X(4)  VALUE '0954'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  13
* EL156.cbl
   626     12  ER-0956                 PIC X(4)  VALUE '0956'.
   627     12  ER-0967                 PIC X(4)  VALUE '0967'.
   628     12  ER-0968                 PIC X(4)  VALUE '0968'.
   629     12  ER-0974                 PIC X(4)  VALUE '0974'.
   630     12  ER-0975                 PIC X(4)  VALUE '0975'.
   631     12  ER-1561                 PIC X(4)  VALUE '1561'.
   632     12  ER-1566                 PIC X(4)  VALUE '1566'.
   633     12  ER-1567                 PIC X(4)  VALUE '1567'.
   634     12  ER-1775                 PIC X(4)  VALUE '1775'.
   635     12  ER-1880                 PIC X(4)  VALUE '1880'.
   636     12  ER-2044                 PIC X(4)  VALUE '2044'.
   637     12  ER-3140                 PIC X(4)  VALUE '3140'.
   638     12  ER-3141                 PIC X(4)  VALUE '3141'.
   639     12  ER-3255                 PIC X(4)  VALUE '3255'.
   640     12  ER-3516                 PIC X(4)  VALUE '3516'.
   641     12  ER-3527                 PIC X(4)  VALUE '3527'.
   642     12  ER-3528                 PIC X(4)  VALUE '3528'.
   643     12  ER-3529                 PIC X(4)  VALUE '3529'.
   644     12  ER-3530                 PIC X(4)  VALUE '3530'.
   645     12  ER-3531                 PIC X(4)  VALUE '3531'.
   646     12  ER-3532                 PIC X(4)  VALUE '3532'.
   647     12  ER-3533                 PIC X(4)  VALUE '3533'.
   648     12  ER-3534                 PIC X(4)  VALUE '3534'.
   649     12  ER-3535                 PIC X(4)  VALUE '3535'.
   650     12  ER-3536                 PIC X(4)  VALUE '3536'.
   651     12  ER-3537                 PIC X(4)  VALUE '3537'.
   652     12  ER-3538                 PIC X(4)  VALUE '3538'.
   653     12  ER-3539                 PIC X(4)  VALUE '3539'.
   654     12  ER-3540                 PIC X(4)  VALUE '3540'.
   655     12  ER-3541                 PIC X(4)  VALUE '3541'.
   656     12  ER-3542                 PIC X(4)  VALUE '3542'.
   657     12  ER-3543                 PIC X(4)  VALUE '3543'.
   658     12  ER-3546                 PIC X(4)  VALUE '3546'.
   659     12  ER-3549                 PIC X(4)  VALUE '3549'.
   660     12  ER-3818                 PIC X(4)  VALUE '3818'.
   661     12  ER-7540                 PIC X(4)  VALUE '7540'.
   662     12  ER-7576                 PIC X(4)  VALUE '7576'.
   663     12  ER-7579                 PIC X(4)  VALUE '7579'.
   664     12  ER-7830                 PIC X(4)  VALUE '7830'.
   665     12  ER-7831                 PIC X(4)  VALUE '7831'.
   666     12  ER-7832                 PIC X(4)  VALUE '7832'.
   667     12  ER-7833                 PIC X(4)  VALUE '7833'.
   668     12  ER-7834                 PIC X(4)  VALUE '7834'.
   669     12  ER-7835                 PIC X(4)  VALUE '7835'.
   670     12  ER-7836                 PIC X(4)  VALUE '7836'.
   671     12  ER-7837                 PIC X(4)  VALUE '7837'.
   672     12  ER-7838                 PIC X(4)  VALUE '7838'.
   673     12  ER-7841                 PIC X(4)  VALUE '7841'.
   674     12  ER-7844                 PIC X(4)  VALUE '7844'.
   675     12  ER-7845                 PIC X(4)  VALUE '7845'.
   676     12  ER-8000                 PIC X(4)  VALUE '8000'.
   677     12  ER-8051                 PIC X(4)  VALUE '8051'.
   678     12  ER-8052                 PIC X(4)  VALUE '8052'.
   679     12  ER-8053                 PIC X(4)  VALUE '8053'.
   680     12  ER-8054                 PIC X(4)  VALUE '8054'.
   681     12  ER-8055                 PIC X(4)  VALUE '8055'.
   682     12  ER-8056                 PIC X(4)  VALUE '8056'.
   683     12  ER-8057                 PIC X(4)  VALUE '8057'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  14
* EL156.cbl
   684     12  ER-8058                 PIC X(4)  VALUE '8058'.
   685     12  ER-8059                 PIC X(4)  VALUE '8059'.
   686     12  ER-8060                 PIC X(4)  VALUE '8060'.
   687     12  ER-8061                 PIC X(4)  VALUE '8061'.
   688     12  ER-8062                 PIC X(4)  VALUE '8062'.
   689     12  ER-8063                 PIC X(4)  VALUE '8063'.
   690     12  ER-8064                 PIC X(4)  VALUE '8064'.
   691     12  ER-8065                 PIC X(4)  VALUE '8065'.
   692     12  ER-8066                 PIC X(4)  VALUE '8066'.
   693     12  ER-8146                 PIC X(4)  VALUE '8146'.
   694     12  ER-8147                 PIC X(4)  VALUE '8147'.
   695     12  ER-8152                 PIC X(4)  VALUE '8152'.
   696     12  ER-8153                 PIC X(4)  VALUE '8153'.
   697     12  ER-8154                 PIC X(4)  VALUE '8154'.
   698     12  ER-8155                 PIC X(4)  VALUE '8155'.
   699     12  ER-8310                 PIC X(4)  VALUE '8310'.
   700     12  ER-8311                 PIC X(4)  VALUE '8311'.
   701     12  ER-8312                 PIC X(4)  VALUE '8312'.
   702     12  ER-8313                 PIC X(4)  VALUE '8313'.
   703     12  ER-8314                 PIC X(4)  VALUE '8314'.
   704     12  ER-8315                 PIC X(4)  VALUE '8315'.
   705     12  ER-8316                 PIC X(4)  VALUE '8316'.
   706     12  ER-8317                 PIC X(4)  VALUE '8317'.
   707
   708 01  CSO-WORK-FIELDS.
   709     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   710       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   711
   712     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   713     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   714         88  CERT-NOTE-ADDED           VALUE 'Y'.
   715     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   716         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   717     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   718
   719 01  SC-NP6-CERT-NOTE.
   720     12  FILLER                  PIC X(12)
   721               VALUE 'REM BENEFIT '.
   722     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   723     12  FILLER                  PIC X(8)
   724               VALUE ' + 6 MO '.
   725     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   726     12  FILLER                  PIC X(12)
   727               VALUE ' = AMT PAID '.
   728     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   729
   730 01  SC-NP6-ORIG-NOTE.
   731     12  FILLER                  PIC X(63)  VALUE
   732         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   733
   734 01  ACCESS-KEYS.
   735     12  ELARCH-KEY.
   736         16  ARCH-CO             PIC X.
   737         16  ARCH-NUMBER         PIC S9(08) COMP.
   738         16  ARCH-REC-TYPE       PIC X.
   739         16  ARCH-SEQ            PIC S9(04) COMP.
   740     12  ELMSTR-KEY.
   741         16  MSTR-COMP-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  15
* EL156.cbl
   742         16  MSTR-CARRIER        PIC X.
   743         16  MSTR-CLAIM-NO       PIC X(7).
   744         16  MSTR-CERT-NO        PIC X(11).
   745     12  ELCNTL-KEY.
   746         16  CNTL-COMP-ID        PIC X(3).
   747         16  CNTL-REC-TYPE       PIC X.
   748         16  CNTL-ACCESS         PIC X(4).
   749         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   750     12  ELCERT-KEY.
   751         16  CERT-COMP-CD        PIC X.
   752         16  CERT-CARRIER        PIC X.
   753         16  CERT-GROUPING       PIC X(6).
   754         16  CERT-STATE          PIC XX.
   755         16  CERT-ACCOUNT        PIC X(10).
   756         16  CERT-EFF-DT         PIC XX.
   757         16  CERT-CERT-NO        PIC X(11).
   758     12  ELTRLR-KEY.
   759         16  TRLR-COMP-CD        PIC X.
   760         16  TRLR-CARRIER        PIC X.
   761         16  TRLR-CLAIM-NO       PIC X(7).
   762         16  TRLR-CERT-NO        PIC X(11).
   763         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   764     12  ELACTQ-KEY.
   765         16  ACTQ-COMP-CD        PIC X.
   766         16  ACTQ-CARRIER        PIC X.
   767         16  ACTQ-CLAIM-NO       PIC X(7).
   768         16  ACTQ-CERT-NO        PIC X(11).
   769     12  W-NOTE-KEY.
   770         16  W-NOTE-COMP-CD      PIC X.
   771         16  W-NOTE-CERT-KEY.
   772             20  W-NOTE-CARRIER  PIC X.
   773             20  W-NOTE-GROUPING PIC X(6).
   774             20  W-NOTE-STATE    PIC XX.
   775             20  W-NOTE-ACCOUNT  PIC X(10).
   776             20  W-NOTE-EFF-DT   PIC XX.
   777             20  W-NOTE-CERT-NO  PIC X(11).
   778     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   779     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   780     12  ERACCT-KEY.
   781         16  ERACCT-PARTIAL-KEY.
   782             20  ACCT-COMP-CD    PIC X.
   783             20  ACCT-CARRIER    PIC X.
   784             20  ACCT-GROUPING   PIC X(6).
   785             20  ACCT-STATE      PIC XX.
   786             20  ACCT-ACCOUNT    PIC X(10).
   787         16  ACCT-EXP-DT         PIC XX.
   788         16  FILLER              PIC X(4) VALUE SPACES.
   789     12  ELCHKQ-KEY.
   790         16  CHKQ-COMP-CD        PIC X.
   791         16  CHKQ-CONTROL        PIC S9(8) COMP.
   792         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   793     12  ELBENE-KEY.
   794         16  BENE-COMP-CD         PIC X.
   795         16  BENE-RECORD-TYPE     PIC X.
   796         16  BENE-NUMBER          PIC X(10).
   797     12  ERCOMP-KEY.
   798         16  COMP-COMP-CD        PIC X.
   799         16  COMP-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  16
* EL156.cbl
   800         16  COMP-GROUP          PIC X(06).
   801         16  COMP-FIN-RESP       PIC X(10).
   802         16  COMP-ACCOUNT        PIC X(10).
   803         16  COMP-TYPE           PIC X.
   804
   805     12  DLO035-KEY.
   806         16  DL35-PROCESS-TYPE   PIC X.
   807         16  DL35-CREDIT-CARD    PIC X(20).
   808         16  DL35-BEN-TYPE       PIC XX.
   809         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   810         16  DL35-RETURN-CODE    PIC XX.
   811
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  17
* EL156.cbl
   813*    COPY ELCDATE.
   814******************************************************************
   815*                                                                *
   816*                                                                *
   817*                            ELCDATE.                            *
   818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   819*                            VMOD=2.003
   820*                                                                *
   821*                                                                *
   822*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   823*                 LENGTH = 200                                   *
   824******************************************************************
   825
   826 01  DATE-CONVERSION-DATA.
   827     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   828     12  DC-OPTION-CODE                PIC X.
   829         88  BIN-TO-GREG                VALUE ' '.
   830         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   831         88  EDIT-GREG-TO-BIN           VALUE '2'.
   832         88  YMD-GREG-TO-BIN            VALUE '3'.
   833         88  MDY-GREG-TO-BIN            VALUE '4'.
   834         88  JULIAN-TO-BIN              VALUE '5'.
   835         88  BIN-PLUS-ELAPSED           VALUE '6'.
   836         88  FIND-CENTURY               VALUE '7'.
   837         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   838         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   839         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   840         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   841         88  JULIAN-TO-BIN-3            VALUE 'C'.
   842         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   843         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   844         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   845         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   846         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   847         88  CHECK-LEAP-YEAR            VALUE 'H'.
   848         88  BIN-3-TO-GREG              VALUE 'I'.
   849         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   850         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   851         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   852         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   853         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   854         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   855         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   856         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   857         88  THREE-CHARACTER-BIN
   858                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   859         88  GREGORIAN-TO-BIN
   860                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   861         88  BIN-TO-GREGORIAN
   862                  VALUES ' ' '1' 'I' '8' 'G'.
   863         88  JULIAN-TO-BINARY
   864                  VALUES '5' 'C' 'E' 'F'.
   865     12  DC-ERROR-CODE                 PIC X.
   866         88  NO-CONVERSION-ERROR        VALUE ' '.
   867         88  DATE-CONVERSION-ERROR
   868                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   869         88  DATE-IS-ZERO               VALUE '1'.
   870         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  18
* EL156.cbl
   871         88  DATE-IS-INVALID            VALUE '3'.
   872         88  DATE1-GREATER-DATE2        VALUE '4'.
   873         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   874         88  DATE-INVALID-OPTION        VALUE '9'.
   875         88  INVALID-CENTURY            VALUE 'A'.
   876         88  ONLY-CENTURY               VALUE 'B'.
   877         88  ONLY-LEAP-YEAR             VALUE 'C'.
   878         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   879     12  DC-END-OF-MONTH               PIC X.
   880         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   881     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   882         88  USE-NORMAL-PROCESS         VALUE ' '.
   883         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   884         88  ADJUST-UP-100-YRS          VALUE '2'.
   885     12  FILLER                        PIC X.
   886     12  DC-CONVERSION-DATES.
   887         16  DC-BIN-DATE-1             PIC XX.
   888         16  DC-BIN-DATE-2             PIC XX.
   889         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   890         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   891                       DC-GREG-DATE-1-EDIT.
   892             20  DC-EDIT1-MONTH        PIC 99.
   893             20  SLASH1-1              PIC X.
   894             20  DC-EDIT1-DAY          PIC 99.
   895             20  SLASH1-2              PIC X.
   896             20  DC-EDIT1-YEAR         PIC 99.
   897         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   898         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   899                     DC-GREG-DATE-2-EDIT.
   900             20  DC-EDIT2-MONTH        PIC 99.
   901             20  SLASH2-1              PIC X.
   902             20  DC-EDIT2-DAY          PIC 99.
   903             20  SLASH2-2              PIC X.
   904             20  DC-EDIT2-YEAR         PIC 99.
   905         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   906         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   907                     DC-GREG-DATE-1-YMD.
   908             20  DC-YMD-YEAR           PIC 99.
   909             20  DC-YMD-MONTH          PIC 99.
   910             20  DC-YMD-DAY            PIC 99.
   911         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   912         16  DC-GREG-DATE-1-MDY-R REDEFINES
   913                      DC-GREG-DATE-1-MDY.
   914             20  DC-MDY-MONTH          PIC 99.
   915             20  DC-MDY-DAY            PIC 99.
   916             20  DC-MDY-YEAR           PIC 99.
   917         16  DC-GREG-DATE-1-ALPHA.
   918             20  DC-ALPHA-MONTH        PIC X(10).
   919             20  DC-ALPHA-DAY          PIC 99.
   920             20  FILLER                PIC XX.
   921             20  DC-ALPHA-CENTURY.
   922                 24 DC-ALPHA-CEN-N     PIC 99.
   923             20  DC-ALPHA-YEAR         PIC 99.
   924         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   925         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   926         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   927         16  DC-JULIAN-DATE            PIC 9(05).
   928         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  19
* EL156.cbl
   929                                       PIC 9(05).
   930         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   931             20  DC-JULIAN-YEAR        PIC 99.
   932             20  DC-JULIAN-DAYS        PIC 999.
   933         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   934         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   935         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   936     12  DATE-CONVERSION-VARIBLES.
   937         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   938         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   939             20  FILLER                PIC 9(3).
   940             20  HOLD-CEN-1-CCYY.
   941                 24  HOLD-CEN-1-CC     PIC 99.
   942                 24  HOLD-CEN-1-YY     PIC 99.
   943             20  HOLD-CEN-1-MO         PIC 99.
   944             20  HOLD-CEN-1-DA         PIC 99.
   945         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   946             20  HOLD-CEN-1-R-MO       PIC 99.
   947             20  HOLD-CEN-1-R-DA       PIC 99.
   948             20  HOLD-CEN-1-R-CCYY.
   949                 24  HOLD-CEN-1-R-CC   PIC 99.
   950                 24  HOLD-CEN-1-R-YY   PIC 99.
   951             20  FILLER                PIC 9(3).
   952         16  HOLD-CENTURY-1-X.
   953             20  FILLER                PIC X(3)  VALUE SPACES.
   954             20  HOLD-CEN-1-X-CCYY.
   955                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   956                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   957             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   958             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   959         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   960             20  HOLD-CEN-1-R-X-MO     PIC XX.
   961             20  HOLD-CEN-1-R-X-DA     PIC XX.
   962             20  HOLD-CEN-1-R-X-CCYY.
   963                 24  HOLD-CEN-1-R-X-CC PIC XX.
   964                 24  HOLD-CEN-1-R-X-YY PIC XX.
   965             20  FILLER                PIC XXX.
   966         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   967         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   968         16  DC-JULIAN-DATE-1          PIC 9(07).
   969         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   970             20  DC-JULIAN-1-CCYY.
   971                 24  DC-JULIAN-1-CC    PIC 99.
   972                 24  DC-JULIAN-1-YR    PIC 99.
   973             20  DC-JULIAN-DA-1        PIC 999.
   974         16  DC-JULIAN-DATE-2          PIC 9(07).
   975         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   976             20  DC-JULIAN-2-CCYY.
   977                 24  DC-JULIAN-2-CC    PIC 99.
   978                 24  DC-JULIAN-2-YR    PIC 99.
   979             20  DC-JULIAN-DA-2        PIC 999.
   980         16  DC-GREG-DATE-A-EDIT.
   981             20  DC-EDITA-MONTH        PIC 99.
   982             20  SLASHA-1              PIC X VALUE '/'.
   983             20  DC-EDITA-DAY          PIC 99.
   984             20  SLASHA-2              PIC X VALUE '/'.
   985             20  DC-EDITA-CCYY.
   986                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  20
* EL156.cbl
   987                 24  DC-EDITA-YEAR     PIC 99.
   988         16  DC-GREG-DATE-B-EDIT.
   989             20  DC-EDITB-MONTH        PIC 99.
   990             20  SLASHB-1              PIC X VALUE '/'.
   991             20  DC-EDITB-DAY          PIC 99.
   992             20  SLASHB-2              PIC X VALUE '/'.
   993             20  DC-EDITB-CCYY.
   994                 24  DC-EDITB-CENT     PIC 99.
   995                 24  DC-EDITB-YEAR     PIC 99.
   996         16  DC-GREG-DATE-CYMD         PIC 9(08).
   997         16  DC-GREG-DATE-CYMD-R REDEFINES
   998                              DC-GREG-DATE-CYMD.
   999             20  DC-CYMD-CEN           PIC 99.
  1000             20  DC-CYMD-YEAR          PIC 99.
  1001             20  DC-CYMD-MONTH         PIC 99.
  1002             20  DC-CYMD-DAY           PIC 99.
  1003         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1004         16  DC-GREG-DATE-MDCY-R REDEFINES
  1005                              DC-GREG-DATE-MDCY.
  1006             20  DC-MDCY-MONTH         PIC 99.
  1007             20  DC-MDCY-DAY           PIC 99.
  1008             20  DC-MDCY-CEN           PIC 99.
  1009             20  DC-MDCY-YEAR          PIC 99.
  1010    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1011        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1012    12  DC-EL310-DATE                  PIC X(21).
  1013    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  21
* EL156.cbl
  1015*    COPY ELCLOGOF.
  1016******************************************************************
  1017*                                                                *
  1018*                                                                *
  1019*                            ELCLOGOF.                           *
  1020*                            VMOD=2.001                          *
  1021*                                                                *
  1022*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1023*                                                                *
  1024******************************************************************
  1025 01  CLASIC-LOGOFF.
  1026     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1027     12  LOGOFF-TEXT.
  1028         16  FILLER          PIC X(5)    VALUE SPACES.
  1029         16  LOGOFF-MSG.
  1030             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1031             20  FILLER      PIC X       VALUE SPACES.
  1032             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1033         16  FILLER          PIC X(80)
  1034           VALUE '* YOU ARE NOW LOGGED OFF'.
  1035         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1036         16  FILLER          PIC X       VALUE QUOTE.
  1037         16  LOGOFF-SYS-MSG  PIC X(17)
  1038           VALUE 'S CLAS-IC SYSTEM '.
  1039     12  TEXT-MESSAGES.
  1040         16  UNACCESS-MSG    PIC X(29)
  1041             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1042         16  PGMIDERR-MSG    PIC X(17)
  1043             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  22
* EL156.cbl
  1045*    COPY ELCCALC.
  1046******************************************************************
  1047*                                                                *
  1048*                           ELCCALC.                            *
  1049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1050*                            VMOD=2.025                          *
  1051*                                                                *
  1052*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1053*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1054*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1055*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1056*                                                                *
  1057*  PASSED TO ELRTRM                                              *
  1058*  -----------------                                             *
  1059*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1060*  ORIGINAL TERM                                                 *
  1061*  BEGINNING DATE                                                *
  1062*  ENDING DATE                                                   *
  1063*  COMPANY I.D.                                                  *
  1064*  ACCOUNT MASTER USER FIELD                                     *
  1065*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1066*  FREE LOOK DAYS                                                *
  1067*                                                                *
  1068*  RETURNED FROM ELRTRM                                          *
  1069*  ---------------------                                         *
  1070*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1071*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1072*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1073*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1074*----------------------------------------------------------------*
  1075*  PASSED TO ELRAMT                                              *
  1076*  ----------------                                              *
  1077*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1078*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1079*  ORIGINAL AMOUNT                                               *
  1080*  ALTERNATE BENEFIT (BALLON)                                    *
  1081*  A.P.R. - NET PAY ONLY                                         *
  1082*  METHOD
  1083*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1084*  COMPANY I.D.                                                  *
  1085*  BENEFIT TYPE                                                  *
  1086*                                                                *
  1087*  RETURNED FROM ELRAMT                                          *
  1088*  --------------------                                          *
  1089*  REMAINING AMOUNT 1 - CURRENT                                  *
  1090*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1091*  REMAINING AMOUNT FACTOR
  1092*----------------------------------------------------------------*
  1093*  PASSED TO ELRESV                                              *
  1094*  -----------------                                             *
  1095*  CERTIFICATE EFFECTIVE DATE                                    *
  1096*  VALUATION DATE                                                *
  1097*  PAID THRU DATE                                                *
  1098*  BENEFIT                                                       *
  1099*  INCURRED DATE                                                 *
  1100*  REPORTED DATE                                                 *
  1101*  ISSUE AGE                                                     *
  1102*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  23
* EL156.cbl
  1103*  CDT PERCENT                                                   *
  1104*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1105* *CLAIM TYPE (LIFE, A/H)                                        *
  1106* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1107* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1108*                                                                *
  1109*  RETURNED FROM ELRESV                                          *
  1110*  --------------------                                          *
  1111*  CDT TABLE USED                                                *
  1112*  CDT FACTOR USED                                               *
  1113*  PAY TO CURRENT RESERVE                                        *
  1114*  I.B.N.R. - A/H ONLY                                           *
  1115*  FUTURE (ACCRUED) AH ONLY                                      *
  1116*----------------------------------------------------------------*
  1117*  PASSED TO ELRATE                                              *
  1118*  ----------------                                              *
  1119*  CERT ISSUE DATE                                               *
  1120*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1121*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1122*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1123*  STATE CODE (CLIENT DEFINED)                                   *
  1124*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1125*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1126*  DEVIATION CODE                                                *
  1127*  ISSUE AGE                                                     *
  1128*  ORIGINAL BENEFIT AMOUNT                                       *
  1129*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1130*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1131*  BENEFIT KIND (LIFE OR A/H)                                    *
  1132*  A.P.R.                                                        *
  1133*  METHOD
  1134*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1135*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1136*  COMPANY I.D. (3 CHARACTER)                                    *
  1137*  BENEFIT CODE                                                  *
  1138*  BENEFIT OVERRIDE CODE                                         *
  1139*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1140*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1141*  JOINT INDICATOR (CSL ONLY)                                    *
  1142*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1143*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1144*                                                                *
  1145*  RETURNED FROM ELRATE                                          *
  1146*  --------------------                                          *
  1147*  CALCULATED PREMIUM                                            *
  1148*  PREMIUM RATE                                                  *
  1149*  MORTALITY CODE                                                *
  1150*  MAX ATTAINED AGE                                              *
  1151*  MAX AGE                                                       *
  1152*  MAX TERM                                                      *
  1153*  MAX MONTHLY BENEFIT                                           *
  1154*  MAX TOTAL BENIFIT                                             *
  1155*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1156*----------------------------------------------------------------*
  1157*  PASSED TO ELRFND                                              *
  1158*  ----------------                                              *
  1159*  CERT ISSUE DATE                                               *
  1160*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  24
* EL156.cbl
  1161*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1162*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1163*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1164*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1165*  STATE CODE (CLIENT DEFINED)                                   *
  1166*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1167*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1168*  DEVIATION CODE                                                *
  1169*  ISSUE AGE                                                     *
  1170*  ORIGINAL BENEFIT AMOUNT                                       *
  1171*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1172*  PROCESS TYPE (CANCEL)                                         *
  1173*  BENEFIT KIND (LIFE OR A/H)                                    *
  1174*  A.P.R.                                                        *
  1175*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1176*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1177*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1178*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1179*  COMPANY I.D. (3 CHARACTER)                                    *
  1180*  BENEFIT CODE                                                  *
  1181*  BENEFIT OVERRIDE CODE                                         *
  1182*                                                                *
  1183*  RETURNED FROM ELRFND                                          *
  1184*  --------------------                                          *
  1185*  CALCULATED REFUND                                             *
  1186*----------------------------------------------------------------*
  1187*  PASSED TO ELEARN                                              *
  1188*  ----------------                                              *
  1189*  CERT ISSUE DATE                                               *
  1190*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1191*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1192*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1193*  STATE CODE (CLIENT DEFINED)                                   *
  1194*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1195*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1196*  DEVIATION CODE                                                *
  1197*  ISSUE AGE                                                     *
  1198*  ORIGINAL BENEFIT AMOUNT                                       *
  1199*  BENEFIT KIND (LIFE OR A/H)                                    *
  1200*  A.P.R.                                                        *
  1201*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1202*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1203*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1204*  COMPANY I.D. (3 CHARACTER)                                    *
  1205*  BENEFIT CODE                                                  *
  1206*  BENEFIT OVERRIDE CODE                                         *
  1207*                                                                *
  1208*  RETURNED FROM ELEARN                                          *
  1209*  --------------------                                          *
  1210*  INDICATED  EARNINGS                                           *
  1211*----------------------------------------------------------------*
  1212*                 LENGTH = 450                                   *
  1213*                                                                *
  1214******************************************************************
  1215******************************************************************
  1216*                   C H A N G E   L O G
  1217*
  1218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  25
* EL156.cbl
  1219*-----------------------------------------------------------------
  1220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1221* EFFECTIVE    NUMBER
  1222*-----------------------------------------------------------------
  1223* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1224* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1225* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1226* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1227* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1228* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1229* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1230* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1231* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1232******************************************************************
  1233
  1234 01  CALCULATION-PASS-AREA.
  1235     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1236                                     COMP.
  1237
  1238     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1239       88  NO-CP-ERROR                             VALUE ZERO.
  1240       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1241                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1242       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1243       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1244       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1245       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1246       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1247       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1248       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1249       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1250       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1251       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1252       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1253       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1254       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1255       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1256       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1257       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1258       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1259
  1260     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1261       88  NO-CP-ERROR-2                           VALUE ZERO.
  1262***********************  INPUT AREAS ****************************
  1263
  1264     12  CP-CALCULATION-AREA.
  1265         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1266         16  CP-CERT-EFF-DT        PIC XX.
  1267         16  CP-VALUATION-DT       PIC XX.
  1268         16  CP-PAID-THRU-DT       PIC XX.
  1269         16  CP-BENEFIT-TYPE       PIC X.
  1270           88  CP-AH                               VALUE 'A' 'D'
  1271                                                   'I' 'U'.
  1272           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1273           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1274         16  CP-INCURRED-DT        PIC XX.
  1275         16  CP-REPORTED-DT        PIC XX.
  1276         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  26
* EL156.cbl
  1277         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1278         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1279                                     COMP-3.
  1280         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1281                                     COMP-3.
  1282         16  CP-CDT-METHOD         PIC X.
  1283           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1284           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1285           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1286         16  CP-CLAIM-TYPE         PIC X.
  1287           88  CP-AH-CLAIM                         VALUE 'A'.
  1288           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1289         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1290                                     COMP-3.
  1291         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1292                                     COMP-3.
  1293         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1294                                     COMP-3.
  1295         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1296                                     COMP-3.
  1297         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1298                                     COMP-3.
  1299         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1300                                     COMP-3.
  1301         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1302                                     COMP-3.
  1303         16  CP-REM-TERM-METHOD    PIC X.
  1304           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1305           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1306           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1307           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1308           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1309           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1310           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1311         16  CP-EARNING-METHOD     PIC X.
  1312           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1313           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1314           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1315           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1316           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1317           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1318           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1319           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1320           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1321           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1322           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1323           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1324           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1325           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1326         16  CP-PROCESS-TYPE       PIC X.
  1327           88  CP-CLAIM                            VALUE '1'.
  1328           88  CP-CANCEL                           VALUE '2'.
  1329           88  CP-ISSUE                            VALUE '3'.
  1330         16  CP-SPECIAL-CALC-CD    PIC X.
  1331           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1332           88  CP-1-MTH-INTEREST               VALUE ' '.
  1333           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1334           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  27
* EL156.cbl
  1335           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1336           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1337           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1338           88  CP-FARM-PLAN                    VALUE 'F'.
  1339           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1340           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1341           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1342           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1343           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1344           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1345           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1346           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1347           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1348           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1349                                                     'W' 'X'.
  1350           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1351           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1352           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1353           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1354           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1355           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1356           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1357           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1358           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1359           88  CP-CSL-METH-1                   VALUE '5'.
  1360           88  CP-CSL-METH-2                   VALUE '6'.
  1361           88  CP-CSL-METH-3                   VALUE '7'.
  1362           88  CP-CSL-METH-4                   VALUE '8'.
  1363
  1364         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1365                                     COMP-3.
  1366         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1367         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1368         16  CP-STATE              PIC XX          VALUE SPACE.
  1369         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1370         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1371           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1372               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1373         16  CP-R78-OPTION         PIC X.
  1374           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1375           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1376
  1377         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1378         16  CP-IBNR-RESERVE-SW    PIC X.
  1379         16  CP-CLAIM-STATUS       PIC X.
  1380         16  CP-RATE-FILE          PIC X.
  1381         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1382                                     COMP-3.
  1383
  1384         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1385         16  CP-AH-OVERRIDE-CODE   PIC X.
  1386
  1387         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1388                                     COMP-3.
  1389         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1390                                   PIC S9(5)V99 COMP-3.
  1391         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1392                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  28
* EL156.cbl
  1393         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1398                                  PIC S9(7)V99 COMP-3.
  1399
  1400         16  CP-PAID-FROM-DATE     PIC X(02).
  1401         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1402         16  CP-EXT-DAYS-CALC      PIC X.
  1403           88  CP-EXT-NO-CHG                   VALUE ' '.
  1404           88  CP-EXT-CHG-LF                   VALUE '1'.
  1405           88  CP-EXT-CHG-AH                   VALUE '2'.
  1406           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1407         16  CP-DOMICILE-STATE     PIC XX.
  1408         16  CP-CARRIER            PIC X.
  1409         16  CP-REIN-FLAG          PIC X.
  1410         16  CP-REM-TRM-CALC-OPTION PIC X.
  1411           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1412                      '2' '3' '4' '5'.
  1413           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1414           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1415           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1416           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1417           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1418           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1419           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1420           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1421         16  CP-SIG-SWITCH         PIC X.
  1422         16  CP-RATING-METHOD      PIC X.
  1423           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1424           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1425           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1426           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1427           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1428           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1429           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1430           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1431           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1432         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1433                                     COMP-3.
  1434         16  CP-BEN-CATEGORY       PIC X.
  1435         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1436         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1437                                   PIC S99V9(5) COMP-3.
  1438         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1439         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1440                                   PIC S99V9(5) COMP-3.
  1441         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1442         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1443         16  CP-EXPIRE-DT          PIC XX.
  1444         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1445         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1446         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1447         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1448         16  CP-DDF-SPEC-CALC      PIC X.
  1449             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1450             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  29
* EL156.cbl
  1451         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1452         16  CP-CANCEL-REASON      PIC X.
  1453         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1454         16  CP-PMT-MODE           PIC X.
  1455         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1456         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1457         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1458         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1459         16  FILLER                PIC X.
  1460
  1461***************    OUTPUT FROM ELRESV   ************************
  1462
  1463         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1464
  1465         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1466                                     COMP-3.
  1467         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1468                                     COMP-3.
  1469         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1470                                     COMP-3.
  1471         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1472                                     COMP-3.
  1473         16  FILLER                PIC X(09).
  1474***************    OUTPUT FROM ELRTRM   *************************
  1475
  1476         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1477                                     COMP-3.
  1478         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1479                                     COMP-3.
  1480         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1481                                     COMP-3.
  1482         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1483                                     COMP-3.
  1484         16  FILLER                PIC X(12).
  1485
  1486***************    OUTPUT FROM ELRAMT   *************************
  1487
  1488         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1489                                     COMP-3.
  1490         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1491                                     COMP-3.
  1492         16  FILLER                PIC X(12).
  1493
  1494***************    OUTPUT FROM ELRATE   *************************
  1495
  1496         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1497                                     COMP-3.
  1498         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1499                                     COMP-3.
  1500         16  CP-MORTALITY-CODE     PIC X(4).
  1501         16  CP-RATE-EDIT-FLAG     PIC X.
  1502             88  CP-RATES-NEED-APR                  VALUE '1'.
  1503         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1504                                     COMP-3.
  1505         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1506         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1507         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1508                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  30
* EL156.cbl
  1509         16  FILLER                PIC X(07).
  1510
  1511***************    OUTPUT FROM ELRFND   *************************
  1512
  1513         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1514                                     COMP-3.
  1515         16  CP-REFUND-TYPE-USED   PIC X.
  1516           88  CP-R-AS-R78                         VALUE '1'.
  1517           88  CP-R-AS-PRORATA                     VALUE '2'.
  1518           88  CP-R-AS-CALIF                       VALUE '3'.
  1519           88  CP-R-AS-TEXAS                       VALUE '4'.
  1520           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1521           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1522           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1523           88  CP-R-AS-MEAN                        VALUE '8'.
  1524           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1525           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1526           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1527           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1528           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1529           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1530         16  FILLER                PIC X(12).
  1531
  1532***************    OUTPUT FROM ELEARN   *************************
  1533
  1534         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1535                                     COMP-3.
  1536         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1537                                     COMP-3.
  1538         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1539                                     COMP-3.
  1540         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1541                                     COMP-3.
  1542         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1543                                     COMP-3.
  1544         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1545                                     COMP-3.
  1546         16  CP-EARNING-TYPE-USED  PIC X.
  1547           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1548           88  CP-E-AS-R78                         VALUE '1'.
  1549           88  CP-E-AS-PRORATA                     VALUE '2'.
  1550           88  CP-E-AS-TEXAS                       VALUE '4'.
  1551           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1552           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1553           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1554           88  CP-E-AS-MEAN                        VALUE '8'.
  1555           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1556         16  FILLER                PIC X(12).
  1557
  1558***************    OUTPUT FROM ELPMNT   *************************
  1559
  1560         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1561                                     COMP-3.
  1562         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1563                                     COMP-3.
  1564         16  FILLER                PIC X(12).
  1565
  1566***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  31
* EL156.cbl
  1567         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1580             88  OPEN-RATE-FILE                   VALUE 'O'.
  1581             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1582             88  IO-ERROR                         VALUE 'E'.
  1583
  1584         16  CP-FIRST-PAY-DATE     PIC XX.
  1585
  1586         16  CP-JOINT-INDICATOR    PIC X.
  1587
  1588         16  CP-RESERVE-REMAINING-TERM
  1589                                   PIC S9(4)V9    VALUE ZERO
  1590                                     COMP-3.
  1591
  1592         16  CP-INSURED-BIRTH-DT   PIC XX.
  1593
  1594         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1595                                     COMP-3.
  1596
  1597         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1598                                     COMP-3.
  1599
  1600         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1601                                     COMP-3.
  1602
  1603         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1604                                     COMP-3.
  1605
  1606         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1607                                     COMP-3.
  1608
  1609         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1610                                     COMP-3.
  1611
  1612         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1613                                     COMP-3.
  1614
  1615         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1616             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1617
  1618         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1621                                     COMP-3.
  1622         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1623         16  FILLER                PIC X(15).
  1624******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  32
* EL156.cbl
  1625*    COPY ELCICALC.
  1626******************************************************************
  1627*                                                                *
  1628*                           ELCCICALC.                           *
  1629*                            VMOD=2.001                          *
  1630*                                                                *
  1631*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1632*                 CALCULATION MODULE                             *
  1633*                                                                *
  1634*  PASSED TO ELCLMI                                              *
  1635*  -----------------                                             *
  1636*  STATE                                                         *
  1637*  PRODUCT                                                       *
  1638*  COVERAGE                                                      *
  1639*  EFFECTIVE DATE                                                *
  1640*  INCURRED DATE                                                 *
  1641*  ESTABLISHED DATE                                              *
  1642*  LAST PAID DATE                                                *
  1643*  REPORTED DATE                                                 *
  1644*  CLAIM PAYMENT AMOUNT                                          *
  1645*                                                                *
  1646*  RETURNED FROM ELRTRM                                          *
  1647*  ---------------------                                         *
  1648*  RETURN CODE                                                   *
  1649*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1650*  CLAIM INTEREST AMOUNT                                         *
  1651*----------------------------------------------------------------*
  1652*----------------------------------------------------------------*
  1653*                 LENGTH = 100                                   *
  1654*                                                                *
  1655******************************************************************
  1656******************************************************************
  1657*                   C H A N G E   L O G
  1658*
  1659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1660*-----------------------------------------------------------------
  1661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1662* EFFECTIVE    NUMBER
  1663*-----------------------------------------------------------------
  1664* 120905    2004040700004  PEMA  NEW COPYBOOK
  1665* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1666******************************************************************
  1667
  1668 01  CLAIM-INT-PASS-AREA.
  1669     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1670                                     COMP.
  1671
  1672     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1673       88  NO-CI-ERROR                             VALUE ZERO.
  1674       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1675       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1676       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1677       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1678       88  CP-AMT-LT-5000                          VALUE '4'.
  1679       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1680       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1681       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1682       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  33
* EL156.cbl
  1683***********************  INPUT AREAS ****************************
  1684
  1685     12  CP-CALCULATION-AREA.
  1686         16  CP-COMPANY-CD         PIC X.
  1687         16  CP-STATE              PIC XX.
  1688         16  CP-PRODUCT            PIC XX.
  1689         16  CP-COVERAGE           PIC XX.
  1690         16  CP-INC-DT             PIC XX.
  1691         16  CP-EST-DT             PIC XX.
  1692         16  CP-LSTPD-DT           PIC XX.
  1693         16  CP-RPT-DT             PIC XX.
  1694         16  CP-PRF-DT             PIC XX.
  1695         16  CP-EFF-DT             PIC XX.
  1696         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1697         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1698         16  FILLER                PIC X(37).
  1699
  1700***************    OUTPUT FROM ELCLMI   ************************
  1701
  1702         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1703
  1704         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1705         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1706         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1707         16  FILLER                PIC X(19).
  1708******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  34
* EL156.cbl
  1710*    COPY ELCATTR.
  1711******************************************************************
  1712*                                                                *
  1713*                            ELCATTR.                            *
  1714*                            VMOD=2.001                          *
  1715*                                                                *
  1716*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1717*                                                                *
  1718*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1719*                                                                *
  1720*                   POS 1   P=PROTECTED                          *
  1721*                           U=UNPROTECTED                        *
  1722*                           S=ASKIP                              *
  1723*                   POS 2   A=ALPHA/NUMERIC                      *
  1724*                           N=NUMERIC                            *
  1725*                   POS 3   N=NORMAL                             *
  1726*                           B=BRIGHT                             *
  1727*                           D=DARK                               *
  1728*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1729*                           OF=MODIFIED DATA TAG OFF             *
  1730*                                                                *
  1731*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1732******************************************************************
  1733 01  ATTRIBUTE-LIST.
  1734     12  AL-PABOF            PIC X       VALUE 'Y'.
  1735     12  AL-PABON            PIC X       VALUE 'Z'.
  1736     12  AL-PADOF            PIC X       VALUE '%'.
  1737     12  AL-PADON            PIC X       VALUE '_'.
  1738     12  AL-PANOF            PIC X       VALUE '-'.
  1739     12  AL-PANON            PIC X       VALUE '/'.
  1740     12  AL-SABOF            PIC X       VALUE '8'.
  1741     12  AL-SABON            PIC X       VALUE '9'.
  1742     12  AL-SADOF            PIC X       VALUE '@'.
  1743     12  AL-SADON            PIC X       VALUE QUOTE.
  1744     12  AL-SANOF            PIC X       VALUE '0'.
  1745     12  AL-SANON            PIC X       VALUE '1'.
  1746     12  AL-UABOF            PIC X       VALUE 'H'.
  1747     12  AL-UABON            PIC X       VALUE 'I'.
  1748     12  AL-UADOF            PIC X       VALUE '<'.
  1749     12  AL-UADON            PIC X       VALUE '('.
  1750     12  AL-UANOF            PIC X       VALUE ' '.
  1751     12  AL-UANON            PIC X       VALUE 'A'.
  1752     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1753     12  AL-UNBON            PIC X       VALUE 'R'.
  1754     12  AL-UNDOF            PIC X       VALUE '*'.
  1755     12  AL-UNDON            PIC X       VALUE ')'.
  1756     12  AL-UNNOF            PIC X       VALUE '&'.
  1757     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  35
* EL156.cbl
  1759*    COPY ELCEMIB.
  1760******************************************************************
  1761*                                                                *
  1762*                                                                *
  1763*                            ELCEMIB.                            *
  1764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1765*                            VMOD=2.005                          *
  1766*                                                                *
  1767*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1768*                                                                *
  1769******************************************************************
  1770 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1771     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1772     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1773     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1774     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1775     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1776     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1777     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1778     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1779     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1780         88  EMI-NO-ERRORS                    VALUE '1'.
  1781         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1782         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1783     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1784         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1785     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1786         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1787         88  EMI-AREA1-FULL                   VALUE '2'.
  1788     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1789         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1790         88  EMI-AREA2-FULL                   VALUE '2'.
  1791     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1792         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1793         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1794         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1795         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1796         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1797     12  EMI-ERROR-LINES.
  1798         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1799         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1800         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1801         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1802             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1803                 24  EMI-ERR-NUM         PIC X(4).
  1804                 24  EMI-FILLER          PIC X.
  1805                 24  EMI-SEV             PIC X.
  1806                 24  FILLER              PIC X.
  1807             20  FILLER                  PIC X(02).
  1808     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1809         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1810             20  EMI-ERROR-NUMBER    PIC X(4).
  1811             20  EMI-FILL            PIC X.
  1812             20  EMI-SEVERITY        PIC X.
  1813             20  FILLER              PIC X.
  1814             20  EMI-ERROR-TEXT.
  1815                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1816                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  36
* EL156.cbl
  1817     12  EMI-SEVERITY-SAVE           PIC X.
  1818         88  EMI-NOTE                    VALUE 'N'.
  1819         88  EMI-WARNING                 VALUE 'W'.
  1820         88  EMI-FORCABLE                VALUE 'F'.
  1821         88  EMI-FATAL                   VALUE 'X'.
  1822     12  EMI-MESSAGE-FLAG            PIC X.
  1823         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1824         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1825     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1826     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1827         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1828         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1829         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1830     12  FILLER                      PIC X(137)  VALUE SPACES.
  1831     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1832     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1833     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1834     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  37
* EL156.cbl
  1836*    COPY ELCLNKLT.
  1837******************************************************************
  1838*                                                                *
  1839*                                                                *
  1840*                           ELCLNKLT                             *
  1841*                            VMOD=2.003                          *
  1842*                                                                *
  1843*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1844*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1845*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1846*                                                                *
  1847*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1848*   COMPLETING THE REQUIRED FIELDS.                              *
  1849*                                                                *
  1850*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1851*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1852*                              9999 INDICATES AN UNKNOWN ABEND   *
  1853*                                   WAS DETECTED.                *
  1854*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1855*                              CODES FOUND IN THE ERROR FILE.    *
  1856******************************************************************
  1857 01  W-1523-LINKDATA.
  1858     12  W-1523-COMMON-PI-DATA.
  1859         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1860         16  FILLER              PIC  X(67).
  1861         16  W-1523-COMPANY-CD   PIC  X(01).
  1862         16  FILLER              PIC  X(10).
  1863         16  W-1523-CONTROL-IN-PROGRESS.
  1864             20  W-1523-CARRIER  PIC  X(01).
  1865             20  W-1523-GROUPING PIC  X(06).
  1866             20  W-1523-STATE    PIC  X(02).
  1867             20  W-1523-ACCOUNT  PIC  X(10).
  1868             20  W-1523-CLAIM-CERT-GRP.
  1869                 24  W-1523-CLAIM-NO
  1870                                 PIC  X(07).
  1871                 24  W-1523-CERT-NO.
  1872                     28  W-1523-CERT-PRIME
  1873                                 PIC  X(10).
  1874                     28  W-1523-CERT-SFX
  1875                                 PIC  X(01).
  1876                 24  W-1523-CERT-EFF-DT
  1877                                 PIC  X(02).
  1878         16  FILLER              PIC X(265).
  1879
  1880     12  W-1523-WORK-AREA.
  1881         16  W-1523-FORM-NUMBER  PIC  X(04).
  1882         16  W-1523-NUMBER-COPIES
  1883                                 PIC  9(01).
  1884         16  W-1523-ADDR-TYPE    PIC  X(02).
  1885         16  W-1523-FOLLOW-UP-DATE
  1886                                 PIC  X(02).
  1887         16  W-1523-RESEND-DATE  PIC  X(02).
  1888         16  W-1523-ERROR-CODE   PIC  9(04).
  1889             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1890             88  W-1523-FATAL-ERROR
  1891                                    VALUES  0006 0013 0042
  1892                                            0154 0168 0169
  1893                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  38
* EL156.cbl
  1894                                            0179 0186 0281
  1895                                            0332 2055 3697
  1896                                            3698 3699 3770
  1897                                            3771 3772 7675
  1898                                            9106 9808 9883
  1899                                            9887.
  1900             88  W-1523-STOP-ERRORS
  1901                                    VALUES  0013 0042 0154
  1902                                            0168 0169 0172
  1903                                            0281 0332 2055
  1904                                            3698 3699 7675
  1905                                            9106 9808 9883
  1906                                            9999.
  1907         16  W-1523-REASON       PIC  X(70).
  1908         16  W-1523-ARCHIVE-NUMBER
  1909                                 PIC  9(08).
  1910     12  W-1523-POINTER-AREA.
  1911         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1912         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1913         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1914         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1915         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  39
* EL156.cbl
  1917*    COPY ELCNWA.
  1918*****************************************************************
  1919*                                                               *
  1920*                                                               *
  1921*                            ELCNWA.                            *
  1922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1923*                            VMOD=2.003                         *
  1924*                                                               *
  1925*            M O V E   N A M E   W O R K   A R E A.             *
  1926*                                                               *
  1927*****************************************************************.
  1928
  1929 01  WS-NAME-WORK-AREA.
  1930     05  WS-INSURED-LAST-NAME        PIC X(15).
  1931     05  WS-INSURED-1ST-NAME         PIC X(12).
  1932     05  WS-INSURED-MID-INIT         PIC X.
  1933
  1934     05  WS-NAME-WORK.
  1935         10  WS-NW                   PIC X
  1936             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1937
  1938     05  WS-NAME-WORK2.
  1939         10  WS-NW2                  PIC X
  1940             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1941                                        NWA-INDEX0.
  1942
  1943     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1944                                     COMP-3.
  1945
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  40
* EL156.cbl
  1947*    COPY ELCDMO.
  1948******************************************************************
  1949*                                                                *
  1950*                                                                *
  1951*                            ELCDMO.                             *
  1952*                            VMOD=2.004                          *
  1953*                                                                *
  1954*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1955*        COMMUNICATION AREA                                      *
  1956*   FILE TYPE = NA                                               *
  1957*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1958*                                                                *
  1959******************************************************************
  1960 01  DMO-COMMUNICATION-AREA.
  1961     12  DM-RECORD-TYPE                  PIC  X(02).
  1962             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1963             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1964             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1965     12  DM-DIST-CODE                    PIC  X(04).
  1966     12  DM-MAIL-CODE                    PIC  X(05).
  1967     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1968     12  DM-INSURED-NAME                 PIC  X(30).
  1969     12  DM-CLAIM-NO                     PIC  X(07).
  1970     12  DM-CLAIM-TYPE                   PIC  X.
  1971
  1972     12  DM-STATUS-DATA-AREA.
  1973         16  DM-CLAIM-STATUS             PIC  X.
  1974             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1975             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1976             88  DM-CLOSED                        VALUE '3'.
  1977             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1978             88  DM-DEFAULT                       VALUE '9'.
  1979         16  DM-STATUS-DATE              PIC  X(08).
  1980******YYYYMMDD
  1981         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1982             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1983             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1984             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1985             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1986             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1987             88  DM-RE-OPENED                     VALUE 'R'.
  1988             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1989             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1990             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1991         16  DM-STAT-CARRIER             PIC X.
  1992
  1993     12  DM-DRAFT-DATA-AREA.
  1994         16  DM-PAYMENT-TYPE             PIC  X.
  1995             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1996         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1997         16  DM-PAYMENT-DATE             PIC  X(08).
  1998******YYYYMMDD
  1999         16  DM-CERT-NO                  PIC  X(11).
  2000         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2001         16  DM-CARRIER                  PIC  X.
  2002
  2003     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  41
* EL156.cbl
  2005*    COPY ELCDMDCD.
  2006******************************************************************
  2007*                                                                *
  2008*                                                                *
  2009*                            ELCDMDCD.                           *
  2010*                            VMOD=2.001                          *
  2011*                                                                *
  2012*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2013*       COMMUNICATIONS AREA                                      *
  2014*                                                                *
  2015******************************************************************
  2016 01  CD-COMMUNICATION-AREA.
  2017     12  CD-SYSTEM-ID            PIC  X(02).
  2018         88 CD-CLAIMS                      VALUE 'CL'.
  2019         88 CD-CREDIT                      VALUE 'CR'.
  2020     12  CD-RECORD-TYPE          PIC  X(02).
  2021         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2022         88 CD-EOB-CODE                    VALUE 'EO'.
  2023         88 CD-ICD9-CODE                   VALUE 'I9'.
  2024         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2025         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2026         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2027         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2028         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2029     12  CD-RECORD-KEY           PIC  X(06).
  2030         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2031     12  CD-RETURN-CODE          PIC  X(02).
  2032     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2033     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2034     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2035     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  42
* EL156.cbl
  2037*    COPY ELCDCTB.
  2038******************************************************************
  2039*                                                                *
  2040*                                                                *
  2041*                            ELCDCTB.                            *
  2042*                            VMOD=2.002                          *
  2043*                                                                *
  2044*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2045*       COMMUNICATIONS AREA                                      *
  2046*                                                                *
  2047******************************************************************
  2048 01  DCT-COMMUNICATION-AREA.
  2049     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2050     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2051     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2052     12  DCT-PRODUCT-CODE         PIC  X(02).
  2053     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2054     12  DCT-RETURN-CODE          PIC  X(02).
  2055     12  DCT-MAIL-CODE            PIC  X(05).
  2056     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2057     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  43
* EL156.cbl
  2059 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2060 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2061 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2062 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  44
* EL156.cbl
  2064*    COPY ELCINTF.
  2065******************************************************************
  2066*                                                                *
  2067*                                                                *
  2068*                            ELCINTF.                            *
  2069*                            VMOD=2.017                          *
  2070*                                                                *
  2071*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2072*                                                                *
  2073*       LENGTH = 1024                                            *
  2074*                                                                *
  2075******************************************************************
  2076*                   C H A N G E   L O G
  2077*
  2078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2079*-----------------------------------------------------------------
  2080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2081* EFFECTIVE    NUMBER
  2082*-----------------------------------------------------------------
  2083* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2084******************************************************************
  2085 01  PROGRAM-INTERFACE-BLOCK.
  2086     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2087     12  PI-CALLING-PROGRAM              PIC X(8).
  2088     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2089     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2090     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2091     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2092     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2093     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2094     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2095     12  PI-COMPANY-ID                   PIC XXX.
  2096     12  PI-COMPANY-CD                   PIC X.
  2097
  2098     12  PI-COMPANY-PASSWORD             PIC X(8).
  2099
  2100     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2101
  2102     12  PI-CONTROL-IN-PROGRESS.
  2103         16  PI-CARRIER                  PIC X.
  2104         16  PI-GROUPING                 PIC X(6).
  2105         16  PI-STATE                    PIC XX.
  2106         16  PI-ACCOUNT                  PIC X(10).
  2107         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2108                                         PIC X(10).
  2109         16  PI-CLAIM-CERT-GRP.
  2110             20  PI-CLAIM-NO             PIC X(7).
  2111             20  PI-CERT-NO.
  2112                 25  PI-CERT-PRIME       PIC X(10).
  2113                 25  PI-CERT-SFX         PIC X.
  2114             20  PI-CERT-EFF-DT          PIC XX.
  2115         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2116             20  PI-PLAN-CODE            PIC X(2).
  2117             20  PI-REVISION-NUMBER      PIC X(3).
  2118             20  PI-PLAN-EFF-DT          PIC X(2).
  2119             20  PI-PLAN-EXP-DT          PIC X(2).
  2120             20  FILLER                  PIC X(11).
  2121         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  45
* EL156.cbl
  2122             20  PI-OE-REFERENCE-1.
  2123                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2124                 25  PI-OE-REF-1-SUFF    PIC XX.
  2125
  2126     12  PI-SESSION-IN-PROGRESS          PIC X.
  2127         88  CLAIM-SESSION                   VALUE '1'.
  2128         88  CREDIT-SESSION                  VALUE '2'.
  2129         88  WARRANTY-SESSION                VALUE '3'.
  2130         88  MORTGAGE-SESSION                VALUE '4'.
  2131         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2132
  2133
  2134*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2135
  2136     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2137     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2138
  2139     12  PI-CREDIT-USER                  PIC X.
  2140         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2141         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2142
  2143     12  PI-CLAIM-USER                   PIC X.
  2144         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2145         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2146
  2147     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2148         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2149         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2150         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2151         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2152         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2153
  2154     12  PI-PROCESSOR-ID                 PIC X(4).
  2155
  2156     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2157
  2158     12  PI-MEMBER-CAPTION               PIC X(10).
  2159
  2160     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2161         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2162
  2163     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2164     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2165     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2166     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2167
  2168     12  PI-AH-OVERRIDE-L1               PIC X.
  2169     12  PI-AH-OVERRIDE-L2               PIC XX.
  2170     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2171     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2172
  2173     12  PI-NEW-SYSTEM                   PIC X(2).
  2174
  2175     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2176     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2177         88  PI-USES-PAID-TO                 VALUE '1'.
  2178     12  PI-CRDTCRD-SYSTEM.
  2179         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  46
* EL156.cbl
  2180             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2181             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2182         16  PI-CC-MONTH-END-DT          PIC XX.
  2183     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2184
  2185     12  PI-OE-REFERENCE-2.
  2186         16  PI-OE-REF-2-PRIME           PIC X(10).
  2187         16  PI-OE-REF-2-SUFF            PIC X.
  2188
  2189     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2190
  2191     12  PI-LANGUAGE-TYPE                PIC X.
  2192             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2193             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2194             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2195
  2196     12  PI-POLICY-LINKAGE-IND           PIC X.
  2197         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2198         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2199                                                   LOW-VALUES.
  2200
  2201     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2202     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2203         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2204         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2205
  2206     12  PI-PROCESSOR-CSR-IND            PIC X.
  2207         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2208         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2209
  2210     12  FILLER                          PIC X(3).
  2211
  2212     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2213
  2214     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2215         PI-SYSTEM-LEVEL.
  2216
  2217         16  PI-ENTRY-CODES.
  2218             20  PI-ENTRY-CD-1           PIC X.
  2219             20  PI-ENTRY-CD-2           PIC X.
  2220
  2221         16  PI-RETURN-CODES.
  2222             20  PI-RETURN-CD-1          PIC X.
  2223             20  PI-RETURN-CD-2          PIC X.
  2224
  2225         16  PI-UPDATE-STATUS-SAVE.
  2226             20  PI-UPDATE-BY            PIC X(4).
  2227             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2228
  2229         16  PI-LOWER-CASE-LETTERS       PIC X.
  2230             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2231
  2232*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2233*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2234*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2235
  2236         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2237             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  47
* EL156.cbl
  2238             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2239             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2240             88  ACCNT-CNTL                  VALUE '3'.
  2241             88  CARR-ACCNT-CNTL             VALUE '4'.
  2242
  2243         16  PI-PROCESSOR-CAP-LIST.
  2244             20  PI-SYSTEM-CONTROLS.
  2245                24 PI-SYSTEM-DISPLAY     PIC X.
  2246                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2247                24 PI-SYSTEM-MODIFY      PIC X.
  2248                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2249             20  FILLER                  PIC XX.
  2250             20  PI-DISPLAY-CAP          PIC X.
  2251                 88  DISPLAY-CAP             VALUE 'Y'.
  2252             20  PI-MODIFY-CAP           PIC X.
  2253                 88  MODIFY-CAP              VALUE 'Y'.
  2254             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2255                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2256             20  PI-FORCE-CAP            PIC X.
  2257                 88  FORCE-CAP               VALUE 'Y'.
  2258
  2259         16  PI-PROGRAM-CONTROLS.
  2260             20  PI-PGM-PRINT-OPT        PIC X.
  2261             20  PI-PGM-FORMAT-OPT       PIC X.
  2262             20  PI-PGM-PROCESS-OPT      PIC X.
  2263             20  PI-PGM-TOTALS-OPT       PIC X.
  2264
  2265         16  PI-HELP-INTERFACE.
  2266             20  PI-LAST-ERROR-NO        PIC X(4).
  2267             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2268
  2269         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2270             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2271
  2272         16  PI-CR-CONTROL-IN-PROGRESS.
  2273             20  PI-CR-CARRIER           PIC X.
  2274             20  PI-CR-GROUPING          PIC X(6).
  2275             20  PI-CR-STATE             PIC XX.
  2276             20  PI-CR-ACCOUNT           PIC X(10).
  2277             20  PI-CR-FIN-RESP          PIC X(10).
  2278             20  PI-CR-TYPE              PIC X.
  2279
  2280         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2281
  2282         16  PI-CR-MONTH-END-DT          PIC XX.
  2283
  2284         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2285             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2286             88  PI-ZERO-CARRIER             VALUE '1'.
  2287             88  PI-ZERO-GROUPING            VALUE '2'.
  2288             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2289
  2290         16  PI-CARRIER-SECURITY         PIC X.
  2291             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2292
  2293         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2294             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2295             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  48
* EL156.cbl
  2296
  2297         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2298             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2299                                         INDEXED BY PI-ACCESS-NDX
  2300                                         PIC X.
  2301
  2302         16  PI-GA-BILLING-CONTROL       PIC X.
  2303             88  PI-GA-BILLING               VALUE '1'.
  2304
  2305         16  PI-MAIL-PROCESSING          PIC X.
  2306             88  PI-MAIL-YES                 VALUE 'Y'.
  2307
  2308         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2309
  2310         16  PI-AR-SYSTEM.
  2311             20  PI-AR-PROCESSING-CNTL   PIC X.
  2312                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2313             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2314             20  PI-AR-MONTH-END-DT      PIC XX.
  2315
  2316         16  PI-MP-SYSTEM.
  2317             20  PI-MORTGAGE-USER            PIC X.
  2318                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2319                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2320             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2321                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2322                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2323                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2324                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2325                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2326             20  PI-MP-MONTH-END-DT          PIC XX.
  2327             20  PI-MP-REFERENCE-NO.
  2328                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2329                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2330
  2331         16  PI-LABEL-CONTROL            PIC X(01).
  2332             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2333             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2334
  2335         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2336             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2337
  2338         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2339             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2340             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2341
  2342         16  FILLER                      PIC X(14).
  2343
  2344     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2345******************************************************************
  2346     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2347         16  PI-SAVE-FORM        PIC X(12).
  2348         16  PI-ACCT-KEY         PIC X(26).
  2349         16  PI-PAYEE-NAME       PIC X(30).
  2350         16  PI-DAILY-RATE       PIC S9(3)V99.
  2351         16  PI-MONTH-END-SAVE   PIC XX.
  2352         16  PI-BENEFIT-SAVE.
  2353             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  49
* EL156.cbl
  2354             20  PI-BEN-TYPE     PIC X.
  2355         16  PI-MANUAL-SW        PIC 9.
  2356         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2357         16  PI-PASS-SW          PIC X.
  2358         16  PI-PFKEY-USED       PIC X.
  2359         16  PI-CK-ASSIGN        PIC X.
  2360         16  PI-FATAL-COUNT      PIC 99.
  2361         16  PI-FORCE-COUNT      PIC 99.
  2362         16  PI-SAVE-INPUT.
  2363             20  PI-PMTTYPE      PIC X.
  2364             20  PI-PAYEE.
  2365                 24  PI-PAYEE-TYPE PIC X.
  2366                 24  PI-PAYEE-SEQ  PIC X.
  2367                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2368                   PI-PAYEE-SEQ    PIC S9.
  2369             20  PI-PMTNOTE1     PIC X(60).
  2370             20  PI-PMTNOTE2     PIC X(60).
  2371             20  PI-OFFLINE      PIC X.
  2372             20  PI-ECHECKNO     PIC X(7).
  2373             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2374                 28  PI-ECHECKNO-N     PIC X.
  2375                 28  PI-ECHECKNO-6     PIC X(6).
  2376             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2377                 24  PI-ECHECKNO-CR    PIC XX.
  2378                 24  PI-ECHECKNO-5     PIC X(5).
  2379             20  PI-HOLDTIL      PIC 9(6).
  2380             20  PI-EPYFROM      PIC 9(6).
  2381             20  PI-EPYTHRU      PIC 9(6).
  2382             20  PI-EDAYS        PIC S9(5).
  2383             20  PI-EPYAMT       PIC S9(7)V99.
  2384             20  PI-ERESV        PIC S9(7)V99.
  2385             20  PI-EEXPENS      PIC 9(6)V99.
  2386             20  PI-ETYPE        PIC X.
  2387             20  PI-CASH         PIC X.
  2388             20  PI-GROUPED      PIC X.
  2389             20  PI-INT-RATE     PIC S99V9(5).
  2390             20  PI-AIGFROM      PIC 9(6).
  2391             20  PI-LOAN-NO      PIC X(20).
  2392             20  PI-PROOF-DATE   PIC 9(6).
  2393             20  PI-PRINT-EOB-YN PIC X.
  2394             20  PI-PRINT-CLM-FRM-YN PIC X.
  2395             20  PI-PRINT-SURVEY-YN PIC X.
  2396         16  PI-SAVE-COMPUTED.
  2397             20  PI-CCHECKNO     PIC X(7).
  2398             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2399                 28  PI-CCHECKNO-N     PIC X.
  2400                 28  PI-CCHECKNO-6     PIC X(6).
  2401             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2402                 24  PI-CCHECKNO-CR    PIC XX.
  2403                 24  PI-CCHECKNO-5     PIC X(5).
  2404             20  PI-CPYFROM      PIC XX.
  2405             20  PI-CPYTHRU      PIC XX.
  2406             20  PI-CDAYS        PIC S9(5).
  2407             20  PI-CPYAMT       PIC S9(7)V99.
  2408             20  PI-CRESV        PIC 9(6)V99.
  2409             20  PI-CEXPENS      PIC 9(6)V99.
  2410             20  PI-PMT-APPR-SW  PIC X.
  2411                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  50
* EL156.cbl
  2412                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2413                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2414         16  PI-PREV-CLMNO       PIC X(7).
  2415         16  PI-LF-COVERAGE-TYPE PIC X.
  2416         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2417         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2418         16  PI-PROVISIONAL-IND  PIC X.
  2419             88 PI-PROV-PMT      VALUE 'P'.
  2420         16  PI-PREV-TRLR-KEY    PIC X(22).
  2421         16  PI-SPLIT-PMT-SW     PIC X.
  2422         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2423         16  PI-ACTIVITY-CODE    PIC 99.
  2424         16  PI-RESET-SW         PIC X.
  2425         16  PI-SPECIAL-BEN-SW   PIC X.
  2426             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2427         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2428         16  PI-EXP-DT           PIC XX.
  2429         16  PI-LOAN-DUE-DAY     PIC 99.
  2430         16  PI-3RD-PARTY-SW     PIC X.
  2431         16  PI-LOAN-UPDATE-SW   PIC X.
  2432
  2433         16  PI-DMD-DATA.
  2434             20  PI-SV-CERT-KEY       PIC X(21).
  2435             20  PI-SV-CERT-NO        PIC X(11).
  2436             20  PI-SV-BEN            PIC X(10).
  2437             20  PI-SV-CCN            PIC X(16).
  2438             20  PI-INTEREST-PAID-IND PIC X.
  2439                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2440             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2441             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2442             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2443             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2444         16  PI-AT-EOB-CODES.
  2445             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2446         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2447         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2448         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2449         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2450         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2451         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2452         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2453         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2454         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2455         16  PI-LF-BENEFIT-CD         PIC X(2).
  2456         16  PI-EOB-CODES-EXIST PIC X.
  2457         16  PI-SET-NOTE2-MDT   PIC X.
  2458         16  PI-VFY-2ND-BENE          PIC X.
  2459         16  PI-CLM-TYPE              PIC X.
  2460         16  PI-APPROVAL-LEVEL        PIC X.
  2461*00781          16  FILLER                   PIC X(176).
  2462*052506         16  FILLER                   PIC X(161).
  2463*031808         16  FILLER                   PIC X(154).
  2464*091808         16  FILLER                   PIC X(152).
  2465*041710         16  FILLER                   PIC X(94).
  2466         16  FILLER                   PIC X(91).
  2467
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  51
* EL156.cbl
  2469*    COPY ELCJPFX.
  2470******************************************************************
  2471*                                                                *
  2472*                                                                *
  2473*                            ELCJPFX.                            *
  2474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2475*                            VMOD=2.002                          *
  2476*                                                                *
  2477*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2478*                                                                *
  2479*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2480*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2481*        ELCNTL - CONTROL FILE                                   *
  2482*        ELMSTR - CLAIM MASTERS                                  *
  2483*        ELTRLR - ACTIVITY TRAILERS                              *
  2484*        ELCHKQ - CHECK QUE                                      *
  2485******************************************************************
  2486 01  JOURNAL-RECORD.
  2487     12  JP-USER-ID                  PIC X(4).
  2488     12  JP-FILE-ID                  PIC X(8).
  2489     12  JP-PROGRAM-ID               PIC X(8).
  2490     12  JP-RECORD-TYPE              PIC X.
  2491         88 JP-ADD              VALUE 'A'.
  2492         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2493         88 JP-AFTER-CHANGE     VALUE 'C'.
  2494         88 JP-DELETE           VALUE 'D'.
  2495         88 JP-GENERIC-DELETE   VALUE 'G'.
  2496         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2497         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2498     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2499     12  JP-RECORD-AREA
  2500
  2501
  2502                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  52
* EL156.cbl
  2504*    COPY ELCAID.
  2505******************************************************************
  2506*                                                                *
  2507*                            ELCAID.                             *
  2508*                            VMOD=2.001                          *
  2509*                                                                *
  2510*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2511*                                                                *
  2512*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2513*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2514******************************************************************
  2515
  2516 01  DFHAID.
  2517   02  DFHNULL   PIC  X  VALUE  ' '.
  2518   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2519   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2520   02  DFHPEN    PIC  X  VALUE  '='.
  2521   02  DFHOPID   PIC  X  VALUE  'W'.
  2522   02  DFHPA1    PIC  X  VALUE  '%'.
  2523   02  DFHPA2    PIC  X  VALUE  '>'.
  2524   02  DFHPA3    PIC  X  VALUE  ','.
  2525   02  DFHPF1    PIC  X  VALUE  '1'.
  2526   02  DFHPF2    PIC  X  VALUE  '2'.
  2527   02  DFHPF3    PIC  X  VALUE  '3'.
  2528   02  DFHPF4    PIC  X  VALUE  '4'.
  2529   02  DFHPF5    PIC  X  VALUE  '5'.
  2530   02  DFHPF6    PIC  X  VALUE  '6'.
  2531   02  DFHPF7    PIC  X  VALUE  '7'.
  2532   02  DFHPF8    PIC  X  VALUE  '8'.
  2533   02  DFHPF9    PIC  X  VALUE  '9'.
  2534   02  DFHPF10   PIC  X  VALUE  ':'.
  2535   02  DFHPF11   PIC  X  VALUE  '#'.
  2536   02  DFHPF12   PIC  X  VALUE  '@'.
  2537   02  DFHPF13   PIC  X  VALUE  'A'.
  2538   02  DFHPF14   PIC  X  VALUE  'B'.
  2539   02  DFHPF15   PIC  X  VALUE  'C'.
  2540   02  DFHPF16   PIC  X  VALUE  'D'.
  2541   02  DFHPF17   PIC  X  VALUE  'E'.
  2542   02  DFHPF18   PIC  X  VALUE  'F'.
  2543   02  DFHPF19   PIC  X  VALUE  'G'.
  2544   02  DFHPF20   PIC  X  VALUE  'H'.
  2545   02  DFHPF21   PIC  X  VALUE  'I'.
  2546*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2547   02  DFHPF22   PIC  X  VALUE  '['.
  2548   02  DFHPF23   PIC  X  VALUE  '.'.
  2549   02  DFHPF24   PIC  X  VALUE  '<'.
  2550   02  DFHMSRE   PIC  X  VALUE  'X'.
  2551   02  DFHSTRF   PIC  X  VALUE  'h'.
  2552   02  DFHTRIG   PIC  X  VALUE  '"'.
  2553 01  FILLER    REDEFINES DFHAID.
  2554     12  FILLER              PIC X(8).
  2555     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  53
* EL156.cbl
  2557*    COPY EL156S.
  2558 01  EL156AI.
  2559     05  FILLER            PIC  X(0012).
  2560*    -------------------------------
  2561     05  RUNDTEAL PIC S9(0004) COMP.
  2562     05  RUNDTEAF PIC  X(0001).
  2563     05  FILLER REDEFINES RUNDTEAF.
  2564         10  RUNDTEAA PIC  X(0001).
  2565     05  RUNDTEAI PIC  X(0008).
  2566*    -------------------------------
  2567     05  RUNTIMAL PIC S9(0004) COMP.
  2568     05  RUNTIMAF PIC  X(0001).
  2569     05  FILLER REDEFINES RUNTIMAF.
  2570         10  RUNTIMAA PIC  X(0001).
  2571     05  RUNTIMAI PIC  X(0005).
  2572*    -------------------------------
  2573     05  SEQUL PIC S9(0004) COMP.
  2574     05  SEQUF PIC  X(0001).
  2575     05  FILLER REDEFINES SEQUF.
  2576         10  SEQUA PIC  X(0001).
  2577     05  SEQUI PIC  X(0010).
  2578*    -------------------------------
  2579     05  CLMNOL PIC S9(0004) COMP.
  2580     05  CLMNOF PIC  X(0001).
  2581     05  FILLER REDEFINES CLMNOF.
  2582         10  CLMNOA PIC  X(0001).
  2583     05  CLMNOI PIC  X(0007).
  2584*    -------------------------------
  2585     05  CARRL PIC S9(0004) COMP.
  2586     05  CARRF PIC  X(0001).
  2587     05  FILLER REDEFINES CARRF.
  2588         10  CARRA PIC  X(0001).
  2589     05  CARRI PIC  X(0001).
  2590*    -------------------------------
  2591     05  CERTNOL PIC S9(0004) COMP.
  2592     05  CERTNOF PIC  X(0001).
  2593     05  FILLER REDEFINES CERTNOF.
  2594         10  CERTNOA PIC  X(0001).
  2595     05  CERTNOI PIC  X(0010).
  2596*    -------------------------------
  2597     05  SUFXL PIC S9(0004) COMP.
  2598     05  SUFXF PIC  X(0001).
  2599     05  FILLER REDEFINES SUFXF.
  2600         10  SUFXA PIC  X(0001).
  2601     05  SUFXI PIC  X(0001).
  2602*    -------------------------------
  2603     05  CLMTYPL PIC S9(0004) COMP.
  2604     05  CLMTYPF PIC  X(0001).
  2605     05  FILLER REDEFINES CLMTYPF.
  2606         10  CLMTYPA PIC  X(0001).
  2607     05  CLMTYPI PIC  X(0006).
  2608*    -------------------------------
  2609     05  CLMSTATL PIC S9(0004) COMP.
  2610     05  CLMSTATF PIC  X(0001).
  2611     05  FILLER REDEFINES CLMSTATF.
  2612         10  CLMSTATA PIC  X(0001).
  2613     05  CLMSTATI PIC  X(0006).
  2614*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  54
* EL156.cbl
  2615     05  LSTNMEL PIC S9(0004) COMP.
  2616     05  LSTNMEF PIC  X(0001).
  2617     05  FILLER REDEFINES LSTNMEF.
  2618         10  LSTNMEA PIC  X(0001).
  2619     05  LSTNMEI PIC  X(0015).
  2620*    -------------------------------
  2621     05  FSTNMEL PIC S9(0004) COMP.
  2622     05  FSTNMEF PIC  X(0001).
  2623     05  FILLER REDEFINES FSTNMEF.
  2624         10  FSTNMEA PIC  X(0001).
  2625     05  FSTNMEI PIC  X(0012).
  2626*    -------------------------------
  2627     05  MINITL PIC S9(0004) COMP.
  2628     05  MINITF PIC  X(0001).
  2629     05  FILLER REDEFINES MINITF.
  2630         10  MINITA PIC  X(0001).
  2631     05  MINITI PIC  X(0001).
  2632*    -------------------------------
  2633     05  PRIMHDGL PIC S9(0004) COMP.
  2634     05  PRIMHDGF PIC  X(0001).
  2635     05  FILLER REDEFINES PRIMHDGF.
  2636         10  PRIMHDGA PIC  X(0001).
  2637     05  PRIMHDGI PIC  X(0012).
  2638*    -------------------------------
  2639     05  PCERTNOL PIC S9(0004) COMP.
  2640     05  PCERTNOF PIC  X(0001).
  2641     05  FILLER REDEFINES PCERTNOF.
  2642         10  PCERTNOA PIC  X(0001).
  2643     05  PCERTNOI PIC  X(0010).
  2644*    -------------------------------
  2645     05  PSUFXL PIC S9(0004) COMP.
  2646     05  PSUFXF PIC  X(0001).
  2647     05  FILLER REDEFINES PSUFXF.
  2648         10  PSUFXA PIC  X(0001).
  2649     05  PSUFXI PIC  X(0001).
  2650*    -------------------------------
  2651     05  STATUSL PIC S9(0004) COMP.
  2652     05  STATUSF PIC  X(0001).
  2653     05  FILLER REDEFINES STATUSF.
  2654         10  STATUSA PIC  X(0001).
  2655     05  STATUSI PIC  X(0010).
  2656*    -------------------------------
  2657     05  LOANHL PIC S9(0004) COMP.
  2658     05  LOANHF PIC  X(0001).
  2659     05  FILLER REDEFINES LOANHF.
  2660         10  LOANHA PIC  X(0001).
  2661     05  LOANHI PIC  X(0014).
  2662*    -------------------------------
  2663     05  LOANNOL PIC S9(0004) COMP.
  2664     05  LOANNOF PIC  X(0001).
  2665     05  FILLER REDEFINES LOANNOF.
  2666         10  LOANNOA PIC  X(0001).
  2667     05  LOANNOI PIC  X(0025).
  2668*    -------------------------------
  2669     05  DUEDAYHL PIC S9(0004) COMP.
  2670     05  DUEDAYHF PIC  X(0001).
  2671     05  FILLER REDEFINES DUEDAYHF.
  2672         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  55
* EL156.cbl
  2673     05  DUEDAYHI PIC  X(0008).
  2674*    -------------------------------
  2675     05  DUEDAYL PIC S9(0004) COMP.
  2676     05  DUEDAYF PIC  X(0001).
  2677     05  FILLER REDEFINES DUEDAYF.
  2678         10  DUEDAYA PIC  X(0001).
  2679     05  DUEDAYI PIC  X(0002).
  2680*    -------------------------------
  2681     05  ZINTHL PIC S9(0004) COMP.
  2682     05  ZINTHF PIC  X(0001).
  2683     05  FILLER REDEFINES ZINTHF.
  2684         10  ZINTHA PIC  X(0001).
  2685     05  ZINTHI PIC  X(0009).
  2686*    -------------------------------
  2687     05  ZINTL PIC S9(0004) COMP.
  2688     05  ZINTF PIC  X(0001).
  2689     05  FILLER REDEFINES ZINTF.
  2690         10  ZINTA PIC  X(0001).
  2691     05  ZINTI PIC  99V99999.
  2692*    -------------------------------
  2693     05  PTHRHDGL PIC S9(0004) COMP.
  2694     05  PTHRHDGF PIC  X(0001).
  2695     05  FILLER REDEFINES PTHRHDGF.
  2696         10  PTHRHDGA PIC  X(0001).
  2697     05  PTHRHDGI PIC  X(0014).
  2698*    -------------------------------
  2699     05  PDTHRUL PIC S9(0004) COMP.
  2700     05  PDTHRUF PIC  X(0001).
  2701     05  FILLER REDEFINES PDTHRUF.
  2702         10  PDTHRUA PIC  X(0001).
  2703     05  PDTHRUI PIC  X(0008).
  2704*    -------------------------------
  2705     05  TOTPAIDL PIC S9(0004) COMP.
  2706     05  TOTPAIDF PIC  X(0001).
  2707     05  FILLER REDEFINES TOTPAIDF.
  2708         10  TOTPAIDA PIC  X(0001).
  2709     05  TOTPAIDI PIC  X(0010).
  2710*    -------------------------------
  2711     05  COVERL PIC S9(0004) COMP.
  2712     05  COVERF PIC  X(0001).
  2713     05  FILLER REDEFINES COVERF.
  2714         10  COVERA PIC  X(0001).
  2715     05  COVERI PIC  X(0010).
  2716*    -------------------------------
  2717     05  INCURL PIC S9(0004) COMP.
  2718     05  INCURF PIC  X(0001).
  2719     05  FILLER REDEFINES INCURF.
  2720         10  INCURA PIC  X(0001).
  2721     05  INCURI PIC  X(0008).
  2722*    -------------------------------
  2723     05  LSTDTEL PIC S9(0004) COMP.
  2724     05  LSTDTEF PIC  X(0001).
  2725     05  FILLER REDEFINES LSTDTEF.
  2726         10  LSTDTEA PIC  X(0001).
  2727     05  LSTDTEI PIC  X(0008).
  2728*    -------------------------------
  2729     05  CRTSTATL PIC S9(0004) COMP.
  2730     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  56
* EL156.cbl
  2731     05  FILLER REDEFINES CRTSTATF.
  2732         10  CRTSTATA PIC  X(0001).
  2733     05  CRTSTATI PIC  X(0010).
  2734*    -------------------------------
  2735     05  EFFECTL PIC S9(0004) COMP.
  2736     05  EFFECTF PIC  X(0001).
  2737     05  FILLER REDEFINES EFFECTF.
  2738         10  EFFECTA PIC  X(0001).
  2739     05  EFFECTI PIC  X(0008).
  2740*    -------------------------------
  2741     05  TERMSL PIC S9(0004) COMP.
  2742     05  TERMSF PIC  X(0001).
  2743     05  FILLER REDEFINES TERMSF.
  2744         10  TERMSA PIC  X(0001).
  2745     05  TERMSI PIC  X(0011).
  2746*    -------------------------------
  2747     05  STACCTL PIC S9(0004) COMP.
  2748     05  STACCTF PIC  X(0001).
  2749     05  FILLER REDEFINES STACCTF.
  2750         10  STACCTA PIC  X(0001).
  2751     05  STACCTI PIC  X(0013).
  2752*    -------------------------------
  2753     05  EXPDTEHL PIC S9(0004) COMP.
  2754     05  EXPDTEHF PIC  X(0001).
  2755     05  FILLER REDEFINES EXPDTEHF.
  2756         10  EXPDTEHA PIC  X(0001).
  2757     05  EXPDTEHI PIC  X(0014).
  2758*    -------------------------------
  2759     05  EXPDTEL PIC S9(0004) COMP.
  2760     05  EXPDTEF PIC  X(0001).
  2761     05  FILLER REDEFINES EXPDTEF.
  2762         10  EXPDTEA PIC  X(0001).
  2763     05  EXPDTEI PIC  X(0008).
  2764*    -------------------------------
  2765     05  BENECAPL PIC S9(0004) COMP.
  2766     05  BENECAPF PIC  X(0001).
  2767     05  FILLER REDEFINES BENECAPF.
  2768         10  BENECAPA PIC  X(0001).
  2769     05  BENECAPI PIC  X(0013).
  2770*    -------------------------------
  2771     05  BENEL PIC S9(0004) COMP.
  2772     05  BENEF PIC  X(0001).
  2773     05  FILLER REDEFINES BENEF.
  2774         10  BENEA PIC  X(0001).
  2775     05  BENEI PIC  X(0009).
  2776*    -------------------------------
  2777     05  FORMTYPL PIC S9(0004) COMP.
  2778     05  FORMTYPF PIC  X(0001).
  2779     05  FILLER REDEFINES FORMTYPF.
  2780         10  FORMTYPA PIC  X(0001).
  2781     05  FORMTYPI PIC  X(0001).
  2782*    -------------------------------
  2783     05  PMTTYPEL PIC S9(0004) COMP.
  2784     05  PMTTYPEF PIC  X(0001).
  2785     05  FILLER REDEFINES PMTTYPEF.
  2786         10  PMTTYPEA PIC  X(0001).
  2787     05  PMTTYPEI PIC  X(0001).
  2788*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  57
* EL156.cbl
  2789     05  PAYEEL PIC S9(0004) COMP.
  2790     05  PAYEEF PIC  X(0001).
  2791     05  FILLER REDEFINES PAYEEF.
  2792         10  PAYEEA PIC  X(0001).
  2793     05  PAYEEI PIC  X(0002).
  2794*    -------------------------------
  2795     05  CHECKNOL PIC S9(0004) COMP.
  2796     05  CHECKNOF PIC  X(0001).
  2797     05  FILLER REDEFINES CHECKNOF.
  2798         10  CHECKNOA PIC  X(0001).
  2799     05  CHECKNOI PIC  X(0007).
  2800*    -------------------------------
  2801     05  OFFLINEL PIC S9(0004) COMP.
  2802     05  OFFLINEF PIC  X(0001).
  2803     05  FILLER REDEFINES OFFLINEF.
  2804         10  OFFLINEA PIC  X(0001).
  2805     05  OFFLINEI PIC  X(0001).
  2806*    -------------------------------
  2807     05  HOLDTILL PIC S9(0004) COMP.
  2808     05  HOLDTILF PIC  X(0001).
  2809     05  FILLER REDEFINES HOLDTILF.
  2810         10  HOLDTILA PIC  X(0001).
  2811     05  HOLDTILI PIC  X(0008).
  2812*    -------------------------------
  2813     05  NOTE1L PIC S9(0004) COMP.
  2814     05  NOTE1F PIC  X(0001).
  2815     05  FILLER REDEFINES NOTE1F.
  2816         10  NOTE1A PIC  X(0001).
  2817     05  NOTE1I PIC  X(0060).
  2818*    -------------------------------
  2819     05  NOTE2L PIC S9(0004) COMP.
  2820     05  NOTE2F PIC  X(0001).
  2821     05  FILLER REDEFINES NOTE2F.
  2822         10  NOTE2A PIC  X(0001).
  2823     05  NOTE2I PIC  X(0060).
  2824*    -------------------------------
  2825     05  EOBYNL PIC S9(0004) COMP.
  2826     05  EOBYNF PIC  X(0001).
  2827     05  FILLER REDEFINES EOBYNF.
  2828         10  EOBYNA PIC  X(0001).
  2829     05  EOBYNI PIC  X(0001).
  2830*    -------------------------------
  2831     05  CLMFMYNL PIC S9(0004) COMP.
  2832     05  CLMFMYNF PIC  X(0001).
  2833     05  FILLER REDEFINES CLMFMYNF.
  2834         10  CLMFMYNA PIC  X(0001).
  2835     05  CLMFMYNI PIC  X(0001).
  2836*    -------------------------------
  2837     05  SURVYYNL PIC S9(0004) COMP.
  2838     05  SURVYYNF PIC  X(0001).
  2839     05  FILLER REDEFINES SURVYYNF.
  2840         10  SURVYYNA PIC  X(0001).
  2841     05  SURVYYNI PIC  X(0001).
  2842*    -------------------------------
  2843     05  PINTHL PIC S9(0004) COMP.
  2844     05  PINTHF PIC  X(0001).
  2845     05  FILLER REDEFINES PINTHF.
  2846         10  PINTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  58
* EL156.cbl
  2847     05  PINTHI PIC  X(0004).
  2848*    -------------------------------
  2849     05  PINTL PIC S9(0004) COMP.
  2850     05  PINTF PIC  X(0001).
  2851     05  FILLER REDEFINES PINTF.
  2852         10  PINTA PIC  X(0001).
  2853     05  PINTI PIC  X(0008).
  2854*    -------------------------------
  2855     05  PROOFDTL PIC S9(0004) COMP.
  2856     05  PROOFDTF PIC  X(0001).
  2857     05  FILLER REDEFINES PROOFDTF.
  2858         10  PROOFDTA PIC  X(0001).
  2859     05  PROOFDTI PIC  X(0008).
  2860*    -------------------------------
  2861     05  AIGFRMHL PIC S9(0004) COMP.
  2862     05  AIGFRMHF PIC  X(0001).
  2863     05  FILLER REDEFINES AIGFRMHF.
  2864         10  AIGFRMHA PIC  X(0001).
  2865     05  AIGFRMHI PIC  X(0012).
  2866*    -------------------------------
  2867     05  AIGFROML PIC S9(0004) COMP.
  2868     05  AIGFROMF PIC  X(0001).
  2869     05  FILLER REDEFINES AIGFROMF.
  2870         10  AIGFROMA PIC  X(0001).
  2871     05  AIGFROMI PIC  X(0008).
  2872*    -------------------------------
  2873     05  PMTHDGAL PIC S9(0004) COMP.
  2874     05  PMTHDGAF PIC  X(0001).
  2875     05  FILLER REDEFINES PMTHDGAF.
  2876         10  PMTHDGAA PIC  X(0001).
  2877     05  PMTHDGAI PIC  X(0066).
  2878*    -------------------------------
  2879     05  EPYFROML PIC S9(0004) COMP.
  2880     05  EPYFROMF PIC  X(0001).
  2881     05  FILLER REDEFINES EPYFROMF.
  2882         10  EPYFROMA PIC  X(0001).
  2883     05  EPYFROMI PIC  X(0008).
  2884*    -------------------------------
  2885     05  EPYTHRUL PIC S9(0004) COMP.
  2886     05  EPYTHRUF PIC  X(0001).
  2887     05  FILLER REDEFINES EPYTHRUF.
  2888         10  EPYTHRUA PIC  X(0001).
  2889     05  EPYTHRUI PIC  X(0008).
  2890*    -------------------------------
  2891     05  EDAYSL PIC S9(0004) COMP.
  2892     05  EDAYSF PIC  X(0001).
  2893     05  FILLER REDEFINES EDAYSF.
  2894         10  EDAYSA PIC  X(0001).
  2895     05  EDAYSI PIC  S9(6).
  2896*    -------------------------------
  2897     05  EPYAMTL PIC S9(0004) COMP.
  2898     05  EPYAMTF PIC  X(0001).
  2899     05  FILLER REDEFINES EPYAMTF.
  2900         10  EPYAMTA PIC  X(0001).
  2901     05  EPYAMTI PIC  S9(8)V99.
  2902*    -------------------------------
  2903     05  ERESVL PIC S9(0004) COMP.
  2904     05  ERESVF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  59
* EL156.cbl
  2905     05  FILLER REDEFINES ERESVF.
  2906         10  ERESVA PIC  X(0001).
  2907     05  ERESVI PIC  S9(7)V99.
  2908*    -------------------------------
  2909     05  ETYPEL PIC S9(0004) COMP.
  2910     05  ETYPEF PIC  X(0001).
  2911     05  FILLER REDEFINES ETYPEF.
  2912         10  ETYPEA PIC  X(0001).
  2913     05  ETYPEI PIC  X(0001).
  2914*    -------------------------------
  2915     05  EEXPENSL PIC S9(0004) COMP.
  2916     05  EEXPENSF PIC  X(0001).
  2917     05  FILLER REDEFINES EEXPENSF.
  2918         10  EEXPENSA PIC  X(0001).
  2919     05  EEXPENSI PIC  9(6)V99.
  2920*    -------------------------------
  2921     05  CPYFROML PIC S9(0004) COMP.
  2922     05  CPYFROMF PIC  X(0001).
  2923     05  FILLER REDEFINES CPYFROMF.
  2924         10  CPYFROMA PIC  X(0001).
  2925     05  CPYFROMI PIC  X(0008).
  2926*    -------------------------------
  2927     05  CPYTHRUL PIC S9(0004) COMP.
  2928     05  CPYTHRUF PIC  X(0001).
  2929     05  FILLER REDEFINES CPYTHRUF.
  2930         10  CPYTHRUA PIC  X(0001).
  2931     05  CPYTHRUI PIC  X(0008).
  2932*    -------------------------------
  2933     05  CDAYSL PIC S9(0004) COMP.
  2934     05  CDAYSF PIC  X(0001).
  2935     05  FILLER REDEFINES CDAYSF.
  2936         10  CDAYSA PIC  X(0001).
  2937     05  CDAYSI PIC  9(6).
  2938*    -------------------------------
  2939     05  CPYAMTL PIC S9(0004) COMP.
  2940     05  CPYAMTF PIC  X(0001).
  2941     05  FILLER REDEFINES CPYAMTF.
  2942         10  CPYAMTA PIC  X(0001).
  2943     05  CPYAMTI PIC  S9(8)V99.
  2944*    -------------------------------
  2945     05  CRESVL PIC S9(0004) COMP.
  2946     05  CRESVF PIC  X(0001).
  2947     05  FILLER REDEFINES CRESVF.
  2948         10  CRESVA PIC  X(0001).
  2949     05  CRESVI PIC  9(6)V99.
  2950*    -------------------------------
  2951     05  CEXPENSL PIC S9(0004) COMP.
  2952     05  CEXPENSF PIC  X(0001).
  2953     05  FILLER REDEFINES CEXPENSF.
  2954         10  CEXPENSA PIC  X(0001).
  2955     05  CEXPENSI PIC  9(6)V99.
  2956*    -------------------------------
  2957     05  ERRMSG0L PIC S9(0004) COMP.
  2958     05  ERRMSG0F PIC  X(0001).
  2959     05  FILLER REDEFINES ERRMSG0F.
  2960         10  ERRMSG0A PIC  X(0001).
  2961     05  ERRMSG0I PIC  X(0072).
  2962*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  60
* EL156.cbl
  2963     05  ERRMSG1L PIC S9(0004) COMP.
  2964     05  ERRMSG1F PIC  X(0001).
  2965     05  FILLER REDEFINES ERRMSG1F.
  2966         10  ERRMSG1A PIC  X(0001).
  2967     05  ERRMSG1I PIC  X(0072).
  2968*    -------------------------------
  2969     05  ERRMSG2L PIC S9(0004) COMP.
  2970     05  ERRMSG2F PIC  X(0001).
  2971     05  FILLER REDEFINES ERRMSG2F.
  2972         10  ERRMSG2A PIC  X(0001).
  2973     05  ERRMSG2I PIC  X(0072).
  2974*    -------------------------------
  2975     05  ENTERPFL PIC S9(0004) COMP.
  2976     05  ENTERPFF PIC  X(0001).
  2977     05  FILLER REDEFINES ENTERPFF.
  2978         10  ENTERPFA PIC  X(0001).
  2979     05  ENTERPFI PIC  99.
  2980*    -------------------------------
  2981     05  PF6TITL PIC S9(0004) COMP.
  2982     05  PF6TITF PIC  X(0001).
  2983     05  FILLER REDEFINES PF6TITF.
  2984         10  PF6TITA PIC  X(0001).
  2985     05  PF6TITI PIC  X(0016).
  2986 01  EL156AO REDEFINES EL156AI.
  2987     05  FILLER            PIC  X(0012).
  2988*    -------------------------------
  2989     05  FILLER            PIC  X(0003).
  2990     05  RUNDTEAO PIC  X(0008).
  2991*    -------------------------------
  2992     05  FILLER            PIC  X(0003).
  2993     05  RUNTIMAO PIC  99.99.
  2994*    -------------------------------
  2995     05  FILLER            PIC  X(0003).
  2996     05  SEQUO PIC  X(0010).
  2997*    -------------------------------
  2998     05  FILLER            PIC  X(0003).
  2999     05  CLMNOO PIC  X(0007).
  3000*    -------------------------------
  3001     05  FILLER            PIC  X(0003).
  3002     05  CARRO PIC  X(0001).
  3003*    -------------------------------
  3004     05  FILLER            PIC  X(0003).
  3005     05  CERTNOO PIC  X(0010).
  3006*    -------------------------------
  3007     05  FILLER            PIC  X(0003).
  3008     05  SUFXO PIC  X(0001).
  3009*    -------------------------------
  3010     05  FILLER            PIC  X(0003).
  3011     05  CLMTYPO PIC  X(0006).
  3012*    -------------------------------
  3013     05  FILLER            PIC  X(0003).
  3014     05  CLMSTATO PIC  X(0006).
  3015*    -------------------------------
  3016     05  FILLER            PIC  X(0003).
  3017     05  LSTNMEO PIC  X(0015).
  3018*    -------------------------------
  3019     05  FILLER            PIC  X(0003).
  3020     05  FSTNMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  61
* EL156.cbl
  3021*    -------------------------------
  3022     05  FILLER            PIC  X(0003).
  3023     05  MINITO PIC  X(0001).
  3024*    -------------------------------
  3025     05  FILLER            PIC  X(0003).
  3026     05  PRIMHDGO PIC  X(0012).
  3027*    -------------------------------
  3028     05  FILLER            PIC  X(0003).
  3029     05  PCERTNOO PIC  X(0010).
  3030*    -------------------------------
  3031     05  FILLER            PIC  X(0003).
  3032     05  PSUFXO PIC  X(0001).
  3033*    -------------------------------
  3034     05  FILLER            PIC  X(0003).
  3035     05  STATUSO PIC  X(0010).
  3036*    -------------------------------
  3037     05  FILLER            PIC  X(0003).
  3038     05  LOANHO PIC  X(0014).
  3039*    -------------------------------
  3040     05  FILLER            PIC  X(0003).
  3041     05  LOANNOO PIC  X(0025).
  3042*    -------------------------------
  3043     05  FILLER            PIC  X(0003).
  3044     05  DUEDAYHO PIC  X(0008).
  3045*    -------------------------------
  3046     05  FILLER            PIC  X(0003).
  3047     05  DUEDAYO PIC  X(0002).
  3048*    -------------------------------
  3049     05  FILLER            PIC  X(0003).
  3050     05  ZINTHO PIC  X(0009).
  3051*    -------------------------------
  3052     05  FILLER            PIC  X(0003).
  3053     05  ZINTO PIC  9.99999.
  3054*    -------------------------------
  3055     05  FILLER            PIC  X(0003).
  3056     05  PTHRHDGO PIC  X(0014).
  3057*    -------------------------------
  3058     05  FILLER            PIC  X(0003).
  3059     05  PDTHRUO PIC  X(0008).
  3060*    -------------------------------
  3061     05  FILLER            PIC  X(0003).
  3062     05  TOTPAIDO PIC  Z(6).99-.
  3063*    -------------------------------
  3064     05  FILLER            PIC  X(0003).
  3065     05  COVERO PIC  X(0010).
  3066*    -------------------------------
  3067     05  FILLER            PIC  X(0003).
  3068     05  INCURO PIC  X(0008).
  3069*    -------------------------------
  3070     05  FILLER            PIC  X(0003).
  3071     05  LSTDTEO PIC  X(0008).
  3072*    -------------------------------
  3073     05  FILLER            PIC  X(0003).
  3074     05  CRTSTATO PIC  X(0010).
  3075*    -------------------------------
  3076     05  FILLER            PIC  X(0003).
  3077     05  EFFECTO PIC  X(0008).
  3078*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  62
* EL156.cbl
  3079     05  FILLER            PIC  X(0003).
  3080     05  TERMSO PIC  X(0011).
  3081*    -------------------------------
  3082     05  FILLER            PIC  X(0003).
  3083     05  STACCTO PIC  X(0013).
  3084*    -------------------------------
  3085     05  FILLER            PIC  X(0003).
  3086     05  EXPDTEHO PIC  X(0014).
  3087*    -------------------------------
  3088     05  FILLER            PIC  X(0003).
  3089     05  EXPDTEO PIC  X(0008).
  3090*    -------------------------------
  3091     05  FILLER            PIC  X(0003).
  3092     05  BENECAPO PIC  X(0013).
  3093*    -------------------------------
  3094     05  FILLER            PIC  X(0003).
  3095     05  BENEO PIC  Z(6).99.
  3096*    -------------------------------
  3097     05  FILLER            PIC  X(0003).
  3098     05  FORMTYPO PIC  X(0001).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  PMTTYPEO PIC  X(0001).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  PAYEEO PIC  X(0002).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  CHECKNOO PIC  X(0007).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  OFFLINEO PIC  X(0001).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  HOLDTILO PIC  99B99B99.
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  NOTE1O PIC  X(0060).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  NOTE2O PIC  X(0060).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  EOBYNO PIC  X(0001).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  CLMFMYNO PIC  X(0001).
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  SURVYYNO PIC  X(0001).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  PINTHO PIC  X(0004).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  PINTO PIC  Z,ZZ9.99.
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  63
* EL156.cbl
  3137     05  PROOFDTO PIC  99B99B99.
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  AIGFRMHO PIC  X(0012).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  AIGFROMO PIC  99B99B99.
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  PMTHDGAO PIC  X(0066).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  EPYFROMO PIC  99B99B99.
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  EPYTHRUO PIC  99B99B99.
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  EDAYSO PIC  Z(4)9-.
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  EPYAMTO PIC  Z(6).99-.
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  ERESVO PIC  Z(5).99-.
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  ETYPEO PIC  X(0001).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  EEXPENSO PIC  Z(5).99.
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  CPYFROMO PIC  99B99B99.
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  CPYTHRUO PIC  99B99B99.
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  CDAYSO PIC  Z(4)9-.
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  CPYAMTO PIC  Z(6).99-.
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  CRESVO PIC  Z(5).99.
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  CEXPENSO PIC  Z(5).99.
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  ERRMSG0O PIC  X(0072).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  ERRMSG1O PIC  X(0072).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  ERRMSG2O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  64
* EL156.cbl
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  ENTERPFO PIC  X(0002).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  PF6TITO PIC  X(0016).
  3201*    -------------------------------
  3202 01  EL156BI REDEFINES EL156AI.
  3203     05  FILLER            PIC  X(0012).
  3204*    -------------------------------
  3205     05  RUNDTEBL PIC S9(0004) COMP.
  3206     05  RUNDTEBF PIC  X(0001).
  3207     05  FILLER REDEFINES RUNDTEBF.
  3208         10  RUNDTEBA PIC  X(0001).
  3209     05  RUNDTEBI PIC  X(0008).
  3210*    -------------------------------
  3211     05  RUNTIMBL PIC S9(0004) COMP.
  3212     05  RUNTIMBF PIC  X(0001).
  3213     05  FILLER REDEFINES RUNTIMBF.
  3214         10  RUNTIMBA PIC  X(0001).
  3215     05  RUNTIMBI PIC  X(0005).
  3216*    -------------------------------
  3217     05  PAYDTBL PIC S9(0004) COMP.
  3218     05  PAYDTBF PIC  X(0001).
  3219     05  FILLER REDEFINES PAYDTBF.
  3220         10  PAYDTBA PIC  X(0001).
  3221     05  PAYDTBI PIC  X(0008).
  3222*    -------------------------------
  3223     05  PAYTYPBL PIC S9(0004) COMP.
  3224     05  PAYTYPBF PIC  X(0001).
  3225     05  FILLER REDEFINES PAYTYPBF.
  3226         10  PAYTYPBA PIC  X(0001).
  3227     05  PAYTYPBI PIC  X(0015).
  3228*    -------------------------------
  3229     05  PAYAMTBL PIC S9(0004) COMP.
  3230     05  PAYAMTBF PIC  X(0001).
  3231     05  FILLER REDEFINES PAYAMTBF.
  3232         10  PAYAMTBA PIC  X(0001).
  3233     05  PAYAMTBI PIC  X(0011).
  3234*    -------------------------------
  3235     05  LOANHBL PIC S9(0004) COMP.
  3236     05  LOANHBF PIC  X(0001).
  3237     05  FILLER REDEFINES LOANHBF.
  3238         10  LOANHBA PIC  X(0001).
  3239     05  LOANHBI PIC  X(0012).
  3240*    -------------------------------
  3241     05  LOANNBL PIC S9(0004) COMP.
  3242     05  LOANNBF PIC  X(0001).
  3243     05  FILLER REDEFINES LOANNBF.
  3244         10  LOANNBA PIC  X(0001).
  3245     05  LOANNBI PIC  X(0025).
  3246*    -------------------------------
  3247     05  CKNUMHDL PIC S9(0004) COMP.
  3248     05  CKNUMHDF PIC  X(0001).
  3249     05  FILLER REDEFINES CKNUMHDF.
  3250         10  CKNUMHDA PIC  X(0001).
  3251     05  CKNUMHDI PIC  X(0012).
  3252*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  65
* EL156.cbl
  3253     05  CKNUMBL PIC S9(0004) COMP.
  3254     05  CKNUMBF PIC  X(0001).
  3255     05  FILLER REDEFINES CKNUMBF.
  3256         10  CKNUMBA PIC  X(0001).
  3257     05  CKNUMBI PIC  X(0007).
  3258*    -------------------------------
  3259     05  AGTHDGL PIC S9(0004) COMP.
  3260     05  AGTHDGF PIC  X(0001).
  3261     05  FILLER REDEFINES AGTHDGF.
  3262         10  AGTHDGA PIC  X(0001).
  3263     05  AGTHDGI PIC  X(0016).
  3264*    -------------------------------
  3265     05  NAMEBL PIC S9(0004) COMP.
  3266     05  NAMEBF PIC  X(0001).
  3267     05  FILLER REDEFINES NAMEBF.
  3268         10  NAMEBA PIC  X(0001).
  3269     05  NAMEBI PIC  X(0030).
  3270*    -------------------------------
  3271     05  NAMEB2L PIC S9(0004) COMP.
  3272     05  NAMEB2F PIC  X(0001).
  3273     05  FILLER REDEFINES NAMEB2F.
  3274         10  NAMEB2A PIC  X(0001).
  3275     05  NAMEB2I PIC  X(0030).
  3276*    -------------------------------
  3277     05  ADDR1BL PIC S9(0004) COMP.
  3278     05  ADDR1BF PIC  X(0001).
  3279     05  FILLER REDEFINES ADDR1BF.
  3280         10  ADDR1BA PIC  X(0001).
  3281     05  ADDR1BI PIC  X(0030).
  3282*    -------------------------------
  3283     05  ADDR1B2L PIC S9(0004) COMP.
  3284     05  ADDR1B2F PIC  X(0001).
  3285     05  FILLER REDEFINES ADDR1B2F.
  3286         10  ADDR1B2A PIC  X(0001).
  3287     05  ADDR1B2I PIC  X(0030).
  3288*    -------------------------------
  3289     05  ADDR2BL PIC S9(0004) COMP.
  3290     05  ADDR2BF PIC  X(0001).
  3291     05  FILLER REDEFINES ADDR2BF.
  3292         10  ADDR2BA PIC  X(0001).
  3293     05  ADDR2BI PIC  X(0030).
  3294*    -------------------------------
  3295     05  ADDR2B2L PIC S9(0004) COMP.
  3296     05  ADDR2B2F PIC  X(0001).
  3297     05  FILLER REDEFINES ADDR2B2F.
  3298         10  ADDR2B2A PIC  X(0001).
  3299     05  ADDR2B2I PIC  X(0030).
  3300*    -------------------------------
  3301     05  CITYSTBL PIC S9(0004) COMP.
  3302     05  CITYSTBF PIC  X(0001).
  3303     05  FILLER REDEFINES CITYSTBF.
  3304         10  CITYSTBA PIC  X(0001).
  3305     05  CITYSTBI PIC  X(0030).
  3306*    -------------------------------
  3307     05  CITYST2L PIC S9(0004) COMP.
  3308     05  CITYST2F PIC  X(0001).
  3309     05  FILLER REDEFINES CITYST2F.
  3310         10  CITYST2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  66
* EL156.cbl
  3311     05  CITYST2I PIC  X(0030).
  3312*    -------------------------------
  3313     05  ZIPBL PIC S9(0004) COMP.
  3314     05  ZIPBF PIC  X(0001).
  3315     05  FILLER REDEFINES ZIPBF.
  3316         10  ZIPBA PIC  X(0001).
  3317     05  ZIPBI PIC  X(0009).
  3318*    -------------------------------
  3319     05  ZIPB2L PIC S9(0004) COMP.
  3320     05  ZIPB2F PIC  X(0001).
  3321     05  FILLER REDEFINES ZIPB2F.
  3322         10  ZIPB2A PIC  X(0001).
  3323     05  ZIPB2I PIC  X(0009).
  3324*    -------------------------------
  3325     05  INTHDBL PIC S9(0004) COMP.
  3326     05  INTHDBF PIC  X(0001).
  3327     05  FILLER REDEFINES INTHDBF.
  3328         10  INTHDBA PIC  X(0001).
  3329     05  INTHDBI PIC  X(0012).
  3330*    -------------------------------
  3331     05  INTAMTBL PIC S9(0004) COMP.
  3332     05  INTAMTBF PIC  X(0001).
  3333     05  FILLER REDEFINES INTAMTBF.
  3334         10  INTAMTBA PIC  X(0001).
  3335     05  INTAMTBI PIC  X(0011).
  3336*    -------------------------------
  3337     05  PMTHDGBL PIC S9(0004) COMP.
  3338     05  PMTHDGBF PIC  X(0001).
  3339     05  FILLER REDEFINES PMTHDGBF.
  3340         10  PMTHDGBA PIC  X(0001).
  3341     05  PMTHDGBI PIC  X(0034).
  3342*    -------------------------------
  3343     05  CLMNOBL PIC S9(0004) COMP.
  3344     05  CLMNOBF PIC  X(0001).
  3345     05  FILLER REDEFINES CLMNOBF.
  3346         10  CLMNOBA PIC  X(0001).
  3347     05  CLMNOBI PIC  X(0007).
  3348*    -------------------------------
  3349     05  CARRBL PIC S9(0004) COMP.
  3350     05  CARRBF PIC  X(0001).
  3351     05  FILLER REDEFINES CARRBF.
  3352         10  CARRBA PIC  X(0001).
  3353     05  CARRBI PIC  X(0001).
  3354*    -------------------------------
  3355     05  CERTNOBL PIC S9(0004) COMP.
  3356     05  CERTNOBF PIC  X(0001).
  3357     05  FILLER REDEFINES CERTNOBF.
  3358         10  CERTNOBA PIC  X(0001).
  3359     05  CERTNOBI PIC  X(0010).
  3360*    -------------------------------
  3361     05  SUFXBL PIC S9(0004) COMP.
  3362     05  SUFXBF PIC  X(0001).
  3363     05  FILLER REDEFINES SUFXBF.
  3364         10  SUFXBA PIC  X(0001).
  3365     05  SUFXBI PIC  X(0001).
  3366*    -------------------------------
  3367     05  CLMTYPBL PIC S9(0004) COMP.
  3368     05  CLMTYPBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  67
* EL156.cbl
  3369     05  FILLER REDEFINES CLMTYPBF.
  3370         10  CLMTYPBA PIC  X(0001).
  3371     05  CLMTYPBI PIC  X(0006).
  3372*    -------------------------------
  3373     05  INCURBL PIC S9(0004) COMP.
  3374     05  INCURBF PIC  X(0001).
  3375     05  FILLER REDEFINES INCURBF.
  3376         10  INCURBA PIC  X(0001).
  3377     05  INCURBI PIC  X(0008).
  3378*    -------------------------------
  3379     05  PYFROMBL PIC S9(0004) COMP.
  3380     05  PYFROMBF PIC  X(0001).
  3381     05  FILLER REDEFINES PYFROMBF.
  3382         10  PYFROMBA PIC  X(0001).
  3383     05  PYFROMBI PIC  X(0008).
  3384*    -------------------------------
  3385     05  PYTHRUBL PIC S9(0004) COMP.
  3386     05  PYTHRUBF PIC  X(0001).
  3387     05  FILLER REDEFINES PYTHRUBF.
  3388         10  PYTHRUBA PIC  X(0001).
  3389     05  PYTHRUBI PIC  X(0008).
  3390*    -------------------------------
  3391     05  DAYSBL PIC S9(0004) COMP.
  3392     05  DAYSBF PIC  X(0001).
  3393     05  FILLER REDEFINES DAYSBF.
  3394         10  DAYSBA PIC  X(0001).
  3395     05  DAYSBI PIC  X(0005).
  3396*    -------------------------------
  3397     05  BYBL PIC S9(0004) COMP.
  3398     05  BYBF PIC  X(0001).
  3399     05  FILLER REDEFINES BYBF.
  3400         10  BYBA PIC  X(0001).
  3401     05  BYBI PIC  X(0004).
  3402*    -------------------------------
  3403     05  PROOFDBL PIC S9(0004) COMP.
  3404     05  PROOFDBF PIC  X(0001).
  3405     05  FILLER REDEFINES PROOFDBF.
  3406         10  PROOFDBA PIC  X(0001).
  3407     05  PROOFDBI PIC  X(0008).
  3408*    -------------------------------
  3409     05  ACCTBL PIC S9(0004) COMP.
  3410     05  ACCTBF PIC  X(0001).
  3411     05  FILLER REDEFINES ACCTBF.
  3412         10  ACCTBA PIC  X(0001).
  3413     05  ACCTBI PIC  X(0010).
  3414*    -------------------------------
  3415     05  STATEBL PIC S9(0004) COMP.
  3416     05  STATEBF PIC  X(0001).
  3417     05  FILLER REDEFINES STATEBF.
  3418         10  STATEBA PIC  X(0001).
  3419     05  STATEBI PIC  X(0002).
  3420*    -------------------------------
  3421     05  GROUPBL PIC S9(0004) COMP.
  3422     05  GROUPBF PIC  X(0001).
  3423     05  FILLER REDEFINES GROUPBF.
  3424         10  GROUPBA PIC  X(0001).
  3425     05  GROUPBI PIC  X(0006).
  3426*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  68
* EL156.cbl
  3427     05  ACARRBL PIC S9(0004) COMP.
  3428     05  ACARRBF PIC  X(0001).
  3429     05  FILLER REDEFINES ACARRBF.
  3430         10  ACARRBA PIC  X(0001).
  3431     05  ACARRBI PIC  X(0001).
  3432*    -------------------------------
  3433     05  ACCTNMBL PIC S9(0004) COMP.
  3434     05  ACCTNMBF PIC  X(0001).
  3435     05  FILLER REDEFINES ACCTNMBF.
  3436         10  ACCTNMBA PIC  X(0001).
  3437     05  ACCTNMBI PIC  X(0030).
  3438*    -------------------------------
  3439     05  UNDISBL PIC S9(0004) COMP.
  3440     05  UNDISBF PIC  X(0001).
  3441     05  FILLER REDEFINES UNDISBF.
  3442         10  UNDISBA PIC  X(0001).
  3443     05  UNDISBI PIC  X(0010).
  3444*    -------------------------------
  3445     05  RATEBL PIC S9(0004) COMP.
  3446     05  RATEBF PIC  X(0001).
  3447     05  FILLER REDEFINES RATEBF.
  3448         10  RATEBA PIC  X(0001).
  3449     05  RATEBI PIC  X(0006).
  3450*    -------------------------------
  3451     05  ERMSG1BL PIC S9(0004) COMP.
  3452     05  ERMSG1BF PIC  X(0001).
  3453     05  FILLER REDEFINES ERMSG1BF.
  3454         10  ERMSG1BA PIC  X(0001).
  3455     05  ERMSG1BI PIC  X(0072).
  3456*    -------------------------------
  3457     05  ENTPFBL PIC S9(0004) COMP.
  3458     05  ENTPFBF PIC  X(0001).
  3459     05  FILLER REDEFINES ENTPFBF.
  3460         10  ENTPFBA PIC  X(0001).
  3461     05  ENTPFBI PIC  99.
  3462 01  EL156BO REDEFINES EL156AI.
  3463     05  FILLER            PIC  X(0012).
  3464*    -------------------------------
  3465     05  FILLER            PIC  X(0003).
  3466     05  RUNDTEBO PIC  X(0008).
  3467*    -------------------------------
  3468     05  FILLER            PIC  X(0003).
  3469     05  RUNTIMBO PIC  99.99.
  3470*    -------------------------------
  3471     05  FILLER            PIC  X(0003).
  3472     05  PAYDTBO PIC  99B99B99.
  3473*    -------------------------------
  3474     05  FILLER            PIC  X(0003).
  3475     05  PAYTYPBO PIC  X(0015).
  3476*    -------------------------------
  3477     05  FILLER            PIC  X(0003).
  3478     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3479*    -------------------------------
  3480     05  FILLER            PIC  X(0003).
  3481     05  LOANHBO PIC  X(0012).
  3482*    -------------------------------
  3483     05  FILLER            PIC  X(0003).
  3484     05  LOANNBO PIC  X(0025).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  69
* EL156.cbl
  3485*    -------------------------------
  3486     05  FILLER            PIC  X(0003).
  3487     05  CKNUMHDO PIC  X(0012).
  3488*    -------------------------------
  3489     05  FILLER            PIC  X(0003).
  3490     05  CKNUMBO PIC  X(0007).
  3491*    -------------------------------
  3492     05  FILLER            PIC  X(0003).
  3493     05  AGTHDGO PIC  X(0016).
  3494*    -------------------------------
  3495     05  FILLER            PIC  X(0003).
  3496     05  NAMEBO PIC  X(0030).
  3497*    -------------------------------
  3498     05  FILLER            PIC  X(0003).
  3499     05  NAMEB2O PIC  X(0030).
  3500*    -------------------------------
  3501     05  FILLER            PIC  X(0003).
  3502     05  ADDR1BO PIC  X(0030).
  3503*    -------------------------------
  3504     05  FILLER            PIC  X(0003).
  3505     05  ADDR1B2O PIC  X(0030).
  3506*    -------------------------------
  3507     05  FILLER            PIC  X(0003).
  3508     05  ADDR2BO PIC  X(0030).
  3509*    -------------------------------
  3510     05  FILLER            PIC  X(0003).
  3511     05  ADDR2B2O PIC  X(0030).
  3512*    -------------------------------
  3513     05  FILLER            PIC  X(0003).
  3514     05  CITYSTBO PIC  X(0030).
  3515*    -------------------------------
  3516     05  FILLER            PIC  X(0003).
  3517     05  CITYST2O PIC  X(0030).
  3518*    -------------------------------
  3519     05  FILLER            PIC  X(0003).
  3520     05  ZIPBO PIC  ZZZZ99999.
  3521*    -------------------------------
  3522     05  FILLER            PIC  X(0003).
  3523     05  ZIPB2O PIC  ZZZZZZZZZ.
  3524*    -------------------------------
  3525     05  FILLER            PIC  X(0003).
  3526     05  INTHDBO PIC  X(0012).
  3527*    -------------------------------
  3528     05  FILLER            PIC  X(0003).
  3529     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3530*    -------------------------------
  3531     05  FILLER            PIC  X(0003).
  3532     05  PMTHDGBO PIC  X(0034).
  3533*    -------------------------------
  3534     05  FILLER            PIC  X(0003).
  3535     05  CLMNOBO PIC  X(0007).
  3536*    -------------------------------
  3537     05  FILLER            PIC  X(0003).
  3538     05  CARRBO PIC  X(0001).
  3539*    -------------------------------
  3540     05  FILLER            PIC  X(0003).
  3541     05  CERTNOBO PIC  X(0010).
  3542*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  70
* EL156.cbl
  3543     05  FILLER            PIC  X(0003).
  3544     05  SUFXBO PIC  X(0001).
  3545*    -------------------------------
  3546     05  FILLER            PIC  X(0003).
  3547     05  CLMTYPBO PIC  X(0006).
  3548*    -------------------------------
  3549     05  FILLER            PIC  X(0003).
  3550     05  INCURBO PIC  X(0008).
  3551*    -------------------------------
  3552     05  FILLER            PIC  X(0003).
  3553     05  PYFROMBO PIC  99B99B99.
  3554*    -------------------------------
  3555     05  FILLER            PIC  X(0003).
  3556     05  PYTHRUBO PIC  99B99B99.
  3557*    -------------------------------
  3558     05  FILLER            PIC  X(0003).
  3559     05  DAYSBO PIC  X(0005).
  3560*    -------------------------------
  3561     05  FILLER            PIC  X(0003).
  3562     05  BYBO PIC  X(0004).
  3563*    -------------------------------
  3564     05  FILLER            PIC  X(0003).
  3565     05  PROOFDBO PIC  99B99B99.
  3566*    -------------------------------
  3567     05  FILLER            PIC  X(0003).
  3568     05  ACCTBO PIC  X(0010).
  3569*    -------------------------------
  3570     05  FILLER            PIC  X(0003).
  3571     05  STATEBO PIC  X(0002).
  3572*    -------------------------------
  3573     05  FILLER            PIC  X(0003).
  3574     05  GROUPBO PIC  X(0006).
  3575*    -------------------------------
  3576     05  FILLER            PIC  X(0003).
  3577     05  ACARRBO PIC  X(0001).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  ACCTNMBO PIC  X(0030).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  UNDISBO PIC  ZZZ,Z99.99.
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  RATEBO PIC  ZZZ.99.
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  ERMSG1BO PIC  X(0072).
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  ENTPFBO PIC  X(0002).
  3593*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  71
* EL156.cbl
  3595****************************************************************
  3596*
  3597* Copyright (c) 2007 by Clerity Solutions, Inc.
  3598* All rights reserved.
  3599*
  3600****************************************************************
  3601 01  DFHEIV.
  3602   02  DFHEIV0               PIC X(35).
  3603   02  DFHEIV1               PIC X(08).
  3604   02  DFHEIV2               PIC X(08).
  3605   02  DFHEIV3               PIC X(08).
  3606   02  DFHEIV4               PIC X(06).
  3607   02  DFHEIV5               PIC X(04).
  3608   02  DFHEIV6               PIC X(04).
  3609   02  DFHEIV7               PIC X(02).
  3610   02  DFHEIV8               PIC X(02).
  3611   02  DFHEIV9               PIC X(01).
  3612   02  DFHEIV10              PIC S9(7) COMP-3.
  3613   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3614   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3615   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3616   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3617   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3618   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3619   02  DFHEIV17              PIC X(04).
  3620   02  DFHEIV18              PIC X(04).
  3621   02  DFHEIV19              PIC X(04).
  3622   02  DFHEIV20              USAGE IS POINTER.
  3623   02  DFHEIV21              USAGE IS POINTER.
  3624   02  DFHEIV22              USAGE IS POINTER.
  3625   02  DFHEIV23              USAGE IS POINTER.
  3626   02  DFHEIV24              USAGE IS POINTER.
  3627   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3628   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3629   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3630   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3631   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3632   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3633   02  FILLER                PIC X(02).
  3634   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3635   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3636   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3637   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3638   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3639 LINKAGE  SECTION.
  3640*****************************************************************
  3641*                                                               *
  3642* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3643* All rights reserved.                                          *
  3644*                                                               *
  3645*****************************************************************
  3646 01  dfheiblk.
  3647     02  eibtime          pic s9(7) comp-3.
  3648     02  eibdate          pic s9(7) comp-3.
  3649     02  eibtrnid         pic x(4).
  3650     02  eibtaskn         pic s9(7) comp-3.
  3651     02  eibtrmid         pic x(4).
  3652     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  72
* EL156.cbl
  3653     02  eibcposn         pic s9(4) comp.
  3654     02  eibcalen         pic s9(4) comp.
  3655     02  eibaid           pic x(1).
  3656     02  eibfiller1       pic x(1).
  3657     02  eibfn            pic x(2).
  3658     02  eibfiller2       pic x(2).
  3659     02  eibrcode         pic x(6).
  3660     02  eibfiller3       pic x(2).
  3661     02  eibds            pic x(8).
  3662     02  eibreqid         pic x(8).
  3663     02  eibrsrce         pic x(8).
  3664     02  eibsync          pic x(1).
  3665     02  eibfree          pic x(1).
  3666     02  eibrecv          pic x(1).
  3667     02  eibsend          pic x(1).
  3668     02  eibatt           pic x(1).
  3669     02  eibeoc           pic x(1).
  3670     02  eibfmh           pic x(1).
  3671     02  eibcompl         pic x(1).
  3672     02  eibsig           pic x(1).
  3673     02  eibconf          pic x(1).
  3674     02  eiberr           pic x(1).
  3675     02  eibrldbk         pic x(1).
  3676     02  eiberrcd         pic x(4).
  3677     02  eibsynrb         pic x(1).
  3678     02  eibnodat         pic x(1).
  3679     02  eibfiller5       pic x(2).
  3680     02  eibresp          pic 9(09) comp.
  3681     02  eibresp2         pic 9(09) comp.
  3682     02  dfheigdj         pic s9(4) comp.
  3683     02  dfheigdk         pic s9(4) comp.
  3684 01  DFHCOMMAREA             PIC X(1024).
  3685
  3686*    COPY ELCMSTR.
  3687******************************************************************
  3688*                                                                *
  3689*                            ELCMSTR.                            *
  3690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3691*                            VMOD=2.012                          *
  3692*                                                                *
  3693*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3694*                                                                *
  3695*   FILE TYPE = VSAM,KSDS                                        *
  3696*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3697*                                                                *
  3698*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3699*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3700*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3701*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3702*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3703*                                                 RKP=75,LEN=21  *
  3704*                                                                *
  3705*   **** NOTE ****                                               *
  3706*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3707*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3708*                                                                *
  3709*   LOG = YES                                                    *
  3710*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  73
* EL156.cbl
  3711******************************************************************
  3712*                   C H A N G E   L O G
  3713*
  3714* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3715*-----------------------------------------------------------------
  3716*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3717* EFFECTIVE    NUMBER
  3718*-----------------------------------------------------------------
  3719* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3720* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3721******************************************************************
  3722 01  CLAIM-MASTER.
  3723     12  CL-RECORD-ID                PIC XX.
  3724         88  VALID-CL-ID         VALUE 'CL'.
  3725
  3726     12  CL-CONTROL-PRIMARY.
  3727         16  CL-COMPANY-CD           PIC X.
  3728         16  CL-CARRIER              PIC X.
  3729         16  CL-CLAIM-NO             PIC X(7).
  3730         16  CL-CERT-NO.
  3731             20  CL-CERT-PRIME       PIC X(10).
  3732             20  CL-CERT-SFX         PIC X.
  3733
  3734     12  CL-CONTROL-BY-NAME.
  3735         16  CL-COMPANY-CD-A1        PIC X.
  3736         16  CL-INSURED-LAST-NAME    PIC X(15).
  3737         16  CL-INSURED-NAME.
  3738             20  CL-INSURED-1ST-NAME PIC X(12).
  3739             20  CL-INSURED-MID-INIT PIC X.
  3740
  3741     12  CL-CONTROL-BY-SSN.
  3742         16  CL-COMPANY-CD-A2        PIC X.
  3743         16  CL-SOC-SEC-NO.
  3744             20  CL-SSN-STATE        PIC XX.
  3745             20  CL-SSN-ACCOUNT      PIC X(6).
  3746             20  CL-SSN-LN3          PIC X(3).
  3747
  3748     12  CL-CONTROL-BY-CERT-NO.
  3749         16  CL-COMPANY-CD-A4        PIC X.
  3750         16  CL-CERT-NO-A4.
  3751             20  CL-CERT-A4-PRIME    PIC X(10).
  3752             20  CL-CERT-A4-SFX      PIC X.
  3753
  3754     12  CL-CONTROL-BY-CCN.
  3755         16  CL-COMPANY-CD-A5        PIC X.
  3756         16  CL-CCN-A5.
  3757             20  CL-CCN.
  3758                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3759                 24  CL-CCN-PRIME-A5 PIC X(12).
  3760             20  CL-CCN-FILLER-A5    PIC X(4).
  3761
  3762     12  CL-INSURED-PROFILE-DATA.
  3763         16  CL-INSURED-BIRTH-DT     PIC XX.
  3764         16  CL-INSURED-SEX-CD       PIC X.
  3765             88  INSURED-IS-MALE        VALUE 'M'.
  3766             88  INSURED-IS-FEMALE      VALUE 'F'.
  3767             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3768         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  74
* EL156.cbl
  3769         16  FILLER                  PIC X(5).
  3770
  3771     12  CL-PROCESSING-INFO.
  3772         16  CL-PROCESSOR-ID         PIC X(4).
  3773         16  CL-CLAIM-STATUS         PIC X.
  3774             88  CLAIM-IS-OPEN          VALUE 'O'.
  3775             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3776         16  CL-CLAIM-TYPE           PIC X.
  3777*            88  AH-CLAIM               VALUE 'A'.
  3778*            88  LIFE-CLAIM             VALUE 'L'.
  3779*            88  PROPERTY-CLAIM         VALUE 'P'.
  3780*            88  IUI-CLAIM              VALUE 'I'.
  3781*            88  GAP-CLAIM              VALUE 'G'.
  3782         16  CL-CLAIM-PREM-TYPE      PIC X.
  3783             88  SINGLE-PREMIUM         VALUE '1'.
  3784             88  O-B-COVERAGE           VALUE '2'.
  3785             88  OPEN-END-COVERAGE      VALUE '3'.
  3786         16  CL-INCURRED-DT          PIC XX.
  3787         16  CL-REPORTED-DT          PIC XX.
  3788         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3789         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3790         16  CL-LAST-PMT-DT          PIC XX.
  3791         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3792         16  CL-PAID-THRU-DT         PIC XX.
  3793         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3794         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3795         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3796         16  CL-PMT-CALC-METHOD      PIC X.
  3797             88  CL-360-DAY-YR          VALUE '1'.
  3798             88  CL-365-DAY-YR          VALUE '2'.
  3799             88  CL-FULL-MONTHS         VALUE '3'.
  3800         16  CL-CAUSE-CD             PIC X(6).
  3801
  3802         16  CL-PRIME-CERT-NO.
  3803             20  CL-PRIME-CERT-PRIME PIC X(10).
  3804             20  CL-PRIME-CERT-SFX   PIC X.
  3805
  3806         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3807             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3808             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3809
  3810         16  CL-MICROFILM-NO         PIC X(10).
  3811         16  CL-PROG-FORM-TYPE       PIC X.
  3812         16  CL-LAST-ADD-ON-DT       PIC XX.
  3813
  3814         16  CL-LAST-REOPEN-DT       PIC XX.
  3815         16  CL-LAST-CLOSE-DT        PIC XX.
  3816         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3817             88  FINAL-PAID             VALUE '1'.
  3818             88  CLAIM-DENIED           VALUE '2'.
  3819             88  AUTO-CLOSE             VALUE '3'.
  3820             88  MANUAL-CLOSE           VALUE '4'.
  3821             88  BENEFITS-CHANGED       VALUE 'C'.
  3822             88  SETUP-ERRORS           VALUE 'E'.
  3823         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3824         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3825         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3826             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  75
* EL156.cbl
  3827         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3828         16  FILLER                  PIC X.
  3829
  3830     12  CL-CERTIFICATE-DATA.
  3831         16  CL-CERT-ORIGIN          PIC X.
  3832             88  CERT-WAS-ONLINE        VALUE '1'.
  3833             88  CERT-WAS-CREATED       VALUE '2'.
  3834             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3835         16  CL-CERT-KEY-DATA.
  3836             20  CL-CERT-CARRIER     PIC X.
  3837             20  CL-CERT-GROUPING    PIC X(6).
  3838             20  CL-CERT-STATE       PIC XX.
  3839             20  CL-CERT-ACCOUNT.
  3840                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3841                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3842             20  CL-CERT-EFF-DT      PIC XX.
  3843
  3844     12  CL-STATUS-CONTROLS.
  3845         16  CL-PRIORITY-CD          PIC X.
  3846             88  CONFIDENTIAL-DATA      VALUE '8'.
  3847             88  HIGHEST-PRIORITY       VALUE '9'.
  3848         16  CL-SUPV-ATTN-CD         PIC X.
  3849             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3850             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3851         16  CL-PURGED-DT            PIC XX.
  3852         16  CL-RESTORED-DT          PIC XX.
  3853         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3854         16  CL-NEXT-RESEND-DT       PIC XX.
  3855         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3856         16  FILLER                  PIC XX.
  3857         16  CL-LAST-MAINT-DT        PIC XX.
  3858         16  CL-LAST-MAINT-USER      PIC X(4).
  3859         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3860         16  CL-LAST-MAINT-TYPE      PIC X.
  3861             88  CLAIM-SET-UP           VALUE ' '.
  3862             88  PAYMENT-MADE           VALUE '1'.
  3863             88  LETTER-SENT            VALUE '2'.
  3864             88  MASTER-WAS-ALTERED     VALUE '3'.
  3865             88  MASTER-WAS-RESTORED    VALUE '4'.
  3866             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3867             88  FILE-CONVERTED         VALUE '6'.
  3868             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3869             88  ERROR-CORRECTION       VALUE 'E'.
  3870         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3871         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3872         16  CL-BENEFICIARY          PIC X(10).
  3873         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3874         16  CL-DENIAL-TYPE          PIC X.
  3875             88  CL-TYPE-DENIAL          VALUE '1'.
  3876             88  CL-TYPE-RESCISSION      VALUE '2'.
  3877             88  CL-TYPE-REFORMATION     VALUE '3'.
  3878             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3879             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3880         16  FILLER                  PIC X(5).
  3881
  3882     12  CL-TRAILER-CONTROLS.
  3883         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3884             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  76
* EL156.cbl
  3885             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3886             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3887         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3888         16  FILLER                  PIC XX.
  3889         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3890         16  CL-ADDRESS-TRAILER-CNT.
  3891             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3892                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3893             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3894                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3895             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3896                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3897             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3898                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3899             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3900                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3901             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3902                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3903             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3904                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3905
  3906     12  CL-CV-REFERENCE-NO.
  3907         16  CL-CV-REFNO-PRIME       PIC X(18).
  3908         16  CL-CV-REFNO-SFX         PIC XX.
  3909
  3910     12  CL-FILE-LOCATION            PIC X(4).
  3911
  3912     12  CL-PROCESS-ERRORS.
  3913         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3914             88  NO-FATAL-ERRORS        VALUE ZERO.
  3915         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3916             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3917
  3918     12  CL-PRODUCT-CD               PIC X.
  3919
  3920     12  CL-CURRENT-KEY-DATA.
  3921         16  CL-CURRENT-CARRIER      PIC X.
  3922         16  CL-CURRENT-GROUPING     PIC X(6).
  3923         16  CL-CURRENT-STATE        PIC XX.
  3924         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3925
  3926     12  CL-ASSOCIATES               PIC X.
  3927         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3928         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3929         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3930         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3931
  3932     12  CL-ACTIVITY-CODE            PIC 99.
  3933     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3934     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3935
  3936     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3937     12  CL-LAG-REPORT-CODE          PIC 9.
  3938     12  CL-LOAN-TYPE                PIC XX.
  3939     12  CL-LEGAL-STATE              PIC XX.
  3940
  3941*    12  FILLER                      PIC X(5).
  3942     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  77
* EL156.cbl
  3943     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  78
* EL156.cbl
  3945*    COPY ELCCNTL.
  3946******************************************************************
  3947*                                                                *
  3948*                                                                *
  3949*                            ELCCNTL.                            *
  3950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3951*                            VMOD=2.059                          *
  3952*                                                                *
  3953*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3954*                                                                *
  3955*   FILE TYPE = VSAM,KSDS                                        *
  3956*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3957*                                                                *
  3958*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3959*       ALTERNATE INDEX = NONE                                   *
  3960*                                                                *
  3961*   LOG = YES                                                    *
  3962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3963******************************************************************
  3964*                   C H A N G E   L O G
  3965*
  3966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3967*-----------------------------------------------------------------
  3968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3969* EFFECTIVE    NUMBER
  3970*-----------------------------------------------------------------
  3971* 082503                   PEMA  ADD BENEFIT GROUP
  3972* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3973* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3974* 092705    2005050300006  PEMA  ADD SPP LEASES
  3975* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3976* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3977* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3978* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3979* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3980* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3981* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3982******************************************************************
  3983*
  3984 01  CONTROL-FILE.
  3985     12  CF-RECORD-ID                       PIC XX.
  3986         88  VALID-CF-ID                        VALUE 'CF'.
  3987
  3988     12  CF-CONTROL-PRIMARY.
  3989         16  CF-COMPANY-ID                  PIC XXX.
  3990         16  CF-RECORD-TYPE                 PIC X.
  3991             88  CF-COMPANY-MASTER              VALUE '1'.
  3992             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3993             88  CF-STATE-MASTER                VALUE '3'.
  3994             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3995             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3996             88  CF-CARRIER-MASTER              VALUE '6'.
  3997             88  CF-MORTALITY-MASTER            VALUE '7'.
  3998             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3999             88  CF-TERMINAL-MASTER             VALUE '9'.
  4000             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4001             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4002             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  79
* EL156.cbl
  4003             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4004             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4005             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4006             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4007             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4008             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4009         16  CF-ACCESS-CD-GENL              PIC X(4).
  4010         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4011             20  CF-PROCESSOR               PIC X(4).
  4012         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4013             20  CF-STATE-CODE              PIC XX.
  4014             20  FILLER                     PIC XX.
  4015         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4016             20  FILLER                     PIC XX.
  4017             20  CF-HI-BEN-IN-REC           PIC XX.
  4018         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4019             20  FILLER                     PIC XXX.
  4020             20  CF-CARRIER-CNTL            PIC X.
  4021         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4022             20  FILLER                     PIC XX.
  4023             20  CF-HI-TYPE-IN-REC          PIC 99.
  4024         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4025             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4026                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4027             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4028             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4029         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4030             20  FILLER                     PIC X.
  4031             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4032         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4033             20  FILLER                     PIC XX.
  4034             20  CF-MORTGAGE-PLAN           PIC XX.
  4035         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4036
  4037     12  CF-LAST-MAINT-DT                   PIC XX.
  4038     12  CF-LAST-MAINT-BY                   PIC X(4).
  4039     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4040
  4041     12  CF-RECORD-BODY                     PIC X(728).
  4042
  4043
  4044****************************************************************
  4045*             COMPANY MASTER RECORD                            *
  4046****************************************************************
  4047
  4048     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4049         16  CF-COMPANY-ADDRESS.
  4050             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4051             20  CF-CL-IN-CARE-OF           PIC X(30).
  4052             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4053             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4054             20  CF-CL-CITY-STATE           PIC X(30).
  4055             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4056             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4057         16  CF-COMPANY-CD                  PIC X.
  4058         16  CF-COMPANY-PASSWORD            PIC X(8).
  4059         16  CF-SECURITY-OPTION             PIC X.
  4060             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  80
* EL156.cbl
  4061             88  COMPANY-VERIFY                 VALUE '2'.
  4062             88  PROCESSOR-VERIFY               VALUE '3'.
  4063             88  NO-SECURITY                    VALUE '4'.
  4064             88  ALL-BUT-TERM                   VALUE '5'.
  4065         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4066             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4067         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4068             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4069         16  CF-INFORCE-LOCATION            PIC X.
  4070             88  CERTS-ARE-ONLINE               VALUE '1'.
  4071             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4072             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4073         16  CF-LOWER-CASE-LETTERS          PIC X.
  4074         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4075             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4076             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4077             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4078             88  CF-ACCNT-CNTL                  VALUE '3'.
  4079             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4080
  4081         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4082         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4083
  4084         16  CF-LGX-CREDIT-USER             PIC X.
  4085             88  CO-IS-NOT-USER                 VALUE 'N'.
  4086             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4087
  4088         16 CF-CREDIT-CALC-CODES.
  4089             20  CF-CR-REM-TERM-CALC PIC X.
  4090               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4091               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4092               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4093               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4094               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4095               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4096               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4097             20  CF-CR-R78-METHOD           PIC X.
  4098               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4099               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4100
  4101         16  CF-CLAIM-CONTROL-COUNTS.
  4102             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4103                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4104
  4105             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4106                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4107
  4108             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4109                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4110
  4111             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4112                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4113
  4114         16  CF-CURRENT-MONTH-END           PIC XX.
  4115
  4116         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4117             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4118             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  81
* EL156.cbl
  4119             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4120             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4121                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4122                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4123             20  CF-CO-PREM-REJECT-SW       PIC X.
  4124                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4125                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4126             20  CF-CO-REF-REJECT-SW        PIC X.
  4127                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4128                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4129
  4130         16  CF-CO-REPORTING-DT             PIC XX.
  4131         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4132         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4133           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4134           88  CF-CO-MONTH-END                  VALUE '1'.
  4135
  4136         16  CF-LGX-CLAIM-USER              PIC X.
  4137             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4138             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4139
  4140         16  CF-CREDIT-EDIT-CONTROLS.
  4141             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4142             20  CF-MIN-AGE                 PIC 99.
  4143             20  CF-DEFAULT-AGE             PIC 99.
  4144             20  CF-MIN-TERM                PIC S999      COMP-3.
  4145             20  CF-MAX-TERM                PIC S999      COMP-3.
  4146             20  CF-DEFAULT-SEX             PIC X.
  4147             20  CF-JOINT-AGE-INPUT         PIC X.
  4148                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4149             20  CF-BIRTH-DATE-INPUT        PIC X.
  4150                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4151             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4152                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4153                 88  CF-ZERO-CARRIER            VALUE '1'.
  4154                 88  CF-ZERO-GROUPING           VALUE '2'.
  4155                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4156             20  CF-EDIT-SW                 PIC X.
  4157                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4158             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4159             20  CF-CR-PR-METHOD            PIC X.
  4160               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4161               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4162             20  FILLER                     PIC X.
  4163
  4164         16  CF-CREDIT-MISC-CONTROLS.
  4165             20  CF-REIN-TABLE-SW           PIC X.
  4166                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4167             20  CF-COMP-TABLE-SW           PIC X.
  4168                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4169             20  CF-EXPERIENCE-RETENTION-AGE
  4170                                            PIC S9        COMP-3.
  4171             20  CF-CONVERSION-DT           PIC XX.
  4172             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4173             20  CF-RUN-FREQUENCY-SW        PIC X.
  4174                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4175                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4176
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  82
* EL156.cbl
  4177             20  CF-CR-CHECK-NO-CONTROL.
  4178                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4179                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4180                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4181                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4182                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4183                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4184
  4185                 24  CF-CR-CHECK-COUNT       REDEFINES
  4186                     CF-CR-CHECK-COUNTER      PIC X(4).
  4187
  4188                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4189                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4190
  4191                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4192                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4193                 24  CF-MAIL-PROCESSING       PIC X.
  4194                     88  MAIL-PROCESSING          VALUE 'Y'.
  4195
  4196         16  CF-MISC-SYSTEM-CONTROL.
  4197             20  CF-SYSTEM-C                 PIC X.
  4198                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4199             20  CF-SYSTEM-D                 PIC X.
  4200                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4201             20  CF-SOC-SEC-NO-SW            PIC X.
  4202                 88  SOC-SEC-NO-USED             VALUE '1'.
  4203             20  CF-MEMBER-NO-SW             PIC X.
  4204                 88  MEMBER-NO-USED              VALUE '1'.
  4205             20  CF-TAX-ID-NUMBER            PIC X(11).
  4206             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4207             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4208                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4209                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4210                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4211                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4212             20  CF-SYSTEM-E                 PIC X.
  4213                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4214
  4215         16  CF-LGX-LIFE-USER               PIC X.
  4216             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4217             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4218
  4219         16  CF-CR-MONTH-END-DT             PIC XX.
  4220
  4221         16  CF-FILE-MAINT-DATES.
  4222             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4223                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4224             20  CF-LAST-BATCH       REDEFINES
  4225                 CF-LAST-BATCH-NO               PIC X(4).
  4226             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4227             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4228             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4229             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4230             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4231             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4232             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4233             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4234             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  83
* EL156.cbl
  4235             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4236
  4237         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4238         16  FILLER                         PIC X.
  4239
  4240         16  CF-ALT-MORT-CODE               PIC X(4).
  4241         16  CF-MEMBER-CAPTION              PIC X(10).
  4242
  4243         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4244             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4245             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4246             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4247             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4248             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4249
  4250         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4251
  4252         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4253         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4254         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4255         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4256
  4257         16  CF-AH-OVERRIDE-L1              PIC X.
  4258         16  CF-AH-OVERRIDE-L2              PIC XX.
  4259         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4260         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4261
  4262         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4263         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4264
  4265         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4266         16  CF-AR-LAST-EL860-DT            PIC XX.
  4267         16  CF-MP-MONTH-END-DT             PIC XX.
  4268
  4269         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4270         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4271             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4272
  4273         16  CF-AR-MONTH-END-DT             PIC XX.
  4274
  4275         16  CF-CRDTCRD-USER                PIC X.
  4276             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4277             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4278
  4279         16  CF-CC-MONTH-END-DT             PIC XX.
  4280
  4281         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4282
  4283         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4284             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4285             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4286             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4287         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4288         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4289         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4290         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4291             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4292             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  84
* EL156.cbl
  4293         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4294         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4295         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4296             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4297         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4298
  4299         16  CF-CL-ZIP-CODE.
  4300             20  CF-CL-ZIP-PRIME.
  4301                 24  CF-CL-ZIP-1ST          PIC X.
  4302                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4303                 24  FILLER                 PIC X(4).
  4304             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4305         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4306             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4307             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4308             20  FILLER                     PIC XXX.
  4309
  4310         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4311         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4312         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4313         16  CF-CO-OPTION-START-DATE        PIC XX.
  4314         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4315           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4316                                                      '3' '4'.
  4317           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4318           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4319           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4320           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4321           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4322           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4323
  4324         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4325
  4326         16  CF-PAYMENT-APPROVAL-LEVELS.
  4327             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4328             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4329             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4330             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4331             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4332             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4333
  4334         16  CF-END-USER-REPORTING-USER     PIC X.
  4335             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4336             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4337
  4338         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4339             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4340             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4341
  4342         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4343
  4344         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4345         16  FILLER                         PIC X.
  4346
  4347         16  CF-CREDIT-ARCHIVE-CNTL.
  4348             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4349             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4350             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  85
* EL156.cbl
  4351
  4352         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4353
  4354         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4355             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4356             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4357
  4358         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4359             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4360             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4361
  4362         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4363
  4364         16  CF-CO-ACH-ID-CODE              PIC  X.
  4365             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4366             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4367             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4368         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4369         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4370         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4371         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4372         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4373         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4374         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4375         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4376         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4377                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4378         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4379                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4380
  4381         16  CF-CO-OVER-SHORT.
  4382             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4383             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4384
  4385*         16  FILLER                         PIC X(102).
  4386         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4387             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4388             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4389
  4390         16  CF-AH-APPROVAL-DAYS.
  4391             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4392             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4393             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4394             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4395
  4396         16  FILLER                         PIC X(82).
  4397****************************************************************
  4398*             PROCESSOR/USER RECORD                            *
  4399****************************************************************
  4400
  4401     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4402         16  CF-PROCESSOR-NAME              PIC X(30).
  4403         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4404         16  CF-PROCESSOR-TITLE             PIC X(26).
  4405         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4406                 88  MESSAGE-YES                VALUE 'Y'.
  4407                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4408
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  86
* EL156.cbl
  4409*****************************************************
  4410****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4411****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4412****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4413****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4414*****************************************************
  4415
  4416         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4417             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4418             20  CF-APPLICATION-FORCE       PIC X.
  4419             20  CF-INDIVIDUAL-APP.
  4420                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4421                     28  CF-BROWSE-APP      PIC X.
  4422                     28  CF-UPDATE-APP      PIC X.
  4423
  4424         16  CF-CURRENT-TERM-ON             PIC X(4).
  4425         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4426             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4427             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4428             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4429             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4430             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4431             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4432             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4433         16  CF-PROCESSOR-CARRIER           PIC X.
  4434             88  NO-CARRIER-SECURITY            VALUE ' '.
  4435         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4436             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4437         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4438             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4439         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4440             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4441
  4442         16  CF-PROC-SYS-ACCESS-SW.
  4443             20  CF-PROC-CREDIT-CLAIMS-SW.
  4444                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4445                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4446                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4447                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4448             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4449                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4450                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4451             20  CF-PROC-LIFE-GNRLDGR-SW.
  4452                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4453                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4454                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4455                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4456             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4457                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4458                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4459         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4460             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4461             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4462         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4463
  4464         16  CF-APPROVAL-LEVEL                  PIC X.
  4465             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4466             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  87
* EL156.cbl
  4467             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4468             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4469
  4470         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4471
  4472         16  CF-LANGUAGE-TYPE                   PIC X.
  4473             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4474             88  CF-LANG-IS-FR                      VALUE 'F'.
  4475
  4476         16  CF-CSR-IND                         PIC X.
  4477         16  FILLER                             PIC X(239).
  4478
  4479****************************************************************
  4480*             PROCESSOR/REMINDERS RECORD                       *
  4481****************************************************************
  4482
  4483     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4484         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4485             20  CF-START-REMIND-DT         PIC XX.
  4486             20  CF-END-REMIND-DT           PIC XX.
  4487             20  CF-REMINDER-TEXT           PIC X(50).
  4488         16  FILLER                         PIC X(296).
  4489
  4490
  4491****************************************************************
  4492*             STATE MASTER RECORD                              *
  4493****************************************************************
  4494
  4495     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4496         16  CF-STATE-ABBREVIATION          PIC XX.
  4497         16  CF-STATE-NAME                  PIC X(25).
  4498         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4499         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4500             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4501             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4502             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4503             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4504                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4505                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4506             20  CF-ST-PREM-REJECT-SW       PIC X.
  4507                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4508                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4509             20  CF-ST-REF-REJECT-SW        PIC X.
  4510                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4511                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4512         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4513         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4514         16  CF-ST-REFUND-RULES.
  4515             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4516             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4517             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4518         16  CF-ST-FST-PMT-EXTENSION.
  4519             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4520             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4521                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4522                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4523                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4524                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  88
* EL156.cbl
  4525         16  CF-ST-STATE-CALL.
  4526             20  CF-ST-CALL-UNEARNED        PIC X.
  4527             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4528             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4529         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4530             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4531             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4532         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4533         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4534         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4535         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4536         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4537         16  FILLER                         PIC X.
  4538         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4539             20  CF-ST-BENEFIT-CD           PIC XX.
  4540             20  CF-ST-BENEFIT-KIND         PIC X.
  4541                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4542                 88  CF-ST-AH-KIND              VALUE 'A'.
  4543             20  CF-ST-REM-TERM-CALC        PIC X.
  4544                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4545                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4546                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4547                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4548                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4549                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4550                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4551                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4552
  4553             20  CF-ST-REFUND-CALC          PIC X.
  4554                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4555                 88  ST-REFD-BY-R78             VALUE '1'.
  4556                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4557                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4558                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4559                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4560                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4561                 88  ST-REFD-UTAH               VALUE '7'.
  4562                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4563                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4564                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4565
  4566             20  CF-ST-EARNING-CALC         PIC X.
  4567                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4568                 88  ST-EARN-BY-R78             VALUE '1'.
  4569                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4570                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4571                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4572                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4573                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4574                 88  ST-EARN-MEAN               VALUE '8'.
  4575                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4576
  4577             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4578                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4579                 88  ST-OVRD-BY-R78             VALUE '1'.
  4580                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4581                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4582                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  89
* EL156.cbl
  4583                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4584                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4585                 88  ST-OVRD-MEAN               VALUE '8'.
  4586                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4587             20  FILLER                     PIC X.
  4588
  4589         16  CF-ST-COMMISSION-CAPS.
  4590             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4591             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4592             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4593             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4594         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4595                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4596
  4597         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4598
  4599         16  CF-ST-STATUTORY-INTEREST.
  4600             20  CF-ST-STAT-DATE-FROM       PIC X.
  4601                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4602                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4603             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4604             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4605             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4606             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4607             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4608
  4609         16  CF-ST-OVER-SHORT.
  4610             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4611             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4612
  4613         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4614
  4615         16  CF-ST-RT-CALC                  PIC X.
  4616
  4617         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4618         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4619         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4620         16  CF-ST-RF-LR-CALC               PIC X.
  4621         16  CF-ST-RF-LL-CALC               PIC X.
  4622         16  CF-ST-RF-LN-CALC               PIC X.
  4623         16  CF-ST-RF-AH-CALC               PIC X.
  4624         16  CF-ST-RF-CP-CALC               PIC X.
  4625*        16  FILLER                         PIC X(206).
  4626*CIDMOD         16  FILLER                         PIC X(192).
  4627         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4628             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4629         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4630         16  CF-ST-VFY-2ND-BENE             PIC X.
  4631         16  CF-ST-CAUSAL-STATE             PIC X.
  4632         16  FILLER                         PIC X(185).
  4633
  4634****************************************************************
  4635*             BENEFIT MASTER RECORD                            *
  4636****************************************************************
  4637
  4638     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4639         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4640             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  90
* EL156.cbl
  4641             20  CF-BENEFIT-NUMERIC  REDEFINES
  4642                 CF-BENEFIT-CODE            PIC XX.
  4643             20  CF-BENEFIT-ALPHA           PIC XXX.
  4644             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4645             20  CF-BENEFIT-COMMENT         PIC X(10).
  4646
  4647             20  CF-LF-COVERAGE-TYPE        PIC X.
  4648                 88  CF-REDUCING                VALUE 'R'.
  4649                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4650
  4651             20  CF-SPECIAL-CALC-CD         PIC X.
  4652                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4653                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4654                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4655                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4656                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4657                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4658                 88  CF-FARM-PLAN               VALUE 'F'.
  4659                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4660                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4661                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4662                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4663                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4664                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4665                 88  CF-PRUDENTIAL              VALUE 'P'.
  4666                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4667                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4668                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4669                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4670                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4671                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4672
  4673             20  CF-JOINT-INDICATOR         PIC X.
  4674                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4675
  4676*            20  FILLER                     PIC X(12).
  4677             20  FILLER                     PIC X(11).
  4678             20  CF-BENEFIT-CATEGORY        PIC X.
  4679             20  CF-LOAN-TYPE               PIC X(8).
  4680
  4681             20  CF-CO-REM-TERM-CALC        PIC X.
  4682                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4683                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4684                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4685                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4686                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4687
  4688             20  CF-CO-EARNINGS-CALC        PIC X.
  4689                 88  CO-EARN-BY-R78             VALUE '1'.
  4690                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4691                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4692                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4693                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4694                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4695                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4696                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4697
  4698             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  91
* EL156.cbl
  4699                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4700                 88  CO-REFD-BY-R78             VALUE '1'.
  4701                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4702                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4703                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4704                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4705                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4706                 88  CO-REFD-MEAN               VALUE '8'.
  4707                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4708                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4709                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4710
  4711             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4712                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4713                 88  CO-OVRD-BY-R78             VALUE '1'.
  4714                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4715                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4716                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4717                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4718                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4719                 88  CO-OVRD-MEAN               VALUE '8'.
  4720                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4721
  4722             20  CF-CO-BEN-I-G-CD           PIC X.
  4723                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4724                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4725                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4726
  4727         16  FILLER                         PIC X(304).
  4728
  4729
  4730****************************************************************
  4731*             CARRIER MASTER RECORD                            *
  4732****************************************************************
  4733
  4734     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4735         16  CF-ADDRESS-DATA.
  4736             20  CF-MAIL-TO-NAME            PIC X(30).
  4737             20  CF-IN-CARE-OF              PIC X(30).
  4738             20  CF-ADDRESS-LINE-1          PIC X(30).
  4739             20  CF-ADDRESS-LINE-2          PIC X(30).
  4740             20  CF-CITY-STATE              PIC X(30).
  4741             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4742             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4743
  4744         16  CF-CLAIM-NO-CONTROL.
  4745             20  CF-CLAIM-NO-METHOD         PIC X.
  4746                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4747                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4748                 88  CLAIM-NO-SEQ               VALUE '3'.
  4749                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4750             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4751                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4752                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4753                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4754
  4755         16  CF-CHECK-NO-CONTROL.
  4756             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  92
* EL156.cbl
  4757                 88  CHECK-NO-MANUAL            VALUE '1'.
  4758                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4759                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4760                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4761             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4762                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4763
  4764         16  CF-DOMICILE-STATE              PIC XX.
  4765
  4766         16  CF-EXPENSE-CONTROLS.
  4767             20  CF-EXPENSE-METHOD          PIC X.
  4768                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4769                 88  DOLLARS-PER-PMT            VALUE '2'.
  4770                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4771                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4772             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4773             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4774
  4775         16  CF-CORRESPONDENCE-CONTROL.
  4776             20  CF-LETTER-RESEND-OPT       PIC X.
  4777                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4778                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4779             20  FILLER                     PIC X(4).
  4780
  4781         16  CF-RESERVE-CONTROLS.
  4782             20  CF-MANUAL-SW               PIC X.
  4783                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4784             20  CF-FUTURE-SW               PIC X.
  4785                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4786             20  CF-PTC-SW                  PIC X.
  4787                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4788             20  CF-IBNR-SW                 PIC X.
  4789                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4790             20  CF-PTC-LF-SW               PIC X.
  4791                 88  CF-LF-PTC-USED             VALUE '1'.
  4792             20  CF-CDT-ACCESS-METHOD       PIC X.
  4793                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4794                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4795                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4796             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4797
  4798         16  CF-CLAIM-CALC-METHOD           PIC X.
  4799             88  360-PLUS-MONTHS                VALUE '1'.
  4800             88  365-PLUS-MONTHS                VALUE '2'.
  4801             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4802             88  360-DAILY                      VALUE '4'.
  4803             88  365-DAILY                      VALUE '5'.
  4804
  4805         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4806         16  FILLER                         PIC X(11).
  4807
  4808         16  CF-LIMIT-AMOUNTS.
  4809             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4810             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4811             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4812             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4813             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4814             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  93
* EL156.cbl
  4815             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4816             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4817             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4818             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4819
  4820         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4821         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4822         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4823
  4824         16  CF-ZIP-CODE.
  4825             20  CF-ZIP-PRIME.
  4826                 24  CF-ZIP-1ST             PIC X.
  4827                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4828                 24  FILLER                 PIC X(4).
  4829             20  CF-ZIP-PLUS4               PIC X(4).
  4830         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4831             20  CF-CAN-POSTAL-1            PIC XXX.
  4832             20  CF-CAN-POSTAL-2            PIC XXX.
  4833             20  FILLER                     PIC XXX.
  4834
  4835         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4836         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4837         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4838
  4839         16  CF-RATING-SWITCH               PIC X.
  4840             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4841             88  CF-NO-RATING                   VALUE 'N'.
  4842
  4843         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4844
  4845         16  CF-CARRIER-OVER-SHORT.
  4846             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4847             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4848
  4849         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4850         16  CF-SECPAY-SWITCH               PIC X.
  4851             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4852             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4853         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4854         16  FILLER                         PIC X(448).
  4855*        16  FILLER                         PIC X(452).
  4856
  4857
  4858****************************************************************
  4859*             MORTALITY MASTER RECORD                          *
  4860****************************************************************
  4861
  4862     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4863         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4864                                INDEXED BY CF-MORT-NDX.
  4865             20  CF-MORT-TABLE              PIC X(5).
  4866             20  CF-MORT-TABLE-TYPE         PIC X.
  4867                 88  CF-MORT-JOINT              VALUE 'J'.
  4868                 88  CF-MORT-SINGLE             VALUE 'S'.
  4869                 88  CF-MORT-COMBINED           VALUE 'C'.
  4870                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4871                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4872             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  94
* EL156.cbl
  4873             20  CF-MORT-AGE-METHOD         PIC XX.
  4874                 88  CF-AGE-LAST                VALUE 'AL'.
  4875                 88  CF-AGE-NEAR                VALUE 'AN'.
  4876             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4877             20  CF-MORT-ADJUSTMENT-DIRECTION
  4878                                            PIC X.
  4879                 88  CF-MINUS                   VALUE '-'.
  4880                 88  CF-PLUS                    VALUE '+'.
  4881             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4882             20  CF-MORT-JOINT-CODE         PIC X.
  4883                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4884             20  CF-MORT-PC-Q               PIC X.
  4885                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4886             20  CF-MORT-TABLE-CODE         PIC X(4).
  4887             20  CF-MORT-COMMENTS           PIC X(15).
  4888             20  FILLER                     PIC X(14).
  4889
  4890         16  FILLER                         PIC X(251).
  4891
  4892
  4893****************************************************************
  4894*             BUSSINESS TYPE MASTER RECORD                     *
  4895****************************************************************
  4896
  4897     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4898* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4899* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4900* AND RECORD 05 IS TYPES 81-99
  4901         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4902             20  CF-BUSINESS-TITLE          PIC  X(19).
  4903             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4904                                            PIC S9V9(4) COMP-3.
  4905             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4906             20  FILLER                     PIC  X.
  4907         16  FILLER                         PIC  X(248).
  4908
  4909
  4910****************************************************************
  4911*             TERMINAL MASTER RECORD                           *
  4912****************************************************************
  4913
  4914     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4915
  4916         16  CF-COMPANY-TERMINALS.
  4917             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4918                                  PIC X(4).
  4919         16  FILLER               PIC X(248).
  4920
  4921
  4922****************************************************************
  4923*             LIFE EDIT MASTER RECORD                          *
  4924****************************************************************
  4925
  4926     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4927         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4928             20  CF-LIFE-CODE-IN            PIC XX.
  4929             20  CF-LIFE-CODE-OUT           PIC XX.
  4930         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  95
* EL156.cbl
  4931
  4932
  4933****************************************************************
  4934*             AH EDIT MASTER RECORD                            *
  4935****************************************************************
  4936
  4937     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4938         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4939             20  CF-AH-CODE-IN              PIC XXX.
  4940             20  CF-AH-CODE-OUT             PIC XX.
  4941         16  FILLER                         PIC X(248).
  4942
  4943
  4944****************************************************************
  4945*             CREDIBILITY TABLES                               *
  4946****************************************************************
  4947
  4948     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4949         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4950                             INDEXED BY CF-CRDB-NDX.
  4951             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4952             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4953             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4954         16  FILLER                         PIC  X(332).
  4955
  4956
  4957****************************************************************
  4958*             REPORT CUSTOMIZATION RECORD                      *
  4959****************************************************************
  4960
  4961     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4962         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4963             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4964             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4965             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4966**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4967****       A T-TRANSFER.                                   ****
  4968             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4969
  4970         16  FILLER                         PIC XX.
  4971
  4972         16  CF-CARRIER-CNTL-OPT.
  4973             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4974                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4975                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4976             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4977                                            PIC X.
  4978         16  CF-GROUP-CNTL-OPT.
  4979             20  CF-GROUP-OPT-SEQ           PIC 9.
  4980                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4981                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4982             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4983                                            PIC X(6).
  4984         16  CF-STATE-CNTL-OPT.
  4985             20  CF-STATE-OPT-SEQ           PIC 9.
  4986                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4987                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4988             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  96
* EL156.cbl
  4989                                            PIC XX.
  4990         16  CF-ACCOUNT-CNTL-OPT.
  4991             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4992                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4993                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4994             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4995                                            PIC X(10).
  4996         16  CF-BUS-TYP-CNTL-OPT.
  4997             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4998                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4999                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5000             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5001                                            PIC XX.
  5002         16  CF-LF-TYP-CNTL-OPT.
  5003             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5004                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5005                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5006             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5007                                            PIC XX.
  5008         16  CF-AH-TYP-CNTL-OPT.
  5009             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5010                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5011                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5012             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5013                                            PIC XX.
  5014         16  CF-REPTCD1-CNTL-OPT.
  5015             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5016                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5017                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5018             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5019                                            PIC X(10).
  5020         16  CF-REPTCD2-CNTL-OPT.
  5021             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5022                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5023                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5024             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5025                                            PIC X(10).
  5026         16  CF-USER1-CNTL-OPT.
  5027             20  CF-USER1-OPT-SEQ           PIC 9.
  5028                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5029                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5030             20  CF-USER1-SELECT OCCURS 3 TIMES
  5031                                            PIC X(10).
  5032         16  CF-USER2-CNTL-OPT.
  5033             20  CF-USER2-OPT-SEQ           PIC 9.
  5034                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5035                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5036             20  CF-USER2-SELECT OCCURS 3 TIMES
  5037                                            PIC X(10).
  5038         16  CF-USER3-CNTL-OPT.
  5039             20  CF-USER3-OPT-SEQ           PIC 9.
  5040                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5041                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5042             20  CF-USER3-SELECT OCCURS 3 TIMES
  5043                                            PIC X(10).
  5044         16  CF-USER4-CNTL-OPT.
  5045             20  CF-USER4-OPT-SEQ           PIC 9.
  5046                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  97
* EL156.cbl
  5047                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5048             20  CF-USER4-SELECT OCCURS 3 TIMES
  5049                                            PIC X(10).
  5050         16  CF-USER5-CNTL-OPT.
  5051             20  CF-USER5-OPT-SEQ           PIC 9.
  5052                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5053                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5054             20  CF-USER5-SELECT OCCURS 3 TIMES
  5055                                            PIC X(10).
  5056         16  CF-REINS-CNTL-OPT.
  5057             20  CF-REINS-OPT-SEQ           PIC 9.
  5058                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5059                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5060             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5061                 24  CF-REINS-PRIME         PIC XXX.
  5062                 24  CF-REINS-SUB           PIC XXX.
  5063
  5064         16  CF-AGENT-CNTL-OPT.
  5065             20  CF-AGENT-OPT-SEQ           PIC 9.
  5066                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5067                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5068             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5069                                            PIC X(10).
  5070
  5071         16  FILLER                         PIC X(43).
  5072
  5073         16  CF-LOSS-RATIO-SELECT.
  5074             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5075             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5076         16  CF-ENTRY-DATE-SELECT.
  5077             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5078             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5079         16  CF-EFFECTIVE-DATE-SELECT.
  5080             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5081             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5082
  5083         16  CF-EXCEPTION-LIST-IND          PIC X.
  5084             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5085
  5086         16  FILLER                         PIC X(318).
  5087
  5088****************************************************************
  5089*                  EXCEPTION REPORTING RECORD                  *
  5090****************************************************************
  5091
  5092     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5093         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5094             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5095
  5096         16  CF-COMBINED-LIFE-AH-OPT.
  5097             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5098             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5099             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5100             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5101
  5102         16  CF-LIFE-OPT.
  5103             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5104             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  98
* EL156.cbl
  5105             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5106             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5107             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5108             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5109             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5110             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5111             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5112             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5113
  5114         16  CF-AH-OPT.
  5115             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5116             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5117             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5118             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5119             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5120             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5121             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5122             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5123             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5124             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5125
  5126         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5127             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5128             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5129             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5130
  5131         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5132
  5133         16  FILLER                         PIC X(673).
  5134
  5135
  5136****************************************************************
  5137*             MORTGAGE SYSTEM PLAN RECORD                      *
  5138****************************************************************
  5139
  5140     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5141         16  CF-PLAN-TYPE                   PIC X.
  5142             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5143             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5144             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5145         16  CF-PLAN-ABBREV                 PIC XXX.
  5146         16  CF-PLAN-DESCRIPT               PIC X(10).
  5147         16  CF-PLAN-NOTES                  PIC X(20).
  5148         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5149         16  CF-PLAN-UNDERWRITING.
  5150             20  CF-PLAN-TERM-DATA.
  5151                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5152                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5153             20  CF-PLAN-AGE-DATA.
  5154                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5155                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5156                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5157             20  CF-PLAN-BENEFIT-DATA.
  5158                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5159                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5160                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5161                                            PIC S9(7)V99  COMP-3.
  5162         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page  99
* EL156.cbl
  5163             20  CF-POLICY-FORM             PIC X(12).
  5164             20  CF-MASTER-APPLICATION      PIC X(12).
  5165             20  CF-MASTER-POLICY           PIC X(12).
  5166         16  CF-PLAN-RATING.
  5167             20  CF-RATE-CODE               PIC X(5).
  5168             20  CF-SEX-RATING              PIC X.
  5169                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5170                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5171             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5172             20  CF-SUB-STD-TYPE            PIC X.
  5173                 88  CF-PCT-OF-PREM            VALUE '1'.
  5174                 88  CF-PCT-OF-BENE            VALUE '2'.
  5175         16  CF-PLAN-PREM-TOLERANCES.
  5176             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5177             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5178         16  CF-PLAN-PYMT-TOLERANCES.
  5179             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5180             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5181         16  CF-PLAN-MISC-DATA.
  5182             20  FILLER                     PIC X.
  5183             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5184             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5185         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5186         16  CF-PLAN-IND-GRP                PIC X.
  5187             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5188                                                     '1'.
  5189             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5190                                                     '2'.
  5191         16  CF-MIB-SEARCH-SW               PIC X.
  5192             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5193             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5194             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5195             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5196         16  CF-ALPHA-SEARCH-SW             PIC X.
  5197             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5198             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5199             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5200             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5201             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5202             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5203             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5204             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5205             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5206             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5207                                                     'A' 'B' 'C'
  5208                                                     'X' 'Y' 'Z'.
  5209         16  CF-EFF-DT-RULE-SW              PIC X.
  5210             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5211             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5212             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5213             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5214             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5215         16  FILLER                         PIC X(4).
  5216         16  CF-HEALTH-QUESTIONS            PIC X.
  5217             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5218         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5219         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5220         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 100
* EL156.cbl
  5221             88  CF-COMBINED-PLAN              VALUE 'C'.
  5222             88  CF-JNT-PLAN                   VALUE 'J'.
  5223             88  CF-SNGL-PLAN                  VALUE 'S'.
  5224         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5225         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5226         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5227         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5228         16  CF-RERATE-CNTL                 PIC  X.
  5229             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5230             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5231             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5232             88  CF-AUTO-RECALC                 VALUE '4'.
  5233         16  CF-BENEFIT-TYPE                PIC  X.
  5234             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5235             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5236         16  CF-POLICY-FEE                  PIC S999V99
  5237                                                    COMP-3.
  5238         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5239         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5240         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5241         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5242         16  FILLER                         PIC  X(32).
  5243         16  CF-TERMINATION-FORM            PIC  X(04).
  5244         16  FILLER                         PIC  X(08).
  5245         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5246                                                       COMP-3.
  5247         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5248         16  CF-ISSUE-LETTER                PIC  X(4).
  5249         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5250         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5251             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5252             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5253         16  CF-MP-REFUND-CALC              PIC X.
  5254             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5255             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5256             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5257             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5258             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5259             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5260             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5261             88  CF-MP-REFD-MEAN                VALUE '8'.
  5262         16  CF-ALT-RATE-CODE               PIC  X(5).
  5263
  5264
  5265         16  FILLER                         PIC X(498).
  5266****************************************************************
  5267*             MORTGAGE COMPANY MASTER RECORD                   *
  5268****************************************************************
  5269
  5270     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5271         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5272         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5273             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5274             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5275             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5276             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5277             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5278
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 101
* EL156.cbl
  5279         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5280         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5281         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5282         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5283         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5284
  5285         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5286             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5287         16  CF-MP-RECON-USE-IND            PIC X(1).
  5288             88  CF-MP-USE-RECON             VALUE 'Y'.
  5289         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5290             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5291         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5292             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5293             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5294         16  FILLER                         PIC X(1).
  5295         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5296             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5297         16  CF-MORTG-MIB-VERSION           PIC X.
  5298             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5299             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5300             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5301         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5302             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5303                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5304             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5305                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5306             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5307                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5308             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5309                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5310             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5311                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5312             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5313                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5314         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5315         16  FILLER                         PIC X(7).
  5316         16  CF-MORTG-DESTINATION-SYMBOL.
  5317             20  CF-MORTG-MIB-COMM          PIC X(5).
  5318             20  CF-MORTG-MIB-TERM          PIC X(5).
  5319         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5320             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5321         16  FILLER                         PIC X(03).
  5322         16  CF-MP-CHECK-NO-CONTROL.
  5323             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5324                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5325                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5326                                                ' ' LOW-VALUES.
  5327                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5328                                               VALUE '3'.
  5329         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5330         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5331         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5332             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5333                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5334             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5335                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5336             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 102
* EL156.cbl
  5337                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5338             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5339                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5340             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5341                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5342             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5343                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5344         16  CF-MORTG-BILLING-AREA.
  5345             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5346                                            PIC X.
  5347         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5348         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5349         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5350         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5351             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5352             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5353         16  FILLER                         PIC X.
  5354         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5355             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5356             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5357         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5358         16  FILLER                         PIC X(8).
  5359         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5360         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5361         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5362         16  CF-ACH-COMPANY-ID.
  5363             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5364                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5365                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5366                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5367             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5368         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5369             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5370         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5371             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5372             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5373         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5374         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5375         16  FILLER                         PIC X(536).
  5376
  5377****************************************************************
  5378*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5379****************************************************************
  5380
  5381     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5382         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5383             20  CF-FEMALE-HEIGHT.
  5384                 24  CF-FEMALE-FT           PIC 99.
  5385                 24  CF-FEMALE-IN           PIC 99.
  5386             20  CF-FEMALE-MIN-WT           PIC 999.
  5387             20  CF-FEMALE-MAX-WT           PIC 999.
  5388         16  FILLER                         PIC X(428).
  5389
  5390     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5391         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5392             20  CF-MALE-HEIGHT.
  5393                 24  CF-MALE-FT             PIC 99.
  5394                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 103
* EL156.cbl
  5395             20  CF-MALE-MIN-WT             PIC 999.
  5396             20  CF-MALE-MAX-WT             PIC 999.
  5397         16  FILLER                         PIC X(428).
  5398******************************************************************
  5399*             AUTOMATIC ACTIVITY RECORD                          *
  5400******************************************************************
  5401     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5402         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5403             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5404             20  CF-SYS-LETTER-ID           PIC X(04).
  5405             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5406             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5407             20  CF-SYS-RESET-SW            PIC X(01).
  5408             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5409             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5410
  5411         16  FILLER                         PIC X(50).
  5412
  5413         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5414             20  CF-USER-ACTIVE-SW          PIC X(01).
  5415             20  CF-USER-LETTER-ID          PIC X(04).
  5416             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5417             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5418             20  CF-USER-RESET-SW           PIC X(01).
  5419             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5420             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5421             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5422
  5423         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 104
* EL156.cbl
  5425*    COPY ELCCERT.
  5426******************************************************************
  5427*                                                                *
  5428*                            ELCCERT.                            *
  5429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5430*                            VMOD=2.013                          *
  5431*                                                                *
  5432*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5433*                                                                *
  5434*   FILE TYPE = VSAM,KSDS                                        *
  5435*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5436*                                                                *
  5437*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5438*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5439*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5440*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5441*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5442*                                                                *
  5443*   LOG = YES                                                    *
  5444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5445******************************************************************
  5446*                   C H A N G E   L O G
  5447*
  5448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5449*-----------------------------------------------------------------
  5450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5451* EFFECTIVE    NUMBER
  5452*-----------------------------------------------------------------
  5453* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5454* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5455* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5456* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5457* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5458* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5459* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5460* 032612  CR2011110200001  PEMA  AHL CHANGES
  5461******************************************************************
  5462
  5463 01  CERTIFICATE-MASTER.
  5464     12  CM-RECORD-ID                      PIC XX.
  5465         88  VALID-CM-ID                      VALUE 'CM'.
  5466
  5467     12  CM-CONTROL-PRIMARY.
  5468         16  CM-COMPANY-CD                 PIC X.
  5469         16  CM-CARRIER                    PIC X.
  5470         16  CM-GROUPING.
  5471             20  CM-GROUPING-PREFIX        PIC X(3).
  5472             20  CM-GROUPING-PRIME         PIC X(3).
  5473         16  CM-STATE                      PIC XX.
  5474         16  CM-ACCOUNT.
  5475             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5476             20  CM-ACCOUNT-PRIME          PIC X(6).
  5477         16  CM-CERT-EFF-DT                PIC XX.
  5478         16  CM-CERT-NO.
  5479             20  CM-CERT-PRIME             PIC X(10).
  5480             20  CM-CERT-SFX               PIC X.
  5481
  5482     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 105
* EL156.cbl
  5483         16  CM-COMPANY-CD-A1              PIC X.
  5484         16  CM-INSURED-LAST-NAME          PIC X(15).
  5485         16  CM-INSURED-INITIALS.
  5486             20  CM-INSURED-INITIAL1       PIC X.
  5487             20  CM-INSURED-INITIAL2       PIC X.
  5488
  5489     12  CM-CONTROL-BY-SSN.
  5490         16  CM-COMPANY-CD-A2              PIC X.
  5491         16  CM-SOC-SEC-NO.
  5492             20  CM-SSN-STATE              PIC XX.
  5493             20  CM-SSN-ACCOUNT            PIC X(6).
  5494             20  CM-SSN-LN3.
  5495                 25  CM-INSURED-INITIALS-A2.
  5496                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5497                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5498                 25 CM-PART-LAST-NAME-A2         PIC X.
  5499
  5500     12  CM-CONTROL-BY-CERT-NO.
  5501         16  CM-COMPANY-CD-A4              PIC X.
  5502         16  CM-CERT-NO-A4                 PIC X(11).
  5503
  5504     12  CM-CONTROL-BY-MEMB.
  5505         16  CM-COMPANY-CD-A5              PIC X.
  5506         16  CM-MEMBER-NO.
  5507             20  CM-MEMB-STATE             PIC XX.
  5508             20  CM-MEMB-ACCOUNT           PIC X(6).
  5509             20  CM-MEMB-LN4.
  5510                 25  CM-INSURED-INITIALS-A5.
  5511                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5512                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5513                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5514
  5515     12  CM-INSURED-PROFILE-DATA.
  5516         16  CM-INSURED-FIRST-NAME.
  5517             20  CM-INSURED-1ST-INIT       PIC X.
  5518             20  FILLER                    PIC X(9).
  5519         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5520         16  CM-INSURED-SEX                PIC X.
  5521             88  CM-SEX-MALE                  VALUE 'M'.
  5522             88  CM-SEX-FEMAL                 VALUE 'F'.
  5523         16  CM-INSURED-JOINT-AGE          PIC 99.
  5524         16  CM-JOINT-INSURED-NAME.
  5525             20  CM-JT-LAST-NAME           PIC X(15).
  5526             20  CM-JT-FIRST-NAME.
  5527                 24  CM-JT-1ST-INIT        PIC X.
  5528                 24  FILLER                PIC X(9).
  5529             20  CM-JT-INITIAL             PIC X.
  5530
  5531     12  CM-LIFE-DATA.
  5532         16  CM-LF-BENEFIT-CD              PIC XX.
  5533         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5534         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5535         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5536         16  CM-LF-DEV-CODE                PIC XXX.
  5537         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5538         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5539         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5540         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 106
* EL156.cbl
  5541         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5542         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5543         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5544         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5545         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5546         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5547         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5548         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5549         16  FILLER                        PIC XX.
  5550
  5551     12  CM-AH-DATA.
  5552         16  CM-AH-BENEFIT-CD              PIC XX.
  5553         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5554         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5555         16  CM-AH-DEV-CODE                PIC XXX.
  5556         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5557         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5558         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5559         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5560         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5561         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5562         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5563         16  CM-AH-PAID-THRU-DT            PIC XX.
  5564             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5565         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5566         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5567         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5568         16  FILLER                        PIC X.
  5569
  5570     12  CM-LOAN-INFORMATION.
  5571         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5572         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5573                                           PIC S9(5)V99  COMP-3.
  5574         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5575         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5576         16  CM-PAY-FREQUENCY              PIC S99.
  5577         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5578         16  CM-RATE-CLASS                 PIC XX.
  5579         16  CM-BENEFICIARY                PIC X(25).
  5580         16  CM-POLICY-FORM-NO             PIC X(12).
  5581         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5582         16  CM-LAST-ADD-ON-DT             PIC XX.
  5583         16  CM-DEDUCTIBLE-AMOUNTS.
  5584             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5585             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5586         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5587             20  CM-RESIDENT-STATE         PIC XX.
  5588             20  CM-RATE-CODE              PIC X(4).
  5589             20  FILLER                    PIC XX.
  5590         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5591             20  CM-LOAN-OFFICER           PIC X(5).
  5592             20  FILLER                    PIC XXX.
  5593         16  CM-CSR-CODE                   PIC XXX.
  5594         16  CM-UNDERWRITING-CODE          PIC X.
  5595             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5596         16  CM-POST-CARD-IND              PIC X.
  5597         16  CM-NH-INTERFACE-SW            PIC X.
  5598         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 107
* EL156.cbl
  5599             88  CM-SING-PRM                  VALUE '1'.
  5600             88  CM-O-B-COVERAGE              VALUE '2'.
  5601             88  CM-OPEN-END                  VALUE '3'.
  5602         16  CM-IND-GRP-TYPE               PIC X.
  5603             88  CM-INDIVIDUAL                VALUE 'I'.
  5604             88  CM-GROUP                     VALUE 'G'.
  5605         16  CM-SKIP-CODE                  PIC X.
  5606             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5607             88  SKIP-JULY                    VALUE '1'.
  5608             88  SKIP-AUGUST                  VALUE '2'.
  5609             88  SKIP-SEPTEMBER               VALUE '3'.
  5610             88  SKIP-JULY-AUG                VALUE '4'.
  5611             88  SKIP-AUG-SEPT                VALUE '5'.
  5612             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5613             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5614             88  SKIP-JUNE                    VALUE '8'.
  5615             88  SKIP-JUNE-JULY               VALUE '9'.
  5616             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5617             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5618         16  CM-PAYMENT-MODE               PIC X.
  5619             88  PAY-MONTHLY                  VALUE SPACE.
  5620             88  PAY-WEEKLY                   VALUE '1'.
  5621             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5622             88  PAY-BI-WEEKLY                VALUE '3'.
  5623             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5624         16  CM-LOAN-NUMBER                PIC X(8).
  5625         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5626         16  CM-OLD-LOF                    PIC XXX.
  5627*        16  CM-LOAN-OFFICER               PIC XXX.
  5628         16  CM-REIN-TABLE                 PIC XXX.
  5629         16  CM-SPECIAL-REIN-CODE          PIC X.
  5630         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5631         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5632         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5633
  5634     12  CM-STATUS-DATA.
  5635         16  CM-ENTRY-STATUS               PIC X.
  5636         16  CM-ENTRY-DT                   PIC XX.
  5637
  5638         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5639         16  CM-LF-CANCEL-DT               PIC XX.
  5640         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5641
  5642         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5643         16  CM-LF-DEATH-DT                PIC XX.
  5644         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5645
  5646         16  CM-LF-CURRENT-STATUS          PIC X.
  5647             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5648                                                'M' '4' '5' '9'.
  5649             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5650             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5651             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5652             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5653             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5654             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5655             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5656             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 108
* EL156.cbl
  5657             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5658             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5659             88  CM-LF-DECLINED               VALUE 'D'.
  5660             88  CM-LF-VOIDED                 VALUE 'V'.
  5661
  5662         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5663         16  CM-AH-CANCEL-DT               PIC XX.
  5664         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5665
  5666         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5667         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5668         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5669
  5670         16  CM-AH-CURRENT-STATUS          PIC X.
  5671             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5672                                                'M' '4' '5' '9'.
  5673             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5674             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5675             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5676             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5677             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5678             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5679             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5680             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5681             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5682             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5683             88  CM-AH-DECLINED               VALUE 'D'.
  5684             88  CM-AH-VOIDED                 VALUE 'V'.
  5685
  5686         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5687             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5688             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5689             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5690         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5691
  5692         16  CM-ENTRY-BATCH                PIC X(6).
  5693         16  CM-LF-EXIT-BATCH              PIC X(6).
  5694         16  CM-AH-EXIT-BATCH              PIC X(6).
  5695         16  CM-LAST-MONTH-END             PIC XX.
  5696
  5697     12  CM-NOTE-SW                        PIC X.
  5698         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5699         88  CERT-NOTES-PRESENT               VALUE '1'.
  5700         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5701         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5702         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5703         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5704         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5705         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5706     12  CM-COMP-EXCP-SW                   PIC X.
  5707         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5708         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5709     12  CM-INSURED-ADDRESS-SW             PIC X.
  5710         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5711         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5712
  5713*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5714     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 109
* EL156.cbl
  5715     12  FILLER                            PIC X.
  5716
  5717*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5718     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5719     12  FILLER                            PIC X.
  5720*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5721     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5722
  5723     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5724         88  CERT-ADDED-BATCH                 VALUE ' '.
  5725         88  CERT-ADDED-ONLINE                VALUE '1'.
  5726         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5727         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5728         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5729     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5730         88  CERT-AS-LOADED                   VALUE ' '.
  5731         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5732         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5733         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5734         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5735         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5736         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5737         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5738
  5739     12  CM-ACCOUNT-COMM-PCTS.
  5740         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5741         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5742
  5743     12  CM-USER-FIELD                     PIC X.
  5744     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5745     12  CM-CLP-STATE                      PIC XX.
  5746     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5747     12  CM-USER-RESERVED                  PIC XXX.
  5748     12  FILLER REDEFINES CM-USER-RESERVED.
  5749         16  CM-AH-CLASS-CD                PIC XX.
  5750         16  F                             PIC X.
  5751******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 110
* EL156.cbl
  5753*    COPY ELCTRLR.
  5754******************************************************************
  5755*                                                                *
  5756*                            ELCTRLR.                            *
  5757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5758*                            VMOD=2.014                          *
  5759*                                                                *
  5760*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5761*                                                                *
  5762*   FILE TYPE = VSAM,KSDS                                        *
  5763*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5764*                                                                *
  5765*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5766*       ALTERNATE INDEX = NONE                                   *
  5767*                                                                *
  5768*   LOG = YES                                                    *
  5769*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5770******************************************************************
  5771*                   C H A N G E   L O G
  5772*
  5773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5774*-----------------------------------------------------------------
  5775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5776* EFFECTIVE    NUMBER
  5777*-----------------------------------------------------------------
  5778* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5779* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5780* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5781* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5782* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5783* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5784* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5785* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5786* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5787* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5788* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5789* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5790* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5791* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5792* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5793******************************************************************
  5794 01  ACTIVITY-TRAILERS.
  5795     12  AT-RECORD-ID                    PIC XX.
  5796         88  VALID-AT-ID                       VALUE 'AT'.
  5797
  5798     12  AT-CONTROL-PRIMARY.
  5799         16  AT-COMPANY-CD               PIC X.
  5800         16  AT-CARRIER                  PIC X.
  5801         16  AT-CLAIM-NO                 PIC X(7).
  5802         16  AT-CERT-NO.
  5803             20  AT-CERT-PRIME           PIC X(10).
  5804             20  AT-CERT-SFX             PIC X.
  5805         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5806             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5807             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5808             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5809             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5810             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 111
* EL156.cbl
  5811             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5812             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5813             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5814             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5815             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5816             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5817             88  AT-BENEFICIARY-TRL           VALUE +91.
  5818             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5819             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5820             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5821
  5822     12  AT-TRAILER-TYPE                 PIC X.
  5823         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5824         88  PAYMENT-TR                       VALUE '2'.
  5825         88  AUTO-PAY-TR                      VALUE '3'.
  5826         88  CORRESPONDENCE-TR                VALUE '4'.
  5827         88  ADDRESS-TR                       VALUE '5'.
  5828         88  GENERAL-INFO-TR                  VALUE '6'.
  5829         88  AUTO-PROMPT-TR                   VALUE '7'.
  5830         88  DENIAL-TR                        VALUE '8'.
  5831         88  INCURRED-CHG-TR                  VALUE '9'.
  5832         88  FORM-CONTROL-TR                  VALUE 'A'.
  5833
  5834     12  AT-RECORDED-DT                  PIC XX.
  5835     12  AT-RECORDED-BY                  PIC X(4).
  5836     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5837
  5838     12  AT-TRAILER-BODY                 PIC X(165).
  5839
  5840     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5841         16  AT-RESERVE-CONTROLS.
  5842             20  AT-MANUAL-SW            PIC X.
  5843                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5844             20  AT-FUTURE-SW            PIC X.
  5845                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5846             20  AT-PTC-SW               PIC X.
  5847                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5848             20  AT-IBNR-SW              PIC X.
  5849                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5850             20  AT-PTC-LF-SW            PIC X.
  5851                 88  AT-LF-PTC-USED          VALUE '1'.
  5852             20  AT-CDT-ACCESS-METHOD    PIC X.
  5853                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5854                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5855                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5856             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5857         16  AT-LAST-COMPUTED-DT         PIC XX.
  5858         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5859         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5860         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5861         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5862         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5863         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5864         16  AT-EXPENSE-CONTROLS.
  5865             20  AT-EXPENSE-METHOD       PIC X.
  5866                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5867                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5868                 88  PERCENT-OF-PMT           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 112
* EL156.cbl
  5869                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5870             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5871             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5872         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5873         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5874
  5875         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5876         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5877
  5878*        16  FILLER                      PIC X(53).
  5879         16  FILLER                      PIC X(47).
  5880
  5881         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5882         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5883
  5884         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5885             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5886             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5887*                    C = CLOSED
  5888*                    O = OPEN
  5889             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5890*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5891
  5892     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5893         16  AT-PAYMENT-TYPE             PIC X.
  5894             88  PARTIAL-PAYMENT                VALUE '1'.
  5895             88  FINAL-PAYMENT                  VALUE '2'.
  5896             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5897             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5898             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5899             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5900             88  VOIDED-PAYMENT                 VALUE '9'.
  5901             88  TRANSFER                       VALUE 'T'.
  5902             88  LIFE-INTEREST                  VALUE 'I'.
  5903
  5904         16  AT-CLAIM-TYPE               PIC X.
  5905             88  PAID-FOR-AH                    VALUE 'A'.
  5906             88  PAID-FOR-LIFE                  VALUE 'L'.
  5907             88  PAID-FOR-IUI                   VALUE 'I'.
  5908             88  PAID-FOR-GAP                   VALUE 'G'.
  5909         16  AT-CLAIM-PREM-TYPE          PIC X.
  5910             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5911             88  AT-O-B-COVERAGE                VALUE '2'.
  5912             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5913         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5914         16  AT-CHECK-NO                 PIC X(7).
  5915         16  AT-PAID-FROM-DT             PIC XX.
  5916         16  AT-PAID-THRU-DT             PIC XX.
  5917         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5918         16  FILLER                      PIC X.
  5919         16  AT-PAYEES-NAME              PIC X(30).
  5920         16  AT-PAYMENT-ORIGIN           PIC X.
  5921             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5922             88  ONLINE-AUTO-PMT                VALUE '2'.
  5923             88  OFFLINE-PMT                    VALUE '3'.
  5924         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5925         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5926         16  AT-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 113
* EL156.cbl
  5927             20  AT-VOID-DT              PIC XX.
  5928*00144       20  AT-VOID-REASON          PIC X(30).
  5929             20  AT-VOID-REASON          PIC X(26).
  5930         16  AT-PMT-APPROVED-BY          PIC X(04).
  5931         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5932         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5933         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5934                                         PIC S99V9(5)  COMP-3.
  5935         16  AT-CREDIT-INTERFACE.
  5936             20  AT-PMT-SELECT-DT        PIC XX.
  5937                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5938             20  AT-PMT-ACCEPT-DT        PIC XX.
  5939                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5940             20  AT-VOID-SELECT-DT       PIC XX.
  5941                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5942             20  AT-VOID-ACCEPT-DT       PIC XX.
  5943                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5944
  5945         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5946                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5947                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5948         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5949
  5950         16  AT-FORCE-CONTROL            PIC X.
  5951             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5952         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5953         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5954         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5955         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5956         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5957         16  AT-BENEFIT-TYPE             PIC X.
  5958
  5959         16  AT-EXPENSE-TYPE             PIC X.
  5960         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5961
  5962         16  AT-PAYEE-TYPE-CD.
  5963             20  AT-PAYEE-TYPE           PIC X.
  5964                 88  INSURED-PAID           VALUE 'I'.
  5965                 88  BENEFICIARY-PAID       VALUE 'B'.
  5966                 88  ACCOUNT-PAID           VALUE 'A'.
  5967                 88  OTHER-1-PAID           VALUE 'O'.
  5968                 88  OTHER-2-PAID           VALUE 'Q'.
  5969                 88  DOCTOR-PAID            VALUE 'P'.
  5970                 88  EMPLOYER-PAID          VALUE 'E'.
  5971             20  AT-PAYEE-SEQ            PIC X.
  5972
  5973         16  AT-CASH-PAYMENT             PIC X.
  5974         16  AT-GROUPED-PAYMENT          PIC X.
  5975         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5976         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5977         16  AT-APPROVED-LEVEL           PIC X.
  5978         16  AT-VOID-TYPE                PIC X.
  5979             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5980             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5981         16  AT-AIG-UNEMP-IND            PIC X.
  5982             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5983         16  AT-ASSOCIATES               PIC X.
  5984             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 114
* EL156.cbl
  5985             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5986
  5987         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5988         16  AT-CV-PMT-CODE              PIC X.
  5989             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5990             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5991             88  FULL-ADD-PAYMENT           VALUE '3'.
  5992             88  HALF-ADD-PAYMENT           VALUE '4'.
  5993             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5994             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5995             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5996             88  ADDL-PAYMENT               VALUE '8'.
  5997
  5998         16  AT-EOB-CODE1                PIC XXX.
  5999         16  AT-EOB-CODE2                PIC XXX.
  6000         16  AT-EOB-CODE3                PIC XXX.
  6001         16  FILLER REDEFINES AT-EOB-CODE3.
  6002             20  AT-PRINT-CLM-FORM       PIC X.
  6003             20  AT-PRINT-SURVEY         PIC X.
  6004             20  FILLER                  PIC X.
  6005         16  AT-EOB-CODE4                PIC XXX.
  6006         16  FILLER REDEFINES AT-EOB-CODE4.
  6007             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6008             20  FILLER                  PIC X.
  6009         16  AT-EOB-CODE5                PIC XXX.
  6010         16  FILLER REDEFINES AT-EOB-CODE5.
  6011             20  AT-PMT-PROOF-DT         PIC XX.
  6012             20  FILLER                  PIC X.
  6013
  6014         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6015             88  AT-PRINT-EOB            VALUE 'Y'.
  6016
  6017         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6018         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6019
  6020     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6021         16  AT-SCHEDULE-START-DT        PIC XX.
  6022         16  AT-SCHEDULE-END-DT          PIC XX.
  6023         16  AT-TERMINATED-DT            PIC XX.
  6024         16  AT-LAST-PMT-TYPE            PIC X.
  6025             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6026             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6027         16  AT-FIRST-PMT-DATA.
  6028             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6029             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6030             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6031         16  AT-REGULAR-PMT-DATA.
  6032             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6033             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6034             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6035         16  AT-AUTO-PAYEE-CD.
  6036             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6037                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6038                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6039                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6040                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6041                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6042             20  AT-AUTO-PAYEE-SEQ       PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 115
* EL156.cbl
  6043         16  AT-AUTO-PAY-DAY             PIC 99.
  6044         16  AT-AUTO-CASH                PIC X.
  6045             88  AT-CASH                      VALUE 'Y'.
  6046             88  AT-NON-CASH                  VALUE 'N'.
  6047*        16  FILLER                      PIC X(129).
  6048         16  AT-AUTO-END-LETTER          PIC X(4).
  6049         16  FILLER                      PIC X(125).
  6050
  6051         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6052         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6053
  6054     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6055         16  AT-LETTER-SENT-DT           PIC XX.
  6056         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6057         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6058         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6059         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6060         16  AT-LETTER-ORIGIN            PIC X.
  6061             88  ONLINE-CREATION              VALUE '1' '3'.
  6062             88  OFFLINE-CREATION             VALUE '2' '4'.
  6063             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6064             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6065         16  AT-STD-LETTER-FORM          PIC X(4).
  6066         16  AT-REASON-TEXT              PIC X(70).
  6067         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6068         16  AT-ADDRESEE-TYPE            PIC X.
  6069              88  INSURED-ADDRESEE            VALUE 'I'.
  6070              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6071              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6072              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6073              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6074              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6075              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6076         16  AT-ADDRESSEE-NAME           PIC X(30).
  6077         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6078         16  AT-RESEND-PRINT-DATE        PIC XX.
  6079         16  AT-CORR-SOL-UNSOL           PIC X.
  6080         16  AT-LETTER-PURGED-DT         PIC XX.
  6081*
  6082*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6083*
  6084         16  AT-CSO-REDEFINITION.
  6085             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6086             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6087             20  AT-LETTER-TO-BENE       PIC X(1).
  6088             20  AT-STOP-LETTER-DT       PIC X(2).
  6089             20  FILLER                  PIC X(19).
  6090*             20  FILLER                  PIC X(27).
  6091             20  AT-CSO-LETTER-STATUS    PIC X.
  6092                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6093                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6094                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6095             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6096             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6097*
  6098*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6099*
  6100*        16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 116
* EL156.cbl
  6101*
  6102*        16  AT-DMD-BSR-CODE             PIC X.
  6103*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6104*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6105*
  6106*        16  AT-DMD-LETTER-STATUS        PIC X.
  6107*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6108*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6109*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6110*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6111*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6112
  6113         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6114         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6115
  6116     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6117         16  AT-ADDRESS-TYPE             PIC X.
  6118             88  INSURED-ADDRESS               VALUE 'I'.
  6119             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6120             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6121             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6122             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6123             88  OTHER-ADDRESS-1               VALUE 'O'.
  6124             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6125         16  AT-MAIL-TO-NAME             PIC X(30).
  6126         16  AT-ADDRESS-LINE-1           PIC X(30).
  6127         16  AT-ADDRESS-LINE-2           PIC X(30).
  6128         16  AT-CITY-STATE.
  6129             20  AT-CITY                 PIC X(28).
  6130             20  AT-STATE                PIC XX.
  6131         16  AT-ZIP.
  6132             20  AT-ZIP-CODE.
  6133                 24  AT-ZIP-1ST          PIC X.
  6134                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6135                 24  FILLER              PIC X(4).
  6136             20  AT-ZIP-PLUS4            PIC X(4).
  6137         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6138             20  AT-CAN-POSTAL-1         PIC XXX.
  6139             20  AT-CAN-POSTAL-2         PIC XXX.
  6140             20  FILLER                  PIC XXX.
  6141         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6142*         16  FILLER                      PIC X(23).
  6143         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6144         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6145         16  FILLER                      PIC X(13).
  6146         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6147         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6148
  6149     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6150         16  AT-INFO-LINE-1              PIC X(60).
  6151         16  AT-INFO-LINE-2              PIC X(60).
  6152         16  AT-INFO-TRAILER-TYPE        PIC X.
  6153             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6154             88  AT-CALL-NOTE            VALUE 'C'.
  6155             88  AT-MAINT-NOTE           VALUE 'M'.
  6156             88  AT-CERT-CHANGE          VALUE 'X'.
  6157             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6158             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 117
* EL156.cbl
  6159         16  AT-CALL-TYPE                PIC X.
  6160             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6161             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6162         16  AT-NOTE-CONTINUATION        PIC X.
  6163             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6164         16  AT-EOB-CODES-EXIST          PIC X.
  6165             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6166         16  FILLER                      PIC X(35).
  6167         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6168         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6169
  6170     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6171         16  AT-PROMPT-LINE-1            PIC X(60).
  6172         16  AT-PROMPT-LINE-2            PIC X(60).
  6173         16  AT-PROMPT-START-DT          PIC XX.
  6174         16  AT-PROMPT-END-DT            PIC XX.
  6175         16  FILLER                      PIC X(35).
  6176         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6177         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6178
  6179     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6180         16  AT-DENIAL-INFO-1            PIC X(60).
  6181         16  AT-DENIAL-INFO-2            PIC X(60).
  6182         16  AT-DENIAL-DT                PIC XX.
  6183         16  AT-RETRACTION-DT            PIC XX.
  6184         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6185*         16  FILLER                      PIC X(31).
  6186         16  AT-DENIAL-PROOF-DT          PIC XX.
  6187         16  FILLER                      PIC X(29).
  6188         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6189         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6190
  6191     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6192         16  AT-OLD-INCURRED-DT          PIC XX.
  6193         16  AT-OLD-REPORTED-DT          PIC XX.
  6194         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6195         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6196         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6197         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6198         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6199         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6200         16  FILLER                      PIC X(26).
  6201         16  AT-OLD-DIAG-CODE            PIC X(6).
  6202         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6203         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6204         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6205         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6206         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6207         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6208         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6209         16  FILLER                      PIC X(25).
  6210         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6211
  6212     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6213         16  AT-FORM-SEND-ON-DT          PIC XX.
  6214         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6215         16  AT-FORM-RE-SEND-DT          PIC XX.
  6216         16  AT-FORM-ANSWERED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 118
* EL156.cbl
  6217         16  AT-FORM-PRINTED-DT          PIC XX.
  6218         16  AT-FORM-REPRINT-DT          PIC XX.
  6219         16  AT-FORM-TYPE                PIC X.
  6220             88  INITIAL-FORM                  VALUE '1'.
  6221             88  PROGRESS-FORM                 VALUE '2'.
  6222         16  AT-INSTRUCT-LN-1            PIC X(28).
  6223         16  AT-INSTRUCT-LN-2            PIC X(28).
  6224         16  AT-INSTRUCT-LN-3            PIC X(28).
  6225         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6226         16  AT-FORM-ADDRESS             PIC X.
  6227             88  FORM-TO-INSURED              VALUE 'I'.
  6228             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6229             88  FORM-TO-OTHER-1              VALUE 'O'.
  6230             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6231         16  AT-RELATED-1.
  6232             20 AT-REL-CARR-1            PIC X.
  6233             20 AT-REL-CLAIM-1           PIC X(7).
  6234             20 AT-REL-CERT-1            PIC X(11).
  6235         16  AT-RELATED-2.
  6236             20 AT-REL-CARR-2            PIC X.
  6237             20 AT-REL-CLAIM-2           PIC X(7).
  6238             20 AT-REL-CERT-2            PIC X(11).
  6239         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6240         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6241         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6242         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6243         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6244         16  AT-STOP-FORM-DT             PIC X(2).
  6245
  6246         16  FILLER                      PIC X(09).
  6247         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6248         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6249******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 119
* EL156.cbl
  6251*    COPY ELCACTQ.
  6252******************************************************************
  6253*                                                                *
  6254*                            ELCACTQ.                            *
  6255*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6256*                            VMOD=2.004                          *
  6257*                                                                *
  6258*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6259*                                                                *
  6260*   FILE TYPE = VSAM,KSDS                                        *
  6261*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6262*                                                                *
  6263*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6264*       ALTERNATE INDEX = NONE                                   *
  6265*                                                                *
  6266*   LOG = YES                                                    *
  6267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6268*                                                                *
  6269*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6270******************************************************************
  6271
  6272 01  ACTIVITY-QUE.
  6273     12  AQ-RECORD-ID                PIC XX.
  6274         88  VALID-AQ-ID                VALUE 'AQ'.
  6275
  6276     12  AQ-CONTROL-PRIMARY.
  6277         16  AQ-COMPANY-CD           PIC X.
  6278         16  AQ-CARRIER              PIC X.
  6279         16  AQ-CLAIM-NO             PIC X(7).
  6280         16  AQ-CERT-NO.
  6281             20  AQ-CERT-PRIME       PIC X(10).
  6282             20  AQ-CERT-SFX         PIC X.
  6283
  6284     12  AQ-PENDING-ACTIVITY-FLAGS.
  6285         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6286         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6287             88  PENDING-PAYMENTS       VALUE '1'.
  6288         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6289             88  PENDING-FULL-PRINT     VALUE '1'.
  6290             88  PENDING-PART-PRINT     VALUE '2'.
  6291         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6292             88  PENDING-LETTERS        VALUE '1'.
  6293         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6294             88  PENDING-RESTORE        VALUE 'C'.
  6295             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6296
  6297     12  FILLER                      PIC X(20).
  6298
  6299     12  AQ-RESEND-DATE              PIC XX.
  6300     12  AQ-FOLLOWUP-DATE            PIC XX.
  6301     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6302     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6303     12  AQ-AUTO-LETTER              PIC X(4).
  6304     12  FILLER                      PIC XX.
  6305     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6306*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 120
* EL156.cbl
  6308*    COPY ERCACCT.
  6309******************************************************************
  6310*                                                                *
  6311*                                                                *
  6312*                            ERCACCT                             *
  6313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6314*                            VMOD=2.031                          *
  6315*                                                                *
  6316*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6317*                                                                *
  6318*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6319*   VSAM ACCOUNT MASTER FILES.                                   *
  6320*                                                                *
  6321*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6322*                                                                *
  6323*   FILE TYPE = VSAM,KSDS                                        *
  6324*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6325*                                                                *
  6326*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6327*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6328*                                                                *
  6329*   LOG = NO                                                     *
  6330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6331*                                                                *
  6332*                                                                *
  6333******************************************************************
  6334*                   C H A N G E   L O G
  6335*
  6336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6337*-----------------------------------------------------------------
  6338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6339* EFFECTIVE    NUMBER
  6340*-----------------------------------------------------------------
  6341* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6342* 092705    2005050300006  PEMA  ADD SPP LEASES
  6343* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6344* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6345* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6346* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6347* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6348******************************************************************
  6349
  6350 01  ACCOUNT-MASTER.
  6351     12  AM-RECORD-ID                      PIC XX.
  6352         88  VALID-AM-ID                      VALUE 'AM'.
  6353
  6354     12  AM-CONTROL-PRIMARY.
  6355         16  AM-COMPANY-CD                 PIC X.
  6356         16  AM-MSTR-CNTRL.
  6357             20  AM-CONTROL-A.
  6358                 24  AM-CARRIER            PIC X.
  6359                 24  AM-GROUPING.
  6360                     28 AM-GROUPING-PREFIX PIC XXX.
  6361                     28 AM-GROUPING-PRIME  PIC XXX.
  6362                 24  AM-STATE              PIC XX.
  6363                 24  AM-ACCOUNT.
  6364                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6365                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 121
* EL156.cbl
  6366             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6367                                           PIC X(19).
  6368             20  AM-CNTRL-B.
  6369                 24  AM-EXPIRATION-DT      PIC XX.
  6370                 24  FILLER                PIC X(4).
  6371             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6372                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6373
  6374     12  AM-CONTROL-BY-VAR-GRP.
  6375         16  AM-COMPANY-CD-A1              PIC X.
  6376         16  AM-VG-CARRIER                 PIC X.
  6377         16  AM-VG-GROUPING                PIC X(6).
  6378         16  AM-VG-STATE                   PIC XX.
  6379         16  AM-VG-ACCOUNT                 PIC X(10).
  6380         16  AM-VG-DATE.
  6381             20  AM-VG-EXPIRATION-DT       PIC XX.
  6382             20  FILLER                    PIC X(4).
  6383         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6384                                           PIC 9(11)      COMP-3.
  6385     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6386         16  FILLER                        PIC X(10).
  6387         16  AM-VG-KEY3.
  6388             20  AM-VG3-ACCOUNT            PIC X(10).
  6389             20  AM-VG3-EXP-DT             PIC XX.
  6390         16  FILLER                        PIC X(4).
  6391     12  AM-MAINT-INFORMATION.
  6392         16  AM-LAST-MAINT-DT              PIC XX.
  6393         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6394         16  AM-LAST-MAINT-USER            PIC X(4).
  6395         16  FILLER                        PIC XX.
  6396
  6397     12  AM-EFFECTIVE-DT                   PIC XX.
  6398     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6399
  6400     12  AM-PREV-DATES  COMP-3.
  6401         16  AM-PREV-EXP-DT                PIC 9(11).
  6402         16  AM-PREV-EFF-DT                PIC 9(11).
  6403
  6404     12  AM-REPORT-CODE-1                  PIC X(10).
  6405     12  AM-REPORT-CODE-2                  PIC X(10).
  6406
  6407     12  AM-CITY-CODE                      PIC X(4).
  6408     12  AM-COUNTY-PARISH                  PIC X(6).
  6409
  6410     12  AM-NAME                           PIC X(30).
  6411     12  AM-PERSON                         PIC X(30).
  6412     12  AM-ADDRS                          PIC X(30).
  6413     12  AM-CITY.
  6414         16  AM-ADDR-CITY                  PIC X(28).
  6415         16  AM-ADDR-STATE                 PIC XX.
  6416     12  AM-ZIP.
  6417         16  AM-ZIP-PRIME.
  6418             20  AM-ZIP-PRI-1ST            PIC X.
  6419                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6420             20  FILLER                    PIC X(4).
  6421         16  AM-ZIP-PLUS4                  PIC X(4).
  6422     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6423         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 122
* EL156.cbl
  6424         16  AM-CAN-POSTAL-2               PIC XXX.
  6425         16  FILLER                        PIC XXX.
  6426     12  AM-TEL-NO.
  6427         16  AM-AREA-CODE                  PIC 999.
  6428         16  AM-TEL-PRE                    PIC 999.
  6429         16  AM-TEL-NBR                    PIC 9(4).
  6430     12  AM-TEL-LOC                        PIC X.
  6431         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6432         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6433
  6434     12  AM-COMM-STRUCTURE.
  6435         16  AM-DEFN-1.
  6436             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6437                 24  AM-AGT.
  6438                     28  AM-AGT-PREFIX     PIC X(4).
  6439                     28  AM-AGT-PRIME      PIC X(6).
  6440                 24  AM-COM-TYP            PIC X.
  6441                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6442                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6443                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6444                 24  AM-RECALC-LV-INDIC    PIC X.
  6445                 24  AM-RETRO-LV-INDIC     PIC X.
  6446                 24  AM-GL-CODES           PIC X.
  6447                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6448                 24  FILLER                PIC X(01).
  6449         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6450             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6451                 24  FILLER                PIC X(11).
  6452                 24  AM-L-COMA             PIC XXX.
  6453                 24  AM-J-COMA             PIC XXX.
  6454                 24  AM-A-COMA             PIC XXX.
  6455                 24  FILLER                PIC X(6).
  6456
  6457     12  AM-COMM-CHANGE-STATUS             PIC X.
  6458         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6459
  6460     12  AM-CSR-CODE                       PIC X(4).
  6461
  6462     12  AM-BILLING-STATUS                 PIC X.
  6463         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6464         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6465     12  AM-AUTO-REFUND-SW                 PIC X.
  6466         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6467         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6468     12  AM-GPCD                           PIC 99.
  6469     12  AM-IG                             PIC X.
  6470         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6471         88  AM-HAS-GROUP                     VALUE '2'.
  6472     12  AM-STATUS                         PIC X.
  6473         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6474         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6475         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6476         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6477         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6478         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6479     12  AM-REMIT-TO                       PIC 99.
  6480     12  AM-ID-NO                          PIC X(11).
  6481
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 123
* EL156.cbl
  6482     12  AM-CAL-TABLE                      PIC XX.
  6483     12  AM-LF-DEVIATION                   PIC XXX.
  6484     12  AM-AH-DEVIATION                   PIC XXX.
  6485     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6486     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6487     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6488     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6489     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6490     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6491
  6492     12  AM-USER-FIELDS.
  6493         16  AM-FLD-1                      PIC XX.
  6494         16  AM-FLD-2                      PIC XX.
  6495         16  AM-FLD-3                      PIC XX.
  6496         16  AM-FLD-4                      PIC XX.
  6497         16  AM-FLD-5                      PIC XX.
  6498
  6499     12  AM-1ST-PROD-DATE.
  6500         16  AM-1ST-PROD-YR                PIC XX.
  6501         16  AM-1ST-PROD-MO                PIC XX.
  6502         16  AM-1ST-PROD-DA                PIC XX.
  6503     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6504     12  AM-CERTS-PURGED-DATE.
  6505         16  AM-PUR-YR                     PIC XX.
  6506         16  AM-PUR-MO                     PIC XX.
  6507         16  AM-PUR-DA                     PIC XX.
  6508     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6509     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6510     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6511     12  AM-INACTIVE-DATE.
  6512         16  AM-INA-MO                     PIC 99.
  6513         16  AM-INA-DA                     PIC 99.
  6514         16  AM-INA-YR                     PIC 99.
  6515     12  AM-AR-HI-CERT-DATE                PIC XX.
  6516
  6517     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6518     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6519
  6520     12  AM-OB-PAYMENT-MODE                PIC X.
  6521         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6522         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6523         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6524         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6525
  6526     12  AM-AH-ONLY-INDICATOR              PIC X.
  6527         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6528         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6529
  6530     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6531
  6532     12  AM-OVER-SHORT.
  6533         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6534         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6535
  6536     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6537     12  AM-DCC-CLP-STATE                  PIC XX.
  6538
  6539     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 124
* EL156.cbl
  6540     12  AM-RECALC-REIN                    PIC X.
  6541
  6542     12  AM-REI-TABLE                      PIC XXX.
  6543     12  AM-REI-ET-LF                      PIC X.
  6544     12  AM-REI-ET-AH                      PIC X.
  6545     12  AM-REI-PE-LF                      PIC X.
  6546     12  AM-REI-PE-AH                      PIC X.
  6547     12  AM-REI-PRT-ST                     PIC X.
  6548     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6549     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6550     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6551     12  AM-REI-GROUP-A                    PIC X(6).
  6552     12  AM-REI-MORT                       PIC X(4).
  6553     12  AM-REI-PRT-OW                     PIC X.
  6554     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6555     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6556     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6557     12  AM-REI-GROUP-B                    PIC X(6).
  6558
  6559     12  AM-TRUST-TYPE                     PIC X(2).
  6560
  6561     12  AM-EMPLOYER-STMT-USED             PIC X.
  6562     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6563
  6564     12  AM-STD-AH-TYPE                    PIC XX.
  6565     12  AM-EARN-METHODS.
  6566         16  AM-EARN-METHOD-R              PIC X.
  6567             88 AM-REF-RL-R78                 VALUE 'R'.
  6568             88 AM-REF-RL-PR                  VALUE 'P'.
  6569             88 AM-REF-RL-MEAN                VALUE 'M'.
  6570             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6571         16  AM-EARN-METHOD-L              PIC X.
  6572             88 AM-REF-LL-R78                 VALUE 'R'.
  6573             88 AM-REF-LL-PR                  VALUE 'P'.
  6574             88 AM-REF-LL-MEAN                VALUE 'M'.
  6575             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6576         16  AM-EARN-METHOD-A              PIC X.
  6577             88 AM-REF-AH-R78                 VALUE 'R'.
  6578             88 AM-REF-AH-PR                  VALUE 'P'.
  6579             88 AM-REF-AH-MEAN                VALUE 'M'.
  6580             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6581             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6582             88 AM-REF-AH-NET                 VALUE 'N'.
  6583
  6584     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6585     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6586     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6587
  6588     12  AM-RET-Y-N                        PIC X.
  6589     12  AM-RET-P-E                        PIC X.
  6590     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6591     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6592     12  AM-RET-GRP                        PIC X(6).
  6593     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6594         16  AM-POOL-PRIME                 PIC XXX.
  6595         16  AM-POOL-SUB                   PIC XXX.
  6596     12  AM-RETRO-EARNINGS.
  6597         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 125
* EL156.cbl
  6598         16  AM-RET-EARN-L                 PIC X.
  6599         16  AM-RET-EARN-A                 PIC X.
  6600     12  AM-RET-ST-TAX-USE                 PIC X.
  6601         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6602         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6603     12  AM-RETRO-BEG-EARNINGS.
  6604         16  AM-RET-BEG-EARN-R             PIC X.
  6605         16  AM-RET-BEG-EARN-L             PIC X.
  6606         16  AM-RET-BEG-EARN-A             PIC X.
  6607     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6608     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6609
  6610     12  AM-USER-SELECT-OPTIONS.
  6611         16  AM-USER-SELECT-1              PIC X(10).
  6612         16  AM-USER-SELECT-2              PIC X(10).
  6613         16  AM-USER-SELECT-3              PIC X(10).
  6614         16  AM-USER-SELECT-4              PIC X(10).
  6615         16  AM-USER-SELECT-5              PIC X(10).
  6616
  6617     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6618
  6619     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6620
  6621     12  AM-RPT045A-SWITCH                 PIC X.
  6622         88  RPT045A-OFF                   VALUE 'N'.
  6623
  6624     12  AM-INSURANCE-LIMITS.
  6625         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6626         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6627
  6628     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6629         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6630
  6631     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6632         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6633         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6634
  6635     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6636
  6637     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6638     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6639     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6640     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6641     12  AM-DCC-UEF-STATE                  PIC XX.
  6642     12  FILLER                            PIC XXX.
  6643     12  AM-REPORT-CODE-3                  PIC X(10).
  6644*    12  FILLER                            PIC X(22).
  6645
  6646     12  AM-RESERVE-DATE.
  6647         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6648         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6649         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6650
  6651     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6652     12  AM-NOTIFICATION-TYPES.
  6653         16  AM-NOTIF-OF-LETTERS           PIC X.
  6654         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6655         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 126
* EL156.cbl
  6656         16  AM-NOTIF-OF-STATUS            PIC X.
  6657
  6658     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6659         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6660         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6661         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6662         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6663
  6664     12  AM-BENEFIT-CONTROLS.
  6665         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6666             20  AM-BENEFIT-CODE           PIC XX.
  6667             20  AM-BENEFIT-TYPE           PIC X.
  6668             20  AM-BENEFIT-REVISION       PIC XXX.
  6669             20  AM-BENEFIT-REM-TERM       PIC X.
  6670             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6671             20  FILLER                    PIC XX.
  6672         16  FILLER                        PIC X(80).
  6673
  6674     12  AM-TRANSFER-DATA.
  6675         16  AM-TRANSFERRED-FROM.
  6676             20  AM-TRNFROM-CARRIER        PIC X.
  6677             20  AM-TRNFROM-GROUPING.
  6678                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6679                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6680             20  AM-TRNFROM-STATE          PIC XX.
  6681             20  AM-TRNFROM-ACCOUNT.
  6682                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6683                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6684             20  AM-TRNFROM-DTE            PIC XX.
  6685         16  AM-TRANSFERRED-TO.
  6686             20  AM-TRNTO-CARRIER          PIC X.
  6687             20  AM-TRNTO-GROUPING.
  6688                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6689                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6690             20  AM-TRNTO-STATE            PIC XX.
  6691             20  AM-TRNTO-ACCOUNT.
  6692                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6693                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6694             20  AM-TRNTO-DTE              PIC XX.
  6695         16  FILLER                        PIC X(10).
  6696
  6697     12  AM-SAVED-REMIT-TO                 PIC 99.
  6698
  6699     12  AM-COMM-STRUCTURE-SAVED.
  6700         16  AM-DEFN-1-SAVED.
  6701             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6702                 24  AM-AGT-SV             PIC X(10).
  6703                 24  AM-COM-TYP-SV         PIC X.
  6704                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6705                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6706                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6707                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6708                 24  FILLER                PIC X.
  6709                 24  AM-GL-CODES-SV        PIC X.
  6710                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6711                 24  FILLER                PIC X.
  6712         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6713             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 127
* EL156.cbl
  6714                 24  FILLER                PIC X(11).
  6715                 24  AM-L-COMA-SV          PIC XXX.
  6716                 24  AM-J-COMA-SV          PIC XXX.
  6717                 24  AM-A-COMA-SV          PIC XXX.
  6718                 24  FILLER                PIC X(6).
  6719
  6720     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6721         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6722            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6723            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6724            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6725
  6726     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6727     12  FILLER                            PIC X(120).
  6728
  6729     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6730         16  AM-CONTROL-NAME               PIC X(30).
  6731         16  AM-EXECUTIVE-ONE.
  6732             20  AM-EXEC1-NAME             PIC X(15).
  6733             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6734                                                          COMP-3.
  6735             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6736                                                          COMP-3.
  6737         16  AM-EXECUTIVE-TWO.
  6738             20  AM-EXEC2-NAME             PIC X(15).
  6739             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6740                                                          COMP-3.
  6741             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6742                                                          COMP-3.
  6743
  6744     12  AM-RETRO-ADDITIONAL-DATA.
  6745         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6746         16  AM-RETRO-PREM-P-E             PIC X.
  6747         16  AM-RETRO-CLMS-P-I             PIC X.
  6748         16  AM-RETRO-RET-BRACKET-LF.
  6749             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6750                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6751                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6752             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6753                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6754                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6755             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6756                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6757                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6758         16  AM-RETRO-RET-BRACKET-AH.
  6759             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6760                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6761                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6762                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6763             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6764                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6765                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6766             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6767                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6768                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6769
  6770     12  AM-COMMENTS.
  6771         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 128
* EL156.cbl
  6772
  6773     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6774         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6775         16  AM-FLI-BILLING-CODE           PIC X.
  6776         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6777         16  AM-FLI-UNITED-IDENT           PIC X.
  6778         16  AM-FLI-INTEREST-LOST-DATA.
  6779             20  AM-FLI-BANK-NO            PIC X(5).
  6780             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6781             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6782             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6783         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6784             20  AM-FLI-AGT                PIC X(9).
  6785             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6786             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6787         16  FILLER                        PIC X(102).
  6788
  6789     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6790         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6791             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6792             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6793             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6794             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6795             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6796         16  FILLER                          PIC X(10).
  6797******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 129
* EL156.cbl
  6799*    COPY ELCCHKQ.
  6800******************************************************************
  6801*                                                                *
  6802*                                                                *
  6803*                            ELCCHKQ.                            *
  6804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6805*                            VMOD=2.007                          *
  6806*                                                                *
  6807*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6808*                                                                *
  6809*   FILE TYPE = VSAM,KSDS                                        *
  6810*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6811*                                                                *
  6812*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6813*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6814*                                                                *
  6815*   LOG = YES                                                    *
  6816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6817******************************************************************
  6818 01  CHECK-QUE.
  6819     12  CQ-RECORD-ID                PIC XX.
  6820         88  VALID-CQ-ID         VALUE 'CQ'.
  6821
  6822     12  CQ-CONTROL-PRIMARY.
  6823         16  CQ-COMPANY-CD           PIC X.
  6824         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6825         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6826
  6827     12  CQ-CONTROL-BY-PAYEE.
  6828         16  CQ-CONTROL-BY-NUMBER.
  6829             20  CQ-COMPANY-CD-A1     PIC X.
  6830             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6831         16  CQ-PAYEE-CARRIER        PIC X.
  6832         16  CQ-PAYEE-GROUPING       PIC X(6).
  6833         16  CQ-PAYEE-STATE          PIC XX.
  6834         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6835         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6836
  6837     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6838         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6839         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6840         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6841         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6842         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6843         16  FILLER                  PIC X(3).
  6844
  6845     12  CQ-ENTRY-TYPE               PIC X.
  6846             88  CHECK-ON-QUE           VALUE 'Q'.
  6847             88  ALIGNMENT-CHECK        VALUE 'A'.
  6848             88  SPOILED-CHECK          VALUE 'S'.
  6849             88  PAYMENT-ABORTED        VALUE 'X'.
  6850
  6851     12  CQ-CLAIM-MAST-CNTL.
  6852         16  CQ-CARRIER              PIC X.
  6853         16  CQ-CLAIM-NO             PIC X(7).
  6854         16  CQ-CERT-NO.
  6855             20  CQ-CERT-PRIME       PIC X(10).
  6856             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 130
* EL156.cbl
  6857         16  CQ-CLAIM-TYPE           PIC X.
  6858             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6859             88  CQ-AH-CLAIM            VALUE 'A'.
  6860         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6861             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6862             88  CQ-O-B-COVERAGE        VALUE '2'.
  6863             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6864
  6865     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6866     12  CQ-CHECK-NUMBER             PIC X(7).
  6867     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6868     12  CQ-PAYMENT-TYPE             PIC X.
  6869             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6870             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6871             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6872             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6873             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6874             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6875             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6876             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6877     12  CQ-VOID-INDICATOR           PIC X.
  6878             88  CHECK-IS-STOPPED          VALUE 'S'.
  6879             88  CHECK-IS-VOID             VALUE 'V'.
  6880     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6881     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6882     12  CQ-CHECK-BY-USER            PIC X(4).
  6883     12  CQ-PRE-NUMBERING-SW         PIC X.
  6884       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6885       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6886
  6887     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6888     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6889     12  CQ-LEDGER-FLAG              PIC X(01).
  6890     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6891     12  CQ-LAST-UPDATED-DT          PIC XX.
  6892     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6893     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6894
  6895     12  FILLER                      PIC X(04).
  6896
  6897******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 131
* EL156.cbl
  6899*    COPY ELCBENE.
  6900******************************************************************
  6901*                                                                *
  6902*                            ELCBENE.                            *
  6903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6904*                            VMOD=2.006                          *
  6905*                                                                *
  6906*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6907*                                                                *
  6908*   FILE TYPE = VSAM,KSDS                                        *
  6909*   RECORD SIZE = 500   RECFORM = FIX                            *
  6910*                                                                *
  6911*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6912*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6913*                                                                *
  6914*   LOG = YES                                                    *
  6915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6916*                                                                *
  6917*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6918******************************************************************
  6919
  6920 01  BENEFICIARY-MASTER.
  6921     12  BE-RECORD-ID                PIC XX.
  6922         88  VALID-BE-ID                VALUE 'BE'.
  6923
  6924     12  BE-CONTROL-PRIMARY.
  6925         16  BE-COMPANY-CD           PIC X.
  6926         16  BE-RECORD-TYPE          PIC X.
  6927             88  BENEFICIARY-RECORD  VALUE 'B'.
  6928             88  ADJUSTOR-RECORD     VALUE 'A'.
  6929         16  BE-BENEFICIARY          PIC X(10).
  6930     12  BE-CONTROL-BY-NAME.
  6931         16  BE-COMPANY-CD-A1        PIC X.
  6932         16  BE-RECORD-TYPE-A1       PIC X.
  6933         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6934         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6935
  6936     12  BE-LAST-MAINT-DT            PIC XX.
  6937     12  BE-LAST-MAINT-BY            PIC X(4).
  6938     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6939
  6940     12  BE-ADDRESS-DATA.
  6941         16  BE-MAIL-TO-NAME         PIC X(30).
  6942         16  BE-ADDRESS-LINE-1       PIC X(30).
  6943         16  BE-ADDRESS-LINE-2       PIC X(30).
  6944         16  BE-ADDRESS-LINE-3       PIC X(30).
  6945         16  BE-CITY-STATE.
  6946             20  BE-CITY             PIC X(28).
  6947             20  BE-STATE            PIC XX.
  6948         16  BE-ZIP-CODE.
  6949             20  BE-ZIP-PRIME.
  6950                 24  BE-ZIP-1ST      PIC X.
  6951                     88  BE-CANADIAN-POST-CODE
  6952                                         VALUE 'A' THRU 'Z'.
  6953                 24  FILLER          PIC X(4).
  6954             20  BE-ZIP-PLUS4        PIC X(4).
  6955         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6956             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 132
* EL156.cbl
  6957             20  BE-CAN-POSTAL-2     PIC XXX.
  6958             20  FILLER              PIC XXX.
  6959         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6960         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6961
  6962******************************************************************
  6963*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6964*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6965******************************************************************
  6966     12  BE-CARRIER                  PIC X.
  6967
  6968     12  BE-ADDRESS-DATA2.
  6969         16  BE-MAIL-TO-NAME2        PIC X(30).
  6970         16  BE-ADDRESS-LINE-12      PIC X(30).
  6971         16  BE-ADDRESS-LINE-22      PIC X(30).
  6972         16  BE-ADDRESS-LINE-32      PIC X(30).
  6973         16  BE-CITY-STATE2.
  6974             20  BE-CITY2            PIC X(28).
  6975             20  BE-STATE2           PIC XX.
  6976         16  BE-ZIP-CODE2.
  6977             20  BE-ZIP-PRIME2.
  6978                 24  BE-ZIP-1ST2     PIC X.
  6979                     88  BE-CANADIAN-POST-CODE2
  6980                                         VALUE 'A' THRU 'Z'.
  6981                 24  FILLER          PIC X(4).
  6982             20  BE-ZIP-PLUS42       PIC X(4).
  6983         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6984             20  BE-CAN-POSTAL-12    PIC XXX.
  6985             20  BE-CAN-POSTAL-22    PIC XXX.
  6986             20  FILLER              PIC XXX.
  6987         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6988         16  BE-BILLING-STMT-DATA.
  6989             20  BE-BSR              PIC X.
  6990                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6991                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6992             20  BE-BSR-FROM         PIC X(30).
  6993             20  BE-BSR-DEPT         PIC X(30).
  6994             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6995             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6996             20  BE-OUTPUT-TYPE      PIC X.
  6997                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6998                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6999
  7000     12  FILLER                      PIC X(28).
  7001******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 133
* EL156.cbl
  7003*    COPY ELCARCH.
  7004******************************************************************
  7005*                                                                *
  7006*                            ELCARCH.                            *
  7007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7008*                            VMOD=2.007                          *
  7009*                                                                *
  7010*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7011*                                                                *
  7012*   FILE TYPE = VSAM,KSDS                                        *
  7013*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7014*                                                                *
  7015*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7016*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7017*                                                                *
  7018*   LOG = NO                                                     *
  7019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7020*                                                                *
  7021*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7022******************************************************************
  7023 01  LETTER-ARCHIVE.
  7024     12  LA-RECORD-ID                PIC XX.
  7025         88  VALID-LA-ID                VALUE 'LA'.
  7026
  7027     12  LA-CONTROL-PRIMARY.
  7028         16  LA-COMPANY-CD           PIC X.
  7029         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7030         16  LA-RECORD-TYPE          PIC X.
  7031             88  LA-HEADER-DATA         VALUE '1'.
  7032             88  LA-ADDRESS-DATA        VALUE '2'.
  7033             88  LA-TEXT-DATA           VALUE '3'.
  7034             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7035         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7036
  7037     12  LA-CONTROL-BY-TYPE.
  7038         16  LA-COMPANY-CD-A1        PIC X.
  7039         16  LA-RECORD-TYPE-A1       PIC X.
  7040         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7041         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7042
  7043     12  LA-TEXT-RECORD.
  7044         16  LA-SKIP-CONTROL         PIC XX.
  7045             88  NO-LINES-SKIPPED       VALUE SPACES.
  7046             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7047         16  LA-TEXT-LINE            PIC X(70).
  7048
  7049     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7050         16  FILLER                  PIC XX.
  7051         16  LA-ADDRESS-LINE         PIC X(30).
  7052         16  FILLER                  PIC X(40).
  7053
  7054     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7055         16  FILLER                  PIC XX.
  7056         16  LA-CARRIER              PIC X.
  7057         16  LA-CLAIM-NO             PIC X(7).
  7058         16  LA-CERT-NO.
  7059             20  LA-CERT-PRIME       PIC X(10).
  7060             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 134
* EL156.cbl
  7061         16  LA-NO-OF-COPIES         PIC S9.
  7062         16  LA-RESEND-DATE          PIC XX.
  7063         16  LA-PROCESSOR-CD         PIC X(4).
  7064         16  LA-CREATION-DT          PIC XX.
  7065         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7066         16  LA-RESEND-PRINT-DATE    PIC XX.
  7067         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7068         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7069*
  7070* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7071*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7072*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7073*   I        20  LA-DMD-RES-ST           PIC XX.
  7074*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7075*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7076*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7077*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7078*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7079*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7080*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7081*   I        20  LA-DMD-UND-CODE         PIC XX.
  7082*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7083*   V    16  FILLER                  PIC X(15).
  7084* -----
  7085*
  7086* REINSERTED  CSO  MODS
  7087*
  7088         16  FILLER.
  7089             20  FILLER                  PIC X(29).
  7090             20  LA-CSO-LETTER-STATUS    PIC X.
  7091                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7092                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7093                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7094             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7095             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7096*
  7097
  7098     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7099         16  FILLER                  PIC XX.
  7100         16  LA4-CARRIER             PIC X.
  7101         16  LA4-CLAIM-NO            PIC X(7).
  7102         16  LA4-CERT-NO.
  7103             20  LA4-CERT-PRIME      PIC X(10).
  7104             20  LA4-CERT-SFX        PIC X.
  7105         16  LA4-NO-OF-COPIES        PIC S9.
  7106         16  LA4-RESEND-DATE         PIC XX.
  7107         16  LA4-PROCESSOR-CD        PIC X(4).
  7108         16  LA4-CREATION-DT         PIC XX.
  7109         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7110         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7111         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7112         16  LA4-FORM-TYPE           PIC X.
  7113             88  LA4-INITIAL-FORM    VALUE '1'.
  7114             88  LA4-PROGRESS-FORM   VALUE '2'.
  7115         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7116         16  LA4-STATE               PIC X(02).
  7117         16  FILLER                  PIC X(31).
  7118******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 135
* EL156.cbl
  7120*    COPY ELCDAR.
  7121******************************************************************
  7122*                                                                *
  7123*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7124*   FILE TYPE = VSAM,KSDS                                        *
  7125*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7126*   BASE CLUSTER = DLYACTV                                       *
  7127*   LOG = YES                                                    *
  7128*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7129*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7130*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7131*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7132*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7133*               BY PROGRAM "LGINFCE".                            *
  7134*                                                                *
  7135******************************************************************
  7136 01  DAILY-ACTIVITY-RECORD.
  7137     05  DA-KEY.
  7138         10  DA-COMP-CD          PIC X.
  7139         10  DA-CARRIER          PIC X.
  7140         10  DA-CLAIM-NO         PIC X(7).
  7141         10  DA-CERT-NO.
  7142             15  DA-CERT-PRIME   PIC X(10).
  7143             15  DA-CERT-SFX     PIC X.
  7144     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7145     05  DA-RECORD-TYPE          PIC X.
  7146     05  FILLER                  PIC X(2).
  7147******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 136
* EL156.cbl
  7149*    COPY ERCCOMP.
  7150******************************************************************
  7151*                                                                *
  7152*                                                                *
  7153*                            ERCCOMP                             *
  7154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7155*                            VMOD=2.019                          *
  7156*                                                                *
  7157*   ONLINE CREDIT SYSTEM                                         *
  7158*                                                                *
  7159*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7160*                                                                *
  7161*   FILE TYPE = VSAM,KSDS                                        *
  7162*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7163*                                                                *
  7164*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7165*       ALTERNATE PATH = NONE                                    *
  7166*                                                                *
  7167*   LOG = NO                                                     *
  7168*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7169*                                                                *
  7170******************************************************************
  7171*                   C H A N G E   L O G
  7172*
  7173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7174*-----------------------------------------------------------------
  7175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7176* EFFECTIVE    NUMBER
  7177*-----------------------------------------------------------------
  7178* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7179* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7180* 092205    2005050300006  PEMA  ADD LEASE FEE
  7181* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7182* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7183* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7184* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7185* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7186* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7187******************************************************************
  7188
  7189 01  COMPENSATION-MASTER.
  7190     12  CO-RECORD-ID                          PIC XX.
  7191         88  VALID-CO-ID                          VALUE 'CO'.
  7192
  7193     12  CO-CONTROL-PRIMARY.
  7194         16  CO-COMPANY-CD                     PIC X.
  7195         16  CO-CONTROL.
  7196             20  CO-CTL-1.
  7197                 24  CO-CARR-GROUP.
  7198                     28  CO-CARRIER            PIC X.
  7199                     28  CO-GROUPING.
  7200                         32  CO-GROUP-PREFIX   PIC XXX.
  7201                         32  CO-GROUP-PRIME    PIC XXX.
  7202                 24  CO-RESP-NO.
  7203                     28  CO-RESP-PREFIX        PIC X(4).
  7204                     28  CO-RESP-PRIME         PIC X(6).
  7205             20  CO-CTL-2.
  7206                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 137
* EL156.cbl
  7207                     28  CO-ACCT-PREFIX        PIC X(4).
  7208                     28  CO-ACCT-PRIME         PIC X(6).
  7209         16  CO-TYPE                           PIC X.
  7210             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7211             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7212             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7213
  7214     12  CO-MAINT-INFORMATION.
  7215         16  CO-LAST-MAINT-DT                  PIC XX.
  7216         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7217         16  CO-LAST-MAINT-USER                PIC X(4).
  7218     12  FILLER                                PIC XX.
  7219     12  CO-STMT-TYPE                          PIC XXX.
  7220     12  CO-COMP-TYPE                          PIC X.
  7221         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7222     12  CO-STMT-OWNER                         PIC X(4).
  7223     12  CO-BALANCE-CONTROL                    PIC X.
  7224         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7225         88  CO-NO-BALANCE                        VALUE 'N'.
  7226
  7227     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7228         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7229         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7230         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7231
  7232     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7233         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7234         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7235
  7236     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7237     12  CO-GA-DIRECT-DEP                      PIC X.
  7238     12  CO-FUTURE-SPACE                       PIC X.
  7239         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7240
  7241     12  CO-ACCT-NAME                          PIC X(30).
  7242     12  CO-MAIL-NAME                          PIC X(30).
  7243     12  CO-ADDR-1                             PIC X(30).
  7244     12  CO-ADDR-2                             PIC X(30).
  7245     12  CO-ADDR-3.
  7246         16  CO-ADDR-CITY                      PIC X(27).
  7247         16  CO-ADDR-STATE                     PIC XX.
  7248     12  CO-CSO-1099                           PIC X.
  7249     12  CO-ZIP.
  7250         16  CO-ZIP-PRIME.
  7251             20  CO-ZIP-PRI-1ST                PIC X.
  7252                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7253             20  FILLER                        PIC X(4).
  7254         16  CO-ZIP-PLUS4                      PIC X(4).
  7255     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7256         16  CO-CAN-POSTAL-1                   PIC XXX.
  7257         16  CO-CAN-POSTAL-2                   PIC XXX.
  7258         16  FILLER                            PIC XXX.
  7259     12  CO-SOC-SEC                            PIC X(13).
  7260     12  CO-TELEPHONE.
  7261         16  CO-AREA-CODE                      PIC XXX.
  7262         16  CO-PREFIX                         PIC XXX.
  7263         16  CO-PHONE                          PIC X(4).
  7264
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 138
* EL156.cbl
  7265     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7266
  7267     12  CO-AR-BAL-LEVEL                       PIC X.
  7268         88  CO-AR-REF-LVL                        VALUE '1'.
  7269         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7270         88  CO-AR-BILL-LVL                       VALUE '2'.
  7271         88  CO-AR-AGT-LVL                        VALUE '3'.
  7272         88  CO-AR-FR-LVL                         VALUE '4'.
  7273
  7274     12  CO-AR-NORMAL-PRINT                    PIC X.
  7275         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7276         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7277
  7278     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7279
  7280     12  CO-AR-REPORTING                       PIC X.
  7281         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7282         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7283
  7284     12  CO-AR-PULL-CHECK                      PIC X.
  7285         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7286         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7287
  7288     12  CO-AR-BALANCE-PRINT                   PIC X.
  7289         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7290
  7291     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7292         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7293         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7294         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7295
  7296     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7297
  7298     12  CO-USER-CODE                          PIC X.
  7299     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7300
  7301******************************************************************
  7302*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7303*    THE LAST MONTH END RUN.
  7304******************************************************************
  7305
  7306     12  CO-LAST-ACTIVITY-DATE.
  7307         16  CO-ACT-YEAR                       PIC 99.
  7308         16  CO-ACT-MONTH                      PIC 99.
  7309         16  CO-ACT-DAY                        PIC 99.
  7310
  7311     12  CO-LAST-STMT-DT.
  7312         16  CO-LAST-STMT-YEAR                 PIC 99.
  7313         16  CO-LAST-STMT-MONTH                PIC 99.
  7314         16  CO-LAST-STMT-DAY                  PIC 99.
  7315
  7316     12  CO-MO-END-TOTALS.
  7317         16  CO-MONTHLY-TOTALS.
  7318             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7319             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7320             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7321             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7322             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 139
* EL156.cbl
  7323
  7324         16  CO-AGING-TOTALS.
  7325             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7326             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7327             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7328             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7329
  7330         16  CO-YTD-TOTALS.
  7331             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7332             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7333
  7334         16  CO-OVER-UNDER-TOTALS.
  7335             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7336             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7337
  7338     12  CO-MISCELLANEOUS-TOTALS.
  7339         16  CO-FICA-TOTALS.
  7340             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7341             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7342
  7343         16  CO-CLAIM-TOTALS.
  7344             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7345             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7346
  7347******************************************************************
  7348*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7349*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7350******************************************************************
  7351
  7352     12  CO-CURRENT-TOTALS.
  7353         16  CO-CURRENT-LAST-STMT-DT.
  7354             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7355             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7356             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7357
  7358         16  CO-CURRENT-MONTHLY-TOTALS.
  7359             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7360             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7361             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7362             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7363             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7364
  7365         16  CO-CURRENT-AGING-TOTALS.
  7366             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7367             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7368             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7369             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7370
  7371         16  CO-CURRENT-YTD-TOTALS.
  7372             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7373             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7374
  7375     12  CO-PAID-COMM-TOTALS.
  7376         16  CO-YTD-PAID-COMMS.
  7377             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7378             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7379
  7380     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 140
* EL156.cbl
  7381         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7382         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7383
  7384     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7385         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7386         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7387         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7388         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7389         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7390         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7391         88  CO-FINAL-LETTER                  VALUE 'F'.
  7392         88  CO-RECONCILING                   VALUE 'R'.
  7393         88  CO-PHONE-CALL                    VALUE 'P'.
  7394         88  CO-LEGAL                         VALUE 'L'.
  7395         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7396         88  CO-WRITE-OFF                     VALUE 'W'.
  7397         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7398
  7399     12  CO-CSR-CODE                       PIC X(4).
  7400
  7401     12  CO-GA-STATUS-INFO.
  7402         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7403         16  CO-GA-TERMINATION-DT          PIC XX.
  7404         16  CO-GA-STATUS-CODE             PIC X.
  7405             88  CO-GA-ACTIVE                 VALUE 'A'.
  7406             88  CO-GA-INACTIVE               VALUE 'I'.
  7407             88  CO-GA-PENDING                VALUE 'P'.
  7408         16  CO-GA-COMMENTS.
  7409             20  CO-GA-COMMENT-1           PIC X(40).
  7410             20  CO-GA-COMMENT-2           PIC X(40).
  7411             20  CO-GA-COMMENT-3           PIC X(40).
  7412             20  CO-GA-COMMENT-4           PIC X(40).
  7413
  7414     12  CO-RPTCD2                         PIC X(10).
  7415     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7416         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7417         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7418
  7419     12  CO-TYPE-AGENT                     PIC X(01).
  7420         88  CO-CORPORATION                   VALUE 'C'.
  7421         88  CO-PARTNERSHIP                   VALUE 'P'.
  7422         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7423         88  CO-TRUST                         VALUE 'T'.
  7424         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7425
  7426     12  CO-FAXNO.
  7427         16  CO-FAX-AREA-CODE                  PIC XXX.
  7428         16  CO-FAX-PREFIX                     PIC XXX.
  7429         16  CO-FAX-PHONE                      PIC X(4).
  7430
  7431     12  CO-BANK-INFORMATION.
  7432         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7433         16  CO-BANK-TRANSIT-NON REDEFINES
  7434             CO-BANK-TRANSIT-NO                PIC 9(8).
  7435
  7436         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7437     12  CO-MISC-DEDUCT-INFO REDEFINES
  7438                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 141
* EL156.cbl
  7439         16  CO-MD-GL-ACCT                     PIC X(10).
  7440         16  CO-MD-DIV                         PIC XX.
  7441         16  CO-MD-CENTER                      PIC X(4).
  7442         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7443         16  CO-CREATE-AP-CHECK                PIC X.
  7444         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7445         16  FILLER                            PIC XXX.
  7446     12  CO-ACH-STATUS                         PIC X.
  7447         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7448         88  CO-ACH-PENDING                        VALUE 'P'.
  7449
  7450     12  CO-BILL-SW                            PIC X.
  7451     12  CO-CONTROL-NAME                       PIC X(30).
  7452     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7453     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7454     12  CO-CLP-STATE                          PIC XX.
  7455     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7456     12  CO-SPP-REFUND-EDIT                    PIC X.
  7457
  7458******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 142
* EL156.cbl
  7460*    COPY ERCDMDNT.
  7461******************************************************************
  7462*                                                                *
  7463*                            ERCDMDNT                            *
  7464*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7465*                            VMOD=2.005                          *
  7466*                                                                *
  7467*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7468*                                                                *
  7469*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7470*                                                                *
  7471*        FILE TYPE= VSAM,KSDS                                    *
  7472*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7473*                                                                *
  7474*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7475*                                                                *
  7476*        LOG = YES                                               *
  7477*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7478*                                                                *
  7479******************************************************************
  7480
  7481 01  CERTIFICATE-NOTE.
  7482     12  CN-RECORD-ID                     PIC  XX.
  7483         88  VALID-CN-ID                      VALUE 'CN'.
  7484
  7485     12  CN-CONTROL-PRIMARY.
  7486         16  CN-COMPANY-CD                PIC X.
  7487         16  CN-CERT-KEY.
  7488             20  CN-CARRIER               PIC X.
  7489             20  CN-GROUPING.
  7490                 24  CN-GROUPING-PREFIX   PIC XXX.
  7491                 24  CN-GROUPING-PRIME    PIC XXX.
  7492             20  CN-STATE                 PIC XX.
  7493             20  CN-ACCOUNT.
  7494                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7495                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7496             20  CN-CERT-EFF-DT           PIC XX.
  7497             20  CN-CERT-NO.
  7498                 24  CN-CERT-PRIME        PIC X(10).
  7499                 24  CN-CERT-SFX          PIC X.
  7500
  7501     12  CN-BILLING-START-LINE-NO         PIC 99.
  7502     12  CN-BILLING-END-LINE-NO           PIC 99.
  7503
  7504     12  CN-LINES.
  7505         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7506
  7507     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7508         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7509         16  CN-CSI-GENERAL-DATA-AREA.
  7510             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7511
  7512         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7513             CN-CSI-GENERAL-DATA-AREA.
  7514             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7515             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7516             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7517             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 143
* EL156.cbl
  7518             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7519             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7520             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7521             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7522             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7523             20  FILLER                       PIC XX.
  7524             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7525             20  FILLER                       PIC X(38).
  7526
  7527         16  CN-CSI-PRODUCT-DATA-AREA.
  7528             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7529
  7530         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7531             CN-CSI-PRODUCT-DATA-AREA.
  7532             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7533             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7534             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7535             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7536             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7537             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7538             20  FILLER                   PIC XX.
  7539             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7540             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7541             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7542             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7543             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7544             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7545             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7546             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7547             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7548             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7549             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7550             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7551             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7552             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7553             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7554             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7555             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7556             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7557             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7558             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7559             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7560             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7561             20  FILLER                   PIC X(25).
  7562
  7563         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7564             CN-CSI-CREDIT-CARD-DATA.
  7565             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7566             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7567             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7568             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7569             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7570             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7571             20  FILLER                   PIC XX.
  7572             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7573             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7574             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7575             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 144
* EL156.cbl
  7576             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7577             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7578             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7579             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7580             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7581             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7582             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7583             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7584             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7585             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7586             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7587             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7588             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7589             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7590             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7591             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7592             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7593             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7594             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7595             20  FILLER                   PIC X(17).
  7596
  7597         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7598             CN-CSI-FAMILY-LEAVE-DATA.
  7599             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7600             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7601             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7602             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7603             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7604             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7605             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7606             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7607             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7608             20  CN-CSI-SL-INT-ON-PROCEEDS
  7609                                          PIC S9(5)V99  COMP-3.
  7610             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7611             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7612             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7613             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7614             20  CN-CSI-SL-POLICY-BENEFITS
  7615                                          PIC S9(5)V99  COMP-3.
  7616             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7617             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7618             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7619             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7620             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7621             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7622             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7623             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7624             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7625             20  CN-CSI-SL-STATE-NOT      PIC X.
  7626             20  FILLER                   PIC XX.
  7627
  7628         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7629             CN-CSI-SENIOR-LIFE-DATA.
  7630             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7631             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7632             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7633                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 145
* EL156.cbl
  7634             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7635             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7636             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7637             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7638             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7639             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7640             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7641             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7642             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7643             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7644             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7645             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7646             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7647             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7648             20  CN-CSI-PP-REPAIR         PIC X.
  7649             20  CN-CSI-PP-REPLACE        PIC X.
  7650             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7651             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7652             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7653             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7654             20  FILLER                   PIC X(5).
  7655
  7656         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7657             CN-CSI-PURCH-PROP-DATA.
  7658             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7659             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7660             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7661             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7662             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7663             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7664             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7665             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7666             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7667             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7668             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7669             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7670             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7671             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7672             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7673             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7674             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7675             20  CN-CSI-EW-REPLACE        PIC X.
  7676             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7677             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7678             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7679             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7680             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7681             20  FILLER                   PIC X(4).
  7682
  7683     12  CN-LAST-MAINT-DT                 PIC XX.
  7684     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7685     12  CN-LAST-MAINT-USER               PIC X(4).
  7686     12  FILLER                           PIC X(6).
  7687
  7688******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 146
* EL156.cbl
  7690*    COPY ERCCNOT.
  7691******************************************************************
  7692*                                                                *
  7693*                            ERCCNOT                             *
  7694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7695*                            VMOD=2.003                          *
  7696*                                                                *
  7697*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7698*                                                                *
  7699*        FILE TYPE= VSAM,KSDS                                    *
  7700*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7701*                                                                *
  7702*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7703*                                                                *
  7704*        LOG = YES                                               *
  7705*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7706*                                                                *
  7707******************************************************************
  7708*                   C H A N G E   L O G
  7709*
  7710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7711*-----------------------------------------------------------------
  7712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7713* EFFECTIVE    NUMBER
  7714*-----------------------------------------------------------------
  7715* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7716******************************************************************
  7717
  7718 01  CERT-NOTE-FILE.
  7719     12  CZ-RECORD-ID                PIC  XX.
  7720         88  VALID-CZ-ID                  VALUE 'CZ'.
  7721
  7722     12  CZ-CONTROL-PRIMARY.
  7723         16  CZ-COMPANY-CD           PIC X.
  7724         16  CZ-CARRIER              PIC X.
  7725         16  CZ-GROUPING.
  7726             20 CZ-GROUPING-PREFIX   PIC XXX.
  7727             20 CZ-GROUPING-PRIME    PIC XXX.
  7728         16  CZ-STATE                PIC XX.
  7729         16  CZ-ACCOUNT.
  7730             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7731             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7732         16  CZ-CERT-EFF-DT          PIC XX.
  7733         16  CZ-CERT-NO.
  7734             20  CZ-CERT-PRIME       PIC X(10).
  7735             20  CZ-CERT-SFX         PIC X.
  7736         16  CZ-RECORD-TYPE          PIC X.
  7737             88  CERT-NOTE           VALUE '1'.
  7738             88  CLAIM-CERT-NOTE     VALUE '2'.
  7739         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7740
  7741     12  CZ-LAST-MAINT-DT            PIC XX.
  7742     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7743     12  CZ-LAST-MAINT-USER          PIC X(4).
  7744
  7745     12  CZ-NOTE-INFORMATION.
  7746         16  CZ-NOTE                 PIC X(63).
  7747         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 147
* EL156.cbl
  7748******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 148
* EL156.cbl
  7750 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7751                          CONTROL-FILE CERTIFICATE-MASTER
  7752                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7753                          ACCOUNT-MASTER CHECK-QUE
  7754                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7755                          DAILY-ACTIVITY-RECORD
  7756                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7757                          CERT-NOTE-FILE.
  7758 0000-DFHEXIT SECTION.
  7759     MOVE '9#                    $   ' TO DFHEIV0.
  7760     MOVE 'EL156' TO DFHEIV1.
  7761     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7762
  7763     IF EIBCALEN = 0
  7764         GO TO 8800-UNAUTHORIZED-ACCESS.
  7765
  7766     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7767     MOVE EIBTRMID               TO QID-TERM.
  7768     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7769     MOVE '2'                    TO EMI-SWITCH2.
  7770     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7771     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7772
  7773     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7774     MOVE '5'                    TO DC-OPTION-CODE.
  7775     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7776     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7777                                    SAVE-BIN-DATE.
  7778     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7779     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7780
  7781     IF SAVE-DATE-YY > 70
  7782         MOVE 19                 TO SAVE-DATE-CC
  7783     ELSE
  7784         MOVE 20                 TO SAVE-DATE-CC.
  7785
  7786     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7787         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7788     END-IF.
  7789
  7790     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  7791        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  7792     ELSE
  7793        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7794     END-IF
  7795
  7796     IF PI-PRINT-CLM-FRM-YN = 'N'
  7797         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  7798     ELSE
  7799         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  7800     END-IF
  7801
  7802     IF PI-PRINT-SURVEY-YN = 'N'
  7803         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  7804     ELSE
  7805         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  7806     END-IF
  7807
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 149
* EL156.cbl
  7808* EXEC CICS HANDLE CONDITION
  7809*        NOTOPEN   (9990-ABEND)
  7810*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7811*        MAPFAIL   (0400-FIRST-TIME)
  7812*        DUPREC    (6180-DUPREC)
  7813*        ERROR     (9990-ABEND)
  7814*    END-EXEC.
  7815*    MOVE '"$JL?%.               ! " #00007803' TO DFHEIV0
  7816     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7818     MOVE X'2220233030303037383033' TO DFHEIV0(25:11)
  7819     CALL 'kxdfhei1' USING DFHEIV0
  7820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7821
  7822
  7823     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7824         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7825
  7826     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7827         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7828             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7829             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7830             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7831             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7832             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7833             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7834             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7835             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7836             MOVE LOW-VALUES           TO EL156AI
  7837             MOVE 'Y'                  TO FIRST-ENTRY
  7838         ELSE
  7839             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7840             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7841             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7842             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7843             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7844             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7845             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7846             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7847
  7848     IF RETURNED-FROM NOT = SPACES
  7849        IF (RETURNED-FROM = 'EL614')
  7850           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7851           IF WS-SAVED-EOB-CODES NOT = SPACES
  7852              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7853           ELSE
  7854              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7855           END-IF
  7856        END-IF
  7857         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7858            MOVE 'Y'             TO FIRST-ENTRY
  7859            IF RETURNED-FROM = 'EL614'
  7860               AND (PI-PASS-SW NOT = 'C')
  7861               IF WS-SAVED-EOB-CODES NOT = SPACES
  7862                  MOVE WS-SAVED-EOB-CODES
  7863                                 TO PI-PMTNOTE2
  7864                                    WS-PMTNOTE2
  7865                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 150
* EL156.cbl
  7866               ELSE
  7867                  MOVE SPACES    TO PI-PMTNOTE2
  7868                                    WS-PMTNOTE2
  7869                                    PI-EOB-CODES-EXIST
  7870               END-IF
  7871            END-IF
  7872            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7873            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7874            IF RETURNED-FROM = 'EL614'
  7875               GO TO 1000-EDIT-DATA
  7876            END-IF
  7877            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  7878               (PAYEEI   = LOW-VALUES OR SPACES)
  7879               GO TO 8100-SEND-INITIAL-MAP
  7880            ELSE
  7881               GO TO 1000-EDIT-DATA.
  7882
  7883     IF EIBTRNID NOT = TRANS-ID
  7884         GO TO 0400-FIRST-TIME.
  7885
  7886     IF EIBAID = DFHCLEAR
  7887        IF PI-PASS-SW = 'C'
  7888           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7889           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7890           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7891           MOVE 'Y'            TO RETURNED-FROM-B
  7892           GO TO 1000-EDIT-DATA
  7893        ELSE
  7894           GO TO 9400-CLEAR.
  7895
  7896     IF PI-PASS-SW = 'C'
  7897         MOVE MAP-NAMEB          TO MAP-NAME
  7898         IF EIBAID = DFHPF1 OR DFHPF13
  7899             GO TO 5000-UPDATE
  7900           ELSE
  7901             IF EIBAID NOT = DFHENTER
  7902                 MOVE LOW-VALUES TO EL156BI
  7903                 MOVE MAP-NAMEB  TO MAP-NAME
  7904                 MOVE ER-0029    TO EMI-ERROR
  7905                 MOVE -1         TO  ENTPFBL
  7906                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7907                 GO TO 8200-SEND-DATAONLY.
  7908
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 151
* EL156.cbl
  7910 0200-RECEIVE.
  7911     MOVE LOW-VALUES             TO EL156AI.
  7912     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7913         MOVE ER-0008            TO EMI-ERROR
  7914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7915         IF PI-PASS-SW = 'C'
  7916             MOVE -1             TO ENTPFBL
  7917             GO TO 8200-SEND-DATAONLY
  7918         ELSE
  7919             MOVE -1             TO PMTTYPEL
  7920             GO TO 8200-SEND-DATAONLY.
  7921
  7922     IF PI-COMPANY-ID = 'DMD'
  7923         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7924
  7925     IF PI-PASS-SW = 'C'
  7926         MOVE MAP-NAMEB          TO MAP-NAME.
  7927
  7928
  7929* EXEC CICS RECEIVE
  7930*        MAP   (MAP-NAME)
  7931*        MAPSET(MAPSET-NAME)
  7932*        ASIS
  7933*        INTO  (EL156AI)
  7934*    END-EXEC.
  7935     MOVE LENGTH OF
  7936      EL156AI
  7937       TO DFHEIV11
  7938*    MOVE '8"TAI  L              ''   #00007916' TO DFHEIV0
  7939     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037393136' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           MAP-NAME,
  7944           EL156AI,
  7945           DFHEIV11,
  7946           MAPSET-NAME,
  7947           DFHEIV99,
  7948           DFHEIV99
  7949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7950
  7951
  7952     IF PI-PASS-SW NOT = 'C'
  7953         GO TO 0250-MAPA.
  7954
  7955     IF ENTPFBL NOT > ZERO
  7956         MOVE MAP-NAMEB          TO MAP-NAME
  7957         MOVE ER-0029            TO EMI-ERROR
  7958         MOVE -1                 TO  ENTPFBL
  7959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7960         GO TO 8200-SEND-DATAONLY.
  7961
  7962     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7963         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7964       ELSE
  7965         MOVE MAP-NAMEB           TO MAP-NAME
  7966         MOVE ER-0029             TO EMI-ERROR
  7967         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 152
* EL156.cbl
  7968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7969         GO TO 8200-SEND-DATAONLY.
  7970
  7971     IF EIBAID = DFHPF1 OR DFHPF13
  7972         IF MODIFY-CAP
  7973            GO TO 5000-UPDATE
  7974          ELSE
  7975            MOVE 'UPDATE'           TO SM-READ
  7976            PERFORM 9995-SECURITY-VIOLATION
  7977            MOVE MAP-NAMEB          TO MAP-NAME
  7978            MOVE ER-0070            TO EMI-ERROR
  7979            MOVE -1                 TO  ENTPFBL
  7980            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7981            GO TO 8200-SEND-DATAONLY.
  7982
  7983 0250-MAPA.
  7984     IF ENTERPFL = 0
  7985         GO TO 0300-CHECK-PFKEYS.
  7986
  7987     IF EIBAID NOT = DFHENTER
  7988         MOVE ER-0004            TO EMI-ERROR
  7989         GO TO 0320-INPUT-ERROR.
  7990
  7991     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7992         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7993     ELSE
  7994         MOVE ER-0029            TO EMI-ERROR
  7995         GO TO 0320-INPUT-ERROR.
  7996
  7997 0300-CHECK-PFKEYS.
  7998     IF EIBAID = DFHPF7 OR DFHPF8
  7999         GO TO 8820-PF7-8.
  8000
  8001     IF EIBAID = DFHPF23
  8002         GO TO 8810-PF23.
  8003
  8004     IF EIBAID = DFHPF24
  8005         GO TO 9200-RETURN-MAIN-MENU.
  8006
  8007     IF EIBAID = DFHPF12
  8008         GO TO 9500-PF12.
  8009
  8010     IF EIBAID = DFHPF1
  8011        IF PI-PASS-SW = 'A' OR 'B'
  8012          GO TO 0330-BROWSE-FORWARD.
  8013
  8014     IF EIBAID = DFHPF2
  8015        IF PI-PASS-SW = 'A' OR 'B'
  8016          GO TO 0350-BROWSE-BACKWARD.
  8017
  8018     IF EIBAID = DFHPF6
  8019        IF PI-EOB-CODES-EXIST = 'Y'
  8020           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8021        ELSE
  8022           MOVE SPACES              TO WS-PMTNOTE2
  8023        END-IF
  8024         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8025         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 153
* EL156.cbl
  8026            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8027         END-IF
  8028         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8029         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8030             MOVE 'EL614'        TO PGM-NAME
  8031             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8032             GO TO 9300-XCTL
  8033         ELSE
  8034             MOVE XCTL-157       TO PGM-NAME
  8035             GO TO 9300-XCTL.
  8036
  8037     IF EIBAID = DFHPF9
  8038        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8039        MOVE XCTL-141            TO PGM-NAME
  8040        GO TO 9300-XCTL.
  8041
  8042     IF EIBAID = DFHPF10
  8043        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8044        MOVE XCTL-155            TO PGM-NAME
  8045        GO TO 9300-XCTL.
  8046
  8047     MOVE SPACES                 TO ERRMSG0O
  8048                                    ERRMSG1O
  8049                                    ERRMSG2O.
  8050
  8051     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8052         IF PI-PASS-SW NOT = 'B'
  8053             MOVE ER-0422        TO EMI-ERROR
  8054             GO TO 0320-INPUT-ERROR
  8055           ELSE
  8056             GO TO 0700-TEST-FOR-CHANGES.
  8057
  8058     IF EIBAID = DFHPF11
  8059        IF PI-PASS-SW = 'C'
  8060           MOVE ER-0029          TO EMI-ERROR
  8061           GO TO 0320-INPUT-ERROR.
  8062
  8063     IF EIBAID = DFHENTER OR DFHPF11
  8064        NEXT SENTENCE
  8065     ELSE
  8066        MOVE ER-0029             TO EMI-ERROR
  8067        GO TO 0320-INPUT-ERROR.
  8068
  8069     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8070
  8071     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8072         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8073         GO TO 1000-EDIT-DATA
  8074     ELSE
  8075         IF PI-FATAL-COUNT NOT = 0 OR
  8076            PI-FORCE-COUNT NOT = 0
  8077             GO TO 1000-EDIT-DATA
  8078         ELSE
  8079             GO TO 2000-EDIT-DONE.
  8080
  8081 0320-INPUT-ERROR.
  8082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 154
* EL156.cbl
  8084     IF ENTERPFL = 0
  8085         MOVE -1                 TO PMTTYPEL
  8086     ELSE
  8087         MOVE AL-UNBON           TO ENTERPFA
  8088         MOVE -1                 TO ENTERPFL.
  8089
  8090     GO TO 8200-SEND-DATAONLY.
  8091
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 155
* EL156.cbl
  8093 0330-BROWSE-FORWARD.
  8094
  8095     MOVE CLMNOI            TO PI-CLAIM-NO.
  8096     MOVE CARRI             TO PI-CARRIER.
  8097     MOVE CERTNOI           TO PI-CERT-PRIME.
  8098     MOVE SUFXI             TO PI-CERT-SFX.
  8099
  8100     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8101     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8102     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8103     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8104
  8105     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8106
  8107
  8108* EXEC CICS HANDLE CONDITION
  8109*         NOTFND   (0380-CLAIM-END-FILE)
  8110*         ENDFILE  (0380-CLAIM-END-FILE)
  8111*    END-EXEC.
  8112*    MOVE '"$I''                  ! # #00008078' TO DFHEIV0
  8113     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8115     MOVE X'2320233030303038303738' TO DFHEIV0(25:11)
  8116     CALL 'kxdfhei1' USING DFHEIV0
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8118
  8119
  8120
  8121* EXEC CICS STARTBR
  8122*         DATASET    ('ELMSTR')
  8123*         RIDFLD     (ELMSTR-KEY)
  8124*         GTEQ
  8125*    END-EXEC.
  8126     MOVE 'ELMSTR' TO DFHEIV1
  8127     MOVE 0
  8128       TO DFHEIV11
  8129*    MOVE '&,         G          &   #00008083' TO DFHEIV0
  8130     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8132     MOVE X'2020233030303038303833' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0,
  8134           DFHEIV1,
  8135           ELMSTR-KEY,
  8136           DFHEIV99,
  8137           DFHEIV11,
  8138           DFHEIV99
  8139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8140
  8141
  8142     MOVE 'Y' TO WS-BROWSE-START-SW.
  8143
  8144 0335-READNEXT.
  8145
  8146
  8147* EXEC CICS READNEXT
  8148*         DATASET    ('ELMSTR')
  8149*         RIDFLD     (ELMSTR-KEY)
  8150*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 156
* EL156.cbl
  8151*    END-EXEC.
  8152     MOVE 'ELMSTR' TO DFHEIV1
  8153     MOVE 0
  8154       TO DFHEIV11
  8155*    MOVE '&.S                   )   #00008093' TO DFHEIV0
  8156     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8157     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8158     MOVE X'2020233030303038303933' TO DFHEIV0(25:11)
  8159     CALL 'kxdfhei1' USING DFHEIV0,
  8160           DFHEIV1,
  8161           DFHEIV20,
  8162           DFHEIV99,
  8163           ELMSTR-KEY,
  8164           DFHEIV99,
  8165           DFHEIV11,
  8166           DFHEIV99,
  8167           DFHEIV99
  8168     SET ADDRESS OF CLAIM-MASTER TO
  8169         DFHEIV20
  8170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8171
  8172
  8173     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8174        GO TO 0380-CLAIM-END-FILE.
  8175
  8176     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8177        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8178        GO TO 0335-READNEXT.
  8179
  8180     IF PI-COMPANY-ID = 'CRI'
  8181         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8182            GO TO 0380-CLAIM-END-FILE.
  8183
  8184     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8185         GO TO 0335-READNEXT.
  8186
  8187     IF PI-CARRIER-SECURITY > SPACES
  8188         IF CL-CARRIER = PI-CARRIER-SECURITY
  8189             NEXT SENTENCE
  8190         ELSE
  8191             GO TO 0335-READNEXT.
  8192
  8193     IF PI-ACCOUNT-SECURITY > SPACES
  8194         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8195             NEXT SENTENCE
  8196         ELSE
  8197             GO TO 0335-READNEXT.
  8198
  8199     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8200     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8201     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8202
  8203     GO TO 0400-FIRST-TIME.
  8204
  8205 0350-BROWSE-BACKWARD.
  8206
  8207     MOVE CLMNOI            TO PI-CLAIM-NO
  8208                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 157
* EL156.cbl
  8209     MOVE CARRI             TO PI-CARRIER.
  8210     MOVE CERTNOI           TO PI-CERT-PRIME.
  8211     MOVE SUFXI             TO PI-CERT-SFX.
  8212
  8213     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8214
  8215     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8216     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8217     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8218
  8219
  8220* EXEC CICS HANDLE CONDITION
  8221*         NOTFND   (0380-CLAIM-END-FILE)
  8222*         ENDFILE  (0380-CLAIM-END-FILE)
  8223*    END-EXEC.
  8224*    MOVE '"$I''                  ! $ #00008145' TO DFHEIV0
  8225     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8227     MOVE X'2420233030303038313435' TO DFHEIV0(25:11)
  8228     CALL 'kxdfhei1' USING DFHEIV0
  8229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8230
  8231
  8232
  8233* EXEC CICS STARTBR
  8234*         DATASET    ('ELMSTR')
  8235*         RIDFLD     (ELMSTR-KEY)
  8236*         GTEQ
  8237*    END-EXEC.
  8238     MOVE 'ELMSTR' TO DFHEIV1
  8239     MOVE 0
  8240       TO DFHEIV11
  8241*    MOVE '&,         G          &   #00008150' TO DFHEIV0
  8242     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8243     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8244     MOVE X'2020233030303038313530' TO DFHEIV0(25:11)
  8245     CALL 'kxdfhei1' USING DFHEIV0,
  8246           DFHEIV1,
  8247           ELMSTR-KEY,
  8248           DFHEIV99,
  8249           DFHEIV11,
  8250           DFHEIV99
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8252
  8253
  8254     MOVE 'Y' TO WS-BROWSE-START-SW.
  8255
  8256
  8257* EXEC CICS READNEXT
  8258*         DATASET    ('ELMSTR')
  8259*         RIDFLD     (ELMSTR-KEY)
  8260*         SET        (ADDRESS OF CLAIM-MASTER)
  8261*    END-EXEC.
  8262     MOVE 'ELMSTR' TO DFHEIV1
  8263     MOVE 0
  8264       TO DFHEIV11
  8265*    MOVE '&.S                   )   #00008158' TO DFHEIV0
  8266     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 158
* EL156.cbl
  8267     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8268     MOVE X'2020233030303038313538' TO DFHEIV0(25:11)
  8269     CALL 'kxdfhei1' USING DFHEIV0,
  8270           DFHEIV1,
  8271           DFHEIV20,
  8272           DFHEIV99,
  8273           ELMSTR-KEY,
  8274           DFHEIV99,
  8275           DFHEIV11,
  8276           DFHEIV99,
  8277           DFHEIV99
  8278     SET ADDRESS OF CLAIM-MASTER TO
  8279         DFHEIV20
  8280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8281
  8282
  8283
  8284* EXEC CICS READPREV
  8285*         DATASET    ('ELMSTR')
  8286*         RIDFLD     (ELMSTR-KEY)
  8287*         SET        (ADDRESS OF CLAIM-MASTER)
  8288*    END-EXEC.
  8289     MOVE 'ELMSTR' TO DFHEIV1
  8290     MOVE 0
  8291       TO DFHEIV11
  8292*    MOVE '&0S                   )   #00008164' TO DFHEIV0
  8293     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8295     MOVE X'2020233030303038313634' TO DFHEIV0(25:11)
  8296     CALL 'kxdfhei1' USING DFHEIV0,
  8297           DFHEIV1,
  8298           DFHEIV20,
  8299           DFHEIV99,
  8300           ELMSTR-KEY,
  8301           DFHEIV99,
  8302           DFHEIV11,
  8303           DFHEIV99,
  8304           DFHEIV99
  8305     SET ADDRESS OF CLAIM-MASTER TO
  8306         DFHEIV20
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309
  8310 0360-BROWSE-BACKWARD.
  8311
  8312
  8313* EXEC CICS READPREV
  8314*         DATASET    ('ELMSTR')
  8315*         RIDFLD     (ELMSTR-KEY)
  8316*         SET        (ADDRESS OF CLAIM-MASTER)
  8317*    END-EXEC.
  8318     MOVE 'ELMSTR' TO DFHEIV1
  8319     MOVE 0
  8320       TO DFHEIV11
  8321*    MOVE '&0S                   )   #00008172' TO DFHEIV0
  8322     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8323     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8324     MOVE X'2020233030303038313732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 159
* EL156.cbl
  8325     CALL 'kxdfhei1' USING DFHEIV0,
  8326           DFHEIV1,
  8327           DFHEIV20,
  8328           DFHEIV99,
  8329           ELMSTR-KEY,
  8330           DFHEIV99,
  8331           DFHEIV11,
  8332           DFHEIV99,
  8333           DFHEIV99
  8334     SET ADDRESS OF CLAIM-MASTER TO
  8335         DFHEIV20
  8336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8337
  8338
  8339     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8340        GO TO 0380-CLAIM-END-FILE.
  8341
  8342     IF PI-COMPANY-ID = 'CRI'
  8343         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8344            GO TO 0380-CLAIM-END-FILE.
  8345
  8346     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8347         GO TO 0360-BROWSE-BACKWARD.
  8348
  8349     IF PI-CARRIER-SECURITY > SPACES
  8350         IF CL-CARRIER = PI-CARRIER-SECURITY
  8351             NEXT SENTENCE
  8352         ELSE
  8353             GO TO 0360-BROWSE-BACKWARD.
  8354
  8355     IF PI-ACCOUNT-SECURITY > SPACES
  8356         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8357             NEXT SENTENCE
  8358         ELSE
  8359             GO TO 0360-BROWSE-BACKWARD.
  8360
  8361     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8362     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8363     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8364
  8365     GO TO 0400-FIRST-TIME.
  8366
  8367 0380-CLAIM-END-FILE.
  8368
  8369     MOVE ER-0130     TO EMI-ERROR.
  8370     MOVE -1          TO CLMNOL.
  8371     MOVE AL-UABON    TO CARRA
  8372                         CLMNOA
  8373                         CERTNOA
  8374                         SUFXA.
  8375
  8376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8377
  8378     GO TO 8200-SEND-DATAONLY.
  8379
  8380 0400-FIRST-TIME.
  8381
  8382     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 160
* EL156.cbl
  8383        MOVE 'N'         TO WS-BROWSE-START-SW
  8384
  8385* EXEC CICS ENDBR
  8386*            DATASET    ('ELMSTR')
  8387*       END-EXEC.
  8388     MOVE 'ELMSTR' TO DFHEIV1
  8389     MOVE 0
  8390       TO DFHEIV11
  8391*    MOVE '&2                    $   #00008223' TO DFHEIV0
  8392     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8394     MOVE X'2020233030303038323233' TO DFHEIV0(25:11)
  8395     CALL 'kxdfhei1' USING DFHEIV0,
  8396           DFHEIV1,
  8397           DFHEIV11,
  8398           DFHEIV99
  8399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8400
  8401
  8402     IF PI-PROCESSOR-ID = 'LGXX'
  8403         NEXT SENTENCE
  8404     ELSE
  8405
  8406* EXEC CICS READQ TS
  8407*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8408*            INTO    (SECURITY-CONTROL)
  8409*            LENGTH  (SC-COMM-LENGTH)
  8410*            ITEM    (SC-ITEM)
  8411*        END-EXEC
  8412*    MOVE '*$II   L              ''   #00008230' TO DFHEIV0
  8413     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8415     MOVE X'2020233030303038323330' TO DFHEIV0(25:11)
  8416     CALL 'kxdfhei1' USING DFHEIV0,
  8417           PI-SECURITY-TEMP-STORE-ID,
  8418           SECURITY-CONTROL,
  8419           SC-COMM-LENGTH,
  8420           SC-ITEM,
  8421           DFHEIV99,
  8422           DFHEIV99
  8423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8424         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8425         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8426
  8427     MOVE LOW-VALUES             TO EL156AI.
  8428     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8429     MOVE 'Y'                    TO FIRST-ENTRY.
  8430     GO TO 7000-SHOW-CLAIM.
  8431
  8432 0500-CREATE-TEMP-STORAGE.
  8433     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8434
  8435
  8436* EXEC CICS WRITEQ TS
  8437*        QUEUE (QID)
  8438*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8439*        LENGTH(PI-COMM-LENGTH)
  8440*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 161
* EL156.cbl
  8441*    MOVE '*"                    ''   #00008247' TO DFHEIV0
  8442     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303038323437' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           QID,
  8447           PROGRAM-INTERFACE-BLOCK,
  8448           PI-COMM-LENGTH,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
  8454
  8455
  8456* EXEC CICS WRITEQ TS
  8457*        QUEUE (QID)
  8458*        FROM  (EL156AI)
  8459*        LENGTH(MAP-LENGTH)
  8460*    END-EXEC.
  8461*    MOVE '*"                    ''   #00008253' TO DFHEIV0
  8462     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8464     MOVE X'2020233030303038323533' TO DFHEIV0(25:11)
  8465     CALL 'kxdfhei1' USING DFHEIV0,
  8466           QID,
  8467           EL156AI,
  8468           MAP-LENGTH,
  8469           DFHEIV99,
  8470           DFHEIV99,
  8471           DFHEIV99
  8472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8473
  8474
  8475 0599-EXIT.
  8476      EXIT.
  8477
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 162
* EL156.cbl
  8479 0600-RECOVER-TEMP-STORAGE.
  8480
  8481* EXEC CICS READQ TS
  8482*        QUEUE (QID)
  8483*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8484*        LENGTH(PI-COMM-LENGTH)
  8485*    END-EXEC.
  8486*    MOVE '*$I    L              ''   #00008264' TO DFHEIV0
  8487     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8488     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8489     MOVE X'2020233030303038323634' TO DFHEIV0(25:11)
  8490     CALL 'kxdfhei1' USING DFHEIV0,
  8491           QID,
  8492           PROGRAM-INTERFACE-BLOCK,
  8493           PI-COMM-LENGTH,
  8494           DFHEIV99,
  8495           DFHEIV99,
  8496           DFHEIV99
  8497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8498
  8499
  8500
  8501* EXEC CICS READQ TS
  8502*        QUEUE (QID)
  8503*        INTO  (EL156AI)
  8504*        LENGTH(MAP-LENGTH)
  8505*    END-EXEC.
  8506*    MOVE '*$I    L              ''   #00008270' TO DFHEIV0
  8507     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           QID,
  8512           EL156AI,
  8513           MAP-LENGTH,
  8514           DFHEIV99,
  8515           DFHEIV99,
  8516           DFHEIV99
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8521
  8522     IF PMTTYPEI NOT = LOW-VALUES
  8523         MOVE AL-UANON           TO PMTTYPEA.
  8524
  8525     IF PAYEEI NOT = LOW-VALUES
  8526         MOVE AL-UANON           TO PAYEEA.
  8527
  8528     IF NOTE1I NOT = LOW-VALUES
  8529         MOVE AL-UANON           TO NOTE1A.
  8530
  8531     IF (RETURNED-FROM = 'EL614')
  8532        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8533     END-IF
  8534*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8535*       AND (PI-EOB-CODES-EXIST = 'Y')
  8536*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 163
* EL156.cbl
  8537*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8538     IF PI-SET-NOTE2-MDT = 'Y'
  8539         MOVE AL-SANON           TO NOTE2A
  8540     END-IF
  8541
  8542     IF OFFLINEI NOT = LOW-VALUES
  8543         MOVE AL-UANON           TO OFFLINEA.
  8544
  8545*01299      IF GROUPEDI NOT = LOW-VALUES
  8546*01300          MOVE AL-UANON           TO GROUPEDA.
  8547
  8548*01302      IF CASHI NOT = LOW-VALUES
  8549*01303          MOVE AL-UANON           TO CASHA.
  8550
  8551     IF CHECKNOI NOT = LOW-VALUES
  8552         MOVE AL-UANON           TO CHECKNOA.
  8553
  8554     IF HOLDTILI NOT = LOW-VALUES
  8555         MOVE AL-UANON           TO HOLDTILA.
  8556
  8557     IF EPYFROMI NOT = LOW-VALUES
  8558         MOVE AL-UANON           TO EPYFROMA.
  8559
  8560     IF AIGFROMI NOT = LOW-VALUES
  8561         MOVE AL-UANON           TO AIGFROMA.
  8562
  8563     IF EPYTHRUI NOT = LOW-VALUES
  8564         MOVE AL-UANON           TO EPYTHRUA.
  8565
  8566     IF EDAYSI NOT = LOW-VALUES
  8567         MOVE AL-UNNON           TO EDAYSA.
  8568
  8569     IF EPYAMTL NOT = +0
  8570         MOVE AL-UNNON           TO EPYAMTA.
  8571
  8572     IF ERESVL NOT = +0
  8573         MOVE AL-UNNON           TO ERESVA.
  8574
  8575     IF EEXPENSL NOT = +0
  8576         MOVE AL-UNNON           TO EEXPENSA.
  8577
  8578     IF ETYPEI NOT = LOW-VALUES
  8579         MOVE AL-UNNON           TO ETYPEA.
  8580
  8581     IF PROOFDTI NOT = 0
  8582         MOVE AL-UNNON           TO PROOFDTA.
  8583
  8584     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8585        MOVE AL-UANON            TO EOBYNA
  8586     END-IF
  8587     IF CLMFMYNI = 'Y' OR 'N'
  8588        MOVE AL-UANON            TO CLMFMYNA
  8589     END-IF
  8590
  8591     IF SURVYYNI = 'Y' OR 'N'
  8592        IF PI-APPROVAL-LEVEL = '4'
  8593           MOVE AL-UANON         TO SURVYYNA
  8594        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 164
* EL156.cbl
  8595     END-IF
  8596
  8597     .
  8598 0699-EXIT.
  8599      EXIT.
  8600
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 165
* EL156.cbl
  8602 0700-TEST-FOR-CHANGES.
  8603     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8604         MOVE ER-0433            TO EMI-ERROR
  8605         GO TO 0750-FUNCTION-ERROR.
  8606
  8607     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8608
  8609     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8610         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8611         MOVE 'A'                TO PI-PASS-SW
  8612         GO TO 1000-EDIT-DATA.
  8613
  8614     IF PI-FATAL-COUNT NOT = 0
  8615         MOVE ER-0499            TO EMI-ERROR
  8616         GO TO 0750-FUNCTION-ERROR.
  8617
  8618     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8619         MOVE ER-0500            TO EMI-ERROR
  8620         GO TO 0750-FUNCTION-ERROR.
  8621
  8622     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8623        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8624           MOVE ER-0542          TO EMI-ERROR
  8625           MOVE -1               TO EPYAMTL
  8626           GO TO 0750-FUNCTION-ERROR.
  8627
  8628     IF PI-OFFLINE = 'Y'  OR
  8629        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8630        MOVE EIBAID              TO PI-PFKEY-USED
  8631        GO TO 5000-UPDATE.
  8632
  8633     GO TO 6000-BUILD-SCREEN-B.
  8634
  8635 0750-FUNCTION-ERROR.
  8636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8637
  8638     IF ENTERPFL > 0
  8639         MOVE -1                 TO ENTERPFL
  8640         MOVE AL-UNBON           TO ENTERPFA
  8641         GO TO 8200-SEND-DATAONLY
  8642     ELSE
  8643         MOVE -1                 TO ENTERPFL
  8644         MOVE AL-UNNOF           TO ENTERPFA
  8645         GO TO 8200-SEND-DATAONLY.
  8646
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 166
* EL156.cbl
  8648 0800-DELETE-TS.
  8649
  8650* EXEC CICS HANDLE CONDITION
  8651*        QIDERR(0800-EXIT)
  8652*    END-EXEC.
  8653*    MOVE '"$N                   ! % #00008405' TO DFHEIV0
  8654     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8656     MOVE X'2520233030303038343035' TO DFHEIV0(25:11)
  8657     CALL 'kxdfhei1' USING DFHEIV0
  8658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8659
  8660
  8661
  8662* EXEC CICS DELETEQ TS
  8663*        QUEUE(QID)
  8664*    END-EXEC.
  8665*    MOVE '*&                    #   #00008409' TO DFHEIV0
  8666     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           QID,
  8671           DFHEIV99
  8672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8673
  8674
  8675 0800-EXIT.
  8676      EXIT.
  8677
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 167
* EL156.cbl
  8679 1000-EDIT-DATA.
  8680
  8681     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8682         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8683         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8684
  8685     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8686
  8687     IF NOT MODIFY-CAP
  8688         MOVE ER-0070            TO EMI-ERROR
  8689         MOVE -1                 TO PMTTYPEL
  8690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8691         GO TO 2000-EDIT-DONE.
  8692
  8693     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8694                         '5' AND '6'
  8695         MOVE ER-0420            TO EMI-ERROR
  8696         MOVE -1                 TO PMTTYPEL
  8697         MOVE AL-UABON           TO PMTTYPEA
  8698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8699     ELSE
  8700         MOVE AL-UANON           TO PMTTYPEA.
  8701
  8702*01420      IF PI-OFFLINE = 'Y'
  8703*01421         IF PI-GROUPED = 'Y'
  8704*01422            MOVE ER-1880         TO EMI-ERROR
  8705*01423            MOVE -1              TO GROUPEDL
  8706*01424            MOVE AL-UABON        TO GROUPEDA
  8707*01425            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8708*01426
  8709*01427      IF GROUPEDL > +0
  8710*01428         IF PI-GROUPED = 'Y' OR 'N'
  8711*01429            MOVE AL-UANON TO GROUPEDA
  8712*01430         ELSE
  8713*01431            MOVE ER-3140            TO EMI-ERROR
  8714*01432            MOVE -1                 TO GROUPEDL
  8715*01433            MOVE AL-UABON           TO GROUPEDA
  8716*01434            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8717*01435
  8718*01436      IF CASHL > +0
  8719*01437         IF PI-CASH = 'Y' OR 'N'
  8720*01438            MOVE AL-UANON           TO CASHA
  8721*01439         ELSE
  8722*01440            MOVE ER-3141            TO EMI-ERROR
  8723*01441            MOVE -1                 TO CASHL
  8724*01442            MOVE AL-UABON           TO CASHA
  8725*01443            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8726
  8727     IF LOANNOL > +0
  8728         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8729
  8730 1000-EDIT-PAYEE.
  8731
  8732     IF PI-PAYEE-SEQ NOT NUMERIC
  8733         MOVE ER-0294            TO  EMI-ERROR
  8734         MOVE -1                 TO  PAYEEL
  8735         MOVE AL-UABON           TO  PAYEEA
  8736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 168
* EL156.cbl
  8737         GO TO 1000-CONT-EDIT.
  8738
  8739     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8740                         'E' OR 'O' OR 'Q'
  8741         NEXT SENTENCE
  8742     ELSE
  8743         MOVE ER-0294            TO  EMI-ERROR
  8744         MOVE -1                 TO  PAYEEL
  8745         MOVE AL-UABON           TO  PAYEEA
  8746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8747         GO TO 1000-CONT-EDIT.
  8748
  8749     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8750        (PI-PAYEE-SEQ NOT < '1' AND
  8751         PI-PAYEE-SEQ NOT > '9'))
  8752      OR
  8753        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8754         (PI-PAYEE-SEQ NOT > '9'))
  8755         MOVE AL-UANON            TO PAYEEA
  8756     ELSE
  8757         MOVE ER-0294            TO EMI-ERROR
  8758         MOVE -1                 TO PAYEEL
  8759         MOVE AL-UABON           TO PAYEEA
  8760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8761
  8762     IF PI-COMPANY-ID = 'DMD'
  8763         IF PI-PAYEE-TYPE = 'B' AND
  8764            PI-PAYEE-SEQ NOT = '0'
  8765               MOVE ER-7841            TO EMI-ERROR
  8766               MOVE -1                 TO PAYEEL
  8767               MOVE AL-UABON           TO PAYEEA
  8768               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8769
  8770     IF PI-COMPANY-ID = 'JHL'
  8771         IF PI-PAYEE = 'B0'
  8772             NEXT SENTENCE
  8773           ELSE
  8774
  8775* EXEC CICS HANDLE CONDITION
  8776*            ENDFILE(1950-NOT-FOUND)
  8777*            NOTFND (1950-NOT-FOUND)
  8778*        END-EXEC
  8779*    MOVE '"$''I                  ! & #00008512' TO DFHEIV0
  8780     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8782     MOVE X'2620233030303038353132' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8785         MOVE 'N'                    TO FOUND-TOL-SW
  8786         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8787         MOVE '2'                    TO CNTL-REC-TYPE
  8788         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8789         MOVE +0                     TO CNTL-SEQ-NO
  8790         MOVE 'PROC'                 TO FILE-SWITCH
  8791         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8792         IF PI-PAYEE = 'I1' AND
  8793            APPROVAL-LEVEL-2
  8794             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 169
* EL156.cbl
  8795           ELSE
  8796         IF NOT PI-USER-ALMIGHTY-YES
  8797             MOVE ER-3546        TO EMI-ERROR
  8798             MOVE -1             TO PAYEEL
  8799             MOVE AL-UABON       TO PAYEEA
  8800             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8801
  8802     IF PI-PAYEE-TYPE = 'E'
  8803        IF PI-PMTTYPE = '5' OR '6'
  8804            NEXT SENTENCE
  8805        ELSE
  8806            MOVE ER-3539            TO EMI-ERROR
  8807            MOVE -1                 TO PAYEEL
  8808            MOVE AL-UABON           TO PAYEEA
  8809            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8810
  8811 1000-CONT-EDIT.
  8812
  8813     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8814        IF PI-EPYAMT NOT NEGATIVE
  8815            MOVE ER-0421         TO EMI-ERROR
  8816            MOVE -1              TO OFFLINEL
  8817            MOVE AL-UABON        TO OFFLINEA
  8818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8819        ELSE
  8820            MOVE AL-UANON        TO OFFLINEA.
  8821
  8822     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8823        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8824           CONTINUE
  8825        ELSE
  8826        IF PI-PRINT-EOB-YN = 'S' AND
  8827           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  8828             CONTINUE
  8829        ELSE
  8830           MOVE ER-1561          TO EMI-ERROR
  8831           MOVE -1               TO EOBYNL
  8832           MOVE AL-UABON         TO EOBYNA
  8833           PERFORM 9900-ERROR-FORMAT
  8834                                 THRU 9900-EXIT
  8835        END-IF
  8836        END-IF
  8837
  8838        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  8839            MOVE ER-1566        TO EMI-ERROR
  8840            MOVE -1             TO CLMFMYNL
  8841            MOVE AL-UABON       TO CLMFMYNA
  8842            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8843        END-IF
  8844
  8845        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  8846            MOVE ER-1567        TO EMI-ERROR
  8847            MOVE -1             TO SURVYYNL
  8848            MOVE AL-UABON       TO SURVYYNA
  8849            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8850        END-IF
  8851
  8852     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 170
* EL156.cbl
  8853     IF PI-EPYAMT IS NEGATIVE
  8854         IF PI-OFFLINE NOT = 'Y'
  8855             MOVE ER-0836        TO  EMI-ERROR
  8856             MOVE -1             TO  OFFLINEL
  8857             MOVE AL-UABON       TO  OFFLINEA
  8858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8859
  8860     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8861        MOVE ER-0872             TO EMI-ERROR
  8862        MOVE -1                  TO PROOFDTL
  8863        MOVE AL-UABON            TO PROOFDTA
  8864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8865     ELSE
  8866        MOVE '4'                TO DC-OPTION-CODE
  8867        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8868        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8869        IF DATE-CONVERSION-ERROR
  8870            MOVE ER-0873        TO EMI-ERROR
  8871            MOVE -1                  TO PROOFDTL
  8872            MOVE AL-UABON            TO PROOFDTA
  8873            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8874        ELSE
  8875            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8876            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8877                MOVE ER-0873    TO EMI-ERROR
  8878                MOVE -1                  TO PROOFDTL
  8879                MOVE AL-UABON            TO PROOFDTA
  8880                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8881            END-IF
  8882        END-IF
  8883     END-IF.
  8884
  8885     IF PI-COMPANY-ID = 'DMD'
  8886        IF NOTE1L NOT = ZEROS
  8887            MOVE ER-7844        TO  EMI-ERROR
  8888            MOVE -1             TO  NOTE1L
  8889            MOVE AL-UABON       TO  NOTE1A
  8890            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8891
  8892     IF PI-COMPANY-ID = 'DMD'
  8893        IF NOTE2L NOT = ZEROS
  8894          GO TO 1004-DMD-EOB-CHECKS.
  8895
  8896     IF NOTE1L NOT > +0
  8897         GO TO 1005-CHECK-ERRORS.
  8898
  8899     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8900         GO TO 1005-CHECK-ERRORS.
  8901
  8902     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8903         GO TO 1003-HAN-PMT-NOTES.
  8904
  8905     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8906
  8907     IF WS-PMTOPTION NUMERIC
  8908        IF WS-PMTOPTION > '00' AND < '17'
  8909           NEXT SENTENCE
  8910        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 171
* EL156.cbl
  8911           MOVE ER-0618          TO EMI-ERROR
  8912           MOVE -1               TO NOTE1L
  8913           MOVE AL-UABON         TO NOTE1A
  8914           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8915     ELSE
  8916        GO TO 1005-CHECK-ERRORS.
  8917
  8918     IF WS-PMTOPTION = '05' AND
  8919        WS-DOCNAME = SPACES
  8920          MOVE ER-0616             TO EMI-ERROR
  8921          MOVE -1                  TO NOTE1L
  8922          MOVE AL-UABON            TO NOTE1A
  8923          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8924
  8925     IF WS-PMTOPTION = '15' OR '16'
  8926
  8927* EXEC CICS BIF DEEDIT
  8928*            FIELD (WS-AMOUNT)
  8929*            LENGTH(08)
  8930*        END-EXEC
  8931     MOVE 08
  8932       TO DFHEIV11
  8933*    MOVE '@"L                   #   #00008657' TO DFHEIV0
  8934     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8935     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8936     MOVE X'2020233030303038363537' TO DFHEIV0(25:11)
  8937     CALL 'kxdfhei1' USING DFHEIV0,
  8938           WS-AMOUNT,
  8939           DFHEIV11
  8940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8941        IF (WS-NUM-AMT = ZEROS) OR
  8942           (WS-AMOUNT NOT NUMERIC)
  8943           MOVE ER-0617          TO EMI-ERROR
  8944           MOVE -1               TO NOTE1L
  8945           MOVE AL-UABON         TO NOTE1A
  8946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8947
  8948     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8949
  8950     GO TO 1005-CHECK-ERRORS.
  8951
  8952 1003-HAN-PMT-NOTES.
  8953
  8954     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8955
  8956     IF WS-HAN-PMT-CODE = SPACE
  8957         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8958     ELSE
  8959     IF WS-HAN-PMT-CODE = 'A'
  8960         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8961                                 TO WS-HAN-PMT-NOTE
  8962     ELSE
  8963     IF WS-HAN-PMT-CODE = 'B'
  8964         MOVE ':FINAL PAYMENT / DECEASED'
  8965                                 TO WS-HAN-PMT-NOTE
  8966     ELSE
  8967     IF WS-HAN-PMT-CODE = 'C'
  8968         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 172
* EL156.cbl
  8969                                 TO WS-HAN-PMT-NOTE
  8970     ELSE
  8971     IF WS-HAN-PMT-CODE = 'D'
  8972         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8973                                 TO WS-HAN-PMT-NOTE
  8974     ELSE
  8975     IF WS-HAN-PMT-CODE = 'E'
  8976         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8977                                 TO WS-HAN-PMT-NOTE
  8978     ELSE
  8979     IF WS-HAN-PMT-CODE = 'F'
  8980         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8981                                 TO WS-HAN-PMT-NOTE
  8982     ELSE
  8983     IF WS-HAN-PMT-CODE = 'P'
  8984         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8985
  8986     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8987     GO TO 1005-CHECK-ERRORS.
  8988
  8989 1004-DMD-EOB-CHECKS.
  8990
  8991     INITIALIZE PI-AT-EOB-CODES.
  8992
  8993     IF NOTE2I (20:21) > SPACES
  8994         MOVE ER-7845          TO EMI-ERROR
  8995         MOVE -1               TO NOTE2L
  8996         MOVE AL-UABON         TO NOTE2A
  8997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998         GO TO 1005-CHECK-ERRORS
  8999      ELSE
  9000         MOVE NOTE2I             TO W-EOB-CODES.
  9001
  9002     MOVE +1                     TO W-EOB-NDX.
  9003
  9004 1004-CHECK-EACH-EOB.
  9005
  9006     IF W-EOB-NDX > +5
  9007             OR
  9008        W-EOB-CODE (W-EOB-NDX) = SPACES
  9009         GO TO 1004-CHECK-DUP-EOB.
  9010
  9011     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9012         MOVE ER-0956            TO EMI-ERROR
  9013         MOVE -1                 TO NOTE2L
  9014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9015         GO TO 1005-CHECK-ERRORS.
  9016
  9017     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9018     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9019     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9020     MOVE 'DLO023'               TO PGM-NAME.
  9021
  9022
  9023* EXEC CICS LINK
  9024*        PROGRAM    (PGM-NAME)
  9025*        COMMAREA   (CD-COMMUNICATION-AREA)
  9026*        LENGTH     (CD-RCRD-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 173
* EL156.cbl
  9027*    END-EXEC.
  9028*    MOVE '."C                   (   #00008742' TO DFHEIV0
  9029     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9031     MOVE X'2020233030303038373432' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           PGM-NAME,
  9034           CD-COMMUNICATION-AREA,
  9035           CD-RCRD-LENGTH,
  9036           DFHEIV99,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9041
  9042
  9043     IF CD-RETURN-CODE = 'OK'
  9044         GO TO 1004-CONT.
  9045
  9046     MOVE -1                     TO NOTE2L.
  9047
  9048     IF CD-RETURN-CODE = '01'
  9049         MOVE ER-8310            TO EMI-ERROR
  9050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051         GO TO 1005-CHECK-ERRORS.
  9052
  9053     IF CD-RETURN-CODE = '02'
  9054         MOVE ER-8311            TO EMI-ERROR
  9055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9056         GO TO 1005-CHECK-ERRORS.
  9057
  9058     IF CD-RETURN-CODE = '03'
  9059         MOVE ER-8312            TO EMI-ERROR
  9060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9061         GO TO 1005-CHECK-ERRORS.
  9062
  9063     IF CD-RETURN-CODE = '04'
  9064         MOVE ER-8313            TO EMI-ERROR
  9065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9066         GO TO 1005-CHECK-ERRORS.
  9067
  9068     IF CD-RETURN-CODE = '05'
  9069         MOVE ER-8314            TO EMI-ERROR
  9070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9071         GO TO 1005-CHECK-ERRORS.
  9072
  9073     IF CD-RETURN-CODE = '06'
  9074         MOVE ER-8315            TO EMI-ERROR
  9075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9076         GO TO 1005-CHECK-ERRORS.
  9077
  9078     IF CD-RETURN-CODE = 'E1'
  9079         MOVE ER-8316            TO EMI-ERROR
  9080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9081         GO TO 1005-CHECK-ERRORS.
  9082
  9083     IF CD-RETURN-CODE = 'N1'
  9084         MOVE ER-8317            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 174
* EL156.cbl
  9085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086         GO TO 1005-CHECK-ERRORS.
  9087
  9088 1004-CONT.
  9089     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9090
  9091     ADD +1 TO W-EOB-NDX.
  9092     GO TO 1004-CHECK-EACH-EOB.
  9093
  9094 1004-CHECK-DUP-EOB.
  9095     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9096         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9097                               PI-AT-EOB-CODE (3) OR
  9098                               PI-AT-EOB-CODE (4) OR
  9099                               PI-AT-EOB-CODE (5)))
  9100                  OR
  9101        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9102         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9103                               PI-AT-EOB-CODE (4) OR
  9104                               PI-AT-EOB-CODE (5)))
  9105                  OR
  9106        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9107         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9108                               PI-AT-EOB-CODE (5)))
  9109                  OR
  9110        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9111         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9112            MOVE ER-8000            TO EMI-ERROR
  9113            MOVE AL-UABON           TO NOTE2A
  9114            MOVE -1                 TO NOTE2L
  9115            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9116            GO TO 1005-CHECK-ERRORS.
  9117
  9118 1005-CHECK-ERRORS.
  9119*    IF PI-COMPANY-ID NOT = 'DMD'
  9120        GO TO 1006-CHECK-ERRORS.
  9121
  9122*********  DMD CODE START ******************
  9123*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9124*       GO TO 1006-CHECK-ERRORS.
  9125*
  9126*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9127*
  9128*    COMPUTE W-PAYMENT-TOTAL
  9129*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9130*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9131*               AND
  9132*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9133*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9134*          MOVE ER-0967    TO EMI-ERROR
  9135*          MOVE -1         TO PMTTYPEL
  9136*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9137*
  9138*    GO TO 1006-CHECK-ERRORS.
  9139*********  DMD CODE END ******************
  9140
  9141 1006-CHECK-ERRORS.
  9142     IF NOT EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 175
* EL156.cbl
  9143        GO TO 2000-EDIT-DONE.
  9144
  9145
  9146* EXEC CICS HANDLE CONDITION
  9147*        NOTFND(1950-NOT-FOUND)
  9148*    END-EXEC.
  9149*    MOVE '"$I                   ! '' #00008850' TO DFHEIV0
  9150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9152     MOVE X'2720233030303038383530' TO DFHEIV0(25:11)
  9153     CALL 'kxdfhei1' USING DFHEIV0
  9154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9155
  9156
  9157     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9158     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9159     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9160     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9161     MOVE 'MSTR'                 TO FILE-SWITCH.
  9162
  9163     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9164
  9165     IF PI-COMPANY-ID = 'DMD'
  9166         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9167
  9168     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9169        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9170           MOVE ER-0873    TO EMI-ERROR
  9171           MOVE -1                  TO PROOFDTL
  9172           MOVE AL-UABON            TO PROOFDTA
  9173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9174        END-IF
  9175     END-IF
  9176     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9177         IF PI-PMTTYPE = '5' OR '6'
  9178             NEXT SENTENCE
  9179         ELSE
  9180             MOVE ER-0555             TO EMI-ERROR
  9181             MOVE -1                  TO PMTTYPEL
  9182             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9183
  9184     IF CL-LAST-CLOSE-REASON = '2'
  9185         IF CL-CLAIM-STATUS = 'C'
  9186             MOVE ER-0760        TO  EMI-ERROR
  9187             MOVE -1             TO  PMTTYPEL
  9188             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9189
  9190     IF PI-ACTIVITY-CODE = 9
  9191         MOVE ER-3538            TO  EMI-ERROR
  9192         MOVE -1                 TO  PMTTYPEL
  9193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194
  9195     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9196         GO TO 1008-READ-CERT.
  9197**********************AIG LOGIC STARTS *********************
  9198     IF CL-CERT-PRIME = 'INCOMPLETE'
  9199         MOVE ER-3540            TO  EMI-ERROR
  9200         MOVE -1                 TO  PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 176
* EL156.cbl
  9201         MOVE AL-UABON           TO  PMTTYPEA
  9202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203         GO TO 2000-EDIT-DONE.
  9204
  9205     IF PI-PMTTYPE = '4'
  9206         IF PI-EPYAMT IS NEGATIVE
  9207             IF PI-ECHECKNO-CR = 'CR'
  9208                 NEXT SENTENCE
  9209             ELSE
  9210                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9211
  9212     IF PI-PMTTYPE = '4'
  9213         IF PI-ECHECKNO-CR = 'CR'
  9214             IF PI-EPYAMT IS NEGATIVE
  9215                 NEXT SENTENCE
  9216             ELSE
  9217                 MOVE ER-0834    TO  EMI-ERROR
  9218                 MOVE -1         TO  EPYAMTL
  9219                 MOVE AL-UNBON   TO  EPYAMTA
  9220                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9221
  9222     IF PI-PMTTYPE = '4'
  9223         IF PI-EPYAMT IS NEGATIVE
  9224             IF PI-OFFLINE = 'Y'
  9225                 NEXT SENTENCE
  9226             ELSE
  9227                 MOVE 'Y'        TO  PI-OFFLINE
  9228                                     WS-OFFLINE
  9229                                     OFFLINEO
  9230                 MOVE AL-UANON   TO  OFFLINEA.
  9231
  9232*01845      IF PI-PMTTYPE = '4'
  9233*01846          IF PI-EPYAMT IS NEGATIVE
  9234*01847              IF PI-CASH = 'Y'
  9235*01848                  NEXT SENTENCE
  9236*01849              ELSE
  9237*01850                  MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9238*01851                  MOVE AL-UANON   TO  CASHA
  9239*01852                  GO TO 1007-DEFAULT-AIG-CHECKNO.
  9240*01853
  9241*01854      IF PI-CASH NOT = 'Y' AND 'N'
  9242*01855           IF PI-OFFLINE = 'Y'  AND
  9243*01856              PI-ECHECKNO-CR = 'CR'
  9244*01857                MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9245*01858                MOVE AL-UANON     TO  CASHA
  9246*01859                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9247*01860
  9248*01861      IF PI-CASH NOT = 'Y' AND 'N'
  9249*01862          IF PI-PMTTYPE = '5' OR '6'
  9250*01863              MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9251*01864              MOVE AL-UANON       TO  CASHA
  9252*01865              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9253*01866
  9254*01867      IF PI-CASH NOT = 'Y' AND 'N'
  9255*01868         IF CL-ASSOCIATES = 'N' OR 'A'
  9256*01869             MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9257*01870             MOVE AL-UANON        TO  CASHA
  9258*01871         ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 177
* EL156.cbl
  9259*01872             MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9260*01873             MOVE AL-UANON        TO  CASHA.
  9261*01874
  9262*01875      IF PI-PMTTYPE = '5' OR '6'
  9263*01876          IF PI-CASH = 'N'
  9264*01877              MOVE ER-0819        TO  EMI-ERROR
  9265*01878              MOVE AL-UANON       TO  CASHA
  9266*01879              MOVE -1             TO  CASHL
  9267*01880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9268*01881
  9269*01882      IF CL-ASSOCIATES = 'N' OR 'A'
  9270*01883         IF CASHI = 'N'
  9271*01884          MOVE ER-3537            TO  EMI-ERROR
  9272*01885          MOVE AL-UANON           TO  CASHA
  9273*01886          MOVE -1                 TO  CASHL
  9274*01887          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9275
  9276 1007-DEFAULT-AIG-CHECKNO.
  9277
  9278     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9279         MOVE ER-3532            TO  EMI-ERROR
  9280         MOVE -1                 TO  PMTTYPEL
  9281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9282**********************AIG LOGIC ENDS ***********************
  9283
  9284 1008-READ-CERT.
  9285
  9286     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9287     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9288     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9289     MOVE CL-CERT-STATE          TO CERT-STATE.
  9290     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9291     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9292     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9293     MOVE 'CERT'                 TO FILE-SWITCH.
  9294
  9295     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9296
  9297     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9298         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9299     ELSE
  9300         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9301
  9302*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9303*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9304
  9305     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9306         MOVE ER-0458            TO EMI-ERROR
  9307         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9308
  9309     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9310         MOVE ER-0459            TO EMI-ERROR
  9311         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9312
  9313     IF CL-REPORTED-DT = LOW-VALUES
  9314        MOVE ER-0530             TO EMI-ERROR
  9315        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9316
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 178
* EL156.cbl
  9317     IF PI-COMPANY-ID = 'NCL'
  9318        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9319            MOVE ER-0770            TO EMI-ERROR
  9320            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9321
  9322     IF PI-COMPANY-ID = 'NCL'
  9323        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9324            MOVE ER-0737            TO EMI-ERROR
  9325            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9326
  9327     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9328         MOVE ER-0768            TO  EMI-ERROR
  9329         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9330
  9331     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9332         MOVE ER-0769            TO  EMI-ERROR
  9333         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9334
  9335     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9336         GO TO 1020-DO-LIFE-EDITS
  9337     ELSE
  9338         GO TO 1030-DO-AH-EDITS.
  9339
  9340 1010-GENERAL-ERROR.
  9341     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9342
  9343     IF EMI-MESSAGE-FORMATTED
  9344         MOVE -1                 TO PMTTYPEL.
  9345
  9346 1010-EXIT.
  9347     EXIT.
  9348
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 179
* EL156.cbl
  9350 1020-DO-LIFE-EDITS.
  9351     IF CM-LF-BENEFIT-CD = '00'
  9352         IF PI-PMTTYPE = '5' OR '6'
  9353             MOVE ER-0658        TO EMI-ERROR
  9354             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9355         ELSE
  9356             MOVE ER-1775        TO EMI-ERROR
  9357             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9358
  9359     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9360         MOVE ER-0460            TO EMI-ERROR
  9361         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9362
  9363     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9364     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9365     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9366     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9367     MOVE '4'                    TO  CNTL-REC-TYPE.
  9368     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9369     MOVE 'BENE'                 TO  FILE-SWITCH.
  9370     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9371     IF NO-BENEFIT-FOUND
  9372         GO TO 1950-NOT-FOUND.
  9373
  9374     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9375
  9376     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9377         IF PI-PMTTYPE = '4'
  9378             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9379                PI-LF-COVERAGE-TYPE = 'P'
  9380                 NEXT SENTENCE
  9381             ELSE
  9382                 MOVE ER-0461        TO EMI-ERROR
  9383                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9384         ELSE
  9385            NEXT SENTENCE
  9386     ELSE
  9387         IF PI-PMTTYPE = '2'
  9388            IF NOT CM-O-B-COVERAGE
  9389              AND CM-LF-CURRENT-STATUS = '7'
  9390                MOVE ER-0462     TO EMI-ERROR
  9391                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9392
  9393     IF PI-PMTTYPE = '2'
  9394         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9395            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9396             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9397             MOVE ER-0730            TO  EMI-ERROR
  9398             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9399             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9400
  9401     IF PI-PMTTYPE = '2'
  9402         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9403            PI-LF-COVERAGE-TYPE = 'P'
  9404             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9405                 MOVE ER-0462    TO  EMI-ERROR
  9406                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9407
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 180
* EL156.cbl
  9408     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9409       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9410         MOVE ER-0466            TO EMI-ERROR
  9411         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9412
  9413     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9414         IF PI-PMTTYPE = '3'
  9415             MOVE 0436           TO EMI-ERROR
  9416             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9417             GO TO 1045-EDIT-PAYEE-ADDR
  9418         ELSE
  9419             GO TO 1045-EDIT-PAYEE-ADDR.
  9420
  9421     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9422        PI-LF-COVERAGE-TYPE = 'P'
  9423         IF PI-PMTTYPE = '3'
  9424             MOVE ER-0436          TO  EMI-ERROR
  9425             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9426         ELSE
  9427             NEXT SENTENCE
  9428     ELSE
  9429         IF PI-PMTTYPE = '1' OR '3'
  9430             MOVE ER-0436            TO EMI-ERROR
  9431             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9432*
  9433     IF PI-COMPANY-ID = 'CID' AND
  9434        CL-CERT-STATE = 'SC'  AND
  9435        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9436           MOVE ER-0879    TO  EMI-ERROR
  9437           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9438     END-IF.
  9439     IF PI-COMPANY-ID = 'AHL' AND
  9440        CL-CERT-STATE = 'SC'  AND
  9441        (CM-LF-BENEFIT-CD = '5I' OR '6J')
  9442           MOVE ER-0879    TO  EMI-ERROR
  9443           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9444     END-IF.
  9445
  9446     GO TO 1045-EDIT-PAYEE-ADDR.
  9447
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 181
* EL156.cbl
  9449 1030-DO-AH-EDITS.
  9450     IF CM-AH-BENEFIT-CD = '00'
  9451         IF PI-PMTTYPE = '5' OR '6'
  9452             MOVE ER-0658        TO EMI-ERROR
  9453             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9454         ELSE
  9455             MOVE ER-1775        TO EMI-ERROR
  9456             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9457
  9458     IF CL-TOTAL-PAID-AMT = ZEROS
  9459         IF PI-PMTTYPE = '4'
  9460             MOVE ER-0438        TO EMI-ERROR
  9461             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9462
  9463     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9464         IF PI-PMTTYPE = '3'
  9465             MOVE ER-0463        TO EMI-ERROR
  9466             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9467         ELSE
  9468             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9469              AND CM-LF-CURRENT-STATUS = '7'
  9470                 MOVE ER-0465    TO EMI-ERROR
  9471                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9472
  9473     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9474         IF PI-PMTTYPE = '3'
  9475             MOVE ER-0464        TO EMI-ERROR
  9476             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9477         ELSE
  9478             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9479                 MOVE ER-0469    TO EMI-ERROR
  9480                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9481
  9482     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9483         IF PI-PMTTYPE = '3'
  9484             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9485                 MOVE ER-0467    TO EMI-ERROR
  9486                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9487             ELSE
  9488                 NEXT SENTENCE
  9489         ELSE
  9490             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9491                 MOVE ER-0468    TO EMI-ERROR
  9492                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9493
  9494     GO TO 1045-EDIT-PAYEE-ADDR.
  9495
  9496 1040-PMTTYPE-ERROR.
  9497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498
  9499     IF EMI-MESSAGE-FORMATTED
  9500         MOVE -1                 TO PMTTYPEL
  9501         MOVE AL-UABON           TO PMTTYPEA.
  9502
  9503 1040-EXIT.
  9504     EXIT.
  9505
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 182
* EL156.cbl
  9507 1045-EDIT-PAYEE-ADDR.
  9508
  9509     IF PI-OFFLINE = 'N' AND
  9510        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9511           < PI-PAYEE-SEQ-NUM)
  9512        OR
  9513         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9514         (PI-PAYEE-TYPE = 'B')                 AND
  9515         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9516        OR
  9517         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9518           < PI-PAYEE-SEQ-NUM)
  9519        OR
  9520         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9521           < PI-PAYEE-SEQ-NUM)
  9522        OR
  9523         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9524           < PI-PAYEE-SEQ-NUM)
  9525        OR
  9526         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9527           < PI-PAYEE-SEQ-NUM)
  9528        OR
  9529         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9530           < PI-PAYEE-SEQ-NUM))
  9531             MOVE ER-0437        TO EMI-ERROR
  9532             MOVE -1             TO PAYEEL
  9533             MOVE AL-UABON       TO PAYEEA
  9534             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9535
  9536     IF PI-OFFLINE    = 'N' AND
  9537        PI-PAYEE-TYPE = 'B' AND
  9538        PI-PAYEE-SEQ  = '0'
  9539         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9540         IF BENE-FOUND-SW = 'N'
  9541             MOVE ER-0437        TO EMI-ERROR
  9542             MOVE -1             TO PAYEEL
  9543             MOVE AL-UABON       TO PAYEEA
  9544             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9545
  9546     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9547        IF PI-OFFLINE    = 'N'  AND
  9548           PI-PAYEE-TYPE = 'B'  AND
  9549           PI-PAYEE-SEQ  = '9'
  9550             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9551             IF BENE-FOUND-SW = 'N'
  9552                MOVE ER-0437        TO EMI-ERROR
  9553                MOVE -1             TO PAYEEL
  9554                MOVE AL-UABON       TO PAYEEA
  9555                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9556
  9557*    IF PI-COMPANY-ID = 'CRI'
  9558*        IF CL-CLAIM-TYPE = 'L'
  9559*            MOVE 'N'                TO  WS-GROUPED
  9560*                                        PI-GROUPED
  9561*                                        GROUPEDI
  9562*            MOVE AL-UANON           TO  GROUPEDA
  9563*            GO TO 1050-EDIT-CHECK-NO
  9564*        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 183
* EL156.cbl
  9565*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9566*            IF WS-GROUP-1 = 'C'
  9567*                NEXT SENTENCE
  9568*            ELSE
  9569*                MOVE 'N'            TO  WS-GROUPED
  9570*                                        PI-GROUPED
  9571*                                        GROUPEDI
  9572*                MOVE AL-UANON       TO  GROUPEDA
  9573*                GO TO 1050-EDIT-CHECK-NO.
  9574
  9575*02174      IF PI-GROUPED = 'Y'
  9576*02175         IF PI-PAYEE-TYPE = 'B' OR 'A'
  9577*02176            NEXT SENTENCE
  9578*02177         ELSE
  9579*02178            MOVE ER-0437        TO EMI-ERROR
  9580*02179            MOVE -1             TO PAYEEL
  9581*020413*02180            MOVE AL-UABON       TO PAYEEA
  9582*02181            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583*02182
  9584*02183      IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9585*02184         (PI-GROUPED    = ' ')
  9586*02185         NEXT SENTENCE
  9587*02186      ELSE
  9588*
  9589        GO TO 1050-EDIT-CHECK-NO.
  9590
  9591*02189      IF PI-COMPANY-ID = 'CRI'
  9592*02190         MOVE 'N'           TO GROUPEDI
  9593*02191                               PI-GROUPED
  9594*02192                               WS-GROUPED
  9595*02193         MOVE AL-UANON      TO GROUPEDA.
  9596*02194
  9597*02195      IF PI-COMPANY-ID = 'CRI'
  9598*02196         IF PI-PAYEE-TYPE = 'B'
  9599*02197            IF BENE-FOUND-SW = 'Y'
  9600*02198               IF BE-GROUP-CHECKS-Y-N = 'Y'
  9601*02199                  MOVE 'Y'           TO GROUPEDI
  9602*02200                                        PI-GROUPED
  9603*02201                                        WS-GROUPED
  9604*02202                  MOVE AL-UANON      TO GROUPEDA
  9605*02203               ELSE
  9606*02204                  NEXT SENTENCE
  9607*02205            ELSE
  9608*02206               PERFORM 7920-READ-BENE THRU 7920-EXIT
  9609*02207               IF BENE-FOUND-SW = 'Y'
  9610*02208                  IF BE-GROUP-CHECKS-Y-N = 'Y'
  9611*02209                     MOVE 'Y'      TO GROUPEDI
  9612*02210                                      PI-GROUPED
  9613*02211                                      WS-GROUPED
  9614*02212                     MOVE AL-UANON TO GROUPEDA.
  9615*02213
  9616     IF PI-COMPANY-ID NOT = 'CRI'
  9617        GO TO 1050-EDIT-CHECK-NO.
  9618
  9619*************** CRI CODE START ******************
  9620     IF PI-PAYEE-TYPE NOT = 'A'
  9621        GO TO 1050-EDIT-CHECK-NO.
  9622
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 184
* EL156.cbl
  9623     MOVE LOW-VALUES             TO ERACCT-KEY.
  9624     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9625     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9626     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9627     MOVE PI-STATE               TO ACCT-STATE.
  9628     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9629     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9630     MOVE 'ACCT'                 TO FILE-SWITCH.
  9631
  9632     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9633     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9634
  9635
  9636* EXEC CICS HANDLE CONDITION
  9637*         NOTFND   (1950-NOT-FOUND)
  9638*         ENDFILE  (1950-NOT-FOUND)
  9639*    END-EXEC.
  9640*    MOVE '"$I''                  ! ( #00009332' TO DFHEIV0
  9641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9643     MOVE X'2820233030303039333332' TO DFHEIV0(25:11)
  9644     CALL 'kxdfhei1' USING DFHEIV0
  9645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9646
  9647
  9648
  9649* EXEC CICS STARTBR
  9650*         DATASET   ('ERACCT')
  9651*         RIDFLD    (ERACCT-KEY)
  9652*         GTEQ
  9653*    END-EXEC.
  9654     MOVE 'ERACCT' TO DFHEIV1
  9655     MOVE 0
  9656       TO DFHEIV11
  9657*    MOVE '&,         G          &   #00009337' TO DFHEIV0
  9658     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9659     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9660     MOVE X'2020233030303039333337' TO DFHEIV0(25:11)
  9661     CALL 'kxdfhei1' USING DFHEIV0,
  9662           DFHEIV1,
  9663           ERACCT-KEY,
  9664           DFHEIV99,
  9665           DFHEIV11,
  9666           DFHEIV99
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670 1046-READNEXT-ERACCT.
  9671
  9672
  9673* EXEC CICS READNEXT
  9674*         DATASET   ('ERACCT')
  9675*         RIDFLD    (ERACCT-KEY)
  9676*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9677*    END-EXEC.
  9678     MOVE 'ERACCT' TO DFHEIV1
  9679     MOVE 0
  9680       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 185
* EL156.cbl
  9681*    MOVE '&.S                   )   #00009345' TO DFHEIV0
  9682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9684     MOVE X'2020233030303039333435' TO DFHEIV0(25:11)
  9685     CALL 'kxdfhei1' USING DFHEIV0,
  9686           DFHEIV1,
  9687           DFHEIV20,
  9688           DFHEIV99,
  9689           ERACCT-KEY,
  9690           DFHEIV99,
  9691           DFHEIV11,
  9692           DFHEIV99,
  9693           DFHEIV99
  9694     SET ADDRESS OF ACCOUNT-MASTER TO
  9695         DFHEIV20
  9696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9697
  9698
  9699     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9700        IF WS-ERACCT-HOLD-RECORD = SPACES
  9701           GO TO 1950-NOT-FOUND
  9702        ELSE
  9703           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9704           GO TO 1048-CONTINUE.
  9705
  9706     IF ACCT-EXP-DT = HIGH-VALUES
  9707        NEXT SENTENCE
  9708     ELSE
  9709        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9710        GO TO 1046-READNEXT-ERACCT.
  9711
  9712 1048-CONTINUE.
  9713
  9714*02267      IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9715*02268         MOVE 'Y'                 TO GROUPEDI
  9716*02269                                     PI-GROUPED
  9717*02270                                     WS-GROUPED
  9718*02271         MOVE AL-UANON            TO GROUPEDA.
  9719*************** CRI CODE END ******************
  9720
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 186
* EL156.cbl
  9722 1050-EDIT-CHECK-NO.
  9723
  9724     IF PI-OFFLINE = 'Y'
  9725         IF PI-ECHECKNO = SPACES
  9726              MOVE ER-0439        TO EMI-ERROR
  9727              GO TO 1090-CHECK-NO-ERROR
  9728           ELSE
  9729*02282          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9730*02283             IF PI-ECHECKNO-N = 'N' AND
  9731*02284                PI-CASH       = 'Y'
  9732*02285                  MOVE ER-3535        TO EMI-ERROR
  9733*02286                  GO TO 1090-CHECK-NO-ERROR
  9734*02287               ELSE
  9735*02288                  MOVE AL-UANON    TO CHECKNOA
  9736*02289                  GO TO 1100-EDIT-HOLDTIL
  9737*02290           ELSE
  9738            MOVE AL-UANON    TO CHECKNOA
  9739            GO TO 1100-EDIT-HOLDTIL.
  9740
  9741     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9742     MOVE '6'                    TO CNTL-REC-TYPE.
  9743
  9744     IF CONTROL-IS-ACTUAL-CARRIER
  9745         MOVE PI-CARRIER         TO WS-CARR
  9746     ELSE
  9747         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9748
  9749     IF PI-COMPANY-ID = 'FIA'
  9750         MOVE PI-CARRIER         TO WS-CARR.
  9751
  9752     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9753     MOVE 0                      TO CNTL-SEQ-NO.
  9754     MOVE 'CARR'                 TO FILE-SWITCH.
  9755
  9756     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9757
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 187
* EL156.cbl
  9759     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9760         GO TO 1051-EDIT-CHECKNO-CONT.
  9761
  9762**********************AIG LOGIC STARTS**********************
  9763     IF PI-ECHECKNO = SPACES
  9764         IF CHECK-NO-MANUAL
  9765             MOVE ER-0441        TO EMI-ERROR
  9766             GO TO 1090-CHECK-NO-ERROR
  9767         ELSE
  9768             MOVE AL-UANOF       TO CHECKNOA
  9769             GO TO 1100-EDIT-HOLDTIL.
  9770
  9771     IF PI-ECHECKNO NOT = SPACES
  9772         IF CHECK-NO-MANUAL
  9773             MOVE AL-UANON       TO CHECKNOA
  9774             GO TO 1100-EDIT-HOLDTIL.
  9775
  9776     IF PI-ECHECKNO-CR = 'CR'
  9777        IF PI-OFFLINE = 'Y'
  9778            MOVE AL-UANON       TO CHECKNOA
  9779            GO TO 1100-EDIT-HOLDTIL
  9780        ELSE
  9781            MOVE ER-3534        TO EMI-ERROR
  9782            GO TO 1090-CHECK-NO-ERROR.
  9783
  9784     IF PI-ECHECKNO-N = 'N'
  9785        IF PI-CASH = 'N'
  9786            MOVE AL-UANON       TO CHECKNOA
  9787            GO TO 1100-EDIT-HOLDTIL
  9788        ELSE
  9789            MOVE ER-3535          TO EMI-ERROR
  9790            GO TO 1090-CHECK-NO-ERROR.
  9791
  9792     MOVE ER-0442        TO EMI-ERROR
  9793     GO TO 1090-CHECK-NO-ERROR.
  9794**********************AIG LOGIC ENDS************************
  9795
  9796 1051-EDIT-CHECKNO-CONT.
  9797
  9798     IF PI-COMPANY-ID = 'DMD'
  9799        IF PI-ECHECKNO NOT = SPACES
  9800           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9801              MOVE ER-0442        TO EMI-ERROR
  9802              GO TO 1090-CHECK-NO-ERROR
  9803            ELSE
  9804              GO TO 1100-EDIT-HOLDTIL
  9805          ELSE
  9806           GO TO 1100-EDIT-HOLDTIL.
  9807
  9808     IF PI-ECHECKNO = SPACES
  9809         IF CHECK-NO-MANUAL
  9810             MOVE ER-0441        TO EMI-ERROR
  9811             GO TO 1090-CHECK-NO-ERROR
  9812         ELSE
  9813             MOVE AL-UANOF       TO CHECKNOA
  9814             GO TO 1100-EDIT-HOLDTIL
  9815     ELSE
  9816         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 188
* EL156.cbl
  9817             MOVE AL-UANON       TO CHECKNOA
  9818             GO TO 1100-EDIT-HOLDTIL
  9819         ELSE
  9820             MOVE ER-0442        TO EMI-ERROR
  9821             GO TO 1090-CHECK-NO-ERROR.
  9822
  9823 1090-CHECK-NO-ERROR.
  9824     MOVE -1                     TO CHECKNOL.
  9825     MOVE AL-UABON               TO CHECKNOA.
  9826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9827
  9828     GO TO 2000-EDIT-DONE.
  9829
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 189
* EL156.cbl
  9831 1100-EDIT-HOLDTIL.
  9832     MOVE AL-UANON               TO HOLDTILA.
  9833
  9834     IF PI-HOLDTIL = ZEROS
  9835        IF PI-OFFLINE = 'Y'
  9836           MOVE ER-0572          TO EMI-ERROR
  9837           GO TO 1105-HOLDTIL-ERROR
  9838        ELSE
  9839           GO TO 1110-EDIT-PAID-FROM.
  9840
  9841     MOVE '4'                    TO DC-OPTION-CODE.
  9842     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9843     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9844
  9845     IF DATE-CONVERSION-ERROR
  9846         MOVE ER-0446            TO EMI-ERROR
  9847         GO TO 1105-HOLDTIL-ERROR
  9848     END-IF
  9849     IF PI-OFFLINE = 'Y'
  9850        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9851           MOVE ER-0446            TO EMI-ERROR
  9852           GO TO 1105-HOLDTIL-ERROR
  9853        END-IF
  9854     END-IF
  9855
  9856     IF PI-OFFLINE = 'Y'
  9857        GO TO 1110-EDIT-PAID-FROM.
  9858
  9859     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9860     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9861     MOVE '1'                    TO DC-OPTION-CODE.
  9862     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9863
  9864     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9865         MOVE ER-0447            TO EMI-ERROR
  9866         GO TO 1105-HOLDTIL-ERROR.
  9867
  9868     GO TO 1110-EDIT-PAID-FROM.
  9869
  9870 1105-HOLDTIL-ERROR.
  9871     MOVE -1                     TO HOLDTILL.
  9872     MOVE AL-UNBON               TO HOLDTILA.
  9873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9874
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 190
* EL156.cbl
  9876 1110-EDIT-PAID-FROM.
  9877     MOVE AL-UANON               TO EPYFROMA.
  9878
  9879     IF PI-EPYFROM = ZEROS
  9880         GO TO 1120-CALCULATE-PAID-FROM.
  9881
  9882     IF PI-PMTTYPE = '5' OR '6'
  9883         MOVE ER-0448            TO EMI-ERROR
  9884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9885         MOVE AL-UNBON           TO EPYFROMA
  9886         MOVE -1                 TO EPYFROML
  9887         GO TO 1150-EDIT-PAID-THRU.
  9888
  9889     MOVE '4'                    TO DC-OPTION-CODE.
  9890     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9891     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9892
  9893     IF DATE-CONVERSION-ERROR
  9894         MOVE ER-0449            TO EMI-ERROR
  9895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9896         MOVE AL-UNBON           TO EPYFROMA
  9897         MOVE -1                 TO EPYFROML
  9898     ELSE
  9899         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9900
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 191
* EL156.cbl
  9902 1120-CALCULATE-PAID-FROM.
  9903     IF PI-PMTTYPE = '5' OR '6'
  9904         GO TO 1150-EDIT-PAID-THRU.
  9905
  9906*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9907*       IF PI-PMTTYPE = '4'
  9908*         GO TO 1150-EDIT-PAID-THRU.
  9909
  9910     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9911         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9912         MOVE ' '                TO DC-OPTION-CODE
  9913         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9914         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9915         GO TO 1145-TEST-PAID-FROM.
  9916
  9917     IF PI-PMTTYPE = '4'
  9918        GO TO 1150-EDIT-PAID-THRU.
  9919
  9920     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9921     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9922     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9923     MOVE '5'                    TO CNTL-REC-TYPE.
  9924     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9925     MOVE 'BENE'                 TO FILE-SWITCH.
  9926
  9927     IF WS-BEN-CD = ZEROS
  9928         GO TO 1950-NOT-FOUND.
  9929
  9930     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9931
  9932     IF NO-BENEFIT-FOUND
  9933         GO TO 1950-NOT-FOUND.
  9934
  9935     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9936     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9937
  9938     IF PI-BEN-DAYS NOT NUMERIC
  9939        MOVE ZEROS               TO PI-BEN-DAYS.
  9940
  9941     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9942
  9943     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9944        (CL-TOTAL-PAID-AMT > ZEROS)
  9945         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9946         MOVE '6'                 TO DC-OPTION-CODE
  9947         MOVE +0                  TO DC-ELAPSED-MONTHS
  9948         MOVE +1                  TO DC-ELAPSED-DAYS
  9949         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9950         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9951         GO TO 1145-TEST-PAID-FROM.
  9952
  9953******************************************************************
  9954****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9955****** SPECIAL ENTERED DATE.
  9956******************************************************************
  9957
  9958     IF PI-AIGFROM = ZEROS
  9959         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 192
* EL156.cbl
  9960
  9961     MOVE AL-UANON TO AIGFROMA.
  9962
  9963     MOVE '4'                    TO DC-OPTION-CODE.
  9964     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9965     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9966
  9967     IF DATE-CONVERSION-ERROR
  9968         MOVE ER-0449            TO EMI-ERROR
  9969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9970         MOVE AL-UNBON           TO AIGFROMA
  9971         MOVE -1                 TO AIGFROML
  9972         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9973     ELSE
  9974         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9975         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9976
  9977     GO TO 1140-CONTINUE-PAID-FROM.
  9978
  9979 1130-CONTINUE-PAID-FROM.
  9980
  9981     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9982        (CL-TOTAL-PAID-AMT = ZEROS)
  9983           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9984
  9985 1140-CONTINUE-PAID-FROM.
  9986
  9987     IF PI-BEN-TYPE = 'R'
  9988         IF PI-BEN-DAYS = ZEROS
  9989             NEXT SENTENCE
  9990         ELSE
  9991         IF PI-COMPANY-ID NOT = 'DMD'
  9992             SUBTRACT 1 FROM PI-BEN-DAYS.
  9993
  9994     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
  9995
  9996     IF PI-COMPANY-ID = 'DMD'
  9997         MOVE -1                 TO DC-ELAPSED-DAYS
  9998         MOVE +0                 TO DC-ELAPSED-MONTHS
  9999         MOVE '6'                TO DC-OPTION-CODE
 10000         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10001         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10002         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10003                               REMAINDER DC-ELAPSED-DAYS
 10004      ELSE
 10005         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10006         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10007
 10008     MOVE '6'                    TO DC-OPTION-CODE.
 10009     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10010     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10011
 10012     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10013
 10014     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10015         MOVE ER-0541            TO EMI-ERROR
 10016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10017         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 193
* EL156.cbl
 10018         MOVE AL-UNBON           TO EPYFROMA.
 10019
 10020     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10021        (PI-BENEFIT-SAVE = '60E')
 10022        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10023           (CL-TOTAL-PAID-AMT = ZEROS)
 10024             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10025             MOVE 30                  TO DC-ELAPSED-DAYS
 10026             MOVE +0                  TO DC-ELAPSED-MONTHS
 10027             MOVE '6'                 TO DC-OPTION-CODE
 10028             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10029
 10030     IF PI-BEN-TYPE = 'R'
 10031         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10032     ELSE
 10033         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10034         IF WS-SV-EPYFROM = LOW-VALUES
 10035            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10036
 10037     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10038         IF WS-USE-AIG-PAYFROM   OR
 10039            WS-AIG-RECALC-PAYFROM
 10040              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10041                                      DC-BIN-DATE-1
 10042              MOVE ' '            TO  DC-OPTION-CODE
 10043              MOVE +0             TO  DC-ELAPSED-MONTHS
 10044                                      DC-ELAPSED-DAYS
 10045              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10046              IF NO-CONVERSION-ERROR
 10047                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10048
 10049     IF PI-CPYFROM < CL-INCURRED-DT
 10050        MOVE -1                  TO EPYFROML
 10051        MOVE ER-3542             TO EMI-ERROR
 10052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10053
 10054     IF CM-ENTRY-DT < CL-INCURRED-DT
 10055        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10056        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10057        MOVE +0                     TO DC-ELAPSED-DAYS
 10058        MOVE +0                     TO DC-ELAPSED-MONTHS
 10059        MOVE '1'                    TO DC-OPTION-CODE
 10060        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10061        ELSE
 10062        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10063
 10064     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10065         NEXT SENTENCE
 10066     ELSE
 10067         IF DC-ELAPSED-MONTHS < 2
 10068             MOVE ER-3255        TO EMI-ERROR
 10069             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10070
 10071 1145-TEST-PAID-FROM.
 10072     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10073         GO TO 1150-EDIT-PAID-THRU.
 10074
 10075     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 194
* EL156.cbl
 10076         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10077         MOVE ' '                TO DC-OPTION-CODE
 10078         MOVE +0                 TO DC-ELAPSED-MONTHS
 10079                                    DC-ELAPSED-DAYS
 10080         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10081         IF NO-CONVERSION-ERROR
 10082             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10083         ELSE
 10084             MOVE SPACES             TO EMI-DATE-FIELD.
 10085
 10086     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10087         IF CL-TOTAL-PAID-AMT = ZEROS
 10088             MOVE ER-3543            TO EMI-ERROR
 10089             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10090             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10091             IF EMI-MESSAGE-FORMATTED
 10092                MOVE -1             TO EPYFROML
 10093                MOVE AL-UNBON       TO EPYFROMA
 10094             ELSE
 10095                NEXT SENTENCE
 10096         ELSE
 10097             MOVE ER-0452            TO EMI-ERROR
 10098             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10099             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10100             IF EMI-MESSAGE-FORMATTED
 10101                MOVE -1             TO EPYFROML
 10102                MOVE AL-UNBON       TO EPYFROMA.
 10103
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 195
* EL156.cbl
 10105 1150-EDIT-PAID-THRU.
 10106
 10107     MOVE AL-UANON               TO EPYTHRUA.
 10108
 10109     IF PI-EPYTHRU = ZEROS
 10110         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10111             GO TO 1200-EDIT-FIND-TOLERANCES
 10112         ELSE
 10113            IF (PI-PMTTYPE = '3') OR
 10114               (PI-PMTTYPE = '2' AND
 10115                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10116               GO TO 1152-CHECK-TYPE
 10117            ELSE
 10118               MOVE ER-0473      TO EMI-ERROR
 10119               GO TO 1170-PAID-THRU-FATAL-ERROR
 10120     ELSE
 10121         IF PI-PMTTYPE = '5' OR '6'
 10122             MOVE ER-0474        TO EMI-ERROR
 10123             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10124
 10125     MOVE '4'                    TO DC-OPTION-CODE.
 10126     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10127     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10128
 10129     IF DATE-CONVERSION-ERROR
 10130         MOVE ER-0475            TO EMI-ERROR
 10131         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10132
 10133     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10134
 10135     IF PI-COMPANY-ID = 'DMD'
 10136         IF PI-PMTTYPE NOT = '2'
 10137                 AND
 10138            WS-EXP-DT > WS-SV-EPYTHRU
 10139             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10140             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10141             MOVE '1'              TO DC-OPTION-CODE
 10142             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10143             IF DATE-CONVERSION-ERROR
 10144                 MOVE ER-0944      TO EMI-ERROR
 10145                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10146             ELSE
 10147                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10148                    DC-ELAPSED-DAYS   = 1
 10149                     MOVE ER-0945  TO EMI-ERROR
 10150                     MOVE -1       TO EPYTHRUL
 10151                     MOVE AL-UABON TO EPYTHRUA
 10152                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10153
 10154     IF PI-PMTTYPE = '4'
 10155         NEXT SENTENCE
 10156     ELSE
 10157         IF WS-SV-EPYTHRU = WS-EXP-DT
 10158             IF PI-PMTTYPE NOT = '2' AND '3'
 10159                 MOVE ER-3541    TO EMI-ERROR
 10160                 MOVE -1         TO PMTTYPEL
 10161                 MOVE AL-UABON   TO PMTTYPEA
 10162                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 196
* EL156.cbl
 10163
 10164     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10165         MOVE ER-0501            TO EMI-ERROR
 10166         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10167
 10168     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10169        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10170*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10171*              MOVE ER-0540         TO EMI-ERROR
 10172*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10173*              MOVE -1              TO EPYTHRUL
 10174*              MOVE AL-UNBON        TO EPYTHRUA
 10175*          ELSE
 10176*          IF PI-COMPANY-ID = 'DMD'
 10177*              MOVE ER-7540         TO EMI-ERROR
 10178*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10179*              MOVE -1              TO EPYTHRUL
 10180*              MOVE AL-UNBON        TO EPYTHRUA
 10181*          ELSE
 10182               IF PI-PMTTYPE NOT = '2' AND '3'
 10183                  IF PI-COMPANY-ID = '???'
 10184                      MOVE ER-7540  TO EMI-ERROR
 10185                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10186                      MOVE -1       TO EPYTHRUL
 10187                      MOVE AL-UNBON TO EPYTHRUA
 10188                  ELSE
 10189                      MOVE ER-0540  TO EMI-ERROR
 10190                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10191                      MOVE -1       TO EPYTHRUL
 10192                      MOVE AL-UNBON TO EPYTHRUA.
 10193
 10194     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10195            OR
 10196        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10197         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10198            OR
 10199        (PI-CPYFROM NOT = LOW-VALUES AND
 10200         PI-CPYFROM < CL-PAID-THRU-DT)
 10201        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10202
 10203 1152-CHECK-TYPE.
 10204     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10205        OR (PI-PMTTYPE = '5' OR '6')
 10206         GO TO 1160-EDIT-PAID-THRU-AH.
 10207
 10208 1155-EDIT-PAID-THRU-LIFE.
 10209     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10210     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10211     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10212     MOVE '4'                    TO CNTL-REC-TYPE.
 10213     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10214     MOVE 'BENE'                 TO FILE-SWITCH.
 10215
 10216     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10217
 10218     IF NO-BENEFIT-FOUND
 10219         GO TO 1950-NOT-FOUND.
 10220
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 197
* EL156.cbl
 10221     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10222
 10223     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10224
 10225     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10226        PI-LF-COVERAGE-TYPE = 'P'
 10227         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10228         GO TO 1200-EDIT-FIND-TOLERANCES.
 10229
 10230     IF PI-EPYTHRU = ZEROS
 10231        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10232
 10233     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10234         MOVE ER-0476            TO EMI-ERROR
 10235         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10236
 10237     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10238     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10239     MOVE +0                    TO DC-ELAPSED-DAYS.
 10240     MOVE '6'                   TO DC-OPTION-CODE.
 10241     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10242
 10243     IF (NO-CONVERSION-ERROR AND
 10244         WS-SPECIAL-CALC-CD = 'C')
 10245        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10246            MOVE ER-0657 TO EMI-ERROR
 10247            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10248
 10249     IF PI-COMPANY-ID = 'NCL'
 10250         IF WS-SPECIAL-CALC-CD = 'C' AND
 10251            CM-LF-CRITICAL-PERIOD = +0
 10252             MOVE ER-0844       TO EMI-ERROR
 10253             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10254
 10255     GO TO 1200-EDIT-FIND-TOLERANCES.
 10256
 10257 1160-EDIT-PAID-THRU-AH.
 10258     IF PI-EPYTHRU = ZEROS
 10259        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10260                                    WS-SV-EPYTHRU
 10261     ELSE
 10262        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10263
 10264     IF WS-SV-EPYTHRU < PI-CPYFROM
 10265         MOVE ER-0508            TO EMI-ERROR
 10266         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10267
 10268     IF PI-PMTTYPE = '3'
 10269        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10270         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10271             MOVE ER-0477        TO EMI-ERROR
 10272             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10273         ELSE
 10274             NEXT SENTENCE
 10275     ELSE
 10276         IF WS-SV-EPYTHRU > WS-EXP-DT
 10277             MOVE ER-0557        TO EMI-ERROR
 10278             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 198
* EL156.cbl
 10279
 10280     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10281         PI-PMTTYPE NOT = '3'
 10282         MOVE ER-0541        TO EMI-ERROR
 10283         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10284
 10285     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10286        (PI-PMTTYPE NOT = '3')
 10287         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10288             MOVE ER-0478        TO EMI-ERROR
 10289             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10290
 10291     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10292        (PI-PMTTYPE NOT = '4')
 10293         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10294             MOVE ER-0479        TO EMI-ERROR
 10295             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10296
 10297     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10298         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10299             MOVE ER-0545        TO EMI-ERROR
 10300             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10301
 10302     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10303         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10304             MOVE ER-0481        TO EMI-ERROR
 10305             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10306
 10307*    IF PI-COMPANY-ID = 'NCL'
 10308*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10309*           CM-AH-CRITICAL-PERIOD = +0
 10310*            MOVE ER-0844        TO  EMI-ERROR
 10311*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10312
 10313     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10314        (WS-SPECIAL-CALC-CD NOT = 'C')
 10315          GO TO 1200-EDIT-FIND-TOLERANCES.
 10316
 10317     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10318     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10319     MOVE '1'        TO DC-OPTION-CODE.
 10320     MOVE +0         TO DC-ELAPSED-DAYS
 10321                        DC-ELAPSED-MONTHS.
 10322     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10323
 10324*    IF NO-CONVERSION-ERROR
 10325*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10326*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10327*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10328*           MOVE ER-0657 TO EMI-ERROR
 10329*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10330
 10331     GO TO 1200-EDIT-FIND-TOLERANCES.
 10332
 10333 1165-PAID-THRU-ERROR.
 10334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10335
 10336     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 199
* EL156.cbl
 10337         MOVE -1                 TO EPYTHRUL
 10338         MOVE AL-UNBON           TO EPYTHRUA.
 10339
 10340 1165-EXIT.
 10341     EXIT.
 10342
 10343 1166-CHECK-ALL-TRLRS.
 10344
 10345     IF PI-PMTTYPE = '4'
 10346        GO TO 1166-TRLR-EXIT.
 10347
 10348     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10349
 10350     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10351        WS-SV-EPYFROM = LOW-VALUES
 10352          GO TO 1166-END-CHECK.
 10353
 10354
 10355* EXEC CICS HANDLE CONDITION
 10356*        ENDFILE   (1166-END-CHECK)
 10357*        NOTFND    (1166-END-CHECK)
 10358*    END-EXEC.
 10359*    MOVE '"$''I                  ! ) #00010006' TO DFHEIV0
 10360     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10362     MOVE X'2920233030303130303036' TO DFHEIV0(25:11)
 10363     CALL 'kxdfhei1' USING DFHEIV0
 10364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10365
 10366
 10367     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10368     MOVE +100                   TO TRLR-SEQ-NO.
 10369
 10370
 10371* EXEC CICS STARTBR
 10372*         DATASET    ('ELTRLR')
 10373*         RIDFLD     (ELTRLR-KEY)
 10374*         GTEQ
 10375*    END-EXEC.
 10376     MOVE 'ELTRLR' TO DFHEIV1
 10377     MOVE 0
 10378       TO DFHEIV11
 10379*    MOVE '&,         G          &   #00010014' TO DFHEIV0
 10380     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10382     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 10383     CALL 'kxdfhei1' USING DFHEIV0,
 10384           DFHEIV1,
 10385           ELTRLR-KEY,
 10386           DFHEIV99,
 10387           DFHEIV11,
 10388           DFHEIV99
 10389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10390
 10391
 10392     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10393
 10394 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 200
* EL156.cbl
 10395
 10396
 10397* EXEC CICS READNEXT
 10398*         DATASET    ('ELTRLR')
 10399*         RIDFLD     (ELTRLR-KEY)
 10400*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10401*    END-EXEC.
 10402     MOVE 'ELTRLR' TO DFHEIV1
 10403     MOVE 0
 10404       TO DFHEIV11
 10405*    MOVE '&.S                   )   #00010024' TO DFHEIV0
 10406     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10407     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10408     MOVE X'2020233030303130303234' TO DFHEIV0(25:11)
 10409     CALL 'kxdfhei1' USING DFHEIV0,
 10410           DFHEIV1,
 10411           DFHEIV20,
 10412           DFHEIV99,
 10413           ELTRLR-KEY,
 10414           DFHEIV99,
 10415           DFHEIV11,
 10416           DFHEIV99,
 10417           DFHEIV99
 10418     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10419         DFHEIV20
 10420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10421
 10422
 10423     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10424        TRLR-CARRIER  = MSTR-CARRIER  AND
 10425        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10426        TRLR-CERT-NO  = MSTR-CERT-NO
 10427          NEXT SENTENCE
 10428      ELSE
 10429          GO TO 1166-END-CHECK.
 10430
 10431* **  BYPASS ALL NON-PAYMENT TRAILERS
 10432
 10433     IF AT-TRAILER-TYPE = '2'
 10434        NEXT SENTENCE
 10435     ELSE
 10436        GO TO 1166-READ-TRLR-NEXT.
 10437
 10438* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10439
 10440     IF AT-PAYMENT-TYPE = '1' OR '2'
 10441        NEXT SENTENCE
 10442     ELSE
 10443        GO TO 1166-READ-TRLR-NEXT.
 10444
 10445* **  BYPASS ALL VOID PAYMENTS
 10446
 10447     IF AT-VOID-DT NOT = LOW-VALUES
 10448        GO TO 1166-READ-TRLR-NEXT.
 10449
 10450     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10451        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10452          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 201
* EL156.cbl
 10453
 10454     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10455         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10456            OR
 10457        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10458         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10459        NEXT SENTENCE
 10460     ELSE
 10461         IF CL-TOTAL-PAID-AMT > ZEROS
 10462             MOVE ER-0502            TO EMI-ERROR
 10463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10464             MOVE -1                 TO EPYTHRUL
 10465             MOVE AL-UNBON           TO EPYTHRUA.
 10466
 10467     GO TO 1166-READ-TRLR-NEXT.
 10468
 10469 1166-END-CHECK.
 10470
 10471     IF WS-BROWSE-TRLR-SW = 'Y'
 10472
 10473* EXEC CICS ENDBR
 10474*            DATASET   ('ELTRLR')
 10475*       END-EXEC.
 10476     MOVE 'ELTRLR' TO DFHEIV1
 10477     MOVE 0
 10478       TO DFHEIV11
 10479*    MOVE '&2                    $   #00010079' TO DFHEIV0
 10480     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10482     MOVE X'2020233030303130303739' TO DFHEIV0(25:11)
 10483     CALL 'kxdfhei1' USING DFHEIV0,
 10484           DFHEIV1,
 10485           DFHEIV11,
 10486           DFHEIV99
 10487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10488
 10489
 10490     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10491
 10492 1166-TRLR-EXIT.
 10493     EXIT.
 10494
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 202
* EL156.cbl
 10496 1170-PAID-THRU-FATAL-ERROR.
 10497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10498
 10499     MOVE -1                     TO EPYTHRUL.
 10500     MOVE AL-UNBON               TO EPYTHRUA.
 10501
 10502 1200-EDIT-FIND-TOLERANCES.
 10503
 10504* EXEC CICS HANDLE CONDITION
 10505*        ENDFILE(1950-NOT-FOUND)
 10506*        NOTFND (1950-NOT-FOUND)
 10507*    END-EXEC.
 10508*    MOVE '"$''I                  ! * #00010096' TO DFHEIV0
 10509     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10511     MOVE X'2A20233030303130303936' TO DFHEIV0(25:11)
 10512     CALL 'kxdfhei1' USING DFHEIV0
 10513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10514
 10515
 10516     IF PI-PROCESSOR-ID = 'LGXX'
 10517        GO TO 1240-FIND-ACCT-TOLERANCES.
 10518
 10519     MOVE 'N'                    TO FOUND-TOL-SW.
 10520     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10521     MOVE '2'                    TO CNTL-REC-TYPE.
 10522     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10523     MOVE +0                     TO CNTL-SEQ-NO.
 10524     MOVE 'PROC'                 TO FILE-SWITCH.
 10525
 10526     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10527
 10528     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10529     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10530                                    PI-MAX-PMT-TOL.
 10531     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10532
 10533     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10534         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10535
 10536     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10537     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10538                                    PI-MAX-LF-PMT-TOL.
 10539
 10540     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10541         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10542
 10543     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10544                                    PI-MAX-EXP-PMT.
 10545
 10546 1240-FIND-ACCT-TOLERANCES.
 10547
 10548     IF WS-PMT-TOL NOT = +0
 10549         MOVE 'Y'                TO FOUND-TOL-SW.
 10550
 10551     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10552         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10553         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 203
* EL156.cbl
 10554         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10555         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10556         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10557         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10558     ELSE
 10559         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10560         MOVE PI-CARRIER             TO ACCT-CARRIER
 10561         MOVE PI-GROUPING            TO ACCT-GROUPING
 10562         MOVE PI-STATE               TO ACCT-STATE
 10563         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10564         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10565
 10566     MOVE 'ACCT'                 TO FILE-SWITCH.
 10567
 10568     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10569     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10570
 10571
 10572* EXEC CICS HANDLE CONDITION
 10573*         NOTFND   (1950-NOT-FOUND)
 10574*         ENDFILE  (1950-NOT-FOUND)
 10575*    END-EXEC.
 10576*    MOVE '"$I''                  ! + #00010156' TO DFHEIV0
 10577     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10579     MOVE X'2B20233030303130313536' TO DFHEIV0(25:11)
 10580     CALL 'kxdfhei1' USING DFHEIV0
 10581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10582
 10583
 10584
 10585* EXEC CICS STARTBR
 10586*        DATASET('ERACCT')
 10587*        RIDFLD (ERACCT-KEY)
 10588*        GTEQ
 10589*    END-EXEC.
 10590     MOVE 'ERACCT' TO DFHEIV1
 10591     MOVE 0
 10592       TO DFHEIV11
 10593*    MOVE '&,         G          &   #00010161' TO DFHEIV0
 10594     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10596     MOVE X'2020233030303130313631' TO DFHEIV0(25:11)
 10597     CALL 'kxdfhei1' USING DFHEIV0,
 10598           DFHEIV1,
 10599           ERACCT-KEY,
 10600           DFHEIV99,
 10601           DFHEIV11,
 10602           DFHEIV99
 10603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10604
 10605
 10606 1245-FIND-ACCT-TOLERANCES-LOOP.
 10607
 10608
 10609* EXEC CICS READNEXT
 10610*        DATASET('ERACCT')
 10611*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 204
* EL156.cbl
 10612*        RIDFLD (ERACCT-KEY)
 10613*    END-EXEC.
 10614     MOVE 'ERACCT' TO DFHEIV1
 10615     MOVE 0
 10616       TO DFHEIV11
 10617*    MOVE '&.S                   )   #00010169' TO DFHEIV0
 10618     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10619     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10620     MOVE X'2020233030303130313639' TO DFHEIV0(25:11)
 10621     CALL 'kxdfhei1' USING DFHEIV0,
 10622           DFHEIV1,
 10623           DFHEIV20,
 10624           DFHEIV99,
 10625           ERACCT-KEY,
 10626           DFHEIV99,
 10627           DFHEIV11,
 10628           DFHEIV99,
 10629           DFHEIV99
 10630     SET ADDRESS OF ACCOUNT-MASTER TO
 10631         DFHEIV20
 10632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10633
 10634
 10635     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10636        IF WS-ERACCT-HOLD-RECORD = SPACES
 10637           GO TO 1950-NOT-FOUND
 10638        ELSE
 10639           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10640           GO TO 1250-CONTINUE.
 10641
 10642     IF ACCT-EXP-DT = HIGH-VALUES
 10643        NEXT SENTENCE
 10644     ELSE
 10645        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10646        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10647
 10648 1250-CONTINUE.
 10649
 10650     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10651
 10652     IF FOUND-TOL-SW = 'N'
 10653         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10654
 10655********* 1260-FIND-STATE-TOLERANCES.
 10656
 10657     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10658     MOVE PI-STATE               TO WS-ST-ACCESS.
 10659     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10660     MOVE '3'                    TO CNTL-REC-TYPE.
 10661     MOVE +0                     TO CNTL-SEQ-NO.
 10662     MOVE 'STAT'                 TO FILE-SWITCH.
 10663
 10664     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10665
 10666     IF WS-PMT-TOL = +0
 10667         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10668
 10669     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 205
* EL156.cbl
 10670     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10671     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10672     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10673     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 10674
 10675****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 10676     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 10677*        PI-VFY-2ND-BENE = 'Y' AND
 10678        PI-PAYEE-TYPE <> 'B'
 10679           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 10680     END-IF.
 10681
 10682     IF PI-PMTTYPE      = '2'  AND
 10683        PI-SPLIT-PMT-SW = 'Y'  AND
 10684        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10685          MOVE ER-3530                TO EMI-ERROR
 10686          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10687
 10688********* 1280-FIND-BENEFIT-TOLERANCES.
 10689
 10690     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10691        OR (PI-PMTTYPE = '5' OR '6')
 10692         GO TO 1300-FIND-CARR-TOLERANCES.
 10693
 10694     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10695     MOVE '4'                    TO CNTL-REC-TYPE.
 10696     MOVE +0                     TO CNTL-SEQ-NO.
 10697     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10698     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10699     MOVE 'BENE'                 TO FILE-SWITCH.
 10700
 10701     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10702
 10703     IF NO-BENEFIT-FOUND
 10704         GO TO 1950-NOT-FOUND.
 10705
 10706     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10707     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10708     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10709
 10710
 10711* EXEC CICS HANDLE CONDITION
 10712*        NOTFND(1950-NOT-FOUND)
 10713*    END-EXEC.
 10714*    MOVE '"$I                   ! , #00010250' TO DFHEIV0
 10715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10717     MOVE X'2C20233030303130323530' TO DFHEIV0(25:11)
 10718     CALL 'kxdfhei1' USING DFHEIV0
 10719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10720
 10721
 10722 1300-FIND-CARR-TOLERANCES.
 10723     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10724     MOVE '6'                    TO CNTL-REC-TYPE.
 10725
 10726     IF CONTROL-IS-ACTUAL-CARRIER
 10727         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 206
* EL156.cbl
 10728     ELSE
 10729         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10730
 10731     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10732     MOVE +0                     TO CNTL-SEQ-NO.
 10733     MOVE 'CARR'                 TO FILE-SWITCH.
 10734
 10735     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 10736
 10737     IF WS-DAYS-TOL = +0
 10738         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10739
 10740     IF WS-PMT-TOL = +0
 10741         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10742
 10743     IF WS-MAX-DAYS-TOL = +0
 10744         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10745
 10746     IF WS-MAX-PMT-TOL = +0
 10747         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10748                                    PI-MAX-PMT-TOL.
 10749
 10750     IF WS-MAX-LF-PMT-TOL = +0
 10751        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10752                                    PI-MAX-LF-PMT-TOL.
 10753
 10754     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10755
 10756********* 1320-FIND-COMP-TOLERANCES.
 10757
 10758     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10759     MOVE '1'                    TO CNTL-REC-TYPE.
 10760     MOVE SPACES                 TO CNTL-ACCESS.
 10761     MOVE +0                     TO CNTL-SEQ-NO.
 10762     MOVE 'COMP'                 TO FILE-SWITCH.
 10763
 10764     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10765
 10766     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10767     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10768
 10769     IF WS-PMT-TOL NOT = +0
 10770        IF WS-TOL-SEVERITY NOT = ' '
 10771         GO TO 1360-EDIT-DAYS.
 10772
 10773     IF WS-PMT-TOL = +0
 10774         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10775
 10776     IF WS-TOL-SEVERITY = ' '
 10777         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10778
 10779 1360-EDIT-DAYS.
 10780     IF PI-PMTTYPE NOT = '4'
 10781        IF PI-EDAYS NEGATIVE OR
 10782           PI-EPYAMT NEGATIVE
 10783          MOVE ER-0513             TO EMI-ERROR
 10784          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10785          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 207
* EL156.cbl
 10786
 10787     IF PI-PMTTYPE = '5' OR '6'
 10788        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10789
 10790     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10791        IF PI-PMTTYPE = '4'
 10792          MOVE PI-EDAYS          TO PI-CDAYS.
 10793
 10794     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10795         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10796
 10797     IF PI-PMTTYPE = '4'
 10798        MOVE PI-EDAYS            TO PI-CDAYS
 10799        GO TO 1400-EDIT-PAYMENT.
 10800
 10801     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10802        GO TO 1500-EDIT-EXPENSES.
 10803
 10804*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10805*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10806*          CM-AH-BENEFIT-CD = '23'              AND
 10807*          CL-CERT-STATE    = '04'              AND
 10808*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10809*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10810*            GO TO 1362-CHECK-MAX-DAYS.
 10811
 10812     IF PI-EDAYS = ZEROS
 10813*        IF PI-COMPANY-ID = 'DMD'
 10814*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10815*            MOVE -1             TO DC-ELAPSED-DAYS
 10816*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10817*            MOVE '6'            TO DC-OPTION-CODE
 10818*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10819*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10820*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10821*            MOVE '1'            TO DC-OPTION-CODE
 10822*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10823*            IF NO-CONVERSION-ERROR
 10824*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10825*                                 + DC-ODD-DAYS-OVER
 10826*               MOVE 6           TO EDAYSL
 10827*               MOVE AL-UNNON    TO EDAYSA
 10828*            ELSE
 10829*                NEXT SENTENCE
 10830*       ELSE
 10831            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10832            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10833            MOVE '1'             TO DC-OPTION-CODE
 10834            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10835            IF NO-CONVERSION-ERROR
 10836                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10837                ADD 1                 TO PI-EDAYS
 10838                MOVE AL-UNNON         TO EDAYSA.
 10839
 10840*    IF PI-COMPANY-ID = 'DMD'
 10841*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10842*        MOVE -1                 TO DC-ELAPSED-DAYS
 10843*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 208
* EL156.cbl
 10844*        MOVE '6'                TO DC-OPTION-CODE
 10845*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10846*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10847*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10848*        MOVE '1'                TO DC-OPTION-CODE
 10849*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10850*    ELSE
 10851         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 10852         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10853         MOVE '1'                TO DC-OPTION-CODE.
 10854         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10855
 10856     IF NO-CONVERSION-ERROR
 10857        IF PI-COMPANY-ID = 'DMD'
 10858            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10859                             + DC-ODD-DAYS-OVER
 10860        ELSE
 10861            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10862            ADD 1                TO PI-CDAYS.
 10863
 10864     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10865        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10866        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10867
 10868     IF PI-EDAYS NOT NUMERIC
 10869         MOVE ER-0491            TO EMI-ERROR
 10870         GO TO 1370-DAYS-ERROR.
 10871
 10872     IF CL-NO-OF-PMTS-MADE = 0
 10873        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 10874        AND CL-CERT-STATE = 'MI'
 10875        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10876            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10877     END-IF.
 10878
 10879 1362-CHECK-MAX-DAYS.
 10880
 10881     IF WS-MAX-DAYS-TOL = +999
 10882         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10883
 10884     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10885         IF PI-EDAYS = ZEROS
 10886             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10887         ELSE
 10888             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10889
 10890     IF WS-MAX-DAYS-TOL NOT = ZERO
 10891        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10892           PI-CDAYS > WS-MAX-DAYS-TOL
 10893             MOVE ER-0492          TO EMI-ERROR
 10894             GO TO 1370-DAYS-ERROR.
 10895
 10896 1365-SKIP-MAX-DAYS-EDIT.
 10897     IF PI-EDAYS = ZEROS
 10898        GO TO 1400-EDIT-PAYMENT.
 10899
 10900     IF WS-DAYS-TOL NOT = ZERO
 10901        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 209
* EL156.cbl
 10902           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 10903                MOVE ER-0493     TO EMI-ERROR
 10904                GO TO 1370-DAYS-ERROR.
 10905
 10906     GO TO 1400-EDIT-PAYMENT.
 10907
 10908 1370-DAYS-ERROR.
 10909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10910
 10911     IF EMI-MESSAGE-FORMATTED
 10912         MOVE -1                 TO EDAYSL
 10913         MOVE AL-UABON           TO EDAYSA.
 10914
 10915     GO TO 1400-EDIT-PAYMENT.
 10916
 10917 1380-EDIT-EXPENSE-PMT-AMT.
 10918     IF PI-PMTTYPE = '5' OR '6'
 10919         NEXT SENTENCE
 10920     ELSE
 10921         GO TO 1400-EDIT-PAYMENT.
 10922
 10923     IF WS-MAX-EXP-PMT NOT = ZEROS
 10924        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10925            MOVE ER-3529            TO EMI-ERROR
 10926            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10927
 10928     GO TO 1500-EDIT-EXPENSES.
 10929
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 210
* EL156.cbl
 10931
 10932 1390-CHECK-PAYMENT-DAYS.
 10933
 10934     IF PI-EDAYS = 0
 10935         MOVE PI-CDAYS TO WS-PD-DAYS
 10936     ELSE
 10937         MOVE PI-EDAYS TO WS-PD-DAYS
 10938     END-IF.
 10939
 10940     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10941         IF WS-PD-DAYS = 14
 10942            GO TO 1390-EXIT
 10943         END-IF
 10944     END-IF.
 10945
 10946     IF PI-COMPANY-ID = 'AHL'  AND
 10947        CM-AH-BENEFIT-CD = '1K'
 10948         IF WS-PD-DAYS = 14
 10949            GO TO 1390-EXIT
 10950         END-IF
 10951     END-IF.
 10952
 10953     IF WS-PD-DAYS < 30
 10954         MOVE ER-3549              TO EMI-ERROR
 10955         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10956     END-IF.
 10957
 10958 1390-EXIT.
 10959      EXIT.
 10960
 10961 1400-EDIT-PAYMENT.
 10962*    IF PI-COMPANY-ID = 'DMD'
 10963*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10964*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10965
 10966     IF PI-PMTTYPE NOT = '4'
 10967        GO TO 1405-CALC-PAYMENT.
 10968
 10969     IF PI-EDAYS NOT NUMERIC
 10970         MOVE PI-EPYAMT           TO PI-CPYAMT
 10971         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10972         GO TO 1430-CHECK-AH-TOLERANCE.
 10973
 10974*    IF PI-COMPANY-ID = 'FIA'
 10975*       IF CERT-ACCOUNT = '0000011043'
 10976*        COMPUTE PI-DAILY-RATE ROUNDED =
 10977*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10978*        COMPUTE PI-CPYAMT ROUNDED =
 10979*                          PI-DAILY-RATE * PI-EDAYS
 10980*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10981*        GO TO 1430-CHECK-AH-TOLERANCE.
 10982
 10983     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10984         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10985         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10986         GO TO 1420-CHECK-AIG-BENEFIT.
 10987
 10988     IF WS-CALC-METHOD = '2' OR  '5'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 211
* EL156.cbl
 10989         COMPUTE PI-DAILY-RATE ROUNDED =
 10990                        (CM-AH-BENEFIT-AMT * 12) / 365
 10991         COMPUTE PI-CPYAMT ROUNDED =
 10992                           PI-DAILY-RATE * PI-EDAYS
 10993        GO TO 1420-CHECK-AIG-BENEFIT.
 10994
 10995     IF WS-CALC-METHOD = '3'
 10996         COMPUTE PI-DAILY-RATE =
 10997                         (CM-AH-BENEFIT-AMT * 12) / 365
 10998         COMPUTE PI-CPYAMT ROUNDED =
 10999                           PI-DAILY-RATE * PI-EDAYS
 11000        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 212
* EL156.cbl
 11002*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11003
 11004****************************************************************
 11005****************************************************************
 11006*                  CALCULATED FROM      PAYMENT      PAYMENT
 11007*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11008* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11009*1-01-83  1-15-83    0    15     15        15           15
 11010*1-01-83  1-30-83    0    30     30        30           30
 11011*1-01-83  1-31-83    1     0     31        30           30
 11012*1-01-83  2-01-83    1     1     32        31           31
 11013*1-01-83  2-15-83    1    15     46        45           45
 11014*1-01-83  2-28-83    2     0     59        60           60
 11015*1-01-83  3-01-83    2     1     60        61           61
 11016*1-01-83  3-31-83    3     0     90        90           90
 11017*1-15-83  1-31-83    0    17     17        17           16
 11018*1-15-83  2-01-83    0    18     18        18           17
 11019*1-15-83  2-28-83    1    14     45        44           46
 11020*1-21-83  3-09-83    1    20     48        50           49
 11021*2-05-83  3-06-83    1     2     30        32           32
 11022*2-05-83  3-23-83    1    19     47        49           49
 11023*2-15-83  2-28-83    0    14     14        14           16
 11024*2-15-83  3-01-83    0    15     15        15           17
 11025*2-21-83  3-19-83    0    27     27        27           29
 11026*2-21-83  3-20-83    1     0     28        30           30
 11027*2-21-83  4-10-83    1    18     49        30           50
 11028*2-21-83  5-19-83    2    27     88        87           89
 11029*2-21-83  5-22-83    3     2     91        92           92
 11030*3-21-83  5-19-83    1    30     60        60           59
 11031****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 213
* EL156.cbl
 11033 1405-CALC-PAYMENT.
 11034     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11035     MOVE ' '                    TO DC-OPTION-CODE.
 11036     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11037     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11038     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11039
 11040     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11041     MOVE ' '                    TO DC-OPTION-CODE.
 11042     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11043     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11044     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11045
 11046     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11047     MOVE -1                     TO DC-ELAPSED-DAYS.
 11048     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11049     MOVE '6'                    TO DC-OPTION-CODE.
 11050     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11051     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11052
 11053     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11054     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11055     MOVE '1'                    TO DC-OPTION-CODE.
 11056     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11057
 11058     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11059     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11060     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11061
 11062******************************************************************
 11063*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11064*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11065*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11066******************************************************************
 11067
 11068     IF WS-CALC-METHOD = '1'           AND
 11069        DC-ELAPSED-MONTHS > ZERO AND
 11070        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11071        WDF-DAY > WDT-DAY
 11072          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11073          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11074          MOVE -1                  TO DC-ELAPSED-MONTHS
 11075          MOVE '6'                 TO DC-OPTION-CODE
 11076          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11077          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11078          COMPUTE WS-SAVE-ODD-DAYS =
 11079          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11080          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11081
 11082     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11083     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11084     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11085
 11086     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11087     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11088
 11089*    IF PI-COMPANY-ID = 'FIA'
 11090*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 214
* EL156.cbl
 11091*        COMPUTE PI-DAILY-RATE ROUNDED =
 11092*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11093*        COMPUTE PI-CPYAMT ROUNDED =
 11094*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11095*        GO TO 1420-CHECK-AIG-BENEFIT.
 11096
 11097*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11098*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11099*          CM-AH-BENEFIT-CD = '23'               AND
 11100*          CL-CERT-STATE    = '04'               AND
 11101*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11102*            COMPUTE WS-DAILY-RATE ROUNDED =
 11103*                               CM-AH-BENEFIT-AMT / 30
 11104*            COMPUTE PI-CPYAMT ROUNDED =
 11105*                               (WS-DAILY-RATE * PI-CDAYS)
 11106*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11107*            GO TO 1420-CHECK-AIG-BENEFIT.
 11108
 11109     IF WS-CALC-METHOD = '1'
 11110         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11111         COMPUTE PI-CPYAMT ROUNDED =
 11112             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11113             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11114         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11115         GO TO 1420-CHECK-AIG-BENEFIT.
 11116
 11117     IF WS-CALC-METHOD = '2'
 11118         COMPUTE PI-DAILY-RATE ROUNDED =
 11119                          (CM-AH-BENEFIT-AMT * 12) / 365
 11120         COMPUTE PI-CPYAMT ROUNDED =
 11121             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11122             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11123         GO TO 1420-CHECK-AIG-BENEFIT.
 11124
 11125     IF WS-CALC-METHOD = '4'
 11126         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11127         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11128         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11129         COMPUTE PI-CPYAMT ROUNDED =
 11130                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11131         GO TO 1420-CHECK-AIG-BENEFIT.
 11132
 11133     IF WS-CALC-METHOD = '5'
 11134         COMPUTE PI-DAILY-RATE ROUNDED =
 11135                            (CM-AH-BENEFIT-AMT * 12) / 365
 11136         COMPUTE PI-CPYAMT ROUNDED =
 11137                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11138         GO TO 1420-CHECK-AIG-BENEFIT.
 11139
 11140     IF WS-CALC-METHOD NOT = '3'
 11141        GO TO 1410-CHECK-PAYMENT.
 11142
 11143******   CALCULATION METHOD  3  ROUTINE
 11144     COMPUTE PI-DAILY-RATE =
 11145                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11146
 11147******CHECK TO SEE IF WITHIN SAME MONTH
 11148     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 215
* EL156.cbl
 11149        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11150                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11151         GO TO 1420-CHECK-AIG-BENEFIT.
 11152
 11153******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11154     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11155             SAVE-ODD-DAYS-OVER = ZEROS
 11156      COMPUTE PI-CPYAMT  ROUNDED =
 11157                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11158      GO TO 1420-CHECK-AIG-BENEFIT.
 11159
 11160******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11161******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11162     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11163        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11164        IF WDF-MONTH > 12
 11165           ADD 1                 TO WDF-YEAR
 11166           SUBTRACT 12         FROM WDF-MONTH.
 11167
 11168******CONVERT THE NEW FROM MONTH TO BINARY
 11169     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11170        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11171        MOVE '4'              TO DC-OPTION-CODE
 11172        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11173        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11174
 11175     IF WDF-MONTH = WDT-MONTH AND
 11176        WDF-YEAR  = WDT-YEAR
 11177          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11178                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11179                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11180        ELSE
 11181          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11182          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11183          COMPUTE PI-CPYAMT ROUNDED =
 11184       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11185       +
 11186       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11187       +
 11188       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11189
 11190     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 216
* EL156.cbl
 11192 1410-CHECK-PAYMENT.
 11193******PAYMENT OPTION 6
 11194******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11195     IF SAVE-ELAPSED-MONTHS > ZERO
 11196        IF SAVE-ODD-DAYS-OVER = ZEROS
 11197           GO TO 1412-CHECK-TO-DAY
 11198        ELSE
 11199           IF WDF-DAY > WDT-DAY
 11200              IF WDF-MONTH = 02
 11201                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11202                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11203                  GO TO 1412-CHECK-TO-DAY
 11204              ELSE
 11205                  IF FROM-DAYS-IN-MONTH = 31
 11206                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11207                     GO TO 1412-CHECK-TO-DAY
 11208                  ELSE
 11209                     GO TO 1412-CHECK-TO-DAY
 11210           ELSE
 11211               GO TO 1412-CHECK-TO-DAY.
 11212
 11213     IF WDF-MONTH NOT = WDT-MONTH
 11214        IF WDF-MONTH = 02
 11215           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11216           IF WDF-DAY = 29
 11217              ADD 1              TO SAVE-ODD-DAYS-OVER
 11218           ELSE
 11219              ADD 2              TO SAVE-ODD-DAYS-OVER
 11220        ELSE
 11221           IF FROM-DAYS-IN-MONTH = 31
 11222              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11223
 11224 1412-CHECK-TO-DAY.
 11225        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11226           IF WDT-DAY = 28
 11227              ADD 2              TO SAVE-ODD-DAYS-OVER
 11228           ELSE
 11229              IF WDT-DAY = 29
 11230                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11231              ELSE
 11232                 NEXT SENTENCE
 11233        ELSE
 11234           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11235              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11236
 11237     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11238     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11239     COMPUTE PI-CPYAMT ROUNDED =
 11240         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11241         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11242
 11243     GO TO 1420-CHECK-AIG-BENEFIT.
 11244
 11245 1415-CHECK-LEAP-YEAR.
 11246     IF FROM-DAYS-IN-MONTH = 29
 11247        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11248
 11249 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 217
* EL156.cbl
 11250     EXIT.
 11251
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 218
* EL156.cbl
 11253 1420-CHECK-AIG-BENEFIT.
 11254
 11255     IF WS-SPECIAL-CALC-CD = 'Q'
 11256         GO TO 1425-CHECK-WHOLE-MONTH.
 11257
 11258*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11259*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11260*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11261*       (PI-PMTTYPE = '1' OR '2')
 11262*        NEXT SENTENCE
 11263*    ELSE
 11264         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11265         GO TO 1430-CHECK-AH-TOLERANCE.
 11266
 11267******************AIG LOGIC STARTS**********************
 11268*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11269*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11270*    MOVE ER-3533      TO EMI-ERROR.
 11271*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11272*    GO TO 1430-CHECK-AH-TOLERANCE.
 11273******************AIG LOGIC ENDS************************
 11274
 11275 1425-CHECK-WHOLE-MONTH.
 11276******************************************************************
 11277****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11278****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11279****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11280****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11281****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11282****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11283****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11284****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11285****          PAID * MONTHLY BENEFIT.                         ****
 11286******************************************************************
 11287
 11288     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11289
 11290     IF CL-NO-OF-PMTS-MADE > +0
 11291         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11292
 11293     IF PI-CDAYS < WS-BEN-DAYS
 11294         GO TO 1430-CHECK-AH-TOLERANCE.
 11295
 11296     IF PI-CDAYS = WS-BEN-DAYS
 11297         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11298         GO TO 1430-CHECK-AH-TOLERANCE.
 11299
 11300*    IF PI-COMPANY-ID = 'ACM'
 11301*       NEXT SENTENCE
 11302*    ELSE
 11303        GO TO 1425-NOT-ACM-W15C.
 11304
 11305*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11306*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11307*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11308*    MOVE '6'                    TO  DC-OPTION-CODE.
 11309*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11310*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 219
* EL156.cbl
 11311*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11312*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11313*       MOVE '1'                 TO  DC-OPTION-CODE
 11314*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11315*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11316*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11317*       IF NO-CONVERSION-ERROR
 11318*          IF (DC-ELAPSED-MONTHS > +0) OR
 11319*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11320*             NEXT SENTENCE
 11321*          ELSE
 11322*             MOVE +0            TO  PI-CPYAMT
 11323*             MOVE ER-0846       TO  EMI-ERROR
 11324*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11325*             GO TO 1430-CHECK-AH-TOLERANCE
 11326*       ELSE
 11327*           MOVE ER-0846         TO  EMI-ERROR
 11328*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11329*           GO TO 1430-CHECK-AH-TOLERANCE.
 11330*
 11331*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11332*       ADD +1 TO DC-ELAPSED-MONTHS.
 11333*
 11334*    COMPUTE PI-CPYAMT ROUNDED =
 11335*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11336*
 11337*    GO TO 1430-CHECK-AH-TOLERANCE.
 11338
 11339 1425-NOT-ACM-W15C.
 11340
 11341     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11342     MOVE '6'                        TO  DC-OPTION-CODE.
 11343     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11344     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11345
 11346     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11347     IF NO-CONVERSION-ERROR
 11348         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11349     ELSE
 11350         MOVE ER-0846                TO  EMI-ERROR
 11351         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11352         GO TO 1430-CHECK-AH-TOLERANCE.
 11353
 11354     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11355     MOVE '1'                        TO  DC-OPTION-CODE.
 11356     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11357     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11358     IF NO-CONVERSION-ERROR
 11359         IF DC-ODD-DAYS-OVER = +0
 11360             NEXT SENTENCE
 11361         ELSE
 11362             MOVE ER-0846            TO  EMI-ERROR
 11363             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11364             GO TO 1430-CHECK-AH-TOLERANCE
 11365     ELSE
 11366         MOVE ER-0846                TO  EMI-ERROR
 11367         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11368         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 220
* EL156.cbl
 11369
 11370     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11371         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11372
 11373     GO TO 1430-CHECK-AH-TOLERANCE.
 11374
 11375 1425-CONT-WHOLE-MONTH-PMTS.
 11376******************************************************************
 11377****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11378****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11379****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11380******************************************************************
 11381
 11382     IF PI-COMPANY-ID = 'ACM'
 11383        NEXT SENTENCE
 11384     ELSE
 11385        IF DC-ODD-DAYS-OVER = +0
 11386            NEXT SENTENCE
 11387        ELSE
 11388            MOVE ER-0845            TO  EMI-ERROR
 11389            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11390            GO TO 1430-CHECK-AH-TOLERANCE.
 11391
 11392     COMPUTE PI-CPYAMT ROUNDED =
 11393                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11394
 11395 1430-CHECK-AH-TOLERANCE.
 11396     IF PI-PMT-APPR-SW = 'G'
 11397         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11398
 11399*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11400*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11401*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11402*
 11403*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11404*      IF WDF-MONTH = 02
 11405*        IF SAVE-ELAPSED-MONTHS = 0
 11406*          NEXT SENTENCE
 11407*        ELSE
 11408*          IF SAVE-ODD-DAYS-OVER > 0
 11409*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11410*            COMPUTE WS-PMT-MOS ROUNDED =
 11411*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11412*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11413*                                     WS-PMT-MOS
 11414*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11415*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11416*          ELSE
 11417*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11418*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11419*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11420*                                     WS-PMT-MOS.
 11421
 11422     IF WS-MAX-PMT-TOL NOT = ZERO
 11423        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11424           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11425            MOVE ER-0494         TO  EMI-ERROR
 11426            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 221
* EL156.cbl
 11427            GO TO 1500-EDIT-EXPENSES.
 11428
 11429 1430-CONT-CHECK-AH-TOLERANCE.
 11430
 11431     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11432        GO TO 1500-EDIT-EXPENSES.
 11433
 11434     IF CM-O-B-COVERAGE
 11435        GO TO 1500-EDIT-EXPENSES.
 11436
 11437     IF PI-COMPANY-ID = 'NCL'
 11438       IF FOUND-TOL-SW = 'Y'
 11439         IF WS-PMT-TOL NOT = ZERO
 11440           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11441              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11442                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11443                  IF WS-NCL-PMT-OPTION = SPACES
 11444                      MOVE ER-0699 TO EMI-ERROR
 11445                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11446                  ELSE
 11447                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11448                      NEXT SENTENCE
 11449                  ELSE
 11450                  IF NOT WS-VALID-NCL-OPTION
 11451                      MOVE ER-0699 TO EMI-ERROR
 11452                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11453
 11454     IF WS-PMT-TOL NOT = ZERO
 11455        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11456           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11457                MOVE ER-0495     TO EMI-ERROR
 11458                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11459
 11460     GO TO 1500-EDIT-EXPENSES.
 11461
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 222
* EL156.cbl
 11463 1440-COMPUTE-LIFE-REMAINING.
 11464
 11465     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11466        IF PI-PMTTYPE = '4'
 11467          MOVE PI-EPYAMT TO PI-CPYAMT
 11468          GO TO 1460-TEST-TYPE.
 11469
 11470     IF WS-LF-COVERAGE-TYPE = 'L'
 11471        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11472                          - CL-TOTAL-PAID-AMT
 11473        GO TO 1450-CHECK-MAX.
 11474
 11475     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11476        PI-LF-COVERAGE-TYPE = 'P'
 11477          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11478                              CM-LF-ITD-DEATH-AMT
 11479          GO TO 1450-CHECK-MAX.
 11480
 11481     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11482     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11483     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11484     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11485     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11486     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11487     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11488     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11489     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11490
 11491     PERFORM 9800-LINK-REM-TERM.
 11492
 11493     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11494     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11495     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11496     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11497     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11498     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11499     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11500     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11501     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11502     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11503     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11504     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11505     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11506     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11507     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11508     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11509
 11510
 11511* EXEC CICS LINK
 11512*       PROGRAM  (LINK-REMAMT)
 11513*       COMMAREA (CALCULATION-PASS-AREA)
 11514*       LENGTH   (CP-COMM-LENGTH)
 11515*    END-EXEC.
 11516*    MOVE '."C                   (   #00011042' TO DFHEIV0
 11517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11519     MOVE X'2020233030303131303432' TO DFHEIV0(25:11)
 11520     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 223
* EL156.cbl
 11521           LINK-REMAMT,
 11522           CALCULATION-PASS-AREA,
 11523           CP-COMM-LENGTH,
 11524           DFHEIV99,
 11525           DFHEIV99,
 11526           DFHEIV99,
 11527           DFHEIV99
 11528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11529
 11530
 11531     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11532
 11533     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11534     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11535
 11536     IF PI-COMPANY-ID = 'BOA' AND
 11537        PI-PMTTYPE    = '2'   AND
 11538        PI-OFFLINE    = 'N'
 11539           GO TO 1441-COMPUTE-BOA-INTEREST.
 11540
 11541     IF PI-COMPANY-ID = 'NCL' AND
 11542        PI-PMTTYPE    = '2'   AND
 11543        PI-OFFLINE    = 'N'
 11544          GO TO 1442-COMPUTE-NCL-INTEREST
 11545       ELSE
 11546          GO TO 1445-CONTINUE.
 11547
 11548 1441-COMPUTE-BOA-INTEREST.
 11549     MOVE +0             TO WS-CALC-INT.
 11550
 11551     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11552     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11553     MOVE +0             TO DC-ELAPSED-MONTHS
 11554                            DC-ELAPSED-DAYS.
 11555     MOVE '1'            TO DC-OPTION-CODE.
 11556     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11557     IF NO-CONVERSION-ERROR
 11558         NEXT SENTENCE
 11559     ELSE
 11560         GO TO 1445-CONTINUE.
 11561
 11562     IF (PI-INT-RATE NOT > ZEROS)  AND
 11563        (DC-ELAPSED-DAYS > +30)
 11564         MOVE ER-3531            TO EMI-ERROR
 11565         MOVE -1                 TO PINTL
 11566         MOVE AL-UNBON           TO PINTA
 11567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11568
 11569     IF PI-EPYAMT NOT > ZEROS
 11570         GO TO 1445-CONTINUE.
 11571
 11572     IF (PI-INT-RATE NOT > ZEROS)  OR
 11573        (DC-ELAPSED-DAYS NOT > +30)
 11574         MOVE PI-EPYAMT TO PI-CPYAMT
 11575         GO TO 1441-FORMAT-NOTE.
 11576
 11577     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11578                                 *  PI-INT-RATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 224
* EL156.cbl
 11579                                 *  DC-ELAPSED-DAYS
 11580                                 /  365
 11581                                 /  100.
 11582
 11583     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11584
 11585 1441-FORMAT-NOTE.
 11586
 11587     MOVE SPACES        TO WS-BOANOTE1.
 11588     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11589     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11590     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11591     MOVE AL-UANON      TO NOTE1A.
 11592
 11593     IF WS-CALC-INT > ZEROS
 11594         MOVE SPACES        TO WS-BOANOTE2
 11595         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11596         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11597         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11598         MOVE AL-UANON      TO NOTE2A.
 11599
 11600     GO TO 1445-CONTINUE.
 11601
 11602 1442-COMPUTE-NCL-INTEREST.
 11603     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11604     MOVE PI-STATE               TO WS-ST-ACCESS.
 11605     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11606     MOVE '3'                    TO CNTL-REC-TYPE.
 11607     MOVE +0                     TO CNTL-SEQ-NO.
 11608     MOVE 'STAT'                 TO FILE-SWITCH.
 11609
 11610     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11611
 11612     MOVE +0                 TO WS-CALC-INT.
 11613
 11614     IF ST-STAT-FROM-INCURRED
 11615         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11616       ELSE
 11617     IF ST-STAT-FROM-REPORTED
 11618         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11619       ELSE
 11620         GO TO 1445-CONTINUE.
 11621
 11622     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11623     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11624     MOVE +0                 TO DC-ELAPSED-MONTHS
 11625                                DC-ELAPSED-DAYS.
 11626     MOVE '1'                TO DC-OPTION-CODE.
 11627     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11628     IF NO-CONVERSION-ERROR
 11629         NEXT SENTENCE
 11630     ELSE
 11631         GO TO 1445-CONTINUE.
 11632
 11633     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11634        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11635         GO TO 1445-CONTINUE.
 11636
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 225
* EL156.cbl
 11637     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 11638                                 *  CF-ST-STAT-INTEREST.
 11639
 11640     MOVE SPACES              TO WS-NCLNOTE1.
 11641     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11642     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11643     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11644                                 PI-PMTNOTE1
 11645                                 NOTE1I.
 11646     MOVE AL-UANON            TO NOTE1A.
 11647
 11648     IF WS-CALC-INT > ZEROS
 11649         MOVE SPACES          TO WS-NCLNOTE2
 11650         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11651         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11652         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11653                                 PI-PMTNOTE2
 11654                                 NOTE2I
 11655         MOVE AL-UANON        TO NOTE2A.
 11656
 11657     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11658
 11659 1445-CONTINUE.
 11660
 11661     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11662        GO TO 1460-TEST-TYPE.
 11663
 11664     IF CM-O-B-COVERAGE
 11665        GO TO 1460-TEST-TYPE.
 11666
 11667     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11668         GO TO 1450-CHECK-MAX.
 11669
 11670     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11671                      > PI-EPYAMT)
 11672                      OR
 11673        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11674                      < PI-EPYAMT)
 11675         MOVE ER-0594            TO EMI-ERROR
 11676         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11677         GO TO 1460-TEST-TYPE.
 11678
 11679 1450-CHECK-MAX.
 11680
 11681     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11682        PI-LF-COVERAGE-TYPE = 'P'
 11683         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11684                                   CM-LF-ITD-DEATH-AMT
 11685     ELSE
 11686         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11687                                   CL-TOTAL-PAID-AMT.
 11688
 11689     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11690          MOVE ER-0543           TO EMI-ERROR
 11691          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11692
 11693 1460-TEST-TYPE.
 11694
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 226
* EL156.cbl
 11695     IF PI-PMT-APPR-SW = 'G'
 11696       NEXT SENTENCE
 11697     ELSE
 11698       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11699         IF PI-EPYAMT = ZERO
 11700             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11701                 MOVE ER-0494    TO  EMI-ERROR
 11702                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11703                 GO TO 1500-EDIT-EXPENSES
 11704             ELSE
 11705                 NEXT SENTENCE
 11706         ELSE
 11707             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11708                 MOVE ER-0494    TO  EMI-ERROR
 11709                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11710                 GO TO 1500-EDIT-EXPENSES.
 11711
 11712     IF PI-PMTTYPE NOT = '2' OR
 11713        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11714         GO TO 1500-EDIT-EXPENSES.
 11715
 11716     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11717     MOVE ER-0526                TO EMI-ERROR.
 11718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11719
 11720     IF EMI-ERROR-NUMBER (1) = '0526'
 11721        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11722
 11723     IF EMI-ERROR-NUMBER (2) = '0526'
 11724        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11725
 11726     GO TO 1500-EDIT-EXPENSES.
 11727
 11728 1490-PAYMENT-ERROR.
 11729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11730
 11731     IF EMI-MESSAGE-FORMATTED
 11732         MOVE -1                 TO EPYAMTL
 11733         MOVE AL-UNBON           TO EPYAMTA.
 11734
 11735 1490-EXIT.
 11736      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 227
* EL156.cbl
 11738 1500-EDIT-EXPENSES.
 11739     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11740         GO TO 1500-SKIP-ERROR-0556.
 11741
 11742 1500-CONTINUE-ON.
 11743
 11744     IF CM-O-B-COVERAGE
 11745        MOVE ER-0556             TO EMI-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11747
 11748 1500-SKIP-ERROR-0556.
 11749     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11750        IF PI-EEXPENS NOT = ZEROS
 11751           MOVE ER-0524          TO EMI-ERROR
 11752           GO TO 1590-EXPENSE-ERROR
 11753        ELSE
 11754           GO TO 1600-EDIT-RESERVES.
 11755
 11756     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11757     MOVE '6'                    TO CNTL-REC-TYPE.
 11758
 11759     IF CONTROL-IS-ACTUAL-CARRIER
 11760         MOVE PI-CARRIER         TO WS-CARR
 11761     ELSE
 11762         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11763
 11764     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11765     MOVE +0                     TO CNTL-SEQ-NO.
 11766     MOVE 'CARR'                 TO FILE-SWITCH.
 11767
 11768     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11769
 11770     IF EXPENSE-CALC-MANUAL
 11771        GO TO 1600-EDIT-RESERVES.
 11772
 11773     IF DOLLARS-PER-PMT
 11774        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11775        GO TO 1600-EDIT-RESERVES.
 11776
 11777     IF DOLLARS-PER-MONTH AND
 11778        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11779       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11780       GO TO 1600-EDIT-RESERVES.
 11781
 11782     IF PERCENT-OF-PAYMENT
 11783        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11784
 11785     GO TO 1600-EDIT-RESERVES.
 11786
 11787 1590-EXPENSE-ERROR.
 11788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11789
 11790     IF EMI-MESSAGE-FORMATTED
 11791        MOVE -1                  TO EEXPENSL
 11792        MOVE AL-UNBON            TO EEXPENSA.
 11793
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 228
* EL156.cbl
 11795 1600-EDIT-RESERVES.
 11796     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11797        IF PI-ERESV = ZEROS
 11798           GO TO 1700-EDIT-EXPENSE-TYPE
 11799        ELSE
 11800           MOVE ER-0525          TO EMI-ERROR
 11801           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11802           GO TO 1700-EDIT-EXPENSE-TYPE.
 11803
 11804     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11805     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11806     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11807
 11808     IF NOT AT-MANUAL-RESERVES-USED
 11809        IF PI-ERESV NOT = ZEROS
 11810           MOVE ER-0518          TO EMI-ERROR
 11811           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11812
 11813     IF AT-MANUAL-RESERVES-USED
 11814        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11815        GO TO 1700-EDIT-EXPENSE-TYPE.
 11816
 11817     IF AT-FUTURE-RESERVES-USED
 11818        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11819
 11820     IF AT-FUTURE-RESERVES-USED
 11821        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11822
 11823     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11824        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11825
 11826     IF AT-IBNR-RESERVES-USED
 11827        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11828
 11829     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11830     GO TO 1700-EDIT-EXPENSE-TYPE.
 11831
 11832 1690-RESERVE-ERROR.
 11833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11834
 11835     IF EMI-MESSAGE-FORMATTED
 11836        MOVE AL-UNBON            TO ERESVA
 11837        MOVE -1                  TO ERESVL.
 11838
 11839 1690-EXIT.
 11840      EXIT.
 11841
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 229
* EL156.cbl
 11843 1700-EDIT-EXPENSE-TYPE.
 11844     IF PI-PMTTYPE NOT = '5' AND '6'
 11845        GO TO 2000-EDIT-DONE.
 11846
 11847     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11848                   '6' OR '7' OR '8' OR '9'
 11849        GO TO 2000-EDIT-DONE.
 11850
 11851 1705-EXPENSE-ERROR.
 11852     MOVE ER-0573                TO EMI-ERROR.
 11853     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11854
 11855     IF EMI-MESSAGE-FORMATTED
 11856        MOVE AL-UABON            TO ETYPEA
 11857        MOVE -1                  TO ETYPEL.
 11858
 11859     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 230
* EL156.cbl
 11861 1950-NOT-FOUND.
 11862     IF FILE-SWITCH = 'MSTR'
 11863        MOVE ER-0204             TO EMI-ERROR.
 11864
 11865     IF FILE-SWITCH = 'CARR'
 11866        MOVE ER-0252             TO EMI-ERROR.
 11867
 11868     IF FILE-SWITCH = 'COMP'
 11869        MOVE ER-0254             TO EMI-ERROR.
 11870
 11871     IF FILE-SWITCH = 'STAT'
 11872        MOVE ER-0149             TO EMI-ERROR.
 11873
 11874     IF FILE-SWITCH = 'PROC'
 11875        MOVE ER-0019             TO EMI-ERROR.
 11876
 11877     IF FILE-SWITCH = 'ACCT'
 11878        MOVE ER-0198             TO EMI-ERROR.
 11879
 11880     IF FILE-SWITCH = 'BENE'
 11881        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11882           MOVE ER-0282          TO EMI-ERROR
 11883        ELSE
 11884           MOVE ER-0283          TO EMI-ERROR.
 11885
 11886     MOVE -1                     TO PMTTYPEL.
 11887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11888
 11889     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11890                                     WS-FORCE-CTR.
 11891
 11892     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11893                                     WS-FATAL-CTR.
 11894
 11895     GO TO 8200-SEND-DATAONLY.
 11896
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 231
* EL156.cbl
 11898 2000-EDIT-DONE.
 11899     IF (WS-SPECIAL-CALC-CD = 'C')
 11900        AND (CM-AH-CRITICAL-PERIOD) > 0
 11901        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11902           IF PI-EPYAMT > ZEROS
 11903              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11904                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11905           ELSE
 11906              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11907                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11908           END-IF
 11909           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11910              MOVE ER-0657          TO EMI-ERROR
 11911              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11912           END-IF
 11913        END-IF
 11914     END-IF
 11915     IF PI-HOLDTIL NOT = ZEROS
 11916        MOVE PI-HOLDTIL          TO HOLDTILO
 11917        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11918
 11919     IF PI-EPYFROM NOT = ZEROS
 11920        MOVE PI-EPYFROM          TO EPYFROMO
 11921        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11922
 11923     IF PI-EPYTHRU NOT = ZEROS
 11924        MOVE PI-EPYTHRU            TO EPYTHRUO
 11925        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11926        IF PI-USES-PAID-TO
 11927           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11928           MOVE '4'                TO DC-OPTION-CODE
 11929           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11930           IF NO-CONVERSION-ERROR
 11931              MOVE +1              TO DC-ELAPSED-DAYS
 11932              MOVE +0              TO DC-ELAPSED-MONTHS
 11933              MOVE '6'             TO DC-OPTION-CODE
 11934              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11935              IF NO-CONVERSION-ERROR
 11936                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11937
 11938     MOVE PI-EDAYS               TO EDAYSO.
 11939
 11940     IF PI-AIGFROM NOT = ZEROS
 11941        MOVE PI-AIGFROM          TO AIGFROMO
 11942        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11943
 11944     MOVE PI-EPYAMT              TO EPYAMTO.
 11945     MOVE PI-ERESV               TO ERESVO.
 11946     MOVE PI-EEXPENS             TO EEXPENSO.
 11947
 11948     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11949     MOVE SPACES                 TO DC-OPTION-CODE.
 11950     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11951
 11952     IF DATE-CONVERSION-ERROR
 11953        MOVE SPACES              TO CPYFROMI
 11954     ELSE
 11955        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 232
* EL156.cbl
 11956        IF PI-EPYFROM = ZEROS
 11957           MOVE AL-UANON             TO EPYFROMA
 11958           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11959           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11960
 11961     IF PI-USES-PAID-TO
 11962        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11963        MOVE +1                            TO DC-ELAPSED-DAYS
 11964        MOVE +0                            TO DC-ELAPSED-MONTHS
 11965        MOVE '6'                           TO DC-OPTION-CODE
 11966        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11967        IF NO-CONVERSION-ERROR
 11968           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11969           IF PI-EPYTHRU = ZEROS
 11970              MOVE AL-UANON                TO EPYTHRUA
 11971              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11972              MOVE ' '                     TO DC-OPTION-CODE
 11973              MOVE +0                      TO DC-ELAPSED-DAYS
 11974                                              DC-ELAPSED-MONTHS
 11975              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11976              IF NO-CONVERSION-ERROR
 11977                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11978                  GO TO 2001-CONTINUE
 11979              ELSE
 11980                  GO TO 2001-CONTINUE
 11981           ELSE
 11982              GO TO 2001-CONTINUE.
 11983
 11984     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11985     MOVE SPACES                 TO DC-OPTION-CODE.
 11986     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11987
 11988     IF DATE-CONVERSION-ERROR
 11989        MOVE SPACES              TO CPYTHRUI
 11990     ELSE
 11991        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 11992        IF PI-EPYTHRU = ZEROS
 11993           MOVE AL-UANON TO EPYTHRUA
 11994           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 11995           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 11996
 11997 2001-CONTINUE.
 11998
 11999     MOVE PI-CDAYS               TO CDAYSO.
 12000
 12001     IF PI-EDAYS = ZEROS
 12002        MOVE AL-UNNON TO EDAYSA
 12003        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12004
 12005     MOVE PI-CPYAMT              TO CPYAMTO.
 12006
 12007     IF PI-EPYAMT = ZEROS
 12008        MOVE AL-UNNON            TO EPYAMTA
 12009        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12010
 12011     MOVE PI-CRESV               TO CRESVO.
 12012     MOVE PI-CEXPENS             TO CEXPENSO.
 12013
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 233
* EL156.cbl
 12014     IF PI-EEXPENS = ZEROS
 12015        MOVE AL-UNNON TO EEXPENSA
 12016        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12017
 12018     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12019        AND (CL-CLAIM-TYPE = 'L')
 12020        AND (PI-OFFLINE NOT EQUAL 'Y')
 12021        IF PI-PMTTYPE = '2' OR '4'
 12022           PERFORM 2200-CALC-INTEREST
 12023                                 THRU 2200-EXIT
 12024        END-IF
 12025     END-IF
 12026     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12027     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12028     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12029
 12030     IF EMI-FATAL-CTR = ZEROS
 12031        MOVE 'B'                 TO PI-PASS-SW.
 12032
 12033     IF NOT EMI-MESSAGE-FORMATTED
 12034         MOVE -1                 TO EPYFROML
 12035     ELSE
 12036         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12037            EMI-ERROR-NUMBER (2) = SPACES
 12038             MOVE -1             TO EPYFROML.
 12039
 12040     GO TO 8200-SEND-DATAONLY.
 12041
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 234
* EL156.cbl
 12043 2200-CALC-INTEREST.
 12044     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12045        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12046        MOVE '4'                 TO DC-OPTION-CODE
 12047        PERFORM 9700-LINK-DATE-CONVERT
 12048        IF DATE-CONVERSION-ERROR
 12049            MOVE LOW-VALUES      TO CP-PRF-DT
 12050        ELSE
 12051           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12052        END-IF
 12053     END-IF
 12054     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12055        IN CLAIM-INT-PASS-AREA
 12056     MOVE CL-CERT-STATE          TO CP-STATE
 12057        IN CLAIM-INT-PASS-AREA
 12058     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12059     MOVE 'LF'                   TO CP-COVERAGE
 12060     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12061     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12062     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12063     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12064     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12065     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12066
 12067* EXEC CICS LINK
 12068*       PROGRAM   ('ELCLMI')
 12069*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12070*       LENGTH    (CP-CLAIM-LENGTH)
 12071*    END-EXEC
 12072     MOVE 'ELCLMI' TO DFHEIV1
 12073*    MOVE '."C                   (   #00011583' TO DFHEIV0
 12074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12076     MOVE X'2020233030303131353833' TO DFHEIV0(25:11)
 12077     CALL 'kxdfhei1' USING DFHEIV0,
 12078           DFHEIV1,
 12079           CLAIM-INT-PASS-AREA,
 12080           CP-CLAIM-LENGTH,
 12081           DFHEIV99,
 12082           DFHEIV99,
 12083           DFHEIV99,
 12084           DFHEIV99
 12085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12086     MOVE AL-PANOF               TO PINTHA
 12087                                    PINTA
 12088     IF NO-CI-ERROR
 12089        MOVE CP-CLM-INT-AMT      TO PINTO
 12090                                    PI-INT-AMT
 12091        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12092        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12093        MOVE AL-PANOF            TO PINTHA
 12094                                    PINTA
 12095     ELSE
 12096        IF CI-RETURN-CODE = '8'
 12097           MOVE ER-3818          TO EMI-ERROR
 12098           MOVE -1               TO ZINTL
 12099           PERFORM 9900-ERROR-FORMAT
 12100                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 235
* EL156.cbl
 12101           GO TO 2200-EXIT
 12102        ELSE
 12103           MOVE ZEROS            TO PINTO
 12104                                    PI-INT-AMT
 12105                                    PI-INT-DAYS
 12106                                    PI-INT-RATE-USED
 12107        END-IF
 12108     END-IF
 12109     IF PI-INT-AMT NOT = ZEROS
 12110        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12111           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12112           CONTINUE
 12113        ELSE
 12114           MOVE CL-SOC-SEC-NO (1:3)
 12115                                 TO WS-SSN (1:3)
 12116           MOVE CL-SOC-SEC-NO (5:2)
 12117                                 TO WS-SSN (4:2)
 12118           MOVE CL-SOC-SEC-NO (8:4)
 12119                                 TO WS-SSN (6:4)
 12120           IF (WS-SSN NUMERIC)
 12121              AND (WS-SSN NOT = ZEROS)
 12122              CONTINUE
 12123           ELSE
 12124              MOVE ER-2044       TO EMI-ERROR
 12125              PERFORM 9900-ERROR-FORMAT
 12126                                 THRU 9900-EXIT
 12127           END-IF
 12128        END-IF
 12129        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12130        MOVE +51                 TO TRLR-SEQ-NO
 12131
 12132* EXEC CICS READ
 12133*          DATASET  ('ELTRLR')
 12134*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12135*          RIDFLD   (ELTRLR-KEY)
 12136*          RESP     (WS-RESPONSE)
 12137*       END-EXEC
 12138     MOVE 'ELTRLR' TO DFHEIV1
 12139*    MOVE '&"S        E          (  N#00011633' TO DFHEIV0
 12140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12142     MOVE X'204E233030303131363333' TO DFHEIV0(25:11)
 12143     CALL 'kxdfhei1' USING DFHEIV0,
 12144           DFHEIV1,
 12145           DFHEIV20,
 12146           DFHEIV99,
 12147           ELTRLR-KEY,
 12148           DFHEIV99,
 12149           DFHEIV99,
 12150           DFHEIV99
 12151     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12152         DFHEIV20
 12153     MOVE EIBRESP  TO WS-RESPONSE
 12154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12155        IF (NOT WS-RESP-NORMAL)
 12156                    OR
 12157           ((WS-RESP-NORMAL)
 12158           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 236
* EL156.cbl
 12159           OR (AT-CITY-STATE = SPACES)))
 12160           MOVE ER-0874          TO EMI-ERROR
 12161           PERFORM 9900-ERROR-FORMAT
 12162                                 THRU 9900-EXIT
 12163        END-IF
 12164     END-IF
 12165     .
 12166 2200-EXIT.
 12167     EXIT.
 12168 3000-MOVE-INPUT-TO-SAVE-AREA.
 12169     IF PMTTYPEL > 0
 12170         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12171
 12172     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12173
 12174     IF WS-PMTTYPE = '9'
 12175         MOVE 'P'                TO PI-PROVISIONAL-IND
 12176         MOVE '1'                TO WS-PMTTYPE.
 12177
 12178     IF PAYEEL > 0
 12179         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12180         MOVE PAYEEI             TO WS-PAYEE.
 12181
 12182     IF NOTE1L > +0
 12183         MOVE NOTE1I             TO WS-PMTNOTE1
 12184                                    WS-FLI-PMTNOTE
 12185                                    WS-HAN-PMTNOTE.
 12186
 12187     IF NOTE2L > +0
 12188         MOVE NOTE2I             TO WS-PMTNOTE2.
 12189
 12190     IF OFFLINEL > 0
 12191         MOVE OFFLINEI           TO WS-OFFLINE.
 12192
 12193     IF PROOFDTL > 0
 12194         MOVE PROOFDTI            TO DATE-WORK
 12195         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12196         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12197         MOVE '4'                 TO DC-OPTION-CODE
 12198         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12199         IF NO-CONVERSION-ERROR
 12200            MOVE NUM-WORK         TO PROOFDTO
 12201            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12202            MOVE NUM-WORK         TO WS-PROOF-DATE
 12203         ELSE
 12204            MOVE ZEROS            TO WS-PROOF-DATE
 12205         END-IF
 12206     END-IF.
 12207
 12208     IF EOBYNL > +0
 12209         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 12210         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12211     END-IF
 12212
 12213     IF CLMFMYNL > +0
 12214         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 12215         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 12216     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 237
* EL156.cbl
 12217
 12218     IF SURVYYNL > +0
 12219         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 12220         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 12221     END-IF
 12222*04400      IF GROUPEDL > +0
 12223*04401          MOVE GROUPEDI           TO WS-GROUPED.
 12224*04402
 12225*04403      IF CASHL > +0
 12226*04404         MOVE CASHI               TO WS-CASH.
 12227
 12228     IF LOANNOL > +0
 12229         MOVE LOANNOI            TO WS-LOAN-NO.
 12230
 12231     IF CHECKNOL > 0
 12232         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12233
 12234     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12235         IF WS-AIG-CREDIT-ENTERED
 12236             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12237             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12238             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12239             MOVE AL-UANON         TO CHECKNOA.
 12240
 12241     IF HOLDTILL > 0
 12242         MOVE HOLDTILI           TO DATE-WORK
 12243         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12244         MOVE NUM-WORK           TO WS-HOLDTIL.
 12245
 12246     IF ZINTL > +0
 12247
 12248* EXEC CICS BIF DEEDIT
 12249*           FIELD   (ZINTI)
 12250*           LENGTH  (07)
 12251*       END-EXEC
 12252     MOVE 07
 12253       TO DFHEIV11
 12254*    MOVE '@"L                   #   #00011731' TO DFHEIV0
 12255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12257     MOVE X'2020233030303131373331' TO DFHEIV0(25:11)
 12258     CALL 'kxdfhei1' USING DFHEIV0,
 12259           ZINTI,
 12260           DFHEIV11
 12261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12262        IF ZINTI NOT NUMERIC
 12263           MOVE ER-0419          TO EMI-ERROR
 12264           PERFORM 9900-ERROR-FORMAT
 12265           MOVE AL-UABON         TO ZINTA
 12266           MOVE -1               TO ZINTL
 12267        ELSE
 12268           MOVE ZINTI            TO CP-INT-RATE
 12269                                    WS-INT-RATE
 12270           MOVE CP-INT-RATE      TO ZINTO
 12271           MOVE AL-UNNON         TO ZINTA
 12272        END-IF
 12273     ELSE
 12274        MOVE ZEROS               TO CP-INT-RATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 238
* EL156.cbl
 12275     END-IF
 12276     IF EPYFROML > 0
 12277         MOVE EPYFROMI           TO DATE-WORK
 12278         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12279         MOVE NUM-WORK           TO WS-EPYFROM.
 12280
 12281     IF AIGFROML > 0
 12282         MOVE AIGFROMI           TO DATE-WORK
 12283         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12284         MOVE NUM-WORK           TO WS-AIGFROM
 12285     ELSE
 12286         IF (AIGFROMI = LOW-VALUES) AND
 12287            (PI-AIGFROM NOT = ZEROS)
 12288              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12289
 12290     IF EPYTHRUL > +0
 12291        MOVE EPYTHRUI           TO DATE-WORK
 12292        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12293        MOVE NUM-WORK           TO WS-EPYTHRU
 12294        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12295        MOVE '4'                TO DC-OPTION-CODE
 12296        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12297        IF NO-CONVERSION-ERROR
 12298           IF PI-USES-PAID-TO
 12299              MOVE '6'                TO DC-OPTION-CODE
 12300              MOVE -1                 TO DC-ELAPSED-DAYS
 12301              MOVE +0                 TO DC-ELAPSED-MONTHS
 12302              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12303              IF NO-CONVERSION-ERROR
 12304                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12305                 MOVE ' '             TO DC-OPTION-CODE
 12306                 MOVE +0              TO DC-ELAPSED-DAYS
 12307                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12308              IF NO-CONVERSION-ERROR
 12309                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12310
 12311*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12312*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12313     IF EDAYSL > 0
 12314
 12315* EXEC CICS BIF DEEDIT
 12316*            FIELD(EDAYSI)
 12317*            LENGTH(6)
 12318*        END-EXEC
 12319     MOVE 6
 12320       TO DFHEIV11
 12321*    MOVE '@"L                   #   #00011787' TO DFHEIV0
 12322     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12324     MOVE X'2020233030303131373837' TO DFHEIV0(25:11)
 12325     CALL 'kxdfhei1' USING DFHEIV0,
 12326           EDAYSI,
 12327           DFHEIV11
 12328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12329         MOVE EDAYSI             TO WS-DY-WORK
 12330         IF WS-DY-SIGN = SPACES
 12331            MOVE WS-DY-NUM       TO WS-EDAYS
 12332            ADD 0                TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 239
* EL156.cbl
 12333         ELSE
 12334            MOVE EDAYSI          TO WS-EDAYS
 12335            ADD 0                TO WS-EDAYS.
 12336
 12337*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12338*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12339     IF EPYAMTL > 0
 12340
 12341* EXEC CICS BIF DEEDIT
 12342*            FIELD(EPYAMTI)
 12343*            LENGTH(10)
 12344*        END-EXEC
 12345     MOVE 10
 12346       TO DFHEIV11
 12347*    MOVE '@"L                   #   #00011802' TO DFHEIV0
 12348     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12349     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12350     MOVE X'2020233030303131383032' TO DFHEIV0(25:11)
 12351     CALL 'kxdfhei1' USING DFHEIV0,
 12352           EPYAMTI,
 12353           DFHEIV11
 12354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12355         MOVE EPYAMTI            TO WS-PY-WORK
 12356         IF WS-PY-SIGN = SPACES
 12357            MOVE WS-PY-NUM       TO WS-EPYAMT
 12358            ADD 0                TO WS-EPYAMT
 12359         ELSE
 12360            MOVE EPYAMTI         TO WS-EPYAMT
 12361            ADD 0                TO WS-EPYAMT.
 12362
 12363     IF ERESVL > 0
 12364
 12365* EXEC CICS BIF DEEDIT
 12366*            FIELD(ERESVI)
 12367*            LENGTH(9)
 12368*        END-EXEC
 12369     MOVE 9
 12370       TO DFHEIV11
 12371*    MOVE '@"L                   #   #00011815' TO DFHEIV0
 12372     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12373     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12374     MOVE X'2020233030303131383135' TO DFHEIV0(25:11)
 12375     CALL 'kxdfhei1' USING DFHEIV0,
 12376           ERESVI,
 12377           DFHEIV11
 12378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12379         MOVE ERESVI TO WS-ERESV.
 12380
 12381     IF EEXPENSL > 0
 12382
 12383* EXEC CICS BIF DEEDIT
 12384*            FIELD(EEXPENSI)
 12385*            LENGTH(8)
 12386*        END-EXEC
 12387     MOVE 8
 12388       TO DFHEIV11
 12389*    MOVE '@"L                   #   #00011822' TO DFHEIV0
 12390     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 240
* EL156.cbl
 12391     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12392     MOVE X'2020233030303131383232' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0,
 12394           EEXPENSI,
 12395           DFHEIV11
 12396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12397         MOVE EEXPENSI           TO WS-EEXPENS.
 12398
 12399     IF ETYPEL > ZEROS
 12400         MOVE ETYPEI             TO WS-ETYPE.
 12401
 12402     IF PI-COMPANY-ID = 'BOA'
 12403        IF PINTL > ZEROS
 12404
 12405* EXEC CICS BIF DEEDIT
 12406*            FIELD (PINTI)
 12407*            LENGTH(05)
 12408*          END-EXEC
 12409     MOVE 05
 12410       TO DFHEIV11
 12411*    MOVE '@"L                   #   #00011833' TO DFHEIV0
 12412     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12413     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12414     MOVE X'2020233030303131383333' TO DFHEIV0(25:11)
 12415     CALL 'kxdfhei1' USING DFHEIV0,
 12416           PINTI,
 12417           DFHEIV11
 12418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12419           IF PINTI NUMERIC
 12420               MOVE AL-UNNON     TO PINTA
 12421               MOVE PINTI        TO WS-INT-RATE
 12422               MOVE WS-INT-RATE  TO PINTO.
 12423
 12424 3000-EXIT.
 12425     EXIT.
 12426
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 241
* EL156.cbl
 12428 3050-REBUILD-ENTERED.
 12429
 12430     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12431
 12432     IF PI-PROV-PMT
 12433         MOVE '9'           TO PMTTYPEO
 12434     ELSE
 12435         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12436
 12437     MOVE PI-PAYEE          TO PAYEEO.
 12438     MOVE PI-PMTNOTE1       TO NOTE1O.
 12439     MOVE PI-PMTNOTE2       TO NOTE2O.
 12440     MOVE PI-OFFLINE        TO OFFLINEO.
 12441     IF PI-PROOF-DATE NOT = ZEROS
 12442         MOVE PI-PROOF-DATE TO PROOFDTO
 12443         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12444     END-IF.
 12445*04534      MOVE PI-GROUPED        TO GROUPEDO.
 12446*04535
 12447*04536      MOVE PI-CASH           TO CASHO.
 12448
 12449     IF PI-INT-RATE > ZEROS
 12450         MOVE PI-INT-RATE   TO PINTO.
 12451
 12452     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12453        IF PI-INT-AMT > ZEROS
 12454           MOVE PI-INT-AMT       TO PINTO
 12455           MOVE AL-PANOF         TO PINTA
 12456                                    PINTHA
 12457        END-IF
 12458     END-IF
 12459     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12460     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 12461     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 12462     IF PI-HOLDTIL NOT = ZEROS
 12463        MOVE PI-HOLDTIL          TO HOLDTILO
 12464        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12465
 12466     IF PI-EPYFROM NOT = ZEROS
 12467        MOVE PI-EPYFROM          TO EPYFROMO
 12468        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12469
 12470     IF PI-AIGFROM NOT = ZEROS
 12471        MOVE PI-AIGFROM          TO AIGFROMO
 12472        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12473
 12474     IF PI-EPYTHRU NOT = ZEROS
 12475        MOVE PI-EPYTHRU          TO EPYTHRUO
 12476        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12477        IF PI-USES-PAID-TO
 12478           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12479           MOVE '4'                TO DC-OPTION-CODE
 12480           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12481           IF NO-CONVERSION-ERROR
 12482              MOVE +1 TO DC-ELAPSED-DAYS
 12483              MOVE +0 TO DC-ELAPSED-MONTHS
 12484              MOVE '6' TO DC-OPTION-CODE
 12485              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 242
* EL156.cbl
 12486              IF NO-CONVERSION-ERROR
 12487                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12488
 12489     IF PI-EDAYS NOT = ZEROS
 12490        MOVE PI-EDAYS TO EDAYSO.
 12491
 12492     IF PI-EPYAMT NOT = ZEROS
 12493        MOVE PI-EPYAMT TO EPYAMTO.
 12494
 12495     IF PI-ERESV NOT = ZEROS
 12496        MOVE PI-ERESV TO ERESVO.
 12497
 12498     IF PI-EEXPENS NOT = ZEROS
 12499        MOVE PI-EEXPENS TO EEXPENSO.
 12500
 12501     MOVE PI-ETYPE TO ETYPEO.
 12502
 12503     IF PI-ECHECKNO NOT = SPACES
 12504        MOVE PI-ECHECKNO         TO CHECKNOO
 12505     ELSE
 12506        MOVE PI-CCHECKNO         TO CHECKNOO.
 12507
 12508     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12509     MOVE SPACES                 TO DC-OPTION-CODE.
 12510     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12511
 12512     IF DATE-CONVERSION-ERROR
 12513        MOVE SPACES              TO CPYFROMI
 12514     ELSE
 12515        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12516
 12517     IF PI-USES-PAID-TO
 12518        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12519        MOVE +1                  TO DC-ELAPSED-DAYS
 12520        MOVE +0                  TO DC-ELAPSED-MONTHS
 12521        MOVE '6'                 TO DC-OPTION-CODE
 12522        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12523        IF NO-CONVERSION-ERROR
 12524           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12525           GO TO 3051-CONTINUE.
 12526
 12527     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12528     MOVE SPACES                 TO DC-OPTION-CODE.
 12529     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12530
 12531     IF DATE-CONVERSION-ERROR
 12532        MOVE SPACES              TO CPYTHRUI
 12533     ELSE
 12534        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12535
 12536 3051-CONTINUE.
 12537
 12538     IF PI-CDAYS NOT = ZEROS
 12539        MOVE PI-CDAYS TO CDAYSO.
 12540
 12541     IF PI-CPYAMT NOT = ZEROS
 12542        MOVE PI-CPYAMT TO CPYAMTO.
 12543
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 243
* EL156.cbl
 12544     IF PI-CRESV NOT = ZEROS
 12545        MOVE PI-CRESV TO CRESVO.
 12546
 12547     IF PI-CEXPENS NOT = ZEROS
 12548        MOVE PI-CEXPENS TO CEXPENSO.
 12549
 12550 3059-EXIT.
 12551     EXIT.
 12552
 12553 3100-DEEDIT-DATE.
 12554
 12555* EXEC CICS BIF DEEDIT
 12556*        FIELD(DATE-WORK)
 12557*        LENGTH(8)
 12558*    END-EXEC.
 12559     MOVE 8
 12560       TO DFHEIV11
 12561*    MOVE '@"L                   #   #00011972' TO DFHEIV0
 12562     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12563     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12564     MOVE X'2020233030303131393732' TO DFHEIV0(25:11)
 12565     CALL 'kxdfhei1' USING DFHEIV0,
 12566           DATE-WORK,
 12567           DFHEIV11
 12568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12569
 12570
 12571 3100-EXIT.
 12572     EXIT.
 12573
 12574 3200-CALC-AIG-DAYS.
 12575
 12576     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12577
 12578     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12579     MOVE ' '                    TO DC-OPTION-CODE.
 12580     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12581     IF NO-CONVERSION-ERROR
 12582         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12583     ELSE
 12584         GO TO 3290-ERROR.
 12585
 12586     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12587         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12588                                WS-BIN-FROM-DT
 12589     ELSE
 12590         IF CL-TOTAL-PAID-AMT > ZEROS
 12591             IF WS-SV-EPYFROM = LOW-VALUES
 12592                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12593                                        WS-BIN-FROM-DT
 12594             ELSE
 12595                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12596                                        WS-BIN-FROM-DT
 12597         ELSE
 12598             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12599                                        WS-BIN-FROM-DT.
 12600
 12601 3210-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 244
* EL156.cbl
 12602
 12603     MOVE ' '                    TO DC-OPTION-CODE.
 12604     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12605     IF DATE-CONVERSION-ERROR
 12606         GO TO 3290-ERROR.
 12607
 12608     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12609
 12610     IF PI-LOAN-DUE-DAY = 31
 12611         MOVE 30              TO WS-PMT-DUE-DA
 12612                                 WS-SAVE-DUE-DA
 12613     ELSE
 12614         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12615                                 WS-SAVE-DUE-DA.
 12616
 12617     IF (PI-LOAN-DUE-DAY > 28) AND
 12618        (WS-PMT-DUE-MO = 2)
 12619         MOVE 'Y'                TO WS-DUE-DAY-SW
 12620         MOVE 28                 TO WS-PMT-DUE-DA.
 12621
 12622     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12623     MOVE '4'                    TO DC-OPTION-CODE.
 12624     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12625     IF NO-CONVERSION-ERROR
 12626         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12627     ELSE
 12628         GO TO 3290-ERROR.
 12629
 12630*--------------------------------------------------------------*
 12631*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12632*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12633*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12634*                                                              *
 12635*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12636*             INCURRED DATE      - 04/15/91                    *
 12637*             PMT DUE DATE       - 04/03/91                    *
 12638*             PMT DUE DATE       - 05/03/91                    *
 12639*--------------------------------------------------------------*
 12640
 12641     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12642        (WS-SV-AIGFROM = LOW-VALUES)
 12643         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12644            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12645             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12646             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12647             IF NO-CONVERSION-ERROR
 12648                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12649                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12650             ELSE
 12651                 GO TO 3290-ERROR.
 12652
 12653     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12654        (WS-SV-AIGFROM = LOW-VALUES)
 12655         GO TO 3205-CONT-CALC-PMT.
 12656
 12657     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12658     MOVE ' '                    TO DC-OPTION-CODE.
 12659     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 245
* EL156.cbl
 12660     IF NO-CONVERSION-ERROR
 12661         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 12662     ELSE
 12663         GO TO 3290-ERROR.
 12664
 12665     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12666        (WS-PMT-DUE-DA < WS-FROM-DA)
 12667          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12668          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12669          IF NO-CONVERSION-ERROR
 12670              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12671              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12672          ELSE
 12673              GO TO 3290-ERROR.
 12674
 12675 3205-CONT-CALC-PMT.
 12676
 12677*--------------------------------------------------------------*
 12678*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12679*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12680*--------------------------------------------------------------*
 12681
 12682     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12683        PI-PMTTYPE = '2'
 12684          NEXT SENTENCE
 12685     ELSE
 12686        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12687           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12688             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12689             MOVE ER-3527            TO EMI-ERROR
 12690             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12691             MOVE -1                 TO EPYTHRUL
 12692             MOVE AL-UNBON           TO EPYTHRUA
 12693                                        EPYFROMA
 12694             GO TO 3299-EXIT.
 12695
 12696*--------------------------------------------------------------*
 12697*    CALCULATE RETRO ELIMINATION DATE                          *
 12698*--------------------------------------------------------------*
 12699
 12700     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12701         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12702     ELSE
 12703         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12704
 12705     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12706     MOVE +0             TO DC-ELAPSED-MONTHS.
 12707     MOVE '6'            TO DC-OPTION-CODE.
 12708     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12709     IF NO-CONVERSION-ERROR
 12710         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12711     ELSE
 12712         GO TO 3290-ERROR.
 12713
 12714 3210-CHECK-PMT-DATE.
 12715
 12716*--------------------------------------------------------------*
 12717*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 246
* EL156.cbl
 12718*    THE ENTERED PAY FROM DATE                                 *
 12719*--------------------------------------------------------------*
 12720
 12721     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12722         NEXT SENTENCE
 12723     ELSE
 12724         GO TO 3220-COMPUTE-DAYS.
 12725
 12726     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12727     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12728     IF NO-CONVERSION-ERROR
 12729         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12730         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12731         GO TO 3210-CHECK-PMT-DATE
 12732     ELSE
 12733         GO TO 3290-ERROR.
 12734
 12735 3220-COMPUTE-DAYS.
 12736
 12737     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12738     MOVE ZEROS         TO WS-CDAYS.
 12739     MOVE 'N'           TO WS-ELIMINATION-SW.
 12740
 12741*--------------------------------------------------------------*
 12742*    COMPUTE CALIFORNIA DUE DAYS                               *
 12743*--------------------------------------------------------------*
 12744
 12745     IF CL-TOTAL-PAID-AMT > ZEROS
 12746         MOVE 'Y' TO WS-ELIMINATION-SW
 12747         GO TO 3240-FIRST-PMT-DUE
 12748     ELSE
 12749        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12750            NEXT SENTENCE
 12751        ELSE
 12752            GO TO 3240-FIRST-PMT-DUE.
 12753
 12754 3230-NEXT-PMT-DUE.
 12755
 12756     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12757     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12758     IF NO-CONVERSION-ERROR
 12759         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12760         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12761     ELSE
 12762         GO TO 3290-ERROR.
 12763
 12764 3240-FIRST-PMT-DUE.
 12765
 12766     IF CL-TOTAL-PAID-AMT > ZEROS
 12767         NEXT SENTENCE
 12768     ELSE
 12769        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12770            GO TO 3230-NEXT-PMT-DUE.
 12771
 12772     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12773         GO TO 3250-VERIFY-ELIMINATION.
 12774
 12775     ADD +30 TO WS-CDAYS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 247
* EL156.cbl
 12776     MOVE 'Y' TO WS-ELIMINATION-SW.
 12777     GO TO 3230-NEXT-PMT-DUE.
 12778
 12779 3250-VERIFY-ELIMINATION.
 12780
 12781     IF ELIM-SATISFIED
 12782         GO TO 3260-END-CALC.
 12783
 12784     IF PI-PMTTYPE = '1'
 12785         MOVE ZEROS TO WS-CDAYS
 12786         GO TO 3260-END-CALC.
 12787
 12788     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12789         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12790     ELSE
 12791         IF CL-TOTAL-PAID-AMT > ZEROS
 12792             IF WS-SV-EPYFROM = LOW-VALUES
 12793                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12794             ELSE
 12795                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12796         ELSE
 12797             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12798
 12799     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12800     MOVE '1'                    TO DC-OPTION-CODE.
 12801     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12802     IF NO-CONVERSION-ERROR
 12803         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12804     ELSE
 12805         GO TO 3290-ERROR.
 12806
 12807     IF CL-TOTAL-PAID-AMT > ZEROS
 12808         MOVE WS-DAYS-OFF TO WS-CDAYS
 12809     ELSE
 12810         IF PI-BEN-DAYS > WS-DAYS-OFF
 12811             MOVE ZEROS TO WS-CDAYS
 12812         ELSE
 12813             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12814
 12815 3260-END-CALC.
 12816
 12817     MOVE WS-CDAYS TO PI-CDAYS.
 12818
 12819     IF PI-EDAYS = ZEROS
 12820         MOVE PI-CDAYS TO PI-EDAYS
 12821         MOVE AL-UNNON TO EDAYSA.
 12822
 12823     GO TO 3299-EXIT.
 12824
 12825 3290-ERROR.
 12826
 12827     MOVE ER-3528            TO EMI-ERROR.
 12828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12829     MOVE -1                 TO CDAYSL.
 12830     MOVE AL-UNBON           TO CDAYSA.
 12831
 12832 3299-EXIT.
 12833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 248
* EL156.cbl
 12834
 12835 3300-BUMP-DATE.
 12836
 12837     IF WS-RESTORE-DUE-DAY
 12838         MOVE 'N'              TO WS-DUE-DAY-SW
 12839         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12840         ADD 1                 TO WS-PMT-DUE-MO
 12841         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12842         MOVE '4'              TO DC-OPTION-CODE
 12843         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12844         IF NO-CONVERSION-ERROR
 12845             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12846             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12847             GO TO 3399-EXIT
 12848         ELSE
 12849             MOVE '9'          TO DC-ERROR-CODE
 12850             GO TO 3399-EXIT.
 12851
 12852     IF (WS-PMT-DUE-MO = 1) AND
 12853        (WS-SAVE-DUE-DA > 28)
 12854           MOVE 'Y' TO WS-DUE-DAY-SW.
 12855
 12856     MOVE +0                 TO DC-ELAPSED-DAYS.
 12857     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12858     MOVE '6'                TO DC-OPTION-CODE.
 12859     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12860
 12861 3399-EXIT.
 12862     EXIT.
 12863
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 249
* EL156.cbl
 12865 3400-COMPUTE-EXPIRY.
 12866
 12867     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12868     MOVE +0                    TO DC-ELAPSED-DAYS
 12869                                   DC-ODD-DAYS-OVER.
 12870     MOVE '1'                   TO DC-END-OF-MONTH.
 12871     MOVE '6'                   TO DC-OPTION-CODE.
 12872
 12873     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12874         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12875     ELSE
 12876         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12877
 12878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12879     IF NO-CONVERSION-ERROR
 12880         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12881     ELSE
 12882         GO TO 3390-CONTINUE.
 12883
 12884     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12885         GO TO 3390-CONTINUE.
 12886
 12887     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12888     MOVE '4'                    TO CNTL-REC-TYPE.
 12889     MOVE +0                     TO CNTL-SEQ-NO.
 12890     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12891     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12892     MOVE 'BENE'                 TO FILE-SWITCH.
 12893
 12894     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12895
 12896     IF NO-BENEFIT-FOUND
 12897         GO TO 3390-CONTINUE.
 12898
 12899     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 12900        IF (PI-OFFLINE = 'Y') OR
 12901           (PI-PMTTYPE = '7')
 12902           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12903                                     THRU 9870-EXIT
 12904           IF ERROR-ON-OUTPUT
 12905             MOVE -1                 TO ENTERPFL
 12906             MOVE AL-UANON           TO ENTERPFA
 12907             MOVE MAP-NAMEA          TO MAP-NAME
 12908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12909             GO TO 8200-SEND-DATAONLY.
 12910
 12911     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12912        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12913        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12914          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12915          MOVE +0        TO DC-ELAPSED-DAYS
 12916          MOVE +1        TO DC-ELAPSED-MONTHS
 12917          MOVE 6         TO DC-OPTION-CODE
 12918          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12919          IF NO-CONVERSION-ERROR
 12920              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12921
 12922 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 250
* EL156.cbl
 12923
 12924      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12925         MOVE CM-AH-LOAN-EXPIRE-DT
 12926                                 TO DC-BIN-DATE-1
 12927      ELSE
 12928         MOVE CM-LF-LOAN-EXPIRE-DT
 12929                                 TO DC-BIN-DATE-1
 12930      END-IF
 12931
 12932      MOVE ' '                    TO DC-OPTION-CODE.
 12933      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12934      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12935      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12936
 12937 3499-EXIT.
 12938     EXIT.
 12939
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 251
* EL156.cbl
 12941
 12942 3600-CHECK-VERIFICATION.
 12943
 12944     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12945
 12946     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 12947
 12948     IF PI-PAYEE-TYPE = 'I'
 12949        GO TO 3600-READ-TRAILER.
 12950
 12951     IF PI-PAYEE-TYPE = 'B'
 12952        ADD +10                  TO TRLR-SEQ-NO
 12953        GO TO 3600-READ-TRAILER.
 12954
 12955     IF PI-PAYEE-TYPE = 'A'
 12956        ADD +20                  TO TRLR-SEQ-NO
 12957        GO TO 3600-READ-TRAILER.
 12958
 12959     IF PI-PAYEE-TYPE = 'O'
 12960        ADD +50                  TO TRLR-SEQ-NO
 12961        GO TO 3600-READ-TRAILER.
 12962
 12963     IF PI-PAYEE-TYPE = 'Q'
 12964        ADD +60                  TO TRLR-SEQ-NO
 12965        GO TO 3600-READ-TRAILER.
 12966
 12967     IF PI-PAYEE-TYPE = 'P'
 12968        ADD +30                  TO TRLR-SEQ-NO
 12969        GO TO 3600-READ-TRAILER.
 12970
 12971     IF PI-PAYEE-TYPE = 'E'
 12972        ADD +40                  TO TRLR-SEQ-NO.
 12973
 12974 3600-READ-TRAILER.
 12975
 12976
 12977* EXEC CICS HANDLE CONDITION
 12978*         NOTFND(3600-CONTINUE)
 12979*    END-EXEC.
 12980*    MOVE '"$I                   ! - #00012382' TO DFHEIV0
 12981     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12983     MOVE X'2D20233030303132333832' TO DFHEIV0(25:11)
 12984     CALL 'kxdfhei1' USING DFHEIV0
 12985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12986
 12987
 12988     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12989
 12990 3600-CONTINUE.
 12991
 12992     IF PI-VFY-2ND-BENE = 'Y'
 12993       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 12994         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 12995           MOVE ER-7576            TO EMI-ERROR
 12996           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12997           MOVE -1                 TO PAYEEL
 12998           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 252
* EL156.cbl
 12999           GO TO 3600-EXIT
 13000         END-IF
 13001       END-IF
 13002     END-IF.
 13003
 13004     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13005     MOVE 1 TO WS-SUB2
 13006     MOVE SPACES TO WS-PAYEE-NAME
 13007     PERFORM VARYING WS-SUB FROM 1 BY 1
 13008             UNTIL WS-SUB > 30
 13009         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13010            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13011                 WS-PAYEE-NAME-X (WS-SUB2)
 13012            ADD +1 TO WS-SUB2
 13013         END-IF
 13014     END-PERFORM.
 13015
 13016     STRING CL-INSURED-1ST-NAME
 13017            CL-INSURED-MID-INIT
 13018            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13019     MOVE 1 TO WS-SUB2
 13020     MOVE SPACES TO WS-INSURED-NAME
 13021     PERFORM VARYING WS-SUB FROM 1 BY 1
 13022             UNTIL WS-SUB > 30
 13023         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13024            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13025                 WS-INSURED-NAME-X (WS-SUB2)
 13026            ADD +1 TO WS-SUB2
 13027         END-IF
 13028     END-PERFORM.
 13029
 13030     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13031        MOVE ER-7579            TO EMI-ERROR
 13032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13033        MOVE -1                 TO PAYEEL
 13034        MOVE AL-UABON           TO PAYEEA
 13035     END-IF.
 13036
 13037 3600-EXIT.
 13038     EXIT.
 13039
 13040 5000-UPDATE.
 13041
 13042     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13043
 13044     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13045
 13046     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13047        PI-OFFLINE = 'Y'
 13048        NEXT SENTENCE
 13049     ELSE
 13050        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13051
 13052*    IF PI-COMPANY-ID = 'CRI'
 13053*       IF PI-PMTTYPE = '1' OR  '2'
 13054*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13055*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13056*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 253
* EL156.cbl
 13057
 13058*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13059*       IF PI-PMTTYPE = '1'
 13060*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13061*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13062
 13063     IF PI-PMTTYPE      = '2' AND
 13064        PI-SPLIT-PMT-SW = 'Y' AND
 13065        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13066          MOVE ER-3530                TO EMI-ERROR
 13067          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13068
 13069     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13070        AND (CL-CLAIM-TYPE = 'L')
 13071        IF PI-PMTTYPE = '2' OR '4'
 13072           IF PI-INT-AMT NOT = ZEROS
 13073              PERFORM 7110-BUILD-PMT-TRLR
 13074                                 THRU 7130-EXIT
 13075           ELSE
 13076              IF PI-PMTTYPE = '2'
 13077                 PERFORM 7140-BUILD-NOTE-TRLR
 13078                                 THRU 7170-EXIT
 13079              END-IF
 13080           END-IF
 13081        END-IF
 13082     END-IF
 13083*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13084*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13085*            MOVE 'N'                 TO  WS-LETTER-SW.
 13086
 13087*    IF PI-COMPANY-ID = 'DMD'
 13088*        IF CL-NO-OF-PMTS-MADE = +1
 13089*                OR
 13090*           PI-PMTTYPE = '2'
 13091*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13092
 13093     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13094
 13095*    IF PI-COMPANY-ID = 'DMD'
 13096*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13097*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13098
 13099
 13100* EXEC CICS REWRITE
 13101*         DATASET('ELMSTR')
 13102*         FROM(CLAIM-MASTER)
 13103*     END-EXEC.
 13104     MOVE LENGTH OF
 13105      CLAIM-MASTER
 13106       TO DFHEIV11
 13107     MOVE 'ELMSTR' TO DFHEIV1
 13108*    MOVE '&& L                  %   #00012497' TO DFHEIV0
 13109     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13110     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13111     MOVE X'2020233030303132343937' TO DFHEIV0(25:11)
 13112     CALL 'kxdfhei1' USING DFHEIV0,
 13113           DFHEIV1,
 13114           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 254
* EL156.cbl
 13115           DFHEIV11,
 13116           DFHEIV99
 13117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13118
 13119
 13120     IF WS-LETTER-SW = 'N'
 13121         GO TO 5000-END-UPDATE.
 13122
 13123 5000-GENERATE-AUTO-LETTER.
 13124
 13125
 13126* EXEC CICS LINK
 13127*        PROGRAM    (LINK-1523)
 13128*        COMMAREA   (W-1523-LINKDATA)
 13129*        LENGTH     (W-1523-COMM-LENGTH)
 13130*    END-EXEC.
 13131*    MOVE '."C                   (   #00012507' TO DFHEIV0
 13132     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13134     MOVE X'2020233030303132353037' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0,
 13136           LINK-1523,
 13137           W-1523-LINKDATA,
 13138           W-1523-COMM-LENGTH,
 13139           DFHEIV99,
 13140           DFHEIV99,
 13141           DFHEIV99,
 13142           DFHEIV99
 13143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13144
 13145
 13146     IF W-1523-FATAL-ERROR
 13147         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13148         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13149         MOVE ER-0802                TO  EMI-ERROR
 13150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13151
 13152     IF W-1523-ERROR-CODE = 0191
 13153         MOVE ER-0803                TO  EMI-ERROR
 13154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13155
 13156     IF PI-COMPANY-ID      = 'HAN' AND
 13157        PI-PMTTYPE         = '1'   AND
 13158        PI-3RD-PARTY-SW    = 'Y'   AND
 13159        W-1523-FORM-NUMBER = 'EOB1'
 13160           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13161           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13162           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13163           GO TO 5000-GENERATE-AUTO-LETTER.
 13164
 13165 5000-END-UPDATE.
 13166
 13167     MOVE ER-0000                TO EMI-ERROR.
 13168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13169     GO TO 7000-SHOW-CLAIM.
 13170
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 255
* EL156.cbl
 13172 5000-MOVE-NAME.
 13173     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13174     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13175     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13176
 13177 5000-EXIT.
 13178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 256
* EL156.cbl
 13180 5300-CREATE-DMO.
 13181
 13182     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13183     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13184     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13185
 13186
 13187* EXEC CICS HANDLE CONDITION
 13188*         NOTFND   (5300-NOTE-NOT-FOUND)
 13189*    END-EXEC.
 13190*    MOVE '"$I                   ! . #00012553' TO DFHEIV0
 13191     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13193     MOVE X'2E20233030303132353533' TO DFHEIV0(25:11)
 13194     CALL 'kxdfhei1' USING DFHEIV0
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13196
 13197
 13198
 13199* EXEC CICS READ
 13200*         DATASET('ERNOTE')
 13201*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13202*         RIDFLD (W-NOTE-KEY)
 13203*    END-EXEC.
 13204     MOVE 'ERNOTE' TO DFHEIV1
 13205*    MOVE '&"S        E          (   #00012557' TO DFHEIV0
 13206     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13207     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13208     MOVE X'2020233030303132353537' TO DFHEIV0(25:11)
 13209     CALL 'kxdfhei1' USING DFHEIV0,
 13210           DFHEIV1,
 13211           DFHEIV20,
 13212           DFHEIV99,
 13213           W-NOTE-KEY,
 13214           DFHEIV99,
 13215           DFHEIV99,
 13216           DFHEIV99
 13217     SET ADDRESS OF CERTIFICATE-NOTE TO
 13218         DFHEIV20
 13219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13220
 13221
 13222     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13223     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13224     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13225
 13226     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 13227         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 13228     ELSE
 13229         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13230
 13231     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13232     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13233     MOVE 'DLO006'               TO PGM-NAME.
 13234
 13235
 13236* EXEC CICS LINK
 13237*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 257
* EL156.cbl
 13238*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13239*        LENGTH     (DCT-RCRD-LENGTH)
 13240*    END-EXEC.
 13241*    MOVE '."C                   (   #00012576' TO DFHEIV0
 13242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13244     MOVE X'2020233030303132353736' TO DFHEIV0(25:11)
 13245     CALL 'kxdfhei1' USING DFHEIV0,
 13246           PGM-NAME,
 13247           DCT-COMMUNICATION-AREA,
 13248           DCT-RCRD-LENGTH,
 13249           DFHEIV99,
 13250           DFHEIV99,
 13251           DFHEIV99,
 13252           DFHEIV99
 13253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13254
 13255
 13256     IF DCT-RETURN-CODE = 'OK'
 13257         GO TO 5300-CONT.
 13258
 13259     IF DCT-RETURN-CODE = '01' OR '02'
 13260         GO TO 5300-EXIT.
 13261
 13262     IF DCT-RETURN-CODE = '03'
 13263         MOVE ER-0951            TO EMI-ERROR
 13264         GO TO 5300-BAD-EXIT.
 13265
 13266     IF DCT-RETURN-CODE = '04'
 13267         MOVE ER-0946            TO EMI-ERROR
 13268         GO TO 5300-BAD-EXIT.
 13269
 13270     IF DCT-RETURN-CODE = '05'
 13271         MOVE ER-0947            TO EMI-ERROR
 13272         GO TO 5300-BAD-EXIT.
 13273
 13274     IF DCT-RETURN-CODE = '06'
 13275         MOVE ER-0921            TO EMI-ERROR
 13276         GO TO 5300-BAD-EXIT.
 13277
 13278     IF DCT-RETURN-CODE = '07'
 13279         MOVE ER-0849            TO EMI-ERROR
 13280         GO TO 5300-BAD-EXIT.
 13281
 13282     IF DCT-RETURN-CODE = '08'
 13283         MOVE ER-0948            TO EMI-ERROR
 13284         GO TO 5300-BAD-EXIT.
 13285
 13286     IF DCT-RETURN-CODE = 'N1'
 13287         MOVE ER-0950            TO EMI-ERROR
 13288         GO TO 5300-BAD-EXIT.
 13289
 13290     IF DCT-RETURN-CODE = 'E1'
 13291         MOVE ER-0974            TO EMI-ERROR
 13292         GO TO 5300-BAD-EXIT.
 13293
 13294     IF DCT-RETURN-CODE = 'E2'
 13295         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 258
* EL156.cbl
 13296         GO TO 5300-BAD-EXIT.
 13297
 13298     IF DCT-RETURN-CODE NOT = 'OK'
 13299         MOVE ER-0949            TO EMI-ERROR
 13300         GO TO 5300-BAD-EXIT.
 13301
 13302 5300-CONT.
 13303
 13304     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13305     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13306     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13307     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13308     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13309     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13310     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13311     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13312
 13313     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13314     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13315     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13316     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13317     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13318
 13319     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13320
 13321     IF PI-PMTTYPE = '2'
 13322         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13323         MOVE '4'                TO DM-CLAIM-STATUS
 13324     ELSE
 13325         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13326         MOVE '2'                TO DM-CLAIM-STATUS.
 13327
 13328     MOVE 'DLO025'               TO PGM-NAME.
 13329
 13330
 13331* EXEC CICS LINK
 13332*        PROGRAM    (PGM-NAME)
 13333*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13334*        LENGTH     (DM-DMO-LENGTH)
 13335*    END-EXEC.
 13336*    MOVE '."C                   (   #00012656' TO DFHEIV0
 13337     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13339     MOVE X'2020233030303132363536' TO DFHEIV0(25:11)
 13340     CALL 'kxdfhei1' USING DFHEIV0,
 13341           PGM-NAME,
 13342           DMO-COMMUNICATION-AREA,
 13343           DM-DMO-LENGTH,
 13344           DFHEIV99,
 13345           DFHEIV99,
 13346           DFHEIV99,
 13347           DFHEIV99
 13348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13349
 13350
 13351     IF DM-RETURN-CODE = 'OK'
 13352         GO TO 5300-EXIT.
 13353
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 259
* EL156.cbl
 13354     IF DM-RETURN-CODE = '01'
 13355         MOVE ER-8051            TO EMI-ERROR
 13356         GO TO 5300-BAD-EXIT.
 13357
 13358     IF DM-RETURN-CODE = '02'
 13359         MOVE ER-8052            TO EMI-ERROR
 13360         GO TO 5300-BAD-EXIT.
 13361
 13362     IF DM-RETURN-CODE = '03'
 13363         MOVE ER-8053            TO EMI-ERROR
 13364         GO TO 5300-BAD-EXIT.
 13365
 13366     IF DM-RETURN-CODE = '04'
 13367         MOVE ER-8054            TO EMI-ERROR
 13368         GO TO 5300-BAD-EXIT.
 13369
 13370     IF DM-RETURN-CODE = '05'
 13371         MOVE ER-8055            TO EMI-ERROR
 13372         GO TO 5300-BAD-EXIT.
 13373
 13374     IF DM-RETURN-CODE = '06'
 13375         MOVE ER-8056            TO EMI-ERROR
 13376         GO TO 5300-BAD-EXIT.
 13377
 13378     IF DM-RETURN-CODE = '07'
 13379         MOVE ER-8057            TO EMI-ERROR
 13380         GO TO 5300-BAD-EXIT.
 13381
 13382     IF DM-RETURN-CODE = '08'
 13383         MOVE ER-8058            TO EMI-ERROR
 13384         GO TO 5300-BAD-EXIT.
 13385
 13386     IF DM-RETURN-CODE = '09'
 13387         MOVE ER-8059            TO EMI-ERROR
 13388         GO TO 5300-BAD-EXIT.
 13389
 13390     IF DM-RETURN-CODE = '10'
 13391         MOVE ER-8060            TO EMI-ERROR
 13392         GO TO 5300-BAD-EXIT.
 13393
 13394     IF DM-RETURN-CODE = '11'
 13395         MOVE ER-8061            TO EMI-ERROR
 13396         GO TO 5300-BAD-EXIT.
 13397
 13398     IF DM-RETURN-CODE = '12'
 13399         MOVE ER-8062            TO EMI-ERROR
 13400         GO TO 5300-BAD-EXIT.
 13401
 13402     IF DM-RETURN-CODE = '13'
 13403         MOVE ER-8063            TO EMI-ERROR
 13404         GO TO 5300-BAD-EXIT.
 13405
 13406     IF DM-RETURN-CODE = '14'
 13407         MOVE ER-8064            TO EMI-ERROR
 13408         GO TO 5300-BAD-EXIT.
 13409
 13410     IF DM-RETURN-CODE = '15'
 13411         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 260
* EL156.cbl
 13412         GO TO 5300-BAD-EXIT.
 13413
 13414     IF DM-RETURN-CODE = '16'
 13415         MOVE ER-8154            TO EMI-ERROR
 13416         GO TO 5300-BAD-EXIT.
 13417
 13418     IF DM-RETURN-CODE = '17'
 13419         MOVE ER-8155            TO EMI-ERROR
 13420         GO TO 5300-BAD-EXIT.
 13421
 13422     IF DM-RETURN-CODE = 'N1'
 13423         MOVE ER-8152            TO EMI-ERROR
 13424         GO TO 5300-BAD-EXIT.
 13425
 13426     IF DM-RETURN-CODE = 'E1'
 13427         MOVE ER-8153            TO EMI-ERROR
 13428         GO TO 5300-BAD-EXIT.
 13429
 13430     MOVE ER-8066            TO EMI-ERROR.
 13431     GO TO 5300-BAD-EXIT.
 13432
 13433 5300-NOTE-NOT-FOUND.
 13434
 13435     MOVE ER-0954                TO EMI-ERROR.
 13436     GO TO 5300-BAD-EXIT.
 13437
 13438 5300-BAD-EXIT.
 13439
 13440* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13441*    MOVE '6"R                   !   #00012750' TO DFHEIV0
 13442     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13444     MOVE X'2020233030303132373530' TO DFHEIV0(25:11)
 13445     CALL 'kxdfhei1' USING DFHEIV0
 13446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13447
 13448     IF MAP-NAME = 'EL156A'
 13449         MOVE -1             TO ENTERPFL
 13450       ELSE
 13451         MOVE LOW-VALUES     TO EL156BI
 13452         MOVE -1             TO ENTPFBL.
 13453
 13454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13455     GO TO 8200-SEND-DATAONLY.
 13456
 13457 5300-EXIT.
 13458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 261
* EL156.cbl
 13460 5350-FORMAT-LAST-NAME-1ST.
 13461*****************************************************************
 13462*             M O V E   N A M E   R O U T I N E                 *
 13463*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13464*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13465*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13466*                  FIELD                   VALUE                *
 13467*           W-NAME-LAST    (CL15)      SMITH                    *
 13468*           W-NAME-FIRST   (CL15)      JOHN                     *
 13469*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13470*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13471*     CONTAIN                                                   *
 13472*                SMITH, JOHN ALLEN                              *
 13473*     OR                                                        *
 13474*                SMITH, JOHN A.                                 *
 13475*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13476*     COPYBOOK, ELCNWA.                                         *
 13477*****************************************************************.
 13478
 13479     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13480     MOVE ZERO                   TO  WS-NAME-SW.
 13481     SET NWA-INDEX               TO +1.
 13482
 13483     IF W-NAME-LAST   = SPACES AND
 13484        W-NAME-MIDDLE = SPACES
 13485         MOVE +1                 TO WS-NAME-SW.
 13486
 13487     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13488     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13489
 13490     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13491     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13492
 13493     SET NWA-INDEX UP BY +1.
 13494
 13495     IF W-NAME-MIDDLE NOT = SPACES
 13496         IF W-NAME-MIDDLE-2 = SPACES
 13497             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13498             SET NWA-INDEX UP BY +1
 13499             MOVE '.'            TO WS-NW (NWA-INDEX)
 13500             SET NWA-INDEX UP BY +2
 13501         ELSE
 13502             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13503             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13504
 13505 5350-EXIT.
 13506     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 262
* EL156.cbl
 13508 5360-MOVE-NAME.
 13509
 13510     IF WS-NAME-SW > +1
 13511         GO TO 5360-EXIT.
 13512
 13513     IF WS-NAME-WORK2 = SPACES
 13514         GO TO 5360-EXIT.
 13515
 13516     SET NWA-INDEX2            TO +1.
 13517     SET NWA-INDEX3            TO +2.
 13518
 13519 5360-MOVE-NAME-CYCLE.
 13520
 13521     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13522
 13523     IF NWA-INDEX < +30
 13524         SET NWA-INDEX UP BY +1
 13525     ELSE
 13526         ADD +2                TO  WS-NAME-SW
 13527         GO TO 5360-EXIT.
 13528
 13529     IF NWA-INDEX2 < +20
 13530         SET NWA-INDEX3 UP BY +1
 13531         SET NWA-INDEX2 UP BY +1.
 13532
 13533     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13534        WS-NW2 (NWA-INDEX3) = SPACES
 13535         IF WS-NAME-SW = ZERO
 13536             MOVE ','            TO  WS-NW (NWA-INDEX)
 13537             SET NWA-INDEX UP BY +2
 13538             MOVE +1             TO  WS-NAME-SW
 13539             GO TO 5360-EXIT
 13540         ELSE
 13541             GO TO 5360-EXIT.
 13542
 13543     GO TO 5360-MOVE-NAME-CYCLE.
 13544
 13545 5360-EXIT.
 13546     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 263
* EL156.cbl
 13548 6000-BUILD-SCREEN-B.
 13549     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13550     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13551     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13552     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13553
 13554     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13555
 13556 6050-BUILD-SCREEN.
 13557     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13558     MOVE LOW-VALUES             TO EL156BI.
 13559     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13560
 13561     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13562
 13563     IF PI-PAYEE-TYPE = 'I'
 13564        GO TO 6060-READ-TRAILER.
 13565
 13566     IF PI-PAYEE-TYPE = 'B'
 13567        ADD +10                  TO TRLR-SEQ-NO
 13568        GO TO 6060-READ-TRAILER.
 13569
 13570     IF PI-PAYEE-TYPE = 'A'
 13571        ADD +20                  TO TRLR-SEQ-NO
 13572        GO TO 6060-READ-TRAILER.
 13573
 13574     IF PI-PAYEE-TYPE = 'O'
 13575        ADD +50                  TO TRLR-SEQ-NO
 13576        GO TO 6060-READ-TRAILER.
 13577
 13578     IF PI-PAYEE-TYPE = 'Q'
 13579        ADD +60                  TO TRLR-SEQ-NO
 13580        GO TO 6060-READ-TRAILER.
 13581
 13582     IF PI-PAYEE-TYPE = 'P'
 13583        ADD +30                  TO TRLR-SEQ-NO
 13584        GO TO 6060-READ-TRAILER.
 13585
 13586     IF PI-PAYEE-TYPE = 'E'
 13587        ADD +40                  TO TRLR-SEQ-NO.
 13588
 13589 6060-READ-TRAILER.
 13590
 13591     IF PI-PAYEE-TYPE    = 'A' AND
 13592        PI-PAYEE-SEQ-NUM = 0
 13593          GO TO 6061-READ-ACCOUNT.
 13594
 13595     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13596        (PI-PAYEE-TYPE    = 'B')             AND
 13597        (PI-PAYEE-SEQ-NUM = 9)
 13598          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13599          IF BENE-FOUND-SW = 'N'
 13600            GO TO 6065-NOT-FOUND
 13601          ELSE
 13602            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13603            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13604            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13605*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 264
* EL156.cbl
 13606            STRING BE-CITY ' ' BE-STATE
 13607               DELIMITED BY '  ' INTO CITYSTBO
 13608            END-STRING
 13609            MOVE BE-ZIP-CODE       TO ZIPBO
 13610            GO TO 6061-READ-ACCOUNT.
 13611
 13612     IF PI-PAYEE-TYPE    = 'B' AND
 13613        PI-PAYEE-SEQ-NUM = 0
 13614          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13615          IF BENE-FOUND-SW = 'N'
 13616            GO TO 6065-NOT-FOUND
 13617          ELSE
 13618            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13619            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13620            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13621*           MOVE BE-CITY-STATE     TO CITYSTBO
 13622            STRING BE-CITY ' ' BE-STATE
 13623               DELIMITED BY '  ' INTO CITYSTBO
 13624            END-STRING
 13625            MOVE BE-ZIP-CODE       TO ZIPBO
 13626            GO TO 6061-READ-ACCOUNT.
 13627
 13628
 13629* EXEC CICS HANDLE CONDITION
 13630*         NOTFND(6065-NOT-FOUND)
 13631*     END-EXEC.
 13632*    MOVE '"$I                   ! / #00012931' TO DFHEIV0
 13633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13635     MOVE X'2F20233030303132393331' TO DFHEIV0(25:11)
 13636     CALL 'kxdfhei1' USING DFHEIV0
 13637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13638
 13639
 13640     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13641
 13642     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13643     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13644     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13645     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13646*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13647     STRING AT-CITY ' ' AT-STATE
 13648        DELIMITED BY '  ' INTO CITYSTBO
 13649     END-STRING
 13650     MOVE AT-ZIP-CODE            TO ZIPBO.
 13651
 13652 6061-READ-ACCOUNT.
 13653
 13654* EXEC CICS HANDLE CONDITION
 13655*         NOTFND(6068-ACCT-NOT-FND)
 13656*     END-EXEC.
 13657*    MOVE '"$I                   ! 0 #00012948' TO DFHEIV0
 13658     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13660     MOVE X'3020233030303132393438' TO DFHEIV0(25:11)
 13661     CALL 'kxdfhei1' USING DFHEIV0
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13663
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 265
* EL156.cbl
 13664
 13665
 13666* EXEC CICS READ
 13667*         DATASET('ERACCT')
 13668*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13669*         RIDFLD (PI-ACCT-KEY)
 13670*     END-EXEC.
 13671     MOVE 'ERACCT' TO DFHEIV1
 13672*    MOVE '&"S        E          (   #00012952' TO DFHEIV0
 13673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13675     MOVE X'2020233030303132393532' TO DFHEIV0(25:11)
 13676     CALL 'kxdfhei1' USING DFHEIV0,
 13677           DFHEIV1,
 13678           DFHEIV20,
 13679           DFHEIV99,
 13680           PI-ACCT-KEY,
 13681           DFHEIV99,
 13682           DFHEIV99,
 13683           DFHEIV99
 13684     SET ADDRESS OF ACCOUNT-MASTER TO
 13685         DFHEIV20
 13686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13687
 13688
 13689     MOVE AM-CARRIER             TO ACARRBO.
 13690     MOVE AM-GROUPING            TO GROUPBO.
 13691     MOVE AM-STATE               TO STATEBO.
 13692     MOVE AM-ACCOUNT             TO ACCTBO.
 13693     MOVE AM-NAME                TO ACCTNMBO.
 13694
 13695     IF PI-PAYEE-TYPE = 'A' AND
 13696        PI-PAYEE-SEQ-NUM = 0
 13697          MOVE AM-NAME             TO NAMEBO
 13698                                      PI-PAYEE-NAME
 13699          MOVE AM-ADDRS            TO ADDR1BO
 13700          MOVE SPACES              TO ADDR2BO
 13701*         MOVE AM-CITY             TO CITYSTBO
 13702          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13703             DELIMITED BY '  ' INTO CITYSTBO
 13704          END-STRING
 13705          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13706          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13707          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13708          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13709
 13710     IF CITYSTBO EQUAL SPACES
 13711         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13712         GO TO 6070-FORMAT-DATA
 13713     END-IF.
 13714
 13715     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13716     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13717     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13718     PERFORM VARYING WS-SUB FROM 30 BY -1
 13719          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13720        IF WS-END-SUB = 0  AND
 13721           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 266
* EL156.cbl
 13722            CONTINUE
 13723        ELSE
 13724            IF WS-END-SUB = 0
 13725                MOVE WS-SUB TO WS-END-SUB
 13726            ELSE
 13727                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13728                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13729                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13730                END-IF
 13731            END-IF
 13732        END-IF
 13733        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13734            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13735            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13736        END-IF
 13737     END-PERFORM.
 13738
 13739     IF WS-BEG-SUB > 0
 13740         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13741         IF WS-STATE-LENGTH = 2
 13742             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13743                  TO PI-CHECK-STATE-FOR-AK
 13744         ELSE
 13745             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13746                'ALASKA'
 13747                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13748             ELSE
 13749                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13750             END-IF
 13751         END-IF
 13752     ELSE
 13753         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13754     END-IF.
 13755
 13756     GO TO 6070-FORMAT-DATA.
 13757
 13758 6065-NOT-FOUND.
 13759     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13760     GO TO 6061-READ-ACCOUNT.
 13761
 13762 6068-ACCT-NOT-FND.
 13763     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13764
 13765 6070-FORMAT-DATA.
 13766     IF PI-HOLDTIL = ZEROS
 13767        MOVE SAVE-DATE           TO PAYDTBI
 13768       ELSE
 13769        MOVE PI-HOLDTIL          TO PAYDTBO
 13770        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13771
 13772     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13773     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13774
 13775     IF EIBAID = DFHPF3 OR DFHPF4
 13776        NEXT SENTENCE
 13777     ELSE
 13778       GO TO 6071-CONTINUE.
 13779
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 267
* EL156.cbl
 13780     MOVE PI-EPYFROM          TO PYFROMBO.
 13781     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13782
 13783     IF NOT PI-USES-PAID-TO
 13784        MOVE PI-EPYTHRU          TO PYTHRUBO
 13785        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13786     ELSE
 13787        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13788        MOVE '4'              TO DC-OPTION-CODE
 13789        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13790        IF NO-CONVERSION-ERROR
 13791           MOVE +1            TO DC-ELAPSED-DAYS
 13792           MOVE +0            TO DC-ELAPSED-MONTHS
 13793           MOVE '6'           TO DC-OPTION-CODE
 13794           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13795           IF NO-CONVERSION-ERROR
 13796              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13797
 13798     MOVE PI-EDAYS            TO DAYSBO.
 13799     MOVE PI-EPYAMT           TO PAYAMTBO.
 13800     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13801        IF PI-INT-AMT > ZEROS
 13802           MOVE PI-INT-AMT       TO INTAMTBO
 13803        END-IF
 13804     END-IF
 13805     GO TO 6072-SET-TYPE.
 13806
 13807 6071-CONTINUE.
 13808
 13809     IF PI-CPYFROM NOT = LOW-VALUES
 13810        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13811        MOVE SPACES              TO DC-OPTION-CODE
 13812        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13813        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13814
 13815     IF PI-CPYTHRU NOT = LOW-VALUES
 13816        IF NOT PI-USES-PAID-TO
 13817           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13818           MOVE SPACES             TO DC-OPTION-CODE
 13819           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13820           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13821        ELSE
 13822           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13823           MOVE '6'                TO DC-OPTION-CODE
 13824           MOVE +1                 TO DC-ELAPSED-DAYS
 13825           MOVE +0                 TO DC-ELAPSED-MONTHS
 13826           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13827           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13828
 13829     MOVE PI-CDAYS               TO DAYSBO.
 13830     MOVE PI-CPYAMT              TO PAYAMTBO.
 13831     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13832        IF PI-INT-AMT > ZEROS
 13833           MOVE PI-INT-AMT       TO INTAMTBO
 13834        END-IF
 13835     END-IF
 13836     .
 13837 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 268
* EL156.cbl
 13838     IF PI-PMTTYPE = '1'
 13839        MOVE 'PARTIAL'           TO PAYTYPBO.
 13840
 13841     IF PI-PMTTYPE = '2'
 13842        MOVE 'FINAL'             TO PAYTYPBO.
 13843
 13844     IF PI-PMTTYPE = '3'
 13845        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13846
 13847     IF PI-PMTTYPE = '4'
 13848        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13849
 13850     IF PI-PMTTYPE = '5'
 13851        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13852
 13853     IF PI-PMTTYPE = '6'
 13854        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13855
 13856     IF PI-PROV-PMT
 13857        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13858
 13859     IF PI-ECHECKNO NOT = SPACES
 13860        MOVE PI-ECHECKNO         TO CKNUMBO
 13861     ELSE
 13862        MOVE PI-CCHECKNO         TO CKNUMBO.
 13863
 13864     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 13865        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13866        MOVE +91                 TO  TRLR-SEQ-NO
 13867
 13868* EXEC CICS READ
 13869*           DATASET  ('ELTRLR')
 13870*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13871*           RIDFLD   (ELTRLR-KEY)
 13872*           RESP     (WS-RESPONSE)
 13873*       END-EXEC
 13874     MOVE 'ELTRLR' TO DFHEIV1
 13875*    MOVE '&"S        E          (  N#00013136' TO DFHEIV0
 13876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13878     MOVE X'204E233030303133313336' TO DFHEIV0(25:11)
 13879     CALL 'kxdfhei1' USING DFHEIV0,
 13880           DFHEIV1,
 13881           DFHEIV20,
 13882           DFHEIV99,
 13883           ELTRLR-KEY,
 13884           DFHEIV99,
 13885           DFHEIV99,
 13886           DFHEIV99
 13887     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13888         DFHEIV20
 13889     MOVE EIBRESP  TO WS-RESPONSE
 13890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13891
 13892        IF WS-RESP-NORMAL
 13893           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13894        ELSE
 13895           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 269
* EL156.cbl
 13896        END-IF
 13897     END-IF
 13898
 13899*       MOVE PI-LOAN-NO          TO LOANNBO
 13900
 13901     IF CKNUMBO = SPACES
 13902         MOVE SPACES             TO CKNUMHDO.
 13903
 13904     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13905     MOVE CL-CARRIER             TO CARRBO.
 13906     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13907     MOVE CL-CERT-SFX            TO SUFXBO.
 13908
 13909     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13910        EVALUATE CL-CLAIM-TYPE
 13911           WHEN 'I'
 13912              MOVE '  IU  '      TO CLMTYPBO
 13913           WHEN 'G'
 13914              MOVE ' GAP  '      TO CLMTYPBO
 13915           WHEN OTHER
 13916              MOVE PI-AH-OVERRIDE-L6
 13917                                 TO CLMTYPBO
 13918        END-EVALUATE
 13919        MOVE ZEROS               TO UNDISBO
 13920*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13921        IF PI-PMTTYPE = '5' OR '6'
 13922           GO TO 6073-GET-NOTIFY-DATA
 13923        ELSE
 13924           MOVE PI-DAILY-RATE    TO RATEBO
 13925           GO TO 6073-GET-NOTIFY-DATA.
 13926
 13927     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13928
 13929     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13930        MOVE ZEROS               TO UNDISBO
 13931     ELSE
 13932        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13933
 13934 6073-GET-NOTIFY-DATA.
 13935
 13936     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13937
 13938     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13939         MOVE SPACES             TO  NAMEB2O
 13940                                     ADDR1B2O
 13941                                     ADDR2B2O
 13942                                     CITYST2O
 13943                                     AGTHDGO
 13944         MOVE ZEROS              TO  ZIPB2O
 13945         GO TO 6080-SET-INCURRED.
 13946
 13947     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13948     MOVE +29                    TO  TRLR-SEQ-NO.
 13949
 13950
 13951* EXEC CICS HANDLE CONDITION
 13952*        NOTFND   (6074-GET-COMP-DATA)
 13953*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 270
* EL156.cbl
 13954*    MOVE '"$I                   ! 1 #00013201' TO DFHEIV0
 13955     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13957     MOVE X'3120233030303133323031' TO DFHEIV0(25:11)
 13958     CALL 'kxdfhei1' USING DFHEIV0
 13959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13960
 13961
 13962     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13963
 13964     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13965     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13966     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13967*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13968     STRING AT-CITY ' ' AT-STATE
 13969        DELIMITED BY '  ' INTO CITYST2O
 13970     END-STRING
 13971     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13972     GO TO 6080-SET-INCURRED.
 13973
 13974 6074-GET-COMP-DATA.
 13975
 13976     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13977         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13978
 13979     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13980         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13981                                         ADDR1B2O
 13982                                         ADDR2B2O
 13983                                         CITYST2O
 13984         MOVE ZEROS                  TO  ZIPB2O
 13985         GO TO 6080-SET-INCURRED.
 13986
 13987     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13988     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 13989     MOVE AM-CARRIER             TO  COMP-CARRIER.
 13990     MOVE AM-GROUPING            TO  COMP-GROUP.
 13991     MOVE 'A'                    TO  COMP-TYPE.
 13992     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13993                                 TO  COMP-FIN-RESP.
 13994
 13995     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 13996         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 13997                                       'G' OR 'B'
 13998             MOVE 'G'            TO  COMP-TYPE
 13999             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14000         ELSE
 14001             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14002                                 TO  COMP-ACCOUNT
 14003     ELSE
 14004         MOVE 'G'                TO  COMP-TYPE
 14005         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14006
 14007     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14008
 14009     IF COMP-REC-FOUND
 14010         MOVE CO-ACCT-NAME       TO  NAMEB2O
 14011         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 271
* EL156.cbl
 14012         MOVE CO-ADDR-2          TO  ADDR2B2O
 14013*        MOVE CO-ADDR-3          TO  CITYST2O
 14014         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14015            DELIMITED BY '  ' INTO CITYST2O
 14016         END-STRING
 14017         MOVE CO-ZIP             TO  ZIPB2O
 14018     ELSE
 14019         MOVE 'NO COMP ADDRESS AVAILABLE'
 14020                                 TO  NAMEB2O
 14021                                     ADDR1B2O
 14022                                     ADDR2B2O
 14023                                     CITYST2O
 14024         MOVE ZEROS               TO ZIPB2O.
 14025
 14026 6080-SET-INCURRED.
 14027     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14028     MOVE SPACES                 TO DC-OPTION-CODE.
 14029     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14030     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14031     MOVE PI-PROCESSOR-ID        TO BYBO.
 14032     MOVE MAP-NAMEB              TO MAP-NAME.
 14033     MOVE 'C'                    TO PI-PASS-SW.
 14034     MOVE EIBAID                 TO PI-PFKEY-USED.
 14035     MOVE -1                     TO ENTPFBL.
 14036     GO TO 8100-SEND-INITIAL-MAP.
 14037
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 272
* EL156.cbl
 14039 6100-BUILD-PAYMENT-TRAILER.
 14040
 14041     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14042       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14043         GO TO 6105-STATE-CHECK-NUMBER
 14044     END-IF.
 14045
 14046     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14047     MOVE '6'                    TO CNTL-REC-TYPE.
 14048
 14049     IF CONTROL-IS-ACTUAL-CARRIER
 14050         MOVE PI-CARRIER         TO WS-CARR
 14051     ELSE
 14052         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14053
 14054     IF PI-COMPANY-ID = 'FIA'
 14055         MOVE PI-CARRIER         TO  WS-CARR.
 14056
 14057     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14058     MOVE 0                      TO CNTL-SEQ-NO.
 14059     MOVE 'CARR'                 TO FILE-SWITCH.
 14060
 14061     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14062
 14063     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14064         IF PI-OFFLINE     = 'Y' AND
 14065            PI-ECHECKNO-CR = 'CR'
 14066              GO TO 6110-READ-CONTROL
 14067         ELSE
 14068            IF PI-CASH = 'N'
 14069                GO TO 6110-READ-CONTROL.
 14070
 14071     IF CHECK-NO-MANUAL    OR
 14072        CHECK-NO-AT-PRINT  OR
 14073        PI-OFFLINE = 'Y'
 14074          GO TO 6130-BUILD-TRAILER.
 14075
 14076     IF PI-COMPANY-ID = 'FIA'
 14077         NEXT SENTENCE
 14078     ELSE
 14079         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14080             GO TO 6110-READ-CONTROL.
 14081
 14082     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14083
 14084     IF CHECK-CNT-RESET-VALUE
 14085        MOVE +1                  TO CF-CHECK-COUNTER
 14086     ELSE
 14087        ADD +1                   TO CF-CHECK-COUNTER.
 14088
 14089     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14090
 14091     IF CHECK-NO-CARR-SEQ
 14092        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14093
 14094     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14095     GO TO 6120-REWRITE.
 14096
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 273
* EL156.cbl
 14097 6105-STATE-CHECK-NUMBER.
 14098     IF CHECK-NO-MANUAL    OR
 14099        CHECK-NO-AT-PRINT  OR
 14100        PI-OFFLINE = 'Y'
 14101           GO TO 6130-BUILD-TRAILER
 14102     END-IF.
 14103
 14104     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14105     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14106     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14107     MOVE '3'                TO CNTL-REC-TYPE.
 14108     MOVE +0                 TO CNTL-SEQ-NO.
 14109     MOVE 'STAT'             TO FILE-SWITCH.
 14110     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14111
 14112     IF CF-ST-CHECK-CNT-RESET
 14113         MOVE +1             TO CF-ST-CHECK-COUNTER
 14114     ELSE
 14115         ADD +1              TO CF-ST-CHECK-COUNTER
 14116     END-IF.
 14117
 14118     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14119     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14120     GO TO 6120-REWRITE.
 14121
 14122 6110-READ-CONTROL.
 14123     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14124     MOVE '1'                    TO CNTL-REC-TYPE.
 14125     MOVE SPACES                 TO CNTL-ACCESS.
 14126     MOVE 0                      TO CNTL-SEQ-NO.
 14127
 14128     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14129
 14130     IF CO-CHECK-COUNT-RESET
 14131        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14132     ELSE
 14133        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14134
 14135     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14136
 14137     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14138         IF PI-OFFLINE     = 'Y'  AND
 14139            PI-ECHECKNO-CR = 'CR'
 14140              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14141              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14142              MOVE AL-UANON           TO CHECKNOA
 14143              GO TO 6120-REWRITE
 14144         ELSE
 14145         IF PI-CASH = 'N'
 14146             MOVE 'N'                TO PI-ECHECKNO-N
 14147             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14148             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14149             MOVE AL-UANON           TO CHECKNOA
 14150             GO TO 6120-REWRITE.
 14151
 14152     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14153
 14154 6120-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 274
* EL156.cbl
 14155
 14156* EXEC CICS REWRITE
 14157*         DATASET('ELCNTL')
 14158*         FROM(CONTROL-FILE)
 14159*     END-EXEC.
 14160     MOVE LENGTH OF
 14161      CONTROL-FILE
 14162       TO DFHEIV11
 14163     MOVE 'ELCNTL' TO DFHEIV1
 14164*    MOVE '&& L                  %   #00013398' TO DFHEIV0
 14165     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14166     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14167     MOVE X'2020233030303133333938' TO DFHEIV0(25:11)
 14168     CALL 'kxdfhei1' USING DFHEIV0,
 14169           DFHEIV1,
 14170           CONTROL-FILE,
 14171           DFHEIV11,
 14172           DFHEIV99
 14173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14174
 14175
 14176     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14177
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 275
* EL156.cbl
 14179 6130-BUILD-TRAILER.
 14180
 14181
 14182* EXEC CICS GETMAIN
 14183*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14184*         LENGTH    (200)
 14185*         INITIMG   (GETMAIN-SPACE)
 14186*     END-EXEC.
 14187     MOVE 200
 14188       TO DFHEIV11
 14189*    MOVE ',"IL                  $   #00013408' TO DFHEIV0
 14190     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14191     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14192     MOVE X'2020233030303133343038' TO DFHEIV0(25:11)
 14193     CALL 'kxdfhei1' USING DFHEIV0,
 14194           DFHEIV20,
 14195           DFHEIV11,
 14196           GETMAIN-SPACE
 14197     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14198         DFHEIV20
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14200
 14201
 14202     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 14203                                    AT-PREV-PAID-THRU-DT.
 14204     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 14205     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 14206     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14207     MOVE 'AT'                   TO AT-RECORD-ID.
 14208     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14209
 14210     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14211        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14212           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 14213     ELSE
 14214           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 14215           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 14216
 14217     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 14218         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 14219             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 14220             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 14221           ELSE
 14222             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 14223             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 14224
 14225     MOVE '2'                    TO AT-TRAILER-TYPE.
 14226     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14227                                    AT-PAYMENT-LAST-MAINT-DT.
 14228     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14229                                    AT-PAYMENT-LAST-UPDATED-BY.
 14230     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14231     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 14232     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 14233     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 14234
 14235     IF PI-PMT-APPROVED
 14236        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 276
* EL156.cbl
 14237           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 14238
 14239     IF PI-PFKEY-USED = DFHPF5
 14240        GO TO 6140-PF5-ENTERED.
 14241
 14242     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 14243     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 14244
 14245     IF PI-AIG-SPECIAL-BENEFIT
 14246         IF WS-1ST-SPECIAL-PMT
 14247             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 14248             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 14249                                        AT-AMOUNT-PAID
 14250         ELSE
 14251             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14252
 14253     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 14254
 14255     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 14256     MOVE '4'                    TO DC-OPTION-CODE.
 14257     PERFORM 9700-LINK-DATE-CONVERT.
 14258
 14259     IF DATE-CONVERSION-ERROR
 14260        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 14261     ELSE
 14262        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 14263
 14264     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14265     MOVE '4'                    TO DC-OPTION-CODE.
 14266     PERFORM 9700-LINK-DATE-CONVERT.
 14267
 14268     IF DATE-CONVERSION-ERROR
 14269        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 14270     ELSE
 14271        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 14272
 14273     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14274     GO TO 6150-FINISH-MOVE.
 14275
 14276 6140-PF5-ENTERED.
 14277     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14278     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14279
 14280     IF PI-AIG-SPECIAL-BENEFIT
 14281         IF WS-1ST-SPECIAL-PMT
 14282             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14283             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14284                                        AT-AMOUNT-PAID
 14285         ELSE
 14286             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14287
 14288     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14289     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14290     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14291
 14292 6150-FINISH-MOVE.
 14293
 14294     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 277
* EL156.cbl
 14295         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14296     ELSE
 14297         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14298
 14299     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14300     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14301
 14302*05919      MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14303*05920      MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14304
 14305     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14306         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14307
 14308     IF PI-OFFLINE = 'N'
 14309        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14310        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14311     ELSE
 14312        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14313        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14314
 14315     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14316
 14317     IF WS-2ND-SPECIAL-PMT
 14318         MOVE 'Y'                TO AT-CASH-PAYMENT
 14319         MOVE SPACES             TO AT-CHECK-NO
 14320         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14321         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14322         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14323         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14324
 14325     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14326                                    AT-TO-BE-WRITTEN-DT.
 14327
 14328     IF PI-HOLDTIL NOT = ZEROS
 14329        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14330        MOVE '4'                 TO DC-OPTION-CODE
 14331        PERFORM 9700-LINK-DATE-CONVERT
 14332        IF PI-OFFLINE = 'N'
 14333           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14334        ELSE
 14335           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14336
 14337     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14338     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14339                                    AT-CHECK-QUE-SEQUENCE.
 14340
 14341     IF PI-PFKEY-USED = DFHPF4
 14342        MOVE '1'                 TO AT-FORCE-CONTROL.
 14343
 14344     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14345        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14346        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14347        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14348
 14349     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14350                                    AT-VOID-SELECT-DT
 14351                                    AT-VOID-ACCEPT-DT
 14352                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 278
* EL156.cbl
 14353     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14354        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14355        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14356        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14357        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14358     ELSE
 14359        MOVE ZEROS               TO AT-DAILY-RATE
 14360                                    AT-ELIMINATION-DAYS
 14361        MOVE SPACES              TO AT-BENEFIT-TYPE
 14362     END-IF
 14363     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14364     MOVE '4'                    TO DC-OPTION-CODE.
 14365     PERFORM 9700-LINK-DATE-CONVERT.
 14366     IF DATE-CONVERSION-ERROR
 14367         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14368     ELSE
 14369         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14370     END-IF.
 14371     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14372     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 14373     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 14374*******************************************************
 14375     IF NOT PI-PMT-GRADUATED
 14376         GO TO 6170-WRITE.
 14377
 14378     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14379     MOVE '1'                    TO CNTL-REC-TYPE.
 14380     MOVE SPACES                 TO CNTL-ACCESS.
 14381     MOVE +0                     TO CNTL-SEQ-NO.
 14382     MOVE 'COMP'                 TO FILE-SWITCH.
 14383
 14384     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14385
 14386     IF PAID-FOR-LIFE
 14387         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14388             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14389                                     WS-PMT-APPROVAL-SW
 14390             GO TO 6170-WRITE.
 14391
 14392*05999      IF PAID-FOR-AH
 14393     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14394         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14395             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14396                                     WS-PMT-APPROVAL-SW
 14397             GO TO 6170-WRITE.
 14398
 14399     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14400
 14401******A&H Limits are set as a monthly payment.  Calculate the mont
 14402******equivalent of the amount paid today
 14403     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14404        PI-SAVE-ODD-DAYS-OVER > 0
 14405           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 14406                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14407           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14408                                  WS-CALC-PMT-MONTHS
 14409     ELSE
 14410           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 279
* EL156.cbl
 14411     END-IF.
 14412*06007      IF ((PAID-FOR-AH) AND
 14413     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14414*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14415        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14416              OR
 14417        ((PAID-FOR-LIFE) AND
 14418        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14419            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14420       ELSE
 14421*06014      IF ((PAID-FOR-AH)  AND
 14422         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14423*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14424           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14425              OR
 14426        ((PAID-FOR-LIFE) AND
 14427        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14428            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14429         ELSE
 14430*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14431           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14432               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14433              OR
 14434          ((PAID-FOR-LIFE) AND
 14435          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14436            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14437       ELSE
 14438            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14439
 14440     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14441        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14442        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14443            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14444        END-IF
 14445     ELSE
 14446     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14447        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14448        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14449            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14450        END-IF
 14451     ELSE
 14452     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14453        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14454        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14455            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14456        END-IF
 14457     ELSE
 14458     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14459            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14460
 14461     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14462
 14463     IF NOT PI-PMT-GRADUATED
 14464         GO TO 6170-WRITE.
 14465
 14466
 14467* EXEC CICS HANDLE CONDITION
 14468*        NOTFND   (6170-WRITE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 280
* EL156.cbl
 14469*    END-EXEC.
 14470*    MOVE '"$I                   ! 2 #00013678' TO DFHEIV0
 14471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14473     MOVE X'3220233030303133363738' TO DFHEIV0(25:11)
 14474     CALL 'kxdfhei1' USING DFHEIV0
 14475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14476
 14477
 14478     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14479     MOVE '2'                    TO CNTL-REC-TYPE.
 14480     MOVE +0                     TO CNTL-SEQ-NO.
 14481     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14482
 14483
 14484* EXEC CICS READ
 14485*         DATASET  ('ELCNTL')
 14486*         SET      (ADDRESS OF CONTROL-FILE)
 14487*         RIDFLD   (ELCNTL-KEY)
 14488*    END-EXEC.
 14489     MOVE 'ELCNTL' TO DFHEIV1
 14490*    MOVE '&"S        E          (   #00013687' TO DFHEIV0
 14491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14493     MOVE X'2020233030303133363837' TO DFHEIV0(25:11)
 14494     CALL 'kxdfhei1' USING DFHEIV0,
 14495           DFHEIV1,
 14496           DFHEIV20,
 14497           DFHEIV99,
 14498           ELCNTL-KEY,
 14499           DFHEIV99,
 14500           DFHEIV99,
 14501           DFHEIV99
 14502     SET ADDRESS OF CONTROL-FILE TO
 14503         DFHEIV20
 14504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14505
 14506
 14507     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14508
 14509     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14510                         OR '4'
 14511         NEXT SENTENCE
 14512     ELSE
 14513         MOVE 'Y' TO WS-NEED-APPROVAL
 14514         GO TO 6170-WRITE.
 14515
 14516     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14517         MOVE 'Y' TO WS-NEED-APPROVAL
 14518         IF WS-APPROVAL-LEVEL = '1'
 14519             MOVE '2'        TO  AT-APPROVED-LEVEL
 14520                            WS-SAVE-APPROVED-LEVEL
 14521             GO TO 6170-WRITE
 14522         ELSE
 14523             IF WS-APPROVAL-LEVEL = '2'
 14524                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14525                                WS-SAVE-APPROVED-LEVEL
 14526                 GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 281
* EL156.cbl
 14527             ELSE IF WS-APPROVAL-LEVEL = '3'
 14528                 MOVE '4'        TO  AT-APPROVED-LEVEL
 14529                                WS-SAVE-APPROVED-LEVEL
 14530                 GO TO 6170-WRITE.
 14531
 14532     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14533                             WS-PMT-APPROVAL-SW.
 14534     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14535                             AT-APPROVAL-LEVEL-REQD.
 14536
 14537*******************************************************
 14538
 14539 6170-WRITE.
 14540
 14541     IF PI-COMPANY-ID = 'DMD'
 14542        IF PI-AT-EOB-CODES NOT = SPACES
 14543           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14544           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14545           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14546           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14547           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14548
 14549
 14550* EXEC CICS HANDLE CONDITION
 14551*        DUPREC    (6180-DUPREC)
 14552*    END-EXEC.
 14553*    MOVE '"$%                   ! 3 #00013735' TO DFHEIV0
 14554     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14556     MOVE X'3320233030303133373335' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0
 14558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14559
 14560
 14561
 14562* EXEC CICS WRITE
 14563*         DATASET       ('ELTRLR')
 14564*         FROM          (ACTIVITY-TRAILERS)
 14565*         RIDFLD        (AT-CONTROL-PRIMARY)
 14566*     END-EXEC.
 14567     MOVE LENGTH OF
 14568      ACTIVITY-TRAILERS
 14569       TO DFHEIV11
 14570     MOVE 'ELTRLR' TO DFHEIV1
 14571*    MOVE '&$ L                  ''   #00013739' TO DFHEIV0
 14572     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14573     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14574     MOVE X'2020233030303133373339' TO DFHEIV0(25:11)
 14575     CALL 'kxdfhei1' USING DFHEIV0,
 14576           DFHEIV1,
 14577           ACTIVITY-TRAILERS,
 14578           DFHEIV11,
 14579           AT-CONTROL-PRIMARY,
 14580           DFHEIV99,
 14581           DFHEIV99
 14582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14583
 14584
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 282
* EL156.cbl
 14585     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14586        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14587*06088           GO TO 6199-EXIT.
 14588           GO TO 6176-APPROVAL-NOTE.
 14589
 14590
 14591* EXEC CICS GETMAIN
 14592*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14593*         LENGTH    (200)
 14594*         INITIMG   (GETMAIN-SPACE)
 14595*     END-EXEC.
 14596     MOVE 200
 14597       TO DFHEIV11
 14598*    MOVE ',"IL                  $   #00013750' TO DFHEIV0
 14599     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14601     MOVE X'2020233030303133373530' TO DFHEIV0(25:11)
 14602     CALL 'kxdfhei1' USING DFHEIV0,
 14603           DFHEIV20,
 14604           DFHEIV11,
 14605           GETMAIN-SPACE
 14606     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14607         DFHEIV20
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14612
 14613     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14614     MOVE 'AT'                   TO AT-RECORD-ID.
 14615     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14616     MOVE '6'                    TO AT-TRAILER-TYPE.
 14617     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14618                                    AT-GEN-INFO-LAST-MAINT-DT
 14619     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14620                                    AT-GEN-INFO-LAST-UPDATED-BY
 14621     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14622
 14623     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14624     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14625     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14626
 14627     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14628
 14629 6175-WRITE.
 14630
 14631
 14632* EXEC CICS HANDLE CONDITION
 14633*        DUPREC    (6190-DUPREC)
 14634*    END-EXEC.
 14635*    MOVE '"$%                   ! 4 #00013776' TO DFHEIV0
 14636     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14638     MOVE X'3420233030303133373736' TO DFHEIV0(25:11)
 14639     CALL 'kxdfhei1' USING DFHEIV0
 14640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14641
 14642
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 283
* EL156.cbl
 14643
 14644* EXEC CICS WRITE
 14645*         DATASET     ('ELTRLR')
 14646*         FROM        (ACTIVITY-TRAILERS)
 14647*         RIDFLD      (AT-CONTROL-PRIMARY)
 14648*     END-EXEC.
 14649     MOVE LENGTH OF
 14650      ACTIVITY-TRAILERS
 14651       TO DFHEIV11
 14652     MOVE 'ELTRLR' TO DFHEIV1
 14653*    MOVE '&$ L                  ''   #00013780' TO DFHEIV0
 14654     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14655     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14656     MOVE X'2020233030303133373830' TO DFHEIV0(25:11)
 14657     CALL 'kxdfhei1' USING DFHEIV0,
 14658           DFHEIV1,
 14659           ACTIVITY-TRAILERS,
 14660           DFHEIV11,
 14661           AT-CONTROL-PRIMARY,
 14662           DFHEIV99,
 14663           DFHEIV99
 14664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14665
 14666
 14667 6176-APPROVAL-NOTE.
 14668
 14669     IF NOT APPROVAL-NEEDED
 14670         GO TO 6199-EXIT.
 14671
 14672
 14673* EXEC CICS GETMAIN
 14674*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14675*        LENGTH    (200)
 14676*        INITIMG   (GETMAIN-SPACE)
 14677*    END-EXEC.
 14678     MOVE 200
 14679       TO DFHEIV11
 14680*    MOVE ',"IL                  $   #00013791' TO DFHEIV0
 14681     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14682     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14683     MOVE X'2020233030303133373931' TO DFHEIV0(25:11)
 14684     CALL 'kxdfhei1' USING DFHEIV0,
 14685           DFHEIV20,
 14686           DFHEIV11,
 14687           GETMAIN-SPACE
 14688     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14689         DFHEIV20
 14690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14691
 14692
 14693     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14694
 14695     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 14696     MOVE 'AT'               TO AT-RECORD-ID
 14697     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14698     MOVE '6'                TO AT-TRAILER-TYPE
 14699     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14700                                AT-GEN-INFO-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 284
* EL156.cbl
 14701     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14702                                AT-GEN-INFO-LAST-UPDATED-BY
 14703     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14704
 14705     MOVE WS-APPROV-NOTE     TO AT-INFO-LINE-1
 14706     MOVE SPACES             TO AT-INFO-LINE-2
 14707
 14708     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14709 6177-WRITE.
 14710
 14711
 14712* EXEC CICS HANDLE CONDITION
 14713*        DUPREC    (6185-DUPREC)
 14714*    END-EXEC.
 14715*    MOVE '"$%                   ! 5 #00013815' TO DFHEIV0
 14716     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14718     MOVE X'3520233030303133383135' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723
 14724* EXEC CICS WRITE
 14725*         DATASET     ('ELTRLR')
 14726*         FROM        (ACTIVITY-TRAILERS)
 14727*         RIDFLD      (AT-CONTROL-PRIMARY)
 14728*     END-EXEC.
 14729     MOVE LENGTH OF
 14730      ACTIVITY-TRAILERS
 14731       TO DFHEIV11
 14732     MOVE 'ELTRLR' TO DFHEIV1
 14733*    MOVE '&$ L                  ''   #00013819' TO DFHEIV0
 14734     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14736     MOVE X'2020233030303133383139' TO DFHEIV0(25:11)
 14737     CALL 'kxdfhei1' USING DFHEIV0,
 14738           DFHEIV1,
 14739           ACTIVITY-TRAILERS,
 14740           DFHEIV11,
 14741           AT-CONTROL-PRIMARY,
 14742           DFHEIV99,
 14743           DFHEIV99
 14744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14745
 14746
 14747
 14748     GO TO 6199-EXIT.
 14749
 14750 6180-DUPREC.
 14751
 14752     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14753     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14754     GO TO 6170-WRITE.
 14755
 14756 6185-DUPREC.
 14757     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14758     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 285
* EL156.cbl
 14759     GO TO 6177-WRITE.
 14760
 14761 6190-DUPREC.
 14762     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14763     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14764     GO TO 6175-WRITE.
 14765
 14766 6199-EXIT.
 14767      EXIT.
 14768
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 286
* EL156.cbl
 14770 6200-UPDATE-CLAIM-MSTR.
 14771     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14772     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14773     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14774     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14775
 14776     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14777
 14778     MOVE ZEROS                  TO W-INTEREST.
 14779
 14780     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14781        IF (PI-OFFLINE = 'Y') OR
 14782           (PI-PMTTYPE = '7')
 14783           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14784                                 THRU 9870-EXIT
 14785        END-IF
 14786     END-IF
 14787     IF NOT ERROR-ON-OUTPUT
 14788        CONTINUE
 14789     ELSE
 14790
 14791* EXEC CICS REWRITE
 14792*          DATASET('ELMSTR')
 14793*          FROM(CLAIM-MASTER)
 14794*       END-EXEC
 14795     MOVE LENGTH OF
 14796      CLAIM-MASTER
 14797       TO DFHEIV11
 14798     MOVE 'ELMSTR' TO DFHEIV1
 14799*    MOVE '&& L                  %   #00013868' TO DFHEIV0
 14800     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14801     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14802     MOVE X'2020233030303133383638' TO DFHEIV0(25:11)
 14803     CALL 'kxdfhei1' USING DFHEIV0,
 14804           DFHEIV1,
 14805           CLAIM-MASTER,
 14806           DFHEIV11,
 14807           DFHEIV99
 14808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14809
 14810        MOVE -1                  TO ENTPFBL
 14811        MOVE AL-UANON            TO ENTPFBA
 14812        MOVE MAP-NAMEB           TO MAP-NAME
 14813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14814        GO TO 8200-SEND-DATAONLY
 14815     END-IF
 14816
 14817     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14818
 14819     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14820
 14821     IF PI-AIG-SPECIAL-BENEFIT
 14822         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14823
 14824     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14825
 14826     IF PI-SPECIAL-BEN-SW = 'Y'
 14827         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 287
* EL156.cbl
 14828         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14829
 14830     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14831         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14832     ELSE
 14833         IF PI-PMTTYPE NOT = '4'
 14834            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14835
 14836     IF PI-PMTTYPE = '5' OR '6'
 14837        GO TO  6250-SET-MAINT.
 14838
 14839     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14840                                         CL-LAG-REPORT-CODE.
 14841
 14842     IF CL-ACTIVITY-CODE = 09
 14843         GO TO 6200-CONT-UPDATE.
 14844
 14845     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14846         IF CL-ACTIVITY-CODE = 11
 14847             GO TO 6200-CONT-UPDATE.
 14848
 14849     IF WS-ACT-REC-FOUND-SW = 'N'
 14850         GO TO 6200-CONT-UPDATE.
 14851
 14852     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14853         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14854         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14855         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14856
 14857     IF WS-UPDATE-SW = 'Y'
 14858         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14859                                         CL-NEXT-FOLLOWUP-DT.
 14860
 14861 6200-CONT-UPDATE.
 14862
 14863     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14864       IF CLAIM-IS-CLOSED
 14865         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14866           IF WS-OPEN-CLOSE-SW = '2'
 14867             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14868                                        CL-LAST-CLOSE-DT.
 14869
 14870     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14871        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14872        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14873
 14874     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14875        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14876        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14877        MOVE 'C'                 TO CL-CLAIM-STATUS
 14878        IF PI-PMTTYPE = '2'
 14879           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14880           CONTINUE
 14881        ELSE
 14882           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14883        END-IF
 14884     ELSE
 14885        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 288
* EL156.cbl
 14886           IF PI-PMTTYPE = '2' AND
 14887              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14888              CONTINUE
 14889           ELSE
 14890              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14891           END-IF
 14892        END-IF
 14893     END-IF
 14894
 14895     IF PI-PMTTYPE = '4'
 14896        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14897
 14898     IF PI-COMPANY-ID = 'CVL'
 14899         IF PI-LOAN-UPDATE-SW = 'Y'
 14900             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14901             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14902             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14903             MOVE CL-CERT-STATE      TO  CERT-STATE
 14904             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14905             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14906             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14907             MOVE 'CERT'             TO  FILE-SWITCH
 14908             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14909             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14910             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14911
 14912     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14913        GO TO 6220-USE-COMPUTED.
 14914
 14915     IF (PI-PMTTYPE = '4')  AND
 14916        (PI-EPYAMT < ZEROS)
 14917          COMPUTE CL-NO-OF-DAYS-PAID =
 14918                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14919          IF CL-NO-OF-DAYS-PAID < +0
 14920              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14921          ELSE
 14922              NEXT SENTENCE
 14923     ELSE
 14924          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14925
 14926     IF PI-PROCESSOR-ID = 'FIX '
 14927        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14928           NEXT SENTENCE
 14929        ELSE
 14930           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14931     ELSE
 14932        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14933
 14934     IF PI-PMTTYPE = '4'
 14935        GO TO 6250-SET-MAINT.
 14936
 14937     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14938
 14939     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14940     MOVE '4'                    TO DC-OPTION-CODE.
 14941     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14942     IF DATE-CONVERSION-ERROR
 14943        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 289
* EL156.cbl
 14944     ELSE
 14945        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14946           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14947           IF PI-AIG-SPECIAL-BENEFIT
 14948               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14949           ELSE
 14950               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14951
 14952     GO TO 6250-SET-MAINT.
 14953
 14954 6220-USE-COMPUTED.
 14955
 14956     IF (PI-PMTTYPE = '4')  AND
 14957        (PI-CPYAMT < ZEROS)
 14958          COMPUTE CL-NO-OF-DAYS-PAID =
 14959                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14960          IF CL-NO-OF-DAYS-PAID < +0
 14961              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14962          ELSE
 14963              NEXT SENTENCE
 14964     ELSE
 14965          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14966
 14967     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14968
 14969     IF PI-PMTTYPE = '4'
 14970        GO TO 6250-SET-MAINT.
 14971
 14972     IF PI-AIG-SPECIAL-BENEFIT
 14973         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 14974     ELSE
 14975         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 14976
 14977     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14978
 14979     IF PI-CPYTHRU > CL-PAID-THRU-DT
 14980        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 14981
 14982 6250-SET-MAINT.
 14983     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 14984
 14985     IF PI-PROCESSOR-ID = 'FIX '
 14986        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 14987           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 14988        ELSE
 14989           NEXT SENTENCE
 14990     ELSE
 14991        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 14992
 14993     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 14994     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 14995     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 14996
 14997 6299-EXIT.
 14998      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 290
* EL156.cbl
 15000 6300-UPDATE-CERT.
 15001
 15002*  ADD CERTNOTE FOR SC NP+6
 15003     IF PI-COMPANY-ID = 'CID' AND
 15004       (PI-PMTTYPE = '2' OR '3') AND
 15005        CL-CERT-STATE = 'SC'  AND
 15006        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15007           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15008     END-IF.
 15009
 15010     IF PI-COMPANY-ID = 'AHL' AND
 15011       (PI-PMTTYPE = '2' OR '3') AND
 15012        CL-CERT-STATE = 'SC'  AND
 15013        (PI-LF-BENEFIT-CD = '5I' OR '6J')
 15014           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15015     END-IF.
 15016
 15017     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15018     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15019     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15020     MOVE CL-CERT-STATE    TO CERT-STATE.
 15021     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15022     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15023     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15024     MOVE 'CERT'           TO FILE-SWITCH.
 15025
 15026     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15027
 15028     IF CERT-NOTE-ADDED
 15029        IF CM-NOTE-SW = ' '
 15030           MOVE '4'             TO CM-NOTE-SW
 15031        ELSE
 15032           IF CM-NOTE-SW = '1'
 15033               MOVE '5'           TO CM-NOTE-SW
 15034           ELSE
 15035              IF CM-NOTE-SW = '2'
 15036                 MOVE '6'         TO CM-NOTE-SW
 15037              ELSE
 15038                 IF CM-NOTE-SW = '3'
 15039                    MOVE '7'      TO CM-NOTE-SW
 15040                 END-IF
 15041              END-IF
 15042           END-IF
 15043        END-IF
 15044     END-IF.
 15045
 15046     IF PI-COMPANY-ID = 'CVL'
 15047         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15048         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15049
 15050     IF PI-PMTTYPE NOT = '4'
 15051        GO TO 6340-UPDATE-CERT.
 15052
 15053     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15054        IF PI-PFKEY-USED = DFHPF5
 15055           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15056        ELSE
 15057           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 291
* EL156.cbl
 15058
 15059*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15060*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15061*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15062*               PI-LF-COVERAGE-TYPE = 'P'
 15063*                GO TO 6350-REWRITE-CERT.
 15064
 15065     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15066       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15067          PI-LF-COVERAGE-TYPE = 'P'
 15068           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15069                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15070                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15071                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15072                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15073                GO TO 6350-REWRITE-CERT
 15074            ELSE
 15075                GO TO 6350-REWRITE-CERT.
 15076
 15077     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15078         GO TO 6350-REWRITE-CERT.
 15079
 15080     IF NOT CM-AH-LUMP-SUM-DISAB
 15081        GO TO 6380-UNLOCK-CERT.
 15082
 15083     IF PI-PFKEY-USED = DFHPF5
 15084        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15085                                    CM-AH-ITD-AH-PMT
 15086        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15087        GO TO 6350-REWRITE-CERT
 15088     ELSE
 15089        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15090                                    CM-AH-ITD-AH-PMT
 15091        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15092        GO TO 6350-REWRITE-CERT.
 15093
 15094 6340-UPDATE-CERT.
 15095
 15096     IF CL-CLAIM-TYPE = 'L'
 15097         IF PI-PFKEY-USED = DFHPF5
 15098             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15099         ELSE
 15100             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15101
 15102     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15103         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15104             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15105                PI-LF-COVERAGE-TYPE = 'P'
 15106                 GO TO 6350-REWRITE-CERT.
 15107
 15108     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15109       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15110          PI-LF-COVERAGE-TYPE = 'P'
 15111           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15112                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15113                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15114                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15115                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 292
* EL156.cbl
 15116                GO TO 6350-REWRITE-CERT.
 15117
 15118     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15119         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 15120            PI-LF-COVERAGE-TYPE NOT = 'P'
 15121             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 15122             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 15123             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 15124             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 15125             GO TO 6350-REWRITE-CERT.
 15126
 15127     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15128         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 15129         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 15130         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 15131         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 15132         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 15133         IF PI-PFKEY-USED = DFHPF5
 15134             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 15135                                        CM-AH-ITD-AH-PMT
 15136             GO TO 6350-REWRITE-CERT
 15137         ELSE
 15138             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15139                                        CM-AH-ITD-AH-PMT
 15140             GO TO 6350-REWRITE-CERT.
 15141
 15142 6350-REWRITE-CERT.
 15143
 15144
 15145* EXEC CICS REWRITE
 15146*         DATASET  ('ELCERT')
 15147*         FROM(CERTIFICATE-MASTER)
 15148*     END-EXEC.
 15149     MOVE LENGTH OF
 15150      CERTIFICATE-MASTER
 15151       TO DFHEIV11
 15152     MOVE 'ELCERT' TO DFHEIV1
 15153*    MOVE '&& L                  %   #00014207' TO DFHEIV0
 15154     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15155     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15156     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 15157     CALL 'kxdfhei1' USING DFHEIV0,
 15158           DFHEIV1,
 15159           CERTIFICATE-MASTER,
 15160           DFHEIV11,
 15161           DFHEIV99
 15162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15163
 15164
 15165     GO TO 6399-EXIT.
 15166
 15167 6380-UNLOCK-CERT.
 15168
 15169* EXEC CICS UNLOCK
 15170*         DATASET  ('ELCERT')
 15171*     END-EXEC.
 15172     MOVE 'ELCERT' TO DFHEIV1
 15173*    MOVE '&*                    #   #00014215' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 293
* EL156.cbl
 15174     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15175     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15176     MOVE X'2020233030303134323135' TO DFHEIV0(25:11)
 15177     CALL 'kxdfhei1' USING DFHEIV0,
 15178           DFHEIV1,
 15179           DFHEIV99
 15180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15181
 15182
 15183 6399-EXIT.
 15184      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 294
* EL156.cbl
 15186 6400-UPDATE-ZERO-TRAILER.
 15187     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15188     MOVE ZEROS                  TO TRLR-SEQ-NO.
 15189
 15190     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 15191
 15192     IF PI-EPYAMT NOT = ZEROS
 15193         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 15194     ELSE
 15195         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 15196
 15197     IF PI-ERESV NOT = ZEROS
 15198        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 15199
 15200     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 15201        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 15202
 15203     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 15204        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 15205     ELSE
 15206        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 15207
 15208     IF PI-PMTTYPE = '5'
 15209        IF PI-EPYAMT = ZEROS
 15210           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 15211        ELSE
 15212           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 15213
 15214     IF PI-PMTTYPE = '6'
 15215        IF PI-EPYAMT = ZEROS
 15216           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 15217        ELSE
 15218           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 15219
 15220 6420-CHECK-OPEN-CLOSE.
 15221     IF PI-PMTTYPE = '5' OR '6'
 15222        GO TO 6450-REWRITE.
 15223
 15224     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15225         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15226             IF CLAIM-IS-CLOSED
 15227                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 15228                 MOVE 1          TO  SUB-1
 15229                 GO TO 6440-AIG-LOOP.
 15230
 15231     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 15232        GO TO 6450-REWRITE.
 15233
 15234     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 15235        GO TO 6450-REWRITE.
 15236
 15237     MOVE 1                      TO SUB-1.
 15238
 15239 6430-LOOP.
 15240     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15241        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 15242        IF PI-PMTTYPE = '1' OR '4'
 15243           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 295
* EL156.cbl
 15244           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15245           GO TO 6450-REWRITE
 15246        ELSE
 15247           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 15248           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15249           GO TO 6450-REWRITE.
 15250
 15251     IF SUB-1 = 6
 15252      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15253      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15254      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15255      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15256      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15257      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15258      GO TO 6430-LOOP.
 15259
 15260     ADD 1                       TO SUB-1.
 15261     GO TO 6430-LOOP.
 15262
 15263
 15264 6440-AIG-LOOP.
 15265
 15266     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15267       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 15268       IF WS-OPEN-CLOSE-SW = '1'
 15269         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15270         IF PI-PMTTYPE = '2'
 15271           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15272           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 15273         ELSE
 15274           IF PI-PMTTYPE = '3'
 15275             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15276             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 15277           ELSE
 15278             IF PI-PMTTYPE = '4'
 15279               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15280               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15281             ELSE
 15282               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15283               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15284       ELSE
 15285         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15286         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15287         GO TO 6450-REWRITE.
 15288
 15289     IF SUB-1 = 6
 15290      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15291      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15292      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15293      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15294      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15295      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15296      GO TO 6440-AIG-LOOP.
 15297
 15298     ADD 1                       TO SUB-1.
 15299     GO TO 6440-AIG-LOOP.
 15300
 15301 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 296
* EL156.cbl
 15302     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15303     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15304     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15305
 15306     IF PI-COMPANY-ID = 'DMD'
 15307         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15308         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15309         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15310         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15311         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15312
 15313
 15314* EXEC CICS REWRITE
 15315*         DATASET  ('ELTRLR')
 15316*         FROM     (ACTIVITY-TRAILERS)
 15317*     END-EXEC.
 15318     MOVE LENGTH OF
 15319      ACTIVITY-TRAILERS
 15320       TO DFHEIV11
 15321     MOVE 'ELTRLR' TO DFHEIV1
 15322*    MOVE '&& L                  %   #00014349' TO DFHEIV0
 15323     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15324     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15325     MOVE X'2020233030303134333439' TO DFHEIV0(25:11)
 15326     CALL 'kxdfhei1' USING DFHEIV0,
 15327           DFHEIV1,
 15328           ACTIVITY-TRAILERS,
 15329           DFHEIV11,
 15330           DFHEIV99
 15331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15332
 15333
 15334 6499-EXIT.
 15335      EXIT.
 15336
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 297
* EL156.cbl
 15338 6500-READ-DLO035.
 15339     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15340     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15341     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15342     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15343
 15344
 15345* EXEC CICS LINK
 15346*        PROGRAM    ('DLO035')
 15347*        COMMAREA   (DLO035-KEY)
 15348*        LENGTH     (DL35-LENGTH)
 15349*    END-EXEC.
 15350     MOVE 'DLO035' TO DFHEIV1
 15351*    MOVE '."C                   (   #00014364' TO DFHEIV0
 15352     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15354     MOVE X'2020233030303134333634' TO DFHEIV0(25:11)
 15355     CALL 'kxdfhei1' USING DFHEIV0,
 15356           DFHEIV1,
 15357           DLO035-KEY,
 15358           DL35-LENGTH,
 15359           DFHEIV99,
 15360           DFHEIV99,
 15361           DFHEIV99,
 15362           DFHEIV99
 15363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15364
 15365
 15366     IF DL35-RETURN-CODE = 'OK'
 15367         GO TO 6500-EXIT.
 15368
 15369     IF DL35-RETURN-CODE = '01'
 15370         MOVE ER-7830            TO EMI-ERROR
 15371         GO TO 6500-BAD-EXIT.
 15372
 15373     IF DL35-RETURN-CODE = '02'
 15374         MOVE ER-7831            TO EMI-ERROR
 15375         GO TO 6500-BAD-EXIT.
 15376
 15377     IF DL35-RETURN-CODE = '03'
 15378         MOVE ER-7832            TO EMI-ERROR
 15379         GO TO 6500-BAD-EXIT.
 15380
 15381     IF DL35-RETURN-CODE = '04'
 15382         MOVE ER-7833            TO EMI-ERROR
 15383         GO TO 6500-BAD-EXIT.
 15384
 15385     IF DL35-RETURN-CODE = '05'
 15386         MOVE ER-7834            TO EMI-ERROR
 15387         GO TO 6500-BAD-EXIT.
 15388
 15389     IF DL35-RETURN-CODE = '06'
 15390         MOVE ER-7835            TO EMI-ERROR
 15391         GO TO 6500-BAD-EXIT.
 15392
 15393     IF DL35-RETURN-CODE = '07'
 15394         MOVE ER-7836            TO EMI-ERROR
 15395         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 298
* EL156.cbl
 15396
 15397     IF DL35-RETURN-CODE = 'E1'
 15398         MOVE ER-7837            TO EMI-ERROR
 15399         GO TO 6500-BAD-EXIT.
 15400
 15401     IF DL35-RETURN-CODE NOT = 'OK'
 15402         MOVE ER-7838            TO EMI-ERROR
 15403         GO TO 6500-BAD-EXIT.
 15404
 15405 6500-EXIT.
 15406      EXIT.
 15407
 15408 6500-BAD-EXIT.
 15409
 15410* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15411*    MOVE '6"R                   !   #00014413' TO DFHEIV0
 15412     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15414     MOVE X'2020233030303134343133' TO DFHEIV0(25:11)
 15415     CALL 'kxdfhei1' USING DFHEIV0
 15416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15417
 15418     MOVE -1                 TO PMTTYPEL.
 15419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15420     GO TO 8200-SEND-DATAONLY.
 15421
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 299
* EL156.cbl
 15423 6600-UPDATE-DLO035.
 15424     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15425     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15426     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15427     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15428
 15429
 15430* EXEC CICS LINK
 15431*        PROGRAM    ('DLO035')
 15432*        COMMAREA   (DLO035-KEY)
 15433*        LENGTH     (DL35-LENGTH)
 15434*    END-EXEC.
 15435     MOVE 'DLO035' TO DFHEIV1
 15436*    MOVE '."C                   (   #00014425' TO DFHEIV0
 15437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15439     MOVE X'2020233030303134343235' TO DFHEIV0(25:11)
 15440     CALL 'kxdfhei1' USING DFHEIV0,
 15441           DFHEIV1,
 15442           DLO035-KEY,
 15443           DL35-LENGTH,
 15444           DFHEIV99,
 15445           DFHEIV99,
 15446           DFHEIV99,
 15447           DFHEIV99
 15448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15449
 15450
 15451     IF DL35-RETURN-CODE = 'OK'
 15452         GO TO 6600-EXIT.
 15453
 15454     IF DL35-RETURN-CODE = '01'
 15455         MOVE ER-7830            TO EMI-ERROR
 15456         GO TO 6500-BAD-EXIT.
 15457
 15458     IF DL35-RETURN-CODE = '02'
 15459         MOVE ER-7831            TO EMI-ERROR
 15460         GO TO 6500-BAD-EXIT.
 15461
 15462     IF DL35-RETURN-CODE = '03'
 15463         MOVE ER-7832            TO EMI-ERROR
 15464         GO TO 6500-BAD-EXIT.
 15465
 15466     IF DL35-RETURN-CODE = '04'
 15467         MOVE ER-7833            TO EMI-ERROR
 15468         GO TO 6500-BAD-EXIT.
 15469
 15470     IF DL35-RETURN-CODE = '05'
 15471         MOVE ER-7834            TO EMI-ERROR
 15472         GO TO 6500-BAD-EXIT.
 15473
 15474     IF DL35-RETURN-CODE = '06'
 15475         MOVE ER-7835            TO EMI-ERROR
 15476         GO TO 6500-BAD-EXIT.
 15477
 15478     IF DL35-RETURN-CODE = '07'
 15479         MOVE ER-7836            TO EMI-ERROR
 15480         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 300
* EL156.cbl
 15481
 15482     IF DL35-RETURN-CODE = 'E1'
 15483         MOVE ER-7837            TO EMI-ERROR
 15484         GO TO 6500-BAD-EXIT.
 15485
 15486     IF DL35-RETURN-CODE NOT = 'OK'
 15487         MOVE ER-7838            TO EMI-ERROR
 15488         GO TO 6500-BAD-EXIT.
 15489
 15490 6600-EXIT.
 15491      EXIT.
 15492
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 301
* EL156.cbl
 15494 6700-UPDATE-ACTQ.
 15495***************************************************************
 15496*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15497*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15498*    ONE ALREADY THERE.                                       *
 15499***************************************************************
 15500
 15501
 15502* EXEC CICS HANDLE CONDITION
 15503*         NOTFND(6720-BUILD-NEW-RECORD)
 15504*     END-EXEC.
 15505*    MOVE '"$I                   ! 6 #00014481' TO DFHEIV0
 15506     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15508     MOVE X'3620233030303134343831' TO DFHEIV0(25:11)
 15509     CALL 'kxdfhei1' USING DFHEIV0
 15510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15511
 15512
 15513
 15514* EXEC CICS READ
 15515*         DATASET('ELACTQ')
 15516*         RIDFLD (ELMSTR-KEY)
 15517*         SET    (ADDRESS OF ACTIVITY-QUE)
 15518*         UPDATE
 15519*     END-EXEC.
 15520     MOVE 'ELACTQ' TO DFHEIV1
 15521*    MOVE '&"S        EU         (   #00014485' TO DFHEIV0
 15522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15523     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15524     MOVE X'2020233030303134343835' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0,
 15526           DFHEIV1,
 15527           DFHEIV20,
 15528           DFHEIV99,
 15529           ELMSTR-KEY,
 15530           DFHEIV99,
 15531           DFHEIV99,
 15532           DFHEIV99
 15533     SET ADDRESS OF ACTIVITY-QUE TO
 15534         DFHEIV20
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15536
 15537
 15538     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15539
 15540     IF PI-AIG-SPECIAL-BENEFIT AND
 15541        PI-CASH = 'Y'
 15542         ADD 2                   TO AQ-PAYMENT-COUNTER
 15543     ELSE
 15544         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15545
 15546     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15547         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15548
 15549     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15550
 15551     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 302
* EL156.cbl
 15552         IF WS-PMT-APPROVAL-SW = 'A'
 15553             NEXT SENTENCE
 15554         ELSE
 15555            IF PI-AIG-SPECIAL-BENEFIT AND
 15556               PI-CASH = 'Y'
 15557                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15558                                     WS-PMT-UNAPPROVED-CNT
 15559            ELSE
 15560                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15561                                     WS-PMT-UNAPPROVED-CNT
 15562     ELSE
 15563         IF PI-PMT-APPR-SW = 'Y'
 15564            IF PI-AIG-SPECIAL-BENEFIT AND
 15565               PI-CASH = 'Y'
 15566                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15567                                     WS-PMT-UNAPPROVED-CNT
 15568            ELSE
 15569                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15570                                     WS-PMT-UNAPPROVED-CNT.
 15571
 15572     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15573         MOVE ER-3536 TO EMI-ERROR
 15574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15575
 15576     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15577
 15578
 15579* EXEC CICS REWRITE
 15580*         DATASET('ELACTQ')
 15581*         FROM   (ACTIVITY-QUE)
 15582*     END-EXEC.
 15583     MOVE LENGTH OF
 15584      ACTIVITY-QUE
 15585       TO DFHEIV11
 15586     MOVE 'ELACTQ' TO DFHEIV1
 15587*    MOVE '&& L                  %   #00014532' TO DFHEIV0
 15588     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15589     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15590     MOVE X'2020233030303134353332' TO DFHEIV0(25:11)
 15591     CALL 'kxdfhei1' USING DFHEIV0,
 15592           DFHEIV1,
 15593           ACTIVITY-QUE,
 15594           DFHEIV11,
 15595           DFHEIV99
 15596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15597
 15598
 15599     GO TO 6799-EXIT.
 15600
 15601 6720-BUILD-NEW-RECORD.
 15602
 15603* EXEC CICS GETMAIN
 15604*         SET    (ADDRESS OF ACTIVITY-QUE)
 15605*         LENGTH (60)
 15606*         INITIMG(GETMAIN-SPACE)
 15607*     END-EXEC.
 15608     MOVE 60
 15609       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 303
* EL156.cbl
 15610*    MOVE ',"IL                  $   #00014540' TO DFHEIV0
 15611     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15612     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15613     MOVE X'2020233030303134353430' TO DFHEIV0(25:11)
 15614     CALL 'kxdfhei1' USING DFHEIV0,
 15615           DFHEIV20,
 15616           DFHEIV11,
 15617           GETMAIN-SPACE
 15618     SET ADDRESS OF ACTIVITY-QUE TO
 15619         DFHEIV20
 15620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15621
 15622
 15623     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15624
 15625     IF PI-AIG-SPECIAL-BENEFIT AND
 15626        PI-CASH = 'Y'
 15627         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15628     ELSE
 15629         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15630
 15631     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15632     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15633     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15634     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15635                                    AQ-FOLLOWUP-DATE.
 15636     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15637     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15638
 15639     IF PI-PMT-GRADUATED
 15640         IF WS-PMT-APPROVAL-SW = 'A'
 15641             NEXT SENTENCE
 15642         ELSE
 15643            IF PI-AIG-SPECIAL-BENEFIT AND
 15644               PI-CASH = 'Y'
 15645                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15646            ELSE
 15647                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15648     ELSE
 15649         IF PI-PMT-APPR-SW = 'Y'
 15650            IF PI-AIG-SPECIAL-BENEFIT AND
 15651               PI-CASH = 'Y'
 15652                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15653            ELSE
 15654                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15655
 15656     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15657         MOVE ER-3536 TO EMI-ERROR
 15658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15659
 15660
 15661* EXEC CICS WRITE
 15662*         DATASET('ELACTQ')
 15663*         RIDFLD (ELMSTR-KEY)
 15664*         FROM   (ACTIVITY-QUE)
 15665*     END-EXEC.
 15666     MOVE LENGTH OF
 15667      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 304
* EL156.cbl
 15668       TO DFHEIV11
 15669     MOVE 'ELACTQ' TO DFHEIV1
 15670*    MOVE '&$ L                  ''   #00014583' TO DFHEIV0
 15671     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15672     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15673     MOVE X'2020233030303134353833' TO DFHEIV0(25:11)
 15674     CALL 'kxdfhei1' USING DFHEIV0,
 15675           DFHEIV1,
 15676           ACTIVITY-QUE,
 15677           DFHEIV11,
 15678           ELMSTR-KEY,
 15679           DFHEIV99,
 15680           DFHEIV99
 15681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15682
 15683
 15684 6799-EXIT.
 15685      EXIT.
 15686
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 305
* EL156.cbl
 15688 6800-BUILD-FORM-TRAILER.
 15689
 15690
 15691* EXEC CICS GETMAIN
 15692*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15693*         LENGTH   (200)
 15694*         INITIMG  (GETMAIN-SPACE)
 15695*    END-EXEC.
 15696     MOVE 200
 15697       TO DFHEIV11
 15698*    MOVE ',"IL                  $   #00014595' TO DFHEIV0
 15699     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15701     MOVE X'2020233030303134353935' TO DFHEIV0(25:11)
 15702     CALL 'kxdfhei1' USING DFHEIV0,
 15703           DFHEIV20,
 15704           DFHEIV11,
 15705           GETMAIN-SPACE
 15706     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15707         DFHEIV20
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15709
 15710
 15711     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15712
 15713     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15714     MOVE 'AT'                   TO AT-RECORD-ID.
 15715     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15716
 15717     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15718     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15719                                    AT-FORM-LAST-MAINT-DT
 15720                                    AT-FORM-SEND-ON-DT.
 15721     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15722                                    AT-FORM-LAST-UPDATED-BY.
 15723     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15724     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15725     MOVE '6'                    TO DC-OPTION-CODE.
 15726     MOVE +29                    TO DC-ELAPSED-DAYS.
 15727     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15728     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15729     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15730
 15731     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15732         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15733
 15734     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15735                                    AT-FORM-RE-SEND-DT
 15736                                    AT-EMP-FORM-ANSWERED-DT
 15737                                    AT-PHY-FORM-ANSWERED-DT
 15738                                    AT-EMP-FORM-SEND-ON-DT
 15739                                    AT-PHY-FORM-SEND-ON-DT
 15740                                    AT-FORM-PRINTED-DT
 15741                                    AT-FORM-REPRINT-DT.
 15742     MOVE '2'                    TO AT-FORM-TYPE.
 15743
 15744     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15745     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 306
* EL156.cbl
 15746
 15747     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15748         NEXT SENTENCE
 15749     ELSE
 15750         IF CL-PROG-FORM-TYPE NOT = 'S'
 15751            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15752
 15753
 15754* EXEC CICS WRITE
 15755*         DATASET  ('ELTRLR')
 15756*         FROM     (ACTIVITY-TRAILERS)
 15757*         RIDFLD   (AT-CONTROL-PRIMARY)
 15758*     END-EXEC.
 15759     MOVE LENGTH OF
 15760      ACTIVITY-TRAILERS
 15761       TO DFHEIV11
 15762     MOVE 'ELTRLR' TO DFHEIV1
 15763*    MOVE '&$ L                  ''   #00014643' TO DFHEIV0
 15764     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15766     MOVE X'2020233030303134363433' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0,
 15768           DFHEIV1,
 15769           ACTIVITY-TRAILERS,
 15770           DFHEIV11,
 15771           AT-CONTROL-PRIMARY,
 15772           DFHEIV99,
 15773           DFHEIV99
 15774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15775
 15776
 15777 6899-EXIT.
 15778      EXIT.
 15779
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 307
* EL156.cbl
 15781 6900-BUILD-ARCHIVE-HEADER.
 15782
 15783     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15784     MOVE '1'                    TO CNTL-REC-TYPE.
 15785     MOVE +0                     TO CNTL-SEQ-NO.
 15786     MOVE SPACES                 TO CNTL-ACCESS.
 15787
 15788
 15789* EXEC CICS READ
 15790*         DATASET  ('ELCNTL')
 15791*         SET      (ADDRESS OF CONTROL-FILE)
 15792*         RIDFLD   (ELCNTL-KEY)
 15793*         UPDATE
 15794*    END-EXEC.
 15795     MOVE 'ELCNTL' TO DFHEIV1
 15796*    MOVE '&"S        EU         (   #00014660' TO DFHEIV0
 15797     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15798     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15799     MOVE X'2020233030303134363630' TO DFHEIV0(25:11)
 15800     CALL 'kxdfhei1' USING DFHEIV0,
 15801           DFHEIV1,
 15802           DFHEIV20,
 15803           DFHEIV99,
 15804           ELCNTL-KEY,
 15805           DFHEIV99,
 15806           DFHEIV99,
 15807           DFHEIV99
 15808     SET ADDRESS OF CONTROL-FILE TO
 15809         DFHEIV20
 15810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15811
 15812
 15813     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15814     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15815
 15816
 15817* EXEC CICS REWRITE
 15818*         FROM     (CONTROL-FILE)
 15819*         DATASET  ('ELCNTL')
 15820*    END-EXEC.
 15821     MOVE LENGTH OF
 15822      CONTROL-FILE
 15823       TO DFHEIV11
 15824     MOVE 'ELCNTL' TO DFHEIV1
 15825*    MOVE '&& L                  %   #00014670' TO DFHEIV0
 15826     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15827     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15828     MOVE X'2020233030303134363730' TO DFHEIV0(25:11)
 15829     CALL 'kxdfhei1' USING DFHEIV0,
 15830           DFHEIV1,
 15831           CONTROL-FILE,
 15832           DFHEIV11,
 15833           DFHEIV99
 15834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15835
 15836
 15837
 15838* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 308
* EL156.cbl
 15839*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15840*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15841*    END-EXEC.
 15842*    MOVE '"$$%                  ! 7 #00014675' TO DFHEIV0
 15843     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15845     MOVE X'3720233030303134363735' TO DFHEIV0(25:11)
 15846     CALL 'kxdfhei1' USING DFHEIV0
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850
 15851* EXEC CICS GETMAIN
 15852*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15853*         LENGTH  (ELARCH-LENGTH)
 15854*         INITIMG (GETMAIN-SPACE)
 15855*    END-EXEC.
 15856*    MOVE ',"IL                  $   #00014680' TO DFHEIV0
 15857     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15858     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15859     MOVE X'2020233030303134363830' TO DFHEIV0(25:11)
 15860     CALL 'kxdfhei1' USING DFHEIV0,
 15861           DFHEIV20,
 15862           ELARCH-LENGTH,
 15863           GETMAIN-SPACE
 15864     SET ADDRESS OF LETTER-ARCHIVE TO
 15865         DFHEIV20
 15866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15867
 15868
 15869     MOVE 'LA'                   TO LA-RECORD-ID.
 15870     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15871                                    LA-ARCHIVE-NO-A1.
 15872     MOVE '4'                    TO LA-RECORD-TYPE
 15873                                    LA-RECORD-TYPE-A1.
 15874     MOVE +0                     TO LA-LINE-SEQ-NO
 15875                                    LA-LINE-SEQ-NO-A1.
 15876     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15877                                    LA-COMPANY-CD-A1.
 15878     MOVE CL-CARRIER             TO LA4-CARRIER.
 15879     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15880     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15881     MOVE CL-CERT-STATE          TO LA4-STATE.
 15882     MOVE +0                     TO LA4-NO-OF-COPIES.
 15883     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15884     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15885     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15886                                    LA4-INITIAL-PRINT-DATE
 15887                                    LA4-RESEND-PRINT-DATE
 15888                                    LA4-FORM-REM-PRINT-DT.
 15889     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15890     MOVE '2'                    TO LA4-FORM-TYPE.
 15891
 15892
 15893* EXEC CICS WRITE
 15894*         DATASET  ('ELARCH')
 15895*         FROM     (LETTER-ARCHIVE)
 15896*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 309
* EL156.cbl
 15897*    END-EXEC.
 15898     MOVE LENGTH OF
 15899      LETTER-ARCHIVE
 15900       TO DFHEIV11
 15901     MOVE 'ELARCH' TO DFHEIV1
 15902*    MOVE '&$ L                  ''   #00014709' TO DFHEIV0
 15903     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15904     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15905     MOVE X'2020233030303134373039' TO DFHEIV0(25:11)
 15906     CALL 'kxdfhei1' USING DFHEIV0,
 15907           DFHEIV1,
 15908           LETTER-ARCHIVE,
 15909           DFHEIV11,
 15910           LA-CONTROL-PRIMARY,
 15911           DFHEIV99,
 15912           DFHEIV99
 15913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15914
 15915
 15916 6999-EXIT.
 15917      EXIT.
 15918
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 310
* EL156.cbl
 15920 7000-SHOW-CLAIM.
 15921     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15922     MOVE 'A'                    TO PI-PASS-SW.
 15923     MOVE LOW-VALUES             TO PI-CPYFROM
 15924                                    PI-MONTH-END-SAVE
 15925                                    PI-CPYTHRU.
 15926
 15927     MOVE ZEROS                  TO PI-FATAL-COUNT
 15928                                    PI-DAILY-RATE
 15929                                    PI-BEN-DAYS
 15930                                    PI-MANUAL-SW
 15931                                    PI-SAVE-CURSOR
 15932                                    PI-FORCE-COUNT
 15933                                    PI-HOLDTIL
 15934                                    PI-EPYFROM
 15935                                    PI-EPYTHRU
 15936                                    PI-EDAYS
 15937                                    PI-EPYAMT
 15938                                    PI-ERESV
 15939                                    PI-EEXPENS
 15940                                    PI-CDAYS
 15941                                    PI-CPYAMT
 15942                                    PI-CRESV
 15943                                    PI-CEXPENS
 15944                                    PI-INT-RATE
 15945                                    PI-AIGFROM.
 15946     MOVE ZEROS                  TO PI-PROOF-DATE.
 15947     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15948                                    PI-REM-BEN-AMT
 15949                                    PI-MO-BEN-AMT.
 15950
 15951     MOVE LOW-VALUES             TO EL156AI.
 15952     MOVE MAP-NAMEA              TO MAP-NAME.
 15953
 15954
 15955
 15956* EXEC CICS HANDLE CONDITION
 15957*        NOTFND   (7010-BUILD-MAP)
 15958*    END-EXEC.
 15959*    MOVE '"$I                   ! 8 #00014754' TO DFHEIV0
 15960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15962     MOVE X'3820233030303134373534' TO DFHEIV0(25:11)
 15963     CALL 'kxdfhei1' USING DFHEIV0
 15964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15965
 15966
 15967     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15968     MOVE '2'                    TO CNTL-REC-TYPE.
 15969     MOVE +0                     TO CNTL-SEQ-NO.
 15970     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15971
 15972
 15973* EXEC CICS READ
 15974*         DATASET  ('ELCNTL')
 15975*         SET      (ADDRESS OF CONTROL-FILE)
 15976*         RIDFLD   (ELCNTL-KEY)
 15977*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 311
* EL156.cbl
 15978     MOVE 'ELCNTL' TO DFHEIV1
 15979*    MOVE '&"S        E          (   #00014763' TO DFHEIV0
 15980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15982     MOVE X'2020233030303134373633' TO DFHEIV0(25:11)
 15983     CALL 'kxdfhei1' USING DFHEIV0,
 15984           DFHEIV1,
 15985           DFHEIV20,
 15986           DFHEIV99,
 15987           ELCNTL-KEY,
 15988           DFHEIV99,
 15989           DFHEIV99,
 15990           DFHEIV99
 15991     SET ADDRESS OF CONTROL-FILE TO
 15992         DFHEIV20
 15993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15994
 15995
 15996     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 15997
 15998     IF PI-APPROVAL-LEVEL = '4'
 15999         MOVE AL-UANON      TO SURVYYNA
 16000     END-IF.
 16001
 16002
 16003 7010-BUILD-MAP.
 16004
 16005
 16006* EXEC CICS HANDLE CONDITION
 16007*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16008*    END-EXEC.
 16009*    MOVE '"$I                   ! 9 #00014778' TO DFHEIV0
 16010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16012     MOVE X'3920233030303134373738' TO DFHEIV0(25:11)
 16013     CALL 'kxdfhei1' USING DFHEIV0
 16014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16015
 16016
 16017     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16018     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16019     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16020     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16021     MOVE 'MSTR'                 TO FILE-SWITCH.
 16022
 16023     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16024
 16025     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16026     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16027     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16028     MOVE CL-CCN                 TO PI-SV-CCN.
 16029
 16030     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16031     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16032     MOVE CL-CLAIM-NO            TO CLMNOO.
 16033     MOVE CL-CARRIER             TO CARRO.
 16034     MOVE CL-CERT-PRIME          TO CERTNOO.
 16035     MOVE CL-CERT-SFX            TO SUFXO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 312
* EL156.cbl
 16036
 16037     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16038        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16039        CONTINUE
 16040     ELSE
 16041        MOVE AL-SADOF            TO ZINTHA
 16042                                    ZINTA
 16043                                    PINTHA
 16044                                    PINTA
 16045     END-IF
 16046     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16047     EVALUATE TRUE
 16048     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16049         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16050     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16051         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16052
 16053     WHEN CL-CLAIM-TYPE = 'I'
 16054         MOVE '  IU  '           TO CLMTYPO
 16055     WHEN CL-CLAIM-TYPE = 'G'
 16056         MOVE ' GAP  '           TO CLMTYPO
 16057     END-EVALUATE.
 16058     IF CLAIM-IS-OPEN
 16059         MOVE ' OPEN'            TO CLMSTATO
 16060     ELSE
 16061         MOVE 'CLOSED'           TO CLMSTATO.
 16062
 16063     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 16064
 16065     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16066         MOVE SPACES             TO  PCERTNOO
 16067                                     PSUFXO
 16068                                     PRIMHDGO
 16069                                     SEQUO
 16070         MOVE AL-SADOF           TO  PCERTNOA
 16071                                     PSUFXA
 16072                                     PRIMHDGA
 16073                                     SEQUA
 16074     ELSE
 16075         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16076         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 16077         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 16078         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 16079         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 16080         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 16081         MOVE AL-SANON               TO  PCERTNOA
 16082                                         PSUFXA
 16083                                         PRIMHDGA
 16084         MOVE AL-SABON               TO  SEQUA.
 16085
 16086     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 16087
 16088     IF CL-NO-OF-PMTS-MADE = 0 AND
 16089        CL-TOTAL-PAID-AMT = 0
 16090         NEXT SENTENCE
 16091     ELSE
 16092         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 16093             IF NOT PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 313
* EL156.cbl
 16094                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16095                 MOVE ' '                 TO DC-OPTION-CODE
 16096                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16097                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 16098             ELSE
 16099                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16100                 MOVE '6'                 TO DC-OPTION-CODE
 16101                 MOVE +1                  TO DC-ELAPSED-DAYS
 16102                 MOVE +0                  TO DC-ELAPSED-MONTHS
 16103                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16104                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 16105
 16106     IF MAP-NAME = 'EL156A'
 16107     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 16108        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16109          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 16110
 16111     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 16112         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 16113         MOVE ' '                TO DC-OPTION-CODE
 16114         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16115         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 16116
 16117     IF CL-INCURRED-DT NOT = LOW-VALUES
 16118         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 16119         MOVE ' '                TO DC-OPTION-CODE
 16120         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16121         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 16122
 16123     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 16124
 16125     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 16126         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 16127         MOVE ' '                TO DC-OPTION-CODE
 16128         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16129         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 16130
 16131     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16132         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 16133         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 16134     ELSE
 16135         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 16136         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 16137
 16138     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 16139     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 16140     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 16141     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 16142                                    PI-GROUPING.
 16143     MOVE CL-CERT-STATE          TO CERT-STATE
 16144                                    PI-STATE.
 16145     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 16146                                    PI-ACCOUNT.
 16147     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 16148     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 16149     MOVE 'CERT'                 TO FILE-SWITCH.
 16150
 16151     PERFORM 7970-READ-CERT THRU 7970-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 314
* EL156.cbl
 16152
 16153     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16154     MOVE PI-STATE               TO WS-ST-ACCESS.
 16155     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 16156     MOVE '3'                    TO CNTL-REC-TYPE.
 16157     MOVE +0                     TO CNTL-SEQ-NO.
 16158     MOVE 'STAT'                 TO FILE-SWITCH.
 16159
 16160     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16161
 16162     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 16163     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 16164
 16165     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16166        GO TO 7020-BYPASS-BENEFIT.
 16167
 16168     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16169     MOVE '4'                    TO CNTL-REC-TYPE.
 16170     MOVE +0                     TO CNTL-SEQ-NO.
 16171     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 16172     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16173     MOVE 'BENE'                 TO FILE-SWITCH.
 16174
 16175     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16176
 16177     IF NO-BENEFIT-FOUND
 16178        GO TO 7020-BYPASS-BENEFIT.
 16179
 16180     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 16181     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 16182     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 16183
 16184 7020-BYPASS-BENEFIT.
 16185
 16186*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16187*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 16188*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 16189
 16190     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 16191         GO TO 7021-GO-TO-LIFE.
 16192
 16193     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 16194     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 16195     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 16196     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16197     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 16198                                    CP-ORIGINAL-TERM.
 16199     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 16200
 16201*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16202*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16203*    ELSE
 16204         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16205
 16206     MOVE ' '                    TO DC-OPTION-CODE.
 16207     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16208     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16209
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 315
* EL156.cbl
 16210     IF PI-COMPANY-ID = 'DMD'
 16211         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 16212         GO TO 7023-BYPASS-REMAINING-TERM.
 16213
 16214     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16215     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 16216     GO TO 7022-AROUND-LIFE.
 16217
 16218 7021-GO-TO-LIFE.
 16219
 16220     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16221     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16222     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 16223                                    CP-ORIGINAL-TERM.
 16224     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 16225     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 16226     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 16227     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 16228
 16229     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16230         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16231     ELSE
 16232         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16233
 16234     MOVE ' '                    TO DC-OPTION-CODE.
 16235     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16236     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16237
 16238 7022-AROUND-LIFE.
 16239
 16240     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 16241     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16242     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 16243     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 16244     MOVE '4'                    TO CP-REM-TERM-METHOD.
 16245     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 16246     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 16247
 16248     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16249
 16250     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16251        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 16252           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 16253
 16254     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16255        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 16256           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 16257
 16258 7023-BYPASS-REMAINING-TERM.
 16259
 16260     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16261       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 16262          MOVE ZEROS                  TO BENEO
 16263       ELSE
 16264          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 16265          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 16266          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 16267          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 316
* EL156.cbl
 16268          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 16269          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 16270          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 16271          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 16272          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 16273          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 16274          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 16275          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 16276
 16277* EXEC CICS LINK
 16278*            PROGRAM  (LINK-REMAMT)
 16279*            COMMAREA (CALCULATION-PASS-AREA)
 16280*            LENGTH   (CP-COMM-LENGTH)
 16281*         END-EXEC
 16282*    MOVE '."C                   (   #00015041' TO DFHEIV0
 16283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16285     MOVE X'2020233030303135303431' TO DFHEIV0(25:11)
 16286     CALL 'kxdfhei1' USING DFHEIV0,
 16287           LINK-REMAMT,
 16288           CALCULATION-PASS-AREA,
 16289           CP-COMM-LENGTH,
 16290           DFHEIV99,
 16291           DFHEIV99,
 16292           DFHEIV99,
 16293           DFHEIV99
 16294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16295          MOVE CP-REMAINING-AMT       TO BENEO.
 16296
 16297     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16298         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16299            WS-LF-COVERAGE-TYPE = 'P'
 16300             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 16301                                        CM-LF-ITD-DEATH-AMT
 16302             MOVE WS-REMAINING-AMT  TO  BENEO.
 16303
 16304     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 16305     MOVE BENEO                  TO PI-REM-BEN-AMT.
 16306     MOVE WS-TERMS               TO TERMSO.
 16307
 16308     IF WS-STATUS = '6' OR '7' OR '8'
 16309         MOVE AL-SABOF           TO CRTSTATA.
 16310
 16311     IF WS-STATUS = '1' OR '4'
 16312        IF CP-REMAINING-TERM-3 = ZEROS
 16313           MOVE 'EXPIRED'        TO CRTSTATO
 16314        ELSE
 16315           MOVE 'ACTIVE  '       TO CRTSTATO.
 16316
 16317     IF WS-STATUS = '2'
 16318         MOVE 'PEND    '         TO CRTSTATO.
 16319
 16320     IF WS-STATUS = '3'
 16321         MOVE 'RESTORE '         TO CRTSTATO.
 16322
 16323     IF WS-STATUS = '5'
 16324         MOVE 'REISSUE '         TO CRTSTATO.
 16325
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 317
* EL156.cbl
 16326     IF WS-STATUS = '6'
 16327         MOVE 'LMP DIS'          TO CRTSTATO.
 16328
 16329     IF WS-STATUS = '7'
 16330         MOVE 'DEATH'            TO CRTSTATO.
 16331
 16332     IF WS-STATUS = '8'
 16333         MOVE 'CANCEL'           TO CRTSTATO.
 16334
 16335     IF WS-STATUS = '9'
 16336         MOVE 'RE-ONLY '         TO CRTSTATO.
 16337
 16338     IF WS-STATUS = 'V'
 16339         MOVE 'VOID  '           TO CRTSTATO.
 16340
 16341     IF WS-STATUS = 'D'
 16342         MOVE 'DECLINE '         TO CRTSTATO.
 16343
 16344     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16345         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16346         MOVE '5'                TO CNTL-REC-TYPE
 16347     ELSE
 16348         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16349         MOVE '4'                TO CNTL-REC-TYPE.
 16350
 16351     MOVE '** NONE **'           TO COVERO.
 16352     MOVE AL-SABON               TO COVERA.
 16353
 16354     IF PI-COMPANY-ID = 'CVL'
 16355         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16356             MOVE CM-BENEFICIARY TO LOANNOO
 16357             MOVE AL-UANON       TO LOANNOA.
 16358
 16359     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 16360        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16361        MOVE +91                 TO  TRLR-SEQ-NO
 16362
 16363* EXEC CICS READ
 16364*           DATASET  ('ELTRLR')
 16365*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16366*           RIDFLD   (ELTRLR-KEY)
 16367*           RESP     (WS-RESPONSE)
 16368*       END-EXEC
 16369     MOVE 'ELTRLR' TO DFHEIV1
 16370*    MOVE '&"S        E          (  N#00015113' TO DFHEIV0
 16371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16373     MOVE X'204E233030303135313133' TO DFHEIV0(25:11)
 16374     CALL 'kxdfhei1' USING DFHEIV0,
 16375           DFHEIV1,
 16376           DFHEIV20,
 16377           DFHEIV99,
 16378           ELTRLR-KEY,
 16379           DFHEIV99,
 16380           DFHEIV99,
 16381           DFHEIV99
 16382     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16383         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 318
* EL156.cbl
 16384     MOVE EIBRESP  TO WS-RESPONSE
 16385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16386
 16387        IF WS-RESP-NORMAL
 16388           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16389        ELSE
 16390           MOVE SPACES           TO  LOANNOO
 16391        END-IF
 16392*052506
 16393*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16394*052506
 16395     END-IF
 16396
 16397     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16398        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16399
 16400     IF WS-BEN-CD = ZEROS
 16401         GO TO 7050-SHOW-CONTINUE.
 16402
 16403     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16404     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16405     MOVE +0                     TO CNTL-SEQ-NO.
 16406     MOVE 'BENE'                 TO FILE-SWITCH.
 16407
 16408     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16409
 16410     IF BENEFIT-FOUND
 16411         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 16412         MOVE AL-SANON                    TO COVERA.
 16413
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 319
* EL156.cbl
 16415 7050-SHOW-CONTINUE.
 16416
 16417     IF PI-COMPANY-ID = 'DMD'
 16418         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16419
 16420     MOVE -1                     TO PMTTYPEL.
 16421     GO TO 8100-SEND-INITIAL-MAP.
 16422
 16423 7100-SHOW-RECORD-NOT-FOUND.
 16424     IF FILE-SWITCH = 'MSTR'
 16425         MOVE ER-0204            TO EMI-ERROR.
 16426
 16427     IF FILE-SWITCH = 'CERT'
 16428         MOVE ER-0206            TO EMI-ERROR.
 16429
 16430     IF FILE-SWITCH = 'STAT'
 16431         MOVE ER-0149            TO EMI-ERROR.
 16432
 16433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16434
 16435     MOVE -1                     TO PMTTYPEL.
 16436     GO TO 8100-SEND-INITIAL-MAP
 16437
 16438     .
 16439 7110-BUILD-PMT-TRLR.
 16440     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16441     MOVE +51                    TO TRLR-SEQ-NO
 16442
 16443* EXEC CICS READ
 16444*        DATASET  ('ELTRLR')
 16445*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16446*        RIDFLD   (ELTRLR-KEY)
 16447*        RESP     (WS-RESPONSE)
 16448*    END-EXEC
 16449     MOVE 'ELTRLR' TO DFHEIV1
 16450*    MOVE '&"S        E          (  N#00015175' TO DFHEIV0
 16451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16453     MOVE X'204E233030303135313735' TO DFHEIV0(25:11)
 16454     CALL 'kxdfhei1' USING DFHEIV0,
 16455           DFHEIV1,
 16456           DFHEIV20,
 16457           DFHEIV99,
 16458           ELTRLR-KEY,
 16459           DFHEIV99,
 16460           DFHEIV99,
 16461           DFHEIV99
 16462     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16463         DFHEIV20
 16464     MOVE EIBRESP  TO WS-RESPONSE
 16465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16466     IF WS-RESP-NORMAL
 16467        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16468     END-IF
 16469     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16470
 16471* EXEC CICS GETMAIN
 16472*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 320
* EL156.cbl
 16473*         LENGTH    (200)
 16474*         INITIMG   (GETMAIN-SPACE)
 16475*     END-EXEC
 16476     MOVE 200
 16477       TO DFHEIV11
 16478*    MOVE ',"IL                  $   #00015185' TO DFHEIV0
 16479     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16480     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16481     MOVE X'2020233030303135313835' TO DFHEIV0(25:11)
 16482     CALL 'kxdfhei1' USING DFHEIV0,
 16483           DFHEIV20,
 16484           DFHEIV11,
 16485           GETMAIN-SPACE
 16486     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16487         DFHEIV20
 16488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16489     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16490                                    AT-PREV-PAID-THRU-DT
 16491     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16492     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16493     MOVE 'AT'                   TO AT-RECORD-ID
 16494     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16495     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16496     MOVE '2'                    TO AT-TRAILER-TYPE
 16497     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16498                                    AT-PAYMENT-LAST-MAINT-DT
 16499     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16500                                    AT-PAYMENT-LAST-UPDATED-BY
 16501     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16502     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16503     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16504     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16505     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16506     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16507     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16508     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16509     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16510     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16511     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16512     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16513     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16514     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16515     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16516     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16517                                    AT-TO-BE-WRITTEN-DT
 16518     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16519                                    AT-CHECK-QUE-SEQUENCE
 16520                                    AT-ADDL-RESERVE
 16521     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16522                                    AT-VOID-SELECT-DT
 16523                                    AT-VOID-ACCEPT-DT
 16524                                    AT-VOID-DT
 16525                                    AT-PMT-PROOF-DT
 16526                                    AT-INT-PMT-SELECT-DT
 16527     MOVE ZEROS                  TO AT-DAILY-RATE
 16528                                    AT-ELIMINATION-DAYS
 16529     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16530*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 321
* EL156.cbl
 16531*        DUPREC    (7120-DUPREC)
 16532*    END-EXEC
 16533     .
 16534 7115-WRITE-INT-TRLR.
 16535
 16536* EXEC CICS WRITE
 16537*         DATASET       ('ELTRLR')
 16538*         FROM          (ACTIVITY-TRAILERS)
 16539*         RIDFLD        (AT-CONTROL-PRIMARY)
 16540*         RESP          (WS-RESPONSE)
 16541*     END-EXEC
 16542     MOVE LENGTH OF
 16543      ACTIVITY-TRAILERS
 16544       TO DFHEIV11
 16545     MOVE 'ELTRLR' TO DFHEIV1
 16546*    MOVE '&$ L                  ''  N#00015236' TO DFHEIV0
 16547     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16549     MOVE X'204E233030303135323336' TO DFHEIV0(25:11)
 16550     CALL 'kxdfhei1' USING DFHEIV0,
 16551           DFHEIV1,
 16552           ACTIVITY-TRAILERS,
 16553           DFHEIV11,
 16554           AT-CONTROL-PRIMARY,
 16555           DFHEIV99,
 16556           DFHEIV99
 16557     MOVE EIBRESP  TO WS-RESPONSE
 16558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16559      IF WS-RESP-DUPREC
 16560         GO TO 7120-DUPREC
 16561      END-IF
 16562     GO TO 7130-EXIT
 16563     .
 16564 7120-DUPREC.
 16565     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16566     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16567     GO TO 7115-WRITE-INT-TRLR
 16568     .
 16569 7130-EXIT.
 16570      EXIT.
 16571 7140-BUILD-NOTE-TRLR.
 16572
 16573
 16574* EXEC CICS GETMAIN
 16575*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16576*         LENGTH    (200)
 16577*         INITIMG   (GETMAIN-SPACE)
 16578*     END-EXEC
 16579     MOVE 200
 16580       TO DFHEIV11
 16581*    MOVE ',"IL                  $   #00015256' TO DFHEIV0
 16582     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16583     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16584     MOVE X'2020233030303135323536' TO DFHEIV0(25:11)
 16585     CALL 'kxdfhei1' USING DFHEIV0,
 16586           DFHEIV20,
 16587           DFHEIV11,
 16588           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 322
* EL156.cbl
 16589     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16590         DFHEIV20
 16591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16592     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16593     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16594     MOVE 'AT'                   TO AT-RECORD-ID
 16595     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16596     MOVE '6'                    TO AT-TRAILER-TYPE
 16597     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16598                                    AT-GEN-INFO-LAST-MAINT-DT
 16599     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16600                                    AT-GEN-INFO-LAST-UPDATED-BY
 16601     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16602     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16603     .
 16604 7150-WRITE.
 16605
 16606* EXEC CICS HANDLE CONDITION
 16607*        DUPREC    (7160-DUPREC)
 16608*    END-EXEC
 16609*    MOVE '"$%                   ! : #00015274' TO DFHEIV0
 16610     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16612     MOVE X'3A20233030303135323734' TO DFHEIV0(25:11)
 16613     CALL 'kxdfhei1' USING DFHEIV0
 16614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16615
 16616* EXEC CICS WRITE
 16617*         DATASET     ('ELTRLR')
 16618*         FROM        (ACTIVITY-TRAILERS)
 16619*         RIDFLD      (AT-CONTROL-PRIMARY)
 16620*         RESP        (WS-RESPONSE)
 16621*     END-EXEC
 16622     MOVE LENGTH OF
 16623      ACTIVITY-TRAILERS
 16624       TO DFHEIV11
 16625     MOVE 'ELTRLR' TO DFHEIV1
 16626*    MOVE '&$ L                  ''  N#00015277' TO DFHEIV0
 16627     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16629     MOVE X'204E233030303135323737' TO DFHEIV0(25:11)
 16630     CALL 'kxdfhei1' USING DFHEIV0,
 16631           DFHEIV1,
 16632           ACTIVITY-TRAILERS,
 16633           DFHEIV11,
 16634           AT-CONTROL-PRIMARY,
 16635           DFHEIV99,
 16636           DFHEIV99
 16637     MOVE EIBRESP  TO WS-RESPONSE
 16638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16639      IF WS-RESP-DUPREC
 16640         GO TO 7160-DUPREC
 16641      END-IF
 16642     GO TO 7170-EXIT
 16643     .
 16644 7160-DUPREC.
 16645     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16646     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 323
* EL156.cbl
 16647     GO TO 7150-WRITE
 16648     .
 16649 7170-EXIT.
 16650      EXIT.
 16651
 16652 7180-ADD-CERT-NOTE.
 16653*ADD CERT NOTE FOR SC NP+6
 16654
 16655
 16656* EXEC CICS GETMAIN
 16657*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16658*         LENGTH    (150)
 16659*         INITIMG   (GETMAIN-SPACE)
 16660*     END-EXEC.
 16661     MOVE 150
 16662       TO DFHEIV11
 16663*    MOVE ',"IL                  $   #00015299' TO DFHEIV0
 16664     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16666     MOVE X'2020233030303135323939' TO DFHEIV0(25:11)
 16667     CALL 'kxdfhei1' USING DFHEIV0,
 16668           DFHEIV20,
 16669           DFHEIV11,
 16670           GETMAIN-SPACE
 16671     SET ADDRESS OF CERT-NOTE-FILE TO
 16672         DFHEIV20
 16673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16674
 16675
 16676     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16677     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16678     MOVE +1                     TO WRK-NOTE-SEQ.
 16679     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16680     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16681     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16682     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16683     MOVE CL-CERT-STATE          TO CZ-STATE.
 16684     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16685     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16686     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16687     MOVE '2'                    TO CZ-RECORD-TYPE.
 16688     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16689     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16690     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16691     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16692     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16693     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16694     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16695     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16696     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16697
 16698 7181-WRITE.
 16699
 16700
 16701* EXEC CICS WRITE
 16702*         DATASET     ('ERCNOT')
 16703*         FROM        (CERT-NOTE-FILE)
 16704*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 324
* EL156.cbl
 16705*         RESP        (WS-RESPONSE)
 16706*    END-EXEC.
 16707     MOVE LENGTH OF
 16708      CERT-NOTE-FILE
 16709       TO DFHEIV11
 16710     MOVE 'ERCNOT' TO DFHEIV1
 16711*    MOVE '&$ L                  ''  N#00015329' TO DFHEIV0
 16712     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16714     MOVE X'204E233030303135333239' TO DFHEIV0(25:11)
 16715     CALL 'kxdfhei1' USING DFHEIV0,
 16716           DFHEIV1,
 16717           CERT-NOTE-FILE,
 16718           DFHEIV11,
 16719           CZ-CONTROL-PRIMARY,
 16720           DFHEIV99,
 16721           DFHEIV99
 16722     MOVE EIBRESP  TO WS-RESPONSE
 16723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16724
 16725
 16726     IF WS-RESP-DUPREC
 16727         GO TO 7182-DUPREC
 16728     END-IF.
 16729
 16730     SET CERT-NOTE-ADDED TO TRUE.
 16731
 16732     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16733         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16734     END-IF.
 16735
 16736     GO TO 7189-EXIT.
 16737
 16738 7182-DUPREC.
 16739
 16740     ADD +1                      TO  WRK-NOTE-SEQ.
 16741     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16742     GO TO 7181-WRITE.
 16743
 16744 7189-EXIT.
 16745      EXIT.
 16746
 16747 7190-ADD-ORIG-NOTE.
 16748
 16749
 16750* EXEC CICS GETMAIN
 16751*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16752*         LENGTH    (150)
 16753*         INITIMG   (GETMAIN-SPACE)
 16754*     END-EXEC.
 16755     MOVE 150
 16756       TO DFHEIV11
 16757*    MOVE ',"IL                  $   #00015359' TO DFHEIV0
 16758     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16760     MOVE X'2020233030303135333539' TO DFHEIV0(25:11)
 16761     CALL 'kxdfhei1' USING DFHEIV0,
 16762           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 325
* EL156.cbl
 16763           DFHEIV11,
 16764           GETMAIN-SPACE
 16765     SET ADDRESS OF CERT-NOTE-FILE TO
 16766         DFHEIV20
 16767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16768
 16769
 16770     ADD +1                      TO WRK-NOTE-SEQ.
 16771     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16772     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16773     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16774     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16775     MOVE CL-CERT-STATE          TO CZ-STATE.
 16776     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16777     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16778     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16779     MOVE '2'                    TO CZ-RECORD-TYPE.
 16780     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16781     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16782     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16783     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16784     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16785     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16786
 16787 7191-WRITE.
 16788
 16789
 16790* EXEC CICS WRITE
 16791*         DATASET     ('ERCNOT')
 16792*         FROM        (CERT-NOTE-FILE)
 16793*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16794*         RESP        (WS-RESPONSE)
 16795*    END-EXEC.
 16796     MOVE LENGTH OF
 16797      CERT-NOTE-FILE
 16798       TO DFHEIV11
 16799     MOVE 'ERCNOT' TO DFHEIV1
 16800*    MOVE '&$ L                  ''  N#00015384' TO DFHEIV0
 16801     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16803     MOVE X'204E233030303135333834' TO DFHEIV0(25:11)
 16804     CALL 'kxdfhei1' USING DFHEIV0,
 16805           DFHEIV1,
 16806           CERT-NOTE-FILE,
 16807           DFHEIV11,
 16808           CZ-CONTROL-PRIMARY,
 16809           DFHEIV99,
 16810           DFHEIV99
 16811     MOVE EIBRESP  TO WS-RESPONSE
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16813
 16814
 16815     IF WS-RESP-DUPREC
 16816         GO TO 7192-DUPREC
 16817     END-IF.
 16818
 16819     GO TO 7199-EXIT.
 16820
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 326
* EL156.cbl
 16821 7192-DUPREC.
 16822
 16823     ADD +1                      TO  WRK-NOTE-SEQ.
 16824     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16825     GO TO 7191-WRITE.
 16826
 16827 7199-EXIT.
 16828      EXIT.
 16829 7200-FIND-BENEFIT.
 16830     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16831
 16832
 16833* EXEC CICS HANDLE CONDITION
 16834*        ENDFILE(7200-EXIT)
 16835*        NOTFND(7200-EXIT)
 16836*    END-EXEC.
 16837*    MOVE '"$''I                  ! ; #00015408' TO DFHEIV0
 16838     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16840     MOVE X'3B20233030303135343038' TO DFHEIV0(25:11)
 16841     CALL 'kxdfhei1' USING DFHEIV0
 16842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16843
 16844
 16845
 16846* EXEC CICS READ
 16847*        DATASET('ELCNTL')
 16848*        SET(ADDRESS OF CONTROL-FILE)
 16849*        RIDFLD(ELCNTL-KEY)
 16850*        GTEQ
 16851*    END-EXEC.
 16852     MOVE 'ELCNTL' TO DFHEIV1
 16853*    MOVE '&"S        G          (   #00015413' TO DFHEIV0
 16854     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16856     MOVE X'2020233030303135343133' TO DFHEIV0(25:11)
 16857     CALL 'kxdfhei1' USING DFHEIV0,
 16858           DFHEIV1,
 16859           DFHEIV20,
 16860           DFHEIV99,
 16861           ELCNTL-KEY,
 16862           DFHEIV99,
 16863           DFHEIV99,
 16864           DFHEIV99
 16865     SET ADDRESS OF CONTROL-FILE TO
 16866         DFHEIV20
 16867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16868
 16869
 16870     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16871        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16872           GO TO 7200-EXIT.
 16873
 16874     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16875         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16876            ((SUB-1 > 8) OR
 16877            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16878
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 327
* EL156.cbl
 16879     IF SUB-1 NOT = 9
 16880         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16881
 16882     GO TO 7200-EXIT.
 16883
 16884 7200-BENEFIT-DUMMY.
 16885
 16886 7200-DUMMY-EXIT.
 16887     EXIT.
 16888
 16889 7200-EXIT.
 16890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 328
* EL156.cbl
 16892*052506
 16893*052506 7250-FIND-LETTER-TRLR.
 16894*052506     EXEC CICS HANDLE CONDITION
 16895*052506         ENDFILE  (7250-END)
 16896*052506         NOTFND   (7250-END)
 16897*052506     END-EXEC.
 16898*052506
 16899*052506     EXEC CICS STARTBR
 16900*052506         DATASET   ('ELTRLR')
 16901*052506         RIDFLD    (ELTRLR-KEY)
 16902*052506         GTEQ
 16903*052506     END-EXEC.
 16904*052506
 16905*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16906*052506
 16907*052506 7250-FIND-LOOP.
 16908*052506     EXEC CICS READNEXT
 16909*052506         DATASET   ('ELTRLR')
 16910*052506         RIDFLD    (ELTRLR-KEY)
 16911*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16912*052506     END-EXEC.
 16913*052506
 16914*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16915*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16916*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16917*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16918*052506        GO TO 7250-END
 16919*052506     END-IF.
 16920*052506
 16921*052506     IF AT-TRAILER-TYPE NOT = '4'
 16922*052506         GO TO 7250-FIND-LOOP
 16923*052506     END-IF.
 16924*052506
 16925*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16926*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16927*052506     END-IF.
 16928*052506
 16929*052506     GO TO 7250-FIND-LOOP.
 16930*052506
 16931*052506 7250-END.
 16932*052506
 16933*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16934*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16935*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16936*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16937*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16938*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 16939*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 16940*052506     END-IF.
 16941*052506
 16942*052506     EXEC CICS ENDBR
 16943*052506          DATASET    ('ELTRLR')
 16944*052506     END-EXEC.
 16945*052506
 16946*052506 7250-EXIT.
 16947*052506     EXIT.
 16948*052506     EJECT
 16949*052506
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 329
* EL156.cbl
 16950 7300-CHECK-AUTO-ACTIVITY.
 16951
 16952     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 16953         NEXT SENTENCE
 16954     ELSE
 16955         GO TO 7399-EXIT.
 16956
 16957     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 16958
 16959     IF WS-ACT-REC-FOUND-SW = 'N'
 16960         GO TO 7399-EXIT.
 16961
 16962     IF PI-ACTIVITY-CODE = 09
 16963         GO TO 7300-CONT-AUTO-ACTIVITY.
 16964
 16965     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 16966        (PI-ACTIVITY-CODE = 11)
 16967         GO TO 7300-CONT-AUTO-ACTIVITY.
 16968
 16969     IF PI-PROVISIONAL-IND = 'P'
 16970         IF PI-PMTTYPE = '1'
 16971             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 16972                 MOVE 'N'    TO  PI-RESET-SW
 16973                 GO TO 7399-EXIT.
 16974
 16975     IF PI-PMTTYPE = '1'
 16976         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 16977             MOVE 'N'        TO  PI-RESET-SW
 16978             GO TO 7399-EXIT.
 16979
 16980     IF PI-PMTTYPE = '2' OR '3'
 16981         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 16982             MOVE 'N'        TO  PI-RESET-SW
 16983             GO TO 7399-EXIT.
 16984
 16985     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16986         IF PI-PROVISIONAL-IND = 'P'
 16987             NEXT SENTENCE
 16988         ELSE
 16989             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 16990
 16991 7300-CONT-AUTO-ACTIVITY.
 16992
 16993     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16994         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 16995         MOVE '4'            TO DC-OPTION-CODE
 16996         MOVE +0             TO DC-ELAPSED-DAYS
 16997                                DC-ELAPSED-MONTHS
 16998         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16999         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 17000         IF PI-USES-PAID-TO
 17001             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17002             IF NO-CONVERSION-ERROR
 17003                 MOVE +1     TO DC-ELAPSED-DAYS
 17004                 MOVE +0     TO DC-ELAPSED-MONTHS
 17005                 MOVE '6'    TO DC-OPTION-CODE
 17006                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17007                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 330
* EL156.cbl
 17008                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17009
 17010     IF PI-PFKEY-USED = DFHPF5
 17011         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 17012         IF PI-USES-PAID-TO
 17013             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 17014             MOVE +1                  TO DC-ELAPSED-DAYS
 17015             MOVE +0                  TO DC-ELAPSED-MONTHS
 17016             MOVE '6'                 TO DC-OPTION-CODE
 17017             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17018             IF NO-CONVERSION-ERROR
 17019                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17020
 17021     IF WS-CHK-THRU-DT < PI-EXP-DT
 17022         NEXT SENTENCE
 17023     ELSE
 17024         MOVE 03                     TO  WS-ACTIVITY-CODE
 17025         GO TO 7390-PROCESS-ACTIVITY.
 17026
 17027     IF PI-PROV-PMT
 17028         MOVE 09                     TO  WS-ACTIVITY-CODE
 17029     ELSE
 17030        IF PI-PMTTYPE = '1'
 17031            MOVE 02                  TO  WS-ACTIVITY-CODE
 17032        ELSE
 17033        IF PI-PMTTYPE = '2' OR '3'
 17034            MOVE 07                  TO  WS-ACTIVITY-CODE
 17035        ELSE
 17036        IF PI-PMTTYPE = '4'
 17037            MOVE 00                  TO  WS-ACTIVITY-CODE
 17038        ELSE
 17039            MOVE 'N'                 TO  PI-RESET-SW
 17040            GO TO 7399-EXIT.
 17041
 17042 7390-PROCESS-ACTIVITY.
 17043
 17044     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 17045
 17046 7399-EXIT.
 17047     EXIT.
 17048
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 331
* EL156.cbl
 17050 7400-CHECK-AUTO-ACTIVITY.
 17051
 17052
 17053* EXEC CICS HANDLE CONDITION
 17054*        NOTFND   (7400-NOT-FOUND)
 17055*    END-EXEC.
 17056*    MOVE '"$I                   ! < #00015602' TO DFHEIV0
 17057     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17059     MOVE X'3C20233030303135363032' TO DFHEIV0(25:11)
 17060     CALL 'kxdfhei1' USING DFHEIV0
 17061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17062
 17063
 17064     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 17065     MOVE 'T'                    TO  CNTL-REC-TYPE.
 17066     MOVE SPACES                 TO  CNTL-ACCESS.
 17067     MOVE +0                     TO  CNTL-SEQ-NO.
 17068
 17069
 17070* EXEC CICS READ
 17071*        DATASET   ('ELCNTL')
 17072*        RIDFLD    (ELCNTL-KEY)
 17073*        SET       (ADDRESS OF CONTROL-FILE)
 17074*    END-EXEC.
 17075     MOVE 'ELCNTL' TO DFHEIV1
 17076*    MOVE '&"S        E          (   #00015611' TO DFHEIV0
 17077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303135363131' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           DFHEIV1,
 17082           DFHEIV20,
 17083           DFHEIV99,
 17084           ELCNTL-KEY,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99
 17088     SET ADDRESS OF CONTROL-FILE TO
 17089         DFHEIV20
 17090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17091
 17092
 17093     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 17094     GO TO 7400-EXIT.
 17095
 17096 7400-NOT-FOUND.
 17097     MOVE 'N'                        TO  PI-RESET-SW
 17098                                         WS-LETTER-SW
 17099                                         WS-ACT-REC-FOUND-SW.
 17100
 17101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17102
 17103 7400-EXIT.
 17104     EXIT.
 17105
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 332
* EL156.cbl
 17107 7450-FORMAT-AUTO-LETTER.
 17108
 17109     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 17110         MOVE 'Y'                    TO PI-RESET-SW
 17111         GO TO 7450-CONTINUE-PROCESS.
 17112
 17113     MOVE PI-ACTIVITY-CODE           TO  SUB.
 17114
 17115     IF SUB > 9
 17116         SUBTRACT 9 FROM SUB
 17117         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 17118     ELSE
 17119         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 17120
 17121 7450-CONTINUE-PROCESS.
 17122
 17123     IF WS-ACTIVITY-CODE = ZEROS
 17124         MOVE 'N'                    TO  WS-LETTER-SW
 17125         GO TO 7499-EXIT.
 17126
 17127     MOVE WS-ACTIVITY-CODE           TO  SUB.
 17128
 17129     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 17130         MOVE 'N'                    TO  PI-RESET-SW
 17131                                         WS-LETTER-SW
 17132         GO TO 7499-EXIT.
 17133
 17134     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 17135         MOVE 'N'                    TO  WS-LETTER-SW
 17136         GO TO 7499-EXIT.
 17137
 17138     MOVE 'Y'                        TO  WS-LETTER-SW.
 17139     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 17140     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 17141
 17142     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 17143
 17144     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 17145         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 17146         MOVE '6'                    TO  DC-OPTION-CODE
 17147         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 17148         MOVE +0                     TO  DC-ELAPSED-MONTHS
 17149         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17150         IF NO-CONVERSION-ERROR
 17151             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 17152         ELSE
 17153              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 17154
 17155     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 17156         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 17157         MOVE '6'                    TO  DC-OPTION-CODE
 17158         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 17159         MOVE +0                     TO  DC-ELAPSED-MONTHS
 17160         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17161         IF NO-CONVERSION-ERROR
 17162             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 17163         ELSE
 17164             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 333
* EL156.cbl
 17165
 17166 7499-EXIT.
 17167     EXIT.
 17168
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 334
* EL156.cbl
 17170 7500-RESET-AUTO-ACTIVITY.
 17171
 17172     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 17173     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 17174     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 17175     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 17176     MOVE +100                   TO  TRLR-SEQ-NO.
 17177
 17178 7500-STARTBR-TRLR.
 17179
 17180
 17181* EXEC CICS HANDLE CONDITION
 17182*        ENDFILE  (7590-END)
 17183*        NOTFND   (7590-END)
 17184*    END-EXEC.
 17185*    MOVE '"$''I                  ! = #00015704' TO DFHEIV0
 17186     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17188     MOVE X'3D20233030303135373034' TO DFHEIV0(25:11)
 17189     CALL 'kxdfhei1' USING DFHEIV0
 17190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17191
 17192
 17193
 17194* EXEC CICS STARTBR
 17195*        DATASET   ('ELTRLR')
 17196*        RIDFLD    (ELTRLR-KEY)
 17197*        GTEQ
 17198*    END-EXEC.
 17199     MOVE 'ELTRLR' TO DFHEIV1
 17200     MOVE 0
 17201       TO DFHEIV11
 17202*    MOVE '&,         G          &   #00015709' TO DFHEIV0
 17203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17205     MOVE X'2020233030303135373039' TO DFHEIV0(25:11)
 17206     CALL 'kxdfhei1' USING DFHEIV0,
 17207           DFHEIV1,
 17208           ELTRLR-KEY,
 17209           DFHEIV99,
 17210           DFHEIV11,
 17211           DFHEIV99
 17212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17213
 17214
 17215     MOVE 'Y'                        TO  WS-BROWSE-SW.
 17216
 17217 7500-READ-NEXT.
 17218
 17219
 17220* EXEC CICS READNEXT
 17221*        DATASET   ('ELTRLR')
 17222*        RIDFLD    (ELTRLR-KEY)
 17223*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17224*    END-EXEC.
 17225     MOVE 'ELTRLR' TO DFHEIV1
 17226     MOVE 0
 17227       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 335
* EL156.cbl
 17228*    MOVE '&.S                   )   #00015719' TO DFHEIV0
 17229     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17230     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17231     MOVE X'2020233030303135373139' TO DFHEIV0(25:11)
 17232     CALL 'kxdfhei1' USING DFHEIV0,
 17233           DFHEIV1,
 17234           DFHEIV20,
 17235           DFHEIV99,
 17236           ELTRLR-KEY,
 17237           DFHEIV99,
 17238           DFHEIV11,
 17239           DFHEIV99,
 17240           DFHEIV99
 17241     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17242         DFHEIV20
 17243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17244
 17245
 17246     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17247        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17248        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17249        PI-CERT-NO    NOT = TRLR-CERT-NO
 17250         GO TO 7590-END.
 17251
 17252     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 17253         GO TO 7500-READ-NEXT.
 17254
 17255     IF AT-TRAILER-TYPE NOT = '4'
 17256         GO TO 7500-READ-NEXT.
 17257
 17258     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 17259         GO TO 7500-READ-NEXT.
 17260
 17261     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 17262        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 17263         GO TO 7500-READ-NEXT.
 17264
 17265     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 17266        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 17267        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 17268         GO TO 7500-READ-NEXT.
 17269
 17270     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 17271                         AND
 17272        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 17273                         AND
 17274        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 17275            GO TO 7500-READ-NEXT.
 17276
 17277     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 17278
 17279
 17280* EXEC CICS ENDBR
 17281*        DATASET   ('ELTRLR')
 17282*    END-EXEC.
 17283     MOVE 'ELTRLR' TO DFHEIV1
 17284     MOVE 0
 17285       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 336
* EL156.cbl
 17286*    MOVE '&2                    $   #00015758' TO DFHEIV0
 17287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17289     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 17290     CALL 'kxdfhei1' USING DFHEIV0,
 17291           DFHEIV1,
 17292           DFHEIV11,
 17293           DFHEIV99
 17294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17295
 17296
 17297     MOVE 'N'                        TO  WS-BROWSE-SW.
 17298
 17299
 17300* EXEC CICS READ
 17301*        DATASET   ('ELTRLR')
 17302*        RIDFLD    (ELTRLR-KEY)
 17303*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17304*        UPDATE
 17305*    END-EXEC.
 17306     MOVE 'ELTRLR' TO DFHEIV1
 17307*    MOVE '&"S        EU         (   #00015764' TO DFHEIV0
 17308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17310     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 17311     CALL 'kxdfhei1' USING DFHEIV0,
 17312           DFHEIV1,
 17313           DFHEIV20,
 17314           DFHEIV99,
 17315           ELTRLR-KEY,
 17316           DFHEIV99,
 17317           DFHEIV99,
 17318           DFHEIV99
 17319     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17320         DFHEIV20
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324     MOVE 'Y'                        TO  WS-UPDATE-SW.
 17325
 17326     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 17327         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 17328     ELSE
 17329         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 17330             NEXT SENTENCE
 17331         ELSE
 17332             GO TO 7500-REWRITE-TRLR.
 17333
 17334     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 17335
 17336     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17337     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17338     MOVE '1'                        TO  ARCH-REC-TYPE.
 17339     MOVE +0                         TO  ARCH-SEQ.
 17340
 17341     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17342
 17343 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 337
* EL156.cbl
 17344
 17345
 17346* EXEC CICS REWRITE
 17347*        DATASET   ('ELTRLR')
 17348*        FROM      (ACTIVITY-TRAILERS)
 17349*    END-EXEC.
 17350     MOVE LENGTH OF
 17351      ACTIVITY-TRAILERS
 17352       TO DFHEIV11
 17353     MOVE 'ELTRLR' TO DFHEIV1
 17354*    MOVE '&& L                  %   #00015792' TO DFHEIV0
 17355     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17357     MOVE X'2020233030303135373932' TO DFHEIV0(25:11)
 17358     CALL 'kxdfhei1' USING DFHEIV0,
 17359           DFHEIV1,
 17360           ACTIVITY-TRAILERS,
 17361           DFHEIV11,
 17362           DFHEIV99
 17363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17364
 17365
 17366     GO TO 7500-STARTBR-TRLR.
 17367
 17368 7590-END.
 17369
 17370     IF WS-BROWSE-SW = 'Y'
 17371         MOVE 'N'                    TO  WS-BROWSE-SW
 17372
 17373* EXEC CICS ENDBR
 17374*            DATASET   ('ELTRLR')
 17375*        END-EXEC.
 17376     MOVE 'ELTRLR' TO DFHEIV1
 17377     MOVE 0
 17378       TO DFHEIV11
 17379*    MOVE '&2                    $   #00015803' TO DFHEIV0
 17380     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17381     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17382     MOVE X'2020233030303135383033' TO DFHEIV0(25:11)
 17383     CALL 'kxdfhei1' USING DFHEIV0,
 17384           DFHEIV1,
 17385           DFHEIV11,
 17386           DFHEIV99
 17387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17388
 17389
 17390 7599-EXIT.
 17391     EXIT.
 17392
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 338
* EL156.cbl
 17394 7600-READ-ARCH-UPDATE.
 17395
 17396
 17397* EXEC CICS HANDLE CONDITION
 17398*        NOTFND   (7699-EXIT)
 17399*    END-EXEC.
 17400*    MOVE '"$I                   ! > #00015813' TO DFHEIV0
 17401     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17403     MOVE X'3E20233030303135383133' TO DFHEIV0(25:11)
 17404     CALL 'kxdfhei1' USING DFHEIV0
 17405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17406
 17407
 17408
 17409* EXEC CICS READ
 17410*        DATASET   ('ELARCH')
 17411*        RIDFLD    (ELARCH-KEY)
 17412*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17413*        UPDATE
 17414*    END-EXEC.
 17415     MOVE 'ELARCH' TO DFHEIV1
 17416*    MOVE '&"S        EU         (   #00015817' TO DFHEIV0
 17417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17418     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17419     MOVE X'2020233030303135383137' TO DFHEIV0(25:11)
 17420     CALL 'kxdfhei1' USING DFHEIV0,
 17421           DFHEIV1,
 17422           DFHEIV20,
 17423           DFHEIV99,
 17424           ELARCH-KEY,
 17425           DFHEIV99,
 17426           DFHEIV99,
 17427           DFHEIV99
 17428     SET ADDRESS OF LETTER-ARCHIVE TO
 17429         DFHEIV20
 17430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17431
 17432
 17433     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17434
 17435
 17436* EXEC CICS REWRITE
 17437*        DATASET   ('ELARCH')
 17438*        FROM      (LETTER-ARCHIVE)
 17439*    END-EXEC.
 17440     MOVE LENGTH OF
 17441      LETTER-ARCHIVE
 17442       TO DFHEIV11
 17443     MOVE 'ELARCH' TO DFHEIV1
 17444*    MOVE '&& L                  %   #00015826' TO DFHEIV0
 17445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17447     MOVE X'2020233030303135383236' TO DFHEIV0(25:11)
 17448     CALL 'kxdfhei1' USING DFHEIV0,
 17449           DFHEIV1,
 17450           LETTER-ARCHIVE,
 17451           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 339
* EL156.cbl
 17452           DFHEIV99
 17453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17454
 17455
 17456 7699-EXIT.
 17457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 340
* EL156.cbl
 17459 7700-GET-DCT.
 17460
 17461     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17462     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17463     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17464     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17465                                    PI-MAX-BENEFIT-AMT
 17466                                    PI-MAX-BENEFIT-PYMT
 17467                                    PI-MIN-PAYMENT-AMT
 17468                                    PI-TIME-OF-LOSS-BAL.
 17469
 17470
 17471* EXEC CICS HANDLE CONDITION
 17472*         NOTFND (5300-NOTE-NOT-FOUND)
 17473*     END-EXEC.
 17474*    MOVE '"$I                   ! ? #00015845' TO DFHEIV0
 17475     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17477     MOVE X'3F20233030303135383435' TO DFHEIV0(25:11)
 17478     CALL 'kxdfhei1' USING DFHEIV0
 17479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17480
 17481
 17482
 17483* EXEC CICS READ
 17484*         DATASET('ERNOTE')
 17485*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17486*         RIDFLD (W-NOTE-KEY)
 17487*     END-EXEC.
 17488     MOVE 'ERNOTE' TO DFHEIV1
 17489*    MOVE '&"S        E          (   #00015849' TO DFHEIV0
 17490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17492     MOVE X'2020233030303135383439' TO DFHEIV0(25:11)
 17493     CALL 'kxdfhei1' USING DFHEIV0,
 17494           DFHEIV1,
 17495           DFHEIV20,
 17496           DFHEIV99,
 17497           W-NOTE-KEY,
 17498           DFHEIV99,
 17499           DFHEIV99,
 17500           DFHEIV99
 17501     SET ADDRESS OF CERTIFICATE-NOTE TO
 17502         DFHEIV20
 17503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17504
 17505
 17506     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17507     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17508     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17509     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17510     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17511
 17512     IF PI-PAYEE-TYPE NOT = 'B'
 17513         GO TO 7700-EXIT.
 17514
 17515     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17516     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 341
* EL156.cbl
 17517     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17518
 17519     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17520         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17521     ELSE
 17522         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17523
 17524     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17525     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17526     MOVE 'DLO006'               TO PGM-NAME.
 17527
 17528
 17529* EXEC CICS LINK
 17530*        PROGRAM    (PGM-NAME)
 17531*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17532*        LENGTH     (DCT-RCRD-LENGTH)
 17533*    END-EXEC.
 17534*    MOVE '."C                   (   #00015877' TO DFHEIV0
 17535     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17537     MOVE X'2020233030303135383737' TO DFHEIV0(25:11)
 17538     CALL 'kxdfhei1' USING DFHEIV0,
 17539           PGM-NAME,
 17540           DCT-COMMUNICATION-AREA,
 17541           DCT-RCRD-LENGTH,
 17542           DFHEIV99,
 17543           DFHEIV99,
 17544           DFHEIV99,
 17545           DFHEIV99
 17546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17547
 17548
 17549     IF DCT-RETURN-CODE = 'OK'
 17550         GO TO 7700-CONT.
 17551
 17552     IF DCT-RETURN-CODE = '01' OR '02'
 17553         GO TO 7700-SET-TO-YES.
 17554
 17555     IF DCT-RETURN-CODE = '03'
 17556
 17557* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17558*    MOVE '6"R                   !   #00015890' TO DFHEIV0
 17559     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17561     MOVE X'2020233030303135383930' TO DFHEIV0(25:11)
 17562     CALL 'kxdfhei1' USING DFHEIV0
 17563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17564         MOVE ER-0951            TO EMI-ERROR
 17565         MOVE -1                 TO PMTTYPEL
 17566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17567         GO TO 8200-SEND-DATAONLY.
 17568
 17569     IF DCT-RETURN-CODE = '04'
 17570
 17571* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17572*    MOVE '6"R                   !   #00015897' TO DFHEIV0
 17573     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 342
* EL156.cbl
 17575     MOVE X'2020233030303135383937' TO DFHEIV0(25:11)
 17576     CALL 'kxdfhei1' USING DFHEIV0
 17577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17578         MOVE ER-0946            TO EMI-ERROR
 17579         MOVE -1                 TO PMTTYPEL
 17580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17581         GO TO 8200-SEND-DATAONLY.
 17582
 17583     IF DCT-RETURN-CODE = '05'
 17584
 17585* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17586*    MOVE '6"R                   !   #00015904' TO DFHEIV0
 17587     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17589     MOVE X'2020233030303135393034' TO DFHEIV0(25:11)
 17590     CALL 'kxdfhei1' USING DFHEIV0
 17591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17592         MOVE ER-0947            TO EMI-ERROR
 17593         MOVE -1                 TO PMTTYPEL
 17594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17595         GO TO 8200-SEND-DATAONLY.
 17596
 17597     IF DCT-RETURN-CODE = '06'
 17598
 17599* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17600*    MOVE '6"R                   !   #00015911' TO DFHEIV0
 17601     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17603     MOVE X'2020233030303135393131' TO DFHEIV0(25:11)
 17604     CALL 'kxdfhei1' USING DFHEIV0
 17605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17606         MOVE ER-0921            TO EMI-ERROR
 17607         MOVE -1                 TO PMTTYPEL
 17608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17609         GO TO 8200-SEND-DATAONLY.
 17610
 17611     IF DCT-RETURN-CODE = '07'
 17612
 17613* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17614*    MOVE '6"R                   !   #00015918' TO DFHEIV0
 17615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17617     MOVE X'2020233030303135393138' TO DFHEIV0(25:11)
 17618     CALL 'kxdfhei1' USING DFHEIV0
 17619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17620         MOVE ER-0919            TO EMI-ERROR
 17621         MOVE -1                 TO PMTTYPEL
 17622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17623         GO TO 8200-SEND-DATAONLY.
 17624
 17625     IF DCT-RETURN-CODE = '08'
 17626
 17627* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17628*    MOVE '6"R                   !   #00015925' TO DFHEIV0
 17629     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17631     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 17632     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 343
* EL156.cbl
 17633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17634         MOVE ER-0948            TO EMI-ERROR
 17635         MOVE -1                 TO PMTTYPEL
 17636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17637         GO TO 8200-SEND-DATAONLY.
 17638
 17639     IF DCT-RETURN-CODE = 'N1'
 17640
 17641* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17642*    MOVE '6"R                   !   #00015932' TO DFHEIV0
 17643     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17645     MOVE X'2020233030303135393332' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0
 17647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17648         MOVE ER-0950            TO EMI-ERROR
 17649         MOVE -1                 TO PMTTYPEL
 17650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17651         GO TO 8200-SEND-DATAONLY.
 17652
 17653     IF DCT-RETURN-CODE = 'E1'
 17654
 17655* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17656*    MOVE '6"R                   !   #00015939' TO DFHEIV0
 17657     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17659     MOVE X'2020233030303135393339' TO DFHEIV0(25:11)
 17660     CALL 'kxdfhei1' USING DFHEIV0
 17661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17662         MOVE ER-0974            TO EMI-ERROR
 17663         MOVE -1                 TO PMTTYPEL
 17664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17665         GO TO 8200-SEND-DATAONLY.
 17666
 17667     IF DCT-RETURN-CODE = 'E2'
 17668
 17669* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17670*    MOVE '6"R                   !   #00015946' TO DFHEIV0
 17671     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17673     MOVE X'2020233030303135393436' TO DFHEIV0(25:11)
 17674     CALL 'kxdfhei1' USING DFHEIV0
 17675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17676         MOVE ER-0975            TO EMI-ERROR
 17677         MOVE -1                 TO PMTTYPEL
 17678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17679         GO TO 8200-SEND-DATAONLY.
 17680
 17681     IF DCT-RETURN-CODE NOT = 'OK'
 17682
 17683* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17684*    MOVE '6"R                   !   #00015953' TO DFHEIV0
 17685     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17687     MOVE X'2020233030303135393533' TO DFHEIV0(25:11)
 17688     CALL 'kxdfhei1' USING DFHEIV0
 17689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17690         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 344
* EL156.cbl
 17691         MOVE -1                 TO PMTTYPEL
 17692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17693         GO TO 8200-SEND-DATAONLY.
 17694
 17695 7700-CONT.
 17696
 17697*07839      MOVE 'N'                    TO CASHO.
 17698*07840      MOVE +1                     TO CASHL.
 17699*07841      MOVE AL-UANON               TO CASHA.
 17700
 17701     IF PI-OFFLINE = 'Y'
 17702         GO TO 7700-EXIT.
 17703
 17704     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17705     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17706     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17707     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17708     MOVE +7                     TO CHECKNOL.
 17709     MOVE AL-UANON               TO CHECKNOA.
 17710     GO TO 7700-EXIT.
 17711
 17712 7700-SET-TO-YES.
 17713
 17714*07856      MOVE 'Y'                    TO CASHO.
 17715*07857      MOVE +1                     TO CASHL.
 17716*07858      MOVE AL-UANON               TO CASHA.
 17717
 17718 7700-EXIT.
 17719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 345
* EL156.cbl
 17721 7800-READ-COMP-MSTR.
 17722
 17723
 17724* EXEC CICS HANDLE CONDITION
 17725*        NOTFND   (7800-COMP-NOTFND)
 17726*    END-EXEC.
 17727*    MOVE '"$I                   ! @ #00015987' TO DFHEIV0
 17728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17730     MOVE X'4020233030303135393837' TO DFHEIV0(25:11)
 17731     CALL 'kxdfhei1' USING DFHEIV0
 17732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17733
 17734
 17735
 17736* EXEC CICS READ
 17737*        DATASET   ('ERCOMP')
 17738*        RIDFLD    (ERCOMP-KEY)
 17739*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17740*    END-EXEC.
 17741     MOVE 'ERCOMP' TO DFHEIV1
 17742*    MOVE '&"S        E          (   #00015991' TO DFHEIV0
 17743     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17745     MOVE X'2020233030303135393931' TO DFHEIV0(25:11)
 17746     CALL 'kxdfhei1' USING DFHEIV0,
 17747           DFHEIV1,
 17748           DFHEIV20,
 17749           DFHEIV99,
 17750           ERCOMP-KEY,
 17751           DFHEIV99,
 17752           DFHEIV99,
 17753           DFHEIV99
 17754     SET ADDRESS OF COMPENSATION-MASTER TO
 17755         DFHEIV20
 17756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17757
 17758
 17759     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17760     GO TO 7800-COMP-EXIT.
 17761
 17762 7800-COMP-NOTFND.
 17763     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17764
 17765 7800-COMP-EXIT.
 17766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 346
* EL156.cbl
 17768 7900-READ-CLAIM.
 17769
 17770* EXEC CICS READ
 17771*        DATASET  ('ELMSTR')
 17772*        SET      (ADDRESS OF CLAIM-MASTER)
 17773*        RIDFLD   (ELMSTR-KEY)
 17774*    END-EXEC.
 17775     MOVE 'ELMSTR' TO DFHEIV1
 17776*    MOVE '&"S        E          (   #00016007' TO DFHEIV0
 17777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17779     MOVE X'2020233030303136303037' TO DFHEIV0(25:11)
 17780     CALL 'kxdfhei1' USING DFHEIV0,
 17781           DFHEIV1,
 17782           DFHEIV20,
 17783           DFHEIV99,
 17784           ELMSTR-KEY,
 17785           DFHEIV99,
 17786           DFHEIV99,
 17787           DFHEIV99
 17788     SET ADDRESS OF CLAIM-MASTER TO
 17789         DFHEIV20
 17790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17791
 17792
 17793 7900-EXIT.
 17794      EXIT.
 17795
 17796 7910-READ-CLAIM-UPDATE.
 17797
 17798* EXEC CICS READ
 17799*        DATASET  ('ELMSTR')
 17800*        SET      (ADDRESS OF CLAIM-MASTER)
 17801*        RIDFLD   (ELMSTR-KEY)
 17802*        UPDATE
 17803*    END-EXEC.
 17804     MOVE 'ELMSTR' TO DFHEIV1
 17805*    MOVE '&"S        EU         (   #00016017' TO DFHEIV0
 17806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17807     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17808     MOVE X'2020233030303136303137' TO DFHEIV0(25:11)
 17809     CALL 'kxdfhei1' USING DFHEIV0,
 17810           DFHEIV1,
 17811           DFHEIV20,
 17812           DFHEIV99,
 17813           ELMSTR-KEY,
 17814           DFHEIV99,
 17815           DFHEIV99,
 17816           DFHEIV99
 17817     SET ADDRESS OF CLAIM-MASTER TO
 17818         DFHEIV20
 17819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17820
 17821
 17822 7910-EXIT.
 17823      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 347
* EL156.cbl
 17825 7920-READ-BENE.
 17826     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17827     MOVE 'B'                TO BENE-RECORD-TYPE.
 17828     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17829
 17830     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17831        IF PI-PAYEE-TYPE    = 'B' AND
 17832           PI-PAYEE-SEQ-NUM = 9
 17833             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17834             MOVE WS-A-BENE           TO BENE-NUMBER.
 17835
 17836
 17837* EXEC CICS HANDLE CONDITION
 17838*        NOTFND   (7920-NOT-FOUND)
 17839*    END-EXEC.
 17840*    MOVE '"$I                   ! A #00016038' TO DFHEIV0
 17841     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17843     MOVE X'4120233030303136303338' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17846
 17847
 17848
 17849* EXEC CICS READ
 17850*        DATASET  ('ELBENE')
 17851*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17852*        RIDFLD   (ELBENE-KEY)
 17853*    END-EXEC.
 17854     MOVE 'ELBENE' TO DFHEIV1
 17855*    MOVE '&"S        E          (   #00016042' TO DFHEIV0
 17856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17858     MOVE X'2020233030303136303432' TO DFHEIV0(25:11)
 17859     CALL 'kxdfhei1' USING DFHEIV0,
 17860           DFHEIV1,
 17861           DFHEIV20,
 17862           DFHEIV99,
 17863           ELBENE-KEY,
 17864           DFHEIV99,
 17865           DFHEIV99,
 17866           DFHEIV99
 17867     SET ADDRESS OF BENEFICIARY-MASTER TO
 17868         DFHEIV20
 17869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17870
 17871
 17872     MOVE 'Y' TO BENE-FOUND-SW.
 17873     GO TO 7920-EXIT.
 17874
 17875 7920-NOT-FOUND.
 17876     MOVE 'N'                    TO BENE-FOUND-SW.
 17877
 17878 7920-EXIT.
 17879      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 348
* EL156.cbl
 17881 7930-READ-CONTROL.
 17882
 17883* EXEC CICS READ
 17884*        DATASET  ('ELCNTL')
 17885*        SET      (ADDRESS OF CONTROL-FILE)
 17886*        RIDFLD   (ELCNTL-KEY)
 17887*    END-EXEC.
 17888     MOVE 'ELCNTL' TO DFHEIV1
 17889*    MOVE '&"S        E          (   #00016058' TO DFHEIV0
 17890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17892     MOVE X'2020233030303136303538' TO DFHEIV0(25:11)
 17893     CALL 'kxdfhei1' USING DFHEIV0,
 17894           DFHEIV1,
 17895           DFHEIV20,
 17896           DFHEIV99,
 17897           ELCNTL-KEY,
 17898           DFHEIV99,
 17899           DFHEIV99,
 17900           DFHEIV99
 17901     SET ADDRESS OF CONTROL-FILE TO
 17902         DFHEIV20
 17903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17904
 17905
 17906 7930-EXIT.
 17907      EXIT.
 17908
 17909 7940-READ-CONTROL-UPDATE.
 17910
 17911* EXEC CICS READ
 17912*        DATASET  ('ELCNTL')
 17913*        SET      (ADDRESS OF CONTROL-FILE)
 17914*        RIDFLD   (ELCNTL-KEY)
 17915*        UPDATE
 17916*    END-EXEC.
 17917     MOVE 'ELCNTL' TO DFHEIV1
 17918*    MOVE '&"S        EU         (   #00016068' TO DFHEIV0
 17919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17921     MOVE X'2020233030303136303638' TO DFHEIV0(25:11)
 17922     CALL 'kxdfhei1' USING DFHEIV0,
 17923           DFHEIV1,
 17924           DFHEIV20,
 17925           DFHEIV99,
 17926           ELCNTL-KEY,
 17927           DFHEIV99,
 17928           DFHEIV99,
 17929           DFHEIV99
 17930     SET ADDRESS OF CONTROL-FILE TO
 17931         DFHEIV20
 17932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17933
 17934
 17935 7940-EXIT.
 17936      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 349
* EL156.cbl
 17938 7950-READ-TRAILER.
 17939
 17940* EXEC CICS READ
 17941*        DATASET  ('ELTRLR')
 17942*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17943*        RIDFLD   (ELTRLR-KEY)
 17944*    END-EXEC.
 17945     MOVE 'ELTRLR' TO DFHEIV1
 17946*    MOVE '&"S        E          (   #00016079' TO DFHEIV0
 17947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17949     MOVE X'2020233030303136303739' TO DFHEIV0(25:11)
 17950     CALL 'kxdfhei1' USING DFHEIV0,
 17951           DFHEIV1,
 17952           DFHEIV20,
 17953           DFHEIV99,
 17954           ELTRLR-KEY,
 17955           DFHEIV99,
 17956           DFHEIV99,
 17957           DFHEIV99
 17958     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17959         DFHEIV20
 17960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17961
 17962
 17963 7950-EXIT.
 17964      EXIT.
 17965
 17966 7960-READ-TRAILER-UPDATE.
 17967
 17968* EXEC CICS READ
 17969*        DATASET  ('ELTRLR')
 17970*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17971*        RIDFLD   (ELTRLR-KEY)
 17972*        UPDATE
 17973*    END-EXEC.
 17974     MOVE 'ELTRLR' TO DFHEIV1
 17975*    MOVE '&"S        EU         (   #00016089' TO DFHEIV0
 17976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17978     MOVE X'2020233030303136303839' TO DFHEIV0(25:11)
 17979     CALL 'kxdfhei1' USING DFHEIV0,
 17980           DFHEIV1,
 17981           DFHEIV20,
 17982           DFHEIV99,
 17983           ELTRLR-KEY,
 17984           DFHEIV99,
 17985           DFHEIV99,
 17986           DFHEIV99
 17987     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17988         DFHEIV20
 17989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17990
 17991
 17992 7960-EXIT.
 17993      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 350
* EL156.cbl
 17995 7970-READ-CERT.
 17996
 17997* EXEC CICS READ
 17998*        DATASET  ('ELCERT')
 17999*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18000*        RIDFLD   (ELCERT-KEY)
 18001*    END-EXEC.
 18002     MOVE 'ELCERT' TO DFHEIV1
 18003*    MOVE '&"S        E          (   #00016100' TO DFHEIV0
 18004     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18006     MOVE X'2020233030303136313030' TO DFHEIV0(25:11)
 18007     CALL 'kxdfhei1' USING DFHEIV0,
 18008           DFHEIV1,
 18009           DFHEIV20,
 18010           DFHEIV99,
 18011           ELCERT-KEY,
 18012           DFHEIV99,
 18013           DFHEIV99,
 18014           DFHEIV99
 18015     SET ADDRESS OF CERTIFICATE-MASTER TO
 18016         DFHEIV20
 18017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18018
 18019
 18020 7970-EXIT.
 18021      EXIT.
 18022
 18023 7980-READ-CERT-UPDATE.
 18024
 18025* EXEC CICS READ
 18026*        DATASET  ('ELCERT')
 18027*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18028*        RIDFLD   (ELCERT-KEY)
 18029*        UPDATE
 18030*    END-EXEC.
 18031     MOVE 'ELCERT' TO DFHEIV1
 18032*    MOVE '&"S        EU         (   #00016110' TO DFHEIV0
 18033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18035     MOVE X'2020233030303136313130' TO DFHEIV0(25:11)
 18036     CALL 'kxdfhei1' USING DFHEIV0,
 18037           DFHEIV1,
 18038           DFHEIV20,
 18039           DFHEIV99,
 18040           ELCERT-KEY,
 18041           DFHEIV99,
 18042           DFHEIV99,
 18043           DFHEIV99
 18044     SET ADDRESS OF CERTIFICATE-MASTER TO
 18045         DFHEIV20
 18046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18047
 18048
 18049 7980-EXIT.
 18050      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 351
* EL156.cbl
 18052 8000-LOAD-ERROR-MESSAGES.
 18053     IF PI-PASS-SW = 'C'
 18054        MOVE EMI-LINE1           TO ERMSG1BO
 18055     ELSE
 18056        MOVE EMI-LINE1           TO ERRMSG1O
 18057        MOVE EMI-LINE2           TO ERRMSG2O.
 18058
 18059 8000-EXIT.
 18060     EXIT.
 18061
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 352
* EL156.cbl
 18063
 18064 8010-DMD-ERROR-CHECKS.
 18065     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 18066
 18067     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 18068         GO TO 8051-ISSUE-ERROR.
 18069
 18070     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 18071     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 18072     MOVE '3'                    TO DC-OPTION-CODE.
 18073     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18074     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 18075         GO TO 8051-ISSUE-ERROR.
 18076
 18077     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 18078       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 18079                           OR
 18080          (CL-SSN-STATE   = CL-CERT-STATE  AND
 18081           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 18082             MOVE ER-0851         TO EMI-ERROR
 18083             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18084       END-IF
 18085       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 18086             MOVE ER-8147         TO EMI-ERROR
 18087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18088
 18089     GO TO 8090-EXIT.
 18090
 18091 8051-ISSUE-ERROR.
 18092     MOVE ER-8146            TO EMI-ERROR.
 18093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18094     GO TO 8090-EXIT.
 18095
 18096 8090-EXIT.
 18097      EXIT.
 18098
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 353
* EL156.cbl
 18100 8100-SEND-INITIAL-MAP.
 18101
 18102     MOVE SAVE-DATE              TO RUNDTEAO.
 18103     MOVE EIBTIME                TO TIME-IN.
 18104     MOVE TIME-OUT               TO RUNTIMAO.
 18105     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18106
 18107     IF MAP-NAME = 'EL156A'
 18108        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18109           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18110        END-IF
 18111     END-IF
 18112*08059      IF MAP-NAME = 'EL156A'
 18113*08060         IF PI-COMPANY-ID = 'CRI'
 18114*08061            NEXT SENTENCE
 18115*08062         ELSE
 18116*08063            MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 18117
 18118     IF MAP-NAME = 'EL156A'
 18119        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 18120           NEXT SENTENCE
 18121        ELSE
 18122           MOVE AL-SADOF TO  PINTA    PINTHA.
 18123
 18124     IF MAP-NAME = 'EL156A'
 18125        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18126            NEXT SENTENCE
 18127        ELSE
 18128           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 18129
 18130*08077      IF MAP-NAME = 'EL156A'
 18131*08078         IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 18132*08079            NEXT SENTENCE
 18133*08080         ELSE
 18134*08081            MOVE AL-SADOF TO CASHHA CASHA.
 18135
 18136     IF MAP-NAME = 'EL156A'
 18137        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 18138           NEXT SENTENCE
 18139        ELSE
 18140           MOVE AL-SADOF        TO  LOANHA
 18141                                    LOANNOA.
 18142
 18143     IF MAP-NAME = 'EL156A'
 18144        MOVE -1                 TO  ENTERPFL
 18145        IF PI-USES-PAID-TO
 18146           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18147           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18148           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18149        ELSE
 18150           NEXT SENTENCE
 18151     ELSE
 18152        IF MAP-NAME = 'EL156B'
 18153           IF PI-USES-PAID-TO
 18154              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18155              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18156
 18157
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 354
* EL156.cbl
 18158* EXEC CICS SEND
 18159*        MAP   (MAP-NAME)
 18160*        MAPSET(MAPSET-NAME)
 18161*        FROM  (EL156AI)
 18162*        ERASE
 18163*        CURSOR
 18164*    END-EXEC.
 18165     MOVE LENGTH OF
 18166      EL156AI
 18167       TO DFHEIV12
 18168     MOVE -1
 18169       TO DFHEIV11
 18170*    MOVE '8$     CT  E    H L F ,   #00016225' TO DFHEIV0
 18171     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 18172     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18173     MOVE X'2020233030303136323235' TO DFHEIV0(25:11)
 18174     CALL 'kxdfhei1' USING DFHEIV0,
 18175           MAP-NAME,
 18176           EL156AI,
 18177           DFHEIV12,
 18178           MAPSET-NAME,
 18179           DFHEIV99,
 18180           DFHEIV99,
 18181           DFHEIV99,
 18182           DFHEIV11,
 18183           DFHEIV99,
 18184           DFHEIV99,
 18185           DFHEIV99
 18186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18187
 18188
 18189     GO TO 9100-RETURN-TRAN.
 18190
 18191 8200-SEND-DATAONLY.
 18192
 18193     IF FIRST-ENTRY = 'Y'
 18194         GO TO 8100-SEND-INITIAL-MAP.
 18195
 18196     IF RETURNED-FROM-B = 'Y'
 18197         GO TO 8100-SEND-INITIAL-MAP.
 18198
 18199     MOVE SAVE-DATE              TO RUNDTEAO.
 18200     MOVE EIBTIME                TO TIME-IN.
 18201     MOVE TIME-OUT               TO RUNTIMAO.
 18202
 18203     IF EIBAID = DFHPF11
 18204        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 18205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18206        MOVE 'EL001   '          TO RETURNED-FROM
 18207        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 18208        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 18209        GO TO 8100-SEND-INITIAL-MAP.
 18210
 18211     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18212
 18213     IF MAP-NAME =  'EL156A'
 18214        MOVE -1                 TO  ENTERPFL
 18215        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 355
* EL156.cbl
 18216           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18217           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18218           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18219        ELSE
 18220           NEXT SENTENCE
 18221     ELSE
 18222        IF MAP-NAME = 'EL156B'
 18223           IF PI-USES-PAID-TO
 18224              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18225              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18226
 18227     IF MAP-NAME =  'EL156A'
 18228        IF PI-COMPANY-ID = 'BOA'
 18229            IF PI-INT-RATE NUMERIC
 18230                MOVE PI-INT-RATE TO PINTO.
 18231     IF MAP-NAME = 'EL156A'
 18232        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18233           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18234*          MOVE 'Y'              TO EOBYNO
 18235        END-IF
 18236     END-IF
 18237
 18238
 18239* EXEC CICS SEND
 18240*        MAP   (MAP-NAME)
 18241*        MAPSET(MAPSET-NAME)
 18242*        FROM  (EL156AI)
 18243*        DATAONLY
 18244*        CURSOR
 18245*    END-EXEC.
 18246     MOVE LENGTH OF
 18247      EL156AI
 18248       TO DFHEIV12
 18249     MOVE -1
 18250       TO DFHEIV11
 18251*    MOVE '8$D    CT       H L F ,   #00016282' TO DFHEIV0
 18252     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 18253     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18254     MOVE X'2020233030303136323832' TO DFHEIV0(25:11)
 18255     CALL 'kxdfhei1' USING DFHEIV0,
 18256           MAP-NAME,
 18257           EL156AI,
 18258           DFHEIV12,
 18259           MAPSET-NAME,
 18260           DFHEIV99,
 18261           DFHEIV99,
 18262           DFHEIV99,
 18263           DFHEIV11,
 18264           DFHEIV99,
 18265           DFHEIV99,
 18266           DFHEIV99
 18267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18268
 18269
 18270     GO TO 9100-RETURN-TRAN.
 18271
 18272 8300-SEND-TEXT.
 18273
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 356
* EL156.cbl
 18274* EXEC CICS SEND TEXT
 18275*        FROM(LOGOFF-TEXT)
 18276*        LENGTH(LOGOFF-LENGTH)
 18277*        ERASE
 18278*        FREEKB
 18279*    END-EXEC.
 18280*    MOVE '8&      T  E F  H   F -   #00016293' TO DFHEIV0
 18281     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 18282     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 18283     MOVE X'2020233030303136323933' TO DFHEIV0(25:11)
 18284     CALL 'kxdfhei1' USING DFHEIV0,
 18285           LOGOFF-TEXT,
 18286           LOGOFF-LENGTH,
 18287           DFHEIV99,
 18288           DFHEIV99,
 18289           DFHEIV99,
 18290           DFHEIV99,
 18291           DFHEIV99,
 18292           DFHEIV99,
 18293           DFHEIV99,
 18294           DFHEIV99,
 18295           DFHEIV99,
 18296           DFHEIV99
 18297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18298
 18299
 18300
 18301* EXEC CICS RETURN
 18302*    END-EXEC.
 18303*    MOVE '.(                    ''   #00016300' TO DFHEIV0
 18304     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 18305     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18306     MOVE X'2020233030303136333030' TO DFHEIV0(25:11)
 18307     CALL 'kxdfhei1' USING DFHEIV0,
 18308           DFHEIV99,
 18309           DFHEIV99,
 18310           DFHEIV99,
 18311           DFHEIV99,
 18312           DFHEIV99,
 18313           DFHEIV99
 18314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18315
 18316
 18317 8500-FILE-NOTOPEN.
 18318     IF FILE-SWITCH = 'MSTR'
 18319         MOVE ER-0154            TO EMI-ERROR.
 18320     IF FILE-SWITCH = 'TRLR'
 18321         MOVE ER-0172            TO EMI-ERROR.
 18322     IF FILE-SWITCH = 'CERT'
 18323         MOVE ER-0169            TO EMI-ERROR.
 18324     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 18325                      'PROC' OR 'STAT'
 18326         MOVE ER-0042            TO EMI-ERROR.
 18327     IF FILE-SWITCH = 'ACTQ'
 18328         MOVE ER-0338            TO EMI-ERROR.
 18329     IF FILE-SWITCH = 'ACCT'
 18330         MOVE ER-0168            TO EMI-ERROR.
 18331
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 357
* EL156.cbl
 18332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18333     MOVE -1                     TO PMTTYPEL.
 18334
 18335     IF FIRST-ENTRY = 'Y'
 18336         GO TO 8100-SEND-INITIAL-MAP.
 18337
 18338     GO TO 8200-SEND-DATAONLY.
 18339
 18340 8600-PGRM-NOT-FOUND.
 18341
 18342     MOVE ER-0923                TO EMI-ERROR.
 18343     MOVE -1                     TO ENTPFBL.
 18344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18345
 18346     IF FIRST-ENTRY = 'Y'
 18347         GO TO 8100-SEND-INITIAL-MAP
 18348     ELSE
 18349         GO TO 8200-SEND-DATAONLY.
 18350
 18351 8800-UNAUTHORIZED-ACCESS.
 18352     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18353     GO TO 8300-SEND-TEXT.
 18354
 18355 8810-PF23.
 18356     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18357     MOVE XCTL-005               TO PGM-NAME.
 18358     GO TO 9300-XCTL.
 18359
 18360 8820-PF7-8.
 18361     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18362     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18363                                    PI-SAVED-PROGRAM-2
 18364                                    PI-SAVED-PROGRAM-3
 18365                                    PI-SAVED-PROGRAM-4
 18366                                    PI-SAVED-PROGRAM-5
 18367                                    PI-SAVED-PROGRAM-6
 18368                                    PI-RETURN-TO-PROGRAM.
 18369     IF EIBAID = DFHPF8
 18370        MOVE XCTL-132            TO PGM-NAME
 18371     ELSE
 18372        MOVE XCTL-130            TO PGM-NAME.
 18373
 18374     GO TO 9300-XCTL.
 18375
 18376 9100-RETURN-TRAN.
 18377     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18378     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18379
 18380
 18381* EXEC CICS RETURN
 18382*        TRANSID(TRANS-ID)
 18383*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18384*        LENGTH(PI-COMM-LENGTH)
 18385*    END-EXEC.
 18386*    MOVE '.(CT                  ''   #00016366' TO DFHEIV0
 18387     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18389     MOVE X'2020233030303136333636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 358
* EL156.cbl
 18390     CALL 'kxdfhei1' USING DFHEIV0,
 18391           TRANS-ID,
 18392           PROGRAM-INTERFACE-BLOCK,
 18393           PI-COMM-LENGTH,
 18394           DFHEIV99,
 18395           DFHEIV99,
 18396           DFHEIV99
 18397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18398
 18399
 18400 9200-RETURN-MAIN-MENU.
 18401     MOVE XCTL-126               TO PGM-NAME.
 18402     GO TO 9300-XCTL.
 18403
 18404 9300-XCTL.
 18405
 18406* EXEC CICS XCTL
 18407*        PROGRAM(PGM-NAME)
 18408*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18409*        LENGTH(PI-COMM-LENGTH)
 18410*    END-EXEC.
 18411*    MOVE '.$C                   %   #00016377' TO DFHEIV0
 18412     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18413     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18414     MOVE X'2020233030303136333737' TO DFHEIV0(25:11)
 18415     CALL 'kxdfhei1' USING DFHEIV0,
 18416           PGM-NAME,
 18417           PROGRAM-INTERFACE-BLOCK,
 18418           PI-COMM-LENGTH,
 18419           DFHEIV99
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
 18422
 18423 9400-CLEAR.
 18424     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18425     GO TO 9300-XCTL.
 18426
 18427 9500-PF12.
 18428     MOVE XCTL-010               TO PGM-NAME.
 18429     GO TO 9300-XCTL.
 18430
 18431 9700-LINK-DATE-CONVERT.
 18432     MOVE LINK-ELDATCV           TO PGM-NAME.
 18433
 18434* EXEC CICS LINK
 18435*        PROGRAM   (PGM-NAME)
 18436*        COMMAREA  (DATE-CONVERSION-DATA)
 18437*        LENGTH    (DC-COMM-LENGTH)
 18438*    END-EXEC.
 18439*    MOVE '."C                   (   #00016393' TO DFHEIV0
 18440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18442     MOVE X'2020233030303136333933' TO DFHEIV0(25:11)
 18443     CALL 'kxdfhei1' USING DFHEIV0,
 18444           PGM-NAME,
 18445           DATE-CONVERSION-DATA,
 18446           DC-COMM-LENGTH,
 18447           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 359
* EL156.cbl
 18448           DFHEIV99,
 18449           DFHEIV99,
 18450           DFHEIV99
 18451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18452
 18453
 18454 9700-EXIT.
 18455     EXIT.
 18456
 18457 9800-LINK-REM-TERM.
 18458     MOVE LINK-REMTERM TO PGM-NAME.
 18459
 18460
 18461* EXEC CICS LINK
 18462*        PROGRAM   (PGM-NAME)
 18463*        COMMAREA  (CALCULATION-PASS-AREA)
 18464*        LENGTH    (CP-COMM-LENGTH)
 18465*    END-EXEC.
 18466*    MOVE '."C                   (   #00016405' TO DFHEIV0
 18467     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18469     MOVE X'2020233030303136343035' TO DFHEIV0(25:11)
 18470     CALL 'kxdfhei1' USING DFHEIV0,
 18471           PGM-NAME,
 18472           CALCULATION-PASS-AREA,
 18473           CP-COMM-LENGTH,
 18474           DFHEIV99,
 18475           DFHEIV99,
 18476           DFHEIV99,
 18477           DFHEIV99
 18478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18479
 18480
 18481 9800-EXIT.
 18482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 360
* EL156.cbl
 18484 9830-DMD-REMAINING-TERM.
 18485
 18486     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18487         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18488
 18489     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18490                              CM-PMT-EXTENSION-DAYS.
 18491
 18492     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18493                                  CL-NO-OF-DAYS-PAID.
 18494
 18495     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18496         GIVING W-REM REMAINDER W-REM-DAYS.
 18497
 18498     MOVE W-REM                  TO WST-REM.
 18499
 18500     IF W-REM-DAYS > ZEROS
 18501         MOVE '/'                TO WST-SLASH
 18502         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18503     ELSE
 18504         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18505
 18506 9830-EXIT.
 18507     EXIT.
 18508
 18509 9870-OUTPUT-ACTIVITY-RECORD.
 18510
 18511
 18512* EXEC CICS GETMAIN
 18513*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18514*         LENGTH(25)
 18515*         INITIMG(WS-BLANK)
 18516*    END-EXEC.
 18517     MOVE 25
 18518       TO DFHEIV11
 18519*    MOVE ',"IL                  $   #00016441' TO DFHEIV0
 18520     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18521     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18522     MOVE X'2020233030303136343431' TO DFHEIV0(25:11)
 18523     CALL 'kxdfhei1' USING DFHEIV0,
 18524           DFHEIV20,
 18525           DFHEIV11,
 18526           WS-BLANK
 18527     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18528         DFHEIV20
 18529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18530
 18531
 18532     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18533     MOVE ELMSTR-KEY             TO DA-KEY.
 18534     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18535
 18536     IF PI-PMTTYPE EQUAL '7'
 18537         MOVE 'V'                TO DA-RECORD-TYPE
 18538     ELSE
 18539         MOVE 'P'                TO DA-RECORD-TYPE.
 18540
 18541
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 361
* EL156.cbl
 18542* EXEC CICS HANDLE CONDITION
 18543*         NOTOPEN(9870-NOTOPEN)
 18544*         DUPREC(9870-EXIT)
 18545*    END-EXEC.
 18546*    MOVE '"$J%                  ! B #00016456' TO DFHEIV0
 18547     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18549     MOVE X'4220233030303136343536' TO DFHEIV0(25:11)
 18550     CALL 'kxdfhei1' USING DFHEIV0
 18551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18552
 18553
 18554
 18555* EXEC CICS WRITE
 18556*         DATASET('DLYACTV')
 18557*         RIDFLD(DA-KEY)
 18558*         FROM(DAILY-ACTIVITY-RECORD)
 18559*         LENGTH(25)
 18560*    END-EXEC.
 18561     MOVE 'DLYACTV' TO DFHEIV1
 18562     MOVE 25
 18563       TO DFHEIV11
 18564*    MOVE '&$ L                  ''   #00016461' TO DFHEIV0
 18565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303136343631' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           DFHEIV1,
 18570           DAILY-ACTIVITY-RECORD,
 18571           DFHEIV11,
 18572           DA-KEY,
 18573           DFHEIV99,
 18574           DFHEIV99
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18578     GO TO 9870-EXIT.
 18579
 18580 9870-NOTOPEN.
 18581
 18582     MOVE '2955'                 TO EMI-ERROR.
 18583     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18584
 18585 9870-EXIT.
 18586     EXIT.
 18587
 18588 9900-ERROR-FORMAT.
 18589
 18590     IF EMI-ERROR = ER-0923
 18591         MOVE PGM-NAME           TO W-CALLED-NAME.
 18592
 18593     MOVE LINK-001      TO PGM-NAME.
 18594     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18595
 18596
 18597* EXEC CICS LINK
 18598*        PROGRAM (PGM-NAME)
 18599*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 362
* EL156.cbl
 18600*        LENGTH  (EMI-COMM-LENGTH)
 18601*    END-EXEC.
 18602*    MOVE '."C                   (   #00016486' TO DFHEIV0
 18603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18605     MOVE X'2020233030303136343836' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           PGM-NAME,
 18608           ERROR-MESSAGE-INTERFACE-BLOCK,
 18609           EMI-COMM-LENGTH,
 18610           DFHEIV99,
 18611           DFHEIV99,
 18612           DFHEIV99,
 18613           DFHEIV99
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617     IF EMI-ERROR = ER-0923
 18618         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18619
 18620 9900-EXIT.
 18621     EXIT.
 18622
 18623 9990-ABEND.
 18624     MOVE LINK-004               TO PGM-NAME.
 18625     MOVE DFHEIBLK               TO EMI-LINE1.
 18626
 18627* EXEC CICS LINK
 18628*        PROGRAM   (PGM-NAME)
 18629*        COMMAREA  (EMI-LINE1)
 18630*        LENGTH    (64)
 18631*    END-EXEC.
 18632     MOVE 64
 18633       TO DFHEIV11
 18634*    MOVE '."C                   (   #00016501' TO DFHEIV0
 18635     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18637     MOVE X'2020233030303136353031' TO DFHEIV0(25:11)
 18638     CALL 'kxdfhei1' USING DFHEIV0,
 18639           PGM-NAME,
 18640           EMI-LINE1,
 18641           DFHEIV11,
 18642           DFHEIV99,
 18643           DFHEIV99,
 18644           DFHEIV99,
 18645           DFHEIV99
 18646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18647
 18648
 18649     MOVE 'EL156A'               TO  MAP-NAME.
 18650     MOVE LOW-VALUES             TO  EL156AO.
 18651     GO TO 8100-SEND-INITIAL-MAP.
 18652
 18653 9995-SECURITY-VIOLATION.
 18654*    COPY ELCSCTP.
 18655******************************************************************
 18656*                                                                *
 18657*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 363
* EL156.cbl
 18658*                            VMOD=2.001                          *
 18659*                                                                *
 18660*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18661******************************************************************
 18662
 18663
 18664     MOVE EIBDATE          TO SM-JUL-DATE.
 18665     MOVE EIBTRMID         TO SM-TERMID.
 18666     MOVE THIS-PGM         TO SM-PGM.
 18667     MOVE EIBTIME          TO TIME-IN.
 18668     MOVE TIME-OUT         TO SM-TIME.
 18669     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18670
 18671
 18672* EXEC CICS LINK
 18673*         PROGRAM  ('EL003')
 18674*         COMMAREA (SECURITY-MESSAGE)
 18675*         LENGTH   (80)
 18676*    END-EXEC.
 18677     MOVE 'EL003' TO DFHEIV1
 18678     MOVE 80
 18679       TO DFHEIV11
 18680*    MOVE '."C                   (   #00016529' TO DFHEIV0
 18681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18683     MOVE X'2020233030303136353239' TO DFHEIV0(25:11)
 18684     CALL 'kxdfhei1' USING DFHEIV0,
 18685           DFHEIV1,
 18686           SECURITY-MESSAGE,
 18687           DFHEIV11,
 18688           DFHEIV99,
 18689           DFHEIV99,
 18690           DFHEIV99,
 18691           DFHEIV99
 18692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18693
 18694
 18695******************************************************************
 18696
 18697
 18698
 18699 9999-DFHBACK SECTION.
 18700     MOVE '9%                    "   ' TO DFHEIV0
 18701     MOVE 'EL156' TO DFHEIV1
 18702     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18703     GOBACK.
 18704 9999-DFHEXIT.
 18705     IF DFHEIGDJ EQUAL 0001
 18706         NEXT SENTENCE
 18707     ELSE IF DFHEIGDJ EQUAL 2
 18708         GO TO 9990-ABEND,
 18709               8600-PGRM-NOT-FOUND,
 18710               0400-FIRST-TIME,
 18711               6180-DUPREC,
 18712               9990-ABEND
 18713         DEPENDING ON DFHEIGDI
 18714     ELSE IF DFHEIGDJ EQUAL 3
 18715         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 364
* EL156.cbl
 18716               0380-CLAIM-END-FILE
 18717         DEPENDING ON DFHEIGDI
 18718     ELSE IF DFHEIGDJ EQUAL 4
 18719         GO TO 0380-CLAIM-END-FILE,
 18720               0380-CLAIM-END-FILE
 18721         DEPENDING ON DFHEIGDI
 18722     ELSE IF DFHEIGDJ EQUAL 5
 18723         GO TO 0800-EXIT
 18724         DEPENDING ON DFHEIGDI
 18725     ELSE IF DFHEIGDJ EQUAL 6
 18726         GO TO 1950-NOT-FOUND,
 18727               1950-NOT-FOUND
 18728         DEPENDING ON DFHEIGDI
 18729     ELSE IF DFHEIGDJ EQUAL 7
 18730         GO TO 1950-NOT-FOUND
 18731         DEPENDING ON DFHEIGDI
 18732     ELSE IF DFHEIGDJ EQUAL 8
 18733         GO TO 1950-NOT-FOUND,
 18734               1950-NOT-FOUND
 18735         DEPENDING ON DFHEIGDI
 18736     ELSE IF DFHEIGDJ EQUAL 9
 18737         GO TO 1166-END-CHECK,
 18738               1166-END-CHECK
 18739         DEPENDING ON DFHEIGDI
 18740     ELSE IF DFHEIGDJ EQUAL 10
 18741         GO TO 1950-NOT-FOUND,
 18742               1950-NOT-FOUND
 18743         DEPENDING ON DFHEIGDI
 18744     ELSE IF DFHEIGDJ EQUAL 11
 18745         GO TO 1950-NOT-FOUND,
 18746               1950-NOT-FOUND
 18747         DEPENDING ON DFHEIGDI
 18748     ELSE IF DFHEIGDJ EQUAL 12
 18749         GO TO 1950-NOT-FOUND
 18750         DEPENDING ON DFHEIGDI
 18751     ELSE IF DFHEIGDJ EQUAL 13
 18752         GO TO 3600-CONTINUE
 18753         DEPENDING ON DFHEIGDI
 18754     ELSE IF DFHEIGDJ EQUAL 14
 18755         GO TO 5300-NOTE-NOT-FOUND
 18756         DEPENDING ON DFHEIGDI
 18757     ELSE IF DFHEIGDJ EQUAL 15
 18758         GO TO 6065-NOT-FOUND
 18759         DEPENDING ON DFHEIGDI
 18760     ELSE IF DFHEIGDJ EQUAL 16
 18761         GO TO 6068-ACCT-NOT-FND
 18762         DEPENDING ON DFHEIGDI
 18763     ELSE IF DFHEIGDJ EQUAL 17
 18764         GO TO 6074-GET-COMP-DATA
 18765         DEPENDING ON DFHEIGDI
 18766     ELSE IF DFHEIGDJ EQUAL 18
 18767         GO TO 6170-WRITE
 18768         DEPENDING ON DFHEIGDI
 18769     ELSE IF DFHEIGDJ EQUAL 19
 18770         GO TO 6180-DUPREC
 18771         DEPENDING ON DFHEIGDI
 18772     ELSE IF DFHEIGDJ EQUAL 20
 18773         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 10:42 Page 365
* EL156.cbl
 18774         DEPENDING ON DFHEIGDI
 18775     ELSE IF DFHEIGDJ EQUAL 21
 18776         GO TO 6185-DUPREC
 18777         DEPENDING ON DFHEIGDI
 18778     ELSE IF DFHEIGDJ EQUAL 22
 18779         GO TO 6720-BUILD-NEW-RECORD
 18780         DEPENDING ON DFHEIGDI
 18781     ELSE IF DFHEIGDJ EQUAL 23
 18782         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18783               6900-BUILD-ARCHIVE-HEADER
 18784         DEPENDING ON DFHEIGDI
 18785     ELSE IF DFHEIGDJ EQUAL 24
 18786         GO TO 7010-BUILD-MAP
 18787         DEPENDING ON DFHEIGDI
 18788     ELSE IF DFHEIGDJ EQUAL 25
 18789         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18790         DEPENDING ON DFHEIGDI
 18791     ELSE IF DFHEIGDJ EQUAL 26
 18792         GO TO 7160-DUPREC
 18793         DEPENDING ON DFHEIGDI
 18794     ELSE IF DFHEIGDJ EQUAL 27
 18795         GO TO 7200-EXIT,
 18796               7200-EXIT
 18797         DEPENDING ON DFHEIGDI
 18798     ELSE IF DFHEIGDJ EQUAL 28
 18799         GO TO 7400-NOT-FOUND
 18800         DEPENDING ON DFHEIGDI
 18801     ELSE IF DFHEIGDJ EQUAL 29
 18802         GO TO 7590-END,
 18803               7590-END
 18804         DEPENDING ON DFHEIGDI
 18805     ELSE IF DFHEIGDJ EQUAL 30
 18806         GO TO 7699-EXIT
 18807         DEPENDING ON DFHEIGDI
 18808     ELSE IF DFHEIGDJ EQUAL 31
 18809         GO TO 5300-NOTE-NOT-FOUND
 18810         DEPENDING ON DFHEIGDI
 18811     ELSE IF DFHEIGDJ EQUAL 32
 18812         GO TO 7800-COMP-NOTFND
 18813         DEPENDING ON DFHEIGDI
 18814     ELSE IF DFHEIGDJ EQUAL 33
 18815         GO TO 7920-NOT-FOUND
 18816         DEPENDING ON DFHEIGDI
 18817     ELSE IF DFHEIGDJ EQUAL 34
 18818         GO TO 9870-NOTOPEN,
 18819               9870-EXIT
 18820         DEPENDING ON DFHEIGDI.
 18821     MOVE '9%                    "   ' TO DFHEIV0
 18822     MOVE 'EL156' TO DFHEIV1
 18823     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18824     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11708     Code:       67911
