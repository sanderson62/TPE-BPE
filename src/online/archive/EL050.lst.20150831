* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145*-----------------------------------------------------------------
   146
   147 01  WORK-AREAS.
   148
   149*****************************************************************
   150*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   151*****************************************************************
   152
   153     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-NAME-EDIT-WORK-AREA.
   157         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   158         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   159             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   160         16  WS-WORK-NAME.
   161             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   162             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   163             20  FILLER           PIC X(10)     VALUE SPACES.
   164         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   165             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   166
   167*****************************************************************
   168*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   169*****************************************************************
   170
   171     12  WS-ERRESC-KEY.
   172         16 WS-ERRESC-SEARCH-KEY.
   173             20  WS-ERRESC-COMPANY-CD PIC  X.
   174             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   5
* EL050.cbl
   175             20  WS-ERRESC-GROUP      PIC X(6).
   176             20  WS-ERRESC-STATE      PIC XX.
   177             20  WS-ERRESC-ACCOUNT    PIC X(10).
   178         16 WS-ERRESC-RESIDUAL-KEY.
   179             20  WS-ERRESC-AGENT      PIC X(10).
   180             20  WS-ERRESC-RES-STATE  PIC XX.
   181             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   182*                                          YYYYMMDD
   183     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   185
   186*RESIDENT STATE TAX MASTER(ERRESS)
   187*
   188     12  WS-ERRESS-KEY.
   189         16  WS-ERRESS-COMPANY-CD      PIC  X.
   190         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   191         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   192         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   193*                                          YYYYMMDD
   194
   195     12  WS-CONTRACT-DATE              PIC 9(8).
   196*                                          YYYYMMDD
   197     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   198     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   199         16 WS-YEAR-YY                 PIC   9999.
   200         16 FILLER                     PIC 9(4).
   201*                                          YYYYMMDD
   202     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   203     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   204     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   205     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   206
   207     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   208         88  DPRB-1ST-TIME                      VALUE ' '.
   209
   210*****************************************************************
   211*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   212*****************************************************************
   213
   214     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   215     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   216     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   220     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   221     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   222     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   223     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   224     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   225         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   226         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   227     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   228         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   229         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   230     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   231
   232     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   6
* EL050.cbl
   233     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   234
   235     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   236     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   249     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   250     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   271     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   272     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   273     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   274     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   283     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   284     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   285     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   286     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   287     12  WS-2671-SW               PIC X         VALUE SPACE.
   288     12  WS-2672-SW               PIC X         VALUE SPACE.
   289     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   290         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   7
* EL050.cbl
   291     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   292         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   293     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   294
   295     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   296         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   297         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   298         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   299         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   300
   301     12  WS-CREDIT-EDIT-CONTROLS.
   302         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   303         16  WS-MIN-AGE           PIC 99                VALUE  0.
   304         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   305         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   306         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   307         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   308
   309     12  WS-AGE-FIELDS.
   310         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   311         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   312         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   313         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   314
   315     12  WS-SAVE-ALLOWABLE-BENEFIT.
   316         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   317         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   318         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   319         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   320         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   321         16  FILLER                      PIC XX.
   322
   323     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   324     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   325     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   326     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   327     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   328     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   329     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   330     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   331     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   332     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   333
   334     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   335     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   336     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   337     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   338     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   339     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   340     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   341     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   342         88  WS-REDUCING              VALUE 'R'.
   343         88  WS-LEVEL                 VALUE 'L' 'P'.
   344     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   345
   346     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   347     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   348     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   8
* EL050.cbl
   349     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   350     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   351     12  ws-ah-max-bens           pic 99        value zeros.
   352     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   353     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   354     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   355     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   356
   357     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   358     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   359     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   360     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   361     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   362     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   363     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   364     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   366     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   367     12  WS-ACCT-SIG-SW.
   368         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   369         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   370     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   371     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   372     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   373     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   377     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-INITIALS.
   380         16  WS-INIT-1            PIC X         VALUE SPACES.
   381         16  WS-INIT-2            PIC X         VALUE SPACES.
   382
   383     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   384     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   385     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   386     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   387     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   388*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   389     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   396     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   397     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   398     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   399     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   400     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   404     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   406     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411******** FLA
   412     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   416     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   417********
   418     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   419     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   422     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   423     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   424     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   425     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   426     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   427     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   428
   429     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   430         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   431                                         '0' THRU '9'.
   432
   433     12  NUMBER-OF-MONTHS.
   434         16  SK-MO OCCURS 12 TIMES PIC X.
   435
   436     12  WS-WORK-DATE.
   437         16  WS-YEAR            PIC 99    VALUE 00.
   438         16  WS-MONTH           PIC 99    VALUE 00.
   439         16  WS-DAY             PIC 99    VALUE 00.
   440
   441     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   442     12  WS-WORK-CRIT-DEV       REDEFINES
   443         WS-WORK-LF-CRIT-PER    PIC X(03).
   444
   445     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   446     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   447
   448     12  WS-WORK-DATE-FROM.
   449         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   450         16  FILLER             PIC X  VALUE SPACE.
   451         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   452         16  FILLER             PIC X         VALUE SPACE.
   453         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   454
   455     12  WS-WORK-DATE-THRU.
   456         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   459         16  FILLER             PIC X         VALUE SPACE.
   460         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   461
   462     12  WS-LF-INPUT-CD.
   463         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   464         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  10
* EL050.cbl
   465
   466     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   467     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   468         16  WS-AH-INPUT-CD-1   PIC X.
   469         16  WS-AH-INPUT-CD-2-3 PIC XX.
   470
   471     12  WS-SWITCHES.
   472         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   473         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   474             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   475         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   476             88  BANK-ACCT-FOUND          VALUE 'Y'.
   477         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   478             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   479         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   480             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   481         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   482             88  COMP-MASTER-FOUND        VALUE 'Y'.
   483         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   484             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   485         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   486             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   487         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   488             88  STAT-MASTER-FOUND        VALUE 'Y'.
   489         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   490             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   491         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   492             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   493         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   494             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   495         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   496             88  FORM-MASTER-FOUND        VALUE 'Y'.
   497         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   498             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   499         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   500             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   501         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   502             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   503         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   504             88  NO-BENEFIT-FOUND         VALUE 'N'.
   505         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   506             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   507         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   508             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   509         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   510             88  AH-BENEFIT-FOUND         VALUE ' '.
   511             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   512         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   513             88  LF-BENEFIT-FOUND         VALUE ' '.
   514             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   515         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   516             88  NO-STATE-RECORD          VALUE '1'.
   517         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   518             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   519         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   520             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   521         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   522             88  CERT-WAS-FOUND           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  11
* EL050.cbl
   523             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   524         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   525             88  BROWSE-STARTED           VALUE 'Y'.
   526         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   527             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   528         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   529             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   530         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   531             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   532         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   533             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   534         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   535             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   536         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   537             88  APP-CERT-USED            VALUE 'Y' 'A'.
   538         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   539             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   540             88  FIRST-TIME-THROUGH       VALUE '1'.
   541             88  CTBL-NOT-FOUND           VALUE '2'.
   542
   543         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   544             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   545
   546         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   547             88  DLO-ERROR-FOUND          VALUE 'Y'.
   548
   549********FLA
   550     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   551     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   552********
   553     12  RC-SW-1                  PIC X           VALUE '0'.
   554     12  RC-SW-2                  PIC X           VALUE '0'.
   555     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   556     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   557     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   565     12  LIT-SPACES               PIC X           VALUE SPACES.
   566     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   567     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   568     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   569     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   570     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   571     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   572     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   573         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   574         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   575     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   576         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   577
   578 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   579     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   580     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  12
* EL050.cbl
   581 01  WS-CRI-SSN-WORK-AREA.
   582     05  WS-CRI-SOC-SEC-NO.
   583         10  WS-SS-REPT-CD       PIC X(5).
   584         10  WS-SS-LAST-NAME     PIC X(5).
   585         10  WS-SS-INITIAL       PIC X.
   586
   587     05  WS-CRI-REPORT-CODE.
   588         10  FILLER              PIC X(5).
   589         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   590
   591     05  WS-CRI-LAST-NAME.
   592         10  WS-CRI-NAME-MOVE    PIC X(5).
   593         10  FILLER              PIC X(10).
   594
   595 01  WS-NUM-TABLE                PIC X(26)  VALUE
   596     '12345678012345070923456789'.
   597 01  FILLER REDEFINES WS-NUM-TABLE.
   598     05  WS-NUM OCCURS 26        PIC 9.
   599 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   600 01  V1                          PIC S999 COMP-3.
   601 01  V2                          PIC S999 COMP-3.
   602 01  V3                          PIC S999 COMP-3.
   603 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   604 01  FILLER REDEFINES WS-WORK-VIN.
   605     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   606 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   607 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   608 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   609 01  WS-HEX-WORK.
   610     05  FILLER                  PIC X  VALUE LOW-VALUES.
   611     05  WS-HEX-BYTE             PIC X.
   612 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   613 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   614 01  WS-WORK-HIN-ROW-B.
   615     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   616
   617 01  ws-benefit-cd-chg-sw      pic x value spaces.
   618     88  benefit-code-chg           value 'Y'.
   619 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   620 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   621     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   622 01  WS-ROW-D-TABLE.
   623     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   624
   625 01  WS-HIN-TABLE-B.
   626     05  F                       PIC XX VALUE 'A2'.
   627     05  F                       PIC XX VALUE 'B3'.
   628     05  F                       PIC XX VALUE 'C4'.
   629     05  F                       PIC XX VALUE 'D5'.
   630     05  F                       PIC XX VALUE 'E6'.
   631     05  F                       PIC XX VALUE 'F7'.
   632     05  F                       PIC XX VALUE 'G8'.
   633     05  F                       PIC XX VALUE 'H9'.
   634     05  F                       PIC XX VALUE 'I1'.
   635     05  F                       PIC XX VALUE 'J2'.
   636     05  F                       PIC XX VALUE 'K3'.
   637     05  F                       PIC XX VALUE 'L4'.
   638     05  F                       PIC XX VALUE 'M5'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'N6'.
   640     05  F                       PIC XX VALUE 'O0'.
   641     05  F                       PIC XX VALUE 'P7'.
   642     05  F                       PIC XX VALUE 'Q0'.
   643     05  F                       PIC XX VALUE 'R8'.
   644     05  F                       PIC XX VALUE 'S9'.
   645     05  F                       PIC XX VALUE 'T2'.
   646     05  F                       PIC XX VALUE 'U3'.
   647     05  F                       PIC XX VALUE 'V4'.
   648     05  F                       PIC XX VALUE 'W5'.
   649     05  F                       PIC XX VALUE 'X6'.
   650     05  F                       PIC XX VALUE 'Y7'.
   651     05  F                       PIC XX VALUE 'Z8'.
   652 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   653     05  WS-VAL-IN               PIC X.
   654     05  WS-VAL-OUT              PIC 9.
   655 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   656 01  WS-COMPARE-BINARY-DATES.
   657     05  WS-971231                PIC XX VALUE X'92FF'.
   658     05  WS-931231                PIC XX VALUE X'8CFF'.
   659     05  WS-791231                PIC XX VALUE X'77FF'.
   660     05  WS-771001                PIC XX VALUE X'74A1'.
   661     05  WS-820301                PIC XX VALUE X'7B41'.
   662     05  WS-831031                PIC XX VALUE X'7DBF'.
   663     05  WS-831231                PIC XX VALUE X'7DFF'.
   664     05  WS-810831                PIC XX VALUE X'7A7F'.
   665     05  WS-830901                PIC XX VALUE X'7D81'.
   666
   667 01  FILE-ACCESS-IDS.
   668     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   669     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   670     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   671     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   672     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   673     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   674     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   675     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   676     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   677     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   678     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   679     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   680     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   681     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   682     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   683     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   684     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   685 01  DD-IU-SW                    PIC X   VALUE ' '.
   686     88  DD-IU-PRESENT                 VALUE 'Y'.
   687
   688 01  ACCESS-KEYS.
   689     12  ELMSTR-KEY.
   690         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   691         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   692     12  W-CLAIM-KEY.
   693         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   694         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   695
   696     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  14
* EL050.cbl
   697         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   698         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   699         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   700         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   701
   702     12  ELCERT-KEY.
   703         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   704         16  CERT-CARRIER         PIC X       VALUE SPACE.
   705         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   706         16  CERT-STATE           PIC XX      VALUE SPACES.
   707         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   708         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   709         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   710
   711     12  ELCERT2-KEY.
   712         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   713         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   714
   715     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   716
   717     12  ELCERT-SAVE.
   718         16  FILLER                      PIC XX    VALUE SPACES.
   719
   720         16  WCS-CONTROL-PRIMARY.
   721             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   722             20  WCS-CARRIER             PIC X     VALUE SPACE.
   723             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   724             20  WCS-STATE               PIC XX    VALUE SPACES.
   725             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   726             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   727             20  WCS-CERT-NO.
   728                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   729                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   730
   731         16  CS-CONTROL-BY-NAME.
   732             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   733             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   734             20  CS-INSURED-INITIALS.
   735                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   736                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   737
   738         16  CS-CONTROL-BY-SSN.
   739             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   740             20  CS-SOC-SEC-NO.
   741                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   742                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   743                 24  CS-SSN-LN3.
   744                     28 CS-INSURED-INITIALS-A2   PIC XX
   745                                     VALUE SPACES.
   746                     28 CS-PART-LAST-NAME-A2     PIC X
   747                                     VALUE SPACE.
   748
   749         16  CS-CONTROL-BY-CERT-NO.
   750             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   751             20  CS-CERT-NO-A4           PIC X(11)
   752                                     VALUE SPACES.
   753
   754         16  CS-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  15
* EL050.cbl
   755             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   756             20  CS-MEMBER-NO.
   757                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   758                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   759                 24  CS-MEMB-LN4.
   760                     28 CS-INSURED-INITIALS-A5   PIC XX
   761                                      VALUE SPACES.
   762                     28 CS-PART-LAST-NAME-A5     PIC XX
   763                                      VALUE SPACES.
   764
   765         16  FILLER              PIC X(360) VALUE SPACES.
   766
   767     12  ERACCT-KEY.
   768         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   769         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   770         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   771         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   772         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   773         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   774
   775     12  ERCOMP-KEY.
   776         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   777         16  COMP-CARRIER         PIC X     VALUE SPACES.
   778         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   779         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   780         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   781         16  COMP-TYPE            PIC X     VALUE SPACES.
   782
   783     12  ERLOFC-KEY.
   784         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   785         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   786         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   787         16  LOFC-STATE           PIC XX    VALUE SPACES.
   788         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   789         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   790
   791     12  WS-ELCRTT-KEY.
   792         16  WS-ELCRTT-PRIMARY       PIC X(33).
   793         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   794
   795     12  ERBXRF-KEY.
   796         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   797         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   798         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   799         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   800
   801     12  ERAGTC-KEY.
   802         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   803         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   804         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   805         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   806         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   807         16  AGTC-TYPE            PIC X     VALUE SPACES.
   808
   809     12  ERPLAN-KEY.
   810         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   811         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   812         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  16
* EL050.cbl
   813         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   814         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   815         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   816         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   817         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   818
   819     12  ERFORM-KEY.
   820         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   821         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   822         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   823         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   824
   825     12  ERREIN-KEY.
   826         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   827         16  REIN-TYPE            PIC X     VALUE SPACES.
   828         16  REIN-TABLE-CO.
   829             20  REIN-CODE-1      PIC X     VALUE SPACE.
   830             20  REIN-CODE-2      PIC X     VALUE SPACE.
   831             20  REIN-CODE-3      PIC X     VALUE SPACE.
   832         16  FILLER               PIC X(3)  VALUE SPACES.
   833
   834     12  ERCTBL-KEY.
   835         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   836         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   837         16  CTBL-CNTRL-2.
   838             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   839             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   840
   841     12  ELCRTO-KEY.
   842         16  ELCRTO-COMPANY-CD       PIC X.
   843         16  ELCRTO-CARRIER          PIC X.
   844         16  ELCRTO-GROUPING         PIC X(6).
   845         16  ELCRTO-STATE            PIC XX.
   846         16  ELCRTO-ACCOUNT          PIC X(10).
   847         16  ELCRTO-CERT-EFF-DT      PIC XX.
   848         16  ELCRTO-CERT-NO.
   849             20  ELCRTO-CERT-PRIME   PIC X(10).
   850             20  ELCRTO-CERT-SFX     PIC X.
   851         16  ELCRTO-RECORD-TYPE      PIC X.
   852         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   853
   854
   855     12  WS-ACCESS.
   856         16  FILLER               PIC XX    VALUE SPACES.
   857         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   858
   859     12  WS-CARR-ACCESS.
   860         16  FILLER               PIC X(3)  VALUE SPACES.
   861         16  WS-CARR              PIC X     VALUE SPACE.
   862*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   863*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   864     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   865         88  WS-DMD-LF-RATING   VALUE 'Y'.
   866         88  WS-DMD-AH-RATING   VALUE 'Y'.
   867         88  WS-DMD-NO-RATING   VALUE 'N'.
   868
   869     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   870         88  WS-LF-CASH            VALUE 'MJ' 'MS'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  17
* EL050.cbl
   871                                         'NJ' 'NL'
   872                                         'PJ' 'PL'
   873                                         'SJ' 'SL'.
   874     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   875         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   876                                         'NI' 'NJ' 'NL' 'NU'
   877                                         'PJ' 'PL' 'PI' 'PU'
   878                                         'SI' 'SJ' 'SL' 'SU'
   879                                         'MX' 'MY' 'MZ'.
   880 01  ERPDEF-KEY-SAVE             PIC X(18).
   881 01  ERPDEF-KEY.
   882     12  ERPDEF-COMPANY-CD       PIC X.
   883     12  ERPDEF-STATE            PIC XX.
   884     12  ERPDEF-PROD-CD          PIC XXX.
   885     12  F                       PIC X(7).
   886     12  ERPDEF-BEN-TYPE         PIC X.
   887     12  ERPDEF-BEN-CODE         PIC XX.
   888     12  ERPDEF-EXP-DT           PIC XX.
   889
   890 01  ELSTAT-KEY-SAVE             PIC X(20).
   891 01  ELSTAT-KEY.
   892     12  ELSTAT-COMPANY-ID       PIC XXX.
   893     12  ELSTAT-CARRIER          PIC X.
   894     12  ELSTAT-GROUP            PIC X(6).
   895     12  ELSTAT-STATE            PIC XX.
   896     12  ELSTAT-EXP-DT           PIC 9(8).
   897 01  WS-ERROR-VALUES.
   898     12  ER-1570                     PIC S9(4)   VALUE +1570.
   899     12  ER-1571                     PIC S9(4)   VALUE +1571.
   900     12  er-1572                     pic s9(4)   value +1572.
   901     12  er-1573                     pic s9(4)   value +1573.
   902     12  er-1574                     pic s9(4)   value +1574.
   903     12  ER-1575                     PIC S9(4)   VALUE +1575.
   904     12  er-1576                     pic s9(4)   value +1576.
   905     12  ER-1891                     PIC S9(4)   VALUE +1891.
   906     12  ER-1892                     PIC S9(4)   VALUE +1892.
   907     12  ER-1893                     PIC S9(4)   VALUE +1893.
   908     12  ER-1894                     PIC S9(4)   VALUE +1894.
   909     12  ER-1895                     PIC S9(4)   VALUE +1895.
   910     12  ER-1896                     PIC S9(4)   VALUE +1896.
   911     12  ER-1897                     PIC S9(4)   VALUE +1897.
   912     12  ER-1898                     PIC S9(4)   VALUE +1898.
   913     12  ER-1899                     PIC S9(4)   VALUE +1899.
   914     12  ER-1900                     PIC S9(4)   VALUE +1900.
   915     12  ER-1901                     PIC S9(4)   VALUE +1901.
   916     12  ER-1902                     PIC S9(4)   VALUE +1902.
   917     12  ER-1903                     PIC S9(4)   VALUE +1903.
   918     12  ER-1904                     PIC S9(4)   VALUE +1904.
   919     12  ER-1905                     PIC S9(4)   VALUE +1905.
   920     12  ER-1906                     PIC S9(4)   VALUE +1906.
   921     12  ER-1907                     PIC S9(4)   VALUE +1907.
   922     12  ER-1909                     PIC S9(4)   VALUE +1909.
   923     12  ER-1910                     PIC S9(4)   VALUE +1910.
   924     12  ER-1911                     PIC S9(4)   VALUE +1911.
   925     12  ER-1912                     PIC S9(4)   VALUE +1912.
   926     12  ER-1913                     PIC S9(4)   VALUE +1913.
   927     12  ER-1914                     PIC S9(4)   VALUE +1914.
   928     12  ER-1915                     PIC S9(4)   VALUE +1915.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  18
* EL050.cbl
   929     12  ER-1916                     PIC S9(4)   VALUE +1916.
   930     12  ER-1917                     PIC S9(4)   VALUE +1917.
   931     12  ER-1918                     PIC S9(4)   VALUE +1918.
   932     12  ER-1919                     PIC S9(4)   VALUE +1919.
   933     12  ER-1920                     PIC S9(4)   VALUE +1920.
   934     12  ER-1921                     PIC S9(4)   VALUE +1921.
   935     12  ER-1922                     PIC S9(4)   VALUE +1922.
   936     12  ER-1923                     PIC S9(4)   VALUE +1923.
   937     12  ER-1924                     PIC S9(4)   VALUE +1924.
   938     12  ER-1925                     PIC S9(4)   VALUE +1925.
   939     12  ER-1926                     PIC S9(4)   VALUE +1926.
   940     12  ER-1927                     PIC S9(4)   VALUE +1927.
   941     12  ER-2393                     PIC S9(4)   VALUE +2393.
   942     12  ER-2600                     PIC S9(4)   VALUE +2600.
   943     12  ER-2601                     PIC S9(4)   VALUE +2601.
   944     12  ER-2602                     PIC S9(4)   VALUE +2602.
   945     12  ER-2603                     PIC S9(4)   VALUE +2603.
   946     12  ER-2604                     PIC S9(4)   VALUE +2604.
   947     12  ER-2605                     PIC S9(4)   VALUE +2605.
   948     12  ER-2606                     PIC S9(4)   VALUE +2606.
   949     12  ER-2607                     PIC S9(4)   VALUE +2607.
   950     12  ER-2608                     PIC S9(4)   VALUE +2608.
   951     12  ER-2609                     PIC S9(4)   VALUE +2609.
   952     12  ER-2610                     PIC S9(4)   VALUE +2610.
   953     12  ER-2611                     PIC S9(4)   VALUE +2611.
   954     12  ER-2612                     PIC S9(4)   VALUE +2612.
   955     12  ER-2613                     PIC S9(4)   VALUE +2613.
   956     12  ER-2614                     PIC S9(4)   VALUE +2614.
   957     12  ER-2615                     PIC S9(4)   VALUE +2615.
   958     12  ER-2616                     PIC S9(4)   VALUE +2616.
   959     12  ER-2617                     PIC S9(4)   VALUE +2617.
   960     12  ER-2618                     PIC S9(4)   VALUE +2618.
   961     12  ER-2619                     PIC S9(4)   VALUE +2619.
   962     12  ER-2620                     PIC S9(4)   VALUE +2620.
   963     12  ER-2621                     PIC S9(4)   VALUE +2621.
   964     12  ER-2622                     PIC S9(4)   VALUE +2622.
   965     12  ER-2623                     PIC S9(4)   VALUE +2623.
   966     12  ER-2624                     PIC S9(4)   VALUE +2624.
   967     12  ER-2625                     PIC S9(4)   VALUE +2625.
   968     12  ER-2626                     PIC S9(4)   VALUE +2626.
   969     12  ER-2627                     PIC S9(4)   VALUE +2627.
   970     12  ER-2628                     PIC S9(4)   VALUE +2628.
   971     12  ER-2629                     PIC S9(4)   VALUE +2629.
   972     12  ER-2630                     PIC S9(4)   VALUE +2630.
   973     12  ER-2631                     PIC S9(4)   VALUE +2631.
   974     12  ER-2632                     PIC S9(4)   VALUE +2632.
   975     12  ER-2633                     PIC S9(4)   VALUE +2633.
   976     12  ER-2634                     PIC S9(4)   VALUE +2634.
   977     12  ER-2635                     PIC S9(4)   VALUE +2635.
   978     12  ER-2636                     PIC S9(4)   VALUE +2636.
   979     12  ER-2637                     PIC S9(4)   VALUE +2637.
   980     12  ER-2638                     PIC S9(4)   VALUE +2638.
   981     12  ER-2639                     PIC S9(4)   VALUE +2639.
   982     12  ER-2640                     PIC S9(4)   VALUE +2640.
   983     12  ER-2641                     PIC S9(4)   VALUE +2641.
   984     12  ER-2642                     PIC S9(4)   VALUE +2642.
   985     12  ER-2643                     PIC S9(4)   VALUE +2643.
   986     12  ER-2644                     PIC S9(4)   VALUE +2644.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  19
* EL050.cbl
   987     12  ER-2645                     PIC S9(4)   VALUE +2645.
   988     12  ER-2646                     PIC S9(4)   VALUE +2646.
   989     12  ER-2647                     PIC S9(4)   VALUE +2647.
   990     12  ER-2648                     PIC S9(4)   VALUE +2648.
   991     12  ER-2649                     PIC S9(4)   VALUE +2649.
   992     12  ER-2650                     PIC S9(4)   VALUE +2650.
   993     12  ER-2651                     PIC S9(4)   VALUE +2651.
   994     12  ER-2652                     PIC S9(4)   VALUE +2652.
   995     12  ER-2653                     PIC S9(4)   VALUE +2653.
   996     12  ER-2654                     PIC S9(4)   VALUE +2654.
   997     12  ER-2655                     PIC S9(4)   VALUE +2655.
   998     12  ER-2656                     PIC S9(4)   VALUE +2656.
   999     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1000     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1001     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1002     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1003     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1004     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1005     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1006     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1007     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1008     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1009     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1010     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1011     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1012     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1013     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1014     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1015     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1016     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1017     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1018     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1019     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1020     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1021     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1022     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1023     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1024     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1025     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1026     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1027     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1028     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1029     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1030     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1031     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1032     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1033     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1034     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1035     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1036     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1037     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1038     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1039     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1040     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1041     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1042     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1043     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1044     12  ER-2702                     PIC S9(4)   VALUE +2702.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  20
* EL050.cbl
  1045     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1046     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1047     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1048     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1049     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1050     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1051     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1052     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1053     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1054     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1055     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1056     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1057     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1058     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1059     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1060     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1061     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1062     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1063     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1064     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1065     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1066     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1067     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1068     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1069     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1070     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1071     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1072     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1073     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1074     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1075     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1076     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1077     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1078     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1079     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1080     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1081     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1082     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1083     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1084     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1085     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1086     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1087     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1088     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1089     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1090     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1091     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1092     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1093     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1094     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1095     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1096     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1097     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1098     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1099     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1100     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1101     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1102     12  ER-2770                     PIC S9(4)   VALUE +2770.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  21
* EL050.cbl
  1103     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1104     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1105     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1106     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1107     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1108     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1109     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1110     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1111     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1112     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1113     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1114     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1115     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1116     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1117     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1118     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1119     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1120     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1121     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1122     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1123     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1124     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1125     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1126     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1127     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1128     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1129     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1130     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1131     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1132     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1133     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1134     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1135     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1136     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1137     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1138     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1139     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1140     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1141     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1142     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1143     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1144     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1145     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1146     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1147     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1148     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1149     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1150     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1151     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1152     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1153     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1154     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1155     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1156     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1157     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1158     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1159     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1160     12  ER-3825                     PIC S9(4)   VALUE +3825.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  22
* EL050.cbl
  1161     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1162     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1163     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1164     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1165     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1166     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1167     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1168     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1169     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1170     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1171     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1172     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1173     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1174     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1175     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1176     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1177     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1178     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1179     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1180     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1181     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1182     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1183     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1184     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1185     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1186     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1187     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1188     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1189     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1190     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1191     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1192     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1193     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1194     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1195     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1196     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1197     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1198     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1199     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1200     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1201     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1202     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1203     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1204     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1205     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1206     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1207     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1208     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1209     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1210     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1211     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1212     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1213     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1214     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1215     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1216     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1217     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1218     12  ER-8098                     PIC S9(4)   VALUE +8098.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  23
* EL050.cbl
  1219     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1220     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1221     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1222     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1223     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1224     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1225     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1226     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1227     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1228     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1229     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1230     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1231     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1232     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1233     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1234     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1235     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1236     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1237     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1238     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1239     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1240     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1241     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1242     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1243     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1244     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1245     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1246     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1247******************************************************************
  1248***************   END OF ELC50WS     ****************************
  1249******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  24
* EL050.cbl
  1252 01  WORKING-STORAGE-WORK-AREAS.
  1253     12  WS-RESPONSE             PIC S9(8)  COMP.
  1254         88  WS-RESP-NORMAL           VALUE +00.
  1255         88  WS-RESP-ERROR            VALUE +01.
  1256         88  WS-RESP-NOTFND           VALUE +13.
  1257         88  WS-RESP-DUPREC           VALUE +14.
  1258         88  WS-RESP-ENDFILE          VALUE +20.
  1259     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1260     12  WORK-AREAS.
  1261         16  WK-CONV-GREG.
  1262             24  WCG-CENT             PIC XX.
  1263             24  WCG-REST             PIC X(4).
  1264         16  WORK-GREGORIAN-DATE.
  1265             24  WK-GREG-CENT         PIC XX.
  1266             24  WK-GREG-DATE-YYMMDD.
  1267                 28  WK-GREG-YYMM     PIC X(4).
  1268                 28  WK-GREG-DD       PIC XX.
  1269
  1270         16  WORK-SELECT-DATE.
  1271             24  WK-SELECT-CENT            PIC XX.
  1272             24  WK-SELECT-DATE-YYMMDD.
  1273                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1274                 28  FILLER                PIC XX.
  1275
  1276         16  WK-FORM-NO.
  1277             24  WK-FORM-BANK-ID       PIC X(5).
  1278             24  WK-FORM-UNDRWRTR      PIC X(1).
  1279             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1280
  1281         16  WK-MEMBER-NO.
  1282             24  WK-MEMBER-1-6        PIC X(6).
  1283             24  WK-MEMBER-7-12       PIC X(6).
  1284
  1285         16  WK-FULL-CERT-NO.
  1286             24  WK-CERT-POS-1-2      PIC X(2).
  1287             24  WK-CERT-POS-3        PIC X(1).
  1288             24  WK-CERT-POS-4        PIC X(1).
  1289             24  WK-CERT-POS-5-6      PIC X(2).
  1290             24  WK-CERT-POS-7        PIC X(1).
  1291             24  WK-CERT-POS-8-11     PIC X(4).
  1292
  1293         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1294             88  VALID-RATE-CODE        VALUE 'Y'.
  1295             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1296
  1297         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1298         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1299         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1300         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1301         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1302         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1303         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1304         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1305         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1306         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1307
  1308* DLO001
  1309 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  25
* EL050.cbl
  1310     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1311     12  DMPF-RETURN-CODE          PIC XX.
  1312         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1314         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1315         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1316         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1317         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1318
  1319* DLO002
  1320 01  WS-DLO-INTERNAL-POLICY-FORM.
  1321     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1322     12  DIPF-RETURN-CODE          PIC XX.
  1323         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1324         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1325         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1326         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1327         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1328         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1329
  1330* DLO003
  1331 01  WS-DLO-VALID-BANK-ID.
  1332     12  DVBI-BANK-ID              PIC X(5).
  1333     12  DVBI-BANK-ID-TYPE         PIC X.
  1334         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1335         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1336         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1337         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1338         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1339     12  DVBI-RETURN-CODE          PIC XX.
  1340         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1341         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1342         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1343         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1344         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1345         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1346         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1347         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1348         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1349
  1350* DLO007
  1351 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1352     12  DCUA-RES-STATE            PIC XX.
  1353     12  DCUA-BEN-TYPE             PIC XX.
  1354     12  DCUA-SYS-IDENT            PIC X.
  1355         88  DCUA-CLAIM                        VALUE 'C'.
  1356         88  DCUA-PREMIUM                      VALUE 'P'.
  1357     12  DCUA-COVERAGE-RULE        PIC X.
  1358     12  DCUA-CLIENT-ID            PIC X(10).
  1359     12  DCUA-EFF-DATE             PIC X(8).
  1360     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1361     12  DCUA-RETURN-CODE          PIC XX.
  1362         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1363     12  DCUA-CERT-NUMBER          PIC X(11).
  1364     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1365     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1366
  1367* DLO011
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  26
* EL050.cbl
  1368 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1369     12  DPRB-RATE-CODE            PIC X(4).
  1370     12  DPRB-COVERAGE-CATEG       PIC X.
  1371     12  DPRB-RETURN-CODE          PIC XX.
  1372         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1373         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1374         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1375         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1376         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1377         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1378         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1379         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1380         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1381     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1382     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1383     12  DPRB-BEN-TYPE             PIC XX.
  1384
  1385* DLO017
  1386 01  WS-DLO-VALID-RATE-CODE.
  1387     12  DVRC-RATE-CODE            PIC X(4).
  1388     12  DVRC-RETURN-CODE          PIC XX.
  1389         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1390         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1391         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1392         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1393         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1394         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1395
  1396* DLO019
  1397 01  WS-DLO-ORIG-COV-CAT.
  1398     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1399     12  DOCC-RETURN-CODE          PIC XX.
  1400     12  DOCC-ORIG-COV-CAT         PIC X.
  1401     12  DOCC-UNDERWITER           PIC XX.
  1402     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1403     12  DOCC-FILLER               PIC X(6).
  1404
  1405* DLO021
  1406 01  WS-DLO-VALID-LOAN-OFFICER.
  1407     12  DVLO-LOAN-OFFICER.
  1408         16  DVLO-BILL-TYPE        PIC X.
  1409         16  DVLO-BILL-SOURCE      PIC X.
  1410         16  DVLO-BATCH-TYPE       PIC X.
  1411     12  DVLO-RETURN-CODE          PIC XX.
  1412         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1413         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1414         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1415         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1416         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1417         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1418
  1419* DLO022
  1420 01  WS-DLO-VALID-STATE-CODE.
  1421     12  DVSC-STATE-CODE           PIC XX.
  1422     12  DVSC-RETURN-CODE          PIC XX.
  1423         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1424
  1425* DLO023
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  27
* EL050.cbl
  1426 01  WS-DLO-VALID-CODE-VALUES.
  1427     12  DVCV-SYSTEM-ID            PIC XX.
  1428         88  DVCV-CLAIMS                       VALUE 'CL'.
  1429         88  DVCV-CREDIT                       VALUE 'CR'.
  1430     12  DVCV-RECORD-TYPE          PIC XX.
  1431         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1432         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1433         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1434         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1435         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1436         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1437         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1438         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1439     12  DVCV-RECORD-KEY           PIC X(6).
  1440     12  DVCV-RETURN-CODE          PIC XX.
  1441         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1443         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1444         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1445         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1446         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1447         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1448     12  DVCV-CODE-DESC            PIC X(60).
  1449     12  DVCV-GEN-DESC-1           PIC X(20).
  1450     12  DVCV-GEN-DESC-2           PIC X(20).
  1451     12  DVCV-GEN-DESC-3           PIC X(20).
  1452
  1453****  this is for aggregate report.
  1454 01  ws-passed-key-length        pic s9(4) comp value +100.
  1455 01  ws-passed-key-area.
  1456     05  ws-passed-pend-key.
  1457         10  ws-pass-company-cd  pic x.
  1458         10  ws-pass-carrier     pic x.
  1459         10  ws-pass-grouping    pic x(6).
  1460         10  ws-pass-state       pic xx.
  1461         10  ws-pass-account     pic x(10).
  1462         10  ws-pass-eff-dt      pic xx.
  1463         10  ws-pass-cert-no     pic x(11).
  1464         10  ws-pass-seq-no      pic s9(4) comp.
  1465         10  ws-pass-rec-type    pic x.
  1466     05  ws-return-area.
  1467         10  ws-exceed-limit-yn  pic x.
  1468         10  ws-has-claim-yn     pic x.
  1469     05  filler                  pic x(62).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  28
* EL050.cbl
  1471*    COPY ERCBXRF.
  1472******************************************************************
  1473*                                                                *
  1474*                                                                *
  1475*                            ERCBXRF                             *
  1476*                                                                *
  1477*   ONLINE CREDIT SYSTEM                                         *
  1478*                                                                *
  1479*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1480*                                                                *
  1481*   FILE TYPE = VSAM,KSDS                                        *
  1482*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1483*                                                                *
  1484*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1485*       ALTERNATE PATH = NONE                                    *
  1486*                                                                *
  1487*   LOG = NO                                                     *
  1488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1489*                                                                *
  1490******************************************************************
  1491
  1492 01  BANK-CROSS-REFERENCE.
  1493     12  BK-RECORD-ID                PIC XX.
  1494         88  VALID-BK-ID             VALUE 'BK'.
  1495
  1496     12  BK-CONTROL-PRIMARY.
  1497         16  BK-COMPANY-CD           PIC X.
  1498         16  BK-CARRIER              PIC X.
  1499         16  BK-GROUPING             PIC X(6).
  1500         16  BK-BANK-NO              PIC X(10).
  1501
  1502     12  BK-MAINT-INFORMATION.
  1503         16  BK-LAST-MAINT-DT        PIC XX.
  1504         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1505         16  BK-LAST-MAINT-USER      PIC X(4).
  1506         16  FILLER                  PIC X(9).
  1507
  1508     12  FILLER                      PIC X(37).
  1509
  1510     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1511
  1512     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1513                            DEPENDING ON BK-BANK-POINTER-CNT.
  1514         16  BK-AM-ACCOUNT           PIC X(10).
  1515         16  BK-AM-EXP-DT            PIC XX.
  1516         16  BK-AM-EFF-DT            PIC XX.
  1517         16  BK-AM-STATE             PIC XX.
  1518         16  FILLER                  PIC X(20).
  1519
  1520******************************************************************
  1521
  1522*    COPY ERCCOMP.
  1523******************************************************************
  1524*                                                                *
  1525*                                                                *
  1526*                            ERCCOMP                             *
  1527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1528*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  29
* EL050.cbl
  1529*                                                                *
  1530*   ONLINE CREDIT SYSTEM                                         *
  1531*                                                                *
  1532*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1533*                                                                *
  1534*   FILE TYPE = VSAM,KSDS                                        *
  1535*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1536*                                                                *
  1537*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1538*       ALTERNATE PATH = NONE                                    *
  1539*                                                                *
  1540*   LOG = NO                                                     *
  1541*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1542*                                                                *
  1543******************************************************************
  1544*                   C H A N G E   L O G
  1545*
  1546* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1547*-----------------------------------------------------------------
  1548*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1549* EFFECTIVE    NUMBER
  1550*-----------------------------------------------------------------
  1551* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1552* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1553* 092205    2005050300006  PEMA  ADD LEASE FEE
  1554* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1555* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1556* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1557* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1558* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1559* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1560******************************************************************
  1561
  1562 01  COMPENSATION-MASTER.
  1563     12  CO-RECORD-ID                          PIC XX.
  1564         88  VALID-CO-ID                          VALUE 'CO'.
  1565
  1566     12  CO-CONTROL-PRIMARY.
  1567         16  CO-COMPANY-CD                     PIC X.
  1568         16  CO-CONTROL.
  1569             20  CO-CTL-1.
  1570                 24  CO-CARR-GROUP.
  1571                     28  CO-CARRIER            PIC X.
  1572                     28  CO-GROUPING.
  1573                         32  CO-GROUP-PREFIX   PIC XXX.
  1574                         32  CO-GROUP-PRIME    PIC XXX.
  1575                 24  CO-RESP-NO.
  1576                     28  CO-RESP-PREFIX        PIC X(4).
  1577                     28  CO-RESP-PRIME         PIC X(6).
  1578             20  CO-CTL-2.
  1579                 24  CO-ACCOUNT.
  1580                     28  CO-ACCT-PREFIX        PIC X(4).
  1581                     28  CO-ACCT-PRIME         PIC X(6).
  1582         16  CO-TYPE                           PIC X.
  1583             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1584             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1585             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1586
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  30
* EL050.cbl
  1587     12  CO-MAINT-INFORMATION.
  1588         16  CO-LAST-MAINT-DT                  PIC XX.
  1589         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1590         16  CO-LAST-MAINT-USER                PIC X(4).
  1591     12  FILLER                                PIC XX.
  1592     12  CO-STMT-TYPE                          PIC XXX.
  1593     12  CO-COMP-TYPE                          PIC X.
  1594         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1595     12  CO-STMT-OWNER                         PIC X(4).
  1596     12  CO-BALANCE-CONTROL                    PIC X.
  1597         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1598         88  CO-NO-BALANCE                        VALUE 'N'.
  1599
  1600     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1601         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1602         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1603         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1604
  1605     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1606         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1607         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1608
  1609     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1610     12  CO-GA-DIRECT-DEP                      PIC X.
  1611     12  CO-FUTURE-SPACE                       PIC X.
  1612         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1613
  1614     12  CO-ACCT-NAME                          PIC X(30).
  1615     12  CO-MAIL-NAME                          PIC X(30).
  1616     12  CO-ADDR-1                             PIC X(30).
  1617     12  CO-ADDR-2                             PIC X(30).
  1618     12  CO-ADDR-3.
  1619         16  CO-ADDR-CITY                      PIC X(27).
  1620         16  CO-ADDR-STATE                     PIC XX.
  1621     12  CO-CSO-1099                           PIC X.
  1622     12  CO-ZIP.
  1623         16  CO-ZIP-PRIME.
  1624             20  CO-ZIP-PRI-1ST                PIC X.
  1625                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1626             20  FILLER                        PIC X(4).
  1627         16  CO-ZIP-PLUS4                      PIC X(4).
  1628     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1629         16  CO-CAN-POSTAL-1                   PIC XXX.
  1630         16  CO-CAN-POSTAL-2                   PIC XXX.
  1631         16  FILLER                            PIC XXX.
  1632     12  CO-SOC-SEC                            PIC X(13).
  1633     12  CO-TELEPHONE.
  1634         16  CO-AREA-CODE                      PIC XXX.
  1635         16  CO-PREFIX                         PIC XXX.
  1636         16  CO-PHONE                          PIC X(4).
  1637
  1638     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1639
  1640     12  CO-AR-BAL-LEVEL                       PIC X.
  1641         88  CO-AR-REF-LVL                        VALUE '1'.
  1642         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1643         88  CO-AR-BILL-LVL                       VALUE '2'.
  1644         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  31
* EL050.cbl
  1645         88  CO-AR-FR-LVL                         VALUE '4'.
  1646
  1647     12  CO-AR-NORMAL-PRINT                    PIC X.
  1648         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1649         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1650
  1651     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1652
  1653     12  CO-AR-REPORTING                       PIC X.
  1654         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1655         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1656
  1657     12  CO-AR-PULL-CHECK                      PIC X.
  1658         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1659         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1660
  1661     12  CO-AR-BALANCE-PRINT                   PIC X.
  1662         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1663
  1664     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1665         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1666         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1667         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1668
  1669     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1670
  1671     12  CO-USER-CODE                          PIC X.
  1672     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1673
  1674******************************************************************
  1675*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1676*    THE LAST MONTH END RUN.
  1677******************************************************************
  1678
  1679     12  CO-LAST-ACTIVITY-DATE.
  1680         16  CO-ACT-YEAR                       PIC 99.
  1681         16  CO-ACT-MONTH                      PIC 99.
  1682         16  CO-ACT-DAY                        PIC 99.
  1683
  1684     12  CO-LAST-STMT-DT.
  1685         16  CO-LAST-STMT-YEAR                 PIC 99.
  1686         16  CO-LAST-STMT-MONTH                PIC 99.
  1687         16  CO-LAST-STMT-DAY                  PIC 99.
  1688
  1689     12  CO-MO-END-TOTALS.
  1690         16  CO-MONTHLY-TOTALS.
  1691             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1692             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1693             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1694             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1695             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1696
  1697         16  CO-AGING-TOTALS.
  1698             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1699             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1700             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1701             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1702
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  32
* EL050.cbl
  1703         16  CO-YTD-TOTALS.
  1704             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1705             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1706
  1707         16  CO-OVER-UNDER-TOTALS.
  1708             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1709             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1710
  1711     12  CO-MISCELLANEOUS-TOTALS.
  1712         16  CO-FICA-TOTALS.
  1713             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1714             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1715
  1716         16  CO-CLAIM-TOTALS.
  1717             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1718             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1719
  1720******************************************************************
  1721*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1722*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1723******************************************************************
  1724
  1725     12  CO-CURRENT-TOTALS.
  1726         16  CO-CURRENT-LAST-STMT-DT.
  1727             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1728             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1729             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1730
  1731         16  CO-CURRENT-MONTHLY-TOTALS.
  1732             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1733             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1734             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1735             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1736             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1737
  1738         16  CO-CURRENT-AGING-TOTALS.
  1739             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1740             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1743
  1744         16  CO-CURRENT-YTD-TOTALS.
  1745             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1747
  1748     12  CO-PAID-COMM-TOTALS.
  1749         16  CO-YTD-PAID-COMMS.
  1750             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1751             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1752
  1753     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1754         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1755         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1756
  1757     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1758         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1759         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1760         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  33
* EL050.cbl
  1761         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1762         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1763         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1764         88  CO-FINAL-LETTER                  VALUE 'F'.
  1765         88  CO-RECONCILING                   VALUE 'R'.
  1766         88  CO-PHONE-CALL                    VALUE 'P'.
  1767         88  CO-LEGAL                         VALUE 'L'.
  1768         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1769         88  CO-WRITE-OFF                     VALUE 'W'.
  1770         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1771
  1772     12  CO-CSR-CODE                       PIC X(4).
  1773
  1774     12  CO-GA-STATUS-INFO.
  1775         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1776         16  CO-GA-TERMINATION-DT          PIC XX.
  1777         16  CO-GA-STATUS-CODE             PIC X.
  1778             88  CO-GA-ACTIVE                 VALUE 'A'.
  1779             88  CO-GA-INACTIVE               VALUE 'I'.
  1780             88  CO-GA-PENDING                VALUE 'P'.
  1781         16  CO-GA-COMMENTS.
  1782             20  CO-GA-COMMENT-1           PIC X(40).
  1783             20  CO-GA-COMMENT-2           PIC X(40).
  1784             20  CO-GA-COMMENT-3           PIC X(40).
  1785             20  CO-GA-COMMENT-4           PIC X(40).
  1786
  1787     12  CO-RPTCD2                         PIC X(10).
  1788     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1789         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1790         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1791
  1792     12  CO-TYPE-AGENT                     PIC X(01).
  1793         88  CO-CORPORATION                   VALUE 'C'.
  1794         88  CO-PARTNERSHIP                   VALUE 'P'.
  1795         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1796         88  CO-TRUST                         VALUE 'T'.
  1797         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1798
  1799     12  CO-FAXNO.
  1800         16  CO-FAX-AREA-CODE                  PIC XXX.
  1801         16  CO-FAX-PREFIX                     PIC XXX.
  1802         16  CO-FAX-PHONE                      PIC X(4).
  1803
  1804     12  CO-BANK-INFORMATION.
  1805         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1806         16  CO-BANK-TRANSIT-NON REDEFINES
  1807             CO-BANK-TRANSIT-NO                PIC 9(8).
  1808
  1809         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1810     12  CO-MISC-DEDUCT-INFO REDEFINES
  1811                  CO-BANK-INFORMATION.
  1812         16  CO-MD-GL-ACCT                     PIC X(10).
  1813         16  CO-MD-DIV                         PIC XX.
  1814         16  CO-MD-CENTER                      PIC X(4).
  1815         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1816         16  CO-CREATE-AP-CHECK                PIC X.
  1817         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1818         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  34
* EL050.cbl
  1819     12  CO-ACH-STATUS                         PIC X.
  1820         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1821         88  CO-ACH-PENDING                        VALUE 'P'.
  1822
  1823     12  CO-BILL-SW                            PIC X.
  1824     12  CO-CONTROL-NAME                       PIC X(30).
  1825     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1826     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1827     12  CO-CLP-STATE                          PIC XX.
  1828     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1829     12  CO-SPP-REFUND-EDIT                    PIC X.
  1830
  1831******************************************************************
  1832
  1833*    COPY ERCAGTC.
  1834******************************************************************
  1835*                                                                *
  1836*                                                                *
  1837*                            ERCAGTC                             *
  1838*                            VMOD=2.001                          *
  1839*                                                                *
  1840*   ONLINE CREDIT SYSTEM                                         *
  1841*                                                                *
  1842*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1843*                                                                *
  1844*   FILE TYPE = VSAM,KSDS                                        *
  1845*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1846*                                                                *
  1847*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1848*       ALTERNATE PATH = NONE                                    *
  1849*                                                                *
  1850*   LOG = NO                                                     *
  1851*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1852*                                                                *
  1853******************************************************************
  1854*                   C H A N G E   L O G
  1855*
  1856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1857*-----------------------------------------------------------------
  1858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1859* EFFECTIVE    NUMBER
  1860*-----------------------------------------------------------------
  1861* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1862* 111004                         NEW FILE AND COPYBOOK
  1863* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1864******************************************************************
  1865 01  AGENT-COMMISSIONS.
  1866     12  AG-RECORD-ID                          PIC XX.
  1867         88  VALID-CO-ID                          VALUE 'AG'.
  1868     12  AG-CONTROL-PRIMARY.
  1869         16  AG-COMPANY-CD                     PIC X.
  1870         16  AG-CONTROL.
  1871             20  AG-CTL-1.
  1872                 24  AG-CARR-GROUP.
  1873                     28  AG-CARRIER            PIC X.
  1874                     28  AG-GROUPING           PIC X(6).
  1875                 24  AG-BANK                   PIC X(10).
  1876             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  35
* EL050.cbl
  1877                 24  AG-EXP-DT                 PIC XX.
  1878         16  AG-TYPE                           PIC X.
  1879             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1880             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1881     12  AG-MAINT-INFORMATION.
  1882         16  AG-LAST-MAINT-DT                  PIC XX.
  1883         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1884         16  AG-LAST-MAINT-USER                PIC X(4).
  1885         16  FILLER                            PIC X(10).
  1886     12  AG-EFF-DT                             PIC XX.
  1887     12  AG-COMM-STRUCTURE.
  1888         16  AG-AGT-COMMS OCCURS 10.
  1889             20  AG-AGT                PIC X(10).
  1890             20  AG-COM-TYP            PIC X.
  1891             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1892             20  AG-RECALC-LV-INDIC    PIC X.
  1893             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1894             20  AG-LRCALC-LV-INDIC    PIC X.
  1895             20  FILLER                PIC X(05).
  1896     12  FILLER                  PIC X(145).
  1897******************************************************************
  1898*    COPY ERCRESS.
  1899******************************************************************
  1900*                                                                *
  1901*                            ERCRESS                             *
  1902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1903*                            VMOD=2.002                          *
  1904*                                                                *
  1905*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1906*                                                                *
  1907*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1908*   VSAM RESIDENT STATE TAX MASTER                              *
  1909*                                                                *
  1910*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1911*                                                                *
  1912*   FILE TYPE = VSAM,KSDS                                        *
  1913*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1914*                                                                *
  1915*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1916*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1917*                                                                *
  1918*   LOG = NO                                                     *
  1919*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1920*                                                                *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  RESIDENT-STATE-TAX-MASTER.
  1925
  1926     10  ERRESS-PRIMARY-KEY.
  1927         15  RES-COMPANY-CD        PIC X.
  1928         15  RES-RESIDENT-STATE    PIC XX.
  1929         15  RES-COVERAGE-CATEGORY PIC X.
  1930         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1931*                                      YYYYMMDD
  1932*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1933
  1934     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  36
* EL050.cbl
  1935
  1936         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1937         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1938         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1939         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1940
  1941     10 RES-RECALC-SW              PIC   X.
  1942         88 RECALC                VALUE 'Y'.
  1943         88 NO-RECALC             VALUE 'N'.
  1944     10  RES-MAINT-BY              PIC X(4).
  1945     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1946     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1947*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  37
* EL050.cbl
  1949*    COPY ERCRESC.
  1950******************************************************************
  1951*                                                                *
  1952*                            ERCRESC                             *
  1953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1954*                            VMOD=2.003                          *
  1955*                                                                *
  1956*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1957*                                                                *
  1958*   FILE TYPE = VSAM,KSDS                                        *
  1959*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1960*                                                                *
  1961*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1962*       ALTERNATE PATH1 = NONE                                   *
  1963*                                                                *
  1964*   LOG = NO                                                     *
  1965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1966*                                                                *
  1967******************************************************************
  1968
  1969 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1970
  1971     10  ERRESC-RECORD-KEY.
  1972         15  RESC-COMPANY-CD           PIC   X.
  1973         15  RESC-CARRIER              PIC   X.
  1974         15  RESC-GROUP                PIC   X(6).
  1975         15  RESC-STATE                PIC   XX.
  1976         15  RESC-ACCOUNT              PIC   X(10).
  1977         15  RESC-AGENT                PIC   X(10).
  1978         15  RESC-RESIDENT-STATE       PIC   XX.
  1979         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1980*                                           YYYYMMDD
  1981     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1982
  1983     10  RESC-COMM-RECORD-DATA.
  1984         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1985             20 RESC-COVERAGE-CAT      PIC    X.
  1986             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1987             20 RESC-COMMISSION-TAB REDEFINES
  1988                RESC-COMMISSION-PER    PIC  XXX.
  1989
  1990     10  RESC-MAINT-BY                 PIC X(4).
  1991     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1992     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1993*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  38
* EL050.cbl
  1995*    COPY ERCPLAN.
  1996******************************************************************
  1997*                                                                *
  1998*                                                                *
  1999*                            ERCPLAN                             *
  2000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2001*                            VMOD=2.003                          *
  2002*                                                                *
  2003*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2004*                                                                *
  2005*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2006*   PLAN MASTER                                                  *
  2007*                                                                *
  2008*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2009*                                                                *
  2010*   FILE TYPE = VSAM,KSDS                                        *
  2011*   RECORD SIZE = 420   RECFORM = FIX                            *
  2012*                                                                *
  2013*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2014*       ALTERNATE PATH1 = N/A                                    *
  2015*                                                                *
  2016*   LOG = NO                                                     *
  2017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2018*                                                                *
  2019*                                                                *
  2020******************************************************************
  2021
  2022 01  PLAN-MASTER.
  2023     12  PL-RECORD-ID                      PIC XX.
  2024         88  VALID-PL-ID                      VALUE 'PL'.
  2025
  2026     12  PL-CONTROL-PRIMARY.
  2027         16  PL-COMPANY-CD                 PIC X.
  2028         16  PL-MSTR-CNTRL.
  2029             20  PL-CONTROL-A.
  2030                 24  PL-CARRIER            PIC X.
  2031                 24  PL-GROUPING           PIC X(6).
  2032                 24  PL-STATE              PIC XX.
  2033                 24  PL-ACCOUNT            PIC X(10).
  2034             20  PL-BENEFIT-TYPE           PIC X.
  2035             20  PL-BENEFIT-CODE           PIC XX.
  2036             20  PL-REVISION-NO            PIC X(3).
  2037
  2038     12  PL-CONTROL-BY-VAR-GRP.
  2039         16  PL-COMPANY-CD-A1              PIC X.
  2040         16  PL-VG-CARRIER                 PIC X.
  2041         16  PL-VG-GROUPING                PIC X(6).
  2042         16  PL-VG-STATE                   PIC XX.
  2043         16  PL-VG-ACCOUNT                 PIC X(10).
  2044         16  PL-BENEFIT-TYPE-A1            PIC X.
  2045         16  PL-BENEFIT-CODE-A1            PIC XX.
  2046         16  PL-REVISION-NO-A1             PIC 999.
  2047
  2048     12  PL-MAINT-INFORMATION.
  2049         16  PL-LAST-MAINT-DT              PIC XX.
  2050         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2051         16  PL-LAST-MAINT-USER            PIC X(4).
  2052         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  39
* EL050.cbl
  2053
  2054     12  PL-LIABILITY-LIMITS.
  2055         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2056         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2057             20  PL-LM-AGE                 PIC S99        COMP-3.
  2058             20  PL-LM-DUR                 PIC S999       COMP-3.
  2059             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2060             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2061
  2062     12  FILLER                            PIC X(30).
  2063
  2064     12  PL-GL-ACCOUNT-NOS.
  2065         16  PL-PREMIUM-GL                 PIC X(8).
  2066         16  PL-COMM-GL                    PIC X(8).
  2067         16  PL-CLAIM-GL                   PIC X(8).
  2068     12  FILLER                            PIC X(24).
  2069     12  PL-TOLERANCES.
  2070         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2071         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2072         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2073         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2074         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2075         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2076     12  PL-OVER-SHORT.
  2077         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2078         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2079     12  FILLER                            PIC X(24).
  2080     12  PLAN-MISC.
  2081         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2082         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2083         16  PL-IG                         PIC X.
  2084         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2085         16  PL-POLICY-FORM                PIC X(12).
  2086         16  PL-EDIT-FOR-FORM              PIC X(01).
  2087         16  PL-DEV-CODE                   PIC XXX.
  2088         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2089         16  PL-CALC-METHOD                PIC X.
  2090         16  PL-BENEFIT-GROUP              PIC X(05).
  2091         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2092
  2093         16  FILLER                        PIC X(99).
  2094******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  40
* EL050.cbl
  2096*    COPY ELCCERT.
  2097******************************************************************
  2098*                                                                *
  2099*                            ELCCERT.                            *
  2100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2101*                            VMOD=2.013                          *
  2102*                                                                *
  2103*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2104*                                                                *
  2105*   FILE TYPE = VSAM,KSDS                                        *
  2106*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2107*                                                                *
  2108*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2109*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2110*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2111*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2112*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2113*                                                                *
  2114*   LOG = YES                                                    *
  2115*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2116******************************************************************
  2117*                   C H A N G E   L O G
  2118*
  2119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2120*-----------------------------------------------------------------
  2121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2122* EFFECTIVE    NUMBER
  2123*-----------------------------------------------------------------
  2124* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2125* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2126* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2127* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2128* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2129* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2131* 032612  CR2011110200001  PEMA  AHL CHANGES
  2132* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2133******************************************************************
  2134
  2135 01  CERTIFICATE-MASTER.
  2136     12  CM-RECORD-ID                      PIC XX.
  2137         88  VALID-CM-ID                      VALUE 'CM'.
  2138
  2139     12  CM-CONTROL-PRIMARY.
  2140         16  CM-COMPANY-CD                 PIC X.
  2141         16  CM-CARRIER                    PIC X.
  2142         16  CM-GROUPING.
  2143             20  CM-GROUPING-PREFIX        PIC X(3).
  2144             20  CM-GROUPING-PRIME         PIC X(3).
  2145         16  CM-STATE                      PIC XX.
  2146         16  CM-ACCOUNT.
  2147             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2148             20  CM-ACCOUNT-PRIME          PIC X(6).
  2149         16  CM-CERT-EFF-DT                PIC XX.
  2150         16  CM-CERT-NO.
  2151             20  CM-CERT-PRIME             PIC X(10).
  2152             20  CM-CERT-SFX               PIC X.
  2153
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  41
* EL050.cbl
  2154     12  CM-CONTROL-BY-NAME.
  2155         16  CM-COMPANY-CD-A1              PIC X.
  2156         16  CM-INSURED-LAST-NAME          PIC X(15).
  2157         16  CM-INSURED-INITIALS.
  2158             20  CM-INSURED-INITIAL1       PIC X.
  2159             20  CM-INSURED-INITIAL2       PIC X.
  2160
  2161     12  CM-CONTROL-BY-SSN.
  2162         16  CM-COMPANY-CD-A2              PIC X.
  2163         16  CM-SOC-SEC-NO.
  2164             20  CM-SSN-STATE              PIC XX.
  2165             20  CM-SSN-ACCOUNT            PIC X(6).
  2166             20  CM-SSN-LN3.
  2167                 25  CM-INSURED-INITIALS-A2.
  2168                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2169                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2170                 25 CM-PART-LAST-NAME-A2         PIC X.
  2171
  2172     12  CM-CONTROL-BY-CERT-NO.
  2173         16  CM-COMPANY-CD-A4              PIC X.
  2174         16  CM-CERT-NO-A4                 PIC X(11).
  2175
  2176     12  CM-CONTROL-BY-MEMB.
  2177         16  CM-COMPANY-CD-A5              PIC X.
  2178         16  CM-MEMBER-NO.
  2179             20  CM-MEMB-STATE             PIC XX.
  2180             20  CM-MEMB-ACCOUNT           PIC X(6).
  2181             20  CM-MEMB-LN4.
  2182                 25  CM-INSURED-INITIALS-A5.
  2183                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2184                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2185                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2186
  2187     12  CM-INSURED-PROFILE-DATA.
  2188         16  CM-INSURED-FIRST-NAME.
  2189             20  CM-INSURED-1ST-INIT       PIC X.
  2190             20  FILLER                    PIC X(9).
  2191         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2192         16  CM-INSURED-SEX                PIC X.
  2193             88  CM-SEX-MALE                  VALUE 'M'.
  2194             88  CM-SEX-FEMAL                 VALUE 'F'.
  2195         16  CM-INSURED-JOINT-AGE          PIC 99.
  2196         16  CM-JOINT-INSURED-NAME.
  2197             20  CM-JT-LAST-NAME           PIC X(15).
  2198             20  CM-JT-FIRST-NAME.
  2199                 24  CM-JT-1ST-INIT        PIC X.
  2200                 24  FILLER                PIC X(9).
  2201             20  CM-JT-INITIAL             PIC X.
  2202
  2203     12  CM-LIFE-DATA.
  2204         16  CM-LF-BENEFIT-CD              PIC XX.
  2205         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2206         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2207         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2208         16  CM-LF-DEV-CODE                PIC XXX.
  2209         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2210         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2211         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  42
* EL050.cbl
  2212         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2213         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2214         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2215         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2216         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2218         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2219         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2220         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2221         16  cm-temp-epiq                  pic xx.
  2222             88  EPIQ-CLASS                  value 'EQ'.
  2223*        16  FILLER                        PIC XX.
  2224
  2225     12  CM-AH-DATA.
  2226         16  CM-AH-BENEFIT-CD              PIC XX.
  2227         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2228         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2229         16  CM-AH-DEV-CODE                PIC XXX.
  2230         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2231         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2232         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2233         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2234         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2235         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2237         16  CM-AH-PAID-THRU-DT            PIC XX.
  2238             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2239         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2240         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2241         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2242         16  FILLER                        PIC X.
  2243
  2244     12  CM-LOAN-INFORMATION.
  2245         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2246         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2247                                           PIC S9(5)V99  COMP-3.
  2248         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2249         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2250         16  CM-PAY-FREQUENCY              PIC S99.
  2251         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2252         16  CM-RATE-CLASS                 PIC XX.
  2253         16  CM-BENEFICIARY                PIC X(25).
  2254         16  CM-POLICY-FORM-NO             PIC X(12).
  2255         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2256         16  CM-LAST-ADD-ON-DT             PIC XX.
  2257         16  CM-DEDUCTIBLE-AMOUNTS.
  2258             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2259             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2260         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2261             20  CM-RESIDENT-STATE         PIC XX.
  2262             20  CM-RATE-CODE              PIC X(4).
  2263             20  FILLER                    PIC XX.
  2264         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2265             20  CM-LOAN-OFFICER           PIC X(5).
  2266             20  FILLER                    PIC XXX.
  2267         16  CM-CSR-CODE                   PIC XXX.
  2268         16  CM-UNDERWRITING-CODE          PIC X.
  2269             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  43
* EL050.cbl
  2270         16  CM-POST-CARD-IND              PIC X.
  2271         16  CM-NH-INTERFACE-SW            PIC X.
  2272         16  CM-PREMIUM-TYPE               PIC X.
  2273             88  CM-SING-PRM                  VALUE '1'.
  2274             88  CM-O-B-COVERAGE              VALUE '2'.
  2275             88  CM-OPEN-END                  VALUE '3'.
  2276         16  CM-IND-GRP-TYPE               PIC X.
  2277             88  CM-INDIVIDUAL                VALUE 'I'.
  2278             88  CM-GROUP                     VALUE 'G'.
  2279         16  CM-SKIP-CODE                  PIC X.
  2280             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2281             88  SKIP-JULY                    VALUE '1'.
  2282             88  SKIP-AUGUST                  VALUE '2'.
  2283             88  SKIP-SEPTEMBER               VALUE '3'.
  2284             88  SKIP-JULY-AUG                VALUE '4'.
  2285             88  SKIP-AUG-SEPT                VALUE '5'.
  2286             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2287             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2288             88  SKIP-JUNE                    VALUE '8'.
  2289             88  SKIP-JUNE-JULY               VALUE '9'.
  2290             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2291             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2292         16  CM-PAYMENT-MODE               PIC X.
  2293             88  PAY-MONTHLY                  VALUE SPACE.
  2294             88  PAY-WEEKLY                   VALUE '1'.
  2295             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2296             88  PAY-BI-WEEKLY                VALUE '3'.
  2297             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2298         16  CM-LOAN-NUMBER                PIC X(8).
  2299         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2300         16  CM-OLD-LOF                    PIC XXX.
  2301*        16  CM-LOAN-OFFICER               PIC XXX.
  2302         16  CM-REIN-TABLE                 PIC XXX.
  2303         16  CM-SPECIAL-REIN-CODE          PIC X.
  2304         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2305         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2306         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2307
  2308     12  CM-STATUS-DATA.
  2309         16  CM-ENTRY-STATUS               PIC X.
  2310         16  CM-ENTRY-DT                   PIC XX.
  2311
  2312         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2313         16  CM-LF-CANCEL-DT               PIC XX.
  2314         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2315
  2316         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2317         16  CM-LF-DEATH-DT                PIC XX.
  2318         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2319
  2320         16  CM-LF-CURRENT-STATUS          PIC X.
  2321             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2322                                                'M' '4' '5' '9'.
  2323             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2324             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2325             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2326             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2327             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  44
* EL050.cbl
  2328             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2329             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2330             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2331             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2332             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2333             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2334             88  CM-LF-DECLINED               VALUE 'D'.
  2335             88  CM-LF-VOIDED                 VALUE 'V'.
  2336
  2337         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2338         16  CM-AH-CANCEL-DT               PIC XX.
  2339         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2340
  2341         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2342         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2343         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2344
  2345         16  CM-AH-CURRENT-STATUS          PIC X.
  2346             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2347                                                'M' '4' '5' '9'.
  2348             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2349             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2350             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2351             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2352             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2353             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2354             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2355             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2356             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2357             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2358             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2359             88  CM-AH-DECLINED               VALUE 'D'.
  2360             88  CM-AH-VOIDED                 VALUE 'V'.
  2361
  2362         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2363             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2364             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2365             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2366         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2367
  2368         16  CM-ENTRY-BATCH                PIC X(6).
  2369         16  CM-LF-EXIT-BATCH              PIC X(6).
  2370         16  CM-AH-EXIT-BATCH              PIC X(6).
  2371         16  CM-LAST-MONTH-END             PIC XX.
  2372
  2373     12  CM-NOTE-SW                        PIC X.
  2374         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2375         88  CERT-NOTES-PRESENT               VALUE '1'.
  2376         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2377         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2378         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2379         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2380         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2381         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2382     12  CM-COMP-EXCP-SW                   PIC X.
  2383         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2384         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2385     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  45
* EL050.cbl
  2386         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2387         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2388
  2389*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2390     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2391     12  FILLER                            PIC X.
  2392
  2393*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2394     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2395     12  FILLER                            PIC X.
  2396*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2397     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2398
  2399     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2400         88  CERT-ADDED-BATCH                 VALUE ' '.
  2401         88  CERT-ADDED-ONLINE                VALUE '1'.
  2402         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2403         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2404         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2405     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2406         88  CERT-AS-LOADED                   VALUE ' '.
  2407         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2408         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2409         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2410         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2411         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2412         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2413         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2414
  2415     12  CM-ACCOUNT-COMM-PCTS.
  2416         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2417         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2418
  2419     12  CM-USER-FIELD                     PIC X.
  2420     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2421     12  CM-CLP-STATE                      PIC XX.
  2422     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2423     12  CM-USER-RESERVED                  PIC XXX.
  2424     12  FILLER REDEFINES CM-USER-RESERVED.
  2425         16  CM-AH-CLASS-CD                PIC XX.
  2426         16  F                             PIC X.
  2427******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  46
* EL050.cbl
  2429*    COPY ERCMAIL.
  2430******************************************************************
  2431*                                                                *
  2432*                                                                *
  2433*                            ERCMAIL                             *
  2434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2435*                            VMOD=2.003                          *
  2436*                                                                *
  2437*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2438*                                                                *
  2439*   FILE TYPE = VSAM,KSDS                                        *
  2440*   RECORD SIZE = 374   RECFORM = FIX                            *
  2441*                                                                *
  2442*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2443*   ALTERNATE PATH    = NOT USED                                 *
  2444*                                                                *
  2445*   LOG = YES                                                    *
  2446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2447******************************************************************
  2448*                   C H A N G E   L O G
  2449*
  2450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2451*-----------------------------------------------------------------
  2452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2453* EFFECTIVE    NUMBER
  2454*-----------------------------------------------------------------
  2455* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2456* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2457* 111108                   PEMA  ADD CRED BENE ADDR2
  2458******************************************************************
  2459
  2460 01  MAILING-DATA.
  2461     12  MA-RECORD-ID                      PIC XX.
  2462         88  VALID-MA-ID                       VALUE 'MA'.
  2463
  2464     12  MA-CONTROL-PRIMARY.
  2465         16  MA-COMPANY-CD                 PIC X.
  2466         16  MA-CARRIER                    PIC X.
  2467         16  MA-GROUPING.
  2468             20  MA-GROUPING-PREFIX        PIC XXX.
  2469             20  MA-GROUPING-PRIME         PIC XXX.
  2470         16  MA-STATE                      PIC XX.
  2471         16  MA-ACCOUNT.
  2472             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2473             20  MA-ACCOUNT-PRIME          PIC X(6).
  2474         16  MA-CERT-EFF-DT                PIC XX.
  2475         16  MA-CERT-NO.
  2476             20  MA-CERT-PRIME             PIC X(10).
  2477             20  MA-CERT-SFX               PIC X.
  2478
  2479     12  FILLER                            PIC XX.
  2480
  2481     12  MA-ACCESS-CONTROL.
  2482         16  MA-SOURCE-SYSTEM              PIC XX.
  2483             88  MA-FROM-CREDIT                VALUE 'CR'.
  2484             88  MA-FROM-VSI                   VALUE 'VS'.
  2485             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2486             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  47
* EL050.cbl
  2487         16  MA-RECORD-ADD-DT              PIC XX.
  2488         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2489         16  MA-LAST-MAINT-DT              PIC XX.
  2490         16  MA-LAST-MAINT-BY              PIC XXXX.
  2491         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2492
  2493     12  MA-PROFILE-INFO.
  2494         16  MA-QUALIFY-CODE-1             PIC XX.
  2495         16  MA-QUALIFY-CODE-2             PIC XX.
  2496         16  MA-QUALIFY-CODE-3             PIC XX.
  2497         16  MA-QUALIFY-CODE-4             PIC XX.
  2498         16  MA-QUALIFY-CODE-5             PIC XX.
  2499
  2500         16  MA-INSURED-LAST-NAME          PIC X(15).
  2501         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2502         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2503         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2504         16  MA-INSURED-BIRTH-DT           PIC XX.
  2505         16  MA-INSURED-SEX                PIC X.
  2506             88  MA-SEX-MALE                   VALUE 'M'.
  2507             88  MA-SEX-FEMALE                 VALUE 'F'.
  2508         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2509
  2510         16  MA-ADDRESS-CORRECTED          PIC X.
  2511         16  MA-JOINT-BIRTH-DT             PIC XX.
  2512*        16  FILLER                        PIC X(12).
  2513
  2514         16  MA-ADDRESS-LINE-1             PIC X(30).
  2515         16  MA-ADDRESS-LINE-2             PIC X(30).
  2516         16  MA-CITY-STATE.
  2517             20  MA-CITY                   PIC X(28).
  2518             20  MA-ADDR-STATE             PIC XX.
  2519         16  MA-ZIP.
  2520             20  MA-ZIP-CODE.
  2521                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2522                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2523                 24  FILLER                PIC X(4).
  2524             20  MA-ZIP-PLUS4              PIC X(4).
  2525         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2526             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2527             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2528             20  FILLER                    PIC X(3).
  2529
  2530         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2531
  2532         16  FILLER                        PIC XXX.
  2533*        16  FILLER                        PIC X(10).
  2534
  2535     12  MA-CRED-BENE-INFO.
  2536         16  MA-CRED-BENE-NAME                 PIC X(25).
  2537         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2538         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2539         16  MA-CRED-BENE-CTYST.
  2540             20  MA-CRED-BENE-CITY             PIC X(28).
  2541             20  MA-CRED-BENE-STATE            PIC XX.
  2542         16  MA-CRED-BENE-ZIP.
  2543             20  MA-CB-ZIP-CODE.
  2544                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  48
* EL050.cbl
  2545                     88  MA-CB-CANADIAN-POST-CODE
  2546                                           VALUE 'A' THRU 'Z'.
  2547                 24  FILLER                    PIC X(4).
  2548             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2549         16  MA-CB-CANADIAN-POSTAL-CODE
  2550                            REDEFINES MA-CRED-BENE-ZIP.
  2551             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2552             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2553             20  FILLER                        PIC X(3).
  2554     12  MA-POST-CARD-MAIL-DATA.
  2555         16  MA-MAIL-DATA OCCURS 7.
  2556             20  MA-MAIL-TYPE              PIC X.
  2557                 88  MA-12MO-MAILING           VALUE '1'.
  2558                 88  MA-EXP-MAILING            VALUE '2'.
  2559             20  MA-MAIL-STATUS            PIC X.
  2560                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2561                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2562                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2563             20  MA-MAIL-DATE              PIC XX.
  2564     12  FILLER                            PIC XX.
  2565     12  FILLER                            PIC XX.
  2566*    12  FILLER                            PIC X(30).
  2567******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  49
* EL050.cbl
  2569*    COPY ERCPNDM.
  2570******************************************************************
  2571*                                                                *
  2572*                                                                *
  2573*                            ERCPNDM                             *
  2574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2575*                            VMOD=2.003                          *
  2576*                                                                *
  2577*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2578*                                                                *
  2579*   FILE TYPE = VSAM,KSDS                                        *
  2580*   RECORD SIZE = 374   RECFORM = FIX                            *
  2581*                                                                *
  2582*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2583*   ALTERNATE PATH    = NOT USED                                 *
  2584*                                                                *
  2585*   LOG = YES                                                    *
  2586*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2587******************************************************************
  2588*                   C H A N G E   L O G
  2589*
  2590* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2591*-----------------------------------------------------------------
  2592*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2593* EFFECTIVE    NUMBER
  2594*-----------------------------------------------------------------
  2595* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2596* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2597* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2598******************************************************************
  2599
  2600 01  PENDING-MAILING-DATA.
  2601     12  PM-RECORD-ID                      PIC XX.
  2602         88  VALID-MA-ID                       VALUE 'PM'.
  2603
  2604     12  PM-CONTROL-PRIMARY.
  2605         16  PM-COMPANY-CD                 PIC X.
  2606         16  PM-ENTRY-BATCH                PIC X(6).
  2607         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2608         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2609
  2610     12  FILLER                            PIC X(14).
  2611
  2612     12  PM-ACCESS-CONTROL.
  2613         16  PM-SOURCE-SYSTEM              PIC XX.
  2614             88  PM-FROM-CREDIT                VALUE 'CR'.
  2615             88  PM-FROM-VSI                   VALUE 'VS'.
  2616             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2617             88  PM-FROM-OTHER                 VALUE 'OT'.
  2618         16  PM-RECORD-ADD-DT              PIC XX.
  2619         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2620         16  PM-LAST-MAINT-DT              PIC XX.
  2621         16  PM-LAST-MAINT-BY              PIC XXXX.
  2622         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2623
  2624     12  PM-PROFILE-INFO.
  2625         16  PM-QUALIFY-CODE-1             PIC XX.
  2626         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  50
* EL050.cbl
  2627         16  PM-QUALIFY-CODE-3             PIC XX.
  2628         16  PM-QUALIFY-CODE-4             PIC XX.
  2629         16  PM-QUALIFY-CODE-5             PIC XX.
  2630
  2631         16  PM-INSURED-LAST-NAME          PIC X(15).
  2632         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2633         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2634         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2635         16  PM-INSURED-BIRTH-DT           PIC XX.
  2636         16  PM-INSURED-SEX                PIC X.
  2637             88  PM-SEX-MALE                   VALUE 'M'.
  2638             88  PM-SEX-FEMALE                 VALUE 'F'.
  2639         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2640
  2641         16  PM-ADDRESS-CORRECTED          PIC X.
  2642         16  PM-JOINT-BIRTH-DT             PIC XX.
  2643*        16  FILLER                        PIC X(12).
  2644
  2645         16  PM-ADDRESS-LINE-1             PIC X(30).
  2646         16  PM-ADDRESS-LINE-2             PIC X(30).
  2647         16  PM-CITY-STATE.
  2648             20  PM-CITY                   PIC X(28).
  2649             20  PM-STATE                  PIC XX.
  2650         16  PM-ZIP.
  2651             20  PM-ZIP-CODE.
  2652                 24  PM-ZIP-1              PIC X.
  2653                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2654                 24  FILLER                PIC X(4).
  2655             20  PM-ZIP-PLUS4              PIC X(4).
  2656         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2657             20  PM-CAN-POST1              PIC XXX.
  2658             20  PM-CAN-POST2              PIC XXX.
  2659             20  FILLER                    PIC XXX.
  2660
  2661         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2662
  2663         16  FILLER                        PIC X(03).
  2664
  2665     12  PM-CRED-BENE-INFO.
  2666         16  PM-CRED-BENE-NAME             PIC X(25).
  2667         16  PM-CRED-BENE-ADDR             PIC X(30).
  2668         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2669         16  PM-CRED-BENE-CTYST.
  2670             20  PM-CRED-BENE-CITY         PIC X(28).
  2671             20  PM-CRED-BENE-STATE        PIC XX.
  2672         16  PM-CRED-BENE-ZIP.
  2673             20  PM-CB-ZIP-CODE.
  2674                 24  PM-CB-ZIP-1           PIC X.
  2675                     88  PM-CB-CANADIAN-POST-CODE
  2676                                  VALUE 'A' THRU 'Z'.
  2677                 24  FILLER                PIC X(4).
  2678             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2679         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2680             20  PM-CB-CAN-POST1           PIC XXX.
  2681             20  PM-CB-CAN-POST2           PIC XXX.
  2682             20  FILLER                    PIC XXX.
  2683     12  PM-POST-CARD-MAIL-DATA.
  2684         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  51
* EL050.cbl
  2685             20  PM-MAIL-TYPE              PIC X.
  2686                 88  PM-12MO-MAILING           VALUE '1'.
  2687                 88  PM-EXP-MAILING            VALUE '2'.
  2688             20  PM-MAIL-STATUS            PIC X.
  2689                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2690                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2691                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2692             20  PM-MAIL-DATE              PIC XX.
  2693     12  FILLER                            PIC XX.
  2694     12  FILLER                            PIC X(12).
  2695*    12  FILLER                            PIC X(30).
  2696
  2697******************************************************************
  2698*                                COPY ERCLOFC.
  2699******************************************************************
  2700*                                                                *
  2701*                                                                *
  2702*                            ERCLOFC                             *
  2703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2704*                            VMOD=2.003                          *
  2705*                                                                *
  2706*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2707*                                                                *
  2708*   FILE TYPE = VSAM,KSDS                                        *
  2709*   RECORD SIZE = 670   RECFORM = FIX                            *
  2710*                                                                *
  2711*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2712*                                                                *
  2713*   LOG = YES                                                    *
  2714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2715*                                                                *
  2716******************************************************************
  2717
  2718 01  LOAN-OFFICER-MASTER.
  2719     12  LO-RECORD-ID                PIC XX.
  2720         88  VALID-LO-ID                VALUE 'LO'.
  2721
  2722     12  LO-CONTROL-PRIMARY.
  2723         16  LO-COMPANY-CD           PIC X.
  2724         16  LO-CARRIER              PIC X.
  2725         16  LO-GROUPING.
  2726             20  LO-GROUPING-PREFIX  PIC XXX.
  2727             20  LO-GROUPING-PRIME   PIC XXX.
  2728         16  LO-STATE                PIC XX.
  2729         16  LO-ACCOUNT.
  2730             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2731             20  LO-ACCOUNT-PRIME    PIC X(6).
  2732         16  LO-OFFICER-CODE         PIC X(5).
  2733
  2734     12  LO-OFFICER-NAME             PIC X(30).
  2735
  2736     12  LO-LAST-MAINT-DT            PIC XX.
  2737     12  LO-LAST-USER                PIC X(4).
  2738     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2739
  2740     12  LO-COMP-CONTROL             PIC X.
  2741             88  LO-SHOW-COMP           VALUE 'Y'.
  2742             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  52
* EL050.cbl
  2743     12  LO-DETAIL-CONTROL           PIC X.
  2744             88  LO-PRINT-DETAIL        VALUE 'D'.
  2745             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2746
  2747     12  LO-SV-CARRIER               PIC X.
  2748     12  LO-SV-GROUPING              PIC X(6).
  2749     12  LO-SV-STATE                 PIC XX.
  2750
  2751     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2752     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2753
  2754     12  LO-OFFICER-INFO.
  2755         16  FILLER OCCURS 12 TIMES.
  2756             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2757             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2758             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2759             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2760             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2761             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2762             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2763             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2764     12  FILLER                      PIC X(198).
  2765******************************************************************
  2766*                                COPY ERCPDEF.
  2767******************************************************************
  2768*                                                                *
  2769*                                                                *
  2770*                            ERCPDEF.                            *
  2771*                                                                *
  2772*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2773*                                                                *
  2774*    FILE TYPE = VSAM,KSDS                                       *
  2775*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2776*                                                                *
  2777*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2778*                                                                *
  2779*    LOG = YES                                                   *
  2780*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2781******************************************************************
  2782*                   C H A N G E   L O G
  2783*
  2784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2785*-----------------------------------------------------------------
  2786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2787* EFFECTIVE    NUMBER
  2788*-----------------------------------------------------------------
  2789* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2790* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2791* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2792******************************************************************
  2793 01  PRODUCT-MASTER.
  2794    12  PD-RECORD-ID                 PIC X(02).
  2795        88  VALID-PD-ID                  VALUE 'PD'.
  2796    12  PD-CONTROL-PRIMARY.
  2797        16  PD-COMPANY-CD            PIC X.
  2798        16  PD-STATE                 PIC XX.
  2799        16  PD-PRODUCT-CD            PIC XXX.
  2800        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  53
* EL050.cbl
  2801        16  PD-BEN-TYPE              PIC X.
  2802        16  PD-BEN-CODE              PIC XX.
  2803        16  PD-PROD-EXP-DT           PIC XX.
  2804    12  FILLER                       PIC X(50).
  2805    12  PD-PRODUCT-DATA OCCURS 8.
  2806        16  PD-PROD-CODE             PIC X.
  2807            88  PD-PROD-LIFE           VALUE 'L'.
  2808            88  PD-PROD-PROP           VALUE 'P'.
  2809            88  PD-PROD-AH             VALUE 'A'.
  2810            88  PD-PROD-IU             VALUE 'I'.
  2811            88  PD-PROD-GAP            VALUE 'G'.
  2812            88  PD-PROD-FAML           VALUE 'F'.
  2813        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2814        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2815        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2816        16  PD-MAX-TERM              PIC S999        COMP-3.
  2817        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2818        16  FILLER                   PIC X.
  2819        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2820        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2821        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2822        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2823        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2824        16  PD-REC-CRIT-PERIOD       PIC 99.
  2825        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2826            20  PD-RECURRING-YN      PIC X.
  2827            20  FILLER               PIC X.
  2828        16  PD-RTW-MOS               PIC 99.
  2829        16  PD-MAX-EXTENSION         PIC 99.
  2830        16  pd-ben-pct               pic sv999 comp-3.
  2831*       16  FILLER                   PIC XX.
  2832    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2833    12  PD-TERM-LIMITS OCCURS 15.
  2834        16  PD-LOW-TERM              PIC S999        COMP-3.
  2835        16  PD-HI-TERM               PIC S999        COMP-3.
  2836*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2837    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2838        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2839        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2840    12  PD-EARN-FACTORS.
  2841        16  FILLER OCCURS 15.
  2842            20  FILLER OCCURS 15.
  2843                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2844    12  PD-PRODUCT-DESC              PIC X(80).
  2845    12  PD-TRUNCATED                 PIC X.
  2846    12  FILLER                       PIC X(59).
  2847    12  PD-MAINT-INFORMATION.
  2848        16  PD-LAST-MAINT-DT         PIC X(02).
  2849        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2850        16  PD-LAST-MAINT-BY         PIC X(04).
  2851*                                COPY ELCSTATE.
  2852******************************************************************
  2853*                                                                *
  2854*                                                                *
  2855*                            ELCSTATE.                           *
  2856*                                                                *
  2857*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2858*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  54
* EL050.cbl
  2859*   FILE TYPE = VSAM,KSDS                                        *
  2860*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2861*                                                                *
  2862*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2863*       ALTERNATE INDEX = NONE                                   *
  2864*                                                                *
  2865*   LOG = YES                                                    *
  2866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2876******************************************************************
  2877*
  2878 01  STATE-FILE.
  2879     12  SF-RECORD-ID                       PIC XX.
  2880         88  VALID-CF-ID                        VALUE 'SF'.
  2881     12  SF-CONTROL-PRIMARY.
  2882         16  SF-COMPANY-ID                  PIC XXX.
  2883         16  SF-CARRIER-CODE                PIC X.
  2884         16  SF-GROUPING                    PIC X(6).
  2885         16  SF-STATE-CODE                  PIC XX.
  2886         16  SF-EXPIRE-DATE                 PIC 9(8).
  2887****************************************************************
  2888*             STATE CONTROLS
  2889****************************************************************
  2890     12  SF-LAST-MAINT-DT                   PIC XX.
  2891     12  SF-LAST-MAINT-BY                   PIC X(4).
  2892     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2893     12  SF-STATE-RT-CONTROLS.
  2894         16  SF-ST-RT-CALC                  PIC X.
  2895     12  SF-ST-TAX-CONTROLS.
  2896         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2897         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2898         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2899     12  SF-ST-REFUND-OPTIONS.
  2900         16  SF-ST-RF-LR-CALC               PIC X.
  2901         16  SF-ST-RF-LL-CALC               PIC X.
  2902         16  SF-ST-RF-LN-CALC               PIC X.
  2903         16  SF-ST-RF-AH-CALC               PIC X.
  2904         16  SF-ST-RF-CP-CALC               PIC X.
  2905     12  SF-ST-UNEARN-PREM-OPTIONS.
  2906         16  SF-ST-LUEP-R78                 PIC X.
  2907         16  SF-ST-LUEP-PRO                 PIC X.
  2908         16  SF-ST-LUEP-ST                  PIC X.
  2909         16  SF-ST-LUEP-DOM                 PIC X.
  2910         16  SF-ST-AUEP-R78                 PIC X.
  2911         16  SF-ST-AUEP-PRO                 PIC X.
  2912         16  SF-ST-AUEP-ST                  PIC X.
  2913         16  SF-ST-AUEP-DOM                 PIC X.
  2914         16  SF-ST-CUEP-R78                 PIC X.
  2915         16  SF-ST-CUEP-PRO                 PIC X.
  2916         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  55
* EL050.cbl
  2917         16  SF-ST-CUEP-DOM                 PIC X.
  2918     12  SF-ST-EARN-PREM-OPTIONS.
  2919         16  SF-ST-LEP-R78                  PIC X.
  2920         16  SF-ST-LEP-PRO                  PIC X.
  2921         16  SF-ST-LEP-ST                   PIC X.
  2922         16  SF-ST-LEP-DOM                  PIC X.
  2923         16  SF-ST-AEP-R78                  PIC X.
  2924         16  SF-ST-AEP-PRO                  PIC X.
  2925         16  SF-ST-AEP-ST                   PIC X.
  2926         16  SF-ST-AEP-DOM                  PIC X.
  2927         16  SF-ST-CEP-R78                  PIC X.
  2928         16  SF-ST-CEP-PRO                  PIC X.
  2929         16  SF-ST-CEP-ST                   PIC X.
  2930         16  SF-ST-CEP-DOM                  PIC X.
  2931     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  56
* EL050.cbl
  2933*    COPY ELCCRTT.
  2934******************************************************************
  2935*                                                                *
  2936*                            ELCCRTT.                            *
  2937*                                                                *
  2938*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2939*                                                                *
  2940*   FILE TYPE = VSAM,KSDS                                        *
  2941*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2942*                                                                *
  2943*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2944*                                                                *
  2945*   LOG = YES                                                    *
  2946*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2947******************************************************************
  2948*                   C H A N G E   L O G
  2949*
  2950* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2951*-----------------------------------------------------------------
  2952*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2953* EFFECTIVE    NUMBER
  2954*-----------------------------------------------------------------
  2955* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2956* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2957* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2958* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2959* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2960* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2961* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2962******************************************************************
  2963
  2964 01  CERTIFICATE-TRAILERS.
  2965     12  CS-RECORD-ID                      PIC XX.
  2966         88  VALID-CS-ID                      VALUE 'CS'.
  2967
  2968     12  CS-CONTROL-PRIMARY.
  2969         16  CS-COMPANY-CD                 PIC X.
  2970         16  CS-CARRIER                    PIC X.
  2971         16  CS-GROUPING                   PIC X(6).
  2972         16  CS-STATE                      PIC XX.
  2973         16  CS-ACCOUNT                    PIC X(10).
  2974         16  CS-CERT-EFF-DT                PIC XX.
  2975         16  CS-CERT-NO.
  2976             20  CS-CERT-PRIME             PIC X(10).
  2977             20  CS-CERT-SFX               PIC X.
  2978         16  CS-TRAILER-TYPE               PIC X.
  2979             88  COMM-TRLR           VALUE 'A'.
  2980             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2981             88  CERT-DATA-TRLR      VALUE 'C'.
  2982
  2983     12  CS-DATA-AREA                      PIC X(516).
  2984
  2985     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2986         16  CS-BANK-COMMISSION-AREA.
  2987             20  CS-BANK-COMMS       OCCURS 10.
  2988                 24  CS-AGT                PIC X(10).
  2989                 24  CS-COM-TYP            PIC X.
  2990                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  57
* EL050.cbl
  2991                 24  CS-RECALC-LV-INDIC    PIC X.
  2992                 24  FILLER                PIC X(10).
  2993         16  FILLER                        PIC X(256).
  2994
  2995     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2996****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2997         16  CS-MB-CLAIM-DATA OCCURS 24.
  2998             20  CS-CLAIM-NO               PIC X(7).
  2999             20  CS-CLAIM-TYPE             PIC X.
  3000                 88  CS-AH-CLM               VALUE 'A'.
  3001                 88  CS-IU-CLM               VALUE 'I'.
  3002                 88  CS-GP-CLM               VALUE 'G'.
  3003                 88  CS-LF-CLM               VALUE 'L'.
  3004                 88  CS-PR-CLM               VALUE 'P'.
  3005                 88  CS-FL-CLM               VALUE 'F'.
  3006             20  CS-INSURED-TYPE           PIC X.
  3007                 88  CS-PRIM-INSURED          VALUE 'P'.
  3008                 88  CS-CO-BORROWER           VALUE 'C'.
  3009             20  CS-BENEFIT-PERIOD         PIC 99.
  3010             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3011             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3012             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3013         16  FILLER                        PIC X(12).
  3014     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3015         16  CS-VIN-NUMBER                 PIC X(17).
  3016         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3017         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3018         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3019         16  FILLER                        PIC X(496).
  3020*    COPY ELCCRTO.
  3021******************************************************************
  3022*                                                                *
  3023*                            ELCCRTO.                            *
  3024*                                                                *
  3025*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3026*                                                                *
  3027*   FILE TYPE = VSAM,KSDS                                        *
  3028*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3029*                                                                *
  3030*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3031*                                                                *
  3032*   LOG = YES                                                    *
  3033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3034******************************************************************
  3035*                   C H A N G E   L O G
  3036*
  3037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3038*-----------------------------------------------------------------
  3039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3040* EFFECTIVE    NUMBER
  3041*-----------------------------------------------------------------
  3042* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3043* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3044* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3045* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3046* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3047******************************************************************
  3048 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  58
* EL050.cbl
  3049     12  OC-RECORD-ID                      PIC XX.
  3050         88  VALID-OC-ID                      VALUE 'OC'.
  3051     12  OC-CONTROL-PRIMARY.
  3052         16  OC-COMPANY-CD                 PIC X.
  3053         16  OC-CARRIER                    PIC X.
  3054         16  OC-GROUPING                   PIC X(6).
  3055         16  OC-STATE                      PIC XX.
  3056         16  OC-ACCOUNT                    PIC X(10).
  3057         16  OC-CERT-EFF-DT                PIC XX.
  3058         16  OC-CERT-NO.
  3059             20  OC-CERT-PRIME             PIC X(10).
  3060             20  OC-CERT-SFX               PIC X.
  3061         16  OC-RECORD-TYPE                PIC X.
  3062         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3063     12  OC-LAST-MAINT-DT                  PIC XX.
  3064     12  OC-LAST-MAINT-BY                  PIC X(4).
  3065     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3066     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3067     12  FILLER                            PIC X(49).
  3068     12  OC-ORIG-REC.
  3069         16  OC-INS-LAST-NAME              PIC X(15).
  3070         16  OC-INS-FIRST-NAME             PIC X(10).
  3071         16  OC-INS-MIDDLE-INIT            PIC X.
  3072         16  OC-INS-AGE                    PIC S999     COMP-3.
  3073         16  OC-JNT-LAST-NAME              PIC X(15).
  3074         16  OC-JNT-FIRST-NAME             PIC X(10).
  3075         16  OC-JNT-MIDDLE-INIT            PIC X.
  3076         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3077         16  OC-LF-BENCD                   PIC XX.
  3078         16  OC-LF-TERM                    PIC S999      COMP-3.
  3079         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3080         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3081         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3082         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3083         16  OC-LF-EXP-DT                  PIC XX.
  3084         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3085         16  OC-LF-CANCEL-DT               PIC XX.
  3086         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3087         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3088         16  OC-AH-BENCD                   PIC XX.
  3089         16  OC-AH-TERM                    PIC S999      COMP-3.
  3090         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3091         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3092         16  OC-AH-EXP-DT                  PIC XX.
  3093         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3094         16  OC-AH-CP                      PIC 99.
  3095         16  OC-AH-CANCEL-DT               PIC XX.
  3096         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3097         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3098         16  OC-CRED-BENE-NAME             PIC X(25).
  3099         16  OC-1ST-PMT-DT                 PIC XX.
  3100         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3101         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3102         16  OC-ISSUE-TRAN-IND             PIC X.
  3103         16  OC-CANCEL-TRAN-IND            PIC X.
  3104         16  FILLER                        PIC X(211).
  3105
  3106     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  59
* EL050.cbl
  3107******************************************************************
  3108
  3109*    COPY ELCDATE.
  3110******************************************************************
  3111*                                                                *
  3112*                                                                *
  3113*                            ELCDATE.                            *
  3114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3115*                            VMOD=2.003
  3116*                                                                *
  3117*                                                                *
  3118*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3119*                 LENGTH = 200                                   *
  3120******************************************************************
  3121
  3122 01  DATE-CONVERSION-DATA.
  3123     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3124     12  DC-OPTION-CODE                PIC X.
  3125         88  BIN-TO-GREG                VALUE ' '.
  3126         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3127         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3128         88  YMD-GREG-TO-BIN            VALUE '3'.
  3129         88  MDY-GREG-TO-BIN            VALUE '4'.
  3130         88  JULIAN-TO-BIN              VALUE '5'.
  3131         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3132         88  FIND-CENTURY               VALUE '7'.
  3133         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3134         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3135         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3136         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3137         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3138         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3139         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3140         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3141         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3142         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3143         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3144         88  BIN-3-TO-GREG              VALUE 'I'.
  3145         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3146         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3147         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3148         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3149         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3150         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3151         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3152         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3153         88  THREE-CHARACTER-BIN
  3154                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3155         88  GREGORIAN-TO-BIN
  3156                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3157         88  BIN-TO-GREGORIAN
  3158                  VALUES ' ' '1' 'I' '8' 'G'.
  3159         88  JULIAN-TO-BINARY
  3160                  VALUES '5' 'C' 'E' 'F'.
  3161     12  DC-ERROR-CODE                 PIC X.
  3162         88  NO-CONVERSION-ERROR        VALUE ' '.
  3163         88  DATE-CONVERSION-ERROR
  3164                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  60
* EL050.cbl
  3165         88  DATE-IS-ZERO               VALUE '1'.
  3166         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3167         88  DATE-IS-INVALID            VALUE '3'.
  3168         88  DATE1-GREATER-DATE2        VALUE '4'.
  3169         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3170         88  DATE-INVALID-OPTION        VALUE '9'.
  3171         88  INVALID-CENTURY            VALUE 'A'.
  3172         88  ONLY-CENTURY               VALUE 'B'.
  3173         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3174         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3175     12  DC-END-OF-MONTH               PIC X.
  3176         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3177     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3178         88  USE-NORMAL-PROCESS         VALUE ' '.
  3179         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3180         88  ADJUST-UP-100-YRS          VALUE '2'.
  3181     12  FILLER                        PIC X.
  3182     12  DC-CONVERSION-DATES.
  3183         16  DC-BIN-DATE-1             PIC XX.
  3184         16  DC-BIN-DATE-2             PIC XX.
  3185         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3186         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3187                       DC-GREG-DATE-1-EDIT.
  3188             20  DC-EDIT1-MONTH        PIC 99.
  3189             20  SLASH1-1              PIC X.
  3190             20  DC-EDIT1-DAY          PIC 99.
  3191             20  SLASH1-2              PIC X.
  3192             20  DC-EDIT1-YEAR         PIC 99.
  3193         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3194         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3195                     DC-GREG-DATE-2-EDIT.
  3196             20  DC-EDIT2-MONTH        PIC 99.
  3197             20  SLASH2-1              PIC X.
  3198             20  DC-EDIT2-DAY          PIC 99.
  3199             20  SLASH2-2              PIC X.
  3200             20  DC-EDIT2-YEAR         PIC 99.
  3201         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3202         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3203                     DC-GREG-DATE-1-YMD.
  3204             20  DC-YMD-YEAR           PIC 99.
  3205             20  DC-YMD-MONTH          PIC 99.
  3206             20  DC-YMD-DAY            PIC 99.
  3207         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3208         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3209                      DC-GREG-DATE-1-MDY.
  3210             20  DC-MDY-MONTH          PIC 99.
  3211             20  DC-MDY-DAY            PIC 99.
  3212             20  DC-MDY-YEAR           PIC 99.
  3213         16  DC-GREG-DATE-1-ALPHA.
  3214             20  DC-ALPHA-MONTH        PIC X(10).
  3215             20  DC-ALPHA-DAY          PIC 99.
  3216             20  FILLER                PIC XX.
  3217             20  DC-ALPHA-CENTURY.
  3218                 24 DC-ALPHA-CEN-N     PIC 99.
  3219             20  DC-ALPHA-YEAR         PIC 99.
  3220         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3221         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3222         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  61
* EL050.cbl
  3223         16  DC-JULIAN-DATE            PIC 9(05).
  3224         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3225                                       PIC 9(05).
  3226         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3227             20  DC-JULIAN-YEAR        PIC 99.
  3228             20  DC-JULIAN-DAYS        PIC 999.
  3229         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3230         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3231         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3232     12  DATE-CONVERSION-VARIBLES.
  3233         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3234         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3235             20  FILLER                PIC 9(3).
  3236             20  HOLD-CEN-1-CCYY.
  3237                 24  HOLD-CEN-1-CC     PIC 99.
  3238                 24  HOLD-CEN-1-YY     PIC 99.
  3239             20  HOLD-CEN-1-MO         PIC 99.
  3240             20  HOLD-CEN-1-DA         PIC 99.
  3241         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3242             20  HOLD-CEN-1-R-MO       PIC 99.
  3243             20  HOLD-CEN-1-R-DA       PIC 99.
  3244             20  HOLD-CEN-1-R-CCYY.
  3245                 24  HOLD-CEN-1-R-CC   PIC 99.
  3246                 24  HOLD-CEN-1-R-YY   PIC 99.
  3247             20  FILLER                PIC 9(3).
  3248         16  HOLD-CENTURY-1-X.
  3249             20  FILLER                PIC X(3)  VALUE SPACES.
  3250             20  HOLD-CEN-1-X-CCYY.
  3251                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3252                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3253             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3254             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3255         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3256             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3257             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3258             20  HOLD-CEN-1-R-X-CCYY.
  3259                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3260                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3261             20  FILLER                PIC XXX.
  3262         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3263         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3264         16  DC-JULIAN-DATE-1          PIC 9(07).
  3265         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3266             20  DC-JULIAN-1-CCYY.
  3267                 24  DC-JULIAN-1-CC    PIC 99.
  3268                 24  DC-JULIAN-1-YR    PIC 99.
  3269             20  DC-JULIAN-DA-1        PIC 999.
  3270         16  DC-JULIAN-DATE-2          PIC 9(07).
  3271         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3272             20  DC-JULIAN-2-CCYY.
  3273                 24  DC-JULIAN-2-CC    PIC 99.
  3274                 24  DC-JULIAN-2-YR    PIC 99.
  3275             20  DC-JULIAN-DA-2        PIC 999.
  3276         16  DC-GREG-DATE-A-EDIT.
  3277             20  DC-EDITA-MONTH        PIC 99.
  3278             20  SLASHA-1              PIC X VALUE '/'.
  3279             20  DC-EDITA-DAY          PIC 99.
  3280             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  62
* EL050.cbl
  3281             20  DC-EDITA-CCYY.
  3282                 24  DC-EDITA-CENT     PIC 99.
  3283                 24  DC-EDITA-YEAR     PIC 99.
  3284         16  DC-GREG-DATE-B-EDIT.
  3285             20  DC-EDITB-MONTH        PIC 99.
  3286             20  SLASHB-1              PIC X VALUE '/'.
  3287             20  DC-EDITB-DAY          PIC 99.
  3288             20  SLASHB-2              PIC X VALUE '/'.
  3289             20  DC-EDITB-CCYY.
  3290                 24  DC-EDITB-CENT     PIC 99.
  3291                 24  DC-EDITB-YEAR     PIC 99.
  3292         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3293         16  DC-GREG-DATE-CYMD-R REDEFINES
  3294                              DC-GREG-DATE-CYMD.
  3295             20  DC-CYMD-CEN           PIC 99.
  3296             20  DC-CYMD-YEAR          PIC 99.
  3297             20  DC-CYMD-MONTH         PIC 99.
  3298             20  DC-CYMD-DAY           PIC 99.
  3299         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3300         16  DC-GREG-DATE-MDCY-R REDEFINES
  3301                              DC-GREG-DATE-MDCY.
  3302             20  DC-MDCY-MONTH         PIC 99.
  3303             20  DC-MDCY-DAY           PIC 99.
  3304             20  DC-MDCY-CEN           PIC 99.
  3305             20  DC-MDCY-YEAR          PIC 99.
  3306    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3307        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3308    12  DC-EL310-DATE                  PIC X(21).
  3309    12  FILLER                         PIC X(28).
  3310
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  63
* EL050.cbl
  3312*    COPY ELCCALC.
  3313******************************************************************
  3314*                                                                *
  3315*                           ELCCALC.                            *
  3316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3317*                            VMOD=2.025                          *
  3318*                                                                *
  3319*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3320*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3321*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3322*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3323*                                                                *
  3324*  PASSED TO ELRTRM                                              *
  3325*  -----------------                                             *
  3326*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3327*  ORIGINAL TERM                                                 *
  3328*  BEGINNING DATE                                                *
  3329*  ENDING DATE                                                   *
  3330*  COMPANY I.D.                                                  *
  3331*  ACCOUNT MASTER USER FIELD                                     *
  3332*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3333*  FREE LOOK DAYS                                                *
  3334*                                                                *
  3335*  RETURNED FROM ELRTRM                                          *
  3336*  ---------------------                                         *
  3337*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3338*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3339*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3340*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3341*----------------------------------------------------------------*
  3342*  PASSED TO ELRAMT                                              *
  3343*  ----------------                                              *
  3344*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3345*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3346*  ORIGINAL AMOUNT                                               *
  3347*  ALTERNATE BENEFIT (BALLON)                                    *
  3348*  A.P.R. - NET PAY ONLY                                         *
  3349*  METHOD
  3350*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3351*  COMPANY I.D.                                                  *
  3352*  BENEFIT TYPE                                                  *
  3353*                                                                *
  3354*  RETURNED FROM ELRAMT                                          *
  3355*  --------------------                                          *
  3356*  REMAINING AMOUNT 1 - CURRENT                                  *
  3357*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3358*  REMAINING AMOUNT FACTOR
  3359*----------------------------------------------------------------*
  3360*  PASSED TO ELRESV                                              *
  3361*  -----------------                                             *
  3362*  CERTIFICATE EFFECTIVE DATE                                    *
  3363*  VALUATION DATE                                                *
  3364*  PAID THRU DATE                                                *
  3365*  BENEFIT                                                       *
  3366*  INCURRED DATE                                                 *
  3367*  REPORTED DATE                                                 *
  3368*  ISSUE AGE                                                     *
  3369*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  64
* EL050.cbl
  3370*  CDT PERCENT                                                   *
  3371*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3372* *CLAIM TYPE (LIFE, A/H)                                        *
  3373* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3374* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3375*                                                                *
  3376*  RETURNED FROM ELRESV                                          *
  3377*  --------------------                                          *
  3378*  CDT TABLE USED                                                *
  3379*  CDT FACTOR USED                                               *
  3380*  PAY TO CURRENT RESERVE                                        *
  3381*  I.B.N.R. - A/H ONLY                                           *
  3382*  FUTURE (ACCRUED) AH ONLY                                      *
  3383*----------------------------------------------------------------*
  3384*  PASSED TO ELRATE                                              *
  3385*  ----------------                                              *
  3386*  CERT ISSUE DATE                                               *
  3387*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3388*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3389*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3390*  STATE CODE (CLIENT DEFINED)                                   *
  3391*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3392*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3393*  DEVIATION CODE                                                *
  3394*  ISSUE AGE                                                     *
  3395*  ORIGINAL BENEFIT AMOUNT                                       *
  3396*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3397*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3398*  BENEFIT KIND (LIFE OR A/H)                                    *
  3399*  A.P.R.                                                        *
  3400*  METHOD
  3401*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3402*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3403*  COMPANY I.D. (3 CHARACTER)                                    *
  3404*  BENEFIT CODE                                                  *
  3405*  BENEFIT OVERRIDE CODE                                         *
  3406*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3407*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3408*  JOINT INDICATOR (CSL ONLY)                                    *
  3409*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3410*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3411*                                                                *
  3412*  RETURNED FROM ELRATE                                          *
  3413*  --------------------                                          *
  3414*  CALCULATED PREMIUM                                            *
  3415*  PREMIUM RATE                                                  *
  3416*  MORTALITY CODE                                                *
  3417*  MAX ATTAINED AGE                                              *
  3418*  MAX AGE                                                       *
  3419*  MAX TERM                                                      *
  3420*  MAX MONTHLY BENEFIT                                           *
  3421*  MAX TOTAL BENIFIT                                             *
  3422*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3423*----------------------------------------------------------------*
  3424*  PASSED TO ELRFND                                              *
  3425*  ----------------                                              *
  3426*  CERT ISSUE DATE                                               *
  3427*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  65
* EL050.cbl
  3428*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3429*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3430*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3431*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3432*  STATE CODE (CLIENT DEFINED)                                   *
  3433*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3434*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3435*  DEVIATION CODE                                                *
  3436*  ISSUE AGE                                                     *
  3437*  ORIGINAL BENEFIT AMOUNT                                       *
  3438*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3439*  PROCESS TYPE (CANCEL)                                         *
  3440*  BENEFIT KIND (LIFE OR A/H)                                    *
  3441*  A.P.R.                                                        *
  3442*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3443*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3444*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3445*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3446*  COMPANY I.D. (3 CHARACTER)                                    *
  3447*  BENEFIT CODE                                                  *
  3448*  BENEFIT OVERRIDE CODE                                         *
  3449*                                                                *
  3450*  RETURNED FROM ELRFND                                          *
  3451*  --------------------                                          *
  3452*  CALCULATED REFUND                                             *
  3453*----------------------------------------------------------------*
  3454*  PASSED TO ELEARN                                              *
  3455*  ----------------                                              *
  3456*  CERT ISSUE DATE                                               *
  3457*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3458*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  STATE CODE (CLIENT DEFINED)                                   *
  3461*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3462*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3463*  DEVIATION CODE                                                *
  3464*  ISSUE AGE                                                     *
  3465*  ORIGINAL BENEFIT AMOUNT                                       *
  3466*  BENEFIT KIND (LIFE OR A/H)                                    *
  3467*  A.P.R.                                                        *
  3468*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3469*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3470*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3471*  COMPANY I.D. (3 CHARACTER)                                    *
  3472*  BENEFIT CODE                                                  *
  3473*  BENEFIT OVERRIDE CODE                                         *
  3474*                                                                *
  3475*  RETURNED FROM ELEARN                                          *
  3476*  --------------------                                          *
  3477*  INDICATED  EARNINGS                                           *
  3478*----------------------------------------------------------------*
  3479*                 LENGTH = 450                                   *
  3480*                                                                *
  3481******************************************************************
  3482******************************************************************
  3483*                   C H A N G E   L O G
  3484*
  3485* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  66
* EL050.cbl
  3486*-----------------------------------------------------------------
  3487*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3488* EFFECTIVE    NUMBER
  3489*-----------------------------------------------------------------
  3490* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3491* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3492* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3493* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3494* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3496* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3497* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3498* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3499******************************************************************
  3500
  3501 01  CALCULATION-PASS-AREA.
  3502     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3503                                     COMP.
  3504
  3505     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3506       88  NO-CP-ERROR                             VALUE ZERO.
  3507       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3508                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3509       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3510       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3511       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3512       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3513       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3514       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3515       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3516       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3517       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3518       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3519       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3520       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3521       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3522       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3523       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3524       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3525       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3526
  3527     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3528       88  NO-CP-ERROR-2                           VALUE ZERO.
  3529***********************  INPUT AREAS ****************************
  3530
  3531     12  CP-CALCULATION-AREA.
  3532         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3533         16  CP-CERT-EFF-DT        PIC XX.
  3534         16  CP-VALUATION-DT       PIC XX.
  3535         16  CP-PAID-THRU-DT       PIC XX.
  3536         16  CP-BENEFIT-TYPE       PIC X.
  3537           88  CP-AH                               VALUE 'A' 'D'
  3538                                                   'I' 'U'.
  3539           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3540           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3541         16  CP-INCURRED-DT        PIC XX.
  3542         16  CP-REPORTED-DT        PIC XX.
  3543         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  67
* EL050.cbl
  3544         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3545         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3546                                     COMP-3.
  3547         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3548                                     COMP-3.
  3549         16  CP-CDT-METHOD         PIC X.
  3550           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3551           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3552           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3553         16  CP-CLAIM-TYPE         PIC X.
  3554           88  CP-AH-CLAIM                         VALUE 'A'.
  3555           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3556         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3557                                     COMP-3.
  3558         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3559                                     COMP-3.
  3560         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3563                                     COMP-3.
  3564         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3569                                     COMP-3.
  3570         16  CP-REM-TERM-METHOD    PIC X.
  3571           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3572           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3573           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3574           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3575           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3576           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3577           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3578         16  CP-EARNING-METHOD     PIC X.
  3579           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3580           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3581           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3582           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3583           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3584           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3585           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3586           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3587           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3588           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3589           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3590           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3591           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3592           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3593         16  CP-PROCESS-TYPE       PIC X.
  3594           88  CP-CLAIM                            VALUE '1'.
  3595           88  CP-CANCEL                           VALUE '2'.
  3596           88  CP-ISSUE                            VALUE '3'.
  3597         16  CP-SPECIAL-CALC-CD    PIC X.
  3598           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3599           88  CP-1-MTH-INTEREST               VALUE ' '.
  3600           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3601           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  68
* EL050.cbl
  3602           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3603           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3604           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3605           88  CP-FARM-PLAN                    VALUE 'F'.
  3606           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3607           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3608           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3609           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3610           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3611           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3612           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3613           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3614           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3615           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3616                                                     'W' 'X'.
  3617           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3618           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3619           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3620           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3621           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3622           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3623           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3624           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3625           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3626           88  CP-CSL-METH-1                   VALUE '5'.
  3627           88  CP-CSL-METH-2                   VALUE '6'.
  3628           88  CP-CSL-METH-3                   VALUE '7'.
  3629           88  CP-CSL-METH-4                   VALUE '8'.
  3630
  3631         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3632                                     COMP-3.
  3633         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3634         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3635         16  CP-STATE              PIC XX          VALUE SPACE.
  3636         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3637         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3638           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3639               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3640         16  CP-R78-OPTION         PIC X.
  3641           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3642           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3643
  3644         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3645         16  CP-IBNR-RESERVE-SW    PIC X.
  3646         16  CP-CLAIM-STATUS       PIC X.
  3647         16  CP-RATE-FILE          PIC X.
  3648         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3649                                     COMP-3.
  3650
  3651         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3652         16  CP-AH-OVERRIDE-CODE   PIC X.
  3653
  3654         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3655                                     COMP-3.
  3656         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3657                                   PIC S9(5)V99 COMP-3.
  3658         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3659                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  69
* EL050.cbl
  3660         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3665                                  PIC S9(7)V99 COMP-3.
  3666
  3667         16  CP-PAID-FROM-DATE     PIC X(02).
  3668         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3669         16  CP-EXT-DAYS-CALC      PIC X.
  3670           88  CP-EXT-NO-CHG                   VALUE ' '.
  3671           88  CP-EXT-CHG-LF                   VALUE '1'.
  3672           88  CP-EXT-CHG-AH                   VALUE '2'.
  3673           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3674         16  CP-DOMICILE-STATE     PIC XX.
  3675         16  CP-CARRIER            PIC X.
  3676         16  CP-REIN-FLAG          PIC X.
  3677         16  CP-REM-TRM-CALC-OPTION PIC X.
  3678           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3679                      '2' '3' '4' '5'.
  3680           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3681           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3682           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3683           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3684           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3685           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3686           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3687           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3688         16  CP-SIG-SWITCH         PIC X.
  3689         16  CP-RATING-METHOD      PIC X.
  3690           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3691           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3692           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3693           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3694           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3695           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3696           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3697           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3698           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3699         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3700                                     COMP-3.
  3701         16  CP-BEN-CATEGORY       PIC X.
  3702         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3703         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3704                                   PIC S99V9(5) COMP-3.
  3705         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3706         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3707                                   PIC S99V9(5) COMP-3.
  3708         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3709         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3710         16  CP-EXPIRE-DT          PIC XX.
  3711         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3712         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3713         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3714         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3715         16  CP-DDF-SPEC-CALC      PIC X.
  3716             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3717             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  70
* EL050.cbl
  3718         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3719         16  CP-CANCEL-REASON      PIC X.
  3720         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3721         16  CP-PMT-MODE           PIC X.
  3722         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3723         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3724         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3725         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3726         16  FILLER                PIC X.
  3727
  3728***************    OUTPUT FROM ELRESV   ************************
  3729
  3730         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3731
  3732         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  FILLER                PIC X(09).
  3741***************    OUTPUT FROM ELRTRM   *************************
  3742
  3743         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3750                                     COMP-3.
  3751         16  FILLER                PIC X(12).
  3752
  3753***************    OUTPUT FROM ELRAMT   *************************
  3754
  3755         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  FILLER                PIC X(12).
  3760
  3761***************    OUTPUT FROM ELRATE   *************************
  3762
  3763         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-MORTALITY-CODE     PIC X(4).
  3768         16  CP-RATE-EDIT-FLAG     PIC X.
  3769             88  CP-RATES-NEED-APR                  VALUE '1'.
  3770         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3773         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3774         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3775                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  71
* EL050.cbl
  3776         16  FILLER                PIC X(07).
  3777
  3778***************    OUTPUT FROM ELRFND   *************************
  3779
  3780         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-REFUND-TYPE-USED   PIC X.
  3783           88  CP-R-AS-R78                         VALUE '1'.
  3784           88  CP-R-AS-PRORATA                     VALUE '2'.
  3785           88  CP-R-AS-CALIF                       VALUE '3'.
  3786           88  CP-R-AS-TEXAS                       VALUE '4'.
  3787           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3788           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3789           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3790           88  CP-R-AS-MEAN                        VALUE '8'.
  3791           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3792           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3793           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3794           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3795           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3796           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3797         16  FILLER                PIC X(12).
  3798
  3799***************    OUTPUT FROM ELEARN   *************************
  3800
  3801         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-EARNING-TYPE-USED  PIC X.
  3814           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3815           88  CP-E-AS-R78                         VALUE '1'.
  3816           88  CP-E-AS-PRORATA                     VALUE '2'.
  3817           88  CP-E-AS-TEXAS                       VALUE '4'.
  3818           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3819           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3820           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3821           88  CP-E-AS-MEAN                        VALUE '8'.
  3822           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3823         16  FILLER                PIC X(12).
  3824
  3825***************    OUTPUT FROM ELPMNT   *************************
  3826
  3827         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3830                                     COMP-3.
  3831         16  FILLER                PIC X(12).
  3832
  3833***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  72
* EL050.cbl
  3834         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3847             88  OPEN-RATE-FILE                   VALUE 'O'.
  3848             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3849             88  IO-ERROR                         VALUE 'E'.
  3850
  3851         16  CP-FIRST-PAY-DATE     PIC XX.
  3852
  3853         16  CP-JOINT-INDICATOR    PIC X.
  3854
  3855         16  CP-RESERVE-REMAINING-TERM
  3856                                   PIC S9(4)V9    VALUE ZERO
  3857                                     COMP-3.
  3858
  3859         16  CP-INSURED-BIRTH-DT   PIC XX.
  3860
  3861         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3862                                     COMP-3.
  3863
  3864         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3865                                     COMP-3.
  3866
  3867         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3868                                     COMP-3.
  3869
  3870         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3871                                     COMP-3.
  3872
  3873         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3874                                     COMP-3.
  3875
  3876         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3877                                     COMP-3.
  3878
  3879         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3880                                     COMP-3.
  3881
  3882         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3883             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3884
  3885         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3886                                     COMP-3.
  3887         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3888                                     COMP-3.
  3889         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3890         16  FILLER                PIC X(15).
  3891******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  73
* EL050.cbl
  3893******************************************************************
  3894*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3895*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3896*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3897*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3898*** MODIFICATION.                                              ***
  3899*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3900*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3901******************************************************************
  3902*    COPY ERCPNDB.
  3903******************************************************************
  3904*                                                                *
  3905*                                                                *
  3906*                            ERCPNDB.                            *
  3907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3908*                            VMOD=2.025                          *
  3909*                                                                *
  3910*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3911*                                                                *
  3912******************************************************************
  3913*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3914*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3915******************************************************************
  3916*                                                                *
  3917*                                                                *
  3918*   FILE TYPE = VSAM,KSDS                                        *
  3919*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3920*                                                                *
  3921*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3922*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3923*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3924*                                                 RKP=13,LEN=36  *
  3925*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3926*                                      AND CHG-SEQ.)             *
  3927*                                                RKP=49,LEN=11   *
  3928*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3929*                                      AND CHG-SEQ.)             *
  3930*                                                RKP=60,LEN=15   *
  3931*                                                                *
  3932*   LOG = NO                                                     *
  3933*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3934******************************************************************
  3935******************************************************************
  3936*                   C H A N G E   L O G
  3937*
  3938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3939*-----------------------------------------------------------------
  3940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3941* EFFECTIVE    NUMBER
  3942*-----------------------------------------------------------------
  3943* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3944* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3945* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3946* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3947* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3948* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3949* 032306                   PEMA  ADD BOW LOAN NUMBER
  3950* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  74
* EL050.cbl
  3951* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3952* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3953* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3954* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3955* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3956* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3957* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3958* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3959******************************************************************
  3960
  3961 01  PENDING-BUSINESS.
  3962     12  PB-RECORD-ID                     PIC XX.
  3963         88  VALID-PB-ID                        VALUE 'PB'.
  3964
  3965     12  PB-CONTROL-PRIMARY.
  3966         16  PB-COMPANY-CD                PIC X.
  3967         16  PB-ENTRY-BATCH               PIC X(6).
  3968         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3969         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3970
  3971     12  PB-CONTROL-BY-ACCOUNT.
  3972         16  PB-COMPANY-CD-A1             PIC X.
  3973         16  PB-CARRIER                   PIC X.
  3974         16  PB-GROUPING.
  3975             20  PB-GROUPING-PREFIX       PIC XXX.
  3976             20  PB-GROUPING-PRIME        PIC XXX.
  3977         16  PB-STATE                     PIC XX.
  3978         16  PB-ACCOUNT.
  3979             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3980             20  PB-ACCOUNT-PRIME         PIC X(6).
  3981         16  PB-CERT-EFF-DT               PIC XX.
  3982         16  PB-CERT-NO.
  3983             20  PB-CERT-PRIME            PIC X(10).
  3984             20  PB-CERT-SFX              PIC X.
  3985         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3986
  3987         16  PB-RECORD-TYPE               PIC X.
  3988             88  PB-MAILING-DATA                VALUE '0'.
  3989             88  PB-ISSUE                       VALUE '1'.
  3990             88  PB-CANCELLATION                VALUE '2'.
  3991             88  PB-BATCH-TRAILER               VALUE '9'.
  3992
  3993     12  PB-CONTROL-BY-ORIG-BATCH.
  3994         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3995         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3996         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3997         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3998
  3999     12  PB-CONTROL-BY-CSR.
  4000         16  PB-CSR-COMPANY-CD            PIC X.
  4001         16  PB-CSR-ID                    PIC X(4).
  4002         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4003         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4004         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4005******************************************************************
  4006*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4007******************************************************************
  4008
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  75
* EL050.cbl
  4009     12  PB-LAST-MAINT-DT                 PIC XX.
  4010     12  PB-LAST-MAINT-BY                 PIC X(4).
  4011     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4012
  4013     12  PB-RECORD-BODY                   PIC X(375).
  4014
  4015     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4016         16  PB-CERT-ORIGIN               PIC X.
  4017             88  CLASIC-CREATED-CERT         VALUE '1'.
  4018         16  PB-I-NAME.
  4019             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4020             20  PB-I-INSURED-FIRST-NAME.
  4021                 24  PB-I-INSURED-1ST-INIT PIC X.
  4022                 24  FILLER                PIC X(9).
  4023             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4024         16  PB-I-AGE                     PIC S99   COMP-3.
  4025         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4026         16  PB-I-BIRTHDAY                PIC XX.
  4027         16  PB-I-INSURED-SEX             PIC X.
  4028             88  PB-SEX-MALE     VALUE 'M'.
  4029             88  PB-SEX-FEMALE   VALUE 'F'.
  4030
  4031         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4032         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4033         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4034         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4035         16  PB-I-SKIP-CODE               PIC X.
  4036             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4037             88  PB-SKIP-JULY              VALUE '1'.
  4038             88  PB-SKIP-AUGUST            VALUE '2'.
  4039             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4040             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4041             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4042             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4043             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4044             88  PB-SKIP-JUNE              VALUE '8'.
  4045             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4046             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4047             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4048         16  PB-I-TERM-TYPE               PIC X.
  4049             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4050             88  PB-PAID-WEEKLY            VALUE 'W'.
  4051             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4052             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4053             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4054         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4055         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4056         16  PB-I-DATA-ENTRY-SW           PIC X.
  4057             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4058             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4059             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4060             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4061         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4062         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4063*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4064         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4065         16  FILLER                       PIC X.
  4066
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  76
* EL050.cbl
  4067         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4068             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4069             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4070                                                   '90' THRU '99'.
  4071         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4072                                          PIC XX.
  4073         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4074         16  PB-I-AMOUNT-FINANCED REDEFINES
  4075                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4076         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4077         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4078                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4079         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4080         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4081         16  PB-I-CLP-AMOUNT REDEFINES
  4082                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4083         16  PB-I-LF-CALC-FLAG            PIC X.
  4084             88 PB-COMP-LF-PREM               VALUE '?'.
  4085         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4086         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4087         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4088         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4089         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4090         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4091         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4092         16  PB-I-LF-ABBR                 PIC XXX.
  4093         16  PB-I-LF-INPUT-CD             PIC XX.
  4094
  4095         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4096             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4097             88  PB-INVALID-AH               VALUE '  ' '00'
  4098                                                   '90' THRU '99'.
  4099         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4100         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4101         16  PB-I-AH-CALC-FLAG            PIC X.
  4102             88 PB-COMP-AH-PREM                  VALUE '?'.
  4103         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4104         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4105         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4106         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4107         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4108         16  PB-I-AH-ABBR                 PIC XXX.
  4109         16  PB-I-AH-INPUT-CD             PIC XXX.
  4110
  4111         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4112         16  PB-I-REIN-TABLE              PIC XXX.
  4113         16  PB-I-BUSINESS-TYPE           PIC 99.
  4114         16  PB-I-INDV-GRP-CD             PIC X.
  4115         16  PB-I-MORT-CODE.
  4116             20  PB-I-TABLE               PIC X.
  4117             20  PB-I-INTEREST            PIC XX.
  4118             20  PB-I-MORT-TYP            PIC X.
  4119         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4120         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4121         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4122         16  PB-I-INDV-GRP-OVRD           PIC X.
  4123         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4124         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  77
* EL050.cbl
  4125             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4126         16  PB-I-RATE-CLASS              PIC XX.
  4127         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4128         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4129         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4130         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4131         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4132         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4133         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4134         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4135         16  PB-I-OB-FLAG                 PIC X.
  4136             88  PB-I-OB                      VALUE 'B'.
  4137             88  PB-I-SUMMARY                 VALUE 'Z'.
  4138         16  PB-I-ENTRY-STATUS            PIC X.
  4139             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4140                                              'M' '5' '9' '2'.
  4141             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4142             88  PB-I-POLICY-PENDING          VALUE '2'.
  4143             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4144             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4145             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4146             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4147             88  PB-I-REIN-ONLY               VALUE '9'.
  4148             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4149             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4150             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4151             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4152         16  PB-I-INT-CODE                PIC X.
  4153             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4154             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4155         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4156         16  PB-I-SOC-SEC-NO              PIC X(11).
  4157         16  PB-I-MEMBER-NO               PIC X(12).
  4158         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4159*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4160         16  PB-I-OLD-LOF                 PIC XXX.
  4161         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4162         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4163         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4164         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4165         16  PB-I-LIFE-INDICATOR          PIC X.
  4166             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4167         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4168         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4169                                          PIC S9(5)V99    COMP-3.
  4170         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4171             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4172             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4173         16  PB-I-1ST-PMT-DT              PIC XX.
  4174         16  PB-I-JOINT-INSURED.
  4175             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4176             20 PB-I-JOINT-FIRST-NAME.
  4177                24  PB-I-JOINT-FIRST-INIT PIC X.
  4178                24  FILLER                PIC X(9).
  4179             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4180*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4181         16  PB-I-BENEFICIARY-NAME.
  4182             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  78
* EL050.cbl
  4183             20  FILLER                   PIC X(15).
  4184         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4185         16  PB-I-REFERENCE               PIC X(12).
  4186         16  FILLER REDEFINES PB-I-REFERENCE.
  4187             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4188             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4189             20  PB-I-CLP-STATE           PIC XX.
  4190         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4191             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4192             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4193             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4194         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4195         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4196         16  PB-I-RESIDENT-STATE          PIC XX.
  4197         16  PB-I-RATE-CODE               PIC X(4).
  4198         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4199         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4200         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4201         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4202         16  PB-I-BANK-NOCHRGB            PIC 99.
  4203         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4204         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4205
  4206     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4207         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4208             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4209         16  PB-C-CANCEL-ORIGIN           PIC X.
  4210             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4211         16  PB-C-LF-CANCEL-DT            PIC XX.
  4212         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4213         16  PB-C-LF-CALC-REQ             PIC X.
  4214             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4215         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4216         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4217         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4218             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4219         16  PB-C-AH-CANCEL-DT            PIC XX.
  4220         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4221         16  PB-C-AH-CALC-REQ             PIC X.
  4222             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4223         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4224         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4225         16  PB-C-LAST-NAME               PIC X(15).
  4226         16  PB-C-REFUND-SW               PIC X.
  4227             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4228             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4229         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4230         16  PB-C-PAYEE-CODE              PIC X(6).
  4231         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4232         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4233         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4234         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4235         16  PB-C-REFERENCE               PIC X(12).
  4236         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4238         16  PB-C-POST-CARD-IND           PIC X.
  4239         16  PB-C-CANCEL-REASON           PIC X.
  4240         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  79
* EL050.cbl
  4241         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4242         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4243         16  FILLER                       PIC X(01).
  4244*        16  FILLER                       PIC X(18).
  4245         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4246*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4247         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4248         16  PB-CANCELED-CERT-DATA.
  4249             20  PB-CI-INSURED-NAME.
  4250                 24  PB-CI-LAST-NAME      PIC X(15).
  4251                 24  PB-CI-INITIALS       PIC XX.
  4252             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4253             20  PB-CI-INSURED-SEX        PIC X.
  4254             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4255             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4256             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4257             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4258             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4259             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4260             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4261             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4262             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4263             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4264             20  PB-CI-RATE-CLASS         PIC XX.
  4265             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4266             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4267             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4268             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4269             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4270             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4271             20  PB-CI-LF-ABBR            PIC X(3).
  4272             20  PB-CI-AH-ABBR            PIC X(3).
  4273             20  PB-CI-OB-FLAG            PIC X.
  4274                 88  PB-CI-OB                VALUE 'B'.
  4275             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4276                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4277                                           'M' '4' '5' '9' '2'.
  4278                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4279                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4280                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4281                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4282                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4283                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4284                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4285                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4286                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4287                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4288                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4289                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4290                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4291             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4292                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4293                                           'M' '4' '5' '9' '2'.
  4294                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4295                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4296                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4297                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4298                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  80
* EL050.cbl
  4299                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4300                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4301                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4302                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4303                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4304                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4305                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4306                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4307             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4308             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4309             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4310             20  PB-CI-MEMBER-NO          PIC X(12).
  4311             20  PB-CI-INT-CODE           PIC X.
  4312                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4313                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4314             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4315             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4316             20  PB-CI-COMP-EXCP-SW       PIC X.
  4317                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4318                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4319             20  PB-CI-ENTRY-STATUS       PIC X.
  4320             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4321             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4322             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4323             20  PB-CI-DEATH-DT           PIC XX.
  4324             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4325             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4326             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4327             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4328             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4329             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4330             20  PB-CI-ENTRY-DT              PIC XX.
  4331             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4332             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4333             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4334             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4335             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4336             20  PB-CI-OLD-LOF               PIC XXX.
  4337*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4338             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4339             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4340             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4341             20  PB-CI-INDV-GRP-CD           PIC X.
  4342             20  PB-CI-BENEFICIARY-NAME.
  4343                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4344                 24  FILLER                  PIC X(15).
  4345             20  PB-CI-NOTE-SW               PIC X.
  4346             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4347             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4348             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4349             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4350             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4351             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4352             20  PB-CI-FIRST-NAME            PIC X(10).
  4353             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4354
  4355         16  FILLER                       PIC X(13).
  4356*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  81
* EL050.cbl
  4357*        16  FILLER                       PIC X(46).
  4358
  4359     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4360         16  FILLER                       PIC X(10).
  4361         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4362         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4363         16  PB-M-INSURED-MID-INIT        PIC X.
  4364         16  PB-M-INSURED-AGE             PIC 99.
  4365         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4366         16  PB-M-INSURED-SEX             PIC X.
  4367         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4368         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4369         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4370         16  PB-M-INSURED-CITY-STATE.
  4371             20  PB-M-INSURED-CITY        PIC X(28).
  4372             20  PB-M-INSURED-STATE       PIC XX.
  4373         16  PB-M-INSURED-ZIP-CODE.
  4374             20  PB-M-INSURED-ZIP-PRIME.
  4375                 24  PB-M-INSURED-ZIP-1   PIC X.
  4376                     88  PB-M-CANADIAN-POST-CODE
  4377                                             VALUE 'A' THRU 'Z'.
  4378                 24  FILLER               PIC X(4).
  4379             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4380         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4381                                        PB-M-INSURED-ZIP-CODE.
  4382             20  PM-M-INS-CAN-POST1       PIC XXX.
  4383             20  PM-M-INS-CAN-POST2       PIC XXX.
  4384             20  FILLER                   PIC XXX.
  4385         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4386         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4387         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4388         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4389         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4390         16  PB-M-CRED-BENE-CITYST.
  4391             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4392             20  PB-M-CRED-BENE-STATE     PIC XX.
  4393         16  FILLER                       PIC X(92).
  4394
  4395     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4398         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4399         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4400         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4401         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4402         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4403         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4404         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4405         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4406         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4407         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4408         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4409         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4410         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4411         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4412         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4413         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4414         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  82
* EL050.cbl
  4415         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4416         16  PB-REFERENCE                 PIC X(12).
  4417         16  PB-B-RECEIVED-DT             PIC XX.
  4418         16  FILLER                       PIC X(234).
  4419
  4420     12  PB-RECORD-STATUS.
  4421         16  PB-CREDIT-SELECT-DT          PIC XX.
  4422         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4423         16  PB-BILLED-DT                 PIC XX.
  4424         16  PB-BILLING-STATUS            PIC X.
  4425             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4426             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4427             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4428         16  PB-RECORD-BILL               PIC X.
  4429             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4430             88  PB-RECORD-RETURNED           VALUE 'R'.
  4431             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4432             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4433             88  PB-OVERRIDE-AH               VALUE 'A'.
  4434             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4435         16  PB-BATCH-ENTRY               PIC X.
  4436             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4437             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4438             88  PB-REISSUED-CERT             VALUE 'E'.
  4439             88  PB-CASH-CERT                 VALUE 'C'.
  4440             88  PB-MONTHLY-CERT              VALUE 'M'.
  4441             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4442             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4443             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4444         16  PB-FORCE-CODE                PIC X.
  4445             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4446             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4447             88  PB-CANCEL-FORCE              VALUE '8'.
  4448             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4449             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4450             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4451             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4452             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4453             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4454             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4455         16  PB-FATAL-FLAG                PIC X.
  4456             88  PB-FATAL-ERRORS              VALUE 'X'.
  4457         16  PB-FORCE-ER-CD               PIC X.
  4458             88  PB-FORCE-ERRORS              VALUE 'F'.
  4459             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4460         16  PB-WARN-ER-CD                PIC X.
  4461             88  PB-WARNING-ERRORS            VALUE 'W'.
  4462         16  FILLER                       PIC X.
  4463         16  PB-OUT-BAL-CD                PIC X.
  4464             88  PB-OUT-OF-BAL                VALUE 'O'.
  4465         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4466         16  PB-AH-OVERRIDE-L1            PIC X.
  4467         16  PB-INPUT-DT                  PIC XX.
  4468         16  PB-INPUT-BY                  PIC X(4).
  4469         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4470         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4471         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4472         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  83
* EL050.cbl
  4473         16  PB-AH-EARNING-METHOD         PIC X.
  4474         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4475         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4476         16  PB-REIN-CD                   PIC XXX.
  4477         16  PB-LF-REFUND-TYPE            PIC X.
  4478         16  PB-AH-REFUND-TYPE            PIC X.
  4479         16  PB-ACCT-EFF-DT               PIC XX.
  4480         16  PB-ACCT-EXP-DT               PIC XX.
  4481         16  PB-COMPANY-ID                PIC X(3).
  4482         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4483         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4484         16  PB-SV-CARRIER                PIC X.
  4485         16  PB-SV-GROUPING               PIC X(6).
  4486         16  PB-SV-STATE                  PIC XX.
  4487         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4488         16  PB-GA-BILLING-INFO.
  4489             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4490                                          PIC XX.
  4491         16  PB-SV-REMIT-TO  REDEFINES
  4492             PB-GA-BILLING-INFO           PIC X(10).
  4493         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4494         16  PB-I-LOAN-OFFICER            PIC X(5).
  4495         16  PB-I-VIN                     PIC X(17).
  4496
  4497         16  FILLER                       PIC X(04).
  4498         16  IMNET-BYPASS-SW              PIC X.
  4499
  4500******************************************************************
  4501*                COMMON EDIT ERRORS                              *
  4502******************************************************************
  4503
  4504     12  PB-COMMON-ERRORS.
  4505         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4506                                           PIC S9(4)     COMP.
  4507
  4508******************************************************************
  4509
  4510* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4511*    COPY ELC50W1.
  4512******************************************************************
  4513*                                                                *
  4514*                                                                *
  4515*                             ELC50W1                            *
  4516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4517*                            VMOD=2.004                          *
  4518*                                                                *
  4519*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4520*                                                                *
  4521*                                                                *
  4522******************************************************************
  4523
  4524     12  WK-WORK-AREA.
  4525         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4526         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4527         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4528         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4529         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4530         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  84
* EL050.cbl
  4531         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4532         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4533         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4534         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4535         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4536         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4537         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4538         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4539         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4540         16  WK-CREDIT-EDIT-CONTROLS.
  4541             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4542             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4543             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4544             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4545             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4546             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4547         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4548         16  WK-SAVE-REIN-DATA.
  4549             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4550             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4551             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4552         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4553             88  ENTRY-FROM-EL6311       VALUE '6'.
  4554         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4555         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4556     12  WK-RECORD-ADDRESSES.
  4557         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4558         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4559         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4560         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4561         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4562         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4563         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4564         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4565     12  WK-OVER-SHORT-AREA.
  4566         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4567         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4568         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4569             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4570         16  FILLER                   PIC X(5) VALUE SPACES.
  4571
  4572*    COPY ELCEDITC.
  4573******************************************************************
  4574*                                                                *
  4575*                                                                *
  4576*                            ELCEDITC                            *
  4577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4578*                            VMOD=2.012                          *
  4579*                                                                *
  4580*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4581*                     EL6313, EL050 AND EL517.                   *
  4582*                                                                *
  4583******************************************************************
  4584******************************************************************
  4585*                   C H A N G E   L O G
  4586*
  4587* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4588*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  85
* EL050.cbl
  4589*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4590* EFFECTIVE    NUMBER
  4591*-----------------------------------------------------------------
  4592* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4593******************************************************************
  4594
  4595     12  EDIT-CRITERIA-DATA.
  4596         16  EC-CO-MONTH-END-DT       PIC XX.
  4597         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4598         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4599         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4600         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4601         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4602         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4603         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4604         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4605         16  EC-CO-REM-TERM-CALC      PIC X.
  4606               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4607               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4608               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4609               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4610
  4611         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4612               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4613               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4614               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4615               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4616               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4617               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4618               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4619               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4620               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4621               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4622
  4623         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4624               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4625               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4626               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4627               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4628               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4629               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4630               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4631               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4632
  4633         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4634                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4635                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4636
  4637         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4638                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4639                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4640                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4641                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4642                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4643                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4644                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4645                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4646
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  86
* EL050.cbl
  4647         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4648               88  EC-BR-REDUCING                   VALUE 'R'.
  4649               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4650
  4651         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4652         16  EC-BR-LF-DESC             PIC X(10).
  4653         16  EC-BR-AH-DESC             PIC X(10).
  4654         16  EC-BR-LF-COMMENT          PIC X(10).
  4655         16  EC-BR-AH-COMMENT          PIC X(10).
  4656
  4657         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4658               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4659               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4660               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4661               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4662
  4663         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4664               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4665               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4666               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4667               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4668
  4669         16  EC-BR-LF-REFUND-CALC      PIC X.
  4670                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4671                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4672                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4673                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4674                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4675                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4676                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4677
  4678         16  EC-BR-AH-REFUND-CALC      PIC X.
  4679                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4680                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4681                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4682                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4683                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4684                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4685                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4686                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4687
  4688         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4689                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4690                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4691                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4692
  4693         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4694                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4695                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4696                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4697
  4698         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4699         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4700         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4701         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4702
  4703         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4704         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  87
* EL050.cbl
  4705                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4706                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4707                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4708                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4709
  4710         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4711               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4712               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4713               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4714               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4715               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4716
  4717         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4718               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4719               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4720               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4721               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4722               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4723
  4724         16  EC-ST-LF-REFUND-CALC      PIC X.
  4725                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4726                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4727                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4728                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4729                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4730                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4731                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4732                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4733
  4734         16  EC-ST-AH-REFUND-CALC      PIC X.
  4735                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4736                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4737                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4738                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4739                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4740                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4741                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4742                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4743
  4744         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4745         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4746         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4747         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4748         16  EC-AM-EXPIRATION-DT       PIC XX.
  4749         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4750         16  EC-AM-CLASS-CD            PIC XX.
  4751         16  EC-AM-LF-DEVIATION        PIC XXX.
  4752         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4753         16  EC-AM-AH-DEVIATION        PIC XXX.
  4754         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4755         16  EC-AM-PHONE-NO            PIC X(10).
  4756
  4757         16  EC-AM-LF-REFUND-CALC      PIC X.
  4758                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4759                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4760                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4761                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4762                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  88
* EL050.cbl
  4763                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4764                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4765
  4766         16  EC-AM-AH-REFUND-CALC      PIC X.
  4767                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4768                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4769                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4770                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4771                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4772                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4773                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4774
  4775         16  EC-AM-BEN-I-G-CD          PIC X.
  4776                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4777                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4778                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4779
  4780         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4781         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4782         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4783         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4784         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4785         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4786         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4787         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4788         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4789
  4790         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4791         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4792         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4793         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4794         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4795         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4796         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4797         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4798         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4799         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4800         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4801         16  EC-RT-LF-NSP-ST           PIC XX.
  4802         16  EC-RT-AH-NSP-ST           PIC XX.
  4803         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4804         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4805
  4806         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4807             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4808                                             'M' '5' '9' '2'.
  4809             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4810             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4811             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4812             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4813             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4814             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4815             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4816             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4817             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4818             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4819
  4820         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  89
* EL050.cbl
  4821             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4822                                             'M' '5' '9' '2'.
  4823             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4824             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4825             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4826             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4827             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4828             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4829             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4830             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4831             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4832             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4833
  4834         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4835         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4836         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4837         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4838         16  EC-CM-DEATH-DT            PIC XX.
  4839
  4840*DMD CUSTOM CODING FIELDS BELOW
  4841*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4842         16  EC-BR-DMD-RATING-SW       PIC X.
  4843                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4844                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4845                 88  NO-DMD-RATING               VALUE 'N'.
  4846
  4847         16  EC-NEW-CERT               PIC X(11).
  4848         16  EC-NEW-STATE              PIC XX.
  4849         16  FILLER                    PIC X.
  4850*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4851         16  OVER-SHORT-EDIT-FIELDS.
  4852             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4853             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4854             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4855             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4856             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4857             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4858             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4859             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4860             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4861         16  FILLER                    PIC X(71).
  4862******************************************************************
  4863
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  90
* EL050.cbl
  4865*    COPY ELCDIFRD.
  4866******************************************************************
  4867*                                                                *
  4868*                                                                *
  4869*                            ELCDIFRD.                           *
  4870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4871*                            VMOD=2.004                          *
  4872*                                                                *
  4873*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4874*                                                                *
  4875******************************************************************
  4876*
  4877  01  WS-DIFFERENCE-CALCULATION.
  4878        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4879        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4880        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4881        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4882        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4883        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4884        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4885        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4886        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4887        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4888        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4889
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  91
* EL050.cbl
  4891****************************************************************
  4892*
  4893* Copyright (c) 2007 by Clerity Solutions, Inc.
  4894* All rights reserved.
  4895*
  4896****************************************************************
  4897 01  DFHEIV.
  4898   02  DFHEIV0               PIC X(35).
  4899   02  DFHEIV1               PIC X(08).
  4900   02  DFHEIV2               PIC X(08).
  4901   02  DFHEIV3               PIC X(08).
  4902   02  DFHEIV4               PIC X(06).
  4903   02  DFHEIV5               PIC X(04).
  4904   02  DFHEIV6               PIC X(04).
  4905   02  DFHEIV7               PIC X(02).
  4906   02  DFHEIV8               PIC X(02).
  4907   02  DFHEIV9               PIC X(01).
  4908   02  DFHEIV10              PIC S9(7) COMP-3.
  4909   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4910   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4911   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4912   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4913   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4914   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4915   02  DFHEIV17              PIC X(04).
  4916   02  DFHEIV18              PIC X(04).
  4917   02  DFHEIV19              PIC X(04).
  4918   02  DFHEIV20              USAGE IS POINTER.
  4919   02  DFHEIV21              USAGE IS POINTER.
  4920   02  DFHEIV22              USAGE IS POINTER.
  4921   02  DFHEIV23              USAGE IS POINTER.
  4922   02  DFHEIV24              USAGE IS POINTER.
  4923   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4924   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4925   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4926   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4927   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4928   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4929   02  FILLER                PIC X(02).
  4930   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4931   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4932   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4933   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4934   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4935 LINKAGE  SECTION.
  4936*****************************************************************
  4937*                                                               *
  4938* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4939* All rights reserved.                                          *
  4940*                                                               *
  4941*****************************************************************
  4942 01  dfheiblk.
  4943     02  eibtime          pic s9(7) comp-3.
  4944     02  eibdate          pic s9(7) comp-3.
  4945     02  eibtrnid         pic x(4).
  4946     02  eibtaskn         pic s9(7) comp-3.
  4947     02  eibtrmid         pic x(4).
  4948     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  92
* EL050.cbl
  4949     02  eibcposn         pic s9(4) comp.
  4950     02  eibcalen         pic s9(4) comp.
  4951     02  eibaid           pic x(1).
  4952     02  eibfiller1       pic x(1).
  4953     02  eibfn            pic x(2).
  4954     02  eibfiller2       pic x(2).
  4955     02  eibrcode         pic x(6).
  4956     02  eibfiller3       pic x(2).
  4957     02  eibds            pic x(8).
  4958     02  eibreqid         pic x(8).
  4959     02  eibrsrce         pic x(8).
  4960     02  eibsync          pic x(1).
  4961     02  eibfree          pic x(1).
  4962     02  eibrecv          pic x(1).
  4963     02  eibsend          pic x(1).
  4964     02  eibatt           pic x(1).
  4965     02  eibeoc           pic x(1).
  4966     02  eibfmh           pic x(1).
  4967     02  eibcompl         pic x(1).
  4968     02  eibsig           pic x(1).
  4969     02  eibconf          pic x(1).
  4970     02  eiberr           pic x(1).
  4971     02  eibrldbk         pic x(1).
  4972     02  eiberrcd         pic x(4).
  4973     02  eibsynrb         pic x(1).
  4974     02  eibnodat         pic x(1).
  4975     02  eibfiller5       pic x(2).
  4976     02  eibresp          pic 9(09) comp.
  4977     02  eibresp2         pic 9(09) comp.
  4978     02  dfheigdj         pic s9(4) comp.
  4979     02  dfheigdk         pic s9(4) comp.
  4980
  4981 01  DFHCOMMAREA                   PIC X(1036).
  4982
  4983*01 PARMLIST .
  4984*    02  FILLER                    PIC S9(8)   COMP.
  4985*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4986*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4987*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4988*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4989*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4990*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4991*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4992
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  93
* EL050.cbl
  4994*    COPY ELCCNTL.
  4995******************************************************************
  4996*                                                                *
  4997*                                                                *
  4998*                            ELCCNTL.                            *
  4999*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5000*                            VMOD=2.059                          *
  5001*                                                                *
  5002*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5003*                                                                *
  5004*   FILE TYPE = VSAM,KSDS                                        *
  5005*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5006*                                                                *
  5007*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5008*       ALTERNATE INDEX = NONE                                   *
  5009*                                                                *
  5010*   LOG = YES                                                    *
  5011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5012******************************************************************
  5013*                   C H A N G E   L O G
  5014*
  5015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5016*-----------------------------------------------------------------
  5017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5018* EFFECTIVE    NUMBER
  5019*-----------------------------------------------------------------
  5020* 082503                   PEMA  ADD BENEFIT GROUP
  5021* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5022* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5023* 092705    2005050300006  PEMA  ADD SPP LEASES
  5024* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5025* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5026* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5027* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5028* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5029* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5030* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5031* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5032* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5033* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5034******************************************************************
  5035*
  5036 01  CONTROL-FILE.
  5037     12  CF-RECORD-ID                       PIC XX.
  5038         88  VALID-CF-ID                        VALUE 'CF'.
  5039
  5040     12  CF-CONTROL-PRIMARY.
  5041         16  CF-COMPANY-ID                  PIC XXX.
  5042         16  CF-RECORD-TYPE                 PIC X.
  5043             88  CF-COMPANY-MASTER              VALUE '1'.
  5044             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5045             88  CF-STATE-MASTER                VALUE '3'.
  5046             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5047             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5048             88  CF-CARRIER-MASTER              VALUE '6'.
  5049             88  CF-MORTALITY-MASTER            VALUE '7'.
  5050             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5051             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  94
* EL050.cbl
  5052             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5053             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5054             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5055             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5056             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5057             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5058             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5059             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5060             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5061         16  CF-ACCESS-CD-GENL              PIC X(4).
  5062         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5063             20  CF-PROCESSOR               PIC X(4).
  5064         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5065             20  CF-STATE-CODE              PIC XX.
  5066             20  FILLER                     PIC XX.
  5067         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5068             20  FILLER                     PIC XX.
  5069             20  CF-HI-BEN-IN-REC           PIC XX.
  5070         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5071             20  FILLER                     PIC XXX.
  5072             20  CF-CARRIER-CNTL            PIC X.
  5073         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5074             20  FILLER                     PIC XX.
  5075             20  CF-HI-TYPE-IN-REC          PIC 99.
  5076         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5077             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5078                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5079             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5080             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5081         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5082             20  FILLER                     PIC X.
  5083             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5084         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5085             20  FILLER                     PIC XX.
  5086             20  CF-MORTGAGE-PLAN           PIC XX.
  5087         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5088
  5089     12  CF-LAST-MAINT-DT                   PIC XX.
  5090     12  CF-LAST-MAINT-BY                   PIC X(4).
  5091     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5092
  5093     12  CF-RECORD-BODY                     PIC X(728).
  5094
  5095
  5096****************************************************************
  5097*             COMPANY MASTER RECORD                            *
  5098****************************************************************
  5099
  5100     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5101         16  CF-COMPANY-ADDRESS.
  5102             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5103             20  CF-CL-IN-CARE-OF           PIC X(30).
  5104             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5105             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5106             20  CF-CL-CITY-STATE           PIC X(30).
  5107             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5108             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5109         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  95
* EL050.cbl
  5110         16  CF-COMPANY-PASSWORD            PIC X(8).
  5111         16  CF-SECURITY-OPTION             PIC X.
  5112             88  ALL-SECURITY                   VALUE '1'.
  5113             88  COMPANY-VERIFY                 VALUE '2'.
  5114             88  PROCESSOR-VERIFY               VALUE '3'.
  5115             88  NO-SECURITY                    VALUE '4'.
  5116             88  ALL-BUT-TERM                   VALUE '5'.
  5117         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5118             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5119         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5120             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5121         16  CF-INFORCE-LOCATION            PIC X.
  5122             88  CERTS-ARE-ONLINE               VALUE '1'.
  5123             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5124             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5125         16  CF-LOWER-CASE-LETTERS          PIC X.
  5126         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5127             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5128             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5129             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5130             88  CF-ACCNT-CNTL                  VALUE '3'.
  5131             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5132
  5133         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5134         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5135
  5136         16  CF-LGX-CREDIT-USER             PIC X.
  5137             88  CO-IS-NOT-USER                 VALUE 'N'.
  5138             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5139
  5140         16 CF-CREDIT-CALC-CODES.
  5141             20  CF-CR-REM-TERM-CALC PIC X.
  5142               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5143               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5144               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5145               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5146               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5147               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5148               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5149             20  CF-CR-R78-METHOD           PIC X.
  5150               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5151               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5152
  5153         16  CF-CLAIM-CONTROL-COUNTS.
  5154             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5155                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5156
  5157             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5158                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5159
  5160             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5161                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5162
  5163             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5164                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5165
  5166         16  CF-CURRENT-MONTH-END           PIC XX.
  5167
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  96
* EL050.cbl
  5168         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5169             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5170             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5171             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5172             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5173                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5174                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5175             20  CF-CO-PREM-REJECT-SW       PIC X.
  5176                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5177                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5178             20  CF-CO-REF-REJECT-SW        PIC X.
  5179                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5180                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5181
  5182         16  CF-CO-REPORTING-DT             PIC XX.
  5183         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5184         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5185           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5186           88  CF-CO-MONTH-END                  VALUE '1'.
  5187
  5188         16  CF-LGX-CLAIM-USER              PIC X.
  5189             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5190             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5191
  5192         16  CF-CREDIT-EDIT-CONTROLS.
  5193             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5194             20  CF-MIN-AGE                 PIC 99.
  5195             20  CF-DEFAULT-AGE             PIC 99.
  5196             20  CF-MIN-TERM                PIC S999      COMP-3.
  5197             20  CF-MAX-TERM                PIC S999      COMP-3.
  5198             20  CF-DEFAULT-SEX             PIC X.
  5199             20  CF-JOINT-AGE-INPUT         PIC X.
  5200                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5201             20  CF-BIRTH-DATE-INPUT        PIC X.
  5202                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5203             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5204                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5205                 88  CF-ZERO-CARRIER            VALUE '1'.
  5206                 88  CF-ZERO-GROUPING           VALUE '2'.
  5207                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5208             20  CF-EDIT-SW                 PIC X.
  5209                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5210             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5211             20  CF-CR-PR-METHOD            PIC X.
  5212               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5213               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5214             20  FILLER                     PIC X.
  5215
  5216         16  CF-CREDIT-MISC-CONTROLS.
  5217             20  CF-REIN-TABLE-SW           PIC X.
  5218                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5219             20  CF-COMP-TABLE-SW           PIC X.
  5220                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5221             20  CF-EXPERIENCE-RETENTION-AGE
  5222                                            PIC S9        COMP-3.
  5223             20  CF-CONVERSION-DT           PIC XX.
  5224             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5225             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  97
* EL050.cbl
  5226                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5227                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5228
  5229             20  CF-CR-CHECK-NO-CONTROL.
  5230                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5231                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5232                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5233                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5234                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5235                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5236
  5237                 24  CF-CR-CHECK-COUNT       REDEFINES
  5238                     CF-CR-CHECK-COUNTER      PIC X(4).
  5239
  5240                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5241                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5242
  5243                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5244                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5245                 24  CF-MAIL-PROCESSING       PIC X.
  5246                     88  MAIL-PROCESSING          VALUE 'Y'.
  5247
  5248         16  CF-MISC-SYSTEM-CONTROL.
  5249             20  CF-SYSTEM-C                 PIC X.
  5250                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5251             20  CF-SYSTEM-D                 PIC X.
  5252                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5253             20  CF-SOC-SEC-NO-SW            PIC X.
  5254                 88  SOC-SEC-NO-USED             VALUE '1'.
  5255             20  CF-MEMBER-NO-SW             PIC X.
  5256                 88  MEMBER-NO-USED              VALUE '1'.
  5257             20  CF-TAX-ID-NUMBER            PIC X(11).
  5258             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5259             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5260                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5261                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5262                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5263                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5264             20  CF-SYSTEM-E                 PIC X.
  5265                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5266
  5267         16  CF-LGX-LIFE-USER               PIC X.
  5268             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5269             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5270
  5271         16  CF-CR-MONTH-END-DT             PIC XX.
  5272
  5273         16  CF-FILE-MAINT-DATES.
  5274             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5275                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5276             20  CF-LAST-BATCH       REDEFINES
  5277                 CF-LAST-BATCH-NO               PIC X(4).
  5278             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5279             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5280             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5281             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5282             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5283             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  98
* EL050.cbl
  5284             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5285             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5286             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5287             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5288
  5289         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5290         16  FILLER                         PIC X.
  5291
  5292         16  CF-ALT-MORT-CODE               PIC X(4).
  5293         16  CF-MEMBER-CAPTION              PIC X(10).
  5294
  5295         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5296             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5297             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5298             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5299             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5300             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5301
  5302         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5303
  5304         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5305         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5306         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5307         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5308
  5309         16  CF-AH-OVERRIDE-L1              PIC X.
  5310         16  CF-AH-OVERRIDE-L2              PIC XX.
  5311         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5312         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5313
  5314         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5315         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5316
  5317         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5318         16  CF-AR-LAST-EL860-DT            PIC XX.
  5319         16  CF-MP-MONTH-END-DT             PIC XX.
  5320
  5321         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5322         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5323             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5324
  5325         16  CF-AR-MONTH-END-DT             PIC XX.
  5326
  5327         16  CF-CRDTCRD-USER                PIC X.
  5328             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5329             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5330
  5331         16  CF-CC-MONTH-END-DT             PIC XX.
  5332
  5333         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5334
  5335         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5336             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5337             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5338             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5339         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5340         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5341         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page  99
* EL050.cbl
  5342         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5343             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5344             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5345         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5346         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5347         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5348             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5349         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5350
  5351         16  CF-CL-ZIP-CODE.
  5352             20  CF-CL-ZIP-PRIME.
  5353                 24  CF-CL-ZIP-1ST          PIC X.
  5354                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5355                 24  FILLER                 PIC X(4).
  5356             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5357         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5358             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5359             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5360             20  FILLER                     PIC XXX.
  5361
  5362         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5363         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5364         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5365         16  CF-CO-OPTION-START-DATE        PIC XX.
  5366         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5367           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5368                                                      '3' '4'.
  5369           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5370           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5371           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5372           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5373           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5374           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5375
  5376         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5377
  5378         16  CF-PAYMENT-APPROVAL-LEVELS.
  5379             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5380             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5381             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5382             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5383             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5384             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5385
  5386         16  CF-END-USER-REPORTING-USER     PIC X.
  5387             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5388             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5389
  5390         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5391             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5392             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5393
  5394         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5395
  5396         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5397         16  FILLER                         PIC X.
  5398
  5399         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 100
* EL050.cbl
  5400             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5401             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5402             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5403
  5404         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5405
  5406         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5407             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5408             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5409
  5410         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5411             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5412             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5413
  5414         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5415
  5416         16  CF-CO-ACH-ID-CODE              PIC  X.
  5417             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5418             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5419             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5420         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5421         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5422         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5423         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5424         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5425         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5426         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5427         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5428         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5429                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5430         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5431                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5432
  5433         16  CF-CO-OVER-SHORT.
  5434             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5435             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5436
  5437*         16  FILLER                         PIC X(102).
  5438         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5439             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5440             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5441
  5442         16  CF-AH-APPROVAL-DAYS.
  5443             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5444             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5445             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5446             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5447
  5448         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5449
  5450         16  CF-APPROV-LEV-5.
  5451             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5452             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5453             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5454
  5455         16  FILLER                         PIC X(68).
  5456****************************************************************
  5457*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 101
* EL050.cbl
  5458****************************************************************
  5459
  5460     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5461         16  CF-PROCESSOR-NAME              PIC X(30).
  5462         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5463         16  CF-PROCESSOR-TITLE             PIC X(26).
  5464         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5465                 88  MESSAGE-YES                VALUE 'Y'.
  5466                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5467
  5468*****************************************************
  5469****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5470****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5471****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5472****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5473*****************************************************
  5474
  5475         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5476             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5477             20  CF-APPLICATION-FORCE       PIC X.
  5478             20  CF-INDIVIDUAL-APP.
  5479                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5480                     28  CF-BROWSE-APP      PIC X.
  5481                     28  CF-UPDATE-APP      PIC X.
  5482
  5483         16  CF-CURRENT-TERM-ON             PIC X(4).
  5484         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5485             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5486             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5487             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5488             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5489             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5490             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5491             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5492         16  CF-PROCESSOR-CARRIER           PIC X.
  5493             88  NO-CARRIER-SECURITY            VALUE ' '.
  5494         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5495             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5496         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5497             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5498         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5499             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5500
  5501         16  CF-PROC-SYS-ACCESS-SW.
  5502             20  CF-PROC-CREDIT-CLAIMS-SW.
  5503                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5504                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5505                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5506                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5507             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5508                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5509                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5510             20  CF-PROC-LIFE-GNRLDGR-SW.
  5511                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5512                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5513                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5514                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5515             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 102
* EL050.cbl
  5516                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5517                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5518         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5519             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5520             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5521         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5522
  5523         16  CF-APPROVAL-LEVEL                  PIC X.
  5524             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5525             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5526             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5527             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5528             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5529
  5530         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5531
  5532         16  CF-LANGUAGE-TYPE                   PIC X.
  5533             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5534             88  CF-LANG-IS-FR                      VALUE 'F'.
  5535
  5536         16  CF-CSR-IND                         PIC X.
  5537         16  FILLER                             PIC X(239).
  5538
  5539****************************************************************
  5540*             PROCESSOR/REMINDERS RECORD                       *
  5541****************************************************************
  5542
  5543     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5544         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5545             20  CF-START-REMIND-DT         PIC XX.
  5546             20  CF-END-REMIND-DT           PIC XX.
  5547             20  CF-REMINDER-TEXT           PIC X(50).
  5548         16  FILLER                         PIC X(296).
  5549
  5550
  5551****************************************************************
  5552*             STATE MASTER RECORD                              *
  5553****************************************************************
  5554
  5555     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5556         16  CF-STATE-ABBREVIATION          PIC XX.
  5557         16  CF-STATE-NAME                  PIC X(25).
  5558         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5559         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5560             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5561             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5562             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5563             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5564                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5565                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5566             20  CF-ST-PREM-REJECT-SW       PIC X.
  5567                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5568                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5569             20  CF-ST-REF-REJECT-SW        PIC X.
  5570                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5571                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5572         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5573         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 103
* EL050.cbl
  5574         16  CF-ST-REFUND-RULES.
  5575             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5576             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5577             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5578         16  CF-ST-FST-PMT-EXTENSION.
  5579             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5580             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5581                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5582                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5583                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5584                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5585         16  CF-ST-STATE-CALL.
  5586             20  CF-ST-CALL-UNEARNED        PIC X.
  5587             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5588             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5589         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5590             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5591             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5592         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5593         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5594         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5595         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5596         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5597         16  FILLER                         PIC X.
  5598         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5599             20  CF-ST-BENEFIT-CD           PIC XX.
  5600             20  CF-ST-BENEFIT-KIND         PIC X.
  5601                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5602                 88  CF-ST-AH-KIND              VALUE 'A'.
  5603             20  CF-ST-REM-TERM-CALC        PIC X.
  5604                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5605                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5606                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5607                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5608                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5609                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5610                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5611                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5612
  5613             20  CF-ST-REFUND-CALC          PIC X.
  5614                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5615                 88  ST-REFD-BY-R78             VALUE '1'.
  5616                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5617                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5618                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5619                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5620                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5621                 88  ST-REFD-UTAH               VALUE '7'.
  5622                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5623                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5624                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5625
  5626             20  CF-ST-EARNING-CALC         PIC X.
  5627                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5628                 88  ST-EARN-BY-R78             VALUE '1'.
  5629                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5630                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5631                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 104
* EL050.cbl
  5632                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5633                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5634                 88  ST-EARN-MEAN               VALUE '8'.
  5635                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5636
  5637             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5638                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5639                 88  ST-OVRD-BY-R78             VALUE '1'.
  5640                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5641                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5642                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5643                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5644                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5645                 88  ST-OVRD-MEAN               VALUE '8'.
  5646                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5647             20  FILLER                     PIC X.
  5648
  5649         16  CF-ST-COMMISSION-CAPS.
  5650             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5651             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5652             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5653             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5654         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5655                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5656
  5657         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5658
  5659         16  CF-ST-STATUTORY-INTEREST.
  5660             20  CF-ST-STAT-DATE-FROM       PIC X.
  5661                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5662                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5663             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5664             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5665             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5666             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5667             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5668
  5669         16  CF-ST-OVER-SHORT.
  5670             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5671             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5672
  5673         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5674
  5675         16  CF-ST-RT-CALC                  PIC X.
  5676
  5677         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5678         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5679         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5680         16  CF-ST-RF-LR-CALC               PIC X.
  5681         16  CF-ST-RF-LL-CALC               PIC X.
  5682         16  CF-ST-RF-LN-CALC               PIC X.
  5683         16  CF-ST-RF-AH-CALC               PIC X.
  5684         16  CF-ST-RF-CP-CALC               PIC X.
  5685*        16  FILLER                         PIC X(206).
  5686*CIDMOD         16  FILLER                         PIC X(192).
  5687         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5688             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5689         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 105
* EL050.cbl
  5690         16  CF-ST-VFY-2ND-BENE             PIC X.
  5691         16  CF-ST-CAUSAL-STATE             PIC X.
  5692         16  FILLER                         PIC X(185).
  5693
  5694****************************************************************
  5695*             BENEFIT MASTER RECORD                            *
  5696****************************************************************
  5697
  5698     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5699         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5700             20  CF-BENEFIT-CODE            PIC XX.
  5701             20  CF-BENEFIT-NUMERIC  REDEFINES
  5702                 CF-BENEFIT-CODE            PIC XX.
  5703             20  CF-BENEFIT-ALPHA           PIC XXX.
  5704             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5705             20  CF-BENEFIT-COMMENT         PIC X(10).
  5706
  5707             20  CF-LF-COVERAGE-TYPE        PIC X.
  5708                 88  CF-REDUCING                VALUE 'R'.
  5709                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5710
  5711             20  CF-SPECIAL-CALC-CD         PIC X.
  5712                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5713                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5714                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5715                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5716                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5717                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5718                 88  CF-FARM-PLAN               VALUE 'F'.
  5719                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5720                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5721                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5722                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5723                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5724                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5725                 88  CF-PRUDENTIAL              VALUE 'P'.
  5726                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5727                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5728                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5729                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5730                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5731                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5732
  5733             20  CF-JOINT-INDICATOR         PIC X.
  5734                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5735
  5736*            20  FILLER                     PIC X(12).
  5737             20  cf-maximum-benefits        pic s999 comp-3.
  5738             20  FILLER                     PIC X(09).
  5739             20  CF-BENEFIT-CATEGORY        PIC X.
  5740             20  CF-LOAN-TYPE               PIC X(8).
  5741
  5742             20  CF-CO-REM-TERM-CALC        PIC X.
  5743                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5744                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5745                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5746                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5747                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 106
* EL050.cbl
  5748
  5749             20  CF-CO-EARNINGS-CALC        PIC X.
  5750                 88  CO-EARN-BY-R78             VALUE '1'.
  5751                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5752                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5753                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5754                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5755                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5756                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5757                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5758
  5759             20  CF-CO-REFUND-CALC          PIC X.
  5760                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5761                 88  CO-REFD-BY-R78             VALUE '1'.
  5762                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5763                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5764                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5765                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5766                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5767                 88  CO-REFD-MEAN               VALUE '8'.
  5768                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5769                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5770                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5771
  5772             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5773                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5774                 88  CO-OVRD-BY-R78             VALUE '1'.
  5775                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5776                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5777                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5778                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5779                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5780                 88  CO-OVRD-MEAN               VALUE '8'.
  5781                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5782
  5783             20  CF-CO-BEN-I-G-CD           PIC X.
  5784                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5785                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5786                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5787
  5788         16  FILLER                         PIC X(304).
  5789
  5790
  5791****************************************************************
  5792*             CARRIER MASTER RECORD                            *
  5793****************************************************************
  5794
  5795     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5796         16  CF-ADDRESS-DATA.
  5797             20  CF-MAIL-TO-NAME            PIC X(30).
  5798             20  CF-IN-CARE-OF              PIC X(30).
  5799             20  CF-ADDRESS-LINE-1          PIC X(30).
  5800             20  CF-ADDRESS-LINE-2          PIC X(30).
  5801             20  CF-CITY-STATE              PIC X(30).
  5802             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5803             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5804
  5805         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 107
* EL050.cbl
  5806             20  CF-CLAIM-NO-METHOD         PIC X.
  5807                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5808                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5809                 88  CLAIM-NO-SEQ               VALUE '3'.
  5810                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5811             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5812                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5813                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5814                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5815
  5816         16  CF-CHECK-NO-CONTROL.
  5817             20  CF-CHECK-NO-METHOD         PIC X.
  5818                 88  CHECK-NO-MANUAL            VALUE '1'.
  5819                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5820                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5821                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5822             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5823                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5824
  5825         16  CF-DOMICILE-STATE              PIC XX.
  5826
  5827         16  CF-EXPENSE-CONTROLS.
  5828             20  CF-EXPENSE-METHOD          PIC X.
  5829                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5830                 88  DOLLARS-PER-PMT            VALUE '2'.
  5831                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5832                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5833             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5834             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5835
  5836         16  CF-CORRESPONDENCE-CONTROL.
  5837             20  CF-LETTER-RESEND-OPT       PIC X.
  5838                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5839                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5840             20  FILLER                     PIC X(4).
  5841
  5842         16  CF-RESERVE-CONTROLS.
  5843             20  CF-MANUAL-SW               PIC X.
  5844                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5845             20  CF-FUTURE-SW               PIC X.
  5846                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5847             20  CF-PTC-SW                  PIC X.
  5848                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5849             20  CF-IBNR-SW                 PIC X.
  5850                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5851             20  CF-PTC-LF-SW               PIC X.
  5852                 88  CF-LF-PTC-USED             VALUE '1'.
  5853             20  CF-CDT-ACCESS-METHOD       PIC X.
  5854                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5855                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5856                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5857             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5858
  5859         16  CF-CLAIM-CALC-METHOD           PIC X.
  5860             88  360-PLUS-MONTHS                VALUE '1'.
  5861             88  365-PLUS-MONTHS                VALUE '2'.
  5862             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5863             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 108
* EL050.cbl
  5864             88  365-DAILY                      VALUE '5'.
  5865
  5866         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5867         16  FILLER                         PIC X(11).
  5868
  5869         16  CF-LIMIT-AMOUNTS.
  5870             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5871             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5872             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5873             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5874             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5875             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5876             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5877             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5878             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5879             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5880
  5881         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5882         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5883         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5884
  5885         16  CF-ZIP-CODE.
  5886             20  CF-ZIP-PRIME.
  5887                 24  CF-ZIP-1ST             PIC X.
  5888                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5889                 24  FILLER                 PIC X(4).
  5890             20  CF-ZIP-PLUS4               PIC X(4).
  5891         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5892             20  CF-CAN-POSTAL-1            PIC XXX.
  5893             20  CF-CAN-POSTAL-2            PIC XXX.
  5894             20  FILLER                     PIC XXX.
  5895
  5896         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5897         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5898         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5899
  5900         16  CF-RATING-SWITCH               PIC X.
  5901             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5902             88  CF-NO-RATING                   VALUE 'N'.
  5903
  5904         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5905
  5906         16  CF-CARRIER-OVER-SHORT.
  5907             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5908             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5909
  5910         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5911         16  CF-SECPAY-SWITCH               PIC X.
  5912             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5913             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5914         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5915         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5916         16  FILLER                         PIC X(444).
  5917*        16  FILLER                         PIC X(452).
  5918
  5919
  5920****************************************************************
  5921*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 109
* EL050.cbl
  5922****************************************************************
  5923
  5924     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5925         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5926                                INDEXED BY CF-MORT-NDX.
  5927             20  CF-MORT-TABLE              PIC X(5).
  5928             20  CF-MORT-TABLE-TYPE         PIC X.
  5929                 88  CF-MORT-JOINT              VALUE 'J'.
  5930                 88  CF-MORT-SINGLE             VALUE 'S'.
  5931                 88  CF-MORT-COMBINED           VALUE 'C'.
  5932                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5933                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5934             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5935             20  CF-MORT-AGE-METHOD         PIC XX.
  5936                 88  CF-AGE-LAST                VALUE 'AL'.
  5937                 88  CF-AGE-NEAR                VALUE 'AN'.
  5938             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5939             20  CF-MORT-ADJUSTMENT-DIRECTION
  5940                                            PIC X.
  5941                 88  CF-MINUS                   VALUE '-'.
  5942                 88  CF-PLUS                    VALUE '+'.
  5943             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5944             20  CF-MORT-JOINT-CODE         PIC X.
  5945                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5946             20  CF-MORT-PC-Q               PIC X.
  5947                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5948             20  CF-MORT-TABLE-CODE         PIC X(4).
  5949             20  CF-MORT-COMMENTS           PIC X(15).
  5950             20  FILLER                     PIC X(14).
  5951
  5952         16  FILLER                         PIC X(251).
  5953
  5954
  5955****************************************************************
  5956*             BUSSINESS TYPE MASTER RECORD                     *
  5957****************************************************************
  5958
  5959     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5960* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5961* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5962* AND RECORD 05 IS TYPES 81-99
  5963         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5964             20  CF-BUSINESS-TITLE          PIC  X(19).
  5965             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5966                                            PIC S9V9(4) COMP-3.
  5967             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5968             20  FILLER                     PIC  X.
  5969         16  FILLER                         PIC  X(248).
  5970
  5971
  5972****************************************************************
  5973*             TERMINAL MASTER RECORD                           *
  5974****************************************************************
  5975
  5976     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5977
  5978         16  CF-COMPANY-TERMINALS.
  5979             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 110
* EL050.cbl
  5980                                  PIC X(4).
  5981         16  FILLER               PIC X(248).
  5982
  5983
  5984****************************************************************
  5985*             LIFE EDIT MASTER RECORD                          *
  5986****************************************************************
  5987
  5988     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5989         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5990             20  CF-LIFE-CODE-IN            PIC XX.
  5991             20  CF-LIFE-CODE-OUT           PIC XX.
  5992         16  FILLER                         PIC X(248).
  5993
  5994
  5995****************************************************************
  5996*             AH EDIT MASTER RECORD                            *
  5997****************************************************************
  5998
  5999     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6000         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6001             20  CF-AH-CODE-IN              PIC XXX.
  6002             20  CF-AH-CODE-OUT             PIC XX.
  6003         16  FILLER                         PIC X(248).
  6004
  6005
  6006****************************************************************
  6007*             CREDIBILITY TABLES                               *
  6008****************************************************************
  6009
  6010     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6011         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6012                             INDEXED BY CF-CRDB-NDX.
  6013             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6014             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6015             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6016         16  FILLER                         PIC  X(332).
  6017
  6018
  6019****************************************************************
  6020*             REPORT CUSTOMIZATION RECORD                      *
  6021****************************************************************
  6022
  6023     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6024         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6025             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6026             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6027             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6028**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6029****       A T-TRANSFER.                                   ****
  6030             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6031
  6032         16  FILLER                         PIC XX.
  6033
  6034         16  CF-CARRIER-CNTL-OPT.
  6035             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6036                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6037                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 111
* EL050.cbl
  6038             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6039                                            PIC X.
  6040         16  CF-GROUP-CNTL-OPT.
  6041             20  CF-GROUP-OPT-SEQ           PIC 9.
  6042                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6043                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6044             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6045                                            PIC X(6).
  6046         16  CF-STATE-CNTL-OPT.
  6047             20  CF-STATE-OPT-SEQ           PIC 9.
  6048                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6049                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6050             20  CF-STATE-SELECT OCCURS 3 TIMES
  6051                                            PIC XX.
  6052         16  CF-ACCOUNT-CNTL-OPT.
  6053             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6054                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6055                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6056             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6057                                            PIC X(10).
  6058         16  CF-BUS-TYP-CNTL-OPT.
  6059             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6060                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6061                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6062             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6063                                            PIC XX.
  6064         16  CF-LF-TYP-CNTL-OPT.
  6065             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6066                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6067                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6068             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6069                                            PIC XX.
  6070         16  CF-AH-TYP-CNTL-OPT.
  6071             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6072                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6073                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6074             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6075                                            PIC XX.
  6076         16  CF-REPTCD1-CNTL-OPT.
  6077             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6078                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6079                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6080             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6081                                            PIC X(10).
  6082         16  CF-REPTCD2-CNTL-OPT.
  6083             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6084                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6085                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6086             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6087                                            PIC X(10).
  6088         16  CF-USER1-CNTL-OPT.
  6089             20  CF-USER1-OPT-SEQ           PIC 9.
  6090                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6091                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6092             20  CF-USER1-SELECT OCCURS 3 TIMES
  6093                                            PIC X(10).
  6094         16  CF-USER2-CNTL-OPT.
  6095             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 112
* EL050.cbl
  6096                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6097                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6098             20  CF-USER2-SELECT OCCURS 3 TIMES
  6099                                            PIC X(10).
  6100         16  CF-USER3-CNTL-OPT.
  6101             20  CF-USER3-OPT-SEQ           PIC 9.
  6102                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6103                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6104             20  CF-USER3-SELECT OCCURS 3 TIMES
  6105                                            PIC X(10).
  6106         16  CF-USER4-CNTL-OPT.
  6107             20  CF-USER4-OPT-SEQ           PIC 9.
  6108                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6109                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6110             20  CF-USER4-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112         16  CF-USER5-CNTL-OPT.
  6113             20  CF-USER5-OPT-SEQ           PIC 9.
  6114                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6115                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6116             20  CF-USER5-SELECT OCCURS 3 TIMES
  6117                                            PIC X(10).
  6118         16  CF-REINS-CNTL-OPT.
  6119             20  CF-REINS-OPT-SEQ           PIC 9.
  6120                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6121                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6122             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6123                 24  CF-REINS-PRIME         PIC XXX.
  6124                 24  CF-REINS-SUB           PIC XXX.
  6125
  6126         16  CF-AGENT-CNTL-OPT.
  6127             20  CF-AGENT-OPT-SEQ           PIC 9.
  6128                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6129                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6130             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6131                                            PIC X(10).
  6132
  6133         16  FILLER                         PIC X(43).
  6134
  6135         16  CF-LOSS-RATIO-SELECT.
  6136             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6137             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6138         16  CF-ENTRY-DATE-SELECT.
  6139             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6140             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6141         16  CF-EFFECTIVE-DATE-SELECT.
  6142             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6143             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6144
  6145         16  CF-EXCEPTION-LIST-IND          PIC X.
  6146             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6147
  6148         16  FILLER                         PIC X(318).
  6149
  6150****************************************************************
  6151*                  EXCEPTION REPORTING RECORD                  *
  6152****************************************************************
  6153
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 113
* EL050.cbl
  6154     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6155         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6156             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6157
  6158         16  CF-COMBINED-LIFE-AH-OPT.
  6159             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6160             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6161             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6162             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6163
  6164         16  CF-LIFE-OPT.
  6165             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6166             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6167             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6168             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6169             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6170             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6171             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6172             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6173             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6174             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6175
  6176         16  CF-AH-OPT.
  6177             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6178             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6179             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6180             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6181             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6182             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6183             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6184             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6185             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6186             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6187
  6188         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6189             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6190             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6191             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6192
  6193         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6194
  6195         16  FILLER                         PIC X(673).
  6196
  6197
  6198****************************************************************
  6199*             MORTGAGE SYSTEM PLAN RECORD                      *
  6200****************************************************************
  6201
  6202     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6203         16  CF-PLAN-TYPE                   PIC X.
  6204             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6205             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6206             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6207         16  CF-PLAN-ABBREV                 PIC XXX.
  6208         16  CF-PLAN-DESCRIPT               PIC X(10).
  6209         16  CF-PLAN-NOTES                  PIC X(20).
  6210         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6211         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 114
* EL050.cbl
  6212             20  CF-PLAN-TERM-DATA.
  6213                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6214                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6215             20  CF-PLAN-AGE-DATA.
  6216                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6217                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6218                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6219             20  CF-PLAN-BENEFIT-DATA.
  6220                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6221                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6222                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6223                                            PIC S9(7)V99  COMP-3.
  6224         16  CF-PLAN-POLICY-FORMS.
  6225             20  CF-POLICY-FORM             PIC X(12).
  6226             20  CF-MASTER-APPLICATION      PIC X(12).
  6227             20  CF-MASTER-POLICY           PIC X(12).
  6228         16  CF-PLAN-RATING.
  6229             20  CF-RATE-CODE               PIC X(5).
  6230             20  CF-SEX-RATING              PIC X.
  6231                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6232                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6233             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6234             20  CF-SUB-STD-TYPE            PIC X.
  6235                 88  CF-PCT-OF-PREM            VALUE '1'.
  6236                 88  CF-PCT-OF-BENE            VALUE '2'.
  6237         16  CF-PLAN-PREM-TOLERANCES.
  6238             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6239             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6240         16  CF-PLAN-PYMT-TOLERANCES.
  6241             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6242             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6243         16  CF-PLAN-MISC-DATA.
  6244             20  FILLER                     PIC X.
  6245             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6246             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6247         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6248         16  CF-PLAN-IND-GRP                PIC X.
  6249             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6250                                                     '1'.
  6251             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6252                                                     '2'.
  6253         16  CF-MIB-SEARCH-SW               PIC X.
  6254             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6255             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6256             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6257             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6258         16  CF-ALPHA-SEARCH-SW             PIC X.
  6259             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6260             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6261             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6262             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6263             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6264             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6265             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6266             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6267             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6268             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6269                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 115
* EL050.cbl
  6270                                                     'X' 'Y' 'Z'.
  6271         16  CF-EFF-DT-RULE-SW              PIC X.
  6272             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6273             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6274             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6275             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6276             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6277         16  FILLER                         PIC X(4).
  6278         16  CF-HEALTH-QUESTIONS            PIC X.
  6279             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6280         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6281         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6282         16  CF-PLAN-SNGL-JNT               PIC X.
  6283             88  CF-COMBINED-PLAN              VALUE 'C'.
  6284             88  CF-JNT-PLAN                   VALUE 'J'.
  6285             88  CF-SNGL-PLAN                  VALUE 'S'.
  6286         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6287         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6288         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6289         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6290         16  CF-RERATE-CNTL                 PIC  X.
  6291             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6292             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6293             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6294             88  CF-AUTO-RECALC                 VALUE '4'.
  6295         16  CF-BENEFIT-TYPE                PIC  X.
  6296             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6297             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6298         16  CF-POLICY-FEE                  PIC S999V99
  6299                                                    COMP-3.
  6300         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6301         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6302         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6303         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6304         16  FILLER                         PIC  X(32).
  6305         16  CF-TERMINATION-FORM            PIC  X(04).
  6306         16  FILLER                         PIC  X(08).
  6307         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6308                                                       COMP-3.
  6309         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6310         16  CF-ISSUE-LETTER                PIC  X(4).
  6311         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6312         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6313             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6314             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6315         16  CF-MP-REFUND-CALC              PIC X.
  6316             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6317             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6318             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6319             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6320             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6321             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6322             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6323             88  CF-MP-REFD-MEAN                VALUE '8'.
  6324         16  CF-ALT-RATE-CODE               PIC  X(5).
  6325
  6326
  6327         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 116
* EL050.cbl
  6328****************************************************************
  6329*             MORTGAGE COMPANY MASTER RECORD                   *
  6330****************************************************************
  6331
  6332     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6333         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6334         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6335             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6336             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6337             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6338             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6339             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6340
  6341         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6342         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6343         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6344         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6345         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6346
  6347         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6348             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6349         16  CF-MP-RECON-USE-IND            PIC X(1).
  6350             88  CF-MP-USE-RECON             VALUE 'Y'.
  6351         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6352             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6353         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6354             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6355             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6356         16  FILLER                         PIC X(1).
  6357         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6358             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6359         16  CF-MORTG-MIB-VERSION           PIC X.
  6360             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6361             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6362             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6363         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6364             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6365                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6366             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6367                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6368             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6369                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6370             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6371                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6372             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6373                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6374             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6375                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6376         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6377         16  FILLER                         PIC X(7).
  6378         16  CF-MORTG-DESTINATION-SYMBOL.
  6379             20  CF-MORTG-MIB-COMM          PIC X(5).
  6380             20  CF-MORTG-MIB-TERM          PIC X(5).
  6381         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6382             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6383         16  FILLER                         PIC X(03).
  6384         16  CF-MP-CHECK-NO-CONTROL.
  6385             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 117
* EL050.cbl
  6386                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6387                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6388                                                ' ' LOW-VALUES.
  6389                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6390                                               VALUE '3'.
  6391         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6392         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6393         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6394             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6395                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6396             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6397                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6398             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6399                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6400             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6401                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6402             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6403                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6404             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6405                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6406         16  CF-MORTG-BILLING-AREA.
  6407             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6408                                            PIC X.
  6409         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6410         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6411         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6412         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6413             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6414             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6415         16  FILLER                         PIC X.
  6416         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6417             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6418             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6419         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6420         16  FILLER                         PIC X(8).
  6421         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6422         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6423         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6424         16  CF-ACH-COMPANY-ID.
  6425             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6426                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6427                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6428                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6429             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6430         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6431             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6432         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6433             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6434             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6435         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6436         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6437         16  FILLER                         PIC X(536).
  6438
  6439****************************************************************
  6440*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6441****************************************************************
  6442
  6443     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 118
* EL050.cbl
  6444         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6445             20  CF-FEMALE-HEIGHT.
  6446                 24  CF-FEMALE-FT           PIC 99.
  6447                 24  CF-FEMALE-IN           PIC 99.
  6448             20  CF-FEMALE-MIN-WT           PIC 999.
  6449             20  CF-FEMALE-MAX-WT           PIC 999.
  6450         16  FILLER                         PIC X(428).
  6451
  6452     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6453         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6454             20  CF-MALE-HEIGHT.
  6455                 24  CF-MALE-FT             PIC 99.
  6456                 24  CF-MALE-IN             PIC 99.
  6457             20  CF-MALE-MIN-WT             PIC 999.
  6458             20  CF-MALE-MAX-WT             PIC 999.
  6459         16  FILLER                         PIC X(428).
  6460******************************************************************
  6461*             AUTOMATIC ACTIVITY RECORD                          *
  6462******************************************************************
  6463     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6464         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6465             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6466             20  CF-SYS-LETTER-ID           PIC X(04).
  6467             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6468             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6469             20  CF-SYS-RESET-SW            PIC X(01).
  6470             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6471             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6472
  6473         16  FILLER                         PIC X(50).
  6474
  6475         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6476             20  CF-USER-ACTIVE-SW          PIC X(01).
  6477             20  CF-USER-LETTER-ID          PIC X(04).
  6478             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6479             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6480             20  CF-USER-RESET-SW           PIC X(01).
  6481             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6482             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6483             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6484
  6485         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 119
* EL050.cbl
  6487*    COPY ERCACCT.
  6488******************************************************************
  6489*                                                                *
  6490*                                                                *
  6491*                            ERCACCT                             *
  6492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6493*                            VMOD=2.031                          *
  6494*                                                                *
  6495*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6496*                                                                *
  6497*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6498*   VSAM ACCOUNT MASTER FILES.                                   *
  6499*                                                                *
  6500*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6501*                                                                *
  6502*   FILE TYPE = VSAM,KSDS                                        *
  6503*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6504*                                                                *
  6505*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6506*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6507*                                                                *
  6508*   LOG = NO                                                     *
  6509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6510*                                                                *
  6511*                                                                *
  6512******************************************************************
  6513*                   C H A N G E   L O G
  6514*
  6515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6516*-----------------------------------------------------------------
  6517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6518* EFFECTIVE    NUMBER
  6519*-----------------------------------------------------------------
  6520* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6521* 092705    2005050300006  PEMA  ADD SPP LEASES
  6522* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6523* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6524* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6525* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6526* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6527******************************************************************
  6528
  6529 01  ACCOUNT-MASTER.
  6530     12  AM-RECORD-ID                      PIC XX.
  6531         88  VALID-AM-ID                      VALUE 'AM'.
  6532
  6533     12  AM-CONTROL-PRIMARY.
  6534         16  AM-COMPANY-CD                 PIC X.
  6535         16  AM-MSTR-CNTRL.
  6536             20  AM-CONTROL-A.
  6537                 24  AM-CARRIER            PIC X.
  6538                 24  AM-GROUPING.
  6539                     28 AM-GROUPING-PREFIX PIC XXX.
  6540                     28 AM-GROUPING-PRIME  PIC XXX.
  6541                 24  AM-STATE              PIC XX.
  6542                 24  AM-ACCOUNT.
  6543                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6544                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 120
* EL050.cbl
  6545             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6546                                           PIC X(19).
  6547             20  AM-CNTRL-B.
  6548                 24  AM-EXPIRATION-DT      PIC XX.
  6549                 24  FILLER                PIC X(4).
  6550             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6551                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6552
  6553     12  AM-CONTROL-BY-VAR-GRP.
  6554         16  AM-COMPANY-CD-A1              PIC X.
  6555         16  AM-VG-CARRIER                 PIC X.
  6556         16  AM-VG-GROUPING                PIC X(6).
  6557         16  AM-VG-STATE                   PIC XX.
  6558         16  AM-VG-ACCOUNT                 PIC X(10).
  6559         16  AM-VG-DATE.
  6560             20  AM-VG-EXPIRATION-DT       PIC XX.
  6561             20  FILLER                    PIC X(4).
  6562         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6563                                           PIC 9(11)      COMP-3.
  6564     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6565         16  FILLER                        PIC X(10).
  6566         16  AM-VG-KEY3.
  6567             20  AM-VG3-ACCOUNT            PIC X(10).
  6568             20  AM-VG3-EXP-DT             PIC XX.
  6569         16  FILLER                        PIC X(4).
  6570     12  AM-MAINT-INFORMATION.
  6571         16  AM-LAST-MAINT-DT              PIC XX.
  6572         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6573         16  AM-LAST-MAINT-USER            PIC X(4).
  6574         16  FILLER                        PIC XX.
  6575
  6576     12  AM-EFFECTIVE-DT                   PIC XX.
  6577     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6578
  6579     12  AM-PREV-DATES  COMP-3.
  6580         16  AM-PREV-EXP-DT                PIC 9(11).
  6581         16  AM-PREV-EFF-DT                PIC 9(11).
  6582
  6583     12  AM-REPORT-CODE-1                  PIC X(10).
  6584     12  AM-REPORT-CODE-2                  PIC X(10).
  6585
  6586     12  AM-CITY-CODE                      PIC X(4).
  6587     12  AM-COUNTY-PARISH                  PIC X(6).
  6588
  6589     12  AM-NAME                           PIC X(30).
  6590     12  AM-PERSON                         PIC X(30).
  6591     12  AM-ADDRS                          PIC X(30).
  6592     12  AM-CITY.
  6593         16  AM-ADDR-CITY                  PIC X(28).
  6594         16  AM-ADDR-STATE                 PIC XX.
  6595     12  AM-ZIP.
  6596         16  AM-ZIP-PRIME.
  6597             20  AM-ZIP-PRI-1ST            PIC X.
  6598                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6599             20  FILLER                    PIC X(4).
  6600         16  AM-ZIP-PLUS4                  PIC X(4).
  6601     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6602         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 121
* EL050.cbl
  6603         16  AM-CAN-POSTAL-2               PIC XXX.
  6604         16  FILLER                        PIC XXX.
  6605     12  AM-TEL-NO.
  6606         16  AM-AREA-CODE                  PIC 999.
  6607         16  AM-TEL-PRE                    PIC 999.
  6608         16  AM-TEL-NBR                    PIC 9(4).
  6609     12  AM-TEL-LOC                        PIC X.
  6610         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6611         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6612
  6613     12  AM-COMM-STRUCTURE.
  6614         16  AM-DEFN-1.
  6615             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6616                 24  AM-AGT.
  6617                     28  AM-AGT-PREFIX     PIC X(4).
  6618                     28  AM-AGT-PRIME      PIC X(6).
  6619                 24  AM-COM-TYP            PIC X.
  6620                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6621                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6622                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6623                 24  AM-RECALC-LV-INDIC    PIC X.
  6624                 24  AM-RETRO-LV-INDIC     PIC X.
  6625                 24  AM-GL-CODES           PIC X.
  6626                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6627                 24  FILLER                PIC X(01).
  6628         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6629             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6630                 24  FILLER                PIC X(11).
  6631                 24  AM-L-COMA             PIC XXX.
  6632                 24  AM-J-COMA             PIC XXX.
  6633                 24  AM-A-COMA             PIC XXX.
  6634                 24  FILLER                PIC X(6).
  6635
  6636     12  AM-COMM-CHANGE-STATUS             PIC X.
  6637         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6638
  6639     12  AM-CSR-CODE                       PIC X(4).
  6640
  6641     12  AM-BILLING-STATUS                 PIC X.
  6642         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6643         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6644     12  AM-AUTO-REFUND-SW                 PIC X.
  6645         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6646         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6647     12  AM-GPCD                           PIC 99.
  6648     12  AM-IG                             PIC X.
  6649         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6650         88  AM-HAS-GROUP                     VALUE '2'.
  6651     12  AM-STATUS                         PIC X.
  6652         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6653         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6654         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6655         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6656         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6657         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6658     12  AM-REMIT-TO                       PIC 99.
  6659     12  AM-ID-NO                          PIC X(11).
  6660
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 122
* EL050.cbl
  6661     12  AM-CAL-TABLE                      PIC XX.
  6662     12  AM-LF-DEVIATION                   PIC XXX.
  6663     12  AM-AH-DEVIATION                   PIC XXX.
  6664     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6665     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6666     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6667     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6668     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6669     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6670
  6671     12  AM-USER-FIELDS.
  6672         16  AM-FLD-1                      PIC XX.
  6673         16  AM-FLD-2                      PIC XX.
  6674         16  AM-FLD-3                      PIC XX.
  6675         16  AM-FLD-4                      PIC XX.
  6676         16  AM-FLD-5                      PIC XX.
  6677
  6678     12  AM-1ST-PROD-DATE.
  6679         16  AM-1ST-PROD-YR                PIC XX.
  6680         16  AM-1ST-PROD-MO                PIC XX.
  6681         16  AM-1ST-PROD-DA                PIC XX.
  6682     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6683     12  AM-CERTS-PURGED-DATE.
  6684         16  AM-PUR-YR                     PIC XX.
  6685         16  AM-PUR-MO                     PIC XX.
  6686         16  AM-PUR-DA                     PIC XX.
  6687     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6688     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6689     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6690     12  AM-INACTIVE-DATE.
  6691         16  AM-INA-MO                     PIC 99.
  6692         16  AM-INA-DA                     PIC 99.
  6693         16  AM-INA-YR                     PIC 99.
  6694     12  AM-AR-HI-CERT-DATE                PIC XX.
  6695
  6696     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6697     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6698
  6699     12  AM-OB-PAYMENT-MODE                PIC X.
  6700         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6701         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6702         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6703         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6704
  6705     12  AM-AH-ONLY-INDICATOR              PIC X.
  6706         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6707         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6708
  6709     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6710
  6711     12  AM-OVER-SHORT.
  6712         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6713         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6714
  6715     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6716     12  AM-DCC-CLP-STATE                  PIC XX.
  6717
  6718     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 123
* EL050.cbl
  6719     12  AM-RECALC-REIN                    PIC X.
  6720
  6721     12  AM-REI-TABLE                      PIC XXX.
  6722     12  AM-REI-ET-LF                      PIC X.
  6723     12  AM-REI-ET-AH                      PIC X.
  6724     12  AM-REI-PE-LF                      PIC X.
  6725     12  AM-REI-PE-AH                      PIC X.
  6726     12  AM-REI-PRT-ST                     PIC X.
  6727     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6728     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6729     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6730     12  AM-REI-GROUP-A                    PIC X(6).
  6731     12  AM-REI-MORT                       PIC X(4).
  6732     12  AM-REI-PRT-OW                     PIC X.
  6733     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6734     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6735     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6736     12  AM-REI-GROUP-B                    PIC X(6).
  6737
  6738     12  AM-TRUST-TYPE                     PIC X(2).
  6739
  6740     12  AM-EMPLOYER-STMT-USED             PIC X.
  6741     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6742
  6743     12  AM-STD-AH-TYPE                    PIC XX.
  6744     12  AM-EARN-METHODS.
  6745         16  AM-EARN-METHOD-R              PIC X.
  6746             88 AM-REF-RL-R78                 VALUE 'R'.
  6747             88 AM-REF-RL-PR                  VALUE 'P'.
  6748             88 AM-REF-RL-MEAN                VALUE 'M'.
  6749             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6750         16  AM-EARN-METHOD-L              PIC X.
  6751             88 AM-REF-LL-R78                 VALUE 'R'.
  6752             88 AM-REF-LL-PR                  VALUE 'P'.
  6753             88 AM-REF-LL-MEAN                VALUE 'M'.
  6754             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6755         16  AM-EARN-METHOD-A              PIC X.
  6756             88 AM-REF-AH-R78                 VALUE 'R'.
  6757             88 AM-REF-AH-PR                  VALUE 'P'.
  6758             88 AM-REF-AH-MEAN                VALUE 'M'.
  6759             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6760             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6761             88 AM-REF-AH-NET                 VALUE 'N'.
  6762
  6763     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6764     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6765     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6766
  6767     12  AM-RET-Y-N                        PIC X.
  6768     12  AM-RET-P-E                        PIC X.
  6769     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6770     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6771     12  AM-RET-GRP                        PIC X(6).
  6772     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6773         16  AM-POOL-PRIME                 PIC XXX.
  6774         16  AM-POOL-SUB                   PIC XXX.
  6775     12  AM-RETRO-EARNINGS.
  6776         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 124
* EL050.cbl
  6777         16  AM-RET-EARN-L                 PIC X.
  6778         16  AM-RET-EARN-A                 PIC X.
  6779     12  AM-RET-ST-TAX-USE                 PIC X.
  6780         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6781         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6782     12  AM-RETRO-BEG-EARNINGS.
  6783         16  AM-RET-BEG-EARN-R             PIC X.
  6784         16  AM-RET-BEG-EARN-L             PIC X.
  6785         16  AM-RET-BEG-EARN-A             PIC X.
  6786     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6787     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6788
  6789     12  AM-USER-SELECT-OPTIONS.
  6790         16  AM-USER-SELECT-1              PIC X(10).
  6791         16  AM-USER-SELECT-2              PIC X(10).
  6792         16  AM-USER-SELECT-3              PIC X(10).
  6793         16  AM-USER-SELECT-4              PIC X(10).
  6794         16  AM-USER-SELECT-5              PIC X(10).
  6795
  6796     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6797
  6798     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6799
  6800     12  AM-RPT045A-SWITCH                 PIC X.
  6801         88  RPT045A-OFF                   VALUE 'N'.
  6802
  6803     12  AM-INSURANCE-LIMITS.
  6804         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6805         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6806
  6807     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6808         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6809
  6810     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6811         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6812         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6813
  6814     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6815
  6816     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6817     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6818     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6819     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6820     12  AM-DCC-UEF-STATE                  PIC XX.
  6821     12  FILLER                            PIC XXX.
  6822     12  AM-REPORT-CODE-3                  PIC X(10).
  6823*    12  FILLER                            PIC X(22).
  6824
  6825     12  AM-RESERVE-DATE.
  6826         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6827         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6828         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6829
  6830     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6831     12  AM-NOTIFICATION-TYPES.
  6832         16  AM-NOTIF-OF-LETTERS           PIC X.
  6833         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6834         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 125
* EL050.cbl
  6835         16  AM-NOTIF-OF-STATUS            PIC X.
  6836
  6837     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6838         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6839         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6840         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6841         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6842
  6843     12  AM-BENEFIT-CONTROLS.
  6844         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6845             20  AM-BENEFIT-CODE           PIC XX.
  6846             20  AM-BENEFIT-TYPE           PIC X.
  6847             20  AM-BENEFIT-REVISION       PIC XXX.
  6848             20  AM-BENEFIT-REM-TERM       PIC X.
  6849             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6850             20  FILLER                    PIC XX.
  6851         16  FILLER                        PIC X(80).
  6852
  6853     12  AM-TRANSFER-DATA.
  6854         16  AM-TRANSFERRED-FROM.
  6855             20  AM-TRNFROM-CARRIER        PIC X.
  6856             20  AM-TRNFROM-GROUPING.
  6857                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6858                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6859             20  AM-TRNFROM-STATE          PIC XX.
  6860             20  AM-TRNFROM-ACCOUNT.
  6861                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6862                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6863             20  AM-TRNFROM-DTE            PIC XX.
  6864         16  AM-TRANSFERRED-TO.
  6865             20  AM-TRNTO-CARRIER          PIC X.
  6866             20  AM-TRNTO-GROUPING.
  6867                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6868                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6869             20  AM-TRNTO-STATE            PIC XX.
  6870             20  AM-TRNTO-ACCOUNT.
  6871                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6872                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6873             20  AM-TRNTO-DTE              PIC XX.
  6874         16  FILLER                        PIC X(10).
  6875
  6876     12  AM-SAVED-REMIT-TO                 PIC 99.
  6877
  6878     12  AM-COMM-STRUCTURE-SAVED.
  6879         16  AM-DEFN-1-SAVED.
  6880             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6881                 24  AM-AGT-SV             PIC X(10).
  6882                 24  AM-COM-TYP-SV         PIC X.
  6883                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6884                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6885                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6886                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6887                 24  FILLER                PIC X.
  6888                 24  AM-GL-CODES-SV        PIC X.
  6889                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6890                 24  FILLER                PIC X.
  6891         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6892             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 126
* EL050.cbl
  6893                 24  FILLER                PIC X(11).
  6894                 24  AM-L-COMA-SV          PIC XXX.
  6895                 24  AM-J-COMA-SV          PIC XXX.
  6896                 24  AM-A-COMA-SV          PIC XXX.
  6897                 24  FILLER                PIC X(6).
  6898
  6899     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6900         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6901            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6902            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6903            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6904
  6905     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6906     12  FILLER                            PIC X(120).
  6907
  6908     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6909         16  AM-CONTROL-NAME               PIC X(30).
  6910         16  AM-EXECUTIVE-ONE.
  6911             20  AM-EXEC1-NAME             PIC X(15).
  6912             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6913                                                          COMP-3.
  6914             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6915                                                          COMP-3.
  6916         16  AM-EXECUTIVE-TWO.
  6917             20  AM-EXEC2-NAME             PIC X(15).
  6918             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6919                                                          COMP-3.
  6920             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6921                                                          COMP-3.
  6922
  6923     12  AM-RETRO-ADDITIONAL-DATA.
  6924         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6925         16  AM-RETRO-PREM-P-E             PIC X.
  6926         16  AM-RETRO-CLMS-P-I             PIC X.
  6927         16  AM-RETRO-RET-BRACKET-LF.
  6928             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6929                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6930                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6931             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6932                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6933                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6934             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6935                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6936                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6937         16  AM-RETRO-RET-BRACKET-AH.
  6938             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6939                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6940                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6941                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6942             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6943                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6944                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6945             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6946                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6947                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6948
  6949     12  AM-COMMENTS.
  6950         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 127
* EL050.cbl
  6951
  6952     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6953         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6954         16  AM-FLI-BILLING-CODE           PIC X.
  6955         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6956         16  AM-FLI-UNITED-IDENT           PIC X.
  6957         16  AM-FLI-INTEREST-LOST-DATA.
  6958             20  AM-FLI-BANK-NO            PIC X(5).
  6959             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6960             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6961             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6962         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6963             20  AM-FLI-AGT                PIC X(9).
  6964             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6965             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6966         16  FILLER                        PIC X(102).
  6967
  6968     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6969         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6970             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6971             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6972             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6973             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6974             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6975         16  FILLER                          PIC X(10).
  6976******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 128
* EL050.cbl
  6978*    COPY ERCREIN.
  6979******************************************************************
  6980*                                                                *
  6981*                            ERCREIN                             *
  6982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6983*                            VMOD=2.010                          *
  6984*                                                                *
  6985*   ONLINE CREDIT SYSTEM                                         *
  6986*                                                                *
  6987*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6988*                                                                *
  6989*   FILE TYPE = VSAM,KSDS                                        *
  6990*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6991*                                                                *
  6992*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6993*       ALTERNATE PATH = NONE                                    *
  6994*                                                                *
  6995*   LOG = NO                                                     *
  6996*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6997*                                                                *
  6998******************************************************************
  6999*                   C H A N G E   L O G
  7000*
  7001* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7002*-----------------------------------------------------------------
  7003*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7004* EFFECTIVE    NUMBER
  7005*-----------------------------------------------------------------
  7006* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7007* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7008******************************************************************
  7009 01  REINSURANCE-RECORD.
  7010     12  RE-RECORD-ID                      PIC XX.
  7011         88  VALID-RE-ID                      VALUE 'RE'.
  7012
  7013     12  RE-CONTROL-PRIMARY.
  7014         16  RE-COMPANY-CD                 PIC X.
  7015         16  RE-KEY.
  7016             20  RE-CODE                   PIC X.
  7017                 88  RE-TABLE-RECORD          VALUE 'A'.
  7018                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7019             20  RE-TABLE                  PIC XXX.
  7020             20  FILLER                    PIC XXX.
  7021         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7022             20  FILLER                    PIC X.
  7023             20  RE-COMPANY.
  7024                 24  RE-COMP-PRIME         PIC XXX.
  7025                 24  RE-COMP-SUB           PIC XXX.
  7026
  7027     12  RE-MAINT-INFORMATION.
  7028         16  RE-LAST-MAINT-DT              PIC XX.
  7029         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7030         16  RE-LAST-MAINT-USER            PIC X(4).
  7031         16  FILLER                        PIC X(10).
  7032
  7033     12  RE-TABLE-DATA.
  7034         16  RE-100-COMP                   PIC 99.
  7035
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 129
* EL050.cbl
  7036         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7037             20  RE-REI-COMP-NO.
  7038                 24  RE-REI-COMP           PIC XXX.
  7039                 24  RE-REI-COMP-SUB       PIC XXX.
  7040             20  RE-LF-QC                  PIC X.
  7041             20  RE-AH-QC                  PIC X.
  7042             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7043             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7044             20  RE-LFAGE-LO               PIC 99.
  7045             20  RE-LFAGE-HI               PIC 99.
  7046             20  RE-AHAGE-LO               PIC 99.
  7047             20  RE-AHAGE-HI               PIC 99.
  7048             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7049             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7050             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7051             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7052             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7053             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7054             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7055             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7056             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7057             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7058             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7059             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7060             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7061             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7062             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7063             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7064             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7065             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7066             20  RE-LF-BEN-CODE            PIC X.
  7067             20  RE-AH-BEN-CODE            PIC X.
  7068             20  RE-INTERACTIVE            PIC X.
  7069             20  RE-REMAINING              PIC X.
  7070             20  RE-LF-RUNOFF-SW           PIC X.
  7071             20  RE-AH-RUNOFF-SW           PIC X.
  7072             20  FILLER                    PIC X(19).
  7073
  7074         16  RE-COMP-INFO-END              PIC X(6).
  7075         16  RE-NSP-ST-CD-LF               PIC XX.
  7076         16  RE-NSP-ST-CD-AH               PIC XX.
  7077         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7078             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7079
  7080         16  FILLER                        PIC X(27).
  7081
  7082     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7083         16  RE-NAME                       PIC X(30).
  7084         16  RE-LF-PE                      PIC X.
  7085         16  RE-AH-PE                      PIC X.
  7086         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7087         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7088         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7089         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7090         16  RE-PRT-ST                     PIC X.
  7091         16  RE-PRT-OW                     PIC X.
  7092         16  RE-MORT-CODE                  PIC X(4).
  7093         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 130
* EL050.cbl
  7094         16  RE-ZERO-LF-FEE                PIC X.
  7095         16  RE-ZERO-AH-FEE                PIC X.
  7096         16  RE-CEDE-NAME                  PIC X(30).
  7097         16  RE-LF-COMM                    PIC X.
  7098         16  RE-AH-COMM                    PIC X.
  7099         16  RE-LF-TAX                     PIC X.
  7100         16  RE-AH-TAX                     PIC X.
  7101         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7102         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7103         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7104
  7105         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7106             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7107
  7108         16  RE-LF-CEDING-FEE-BRACKETS.
  7109             20  RE-LF-FEE-METHOD          PIC X.
  7110                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7111                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7112                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7113                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7114             20  RE-LF-FEE-BASIS           PIC X.
  7115                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7116                 88  RE-LF-NET-CEDED               VALUE '2'.
  7117                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7118                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7119                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7120                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7121                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7122                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7123             20  FILLER                    PIC XXX.
  7124             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7125                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7126                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7127
  7128         16  RE-AH-CEDING-FEE-BRACKETS.
  7129             20  RE-AH-FEE-METHOD          PIC X.
  7130                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7131                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7132                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7133                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7134             20  RE-AH-FEE-BASIS           PIC X.
  7135                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7136                 88  RE-AH-NET-CEDED               VALUE '2'.
  7137                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7138                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7139                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7140                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7141                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7142                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7143             20  FILLER                    PIC XXX.
  7144             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7145                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7146                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7147
  7148         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7149
  7150         16  RE-OLD-CEDING-STMT            PIC X.
  7151
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 131
* EL050.cbl
  7152         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7153         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7154         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7155         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7156         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7157         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7158         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7159         16  RE-MORT-SW                    PIC X.
  7160         16  RE-CEDING-TYPE-FLAG           PIC X.
  7161             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7162             88  RE-CEDED                          VALUE 'C'.
  7163             88  RE-ASSUMED                        VALUE 'A'.
  7164             88  RE-PHANTOM                        VALUE 'P'.
  7165
  7166         16  RE-CEDING-STMT-OPT-A          PIC X.
  7167             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7168         16  RE-CEDING-STMT-OPT-B          PIC X.
  7169             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7170         16  RE-CEDING-STMT-OPT-C          PIC X.
  7171             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7172         16  RE-CEDING-STMT-OPT-D          PIC X.
  7173             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7174         16  RE-CEDING-STMT-OPT-E          PIC X.
  7175             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7176
  7177         16  RE-PRT-CRSV                   PIC X.
  7178
  7179         16  RE-GL-CENTER                  PIC X(4).
  7180
  7181         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7182
  7183         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7184
  7185         16  RE-EARN-STOP-CODE             PIC X.
  7186             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7187             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7188
  7189         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7190             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7191
  7192         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7193         16  FILLER                        PIC X(2281).
  7194
  7195         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7196
  7197******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 132
* EL050.cbl
  7199*    COPY ERCCTBL.
  7200******************************************************************
  7201*                                                                *
  7202*                                                                *
  7203*                            ERCCTBL                             *
  7204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7205*                            VMOD=2.003
  7206*                                                                *
  7207*   ONLINE CREDIT SYSTEM                                         *
  7208*                                                                *
  7209*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7210*                                                                *
  7211*   FILE TYPE = VSAM,KSDS                                        *
  7212*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7213*                                                                *
  7214*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7215*       ALTERNATE PATH = NONE                                    *
  7216*                                                                *
  7217*   LOG = NO                                                     *
  7218*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7219*                                                                *
  7220*                                                                *
  7221******************************************************************
  7222
  7223 01  COMM-TABLE-RECORD.
  7224     12  CT-RECORD-ID                      PIC XX.
  7225         88  VALID-CT-ID                      VALUE 'CT'.
  7226
  7227     12  CT-CONTROL-PRIMARY.
  7228         16  CT-COMPANY-CD                 PIC X.
  7229         16  CT-TABLE                      PIC XXX.
  7230         16  CT-CNTRL-2.
  7231             20  CT-BEN-TYPE               PIC X.
  7232             20  CT-BEN-CODE               PIC XX.
  7233
  7234     12  CT-MAINT-INFORMATION.
  7235         16  CT-LAST-MAINT-DT              PIC XX.
  7236         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7237         16  CT-LAST-MAINT-USER            PIC X(4).
  7238         16  FILLER                        PIC X(31).
  7239
  7240     12  CT-LIMITS.
  7241         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7242
  7243         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7244
  7245         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7246
  7247     12  CT-RATES.
  7248         16  CT-RTX          OCCURS 27 TIMES.
  7249             20  CT-RT                     PIC SV9(5)     COMP-3.
  7250             20  CT-RT-R   REDEFINES
  7251                 CT-RT                     PIC XXX.
  7252
  7253     12  FILLER                            PIC  X(42).
  7254
  7255******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 133
* EL050.cbl
  7257*    COPY ERCFORM.
  7258******************************************************************
  7259*                                                                *
  7260*                                                                *
  7261*                            ERCFORM.                            *
  7262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7263*                            VMOD=2.003                          *
  7264*                                                                *
  7265*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7266*                                                                *
  7267*    FILE TYPE = VSAM,KSDS                                       *
  7268*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7269*                                                                *
  7270*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7271*                                                                *
  7272*    LOG = YES                                                   *
  7273*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7274******************************************************************
  7275 01  FORM-MASTER.
  7276    12  FO-RECORD-ID                 PIC X(02).
  7277        88  VALID-FO-ID                  VALUE 'FO'.
  7278
  7279    12  FO-CONTROL-PRIMARY.
  7280        16  FO-COMPANY-CD            PIC X(01).
  7281        16  FO-STATE                 PIC X(02).
  7282        16  FO-FORM-ID               PIC X(12).
  7283        16  FO-FORM-EXP-DT           PIC X(02).
  7284
  7285    12  FO-POLICY-FORM-DATA.
  7286        16  FO-IND-GRP-CD            PIC X(01).
  7287        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7288        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7289        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7290        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7291        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7292        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7293        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7294        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7295        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7296        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7297        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7298        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7299        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7300        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7301        16  FO-APP-CERT-USE-CD       PIC X(01).
  7302
  7303    12  FILLER                       PIC X(29).
  7304
  7305    12  FO-FORM-PLAN-TABLE.
  7306        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7307            20  FO-PLAN-TYPE         PIC X(01).
  7308            20  FO-PLAN-ID           PIC X(02).
  7309            20  FO-PLAN-TERM         PIC 9(03).
  7310            20  FO-PLAN-REFUND-METHOD
  7311                                     PIC X.
  7312
  7313    12  FILLER                       PIC X(30).
  7314
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 134
* EL050.cbl
  7315    12  FO-COMMENTS-AREA.
  7316        16  FO-COMMENT-LINE-1        PIC X(78).
  7317
  7318    12  FILLER                       PIC X(20).
  7319
  7320    12  FO-MAINT-INFORMATION.
  7321        16  FO-LAST-MAINT-DT         PIC X(02).
  7322        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7323        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 135
* EL050.cbl
  7325*    COPY ELCMSTR.
  7326******************************************************************
  7327*                                                                *
  7328*                            ELCMSTR.                            *
  7329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7330*                            VMOD=2.012                          *
  7331*                                                                *
  7332*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7333*                                                                *
  7334*   FILE TYPE = VSAM,KSDS                                        *
  7335*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7336*                                                                *
  7337*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7338*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7339*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7340*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7341*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7342*                                                 RKP=75,LEN=21  *
  7343*                                                                *
  7344*   **** NOTE ****                                               *
  7345*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7346*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7347*                                                                *
  7348*   LOG = YES                                                    *
  7349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7350******************************************************************
  7351*                   C H A N G E   L O G
  7352*
  7353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7354*-----------------------------------------------------------------
  7355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7356* EFFECTIVE    NUMBER
  7357*-----------------------------------------------------------------
  7358* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7359* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7360* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7361* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7362* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7363******************************************************************
  7364 01  CLAIM-MASTER.
  7365     12  CL-RECORD-ID                PIC XX.
  7366         88  VALID-CL-ID         VALUE 'CL'.
  7367
  7368     12  CL-CONTROL-PRIMARY.
  7369         16  CL-COMPANY-CD           PIC X.
  7370         16  CL-CARRIER              PIC X.
  7371         16  CL-CLAIM-NO             PIC X(7).
  7372         16  CL-CERT-NO.
  7373             20  CL-CERT-PRIME       PIC X(10).
  7374             20  CL-CERT-SFX         PIC X.
  7375
  7376     12  CL-CONTROL-BY-NAME.
  7377         16  CL-COMPANY-CD-A1        PIC X.
  7378         16  CL-INSURED-LAST-NAME    PIC X(15).
  7379         16  CL-INSURED-NAME.
  7380             20  CL-INSURED-1ST-NAME PIC X(12).
  7381             20  CL-INSURED-MID-INIT PIC X.
  7382
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 136
* EL050.cbl
  7383     12  CL-CONTROL-BY-SSN.
  7384         16  CL-COMPANY-CD-A2        PIC X.
  7385         16  CL-SOC-SEC-NO.
  7386             20  CL-SSN-STATE        PIC XX.
  7387             20  CL-SSN-ACCOUNT      PIC X(6).
  7388             20  CL-SSN-LN3          PIC X(3).
  7389
  7390     12  CL-CONTROL-BY-CERT-NO.
  7391         16  CL-COMPANY-CD-A4        PIC X.
  7392         16  CL-CERT-NO-A4.
  7393             20  CL-CERT-A4-PRIME    PIC X(10).
  7394             20  CL-CERT-A4-SFX      PIC X.
  7395
  7396     12  CL-CONTROL-BY-CCN.
  7397         16  CL-COMPANY-CD-A5        PIC X.
  7398         16  CL-CCN-A5.
  7399             20  CL-CCN.
  7400                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7401                 24  CL-CCN-PRIME-A5 PIC X(12).
  7402             20  CL-CCN-FILLER-A5    PIC X(4).
  7403
  7404     12  CL-INSURED-PROFILE-DATA.
  7405         16  CL-INSURED-BIRTH-DT     PIC XX.
  7406         16  CL-INSURED-SEX-CD       PIC X.
  7407             88  INSURED-IS-MALE        VALUE 'M'.
  7408             88  INSURED-IS-FEMALE      VALUE 'F'.
  7409             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7410         16  CL-INSURED-OCC-CD       PIC X(6).
  7411         16  FILLER                  PIC X(5).
  7412
  7413     12  CL-PROCESSING-INFO.
  7414         16  CL-PROCESSOR-ID         PIC X(4).
  7415         16  CL-CLAIM-STATUS         PIC X.
  7416             88  CLAIM-IS-OPEN          VALUE 'O'.
  7417             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7418         16  CL-CLAIM-TYPE           PIC X.
  7419*            88  AH-CLAIM               VALUE 'A'.
  7420*            88  LIFE-CLAIM             VALUE 'L'.
  7421*            88  PROPERTY-CLAIM         VALUE 'P'.
  7422*            88  IUI-CLAIM              VALUE 'I'.
  7423*            88  GAP-CLAIM              VALUE 'G'.
  7424*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7425         16  CL-CLAIM-PREM-TYPE      PIC X.
  7426             88  SINGLE-PREMIUM         VALUE '1'.
  7427             88  O-B-COVERAGE           VALUE '2'.
  7428             88  OPEN-END-COVERAGE      VALUE '3'.
  7429         16  CL-INCURRED-DT          PIC XX.
  7430         16  CL-REPORTED-DT          PIC XX.
  7431         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7432         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7433         16  CL-LAST-PMT-DT          PIC XX.
  7434         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7435         16  CL-PAID-THRU-DT         PIC XX.
  7436         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7437         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7438         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7439         16  CL-PMT-CALC-METHOD      PIC X.
  7440             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 137
* EL050.cbl
  7441             88  CL-365-DAY-YR          VALUE '2'.
  7442             88  CL-FULL-MONTHS         VALUE '3'.
  7443         16  CL-CAUSE-CD             PIC X(6).
  7444
  7445         16  CL-PRIME-CERT-NO.
  7446             20  CL-PRIME-CERT-PRIME PIC X(10).
  7447             20  CL-PRIME-CERT-SFX   PIC X.
  7448
  7449         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7450             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7451             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7452
  7453         16  CL-MICROFILM-NO         PIC X(10).
  7454         16  FILLER REDEFINES CL-MICROFILM-NO.
  7455             20  CL-BENEFIT-PERIOD   PIC 99.
  7456             20  FILLER              PIC X(8).
  7457         16  CL-PROG-FORM-TYPE       PIC X.
  7458         16  CL-LAST-ADD-ON-DT       PIC XX.
  7459
  7460         16  CL-LAST-REOPEN-DT       PIC XX.
  7461         16  CL-LAST-CLOSE-DT        PIC XX.
  7462         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7463             88  FINAL-PAID             VALUE '1'.
  7464             88  CLAIM-DENIED           VALUE '2'.
  7465             88  AUTO-CLOSE             VALUE '3'.
  7466             88  MANUAL-CLOSE           VALUE '4'.
  7467             88  BENEFITS-CHANGED       VALUE 'C'.
  7468             88  SETUP-ERRORS           VALUE 'E'.
  7469         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7470         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7471         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7472             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7473         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7474         16  FILLER                  PIC X.
  7475
  7476     12  CL-CERTIFICATE-DATA.
  7477         16  CL-CERT-ORIGIN          PIC X.
  7478             88  CERT-WAS-ONLINE        VALUE '1'.
  7479             88  CERT-WAS-CREATED       VALUE '2'.
  7480             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7481         16  CL-CERT-KEY-DATA.
  7482             20  CL-CERT-CARRIER     PIC X.
  7483             20  CL-CERT-GROUPING    PIC X(6).
  7484             20  CL-CERT-STATE       PIC XX.
  7485             20  CL-CERT-ACCOUNT.
  7486                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7487                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7488             20  CL-CERT-EFF-DT      PIC XX.
  7489
  7490     12  CL-STATUS-CONTROLS.
  7491         16  CL-PRIORITY-CD          PIC X.
  7492             88  CONFIDENTIAL-DATA      VALUE '8'.
  7493             88  HIGHEST-PRIORITY       VALUE '9'.
  7494         16  CL-SUPV-ATTN-CD         PIC X.
  7495             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7496             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7497         16  CL-PURGED-DT            PIC XX.
  7498         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 138
* EL050.cbl
  7499         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7500         16  CL-NEXT-RESEND-DT       PIC XX.
  7501         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7502         16  CL-CRITICAL-PERIOD      PIC 99.
  7503*        16  FILLER                  PIC XX.
  7504         16  CL-LAST-MAINT-DT        PIC XX.
  7505         16  CL-LAST-MAINT-USER      PIC X(4).
  7506         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7507         16  CL-LAST-MAINT-TYPE      PIC X.
  7508             88  CLAIM-SET-UP           VALUE ' '.
  7509             88  PAYMENT-MADE           VALUE '1'.
  7510             88  LETTER-SENT            VALUE '2'.
  7511             88  MASTER-WAS-ALTERED     VALUE '3'.
  7512             88  MASTER-WAS-RESTORED    VALUE '4'.
  7513             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7514             88  FILE-CONVERTED         VALUE '6'.
  7515             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7516             88  ERROR-CORRECTION       VALUE 'E'.
  7517         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7518         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7519         16  CL-BENEFICIARY          PIC X(10).
  7520         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7521         16  CL-DENIAL-TYPE          PIC X.
  7522             88  CL-TYPE-DENIAL          VALUE '1'.
  7523             88  CL-TYPE-RESCISSION      VALUE '2'.
  7524             88  CL-TYPE-REFORMATION     VALUE '3'.
  7525             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7526             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7527         16  filler                  pic x(5).
  7528*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7529*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7530*        16  CL-RTW-DT               PIC XX.
  7531
  7532     12  CL-TRAILER-CONTROLS.
  7533         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7534             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7535             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7536             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7537         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7538         16  FILLER                  PIC XX.
  7539         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7540         16  CL-ADDRESS-TRAILER-CNT.
  7541             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7542                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7543             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7544                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7545             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7546                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7547             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7548                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7549             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7550                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7551             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7552                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7553             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7554                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7555
  7556     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 139
* EL050.cbl
  7557         16  CL-CV-REFNO-PRIME       PIC X(18).
  7558         16  CL-CV-REFNO-SFX         PIC XX.
  7559
  7560     12  CL-FILE-LOCATION            PIC X(4).
  7561
  7562     12  CL-PROCESS-ERRORS.
  7563         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7564             88  NO-FATAL-ERRORS        VALUE ZERO.
  7565         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7566             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7567
  7568     12  CL-PRODUCT-CD               PIC X.
  7569
  7570     12  CL-CURRENT-KEY-DATA.
  7571         16  CL-CURRENT-CARRIER      PIC X.
  7572         16  CL-CURRENT-GROUPING     PIC X(6).
  7573         16  CL-CURRENT-STATE        PIC XX.
  7574         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7575
  7576     12  CL-ASSOCIATES               PIC X.
  7577         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7578         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7579         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7580         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7581
  7582     12  CL-ACTIVITY-CODE            PIC 99.
  7583     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7584     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7585
  7586     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7587     12  CL-LAG-REPORT-CODE          PIC 9.
  7588     12  CL-LOAN-TYPE                PIC XX.
  7589     12  CL-LEGAL-STATE              PIC XX.
  7590
  7591     12  CL-YESNOSW                  PIC X.
  7592     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7593         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7594         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7595         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7596     12  cl-insured-type             pic x.
  7597         88  cl-claim-on-primary         value 'P'.
  7598         88  cl-claim-on-co-borrower     value 'C'.
  7599     12  cl-benefit-expiration-dt    PIC XX.
  7600
  7601 01  PLAN-RECORDS.
  7602     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7603     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7604
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 140
* EL050.cbl
  7606 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7607                          ACCOUNT-MASTER REINSURANCE-RECORD
  7608                          COMM-TABLE-RECORD FORM-MASTER
  7609                          CLAIM-MASTER PLAN-RECORDS.
  7610 0000-DFHEXIT SECTION.
  7611     MOVE '9#                    $   ' TO DFHEIV0.
  7612     MOVE 'EL050' TO DFHEIV1.
  7613     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7614
  7615     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7616
  7617
  7618* EXEC CICS  HANDLE CONDITION
  7619*           ERROR    (9300-ABEND)
  7620*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7621*    END-EXEC.
  7622*    MOVE '"$.J                  ! " #00007613' TO DFHEIV0
  7623     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7625     MOVE X'2220233030303037363133' TO DFHEIV0(25:11)
  7626     CALL 'kxdfhei1' USING DFHEIV0
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7628
  7629
  7630 0000-COPY-PROCEDURE-DIV.
  7631*                          COPY ELC50PD.
  7632******************************************************************
  7633*                                                                *
  7634*                            ELC50PD                             *
  7635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7636*                            VMOD=2.188                          *
  7637*                                                                *
  7638******************************************************************
  7639*                   C H A N G E   L O G
  7640*
  7641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7642*-----------------------------------------------------------------
  7643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7644* EFFECTIVE    NUMBER
  7645*-----------------------------------------------------------------
  7646* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7647* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7648* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7649*                             2709 AND 2718
  7650* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7651* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7652* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7653* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7654* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7655*                                IS OPEN OR CNC DT < PD THRU
  7656* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7657* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7658* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7659* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7660* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7661* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7662* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7663* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 141
* EL050.cbl
  7664* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7665* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7666* 020906                   PEMA  EXPAND LOAN OFFICER
  7667* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7668* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7669* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7670* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7671* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7672* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7673* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7674* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7675* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7676* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7677* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7678* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7679* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7680* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7681* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7682* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7683* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7684* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7685* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7686* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7687* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7688* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7689* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7690* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7691* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7692*                                UPDATE VIN ON CERT TRAILER
  7693* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7694* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7695* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7696* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7697* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7698* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7699* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7700* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7701* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7702* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7703* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7704* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7705* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7706* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7707* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7708* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7709* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7710* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7711* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7712* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7713* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7714* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7715* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7716* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7717* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7718* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7719* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7720* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7721* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 142
* EL050.cbl
  7722* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7723* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7724* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7725* 032912  CR2011110200001  PEMA  AHL CHANGES
  7726* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7727* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7728* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7729* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7730* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7731* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7732* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7733* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7734* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7735* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7736* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7737* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7738* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7739* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7740* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7741* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7742* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7743* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7744* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7745* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7746* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7747* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7748* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7749* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7750* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7751* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7752* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7753*                                CERT #, ADD 2898 FORCIBLE ERROR
  7754* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7755* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7756******************************************************************
  7757************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7758******************************************************************
  7759
  7760     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7761
  7762     MOVE SPACES                 TO PB-FATAL-FLAG
  7763                                    PB-FORCE-ER-CD
  7764                                    PB-WARN-ER-CD
  7765                                    PB-OUT-BAL-CD.
  7766
  7767     MOVE SPACE                  TO WS-IG-OVRD-AH
  7768                                    WS-IG-OVRD-LF
  7769                                    WS-IG-OVRD-AM
  7770                                    WS-IG-OVRD
  7771                                    WS-IG-OVRD-AH-PL
  7772                                    WS-IG-OVRD-LF-PL
  7773                                    WS-IG-OVRD-AH-BEN
  7774                                    WS-IG-OVRD-LF-BEN.
  7775
  7776******************************************************************
  7777*************       INITIALIZE COMMON ERRORS       ***************
  7778******************************************************************
  7779
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 143
* EL050.cbl
  7780     MOVE +0                     TO PB-NO-OF-ERRORS.
  7781     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7782
  7783******************************************************************
  7784
  7785     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7786     SET JULIAN-TO-BIN           TO TRUE.
  7787*    MOVE 5                      TO DC-OPTION-CODE.
  7788     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7789     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7790
  7791     MOVE ZERO                   TO  SUB4.
  7792
  7793 0040-INITIALIZE-GA-BILL-DT.
  7794
  7795     ADD +1                      TO  SUB4.
  7796
  7797     IF  SUB4 GREATER THAN +5
  7798         GO TO 0050-CHECK-CNTL-FOUND.
  7799
  7800     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7801         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7802
  7803     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7804
  7805 0050-CHECK-CNTL-FOUND.
  7806
  7807     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7808        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7809                                         WS-AH-REM-TERM-CALC
  7810                                         EC-CO-REM-TERM-CALC
  7811        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7812        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7813        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7814                                         WS-TOL-AH-CLAIM
  7815        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7816                                         WS-TOL-AH-PREM
  7817                                         EC-CO-TOL-PREM
  7818        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7819                                         WS-TOL-AH-REFUND
  7820                                         EC-CO-TOL-REFUND
  7821        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7822                                         WS-AH-REFUND-OVS-AMT
  7823                                         EC-CO-OVR-SHT-AMT
  7824        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7825                                         WS-TOL-AH-PREM-PCT
  7826                                         EC-CO-TOL-PREM-PCT
  7827        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7828                                         WS-TOL-AH-REFUND-PCT
  7829                                         EC-CO-TOL-REFUND-PCT
  7830        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7831                                         WS-AH-REFUND-OVS-PCT
  7832                                         EC-CO-OVR-SHT-PCT
  7833        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7834        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7835        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7836        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7837        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 144
* EL050.cbl
  7838        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7839        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7840        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7841        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7842        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7843        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7844        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7845                                         EC-CO-MONTH-END-DT
  7846        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7847          GO TO 0100-READ-ACCT.
  7848
  7849     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7850     MOVE SPACES                 TO CNTL-ACCESS.
  7851     MOVE '1'                    TO CNTL-REC-TYPE.
  7852     MOVE +0                     TO CNTL-SEQ-NO.
  7853
  7854     MOVE '1' TO RC-SW-1.
  7855     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7856     IF NOT CF-COMPANY-MASTER
  7857         MOVE ZEROS             TO WK-CO-TOL-PREM
  7858                                   WK-CO-TOL-CLAIM
  7859                                   WK-CO-TOL-REFUND
  7860                                   WK-REFUND-OVS-AMT
  7861                                   WK-REFUND-OVS-PCT
  7862                                   WK-CO-TOL-PREM-PCT
  7863                                   WK-CO-TOL-REFUND-PCT
  7864                                   WK-DEFAULT-APR
  7865                                   WK-CO-MAX-CAP
  7866        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7867                                   WK-CR-R78-METHOD
  7868                                   WK-CO-REF-REJECT-SW
  7869                                   WK-CO-PREM-REJECT-SW
  7870                                   WK-REM-TRM-CALC-OPTION
  7871                                   WK-BIRTH-DATE-INPUT
  7872                                   WK-JOINT-AGE-INPUT
  7873        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7874        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7875        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7876        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7877          GO TO 0099-COMPANY-NOT-FOUND.
  7878
  7879     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7880        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7881     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7882        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7883     IF CF-CO-TOL-CAP NOT NUMERIC
  7884        MOVE +0                    TO CF-CO-TOL-CAP.
  7885     IF CF-DEFAULT-APR NOT NUMERIC
  7886        MOVE +0                    TO CF-DEFAULT-APR.
  7887
  7888     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7889     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7890     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7891     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7892     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7893     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7894     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7895     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 145
* EL050.cbl
  7896     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7897     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7898     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7899     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7900
  7901     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7902          CF-CO-OVR-SHT-AMT > +0
  7903        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7904
  7905     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7906          CF-CO-OVR-SHT-PCT > +0
  7907        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7908
  7909     IF CF-VALID-REM-TRM-OPTION
  7910         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7911     ELSE
  7912         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7913
  7914     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7915     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7916     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7917     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7918
  7919     GO TO 0050-CHECK-CNTL-FOUND.
  7920
  7921 0099-COMPANY-NOT-FOUND.
  7922
  7923     MOVE ER-2616                TO WS-ERROR.
  7924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7925
  7926 0100-READ-ACCT.
  7927
  7928     MOVE SPACES                 TO DATE-RANGE-SW.
  7929
  7930     IF WK-ACCT-ADDR = ZEROS
  7931        GO TO 0102-ACCT-GETMAIN.
  7932
  7933     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7934     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7935     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7936
  7937     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7938        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7939        GO TO 0105-READ-ACCT
  7940     END-IF
  7941
  7942     IF PB-CARRIER NOT = SPACES
  7943        IF PB-CARRIER NOT = AM-VG-CARRIER
  7944           GO TO 0105-READ-ACCT.
  7945
  7946     IF PB-STATE NOT = SPACES
  7947        IF PB-STATE NOT = AM-VG-STATE
  7948           GO TO 0105-READ-ACCT.
  7949
  7950     IF PB-GROUPING NOT = SPACES
  7951        IF PB-GROUPING NOT = AM-VG-GROUPING
  7952           GO TO 0105-READ-ACCT.
  7953
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 146
* EL050.cbl
  7954     MOVE 'X'                 TO DATE-RANGE-SW.
  7955
  7956     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7957        MOVE 'X'                 TO DATE-RANGE-SW
  7958        GO TO 0105-READ-ACCT.
  7959
  7960     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7961        GO TO 0105-READ-ACCT.
  7962
  7963     GO TO 0180-ACCOUNT-FOUND.
  7964
  7965 0102-ACCT-GETMAIN.
  7966     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7967     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7968
  7969 0105-READ-ACCT.
  7970     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7971     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7972     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7973     MOVE PB-STATE               TO ACCT-STATE.
  7974     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7975     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7976
  7977     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7978
  7979     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7980
  7981 0110-FIND-ACCT-TOLERANCES-LOOP.
  7982     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7983
  7984     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7985        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7986        GO TO 0199-ACCT-NOT-FOUND
  7987     END-IF
  7988     IF PB-CARRIER NOT = SPACES
  7989        IF PB-CARRIER NOT = AM-VG-CARRIER
  7990           GO TO 0199-ACCT-NOT-FOUND.
  7991
  7992     IF PB-STATE NOT = SPACES
  7993        IF PB-STATE NOT = AM-VG-STATE
  7994           GO TO 0199-ACCT-NOT-FOUND.
  7995
  7996     IF PB-GROUPING NOT = SPACES
  7997        IF PB-GROUPING NOT = AM-VG-GROUPING
  7998           GO TO 0199-ACCT-NOT-FOUND.
  7999
  8000     MOVE 'X'                    TO DATE-RANGE-SW.
  8001
  8002     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8003        MOVE 'X'                 TO DATE-RANGE-SW
  8004        GO TO 0199-ACCT-NOT-FOUND.
  8005
  8006     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8007        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8008
  8009 0180-ACCOUNT-FOUND.
  8010     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8011     MOVE AM-CARRIER             TO PB-SV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 147
* EL050.cbl
  8012     MOVE AM-STATE               TO PB-SV-STATE.
  8013     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8014
  8015     IF AM-CANCEL-FEE  NOT NUMERIC
  8016        MOVE ZEROS TO AM-CANCEL-FEE.
  8017
  8018     IF AM-MAX-MON-BEN NOT NUMERIC
  8019        MOVE ZEROS TO AM-MAX-MON-BEN.
  8020
  8021     IF AM-MAX-TOT-BEN NOT NUMERIC
  8022        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8023
  8024     IF AM-CLP-TOL-PCT NOT NUMERIC
  8025        MOVE +0                  TO AM-CLP-TOL-PCT
  8026     END-IF
  8027     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8028        MOVE +0                  TO AM-SPP-LEASE-COMM
  8029     END-IF
  8030     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8031        MOVE ER-2611             TO   WS-ERROR
  8032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8033
  8034     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8035        MOVE ER-2621             TO   WS-ERROR
  8036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8037
  8038     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8039        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8040        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8041        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8042         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8043
  8044     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8045     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8046     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8047     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8048     IF AM-CLP-TOL-PCT NOT = ZEROS
  8049        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8050     END-IF
  8051     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8052        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8053     END-IF
  8054*    IF PB-COMPANY-ID = 'DCC'
  8055*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8056*                                   WS-ADMIN-FEES
  8057*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8058*          (SUB5 > +10)
  8059*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8060*             AND (AM-A-COM (SUB5) NUMERIC)
  8061*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8062*                + (AM-A-COM (SUB5) * 1000)
  8063*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8064*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8065*                + (AM-A-COM (SUB5) * 1000)
  8066*             END-IF
  8067*             IF AM-COM-TYP (SUB5) = 'N'
  8068*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8069*                + (AM-A-COM (SUB5) * 1000)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 148
* EL050.cbl
  8070*             END-IF
  8071*          END-IF
  8072*       END-PERFORM
  8073*    END-IF
  8074     IF (PB-COMPANY-ID = 'DCC')
  8075        AND (PB-ISSUE)
  8076        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8077                                    ws-cred-union-fees
  8078        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8079           (SUB5 > +10)
  8080           MOVE +0 TO WS-WK-RATE
  8081           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8082                                   'O' OR 'S')
  8083              IF (AM-A-COM (SUB5) NUMERIC)
  8084                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8085                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8086              ELSE
  8087                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8088                 IF PB-ISSUE
  8089                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8090                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8091                 ELSE
  8092                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8093                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8094                 END-IF
  8095                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8096                 MOVE ZEROS             TO WS-SUB1
  8097                                           WS-COMMISSION
  8098                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8099                 MOVE '0530'               TO CTBL-SW
  8100                 MOVE ' '                  TO WS-CTBL-READ-SW
  8101                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8102                 IF FIRST-TIME-THROUGH
  8103                    MOVE 'AA'              TO CTBL-BEN-CODE
  8104                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8105                 END-IF
  8106                 IF CTBL-TABLE-FOUND
  8107                    IF PB-ISSUE
  8108                       COMPUTE WS-COMM-CK-AMT =
  8109                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8110                    ELSE
  8111                       COMPUTE WS-COMM-CK-AMT =
  8112                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8113                    END-IF
  8114                    PERFORM 8800-GET-COMP-RATE
  8115                              THRU 8800-EXIT
  8116                 END-IF
  8117              END-IF
  8118              if am-com-typ (sub5) = 'O' or 'S'
  8119                 compute ws-cred-union-fees rounded =
  8120                    ws-cred-union-fees +
  8121                    (pb-i-ah-premium-amt * ws-wk-rate)
  8122              else
  8123                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8124                + (WS-WK-RATE * 1000)
  8125              end-if
  8126           END-IF
  8127        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 149
* EL050.cbl
  8128     END-IF
  8129     IF PB-COMPANY-ID EQUAL 'CRI'
  8130         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8131
  8132     IF PB-COMPANY-ID EQUAL 'NCL'
  8133         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8134     END-IF
  8135
  8136     GO TO 0200-READ-CERT.
  8137
  8138 0199-ACCT-NOT-FOUND.
  8139
  8140     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8141
  8142     IF DATE-RANGE-SW NOT = SPACES
  8143        MOVE ER-2601             TO WS-ERROR
  8144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145     ELSE
  8146        MOVE ER-2619             TO WS-ERROR
  8147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8148
  8149     GO TO 9990-RETURN.
  8150
  8151 0200-READ-CERT.
  8152
  8153     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8154     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8155     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8156     MOVE PB-SV-STATE            TO CERT-STATE.
  8157     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8158     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8159     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8160
  8161     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8162
  8163     IF CERT-WAS-NOT-FOUND
  8164        GO TO 0299-CERT-NOT-FOUND.
  8165
  8166     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8167        MOVE ER-2759             TO WS-ERROR
  8168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8169        GO TO 0298-UNLOCK-RETURN.
  8170
  8171     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8172         MOVE ER-2758            TO WS-ERROR
  8173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8174         GO TO 0298-UNLOCK-RETURN.
  8175
  8176     IF PB-ISSUE
  8177        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8178           IF CERT-WAS-CREATED-FOR-CLAIM
  8179              NEXT SENTENCE
  8180            ELSE
  8181              MOVE ER-2626       TO WS-ERROR
  8182              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8183              GO TO 0298-UNLOCK-RETURN.
  8184
  8185     IF NOT PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 150
* EL050.cbl
  8186        GO TO 0300-CONTINUE-EDIT.
  8187
  8188     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8189     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8190     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8191     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8192     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8193     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8194
  8195     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8196     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8197     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8198     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8199     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8200     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8201     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8202     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8203     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8204
  8205     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8206     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8207     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8208     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8209     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8210     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8211     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8212
  8213     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8214     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8215
  8216     MOVE CM-CREDIT-INTERFACE-SW-1
  8217                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8218     MOVE CM-CREDIT-INTERFACE-SW-2
  8219                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8220
  8221     IF CM-O-B-COVERAGE
  8222         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8223
  8224     IF CM-LIVES NOT NUMERIC
  8225         MOVE ZERO                TO CM-LIVES.
  8226
  8227     IF CM-BILLED NOT NUMERIC
  8228         MOVE ZERO                TO CM-BILLED.
  8229
  8230     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8231         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8232         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8233         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8234         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8235         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8236         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8237         MOVE CM-LIVES             TO PB-CI-LIVES
  8238*The next line causes a problem with my change  I dont think it is
  8239*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8240
  8241     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8242     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8243     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 151
* EL050.cbl
  8244     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8245     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8246     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8247
  8248     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8249     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8250     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8251     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8252
  8253     IF CM-LIFE-COMM-PCT NUMERIC
  8254         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8255     ELSE
  8256         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8257
  8258     IF CM-AH-COMM-PCT NUMERIC
  8259         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8260     ELSE
  8261         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8262
  8263     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8264
  8265     IF CM-LOAN-APR       NOT NUMERIC
  8266           MOVE ZERO               TO CM-LOAN-APR.
  8267
  8268     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8269           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8270
  8271     IF CM-LOAN-TERM      NOT NUMERIC
  8272           MOVE ZERO               TO CM-LOAN-TERM.
  8273
  8274     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8275           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8276
  8277     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8278           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8279
  8280     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8281     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8282     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8283     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8284     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8285     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8286     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8287     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8288     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8289     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8290     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8291     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8292
  8293     IF CM-STATE = CM-SSN-STATE
  8294         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8295
  8296     IF CM-STATE NOT = CM-MEMB-STATE
  8297         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8298
  8299     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8300
  8301     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 152
* EL050.cbl
  8302        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8303        IF CM-ADDL-CLP NOT NUMERIC
  8304           MOVE +0               TO CM-ADDL-CLP
  8305        END-IF
  8306        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8307        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8308           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8309        END-IF
  8310     END-IF
  8311     IF PB-COMPANY-ID = 'DCC'
  8312        MOVE +0                  TO WS-ADMIN-FEES
  8313                                    WS-CSO-ADMIN-FEE
  8314                                    WS-COMM-AND-MFEE
  8315                                    WS-1ST-YR-ALLOW
  8316        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8317           (SUB5 > +10)
  8318           MOVE +0 TO WS-WK-RATE
  8319           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8320              IF (AM-A-COM (SUB5) NUMERIC)
  8321                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8322                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8323              ELSE
  8324                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8325                 IF PB-ISSUE
  8326                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8327                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8328                 ELSE
  8329                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8330                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8331                 END-IF
  8332                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8333                 MOVE ZEROS             TO WS-SUB1
  8334                                           WS-COMMISSION
  8335                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8336                 MOVE '0530'               TO CTBL-SW
  8337                 MOVE ' '                  TO WS-CTBL-READ-SW
  8338                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8339                 IF FIRST-TIME-THROUGH
  8340                    MOVE 'AA'              TO CTBL-BEN-CODE
  8341                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8342                 END-IF
  8343                 IF CTBL-TABLE-FOUND
  8344                    IF PB-ISSUE
  8345                       COMPUTE WS-COMM-CK-AMT =
  8346                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8347                    ELSE
  8348                       COMPUTE WS-COMM-CK-AMT =
  8349                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8350                    END-IF
  8351                    PERFORM 8800-GET-COMP-RATE
  8352                              THRU 8800-EXIT
  8353                 END-IF
  8354              END-IF
  8355              IF AM-COM-TYP (SUB5) = 'I'
  8356                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8357                   + (WS-WK-RATE * 1000)
  8358              END-IF
  8359              IF AM-COM-TYP (SUB5) = 'N'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 153
* EL050.cbl
  8360                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8361                   + (WS-WK-RATE * 1000)
  8362              END-IF
  8363              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8364                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8365                   + (WS-WK-RATE * 1000)
  8366              END-IF
  8367              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8368                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8369                   + (WS-WK-RATE * 1000)
  8370              END-IF
  8371           END-IF
  8372        END-PERFORM
  8373     END-IF
  8374     GO TO 0300-CONTINUE-EDIT.
  8375
  8376 0298-UNLOCK-RETURN.
  8377      PERFORM 9250-UNLOCK-RETURN
  8378      GO TO 9990-RETURN.
  8379
  8380 0299-CERT-NOT-FOUND.
  8381
  8382     MOVE '1'                     TO CERT-STATUS-SW.
  8383
  8384     IF PB-COMPANY-ID = 'UCL'
  8385         IF WS-ERROR = ER-2799
  8386             GO TO 3000-CONTINUE-EDIT.
  8387
  8388     IF NOT PB-CANCELLATION
  8389         GO TO 0300-CONTINUE-EDIT.
  8390
  8391     MOVE ER-2726                  TO  WS-ERROR.
  8392     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8393     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8394     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8395                                    PB-CI-LF-TERM
  8396                                    PB-C-LF-REM-TERM
  8397                                    PB-CI-AH-TERM
  8398                                    PB-C-AH-REM-TERM
  8399                                    PB-CI-LF-BENEFIT-CD
  8400                                    PB-CI-LF-BENEFIT-AMT
  8401                                    PB-CI-LF-ALT-BENEFIT-AMT
  8402                                    PB-CI-LF-PREMIUM-AMT
  8403                                    PB-CI-LF-ALT-PREMIUM-AMT
  8404                                    PB-CI-AH-BENEFIT-CD
  8405                                    PB-CI-AH-BENEFIT-AMT
  8406                                    PB-CI-AH-PREMIUM-AMT
  8407                                    PB-CI-PAY-FREQUENCY
  8408                                    PB-CI-LOAN-APR
  8409                                    PB-CI-LOAN-TERM
  8410                                    PB-CI-LIFE-COMMISSION
  8411                                    PB-CI-AH-COMMISSION
  8412                                    PB-CI-CURR-SEQ
  8413                                    PB-CI-AH-CANCEL-AMT
  8414                                    PB-CI-LF-CANCEL-AMT
  8415                                    PB-CI-RATE-DEV-PCT-LF
  8416                                    PB-CI-RATE-DEV-PCT-AH
  8417                                    PB-CI-EXTENTION-DAYS
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 154
* EL050.cbl
  8418                                    PB-CI-TERM-IN-DAYS
  8419                                    PB-CI-LIVES
  8420                                    PB-CI-LF-CRIT-PER
  8421                                    PB-CI-AH-CRIT-PER
  8422                                    PB-CI-ADDL-CLP
  8423                                    PB-CI-DDF-IU-RATE-UP.
  8424
  8425     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8426                                    PB-CI-AH-SETTLEMENT-DT
  8427                                    PB-CI-DEATH-DT
  8428                                    PB-CI-LF-PRIOR-CANCEL-DT
  8429                                    PB-CI-AH-PRIOR-CANCEL-DT
  8430                                    PB-CI-ENTRY-DT
  8431                                    PB-CI-LF-EXPIRE-DT
  8432                                    PB-CI-AH-EXPIRE-DT
  8433                                    PB-CI-LOAN-1ST-PMT-DT.
  8434
  8435     IF ACCOUNT-MAST-FOUND
  8436        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8437        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8438
  8439
  8440 0300-CONTINUE-EDIT.
  8441
  8442     IF PB-ISSUE
  8443        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8444            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8445
  8446     IF PB-ISSUE
  8447        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8448            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8449
  8450     IF PB-ISSUE
  8451       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8452          (AM-NO-AH-ONLY)
  8453           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8454               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8455                   MOVE ER-2679 TO WS-ERROR
  8456                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8457
  8458     IF PB-ISSUE
  8459        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8460        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8461        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8462     ELSE
  8463        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8464        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8465        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8466
  8467     MOVE 'N'                    TO PLAN-MASTER-SW
  8468                                    PLAN-MASTER-LIFE-SW
  8469                                    FORM-MASTER-SW
  8470                                    WS-APP-CERT-SW.
  8471
  8472     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8473                                    WS-PL-TOL-LF-REFUND
  8474                                    WS-PL-REF-OVS-AMT
  8475                                    WS-PL-TOL-LF-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 155
* EL050.cbl
  8476                                    WS-PL-TOL-LF-REFUND-PCT
  8477                                    WS-PL-REF-OVS-PCT
  8478                                    WS-PL-TOL-LF-CLAIM.
  8479
  8480     IF PB-COMPANY-ID = 'NCL'
  8481       IF PB-ISSUE
  8482         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8483             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8484             IF FORM-MASTER-FOUND
  8485                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8486
  8487     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8488        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8489
  8490********************** MON CODE **********************
  8491     IF PB-COMPANY-ID = 'MON'
  8492     IF PB-ISSUE
  8493     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8494        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8495             PB-I-LOAN-APR = ZERO)
  8496               MOVE 14.0         TO PB-I-LOAN-APR.
  8497******************************************************
  8498
  8499     IF PB-COMPANY-ID = 'NCL'
  8500       IF PB-ISSUE
  8501           IF FORM-MASTER-FOUND
  8502             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8503                AM-DISMBR-COVERAGE
  8504                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8505                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8506                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8507                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8508                                           PB-I-LIFE-BENEFIT-CD.
  8509
  8510     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8511
  8512     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8513         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8514         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8515         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8516         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8517         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8518           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8519             GO TO 0301-LIFE-BENEFIT-SEARCH
  8520         ELSE
  8521             NEXT SENTENCE
  8522     ELSE
  8523         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8524
  8525     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8526     MOVE '4'                    TO CNTL-REC-TYPE.
  8527     MOVE +0                     TO CNTL-SEQ-NO.
  8528     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8529
  8530     MOVE '1' TO RC-SW-2.
  8531     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8532
  8533     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 156
* EL050.cbl
  8534        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8535         GO TO 0305-BENEFIT-NOT-FOUND.
  8536
  8537     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8538
  8539 0301-LIFE-BENEFIT-SEARCH.
  8540
  8541     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8542
  8543     IF NO-BENEFIT-FOUND
  8544        GO TO 0305-BENEFIT-NOT-FOUND.
  8545
  8546     IF WS-BEN-CD = '99'
  8547        GO TO 0305-BENEFIT-NOT-FOUND.
  8548
  8549     IF PB-COMPANY-ID = 'NCL'
  8550         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8551             GO TO 0304-LIFE-BENEFIT-FOUND.
  8552
  8553     MOVE +1                     TO SUB5.
  8554     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8555
  8556* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8557* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8558     IF PB-COMPANY-ID = 'DMD'
  8559         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8560
  8561 0302-EDIT-ACCT-LF-BENEFITS.
  8562
  8563     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8564        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8565           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8566                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8567           GO TO 03XX-GET-LIFE-ERPLAN.
  8568
  8569     IF SUB5 LESS THAN +20
  8570        ADD +1                   TO SUB5
  8571        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8572
  8573     MOVE +1                     TO SUB5.
  8574
  8575     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8576        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8577
  8578 0303-EDIT-DMD-EXTRA-BENEFITS.
  8579
  8580     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8581        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8582           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8583                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8584           GO TO 03XX-GET-LIFE-ERPLAN.
  8585
  8586     IF SUB5 LESS THAN +30
  8587        ADD +1                   TO SUB5
  8588        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8589
  8590     MOVE +1                     TO SUB5.
  8591
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 157
* EL050.cbl
  8592 03XX-EDIT-FOR-NINETY-LF.
  8593
  8594***************************************************************
  8595*                                                             *
  8596*    NINETY BENEFIT PLAN TYPES:                               *
  8597*                                                             *
  8598*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8599*      92 = ALL GROUP REDUCING BENEFITS                       *
  8600*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8601*      94 = ALL GROUP LEVEL BENEFITS                          *
  8602*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8603*           BENEFIT CONTROLS.                                 *
  8604*      99 = ALL BENEFITS                                      *
  8605*                                                             *
  8606***************************************************************
  8607
  8608     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8609                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8610
  8611     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8612       AND
  8613        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8614        GO TO 03XX-GET-LIFE-ERPLAN.
  8615
  8616     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8617       AND
  8618        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8619        IF CF-REDUCING (SUB3)
  8620           IF (PB-I-INDV-GRP-OVRD = 'I')
  8621              OR
  8622           ((AM-IG = '1') AND
  8623           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8624              OR
  8625           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8626           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8627           (AM-IG NOT = '2'))
  8628              GO TO 03XX-GET-LIFE-ERPLAN.
  8629
  8630     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8631       AND
  8632        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8633        IF CF-REDUCING (SUB3)
  8634           IF (PB-I-INDV-GRP-OVRD = 'G')
  8635              OR
  8636           ((AM-IG = '2') AND
  8637           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8638              OR
  8639           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8640           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8641           (AM-IG NOT = '1'))
  8642              GO TO 03XX-GET-LIFE-ERPLAN.
  8643
  8644     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8645       AND
  8646        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8647        IF CF-LEVEL    (SUB3)
  8648           IF (PB-I-INDV-GRP-OVRD = 'I')
  8649              OR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 158
* EL050.cbl
  8650           ((AM-IG = '1') AND
  8651           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8652              OR
  8653           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8654           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8655            (AM-IG NOT = '2'))
  8656              GO TO 03XX-GET-LIFE-ERPLAN.
  8657
  8658     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8659       AND
  8660        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8661        IF CF-LEVEL    (SUB3)
  8662           IF (PB-I-INDV-GRP-OVRD = 'G')
  8663              OR
  8664           ((AM-IG = '2') AND
  8665           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8666              OR
  8667           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8668           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8669           (AM-IG NOT = '1'))
  8670              GO TO 03XX-GET-LIFE-ERPLAN.
  8671
  8672     IF SUB5 LESS THAN +20
  8673        ADD +1                   TO SUB5
  8674        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8675
  8676     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8677
  8678     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8679        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8680
  8681     MOVE +1                     TO SUB5.
  8682
  8683 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8684
  8685     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8686                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8687
  8688     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8689       AND
  8690        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8691        GO TO 03XX-GET-LIFE-ERPLAN.
  8692
  8693     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8694       AND
  8695        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8696        IF CF-REDUCING (SUB3)
  8697           IF (PB-I-INDV-GRP-OVRD = 'I')
  8698              OR
  8699           ((AM-IG = '1') AND
  8700           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8701              OR
  8702           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8703           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8704           (AM-IG NOT = '2'))
  8705              GO TO 03XX-GET-LIFE-ERPLAN.
  8706
  8707     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 159
* EL050.cbl
  8708       AND
  8709        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8710        IF CF-REDUCING (SUB3)
  8711           IF (PB-I-INDV-GRP-OVRD = 'G')
  8712              OR
  8713           ((AM-IG = '2') AND
  8714           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8715              OR
  8716           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8717           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8718           (AM-IG NOT = '1'))
  8719              GO TO 03XX-GET-LIFE-ERPLAN.
  8720
  8721     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8722       AND
  8723        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8724        IF CF-LEVEL    (SUB3)
  8725           IF (PB-I-INDV-GRP-OVRD = 'I')
  8726              OR
  8727           ((AM-IG = '1') AND
  8728           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8729              OR
  8730           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8731           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8732            (AM-IG NOT = '2'))
  8733              GO TO 03XX-GET-LIFE-ERPLAN.
  8734
  8735     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8736       AND
  8737        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8738        IF CF-LEVEL    (SUB3)
  8739           IF (PB-I-INDV-GRP-OVRD = 'G')
  8740              OR
  8741           ((AM-IG = '2') AND
  8742           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8743              OR
  8744           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8745           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8746           (AM-IG NOT = '1'))
  8747              GO TO 03XX-GET-LIFE-ERPLAN.
  8748
  8749     IF SUB5 LESS THAN +30
  8750        ADD +1                   TO SUB5
  8751        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8752
  8753     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8754
  8755 03XX-EDIT-FOR-NINETY-LF-CONT.
  8756
  8757     MOVE +99                    TO SUB5.
  8758
  8759     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8760        IF PB-ISSUE
  8761           MOVE ER-1924          TO  WS-ERROR
  8762           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8763
  8764     GO TO 0304-LIFE-BENEFIT-FOUND.
  8765
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 160
* EL050.cbl
  8766 03XX-GET-LIFE-ERPLAN.
  8767
  8768     IF WK-PLAN-ADDR EQUAL +0
  8769        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8770
  8771     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8772     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8773     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8774     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8775     MOVE 'Y'                    TO PLAN-MASTER-SW
  8776                                    PLAN-MASTER-LIFE-SW.
  8777     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8778
  8779 03XX-ERPLAN-LIFE-GETMAIN.
  8780
  8781     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8782     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8783
  8784 03XX-ERPLAN-LIFE-READ.
  8785
  8786     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8787     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8788     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8789     MOVE PB-SV-STATE            TO PLAN-STATE.
  8790     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8791     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8792     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8793     MOVE WS-SAVE-BENEFIT-REVISION
  8794                                 TO PLAN-REVISION-NO.
  8795
  8796     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8797     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8798
  8799     IF PB-COMPANY-ID = 'NCL'
  8800       IF NOT LF-PLAN-MASTER-FOUND
  8801         IF NOT PB-POLICY-IS-DECLINED  AND
  8802            NOT PB-POLICY-IS-VOIDED
  8803             MOVE  ER-1921         TO  WS-ERROR
  8804             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8805             GO TO 0304-LIFE-BENEFIT-FOUND.
  8806
  8807     IF NOT LF-PLAN-MASTER-FOUND
  8808        GO TO 0304-LIFE-BENEFIT-FOUND.
  8809
  8810 XXXX-CHECK-LF-PLAN-KEY.
  8811
  8812     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8813        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8814        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8815        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8816        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8817        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8818        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8819        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8820        MOVE 'N'                 TO PLAN-MASTER-SW
  8821          GO TO 03XX-ERPLAN-LIFE-READ.
  8822
  8823     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 161
* EL050.cbl
  8824
  8825     IF  PB-CANCELLATION
  8826         GO TO  0303-LF-ACCT-BEN-FOUND.
  8827
  8828     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8829        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8830           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8831           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8832              MOVE ER-2644             TO WS-ERROR
  8833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8834           ELSE
  8835              NEXT SENTENCE
  8836        ELSE
  8837           IF PB-COMPANY-ID NOT = 'NCL'
  8838              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8839                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8840
  8841 0303-LF-ACCT-BEN-FOUND.
  8842
  8843     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8844
  8845     IF PL-DEV-CODE NOT = SPACES
  8846        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8847
  8848     IF PL-DEV-PCT NUMERIC AND
  8849        PL-DEV-PCT NOT = ZEROS
  8850        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8851
  8852     IF PL-TOL-PREM-AMT GREATER THAN +0
  8853        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8854
  8855     IF PL-TOL-REF-AMT GREATER THAN +0
  8856        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8857
  8858     IF PL-TOL-PREM-PCT GREATER THAN +0
  8859        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8860
  8861     IF PL-TOL-REF-PCT GREATER THAN +0
  8862        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8863
  8864     IF PL-TOL-CLM-AMT GREATER THAN +0
  8865        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8866
  8867     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8868                          PL-OVER-SHORT-AMT > +0
  8869        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8870
  8871     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8872                          PL-OVER-SHORT-PCT > +0
  8873        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8874
  8875     IF PL-SALES-TAX NUMERIC AND
  8876                          PL-SALES-TAX > +0
  8877         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8878
  8879     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8880        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8881                                    WS-IG-OVRD-AM.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 162
* EL050.cbl
  8882
  8883 0304-LIFE-BENEFIT-FOUND.
  8884
  8885     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8886
  8887     IF PB-ISSUE
  8888        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8889     ELSE
  8890        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8891
  8892     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8893     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8894     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8895     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8896     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8897                                         WS-LF-REFUND-CALC.
  8898     if (ws-lf-earnings-calc = '5')
  8899        and (pb-i-loan-apr = zeros)
  8900        and (benefit-code-chg)
  8901        move +99.9999 to pb-i-loan-apr
  8902     end-if
  8903
  8904     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8905        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8906
  8907     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8908        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8909     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8910
  8911     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8912     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8913     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8914     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8915     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8916     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8917
  8918     IF PB-COMPANY-ID = 'NCL'  AND
  8919        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8920         NEXT SENTENCE
  8921     ELSE
  8922         IF SUB5 NOT GREATER THAN +20
  8923            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8924               MOVE WS-SAVE-BENEFIT-REM-TERM
  8925                                      TO WS-AM-LF-BENE-REM-TERM
  8926                                         EC-BR-LF-REM-TERM-CALC.
  8927
  8928     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8929     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8930
  8931     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8932
  8933 0305-BENEFIT-NOT-FOUND.
  8934
  8935     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8936     MOVE ER-2604                TO WS-ERROR.
  8937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8938
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 163
* EL050.cbl
  8940
  8941 0310-FIND-AH-BENEFIT-RECORD.
  8942
  8943     MOVE 'N'                    TO PLAN-MASTER-SW
  8944                                    PLAN-MASTER-AH-SW.
  8945
  8946     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8947                                    WS-PL-TOL-AH-REFUND
  8948                                    WS-AH-PL-REF-OVS-AMT
  8949                                    WS-PL-TOL-AH-PREM-PCT
  8950                                    WS-PL-TOL-AH-REFUND-PCT
  8951                                    WS-AH-PL-REF-OVS-PCT
  8952                                    WS-PL-TOL-AH-CLAIM.
  8953     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8954
  8955
  8956     if pb-issue
  8957        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8958           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8959        end-if
  8960        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8961           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8962           GO TO 0399-BENEFIT-NOT-FOUND
  8963        end-if
  8964     end-if
  8965
  8966     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8967        GO TO 0400-FIND-CARRIER.
  8968
  8969     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8970
  8971     IF WK-AH-BEN-ADDR NOT = ZEROS
  8972         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8973         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8974         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8975         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8976           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8977             GO TO 0311-AH-BENEFIT-SEARCH
  8978         ELSE
  8979             NEXT SENTENCE
  8980     ELSE
  8981         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8982
  8983     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8984     MOVE '5'                    TO CNTL-REC-TYPE.
  8985     MOVE +0                     TO CNTL-SEQ-NO.
  8986     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8987
  8988     MOVE '2' TO RC-SW-2.
  8989     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8990
  8991     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8992        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8993          GO TO 0399-BENEFIT-NOT-FOUND.
  8994
  8995     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8996
  8997 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 164
* EL050.cbl
  8998
  8999     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9000
  9001     IF NO-BENEFIT-FOUND
  9002         GO TO 0399-BENEFIT-NOT-FOUND.
  9003
  9004     IF WS-BEN-CD = '99'
  9005        GO TO 0399-BENEFIT-NOT-FOUND.
  9006
  9007     IF PB-COMPANY-ID  =  'NCL'
  9008         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9009             GO TO 0314-A-H-BENEFIT-FOUND.
  9010
  9011     MOVE +1                     TO SUB5.
  9012     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9013
  9014* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9015* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9016     IF PB-COMPANY-ID = 'DMD'
  9017         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9018
  9019 0312-EDIT-ACCT-AH-BENEFITS.
  9020
  9021     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9022        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9023           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9024                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9025           GO TO 03XX-GET-AH-ERPLAN.
  9026
  9027     IF SUB5 LESS THAN +20
  9028        ADD +1                   TO SUB5
  9029        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9030
  9031     MOVE +1                     TO SUB5.
  9032
  9033     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9034        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9035
  9036 0313-EDIT-DMD-EXTRA-BENEFITS.
  9037
  9038     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9039        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9040           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9041                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9042           GO TO 03XX-GET-AH-ERPLAN.
  9043
  9044     IF SUB5 LESS THAN +30
  9045        ADD +1                   TO SUB5
  9046        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9047
  9048     MOVE +1                     TO SUB5.
  9049
  9050 03XX-EDIT-FOR-NINETY-AH.
  9051
  9052***************************************************************
  9053*                                                             *
  9054*    NINETY BENEFIT PLAN TYPES:                               *
  9055*                                                             *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 165
* EL050.cbl
  9056*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9057*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9058*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9059*           BENEFIT CONTROLS.                                 *
  9060*      99 = ALL BENEFITS.                                     *
  9061*                                                             *
  9062***************************************************************
  9063
  9064     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9065                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9066
  9067     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9068       AND
  9069        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9070        GO TO 03XX-GET-AH-ERPLAN.
  9071
  9072     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9073       AND
  9074        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9075           IF (PB-I-INDV-GRP-OVRD = 'I')
  9076              OR
  9077           ((AM-IG = '1') AND
  9078           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9079              OR
  9080           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9081           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9082           (AM-IG NOT = '2'))
  9083              GO TO 03XX-GET-AH-ERPLAN.
  9084
  9085     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9086       AND
  9087        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9088           IF (PB-I-INDV-GRP-OVRD = 'G')
  9089              OR
  9090           ((AM-IG = '2') AND
  9091           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9092              OR
  9093           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9094           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9095           (AM-IG NOT = '1'))
  9096              GO TO 03XX-GET-AH-ERPLAN.
  9097
  9098     IF SUB5 LESS THAN +20
  9099        ADD +1                   TO SUB5
  9100        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9101
  9102     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9103        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9104
  9105     MOVE +1                    TO SUB5.
  9106
  9107 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9108
  9109     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9110                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9111
  9112     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9113       AND
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 166
* EL050.cbl
  9114        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9115        GO TO 03XX-GET-AH-ERPLAN.
  9116
  9117     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9118       AND
  9119        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9120           IF (PB-I-INDV-GRP-OVRD = 'I')
  9121              OR
  9122           ((AM-IG = '1') AND
  9123           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9124              OR
  9125           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9126           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9127           (AM-IG NOT = '2'))
  9128              GO TO 03XX-GET-AH-ERPLAN.
  9129
  9130     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9131       AND
  9132        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9133           IF (PB-I-INDV-GRP-OVRD = 'G')
  9134              OR
  9135           ((AM-IG = '2') AND
  9136           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9137              OR
  9138           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9139           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9140           (AM-IG NOT = '1'))
  9141              GO TO 03XX-GET-AH-ERPLAN.
  9142
  9143     IF SUB5 LESS THAN +30
  9144        ADD +1                   TO SUB5
  9145        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9146
  9147 03XX-EDIT-FOR-NINETY-AH-CONT.
  9148
  9149     MOVE +99                    TO SUB5.
  9150
  9151     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9152
  9153     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9154        IF PB-ISSUE
  9155           MOVE ER-1925          TO  WS-ERROR
  9156           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9157
  9158     GO TO 0314-A-H-BENEFIT-FOUND.
  9159
  9160 03XX-GET-AH-ERPLAN.
  9161
  9162     IF WK-PLAN-ADDR EQUAL +0
  9163         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9164
  9165     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9166     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9167     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9168     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9169     MOVE 'Y'                    TO PLAN-MASTER-SW
  9170                                    PLAN-MASTER-AH-SW.
  9171*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 167
* EL050.cbl
  9172     GO TO 03XX-ERPLAN-AH-READ.
  9173
  9174 03XX-ERPLAN-AH-GETMAIN.
  9175
  9176     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9177     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9178
  9179 03XX-ERPLAN-AH-READ.
  9180
  9181     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9182     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9183     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9184     MOVE PB-SV-STATE            TO PLAN-STATE.
  9185     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9186     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9187     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9188     MOVE WS-SAVE-BENEFIT-REVISION
  9189                                 TO PLAN-REVISION-NO.
  9190
  9191     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9192     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9193
  9194     IF PB-COMPANY-ID = 'NCL'
  9195       IF NOT AH-PLAN-MASTER-FOUND
  9196         IF NOT PB-POLICY-IS-DECLINED  AND
  9197            NOT PB-POLICY-IS-VOIDED
  9198             MOVE  ER-1922         TO  WS-ERROR
  9199             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9200             GO TO 0314-A-H-BENEFIT-FOUND.
  9201
  9202     IF NOT AH-PLAN-MASTER-FOUND
  9203        GO TO 0314-A-H-BENEFIT-FOUND.
  9204
  9205 XXXX-CHECK-AH-PLAN-KEY.
  9206
  9207     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9208        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9209        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9210        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9211        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9212        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9213        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9214        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9215        MOVE 'N'                 TO PLAN-MASTER-SW
  9216          GO TO 03XX-ERPLAN-AH-READ.
  9217
  9218     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9219
  9220     IF  PB-CANCELLATION
  9221         GO TO  0313-AH-ACCT-BEN-FOUND.
  9222
  9223     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9224       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9225          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9226          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9227             MOVE ER-2644             TO WS-ERROR
  9228             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9229          ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 168
* EL050.cbl
  9230             NEXT SENTENCE
  9231       ELSE
  9232          IF PB-COMPANY-ID NOT = 'NCL'
  9233             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9234                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9235
  9236 0313-AH-ACCT-BEN-FOUND.
  9237
  9238     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9239
  9240     IF PL-DEV-CODE NOT = SPACES
  9241        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9242
  9243     IF PL-DEV-PCT NUMERIC AND
  9244        PL-DEV-PCT NOT = ZEROS
  9245        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9246
  9247     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9248        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9249
  9250     IF PL-TOL-REF-AMT NOT EQUAL +0
  9251        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9252
  9253     IF PL-TOL-PREM-PCT GREATER THAN +0
  9254        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9255
  9256     IF PL-TOL-REF-PCT GREATER THAN +0
  9257        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9258
  9259     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9260        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9261
  9262     IF PL-OVER-SHORT-AMT NUMERIC AND
  9263                          PL-OVER-SHORT-AMT > +0
  9264        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9265
  9266     IF PL-OVER-SHORT-PCT NUMERIC AND
  9267                          PL-OVER-SHORT-PCT > +0
  9268        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9269
  9270     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9271        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9272        IF WS-IG-OVRD-AM EQUAL SPACES
  9273            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9274
  9275 0314-A-H-BENEFIT-FOUND.
  9276
  9277     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9278
  9279     IF PB-ISSUE
  9280        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9281       ELSE
  9282        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9283
  9284     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9285     if cf-maximum-benefits (sub3) numeric
  9286        move cf-maximum-benefits (sub3)
  9287                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 169
* EL050.cbl
  9288     else
  9289        move zeros               to ws-ah-max-bens
  9290     end-if
  9291     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9292     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9293     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9294                                         WS-AH-REFUND-CALC.
  9295
  9296     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9297        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9298
  9299     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9300        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9301     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9302
  9303     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9304     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9305     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9306     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9307     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9308     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9309
  9310     IF PB-COMPANY-ID = 'NCL'  AND
  9311        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9312         NEXT SENTENCE
  9313     ELSE
  9314         IF SUB5 NOT GREATER THAN +20
  9315            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9316                MOVE WS-SAVE-BENEFIT-REM-TERM
  9317                                      TO WS-AM-AH-BENE-REM-TERM
  9318                                         EC-BR-AH-REM-TERM-CALC.
  9319
  9320     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9321     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9322
  9323     GO TO 0400-FIND-CARRIER.
  9324
  9325 0399-BENEFIT-NOT-FOUND.
  9326
  9327     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9328     MOVE ER-2605                TO WS-ERROR.
  9329     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9330
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 170
* EL050.cbl
  9332
  9333 0400-FIND-CARRIER.
  9334
  9335     MOVE PB-SV-CARRIER          TO WS-CARR.
  9336
  9337     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9338     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9339     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9340     MOVE '6'                    TO CNTL-REC-TYPE.
  9341
  9342*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9343     MOVE SPACE                  TO WS-DMD-RATING-SW
  9344                                    EC-BR-DMD-RATING-SW.
  9345
  9346     MOVE '2'                    TO RC-SW-1.
  9347     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9348
  9349     IF NOT CF-CARRIER-MASTER
  9350        GO TO 0400-CARRIER-NOT-FOUND.
  9351
  9352 0400-BUILD-CARR-TOL.
  9353
  9354     IF CF-CR-TOL-PREM NUMERIC AND
  9355        CF-CR-TOL-PREM GREATER THAN +0
  9356        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9357                                    WS-TOL-AH-PREM.
  9358
  9359     IF CF-CR-TOL-REFUND NUMERIC AND
  9360        CF-CR-TOL-REFUND GREATER THAN +0
  9361        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9362                                    WS-TOL-AH-REFUND.
  9363
  9364     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9365        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9366        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9367                                    WS-AH-REFUND-OVS-AMT.
  9368
  9369     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9370        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9371        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9372                                    WS-AH-REFUND-OVS-PCT.
  9373
  9374     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9375        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9376        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9377                                    WS-TOL-AH-PREM-PCT.
  9378
  9379     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9380        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9381        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9382                                     WS-TOL-AH-REFUND-PCT.
  9383
  9384     IF CF-COMPANY-ID EQUAL 'DMD'
  9385         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9386                                    EC-BR-DMD-RATING-SW.
  9387
  9388     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9389     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 171
* EL050.cbl
  9390        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9391     END-IF
  9392     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9393        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9394     END-IF
  9395     IF WS-TOL-CLP-PCT = ZEROS
  9396        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9397     END-IF
  9398
  9399     IF WS-SPP-LEASE-COMM = ZEROS
  9400        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9401     END-IF
  9402     GO TO 0400-FIND-ERPDEF.
  9403
  9404 0400-CARRIER-NOT-FOUND.
  9405
  9406     MOVE ER-2602                TO WS-ERROR.
  9407     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9408
  9409 0400-FIND-ERPDEF.
  9410     IF PB-COMPANY-ID = 'DCC'
  9411        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9412        CONTINUE
  9413     ELSE
  9414        GO TO 0400-FIND-ERCOMP
  9415     END-IF
  9416     MOVE ' '                    TO PDEF-MASTER-SW
  9417     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9418     MOVE PB-STATE               TO ERPDEF-STATE
  9419     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9420     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9421     IF PB-ISSUE
  9422        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9423     ELSE
  9424        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9425     END-IF
  9426     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9427     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9428     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9429     IF PDEF-MASTER-FOUND
  9430        MOVE 'N'                 TO PDEF-MASTER-SW
  9431        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9432        IF PDEF-MASTER-FOUND
  9433           IF (ERPDEF-KEY-SAVE (1:16) =
  9434                        PD-CONTROL-PRIMARY (1:16))
  9435              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9436              CONTINUE
  9437           ELSE
  9438              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9439              IF (ERPDEF-KEY-SAVE (1:16) =
  9440                        PD-CONTROL-PRIMARY (1:16))
  9441                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9442                 CONTINUE
  9443              ELSE
  9444                 MOVE 'N'        TO PDEF-MASTER-SW
  9445              END-IF
  9446           END-IF
  9447        END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 172
* EL050.cbl
  9448        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9449     END-IF
  9450     IF PDEF-MASTER-FOUND
  9451        IF PD-TRUNCATED = 'Y'
  9452           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9453        END-IF
  9454     END-IF
  9455     .
  9456 0400-FIND-ERCOMP.
  9457     IF PB-COMPANY-ID = 'DCC'
  9458        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9459           (WS-SUB1 > +10)
  9460           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9461                 OR 'A' OR 'N'
  9462              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9463              MOVE PB-CARRIER    TO COMP-CARRIER
  9464              MOVE PB-GROUPING   TO COMP-GROUPING
  9465              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9466              MOVE AM-AGT (WS-SUB1)
  9467                                 TO COMP-FIN-RESP
  9468              MOVE 'G'           TO COMP-TYPE
  9469              PERFORM 8582-READ-COMPENSATION-MASTER
  9470                                 THRU 8582-EXIT
  9471              IF COMP-MASTER-FOUND
  9472                 IF CO-GA-INACTIVE
  9473                    MOVE ER-2763 TO WS-ERROR
  9474                    PERFORM 9900-ERROR-FORMAT
  9475                                 THRU 9900-EXIT
  9476                    MOVE +11     TO WS-SUB1
  9477                 END-IF
  9478                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9479                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9480                    MOVE ER-2788 TO WS-ERROR
  9481                    PERFORM 9900-ERROR-FORMAT
  9482                                 THRU 9900-EXIT
  9483                    MOVE +11     TO WS-SUB1
  9484                 END-IF
  9485              END-IF
  9486           END-IF
  9487        END-PERFORM
  9488     END-IF
  9489     IF PB-COMPANY-ID = 'DCC'
  9490        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9491           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9492                                    WS-CLP-STATE
  9493        ELSE
  9494           MOVE SPACES           TO PB-I-CLP-STATE
  9495                                    WS-CLP-STATE
  9496        END-IF
  9497     END-IF
  9498
  9499     IF (PB-COMPANY-ID = 'DCC')
  9500        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9501        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9502        CONTINUE
  9503     ELSE
  9504        GO TO 0400-FIND-STATE-RECORD
  9505     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 173
* EL050.cbl
  9506     MOVE SPACES                 TO WS-CLP-STATE
  9507     MOVE +0                     TO WS-BANK-FEE
  9508                                    WS-BANK-LFEE
  9509                                    WS-BANK-NOCHRGB
  9510
  9511     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9512     IF (PB-ISSUE)
  9513        AND (PB-I-BANK-NUMBER NOT =
  9514            SPACES AND ZEROS AND LOW-VALUES)
  9515        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9516     ELSE
  9517        IF (PB-CANCELLATION)
  9518           AND (PB-CI-BANK-NUMBER NOT =
  9519                SPACES AND ZEROS AND LOW-VALUES)
  9520           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9521        END-IF
  9522     END-IF
  9523     IF COMP-FIN-RESP NOT = LOW-VALUES
  9524        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9525        MOVE PB-CARRIER          TO COMP-CARRIER
  9526        MOVE PB-GROUPING         TO COMP-GROUPING
  9527        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9528        MOVE 'B'                 TO COMP-TYPE
  9529        PERFORM 8582-READ-COMPENSATION-MASTER
  9530                                 THRU 8582-EXIT
  9531        IF COMP-MASTER-FOUND
  9532           IF CO-MAX-BANK-FEE NOT NUMERIC
  9533              MOVE +0            TO CO-MAX-BANK-FEE
  9534           END-IF
  9535           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9536              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9537           END-IF
  9538           IF CO-GA-INACTIVE
  9539              MOVE ER-2763       TO WS-ERROR
  9540              PERFORM 9900-ERROR-FORMAT
  9541                                 THRU 9900-EXIT
  9542           END-IF
  9543           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9544              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9545              MOVE ER-2788 TO WS-ERROR
  9546              PERFORM 9900-ERROR-FORMAT
  9547                                 THRU 9900-EXIT
  9548              MOVE +11     TO WS-SUB1
  9549           END-IF
  9550           IF WS-AH-BEN-CATEGORY = 'G'
  9551              MOVE CO-MAX-BANK-FEE
  9552                                 TO WS-BANK-FEE
  9553                                    PB-I-BANK-FEE
  9554           ELSE
  9555              MOVE CO-MAX-BANK-FEE-LEASE
  9556                                 TO WS-BANK-LFEE
  9557                                    PB-I-BANK-FEE
  9558           END-IF
  9559           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9560              AND (WS-AH-REFUND-CALC = 'G'))
  9561                        OR
  9562              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9563              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 174
* EL050.cbl
  9564              CONTINUE
  9565           ELSE
  9566              MOVE ER-2789 TO WS-ERROR
  9567              PERFORM 9900-ERROR-FORMAT
  9568                                 THRU 9900-EXIT
  9569           END-IF
  9570           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9571                                    PB-I-CLP-STATE
  9572           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9573           MOVE CO-CARRIER       TO BXRF-CARRIER
  9574           MOVE CO-GROUPING      TO BXRF-GROUPING
  9575           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9576           MOVE BXRF-MAX-REC-LENGTH
  9577                                 TO BXRF-REC-LENGTH
  9578           PERFORM 8584-READ-BANK-CROSS-REF
  9579                                 THRU 8584-EXIT
  9580           IF BXRF-MASTER-FOUND
  9581              MOVE ' '           TO BANK-ACCT-SW
  9582              MOVE BK-BANK-POINTER-CNT
  9583                                 TO BK-BANK-POINTER-CNT
  9584              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9585                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9586                 OR (BANK-ACCT-FOUND)
  9587                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9588                    AND (BK-AM-EXP-DT (WS-SUB1)
  9589                                 > PB-CERT-EFF-DT)
  9590                    AND (BK-AM-EFF-DT (WS-SUB1)
  9591                                 NOT > PB-CERT-EFF-DT)
  9592                    SET BANK-ACCT-FOUND TO TRUE
  9593                 END-IF
  9594              END-PERFORM
  9595              IF NOT BANK-ACCT-FOUND
  9596                 MOVE ZEROS      TO WS-BANK-FEE
  9597                                    WS-BANK-LFEE
  9598                 MOVE ER-2869    TO WS-ERROR
  9599                 PERFORM 9900-ERROR-FORMAT
  9600                                 THRU 9900-EXIT
  9601              ELSE
  9602                 PERFORM 5000-PROCESS-REPS
  9603                                 THRU 5000-EXIT
  9604                 IF AGENT-MASTER-FOUND
  9605                    MOVE +0      TO WS-BANK-FEE
  9606                                    WS-BANK-LFEE
  9607*                   MOVE AG-SPP-FEES (1)
  9608*                                TO PB-I-BANK-FEE
  9609*                                   WS-BANK-FEE
  9610                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9611                       (WS-SUB1 > +10)
  9612                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9613                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9614                       END-IF
  9615                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9616                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9617                       END-IF
  9618                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9619                          AG-SPP-FEES (WS-SUB1)
  9620                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9621                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 175
* EL050.cbl
  9622                    END-PERFORM
  9623                    IF WS-AH-BEN-CATEGORY = 'G'
  9624                       MOVE WS-BANK-FEE
  9625                                 TO PB-I-BANK-FEE
  9626                    ELSE
  9627                       MOVE WS-BANK-LFEE
  9628                                 TO PB-I-BANK-FEE
  9629                    END-IF
  9630                 END-IF
  9631              END-IF
  9632           END-IF
  9633        ELSE
  9634           MOVE ER-2879          TO WS-ERROR
  9635           PERFORM 9900-ERROR-FORMAT
  9636                                 THRU 9900-EXIT
  9637        END-IF
  9638     ELSE
  9639        MOVE ER-2879             TO WS-ERROR
  9640        PERFORM 9900-ERROR-FORMAT
  9641                                 THRU 9900-EXIT
  9642     END-IF
  9643     IF WS-AH-BEN-CATEGORY = 'G'
  9644        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9645        + WS-BANK-FEE
  9646     ELSE
  9647        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9648        + WS-BANK-LFEE
  9649     END-IF
  9650     .
  9651 0400-FIND-STATE-RECORD.
  9652
  9653     IF WK-STATE-ADDR NOT = ZEROS
  9654         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9655         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9656         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9657         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9658         IF PB-SV-STATE = CF-STATE-CODE
  9659             GO TO 0405-CONTINUE-EDIT
  9660         ELSE
  9661             NEXT SENTENCE
  9662     ELSE
  9663         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9664
  9665     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9666     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9667     MOVE '3'                    TO CNTL-REC-TYPE.
  9668     MOVE +0                     TO CNTL-SEQ-NO.
  9669
  9670     MOVE '3'                    TO RC-SW-2.
  9671     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9672
  9673     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9674        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9675        PB-SV-STATE   NOT = CF-STATE-CODE)
  9676        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9677                                    WS-TOL-AH-CLAIM
  9678                                    WS-MINIMUM-REFUND
  9679                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 176
* EL050.cbl
  9680                                    WS-TOL-AH-PREM
  9681                                    WS-TOL-LF-REFUND
  9682                                    WS-TOL-AH-REFUND
  9683                                    EC-ST-TOL-PREM-PCT
  9684                                    WS-TOL-LF-PREM-PCT
  9685                                    WS-TOL-AH-PREM-PCT
  9686                                    EC-ST-TOL-REFUND-PCT
  9687                                    WS-TOL-LF-REFUND-PCT
  9688                                    WS-TOL-AH-REFUND-PCT
  9689                                    EC-ST-TOL-PREM
  9690                                    EC-ST-TOL-REFUND
  9691                                    EC-ST-FST-PMT-DAYS-MAX
  9692                                    WS-FREE-LOOK-PERIOD
  9693                                    WS-ST-LF-PREM-TAX
  9694                                    WS-ST-AH-PREM-TAX-I
  9695                                    WS-ST-AH-PREM-TAX-G
  9696                                    WS-BANK-FEE
  9697                                    WS-BANK-LFEE
  9698                                    WS-TOL-CLP-PCT
  9699                                    WS-SPP-LEASE-COMM
  9700        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9701                                    EC-ST-FST-PMT-DAYS-CHG
  9702                                    WS-LF-REM-TERM-CALC
  9703                                    WS-LF-REFUND-CALC
  9704                                    EC-ST-LF-REM-TERM-CALC
  9705                                    EC-ST-LF-REFUND-CALC
  9706                                    WS-AH-REM-TERM-CALC
  9707                                    WS-AH-REFUND-CALC
  9708                                    WS-LF-BEN-CATEGORY
  9709                                    WS-AH-BEN-CATEGORY
  9710                                    WS-CLP-STATE
  9711                                    WS-ST-REFUND-CLAIM-FLAG
  9712                                    WS-ST-CAUSAL-STATE
  9713                                    EC-ST-AH-REM-TERM-CALC
  9714                                    EC-ST-AH-REFUND-CALC
  9715          GO TO 0499-STATE-NOT-FOUND.
  9716
  9717     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9718
  9719 0405-CONTINUE-EDIT.
  9720
  9721     if pb-company-id = 'AHL'
  9722        continue
  9723     else
  9724        IF PB-CERT-PRIME NOT NUMERIC
  9725           MOVE ER-2722          TO WS-ERROR
  9726           PERFORM 9900-ERROR-FORMAT
  9727                                 THRU 9900-EXIT
  9728        end-if
  9729     END-IF
  9730*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9731*       MOVE +0                  TO SUB3
  9732*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9733*       IF SUB3 > +0
  9734*          MOVE ER-2722          TO WS-ERROR
  9735*          PERFORM 9900-ERROR-FORMAT
  9736*                                THRU 9900-EXIT
  9737*       END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 177
* EL050.cbl
  9738*    END-IF
  9739*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9740*       IF PB-CERT-PRIME NOT NUMERIC
  9741*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9742*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9743*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9744*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9745*
  9746*          MOVE ER-2722          TO WS-ERROR
  9747*          PERFORM 9900-ERROR-FORMAT
  9748*                                THRU 9900-EXIT
  9749*       END-IF
  9750*    END-IF
  9751
  9752     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9753
  9754     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9755        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9756                                    WS-TOL-AH-CLAIM.
  9757
  9758     IF CF-ST-REFUND-MIN NOT NUMERIC
  9759        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9760
  9761     IF CF-ST-REFUND-MIN NOT = ZEROS
  9762        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9763
  9764     IF CF-ST-TOL-PREM  NOT = ZEROS
  9765        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9766                                    WS-TOL-AH-PREM
  9767        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9768
  9769     IF CF-ST-TOL-REFUND NOT = ZEROS
  9770        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9771                                    WS-TOL-AH-REFUND
  9772        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9773
  9774     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9775        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9776        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9777                                    WS-AH-REFUND-OVS-AMT
  9778                                    EC-ST-OVR-SHT-AMT.
  9779
  9780     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9781        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9782        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9783                                    WS-TOL-LF-PREM-PCT
  9784                                    WS-TOL-AH-PREM-PCT.
  9785
  9786     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9787        CF-ST-TOL-REF-PCT GREATER THAN +0
  9788        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9789                                    WS-TOL-LF-REFUND-PCT
  9790                                    WS-TOL-AH-REFUND-PCT.
  9791
  9792     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9793        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9794        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9795                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 178
* EL050.cbl
  9796                                    EC-ST-OVR-SHT-PCT.
  9797
  9798     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9799     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9800
  9801     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9802          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9803
  9804     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9805     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9806     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9807
  9808     IF CF-ST-LF-PREM-TAX NUMERIC
  9809        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9810     END-IF
  9811     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9812        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9813     END-IF
  9814     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9815        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9816     END-IF
  9817
  9818     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9819         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9820     END-IF.
  9821
  9822     IF CF-ST-CAUSAL-STATE > SPACES
  9823         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9824     END-IF.
  9825
  9826     IF WS-LF-BENEFIT-CD = ZEROS
  9827        GO TO 0410-CHECK-AH.
  9828
  9829     IF CF-ST-RT-CALC NOT = SPACES
  9830        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9831                                    EC-ST-LF-REM-TERM-CALC
  9832     END-IF
  9833
  9834     IF WS-LF-COVERAGE-TYPE = 'R'
  9835        IF WS-LF-EARNINGS-CALC = '5'
  9836           IF CF-ST-RF-LN-CALC > '0'
  9837              MOVE CF-ST-RF-LN-CALC
  9838                                 TO WS-LF-REFUND-CALC
  9839                                    EC-ST-LF-REFUND-CALC
  9840           END-IF
  9841        ELSE
  9842           IF CF-ST-RF-LR-CALC > '0'
  9843              MOVE CF-ST-RF-LR-CALC
  9844                                 TO WS-LF-REFUND-CALC
  9845                                    EC-ST-LF-REFUND-CALC
  9846           END-IF
  9847        END-IF
  9848     ELSE
  9849        IF CF-ST-RF-LL-CALC > '0'
  9850           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9851                                    EC-ST-LF-REFUND-CALC
  9852        END-IF
  9853     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 179
* EL050.cbl
  9854
  9855     IF CF-ST-RT-CALC NOT = SPACES
  9856        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9857                                    EC-ST-LF-REM-TERM-CALC
  9858     END-IF
  9859
  9860     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9861     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9862
  9863     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9864
  9865     IF NO-BENEFIT-FOUND
  9866        GO TO 0410-CHECK-AH.
  9867
  9868     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9869        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9870                                 TO EC-ST-LF-REM-TERM-CALC
  9871                                    WS-LF-REM-TERM-CALC
  9872     END-IF
  9873
  9874     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9875        MOVE CF-ST-REFUND-CALC (SUB3)
  9876                                 TO WS-LF-REFUND-CALC
  9877                                    EC-ST-LF-REFUND-CALC
  9878     END-IF
  9879*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9880
  9881     .
  9882 0410-CHECK-AH.
  9883
  9884     IF WS-AH-BENEFIT-CD = ZEROS
  9885        GO TO 0500-SET-ACCOUNT.
  9886
  9887     IF CF-ST-RT-CALC NOT = SPACES
  9888        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9889                                    EC-ST-AH-REM-TERM-CALC
  9890     END-IF
  9891
  9892     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9893        IF CF-ST-RF-CP-CALC > '0'
  9894           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9895                                    EC-ST-AH-REFUND-CALC
  9896        END-IF
  9897     ELSE
  9898        IF CF-ST-RF-AH-CALC > '0'
  9899           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9900                                    EC-ST-AH-REFUND-CALC
  9901        END-IF
  9902     END-IF
  9903     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9904     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9905
  9906     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9907
  9908     IF NO-BENEFIT-FOUND
  9909        GO TO 0500-SET-ACCOUNT.
  9910
  9911     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 180
* EL050.cbl
  9912        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9913                                 TO WS-AH-REM-TERM-CALC
  9914                                    EC-ST-AH-REM-TERM-CALC
  9915     END-IF
  9916
  9917     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9918        MOVE CF-ST-REFUND-CALC (SUB3)
  9919                                 TO WS-AH-REFUND-CALC
  9920                                    EC-ST-AH-REFUND-CALC
  9921     END-IF
  9922
  9923*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9924
  9925     GO TO 0500-SET-ACCOUNT.
  9926
  9927 0499-STATE-NOT-FOUND.
  9928
  9929     MOVE ER-2603                TO WS-ERROR.
  9930     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9931
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 181
* EL050.cbl
  9933
  9934 0500-SET-ACCOUNT.
  9935*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9936     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9937        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9938        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9939        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9940        MOVE '3'                 TO CNTL-REC-TYPE
  9941        MOVE +0                  TO CNTL-SEQ-NO
  9942
  9943        MOVE '3'                 TO RC-SW-2
  9944        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9945
  9946        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9947           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9948           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9949           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9950                                    WS-ST-AH-PREM-TAX-I
  9951                                    WS-ST-AH-PREM-TAX-G
  9952        ELSE
  9953           IF CF-ST-LF-PREM-TAX NUMERIC
  9954              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9955           END-IF
  9956           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9957              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9958           END-IF
  9959           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9960              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9961           END-IF
  9962        END-IF
  9963        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9964     END-IF
  9965*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9966*  FOR DCC ONLY
  9967     IF PB-COMPANY-ID = 'DCC'
  9968
  9969     MOVE ' '                    TO STAT-MASTER-SW
  9970     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9971     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9972     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9973     MOVE PB-STATE               TO ELSTAT-STATE
  9974     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9975        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9976     END-IF
  9977
  9978     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9979     SET BIN-TO-GREG             TO TRUE
  9980     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9981     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9982     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9983
  9984     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9985     IF STAT-MASTER-FOUND
  9986        MOVE 'N'                 TO STAT-MASTER-SW
  9987        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9988        IF STAT-MASTER-FOUND
  9989           IF (ELSTAT-KEY-SAVE (1:12) =
  9990                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 182
* EL050.cbl
  9991              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9992                 MOVE 'F'        TO STAT-MASTER-SW
  9993              ELSE
  9994                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9995                 IF (STAT-MASTER-FOUND)
  9996                    AND (ELSTAT-KEY-SAVE (1:12) =
  9997                        SF-CONTROL-PRIMARY (1:12))
  9998                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9999                    MOVE 'F'     TO STAT-MASTER-SW
 10000                 END-IF
 10001              END-IF
 10002           END-IF
 10003        END-IF
 10004     END-IF
 10005
 10006     IF STAT-MASTER-SW = 'F'
 10007        IF SF-ST-LF-PREM-TAX NUMERIC
 10008           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10009        END-IF
 10010        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10011           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10012        END-IF
 10013        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10014           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10015        END-IF
 10016     END-IF
 10017
 10018     END-IF
 10019     IF (PB-COMPANY-ID = 'DCC')
 10020        AND (PB-ISSUE)
 10021        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10022        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10023        AND (AM-GPCD = 06)
 10024        MOVE 'Y'                 TO WS-GOOD-HIN
 10025        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10026           MOVE PB-I-VIN         TO WS-WORK-VIN
 10027           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10028              (V1 > 16)
 10029              IF WS-WORK-VIN (V1:1) NUMERIC
 10030                 MOVE WS-WORK-VIN-N (V1)
 10031                                 TO WS-ROW-B-VAL (V1)
 10032              ELSE
 10033                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10034                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10035                    OR (V2 > 26)
 10036                 END-PERFORM
 10037                 IF V2 < 27
 10038                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10039                 ELSE
 10040                    MOVE 'N'     TO WS-GOOD-HIN
 10041                 END-IF
 10042              END-IF
 10043              COMPUTE WS-ROW-D-VAL (V1) =
 10044                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10045              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10046                 WS-ROW-D-VAL (V1)
 10047           END-PERFORM
 10048           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 183
* EL050.cbl
 10049           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10050             REMAINDER WS-VIN-REMAINDER
 10051           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10052              CONTINUE
 10053           ELSE
 10054              MOVE 'N'           TO WS-GOOD-HIN
 10055           END-IF
 10056        ELSE
 10057           MOVE 'N'              TO WS-GOOD-HIN
 10058        END-IF
 10059        IF WS-GOOD-HIN NOT = 'Y'
 10060           MOVE ER-3826           TO WS-ERROR
 10061           PERFORM 9900-ERROR-FORMAT
 10062                                 THRU 9900-EXIT
 10063        END-IF
 10064     END-IF
 10065     IF (PB-COMPANY-ID = 'DCC')
 10066        AND (PB-ISSUE)
 10067        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10068        AND (AM-GPCD NOT = 06)
 10069        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10070          MOVE PB-I-VIN          TO WS-WORK-VIN
 10071          MOVE +8                TO V2
 10072          MOVE ZEROS             TO WS-VIN-TOTAL
 10073          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10074           (V1 > 17)
 10075             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10076                MOVE ER-3825     TO WS-ERROR
 10077                PERFORM 9900-ERROR-FORMAT
 10078                                 THRU 9900-EXIT
 10079             ELSE
 10080                IF V1 = 8
 10081                   MOVE 10       TO V2
 10082                END-IF
 10083                IF V1 = 9
 10084                   MOVE 0        TO V2
 10085                END-IF
 10086                IF V1 = 10
 10087                   MOVE 9        TO V2
 10088                END-IF
 10089                IF WS-WORK-VIN (V1:1) NUMERIC
 10090                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10091                    + (WS-WORK-VIN-N (V1) * V2)
 10092                ELSE
 10093                   MOVE WS-WORK-VIN (V1:1)
 10094                                 TO WS-HEX-BYTE
 10095                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10096                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10097                    + (WS-NUM (V3) * V2)
 10098                END-IF
 10099                COMPUTE V2 = V2 - 1
 10100             END-IF
 10101          END-PERFORM
 10102          MOVE ZEROS TO WS-VIN-REMAINDER
 10103          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10104             REMAINDER WS-VIN-REMAINDER
 10105          IF ((WS-WORK-VIN (9:1) = 'X')
 10106             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 184
* EL050.cbl
 10107                     OR
 10108             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10109             CONTINUE
 10110          ELSE
 10111             MOVE ER-3826        TO WS-ERROR
 10112             PERFORM 9900-ERROR-FORMAT
 10113                                 THRU 9900-EXIT
 10114          END-IF
 10115        ELSE
 10116          MOVE ER-3826           TO WS-ERROR
 10117          PERFORM 9900-ERROR-FORMAT
 10118                                 THRU 9900-EXIT
 10119        END-IF
 10120     END-IF
 10121******************************************************************
 10122******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10123******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10124******* METHODS.
 10125******************************************************************
 10126     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10127        IF PB-CANCELLATION
 10128           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10129              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10130                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10131                IF FORM-MASTER-FOUND
 10132                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10133******************************************************************
 10134
 10135     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10136     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10137
 10138     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10139     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10140     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10141     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10142
 10143
 10144     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10145     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10146     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10147
 10148     IF AM-LF-OB-RATE NOT NUMERIC
 10149         MOVE ZERO               TO AM-LF-OB-RATE.
 10150
 10151     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10152         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10153
 10154     IF AM-AH-OB-RATE NOT NUMERIC
 10155         MOVE ZERO               TO AM-AH-OB-RATE.
 10156
 10157     IF WS-LF-JOINT-INDICATOR = 'J'
 10158         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10159     ELSE
 10160         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10161
 10162     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10163
 10164     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 185
* EL050.cbl
 10165         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10166
 10167     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10168         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10169                                       WS-IG-OVRD
 10170     ELSE
 10171         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10172             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10173                                       WS-IG-OVRD
 10174         ELSE
 10175             MOVE AM-IG             TO WS-IG-OVRD-AH
 10176                                       WS-IG-OVRD.
 10177
 10178     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10179         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10180                                       WS-IG-OVRD
 10181     ELSE
 10182         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10183             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10184                                       WS-IG-OVRD
 10185         ELSE
 10186             MOVE AM-IG             TO WS-IG-OVRD-LF
 10187                                       WS-IG-OVRD.
 10188
 10189     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10190     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10191     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10192     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10193     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10194
 10195     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10196     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10197     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10198     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10199
 10200     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10201     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10202     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10203     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10204     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10205     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10206     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10207
 10208     IF WS-ACCT-AH-DEV-PCT > +0
 10209        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10210     ELSE
 10211        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10212
 10213     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10214        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10215     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10216        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10217
 10218        IF AM-EARN-METHOD-L = 'S'
 10219            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10220                                        WS-LF-REFUND-CALC.
 10221
 10222        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 186
* EL050.cbl
 10223            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10224                                        WS-LF-REFUND-CALC.
 10225
 10226     IF WS-LF-COVERAGE-TYPE = 'R'
 10227         IF AM-EARN-METHOD-R = 'R'
 10228            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10229                                    WS-LF-REFUND-CALC.
 10230     IF WS-LF-COVERAGE-TYPE = 'R'
 10231         IF AM-EARN-METHOD-R = 'P'
 10232            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10233                                    WS-LF-REFUND-CALC.
 10234     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10235         IF AM-EARN-METHOD-L = 'R'
 10236            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10237                                    WS-LF-REFUND-CALC.
 10238     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10239         IF AM-EARN-METHOD-L = 'P'
 10240            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10241                                    WS-LF-REFUND-CALC.
 10242     IF WS-LF-COVERAGE-TYPE = 'R'
 10243         IF AM-EARN-METHOD-R = 'A'
 10244            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10245                                    WS-LF-REFUND-CALC.
 10246     IF WS-LF-COVERAGE-TYPE = 'R'
 10247         IF AM-EARN-METHOD-R = 'M'
 10248            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10249                                    WS-LF-REFUND-CALC.
 10250     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10251         IF AM-EARN-METHOD-L = 'A'
 10252            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10253                                    WS-LF-REFUND-CALC.
 10254     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10255         IF AM-EARN-METHOD-L = 'M'
 10256            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10257                                    WS-LF-REFUND-CALC.
 10258
 10259     IF AM-EARN-METHOD-A = 'R'
 10260        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10261                                    WS-AH-REFUND-CALC.
 10262     IF AM-EARN-METHOD-A = 'P'
 10263        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10264                                    WS-AH-REFUND-CALC.
 10265     IF AM-EARN-METHOD-A = 'C'
 10266        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10267                                    WS-AH-REFUND-CALC.
 10268     IF AM-EARN-METHOD-A = 'A'
 10269        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10270                                    WS-AH-REFUND-CALC.
 10271     IF AM-EARN-METHOD-A = 'M'
 10272        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10273                                    WS-AH-REFUND-CALC.
 10274     IF AM-EARN-METHOD-A = 'N'
 10275        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10276                                    WS-AH-REFUND-CALC.
 10277     IF AM-EARN-METHOD-A = 'S'
 10278        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10279                                    WS-AH-REFUND-CALC.
 10280
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 187
* EL050.cbl
 10281     IF AM-TOL-PREM NOT = ZEROS
 10282        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10283                                    WS-TOL-AH-PREM.
 10284
 10285     IF AM-OVR-SHT-AMT NUMERIC AND
 10286                  AM-OVR-SHT-AMT > 0
 10287        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10288                                    EC-AM-LF-OVR-SHT-AMT
 10289                                    WS-AH-REFUND-OVS-AMT
 10290                                    EC-AM-AH-OVR-SHT-AMT.
 10291
 10292     IF AM-OVR-SHT-PCT NUMERIC AND
 10293                    AM-OVR-SHT-PCT > 0
 10294        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10295                                    EC-AM-LF-OVR-SHT-PCT
 10296                                    WS-AH-REFUND-OVS-PCT
 10297                                    EC-AM-AH-OVR-SHT-PCT.
 10298
 10299     IF AM-TOL-REF-PCT NUMERIC AND
 10300                  AM-TOL-REF-PCT > 0
 10301        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10302                                    WS-TOL-AH-REFUND-PCT.
 10303
 10304     IF AM-TOL-REF  NOT = ZEROS  AND
 10305                  AM-TOL-REF NUMERIC
 10306        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10307                                    EC-AM-LF-TOL-REFUND
 10308                                    WS-TOL-AH-REFUND
 10309                                    EC-AM-AH-TOL-REFUND.
 10310
 10311     IF AM-TOL-CLM  NOT = ZEROS
 10312        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10313                                    WS-TOL-AH-CLAIM.
 10314
 10315     IF AM-CLP-TOL-PCT NOT NUMERIC
 10316        MOVE +0                  TO AM-CLP-TOL-PCT
 10317     END-IF
 10318
 10319     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10320        MOVE +0                  TO AM-SPP-LEASE-COMM
 10321     END-IF
 10322     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10323        MOVE WS-PL-TOL-LF-PREM-PCT
 10324                                 TO WS-TOL-LF-PREM-PCT.
 10325
 10326     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10327        MOVE WS-PL-TOL-AH-PREM-PCT
 10328                                 TO WS-TOL-AH-PREM-PCT.
 10329
 10330     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10331        MOVE WS-PL-TOL-LF-REFUND-PCT
 10332                                 TO WS-TOL-LF-REFUND-PCT.
 10333
 10334     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10335        MOVE WS-PL-TOL-AH-REFUND-PCT
 10336                                 TO WS-TOL-AH-REFUND-PCT.
 10337
 10338     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 188
* EL050.cbl
 10339        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10340
 10341     IF WS-PL-REF-OVS-PCT > +0
 10342        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10343
 10344     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10345        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10346     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10347        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10348     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10349        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10350     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10351        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10352     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10353        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10354     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10355        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10356
 10357     IF WS-AH-PL-REF-OVS-AMT > +0
 10358        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10359
 10360     IF WS-AH-PL-REF-OVS-PCT > +0
 10361        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10362
 10363     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10364     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10365
 10366     IF PB-CANCELLATION
 10367        GO TO 3000-CONTINUE-EDIT.
 10368
 10369     MOVE +1 TO SUB1.
 10370     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10371     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10372
 10373     IF CF-COMPANY-ID = 'DMD'
 10374       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10375         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10376        ELSE
 10377         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10378
 10379  0525-FIND-ACCT-COMM.
 10380     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10381        NEXT SENTENCE
 10382      ELSE
 10383         ADD +1 TO SUB1
 10384         IF SUB1 LESS +11
 10385            GO TO 0525-FIND-ACCT-COMM
 10386          ELSE
 10387             GO TO 0560-EDIT-CONTINUE.
 10388
 10389     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10390     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10391                                    PB-I-LIFE-COMMISSION.
 10392***  IF PB-COMPANY-ID = 'CRI'
 10393     IF PB-PREM-ACCTNG-ONLY
 10394         GO TO 0560-EDIT-CONTINUE.
 10395
 10396     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 189
* EL050.cbl
 10397     MOVE ' '    TO WS-CTBL-READ-SW.
 10398
 10399
 10400 0530-GET-AH-COMP.
 10401     IF NO-AH-COVERAGE  OR
 10402        NO-AH-BENEFIT-MATCH
 10403           GO TO 0540-NEXT-READ-STEP.
 10404
 10405     IF AM-A-COM (SUB1) NUMERIC
 10406        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10407         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10408         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10409         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10410         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10411     ELSE
 10412          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10413          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10414          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10415          MOVE ZEROS             TO WS-SUB1
 10416                                    WS-COMMISSION
 10417          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10418          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10419          IF WS-COMMISSION > ZEROS
 10420             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10421             GO TO 0540-NEXT-READ-STEP
 10422          END-IF
 10423          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10424          IF CTBL-TABLE-FOUND
 10425             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10426                                        PB-I-AH-TERM
 10427             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10428             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10429             GO TO 0540-NEXT-READ-STEP
 10430          ELSE
 10431             IF FIRST-TIME-THROUGH
 10432                 GO TO 0530-GET-AH-COMP
 10433             ELSE
 10434                 MOVE ER-2609                TO WS-ERROR
 10435                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10436
 10437 0540-NEXT-READ-STEP.
 10438     MOVE '0540' TO CTBL-SW.
 10439     MOVE ' '    TO WS-CTBL-READ-SW.
 10440
 10441 0540-GET-LF-COMP.
 10442     IF NO-LIFE-COVERAGE  OR
 10443        NO-LF-BENEFIT-MATCH
 10444           GO TO 0560-EDIT-CONTINUE.
 10445
 10446     IF WS-LF-JOINT-INDICATOR = 'J'
 10447        IF AM-J-COM (SUB1) NUMERIC
 10448           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10449           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10450           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10451           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10452           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10453        ELSE
 10454           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 190
* EL050.cbl
 10455           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10456           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10457           MOVE ZEROS                TO WS-SUB1
 10458                                        WS-COMMISSION
 10459           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10460           IF WS-COMMISSION > ZEROS
 10461              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10462              GO TO 0560-EDIT-CONTINUE
 10463           END-IF
 10464           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10465           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10466           IF CTBL-TABLE-FOUND
 10467              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10468              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10469              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10470              GO TO 0560-EDIT-CONTINUE
 10471           ELSE
 10472              IF FIRST-TIME-THROUGH
 10473                  GO TO 0540-GET-LF-COMP
 10474              ELSE
 10475                  MOVE ER-2609                TO WS-ERROR
 10476                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10477                  GO TO 0560-EDIT-CONTINUE.
 10478
 10479     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10480        IF AM-L-COM (SUB1) NUMERIC
 10481           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10482           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10483           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10484           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10485           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10486        ELSE
 10487           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10488           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10489           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10490           MOVE ZEROS                TO WS-SUB1
 10491                                        WS-COMMISSION
 10492           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10493           IF WS-COMMISSION IS GREATER THAN ZEROS
 10494              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10495              GO TO 0560-EDIT-CONTINUE
 10496           END-IF
 10497           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10498           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10499           IF CTBL-TABLE-FOUND
 10500              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10501              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10502              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10503              GO TO 0560-EDIT-CONTINUE
 10504           ELSE
 10505              IF FIRST-TIME-THROUGH
 10506                  GO TO 0540-GET-LF-COMP
 10507              ELSE
 10508                  MOVE ER-2609                TO WS-ERROR
 10509                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10510
 10511*    GO TO 0560-EDIT-CONTINUE.
 10512
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 191
* EL050.cbl
 10513 0560-EDIT-CONTINUE.
 10514     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10515                                    WS-AH-PMF-COMM
 10516*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10517*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10518     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10519        (SUB1 > +10)
 10520        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10521           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10522           MOVE '0530'           TO CTBL-SW
 10523           MOVE ' '              TO WS-CTBL-READ-SW
 10524           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10525           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10526           MOVE '0540'           TO CTBL-SW
 10527           MOVE ' '              TO WS-CTBL-READ-SW
 10528           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10529        END-IF
 10530     END-PERFORM
 10531     GO TO 0564-EDIT-CONTINUE
 10532     .
 10533 0561-CHECK-AH.
 10534     IF (NO-AH-COVERAGE)
 10535        OR (NO-AH-BENEFIT-MATCH)
 10536        CONTINUE
 10537     ELSE
 10538        IF (AM-A-COM (SUB1) NUMERIC)
 10539           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10540           IF (AM-COM-TYP (SUB1) = 'A')
 10541              AND (WS-AH-PMF-COMM = ZEROS)
 10542              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10543           END-IF
 10544           CONTINUE
 10545        ELSE
 10546           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10547           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10548           MOVE PB-AH-OVERRIDE-L1
 10549                                 TO CTBL-BEN-TYPE
 10550           MOVE ZEROS            TO WS-SUB1
 10551                                    WS-COMMISSION
 10552           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10553           PERFORM 8300-READ-CTBL-TABLE
 10554                                 THRU 8300-EXIT
 10555           IF CTBL-TABLE-FOUND
 10556              IF (AM-COM-TYP (SUB1) = 'A')
 10557                 AND (WS-AH-PMF-COMM = ZEROS)
 10558                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10559                                        PB-I-AH-TERM
 10560                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10561                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10562              END-IF
 10563              CONTINUE
 10564           ELSE
 10565              IF FIRST-TIME-THROUGH
 10566                 GO TO 0561-CHECK-AH
 10567              ELSE
 10568                 MOVE ER-2609    TO WS-ERROR
 10569                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10570              END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 192
* EL050.cbl
 10571           END-IF
 10572        END-IF
 10573     END-IF
 10574     .
 10575 0561-EXIT.
 10576     EXIT.
 10577 0563-CHECK-LF.
 10578     IF (NO-LIFE-COVERAGE)
 10579        OR (NO-LF-BENEFIT-MATCH)
 10580        CONTINUE
 10581     ELSE
 10582        IF WS-LF-JOINT-INDICATOR = 'J'
 10583           IF AM-J-COM (SUB1) NUMERIC
 10584              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10585              IF (AM-COM-TYP (SUB1) = 'A')
 10586                 AND (WS-LF-PMF-COMM = ZEROS)
 10587                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10588              END-IF
 10589              CONTINUE
 10590           ELSE
 10591              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10592              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10593              MOVE PB-LIFE-OVERRIDE-L1
 10594                                 TO CTBL-BEN-TYPE
 10595              MOVE ZEROS         TO WS-SUB1
 10596                                    WS-COMMISSION
 10597              MOVE AM-J-COMA (SUB1)
 10598                                 TO CTBL-TABLE
 10599              PERFORM 8300-READ-CTBL-TABLE
 10600                                 THRU 8300-EXIT
 10601              IF CTBL-TABLE-FOUND
 10602                 IF (AM-COM-TYP (SUB1) = 'A')
 10603                    AND (WS-LF-PMF-COMM = ZEROS)
 10604                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10605                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10606                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10607                 END-IF
 10608                 CONTINUE
 10609              ELSE
 10610                 IF FIRST-TIME-THROUGH
 10611                    GO TO 0563-CHECK-LF
 10612                 ELSE
 10613                    MOVE ER-2609 TO WS-ERROR
 10614                    PERFORM 9900-ERROR-FORMAT
 10615                                 THRU 9900-EXIT
 10616*                   GO TO 0560-EDIT-CONTINUE
 10617                 END-IF
 10618              END-IF
 10619           END-IF
 10620        ELSE
 10621           IF AM-L-COM (SUB1) NUMERIC
 10622              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10623              IF (AM-COM-TYP (SUB1) = 'A')
 10624                 AND (WS-LF-PMF-COMM = ZEROS)
 10625                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10626              END-IF
 10627              CONTINUE
 10628           ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 193
* EL050.cbl
 10629              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10630              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10631              MOVE PB-LIFE-OVERRIDE-L1
 10632                                 TO CTBL-BEN-TYPE
 10633              MOVE ZEROS         TO WS-SUB1
 10634                                    WS-COMMISSION
 10635              MOVE AM-L-COMA (SUB1)
 10636                                 TO CTBL-TABLE
 10637              PERFORM 8300-READ-CTBL-TABLE
 10638                                 THRU 8300-EXIT
 10639              IF CTBL-TABLE-FOUND
 10640                 CONTINUE
 10641              ELSE
 10642                 IF FIRST-TIME-THROUGH
 10643                    GO TO 0563-CHECK-LF
 10644                 ELSE
 10645                    MOVE ER-2609 TO WS-ERROR
 10646                    PERFORM 9900-ERROR-FORMAT
 10647                                 THRU 9900-EXIT
 10648                 END-IF
 10649              END-IF
 10650           END-IF
 10651        END-IF
 10652     END-IF
 10653     .
 10654 0563-EXIT.
 10655     EXIT.
 10656 0564-EDIT-CONTINUE.
 10657
 10658     IF  PB-COMPANY-ID EQUAL 'DMD'
 10659         IF PB-I-NUM-BILLED EQUAL ZEROS
 10660            MOVE ER-8148       TO WS-ERROR
 10661            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10662
 10663*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10664*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10665*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10666*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10667*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10668*         IF NO-CONVERSION-ERROR
 10669*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10670*         ELSE
 10671*             IF PB-COMPANY-ID EQUAL 'HAN'
 10672*                 MOVE ZEROS     TO PB-I-AGE.
 10673     IF PB-I-BIRTHDAY > LOW-VALUES
 10674        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10675        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10676        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10677        PERFORM 8500-DATE-CONVERT
 10678                                 THRU 8500-EXIT
 10679        IF NO-CONVERSION-ERROR
 10680           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10681           IF PB-I-AGE > ZEROS
 10682              IF WS-WORK-AGE NOT = PB-I-AGE
 10683                 MOVE ER-9501    TO WS-ERROR
 10684                 PERFORM 9900-ERROR-FORMAT
 10685                                 THRU 9900-EXIT
 10686              END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 194
* EL050.cbl
 10687           ELSE
 10688              MOVE WS-WORK-AGE   TO PB-I-AGE
 10689           END-IF
 10690        END-IF
 10691     END-IF
 10692     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10693                                   WS-INS-AGE-SET
 10694     IF PB-I-AGE = ZEROS
 10695        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10696           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10697                                   WS-INS-AGE-SET
 10698           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10699
 10700     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10701                                   WS-AH-EDIT-AGE.
 10702
 10703     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10704        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10705        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10706        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10707        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10708        IF NO-CONVERSION-ERROR
 10709           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10710           IF PB-I-JOINT-AGE > 0
 10711              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10712                 MOVE ER-9503    TO WS-ERROR
 10713                 PERFORM 9900-ERROR-FORMAT
 10714                                 THRU 9900-EXIT
 10715              END-IF
 10716           ELSE
 10717              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10718           END-IF
 10719        ELSE
 10720           MOVE ZEROS            TO PB-I-JOINT-AGE
 10721        END-IF
 10722     END-IF
 10723     IF PB-I-JOINT-AGE NOT NUMERIC
 10724        MOVE ZERO               TO PB-I-JOINT-AGE.
 10725
 10726     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10727                                   WS-JNT-AGE-SET
 10728     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10729        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10730           (WS-AH-JOINT-INDICATOR = 'J')
 10731           IF PB-I-JOINT-AGE = ZEROS
 10732               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10733                                          WS-JNT-AGE-SET
 10734               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10735           END-IF
 10736        END-IF
 10737     END-IF
 10738
 10739     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10740     IF WS-LF-JOINT-INDICATOR = 'J'
 10741        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10742        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10743            IF  PB-I-JOINT-AGE = ZERO
 10744                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 195
* EL050.cbl
 10745                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10746            ELSE
 10747                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10748                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10749                    IF PB-COMPANY-ID NOT = 'LBL'
 10750                        MOVE ER-2685    TO WS-ERROR
 10751                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10752
 10753     IF WS-AH-JOINT-INDICATOR = 'J'
 10754        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10755            IF  PB-I-JOINT-AGE = ZERO
 10756                MOVE ER-2686       TO WS-ERROR
 10757                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10758            ELSE
 10759                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10760                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10761                                           WS-EDIT-AGE
 10762                    IF PB-COMPANY-ID NOT = 'LBL'
 10763                        MOVE ER-2685    TO WS-ERROR
 10764                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10765
 10766******************************************************************
 10767*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10768******************************************************************
 10769
 10770     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10771        (WS-AH-SPECIAL-CALC-CD = 'O')
 10772        NEXT SENTENCE
 10773     ELSE
 10774        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10775          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10776           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10777            WS-AH-JOINT-INDICATOR = 'J')  AND
 10778           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10779            MOVE ER-2627             TO WS-ERROR
 10780            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10781
 10782     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10783        (WS-AH-SPECIAL-CALC-CD = 'O')
 10784         NEXT SENTENCE
 10785     ELSE
 10786         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10787            WS-AH-JOINT-INDICATOR = 'J'
 10788             IF PB-I-JOINT-INSURED = SPACES
 10789                 IF PB-COMPANY-ID NOT = 'JAL'
 10790                     MOVE ER-2696    TO WS-ERROR
 10791                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10792
 10793     IF PB-COMPANY-ID NOT = 'BOA'
 10794        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10795           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10796           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10797               PB-I-JOINT-INSURED NOT = SPACES)
 10798                MOVE ER-2691         TO WS-ERROR
 10799                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10800
 10801     IF PB-COMPANY-ID = 'BOA'
 10802        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 196
* EL050.cbl
 10803           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10804            IF PB-I-JOINT-AGE NOT = ZEROS
 10805                MOVE ER-2691         TO WS-ERROR
 10806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10807
 10808     IF PB-COMPANY-ID = 'CRI'
 10809        IF PB-I-SIG-SW = 'J'
 10810           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10811              WS-AH-JOINT-INDICATOR NOT = 'J'
 10812              MOVE ER-2675       TO WS-ERROR
 10813              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10814
 10815     IF PB-COMPANY-ID = 'CRI'
 10816        IF PB-I-SIG-SW = 'S'
 10817           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10818              WS-AH-JOINT-INDICATOR = 'J'
 10819              MOVE ER-2676       TO WS-ERROR
 10820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10821
 10822     IF PB-COMPANY-ID = 'CVL'
 10823         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10824            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10825              MOVE ER-2783           TO WS-ERROR
 10826              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10827     IF (WS-LF-JOINT-INDICATOR = 'J')
 10828        AND (WS-AH-JOINT-INDICATOR = 'J')
 10829        AND (PB-I-LF-TERM > 120)
 10830        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10831        MOVE ER-2783             TO WS-ERROR
 10832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10833     END-IF
 10834     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10835
 10836     IF PB-I-INDV-GRP-OVRD = 'I'
 10837        MOVE ER-2666             TO WS-ERROR
 10838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10839        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10840
 10841     IF PB-I-INDV-GRP-OVRD = 'G'
 10842        MOVE ER-2666             TO WS-ERROR
 10843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10844        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10845
 10846     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10847        NEXT SENTENCE
 10848     ELSE
 10849        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10850
 10851     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10852        IF WS-ERROR = ER-2666
 10853           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10854           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10855
 10856     IF PB-COMPANY-ID = 'CID'
 10857        IF PB-STATE = 'UT' OR 'MO'
 10858           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10859                 OR '76' OR '77')
 10860                      OR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 197
* EL050.cbl
 10861               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10862                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10863                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10864                   OR '2K' OR '2L'))
 10865              AND PB-I-INDV-GRP-CD = 'I'
 10866              MOVE ER-2721             TO WS-ERROR
 10867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10868           END-IF
 10869        END-IF
 10870     END-IF
 10871
 10872     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10873     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10874        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10875     ELSE
 10876        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10877     END-IF
 10878
 10879*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10880*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10881     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10882                                    ACCOUNT-AH-CK-SW.
 10883
 10884     IF PB-REISSUED-CERT       OR
 10885        PB-REIN-ONLY-CERT      OR
 10886        PB-POLICY-IS-DECLINED  OR
 10887        PB-POLICY-IS-VOIDED
 10888*       OR PB-MONTHLY-CERT
 10889         GO TO 3000-CONTINUE-EDIT.
 10890
 10891     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10892        IF WS-EDIT-AGE           > +65
 10893           MOVE ER-2709          TO WS-ERROR
 10894           PERFORM 9900-ERROR-FORMAT
 10895                                 THRU 9900-EXIT
 10896        ELSE
 10897           IF WS-EDIT-AGE        > +55
 10898              MOVE ER-2718       TO WS-ERROR
 10899              PERFORM 9900-ERROR-FORMAT
 10900                                 THRU 9900-EXIT
 10901           END-IF
 10902        END-IF
 10903     IF PB-COMPANY-ID = 'DCC'
 10904        IF WS-EDIT-AGE           > +65
 10905           MOVE ER-2709          TO WS-ERROR
 10906           PERFORM 9900-ERROR-FORMAT
 10907                                 THRU 9900-EXIT
 10908        END-IF
 10909     END-IF
 10910     .
 10911
 10912 0565-LIFE-PLAN-LIMIT-EDITS.
 10913
 10914     IF NOT LF-PLAN-MASTER-FOUND
 10915        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10916                                    EC-AM-LF-MAX-TOT-BEN
 10917        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10918
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 198
* EL050.cbl
 10919     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10920
 10921     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10922         IF PL-LM-AGE (1) = ZEROS
 10923             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10924
 10925     IF NO-LF-BENEFIT-MATCH          OR
 10926        WS-LF-BENEFIT-CD = ZEROS     OR
 10927        WS-LF-SPECIAL-CALC-CD = 'M'
 10928        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10929
 10930     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10931     MOVE +1                     TO SUB2.
 10932
 10933     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10934        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10935           MOVE +5   TO SUB2
 10936           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10937              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10938              (PL-LM-AGE (SUB2) EQUAL +0)
 10939              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10940              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10941
 10942     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10943
 10944     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10945                               + PB-I-LF-ALT-BENEFIT-AMT.
 10946
 10947 0568-CHECK-LIFE-ATT-AGE.
 10948
 10949     IF PL-ATT-AGE NUMERIC AND
 10950        PL-ATT-AGE > +0
 10951        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10952     END-IF
 10953*    IF PL-ATT-AGE NUMERIC AND
 10954*       PL-ATT-AGE > +0
 10955*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10956*       IF PB-I-BIRTHDAY > LOW-VALUES
 10957*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10958*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10959*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10960*          SET BIN-PLUS-ELAPSED  TO TRUE
 10961*          PERFORM 8500-DATE-CONVERT
 10962*                                THRU 8500-EXIT
 10963*          IF NO-CONVERSION-ERROR
 10964*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10965*             MOVE ER-2669       TO WS-ERROR
 10966*             PERFORM 9900-ERROR-FORMAT
 10967*                                THRU 9900-EXIT
 10968*          END-IF
 10969*       ELSE
 10970*          IF WS-ATT-AGE >= PL-ATT-AGE
 10971*             MOVE ER-2669       TO WS-ERROR
 10972*             PERFORM 9900-ERROR-FORMAT
 10973*                                THRU 9900-EXIT
 10974*          END-IF
 10975*       END-IF
 10976*    END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 199
* EL050.cbl
 10977     .
 10978 0570-CHECK-LIFE-LIMITS.
 10979
 10980     IF PB-COMPANY-ID EQUAL 'CRI'
 10981        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10982           IF SUB2 GREATER THAN +4
 10983              MOVE ER-2637 TO WS-ERROR
 10984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10985              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10986
 10987     IF PB-COMPANY-ID  =  'NCL'
 10988        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10989            SUB2 GREATER THAN +8
 10990             MOVE 'U'         TO PB-BATCH-ENTRY
 10991             MOVE ER-2637     TO WS-ERROR
 10992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10993             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10994
 10995     IF SUB2 > +8
 10996        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10997           AND (PB-I-SIG-SW = 'Y')
 10998           CONTINUE
 10999        ELSE
 11000           MOVE ER-2637          TO WS-ERROR
 11001           PERFORM 9900-ERROR-FORMAT
 11002                                 THRU 9900-EXIT
 11003        END-IF
 11004        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11005     END-IF
 11006     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11007     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11008     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11009
 11010     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11011        ADD +1  TO SUB2
 11012        GO TO 0570-CHECK-LIFE-LIMITS.
 11013
 11014     IF PB-COMPANY-ID = 'NCL'
 11015         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11016
 11017     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11018        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11019        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11020           AND (PB-I-SIG-SW = 'Y')
 11021           CONTINUE
 11022        ELSE
 11023           MOVE ER-2637          TO WS-ERROR
 11024           PERFORM 9900-ERROR-FORMAT
 11025                                 THRU 9900-EXIT
 11026        END-IF
 11027     END-IF
 11028     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11029
 11030
 11031 0570-CHECK-NCL-LIFE-LIMITS.
 11032
 11033     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11034        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 200
* EL050.cbl
 11035         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11036
 11037     IF APP-CERT-USED
 11038         IF SUB2  LESS THAN  +5
 11039             MOVE +5          TO SUB2
 11040             GO TO 0570-CHECK-LIFE-LIMITS.
 11041
 11042     MOVE ER-2637             TO WS-ERROR.
 11043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11044
 11045     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11046
 11047 0575-CHECK-NCL-SIG-SWITCH.
 11048
 11049     IF NOT APP-CERT-USED
 11050         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11051
 11052     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11053        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11054        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11055        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11056         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11057
 11058     IF SUB2 GREATER THAN +4
 11059         IF PL-LM-AGE (5) = ZEROS  AND
 11060            PL-LM-AGE (6) = ZEROS  AND
 11061            PL-LM-AGE (7) = ZEROS  AND
 11062            PL-LM-AGE (8) = ZEROS
 11063             MOVE  ER-1927        TO WS-ERROR
 11064             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11065             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11066         ELSE
 11067             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11068                 MOVE  ER-1920    TO WS-ERROR
 11069                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11070
 11071     IF PB-I-SIG-SW  = 'Y'
 11072       IF NOT PB-I-POLICY-ACCEPTED  AND
 11073          NOT PB-I-POLICY-DECLINED
 11074           MOVE 'U'               TO PB-BATCH-ENTRY
 11075           MOVE  ER-1926          TO WS-ERROR
 11076           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11077
 11078
 11079 0580-AH-PLAN-LIMIT-EDITS.
 11080
 11081     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11082        IF PB-I-AH-BENEFIT-AMT > +1250
 11083           MOVE ER-2702          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT
 11085                                 THRU 9900-EXIT
 11086        END-IF
 11087     END-IF
 11088
 11089     IF (PB-COMPANY-ID = 'DCC')
 11090        AND (PB-MONTHLY-CERT)
 11091        IF PB-I-AH-BENEFIT-AMT > +3000
 11092           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 201
* EL050.cbl
 11093           PERFORM 9900-ERROR-FORMAT
 11094                                 THRU 9900-EXIT
 11095        END-IF
 11096     END-IF
 11097     IF NOT AH-PLAN-MASTER-FOUND
 11098        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11099        GO TO 3000-CONTINUE-EDIT.
 11100
 11101     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11102
 11103     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11104         IF PL-LM-AGE (1) = ZEROS
 11105             GO TO 3000-CONTINUE-EDIT.
 11106
 11107     IF NO-AH-BENEFIT-MATCH          OR
 11108        WS-AH-BENEFIT-CD = ZEROS     OR
 11109        WS-AH-SPECIAL-CALC-CD = 'M'
 11110        GO TO 3000-CONTINUE-EDIT.
 11111
 11112     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11113     MOVE +1                     TO SUB2.
 11114
 11115     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11116        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11117           MOVE +5 TO SUB2
 11118           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11119              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11120              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11121              (PL-LM-AGE (SUB2) EQUAL +0)
 11122              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11123              GO TO 3000-CONTINUE-EDIT.
 11124
 11125     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11126
 11127 0590-CHECK-AH-ATT-AGE.
 11128
 11129     IF PL-ATT-AGE NUMERIC AND
 11130        PL-ATT-AGE GREATER THAN +0
 11131        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11132     END-IF
 11133*       IF WS-ATT-AGE >= PL-ATT-AGE
 11134*          MOVE ER-3054          TO WS-ERROR
 11135*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11136     .
 11137 0597-CHECK-AH-LIMITS.
 11138
 11139     IF PB-COMPANY-ID EQUAL 'CRI'
 11140        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11141           IF SUB2 GREATER THAN +4
 11142              MOVE ER-2638       TO WS-ERROR
 11143              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11144              GO TO 3000-CONTINUE-EDIT.
 11145
 11146     IF PB-COMPANY-ID  =  'NCL'
 11147        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11148            SUB2 GREATER THAN +8
 11149             MOVE 'U'            TO PB-BATCH-ENTRY
 11150             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 202
* EL050.cbl
 11151             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11152             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11153
 11154     IF SUB2 > +8
 11155        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11156           AND (PB-I-SIG-SW = 'Y')
 11157           CONTINUE
 11158        ELSE
 11159           MOVE ER-2638          TO WS-ERROR
 11160           PERFORM 9900-ERROR-FORMAT
 11161                                 THRU 9900-EXIT
 11162        END-IF
 11163        GO TO 3000-CONTINUE-EDIT
 11164     END-IF
 11165
 11166     IF PB-COMPANY-ID = 'CRI'
 11167        IF WS-ERROR = ER-2638
 11168           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11169
 11170     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11171     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11172     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11173     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11174
 11175     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11176        ADD +1                   TO SUB2
 11177        GO TO 0597-CHECK-AH-LIMITS.
 11178
 11179     IF PB-COMPANY-ID = 'NCL'
 11180         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11181
 11182     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11183        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11184        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11185                                 > PL-LM-AMT (SUB2))
 11186        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11187           AND (PB-I-SIG-SW = 'Y')
 11188           CONTINUE
 11189        ELSE
 11190           MOVE ER-2638          TO WS-ERROR
 11191           PERFORM 9900-ERROR-FORMAT
 11192                                 THRU 9900-EXIT
 11193        END-IF
 11194     END-IF
 11195
 11196     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11197         IF  WS-ERROR    EQUAL    ER-2638
 11198             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11199                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11200                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11201                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11202                MOVE  ER-1910    TO  WS-ERROR
 11203                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11204
 11205     IF PB-COMPANY-ID = 'CRI'
 11206        IF WS-ERROR = ER-2638
 11207            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11208            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 203
* EL050.cbl
 11209            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11210
 11211     GO TO 3000-CONTINUE-EDIT.
 11212
 11213 0597-CHECK-NCL-AH-LIMITS.
 11214
 11215     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11216        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11217        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11218                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11219         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11220
 11221     IF APP-CERT-USED
 11222         IF SUB2  LESS THAN  +5
 11223             MOVE +5             TO SUB2
 11224             GO TO 0597-CHECK-AH-LIMITS.
 11225
 11226     MOVE ER-2638                TO WS-ERROR.
 11227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11228
 11229     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11230
 11231 0599-CHECK-NCL-SIG-SWITCH.
 11232
 11233     IF NOT APP-CERT-USED
 11234         GO TO 3000-CONTINUE-EDIT.
 11235
 11236     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11237        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11238        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11239        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11240         GO TO 3000-CONTINUE-EDIT.
 11241
 11242     IF SUB2 GREATER THAN +4
 11243         IF PL-LM-AGE (5) = ZEROS  AND
 11244            PL-LM-AGE (6) = ZEROS  AND
 11245            PL-LM-AGE (7) = ZEROS  AND
 11246            PL-LM-AGE (8) = ZEROS
 11247             MOVE  ER-1927        TO WS-ERROR
 11248             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11249             GO TO 3000-CONTINUE-EDIT
 11250         ELSE
 11251             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11252                 MOVE  ER-1920    TO WS-ERROR
 11253                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11254
 11255     IF PB-I-SIG-SW  = 'Y'
 11256       IF NOT PB-I-POLICY-ACCEPTED  AND
 11257          NOT PB-I-POLICY-DECLINED
 11258           MOVE 'U'               TO PB-BATCH-ENTRY
 11259           MOVE  ER-1926          TO WS-ERROR
 11260           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11261
 11262******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 204
* EL050.cbl
 11264
 11265 3000-CONTINUE-EDIT.
 11266
 11267     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11268     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11269     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11270     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11271     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11272
 11273     IF BROWSE-STARTED
 11274        PERFORM 9990-RETURN THRU 9990-EXIT
 11275        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11276
 11277     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11278        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11279        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11280        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11281*       MOVE 1                   TO DC-OPTION-CODE
 11282        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11283        IF DATE-CONVERSION-ERROR
 11284           MOVE ER-2622          TO WS-ERROR
 11285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11286        ELSE
 11287           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11288              MOVE ER-2623       TO WS-ERROR
 11289              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11290           ELSE
 11291              MOVE ER-2622       TO WS-ERROR
 11292              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11293
 11294     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11295     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11296     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11297*    MOVE 1                      TO DC-OPTION-CODE.
 11298     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11299     IF DATE-CONVERSION-ERROR
 11300        GO TO 3005-EDIT-CONTINUE
 11301     ELSE
 11302        IF DC-ELAPSED-DAYS GREATER +180
 11303           MOVE ER-2613          TO WS-ERROR
 11304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11305        ELSE
 11306           IF DC-ELAPSED-DAYS GREATER +90
 11307              MOVE ER-2612       TO WS-ERROR
 11308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11309           ELSE
 11310             IF DC-ELAPSED-DAYS GREATER +60
 11311                MOVE ER-2614     TO WS-ERROR
 11312                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11313
 11314 3005-EDIT-CONTINUE.
 11315
 11316     IF PB-CANCELLATION
 11317         GO TO 3700-EDIT-CANCEL.
 11318
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 205
* EL050.cbl
 11320******************************************************************
 11321*                  E D I T   I S S U E                           *
 11322******************************************************************
 11323
 11324 3020-EDIT-ISSUE.
 11325
 11326      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11327      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11328      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11329      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11330      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11331
 11332     IF PB-ISSUE-FORCE
 11333        OR PB-ISSUE-DATE-FORCED
 11334        OR PB-FORCE-OFF
 11335        OR PB-OVERCHARGE-FORCE
 11336        CONTINUE
 11337     ELSE
 11338        MOVE ER-2670             TO WS-ERROR
 11339        PERFORM 9900-ERROR-FORMAT
 11340                                 THRU 9900-EXIT
 11341     END-IF
 11342     .
 11343 3022-SET-POLICY-STATUS.
 11344
 11345     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11346
 11347     IF (PB-REISSUED-CERT)
 11348             OR
 11349        ((PB-COMPANY-ID NOT = 'DCC')
 11350         AND (PB-MONTHLY-CERT))
 11351         MOVE '5'                TO PB-I-ENTRY-STATUS
 11352         MOVE 'E'                TO PB-BATCH-ENTRY
 11353     END-IF
 11354
 11355     IF PB-COMPANY-ID = 'DCC'
 11356        IF PB-MONTHLY-CERT
 11357           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11358        END-IF
 11359        IF PB-CASH-CERT
 11360           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11361        END-IF
 11362     END-IF
 11363     IF PB-POLICY-IS-DECLINED
 11364         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11365     IF PB-POLICY-IS-VOIDED
 11366         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11367     IF PB-NEEDS-UNDERWRITING
 11368         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11369     IF PB-REIN-ONLY-CERT
 11370         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11371     IF PB-PREM-ACCTNG-ONLY
 11372         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11373
 11374     MOVE SPACE                  TO PB-I-OB-FLAG.
 11375
 11376     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11377         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 206
* EL050.cbl
 11378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11379         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11380
 11381     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11382        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11383           MOVE 'Z'             TO PB-I-OB-FLAG.
 11384
 11385     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11386        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11387           MOVE 'Z'             TO PB-I-OB-FLAG.
 11388
 11389     IF ACCOUNT-MAST-FOUND
 11390         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11391         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11392         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11393         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11394         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11395         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11396         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11397     END-IF
 11398
 11399     IF ACCOUNT-MAST-FOUND
 11400        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11401         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11402
 11403     IF (ACCOUNT-MAST-FOUND)
 11404        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11405        IF PB-REISSUED-CERT
 11406           CONTINUE
 11407        ELSE
 11408           MOVE ER-2608          TO WS-ERROR
 11409           PERFORM 9900-ERROR-FORMAT
 11410                                 THRU 9900-EXIT
 11411         END-IF
 11412     END-IF
 11413
 11414     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11415        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11416        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11417
 11418**********   DMD CUSTOM CODE FOLLOWS  **********
 11419 3024-EDIT-DMD-FIELDS.
 11420     IF PB-COMPANY-ID NOT = 'DMD'
 11421        GO TO 3025-EDIT-REINSURANCE.
 11422
 11423*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11424*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11425*** ERROR IF THEY ARE NOT EQUAL.
 11426
 11427     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11428     SET BIN-TO-GREG               TO TRUE.
 11429     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11430     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11431**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11432
 11433     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11434     SET BIN-TO-GREG               TO TRUE.
 11435     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 207
* EL050.cbl
 11436     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11437**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11438
 11439     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11440        MOVE ER-8116               TO WS-ERROR
 11441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11442
 11443     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11444
 11445     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11446                                      WK-FULL-CERT-NO.
 11447     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11448
 11449     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11450
 11451     IF PB-VALID-LIFE
 11452        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11453     ELSE
 11454        IF PB-VALID-AH
 11455          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11456
 11457
 11458     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11459     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11460     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11461                                      DCUA-UNDRWRTR-CODE
 11462                                      DCUA-UNDRWRTR-GROUP-CODE
 11463                                      DCUA-RETURN-CODE.
 11464
 11465****************************************************************
 11466*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11467***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11468***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11469***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11470***   TO THIS RECORD.                                        ***
 11471****************************************************************
 11472     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11473     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11474     IF DCUA-SUCCESSFUL-PROCESS
 11475        GO TO 3024-EDIT-DL7-CONT.
 11476
 11477     IF DCUA-RETURN-CODE EQUAL '01'
 11478        MOVE ER-8110               TO WS-ERROR
 11479        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL7-CONT.
 11482
 11483     IF DCUA-RETURN-CODE EQUAL '02'
 11484        MOVE ER-8111               TO WS-ERROR
 11485        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487        GO TO 3024-EDIT-DL7-CONT.
 11488
 11489     IF DCUA-RETURN-CODE EQUAL '03'
 11490        MOVE ER-8074               TO WS-ERROR
 11491        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11493        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 208
* EL050.cbl
 11494
 11495     IF DCUA-RETURN-CODE EQUAL '04'
 11496        MOVE ER-8075               TO WS-ERROR
 11497        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499        GO TO 3024-EDIT-DL7-CONT.
 11500
 11501     IF DCUA-RETURN-CODE EQUAL '05'
 11502        MOVE ER-8076               TO WS-ERROR
 11503        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11505        GO TO 3024-EDIT-DL7-CONT.
 11506
 11507     IF DCUA-RETURN-CODE EQUAL '06'
 11508        MOVE ER-8077               TO WS-ERROR
 11509        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511        GO TO 3024-EDIT-DL7-CONT.
 11512
 11513     IF DCUA-RETURN-CODE EQUAL '07'
 11514        MOVE ER-8078               TO WS-ERROR
 11515        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL7-CONT.
 11518
 11519     IF DCUA-RETURN-CODE EQUAL 'E1'
 11520        MOVE ER-8079               TO WS-ERROR
 11521        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL7-CONT.
 11524
 11525     IF DCUA-RETURN-CODE EQUAL 'E2'
 11526        MOVE ER-8080               TO WS-ERROR
 11527        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529        GO TO 3024-EDIT-DL7-CONT.
 11530
 11531     IF DCUA-RETURN-CODE EQUAL 'E3'
 11532        MOVE ER-8098               TO WS-ERROR
 11533        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL7-CONT.
 11536
 11537     IF DCUA-RETURN-CODE EQUAL 'C1'
 11538        MOVE ER-8099               TO WS-ERROR
 11539        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL7-CONT.
 11542
 11543     IF DCUA-RETURN-CODE EQUAL 'U1'
 11544        MOVE ER-8109               TO WS-ERROR
 11545        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL7-CONT.
 11548
 11549     IF DCUA-RETURN-CODE EQUAL 'N1'
 11550        MOVE ER-8112               TO WS-ERROR
 11551        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 209
* EL050.cbl
 11552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11553        GO TO 3024-EDIT-DL7-CONT.
 11554
 11555     IF DCUA-RETURN-CODE EQUAL 'N2'
 11556        MOVE ER-8113               TO WS-ERROR
 11557        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11559        GO TO 3024-EDIT-DL7-CONT.
 11560
 11561     IF DCUA-RETURN-CODE EQUAL 'N3'
 11562        MOVE ER-8114               TO WS-ERROR
 11563        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11565        GO TO 3024-EDIT-DL7-CONT.
 11566
 11567     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11568     MOVE ER-8097                  TO WS-ERROR.
 11569     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11570     GO TO 3024-EDIT-DL7-CONT.
 11571
 11572 3024-EDIT-DL7-CONT.
 11573
 11574     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11575     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11576     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11577        NEXT SENTENCE
 11578     ELSE
 11579        MOVE ER-9263               TO WS-ERROR
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11581
 11582******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11583******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11584     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11585        NEXT SENTENCE
 11586     ELSE
 11587        MOVE ER-8039               TO WS-ERROR
 11588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11589
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 210
* EL050.cbl
 11591****************************************************************
 11592*** VALIDATE STATE  : DLO022                                 ***
 11593****************************************************************
 11594     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11595     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11596
 11597     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11598     IF DVSC-SUCCESSFUL-EDIT
 11599        GO TO 3024-EDIT-DL22-CONT.
 11600
 11601     IF DVSC-RETURN-CODE EQUAL '01'
 11602        MOVE ER-8300               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11604        GO TO 3024-EDIT-DL22-CONT.
 11605
 11606     IF DVSC-RETURN-CODE EQUAL '02'
 11607        MOVE ER-8301               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL22-CONT.
 11610
 11611     IF DVSC-RETURN-CODE EQUAL '03'
 11612        MOVE ER-8302               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL22-CONT.
 11615
 11616     IF DVSC-RETURN-CODE EQUAL 'N1'
 11617        MOVE ER-8304               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL22-CONT.
 11620
 11621     MOVE ER-8303                  TO WS-ERROR
 11622     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11623
 11624 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 211
* EL050.cbl
 11626****************************************************************
 11627*** VALIDATE LOAN OFFICER : DLO021                           ***
 11628****************************************************************
 11629
 11630     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11631     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11632     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11633     IF DVLO-SUCCESSFUL-EDIT
 11634        GO TO 3024-EDIT-DL21-CONT.
 11635
 11636     IF DVLO-RETURN-CODE EQUAL '01'
 11637        MOVE ER-8081               TO WS-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11639        GO TO 3024-EDIT-DL21-CONT.
 11640
 11641     IF DVLO-RETURN-CODE EQUAL '02'
 11642        MOVE ER-8082               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL21-CONT.
 11645
 11646     IF DVLO-RETURN-CODE EQUAL '03'
 11647        MOVE ER-8083               TO WS-ERROR
 11648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649        GO TO 3024-EDIT-DL21-CONT.
 11650
 11651     IF DVLO-RETURN-CODE EQUAL '04'
 11652        MOVE ER-8084               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654        GO TO 3024-EDIT-DL21-CONT.
 11655
 11656     IF DVLO-RETURN-CODE EQUAL '05'
 11657        MOVE ER-8085               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL21-CONT.
 11660
 11661     MOVE ER-7825                  TO WS-ERROR
 11662     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11663     GO TO 3024-EDIT-DL21-CONT.
 11664
 11665 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 212
* EL050.cbl
 11667
 11668****************************************************************
 11669*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11670****************************************************************
 11671
 11672     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11673     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11674     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11675     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11676     IF DIPF-SUCCESSFUL-EDIT
 11677        GO TO 3024-EDIT-DL02-CONT.
 11678
 11679     IF DIPF-RETURN-CODE EQUAL '01'
 11680        MOVE ER-8086               TO WS-ERROR
 11681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11682        GO TO 3024-EDIT-DL02-CONT.
 11683
 11684     IF DIPF-RETURN-CODE EQUAL '02'
 11685        MOVE ER-8087               TO WS-ERROR
 11686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11687        GO TO 3024-EDIT-DL02-CONT.
 11688
 11689     IF DIPF-RETURN-CODE EQUAL '03'
 11690        MOVE ER-8088               TO WS-ERROR
 11691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11692        GO TO 3024-EDIT-DL02-CONT.
 11693
 11694     MOVE ER-8095                  TO WS-ERROR
 11695     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11696     GO TO 3024-EDIT-DL02-CONT.
 11697
 11698 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 213
* EL050.cbl
 11700
 11701****************************************************************
 11702*** VALIDATE BANK ID : DLO003                                ***
 11703****************************************************************
 11704
 11705     MOVE WK-GREG-CENT           TO WCG-CENT.
 11706     MOVE WK-GREG-YYMM           TO WCG-REST.
 11707     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11708        MOVE ER-8040               TO WS-ERROR
 11709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11710
 11711     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11712     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11713     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11714     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11715     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11716     IF DVBI-SUCCESSFUL-EDIT
 11717        GO TO 3024-EDIT-DL03-CONT.
 11718
 11719     IF DVBI-RETURN-CODE EQUAL '01'
 11720        MOVE ER-8089               TO WS-ERROR
 11721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722        GO TO 3024-EDIT-DL03-CONT.
 11723
 11724     IF DVBI-RETURN-CODE EQUAL '02'
 11725        MOVE ER-8090               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727        GO TO 3024-EDIT-DL03-CONT.
 11728
 11729     IF DVBI-RETURN-CODE EQUAL '03'
 11730        MOVE ER-8091               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732        GO TO 3024-EDIT-DL03-CONT.
 11733
 11734     IF DVBI-RETURN-CODE EQUAL '04'
 11735        MOVE ER-8092               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL03-CONT.
 11738
 11739     IF DVBI-RETURN-CODE EQUAL '05'
 11740        MOVE ER-8093               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL03-CONT.
 11743
 11744     IF DVBI-RETURN-CODE EQUAL '06'
 11745        MOVE ER-8094               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL03-CONT.
 11748
 11749     MOVE ER-8096                  TO WS-ERROR
 11750     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11751     GO TO 3024-EDIT-DL03-CONT.
 11752
 11753 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 214
* EL050.cbl
 11755
 11756     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11757        NEXT SENTENCE
 11758     ELSE
 11759        MOVE ER-8042               TO WS-ERROR
 11760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11761
 11762     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11763     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11764     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11765
 11766     IF DMPF-RETURN-CODE = '01'
 11767        MOVE ER-8067               TO WS-ERROR
 11768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11769        GO TO 3024-EDIT-DL01-CONT.
 11770
 11771     IF DMPF-RETURN-CODE = '02'
 11772        MOVE ER-8068               TO WS-ERROR
 11773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11774        GO TO 3024-EDIT-DL01-CONT.
 11775
 11776     IF DMPF-RETURN-CODE = '03'
 11777        MOVE ER-8069               TO WS-ERROR
 11778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11779        GO TO 3024-EDIT-DL01-CONT.
 11780
 11781     IF DMPF-RETURN-CODE = 'E1'
 11782        MOVE ER-8070               TO WS-ERROR
 11783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11784        GO TO 3024-EDIT-DL01-CONT.
 11785
 11786     IF DMPF-RETURN-CODE = 'N1'
 11787        MOVE ER-8071               TO WS-ERROR
 11788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11789        GO TO 3024-EDIT-DL01-CONT.
 11790
 11791     IF DMPF-RETURN-CODE NOT = 'OK'
 11792        MOVE ER-8072               TO WS-ERROR
 11793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11794
 11795 3024-EDIT-DL01-CONT.
 11796******************************************************************
 11797***  VALIDATES RATE CODES : DLO017                             ***
 11798******************************************************************
 11799
 11800      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11801      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11802      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11803      IF DVRC-SUCCESSFUL-EDIT
 11804        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11805        GO TO 3024-CHECK-VALID-RATE.
 11806
 11807      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11808
 11809      IF DVRC-RETURN-CODE EQUAL '01'
 11810         MOVE ER-7817                   TO WS-ERROR
 11811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 215
* EL050.cbl
 11813
 11814      IF DVRC-RETURN-CODE EQUAL '02'
 11815         MOVE ER-7818                   TO WS-ERROR
 11816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11817         GO TO 3025-EDIT-REINSURANCE.
 11818
 11819      IF DVRC-RETURN-CODE EQUAL '03'
 11820         MOVE ER-7819                   TO WS-ERROR
 11821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11822         GO TO 3025-EDIT-REINSURANCE.
 11823
 11824       MOVE ER-7820                     TO WS-ERROR.
 11825       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11826       GO TO 3025-EDIT-REINSURANCE.
 11827
 11828******************************************************************
 11829***  GET PREMIUM RATES : DLO011                                ***
 11830******************************************************************
 11831
 11832 3024-CHECK-VALID-RATE.
 11833
 11834     IF VALID-RATE-CODE
 11835        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11836        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11837        MOVE SPACES                TO DPRB-RETURN-CODE
 11838        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11839     ELSE
 11840         GO TO 3025-EDIT-REINSURANCE.
 11841
 11842      IF DPRB-SUCCESSFUL-PROCESS
 11843         IF PB-VALID-LIFE
 11844             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11845             GO TO 3025-EDIT-REINSURANCE
 11846         ELSE
 11847             IF PB-VALID-AH
 11848                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11849                 GO TO 3025-EDIT-REINSURANCE.
 11850
 11851      IF DPRB-RETURN-CODE EQUAL '01'
 11852         MOVE ER-7812                   TO WS-ERROR
 11853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11854         GO TO 3025-EDIT-REINSURANCE.
 11855
 11856      IF DPRB-RETURN-CODE EQUAL '02'
 11857         MOVE ER-7813                   TO WS-ERROR
 11858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11859         GO TO 3025-EDIT-REINSURANCE.
 11860
 11861      IF DPRB-RETURN-CODE EQUAL '03'
 11862         MOVE ER-7814                   TO WS-ERROR
 11863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11864         GO TO 3025-EDIT-REINSURANCE.
 11865
 11866      IF DPRB-RETURN-CODE EQUAL '04'
 11867         IF NOT DPRB-1ST-TIME
 11868            MOVE ER-7815                   TO WS-ERROR
 11869            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11870            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 216
* EL050.cbl
 11871          ELSE
 11872         IF PB-VALID-LIFE
 11873            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11874          ELSE
 11875            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11876         END-IF
 11877         MOVE SPACES                TO DOCC-RETURN-CODE
 11878         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11879         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11880         IF DOCC-RETURN-CODE = 'OK'
 11881             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11882             GO TO 3024-CHECK-VALID-RATE
 11883           ELSE
 11884             MOVE ER-7823               TO WS-ERROR
 11885             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11886             GO TO 3025-EDIT-REINSURANCE.
 11887
 11888       MOVE ER-7816                     TO WS-ERROR.
 11889       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11890       GO TO 3025-EDIT-REINSURANCE.
 11891
 11892**********   DMD CUSTOM CODE ABOVE    **********
 11893
 11894 3025-EDIT-REINSURANCE.
 11895     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11896         GO TO 3027-EDIT-CONTINUE.
 11897
 11898     MOVE LOW-VALUES               TO ERREIN-KEY.
 11899     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11900     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11901                                      REIN-CODE-2
 11902                                      REIN-CODE-3.
 11903     MOVE 'A'                      TO REIN-TYPE.
 11904
 11905     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11906
 11907     MOVE '3026' TO REIN-SW.
 11908     MOVE ' '                   TO WS-REIN-READ-SW.
 11909
 11910     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11911     IF REIN-TABLE-NOT-FOUND
 11912         GO TO 3026-NO-SPEC-TABLE.
 11913
 11914     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11915     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11916                                   WS-NSP-ST-CD-LF.
 11917     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11918                                   WS-NSP-ST-CD-AH.
 11919
 11920     GO TO 3040-EDIT-CONTINUE.
 11921
 11922 3026-NO-SPEC-TABLE.
 11923
 11924     MOVE ER-2664                TO WS-ERROR.
 11925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11926     GO TO 3040-EDIT-CONTINUE.
 11927
 11928 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 217
* EL050.cbl
 11929
 11930     IF PB-I-REIN-TABLE = SPACES
 11931       GO TO 3040-EDIT-CONTINUE.
 11932
 11933     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11934          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11935          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11936           GO TO 3040-EDIT-CONTINUE.
 11937
 11938     MOVE LOW-VALUES            TO ERREIN-KEY.
 11939     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11940     MOVE 'A'                   TO REIN-TYPE.
 11941     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11942
 11943     MOVE '3028'                TO REIN-SW.
 11944     MOVE ' '                   TO WS-REIN-READ-SW.
 11945
 11946     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11947     IF REIN-TABLE-NOT-FOUND
 11948         GO TO 3028-NO-REIN-TABLE.
 11949
 11950     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11951     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11952                                   WS-NSP-ST-CD-LF.
 11953     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11954                                   WS-NSP-ST-CD-AH.
 11955
 11956     GO TO 3040-EDIT-CONTINUE.
 11957
 11958 3028-NO-REIN-TABLE.
 11959
 11960     MOVE ER-2615                TO WS-ERROR.
 11961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11962     GO TO 3040-EDIT-CONTINUE.
 11963
 11964 3040-EDIT-CONTINUE.
 11965
 11966     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11967         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11968
 11969     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11970         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11971
 11972     IF (NOT PB-REISSUED-CERT)
 11973        AND (NOT PB-MONTHLY-CERT)
 11974        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11975            MOVE '001'           TO PB-I-LF-TERM
 11976            MOVE 'M'             TO PB-I-INSURED-SEX.
 11977
 11978     IF (NOT PB-REISSUED-CERT)
 11979        AND (NOT PB-MONTHLY-CERT)
 11980        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11981            MOVE '001'           TO PB-I-AH-TERM
 11982            MOVE 'M'             TO PB-I-INSURED-SEX.
 11983
 11984 3040-EDIT-1ST-PMT-DT.
 11985     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11986     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 218
* EL050.cbl
 11987         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11988
 11989******************************************************************
 11990*                                                                *
 11991*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11992*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11993*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11994*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11995*                                                                *
 11996******************************************************************
 11997
 11998     IF PB-EFF-DT-PROCESSING
 11999        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12000                                    PB-I-LF-EXPIRE-DT
 12001                                    PB-I-AH-EXPIRE-DT
 12002        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12003        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12004        MOVE ZERO                TO DC-ELAPSED-DAYS
 12005        MOVE +1                  TO DC-ELAPSED-MONTHS
 12006        SET BIN-PLUS-ELAPSED     TO TRUE
 12007*       MOVE 6                   TO DC-OPTION-CODE
 12008        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12009        IF NO-CONVERSION-ERROR
 12010           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12011
 12012******************************************************************
 12013*                                                                *
 12014*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12015*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12016*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12017*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12018*                                                                *
 12019******************************************************************
 12020
 12021     IF PB-EXT-DAYS-PROCESSING
 12022          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12023                                         PB-I-LF-EXPIRE-DT
 12024                                         PB-I-AH-EXPIRE-DT
 12025          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12026          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12027          MOVE +1                     TO DC-ELAPSED-MONTHS
 12028          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12029          SET BIN-PLUS-ELAPSED        TO TRUE
 12030*         MOVE 6                      TO DC-OPTION-CODE
 12031          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12032          IF NO-CONVERSION-ERROR
 12033             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12034
 12035******************************************************************
 12036*                                                                *
 12037*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12038*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12039*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12040*        (EXPIRE DATE - (TERM -1))  *  -1.
 12041*                                                                *
 12042******************************************************************
 12043
 12044     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 219
* EL050.cbl
 12045        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12046           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12047              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12048              MOVE PB-I-AH-TERM      TO WS-TERM
 12049           ELSE
 12050              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12051              MOVE PB-I-LF-TERM      TO WS-TERM
 12052        ELSE
 12053           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12054              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12055              MOVE PB-I-LF-TERM      TO WS-TERM
 12056           ELSE
 12057              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12058              MOVE PB-I-AH-TERM      TO WS-TERM.
 12059
 12060     IF PB-EXPIRE-DT-PROCESSING
 12061        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12062        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12063        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12064        MOVE ZERO                TO DC-ELAPSED-DAYS
 12065                                    DC-ODD-DAYS-OVER
 12066          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12067          SET BIN-PLUS-ELAPSED    TO TRUE
 12068*         MOVE 6                  TO DC-OPTION-CODE
 12069          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12070          IF NO-CONVERSION-ERROR
 12071             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12072
 12073******************************************************************
 12074*                                                                *
 12075*            1ST PAYMENT DATE PROCESSING                         *
 12076*                                                                *
 12077******************************************************************
 12078
 12079     IF PB-1ST-PMT-DT-PROCESSING
 12080        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12081                                    PB-I-AH-EXPIRE-DT
 12082        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12083
 12084     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12085         NEXT SENTENCE
 12086     ELSE
 12087         MOVE ER-2680                 TO WS-ERROR
 12088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089         GO TO 3060-ORIG-TERM-CHECK.
 12090
 12091     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12092     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12093     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12094*    MOVE 1                      TO DC-OPTION-CODE.
 12095     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12096                                    DC-ELAPSED-DAYS
 12097                                    DC-ODD-DAYS-OVER.
 12098
 12099     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12100
 12101     IF DATE-CONVERSION-ERROR
 12102        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 220
* EL050.cbl
 12103
 12104     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12105     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12106        AND (WS-LF-COVERAGE-TYPE = 'L')
 12107        IF (DC-ELAPSED-MONTHS > 1)
 12108                      OR
 12109           ((DC-ELAPSED-MONTHS = 1)
 12110           AND (DC-ODD-DAYS-OVER > 0))
 12111           MOVE ER-2882          TO WS-ERROR
 12112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12113        END-IF
 12114     END-IF
 12115     if dc-elapsed-months > 0
 12116        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12117        + dc-odd-days-over
 12118     end-if
 12119     IF PB-EXT-DAYS-PROCESSING
 12120        CONTINUE
 12121     ELSE
 12122        IF DC-ELAPSED-MONTHS = +0
 12123           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12124        ELSE
 12125           IF (WS-LF-EARNINGS-CALC = '4')
 12126              AND (DC-ELAPSED-MONTHS > ZERO)
 12127              AND (DC-ELAPSED-DAYS > ZERO)
 12128              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12129           ELSE
 12130              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12131                                 THRU 6499-EXIT
 12132              MOVE WS-ODD-DAYS-OVER
 12133                                 TO PB-I-EXTENTION-DAYS
 12134           END-IF
 12135        END-IF
 12136     END-IF
 12137******************************************************************
 12138*                                                                *
 12139*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12140*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12141*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12142*            AND ANY ODD DAYS.                                   *
 12143*                                                                *
 12144******************************************************************
 12145
 12146     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12147                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12148     IF WS-LF-EARNINGS-CALC NOT = '4'
 12149        IF DC-ELAPSED-DAYS > ZEROS
 12150           MOVE ER-2681          TO WS-ERROR
 12151           PERFORM 9900-ERROR-FORMAT
 12152                                 THRU 9900-EXIT
 12153        END-IF
 12154     END-IF
 12155
 12156     IF WS-LF-EARNINGS-CALC NOT = '4'
 12157        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12158           MOVE ER-2681          TO WS-ERROR
 12159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12160
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 221
* EL050.cbl
 12161     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12162        (PB-I-LF-TERM NOT = ZERO) AND
 12163         NOT NO-LIFE-COVERAGE
 12164          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12165          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12166          IF WS-LF-EARNINGS-CALC = '4'
 12167             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12168             PB-I-PAY-FREQUENCY
 12169          END-IF
 12170          MOVE ZERO              TO DC-ELAPSED-DAYS
 12171                                    DC-ODD-DAYS-OVER
 12172          MOVE 1                 TO DC-END-OF-MONTH
 12173          SET BIN-PLUS-ELAPSED        TO TRUE
 12174*         MOVE 6                 TO DC-OPTION-CODE
 12175          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12176          IF NO-CONVERSION-ERROR
 12177             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12178             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12179                (WS-LF-SPECIAL-CALC-CD = 'L')
 12180                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12181                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12182                  MOVE +1             TO DC-ELAPSED-MONTHS
 12183                  SET BIN-PLUS-ELAPSED  TO TRUE
 12184*                 MOVE 6              TO DC-OPTION-CODE
 12185                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12186                  IF NO-CONVERSION-ERROR
 12187                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12188
 12189* okay, i had to move the new att age edit down here because the
 12190* expiration date could get recalculated and i need the exp date
 12191     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12192        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12193        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12194        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12195           AND ZEROS
 12196           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12197           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12198           SET ELAPSED-BETWEEN-BIN TO TRUE
 12199           PERFORM 8500-DATE-CONVERT
 12200                                 THRU 8500-EXIT
 12201           IF NO-CONVERSION-ERROR
 12202              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12203                 MOVE ER-2669       TO WS-ERROR
 12204*                PERFORM 9900-ERROR-FORMAT
 12205*                                THRU 9900-EXIT
 12206              END-IF
 12207           END-IF
 12208        ELSE
 12209           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12210           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12211              MOVE ER-2669       TO WS-ERROR
 12212*             PERFORM 9900-ERROR-FORMAT
 12213*                                THRU 9900-EXIT
 12214           ELSE
 12215              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12216                 MOVE ER-1570    TO WS-ERROR
 12217                 PERFORM 9900-ERROR-FORMAT
 12218                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 222
* EL050.cbl
 12219              END-IF
 12220           END-IF
 12221        END-IF
 12222        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12223           AND ZEROS
 12224           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12225           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12226           SET ELAPSED-BETWEEN-BIN TO TRUE
 12227           PERFORM 8500-DATE-CONVERT
 12228                                 THRU 8500-EXIT
 12229           IF NO-CONVERSION-ERROR
 12230              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12231                 MOVE ER-2669       TO WS-ERROR
 12232*                PERFORM 9900-ERROR-FORMAT
 12233*                                THRU 9900-EXIT
 12234              END-IF
 12235           END-IF
 12236        ELSE
 12237           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12238             (PB-I-LF-TERM / 12)
 12239           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12240              MOVE ER-2669       TO WS-ERROR
 12241*             PERFORM 9900-ERROR-FORMAT
 12242*                                THRU 9900-EXIT
 12243           ELSE
 12244              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12245                 MOVE ER-1571    TO WS-ERROR
 12246                 PERFORM 9900-ERROR-FORMAT
 12247                                 THRU 9900-EXIT
 12248              END-IF
 12249           END-IF
 12250        END-IF
 12251        IF WS-ERROR = ER-2669
 12252           PERFORM 9900-ERROR-FORMAT
 12253                                 THRU 9900-EXIT
 12254        END-IF
 12255     END-IF
 12256     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12257        (PB-I-AH-TERM NOT = ZERO) AND
 12258         NOT NO-AH-COVERAGE
 12259          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12260             AND (PB-COMPANY-ID = 'DCC')
 12261             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12262             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12263          ELSE
 12264             IF WS-LF-EARNINGS-CALC = '4'
 12265                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12266                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12267                PB-I-PAY-FREQUENCY
 12268             ELSE
 12269                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12270                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12271             END-IF
 12272          END-IF
 12273          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12274                                         DC-ODD-DAYS-OVER
 12275          MOVE 1                      TO DC-END-OF-MONTH
 12276          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 223
* EL050.cbl
 12277*         MOVE 6                      TO DC-OPTION-CODE
 12278          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12279          IF NO-CONVERSION-ERROR
 12280             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12281     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12282        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12283        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12284        IF PB-I-BIRTHDAY > LOW-VALUES
 12285           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12286           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12287           SET ELAPSED-BETWEEN-BIN TO TRUE
 12288           PERFORM 8500-DATE-CONVERT
 12289                                 THRU 8500-EXIT
 12290           IF NO-CONVERSION-ERROR
 12291              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12292                 MOVE ER-3054       TO WS-ERROR
 12293*                PERFORM 9900-ERROR-FORMAT
 12294*                                THRU 9900-EXIT
 12295              END-IF
 12296           END-IF
 12297        ELSE
 12298           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12299           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12300              MOVE ER-3054       TO WS-ERROR
 12301*             PERFORM 9900-ERROR-FORMAT
 12302*                                THRU 9900-EXIT
 12303           END-IF
 12304        END-IF
 12305        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12306           AND ZEROS
 12307           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12308           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12309           SET ELAPSED-BETWEEN-BIN TO TRUE
 12310           PERFORM 8500-DATE-CONVERT
 12311                                 THRU 8500-EXIT
 12312           IF NO-CONVERSION-ERROR
 12313              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12314                 MOVE ER-3054       TO WS-ERROR
 12315*                PERFORM 9900-ERROR-FORMAT
 12316*                                THRU 9900-EXIT
 12317              END-IF
 12318           END-IF
 12319        ELSE
 12320           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12321             (PB-I-AH-TERM / 12)
 12322           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12323              MOVE ER-3054       TO WS-ERROR
 12324*             PERFORM 9900-ERROR-FORMAT
 12325*                                THRU 9900-EXIT
 12326           END-IF
 12327        END-IF
 12328        IF WS-ERROR = ER-3054
 12329           PERFORM 9900-ERROR-FORMAT
 12330                                 THRU 9900-EXIT
 12331        END-IF
 12332     END-IF
 12333     MOVE SPACE                       TO DC-END-OF-MONTH.
 12334
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 224
* EL050.cbl
 12335     IF PB-COMPANY-ID = 'NCB'
 12336        GO TO 3040-EDIT-EXTENSION-DAYS.
 12337
 12338     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12339       AND
 12340        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12341        NEXT SENTENCE
 12342     ELSE
 12343        GO TO 3040-EDIT-EXTENSION-DAYS.
 12344
 12345     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12346        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12347        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12348     ELSE
 12349        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12350        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12351
 12352     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12353*    MOVE '1'      TO DC-OPTION-CODE
 12354     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12355     IF (NO-CONVERSION-ERROR)
 12356        AND (DC-ELAPSED-MONTHS > +1)
 12357        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12358        MOVE ER-2668   TO WS-ERROR
 12359        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12360
 12361 3040-EDIT-EXTENSION-DAYS.
 12362
 12363     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12364        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12365         GO TO 3050-EDIT-TERM-IN-DAYS
 12366     ELSE
 12367         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12368
 12369     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12370         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12371     ELSE
 12372        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12373           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12374           MOVE ER-2681         TO WS-ERROR
 12375           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12376
 12377     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12378        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12379        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12380         GO TO 3060-ORIG-TERM-CHECK.
 12381
 12382     GO TO 3060-ORIG-TERM-CHECK.
 12383
 12384 3050-EDIT-TERM-IN-DAYS.
 12385
 12386     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12387
 12388     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12389         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12390     ELSE
 12391         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12392            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 225
* EL050.cbl
 12393            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12394
 12395     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12396                                       REMAINDER WS-WORK-TERM.
 12397     IF WS-WORK-TERM GREATER THAN ZERO
 12398         ADD +1 TO PB-I-LF-TERM.
 12399
 12400     IF NOT NO-AH-COVERAGE
 12401         MOVE ER-2684            TO WS-ERROR
 12402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12403
 12404
 12405 3060-ORIG-TERM-CHECK.
 12406
 12407******************************************************************
 12408*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12409******************************************************************
 12410
 12411     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12412        NEXT SENTENCE
 12413     ELSE
 12414        IF NOT NO-LIFE-COVERAGE
 12415           IF PB-I-LF-TERM NUMERIC
 12416              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12417              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12418              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12419                  NEXT SENTENCE
 12420           ELSE
 12421              MOVE ER-2647       TO WS-ERROR
 12422              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12423
 12424     IF NOT NO-AH-COVERAGE
 12425         IF PB-I-AH-TERM NUMERIC
 12426            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12427            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12428            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12429             NEXT SENTENCE
 12430          ELSE
 12431              MOVE ER-2658       TO WS-ERROR
 12432              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12433
 12434     IF PB-COMPANY-ID = 'NCB'
 12435        GO TO 3070-LOAN-TERM-CHECK.
 12436
 12437     IF POLICY-HAS-AH
 12438       AND
 12439        POLICY-HAS-LIFE
 12440       AND
 12441        PB-I-LF-TERM NUMERIC
 12442       AND
 12443        PB-I-AH-TERM NUMERIC
 12444        NEXT SENTENCE
 12445     ELSE
 12446        GO TO 3070-LOAN-TERM-CHECK.
 12447
 12448     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12449     IF WS-TEX-FACT-2 LESS THAN +0
 12450        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 226
* EL050.cbl
 12451
 12452     IF WS-TEX-FACT-2 GREATER THAN +1
 12453        MOVE ER-2668             TO WS-ERROR
 12454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12455
 12456 3070-LOAN-TERM-CHECK.
 12457
 12458     IF (WS-LF-BENEFIT-CD = ZERO)
 12459         OR (NO-LF-BENEFIT-MATCH)
 12460            GO TO 3125-EDIT-PMT-FREQ.
 12461*    IF PB-COMPANY-ID NOT = 'DCC'
 12462*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12463*          AND 'V' AND 'W' AND 'X'
 12464*          GO TO 3125-EDIT-PMT-FREQ
 12465*       END-IF
 12466*    ELSE
 12467*       IF WS-AH-DCC-TRUNC = 'T'
 12468*          CONTINUE
 12469*       ELSE
 12470*          GO TO 3125-EDIT-PMT-FREQ
 12471*       END-IF
 12472*    END-IF
 12473     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12474                    OR
 12475        ((PB-COMPANY-ID = 'DCC')
 12476        AND (WS-AH-DCC-TRUNC = 'T'))
 12477        CONTINUE
 12478     ELSE
 12479        GO TO 3125-EDIT-PMT-FREQ
 12480     END-IF
 12481     IF PB-I-LOAN-TERM NOT NUMERIC
 12482         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12483
 12484     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12485        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12486*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12487        PB-I-LOAN-TERM NOT GREATER THAN +360
 12488         NEXT SENTENCE
 12489     ELSE
 12490         MOVE ER-2648            TO WS-ERROR
 12491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12492
 12493     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12494        MOVE ER-3058             TO WS-ERROR
 12495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12496     end-if
 12497
 12498     IF WS-STATE-ABBREVIATION = 'NC'
 12499        IF PB-I-LOAN-TERM > +59
 12500           CONTINUE
 12501        ELSE
 12502           MOVE ER-2792          TO WS-ERROR
 12503           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12504        END-IF
 12505     END-IF
 12506
 12507     .
 12508 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 227
* EL050.cbl
 12509     IF (WS-LF-BENEFIT-CD = ZERO)
 12510         OR (NO-LF-BENEFIT-MATCH)
 12511            GO TO 3127-EDIT-LOAN-OFFICER.
 12512     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12513                    OR
 12514        ((PB-COMPANY-ID = 'DCC')
 12515        AND (WS-AH-DCC-TRUNC = 'T'))
 12516                    OR
 12517         (PB-COMPANY-ID = 'AHL')
 12518        CONTINUE
 12519     ELSE
 12520        IF (PB-I-LOAN-TERM > ZEROS)
 12521           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12522           MOVE ER-1575          TO WS-ERROR
 12523           PERFORM 9900-ERROR-FORMAT
 12524                                 THRU 9900-EXIT
 12525        END-IF
 12526     END-IF
 12527     IF WS-LF-EARNINGS-CALC NOT = '4'
 12528         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12529            MOVE ER-2653         TO WS-ERROR
 12530            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12531            GO TO 3127-EDIT-LOAN-OFFICER
 12532         ELSE
 12533            GO TO 3127-EDIT-LOAN-OFFICER.
 12534
 12535     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12536         MOVE ER-2655            TO WS-ERROR
 12537         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12538         GO TO 3127-EDIT-LOAN-OFFICER.
 12539
 12540     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12541         MOVE ER-2654            TO WS-ERROR
 12542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12543         GO TO 3127-EDIT-LOAN-OFFICER.
 12544
 12545     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12546         GIVING WS-TEX-FACT-2
 12547             REMAINDER WS-TEX-FACT-3.
 12548
 12549*    IF WS-TEX-FACT-3 NOT = ZERO
 12550*       MOVE ER-2654             TO WS-ERROR
 12551*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12552
 12553
 12554 3127-EDIT-LOAN-OFFICER.
 12555
 12556     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12557        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12558           MOVE ER-2690          TO WS-ERROR
 12559           PERFORM 9900-ERROR-FORMAT
 12560                                 THRU 9900-EXIT
 12561        ELSE
 12562           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12563           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12564           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12565           MOVE PB-SV-STATE      TO LOFC-STATE
 12566           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 228
* EL050.cbl
 12567           MOVE PB-I-LOAN-OFFICER
 12568                                 TO LOFC-CODE
 12569           PERFORM 8586-READ-LOAN-OFFICER
 12570                                 THRU 8586-EXIT
 12571           IF (NOT LOFC-MASTER-FOUND)
 12572              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12573              MOVE ER-3006       TO WS-ERROR
 12574              PERFORM 9900-ERROR-FORMAT
 12575                                 THRU 9900-EXIT
 12576           END-IF
 12577        END-IF
 12578     END-IF
 12579     .
 12580 3129-EDIT-APR.
 12581
 12582     IF (WS-LF-BENEFIT-CD = ZERO)
 12583        OR (NO-LF-BENEFIT-MATCH)
 12584        IF PB-COMPANY-ID NOT = 'DCC'
 12585           GO TO 3130-EDIT-AGE
 12586*       ELSE
 12587*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12588*             GO TO 3130-EDIT-AGE
 12589*          END-IF
 12590        END-IF
 12591     END-IF
 12592
 12593     IF (WS-STATE-ABBREVIATION = 'OH')
 12594         AND (PB-I-RATE-CLASS NOT = 'L ')
 12595         AND (PB-I-LF-TERM GREATER THAN 60)
 12596         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12597         GO TO 3129-APR-CONT.
 12598
 12599     IF (WS-STATE-ABBREVIATION = 'RI')
 12600         AND (PB-I-LF-TERM GREATER THAN 60)
 12601         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12602         GO TO 3129-APR-CONT.
 12603
 12604     IF (WS-STATE-ABBREVIATION = 'UT')
 12605         AND (PB-I-LF-TERM GREATER THAN 62)
 12606         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12607         AND (PB-CERT-EFF-DT LESS WS-830901)
 12608         GO TO 3129-APR-CONT.
 12609
 12610     IF PB-COMPANY-ID = 'LAP'
 12611        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12612           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12613              MOVE ER-2656         TO WS-ERROR
 12614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12615              GO TO 3130-EDIT-AGE.
 12616
 12617     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12618        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12619        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12620        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12621        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12622        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12623         GO TO 3130-EDIT-AGE.
 12624
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 229
* EL050.cbl
 12625 3129-APR-CONT.
 12626     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12627         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12628         GO TO 3130-EDIT-AGE.
 12629
 12630     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12631         WS-AH-BENEFIT-CD (1:1) = 'S')
 12632        AND (PB-COMPANY-ID = 'DCC')
 12633        AND (PB-I-LOAN-APR = ZERO)
 12634        MOVE ER-2657             TO WS-ERROR
 12635        PERFORM 9900-ERROR-FORMAT
 12636                                 THRU 9900-EXIT
 12637        GO TO 3130-EDIT-AGE
 12638     END-IF
 12639*    IF PB-I-LOAN-APR = ZERO
 12640*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12641*    END-IF
 12642
 12643     if pb-i-loan-apr = +99.9999
 12644        move er-2656             to ws-error
 12645        PERFORM 9900-ERROR-FORMAT
 12646                                 THRU 9900-EXIT
 12647        GO TO 3130-EDIT-AGE
 12648     end-if
 12649*    IF PB-I-LOAN-APR = ZERO
 12650*       MOVE ER-2656             TO WS-ERROR
 12651*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12652*       GO TO 3130-EDIT-AGE.
 12653
 12654*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12655     if pb-i-loan-apr not = +99.9999
 12656        IF PB-I-LOAN-APR > +30.000
 12657           MOVE ER-2657          TO WS-ERROR
 12658           PERFORM 9900-ERROR-FORMAT
 12659                                 THRU 9900-EXIT
 12660        end-if
 12661     end-if
 12662     .
 12663 3130-EDIT-AGE.
 12664
 12665******************************************************************
 12666*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12667******************************************************************
 12668
 12669     IF NOT NO-LIFE-COVERAGE
 12670        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12671           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12672               MOVE ER-2628             TO WS-ERROR
 12673               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12674
 12675     IF NOT NO-AH-COVERAGE
 12676        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12677           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12678               MOVE ER-2628         TO WS-ERROR
 12679               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12680
 12681 3133-SEX-CODE.
 12682     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 230
* EL050.cbl
 12683         IF WS-DEFAULT-SEX = 'M'
 12684             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12685          ELSE
 12686             IF WS-DEFAULT-SEX = 'F'
 12687             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12688
 12689     IF PB-I-INSURED-SEX = '1'
 12690         MOVE 'M' TO PB-I-INSURED-SEX.
 12691
 12692     IF PB-I-INSURED-SEX = '2'
 12693         MOVE 'F' TO PB-I-INSURED-SEX.
 12694
 12695 3134-SIG-SW-EDIT.
 12696     IF PB-I-SIG-SW = SPACE
 12697         MOVE 'N'                TO  PB-I-SIG-SW.
 12698
 12699     IF PB-COMPANY-ID = 'NCL'
 12700         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12701             NEXT SENTENCE
 12702         ELSE
 12703             MOVE ER-1923        TO  WS-ERROR
 12704             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12705     ELSE
 12706     IF PB-COMPANY-ID = 'CRI'
 12707         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12708             NEXT SENTENCE
 12709         ELSE
 12710             MOVE ER-2606        TO  WS-ERROR
 12711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12712     ELSE
 12713     IF PB-COMPANY-ID = 'TMS'
 12714         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12715             NEXT SENTENCE
 12716         ELSE
 12717             MOVE ER-2689        TO  WS-ERROR
 12718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12719     ELSE
 12720         IF PB-I-SIG-SW = 'Y' OR 'N'
 12721             NEXT SENTENCE
 12722         ELSE
 12723             MOVE ER-2651        TO  WS-ERROR
 12724             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12725
 12726     IF PB-COMPANY-ID = 'FLA'
 12727         IF (WS-EDIT-AGE GREATER 54  OR
 12728             WS-AH-EDIT-AGE GREATER 54)  AND
 12729            PB-I-SIG-SW = 'N'
 12730            MOVE ER-2651         TO  WS-ERROR
 12731            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12732
 12733 3135-NAME-EDIT.
 12734
 12735     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12736        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12737        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12738           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12739                                 TO PB-I-JOINT-FIRST-NAME
 12740        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 231
* EL050.cbl
 12741     END-IF
 12742     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12743        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12744        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12745           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12746                                 TO PB-I-JOINT-LAST-NAME
 12747        END-PERFORM
 12748     END-IF
 12749     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12750        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12751        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12752           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12753                                 TO PB-I-INSURED-FIRST-NAME
 12754        END-PERFORM
 12755     END-IF
 12756     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12757        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12758        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12759           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12760                                 TO PB-I-INSURED-LAST-NAME
 12761        END-PERFORM
 12762     END-IF
 12763     IF PB-I-INSURED-LAST-NAME = SPACES
 12764       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12765       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12766           MOVE ER-2660    TO WS-ERROR
 12767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12768
 12769 3136-EDIT-SEX.
 12770
 12771******************************************************************
 12772*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12773******************************************************************
 12774
 12775     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12776        (WS-AH-SPECIAL-CALC-CD = 'O')
 12777        NEXT SENTENCE
 12778     ELSE
 12779        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12780           NEXT SENTENCE
 12781        ELSE
 12782           MOVE ER-2629            TO WS-ERROR
 12783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12784
 12785 3137-EDIT-EFF-DATE.
 12786
 12787     IF PB-REISSUED-CERT       OR
 12788        PB-POLICY-IS-DECLINED  OR
 12789        PB-POLICY-IS-VOIDED
 12790         GO TO 3139-EDIT-COVERAGE-CODES.
 12791
 12792     MOVE SPACE                  TO WS-2671-SW
 12793                                    WS-2672-SW.
 12794
 12795     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12796         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12797             MOVE ER-2703        TO WS-ERROR
 12798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 232
* EL050.cbl
 12799             GO TO 3139-EDIT-COVERAGE-CODES.
 12800
 12801     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12802         GO TO 3139-EDIT-COVERAGE-CODES.
 12803
 12804     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12805     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12806*    MOVE '1'                    TO DC-OPTION-CODE.
 12807     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12808     MOVE +0                     TO DC-ELAPSED-MONTHS
 12809                                    DC-ELAPSED-DAYS.
 12810     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12811
 12812     IF DATE-CONVERSION-ERROR
 12813         GO TO 3139-EDIT-COVERAGE-CODES.
 12814
 12815     IF DC-ELAPSED-DAYS GREATER +180
 12816         MOVE ER-2672            TO WS-ERROR
 12817         MOVE 'Y'                TO WS-2672-SW
 12818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12819     END-IF
 12820
 12821     IF WS-ERROR = ER-2671  AND
 12822        PB-COMPANY-ID  = 'LBL'
 12823        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12824        MOVE SPACE               TO WS-2671-SW
 12825        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12826
 12827     IF PB-ISSUE-DATE-FORCED  AND
 12828      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12829         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12830         MOVE ER-2673            TO WS-ERROR
 12831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12832         MOVE SPACE              TO WS-2671-SW
 12833                                    WS-2672-SW.
 12834
 12835     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12836         IF PB-ISSUE-DATE-FORCED
 12837             MOVE ER-2600          TO  WS-ERROR
 12838             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12839         ELSE
 12840             MOVE ER-2692          TO  WS-ERROR
 12841             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12842
 12843
 12844 3139-EDIT-COVERAGE-CODES.
 12845
 12846     if pb-company-id not = 'AHL'
 12847        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12848           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12849           MOVE ER-2787          TO WS-ERROR
 12850           PERFORM 9900-ERROR-FORMAT
 12851                                 THRU 9900-EXIT
 12852        END-IF
 12853     end-if
 12854     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12855        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12856                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 233
* EL050.cbl
 12857           MOVE ER-2719          TO WS-ERROR
 12858           PERFORM 9900-ERROR-FORMAT
 12859                                 THRU 9900-EXIT
 12860        END-IF
 12861     END-IF
 12862
 12863     IF PB-POLICY-IS-DECLINED  OR
 12864        PB-POLICY-IS-VOIDED
 12865         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12866
 12867     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12868        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12869         MOVE ER-2630                TO WS-ERROR
 12870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12871
 12872     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12873        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12874        PB-I-LF-PREMIUM-AMT = ZERO
 12875         GO TO 3140-CHECK-AH-FOR-ZERO.
 12876
 12877     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12878        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12879        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12880         GO TO 3140-CHECK-AH-FOR-ZERO.
 12881
 12882     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12883        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12884        MOVE ER-2631             TO WS-ERROR
 12885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12886     END-IF
 12887
 12888
 12889******************************************************************
 12890*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12891******************************************************************
 12892
 12893     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12894        NEXT SENTENCE
 12895     ELSE
 12896        IF PB-I-LF-BENEFIT-AMT = ZERO
 12897           MOVE ER-2632             TO WS-ERROR
 12898           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12899
 12900
 12901******************************************************************
 12902*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12903******************************************************************
 12904
 12905     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12906        CONTINUE
 12907     ELSE
 12908        IF PB-I-LF-PREMIUM-AMT = ZERO
 12909           IF (NOT PB-COMP-LF-PREM)
 12910              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12911              and (ws-lf-ben-category not = 'C')
 12912              MOVE ER-2633       TO WS-ERROR
 12913              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12914           END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 234
* EL050.cbl
 12915        END-IF
 12916     END-IF
 12917     .
 12918 3140-CHECK-AH-FOR-ZERO.
 12919
 12920     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12921        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12922        PB-I-AH-PREMIUM-AMT = ZERO
 12923         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12924
 12925     IF PB-COMPANY-ID = 'CSL'  AND
 12926        PB-I-AH-BENEFIT-CD = ZERO  AND
 12927        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12928        PB-I-AH-PREMIUM-AMT = ZERO
 12929         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12930
 12931     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12932        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12933        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12934         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12935
 12936     IF PB-I-AH-BENEFIT-CD = ZERO
 12937         MOVE ER-2634            TO WS-ERROR
 12938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12939
 12940******************************************************************
 12941*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12942******************************************************************
 12943
 12944     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12945        NEXT SENTENCE
 12946     ELSE
 12947        IF PB-I-AH-BENEFIT-AMT = ZERO
 12948           MOVE ER-2635             TO WS-ERROR
 12949           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12950
 12951******************************************************************
 12952*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12953******************************************************************
 12954
 12955     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12956        NEXT SENTENCE
 12957     ELSE
 12958        IF PB-I-AH-PREMIUM-AMT = ZERO
 12959            IF NOT PB-COMP-AH-PREM
 12960                MOVE ER-2636    TO WS-ERROR
 12961                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12962
 12963
 12964 3140-EDIT-MAX-AMT-SIZES.
 12965* CUSTOM CODE FOR CLIENT    'DMD'
 12966     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12967                                     WS-RES-MUNI-TAX
 12968                                     PB-I-STATE-TAX
 12969                                     PB-I-MUNI-TAX.
 12970
 12971     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12972
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 235
* EL050.cbl
 12973     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12974        GO TO 3150-RATE-OUTSTAND-BAL.
 12975
 12976     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12977        GO TO 3150-RATE-OUTSTAND-BAL.
 12978
 12979     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12980        GO TO 3150-RATE-OUTSTAND-BAL.
 12981
 12982     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12983                             OR 'RIC')
 12984        GO TO 3150-RATE-OUTSTAND-BAL.
 12985
 12986     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12987        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12988            GO TO 3150-RATE-OUTSTAND-BAL
 12989        ELSE
 12990           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12991               GO TO 3150-RATE-OUTSTAND-BAL.
 12992
 12993     IF NOT PB-NO-MONTHS-SKIPPED
 12994        GO TO 3150-RATE-OUTSTAND-BAL.
 12995
 12996     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12997        GO TO 3150-RATE-OUTSTAND-BAL.
 12998
 12999     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13000        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13001           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13002             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13003           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13004           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13005              MOVE ER-2693     TO WS-ERROR
 13006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13007              GO TO 3150-RATE-OUTSTAND-BAL
 13008           ELSE
 13009              GO TO 3150-RATE-OUTSTAND-BAL.
 13010
 13011 3150-RATE-OUTSTAND-BAL.
 13012
 13013* DMD RATING TEST
 13014     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13015         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13016         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13017         MOVE ER-2687                 TO WS-ERROR
 13018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13019         MOVE 'B'                     TO PB-I-OB-FLAG
 13020         GO TO 3260-EDIT-CONTINUE.
 13021
 13022     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13023         IF  WS-ERROR    EQUAL    ER-2693
 13024             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13025                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13026                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13027                 MOVE  +0            TO  WS-ERROR.
 13028
 13029     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13030         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 236
* EL050.cbl
 13031             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13032                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13033                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13034                 MOVE  +0            TO  WS-ERROR.
 13035
 13036     IF PLAN-MASTER-AH-SW = 'Y'
 13037        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13038            IF  WS-ERROR    EQUAL    ER-2693
 13039              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13040                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13041                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13042                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13043                 MOVE  ER-1910           TO  WS-ERROR
 13044                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13045
 13046     IF PLAN-MASTER-AH-SW = 'Y'
 13047        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13048            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13049               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13050               MOVE  ER-1910           TO  WS-ERROR
 13051               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13052
 13053     IF PLAN-MASTER-AH-SW = 'Y'
 13054        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13055            IF  WS-ERROR    EQUAL    ER-2693
 13056                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13057                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13058                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13059                 MOVE  +0       TO  WS-ERROR.
 13060
 13061     IF WS-ERROR = ER-2693
 13062        IF PB-COMPANY-ID = 'JAL' AND
 13063           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13064           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13065           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13066
 13067     IF WS-ERROR = ER-2693
 13068        IF PB-COMPANY-ID = 'NCL'  AND
 13069           PB-I-AH-BENEFIT-CD = 'OA'
 13070           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13071           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13072
 13073     IF WS-ERROR = ER-2693
 13074        IF PB-COMPANY-ID = 'CNL' AND
 13075           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13076           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13077           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13078
 13079     IF WS-ERROR = ER-2693
 13080        IF PB-COMPANY-ID = 'HER'
 13081           IF WS-LEVEL
 13082              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13083              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13084
 13085     IF ((LF-BENEFIT-FOUND) AND
 13086         (NOT NO-LIFE-COVERAGE)  AND
 13087         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13088       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 237
* EL050.cbl
 13089             (NOT NO-AH-COVERAGE)    AND
 13090             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13091         NEXT SENTENCE
 13092     ELSE
 13093         GO TO 3215-EDIT-RATES.
 13094
 13095     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13096        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13097           MOVE ER-2674          TO WS-ERROR
 13098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099           GO TO 3215-EDIT-RATES.
 13100
 13101     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13102        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13103           MOVE ER-2674          TO WS-ERROR
 13104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13105           GO TO 3215-EDIT-RATES.
 13106
 13107     MOVE 'B'                    TO PB-I-OB-FLAG.
 13108
 13109     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13110         NEXT SENTENCE
 13111     ELSE
 13112         IF NOT NO-LIFE-COVERAGE
 13113             IF WS-ACCT-LF-OB-RT = ZERO
 13114                MOVE ER-2641    TO WS-ERROR
 13115                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13116
 13117     IF PB-COMPANY-ID = 'CRI'
 13118       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13119         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13120         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13121         IF WS-ERROR = ER-2675
 13122            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13123            MOVE ER-2687              TO WS-ERROR
 13124            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13125         ELSE
 13126            MOVE ER-2687              TO WS-ERROR
 13127            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13128
 13129
 13130     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13131         NEXT SENTENCE
 13132     ELSE
 13133       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13134            NEXT SENTENCE
 13135       ELSE
 13136         IF NOT NO-AH-COVERAGE
 13137             IF WS-ACCT-AH-OB-RT = ZERO
 13138                MOVE ER-2642    TO WS-ERROR
 13139                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13140
 13141     IF PB-COMPANY-ID = 'CRI'
 13142       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13143         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13144         IF WS-ERROR = ER-2676
 13145            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13146            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 238
* EL050.cbl
 13147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13148         ELSE
 13149            MOVE ER-2687              TO WS-ERROR
 13150            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13151
 13152     IF PB-COMPANY-ID NOT = 'GIC'
 13153         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13154            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13155     ELSE
 13156         IF PB-I-LF-PREM-CALC = ZEROS
 13157             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13158                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13159
 13160     IF PB-COMPANY-ID NOT = 'GIC'
 13161         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13162            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13163     ELSE
 13164         IF PB-I-AH-PREM-CALC = ZEROS
 13165             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13166                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13167
 13168     MOVE ZEROS TO PB-I-MORT-CODE.
 13169
 13170     GO TO 3260-EDIT-CONTINUE.
 13171
 13172
 13173 3215-EDIT-RATES.
 13174     IF ACCOUNT-MAST-FOUND
 13175         NEXT SENTENCE
 13176     ELSE
 13177         GO TO 3999-END-EDIT.
 13178
 13179 3220-CHECK-LF-RATES.
 13180
 13181     IF PB-COMPANY-ID = 'DCC'
 13182        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13183        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13184        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13185           AND (NOT WS-LF-CASH))
 13186                           OR
 13187           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13188           AND (NOT WS-AH-CASH)))
 13189                       AND
 13190           (PB-I-ENTRY-STATUS NOT = '5')
 13191           MOVE 'M'              TO PB-BATCH-ENTRY
 13192                                    PB-I-ENTRY-STATUS
 13193        END-IF
 13194     END-IF
 13195     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13196                                    PB-I-AH-PREM-CALC
 13197                                    PB-I-LF-ALT-PREM-CALC
 13198                                    PB-I-LF-ALT-RATE
 13199                                    PB-I-LF-REI-RATE
 13200                                    PB-I-LF-ALT-REI-RATE
 13201                                    PB-I-AH-REI-RATE
 13202                                    PB-I-TOT-FEES-CALC.
 13203
 13204     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 239
* EL050.cbl
 13205        NEXT SENTENCE
 13206     ELSE
 13207        MOVE ZEROS               TO PB-I-LF-RATE
 13208                                    PB-I-AH-RATE.
 13209
 13210     IF PB-I-TOT-FEES NOT NUMERIC
 13211        MOVE ZEROS               TO PB-I-TOT-FEES
 13212     END-IF
 13213     IF PB-I-LIVES NOT NUMERIC
 13214         MOVE ZERO               TO PB-I-LIVES.
 13215
 13216     IF PB-I-NUM-BILLED NOT NUMERIC
 13217         MOVE ZERO               TO PB-I-NUM-BILLED.
 13218
 13219     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13220        MOVE +0                  TO PB-I-LF-PREM-TAX
 13221     END-IF
 13222
 13223     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13224        MOVE +0                  TO PB-I-AH-PREM-TAX
 13225     END-IF
 13226
 13227     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13228        PB-I-PAY-FREQUENCY = ZEROS
 13229            MOVE 12 TO CP-PAY-FREQUENCY
 13230     ELSE
 13231            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13232
 13233     IF PB-I-STATE-TAX NOT NUMERIC
 13234         MOVE ZEROS               TO PB-I-STATE-TAX.
 13235
 13236     IF PB-I-MUNI-TAX NOT NUMERIC
 13237         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13238
 13239     MOVE SPACES                 TO CP-BEN-CATEGORY
 13240     IF PB-COMPANY-ID  = 'CSL'  AND
 13241        PB-I-LF-TERM NOT = ZERO
 13242        COMPUTE WS-PAYMENT-AMT =
 13243             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13244        COMPUTE WS-CSL-AMT1 =
 13245             PB-I-LF-TERM * AM-MAX-MON-BEN
 13246        COMPUTE WS-CSL-AMT2 =
 13247             WS-PAYMENT-AMT * PB-I-LF-TERM
 13248        IF CP-PAY-FREQUENCY NOT = 12
 13249           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13250           MOVE '8' TO WS-CSL-CALC-CD
 13251        ELSE
 13252           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13253              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13254               AM-MAX-TOT-BEN
 13255               MOVE '6' TO WS-CSL-CALC-CD
 13256           ELSE
 13257              IF (WS-CSL-AMT1  GREATER THAN
 13258                 AM-MAX-TOT-BEN) AND
 13259                 (WS-CSL-AMT2  GREATER THAN
 13260                 AM-MAX-TOT-BEN)
 13261                 MOVE '7' TO WS-CSL-CALC-CD
 13262              ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 240
* EL050.cbl
 13263                 MOVE '5' TO WS-CSL-CALC-CD.
 13264
 13265     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13266         NEXT SENTENCE
 13267     ELSE
 13268         GO TO 3300-CHECK-AH-RATES.
 13269
 13270*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13271
 13272     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13273        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13274              OR
 13275           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13276           MOVE ER-2618          TO WS-ERROR
 13277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13278           GO TO 3300-CHECK-AH-RATES.
 13279
 13280     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13281           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13282                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13283
 13284     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13285         MOVE ER-2687             TO WS-ERROR
 13286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13287         MOVE 'Z000'              TO PB-I-MORT-CODE
 13288         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13289         GO TO 3300-CHECK-AH-RATES.
 13290
 13291     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13292        IF PB-I-LIVES = ZERO
 13293           MOVE ER-2688          TO WS-ERROR
 13294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13295
 13296     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13297
 13298     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13299     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13300     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13301     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13302     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13303     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13304     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13305     MOVE '3'                    TO CP-PROCESS-TYPE.
 13306     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13307     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13308
 13309******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13310     IF PB-COMPANY-ID EQUAL 'CDL'
 13311         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13312            CP-EARN-AS-NET-PAY)
 13313             IF PB-CERT-EFF-DT GREATER  WS-931231
 13314                 MOVE '1'        TO CP-EARNING-METHOD.
 13315*******
 13316
 13317     MOVE PB-SV-STATE            TO CP-STATE.
 13318     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13319     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13320     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 241
* EL050.cbl
 13321     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13322     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13323                                    CP-RATING-BENEFIT-AMT.
 13324     IF CP-STATE-STD-ABBRV = 'OR'
 13325         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13326                                         PB-I-LF-ALT-BENEFIT-AMT.
 13327     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13328     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13329     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13330     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13331     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13332     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13333     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13334     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13335     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13336                                    CP-REMAINING-TERM
 13337                                    CP-LOAN-TERM.
 13338
 13339     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13340         NEXT SENTENCE
 13341     ELSE
 13342         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13343             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13344                                           PB-I-LF-PREMIUM-AMT.
 13345
 13346     IF PB-COMPANY-ID EQUAL 'CSL'
 13347        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13348           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13349                                         PB-I-LF-PREMIUM-AMT.
 13350
 13351     IF PB-COMPANY-ID EQUAL 'NCB'
 13352         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13353            CP-EARN-AS-NET-PAY
 13354             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13355                 PB-I-LF-PREMIUM-AMT.
 13356
 13357     IF (CP-TRUNCATED-LIFE)
 13358        or ((pb-company-id = 'AHL')
 13359           and (pb-i-loan-term > pb-i-lf-term))
 13360        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13361
 13362     IF PB-COMPANY-ID EQUAL 'CRI'
 13363        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13364
 13365     IF CP-TERM-IS-DAYS
 13366         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13367     ELSE
 13368         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13369     IF PB-COMPANY-ID = 'DCC'
 13370        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13371        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13372        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13373        IF WS-LF-BEN-CATEGORY = 'D'
 13374           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13375           MOVE PB-I-LIFE-COMMISSION
 13376                                 TO CP-DCC-ACT-COMM
 13377           MOVE WS-LF-BEN-CATEGORY
 13378                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 242
* EL050.cbl
 13379        END-IF
 13380        IF (CP-BENEFIT-CD (1:1) = 'P')
 13381           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13382           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13383           add pb-i-ah-premium-amt to cp-original-premium
 13384        END-IF
 13385     END-IF
 13386     IF PB-COMPANY-ID = 'CSL'
 13387         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13388         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13389         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13390
 13391     IF PB-COMPANY-ID = 'CSL'
 13392        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13393
 13394     IF (CP-SPECIAL-CALC-CD = 'H')
 13395        OR (PB-COMPANY-ID = 'DCC')
 13396         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13397                                    TO CP-ALTERNATE-BENEFIT
 13398         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13399     if (pb-company-id = 'CID')
 13400        and (ws-lf-earnings-calc = '4')
 13401        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13402        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13403        move pb-i-term-type      to cp-pmt-mode
 13404        move pb-i-no-of-payments to cp-no-of-pmts
 13405     end-if
 13406     IF (PB-COMPANY-ID = 'CID')
 13407        AND (WS-LF-EARNINGS-CALC = 'B')
 13408        AND (CP-STATE-STD-ABBRV = 'MN')
 13409        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13410                                 TO CP-ALTERNATE-BENEFIT
 13411        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13412     END-IF
 13413     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13414     MOVE 'R'                   TO CP-RATE-FILE.
 13415     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13416
 13417     IF CP-ERROR-RATE-NOT-FOUND
 13418        MOVE ER-2641            TO WS-ERROR
 13419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13420        GO TO 3300-CHECK-AH-RATES.
 13421
 13422     IF PB-COMPANY-ID EQUAL 'CRI'
 13423        IF CP-ERROR-NO-LIMITS-CRI
 13424           IF NOT ACCOUNT-LIFE-CHECKED
 13425              MOVE ER-2607      TO WS-ERROR
 13426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13427
 13428******************************************************************
 13429*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13430*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13431******************************************************************
 13432
 13433* CALC LIFE AGE AT EXPIRATION.
 13434
 13435     COMPUTE WS-AGE-AT-EXPIRE =
 13436          ((PB-I-LF-TERM / 12) + PB-I-AGE).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 243
* EL050.cbl
 13437
 13438*    IF PB-STATE = 'CO' OR 'UT'
 13439*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13440*        MOVE 'F'            TO PB-FATAL-FLAG
 13441*        MOVE ER-2709        TO WS-ERROR
 13442*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13443*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13444
 13445*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13446*        MOVE 'X'            TO PB-FATAL-FLAG
 13447*        MOVE ER-2718        TO WS-ERROR
 13448*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13449*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13450
 13451* CALC A & H AGE AT EXPIRATION.
 13452
 13453     COMPUTE WS-AGE-AT-EXPIRE =
 13454          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13455
 13456*    IF PB-STATE = 'CO' OR 'UT'
 13457*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13458*        MOVE 'F'            TO PB-FATAL-FLAG
 13459*        MOVE ER-2709        TO WS-ERROR
 13460*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13461*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13462
 13463*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13464*        MOVE 'X'            TO PB-FATAL-FLAG
 13465*        MOVE ER-2718        TO WS-ERROR
 13466*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13467*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13468
 13469     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13470        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13471
 13472     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13473        and (not pb-monthly-cert)
 13474        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13475     end-if
 13476
 13477     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13478        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13479
 13480     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13481         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13482         MOVE ER-2639        TO WS-ERROR
 13483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13484
 13485
 13486******************************************************************
 13487*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13488******************************************************************
 13489
 13490 PREMIUM-EDITING-IS-BYPASSED.
 13491     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13492        AND (CP-R-MAX-ATT-AGE > +0)
 13493        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13494        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 244
* EL050.cbl
 13495           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13496           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13497           MOVE '1'              TO DC-OPTION-CODE
 13498           PERFORM 8500-DATE-CONVERT
 13499                                 THRU 8500-EXIT
 13500           IF NO-CONVERSION-ERROR
 13501              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13502                 MOVE ER-2661       TO WS-ERROR
 13503*                PERFORM 9900-ERROR-FORMAT
 13504*                                THRU 9900-EXIT
 13505              END-IF
 13506           END-IF
 13507        ELSE
 13508           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13509           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13510              MOVE ER-2661       TO WS-ERROR
 13511*             PERFORM 9900-ERROR-FORMAT
 13512*                                THRU 9900-EXIT
 13513           ELSE
 13514              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13515                 MOVE ER-1570    TO WS-ERROR
 13516                 PERFORM 9900-ERROR-FORMAT
 13517                                 THRU 9900-EXIT
 13518              END-IF
 13519           END-IF
 13520        END-IF
 13521        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13522           MOVE PB-I-JOINT-BIRTHDAY
 13523                                 TO DC-BIN-DATE-1
 13524           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13525           MOVE '1'              TO DC-OPTION-CODE
 13526           PERFORM 8500-DATE-CONVERT
 13527                                 THRU 8500-EXIT
 13528           IF NO-CONVERSION-ERROR
 13529              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13530                 MOVE ER-2661       TO WS-ERROR
 13531*                PERFORM 9900-ERROR-FORMAT
 13532*                                THRU 9900-EXIT
 13533              END-IF
 13534           ELSE
 13535              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13536           END-IF
 13537        ELSE
 13538           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13539             (PB-I-LF-TERM / 12)
 13540           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13541              MOVE ER-2661       TO WS-ERROR
 13542*             PERFORM 9900-ERROR-FORMAT
 13543*                                THRU 9900-EXIT
 13544           ELSE
 13545              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13546                 MOVE ER-1571    TO WS-ERROR
 13547                 PERFORM 9900-ERROR-FORMAT
 13548                                 THRU 9900-EXIT
 13549              END-IF
 13550           END-IF
 13551        END-IF
 13552        IF WS-ERROR = ER-2661
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 245
* EL050.cbl
 13553           PERFORM 9900-ERROR-FORMAT
 13554                                 THRU 9900-EXIT
 13555        END-IF
 13556     END-IF
 13557*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13558*       MOVE ER-2661             TO WS-ERROR
 13559*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13560
 13561     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13562        MOVE ER-2662             TO WS-ERROR
 13563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13564
 13565     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13566        MOVE ER-2677             TO WS-ERROR
 13567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13568
 13569     IF CP-ERROR-LOAN-TERM
 13570        MOVE ER-2648             TO WS-ERROR
 13571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13572
 13573 3221-CHECK-ERROR-RATE-OPEN.
 13574
 13575     IF CP-ERROR-RATE-FILE-NOTOPEN
 13576         GO TO 3990-FILES-NOT-OPEN.
 13577
 13578     IF PB-COMPANY-ID NOT = 'DMD'
 13579        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13580     END-IF
 13581     .
 13582 3221-CONTINUE.
 13583     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13584                                    WS-DCC-AH-RATE
 13585     IF PB-COMPANY-ID = 'DCC'
 13586        IF WS-LF-BEN-CATEGORY = 'D'
 13587           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13588              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13589        END-IF
 13590     END-IF
 13591     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13592*   X'A4FF' = 12/31/2009
 13593     IF (PB-COMPANY-ID = 'CID')
 13594        AND (WS-LF-EARNINGS-CALC = 'B')
 13595        AND (CP-STATE-STD-ABBRV = 'MN')
 13596        AND (PB-CERT-EFF-DT > X'A4FF')
 13597        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13598     END-IF
 13599     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13600
 13601     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13602     IF (PB-COMPANY-ID = 'DCC')
 13603        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13604        AND (PB-I-POLICY-IS-MONTHLY)
 13605        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13606        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13607     END-IF
 13608     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13609     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13610     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 246
* EL050.cbl
 13611     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13612     IF (PB-COMPANY-ID = 'DCC')
 13613        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13614        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13615        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13616        MOVE ER-2786             TO WS-ERROR
 13617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13618     END-IF
 13619
 13620     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13621
 13622******************************************************************
 13623*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13624******************************************************************
 13625     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13626        and ((not pb-monthly-cert)
 13627        or (ws-lf-ben-category = 'C'))
 13628        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13629
 13630     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13631        GO TO 3225-CHECK-ALT-LIFE-RATE
 13632     ELSE
 13633       IF PB-I-LF-RATE = ZERO
 13634          MOVE ER-2641          TO WS-ERROR
 13635          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13636
 13637 3225-CHECK-ALT-LIFE-RATE.
 13638
 13639     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13640        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13641        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13642         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13643
 13644     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13645         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13646             AND PB-COMPANY-ID NOT = 'DCC')
 13647                   OR
 13648              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13649              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13650              AND PB-COMPANY-ID NOT = 'DCC')
 13651             MOVE ER-2720        TO  WS-ERROR
 13652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13653             GO TO 3225-RATING-CONT
 13654         ELSE
 13655             GO TO 3225-RATING-CONT.
 13656     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13657        AND (AM-GPCD = 01 OR 06 OR 15)
 13658        MOVE ER-2798             TO WS-ERROR
 13659        PERFORM 9900-ERROR-FORMAT
 13660                                 THRU 9900-EXIT
 13661*       GO TO 3225-RATING-CONT
 13662     END-IF
 13663     IF (PB-COMPANY-ID = 'CID')
 13664        AND (WS-LF-EARNINGS-CALC = 'B')
 13665        AND (CP-STATE-STD-ABBRV = 'MN')
 13666        AND (PB-CERT-EFF-DT > X'A4FF')
 13667        GO TO 3225-RATING-CONT
 13668     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 247
* EL050.cbl
 13669     IF PB-COMPANY-ID = 'DCC'
 13670        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13671           AND (PB-I-POLICY-IS-MONTHLY)
 13672           GO TO 3225-RATING-CONT
 13673        END-IF
 13674     END-IF
 13675
 13676     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13677        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13678        CP-EARN-AS-REG-BALLOON
 13679        NEXT SENTENCE
 13680     ELSE
 13681        MOVE '2'                 TO CP-EARNING-METHOD.
 13682
 13683 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13684
 13685     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13686
 13687     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13688        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13689        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13690         NEXT SENTENCE
 13691     ELSE
 13692         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13693
 13694     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13695     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13696     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13697                                     CP-RATING-BENEFIT-AMT.
 13698     IF CP-STATE-STD-ABBRV = 'OR'
 13699         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13700                                         PB-I-LF-ALT-BENEFIT-AMT.
 13701     IF PB-COMPANY-ID = 'DCC'
 13702        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13703     END-IF
 13704     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13705     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13706     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13707                                    CP-REMAINING-TERM
 13708                                    CP-LOAN-TERM.
 13709     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13710        ADD +1                   TO CP-ORIGINAL-TERM
 13711                                    CP-REMAINING-TERM
 13712                                    CP-LOAN-TERM.
 13713
 13714     MOVE 'R'                   TO CP-RATE-FILE.
 13715     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13716
 13717     IF CP-ERROR-RATE-NOT-FOUND
 13718         MOVE ER-2641            TO WS-ERROR
 13719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13720         GO TO 3300-CHECK-AH-RATES.
 13721
 13722     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13723     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13724
 13725     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13726         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 248
* EL050.cbl
 13727
 13728     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13729                               + PB-I-LF-ALT-BENEFIT-AMT.
 13730
 13731     IF ACCOUNT-LIFE-CHECKED  OR
 13732        PB-POLICY-IS-VOIDED   OR
 13733        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13734        and (not pb-monthly-cert))
 13735        GO TO 3225-CONTINUE.
 13736
 13737     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13738        GO TO 3225-CONTINUE.
 13739
 13740     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13741                             EC-RT-LF-MAX-TOT-BEN
 13742        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13743        MOVE ER-2639       TO WS-ERROR
 13744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13745
 13746 3225-CONTINUE.
 13747     IF PB-I-LF-ALT-RATE = ZERO
 13748         MOVE ER-2659            TO WS-ERROR
 13749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13750
 13751     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13752        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13753        MOVE ER-2698             TO WS-ERROR
 13754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13755
 13756 3225-RATING-CONT.
 13757
 13758     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13759        and (not pb-monthly-cert)
 13760         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13761         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13762         IF (PB-COMPANY-ID = 'DCC')
 13763            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13764            CONTINUE
 13765         ELSE
 13766            MOVE ER-2687         TO WS-ERROR
 13767            PERFORM 9900-ERROR-FORMAT
 13768                                 THRU 9900-EXIT
 13769         END-IF
 13770         GO TO 3290-EDIT-LF-REIN-RATE
 13771     END-IF
 13772
 13773* DMD RATING TEST
 13774     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13775         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13776         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13777         MOVE ER-2687                 TO WS-ERROR
 13778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779         GO TO 3290-EDIT-LF-REIN-RATE.
 13780
 13781 3230-CLIENT-MORT-CD-SPECIALS.
 13782
 13783     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13784     SET BIN-TO-GREG          TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 249
* EL050.cbl
 13785*    MOVE ' '                 TO DC-OPTION-CODE.
 13786     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13787     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13788
 13789 C-POS-3230-MORT-CD.
 13790     IF PB-COMPANY-ID = 'POS' AND
 13791        PB-SV-CARRIER = '2'
 13792         NEXT SENTENCE
 13793     ELSE
 13794         GO TO C-POS-3240-MORT-CD.
 13795
 13796     IF PB-SV-GROUPING = '030'
 13797        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13798         MOVE '2350' TO PB-I-MORT-CODE
 13799      ELSE
 13800         MOVE '3300' TO PB-I-MORT-CODE.
 13801
 13802
 13803 C-POS-3240-MORT-CD.
 13804     IF PB-COMPANY-ID = 'POS' AND
 13805        PB-SV-CARRIER = '1'
 13806         NEXT SENTENCE
 13807     ELSE
 13808         GO TO 3230-CONTINUE.
 13809
 13810     IF PB-SV-STATE = '45' OR '47'
 13811        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13812         MOVE '5200' TO PB-I-MORT-CODE
 13813     ELSE
 13814         MOVE '8300' TO PB-I-MORT-CODE.
 13815
 13816 3230-CONTINUE.
 13817
 13818     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13819        GO TO 3240-CONTINUE
 13820     END-IF
 13821
 13822     IF PB-CERT-EFF-DT > WS-971231
 13823        GO TO 3240-CONTINUE
 13824     END-IF
 13825
 13826     IF LF-BENEFIT-FOUND AND
 13827        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13828         MOVE 'F250'       TO PB-I-MORT-CODE
 13829     ELSE
 13830         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13831             MOVE '7250'   TO PB-I-MORT-CODE
 13832         ELSE
 13833             MOVE '4251'   TO PB-I-MORT-CODE
 13834         END-IF
 13835     END-IF
 13836
 13837     .
 13838 3240-CONTINUE.
 13839
 13840     IF PB-COMPANY-ID NOT = 'GNL'
 13841         GO TO 3256-CONTINUE.
 13842
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 250
* EL050.cbl
 13843     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13844         MOVE 'A300' TO PB-I-MORT-CODE
 13845     ELSE
 13846         MOVE '8350' TO PB-I-MORT-CODE.
 13847
 13848 3256-CONTINUE.
 13849     IF PB-COMPANY-ID NOT = 'ABL'
 13850         GO TO 3260-EDIT-CONTINUE.
 13851
 13852     IF PB-I-LF-TERM GREATER THAN 59
 13853         MOVE 'F550' TO PB-I-MORT-CODE
 13854     ELSE
 13855         MOVE 'E550' TO PB-I-MORT-CODE.
 13856
 13857 3260-EDIT-CONTINUE.
 13858     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13859
 13860 3290-EDIT-LF-REIN-RATE.
 13861     IF LF-REIN-NSP-NOT-USED
 13862         GO TO 3290-RATING-CONT.
 13863
 13864     IF PB-COMPANY-ID = 'DCC'
 13865        GO TO 3290-RATING-CONT.
 13866     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13867     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13868     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13869     MOVE '3'                   TO CP-PROCESS-TYPE.
 13870     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13871
 13872******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13873     IF PB-COMPANY-ID EQUAL 'CDL'
 13874         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13875            CP-EARN-AS-NET-PAY)
 13876             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13877*            MOVE SPACE          TO DC-OPTION-CODE
 13878             SET BIN-TO-GREG     TO TRUE
 13879             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13880***  Y2K PROJ 7744
 13881             IF DC-GREG-DATE-CYMD GREATER 19931231
 13882                 MOVE '1'        TO CP-EARNING-METHOD.
 13883***  Y2K PROJ 7744
 13884*******
 13885
 13886     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13887     MOVE PB-SV-STATE           TO CP-STATE.
 13888     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13889     MOVE ZERO                  TO CP-DEVIATION-CODE
 13890                                   CP-RATE-DEV-PCT.
 13891     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13892     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13893                                   CP-RATING-BENEFIT-AMT.
 13894
 13895************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13896     IF PB-COMPANY-ID EQUAL 'NCB'
 13897         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13898            CP-EARN-AS-NET-PAY
 13899             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13900                 PB-I-LF-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 251
* EL050.cbl
 13901************
 13902
 13903     IF CP-STATE-STD-ABBRV = 'OR'
 13904         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13905                                         PB-I-LF-ALT-BENEFIT-AMT.
 13906     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13907     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13908     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13909     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13910     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13911     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13912     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13913     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13914                                   CP-REMAINING-TERM
 13915                                   CP-LOAN-TERM.
 13916     IF CP-TRUNCATED-LIFE
 13917        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13918
 13919     IF CP-TERM-IS-DAYS
 13920         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13921     ELSE
 13922         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13923
 13924     IF PB-COMPANY-ID = 'DCC'
 13925        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13926     END-IF
 13927     IF PB-COMPANY-ID NOT = 'TIC'
 13928          MOVE ZERO          TO CP-CLASS-CODE.
 13929
 13930     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13931
 13932     MOVE 'R'                   TO CP-RATE-FILE.
 13933     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13934
 13935     IF CP-ERROR-RATE-NOT-FOUND
 13936        IF PB-I-OB
 13937           MOVE ER-2625      TO WS-ERROR
 13938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13939           GO TO 3299-EDIT-CONTINUE
 13940        ELSE
 13941           MOVE ER-2643      TO WS-ERROR
 13942           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13943           GO TO 3299-EDIT-CONTINUE.
 13944
 13945     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13946
 13947     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13948     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13949
 13950     IF PB-I-LF-REI-RATE = ZERO
 13951         MOVE ER-2643        TO WS-ERROR
 13952         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13953
 13954 3290-CHECK-ALT-REIN-RATE.
 13955
 13956     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13957        GO TO 3290-RATING-CONT.
 13958
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 252
* EL050.cbl
 13959     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13960     MOVE '2'                    TO CP-EARNING-METHOD.
 13961     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13962     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13963     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13964     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13965                                     CP-RATING-BENEFIT-AMT.
 13966     IF CP-STATE-STD-ABBRV = 'OR'
 13967         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13968                                         PB-I-LF-ALT-BENEFIT-AMT.
 13969     IF PB-COMPANY-ID = 'DCC'
 13970        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13971     END-IF
 13972     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13973     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13974     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13975                                    CP-REMAINING-TERM
 13976                                    CP-LOAN-TERM.
 13977     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13978        ADD +1                   TO CP-ORIGINAL-TERM
 13979                                    CP-REMAINING-TERM
 13980                                    CP-LOAN-TERM.
 13981
 13982     MOVE 'R'                   TO CP-RATE-FILE.
 13983     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13984
 13985     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13986
 13987     IF PB-I-LF-ALT-REI-RATE = ZERO
 13988         MOVE ER-2643            TO WS-ERROR
 13989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13990
 13991 3290-RATING-CONT.
 13992
 13993     IF PB-I-OB
 13994*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13995        GO TO 3300-CHECK-AH-RATES.
 13996
 13997 3299-EDIT-CONTINUE.
 13998
 13999     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14000         NEXT SENTENCE
 14001     ELSE
 14002         MOVE ER-2620           TO WS-ERROR
 14003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14004
 14005 3300-CHECK-AH-RATES.
 14006     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14007         NEXT SENTENCE
 14008     ELSE
 14009         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14010
 14011     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14012        and (not pb-monthly-cert))
 14013                  or
 14014        ((CF-COMPANY-ID = 'DMD') AND
 14015                (NO-DMD-RATING))
 14016         IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 253
* EL050.cbl
 14017            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14018            CONTINUE
 14019         ELSE
 14020            MOVE ER-2687         TO WS-ERROR
 14021            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14022         END-IF
 14023         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14024         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14025     END-IF
 14026
 14027     IF PB-I-OB
 14028        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14029
 14030     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14031         MOVE ER-2687             TO WS-ERROR
 14032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14033         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14034         GO TO 3999-END-EDIT.
 14035
 14036*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14037     if pb-company-id = 'AHL'
 14038        go to 3300-skip-crit-per
 14039     end-if
 14040     if (pb-i-ah-crit-per not = zeros)
 14041        and (ws-ah-special-calc-cd not = 'C')
 14042        MOVE ER-1572             TO WS-ERROR
 14043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14044        go to 3300-skip-crit-per
 14045     END-IF
 14046     if (pb-company-id = 'DCC')
 14047        and (am-dcc-product-code not = spaces)
 14048        go to 3300-skip-crit-per
 14049     end-if
 14050     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14051        IF PB-I-AH-CRIT-PER = ZERO
 14052           move ws-ah-max-bens   to pb-i-ah-crit-per
 14053*          MOVE ER-2618       TO WS-ERROR
 14054*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14055*          GO TO 3999-END-EDIT
 14056        END-IF
 14057     END-IF
 14058     if (ws-ah-special-calc-cd = 'C')
 14059        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14060        MOVE ER-1576             TO WS-ERROR
 14061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14062     end-if
 14063
 14064     .
 14065 3300-skip-crit-per.
 14066     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14067     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14068     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14069     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14070     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14071     MOVE PB-SV-STATE            TO CP-STATE.
 14072     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14073     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14074     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 254
* EL050.cbl
 14075*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14076     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14077     MOVE '3'                    TO CP-PROCESS-TYPE.
 14078     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14079     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14080                                    CP-RATING-BENEFIT-AMT.
 14081     IF PB-COMPANY-ID = 'CID'
 14082               OR
 14083        CP-STATE-STD-ABBRV = 'OR'
 14084         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14085                                         PB-I-AH-TERM.
 14086     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14087        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14088           AND (PB-I-POLICY-IS-MONTHLY)
 14089           MOVE PB-I-LF-BENEFIT-AMT
 14090                                 TO CP-NET-BENEFIT-AMT
 14091           move pb-i-ah-premium-amt to cp-original-premium
 14092           add pb-i-lf-premium-amt to cp-original-premium
 14093        END-IF
 14094     END-IF
 14095     MOVE SPACES                 TO CP-BEN-CATEGORY
 14096     IF PB-COMPANY-ID = 'DCC'
 14097        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14098        EVALUATE TRUE
 14099           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14100              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14101              MOVE PB-I-LF-BENEFIT-AMT
 14102                                 TO CP-RATING-BENEFIT-AMT
 14103              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14104           WHEN WS-AH-BEN-CATEGORY = 'G'
 14105              MOVE PB-I-UNPAID-CASH-PRICE
 14106                                 TO CP-RATING-BENEFIT-AMT
 14107           WHEN WS-AH-BEN-CATEGORY = 'D'
 14108              MOVE WS-AH-PMF-COMM
 14109                                 TO CP-DCC-PMF-COMM
 14110              MOVE PB-I-AH-COMMISSION
 14111                                 TO CP-DCC-ACT-COMM
 14112        END-EVALUATE
 14113     END-IF
 14114     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14115     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14116     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14117     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14118     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14119     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14120     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14121                                    CP-REMAINING-TERM
 14122                                    WS-WORK-TERM.
 14123     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14124
 14125     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14126     SET BIN-TO-GREG             TO TRUE.
 14127*    MOVE ' '                    TO DC-OPTION-CODE.
 14128     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14129     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14130
 14131     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14132     IF NOT VALID-SKIP-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 255
* EL050.cbl
 14133         MOVE ER-2683            TO WS-ERROR
 14134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135         GO TO 3320-RATE-CONTINUE.
 14136
 14137     IF PB-NO-MONTHS-SKIPPED
 14138         GO TO 3320-RATE-CONTINUE.
 14139
 14140     MOVE SPACE TO NUMBER-OF-MONTHS.
 14141
 14142     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14143         MOVE 'S'                TO SK-MO (6).
 14144     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14145         MOVE 'S'                TO SK-MO (7).
 14146     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14147         MOVE 'S'                TO SK-MO (8).
 14148     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14149         MOVE 'S'                TO SK-MO (9).
 14150     IF PB-I-SKIP-CODE = 'A'
 14151         MOVE 'S'                TO SK-MO (10).
 14152
 14153     MOVE 1                      TO SUB2.
 14154     MOVE PB-I-AH-TERM           TO SUB3.
 14155     MOVE WS-MONTH               TO SUB1.
 14156     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14157     GO TO 3320-RATE-CONTINUE.
 14158
 14159 3310-GET-SKIP-MO.
 14160     IF SUB1 = 13
 14161         MOVE 1                  TO SUB1.
 14162
 14163     IF SK-MO (SUB1) = 'S'
 14164         SUBTRACT 1 FROM WS-WORK-TERM.
 14165
 14166     ADD 1 TO SUB2
 14167              SUB1.
 14168
 14169 3320-RATE-CONTINUE.
 14170
 14171     IF WS-WORK-TERM = ZERO
 14172         MOVE 1                  TO WS-WORK-TERM.
 14173
 14174     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14175                                    CP-LOAN-TERM.
 14176
 14177     IF PB-COMPANY-ID EQUAL 'DMD'
 14178         NEXT SENTENCE
 14179     ELSE
 14180         MOVE ZERO               TO PB-I-AH-RATE
 14181                                    PB-I-AH-REI-RATE.
 14182
 14183
 14184     IF PB-COMPANY-ID EQUAL 'CRI'
 14185        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14186
 14187     IF PB-COMPANY-ID = 'CSL'
 14188         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14189         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14190         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 256
* EL050.cbl
 14191         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14192
 14193     IF PB-COMPANY-ID = 'DCC'
 14194        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14195           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14196              PB-I-RATE-DEV-PCT-LF
 14197        END-IF
 14198        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14199                                 TO CP-ALTERNATE-BENEFIT
 14200        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14201        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14202        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14203     END-IF
 14204     IF (PB-COMPANY-ID = 'CID')
 14205        AND (WS-LF-EARNINGS-CALC = 'B')
 14206        AND (CP-STATE-STD-ABBRV = 'MN')
 14207        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14208     ELSE
 14209        MOVE ' '                 TO CP-AH-BALLOON-SW
 14210     END-IF
 14211     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14212     MOVE 'R'                   TO CP-RATE-FILE.
 14213     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14214
 14215     IF (CP-ERROR-RATE-NOT-FOUND)
 14216        and (not pb-monthly-cert)
 14217        IF PB-I-OB
 14218           MOVE ER-2624          TO WS-ERROR
 14219           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14220           GO TO 3340-CALCULATE-PREMIUM-AMT
 14221        ELSE
 14222          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14223              NEXT SENTENCE
 14224          ELSE
 14225           MOVE ER-2642          TO WS-ERROR
 14226           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14227           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14228
 14229     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14230        CP-ERROR-DIV-BY-ZERO
 14231           MOVE ER-3782          TO WS-ERROR
 14232           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14233
 14234     IF PB-COMPANY-ID EQUAL 'CRI'
 14235        IF CP-ERROR-NO-LIMITS-CRI
 14236           IF NOT ACCOUNT-AH-CHECKED
 14237              MOVE ER-2607          TO WS-ERROR
 14238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14239
 14240     IF ACCOUNT-AH-CHECKED
 14241        NEXT SENTENCE
 14242     ELSE
 14243       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14244          MOVE ER-2640           TO WS-ERROR
 14245          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14246
 14247     IF PB-COMPANY-ID = 'CRI'
 14248         IF WS-ERROR = ER-2640
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 257
* EL050.cbl
 14249             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14250     IF ACCOUNT-AH-CHECKED
 14251        CONTINUE
 14252     ELSE
 14253        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14254           AND (CP-R-MAX-ATT-AGE > +0)
 14255           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14256           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14257              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14258              MOVE PB-I-AH-EXPIRE-DT
 14259                                 TO DC-BIN-DATE-2
 14260              MOVE '1'           TO DC-OPTION-CODE
 14261              PERFORM 8500-DATE-CONVERT
 14262                                 THRU 8500-EXIT
 14263              IF NO-CONVERSION-ERROR
 14264                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14265                    MOVE ER-2661       TO WS-ERROR
 14266*                   PERFORM 9900-ERROR-FORMAT
 14267*                                THRU 9900-EXIT
 14268                 END-IF
 14269              END-IF
 14270           ELSE
 14271              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14272              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14273                 MOVE ER-2661    TO WS-ERROR
 14274*                PERFORM 9900-ERROR-FORMAT
 14275*                                THRU 9900-EXIT
 14276              ELSE
 14277                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14278                    MOVE ER-1570 TO WS-ERROR
 14279                    PERFORM 9900-ERROR-FORMAT
 14280                                 THRU 9900-EXIT
 14281                 END-IF
 14282              END-IF
 14283           END-IF
 14284           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14285              MOVE PB-I-JOINT-BIRTHDAY
 14286                                    TO DC-BIN-DATE-1
 14287              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14288              MOVE '1'              TO DC-OPTION-CODE
 14289              PERFORM 8500-DATE-CONVERT
 14290                                    THRU 8500-EXIT
 14291              IF NO-CONVERSION-ERROR
 14292                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14293                    MOVE ER-2661       TO WS-ERROR
 14294*                   PERFORM 9900-ERROR-FORMAT
 14295*                                   THRU 9900-EXIT
 14296                 END-IF
 14297              END-IF
 14298           ELSE
 14299              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14300                (PB-I-AH-TERM / 12)
 14301              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14302                 MOVE ER-2661       TO WS-ERROR
 14303*                PERFORM 9900-ERROR-FORMAT
 14304*                                   THRU 9900-EXIT
 14305              ELSE
 14306                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 258
* EL050.cbl
 14307                    MOVE ER-1571 TO WS-ERROR
 14308                    PERFORM 9900-ERROR-FORMAT
 14309                                 THRU 9900-EXIT
 14310                 END-IF
 14311              END-IF
 14312           END-IF
 14313           IF WS-ERROR = ER-2661
 14314              PERFORM 9900-ERROR-FORMAT
 14315                                    THRU 9900-EXIT
 14316           END-IF
 14317        END-IF
 14318     END-IF
 14319*    IF ACCOUNT-AH-CHECKED
 14320*       NEXT SENTENCE
 14321*    ELSE
 14322*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14323*          MOVE ER-2661          TO WS-ERROR
 14324*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14325
 14326     IF ACCOUNT-AH-CHECKED
 14327        NEXT SENTENCE
 14328     ELSE
 14329        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14330           MOVE ER-2663          TO WS-ERROR
 14331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14332
 14333     IF ACCOUNT-AH-CHECKED OR
 14334        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14335         PB-POLICY-IS-VOIDED
 14336        NEXT SENTENCE
 14337     ELSE
 14338        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14339           MOVE ER-2667            TO WS-ERROR
 14340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14341
 14342     IF PB-COMPANY-ID = 'CRI'
 14343         IF WS-ERROR = ER-2667
 14344             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14345
 14346     IF ACCOUNT-AH-CHECKED
 14347        NEXT SENTENCE
 14348     ELSE
 14349        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14350           MOVE ER-2678            TO WS-ERROR
 14351           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14352
 14353     IF CP-ERROR-RATE-FILE-NOTOPEN
 14354         GO TO 3990-FILES-NOT-OPEN.
 14355
 14356 3321-CONTINUE.
 14357     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14358     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14359     IF (PB-COMPANY-ID = 'DCC')
 14360        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14361        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14362                                    PB-I-LF-ALT-PREM-CALC
 14363        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14364        IF WS-AH-BEN-CATEGORY = 'G'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 259
* EL050.cbl
 14365           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14366           + PB-I-ADDL-CLP)
 14367           * (1 + WS-TOL-CLP-PCT)
 14368*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14369        ELSE
 14370           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14371           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14372*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14373        END-IF
 14374        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14375                                 TO PB-I-AH-PREM-CALC
 14376        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14377           MOVE ER-8152          TO WS-ERROR
 14378           PERFORM 9900-ERROR-FORMAT
 14379                                 THRU 9900-EXIT
 14380        ELSE
 14381           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14382                 PB-I-ADDL-CLP)
 14383              MOVE ER-8148       TO WS-ERROR
 14384              PERFORM 9900-ERROR-FORMAT
 14385                                 THRU 9900-EXIT
 14386           END-IF
 14387        END-IF
 14388     END-IF
 14389     IF (PB-COMPANY-ID = 'DCC')
 14390        AND (PB-I-POLICY-IS-MONTHLY)
 14391        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14392        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14393        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14394           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14395        END-IF
 14396     END-IF
 14397     IF (PB-COMPANY-ID = 'DCC')
 14398        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14399        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14400        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14401        MOVE ER-2786             TO WS-ERROR
 14402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14403     END-IF
 14404     MOVE +0                     TO PB-I-AH-CLP
 14405     IF PB-COMPANY-ID = 'DCC'
 14406        evaluate true
 14407           when WS-AH-BEN-CATEGORY = 'D'
 14408              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14409                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14410           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14411              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14412           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14413              compute ws-cred-union-fees rounded =
 14414                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14415                    pb-i-ah-commission)
 14416              COMPUTE PB-I-AH-CLP =
 14417                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14418        end-evaluate
 14419     END-IF
 14420     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14421
 14422     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 260
* EL050.cbl
 14423         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14424
 14425     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14426         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14427
 14428     if (ws-ah-special-calc-cd = 'E')
 14429        and (pb-monthly-cert)
 14430        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14431     end-if
 14432     IF PB-COMPANY-ID = 'CRI'
 14433         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14434            PB-I-PAYMENT-AMOUNT = ZERO
 14435             NEXT SENTENCE
 14436         ELSE
 14437             COMPUTE PB-I-AH-PREM-CALC =
 14438                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14439                 (CP-PREMIUM-RATE / 100)
 14440             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14441                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14442                                             PB-I-RATE-DEV-PCT-AH.
 14443
 14444     IF (PB-I-AH-RATE  = ZERO)
 14445        and (not pb-monthly-cert)
 14446       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14447           NEXT SENTENCE
 14448       ELSE
 14449         MOVE ER-2642            TO WS-ERROR
 14450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14451
 14452     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14453     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14454     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14455     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14456     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14457     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14458
 14459     IF (PB-COMPANY-ID = 'DCC')
 14460        AND (WS-AH-BEN-CATEGORY = 'G')
 14461        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14462        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14463        IF CP-DEVIATION-CODE NOT = '000'
 14464           MOVE '000'            TO CP-DEVIATION-CODE
 14465           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14466           IF NO-CP-ERROR
 14467              COMPUTE PB-I-DDF-IU-RATE-UP =
 14468              PB-I-AH-CLP - CP-CALC-PREMIUM
 14469           ELSE
 14470              MOVE ER-3057        TO WS-ERROR
 14471              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14472           END-IF
 14473        END-IF
 14474     END-IF
 14475     .
 14476 3335-EDIT-AH-REIN-NSP-RATE.
 14477     IF PB-COMPANY-ID = 'DCC'
 14478        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14479              compute ws-cred-union-fees rounded =
 14480                 ws-cred-union-fees + (pb-i-ah-premium-amt *
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 261
* EL050.cbl
 14481                    pb-i-ah-commission)
 14482              COMPUTE PB-I-AH-CLP =
 14483                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14484        end-if
 14485     END-IF
 14486     IF AH-REIN-NSP-NOT-USED
 14487         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14488
 14489     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14490     IF PB-COMPANY-ID = 'DCC'
 14491         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14492     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14493     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14494     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14495     MOVE PB-SV-STATE            TO CP-STATE.
 14496     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14497     MOVE ZERO                   TO CP-DEVIATION-CODE
 14498                                    CP-RATE-DEV-PCT.
 14499*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14500     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14501     MOVE '3'                    TO CP-PROCESS-TYPE.
 14502     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14503     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14504                                    CP-RATING-BENEFIT-AMT.
 14505     IF CP-STATE-STD-ABBRV = 'OR'
 14506         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14507                                         PB-I-AH-TERM.
 14508     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14509     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14510     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14511     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14512     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14513     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14514                                    CP-REMAINING-TERM
 14515                                    WS-WORK-TERM.
 14516     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14517     IF PB-COMPANY-ID = 'DCC'
 14518        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14519     END-IF
 14520     IF  PB-COMPANY-ID = 'TIC'
 14521         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14522            MOVE ZERO TO CP-CLASS-CODE.
 14523
 14524     IF PB-COMPANY-ID NOT = 'TIC'
 14525          MOVE ZERO          TO CP-CLASS-CODE.
 14526
 14527     MOVE ZERO               TO CP-DEVIATION-CODE.
 14528
 14529     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14530
 14531     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14532
 14533     MOVE 'R'                   TO CP-RATE-FILE.
 14534     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14535
 14536     IF CP-ERROR-RATE-NOT-FOUND
 14537         MOVE ER-2645        TO WS-ERROR
 14538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 262
* EL050.cbl
 14539         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14540
 14541     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14542
 14543     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14544     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14545
 14546     IF PB-I-AH-REI-RATE = ZERO
 14547         MOVE ER-2645        TO WS-ERROR
 14548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14549
 14550
 14551 3340-CALCULATE-PREMIUM-AMT.
 14552
 14553     IF PB-COMPANY-ID = 'NCL'
 14554         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14555             WS-AH-SPECIAL-CALC-CD = 'O')
 14556             GO TO 3999-END-EDIT.
 14557
 14558     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14559                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14560                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14561                         OR 'AHL'
 14562         NEXT SENTENCE
 14563     ELSE
 14564         IF WS-STATE-ABBREVIATION = 'CT'
 14565             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14566                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14567                 COMPUTE PB-I-LF-PREM-CALC =
 14568                                     PB-I-LF-PREM-CALC * .90
 14569                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14570                                     PB-I-LF-ALT-PREM-CALC * .90
 14571                 COMPUTE PB-I-AH-PREM-CALC =
 14572                                     PB-I-AH-PREM-CALC * .90.
 14573
 14574     IF PB-COMP-LF-PREM
 14575        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14576        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14577
 14578     IF PB-COMP-AH-PREM
 14579        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14580
 14581 3340-CHECK-DCC-TOT-FEES.
 14582     IF (PB-COMPANY-ID = 'DCC')
 14583        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14584        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14585        AND (PB-I-POLICY-IS-MONTHLY)
 14586        CONTINUE
 14587     ELSE
 14588        GO TO 3340-EDIT-LF-AH-TOL
 14589     END-IF
 14590     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14591     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14592     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14593        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14594           PB-I-RATE-DEV-PCT-LF
 14595     END-IF
 14596     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 263
* EL050.cbl
 14597        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14598           PB-I-RATE-DEV-PCT-AH
 14599     END-IF
 14600     MOVE 'N'                    TO CP-BEN-CATEGORY
 14601     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14602
 14603     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14604     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14605     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14606     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14607     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14608     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14609     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14610     MOVE '3'                    TO CP-PROCESS-TYPE.
 14611     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14612     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14613
 14614     MOVE PB-SV-STATE            TO CP-STATE.
 14615     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14616     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14617     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14618     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14619     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14620                                    CP-RATING-BENEFIT-AMT.
 14621     IF CP-STATE-STD-ABBRV = 'OR'
 14622         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14623                                         PB-I-LF-ALT-BENEFIT-AMT.
 14624     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14625     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14626     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14627     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14628     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14629     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14630     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14631     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14632     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14633                                    CP-REMAINING-TERM
 14634                                    CP-LOAN-TERM.
 14635     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14636        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14637           PB-I-LF-PREMIUM-AMT
 14638     end-if
 14639
 14640     IF CP-TRUNCATED-LIFE
 14641        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14642
 14643     IF CP-TERM-IS-DAYS
 14644         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14645     ELSE
 14646         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14647
 14648     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14649     IF CP-SPECIAL-CALC-CD = 'H'
 14650         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14651                                    TO CP-ALTERNATE-BENEFIT
 14652         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14653     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14654     MOVE 'R'                    TO CP-RATE-FILE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 264
* EL050.cbl
 14655     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14656     IF NOT CP-ERROR-RATE-NOT-FOUND
 14657        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14658        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14659           AND (CP-BENEFIT-CD (1:1) = 'S')
 14660           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14661                                    PB-I-LF-PREMIUM-AMT
 14662        END-IF
 14663     ELSE
 14664        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14665     END-IF
 14666     .
 14667 3340-EDIT-LF-AH-TOL.
 14668
 14669***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14670***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14671***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14672***
 14673     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14674         PB-I-AH-PREMIUM-AMT
 14675          GIVING WS-CALC-WORK.
 14676
 14677     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14678        AND WS-CALC-WORK NOT = ZERO
 14679         MOVE ER-2649            TO WS-ERROR
 14680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14681
 14682     SUBTRACT PB-I-LF-PREM-CALC
 14683             FROM PB-I-LF-PREMIUM-AMT
 14684                 GIVING WS-UNSIGN-WRK1.
 14685
 14686     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14687             FROM PB-I-LF-ALT-PREMIUM-AMT
 14688                 GIVING WS-UNSIGN-WRK4.
 14689
 14690     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14691                                + WS-UNSIGN-WRK4.
 14692
 14693     SUBTRACT PB-I-AH-PREM-CALC
 14694             FROM PB-I-AH-PREMIUM-AMT
 14695                 GIVING WS-UNSIGN-WRK2.
 14696
 14697******************************************************************
 14698*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14699******************************************************************
 14700
 14701     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14702         MOVE ZERO TO WS-UNSIGN-WRK1.
 14703
 14704     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14705         MOVE ZERO TO WS-UNSIGN-WRK2.
 14706
 14707     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14708             GIVING WS-UNSIGN-WRK3.
 14709
 14710 3342-CONTINUE.
 14711
 14712     IF (PB-I-LF-RATE = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 265
* EL050.cbl
 14713         PB-I-AH-RATE = ZERO)
 14714         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14715            WS-AH-SPECIAL-CALC-CD = 'O'
 14716              NEXT SENTENCE
 14717         ELSE
 14718             GO TO 3345-EDIT-CONTINUE.
 14719
 14720     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14721         NEXT SENTENCE
 14722     ELSE
 14723     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14724        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14725           IF (PB-REISSUED-CERT         OR
 14726               PB-POLICY-IS-DECLINED    OR
 14727               PB-POLICY-IS-VOIDED)
 14728              NEXT SENTENCE
 14729           ELSE
 14730              IF WS-PREM-REJECT-SW = SPACE
 14731                 MOVE ER-2652    TO WS-ERROR
 14732                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14733                 GO TO 3344-CHECK-AH
 14734              ELSE
 14735                 MOVE ER-2650    TO WS-ERROR
 14736                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14737                 GO TO 3344-CHECK-AH.
 14738
 14739***
 14740***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14741***
 14742
 14743     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14744         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14745            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14746             (1 + WS-TOL-LF-PREM-PCT)
 14747         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14748            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14749             (1 - WS-TOL-LF-PREM-PCT)
 14750     ELSE
 14751         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14752         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14753
 14754***
 14755***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14756***
 14757
 14758     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14759         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14760          WS-TOL-LF-PREM.
 14761
 14762     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14763         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14764          WS-TOL-LF-PREM.
 14765
 14766     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14767        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14768
 14769     IF PB-REISSUED-CERT
 14770        or PB-POLICY-IS-DECLINED
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 266
* EL050.cbl
 14771        or PB-POLICY-IS-VOIDED
 14772        continue
 14773     ELSE
 14774        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14775              > WS-TOL-LF-HIGH-PREM-AMT)
 14776           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14777              < WS-TOL-LF-LOW-PREM-AMT))
 14778                      or
 14779           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14780              > WS-TOL-LF-HIGH-PREM-PCT)
 14781           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14782              < WS-TOL-LF-LOW-PREM-PCT))
 14783           IF WS-PREM-REJECT-SW = SPACE
 14784              MOVE ER-2652       TO WS-ERROR
 14785              PERFORM 9900-ERROR-FORMAT
 14786                                 THRU 9900-EXIT
 14787           ELSE
 14788              MOVE ER-2650       TO WS-ERROR
 14789              PERFORM 9900-ERROR-FORMAT
 14790                                 THRU 9900-EXIT
 14791           end-if
 14792        end-if
 14793     end-if
 14794
 14795*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14796*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14797*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14798*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14799
 14800     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14801        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14802                      OR
 14803           ((PB-COMPANY-ID = 'DCC')
 14804           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14805           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14806           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14807        END-IF
 14808     END-IF
 14809
 14810     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14811        IF WS-COMP-MAX-CAP GREATER THAN +0
 14812           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14813              IF (PB-REISSUED-CERT         OR
 14814                  PB-POLICY-IS-DECLINED    OR
 14815                  PB-POLICY-IS-VOIDED)
 14816                 NEXT SENTENCE
 14817              ELSE
 14818                  MOVE ER-2646   TO  WS-ERROR
 14819                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14820
 14821 3344-CVL-TOLERANCE-CHECK.
 14822
 14823      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14824          GO TO 3344-CHECK-AH.
 14825
 14826      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14827          GO TO 3344-CHECK-AH.
 14828
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 267
* EL050.cbl
 14829      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14830                                     WS-UNSIGN-WRK6.
 14831
 14832      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14833          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14834                                 + PB-I-LF-PREMIUM-AMT
 14835                                 - PB-I-LF-PREM-CALC.
 14836
 14837      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14838          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14839                                 + PB-I-LF-ALT-PREMIUM-AMT
 14840                                 - PB-I-LF-ALT-PREM-CALC.
 14841
 14842      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14843          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14844              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14845                 MOVE ER-2652    TO  WS-ERROR
 14846                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14847              ELSE
 14848                 MOVE ER-2650    TO  WS-ERROR
 14849                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14850
 14851      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14852          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14853              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14854                 MOVE ER-2652    TO  WS-ERROR
 14855                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14856              ELSE
 14857                 MOVE ER-2650    TO  WS-ERROR
 14858                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14859
 14860 3344-CHECK-AH.
 14861
 14862****************************************************************
 14863***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14864***
 14865
 14866     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14867         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14868             (1 + WS-TOL-AH-PREM-PCT)
 14869         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14870             (1 - WS-TOL-AH-PREM-PCT)
 14871     ELSE
 14872         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14873         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14874
 14875***
 14876***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14877***
 14878
 14879     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14880         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14881
 14882     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14883         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14884
 14885     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14886        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 268
* EL050.cbl
 14887
 14888     IF (PB-REISSUED-CERT)
 14889        OR (PB-POLICY-IS-DECLINED)
 14890        OR (PB-POLICY-IS-VOIDED)
 14891        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14892        CONTINUE
 14893     ELSE
 14894        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14895              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14896                          or
 14897           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14898              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14899           IF WS-PREM-REJECT-SW = SPACE
 14900              MOVE ER-3052       TO WS-ERROR
 14901              PERFORM 9900-ERROR-FORMAT
 14902                                 THRU 9900-EXIT
 14903           ELSE
 14904              MOVE ER-3050       TO WS-ERROR
 14905              PERFORM 9900-ERROR-FORMAT
 14906                                 THRU 9900-EXIT
 14907           END-IF
 14908        END-IF
 14909     END-IF
 14910     if (pb-company-id = 'DCC')
 14911        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14912        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14913        and (pb-i-policy-is-monthly)
 14914        compute ws-tol-ah-high-prem-amt =
 14915           pb-i-tot-fees-calc + ws-tol-ah-prem
 14916        compute ws-tol-ah-low-prem-amt =
 14917           pb-i-tot-fees-calc - ws-tol-ah-prem
 14918        if ws-tol-ah-prem-pct > zeros
 14919           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14920              (1 + ws-tol-ah-prem-pct)
 14921           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14922              (1 - ws-tol-ah-prem-pct)
 14923        else
 14924           move +9999999.99      to ws-tol-ah-high-prem-pct
 14925           move +0               to ws-tol-ah-low-prem-pct
 14926        end-if
 14927        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14928            or
 14929           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14930                          or
 14931           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14932           or
 14933           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14934            move er-3049         to ws-error
 14935           perform 9900-error-format
 14936                                 thru 9900-exit
 14937
 14938        end-if
 14939     end-if
 14940     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14941         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14942             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14943             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14944
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 269
* EL050.cbl
 14945     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14946        IF WS-COMP-MAX-CAP GREATER THAN +0
 14947           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14948              IF (PB-REISSUED-CERT         OR
 14949                  PB-POLICY-IS-DECLINED    OR
 14950                  PB-POLICY-IS-VOIDED)
 14951                 NEXT SENTENCE
 14952              ELSE
 14953                  MOVE ER-2646   TO  WS-ERROR
 14954                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14955
 14956     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14957        (WS-COMP-MAX-CAP EQUAL +0)
 14958           GO TO 3345-EDIT-CONTINUE.
 14959
 14960     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14961        GREATER THAN WS-COMP-MAX-CAP
 14962           MOVE ER-2646          TO  WS-ERROR
 14963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14964
 14965 3345-EDIT-CONTINUE.
 14966
 14967*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14968*       IF PB-ENTRY-BATCH   NUMERIC
 14969*          IF PB-ISSUE
 14970*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14971*          ELSE
 14972*              IF PB-CANCELLATION
 14973*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14974
 14975*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14976*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14977*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14978*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14979*        ELSE
 14980*            MOVE  ER-1909            TO  WS-ERROR
 14981*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14982
 14983     IF PB-I-POLICY-ACCEPTED
 14984        IF PB-POLICY-IS-DECLINED  OR
 14985           PB-REISSUED-CERT  OR
 14986           PB-REIN-ONLY-CERT  OR
 14987           PB-POLICY-IS-VOIDED
 14988            MOVE  ER-1891         TO  WS-ERROR
 14989            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14990        ELSE
 14991            MOVE SPACE            TO  PB-BATCH-ENTRY
 14992            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14993
 14994     IF PB-I-POLICY-DECLINED
 14995        IF PB-REISSUED-CERT  OR
 14996           PB-REIN-ONLY-CERT  OR
 14997           PB-POLICY-IS-VOIDED
 14998            MOVE  ER-1906         TO  WS-ERROR
 14999            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15000        ELSE
 15001            MOVE  'D'             TO  PB-BATCH-ENTRY
 15002                                      PB-I-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 270
* EL050.cbl
 15003
 15004     IF PB-I-NEEDS-UNDERWRITING
 15005        IF PB-POLICY-IS-DECLINED OR
 15006           PB-REISSUED-CERT  OR
 15007           PB-REIN-ONLY-CERT  OR
 15008           PB-POLICY-IS-VOIDED
 15009            MOVE  ER-1907         TO  WS-ERROR
 15010            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15011        ELSE
 15012            MOVE 'U'              TO  PB-BATCH-ENTRY
 15013                                      PB-I-ENTRY-STATUS.
 15014
 15015     IF PB-NEEDS-UNDERWRITING
 15016        MOVE  ER-1901             TO  WS-ERROR
 15017        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15018     IF PB-COMPANY-ID = 'DCC'
 15019        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15020        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15021        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15022           AND (NOT WS-LF-CASH))
 15023                           OR
 15024           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15025           AND (NOT WS-AH-CASH)))
 15026                       AND
 15027           (PB-I-ENTRY-STATUS NOT = '5')
 15028           MOVE 'M'              TO PB-BATCH-ENTRY
 15029                                    PB-I-ENTRY-STATUS
 15030        END-IF
 15031     END-IF
 15032     IF  PB-COMPANY-ID NOT = 'NCL'
 15033         GO TO 3999-END-EDIT.
 15034
 15035     IF PB-REISSUED-CERT  OR
 15036        PB-POLICY-IS-DECLINED  OR
 15037        PB-POLICY-IS-VOIDED  OR
 15038        PB-I-OB
 15039         GO TO 3999-END-EDIT.
 15040
 15041     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15042         MOVE  ER-2644            TO  WS-ERROR
 15043         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15044         GO TO 3999-END-EDIT.
 15045
 15046     MOVE 'N'                     TO  FORM-MASTER-SW.
 15047     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15048
 15049     IF NOT FORM-MASTER-FOUND
 15050         GO TO 3999-END-EDIT.
 15051
 15052     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15053                                      FORM-MASTER-AH-SW.
 15054
 15055     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15056         MOVE  +1                 TO SUB6
 15057         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15058
 15059     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15060         MOVE  +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 271
* EL050.cbl
 15061         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15062
 15063     IF LF-FORM-MASTER-FOUND  OR
 15064        AH-FORM-MASTER-FOUND
 15065         GO TO 3360-CHECK-FORM-LIMITS
 15066     ELSE
 15067         GO TO 3999-END-EDIT.
 15068
 15069******************************************************************
 15070*                  3350-GET-ERFORM                               *
 15071*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15072*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15073******************************************************************
 15074
 15075 3350-GET-ERFORM.
 15076
 15077     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15078         GO TO  3350-ERFORM-GETMAIN.
 15079
 15080     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15081     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15082     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15083     MOVE 'Y'                     TO FORM-MASTER-SW.
 15084
 15085     IF PB-CANCELLATION
 15086         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15087            PB-SV-STATE          EQUAL   FO-STATE       AND
 15088            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15089              GO TO 3350-EXIT
 15090         ELSE
 15091             NEXT SENTENCE
 15092     ELSE
 15093         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15094            PB-SV-STATE          EQUAL   FO-STATE       AND
 15095            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15096              GO TO 3350-EXIT.
 15097
 15098 3350-ERFORM-GETMAIN.
 15099
 15100     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15101     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15102
 15103 3350-ERFORM-READ.
 15104
 15105     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15106     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15107     IF PB-CANCELLATION
 15108         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15109     ELSE
 15110         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15111     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15112
 15113     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15114
 15115     IF FORM-MASTER-FOUND
 15116       IF PB-CANCELLATION
 15117          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15118             PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 272
* EL050.cbl
 15119             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15120              GO  TO 3350-EXIT
 15121          ELSE
 15122              NEXT SENTENCE
 15123       ELSE
 15124          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15125             PB-SV-STATE          EQUAL   FO-STATE       AND
 15126             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15127              GO  TO 3350-EXIT.
 15128
 15129     MOVE  'N'                    TO  FORM-MASTER-SW.
 15130     MOVE  ER-1895                TO  WS-ERROR.
 15131     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15132
 15133 3350-EXIT.
 15134      EXIT.
 15135
 15136******************************************************************
 15137*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15138*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15139*   VALID FOR THE POLICY FORM USED.                              *
 15140******************************************************************
 15141
 15142 3355-EDIT-FORM-LF-BENEFITS.
 15143
 15144     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15145        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15146         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15147         GO TO   3355-EXIT.
 15148
 15149     IF  SUB6    LESS THAN   +40
 15150         ADD  +1      TO  SUB6
 15151         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15152
 15153     MOVE  ER-1896         TO  WS-ERROR.
 15154     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15155
 15156 3355-EXIT.
 15157      EXIT.
 15158
 15159******************************************************************
 15160*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15161*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15162*   VALID FOR THE POLICY FORM USED.                              *
 15163******************************************************************
 15164
 15165 3356-EDIT-FORM-AH-BENEFITS.
 15166
 15167     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15168        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15169         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15170         GO TO  3356-EXIT.
 15171
 15172      IF  SUB6    LESS THAN     +40
 15173          ADD  +1      TO  SUB6
 15174          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15175
 15176     MOVE  ER-1897         TO  WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 273
* EL050.cbl
 15177     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15178
 15179 3356-EXIT.
 15180      EXIT.
 15181
 15182******************************************************************
 15183*                  3357-BENEFIT-SEARCH                           *
 15184*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15185*   CANCELLATIONS ONLY.                                          *
 15186******************************************************************
 15187 3357-BENEFIT-SEARCH.
 15188     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15189         MOVE +1                          TO SUB6
 15190         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15191
 15192     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15193         MOVE +1                          TO SUB6
 15194         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15195
 15196 3357-EXIT.
 15197     EXIT.
 15198
 15199******************************************************************
 15200*                  3358-BENEFIT-LIFE-SEARCH                      *
 15201*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15202*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15203*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15204******************************************************************
 15205 3358-BENEFIT-LIFE-SEARCH.
 15206     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15207       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15208         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15209           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15210              IF FO-PLAN-REFUND-METHOD (SUB6)
 15211                     IS GREATER THAN SPACES
 15212                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15213                                          WS-LF-REFUND-CALC
 15214                 GO TO 3358-EXIT.
 15215
 15216     IF SUB6 LESS THAN +40
 15217         ADD +1                 TO SUB6
 15218         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15219
 15220 3358-EXIT.
 15221     EXIT.
 15222******************************************************************
 15223*                  3359-BENEFIT-AH-SEARCH                        *
 15224*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15225*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15226*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15227******************************************************************
 15228 3359-BENEFIT-AH-SEARCH.
 15229     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15230       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15231         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15232           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15233              IF FO-PLAN-REFUND-METHOD (SUB6)
 15234                      IS GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 274
* EL050.cbl
 15235                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15236                                          WS-AH-REFUND-CALC
 15237                 GO TO 3359-EXIT.
 15238
 15239     IF SUB6 LESS THAN +40
 15240         ADD +1                 TO SUB6
 15241         GO TO 3359-BENEFIT-AH-SEARCH.
 15242
 15243 3359-EXIT.
 15244     EXIT.
 15245
 15246******************************************************************
 15247*                  3360-CHECK-FORM-LIMITS                        *
 15248*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15249*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15250******************************************************************
 15251
 15252 3360-CHECK-FORM-LIMITS.
 15253
 15254     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15255         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15256
 15257     IF NOT LF-FORM-MASTER-FOUND
 15258         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15259
 15260 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15261
 15262     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15263       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15264        WS-LF-JOINT-INDICATOR = 'J'  AND
 15265        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15266         IF PB-COMPANY-ID = 'NCL'
 15267            MOVE  ER-1911          TO  WS-ERROR
 15268            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15269         ELSE
 15270            MOVE  ER-1892          TO  WS-ERROR
 15271            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15272
 15273 3360-CHECK-FORM-LF-ATT-AGE.
 15274
 15275     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15276
 15277     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15278         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15279         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15280            IF PB-COMPANY-ID = 'NCL'
 15281                MOVE  ER-1913      TO  WS-ERROR
 15282                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15283            ELSE
 15284                MOVE  ER-1894      TO  WS-ERROR
 15285                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15286
 15287 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15288
 15289     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15290         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15291         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15292            IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 275
* EL050.cbl
 15293                MOVE  ER-1914      TO  WS-ERROR
 15294                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15295            ELSE
 15296                MOVE  ER-1899      TO  WS-ERROR
 15297                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15298
 15299 3360-CHECK-FORM-LF-TERM-BAMT.
 15300
 15301     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15302         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15303         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15304           IF  PB-COMPANY-ID = 'NCL'
 15305               MOVE  ER-1916       TO  WS-ERROR
 15306               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15307           ELSE
 15308               MOVE  ER-1902       TO  WS-ERROR
 15309               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15310
 15311     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15312                                    PB-I-LF-ALT-BENEFIT-AMT.
 15313
 15314     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15315         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15316         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15317             IF  PB-COMPANY-ID = 'NCL'
 15318                 MOVE  ER-1918     TO  WS-ERROR
 15319                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15320             ELSE
 15321                 MOVE  ER-1904     TO  WS-ERROR
 15322                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15323
 15324******************************************************************
 15325*                  3360-CHECK-FORM-AH-LIMITS                     *
 15326*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15327*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15328******************************************************************
 15329
 15330 3360-CHECK-FORM-AH-LIMITS.
 15331
 15332     IF NOT AH-FORM-MASTER-FOUND
 15333         GO TO 3999-END-EDIT.
 15334
 15335 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15336
 15337     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15338       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15339        WS-AH-JOINT-INDICATOR = 'J'  AND
 15340        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15341         IF PB-COMPANY-ID = 'NCL'
 15342            MOVE  ER-1912          TO  WS-ERROR
 15343            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15344         ELSE
 15345            MOVE  ER-1893          TO  WS-ERROR
 15346            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15347
 15348 3360-CHECK-FORM-AH-ATT-AGE.
 15349
 15350     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 276
* EL050.cbl
 15351
 15352     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15353         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15354         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15355            IF PB-COMPANY-ID = 'NCL'
 15356                MOVE  ER-1913      TO  WS-ERROR
 15357                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15358            ELSE
 15359                MOVE  ER-1894      TO  WS-ERROR
 15360                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15361
 15362 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15363
 15364     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15365         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15366         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15367            IF PB-COMPANY-ID = 'NCL'
 15368                MOVE  ER-1915      TO  WS-ERROR
 15369                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15370            ELSE
 15371                MOVE  ER-1900      TO  WS-ERROR
 15372                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15373
 15374 3360-CHECK-FORM-AH-TERM-BAMT.
 15375
 15376     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15377         FO-AH-MAX-TERM    GREATER THAN  +0
 15378         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15379             IF  PB-COMPANY-ID = 'NCL'
 15380                 MOVE  ER-1917     TO  WS-ERROR
 15381                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15382             ELSE
 15383                  MOVE  ER-1903    TO  WS-ERROR
 15384                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15385
 15386     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15387         FO-MAX-AH-AMT    GREATER THAN  +0
 15388         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15389             IF  PB-COMPANY-ID = 'NCL'
 15390                 MOVE  ER-1919     TO  WS-ERROR
 15391                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15392             ELSE
 15393                 MOVE  ER-1905     TO  WS-ERROR
 15394                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15395
 15396     GO TO 3999-END-EDIT.
 15397
 15398******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 277
* EL050.cbl
 15400******************************************************************
 15401*                  E D I T   C A N C E L                         *
 15402******************************************************************
 15403
 15404 3700-EDIT-CANCEL.
 15405     IF PB-COMPANY-ID = 'DMD'
 15406         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15407                                         WS-RES-MUNI-TAX
 15408                                         PB-CI-STATE-TAX
 15409                                         PB-CI-MUNI-TAX
 15410         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15411
 15412*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15413*       IF PB-ENTRY-BATCH  NUMERIC
 15414*          IF PB-CANCELLATION
 15415*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15416*          ELSE
 15417*             IF PB-ISSUE
 15418*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15419
 15420     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15421        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15422     END-IF
 15423*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15424*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15425
 15426     IF CM-ENTRY-STATUS = 'V'
 15427        MOVE ER-2780             TO WS-ERROR
 15428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15429        GO TO 3999-END-EDIT.
 15430
 15431     IF CM-ENTRY-STATUS = 'D'
 15432        MOVE ER-2781             TO WS-ERROR
 15433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15434        GO TO 3999-END-EDIT.
 15435
 15436     IF CM-ENTRY-STATUS = 'U'
 15437        MOVE ER-2782             TO WS-ERROR
 15438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15439
 15440***************************************************************
 15441*                                                             *
 15442*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15443*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15444*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15445*   OF ANOTHER COVERAGE.                                      *
 15446*                                                             *
 15447***************************************************************
 15448
 15449     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15450                                    PB-C-AH-CANCEL-VOID-SW.
 15451
 15452     IF PB-C-LF-CANCEL-AMT = ZERO
 15453        NEXT SENTENCE
 15454     ELSE
 15455        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15456           AND
 15457           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 278
* EL050.cbl
 15458               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15459               MOVE ER-2745           TO WS-ERROR
 15460               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15461
 15462     IF PB-C-AH-CANCEL-AMT = ZERO
 15463        NEXT SENTENCE
 15464     ELSE
 15465        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15466           AND
 15467           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15468               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15469               MOVE ER-2745           TO WS-ERROR
 15470               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15471
 15472     IF WS-LF-EARNINGS-CALC = '4'
 15473        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15474
 15475     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15476     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15477     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15478     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15479     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15480     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15481
 15482     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15483                                      PB-C-AH-REF-CALC.
 15484     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15485
 15486******************************************************************
 15487*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15488*             TO VALIDATE COVERAGE.                              *
 15489******************************************************************
 15490
 15491     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15492        PB-C-LF-CANCEL-AMT = ZEROS
 15493          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15494      ELSE
 15495          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15496
 15497     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15498        PB-C-AH-CANCEL-AMT = ZEROS
 15499          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15500      ELSE
 15501          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15502
 15503     EVALUATE TRUE
 15504         WHEN PB-CANCEL-FORCE             OR
 15505              PB-CANCEL-DATE-FORCED       OR
 15506              PB-FORCE-OFF
 15507                  IF PB-COMPANY-ID = 'ACE'
 15508                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15509                  END-IF
 15510         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15511               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15512              (PB-COMPANY-ID = 'ACE' )
 15513                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15514         WHEN OTHER
 15515              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 279
* EL050.cbl
 15516                 MOVE ER-2794              TO WS-ERROR
 15517              ELSE
 15518                 MOVE ER-2749              TO WS-ERROR
 15519              END-IF
 15520              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15521     END-EVALUATE.
 15522
 15523
 15524*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15525*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15526*            MOVE  ER-1909            TO  WS-ERROR
 15527*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15528*        ELSE
 15529*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15530
 15531     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15532     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15533        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15534     ELSE
 15535        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15536     END-IF
 15537     .
 15538 3705-EDIT-CANCEL-DT.
 15539
 15540     IF LF-COVERAGE-CANCELLED
 15541        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15542         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15543         MOVE WS-CURRENT-MONTH-END
 15544                                 TO DC-BIN-DATE-2
 15545         SET ELAPSED-BETWEEN-BIN TO TRUE
 15546*        MOVE 1                  TO DC-OPTION-CODE
 15547         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15548         IF DATE-CONVERSION-ERROR
 15549            NEXT SENTENCE
 15550          ELSE
 15551             IF DC-ELAPSED-DAYS GREATER +180
 15552                IF PB-CANCEL-DATE-FORCED  OR
 15553                   PB-CANCEL-DATE-FORCED-NO-FEE
 15554                      MOVE ER-2751  TO WS-ERROR
 15555                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15556                 ELSE
 15557                   MOVE ER-2752  TO WS-ERROR
 15558                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15559
 15560     IF AH-COVERAGE-CANCELLED
 15561        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15562         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15563         MOVE WS-CURRENT-MONTH-END
 15564                                 TO DC-BIN-DATE-2
 15565         SET ELAPSED-BETWEEN-BIN TO TRUE
 15566*        MOVE 1                  TO DC-OPTION-CODE
 15567         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15568         IF DATE-CONVERSION-ERROR
 15569            NEXT SENTENCE
 15570          ELSE
 15571             IF DC-ELAPSED-DAYS GREATER +180
 15572                IF PB-CANCEL-DATE-FORCED OR
 15573                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 280
* EL050.cbl
 15574                      MOVE ER-2751  TO WS-ERROR
 15575                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15576                 ELSE
 15577                   MOVE ER-2752  TO WS-ERROR
 15578                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15579
 15580     IF WS-ERROR = ER-2752
 15581        AND (PB-COMPANY-ID = 'ABL'
 15582         OR  PB-COMPANY-ID = 'FGL'
 15583         OR  PB-COMPANY-ID = 'IST'
 15584         OR  PB-COMPANY-ID = 'JHL'
 15585         OR  PB-COMPANY-ID = 'LAP'
 15586         OR  PB-COMPANY-ID = 'LBL'
 15587         OR  PB-COMPANY-ID = 'NCB'
 15588         OR  PB-COMPANY-ID = 'NLI'
 15589         OR  PB-COMPANY-ID = 'OFI'
 15590         OR  PB-COMPANY-ID = 'PLI'
 15591         OR  PB-COMPANY-ID = 'TAO'
 15592         OR  PB-COMPANY-ID = 'TIC'
 15593         OR  PB-COMPANY-ID = 'HER'
 15594         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15595         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15596            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15597            MOVE ER-2762     TO WS-ERROR
 15598            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15599
 15600     IF LF-COVERAGE-CANCELLED
 15601        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15602        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15603             MOVE ER-2733         TO WS-ERROR
 15604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15605
 15606     IF AH-COVERAGE-CANCELLED
 15607        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15608        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15609              MOVE ER-2733        TO WS-ERROR
 15610              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15611
 15612     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15613        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15614        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15615           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15616            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15617              IF PB-COMPANY-ID NOT = 'LAP'
 15618               MOVE ER-2704            TO WS-ERROR
 15619               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15620
 15621     IF CERT-WAS-NOT-FOUND
 15622         GO TO 3999-END-EDIT.
 15623
 15624     IF PB-COMPANY-ID EQUAL 'CDC'
 15625        IF LF-COVERAGE-CANCELLED
 15626           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15627            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15628            MOVE PB-C-LF-CANCEL-DT
 15629                                 TO DC-BIN-DATE-2
 15630            SET ELAPSED-BETWEEN-BIN TO TRUE
 15631*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 281
* EL050.cbl
 15632            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15633            IF DATE-CONVERSION-ERROR
 15634               NEXT SENTENCE
 15635             ELSE
 15636                IF DC-ELAPSED-DAYS GREATER +60
 15637                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15638
 15639     IF PB-COMPANY-ID EQUAL 'CDC'
 15640        IF AH-COVERAGE-CANCELLED
 15641           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15642            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15643            MOVE PB-C-AH-CANCEL-DT
 15644                                 TO DC-BIN-DATE-2
 15645            MOVE +0              TO DC-ELAPSED-DAYS
 15646                                    DC-ELAPSED-MONTHS
 15647            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15648*           MOVE 1               TO DC-OPTION-CODE
 15649            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15650            IF DATE-CONVERSION-ERROR
 15651               NEXT SENTENCE
 15652             ELSE
 15653                IF DC-ELAPSED-DAYS GREATER +60
 15654                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15655
 15656     MOVE +0                     TO DC-ELAPSED-DAYS
 15657                                    DC-ELAPSED-MONTHS.
 15658
 15659     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15660        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15661          MOVE 'Z'                TO PB-CI-OB-FLAG
 15662          MOVE ER-2767            TO WS-ERROR
 15663          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15664          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15665          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15666          GO TO 3775-OVER-REF-CHK
 15667        ELSE
 15668          MOVE ZEROS              TO PB-CI-LIVES
 15669                                     PB-C-LIVES
 15670          IF PB-CI-OB-FLAG NOT = 'B'
 15671             MOVE SPACE           TO PB-CI-OB-FLAG.
 15672
 15673     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15674         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15675     ELSE
 15676         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15677
 15678     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15679        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15680            MOVE ER-2760         TO WS-ERROR
 15681            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15682
 15683     IF LF-COVERAGE-CANCELLED
 15684        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15685         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15686            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15687               MOVE ER-2774       TO WS-ERROR
 15688               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15689
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 282
* EL050.cbl
 15690     IF AH-COVERAGE-CANCELLED
 15691        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15692         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15693            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15694               MOVE ER-2775       TO WS-ERROR
 15695               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15696
 15697     IF LF-COVERAGE-CANCELLED
 15698        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15699         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15700            MOVE ER-2776         TO WS-ERROR
 15701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15702
 15703     IF AH-COVERAGE-CANCELLED
 15704        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15705         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15706            MOVE ER-2777         TO WS-ERROR
 15707            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15708
 15709     IF LF-COVERAGE-CANCELLED
 15710        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15711        if pb-ci-lf-expire-dt = low-values or spaces
 15712           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15713           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15714           MOVE PB-CI-EXTENTION-DAYS
 15715                                 TO DC-ELAPSED-DAYS
 15716           SET BIN-PLUS-ELAPSED  TO TRUE
 15717           PERFORM 8500-DATE-CONVERT
 15718                                 THRU 8500-EXIT
 15719           IF DATE-CONVERSION-ERROR
 15720              move low-values    to dc-bin-date-2
 15721           end-if
 15722        else
 15723           move pb-ci-lf-expire-dt
 15724                                 to dc-bin-date-2
 15725        end-if
 15726        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15727           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15728                             OR  'FIA'
 15729              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15730           ELSE
 15731              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15732              MOVE ER-2731       TO WS-ERROR
 15733              PERFORM 9900-ERROR-FORMAT
 15734                                 THRU 9900-EXIT
 15735           end-if
 15736        end-if
 15737     end-if
 15738*    IF LF-COVERAGE-CANCELLED
 15739*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15740*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15741*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15742*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15743*        SET BIN-PLUS-ELAPSED      TO TRUE
 15744*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15745*        IF DATE-CONVERSION-ERROR
 15746*           NEXT SENTENCE
 15747*         ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 283
* EL050.cbl
 15748*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15749*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15750*                            OR  'FIA'
 15751*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15752*              ELSE
 15753*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15754*               MOVE ER-2731       TO WS-ERROR
 15755*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15756     .
 15757 3705-EDIT-AH-CANCEL-DT.
 15758     IF AH-COVERAGE-CANCELLED
 15759        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15760        if pb-ci-AH-expire-dt = low-values or spaces
 15761           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15762           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15763           MOVE PB-CI-EXTENTION-DAYS
 15764                                 TO DC-ELAPSED-DAYS
 15765           SET BIN-PLUS-ELAPSED  TO TRUE
 15766           PERFORM 8500-DATE-CONVERT
 15767                                 THRU 8500-EXIT
 15768           IF DATE-CONVERSION-ERROR
 15769              move low-values    to dc-bin-date-2
 15770           end-if
 15771        else
 15772           move pb-ci-ah-expire-dt
 15773                                 to dc-bin-date-2
 15774        end-if
 15775        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15776           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15777                             OR  'FIA'
 15778              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15779           ELSE
 15780              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15781              MOVE ER-2771       TO WS-ERROR
 15782              PERFORM 9900-ERROR-FORMAT
 15783                                 THRU 9900-EXIT
 15784           end-if
 15785        end-if
 15786     end-if
 15787*    IF AH-COVERAGE-CANCELLED
 15788*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15789*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15790*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15791*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15792**       MOVE 6                    TO DC-OPTION-CODE
 15793*        SET BIN-PLUS-ELAPSED      TO TRUE
 15794*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15795*        IF DATE-CONVERSION-ERROR
 15796*           NEXT SENTENCE
 15797*         ELSE
 15798*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15799*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15800*                             OR 'FIA'
 15801*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15802*             ELSE
 15803*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15804*              MOVE ER-2771       TO WS-ERROR
 15805*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 284
* EL050.cbl
 15806     .
 15807 3705-EDIT-CONTINUED.
 15808
 15809*    IF LF-COVERAGE-CANCELLED
 15810*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15811*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15812*            MOVE ER-2727         TO WS-ERROR
 15813*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15814*
 15815*    IF AH-COVERAGE-CANCELLED
 15816*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15817*        IF PB-COMPANY-ID = 'ACE'
 15818*           MOVE ER-2727        TO WS-ERROR
 15819*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15820*        ELSE
 15821*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15822*              MOVE ER-2727     TO WS-ERROR
 15823*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15824
 15825     IF PB-COMPANY-ID = 'ACE'
 15826       IF AH-COVERAGE-CANCELLED
 15827         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15828           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15829              MOVE ER-2732      TO WS-ERROR
 15830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15831
 15832     IF PB-COMPANY-ID      EQUAL   'HER'
 15833        IF WS-ERROR        EQUAL   ER-2727
 15834            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15835            MOVE  ER-2725          TO  WS-ERROR
 15836            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15837
 15838     IF PB-C-CLAIM-CREATED-CANCEL
 15839            MOVE ER-2748         TO WS-ERROR
 15840            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15841
 15842     IF PB-C-LAST-NAME NOT = SPACES
 15843         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15844            MOVE ER-2747         TO WS-ERROR
 15845            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15846
 15847 3710-EDIT-LUMP-SUM-PRIOR.
 15848
 15849     IF AH-COVERAGE-CANCELLED
 15850         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15851             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15852                MOVE ER-2735    TO WS-ERROR
 15853                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15854
 15855     IF LF-COVERAGE-CANCELLED
 15856         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15857             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15858                MOVE ER-2735    TO WS-ERROR
 15859                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15860
 15861 3710-EDIT-PRIOR-DEATH.
 15862
 15863*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 285
* EL050.cbl
 15864*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15865*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15866*           (NOT PB-CI-OB)
 15867*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15868*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15869*                   MOVE ER-2732  TO WS-ERROR
 15870*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15871*
 15872*    IF AH-COVERAGE-CANCELLED
 15873*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15874*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15875*           (NOT PB-CI-OB)
 15876*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15877*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15878*                   MOVE ER-2732  TO WS-ERROR
 15879*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15880
 15881     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15882         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15883            (NOT PB-COMP-LF-CANCEL)
 15884             NEXT SENTENCE
 15885         ELSE
 15886           IF PB-C-LF-CANCEL-VOIDED
 15887              NEXT SENTENCE
 15888           ELSE
 15889              MOVE ER-2753      TO WS-ERROR
 15890              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15891
 15892     IF CANCEL-FUTURE-DT
 15893         GO TO 3999-END-EDIT.
 15894
 15895 3715-GET-REMAIN-TERM-LF.
 15896
 15897     IF NO-LF-BENEFIT-MATCH  OR
 15898        WS-LF-BENEFIT-CD = ZEROS
 15899        GO TO 3730-GET-AH-REMAIN-TERM.
 15900
 15901     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15902     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15903     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15904     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15905     MOVE PB-SV-STATE            TO CP-STATE.
 15906     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15907     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15908     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15909     MOVE '2'                    TO CP-PROCESS-TYPE.
 15910     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15911     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15912     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15913     IF (PB-COMPANY-ID = 'CID')
 15914        AND (CP-STATE-STD-ABBRV = 'WI')
 15915        MOVE '7'                 TO CP-REM-TERM-METHOD
 15916        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15917     ELSE
 15918        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15919        MOVE WS-REM-TRM-CALC-OPTION
 15920                                 TO CP-REM-TRM-CALC-OPTION
 15921     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 286
* EL050.cbl
 15922**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15923     IF (PB-COMPANY-ID = 'CID')
 15924        AND (CP-STATE-STD-ABBRV = 'MO')
 15925        AND (PB-CERT-EFF-DT >= X'9B41')
 15926        AND (PB-CERT-EFF-DT <= X'A2FB')
 15927        MOVE '7'                 TO CP-REM-TERM-METHOD
 15928        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15929     END-IF
 15930     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15931                                    CP-LOAN-TERM.
 15932     IF CP-TRUNCATED-LIFE
 15933        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15934
 15935     IF CP-TERM-IS-DAYS
 15936         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15937     ELSE
 15938         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15939
 15940     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15941
 15942     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15943
 15944     IF LF-COVERAGE-CANCELLED
 15945        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15946        NEXT SENTENCE
 15947      ELSE
 15948          GO TO 3730-GET-AH-REMAIN-TERM.
 15949
 15950 3720-GET-LF-REFUND.
 15951
 15952     IF PB-C-LF-CANCEL-VOIDED
 15953        GO TO 3730-GET-AH-REMAIN-TERM
 15954     end-if
 15955
 15956     IF PB-COMPANY-ID EQUAL 'BOA'
 15957         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15958         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15959         GO TO 3730-GET-AH-REMAIN-TERM.
 15960
 15961     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15962        (WS-AH-SPECIAL-CALC-CD = 'M')
 15963         MOVE ER-2767            TO WS-ERROR
 15964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15965         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15966         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15967         GO TO 3780-UPDATE-CANCEL-CERT.
 15968
 15969*    if (ws-lf-earnings-calc = '6')
 15970*       or (pb-c-lf-refund-override = '6')
 15971*       move cp-remaining-term-1 to cp-remaining-term-2
 15972*    end-if
 15973     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15974
 15975     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15976     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15977     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15978     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15979     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 287
* EL050.cbl
 15980     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15981     IF (PB-COMPANY-ID = 'DCC')
 15982        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15983        IF PDEF-MASTER-FOUND
 15984           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15985              (V1 > +8)
 15986              OR (PD-PROD-CODE (V1) = 'L')
 15987           END-PERFORM
 15988           IF V1 < +9
 15989              MOVE PD-MAX-AMT (V1)
 15990                           TO CP-R-MAX-TOT-BEN
 15991                              EC-AM-LF-MAX-TOT-BEN
 15992           END-IF
 15993        ELSE
 15994        MOVE ' '                 TO PDEF-MASTER-SW
 15995        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15996        MOVE PB-STATE            TO ERPDEF-STATE
 15997        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15998        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15999        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16000        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16001        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16002        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16003        IF PDEF-MASTER-FOUND
 16004           MOVE 'N'              TO PDEF-MASTER-SW
 16005           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16006           IF PDEF-MASTER-FOUND
 16007              IF (ERPDEF-KEY-SAVE (1:16) =
 16008                           PD-CONTROL-PRIMARY (1:16))
 16009                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16010                 CONTINUE
 16011              ELSE
 16012                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16013                 IF (ERPDEF-KEY-SAVE (1:16) =
 16014                           PD-CONTROL-PRIMARY (1:16))
 16015                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16016                    CONTINUE
 16017                 ELSE
 16018                    MOVE 'N'     TO PDEF-MASTER-SW
 16019                 END-IF
 16020              END-IF
 16021
 16022              IF PDEF-MASTER-FOUND
 16023                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16024                    (V1 > +8)
 16025                    OR (PD-PROD-CODE (V1) = 'L')
 16026                 END-PERFORM
 16027                 IF V1 < +9
 16028                    MOVE PD-MAX-AMT (V1)
 16029                                 TO CP-R-MAX-TOT-BEN
 16030                                    EC-AM-LF-MAX-TOT-BEN
 16031                 END-IF
 16032              END-IF
 16033           END-IF
 16034           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16035        END-IF
 16036        END-IF
 16037     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 288
* EL050.cbl
 16038     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16039
 16040     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16041
 16042     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16043                                    PB-C-LF-REM-TERM.
 16044
 16045     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16046     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16047
 16048     IF PB-COMPANY-ID EQUAL 'FLC'
 16049        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16050           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16051           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16052                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16053                    - CM-LF-ITD-DEATH-AMT
 16054           IF PB-C-LF-REF-CALC LESS THAN +0
 16055              MOVE +0            TO PB-C-LF-REF-CALC
 16056              GO TO 3730-GET-AH-REMAIN-TERM
 16057           ELSE
 16058              GO TO 3730-GET-AH-REMAIN-TERM.
 16059
 16060     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16061                            OR '4' OR '5' OR '6' OR '8'
 16062                            OR '9' OR 'G'
 16063        MOVE PB-C-LF-REFUND-OVERRIDE
 16064                                 TO CP-EARNING-METHOD.
 16065
 16066     if pb-company-id = 'AHL'
 16067        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16068        if cp-class-code = spaces
 16069           move zeros            to cp-class-code
 16070        end-if
 16071     ELSE
 16072        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16073     END-IF
 16074*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16075     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16076     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16077                                    CP-RATING-BENEFIT-AMT.
 16078     IF CP-STATE-STD-ABBRV = 'OR'
 16079         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16080                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16081     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16082     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16083     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16084     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16085     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16086     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16087     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16088     IF WS-DEFAULT-APR NOT NUMERIC
 16089         MOVE ZEROS TO WS-DEFAULT-APR.
 16090****   N O T E   ****
 16091*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16092*      THE OH HARD CODING IN ELCRFNDP
 16093
 16094     IF PB-COMPANY-ID = 'CID'
 16095        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 289
* EL050.cbl
 16096           MOVE WS-LF-EARNINGS-CALC
 16097                                 TO CP-EARNING-METHOD
 16098        END-IF
 16099     END-IF
 16100
 16101****   N O T E   ****
 16102
 16103     IF CP-EARN-AS-NET-PAY
 16104         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16105            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16106                MOVE WS-DEFAULT-APR
 16107                                 TO  CP-LOAN-APR
 16108                MOVE ER-3780     TO  WS-ERROR
 16109                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16110            ELSE
 16111                MOVE ER-3781     TO  WS-ERROR
 16112                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16113*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16114     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16115
 16116     IF CP-REFUND-TYPE-USED NOT = SPACE
 16117         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16118
 16119     IF CP-ERROR-RATE-IS-ZERO OR
 16120        CP-ERROR-RATE-NOT-FOUND
 16121        MOVE ER-2740             TO WS-ERROR
 16122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16123
 16124     IF CP-ERROR-RATE-FILE-NOTOPEN
 16125        MOVE ER-2617             TO WS-ERROR
 16126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16127
 16128     IF PB-COMPANY-ID = 'DCC'
 16129        AND PB-CI-ENTRY-STATUS = 'M'
 16130        MOVE +0                  TO PB-C-LF-REF-CALC
 16131     ELSE
 16132        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16133     END-IF
 16134
 16135     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16136         GO TO 3730-GET-AH-REMAIN-TERM.
 16137
 16138*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16139*       ADD +1                   TO PB-C-LF-REM-TERM
 16140*                                   CP-REMAINING-TERM
 16141*                                   CP-ORIGINAL-TERM.
 16142
 16143     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16144     MOVE '2'                    TO CP-EARNING-METHOD
 16145                                    CP-RATING-METHOD.
 16146     IF PB-COMPANY-ID = 'CID'
 16147        IF (CP-STATE-STD-ABBRV = 'MN')
 16148           AND (PB-CERT-EFF-DT > X'A4FF')
 16149           AND (WS-LF-EARNINGS-CALC = 'B')
 16150           MOVE '5'              TO CP-EARNING-METHOD
 16151           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16152        END-IF
 16153     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 290
* EL050.cbl
 16154     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16155                                        CP-REMAINING-BENEFIT
 16156                                        CP-RATING-BENEFIT-AMT.
 16157     IF CP-STATE-STD-ABBRV = 'OR'
 16158         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16159                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16160     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16161     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16162
 16163     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16164
 16165     IF CP-ERROR-RATE-IS-ZERO OR
 16166        CP-ERROR-RATE-NOT-FOUND
 16167        MOVE ER-2740             TO WS-ERROR
 16168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16169
 16170     IF CP-ERROR-RATE-FILE-NOTOPEN
 16171        MOVE ER-2617             TO WS-ERROR
 16172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16173
 16174     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16175
 16176******************************************************************
 16177
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 291
* EL050.cbl
 16179 3730-GET-AH-REMAIN-TERM.
 16180     IF NO-AH-BENEFIT-MATCH  OR
 16181        WS-AH-BENEFIT-CD = ZEROS
 16182         GO TO 3770-CHECK-REFUNDS.
 16183
 16184     IF PB-CI-AH-LUMP-SUM-DISAB
 16185         IF  PB-C-AH-CANCEL-AMT = ZERO
 16186            IF NOT PB-COMP-AH-CANCEL
 16187             GO TO 3770-CHECK-REFUNDS.
 16188
 16189     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16190     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16191     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16192     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16193     MOVE PB-SV-STATE            TO CP-STATE.
 16194     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16195     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16196     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16197     MOVE '2'                    TO CP-PROCESS-TYPE.
 16198     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16199     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16200     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16201     IF (PB-COMPANY-ID = 'CID')
 16202        AND (CP-STATE-STD-ABBRV = 'WI')
 16203        MOVE '7'                 TO CP-REM-TERM-METHOD
 16204        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16205     ELSE
 16206        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16207        MOVE WS-REM-TRM-CALC-OPTION
 16208                                 TO CP-REM-TRM-CALC-OPTION
 16209     END-IF
 16210     IF (PB-COMPANY-ID = 'CID')
 16211        AND (CP-STATE-STD-ABBRV = 'MO')
 16212        AND (PB-CERT-EFF-DT >= X'9B41')
 16213        AND (PB-CERT-EFF-DT <= X'A2FB')
 16214        MOVE '7'                 TO CP-REM-TERM-METHOD
 16215        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16216     END-IF
 16217     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16218                                    CP-LOAN-TERM.
 16219     IF NOT CP-TERM-IS-DAYS
 16220         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16221
 16222     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16223
 16224     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16225
 16226     IF AH-COVERAGE-CANCELLED
 16227        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16228        NEXT SENTENCE
 16229      ELSE
 16230         GO TO 3770-CHECK-REFUNDS.
 16231
 16232 3740-GET-AH-REFUND.
 16233
 16234     IF PB-C-AH-CANCEL-VOIDED
 16235        GO TO 3780-UPDATE-CANCEL-CERT
 16236     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 292
* EL050.cbl
 16237
 16238     IF PB-COMPANY-ID = 'BOA'
 16239         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16240         GO TO 3770-CHECK-REFUNDS.
 16241
 16242     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16243*    MOVE ' '                    TO DC-OPTION-CODE
 16244     SET BIN-TO-GREG             TO TRUE
 16245     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16246     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16247                                    PB-C-AH-REM-TERM.
 16248     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16249     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16250
 16251     IF PB-COMPANY-ID EQUAL 'FLC'
 16252        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16253           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16254           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16255                    - CM-AH-ITD-AH-PMT)
 16256           IF PB-C-AH-REF-CALC LESS THAN +0
 16257              MOVE +0            TO PB-C-AH-REF-CALC
 16258              GO TO 3770-CHECK-REFUNDS
 16259           ELSE
 16260              GO TO 3770-CHECK-REFUNDS.
 16261
 16262     IF PB-COMPANY-ID = 'DCC'
 16263        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16264            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16265           MOVE 'S'              TO CP-EARNING-METHOD
 16266        END-IF
 16267     END-IF
 16268     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16269                            OR '4' OR '5' OR '6' OR '8'
 16270                            OR '9' OR 'G' OR 'S'
 16271        MOVE PB-C-AH-REFUND-OVERRIDE
 16272                                 TO CP-EARNING-METHOD.
 16273
 16274     if pb-company-id = 'AHL'
 16275        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16276        if cp-class-code = spaces
 16277           move zeros            to cp-class-code
 16278        end-if
 16279     ELSE
 16280        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16281     END-IF
 16282*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16283     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16284     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16285                                    CP-RATING-BENEFIT-AMT.
 16286     IF CP-STATE-STD-ABBRV = 'OR'
 16287         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16288                                         PB-CI-AH-TERM.
 16289     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16290     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16291     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16292     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16293     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16294     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 293
* EL050.cbl
 16295
 16296     IF CP-STATE-STD-ABBRV = 'OH'
 16297        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16298                                AND 'CID' AND 'DCC' AND 'AHL')
 16299           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16300              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16301              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16302              MOVE '6' TO CP-EARNING-METHOD
 16303           END-IF
 16304        END-IF
 16305        IF PB-COMPANY-ID = 'CID'
 16306           IF NO-LIFE-COVERAGE
 16307              IF CP-CRITICAL-PERIOD
 16308                 MOVE '2'       TO CP-EARNING-METHOD
 16309              ELSE
 16310                 MOVE '6'       TO CP-EARNING-METHOD
 16311              END-IF
 16312           ELSE
 16313              IF WS-LF-COVERAGE-TYPE = 'L'
 16314                 MOVE '2'       TO CP-EARNING-METHOD
 16315              ELSE
 16316                 IF (PB-CI-LF-TERM > +60) OR
 16317                    (WS-LF-EARNINGS-CALC = '5')
 16318                    IF CP-CRITICAL-PERIOD
 16319                       MOVE '2'  TO CP-EARNING-METHOD
 16320                    ELSE
 16321                       MOVE '6'  TO CP-EARNING-METHOD
 16322                    END-IF
 16323                 ELSE
 16324                    MOVE '1'     TO CP-EARNING-METHOD
 16325                 END-IF
 16326              END-IF
 16327           END-IF
 16328        END-IF
 16329     END-IF
 16330
 16331*    IF CP-STATE-STD-ABBRV = 'VA'
 16332*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16333*          IF CP-ORIGINAL-TERM GREATER 61
 16334*             MOVE '6' TO CP-EARNING-METHOD
 16335*          ELSE
 16336*             MOVE '1' TO CP-EARNING-METHOD.
 16337
 16338     IF WS-DEFAULT-APR NOT NUMERIC
 16339         MOVE ZEROS TO WS-DEFAULT-APR.
 16340     IF CP-EARN-AS-NET-PAY
 16341         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16342            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16343                MOVE WS-DEFAULT-APR
 16344                                 TO  CP-LOAN-APR
 16345                MOVE ER-3780     TO  WS-ERROR
 16346                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16347            ELSE
 16348                MOVE ER-3781     TO  WS-ERROR
 16349                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16350     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16351     IF PB-COMPANY-ID = 'DCC'
 16352        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 294
* EL050.cbl
 16353        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16354        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16355     END-IF
 16356     IF PB-COMPANY-ID = 'DCC'
 16357        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16358        AND (CP-EARNING-METHOD = 'D')
 16359        AND (CP-CANCEL-REASON NOT = 'R')
 16360        CONTINUE
 16361     ELSE
 16362        GO TO 3750-CONTINUE
 16363     END-IF
 16364     MOVE ' '                    TO DD-IU-SW
 16365     IF NOT PDEF-MASTER-FOUND
 16366        MOVE ' '                 TO PDEF-MASTER-SW
 16367        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16368        MOVE PB-STATE            TO ERPDEF-STATE
 16369        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16370        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16371        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16372        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16373        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16374        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16375        IF PDEF-MASTER-FOUND
 16376           MOVE 'N'              TO PDEF-MASTER-SW
 16377           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16378           IF PDEF-MASTER-FOUND
 16379              IF (ERPDEF-KEY-SAVE (1:16) =
 16380                           PD-CONTROL-PRIMARY (1:16))
 16381                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16382                 CONTINUE
 16383              ELSE
 16384                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16385                 IF (ERPDEF-KEY-SAVE (1:16) =
 16386                           PD-CONTROL-PRIMARY (1:16))
 16387                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16388                    CONTINUE
 16389                 ELSE
 16390                    MOVE ER-2740 TO WS-ERROR
 16391                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16392                    GO TO 3770-CHECK-REFUNDS
 16393                 END-IF
 16394              END-IF
 16395           END-IF
 16396           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16397        END-IF
 16398     END-IF
 16399     IF PDEF-MASTER-FOUND
 16400        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16401           (V1 > +8)
 16402           OR (PD-PROD-CODE (V1) = 'I')
 16403        END-PERFORM
 16404        IF V1 < +9
 16405           SET DD-IU-PRESENT        TO TRUE
 16406        END-IF
 16407        IF WS-AH-DCC-TRUNC = 'T'
 16408           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16409        ELSE
 16410           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 295
* EL050.cbl
 16411        END-IF
 16412        EVALUATE TRUE
 16413           WHEN WS-TERM > +168
 16414              MOVE 15               TO V1
 16415           WHEN WS-TERM > +156
 16416              MOVE 14               TO V1
 16417           WHEN WS-TERM > +144
 16418              MOVE 13               TO V1
 16419           WHEN WS-TERM > +132
 16420              MOVE 12               TO V1
 16421           WHEN WS-TERM > +120
 16422              MOVE 11               TO V1
 16423           WHEN WS-TERM > +108
 16424              MOVE 10               TO V1
 16425           WHEN WS-TERM > +96
 16426              MOVE 9                TO V1
 16427           WHEN WS-TERM > +84
 16428              MOVE 8                TO V1
 16429           WHEN WS-TERM > +72
 16430              MOVE 7                TO V1
 16431           WHEN WS-TERM > +60
 16432              MOVE 6                TO V1
 16433           WHEN WS-TERM > +48
 16434              MOVE 5                TO V1
 16435           WHEN WS-TERM > +36
 16436              MOVE 4                TO V1
 16437           WHEN WS-TERM > +24
 16438              MOVE 3                TO V1
 16439           WHEN WS-TERM > +12
 16440              MOVE 2                TO V1
 16441           WHEN OTHER
 16442              MOVE 1                TO V1
 16443        END-EVALUATE
 16444
 16445        EVALUATE TRUE
 16446*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16447*             < +13)
 16448*             AND (DD-IU-PRESENT)
 16449*             MOVE 2                TO V2
 16450*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16451*             MOVE 1                TO V2
 16452           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16453              MOVE 2                TO V2
 16454           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16455              MOVE 3                TO V2
 16456           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16457              MOVE 4                TO V2
 16458           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16459              MOVE 5                TO V2
 16460           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16461              MOVE 6                TO V2
 16462           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16463              MOVE 7                TO V2
 16464           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16465              MOVE 8                TO V2
 16466           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16467              MOVE 9                TO V2
 16468           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 296
* EL050.cbl
 16469              MOVE 10               TO V2
 16470           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16471              MOVE 11               TO V2
 16472           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16473              MOVE 12               TO V2
 16474           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16475              MOVE 13               TO V2
 16476           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16477              MOVE 14               TO V2
 16478           WHEN OTHER
 16479              MOVE 15               TO V2
 16480        END-EVALUATE
 16481
 16482        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16483                                 TO CP-DDF-LO-FACT
 16484        MOVE PD-UEP-FACTOR (V1 V2)
 16485                                 TO CP-DDF-HI-FACT
 16486
 16487        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16488        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16489        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16490           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16491        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16492        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16493        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16494           + PD-1ST-YR-ADMIN-ALLOW
 16495
 16496        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16497*       IF PI-CLP-YN = 'Y'
 16498*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16499*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16500*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16501*       END-IF
 16502
 16503        IF DD-IU-PRESENT
 16504           MOVE 'I'              TO CP-EARNING-METHOD
 16505        END-IF
 16506        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16507                                     CP-CLP-RATE-UP
 16508        IF CP-IU-RATE-UP NOT = ZEROS
 16509           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16510              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16511           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16512              / (1 - WS-WORK-FACT)
 16513        END-IF
 16514     END-IF
 16515     .
 16516 3750-CONTINUE.
 16517     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16518
 16519     IF CP-REFUND-TYPE-USED NOT = SPACE
 16520         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16521
 16522     IF CP-ERROR-RATE-IS-ZERO OR
 16523        CP-ERROR-RATE-NOT-FOUND
 16524        MOVE ER-2740             TO WS-ERROR
 16525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 297
* EL050.cbl
 16527     IF CP-ERROR-RATE-FILE-NOTOPEN
 16528        MOVE ER-2617             TO WS-ERROR
 16529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16530     IF PB-COMPANY-ID = 'DCC'
 16531        AND PB-CI-ENTRY-STATUS = 'M'
 16532        MOVE +0                  TO PB-C-AH-REF-CALC
 16533     ELSE
 16534        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16535     END-IF
 16536     IF PB-COMPANY-ID = 'DCC'
 16537        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16538        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16539        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16540        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16541        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16542        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16543        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16544        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16545*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16546     END-IF
 16547     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 298
* EL050.cbl
 16549
 16550 3770-CHECK-REFUNDS.
 16551
 16552     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16553        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16554           MOVE ER-2766          TO WS-ERROR
 16555           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16556           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16557           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16558              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16559
 16560     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16561        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16562           MOVE ER-2766          TO WS-ERROR
 16563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16564           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16565           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16566              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16567
 16568     IF PB-COMP-LF-CANCEL
 16569        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16570        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16571           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16572              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16573
 16574     IF PB-COMP-AH-CANCEL
 16575        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16576        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16577           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16578              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16579
 16580     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16581             GIVING WS-UNSIGN-WRK1
 16582     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16583             GIVING WS-UNSIGN-WRK2.
 16584
 16585     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16586         MOVE ZERO TO WS-UNSIGN-WRK1.
 16587
 16588     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16589         MOVE ZERO TO WS-UNSIGN-WRK2.
 16590
 16591     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16592
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 299
* EL050.cbl
 16594
 16595 3772-CONTINUE.
 16596
 16597**********************************
 16598*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16599*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16600*** DOUBLES THE TOLERANCE AMOUNT.
 16601***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16602**********************************
 16603     IF PB-COMPANY-ID = 'MON'
 16604     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16605         IF WS-REF-REJECT-SW = SPACE
 16606             MOVE ER-2754        TO WS-ERROR
 16607             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16608           ELSE
 16609             MOVE ER-2736        TO WS-ERROR
 16610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16611**********************************
 16612
 16613 3773-CONTINUE.
 16614
 16615     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16616        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16617           MOVE ER-2723          TO WS-ERROR
 16618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16619
 16620     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16621        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16622           MOVE ER-2724          TO WS-ERROR
 16623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16624
 16625     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16626         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16627             (1 + WS-LF-REFUND-OVS-PCT)
 16628     ELSE
 16629         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16630
 16631     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16632         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16633             (1 - WS-TOL-LF-REFUND-PCT)
 16634     ELSE
 16635         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16636
 16637     IF (PB-COMPANY-ID = 'DCC')
 16638        AND (PB-CI-ENTRY-STATUS = 'M')
 16639        AND (PB-C-LF-CANCEL-AMT > +0)
 16640        MOVE ER-3843             TO WS-ERROR
 16641        PERFORM 9900-ERROR-FORMAT
 16642                                 THRU 9900-EXIT
 16643     END-IF
 16644     EVALUATE TRUE
 16645        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16646           CONTINUE
 16647        WHEN PB-C-LF-CANCEL-AMT = +0
 16648                 AND PB-C-LF-REF-CALC > +0
 16649           CONTINUE
 16650        WHEN WS-LF-REFUND-OVS-AMT = 0
 16651                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 300
* EL050.cbl
 16652           CONTINUE
 16653        WHEN OTHER
 16654           IF WS-TOL-LF-REFUND  = +0
 16655              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16656           END-IF
 16657           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16658                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16659                          (PB-C-LF-CANCEL-AMT))
 16660              CONTINUE
 16661           ELSE
 16662              IF WS-LF-REFUND-OVS-AMT = +0
 16663                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16664              END-IF
 16665              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16666                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16667                                       PB-C-LF-CANCEL-AMT)
 16668                 CONTINUE
 16669              ELSE
 16670                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16671                   MOVE ER-2754   TO  WS-ERROR
 16672                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16673                 ELSE
 16674                    MOVE ER-2736   TO  WS-ERROR
 16675                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16676                 END-IF
 16677              END-IF
 16678           END-IF
 16679     END-EVALUATE.
 16680
 16681     EVALUATE TRUE
 16682        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16683           CONTINUE
 16684        WHEN PB-C-LF-CANCEL-AMT = +0
 16685                 AND PB-C-LF-REF-CALC > +0
 16686           CONTINUE
 16687        WHEN OTHER
 16688           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16689               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16690              CONTINUE
 16691           ELSE
 16692              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16693               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16694                CONTINUE
 16695              ELSE
 16696                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16697                     MOVE ER-2754   TO  WS-ERROR
 16698                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16699                 ELSE
 16700                     MOVE ER-2736   TO  WS-ERROR
 16701                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16702                 END-IF
 16703              END-IF
 16704           END-IF
 16705     END-EVALUATE.
 16706
 16707     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16708         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16709             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 301
* EL050.cbl
 16710     ELSE
 16711         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16712
 16713     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16714         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16715             (1 - WS-TOL-AH-REFUND-PCT)
 16716     ELSE
 16717         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16718
 16719     IF (PB-COMPANY-ID = 'DCC')
 16720        AND (PB-CI-ENTRY-STATUS = 'M')
 16721        AND (PB-C-AH-CANCEL-AMT > +0)
 16722        MOVE ER-3843             TO WS-ERROR
 16723        PERFORM 9900-ERROR-FORMAT
 16724                                 THRU 9900-EXIT
 16725     END-IF
 16726     EVALUATE TRUE
 16727        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16728           CONTINUE
 16729*       WHEN PB-C-AH-REF-CALC = +0 AND
 16730*                  PB-C-AH-CANCEL-AMT > +0
 16731        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16732                   PB-C-AH-REF-CALC > +0
 16733           CONTINUE
 16734        WHEN WS-AH-REFUND-OVS-AMT = +0
 16735                AND WS-TOL-AH-REFUND = +0
 16736           CONTINUE
 16737        WHEN OTHER
 16738           IF WS-TOL-AH-REFUND = +0
 16739              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16740           END-IF
 16741           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16742               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16743                                         PB-C-AH-CANCEL-AMT)
 16744              CONTINUE
 16745           ELSE
 16746              IF WS-AH-REFUND-OVS-AMT = +0
 16747                 MOVE +9999999.99 TO
 16748                         WS-AH-REFUND-OVS-AMT
 16749              END-IF
 16750              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16751                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16752                                         PB-C-AH-CANCEL-AMT)
 16753                 CONTINUE
 16754              ELSE
 16755                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16756                    MOVE ER-2754   TO  WS-ERROR
 16757                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16758                 ELSE
 16759                    MOVE ER-2736   TO  WS-ERROR
 16760                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16761                 END-IF
 16762              END-IF
 16763           END-IF
 16764     END-EVALUATE.
 16765
 16766     EVALUATE TRUE
 16767        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 302
* EL050.cbl
 16768           CONTINUE
 16769*       WHEN PB-C-AH-REF-CALC > +0 AND
 16770*                  PB-C-AH-CANCEL-AMT = +0
 16771        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16772                   PB-C-AH-REF-CALC = +0
 16773           CONTINUE
 16774        WHEN OTHER
 16775           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16776               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16777              CONTINUE
 16778           ELSE
 16779              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16780                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16781                 CONTINUE
 16782              ELSE
 16783                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16784                     MOVE ER-2754   TO  WS-ERROR
 16785                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16786                 ELSE
 16787                     MOVE ER-2736   TO  WS-ERROR
 16788                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16789                 END-IF
 16790              END-IF
 16791           END-IF
 16792     END-EVALUATE.
 16793
 16794     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16795        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16796        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16797           AND  PB-C-LF-REF-CALC < +1.00
 16798           AND  PB-C-AH-REF-CALC < +1.00
 16799           CONTINUE
 16800        ELSE
 16801           IF (PB-COMPANY-ID = 'DCC')
 16802              AND (PB-CI-ENTRY-STATUS = 'M')
 16803              CONTINUE
 16804           ELSE
 16805              MOVE ER-2741       TO WS-ERROR
 16806              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16807           END-IF
 16808        END-IF
 16809     END-IF
 16810
 16811     IF (PB-C-LF-CANCEL-AMT = ZERO
 16812        AND WS-LF-BENEFIT-CD NOT = ZERO
 16813        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16814        AND PB-C-LF-REF-CALC NOT = ZERO)
 16815        OR
 16816        (PB-C-LF-CANCEL-AMT = ZERO
 16817        AND WS-LF-BENEFIT-CD NOT = ZERO
 16818        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16819             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16820                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16821                NEXT SENTENCE
 16822             ELSE
 16823                MOVE ER-2739        TO WS-ERROR
 16824                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16825
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 303
* EL050.cbl
 16826     IF (PB-C-AH-CANCEL-AMT = ZERO
 16827        AND WS-AH-BENEFIT-CD NOT = ZERO
 16828        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16829        AND PB-C-AH-REF-CALC NOT = ZERO)
 16830        OR
 16831        (PB-C-AH-CANCEL-AMT = ZERO
 16832        AND WS-AH-BENEFIT-CD NOT = ZERO
 16833        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16834             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16835                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16836                NEXT SENTENCE
 16837             ELSE
 16838                MOVE ER-2738        TO WS-ERROR
 16839                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840
 16841 3775-OVER-REF-CHK.
 16842
 16843     IF PB-CI-ENTRY-STATUS = '5'
 16844        GO TO 3780-UPDATE-CANCEL-CERT.
 16845
 16846     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16847                              PB-CI-LF-ALT-PREMIUM-AMT.
 16848
 16849     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16850        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16851                                 PB-C-LF-REF-CALC
 16852      ELSE
 16853        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16854                                 PB-C-LF-CANCEL-AMT.
 16855
 16856     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16857        MOVE ER-2755             TO WS-ERROR
 16858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16859
 16860     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16861
 16862     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16863        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16864                                 PB-C-AH-REF-CALC
 16865      ELSE
 16866        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16867                                 PB-C-AH-CANCEL-AMT.
 16868
 16869     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16870        MOVE ER-2778             TO WS-ERROR
 16871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16872
 16873     IF PB-CI-OB-FLAG NOT = 'Z'
 16874        NEXT SENTENCE
 16875       ELSE
 16876         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16877            MOVE ER-2757           TO WS-ERROR
 16878            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16879
 16880 3780-UPDATE-CANCEL-CERT.
 16881
 16882     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16883        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 304
* EL050.cbl
 16884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16885
 16886     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16887         MOVE ER-2729              TO WS-ERROR
 16888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16889
 16890     IF PB-CI-LF-BENEFIT-CD = ZERO
 16891         GO TO 3780-UPDATE-CONT-1.
 16892
 16893     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16894         GO TO 3780-UPDATE-CONT-1.
 16895
 16896     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16897       AND
 16898        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16899       AND
 16900        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16901       AND
 16902        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16903            NEXT SENTENCE
 16904       ELSE
 16905        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16906          AND
 16907***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16908***       AND
 16909           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16910            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16911               MOVE ER-2730      TO WS-ERROR
 16912               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16913               GO TO 3999-END-EDIT
 16914            ELSE
 16915               GO TO 3999-END-EDIT
 16916        ELSE
 16917            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16918               MOVE ER-2765           TO WS-ERROR
 16919               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16920               GO TO 3785-CHECK-NH.
 16921*              GO TO 3999-END-EDIT.
 16922
 16923 3780-UPDATE-CONT-1.
 16924     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16925
 16926     IF PB-CI-AH-BENEFIT-CD = ZERO
 16927         GO TO 3780-UPDATE-CONT-2.
 16928
 16929     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16930         GO TO 3780-UPDATE-CONT-2.
 16931
 16932     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16933
 16934     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16935       AND
 16936        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16937       AND
 16938        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16939       AND
 16940        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16941            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 305
* EL050.cbl
 16942       ELSE
 16943        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16944          AND
 16945***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16946***       AND
 16947           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16948           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16949            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16950               MOVE ER-2773      TO WS-ERROR
 16951               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16952               GO TO 3999-END-EDIT
 16953            ELSE
 16954               GO TO 3999-END-EDIT
 16955            END-IF
 16956           ELSE
 16957             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16958                IF MSTR-CERT-NO = W-CL-CERT-NO
 16959                   MOVE ER-2890 TO WS-ERROR
 16960                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16961                   GO TO 3999-END-EDIT
 16962                ELSE
 16963                   MOVE ER-2898 TO WS-ERROR
 16964                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16965                   GO TO 3999-END-EDIT
 16966                END-IF
 16967             ELSE
 16968                GO TO 3785-CHECK-NH
 16969             END-IF
 16970           END-IF
 16971          ELSE
 16972            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16973              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16974                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16975                   IF MSTR-CERT-NO = W-CL-CERT-NO
 16976                      MOVE ER-2890 TO WS-ERROR
 16977                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16978                      GO TO 3999-END-EDIT
 16979                   ELSE
 16980                      MOVE ER-2898 TO WS-ERROR
 16981                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16982                      GO TO 3999-END-EDIT
 16983                   END-IF
 16984                ELSE
 16985                   MOVE ER-2765 TO WS-ERROR
 16986                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16987                   GO TO 3785-CHECK-NH
 16988                END-IF
 16989              ELSE
 16990               MOVE ER-2765      TO WS-ERROR
 16991               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16992               GO TO 3785-CHECK-NH.
 16993*              GO TO 3999-END-EDIT.
 16994
 16995 3780-UPDATE-CONT-2.
 16996
 16997     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16998        AND WS-LF-BENEFIT-CD = ZERO
 16999           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 306
* EL050.cbl
 17000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17001
 17002     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17003        AND WS-AH-BENEFIT-CD = ZERO
 17004           MOVE ER-2744           TO WS-ERROR
 17005           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17006
 17007     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17008        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17009        AND
 17010        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17011         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17012           MOVE ER-2746           TO WS-ERROR
 17013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17014
 17015     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17016       AND
 17017        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17018             MOVE ER-2737        TO WS-ERROR
 17019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17020
 17021     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17022       AND
 17023        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17024             MOVE ER-2737        TO WS-ERROR
 17025             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17026
 17027     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17028         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17029             OR 'CID' OR 'DCC' OR 'AHL'
 17030             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17031         ELSE
 17032             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17033                 MOVE ER-2768    TO WS-ERROR
 17034                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17035             ELSE
 17036                 MOVE ER-2756    TO WS-ERROR
 17037                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17038
 17039     IF CERT-PEND-ISSUE-RETURNED
 17040        MOVE ER-2772             TO WS-ERROR
 17041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17042 3785-CHECK-NH.
 17043     IF PB-STATE NOT = 'NH'
 17044        GO TO 3999-END-EDIT
 17045     END-IF
 17046
 17047     MOVE ER-2796                TO WS-ERROR
 17048     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17049     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17050        OR (CM-NH-INTERFACE-SW = 'Y')
 17051        MOVE ER-2793             TO WS-ERROR
 17052        PERFORM 9900-ERROR-FORMAT
 17053                                 THRU 9900-EXIT
 17054     END-IF
 17055     MOVE +0                     TO WS-PAYMENT-AMT
 17056     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17057        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 307
* EL050.cbl
 17058     END-IF
 17059     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17060        GO TO 3999-END-EDIT
 17061     END-IF
 17062     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17063     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17064     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17065        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17066     END-IF
 17067     MOVE '1'                    TO DC-OPTION-CODE
 17068     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17069     IF NO-CONVERSION-ERROR
 17070        IF DC-ELAPSED-DAYS < +16
 17071           GO TO 3999-END-EDIT
 17072        END-IF
 17073     END-IF
 17074     MOVE +0                     TO DC-ELAPSED-DAYS
 17075     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17076     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17077     MOVE '1'                    TO DC-OPTION-CODE
 17078     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17079     IF NO-CONVERSION-ERROR
 17080        IF DC-ELAPSED-DAYS > +30
 17081           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17082        ELSE
 17083           GO TO 3999-END-EDIT
 17084        END-IF
 17085     ELSE
 17086        GO TO 3999-END-EDIT
 17087     END-IF
 17088     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17089        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17090           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17091     IF WS-PAYMENT-AMT < 600.00
 17092        GO TO 3999-END-EDIT
 17093     END-IF
 17094     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17095
 17096     IF (ERMAIL-FOUND = ' ')
 17097         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17098         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17099        GO TO 3999-END-EDIT
 17100     END-IF
 17101     MOVE ER-2795                TO WS-ERROR
 17102     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17103
 17104     GO TO 3999-END-EDIT.
 17105******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 308
* EL050.cbl
 17107 3990-FILES-NOT-OPEN.
 17108
 17109     MOVE ER-2617                TO WS-ERROR.
 17110     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17111     GO TO 9990-RETURN.
 17112
 17113 3999-END-EDIT.
 17114
 17115     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17116
 17117     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17118         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17119         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17120             PERFORM 9250-UNLOCK-RETURN
 17121             GO TO 9990-RETURN
 17122          ELSE
 17123             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17124             GO TO 9990-RETURN.
 17125
 17126     IF PB-CANCELLATION
 17127          GO TO 9990-RETURN.
 17128
 17129     IF CERT-WAS-NOT-FOUND
 17130        MOVE SPACES              TO CERTIFICATE-MASTER.
 17131
 17132     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17133
 17134     IF CERT-WAS-FOUND
 17135         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17136             PERFORM 9250-UNLOCK-RETURN
 17137          ELSE
 17138            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17139      ELSE
 17140         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17141
 17142     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17143        IF PB-COMPANY-ID = 'DCC' AND
 17144           (PB-CARRIER = '2' OR '4' OR '6')
 17145              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17146        END-IF
 17147     END-IF.
 17148
 17149     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17150         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17151     END-IF.
 17152     move ' '                    to ws-ins-age-defaulted
 17153     perform 8150-read-elcrtt    thru 8150-exit
 17154     if ws-ins-age-defaulted = 'Y'
 17155        move er-1573             to ws-error
 17156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17157     end-if
 17158
 17159     if ws-jnt-age-defaulted = 'Y'
 17160        move er-1574             to ws-error
 17161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17162     end-if
 17163
 17164     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 309
* EL050.cbl
 17165     IF ((PB-COMPANY-ID = 'DCC')
 17166        AND (WS-NO-SECURE-PAY))
 17167                  OR
 17168        (WS-LF-SPECIAL-CALC-CD = 'O'
 17169        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17170        SET SKIP-ADDR-EDIT       TO TRUE
 17171     END-IF
 17172     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17173        AND (NOT SKIP-ADDR-EDIT)
 17174        MOVE ER-2963             TO WS-ERROR
 17175        PERFORM 9900-ERROR-FORMAT
 17176                                 THRU 9900-EXIT
 17177        GO TO 9990-RETURN
 17178     END-IF
 17179     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17180     IF ERPNDM-FOUND NOT = 'X'
 17181        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17182           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17183           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17184           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17185           AND (NOT SKIP-ADDR-EDIT)
 17186           MOVE ER-2694          TO WS-ERROR
 17187           PERFORM 9900-ERROR-FORMAT
 17188                                 THRU 9900-EXIT
 17189        END-IF
 17190        MOVE ' '                 TO STATE-RECORD-ERROR
 17191        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17192        MOVE PM-STATE            TO CNTL-ACCESS
 17193        MOVE '3'                 TO CNTL-REC-TYPE
 17194        MOVE +0                  TO CNTL-SEQ-NO
 17195        MOVE '0'                 TO RC-SW-2
 17196        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17197        IF (NO-STATE-RECORD)
 17198           OR (CF-RECORD-TYPE NOT = '3')
 17199           OR (PM-STATE NOT = CF-STATE-CODE)
 17200           IF (PM-STATE = SPACES)
 17201              AND (SKIP-ADDR-EDIT)
 17202              CONTINUE
 17203           ELSE
 17204              MOVE ER-2963       TO WS-ERROR
 17205              PERFORM 9900-ERROR-FORMAT
 17206                                 THRU 9900-EXIT
 17207           END-IF
 17208        END-IF
 17209        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17210           MOVE ER-2883          TO WS-ERROR
 17211           PERFORM 9900-ERROR-FORMAT
 17212                                 THRU 9900-EXIT
 17213        END-IF
 17214        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17215           MOVE ' '                 TO STATE-RECORD-ERROR
 17216           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17217           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17218           MOVE '3'                 TO CNTL-REC-TYPE
 17219           MOVE +0                  TO CNTL-SEQ-NO
 17220           MOVE '0'                 TO RC-SW-2
 17221           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17222           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 310
* EL050.cbl
 17223              OR (CF-RECORD-TYPE NOT = '3')
 17224              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17225              MOVE ER-2964          TO WS-ERROR
 17226              PERFORM 9900-ERROR-FORMAT
 17227                                    THRU 9900-EXIT
 17228           END-IF
 17229        END-IF
 17230     ELSE
 17231        IF NOT SKIP-ADDR-EDIT
 17232           MOVE ER-2393          TO WS-ERROR
 17233           PERFORM 9900-ERROR-FORMAT
 17234                                 THRU 9900-EXIT
 17235        END-IF
 17236     END-IF
 17237
 17238     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17239
 17240     IF (ERMAIL-FOUND = ' ' AND
 17241        ERPNDM-FOUND = ' ')
 17242        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17243           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17244           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17245          OR
 17246           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17247          OR
 17248           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17249           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17250           GO TO 3999-UNLOCK-ERMAIL.
 17251
 17252     IF ERPNDM-FOUND = 'X'
 17253        GO TO 3999-UNLOCK-ERMAIL.
 17254
 17255     IF PM-INSURED-LAST-NAME      = SPACES
 17256        AND PM-INSURED-FIRST-NAME = SPACES
 17257        AND PM-ADDRESS-LINE-1     = SPACES
 17258        AND PM-ADDRESS-LINE-2     = SPACES
 17259        AND PM-CITY-STATE         = SPACES
 17260        AND PM-CRED-BENE-NAME     = SPACES
 17261        AND PM-CRED-BENE-ADDR     = SPACES
 17262        AND PM-CRED-BENE-CTYST    = SPACES
 17263        GO TO 3999-UNLOCK-ERMAIL
 17264     END-IF
 17265
 17266     MOVE SPACES                 TO MAILING-DATA.
 17267
 17268     MOVE 'MA'                   TO MA-RECORD-ID.
 17269     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17270     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17271     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17272     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17273     MOVE PB-SV-STATE            TO MA-STATE.
 17274     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17275     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17276
 17277     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17278     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17279
 17280     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 311
* EL050.cbl
 17281        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17282     ELSE
 17283        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17284        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17285        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17286
 17287     GO TO 9990-RETURN.
 17288
 17289 3999-UNLOCK-ERMAIL.
 17290     IF ERMAIL-FOUND = ' '
 17291        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17292
 17293     GO TO 9990-RETURN.
 17294******************************************************************
 17295
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 312
* EL050.cbl
 17297 4000-UPDATE-CANCELLED-CERT.
 17298     IF CERT-WAS-NOT-FOUND
 17299        GO TO 4299-EXIT.
 17300
 17301*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17302     IF PB-C-NH-INT-ON-REFS > ZEROS
 17303        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17304     END-IF
 17305     IF PB-C-REF-INTERFACE-SW = 'Y'
 17306        MOVE PB-C-REF-INTERFACE-SW
 17307                                 TO CM-NH-INTERFACE-SW
 17308     END-IF
 17309     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17310     IF ERMAIL-FOUND = 'X'
 17311        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17312        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17313        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17314        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17315           MOVE ER-2694          TO WS-ERROR
 17316           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17317     END-IF
 17318
 17319     IF PB-C-POST-CARD-IND = 'Y'
 17320        MOVE +8                  TO SUB
 17321*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17322        IF ERMAIL-FOUND = ' '
 17323           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17324              (SUB > +7)
 17325              OR (MA-MAIL-STATUS (SUB) = '1')
 17326           END-PERFORM
 17327        END-IF
 17328        IF (SUB > +7)
 17329           OR (ERMAIL-FOUND = 'X')
 17330           MOVE ER-3789          TO WS-ERROR
 17331           PERFORM 9900-ERROR-FORMAT
 17332                                 THRU 9900-EXIT
 17333        END-IF
 17334     ELSE
 17335        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17336     END-IF
 17337
 17338     IF ERMAIL-FOUND = ' '
 17339        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17340     END-IF.
 17341
 17342     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17343
 17344     IF PB-CI-OB-FLAG = 'Z'
 17345        GO TO 4150-SUMMARY-CERT-CANCEL.
 17346
 17347     IF PB-C-LF-CANCEL-VOIDED
 17348         PERFORM 4200-REVERSE-LF-CANCEL.
 17349     IF PB-C-AH-CANCEL-VOIDED
 17350         PERFORM 4200-REVERSE-AH-CANCEL.
 17351
 17352 4100-APPLY-LF-CANCEL.
 17353
 17354     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 313
* EL050.cbl
 17355
 17356 4100-CHECK-LF-ERRORS.
 17357
 17358     ADD +1                       TO WS-SUB.
 17359
 17360     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17361        IF LF-COVERAGE-CANCELLED
 17362           GO TO 4100-LF-CANCEL-CONT
 17363        ELSE
 17364           GO TO 4100-UPDATE-LF-COVERAGE.
 17365
 17366     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17367                                   ER-2729 OR
 17368                                   ER-2730 OR
 17369                                   ER-2731 OR
 17370                                   ER-2732 OR
 17371                                   ER-2737 OR
 17372                                   ER-2740 OR
 17373                                   ER-2743 OR
 17374                                   ER-2749 OR
 17375                                   ER-2750 OR
 17376                                   ER-2755 OR
 17377                                   ER-2757 OR
 17378                                   ER-2760 OR
 17379                                   ER-2772 OR
 17380                                   ER-2774 OR
 17381                                   ER-2776 OR
 17382                                   ER-2794
 17383        GO TO 4100-UPDATE-LF-COVERAGE.
 17384
 17385     GO TO 4100-CHECK-LF-ERRORS.
 17386
 17387 4100-UPDATE-LF-COVERAGE.
 17388
 17389     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17390     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17391     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17392        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17393     END-IF
 17394     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17395                                      TO CM-CREDIT-INTERFACE-SW-2.
 17396     IF CM-LF-CANCEL-DT = LOW-VALUE
 17397         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17398
 17399     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17400         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17401                                         CM-LF-STATUS-AT-CANCEL.
 17402
 17403     GO TO 4100-APPLY-AH-CANCEL.
 17404
 17405 4100-LF-CANCEL-CONT.
 17406     IF PB-C-LF-CANCEL-VOIDED
 17407         GO TO 4100-APPLY-AH-CANCEL.
 17408
 17409     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17410         GO TO 4100-APPLY-AH-CANCEL.
 17411
 17412     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 314
* EL050.cbl
 17413        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17414           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17415        ELSE
 17416           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17417
 17418     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17419     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17420
 17421     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17422         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17423
 17424     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17425        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17426         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17427         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17428
 17429     IF PB-RECORD-RETURNED
 17430        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17431      ELSE
 17432        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17433
 17434 4100-APPLY-AH-CANCEL.
 17435
 17436     MOVE +0                      TO WS-SUB.
 17437
 17438 4100-CHECK-AH-ERRORS.
 17439
 17440     ADD +1                       TO WS-SUB.
 17441
 17442     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17443        IF AH-COVERAGE-CANCELLED
 17444           GO TO 4100-AH-CANCEL-CONT
 17445        ELSE
 17446           GO TO 4100-UPDATE-AH-COVERAGE.
 17447
 17448     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17449                                   ER-2729 OR
 17450                                   ER-2732 OR
 17451                                   ER-2737 OR
 17452                                   ER-2740 OR
 17453                                   ER-2744 OR
 17454                                   ER-2749 OR
 17455                                   ER-2750 OR
 17456                                   ER-2755 OR
 17457                                   ER-2757 OR
 17458                                   ER-2760 OR
 17459                                   ER-2771 OR
 17460                                   ER-2772 OR
 17461                                   ER-2773 OR
 17462                                   ER-2775 OR
 17463                                   ER-2777 OR
 17464                                   ER-2778 OR
 17465                                   ER-2794
 17466        GO TO 4100-UPDATE-AH-COVERAGE.
 17467
 17468     GO TO 4100-CHECK-AH-ERRORS.
 17469
 17470 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 315
* EL050.cbl
 17471
 17472     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17473     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17474     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17475     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17476                                      TO CM-CREDIT-INTERFACE-SW-2.
 17477     IF CM-AH-CANCEL-DT = LOW-VALUE
 17478         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17479
 17480     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17481         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17482                                         CM-AH-STATUS-AT-CANCEL.
 17483
 17484     IF LF-COVERAGE-CANCELLED
 17485         IF PB-RECORD-RETURNED
 17486              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17487          ELSE
 17488              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17489
 17490     GO TO 4299-EXIT.
 17491
 17492 4100-AH-CANCEL-CONT.
 17493     IF PB-C-AH-CANCEL-VOIDED
 17494         GO TO 4299-EXIT.
 17495
 17496     if cm-credit-interface-sw-2 = ' '
 17497        if pb-fatal-errors or pb-unforced-errors
 17498           move '4'              to cm-credit-interface-sw-2
 17499        else
 17500           move '1'              to cm-credit-interface-sw-2
 17501        end-if
 17502     end-if
 17503     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17504         GO TO 4299-EXIT.
 17505
 17506     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17507        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17508           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17509        ELSE
 17510           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17511
 17512     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17513     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17514
 17515     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17516         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17517
 17518     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17519         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17520         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17521
 17522     IF PB-RECORD-RETURNED
 17523        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17524      ELSE
 17525        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17526
 17527     GO TO 4299-EXIT.
 17528
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 316
* EL050.cbl
 17529 4150-SUMMARY-CERT-CANCEL.
 17530     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17531
 17532     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17533        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17534                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17535     ELSE
 17536        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17537                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17538
 17539     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17540        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17541                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17542     ELSE
 17543        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17544                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17545
 17546     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17547        NEXT SENTENCE
 17548     ELSE
 17549        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17550
 17551     GO TO 4299-EXIT.
 17552
 17553 4200-REVERSE-LF-CANCEL.
 17554     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17555
 17556     IF CM-LF-CANCEL-APPLIED
 17557        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17558        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17559        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17560
 17561     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17562
 17563     IF PB-RECORD-RETURNED
 17564        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17565       ELSE
 17566        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17567
 17568 4200-REVERSE-LF-EXIT.
 17569       EXIT.
 17570
 17571 4200-REVERSE-AH-CANCEL.
 17572     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17573
 17574     IF CM-AH-CANCEL-APPLIED
 17575        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17576        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17577        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17578
 17579     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17580
 17581     IF PB-RECORD-RETURNED
 17582        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17583       ELSE
 17584        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17585
 17586 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 317
* EL050.cbl
 17587       EXIT.
 17588
 17589 4299-EXIT.
 17590       EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 318
* EL050.cbl
 17592
 17593 4500-UPDATE-NEW-CERT.
 17594     IF CERT-WAS-FOUND
 17595         NEXT SENTENCE
 17596       ELSE
 17597         GO TO 4520-BUILD-NEW-KEY.
 17598
 17599     IF  CLASIC-CREATED-CERT
 17600         GO TO 4999-EXIT.
 17601
 17602     IF  CERT-WAS-CREATED-FOR-CLAIM
 17603         GO TO 4520-BUILD-NEW-KEY.
 17604
 17605     IF CERT-ADDED-BATCH
 17606        IF CM-RECORD-ID = 'CM'
 17607            GO TO 4999-EXIT.
 17608
 17609 4520-BUILD-NEW-KEY.
 17610* BUILD CONTROL PRIMARY
 17611
 17612     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17613                                       CM-COMPANY-CD-A1
 17614                                       CM-COMPANY-CD-A2
 17615                                       CM-COMPANY-CD-A4
 17616                                       CM-COMPANY-CD-A5.
 17617
 17618     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17619     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17620     MOVE PB-SV-STATE               TO CM-STATE.
 17621     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17622     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17623     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17624     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17625
 17626     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17627
 17628     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17629     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17630     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17631     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17632
 17633     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17634        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17635
 17636     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17637         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17638         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17639         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17640         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17641     ELSE
 17642         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17643
 17644     IF PB-COMPANY-ID   EQUAL  'CRI'
 17645         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17646         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17647         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17648         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17649         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 319
* EL050.cbl
 17650
 17651     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17652        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17653         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17654
 17655     IF PB-COMPANY-ID  = 'LBL'
 17656        IF PB-I-JOINT-COVERAGE
 17657            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17658                                           PB-I-MEMBER-NO
 17659            GO TO 4550-CONT-CERT-PROCESS.
 17660
 17661     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17662        NEXT SENTENCE
 17663     ELSE
 17664        GO TO 4540-BUILD-MEMBER-NO.
 17665
 17666******************************************************************
 17667*                                                                *
 17668*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17669*    FOR 'MON'.                                                  *
 17670*                                                                *
 17671******************************************************************
 17672
 17673     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17674     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17675     MOVE +1                     TO WS-SUB1
 17676                                    WS-SUB2.
 17677
 17678 4530-EDIT-MEMB-NAME.
 17679
 17680     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17681        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17682        ADD +1                       TO WS-SUB2.
 17683
 17684     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17685        ADD +1                       TO WS-SUB1
 17686        GO TO 4530-EDIT-MEMB-NAME.
 17687
 17688     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17689     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17690     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17691*    MOVE SPACE                      TO DC-OPTION-CODE.
 17692     SET  BIN-TO-GREG                TO TRUE.
 17693     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17694     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17695
 17696     GO TO 4550-CONT-CERT-PROCESS.
 17697
 17698******************************************************************
 17699*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17700******************************************************************
 17701
 17702 4540-BUILD-MEMBER-NO.
 17703
 17704     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17705         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17706         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17707         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 320
* EL050.cbl
 17708         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17709     ELSE
 17710         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17711
 17712     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17713        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17714         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17715
 17716 4550-CONT-CERT-PROCESS.
 17717
 17718*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17719*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17720*    ELSE
 17721*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17722
 17723     IF CERT-WAS-CREATED-FOR-CLAIM
 17724        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17725        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17726
 17727     IF CERT-AND-CLAIM-ONLINE
 17728        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17729        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17730
 17731     MOVE 'CM'                     TO CM-RECORD-ID.
 17732     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17733
 17734     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17735        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17736        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17737     ELSE
 17738        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17739        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17740
 17741     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17742     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17743     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17744     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17745     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17746     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17747     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17748                                      CM-LF-ITD-CANCEL-AMT
 17749                                      CM-LF-ITD-DEATH-AMT
 17750                                      CM-AH-ITD-AH-PMT
 17751                                      CM-AH-ITD-LUMP-PMT
 17752                                      CM-AH-ITD-CANCEL-AMT
 17753                                      CM-LF-NSP-PREMIUM-AMT
 17754                                      CM-AH-NSP-PREMIUM-AMT.
 17755*                                     CM-CLAIM-DEDUCT-WITHHELD
 17756*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17757     if pb-i-loan-apr = +99.9999
 17758        move zeros                 to cm-loan-apr
 17759     else
 17760        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17761     end-if
 17762     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17763     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17764     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17765     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 321
* EL050.cbl
 17766     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17767     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17768     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17769     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17770     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17771     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17772     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17773
 17774     IF PB-I-LIVES NOT NUMERIC
 17775         MOVE ZERO                 TO PB-I-LIVES.
 17776
 17777     IF PB-I-NUM-BILLED NOT NUMERIC
 17778         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17779
 17780     MOVE PB-I-LIVES               TO CM-LIVES.
 17781     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17782
 17783     IF PB-COMPANY-ID EQUAL  'DMD'
 17784         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17785         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17786
 17787     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17788     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17789     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17790     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17791     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17792     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17793
 17794     IF PB-I-LF-POLICY-FEE NUMERIC
 17795        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17796     ELSE
 17797        MOVE +0                    TO CM-LF-POLICY-FEE.
 17798
 17799     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17800        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17801        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17802     ELSE
 17803        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17804
 17805     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17806     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17807     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17808     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17809     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17810     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17811     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17812     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17813     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17814
 17815     IF PB-I-AH-POLICY-FEE NUMERIC
 17816        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17817     ELSE
 17818        MOVE +0                    TO CM-AH-POLICY-FEE.
 17819
 17820     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17821        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17822     ELSE
 17823        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 322
* EL050.cbl
 17824
 17825     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17826     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17827
 17828     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17829                                      CM-LF-DEATH-EXIT-DT
 17830                                      CM-AH-SETTLEMENT-EXIT-DT.
 17831
 17832*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17833*                       'TIH' OR 'OFL' OR 'FLA' OR
 17834*                       'TII' OR 'TMS' OR 'CRI' OR
 17835*                       'NCL'
 17836     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17837
 17838     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17839         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17840            MOVE '2'                TO CM-PREMIUM-TYPE.
 17841
 17842     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17843         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17844            MOVE '2'                TO CM-PREMIUM-TYPE.
 17845
 17846     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17847         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17848     ELSE
 17849         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17850         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17851
 17852     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17853     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17854     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17855     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17856     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17857     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17858     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17859     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17860
 17861     IF PB-NO-MONTHS-SKIPPED
 17862         MOVE SPACE                 TO CM-SKIP-CODE
 17863     ELSE
 17864         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17865
 17866     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17867     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17868                                       CM-LF-STATUS-AT-CANCEL.
 17869
 17870     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17871     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17872                                       CM-AH-STATUS-AT-CANCEL.
 17873
 17874     MOVE '1'                       TO CM-ENTRY-STATUS.
 17875
 17876     IF PB-REISSUED-CERT
 17877        MOVE '5'                    TO CM-ENTRY-STATUS.
 17878
 17879     IF PB-MONTHLY-CERT
 17880        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17881
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 323
* EL050.cbl
 17882     IF PB-CASH-CERT
 17883        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17884
 17885     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17886     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17887     IF PB-POLICY-IS-DECLINED
 17888        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17889
 17890     IF PB-POLICY-IS-VOIDED
 17891        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17892
 17893     IF PB-NEEDS-UNDERWRITING
 17894        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17895
 17896     IF PB-REIN-ONLY-CERT
 17897        MOVE '9'                    TO CM-ENTRY-STATUS.
 17898
 17899     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17900         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17901     ELSE
 17902         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17903
 17904     IF PB-RECORD-RETURNED
 17905        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17906      ELSE
 17907        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17908
 17909     IF PB-I-MAIL-ADDRS-PRESENT
 17910        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17911
 17912     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17913                                       CM-ENTRY-DT.
 17914
 17915 4999-EXIT.
 17916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 324
* EL050.cbl
 17918
 17919 5000-PROCESS-REPS.
 17920     MOVE ' '                    TO AGTC-MASTER-SW
 17921     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17922     MOVE CO-TYPE                TO AGTC-TYPE
 17923     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17924     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17925     IF (AGTC-MASTER-SW NOT = 'N')
 17926        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17927        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17928        PERFORM 8583-READ-ERAGTC-NEXT
 17929                                 THRU 8583-EXIT
 17930     END-IF
 17931     IF AGTC-MASTER-SW = 'N'
 17932        CONTINUE
 17933     ELSE
 17934        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17935           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17936              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17937              MOVE 'Y'           TO AGTC-MASTER-SW
 17938           END-IF
 17939        END-IF
 17940     END-IF
 17941     .
 17942 5000-EXIT.
 17943     EXIT.
 17944 6370-EDIT-INPUT-LF-CODE.
 17945     move ' ' to ws-benefit-cd-chg-sw
 17946     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17947        MOVE +1                  TO SUB
 17948        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17949        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17950        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17951        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17952        GO TO 6370-SEARCH-LOOP.
 17953
 17954     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17955
 17956     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17957     MOVE SPACES                 TO CNTL-ACCESS.
 17958*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17959     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17960     MOVE +0                     TO CNTL-SEQ-NO.
 17961     MOVE '4' TO RC-SW-2.
 17962     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17963
 17964     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17965        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17966        GO TO 6370-NO-LF-FOUND.
 17967
 17968     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17969     MOVE +1                     TO SUB.
 17970
 17971 6370-SEARCH-LOOP.
 17972     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17973         GO TO 6370-NO-LF-FOUND.
 17974
 17975     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 325
* EL050.cbl
 17976        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17977           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17978           set benefit-code-chg to true
 17979        end-if
 17980        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17981        GO TO 6370-HER-NET-PAY-CHECK.
 17982
 17983     ADD 1   TO SUB.
 17984*    IF SUB GREATER 120
 17985     IF SUB GREATER 200
 17986         GO TO 6370-NO-LF-FOUND.
 17987
 17988     GO TO 6370-SEARCH-LOOP.
 17989
 17990 6370-NO-LF-FOUND.
 17991
 17992     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17993        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17994        set benefit-code-chg to true
 17995     end-if
 17996     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17997
 17998 6370-HER-NET-PAY-CHECK.
 17999
 18000     IF PB-COMPANY-ID = 'CID'
 18001        IF PB-SV-STATE = 'CA' OR 'MN'
 18002           IF PB-I-LF-BENEFIT-CD = '02'
 18003              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18004           ELSE
 18005              IF PB-I-LF-BENEFIT-CD = '04'
 18006                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18007              END-IF
 18008           END-IF
 18009        END-IF
 18010     END-IF
 18011
 18012     IF PB-COMPANY-ID NOT = 'HER'
 18013         GO TO 6370-EXIT.
 18014
 18015     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18016         GO TO 6370-EXIT.
 18017
 18018     IF PB-I-LF-TERM NOT NUMERIC
 18019         MOVE ZEROS              TO PB-I-LF-TERM.
 18020
 18021     IF PB-I-LOAN-TERM NOT NUMERIC
 18022         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18023
 18024     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18025         GO TO 6370-EXIT.
 18026
 18027     IF PB-I-LF-BENEFIT-CD = '33'
 18028         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18029
 18030     IF PB-I-LF-BENEFIT-CD = '34'
 18031         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18032
 18033 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 326
* EL050.cbl
 18034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 327
* EL050.cbl
 18036
 18037 6380-EDIT-INPUT-AH-CODE.
 18038     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18039        MOVE +1                  TO SUB
 18040        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18041        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18042        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18043        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18044        GO TO 6380-SEARCH-LOOP.
 18045
 18046     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18047
 18048     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18049     MOVE SPACES                 TO CNTL-ACCESS.
 18050     MOVE 'A'                    TO CNTL-REC-TYPE.
 18051*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18052     MOVE +0                     TO CNTL-SEQ-NO.
 18053     MOVE '5' TO RC-SW-2.
 18054     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18055
 18056     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18057        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18058        GO TO 6380-NO-AH-FOUND.
 18059
 18060     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18061     MOVE +1 TO SUB.
 18062
 18063 6380-SEARCH-LOOP.
 18064     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18065         GO TO 6380-NO-AH-FOUND.
 18066
 18067     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18068         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18069         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18070
 18071     ADD 1   TO SUB.
 18072     IF SUB GREATER THAN 96
 18073*    IF SUB GREATER THAN 300
 18074         GO TO 6380-NO-AH-FOUND.
 18075
 18076     GO TO 6380-SEARCH-LOOP.
 18077
 18078 6380-NO-AH-FOUND.
 18079
 18080     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18081
 18082     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18083         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18084     ELSE
 18085         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18086
 18087 6380-CSO-AH-ONLY-CHECKS.
 18088
 18089     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18090        NEXT SENTENCE
 18091      ELSE
 18092        GO TO 6380-EXIT.
 18093
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 328
* EL050.cbl
 18094     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18095         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18096
 18097
 18098     GO TO 6380-EXIT
 18099     .
 18100 6380-CSO-LIFE-WITH-AH-CHECKS.
 18101
 18102
 18103     .
 18104 6380-EXIT.
 18105     EXIT.
 18106
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 329
* EL050.cbl
 18108
 18109 6400-COMPUTE-EXTENSION-DAYS.
 18110
 18111******************************************************************
 18112*                                                                *
 18113*                   COMPUTE EXTENSION DAYS                       *
 18114*                                                                *
 18115*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18116*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18117*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18118*    THE EXTENSION DAYS.                                         *
 18119*                                                                *
 18120******************************************************************
 18121
 18122     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18123     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18124
 18125******************************************************************
 18126*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18127*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18128******************************************************************
 18129
 18130     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18131        COMPUTE WS-ODD-DAYS-OVER =
 18132               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18133     ELSE
 18134        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18135
 18136     IF WS-ODD-DAYS-OVER = ZEROS
 18137           GO TO 6499-EXIT
 18138     ELSE
 18139        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18140           IF WS-WDF-MONTH = 02
 18141              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18142              ADD 2       TO  WS-ODD-DAYS-OVER
 18143              GO TO 6499-EXIT
 18144           ELSE
 18145              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18146                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18147                 GO TO 6499-EXIT
 18148               ELSE
 18149                 GO TO 6499-EXIT
 18150        ELSE
 18151           GO TO 6499-EXIT.
 18152
 18153 6412-CHECK-TO-DAY.
 18154
 18155        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18156           IF WS-WDT-DAY = 28
 18157              ADD 2              TO WS-ODD-DAYS-OVER
 18158           ELSE
 18159              IF WS-WDT-DAY = 29
 18160                 ADD 1           TO WS-ODD-DAYS-OVER
 18161              ELSE
 18162                 NEXT SENTENCE
 18163        ELSE
 18164           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18165              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 330
* EL050.cbl
 18166
 18167     GO TO 6499-EXIT.
 18168
 18169
 18170 6415-CHECK-LEAP-YEAR.
 18171
 18172     IF DC-DAYS-IN-MONTH = 29
 18173        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18174
 18175 6415-EXIT.
 18176     EXIT.
 18177
 18178 6499-EXIT.
 18179      EXIT.
 18180
 18181 6500-END.
 18182     EXIT.
 18183
 18184
 18185******************************************************************
 18186************* PROCEDURE DIVISION FOR EL050 ***********************
 18187********************** ELC50PD END *******************************
 18188
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 331
* EL050.cbl
 18190
 18191**START***********************************************************
 18192*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18193*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18194******************************************************************
 18195*
 18196 6600-GET-STATE-MUNICIPAL-TAX.
 18197
 18198     IF PB-COMPANY-ID NOT = 'DMD'
 18199         GO TO 6640-EXIT.
 18200
 18201     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18202     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18203     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18204*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18205*
 18206***  Y2K PROJ 7744
 18207     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18208     SET BIN-TO-GREG          TO TRUE.
 18209     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18210
 18211     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18212
 18213     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18214     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18215
 18216
 18217* EXEC CICS HANDLE CONDITION
 18218*        INVREQ    (6610-START-BROWSE)
 18219*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18220*        NOTFND    (6630-END-OF-FILE)
 18221*    END-EXEC.
 18222*    MOVE '"$8JI                 ! # #00018204' TO DFHEIV0
 18223     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18225     MOVE X'2320233030303138323034' TO DFHEIV0(25:11)
 18226     CALL 'kxdfhei1' USING DFHEIV0
 18227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18228
 18229
 18230 6610-START-BROWSE.
 18231
 18232
 18233* EXEC CICS HANDLE CONDITION
 18234*        NOTFND    (6630-END-OF-FILE)
 18235*        DISABLED  (6630-ERRESS-PROBLEM)
 18236*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18237*        ENDFILE   (6630-END-OF-FILE)
 18238*    END-EXEC.
 18239*    MOVE '"$IcJ''                ! $ #00018212' TO DFHEIV0
 18240     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18242     MOVE X'2420233030303138323132' TO DFHEIV0(25:11)
 18243     CALL 'kxdfhei1' USING DFHEIV0
 18244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18245
 18246
 18247
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 332
* EL050.cbl
 18248* EXEC CICS STARTBR
 18249*        DATASET (FILE-ID-ERRESS)
 18250*        RIDFLD  (WS-ERRESS-KEY)
 18251*        GTEQ
 18252*    END-EXEC.
 18253     MOVE 0
 18254       TO DFHEIV11
 18255*    MOVE '&,         G          &   #00018219' TO DFHEIV0
 18256     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18257     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18258     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 18259     CALL 'kxdfhei1' USING DFHEIV0,
 18260           FILE-ID-ERRESS,
 18261           WS-ERRESS-KEY,
 18262           DFHEIV99,
 18263           DFHEIV11,
 18264           DFHEIV99
 18265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18266
 18267
 18268 6620-READ-NEXT-ERRESS-MASTER.
 18269
 18270
 18271* EXEC CICS HANDLE CONDITION
 18272*        NOTFND    (6630-END-OF-FILE)
 18273*        ENDFILE   (6630-END-OF-FILE)
 18274*        DISABLED  (6630-ERRESS-PROBLEM)
 18275*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18276*    END-EXEC.
 18277*    MOVE '"$I''cJ                ! % #00018227' TO DFHEIV0
 18278     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18280     MOVE X'2520233030303138323237' TO DFHEIV0(25:11)
 18281     CALL 'kxdfhei1' USING DFHEIV0
 18282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18283
 18284
 18285
 18286* EXEC CICS READNEXT
 18287*        DATASET (FILE-ID-ERRESS)
 18288*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18289*        RIDFLD  (WS-ERRESS-KEY)
 18290*    END-EXEC.
 18291     MOVE LENGTH OF
 18292      RESIDENT-STATE-TAX-MASTER
 18293       TO DFHEIV12
 18294     MOVE 0
 18295       TO DFHEIV11
 18296*    MOVE '&.IL                  )   #00018234' TO DFHEIV0
 18297     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18298     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18299     MOVE X'2020233030303138323334' TO DFHEIV0(25:11)
 18300     CALL 'kxdfhei1' USING DFHEIV0,
 18301           FILE-ID-ERRESS,
 18302           RESIDENT-STATE-TAX-MASTER,
 18303           DFHEIV12,
 18304           WS-ERRESS-KEY,
 18305           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 333
* EL050.cbl
 18306           DFHEIV11,
 18307           DFHEIV99,
 18308           DFHEIV99
 18309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18310
 18311
 18312     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18313
 18314* EXEC CICS ENDBR
 18315*            DATASET (FILE-ID-ERRESS)
 18316*       END-EXEC
 18317     MOVE 0
 18318       TO DFHEIV11
 18319*    MOVE '&2                    $   #00018241' TO DFHEIV0
 18320     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18321     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18322     MOVE X'2020233030303138323431' TO DFHEIV0(25:11)
 18323     CALL 'kxdfhei1' USING DFHEIV0,
 18324           FILE-ID-ERRESS,
 18325           DFHEIV11,
 18326           DFHEIV99
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18328        GO TO 6630-END-OF-FILE.
 18329
 18330     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18331        NEXT SENTENCE
 18332      ELSE
 18333        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18334
 18335*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18336*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18337*
 18338     MOVE +2                     TO WS-SUB1.
 18339
 18340     IF PB-ISSUE
 18341     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18342        MOVE +1                  TO WS-SUB1.
 18343
 18344     IF PB-CANCELLATION
 18345     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18346        MOVE +1                  TO WS-SUB1.
 18347*
 18348*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18349*
 18350***  Y2K PROJ 7744
 18351     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18352***  Y2K PROJ 7744
 18353
 18354*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18355* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18356* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18357
 18358     ADD 1                    TO WS-YEAR-YY.
 18359
 18360     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18361         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18362                              TO WS-RES-STATE-TAX
 18363         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 334
* EL050.cbl
 18364                              TO WS-RES-MUNI-TAX
 18365     ELSE
 18366         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18367                              TO WS-RES-STATE-TAX
 18368         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18369                              TO WS-RES-MUNI-TAX.
 18370
 18371*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18372
 18373     IF PB-CANCELLATION
 18374         GO TO 6640-CANCEL-TAX.
 18375
 18376     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18377         COMPUTE PB-I-STATE-TAX ROUNDED =
 18378                                   PB-I-LF-PREMIUM-AMT
 18379                                 * WS-RES-STATE-TAX
 18380         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18381                                   PB-I-LF-PREMIUM-AMT
 18382                                 * WS-RES-MUNI-TAX
 18383     ELSE
 18384     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18385         COMPUTE PB-I-STATE-TAX ROUNDED =
 18386                                   PB-I-AH-PREMIUM-AMT
 18387                                 * WS-RES-STATE-TAX
 18388         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18389                                   PB-I-AH-PREMIUM-AMT
 18390                                 * WS-RES-MUNI-TAX.
 18391
 18392
 18393* EXEC CICS ENDBR
 18394*         DATASET (FILE-ID-ERRESS)
 18395*    END-EXEC.
 18396     MOVE 0
 18397       TO DFHEIV11
 18398*    MOVE '&2                    $   #00018308' TO DFHEIV0
 18399     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18401     MOVE X'2020233030303138333038' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0,
 18403           FILE-ID-ERRESS,
 18404           DFHEIV11,
 18405           DFHEIV99
 18406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18407
 18408
 18409     GO TO 6640-EXIT.
 18410
 18411 6640-CANCEL-TAX.
 18412     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18413
 18414     IF PB-C-LF-CANCEL-AMT > ZEROS
 18415         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18416                                   PB-C-LF-CANCEL-AMT
 18417                                 * WS-RES-STATE-TAX
 18418         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18419                                   PB-C-LF-CANCEL-AMT
 18420                                *  WS-RES-MUNI-TAX
 18421     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 335
* EL050.cbl
 18422     IF PB-C-AH-CANCEL-AMT > ZEROS
 18423         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18424                                   PB-C-AH-CANCEL-AMT
 18425                                 * WS-RES-STATE-TAX
 18426         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18427                                   PB-C-AH-CANCEL-AMT
 18428                                *  WS-RES-MUNI-TAX.
 18429
 18430
 18431* EXEC CICS ENDBR
 18432*         DATASET (FILE-ID-ERRESS)
 18433*    END-EXEC.
 18434     MOVE 0
 18435       TO DFHEIV11
 18436*    MOVE '&2                    $   #00018333' TO DFHEIV0
 18437     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18439     MOVE X'2020233030303138333333' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0,
 18441           FILE-ID-ERRESS,
 18442           DFHEIV11,
 18443           DFHEIV99
 18444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18445
 18446
 18447     GO TO 6640-EXIT.
 18448
 18449 6630-END-OF-FILE.
 18450     MOVE ER-8002              TO WS-ERROR.
 18451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18452
 18453     GO TO 6640-EXIT.
 18454
 18455 6630-ERRESS-PROBLEM.
 18456     MOVE ER-8044              TO WS-ERROR.
 18457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18458
 18459 6640-EXIT.
 18460     EXIT.
 18461
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 336
* EL050.cbl
 18463 6650-GET-RES-STATE-COMM.
 18464
 18465     IF PB-COMPANY-ID NOT = 'DMD'
 18466         GO TO 6700-COMM-EXIT.
 18467
 18468     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18469     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18470     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18471     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18472     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18473     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18474     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18475
 18476*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18477*
 18478***  Y2K PROJ 7744
 18479     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18480     SET BIN-TO-GREG          TO TRUE.
 18481     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18482
 18483     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18484***  Y2K PROJ 7744
 18485
 18486     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18487
 18488
 18489* EXEC CICS HANDLE CONDITION
 18490*        INVREQ    (6660-START-BROWSE)
 18491*        DISABLED  (6690-ERRESC-PROBLEM)
 18492*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18493*        NOTFND    (6690-END-OF-FILE)
 18494*    END-EXEC.
 18495*    MOVE '"$8cJI                ! & #00018378' TO DFHEIV0
 18496     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18498     MOVE X'2620233030303138333738' TO DFHEIV0(25:11)
 18499     CALL 'kxdfhei1' USING DFHEIV0
 18500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18501
 18502
 18503
 18504* EXEC CICS RESETBR
 18505*        DATASET (FILE-ID-ERRESC)
 18506*        RIDFLD  (WS-ERRESC-KEY)
 18507*    END-EXEC.
 18508     MOVE 0
 18509       TO DFHEIV11
 18510*    MOVE '&4         G          &   #00018385' TO DFHEIV0
 18511     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18512     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18513     MOVE X'2020233030303138333835' TO DFHEIV0(25:11)
 18514     CALL 'kxdfhei1' USING DFHEIV0,
 18515           FILE-ID-ERRESC,
 18516           WS-ERRESC-KEY,
 18517           DFHEIV99,
 18518           DFHEIV11,
 18519           DFHEIV99
 18520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 337
* EL050.cbl
 18521
 18522
 18523 6660-START-BROWSE.
 18524
 18525
 18526* EXEC CICS HANDLE CONDITION
 18527*        NOTFND    (6690-END-OF-FILE)
 18528*        DISABLED  (6690-ERRESC-PROBLEM)
 18529*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18530*        ENDFILE   (6690-END-OF-FILE)
 18531*    END-EXEC.
 18532*    MOVE '"$IcJ''                ! '' #00018392' TO DFHEIV0
 18533     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18535     MOVE X'2720233030303138333932' TO DFHEIV0(25:11)
 18536     CALL 'kxdfhei1' USING DFHEIV0
 18537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18538
 18539
 18540
 18541* EXEC CICS STARTBR
 18542*        DATASET (FILE-ID-ERRESC)
 18543*        RIDFLD  (WS-ERRESC-KEY)
 18544*        GTEQ
 18545*    END-EXEC.
 18546     MOVE 0
 18547       TO DFHEIV11
 18548*    MOVE '&,         G          &   #00018399' TO DFHEIV0
 18549     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18550     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18551     MOVE X'2020233030303138333939' TO DFHEIV0(25:11)
 18552     CALL 'kxdfhei1' USING DFHEIV0,
 18553           FILE-ID-ERRESC,
 18554           WS-ERRESC-KEY,
 18555           DFHEIV99,
 18556           DFHEIV11,
 18557           DFHEIV99
 18558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18559
 18560
 18561     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18562
 18563 6670-READ-NEXT-ERRESC-MASTER.
 18564
 18565
 18566* EXEC CICS HANDLE CONDITION
 18567*        NOTFND    (6690-END-OF-FILE)
 18568*        DISABLED  (6690-ERRESC-PROBLEM)
 18569*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18570*        ENDFILE   (6690-END-OF-FILE)
 18571*    END-EXEC.
 18572*    MOVE '"$IcJ''                ! ( #00018409' TO DFHEIV0
 18573     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18575     MOVE X'2820233030303138343039' TO DFHEIV0(25:11)
 18576     CALL 'kxdfhei1' USING DFHEIV0
 18577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18578
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 338
* EL050.cbl
 18579
 18580
 18581* EXEC CICS READNEXT
 18582*        DATASET (FILE-ID-ERRESC)
 18583*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18584*        RIDFLD  (ERRESC-RECORD-KEY)
 18585*    END-EXEC.
 18586     MOVE LENGTH OF
 18587      ACCOUNT-RESIDENT-ST-COMMISSION
 18588       TO DFHEIV12
 18589     MOVE 0
 18590       TO DFHEIV11
 18591*    MOVE '&.IL                  )   #00018416' TO DFHEIV0
 18592     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18593     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18594     MOVE X'2020233030303138343136' TO DFHEIV0(25:11)
 18595     CALL 'kxdfhei1' USING DFHEIV0,
 18596           FILE-ID-ERRESC,
 18597           ACCOUNT-RESIDENT-ST-COMMISSION,
 18598           DFHEIV12,
 18599           ERRESC-RECORD-KEY,
 18600           DFHEIV99,
 18601           DFHEIV11,
 18602           DFHEIV99,
 18603           DFHEIV99
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18605
 18606
 18607     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18608        NEXT SENTENCE
 18609     ELSE
 18610
 18611* EXEC CICS ENDBR
 18612*            DATASET (FILE-ID-ERRESC)
 18613*       END-EXEC
 18614     MOVE 0
 18615       TO DFHEIV11
 18616*    MOVE '&2                    $   #00018425' TO DFHEIV0
 18617     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18619     MOVE X'2020233030303138343235' TO DFHEIV0(25:11)
 18620     CALL 'kxdfhei1' USING DFHEIV0,
 18621           FILE-ID-ERRESC,
 18622           DFHEIV11,
 18623           DFHEIV99
 18624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18625        GO TO 6690-END-OF-FILE.
 18626
 18627     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18628
 18629* EXEC CICS ENDBR
 18630*            DATASET (FILE-ID-ERRESC)
 18631*       END-EXEC
 18632     MOVE 0
 18633       TO DFHEIV11
 18634*    MOVE '&2                    $   #00018431' TO DFHEIV0
 18635     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 339
* EL050.cbl
 18637     MOVE X'2020233030303138343331' TO DFHEIV0(25:11)
 18638     CALL 'kxdfhei1' USING DFHEIV0,
 18639           FILE-ID-ERRESC,
 18640           DFHEIV11,
 18641           DFHEIV99
 18642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18643        GO TO 6690-END-OF-FILE.
 18644
 18645     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18646        NEXT SENTENCE
 18647      ELSE
 18648        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18649
 18650* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18651*
 18652     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18653
 18654     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18655
 18656     IF WS-SUB1 > ZERO
 18657         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18658             PERFORM 6680-SET-COMMISSION
 18659         ELSE
 18660             PERFORM 6680-SET-TABLE-CODE.
 18661
 18662
 18663* EXEC CICS ENDBR
 18664*         DATASET (FILE-ID-ERRESC)
 18665*    END-EXEC.
 18666     MOVE 0
 18667       TO DFHEIV11
 18668*    MOVE '&2                    $   #00018453' TO DFHEIV0
 18669     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18670     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18671     MOVE X'2020233030303138343533' TO DFHEIV0(25:11)
 18672     CALL 'kxdfhei1' USING DFHEIV0,
 18673           FILE-ID-ERRESC,
 18674           DFHEIV11,
 18675           DFHEIV99
 18676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18677
 18678
 18679     GO TO 6700-COMM-EXIT.
 18680
 18681 6680-SET-TABLE-CODE.
 18682     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18683        MOVE ZEROS             TO WS-SUB1
 18684     ELSE
 18685* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18686* TO COMPUTE AH COMMISSION.
 18687        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18688        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18689        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18690        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18691        PERFORM 6680-READ-CTBL-TABLE
 18692        IF WS-CTBL-READ-SW NOT = 'Y'
 18693           MOVE ZEROS          TO WS-SUB1.
 18694
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 340
* EL050.cbl
 18695 6680-READ-CTBL-TABLE.
 18696*
 18697* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18698* TO COMPUTE LIFE COMMISSION
 18699
 18700     IF CTBL-SW = '0540'
 18701        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18702        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18703        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18704
 18705     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18706
 18707     IF CTBL-TABLE-FOUND
 18708        IF CTBL-SW = '0530'
 18709             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18710                                    * PB-I-AH-TERM
 18711             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18712             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18713        ELSE
 18714             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18715             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18716             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18717     ELSE
 18718        IF FIRST-TIME-THROUGH
 18719            GO TO 6680-READ-CTBL-TABLE
 18720        ELSE
 18721            MOVE ZEROS         TO WS-SUB1.
 18722
 18723 6680-SET-COMMISSION.
 18724     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18725           MOVE ZEROS          TO WS-SUB1
 18726       ELSE
 18727           MOVE RESC-COMMISSION-PER (WS-SUB)
 18728                               TO WS-COMMISSION
 18729           IF CTBL-SW = '0530'
 18730               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18731           ELSE
 18732               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18733
 18734 6680-SEARCH-CATEGORY.
 18735     ADD +1                   TO WS-SUB.
 18736     IF WS-SUB > +12
 18737         GO TO 6680-EXIT.
 18738
 18739     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18740          MOVE WS-SUB         TO WS-SUB1
 18741          GO TO 6680-EXIT.
 18742
 18743     GO TO 6680-SEARCH-CATEGORY.
 18744
 18745 6680-EXIT.
 18746     EXIT.
 18747
 18748 6690-END-OF-FILE.
 18749     GO TO 6700-COMM-EXIT.
 18750
 18751 6690-ERRESC-PROBLEM.
 18752      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 341
* EL050.cbl
 18753      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18754
 18755      GO TO 6700-COMM-EXIT.
 18756
 18757 6700-COMM-EXIT.
 18758     EXIT.
 18759
 18760 7000-GET-RATE.
 18761
 18762* EXEC CICS LINK
 18763*        PROGRAM    ('ELRATE')
 18764*        COMMAREA   (CALCULATION-PASS-AREA)
 18765*        LENGTH     (CP-COMM-LENGTH)
 18766*    END-EXEC.
 18767     MOVE 'ELRATE' TO DFHEIV1
 18768*    MOVE '."C                   (   #00018539' TO DFHEIV0
 18769     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18771     MOVE X'2020233030303138353339' TO DFHEIV0(25:11)
 18772     CALL 'kxdfhei1' USING DFHEIV0,
 18773           DFHEIV1,
 18774           CALCULATION-PASS-AREA,
 18775           CP-COMM-LENGTH,
 18776           DFHEIV99,
 18777           DFHEIV99,
 18778           DFHEIV99,
 18779           DFHEIV99
 18780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18781
 18782
 18783 7000-EXIT.
 18784     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 342
* EL050.cbl
 18786 7100-FIND-BENEFIT-IN-STATE.
 18787     MOVE 'N'                    TO BEN-SEARCH-SW.
 18788
 18789     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18790         VARYING SUB3 FROM 1 BY 1 UNTIL
 18791            ((SUB3 GREATER 50) OR
 18792              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18793               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18794
 18795     IF SUB3 NOT = 51
 18796         MOVE 'Y'                TO BEN-SEARCH-SW.
 18797
 18798     GO TO 7199-EXIT.
 18799
 18800 7100-BENEFIT-DUMMY.
 18801
 18802 7100-DUMMY-EXIT.
 18803     EXIT.
 18804
 18805 7199-EXIT.
 18806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 343
* EL050.cbl
 18808 7200-FIND-BENEFIT.
 18809     MOVE 'N'                    TO BEN-SEARCH-SW.
 18810
 18811     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18812         VARYING SUB3 FROM 1 BY 1 UNTIL
 18813            ((SUB3 GREATER 8) OR
 18814            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18815
 18816     IF SUB3 NOT = 9
 18817         MOVE 'Y'                TO BEN-SEARCH-SW.
 18818
 18819     GO TO 7200-EXIT.
 18820
 18821 7200-BENEFIT-DUMMY.
 18822
 18823 7200-DUMMY-EXIT.
 18824     EXIT.
 18825
 18826 7200-EXIT.
 18827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 344
* EL050.cbl
 18829 7250-LOOK-FOR-RESCINDED-CLAIM.
 18830     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18831                                    W-CL-COMP-CD.
 18832     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18833                                    W-CL-CERT-NO.
 18834
 18835
 18836* EXEC CICS HANDLE CONDITION
 18837*        NOTFND  (7250-CONTINUE)
 18838*        ENDFILE (7250-CONTINUE)
 18839*    END-EXEC.
 18840*    MOVE '"$I''                  ! ) #00018597' TO DFHEIV0
 18841     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18843     MOVE X'2920233030303138353937' TO DFHEIV0(25:11)
 18844     CALL 'kxdfhei1' USING DFHEIV0
 18845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18846
 18847
 18848
 18849* EXEC CICS IGNORE CONDITION
 18850*        DUPKEY
 18851*    END-EXEC.
 18852*    MOVE '"*$                   !   #00018602' TO DFHEIV0
 18853     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18855     MOVE X'2020233030303138363032' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0
 18857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18858
 18859
 18860
 18861* EXEC CICS STARTBR
 18862*        DATASET   (CLMS-ID)
 18863*        RIDFLD    (ELMSTR-KEY)
 18864*        GENERIC   EQUAL
 18865*        KEYLENGTH (ELMSTR-LENGTH)
 18866*    END-EXEC.
 18867     MOVE 0
 18868       TO DFHEIV11
 18869*    MOVE '&,   KG    E          &   #00018606' TO DFHEIV0
 18870     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18871     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18872     MOVE X'2020233030303138363036' TO DFHEIV0(25:11)
 18873     CALL 'kxdfhei1' USING DFHEIV0,
 18874           CLMS-ID,
 18875           ELMSTR-KEY,
 18876           ELMSTR-LENGTH,
 18877           DFHEIV11,
 18878           DFHEIV99
 18879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18880
 18881
 18882     MOVE 'Y'                    TO W-BROWSE-SW.
 18883
 18884 7250-NEXT-CLAIM.
 18885
 18886
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 345
* EL050.cbl
 18887* EXEC CICS READNEXT
 18888*        DATASET   (CLMS-ID)
 18889*        RIDFLD    (ELMSTR-KEY)
 18890*        SET       (ADDRESS OF CLAIM-MASTER)
 18891*    END-EXEC.
 18892     MOVE 0
 18893       TO DFHEIV11
 18894*    MOVE '&.S                   )   #00018617' TO DFHEIV0
 18895     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18896     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18897     MOVE X'2020233030303138363137' TO DFHEIV0(25:11)
 18898     CALL 'kxdfhei1' USING DFHEIV0,
 18899           CLMS-ID,
 18900           DFHEIV20,
 18901           DFHEIV99,
 18902           ELMSTR-KEY,
 18903           DFHEIV99,
 18904           DFHEIV11,
 18905           DFHEIV99,
 18906           DFHEIV99
 18907     SET ADDRESS OF CLAIM-MASTER TO
 18908         DFHEIV20
 18909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18910
 18911
 18912     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18913        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18914         GO TO 7250-CONTINUE
 18915     END-IF.
 18916
 18917     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18918        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18919        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18920        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18921        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18922         GO TO 7250-NEXT-CLAIM
 18923     END-IF.
 18924
 18925     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18926        OR (CL-CLAIM-TYPE = 'I')
 18927        OR (CL-CLAIM-TYPE = 'G')
 18928        OR (CL-CLAIM-TYPE = 'F')
 18929          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18930              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18931              GO TO 7250-CONTINUE
 18932          END-IF
 18933     END-IF.
 18934
 18935     GO TO 7250-NEXT-CLAIM.
 18936
 18937 7250-CONTINUE.
 18938
 18939     IF W-BROWSE-SW = 'Y'
 18940
 18941* EXEC CICS ENDBR
 18942*            DATASET   (CLMS-ID)
 18943*        END-EXEC
 18944     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 346
* EL050.cbl
 18945       TO DFHEIV11
 18946*    MOVE '&2                    $   #00018651' TO DFHEIV0
 18947     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18948     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18949     MOVE X'2020233030303138363531' TO DFHEIV0(25:11)
 18950     CALL 'kxdfhei1' USING DFHEIV0,
 18951           CLMS-ID,
 18952           DFHEIV11,
 18953           DFHEIV99
 18954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18955         MOVE 'N' TO W-BROWSE-SW
 18956     END-IF.
 18957
 18958 7250-EXIT.
 18959     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 347
* EL050.cbl
 18961 7300-CHECK-FOR-OPEN-CLMS.
 18962
 18963*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18964*    MOVE SPACES                 TO CNTL-ACCESS.
 18965*    MOVE '1'                    TO CNTL-REC-TYPE.
 18966*    MOVE +0                     TO CNTL-SEQ-NO.
 18967
 18968*    MOVE '3'                    TO RC-SW-1.
 18969*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18970
 18971*    IF NOT CF-COMPANY-MASTER
 18972*         PERFORM 0099-COMPANY-NOT-FOUND
 18973*         GO TO 7300-EXIT.
 18974
 18975     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18976                                    W-CL-COMP-CD.
 18977     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18978                                    W-CL-CERT-NO.
 18979
 18980
 18981* EXEC CICS HANDLE CONDITION
 18982*        NOTFND  (7300-CONTINUE)
 18983*        ENDFILE (7300-CONTINUE)
 18984*    END-EXEC.
 18985*    MOVE '"$I''                  ! * #00018679' TO DFHEIV0
 18986     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18988     MOVE X'2A20233030303138363739' TO DFHEIV0(25:11)
 18989     CALL 'kxdfhei1' USING DFHEIV0
 18990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18991
 18992
 18993
 18994* EXEC CICS IGNORE CONDITION
 18995*        DUPKEY
 18996*    END-EXEC.
 18997*    MOVE '"*$                   !   #00018684' TO DFHEIV0
 18998     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19000     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
 19001     CALL 'kxdfhei1' USING DFHEIV0
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005
 19006* EXEC CICS STARTBR
 19007*        DATASET   (CLMS-ID)
 19008*        RIDFLD    (ELMSTR-KEY)
 19009*        GENERIC   EQUAL
 19010*        KEYLENGTH (ELMSTR-LENGTH)
 19011*    END-EXEC.
 19012     MOVE 0
 19013       TO DFHEIV11
 19014*    MOVE '&,   KG    E          &   #00018688' TO DFHEIV0
 19015     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19017     MOVE X'2020233030303138363838' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 348
* EL050.cbl
 19019           CLMS-ID,
 19020           ELMSTR-KEY,
 19021           ELMSTR-LENGTH,
 19022           DFHEIV11,
 19023           DFHEIV99
 19024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19025
 19026
 19027     MOVE 'Y'                    TO W-BROWSE-SW.
 19028
 19029 7300-NEXT-CLAIM.
 19030
 19031
 19032* EXEC CICS READNEXT
 19033*        DATASET   (CLMS-ID)
 19034*        RIDFLD    (ELMSTR-KEY)
 19035*        SET       (ADDRESS OF CLAIM-MASTER)
 19036*    END-EXEC.
 19037     MOVE 0
 19038       TO DFHEIV11
 19039*    MOVE '&.S                   )   #00018699' TO DFHEIV0
 19040     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19042     MOVE X'2020233030303138363939' TO DFHEIV0(25:11)
 19043     CALL 'kxdfhei1' USING DFHEIV0,
 19044           CLMS-ID,
 19045           DFHEIV20,
 19046           DFHEIV99,
 19047           ELMSTR-KEY,
 19048           DFHEIV99,
 19049           DFHEIV11,
 19050           DFHEIV99,
 19051           DFHEIV99
 19052     SET ADDRESS OF CLAIM-MASTER TO
 19053         DFHEIV20
 19054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19055
 19056
 19057     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19058        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19059         GO TO 7300-CONTINUE.
 19060
 19061     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19062        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19063        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19064        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19065        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19066         GO TO 7300-NEXT-CLAIM.
 19067
 19068*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19069     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19070        OR (CL-CLAIM-TYPE = 'I')
 19071        OR (CL-CLAIM-TYPE = 'G')
 19072        OR (CL-CLAIM-TYPE = 'F')
 19073        IF CLAIM-IS-OPEN
 19074           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19075             AND PB-C-AH-CANCEL-DT > SPACES
 19076              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 349
* EL050.cbl
 19077              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19078           END-IF
 19079           EVALUATE TRUE
 19080             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19081                 MOVE ER-2884      TO WS-ERROR
 19082             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19083                 MOVE ER-2887      TO WS-ERROR
 19084             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19085                 MOVE ER-2886      TO WS-ERROR
 19086             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19087                 MOVE ER-2888      TO WS-ERROR
 19088             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19089                 MOVE ER-2885      TO WS-ERROR
 19090             WHEN OTHER
 19091                 MOVE ER-2768      TO WS-ERROR
 19092           END-EVALUATE
 19093           IF PB-C-AH-CANCEL-VOIDED OR
 19094              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19095                NOT AH-COVERAGE-CANCELLED)
 19096               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19097               MOVE ER-2768      TO WS-ERROR
 19098           END-IF
 19099           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19100           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19101              PB-FORCE-CODE NOT EQUAL '8'
 19102               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19103           END-IF
 19104           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19105           GO TO 7300-NEXT-CLAIM
 19106        ELSE
 19107           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19108*****THIS IS A RESCISSION OR REFORMATION
 19109              IF AH-COVERAGE-CANCELLED
 19110                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19111                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19112                    MOVE 1                   TO DC-ELAPSED-DAYS
 19113                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19114                    SET BIN-PLUS-ELAPSED     TO TRUE
 19115                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19116                    IF NO-CONVERSION-ERROR
 19117                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19118                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19119                          MOVE ER-2897 TO WS-ERROR
 19120                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19121                          GO TO 7300-NEXT-CLAIM
 19122                       END-IF
 19123                    END-IF
 19124                 ELSE
 19125                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19126                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19127                         MOVE ER-2890 TO WS-ERROR
 19128                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19129                         GO TO 7300-NEXT-CLAIM
 19130                      ELSE
 19131                         MOVE ER-2898 TO WS-ERROR
 19132                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19133                         GO TO 7300-NEXT-CLAIM
 19134                      END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 350
* EL050.cbl
 19135                   END-IF
 19136                 END-IF
 19137              END-IF
 19138           ELSE
 19139              IF CL-DENIAL-TYPE = '1'  AND
 19140                 CL-TOTAL-PAID-AMT = 0
 19141                    GO TO 7300-NEXT-CLAIM
 19142              END-IF
 19143              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19144               AND PB-C-AH-CANCEL-DT > SPACES
 19145                 MOVE ER-2756        TO WS-ERROR
 19146                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19147                 GO TO 7300-NEXT-CLAIM
 19148              END-IF
 19149           END-IF
 19150        END-IF
 19151     ELSE
 19152*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19153        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19154           IF (CLAIM-IS-OPEN)
 19155              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19156                 <> zeros
 19157              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19158                 <> zeros)
 19159              MOVE ER-2889      TO WS-ERROR
 19160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19161              GO TO 7300-NEXT-CLAIM
 19162           ELSE
 19163              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19164*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19165                 IF (LF-COVERAGE-CANCELLED AND
 19166                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19167                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19168                         MOVE ER-2890 TO WS-ERROR
 19169                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19170                         GO TO 7300-NEXT-CLAIM
 19171                      ELSE
 19172                         MOVE ER-2898 TO WS-ERROR
 19173                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19174                         GO TO 7300-NEXT-CLAIM
 19175                      END-IF
 19176                 END-IF
 19177              ELSE
 19178                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19179                    and (CL-TOTAL-PAID-AMT = 0)
 19180                    GO TO 7300-NEXT-CLAIM
 19181                 END-IF
 19182                 IF (
 19183                      (AH-COVERAGE-CANCELLED)
 19184                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19185                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19186                      and (pb-ci-ah-cancel-amt +
 19187                         pb-c-ah-cancel-amt) <> zeros
 19188                    )
 19189                               OR
 19190                    (
 19191                      (LF-COVERAGE-CANCELLED)
 19192                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 351
* EL050.cbl
 19193                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19194                      and (pb-ci-lf-cancel-amt +
 19195                         pb-c-lf-cancel-amt) <> zeros
 19196                    )
 19197                       MOVE ER-2965 TO WS-ERROR
 19198                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19199                       GO TO 7300-NEXT-CLAIM
 19200                 END-IF
 19201                 IF LF-COVERAGE-CANCELLED
 19202                  IF CL-TOTAL-PAID-AMT > 0
 19203                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19204                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19205                        MOVE ER-2891 TO WS-ERROR
 19206                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19207                        GO TO 7300-NEXT-CLAIM
 19208                      END-IF
 19209                    ELSE
 19210****only show this error if cert num matches exactly
 19211                      IF PB-CERT-NO = CL-CERT-NO
 19212                         MOVE ER-2892 TO WS-ERROR
 19213                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19214                         GO TO 7300-NEXT-CLAIM
 19215                      END-IF
 19216                    END-IF
 19217                  END-IF
 19218                 END-IF
 19219              END-IF
 19220           END-IF
 19221        END-IF
 19222     END-IF
 19223
 19224     GO TO 7300-NEXT-CLAIM.
 19225
 19226 7300-CONTINUE.
 19227
 19228     IF W-BROWSE-SW = 'Y'
 19229
 19230* EXEC CICS ENDBR
 19231*            DATASET   (CLMS-ID)
 19232*        END-EXEC.
 19233     MOVE 0
 19234       TO DFHEIV11
 19235*    MOVE '&2                    $   #00018877' TO DFHEIV0
 19236     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19238     MOVE X'2020233030303138383737' TO DFHEIV0(25:11)
 19239     CALL 'kxdfhei1' USING DFHEIV0,
 19240           CLMS-ID,
 19241           DFHEIV11,
 19242           DFHEIV99
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19244
 19245
 19246 7300-EXIT.
 19247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 352
* EL050.cbl
 19249
 19250 7400-GET-REMAIN-TERM.
 19251
 19252* EXEC CICS LINK
 19253*        PROGRAM    ('ELRTRM')
 19254*        COMMAREA   (CALCULATION-PASS-AREA)
 19255*        LENGTH     (CP-COMM-LENGTH)
 19256*    END-EXEC.
 19257     MOVE 'ELRTRM' TO DFHEIV1
 19258*    MOVE '."C                   (   #00018886' TO DFHEIV0
 19259     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19260     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19261     MOVE X'2020233030303138383836' TO DFHEIV0(25:11)
 19262     CALL 'kxdfhei1' USING DFHEIV0,
 19263           DFHEIV1,
 19264           CALCULATION-PASS-AREA,
 19265           CP-COMM-LENGTH,
 19266           DFHEIV99,
 19267           DFHEIV99,
 19268           DFHEIV99,
 19269           DFHEIV99
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273 7400-EXIT.
 19274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 353
* EL050.cbl
 19276
 19277 7500-GET-REMAIN-AMOUNT.
 19278
 19279* EXEC CICS LINK
 19280*        PROGRAM    ('ELRAMT')
 19281*        COMMAREA   (CALCULATION-PASS-AREA)
 19282*        LENGTH     (CP-COMM-LENGTH)
 19283*    END-EXEC.
 19284     MOVE 'ELRAMT' TO DFHEIV1
 19285*    MOVE '."C                   (   #00018897' TO DFHEIV0
 19286     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19288     MOVE X'2020233030303138383937' TO DFHEIV0(25:11)
 19289     CALL 'kxdfhei1' USING DFHEIV0,
 19290           DFHEIV1,
 19291           CALCULATION-PASS-AREA,
 19292           CP-COMM-LENGTH,
 19293           DFHEIV99,
 19294           DFHEIV99,
 19295           DFHEIV99,
 19296           DFHEIV99
 19297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19298
 19299
 19300 7500-EXIT.
 19301     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 354
* EL050.cbl
 19303
 19304 7600-GET-REFUND.
 19305
 19306* EXEC CICS LINK
 19307*        PROGRAM    ('ELRFND')
 19308*        COMMAREA   (CALCULATION-PASS-AREA)
 19309*        LENGTH     (CP-COMM-LENGTH)
 19310*    END-EXEC.
 19311     MOVE 'ELRFND' TO DFHEIV1
 19312*    MOVE '."C                   (   #00018908' TO DFHEIV0
 19313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19315     MOVE X'2020233030303138393038' TO DFHEIV0(25:11)
 19316     CALL 'kxdfhei1' USING DFHEIV0,
 19317           DFHEIV1,
 19318           CALCULATION-PASS-AREA,
 19319           CP-COMM-LENGTH,
 19320           DFHEIV99,
 19321           DFHEIV99,
 19322           DFHEIV99,
 19323           DFHEIV99
 19324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19325
 19326
 19327 7600-EXIT.
 19328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 355
* EL050.cbl
 19330 7700-CALL-DL1.
 19331
 19332* EXEC CICS LINK
 19333*        PROGRAM    ('DLO001')
 19334*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19335*        LENGTH     (DLO001-COMM-LENGTH)
 19336*    END-EXEC.
 19337     MOVE 'DLO001' TO DFHEIV1
 19338*    MOVE '."C                   (   #00018918' TO DFHEIV0
 19339     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19341     MOVE X'2020233030303138393138' TO DFHEIV0(25:11)
 19342     CALL 'kxdfhei1' USING DFHEIV0,
 19343           DFHEIV1,
 19344           WS-DLO-MASTER-POLICY-FORM,
 19345           DLO001-COMM-LENGTH,
 19346           DFHEIV99,
 19347           DFHEIV99,
 19348           DFHEIV99,
 19349           DFHEIV99
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353 7700-EXIT.
 19354     EXIT.
 19355
 19356 7710-CALL-DL2.
 19357
 19358* EXEC CICS LINK
 19359*        PROGRAM    ('DLO002')
 19360*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19361*        LENGTH     (DLO002-COMM-LENGTH)
 19362*    END-EXEC.
 19363     MOVE 'DLO002' TO DFHEIV1
 19364*    MOVE '."C                   (   #00018928' TO DFHEIV0
 19365     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19367     MOVE X'2020233030303138393238' TO DFHEIV0(25:11)
 19368     CALL 'kxdfhei1' USING DFHEIV0,
 19369           DFHEIV1,
 19370           WS-DLO-INTERNAL-POLICY-FORM,
 19371           DLO002-COMM-LENGTH,
 19372           DFHEIV99,
 19373           DFHEIV99,
 19374           DFHEIV99,
 19375           DFHEIV99
 19376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19377
 19378
 19379 7710-EXIT.
 19380     EXIT.
 19381
 19382 7720-CALL-DL3.
 19383
 19384* EXEC CICS LINK
 19385*        PROGRAM    ('DLO003')
 19386*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19387*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 356
* EL050.cbl
 19388*    END-EXEC.
 19389     MOVE 'DLO003' TO DFHEIV1
 19390*    MOVE '."C                   (   #00018938' TO DFHEIV0
 19391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303138393338' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0,
 19395           DFHEIV1,
 19396           WS-DLO-VALID-BANK-ID,
 19397           DLO003-COMM-LENGTH,
 19398           DFHEIV99,
 19399           DFHEIV99,
 19400           DFHEIV99,
 19401           DFHEIV99
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
 19405 7720-EXIT.
 19406     EXIT.
 19407
 19408 7730-CALL-DL7.
 19409
 19410* EXEC CICS LINK
 19411*        PROGRAM    ('DLO007')
 19412*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19413*        LENGTH     (DLO007-COMM-LENGTH)
 19414*    END-EXEC.
 19415     MOVE 'DLO007' TO DFHEIV1
 19416*    MOVE '."C                   (   #00018948' TO DFHEIV0
 19417     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19419     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 19420     CALL 'kxdfhei1' USING DFHEIV0,
 19421           DFHEIV1,
 19422           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19423           DLO007-COMM-LENGTH,
 19424           DFHEIV99,
 19425           DFHEIV99,
 19426           DFHEIV99,
 19427           DFHEIV99
 19428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19429
 19430
 19431 7730-EXIT.
 19432     EXIT.
 19433
 19434 7740-CALL-DL11.
 19435
 19436* EXEC CICS LINK
 19437*        PROGRAM    ('DLO011')
 19438*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19439*        LENGTH     (DLO011-COMM-LENGTH)
 19440*    END-EXEC.
 19441     MOVE 'DLO011' TO DFHEIV1
 19442*    MOVE '."C                   (   #00018958' TO DFHEIV0
 19443     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19445     MOVE X'2020233030303138393538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 357
* EL050.cbl
 19446     CALL 'kxdfhei1' USING DFHEIV0,
 19447           DFHEIV1,
 19448           WS-DLO-PREM-RATES-BEN-TYPE,
 19449           DLO011-COMM-LENGTH,
 19450           DFHEIV99,
 19451           DFHEIV99,
 19452           DFHEIV99,
 19453           DFHEIV99
 19454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19455
 19456
 19457 7740-EXIT.
 19458     EXIT.
 19459
 19460 7750-CALL-DL17.
 19461
 19462* EXEC CICS LINK
 19463*        PROGRAM    ('DLO017')
 19464*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19465*        LENGTH     (DLO017-COMM-LENGTH)
 19466*    END-EXEC.
 19467     MOVE 'DLO017' TO DFHEIV1
 19468*    MOVE '."C                   (   #00018968' TO DFHEIV0
 19469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19471     MOVE X'2020233030303138393638' TO DFHEIV0(25:11)
 19472     CALL 'kxdfhei1' USING DFHEIV0,
 19473           DFHEIV1,
 19474           WS-DLO-VALID-RATE-CODE,
 19475           DLO017-COMM-LENGTH,
 19476           DFHEIV99,
 19477           DFHEIV99,
 19478           DFHEIV99,
 19479           DFHEIV99
 19480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19481
 19482
 19483 7750-EXIT.
 19484     EXIT.
 19485
 19486 7755-CALL-DL19.
 19487
 19488* EXEC CICS LINK
 19489*        PROGRAM    ('DLO019')
 19490*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19491*        LENGTH     (DLO019-COMM-LENGTH)
 19492*    END-EXEC.
 19493     MOVE 'DLO019' TO DFHEIV1
 19494*    MOVE '."C                   (   #00018978' TO DFHEIV0
 19495     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19497     MOVE X'2020233030303138393738' TO DFHEIV0(25:11)
 19498     CALL 'kxdfhei1' USING DFHEIV0,
 19499           DFHEIV1,
 19500           WS-DLO-ORIG-COV-CAT,
 19501           DLO019-COMM-LENGTH,
 19502           DFHEIV99,
 19503           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 358
* EL050.cbl
 19504           DFHEIV99,
 19505           DFHEIV99
 19506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19507
 19508
 19509 7755-EXIT.
 19510     EXIT.
 19511
 19512 7760-CALL-DL21.
 19513
 19514* EXEC CICS LINK
 19515*        PROGRAM    ('DLO021')
 19516*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19517*        LENGTH     (DLO021-COMM-LENGTH)
 19518*    END-EXEC.
 19519     MOVE 'DLO021' TO DFHEIV1
 19520*    MOVE '."C                   (   #00018988' TO DFHEIV0
 19521     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19523     MOVE X'2020233030303138393838' TO DFHEIV0(25:11)
 19524     CALL 'kxdfhei1' USING DFHEIV0,
 19525           DFHEIV1,
 19526           WS-DLO-VALID-LOAN-OFFICER,
 19527           DLO021-COMM-LENGTH,
 19528           DFHEIV99,
 19529           DFHEIV99,
 19530           DFHEIV99,
 19531           DFHEIV99
 19532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19533
 19534
 19535 7760-EXIT.
 19536     EXIT.
 19537
 19538 7770-CALL-DL22.
 19539
 19540* EXEC CICS LINK
 19541*        PROGRAM    ('DLO022')
 19542*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19543*        LENGTH     (DLO022-COMM-LENGTH)
 19544*    END-EXEC.
 19545     MOVE 'DLO022' TO DFHEIV1
 19546*    MOVE '."C                   (   #00018998' TO DFHEIV0
 19547     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19549     MOVE X'2020233030303138393938' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0,
 19551           DFHEIV1,
 19552           WS-DLO-VALID-STATE-CODE,
 19553           DLO022-COMM-LENGTH,
 19554           DFHEIV99,
 19555           DFHEIV99,
 19556           DFHEIV99,
 19557           DFHEIV99
 19558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19559
 19560
 19561 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 359
* EL050.cbl
 19562     EXIT.
 19563
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 360
* EL050.cbl
 19565
 19566 7780-CALL-AGG.
 19567
 19568* EXEC CICS LINK
 19569*        PROGRAM    ('PEMAGGO')
 19570*        COMMAREA   (WS-PASSED-KEY-AREA)
 19571*        LENGTH     (ws-passed-key-LENGTH)
 19572*    END-EXEC.
 19573     MOVE 'PEMAGGO' TO DFHEIV1
 19574*    MOVE '."C                   (   #00019010' TO DFHEIV0
 19575     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19577     MOVE X'2020233030303139303130' TO DFHEIV0(25:11)
 19578     CALL 'kxdfhei1' USING DFHEIV0,
 19579           DFHEIV1,
 19580           WS-PASSED-KEY-AREA,
 19581           ws-passed-key-LENGTH,
 19582           DFHEIV99,
 19583           DFHEIV99,
 19584           DFHEIV99,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588 7780-EXIT.
 19589     EXIT.
 19590 7800-REWRITE-CERT.
 19591******************************************************************
 19592*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19593*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19594******************************************************************
 19595
 19596     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19597        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19598        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19599        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19600
 19601* EXEC CICS REWRITE
 19602*                  DATASET (CERT-ID)
 19603*                  FROM    (CERTIFICATE-MASTER)
 19604*              END-EXEC
 19605     MOVE LENGTH OF
 19606      CERTIFICATE-MASTER
 19607       TO DFHEIV11
 19608*    MOVE '&& L                  %   #00019027' TO DFHEIV0
 19609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19611     MOVE X'2020233030303139303237' TO DFHEIV0(25:11)
 19612     CALL 'kxdfhei1' USING DFHEIV0,
 19613           CERT-ID,
 19614           CERTIFICATE-MASTER,
 19615           DFHEIV11,
 19616           DFHEIV99
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19618        GO TO 7800-EXIT.
 19619
 19620       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19621       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19622
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 361
* EL050.cbl
 19623 7800-EXIT.
 19624      EXIT.
 19625
 19626 7900-DELETE-CERT.
 19627
 19628* EXEC CICS DELETE
 19629*        DATASET (CERT-ID)
 19630*    END-EXEC.
 19631*    MOVE '&(                    &   #00019040' TO DFHEIV0
 19632     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19634     MOVE X'2020233030303139303430' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0,
 19636           CERT-ID,
 19637           DFHEIV99,
 19638           DFHEIV99,
 19639           DFHEIV99,
 19640           DFHEIV99
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644 7900-EXIT.
 19645     EXIT.
 19646
 19647 8000-WRITE-CERT.
 19648
 19649* EXEC CICS HANDLE CONDITION
 19650*        DUPKEY    (8000-FREE-MAIN)
 19651*    END-EXEC.
 19652*    MOVE '"$$                   ! + #00019048' TO DFHEIV0
 19653     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19655     MOVE X'2B20233030303139303438' TO DFHEIV0(25:11)
 19656     CALL 'kxdfhei1' USING DFHEIV0
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660
 19661* EXEC CICS WRITE
 19662*        DATASET     (CERT-ID)
 19663*        FROM        (CERTIFICATE-MASTER)
 19664*        RIDFLD      (ELCERT-KEY)
 19665*    END-EXEC.
 19666     MOVE LENGTH OF
 19667      CERTIFICATE-MASTER
 19668       TO DFHEIV11
 19669*    MOVE '&$ L                  ''   #00019052' TO DFHEIV0
 19670     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19672     MOVE X'2020233030303139303532' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           CERT-ID,
 19675           CERTIFICATE-MASTER,
 19676           DFHEIV11,
 19677           ELCERT-KEY,
 19678           DFHEIV99,
 19679           DFHEIV99
 19680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 362
* EL050.cbl
 19681
 19682
 19683 8000-FREE-MAIN.
 19684
 19685 8000-EXIT.
 19686      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 363
* EL050.cbl
 19688
 19689 8100-READ-ERPNDM.
 19690
 19691* EXEC CICS HANDLE CONDITION
 19692*         NOTFND     (8100-NOTFND)
 19693*         ENDFILE    (8100-NOTFND)
 19694*    END-EXEC.
 19695*    MOVE '"$I''                  ! , #00019065' TO DFHEIV0
 19696     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19698     MOVE X'2C20233030303139303635' TO DFHEIV0(25:11)
 19699     CALL 'kxdfhei1' USING DFHEIV0
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703     MOVE SPACES                 TO ERPNDM-FOUND.
 19704     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19705
 19706
 19707* EXEC CICS READ
 19708*         DATASET   (FILE-ERPNDM)
 19709*         RIDFLD    (PM-CONTROL-PRIMARY)
 19710*         INTO      (PENDING-MAILING-DATA)
 19711*    END-EXEC.
 19712     MOVE LENGTH OF
 19713      PENDING-MAILING-DATA
 19714       TO DFHEIV11
 19715*    MOVE '&"IL       E          (   #00019073' TO DFHEIV0
 19716     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19718     MOVE X'2020233030303139303733' TO DFHEIV0(25:11)
 19719     CALL 'kxdfhei1' USING DFHEIV0,
 19720           FILE-ERPNDM,
 19721           PENDING-MAILING-DATA,
 19722           DFHEIV11,
 19723           PM-CONTROL-PRIMARY,
 19724           DFHEIV99,
 19725           DFHEIV99,
 19726           DFHEIV99
 19727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19728
 19729
 19730     GO TO 8100-EXIT.
 19731
 19732 8100-NOTFND.
 19733
 19734     MOVE 'X'                    TO ERPNDM-FOUND.
 19735     MOVE ER-2694                TO WS-ERROR.
 19736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19737     MOVE ER-2883                TO WS-ERROR
 19738     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19739     .
 19740 8100-EXIT.
 19741     EXIT.
 19742
 19743 8110-READ-ERMAIL.
 19744
 19745* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 364
* EL050.cbl
 19746*         NOTFND     (8110-NOTFND)
 19747*         ENDFILE    (8110-NOTFND)
 19748*    END-EXEC.
 19749*    MOVE '"$I''                  ! - #00019093' TO DFHEIV0
 19750     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19752     MOVE X'2D20233030303139303933' TO DFHEIV0(25:11)
 19753     CALL 'kxdfhei1' USING DFHEIV0
 19754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19755
 19756
 19757     MOVE SPACES                 TO ERMAIL-FOUND.
 19758     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19759     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19760     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19761     MOVE PB-SV-STATE            TO MA-STATE.
 19762
 19763
 19764* EXEC CICS READ
 19765*         UPDATE
 19766*         DATASET   (FILE-ERMAIL)
 19767*         RIDFLD    (MA-CONTROL-PRIMARY)
 19768*         INTO      (MAILING-DATA)
 19769*    END-EXEC.
 19770     MOVE LENGTH OF
 19771      MAILING-DATA
 19772       TO DFHEIV11
 19773*    MOVE '&"IL       EU         (   #00019104' TO DFHEIV0
 19774     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19775     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19776     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 19777     CALL 'kxdfhei1' USING DFHEIV0,
 19778           FILE-ERMAIL,
 19779           MAILING-DATA,
 19780           DFHEIV11,
 19781           MA-CONTROL-PRIMARY,
 19782           DFHEIV99,
 19783           DFHEIV99,
 19784           DFHEIV99
 19785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19786
 19787
 19788     GO TO 8110-EXIT.
 19789
 19790 8110-NOTFND.
 19791     MOVE 'X'                    TO ERMAIL-FOUND.
 19792
 19793 8110-EXIT.
 19794     EXIT.
 19795
 19796 8120-REWRITE-ERMAIL.
 19797
 19798* EXEC CICS REWRITE
 19799*         DATASET    (FILE-ERMAIL)
 19800*         FROM       (MAILING-DATA)
 19801*    END-EXEC.
 19802     MOVE LENGTH OF
 19803      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 365
* EL050.cbl
 19804       TO DFHEIV11
 19805*    MOVE '&& L                  %   #00019120' TO DFHEIV0
 19806     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19807     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19808     MOVE X'2020233030303139313230' TO DFHEIV0(25:11)
 19809     CALL 'kxdfhei1' USING DFHEIV0,
 19810           FILE-ERMAIL,
 19811           MAILING-DATA,
 19812           DFHEIV11,
 19813           DFHEIV99
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817 8120-EXIT.
 19818     EXIT.
 19819
 19820 8130-WRITE-ERMAIL.
 19821
 19822* EXEC CICS HANDLE CONDITION
 19823*         DUPKEY   (8130-EXIT)
 19824*    END-EXEC.
 19825*    MOVE '"$$                   ! . #00019129' TO DFHEIV0
 19826     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19828     MOVE X'2E20233030303139313239' TO DFHEIV0(25:11)
 19829     CALL 'kxdfhei1' USING DFHEIV0
 19830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19831
 19832
 19833
 19834* EXEC CICS WRITE
 19835*         DATASET     (FILE-ERMAIL)
 19836*         RIDFLD      (MA-CONTROL-PRIMARY)
 19837*         FROM        (MAILING-DATA)
 19838*    END-EXEC.
 19839     MOVE LENGTH OF
 19840      MAILING-DATA
 19841       TO DFHEIV11
 19842*    MOVE '&$ L                  ''   #00019133' TO DFHEIV0
 19843     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19845     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 19846     CALL 'kxdfhei1' USING DFHEIV0,
 19847           FILE-ERMAIL,
 19848           MAILING-DATA,
 19849           DFHEIV11,
 19850           MA-CONTROL-PRIMARY,
 19851           DFHEIV99,
 19852           DFHEIV99
 19853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19854
 19855
 19856 8130-EXIT.
 19857     EXIT.
 19858
 19859 8140-UNLOCK-ERMAIL.
 19860
 19861* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 366
* EL050.cbl
 19862*         DATASET   (FILE-ERMAIL)
 19863*    END-EXEC.
 19864*    MOVE '&*                    #   #00019143' TO DFHEIV0
 19865     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19866     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19867     MOVE X'2020233030303139313433' TO DFHEIV0(25:11)
 19868     CALL 'kxdfhei1' USING DFHEIV0,
 19869           FILE-ERMAIL,
 19870           DFHEIV99
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19872
 19873
 19874 8140-EXIT.
 19875     EXIT.
 19876
 19877 8150-read-elcrtt.
 19878
 19879
 19880* EXEC CICS HANDLE CONDITION
 19881*        NOTFND   (8150-exit)
 19882*    END-EXEC
 19883*    MOVE '"$I                   ! / #00019152' TO DFHEIV0
 19884     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19886     MOVE X'2F20233030303139313532' TO DFHEIV0(25:11)
 19887     CALL 'kxdfhei1' USING DFHEIV0
 19888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19889
 19890     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19891     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19892
 19893
 19894* EXEC CICS READ
 19895*        DATASET  (CRTT-ID)
 19896*        RIDFLD   (WS-ELCRTT-KEY)
 19897*        INTO     (CERTIFICATE-TRAILERS)
 19898*    END-EXEC
 19899     MOVE LENGTH OF
 19900      CERTIFICATE-TRAILERS
 19901       TO DFHEIV11
 19902*    MOVE '&"IL       E          (   #00019159' TO DFHEIV0
 19903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303139313539' TO DFHEIV0(25:11)
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           CRTT-ID,
 19908           CERTIFICATE-TRAILERS,
 19909           DFHEIV11,
 19910           WS-ELCRTT-KEY,
 19911           DFHEIV99,
 19912           DFHEIV99,
 19913           DFHEIV99
 19914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19915
 19916     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19917     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19918
 19919     .
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 367
* EL050.cbl
 19920 8150-exit.
 19921     exit.
 19922 8180-UPDATE-VIN-NUMBER.
 19923
 19924* EXEC CICS HANDLE CONDITION
 19925*        NOTFND   (8180-NOTFND)
 19926*    END-EXEC.
 19927*    MOVE '"$I                   ! 0 #00019172' TO DFHEIV0
 19928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19930     MOVE X'3020233030303139313732' TO DFHEIV0(25:11)
 19931     CALL 'kxdfhei1' USING DFHEIV0
 19932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19933
 19934
 19935     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19936     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19937
 19938
 19939* EXEC CICS READ
 19940*        UPDATE
 19941*        DATASET  (CRTT-ID)
 19942*        RIDFLD   (WS-ELCRTT-KEY)
 19943*        INTO     (CERTIFICATE-TRAILERS)
 19944*    END-EXEC.
 19945     MOVE LENGTH OF
 19946      CERTIFICATE-TRAILERS
 19947       TO DFHEIV11
 19948*    MOVE '&"IL       EU         (   #00019179' TO DFHEIV0
 19949     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           CRTT-ID,
 19954           CERTIFICATE-TRAILERS,
 19955           DFHEIV11,
 19956           WS-ELCRTT-KEY,
 19957           DFHEIV99,
 19958           DFHEIV99,
 19959           DFHEIV99
 19960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19961
 19962
 19963     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19964         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19965
 19966* EXEC CICS REWRITE
 19967*           DATASET  (CRTT-ID)
 19968*           FROM     (CERTIFICATE-TRAILERS)
 19969*        END-EXEC
 19970     MOVE LENGTH OF
 19971      CERTIFICATE-TRAILERS
 19972       TO DFHEIV11
 19973*    MOVE '&& L                  %   #00019188' TO DFHEIV0
 19974     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19975     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19976     MOVE X'2020233030303139313838' TO DFHEIV0(25:11)
 19977     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 368
* EL050.cbl
 19978           CRTT-ID,
 19979           CERTIFICATE-TRAILERS,
 19980           DFHEIV11,
 19981           DFHEIV99
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19983     ELSE
 19984
 19985* EXEC CICS UNLOCK
 19986*          DATASET  (CRTT-ID)
 19987*       END-EXEC
 19988*    MOVE '&*                    #   #00019193' TO DFHEIV0
 19989     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19990     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19991     MOVE X'2020233030303139313933' TO DFHEIV0(25:11)
 19992     CALL 'kxdfhei1' USING DFHEIV0,
 19993           CRTT-ID,
 19994           DFHEIV99
 19995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19996     END-IF.
 19997
 19998     GO TO 8180-EXIT.
 19999
 20000 8180-NOTFND.
 20001
 20002     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20003     MOVE 'CS'         TO CS-RECORD-ID.
 20004     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20005     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20006     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20007     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20008
 20009* EXEC CICS WRITE
 20010*       DATASET  (CRTT-ID)
 20011*       RIDFLD   (WS-ELCRTT-KEY)
 20012*       FROM     (CERTIFICATE-TRAILERS)
 20013*    END-EXEC.
 20014     MOVE LENGTH OF
 20015      CERTIFICATE-TRAILERS
 20016       TO DFHEIV11
 20017*    MOVE '&$ L                  ''   #00019208' TO DFHEIV0
 20018     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20020     MOVE X'2020233030303139323038' TO DFHEIV0(25:11)
 20021     CALL 'kxdfhei1' USING DFHEIV0,
 20022           CRTT-ID,
 20023           CERTIFICATE-TRAILERS,
 20024           DFHEIV11,
 20025           WS-ELCRTT-KEY,
 20026           DFHEIV99,
 20027           DFHEIV99
 20028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20029
 20030
 20031 8180-EXIT.
 20032     EXIT.
 20033
 20034 8190-UPDATE-REFUND-CLAIM-FLAG.
 20035
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 369
* EL050.cbl
 20036* EXEC CICS HANDLE CONDITION
 20037*        NOTFND   (8190-NOTFND)
 20038*    END-EXEC.
 20039*    MOVE '"$I                   ! 1 #00019218' TO DFHEIV0
 20040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20042     MOVE X'3120233030303139323138' TO DFHEIV0(25:11)
 20043     CALL 'kxdfhei1' USING DFHEIV0
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20048     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20049
 20050
 20051* EXEC CICS READ
 20052*        UPDATE
 20053*        DATASET  (CRTT-ID)
 20054*        RIDFLD   (WS-ELCRTT-KEY)
 20055*        INTO     (CERTIFICATE-TRAILERS)
 20056*    END-EXEC.
 20057     MOVE LENGTH OF
 20058      CERTIFICATE-TRAILERS
 20059       TO DFHEIV11
 20060*    MOVE '&"IL       EU         (   #00019225' TO DFHEIV0
 20061     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20062     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20063     MOVE X'2020233030303139323235' TO DFHEIV0(25:11)
 20064     CALL 'kxdfhei1' USING DFHEIV0,
 20065           CRTT-ID,
 20066           CERTIFICATE-TRAILERS,
 20067           DFHEIV11,
 20068           WS-ELCRTT-KEY,
 20069           DFHEIV99,
 20070           DFHEIV99,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20076
 20077* EXEC CICS REWRITE
 20078*       DATASET  (CRTT-ID)
 20079*       FROM     (CERTIFICATE-TRAILERS)
 20080*    END-EXEC.
 20081     MOVE LENGTH OF
 20082      CERTIFICATE-TRAILERS
 20083       TO DFHEIV11
 20084*    MOVE '&& L                  %   #00019233' TO DFHEIV0
 20085     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           CRTT-ID,
 20090           CERTIFICATE-TRAILERS,
 20091           DFHEIV11,
 20092           DFHEIV99
 20093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 370
* EL050.cbl
 20094
 20095
 20096     GO TO 8190-EXIT.
 20097
 20098 8190-NOTFND.
 20099
 20100     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20101     MOVE 'CS'         TO CS-RECORD-ID.
 20102     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20103     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20104     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20105     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20106
 20107* EXEC CICS WRITE
 20108*       DATASET  (CRTT-ID)
 20109*       RIDFLD   (WS-ELCRTT-KEY)
 20110*       FROM     (CERTIFICATE-TRAILERS)
 20111*    END-EXEC.
 20112     MOVE LENGTH OF
 20113      CERTIFICATE-TRAILERS
 20114       TO DFHEIV11
 20115*    MOVE '&$ L                  ''   #00019248' TO DFHEIV0
 20116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20118     MOVE X'2020233030303139323438' TO DFHEIV0(25:11)
 20119     CALL 'kxdfhei1' USING DFHEIV0,
 20120           CRTT-ID,
 20121           CERTIFICATE-TRAILERS,
 20122           DFHEIV11,
 20123           WS-ELCRTT-KEY,
 20124           DFHEIV99,
 20125           DFHEIV99
 20126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20127
 20128
 20129 8190-EXIT.
 20130     EXIT.
 20131
 20132 8195-UPDATE-AGE-FLAGS.
 20133
 20134* EXEC CICS HANDLE CONDITION
 20135*        NOTFND   (8195-NOTFND)
 20136*    END-EXEC.
 20137*    MOVE '"$I                   ! 2 #00019258' TO DFHEIV0
 20138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20140     MOVE X'3220233030303139323538' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20143
 20144
 20145     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20146     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20147
 20148
 20149* EXEC CICS READ
 20150*        UPDATE
 20151*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 371
* EL050.cbl
 20152*        RIDFLD   (WS-ELCRTT-KEY)
 20153*        INTO     (CERTIFICATE-TRAILERS)
 20154*    END-EXEC.
 20155     MOVE LENGTH OF
 20156      CERTIFICATE-TRAILERS
 20157       TO DFHEIV11
 20158*    MOVE '&"IL       EU         (   #00019265' TO DFHEIV0
 20159     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20160     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20161     MOVE X'2020233030303139323635' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           CRTT-ID,
 20164           CERTIFICATE-TRAILERS,
 20165           DFHEIV11,
 20166           WS-ELCRTT-KEY,
 20167           DFHEIV99,
 20168           DFHEIV99,
 20169           DFHEIV99
 20170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20171
 20172
 20173     IF WS-INS-AGE-SET = 'Y'
 20174        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20175     END-IF
 20176     IF WS-JNT-AGE-SET = 'Y'
 20177        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20178     END-IF
 20179
 20180
 20181* EXEC CICS REWRITE
 20182*       DATASET  (CRTT-ID)
 20183*       FROM     (CERTIFICATE-TRAILERS)
 20184*    END-EXEC.
 20185     MOVE LENGTH OF
 20186      CERTIFICATE-TRAILERS
 20187       TO DFHEIV11
 20188*    MOVE '&& L                  %   #00019279' TO DFHEIV0
 20189     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           CRTT-ID,
 20194           CERTIFICATE-TRAILERS,
 20195           DFHEIV11,
 20196           DFHEIV99
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20198
 20199
 20200     GO TO 8195-EXIT.
 20201
 20202 8195-NOTFND.
 20203
 20204     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20205     MOVE 'CS'         TO CS-RECORD-ID.
 20206     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20207     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20208     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20209     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 372
* EL050.cbl
 20210     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20211
 20212* EXEC CICS WRITE
 20213*       DATASET  (CRTT-ID)
 20214*       RIDFLD   (WS-ELCRTT-KEY)
 20215*       FROM     (CERTIFICATE-TRAILERS)
 20216*    END-EXEC.
 20217     MOVE LENGTH OF
 20218      CERTIFICATE-TRAILERS
 20219       TO DFHEIV11
 20220*    MOVE '&$ L                  ''   #00019295' TO DFHEIV0
 20221     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20222     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20223     MOVE X'2020233030303139323935' TO DFHEIV0(25:11)
 20224     CALL 'kxdfhei1' USING DFHEIV0,
 20225           CRTT-ID,
 20226           CERTIFICATE-TRAILERS,
 20227           DFHEIV11,
 20228           WS-ELCRTT-KEY,
 20229           DFHEIV99,
 20230           DFHEIV99
 20231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20232
 20233
 20234 8195-EXIT.
 20235     EXIT.
 20236
 20237 8200-READ-REIN-TABLE.
 20238
 20239* EXEC CICS HANDLE CONDITION
 20240*         NOTFND   (8200-NOTFND)
 20241*    END-EXEC.
 20242*    MOVE '"$I                   ! 3 #00019305' TO DFHEIV0
 20243     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20245     MOVE X'3320233030303139333035' TO DFHEIV0(25:11)
 20246     CALL 'kxdfhei1' USING DFHEIV0
 20247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20248
 20249
 20250
 20251* EXEC CICS READ
 20252*        DATASET     (REIN-ID)
 20253*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20254*        RIDFLD      (ERREIN-KEY)
 20255*    END-EXEC.
 20256*    MOVE '&"S        E          (   #00019309' TO DFHEIV0
 20257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20259     MOVE X'2020233030303139333039' TO DFHEIV0(25:11)
 20260     CALL 'kxdfhei1' USING DFHEIV0,
 20261           REIN-ID,
 20262           DFHEIV20,
 20263           DFHEIV99,
 20264           ERREIN-KEY,
 20265           DFHEIV99,
 20266           DFHEIV99,
 20267           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 373
* EL050.cbl
 20268     SET ADDRESS OF REINSURANCE-RECORD TO
 20269         DFHEIV20
 20270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20271
 20272
 20273     GO TO 8200-EXIT.
 20274
 20275 8200-NOTFND.
 20276     MOVE 'N'             TO WS-REIN-READ-SW.
 20277
 20278 8200-EXIT.
 20279      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 374
* EL050.cbl
 20281
 20282 8300-READ-CTBL-TABLE.
 20283
 20284* EXEC CICS HANDLE CONDITION
 20285*        NOTFND    (8300-NOTFND)
 20286*        DISABLED  (8300-ERRESS-PROBLEM)
 20287*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20288*        ENDFILE   (8300-NOTFND)
 20289*    END-EXEC.
 20290*    MOVE '"$IcJ''                ! 4 #00019325' TO DFHEIV0
 20291     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20293     MOVE X'3420233030303139333235' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0
 20295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20296
 20297
 20298
 20299* EXEC CICS READ
 20300*        DATASET     (CTBL-ID)
 20301*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20302*        RIDFLD      (ERCTBL-KEY)
 20303*    END-EXEC.
 20304*    MOVE '&"S        E          (   #00019332' TO DFHEIV0
 20305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20307     MOVE X'2020233030303139333332' TO DFHEIV0(25:11)
 20308     CALL 'kxdfhei1' USING DFHEIV0,
 20309           CTBL-ID,
 20310           DFHEIV20,
 20311           DFHEIV99,
 20312           ERCTBL-KEY,
 20313           DFHEIV99,
 20314           DFHEIV99,
 20315           DFHEIV99
 20316     SET ADDRESS OF COMM-TABLE-RECORD TO
 20317         DFHEIV20
 20318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20319
 20320
 20321     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20322
 20323     GO TO 8300-EXIT.
 20324
 20325 8300-NOTFND.
 20326
 20327     IF CTBL-SW = '0530'
 20328         MOVE 'AA'                     TO WS-AH-COMP-CD
 20329         MOVE '0550'                   TO CTBL-SW
 20330         MOVE '1'                      TO WS-CTBL-READ-SW
 20331         GO TO 8300-EXIT.
 20332
 20333     IF CTBL-SW = '0540'
 20334         MOVE 'AA'                     TO WS-LF-COMP-CD
 20335         MOVE '0550'                   TO CTBL-SW
 20336         MOVE '1'                      TO WS-CTBL-READ-SW
 20337         GO TO 8300-EXIT.
 20338
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 375
* EL050.cbl
 20339     IF CTBL-SW = '0550'
 20340         MOVE '2'                      TO WS-CTBL-READ-SW
 20341         GO TO 8300-EXIT.
 20342
 20343     GO TO 8300-EXIT.
 20344
 20345 8300-ERRESS-PROBLEM.
 20346
 20347      MOVE ER-8050              TO WS-ERROR.
 20348      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20349
 20350     GO TO 8300-EXIT.
 20351
 20352 8300-EXIT.
 20353      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 376
* EL050.cbl
 20355
 20356
 20357 8400-GETMAIN-ERFORM.
 20358
 20359
 20360* EXEC CICS   GETMAIN
 20361*        LENGTH  (500)
 20362*        SET     (ADDRESS OF FORM-MASTER)
 20363*    END-EXEC.
 20364     MOVE 500
 20365       TO DFHEIV11
 20366*    MOVE '," L                  $   #00019376' TO DFHEIV0
 20367     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20369     MOVE X'2020233030303139333736' TO DFHEIV0(25:11)
 20370     CALL 'kxdfhei1' USING DFHEIV0,
 20371           DFHEIV20,
 20372           DFHEIV11,
 20373           DFHEIV99
 20374     SET ADDRESS OF FORM-MASTER TO
 20375         DFHEIV20
 20376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20377
 20378
 20379     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20380
 20381 8400-EXIT.
 20382      EXIT.
 20383
 20384 8450-READ-FORM-MASTER.
 20385
 20386
 20387* EXEC CICS  HANDLE CONDITION
 20388*        NOTFND   (8450-FORM-NOT-FOUND)
 20389*        ENDFILE  (8450-FORM-NOT-FOUND)
 20390*    END-EXEC.
 20391*    MOVE '"$I''                  ! 5 #00019388' TO DFHEIV0
 20392     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20394     MOVE X'3520233030303139333838' TO DFHEIV0(25:11)
 20395     CALL 'kxdfhei1' USING DFHEIV0
 20396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20397
 20398
 20399
 20400* EXEC CICS   READ
 20401*        DATASET   (FORM-ID)
 20402*        RIDFLD    (ERFORM-KEY)
 20403*        INTO      (FORM-MASTER)
 20404*        GTEQ
 20405*    END-EXEC.
 20406     MOVE LENGTH OF
 20407      FORM-MASTER
 20408       TO DFHEIV11
 20409*    MOVE '&"IL       G          (   #00019393' TO DFHEIV0
 20410     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20412     MOVE X'2020233030303139333933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 377
* EL050.cbl
 20413     CALL 'kxdfhei1' USING DFHEIV0,
 20414           FORM-ID,
 20415           FORM-MASTER,
 20416           DFHEIV11,
 20417           ERFORM-KEY,
 20418           DFHEIV99,
 20419           DFHEIV99,
 20420           DFHEIV99
 20421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20422
 20423
 20424     MOVE  'Y'           TO  FORM-MASTER-SW.
 20425
 20426     GO TO  8450-EXIT.
 20427
 20428 8450-FORM-NOT-FOUND.
 20429
 20430     MOVE  'N'           TO  FORM-MASTER-SW.
 20431
 20432 8450-EXIT.
 20433      EXIT.
 20434
 20435 8500-DATE-CONVERT.
 20436
 20437* EXEC CICS LINK
 20438*        PROGRAM    ('ELDATCV')
 20439*        COMMAREA   (DATE-CONVERSION-DATA)
 20440*        LENGTH     (DC-COMM-LENGTH)
 20441*    END-EXEC.
 20442     MOVE 'ELDATCV' TO DFHEIV1
 20443*    MOVE '."C                   (   #00019412' TO DFHEIV0
 20444     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303139343132' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           DFHEIV1,
 20449           DATE-CONVERSION-DATA,
 20450           DC-COMM-LENGTH,
 20451           DFHEIV99,
 20452           DFHEIV99,
 20453           DFHEIV99,
 20454           DFHEIV99
 20455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20456
 20457
 20458 8500-EXIT.
 20459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 378
* EL050.cbl
 20461
 20462 8555-RELOAD-CONTROL-FILE.
 20463     CONTINUE.
 20464
 20465 8555-EXIT.
 20466     EXIT.
 20467
 20468 8557-GETMAIN-ERPLAN.
 20469
 20470
 20471* EXEC CICS GETMAIN
 20472*        LENGTH    (840)
 20473*        SET       (ADDRESS OF PLAN-RECORDS)
 20474*    END-EXEC.
 20475     MOVE 840
 20476       TO DFHEIV11
 20477*    MOVE '," L                  $   #00019430' TO DFHEIV0
 20478     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20480     MOVE X'2020233030303139343330' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0,
 20482           DFHEIV20,
 20483           DFHEIV11,
 20484           DFHEIV99
 20485     SET ADDRESS OF PLAN-RECORDS TO
 20486         DFHEIV20
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20491
 20492 8557-EXIT.
 20493     EXIT.
 20494
 20495 8560-GETMAIN.
 20496
 20497* EXEC CICS GETMAIN
 20498*        LENGTH    (2000)
 20499*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20500*    END-EXEC.
 20501     MOVE 2000
 20502       TO DFHEIV11
 20503*    MOVE '," L                  $   #00019441' TO DFHEIV0
 20504     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20506     MOVE X'2020233030303139343431' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0,
 20508           DFHEIV20,
 20509           DFHEIV11,
 20510           DFHEIV99
 20511     SET ADDRESS OF ACCOUNT-MASTER TO
 20512         DFHEIV20
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20517
 20518 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 379
* EL050.cbl
 20519     EXIT.
 20520
 20521 8570-START-ACCOUNT-MASTER.
 20522
 20523* EXEC CICS HANDLE CONDITION
 20524*        NOTFND    (0199-ACCT-NOT-FOUND)
 20525*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20526*    END-EXEC.
 20527*    MOVE '"$I''                  ! 6 #00019452' TO DFHEIV0
 20528     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20530     MOVE X'3620233030303139343532' TO DFHEIV0(25:11)
 20531     CALL 'kxdfhei1' USING DFHEIV0
 20532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20533
 20534
 20535
 20536* EXEC CICS STARTBR
 20537*        DATASET    (ACCT-ID)
 20538*        RIDFLD     (ERACCT-KEY)
 20539*        GTEQ
 20540*    END-EXEC.
 20541     MOVE 0
 20542       TO DFHEIV11
 20543*    MOVE '&,         G          &   #00019457' TO DFHEIV0
 20544     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20546     MOVE X'2020233030303139343537' TO DFHEIV0(25:11)
 20547     CALL 'kxdfhei1' USING DFHEIV0,
 20548           ACCT-ID,
 20549           ERACCT-KEY,
 20550           DFHEIV99,
 20551           DFHEIV11,
 20552           DFHEIV99
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20554
 20555
 20556 8570-EXIT.
 20557     EXIT.
 20558
 20559 8580-READ-ACCOUNT-MASTER.
 20560
 20561* EXEC CICS HANDLE CONDITION
 20562*        NOTFND    (0199-ACCT-NOT-FOUND)
 20563*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20564*    END-EXEC.
 20565*    MOVE '"$I''                  ! 7 #00019467' TO DFHEIV0
 20566     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20568     MOVE X'3720233030303139343637' TO DFHEIV0(25:11)
 20569     CALL 'kxdfhei1' USING DFHEIV0
 20570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20571
 20572
 20573
 20574* EXEC CICS READNEXT
 20575*        DATASET     (ACCT-ID)
 20576*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 380
* EL050.cbl
 20577*        RIDFLD      (ERACCT-KEY)
 20578*    END-EXEC.
 20579     MOVE LENGTH OF
 20580      ACCOUNT-MASTER
 20581       TO DFHEIV12
 20582     MOVE 0
 20583       TO DFHEIV11
 20584*    MOVE '&.IL                  )   #00019472' TO DFHEIV0
 20585     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20586     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20587     MOVE X'2020233030303139343732' TO DFHEIV0(25:11)
 20588     CALL 'kxdfhei1' USING DFHEIV0,
 20589           ACCT-ID,
 20590           ACCOUNT-MASTER,
 20591           DFHEIV12,
 20592           ERACCT-KEY,
 20593           DFHEIV99,
 20594           DFHEIV11,
 20595           DFHEIV99,
 20596           DFHEIV99
 20597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20598
 20599
 20600 8580-EXIT.
 20601     EXIT.
 20602
 20603 8582-READ-COMPENSATION-MASTER.
 20604
 20605* EXEC CICS HANDLE CONDITION
 20606*        NOTFND    (8582-COMP-NOT-FOUND)
 20607*        ENDFILE   (8582-COMP-NOT-FOUND)
 20608*    END-EXEC.
 20609*    MOVE '"$I''                  ! 8 #00019482' TO DFHEIV0
 20610     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20612     MOVE X'3820233030303139343832' TO DFHEIV0(25:11)
 20613     CALL 'kxdfhei1' USING DFHEIV0
 20614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20615
 20616
 20617
 20618* EXEC CICS READ
 20619*        DATASET     (COMP-ID)
 20620*        INTO        (COMPENSATION-MASTER)
 20621*        RIDFLD      (ERCOMP-KEY)
 20622*    END-EXEC.
 20623     MOVE LENGTH OF
 20624      COMPENSATION-MASTER
 20625       TO DFHEIV11
 20626*    MOVE '&"IL       E          (   #00019487' TO DFHEIV0
 20627     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20629     MOVE X'2020233030303139343837' TO DFHEIV0(25:11)
 20630     CALL 'kxdfhei1' USING DFHEIV0,
 20631           COMP-ID,
 20632           COMPENSATION-MASTER,
 20633           DFHEIV11,
 20634           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 381
* EL050.cbl
 20635           DFHEIV99,
 20636           DFHEIV99,
 20637           DFHEIV99
 20638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20639
 20640
 20641     MOVE 'Y'                    TO COMP-MASTER-SW
 20642
 20643     GO TO 8582-EXIT
 20644     .
 20645 8582-COMP-NOT-FOUND.
 20646
 20647     MOVE 'N'                    TO COMP-MASTER-SW.
 20648
 20649 8582-EXIT.
 20650     EXIT.
 20651
 20652 8583-READ-ERAGTC.
 20653
 20654* EXEC CICS HANDLE CONDITION
 20655*        NOTFND    (8583-AGTC-NOT-FOUND)
 20656*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20657*    END-EXEC.
 20658*    MOVE '"$I''                  ! 9 #00019505' TO DFHEIV0
 20659     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20661     MOVE X'3920233030303139353035' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0
 20663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20664
 20665
 20666
 20667* EXEC CICS STARTBR
 20668*        DATASET    (AGTC-ID)
 20669*        RIDFLD     (ERAGTC-KEY)
 20670*        GTEQ
 20671*    END-EXEC.
 20672     MOVE 0
 20673       TO DFHEIV11
 20674*    MOVE '&,         G          &   #00019510' TO DFHEIV0
 20675     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20677     MOVE X'2020233030303139353130' TO DFHEIV0(25:11)
 20678     CALL 'kxdfhei1' USING DFHEIV0,
 20679           AGTC-ID,
 20680           ERAGTC-KEY,
 20681           DFHEIV99,
 20682           DFHEIV11,
 20683           DFHEIV99
 20684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20685
 20686
 20687 8583-READ-ERAGTC-NEXT.
 20688
 20689* EXEC CICS READNEXT
 20690*        DATASET     (AGTC-ID)
 20691*        INTO        (AGENT-COMMISSIONS)
 20692*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 382
* EL050.cbl
 20693*    END-EXEC.
 20694     MOVE LENGTH OF
 20695      AGENT-COMMISSIONS
 20696       TO DFHEIV12
 20697     MOVE 0
 20698       TO DFHEIV11
 20699*    MOVE '&.IL                  )   #00019517' TO DFHEIV0
 20700     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20702     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 20703     CALL 'kxdfhei1' USING DFHEIV0,
 20704           AGTC-ID,
 20705           AGENT-COMMISSIONS,
 20706           DFHEIV12,
 20707           ERAGTC-KEY,
 20708           DFHEIV99,
 20709           DFHEIV11,
 20710           DFHEIV99,
 20711           DFHEIV99
 20712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20713
 20714
 20715*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20716
 20717     GO TO 8583-EXIT
 20718     .
 20719 8583-AGTC-NOT-FOUND.
 20720
 20721     MOVE 'N'                    TO AGTC-MASTER-SW.
 20722
 20723 8583-EXIT.
 20724     EXIT.
 20725
 20726 8584-READ-BANK-CROSS-REF.
 20727
 20728* EXEC CICS HANDLE CONDITION
 20729*        NOTFND    (8584-BXRF-NOT-FOUND)
 20730*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20731*    END-EXEC.
 20732*    MOVE '"$I''                  ! : #00019535' TO DFHEIV0
 20733     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20735     MOVE X'3A20233030303139353335' TO DFHEIV0(25:11)
 20736     CALL 'kxdfhei1' USING DFHEIV0
 20737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20738
 20739
 20740
 20741* EXEC CICS READ
 20742*        DATASET     (BXRF-ID)
 20743*        INTO        (BANK-CROSS-REFERENCE)
 20744*        RIDFLD      (ERBXRF-KEY)
 20745*        LENGTH      (BXRF-REC-LENGTH)
 20746*    END-EXEC.
 20747*    MOVE '&"IL       E          (   #00019540' TO DFHEIV0
 20748     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20750     MOVE X'2020233030303139353430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 383
* EL050.cbl
 20751     CALL 'kxdfhei1' USING DFHEIV0,
 20752           BXRF-ID,
 20753           BANK-CROSS-REFERENCE,
 20754           BXRF-REC-LENGTH,
 20755           ERBXRF-KEY,
 20756           DFHEIV99,
 20757           DFHEIV99,
 20758           DFHEIV99
 20759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20760
 20761
 20762     MOVE 'Y'                    TO BXRF-MASTER-SW
 20763
 20764     GO TO 8584-EXIT
 20765     .
 20766 8584-BXRF-NOT-FOUND.
 20767
 20768     MOVE 'N'                    TO BXRF-MASTER-SW.
 20769
 20770 8584-EXIT.
 20771     EXIT.
 20772
 20773 8585-READ-PLAN-MASTER.
 20774
 20775
 20776* EXEC CICS HANDLE CONDITION
 20777*        NOTFND    (8585-PLAN-NOT-FOUND)
 20778*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20779*    END-EXEC.
 20780*    MOVE '"$I''                  ! ; #00019560' TO DFHEIV0
 20781     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20783     MOVE X'3B20233030303139353630' TO DFHEIV0(25:11)
 20784     CALL 'kxdfhei1' USING DFHEIV0
 20785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20786
 20787
 20788
 20789* EXEC CICS READ
 20790*        DATASET     (PLAN-ID)
 20791*        INTO        (PLAN-MASTER)
 20792*        RIDFLD      (ERPLAN-KEY)
 20793*    END-EXEC.
 20794     MOVE LENGTH OF
 20795      PLAN-MASTER
 20796       TO DFHEIV11
 20797*    MOVE '&"IL       E          (   #00019565' TO DFHEIV0
 20798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303139353635' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           PLAN-ID,
 20803           PLAN-MASTER,
 20804           DFHEIV11,
 20805           ERPLAN-KEY,
 20806           DFHEIV99,
 20807           DFHEIV99,
 20808           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 384
* EL050.cbl
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20813
 20814     GO TO 8585-EXIT.
 20815
 20816 8585-PLAN-NOT-FOUND.
 20817
 20818     MOVE 'N'                    TO PLAN-MASTER-SW.
 20819
 20820 8585-EXIT.
 20821     EXIT.
 20822
 20823 8586-READ-LOAN-OFFICER.
 20824
 20825* EXEC CICS READ
 20826*        DATASET     (LOFC-ID)
 20827*        INTO        (LOAN-OFFICER-MASTER)
 20828*        RIDFLD      (ERLOFC-KEY)
 20829*        RESP        (WS-RESPONSE)
 20830*    END-EXEC
 20831     MOVE LENGTH OF
 20832      LOAN-OFFICER-MASTER
 20833       TO DFHEIV11
 20834*    MOVE '&"IL       E          (  N#00019583' TO DFHEIV0
 20835     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20837     MOVE X'204E233030303139353833' TO DFHEIV0(25:11)
 20838     CALL 'kxdfhei1' USING DFHEIV0,
 20839           LOFC-ID,
 20840           LOAN-OFFICER-MASTER,
 20841           DFHEIV11,
 20842           ERLOFC-KEY,
 20843           DFHEIV99,
 20844           DFHEIV99,
 20845           DFHEIV99
 20846     MOVE EIBRESP  TO WS-RESPONSE
 20847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20848
 20849     IF WS-RESP-NORMAL
 20850        MOVE 'Y'                 TO LOFC-MASTER-SW
 20851     ELSE
 20852        MOVE 'N'                 TO LOFC-MASTER-SW
 20853     END-IF
 20854     .
 20855 8586-EXIT.
 20856     EXIT.
 20857 8587-START-ERPDEF.
 20858
 20859* EXEC CICS STARTBR
 20860*       DATASET   (PDEF-ID)
 20861*       RIDFLD    (ERPDEF-KEY)
 20862*       GTEQ
 20863*       RESP      (WS-RESPONSE)
 20864*    END-EXEC
 20865     MOVE 0
 20866       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 385
* EL050.cbl
 20867*    MOVE '&,         G          &  N#00019599' TO DFHEIV0
 20868     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20870     MOVE X'204E233030303139353939' TO DFHEIV0(25:11)
 20871     CALL 'kxdfhei1' USING DFHEIV0,
 20872           PDEF-ID,
 20873           ERPDEF-KEY,
 20874           DFHEIV99,
 20875           DFHEIV11,
 20876           DFHEIV99
 20877     MOVE EIBRESP  TO WS-RESPONSE
 20878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20879     IF WS-RESP-NORMAL
 20880        MOVE 'Y'                 TO PDEF-MASTER-SW
 20881     ELSE
 20882        MOVE 'N'                 TO PDEF-MASTER-SW
 20883     END-IF
 20884     .
 20885 8587-EXIT.
 20886     EXIT.
 20887 8588-READ-ERPDEF.
 20888
 20889* EXEC CICS READNEXT
 20890*       DATASET   (PDEF-ID)
 20891*       RIDFLD    (ERPDEF-KEY)
 20892*       INTO      (PRODUCT-MASTER)
 20893*       RESP      (WS-RESPONSE)
 20894*    END-EXEC
 20895     MOVE LENGTH OF
 20896      PRODUCT-MASTER
 20897       TO DFHEIV12
 20898     MOVE 0
 20899       TO DFHEIV11
 20900*    MOVE '&.IL                  )  N#00019614' TO DFHEIV0
 20901     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20902     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20903     MOVE X'204E233030303139363134' TO DFHEIV0(25:11)
 20904     CALL 'kxdfhei1' USING DFHEIV0,
 20905           PDEF-ID,
 20906           PRODUCT-MASTER,
 20907           DFHEIV12,
 20908           ERPDEF-KEY,
 20909           DFHEIV99,
 20910           DFHEIV11,
 20911           DFHEIV99,
 20912           DFHEIV99
 20913     MOVE EIBRESP  TO WS-RESPONSE
 20914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20915     IF WS-RESP-NORMAL
 20916        MOVE 'Y'                 TO PDEF-MASTER-SW
 20917     ELSE
 20918        MOVE 'N'                 TO PDEF-MASTER-SW
 20919     END-IF
 20920     .
 20921 8588-EXIT.
 20922     EXIT.
 20923 8589-ENDBR-ERPDEF.
 20924
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 386
* EL050.cbl
 20925* EXEC CICS ENDBR
 20926*       DATASET   (PDEF-ID)
 20927*    END-EXEC
 20928     MOVE 0
 20929       TO DFHEIV11
 20930*    MOVE '&2                    $   #00019629' TO DFHEIV0
 20931     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20933     MOVE X'2020233030303139363239' TO DFHEIV0(25:11)
 20934     CALL 'kxdfhei1' USING DFHEIV0,
 20935           PDEF-ID,
 20936           DFHEIV11,
 20937           DFHEIV99
 20938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20939     .
 20940 8589-EXIT.
 20941     EXIT.
 20942 8590-READ-CERT-MASTER.
 20943     IF PB-COMPANY-ID = 'UCL'
 20944         GO TO 8690-READ-CERT-MASTER-UCL.
 20945
 20946
 20947* EXEC CICS HANDLE CONDITION
 20948*         NOTFND    (0299-CERT-NOT-FOUND)
 20949*    END-EXEC.
 20950*    MOVE '"$I                   ! < #00019639' TO DFHEIV0
 20951     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20953     MOVE X'3C20233030303139363339' TO DFHEIV0(25:11)
 20954     CALL 'kxdfhei1' USING DFHEIV0
 20955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20956
 20957
 20958
 20959* EXEC CICS READ
 20960*        DATASET     (CERT-ID)
 20961*        INTO        (CERTIFICATE-MASTER)
 20962*        RIDFLD      (ELCERT-KEY)
 20963*        UPDATE
 20964*    END-EXEC.
 20965     MOVE LENGTH OF
 20966      CERTIFICATE-MASTER
 20967       TO DFHEIV11
 20968*    MOVE '&"IL       EU         (   #00019643' TO DFHEIV0
 20969     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20970     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20971     MOVE X'2020233030303139363433' TO DFHEIV0(25:11)
 20972     CALL 'kxdfhei1' USING DFHEIV0,
 20973           CERT-ID,
 20974           CERTIFICATE-MASTER,
 20975           DFHEIV11,
 20976           ELCERT-KEY,
 20977           DFHEIV99,
 20978           DFHEIV99,
 20979           DFHEIV99
 20980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20981
 20982
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 387
* EL050.cbl
 20983 8590-EXIT.
 20984     EXIT.
 20985
 20986 8690-READ-CERT-MASTER-UCL.
 20987
 20988* EXEC CICS HANDLE CONDITION
 20989*         NOTFND    (8700-READ-CERT-MASTER)
 20990*    END-EXEC.
 20991*    MOVE '"$I                   ! = #00019654' TO DFHEIV0
 20992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20994     MOVE X'3D20233030303139363534' TO DFHEIV0(25:11)
 20995     CALL 'kxdfhei1' USING DFHEIV0
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
 20999 8690-READ-CERT-CONT.
 21000
 21001* EXEC CICS READ
 21002*        DATASET     (CERT-ID)
 21003*        INTO        (CERTIFICATE-MASTER)
 21004*        RIDFLD      (ELCERT-KEY)
 21005*        UPDATE
 21006*    END-EXEC.
 21007     MOVE LENGTH OF
 21008      CERTIFICATE-MASTER
 21009       TO DFHEIV11
 21010*    MOVE '&"IL       EU         (   #00019659' TO DFHEIV0
 21011     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21012     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303139363539' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           CERT-ID,
 21016           CERTIFICATE-MASTER,
 21017           DFHEIV11,
 21018           ELCERT-KEY,
 21019           DFHEIV99,
 21020           DFHEIV99,
 21021           DFHEIV99
 21022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21023
 21024
 21025     GO TO 8590-EXIT.
 21026
 21027 8700-READ-CERT-MASTER.
 21028     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21029     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21030
 21031* EXEC CICS HANDLE CONDITION
 21032*         DUPKEY    (8720-COMP-ACCOUNTS)
 21033*         ENDFILE   (8730-END-BROWSE)
 21034*         NOTFND    (8740-NOT-FOUND)
 21035*    END-EXEC.
 21036*    MOVE '"$$''I                 ! > #00019671' TO DFHEIV0
 21037     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21039     MOVE X'3E20233030303139363731' TO DFHEIV0(25:11)
 21040     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 388
* EL050.cbl
 21041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21042
 21043
 21044
 21045* EXEC CICS STARTBR
 21046*        DATASET     ('ELCERT5')
 21047*        RIDFLD      (ELCERT2-KEY)
 21048*        EQUAL
 21049*    END-EXEC.
 21050     MOVE 'ELCERT5' TO DFHEIV1
 21051     MOVE 0
 21052       TO DFHEIV11
 21053*    MOVE '&,         E          &   #00019677' TO DFHEIV0
 21054     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303139363737' TO DFHEIV0(25:11)
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           DFHEIV1,
 21059           ELCERT2-KEY,
 21060           DFHEIV99,
 21061           DFHEIV11,
 21062           DFHEIV99
 21063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21064
 21065
 21066 8710-READ-NEXT.
 21067
 21068* EXEC CICS READNEXT
 21069*        DATASET     ('ELCERT5')
 21070*        INTO        (CERTIFICATE-MASTER)
 21071*        RIDFLD      (ELCERT2-KEY)
 21072*    END-EXEC.
 21073     MOVE LENGTH OF
 21074      CERTIFICATE-MASTER
 21075       TO DFHEIV12
 21076     MOVE 'ELCERT5' TO DFHEIV1
 21077     MOVE 0
 21078       TO DFHEIV11
 21079*    MOVE '&.IL                  )   #00019684' TO DFHEIV0
 21080     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21081     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21082     MOVE X'2020233030303139363834' TO DFHEIV0(25:11)
 21083     CALL 'kxdfhei1' USING DFHEIV0,
 21084           DFHEIV1,
 21085           CERTIFICATE-MASTER,
 21086           DFHEIV12,
 21087           ELCERT2-KEY,
 21088           DFHEIV99,
 21089           DFHEIV11,
 21090           DFHEIV99,
 21091           DFHEIV99
 21092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21093
 21094
 21095 8720-COMP-ACCOUNTS.
 21096
 21097* EXEC CICS ENTER
 21098*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 389
* EL050.cbl
 21099*         FROM (PB-C-LAST-NAME)
 21100*    END-EXEC.
 21101     MOVE 001
 21102       TO DFHEIV11
 21103*    MOVE ':$F                   %   #00019691' TO DFHEIV0
 21104     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21105     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21106     MOVE X'2020233030303139363931' TO DFHEIV0(25:11)
 21107     CALL 'kxdfhei1' USING DFHEIV0,
 21108           DFHEIV11,
 21109           PB-C-LAST-NAME,
 21110           DFHEIV99,
 21111           DFHEIV99
 21112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21113
 21114
 21115
 21116* EXEC CICS ENTER
 21117*         TRACEID (002)
 21118*         FROM (CM-INSURED-LAST-NAME)
 21119*    END-EXEC.
 21120     MOVE 002
 21121       TO DFHEIV11
 21122*    MOVE ':$F                   %   #00019696' TO DFHEIV0
 21123     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21124     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21125     MOVE X'2020233030303139363936' TO DFHEIV0(25:11)
 21126     CALL 'kxdfhei1' USING DFHEIV0,
 21127           DFHEIV11,
 21128           CM-INSURED-LAST-NAME,
 21129           DFHEIV99,
 21130           DFHEIV99
 21131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21132
 21133
 21134     IF PB-CERT-NO NOT = CM-CERT-NO
 21135         GO TO 8730-END-BROWSE.
 21136
 21137     IF PB-ACCOUNT = CM-ACCOUNT
 21138         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21139             MOVE ER-2799        TO WS-ERROR
 21140             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21141             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21142             GO TO 8730-END-BROWSE.
 21143
 21144     GO TO 8710-READ-NEXT.
 21145
 21146 8730-END-BROWSE.
 21147
 21148* EXEC CICS ENDBR
 21149*         DATASET    ('ELCERT5')
 21150*    END-EXEC.
 21151     MOVE 'ELCERT5' TO DFHEIV1
 21152     MOVE 0
 21153       TO DFHEIV11
 21154*    MOVE '&2                    $   #00019714' TO DFHEIV0
 21155     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21156     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 390
* EL050.cbl
 21157     MOVE X'2020233030303139373134' TO DFHEIV0(25:11)
 21158     CALL 'kxdfhei1' USING DFHEIV0,
 21159           DFHEIV1,
 21160           DFHEIV11,
 21161           DFHEIV99
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165 8740-NOT-FOUND.
 21166     GO TO 0299-CERT-NOT-FOUND.
 21167
 21168 8750-START-ELSTAT.
 21169
 21170* EXEC CICS STARTBR
 21171*       DATASET   (STAT-ID)
 21172*       RIDFLD    (ELSTAT-KEY)
 21173*       GTEQ
 21174*       RESP      (WS-RESPONSE)
 21175*    END-EXEC
 21176     MOVE 0
 21177       TO DFHEIV11
 21178*    MOVE '&,         G          &  N#00019722' TO DFHEIV0
 21179     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21181     MOVE X'204E233030303139373232' TO DFHEIV0(25:11)
 21182     CALL 'kxdfhei1' USING DFHEIV0,
 21183           STAT-ID,
 21184           ELSTAT-KEY,
 21185           DFHEIV99,
 21186           DFHEIV11,
 21187           DFHEIV99
 21188     MOVE EIBRESP  TO WS-RESPONSE
 21189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21190     IF WS-RESP-NORMAL
 21191        MOVE 'Y'                 TO STAT-MASTER-SW
 21192     ELSE
 21193        MOVE 'N'                 TO STAT-MASTER-SW
 21194     END-IF
 21195     .
 21196 8750-EXIT.
 21197     EXIT.
 21198 8752-READ-ELSTAT.
 21199
 21200* EXEC CICS READNEXT
 21201*       DATASET   (STAT-ID)
 21202*       RIDFLD    (ELSTAT-KEY)
 21203*       INTO      (STATE-FILE)
 21204*       RESP      (WS-RESPONSE)
 21205*    END-EXEC
 21206     MOVE LENGTH OF
 21207      STATE-FILE
 21208       TO DFHEIV12
 21209     MOVE 0
 21210       TO DFHEIV11
 21211*    MOVE '&.IL                  )  N#00019737' TO DFHEIV0
 21212     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21213     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21214     MOVE X'204E233030303139373337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 391
* EL050.cbl
 21215     CALL 'kxdfhei1' USING DFHEIV0,
 21216           STAT-ID,
 21217           STATE-FILE,
 21218           DFHEIV12,
 21219           ELSTAT-KEY,
 21220           DFHEIV99,
 21221           DFHEIV11,
 21222           DFHEIV99,
 21223           DFHEIV99
 21224     MOVE EIBRESP  TO WS-RESPONSE
 21225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21226     IF WS-RESP-NORMAL
 21227        MOVE 'Y'                 TO STAT-MASTER-SW
 21228     ELSE
 21229        MOVE 'N'                 TO STAT-MASTER-SW
 21230     END-IF
 21231     .
 21232 8752-EXIT.
 21233     EXIT.
 21234 8800-GET-COMP-RATE.
 21235     MOVE +1 TO IB.
 21236     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21237         ADD +9 TO IB
 21238         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21239             ADD +9 TO IB
 21240             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21241                MOVE ZEROS       TO WS-WK-RATE
 21242                GO TO 8800-EXIT.
 21243
 21244     IF PB-I-AGE GREATER CT-AGE (1)
 21245         ADD +3 TO IB
 21246         IF PB-I-AGE GREATER CT-AGE (2)
 21247             ADD +3 TO IB
 21248             IF PB-I-AGE GREATER CT-AGE (3)
 21249                MOVE ZEROS       TO WS-WK-RATE
 21250                GO TO 8800-EXIT.
 21251
 21252     IF WS-WORK-TERM GREATER CT-TRM (1)
 21253         ADD +1 TO IB
 21254         IF WS-WORK-TERM GREATER CT-TRM (2)
 21255             ADD +1 TO IB
 21256             IF WS-WORK-TERM GREATER CT-TRM (3)
 21257                MOVE ZEROS       TO WS-WK-RATE
 21258                GO TO 8800-EXIT.
 21259
 21260     IF CT-RT (IB) NOT NUMERIC
 21261         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21262         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21263         GO TO 8800-GET-COMP-RATE.
 21264
 21265     MOVE CT-RT (IB) TO WS-WK-RATE.
 21266
 21267 8800-EXIT.
 21268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 392
* EL050.cbl
 21270 8900-ADDRESS-FILE.
 21271     IF ERACCT-FILE-ADDRESSED
 21272         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21273         GO TO 8900-ADDRESS-EXIT.
 21274
 21275     IF ELCNTL-FILE-ADDRESSED
 21276         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21277         GO TO 8900-ADDRESS-EXIT.
 21278
 21279     IF ERPLAN-FILE-ADDRESSED
 21280         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21281         GO TO 8900-ADDRESS-EXIT.
 21282
 21283     IF ERFORM-FILE-ADDRESSED
 21284         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21285         GO TO 8900-ADDRESS-EXIT.
 21286
 21287 8900-ADDRESS-EXIT.
 21288     EXIT.
 21289
 21290 9000-READ-CONTROL.
 21291
 21292* EXEC CICS HANDLE CONDITION
 21293*        NOTFND    (9000-NOTFND)
 21294*    END-EXEC.
 21295*    MOVE '"$I                   ! ? #00019808' TO DFHEIV0
 21296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21298     MOVE X'3F20233030303139383038' TO DFHEIV0(25:11)
 21299     CALL 'kxdfhei1' USING DFHEIV0
 21300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21301
 21302
 21303
 21304* EXEC CICS READ
 21305*        DATASET     (CNTL-ID)
 21306*        SET         (ADDRESS OF CONTROL-FILE)
 21307*        RIDFLD      (ELCNTL-KEY)
 21308*        GTEQ
 21309*    END-EXEC.
 21310*    MOVE '&"S        G          (   #00019812' TO DFHEIV0
 21311     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21313     MOVE X'2020233030303139383132' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           CNTL-ID,
 21316           DFHEIV20,
 21317           DFHEIV99,
 21318           ELCNTL-KEY,
 21319           DFHEIV99,
 21320           DFHEIV99,
 21321           DFHEIV99
 21322     SET ADDRESS OF CONTROL-FILE TO
 21323         DFHEIV20
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21325
 21326
 21327     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 393
* EL050.cbl
 21328
 21329 9000-NOTFND.
 21330     IF RC-SW-1 = '1'
 21331        MOVE ER-2616              TO WS-ERROR
 21332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21333        GO TO 9000-EXIT.
 21334
 21335     IF RC-SW-1 = '2'
 21336        MOVE ER-2602              TO WS-ERROR
 21337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21338
 21339 9000-EXIT.
 21340      EXIT.
 21341
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 394
* EL050.cbl
 21343 9100-READ-CONTROL.
 21344
 21345* EXEC CICS HANDLE CONDITION
 21346*        NOTFND  (9100-NOTFND)
 21347*        ENDFILE (9100-NOTFND)
 21348*    END-EXEC.
 21349*    MOVE '"$I''                  ! @ #00019836' TO DFHEIV0
 21350     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21352     MOVE X'4020233030303139383336' TO DFHEIV0(25:11)
 21353     CALL 'kxdfhei1' USING DFHEIV0
 21354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21355
 21356
 21357
 21358* EXEC CICS READ
 21359*        DATASET     (CNTL-ID)
 21360*        INTO        (CONTROL-FILE)
 21361*        RIDFLD      (ELCNTL-KEY)
 21362*        GTEQ
 21363*    END-EXEC.
 21364     MOVE LENGTH OF
 21365      CONTROL-FILE
 21366       TO DFHEIV11
 21367*    MOVE '&"IL       G          (   #00019841' TO DFHEIV0
 21368     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21370     MOVE X'2020233030303139383431' TO DFHEIV0(25:11)
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           CNTL-ID,
 21373           CONTROL-FILE,
 21374           DFHEIV11,
 21375           ELCNTL-KEY,
 21376           DFHEIV99,
 21377           DFHEIV99,
 21378           DFHEIV99
 21379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21380
 21381
 21382     GO TO 9100-EXIT.
 21383
 21384 9100-NOTFND.
 21385     IF RC-SW-2 = '0'
 21386        MOVE '1'                  TO STATE-RECORD-ERROR
 21387        GO TO 9100-EXIT
 21388     END-IF
 21389     IF RC-SW-2 = '1'
 21390        MOVE '1'                  TO LF-BENEFIT-ERROR
 21391        MOVE ER-2604              TO WS-ERROR
 21392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21393        GO TO 9100-EXIT.
 21394
 21395     IF RC-SW-2 = '2'
 21396        MOVE '1'                  TO AH-BENEFIT-ERROR
 21397        MOVE ER-2605              TO WS-ERROR
 21398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21399        GO TO 9100-EXIT.
 21400
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 395
* EL050.cbl
 21401     IF RC-SW-2 = '3'
 21402         MOVE ER-2603           TO WS-ERROR
 21403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21404         GO TO 9100-EXIT.
 21405
 21406     IF RC-SW-2 = '4'
 21407         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21408         GO TO 9100-EXIT.
 21409
 21410     IF RC-SW-2 = '5'
 21411         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21412         IF WS-AH-INPUT-CD-1 = SPACE
 21413             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21414         ELSE
 21415             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21416
 21417 9100-EXIT.
 21418      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 396
* EL050.cbl
 21420 9200-CONTROL-GETMAIN.
 21421
 21422* EXEC CICS GETMAIN
 21423*         LENGTH   (750)
 21424*         SET      (ADDRESS OF CONTROL-FILE)
 21425*    END-EXEC.
 21426     MOVE 750
 21427       TO DFHEIV11
 21428*    MOVE '," L                  $   #00019887' TO DFHEIV0
 21429     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21431     MOVE X'2020233030303139383837' TO DFHEIV0(25:11)
 21432     CALL 'kxdfhei1' USING DFHEIV0,
 21433           DFHEIV20,
 21434           DFHEIV11,
 21435           DFHEIV99
 21436     SET ADDRESS OF CONTROL-FILE TO
 21437         DFHEIV20
 21438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21439
 21440
 21441     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21442
 21443 9200-EXIT.
 21444     EXIT.
 21445
 21446 9250-UNLOCK-RETURN.
 21447
 21448* EXEC CICS UNLOCK
 21449*        DATASET   (CERT-ID)
 21450*    END-EXEC.
 21451*    MOVE '&*                    #   #00019898' TO DFHEIV0
 21452     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21454     MOVE X'2020233030303139383938' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0,
 21456           CERT-ID,
 21457           DFHEIV99
 21458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21459
 21460
 21461 9300-ABEND.
 21462     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21463
 21464
 21465* EXEC CICS LINK
 21466*        PROGRAM   ('EL004')
 21467*        COMMAREA  (WS-ERROR-LINE)
 21468*        LENGTH    (72)
 21469*    END-EXEC.
 21470     MOVE 'EL004' TO DFHEIV1
 21471     MOVE 72
 21472       TO DFHEIV11
 21473*    MOVE '."C                   (   #00019905' TO DFHEIV0
 21474     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21476     MOVE X'2020233030303139393035' TO DFHEIV0(25:11)
 21477     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 397
* EL050.cbl
 21478           DFHEIV1,
 21479           WS-ERROR-LINE,
 21480           DFHEIV11,
 21481           DFHEIV99,
 21482           DFHEIV99,
 21483           DFHEIV99,
 21484           DFHEIV99
 21485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21486
 21487
 21488     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21489
 21490
 21491* EXEC CICS ABEND
 21492*        ABCODE ('EL50')
 21493*    END-EXEC.
 21494     MOVE 'EL50' TO DFHEIV5
 21495*    MOVE '.,A                   "   #00019913' TO DFHEIV0
 21496     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21497     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21498     MOVE X'2020233030303139393133' TO DFHEIV0(25:11)
 21499     CALL 'kxdfhei1' USING DFHEIV0,
 21500           DFHEIV5
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 398
* EL050.cbl
 21505
 21506******************************************************************
 21507*                                                                *
 21508*            E R R O R   F O R M A T   R O U T I N E             *
 21509*                                                                *
 21510******************************************************************
 21511
 21512 9900-ERROR-FORMAT.
 21513
 21514     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21515                    PB-COMMON-ERROR (2) OR
 21516                    PB-COMMON-ERROR (3) OR
 21517                    PB-COMMON-ERROR (4) OR
 21518                    PB-COMMON-ERROR (5) OR
 21519                    PB-COMMON-ERROR (6) OR
 21520                    PB-COMMON-ERROR (7) OR
 21521                    PB-COMMON-ERROR (8) OR
 21522                    PB-COMMON-ERROR (9) OR
 21523                    PB-COMMON-ERROR (10)
 21524        GO TO 9900-EXIT.
 21525
 21526     IF PB-NO-OF-ERRORS = +10
 21527        GO TO 9900-EXIT.
 21528
 21529     ADD +1  TO PB-NO-OF-ERRORS.
 21530     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21531                                       (PB-NO-OF-ERRORS).
 21532 9900-EXIT.
 21533     EXIT.
 21534
 21535 9990-RETURN.
 21536     IF BROWSE-STARTED
 21537
 21538* EXEC CICS ENDBR
 21539*            DATASET  (ACCT-ID)
 21540*       END-EXEC.
 21541     MOVE 0
 21542       TO DFHEIV11
 21543*    MOVE '&2                    $   #00019950' TO DFHEIV0
 21544     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21545     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21546     MOVE X'2020233030303139393530' TO DFHEIV0(25:11)
 21547     CALL 'kxdfhei1' USING DFHEIV0,
 21548           ACCT-ID,
 21549           DFHEIV11,
 21550           DFHEIV99
 21551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21552
 21553
 21554 9990-EXIT.
 21555     EXIT.
 21556
 21557
 21558****Check for CRTO record, add one if not found.
 21559 9991-CHECK-FOR-ELCRTO.
 21560
 21561* EXEC CICS HANDLE CONDITION
 21562*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 399
* EL050.cbl
 21563*         ENDFILE (9991-CRTO-NOT-FOUND)
 21564*     END-EXEC.
 21565*    MOVE '"$I''                  ! A #00019960' TO DFHEIV0
 21566     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21568     MOVE X'4120233030303139393630' TO DFHEIV0(25:11)
 21569     CALL 'kxdfhei1' USING DFHEIV0
 21570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21571
 21572     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21573     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21574     MOVE +0                     TO ELCRTO-SEQ-NO
 21575
 21576
 21577* EXEC CICS READ
 21578*       DATASET   ('ELCRTO')
 21579*       INTO      (ORIGINAL-CERTIFICATE)
 21580*       RIDFLD    (ELCRTO-KEY)
 21581*       GTEQ
 21582*       RESP      (WS-RESPONSE)
 21583*    END-EXEC
 21584     MOVE LENGTH OF
 21585      ORIGINAL-CERTIFICATE
 21586       TO DFHEIV11
 21587     MOVE 'ELCRTO' TO DFHEIV1
 21588*    MOVE '&"IL       G          (  N#00019968' TO DFHEIV0
 21589     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21591     MOVE X'204E233030303139393638' TO DFHEIV0(25:11)
 21592     CALL 'kxdfhei1' USING DFHEIV0,
 21593           DFHEIV1,
 21594           ORIGINAL-CERTIFICATE,
 21595           DFHEIV11,
 21596           ELCRTO-KEY,
 21597           DFHEIV99,
 21598           DFHEIV99,
 21599           DFHEIV99
 21600     MOVE EIBRESP  TO WS-RESPONSE
 21601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21602
 21603     IF WS-RESP-NORMAL
 21604        AND (OC-CONTROL-PRIMARY (1:33) =
 21605                 PB-CONTROL-BY-ACCOUNT (1:33))
 21606        AND (OC-RECORD-TYPE =  'I')
 21607           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21608               GO TO 9991-CHECK-INDICATORS
 21609           ELSE
 21610               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21611               GO TO 9991-CRTO-ADD-REC
 21612           END-IF
 21613     END-IF.
 21614
 21615 9991-CRTO-NOT-FOUND.
 21616
 21617     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21618     MOVE 'OC'                TO OC-RECORD-ID
 21619     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21620                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 400
* EL050.cbl
 21621     MOVE +4096               TO OC-KEY-SEQ-NO.
 21622
 21623 9991-CRTO-ADD-REC.
 21624
 21625     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21626     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21627     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21628     MOVE 'I'                 TO OC-RECORD-TYPE
 21629     IF PB-ISSUE
 21630         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21631         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21632         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21633         MOVE PB-I-AGE               TO OC-INS-AGE
 21634         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21635         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21636         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21637         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21638         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21639         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21640         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21641         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21642         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21643         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21644         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21645         IF PB-I-JOINT-COMMISSION > +0
 21646             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21647         ELSE
 21648             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21649         END-IF
 21650         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21651         MOVE +0                     TO OC-LF-CANCEL-AMT
 21652                                        OC-LF-ITD-CANCEL-AMT
 21653         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21654         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21655         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21656         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21657         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21658         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21659         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21660         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21661         MOVE +0                     TO OC-AH-CANCEL-AMT
 21662                                        OC-AH-ITD-CANCEL-AMT
 21663         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21664         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21665         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21666     ELSE
 21667         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21668         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21669         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21670         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21671         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21672         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21673         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21674         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21675         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21676          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21677             MOVE SPACES             TO OC-LF-BENCD
 21678             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 401
* EL050.cbl
 21679                                        OC-LF-BEN-AMT
 21680                                        OC-LF-PRM-AMT
 21681                                        OC-LF-ALT-BEN-AMT
 21682                                        OC-LF-ALT-PRM-AMT
 21683                                        OC-LF-COMM-PCT
 21684                                        OC-LF-CANCEL-AMT
 21685             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21686             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21687         ELSE
 21688             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21689             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21690             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21691             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21692             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21693             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21694             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21695             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21696             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21697             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21698         END-IF
 21699         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21700         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21701          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21702             MOVE SPACES             TO OC-AH-BENCD
 21703             MOVE ZEROS              TO OC-AH-TERM
 21704                                        OC-AH-BEN-AMT
 21705                                        OC-AH-PRM-AMT
 21706                                        OC-AH-COMM-PCT
 21707                                        OC-AH-CANCEL-AMT
 21708                                        OC-AH-CP
 21709             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21710             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21711         ELSE
 21712             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21713             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21714             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21715             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21716             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21717             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21718             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21719             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21720             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21721         END-IF
 21722         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21723         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21724         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21725         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21726     END-IF
 21727     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21728
 21729     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21730
 21731
 21732* EXEC CICS READ
 21733*         DATASET   (FILE-ERMAIL)
 21734*         RIDFLD    (MA-CONTROL-PRIMARY)
 21735*         INTO      (MAILING-DATA)
 21736*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 402
* EL050.cbl
 21737*    END-EXEC
 21738     MOVE LENGTH OF
 21739      MAILING-DATA
 21740       TO DFHEIV11
 21741*    MOVE '&"IL       E          (  N#00020104' TO DFHEIV0
 21742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21744     MOVE X'204E233030303230313034' TO DFHEIV0(25:11)
 21745     CALL 'kxdfhei1' USING DFHEIV0,
 21746           FILE-ERMAIL,
 21747           MAILING-DATA,
 21748           DFHEIV11,
 21749           MA-CONTROL-PRIMARY,
 21750           DFHEIV99,
 21751           DFHEIV99,
 21752           DFHEIV99
 21753     MOVE EIBRESP  TO WS-RESPONSE
 21754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21755
 21756     IF WS-RESP-NORMAL
 21757         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21758     END-IF.
 21759
 21760     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21761     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21762
 21763
 21764* EXEC CICS READ
 21765*         DATASET  (CRTT-ID)
 21766*         RIDFLD   (WS-ELCRTT-KEY)
 21767*         INTO     (CERTIFICATE-TRAILERS)
 21768*         RESP     (WS-RESPONSE)
 21769*    END-EXEC
 21770     MOVE LENGTH OF
 21771      CERTIFICATE-TRAILERS
 21772       TO DFHEIV11
 21773*    MOVE '&"IL       E          (  N#00020118' TO DFHEIV0
 21774     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21775     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21776     MOVE X'204E233030303230313138' TO DFHEIV0(25:11)
 21777     CALL 'kxdfhei1' USING DFHEIV0,
 21778           CRTT-ID,
 21779           CERTIFICATE-TRAILERS,
 21780           DFHEIV11,
 21781           WS-ELCRTT-KEY,
 21782           DFHEIV99,
 21783           DFHEIV99,
 21784           DFHEIV99
 21785     MOVE EIBRESP  TO WS-RESPONSE
 21786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21787
 21788     IF WS-RESP-NORMAL
 21789         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21790         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21791     END-IF.
 21792
 21793
 21794* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 403
* EL050.cbl
 21795*       DATASET   ('ELCRTO')
 21796*       FROM      (ORIGINAL-CERTIFICATE)
 21797*       RIDFLD    (OC-CONTROL-PRIMARY)
 21798*       RESP      (WS-RESPONSE)
 21799*    END-EXEC.
 21800     MOVE LENGTH OF
 21801      ORIGINAL-CERTIFICATE
 21802       TO DFHEIV11
 21803     MOVE 'ELCRTO' TO DFHEIV1
 21804*    MOVE '&$ L                  ''  N#00020130' TO DFHEIV0
 21805     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21807     MOVE X'204E233030303230313330' TO DFHEIV0(25:11)
 21808     CALL 'kxdfhei1' USING DFHEIV0,
 21809           DFHEIV1,
 21810           ORIGINAL-CERTIFICATE,
 21811           DFHEIV11,
 21812           OC-CONTROL-PRIMARY,
 21813           DFHEIV99,
 21814           DFHEIV99
 21815     MOVE EIBRESP  TO WS-RESPONSE
 21816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21817
 21818
 21819     GO TO 9991-EXIT.
 21820
 21821 9991-CHECK-INDICATORS.
 21822
 21823     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21824         GO TO 9991-EXIT
 21825     END-IF.
 21826
 21827     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21828         GO TO 9991-EXIT
 21829     END-IF.
 21830
 21831
 21832* EXEC CICS READ
 21833*       DATASET   ('ELCRTO')
 21834*       INTO      (ORIGINAL-CERTIFICATE)
 21835*       RIDFLD    (OC-CONTROL-PRIMARY)
 21836*       UPDATE
 21837*       RESP      (WS-RESPONSE)
 21838*    END-EXEC
 21839     MOVE LENGTH OF
 21840      ORIGINAL-CERTIFICATE
 21841       TO DFHEIV11
 21842     MOVE 'ELCRTO' TO DFHEIV1
 21843*    MOVE '&"IL       EU         (  N#00020149' TO DFHEIV0
 21844     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21846     MOVE X'204E233030303230313439' TO DFHEIV0(25:11)
 21847     CALL 'kxdfhei1' USING DFHEIV0,
 21848           DFHEIV1,
 21849           ORIGINAL-CERTIFICATE,
 21850           DFHEIV11,
 21851           OC-CONTROL-PRIMARY,
 21852           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 404
* EL050.cbl
 21853           DFHEIV99,
 21854           DFHEIV99
 21855     MOVE EIBRESP  TO WS-RESPONSE
 21856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21857     IF WS-RESP-NORMAL
 21858        IF PB-ISSUE
 21859          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21860          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21861          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21862          MOVE PB-I-AGE               TO OC-INS-AGE
 21863          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21864          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21865          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21866          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21867          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21868          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21869          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21870          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21871          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21872          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21873          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21874          IF PB-I-JOINT-COMMISSION > +0
 21875              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21876          ELSE
 21877              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21878          END-IF
 21879          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21880          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21881          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21882          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21883          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21884          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21885          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21886          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21887          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21888
 21889          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21890
 21891* EXEC CICS READ
 21892*             DATASET   (FILE-ERMAIL)
 21893*             RIDFLD    (MA-CONTROL-PRIMARY)
 21894*             INTO      (MAILING-DATA)
 21895*             RESP      (WS-RESPONSE)
 21896*         END-EXEC
 21897     MOVE LENGTH OF
 21898      MAILING-DATA
 21899       TO DFHEIV11
 21900*    MOVE '&"IL       E          (  N#00020189' TO DFHEIV0
 21901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21903     MOVE X'204E233030303230313839' TO DFHEIV0(25:11)
 21904     CALL 'kxdfhei1' USING DFHEIV0,
 21905           FILE-ERMAIL,
 21906           MAILING-DATA,
 21907           DFHEIV11,
 21908           MA-CONTROL-PRIMARY,
 21909           DFHEIV99,
 21910           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 405
* EL050.cbl
 21911           DFHEIV99
 21912     MOVE EIBRESP  TO WS-RESPONSE
 21913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21914          IF WS-RESP-NORMAL
 21915             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21916          END-IF
 21917
 21918          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21919          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21920
 21921* EXEC CICS READ
 21922*             DATASET  (CRTT-ID)
 21923*             RIDFLD   (WS-ELCRTT-KEY)
 21924*             INTO     (CERTIFICATE-TRAILERS)
 21925*             RESP     (WS-RESPONSE)
 21926*         END-EXEC
 21927     MOVE LENGTH OF
 21928      CERTIFICATE-TRAILERS
 21929       TO DFHEIV11
 21930*    MOVE '&"IL       E          (  N#00020201' TO DFHEIV0
 21931     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21933     MOVE X'204E233030303230323031' TO DFHEIV0(25:11)
 21934     CALL 'kxdfhei1' USING DFHEIV0,
 21935           CRTT-ID,
 21936           CERTIFICATE-TRAILERS,
 21937           DFHEIV11,
 21938           WS-ELCRTT-KEY,
 21939           DFHEIV99,
 21940           DFHEIV99,
 21941           DFHEIV99
 21942     MOVE EIBRESP  TO WS-RESPONSE
 21943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21944          IF WS-RESP-NORMAL
 21945             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21946                               OC-INS-AGE-DEFAULT-FLAG
 21947             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21948                               OC-JNT-AGE-DEFAULT-FLAG
 21949          END-IF
 21950
 21951        ELSE
 21952          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21953             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21954             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21955             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21956          END-IF
 21957          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21958             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21959             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21960             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21961          END-IF
 21962          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21963        END-IF
 21964
 21965* EXEC CICS REWRITE
 21966*          DATASET   ('ELCRTO')
 21967*          FROM      (ORIGINAL-CERTIFICATE)
 21968*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 406
* EL050.cbl
 21969*       END-EXEC
 21970     MOVE LENGTH OF
 21971      ORIGINAL-CERTIFICATE
 21972       TO DFHEIV11
 21973     MOVE 'ELCRTO' TO DFHEIV1
 21974*    MOVE '&& L                  %  N#00020227' TO DFHEIV0
 21975     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21976     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21977     MOVE X'204E233030303230323237' TO DFHEIV0(25:11)
 21978     CALL 'kxdfhei1' USING DFHEIV0,
 21979           DFHEIV1,
 21980           ORIGINAL-CERTIFICATE,
 21981           DFHEIV11,
 21982           DFHEIV99
 21983     MOVE EIBRESP  TO WS-RESPONSE
 21984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21985     END-IF.
 21986
 21987 9991-EXIT.
 21988     EXIT.
 21989
 21990
 21991 9999-RETURN.
 21992     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21993
 21994
 21995* EXEC CICS RETURN
 21996*    END-EXEC.
 21997*    MOVE '.(                    ''   #00020241' TO DFHEIV0
 21998     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22000     MOVE X'2020233030303230323431' TO DFHEIV0(25:11)
 22001     CALL 'kxdfhei1' USING DFHEIV0,
 22002           DFHEIV99,
 22003           DFHEIV99,
 22004           DFHEIV99,
 22005           DFHEIV99,
 22006           DFHEIV99,
 22007           DFHEIV99
 22008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22009
 22010
 22011
 22012* GOBACK.
 22013     MOVE '9%                    "   ' TO DFHEIV0
 22014     MOVE 'EL050' TO DFHEIV1
 22015     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22016     GOBACK.
 22017
 22018 9999-DFHBACK SECTION.
 22019     MOVE '9%                    "   ' TO DFHEIV0
 22020     MOVE 'EL050' TO DFHEIV1
 22021     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22022     GOBACK.
 22023 9999-DFHEXIT.
 22024     IF DFHEIGDJ EQUAL 0001
 22025         NEXT SENTENCE
 22026     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 407
* EL050.cbl
 22027         GO TO 9300-ABEND,
 22028               3990-FILES-NOT-OPEN
 22029         DEPENDING ON DFHEIGDI
 22030     ELSE IF DFHEIGDJ EQUAL 3
 22031         GO TO 6610-START-BROWSE,
 22032               6630-ERRESS-PROBLEM,
 22033               6630-END-OF-FILE
 22034         DEPENDING ON DFHEIGDI
 22035     ELSE IF DFHEIGDJ EQUAL 4
 22036         GO TO 6630-END-OF-FILE,
 22037               6630-ERRESS-PROBLEM,
 22038               6630-ERRESS-PROBLEM,
 22039               6630-END-OF-FILE
 22040         DEPENDING ON DFHEIGDI
 22041     ELSE IF DFHEIGDJ EQUAL 5
 22042         GO TO 6630-END-OF-FILE,
 22043               6630-END-OF-FILE,
 22044               6630-ERRESS-PROBLEM,
 22045               6630-ERRESS-PROBLEM
 22046         DEPENDING ON DFHEIGDI
 22047     ELSE IF DFHEIGDJ EQUAL 6
 22048         GO TO 6660-START-BROWSE,
 22049               6690-ERRESC-PROBLEM,
 22050               6690-ERRESC-PROBLEM,
 22051               6690-END-OF-FILE
 22052         DEPENDING ON DFHEIGDI
 22053     ELSE IF DFHEIGDJ EQUAL 7
 22054         GO TO 6690-END-OF-FILE,
 22055               6690-ERRESC-PROBLEM,
 22056               6690-ERRESC-PROBLEM,
 22057               6690-END-OF-FILE
 22058         DEPENDING ON DFHEIGDI
 22059     ELSE IF DFHEIGDJ EQUAL 8
 22060         GO TO 6690-END-OF-FILE,
 22061               6690-ERRESC-PROBLEM,
 22062               6690-ERRESC-PROBLEM,
 22063               6690-END-OF-FILE
 22064         DEPENDING ON DFHEIGDI
 22065     ELSE IF DFHEIGDJ EQUAL 9
 22066         GO TO 7250-CONTINUE,
 22067               7250-CONTINUE
 22068         DEPENDING ON DFHEIGDI
 22069     ELSE IF DFHEIGDJ EQUAL 10
 22070         GO TO 7300-CONTINUE,
 22071               7300-CONTINUE
 22072         DEPENDING ON DFHEIGDI
 22073     ELSE IF DFHEIGDJ EQUAL 11
 22074         GO TO 8000-FREE-MAIN
 22075         DEPENDING ON DFHEIGDI
 22076     ELSE IF DFHEIGDJ EQUAL 12
 22077         GO TO 8100-NOTFND,
 22078               8100-NOTFND
 22079         DEPENDING ON DFHEIGDI
 22080     ELSE IF DFHEIGDJ EQUAL 13
 22081         GO TO 8110-NOTFND,
 22082               8110-NOTFND
 22083         DEPENDING ON DFHEIGDI
 22084     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 408
* EL050.cbl
 22085         GO TO 8130-EXIT
 22086         DEPENDING ON DFHEIGDI
 22087     ELSE IF DFHEIGDJ EQUAL 15
 22088         GO TO 8150-exit
 22089         DEPENDING ON DFHEIGDI
 22090     ELSE IF DFHEIGDJ EQUAL 16
 22091         GO TO 8180-NOTFND
 22092         DEPENDING ON DFHEIGDI
 22093     ELSE IF DFHEIGDJ EQUAL 17
 22094         GO TO 8190-NOTFND
 22095         DEPENDING ON DFHEIGDI
 22096     ELSE IF DFHEIGDJ EQUAL 18
 22097         GO TO 8195-NOTFND
 22098         DEPENDING ON DFHEIGDI
 22099     ELSE IF DFHEIGDJ EQUAL 19
 22100         GO TO 8200-NOTFND
 22101         DEPENDING ON DFHEIGDI
 22102     ELSE IF DFHEIGDJ EQUAL 20
 22103         GO TO 8300-NOTFND,
 22104               8300-ERRESS-PROBLEM,
 22105               8300-ERRESS-PROBLEM,
 22106               8300-NOTFND
 22107         DEPENDING ON DFHEIGDI
 22108     ELSE IF DFHEIGDJ EQUAL 21
 22109         GO TO 8450-FORM-NOT-FOUND,
 22110               8450-FORM-NOT-FOUND
 22111         DEPENDING ON DFHEIGDI
 22112     ELSE IF DFHEIGDJ EQUAL 22
 22113         GO TO 0199-ACCT-NOT-FOUND,
 22114               0199-ACCT-NOT-FOUND
 22115         DEPENDING ON DFHEIGDI
 22116     ELSE IF DFHEIGDJ EQUAL 23
 22117         GO TO 0199-ACCT-NOT-FOUND,
 22118               0199-ACCT-NOT-FOUND
 22119         DEPENDING ON DFHEIGDI
 22120     ELSE IF DFHEIGDJ EQUAL 24
 22121         GO TO 8582-COMP-NOT-FOUND,
 22122               8582-COMP-NOT-FOUND
 22123         DEPENDING ON DFHEIGDI
 22124     ELSE IF DFHEIGDJ EQUAL 25
 22125         GO TO 8583-AGTC-NOT-FOUND,
 22126               8583-AGTC-NOT-FOUND
 22127         DEPENDING ON DFHEIGDI
 22128     ELSE IF DFHEIGDJ EQUAL 26
 22129         GO TO 8584-BXRF-NOT-FOUND,
 22130               8584-BXRF-NOT-FOUND
 22131         DEPENDING ON DFHEIGDI
 22132     ELSE IF DFHEIGDJ EQUAL 27
 22133         GO TO 8585-PLAN-NOT-FOUND,
 22134               8585-PLAN-NOT-FOUND
 22135         DEPENDING ON DFHEIGDI
 22136     ELSE IF DFHEIGDJ EQUAL 28
 22137         GO TO 0299-CERT-NOT-FOUND
 22138         DEPENDING ON DFHEIGDI
 22139     ELSE IF DFHEIGDJ EQUAL 29
 22140         GO TO 8700-READ-CERT-MASTER
 22141         DEPENDING ON DFHEIGDI
 22142     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 24-Jul-15 09:48 Page 409
* EL050.cbl
 22143         GO TO 8720-COMP-ACCOUNTS,
 22144               8730-END-BROWSE,
 22145               8740-NOT-FOUND
 22146         DEPENDING ON DFHEIGDI
 22147     ELSE IF DFHEIGDJ EQUAL 31
 22148         GO TO 9000-NOTFND
 22149         DEPENDING ON DFHEIGDI
 22150     ELSE IF DFHEIGDJ EQUAL 32
 22151         GO TO 9100-NOTFND,
 22152               9100-NOTFND
 22153         DEPENDING ON DFHEIGDI
 22154     ELSE IF DFHEIGDJ EQUAL 33
 22155         GO TO 9991-CRTO-NOT-FOUND,
 22156               9991-CRTO-NOT-FOUND
 22157         DEPENDING ON DFHEIGDI.
 22158     MOVE '9%                    "   ' TO DFHEIV0
 22159     MOVE 'EL050' TO DFHEIV1
 22160     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22161     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40152     Code:       89388
