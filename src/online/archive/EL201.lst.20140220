* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28 environment division.
    29 INPUT-OUTPUT SECTION.
    30 FILE-CONTROL.
    31 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    32    FILE STATUS IS WRITTEN-STATUS
    33                            ORGANIZATION IS LINE SEQUENTIAL.
    34 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    35    FILE STATUS IS WRITRPT-STATUS
    36                            ORGANIZATION IS LINE SEQUENTIAL.
    37 data division.
    38 FILE SECTION.
    39 FD  CPS-WRITTEN-IN
    40     BLOCK CONTAINS 0
    41     RECORDING MODE F.
    42 01  CPS-WRITTEN-IN-REC          pic x(200).
    43 FD  CPS-WRITTEN-RPT
    44     BLOCK CONTAINS 0
    45     RECORDING MODE F.
    46 01  CPS-WRITTEN-RPT-REC         pic x(132).
    47 working-storage section.
    48 01  DFH-START PIC X(04).
    49 77  ws-process-sw               pic x value ' '.
    50     88  process-cashed            value 'C'.
    51     88  process-written           value 'W'.
    52 77  ws-writ-cnt                 pic 9(5) value zeros.
    53 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  ws-bin-cashed-dt            pic xx  value low-values.
    57 77  ws-bin-check-dt             pic xx  value low-values.
    58 77  ws-page-cntr                pic 999  value zeros.
    59 77  ws-line-cntr                pic 999  value 070.
    60 77  ws-max-lines                pic 999  value 060.
    61 77  ws-erchek-sw                pic x    value spaces.
    62     88  erchek-found              value 'Y'.
    63 77  ws-table-sw                 pic x    value spaces.
    64     88  table-found               value 'Y'.
    65 77  ws-continue-sw              pic x  value 'Y'.
    66     88  ok-to-continue            value 'Y'.
    67     88  not-ok-to-continue        value 'N'.
    68 77  ws-in-recs                  pic 9(5) value zeros.
    69 77  ws-eof-sw                   pic x  value spaces.
    70     88  end-of-input                  value 'Y'.
    71 77  ws-sql-code                 pic s9(7) value zeros.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   3
* EL201.cbl
    72 77  ws-dis-sql-code             pic -9999999 value zeros.
    73 01  ws-written-in.
    74     05  ws-writ-in-dir          pic x(15)  value
    75         '/data/seqfiles/'.
    76     05  ws-writ-in-name         pic x(16) value
    77         'miscpymts.csv   '.
    78 01  ws-written-rpt.
    79     05  ws-writ-rpt-dir         pic x(15)  value
    80         '/data/seqfiles/'.
    81     05  ws-writ-rpt-comp-id     pic xxx  value spaces.
    82     05  ws-writ-rpt-name        pic x(13) value
    83         'miscpymts.rpt'.
*   84 EXEC SQL
*   85    INCLUDE SQLDA
*   86 END-EXEC
    87 01 SQLDA sync.
    88    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    89    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    90    05 SQLN                  PIC S9(4) COMP-5 value 0.
    91    05 SQLD                  PIC S9(4) COMP-5 value 0.
    92    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    93       10 SQLTYPE            PIC S9(4) COMP-5.
    94       10 SQLLEN             PIC S9(4) COMP-5.
    95$IF P64 SET
    96X      *> For 64-bit environments, ensure that SQLDATA is
    97X      *> aligned on an 8-byte boundary.
    98X      10 FILLER             PIC S9(9) COMP-5.
    99$END
   100       10 SQLDATA            USAGE POINTER.
   101       10 SQLIND             USAGE POINTER.
   102       10 SQLNAME.
   103          15 SQLNAMEL        PIC S9(4) COMP-5.
   104          15 SQLNAMEC        PIC X(30).
   105
   106* Values for SQLTYPE
   107
   108 78  ESQL-DATE-CHAR              VALUE 384.
   109 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   110 78  ESQL-DATE-REC               VALUE 386.
   111 78  ESQL-DATE-REC-NULL          VALUE 387.
   112 78  ESQL-TIME-CHAR              VALUE 388.
   113 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   114 78  ESQL-TIME-REC               VALUE 390.
   115 78  ESQL-TIME-REC-NULL          VALUE 391.
   116 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   117 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   118 78  ESQL-TIMESTAMP-REC          VALUE 394.
   119 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   120 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   121 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   122 78  ESQL-TS-OFFSET-REC          VALUE 398.
   123 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   124 78  ESQL-LONGVARBINARY          VALUE 404.
   125 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   126 78  ESQL-LONGVARCHAR            VALUE 408.
   127 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   128 78  ESQL-BINARY                 VALUE 444.
   129 78  ESQL-BINARY-NULL            VALUE 445.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-VARBINARY              VALUE 446.
   131 78  ESQL-VARBINARY-NULL         VALUE 447.
   132 78  ESQL-VARCHAR                VALUE 448.
   133 78  ESQL-VARCHAR-NULL           VALUE 449.
   134
   135 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   136 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   137
   138 78  ESQL-CHAR                   VALUE 452.
   139 78  ESQL-CHAR-NULL              VALUE 453.
   140
   141 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   142 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   143
   144 78  ESQL-DOUBLE                 VALUE 480.
   145 78  ESQL-DOUBLE-NULL            VALUE 481.
   146 78  ESQL-REAL                   VALUE 482.
   147 78  ESQL-REAL-NULL              VALUE 483.
   148 78  ESQL-DECIMAL                VALUE 484.
   149 78  ESQL-DECIMAL-NULL           VALUE 485.
   150 78  ESQL-INTEGER                VALUE 496.
   151 78  ESQL-INTEGER-NULL           VALUE 497.
   152 78  ESQL-SMALLINT               VALUE 500.
   153 78  ESQL-SMALLINT-NULL          VALUE 501.
   154 78  ESQL-TINYINT                VALUE 502.
   155 78  ESQL-TINYINT-NULL           VALUE 503.
*  156 EXEC SQL
*  157    INCLUDE SQLCA
*  158 END-EXEC
   159 01 SQLCA.
   160     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   161     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   162     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   163     05  SQLERRM.
   164         49  SQLERRML    PIC S9(4) COMP-5.
   165         49  SQLERRMC    PIC X(70).
   166     05  SQLERRP         PIC X(8).
   167     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   168     05  SQLWARN.
   169         10  SQLWARN0    PIC X.
   170         10  SQLWARN1    PIC X.
   171         10  SQLWARN2    PIC X.
   172         10  SQLWARN3    PIC X.
   173         10  SQLWARN4    PIC X.
   174         10  SQLWARN5    PIC X.
   175         10  SQLWARN6    PIC X.
   176         10  SQLWARN7    PIC X.
   177     05  SQLEXT.
   178         10  SQLWARN8    PIC X.
   179         10  SQLWARN9    PIC X.
   180         10  SQLWARN10   PIC X.
   181         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   182     05  SQLSTATE    PIC X(5).
   183 EXEC SQL
   184    BEGIN DECLARE SECTION
   185 END-EXEC
   186 01  ws-key-stuff.
   187     05  ws-check-key            pic 9(7).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   5
* EL201.cbl
   188     05  ws-check-no             pic x(7).
   189     05  ws-compid               pic xxx.
   190     05  ws-carrier              pic x.
   191     05  ws-grouping             pic x(6).
   192     05  ws-state                pic xx.
   193     05  ws-account              pic x(10).
   194     05  ws-eff-date             pic x(10).
   195     05  ws-certificate          pic x(10).
   196     05  ws-cert-sfx             pic x.
   197     05  ws-seq-no               pic 999.
   198     05  ws-type                 pic 999.
   199 01  sqlcmd                      pic x(1024).
   200 01  WS-MOE-DATE                 pic x(10).
   201 01  svr                         pic x(32).
   202 01  usr                         pic x(32).
   203 01  pass                        pic x(32).
   204 01  usr-pass                    pic x(64).
   205 01  ws-disp-code                pic s9(11).
   206***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   207***                                                            ***
   208***  These indicators are used to determine if a variable      ***
   209***  is passed nulls from sql. The indicator will be -1        ***
   210***  if the value on sql is nulls and +0 if the value is       ***
   211***  something other than nulls. Here is an example on how     ***
   212***  to use the indicator variables.                           ***
   213***                                                            ***
   214***     EXEC SQL                                               ***
   215***        fetch checkapp into                                 ***
   216***           :db-app-status :nu-app-status,                   ***
   217***           :db-app-by     :nu-app-by,                       ***
   218***           :db-app-date   :nu-app-date,                     ***
   219***           :db-app-batch  :nu-app-batch                     ***
   220***     END-EXEC                                               ***
   221***                                                            ***
   222***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   223 01  indicator-vaiables-for-nulls.
   224     05  nu-app-status           pic s9(4) comp value +0.
   225     05  nu-app-by               pic s9(4) comp value +0.
   226     05  nu-app-date             pic s9(4) comp value +0.
   227     05  nu-app-batch            pic s9(4) comp value +0.
   228     05  nu-fincar               pic s9(4) comp value +0.
   229     05  nu-checkno              pic s9(4) comp value +0.
   230 01  daily-check-request-rec.
   231     05  db-checkkey             pic x(7).
   232     05  db-compid               pic xxx.
   233     05  db-carrier              pic x.
   234     05  db-grouping             pic x(6).
   235     05  db-state                pic xx.
   236     05  db-account              pic x(10).
   237     05  db-effdate              pic x(24).
   238     05  db-certificate          pic x(10).
   239     05  db-cert-sfx             pic x.
   240     05  db-seq-no               pic x(7).
   241     05  db-type                 pic x(7).
   242     05  db-amount               pic x(10).
   243     05  db-amount-n redefines
   244         db-amount               pic 9(7).99.
   245     05  db-checkno              pic x(15).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   6
* EL201.cbl
   246     05  db-checkdate            pic x(10).
   247     05  db-checkstatus          pic 9(5).
   248     05  db-releasebatch         pic 9(5).
   249     05  db-releasedt            pic x(10).
   250     05  db-releaseby            pic x(4).
   251     05  db-payeename1           pic x(30).
   252     05  db-payeename2           pic x(30).
   253     05  db-payeeaddr1           pic x(30).
   254     05  db-payeeaddr2           pic x(30).
   255     05  db-payeecity            pic x(30).
   256     05  db-payeest              pic xx.
   257     05  db-payeezip             pic x(10).
   258     05  db-fincar               pic x.
   259     05  db-fingrp               pic x(6).
   260     05  db-finresp              pic x(10).
   261     05  db-finacct              pic x(10).
   262     05  db-preparer             pic x(4).
   263     05  db-app-status           pic x(9).
   264     05  dp-app-status-n redefines db-app-status
   265                                 pic 9(9).
   266     05  db-app-by               pic x(20).
   267     05  db-app-date             pic x(30).
   268     05  db-app-batch            pic x(10).
   269     05  db-return-to            pic x(30).
   270 EXEC SQL
   271    END DECLARE SECTION
   272 END-EXEC
   273 01  FILE-KEYS.
   274     12  ELCNTL-KEY.
   275         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   276         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   277         16 ELCNTL-ACCESS.
   278             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   279             20  FILLER              PIC X       VALUE SPACES.
   280             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   281         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   282 01  f.
   283     05  ws-connect-sw               pic x  value ' '.
   284         88  connected-to-db             value 'Y'.
   285     05  written-status          pic xx.
   286     05  writrpt-status          pic xx.
   287     05  ws-comp-id              pic xxx.
   288     05  ws-comp-cd              pic x.
   289 01  ws-written-rec.
   290     05  wsw-check-no            pic x(20).
   291     05  wsw-check-dt            pic x(20).
   292     05  wsw-check-amt           pic x(15).
   293     05  wsw-vendor-id           pic x(20).
   294     05  wsw-user-defined        pic x(30).
   295     05  wsw-voucher-ref         pic x(35).
   296 01  filler.
   297     05  wsw-check-key           pic x(7).
   298     05  wsw-check-key-num redefines wsw-check-key
   299                                 pic 9(7).
   300 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   301     88  RESP-NORMAL                    VALUE +0.
   302     88  resp-file-notfnd               value +12.
   303     88  RESP-NOTFND                    VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   7
* EL201.cbl
   304     88  resp-duprec                    value +14.
   305     88  resp-dupkey                    value +15.
   306     88  resp-invreq                    value +16.
   307     88  RESP-NOTOPEN                   VALUE +19.
   308     88  RESP-ENDFILE                   VALUE +20.
   309     88  resp-lengtherr                 value +22.
   310 01  ws-work-amt-alpha           pic x(10).
   311 01  ws-work-amt-num redefines ws-work-amt-alpha
   312                                 pic 9(8)v99.
   313 01  ws-qry-string               pic x(80) value spaces.
   314 01  ws-qrystr-len               pic s9(8) comp value +60.
   315 01  ws-seq-alpha                pic x(5).
   316 01  ws-seq-no-num redefines ws-seq-alpha
   317                                 pic 9(5).
   318*                                copy ERCCHEK.
   319******************************************************************
   320*                                                                *
   321*                                                                *
   322*                            ERCCHEK                             *
   323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   324*                            VMOD=2.008                          *
   325*                                                                *
   326*   FILE DESCRIPTION = CHECK RECORDS                             *
   327*                                                                *
   328*   FILE TYPE = VSAM,KSDS                                        *
   329*   RECORD SIZE = 600    RECFORM = FIXED                         *
   330*                                                                *
   331*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   332*       ALTERNATE INDEX = NONE                                   *
   333*                                                                *
   334*   LOG = YES                                                    *
   335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   336******************************************************************
   337*                   C H A N G E   L O G
   338*
   339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   340*-----------------------------------------------------------------
   341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   342* EFFECTIVE    NUMBER
   343*-----------------------------------------------------------------
   344* 021414    2003053000001  PEMA  changes for auto chk request
   345******************************************************************
   346 01  CHECK-RECORDS.
   347     12  CH-RECORD-ID                      PIC XX.
   348         88  VALID-CH-ID                      VALUE 'CH'.
   349
   350     12  CH-CONTROL-PRIMARY.
   351         16  CH-COMPANY-CD                 PIC X.
   352         16  CH-CARRIER                    PIC X.
   353         16  CH-GROUPING                   PIC X(6).
   354         16  CH-STATE                      PIC XX.
   355         16  CH-ACCOUNT                    PIC X(10).
   356         16  CH-CERT-EFF-DT                PIC XX.
   357         16  CH-CERT-NO.
   358             20  CH-CERT-PRIME             PIC X(10).
   359             20  CH-CERT-SFX               PIC X.
   360         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   361
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   8
* EL201.cbl
   362     12  CH-RECORDED-DT                    PIC XX.
   363     12  CH-RECORDED-BY                    PIC X(4).
   364     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   365
   366     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   367     12  CH-CHECK-NO                       PIC X(7).
   368     12  CH-REASON-FOR-CHECK               PIC X(25).
   369     12  CH-CHECK-WRITTEN-DT               PIC XX.
   370     12  FILLER                            PIC X.
   371
   372     12  CH-PAYEE-INFO.
   373         16  CH-PAYEE-NAME-1               PIC X(30).
   374         16  CH-PAYEE-NAME-2               PIC X(30).
   375         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   376         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   377         16  CH-PAYEE-CITY-ST.
   378             20  CH-PAYEE-CITY             PIC X(28).
   379             20  CH-PAYEE-STATE            PIC XX.
   380         16  CH-PAYEE-ZIP-CODE.
   381             20  CH-PAYEE-ZIP.
   382                 24  CH-ZIP-PRI-1ST        PIC X.
   383                     88  CH-CANADIAN-POST-CODE
   384                                           VALUES 'A' THRU 'Z'.
   385                 24  FILLER                PIC X(4).
   386             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   387         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   388             20  CH-CAN-POSTAL-1           PIC XXX.
   389             20  CH-CAN-POSTAL-2           PIC XXX.
   390             20  FILLER                    PIC XXX.
   391
   392     12  CH-CHECK-STUB-TEXT.
   393         16  CH-STUB-LINE-1                PIC X(30).
   394         16  CH-TEXT-LINE-1                PIC X(50).
   395         16  CH-TEXT-LINE-2                PIC X(50).
   396         16  CH-TEXT-LINE-3                PIC X(40).
   397     12  CH-RETURN-TO                      PIC X(30).
   398
   399     12  CH-COMPENSATION-CONTROL.
   400         16  CH-COMP-CARRIER               PIC X.
   401         16  CH-COMP-GROUPING              PIC X(6).
   402         16  CH-COMP-FIN-RESP              PIC X(10).
   403         16  CH-COMP-ACCOUNT               PIC X(10).
   404
   405     12  CH-CREDIT-SELECT-DT               PIC XX.
   406     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   407     12  CH-PAYEE-CODE                     PIC X(6).
   408
   409     12  CH-VOID-DATA.
   410         20  CH-VOID-DT                    PIC XX.
   411         20  CH-VOID-BY                    PIC X(4).
   412         20  CH-VOID-REASON                PIC X(25).
   413
   414     12  CH-APPROVAL-DATA.
   415         20  CH-APPROVAL-DT                PIC XX.
   416         20  CH-APPROVAL-STATUS            PIC X.
   417             88  CH-IN-LIMBO                  VALUE ' '.
   418             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   419             88  CH-APPROVED                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page   9
* EL201.cbl
   420             88  CH-DENIED                    VALUE 'D'.
   421         20  CH-APPROVED-BY                PIC XXXX.
   422     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   423             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   424     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   425
   426     12  ch-released-dt                    pic xx.
   427     12  ch-check-cashed-dt                pic xx.
   428     12  FILLER                            PIC X.
   429*    12  CH-CHECK-REFERENCE                PIC X(12).
   430     12  CH-CHECK-ORIGIN-SW                PIC X.
   431             88  CH-REFUND-CHECK              VALUE 'R'.
   432             88  CH-MAINT-CHECK               VALUE 'M'.
   433
   434     12  CH-CANC-DT                        PIC XX.
   435     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   436     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   437
   438     12  CH-INSURED-NAME                   PIC X(28).
   439
   440     12  ch-released-by                    pic x(4).
   441     12  ch-csr                            pic x(4).
   442     12  ch-deduct-commission              pic x.
   443         88  ch-deduct-comm                  value 'Y'.
   444         88  ch-do-not-deduct-comm           value 'N'.
   445
   446     12  FILLER                            PIC X(11).
   447*    12  CH-LETTER-TABLE.
   448*        16  CH-LETTERS OCCURS 3 TIMES
   449*                       INDEXED BY CH-LT-NDX
   450*                                          PIC X(04).
   451
   452     12  FILLER                            PIC X(07).
   453
   454*                                copy ELCFUNDT.
   455*****************************************************************
   456*                                                               *
   457*                            ELCFUNDT.                          *
   458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   459*                            VMOD=2.001                         *
   460*                                                               *
   461*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   462*                                                               *
   463*****************************************************************
   464
   465
   466 01  FUNCTION-DATE.
   467     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   468     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   469         10  WS-FN-CCYR            PIC 9(4).
   470         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   471             15  WS-FN-CC          PIC 99.
   472             15  WS-FN-YR          PIC 99.
   473         10  WS-FN-MO              PIC 99.
   474         10  WS-FN-DA              PIC 99.
   475     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   476     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   477     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  10
* EL201.cbl
   478     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   479     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   480         88  WS-BEHIND-GMT                     VALUE '-'.
   481         88  WS-AFTER-GMT                      VALUE '+'.
   482         88  WS-NO-GMT                         VALUE ZERO.
   483     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   484     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   485*                                COPY ELCDATE.
   486******************************************************************
   487*                                                                *
   488*                                                                *
   489*                            ELCDATE.                            *
   490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   491*                            VMOD=2.003
   492*                                                                *
   493*                                                                *
   494*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   495*                 LENGTH = 200                                   *
   496******************************************************************
   497
   498 01  DATE-CONVERSION-DATA.
   499     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   500     12  DC-OPTION-CODE                PIC X.
   501         88  BIN-TO-GREG                VALUE ' '.
   502         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   503         88  EDIT-GREG-TO-BIN           VALUE '2'.
   504         88  YMD-GREG-TO-BIN            VALUE '3'.
   505         88  MDY-GREG-TO-BIN            VALUE '4'.
   506         88  JULIAN-TO-BIN              VALUE '5'.
   507         88  BIN-PLUS-ELAPSED           VALUE '6'.
   508         88  FIND-CENTURY               VALUE '7'.
   509         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   510         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   511         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   512         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   513         88  JULIAN-TO-BIN-3            VALUE 'C'.
   514         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   515         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   516         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   517         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   518         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   519         88  CHECK-LEAP-YEAR            VALUE 'H'.
   520         88  BIN-3-TO-GREG              VALUE 'I'.
   521         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   522         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   523         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   524         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   525         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   526         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   527         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   528         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   529         88  THREE-CHARACTER-BIN
   530                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   531         88  GREGORIAN-TO-BIN
   532                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   533         88  BIN-TO-GREGORIAN
   534                  VALUES ' ' '1' 'I' '8' 'G'.
   535         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  11
* EL201.cbl
   536                  VALUES '5' 'C' 'E' 'F'.
   537     12  DC-ERROR-CODE                 PIC X.
   538         88  NO-CONVERSION-ERROR        VALUE ' '.
   539         88  DATE-CONVERSION-ERROR
   540                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   541         88  DATE-IS-ZERO               VALUE '1'.
   542         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   543         88  DATE-IS-INVALID            VALUE '3'.
   544         88  DATE1-GREATER-DATE2        VALUE '4'.
   545         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   546         88  DATE-INVALID-OPTION        VALUE '9'.
   547         88  INVALID-CENTURY            VALUE 'A'.
   548         88  ONLY-CENTURY               VALUE 'B'.
   549         88  ONLY-LEAP-YEAR             VALUE 'C'.
   550         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   551     12  DC-END-OF-MONTH               PIC X.
   552         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   553     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   554         88  USE-NORMAL-PROCESS         VALUE ' '.
   555         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   556         88  ADJUST-UP-100-YRS          VALUE '2'.
   557     12  FILLER                        PIC X.
   558     12  DC-CONVERSION-DATES.
   559         16  DC-BIN-DATE-1             PIC XX.
   560         16  DC-BIN-DATE-2             PIC XX.
   561         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   562         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   563                       DC-GREG-DATE-1-EDIT.
   564             20  DC-EDIT1-MONTH        PIC 99.
   565             20  SLASH1-1              PIC X.
   566             20  DC-EDIT1-DAY          PIC 99.
   567             20  SLASH1-2              PIC X.
   568             20  DC-EDIT1-YEAR         PIC 99.
   569         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   570         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   571                     DC-GREG-DATE-2-EDIT.
   572             20  DC-EDIT2-MONTH        PIC 99.
   573             20  SLASH2-1              PIC X.
   574             20  DC-EDIT2-DAY          PIC 99.
   575             20  SLASH2-2              PIC X.
   576             20  DC-EDIT2-YEAR         PIC 99.
   577         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   578         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   579                     DC-GREG-DATE-1-YMD.
   580             20  DC-YMD-YEAR           PIC 99.
   581             20  DC-YMD-MONTH          PIC 99.
   582             20  DC-YMD-DAY            PIC 99.
   583         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   584         16  DC-GREG-DATE-1-MDY-R REDEFINES
   585                      DC-GREG-DATE-1-MDY.
   586             20  DC-MDY-MONTH          PIC 99.
   587             20  DC-MDY-DAY            PIC 99.
   588             20  DC-MDY-YEAR           PIC 99.
   589         16  DC-GREG-DATE-1-ALPHA.
   590             20  DC-ALPHA-MONTH        PIC X(10).
   591             20  DC-ALPHA-DAY          PIC 99.
   592             20  FILLER                PIC XX.
   593             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  12
* EL201.cbl
   594                 24 DC-ALPHA-CEN-N     PIC 99.
   595             20  DC-ALPHA-YEAR         PIC 99.
   596         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   597         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   598         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   599         16  DC-JULIAN-DATE            PIC 9(05).
   600         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   601                                       PIC 9(05).
   602         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   603             20  DC-JULIAN-YEAR        PIC 99.
   604             20  DC-JULIAN-DAYS        PIC 999.
   605         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   606         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   607         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   608     12  DATE-CONVERSION-VARIBLES.
   609         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   610         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   611             20  FILLER                PIC 9(3).
   612             20  HOLD-CEN-1-CCYY.
   613                 24  HOLD-CEN-1-CC     PIC 99.
   614                 24  HOLD-CEN-1-YY     PIC 99.
   615             20  HOLD-CEN-1-MO         PIC 99.
   616             20  HOLD-CEN-1-DA         PIC 99.
   617         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   618             20  HOLD-CEN-1-R-MO       PIC 99.
   619             20  HOLD-CEN-1-R-DA       PIC 99.
   620             20  HOLD-CEN-1-R-CCYY.
   621                 24  HOLD-CEN-1-R-CC   PIC 99.
   622                 24  HOLD-CEN-1-R-YY   PIC 99.
   623             20  FILLER                PIC 9(3).
   624         16  HOLD-CENTURY-1-X.
   625             20  FILLER                PIC X(3)  VALUE SPACES.
   626             20  HOLD-CEN-1-X-CCYY.
   627                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   628                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   629             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   630             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   631         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   632             20  HOLD-CEN-1-R-X-MO     PIC XX.
   633             20  HOLD-CEN-1-R-X-DA     PIC XX.
   634             20  HOLD-CEN-1-R-X-CCYY.
   635                 24  HOLD-CEN-1-R-X-CC PIC XX.
   636                 24  HOLD-CEN-1-R-X-YY PIC XX.
   637             20  FILLER                PIC XXX.
   638         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   639         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   640         16  DC-JULIAN-DATE-1          PIC 9(07).
   641         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   642             20  DC-JULIAN-1-CCYY.
   643                 24  DC-JULIAN-1-CC    PIC 99.
   644                 24  DC-JULIAN-1-YR    PIC 99.
   645             20  DC-JULIAN-DA-1        PIC 999.
   646         16  DC-JULIAN-DATE-2          PIC 9(07).
   647         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   648             20  DC-JULIAN-2-CCYY.
   649                 24  DC-JULIAN-2-CC    PIC 99.
   650                 24  DC-JULIAN-2-YR    PIC 99.
   651             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  13
* EL201.cbl
   652         16  DC-GREG-DATE-A-EDIT.
   653             20  DC-EDITA-MONTH        PIC 99.
   654             20  SLASHA-1              PIC X VALUE '/'.
   655             20  DC-EDITA-DAY          PIC 99.
   656             20  SLASHA-2              PIC X VALUE '/'.
   657             20  DC-EDITA-CCYY.
   658                 24  DC-EDITA-CENT     PIC 99.
   659                 24  DC-EDITA-YEAR     PIC 99.
   660         16  DC-GREG-DATE-B-EDIT.
   661             20  DC-EDITB-MONTH        PIC 99.
   662             20  SLASHB-1              PIC X VALUE '/'.
   663             20  DC-EDITB-DAY          PIC 99.
   664             20  SLASHB-2              PIC X VALUE '/'.
   665             20  DC-EDITB-CCYY.
   666                 24  DC-EDITB-CENT     PIC 99.
   667                 24  DC-EDITB-YEAR     PIC 99.
   668         16  DC-GREG-DATE-CYMD         PIC 9(08).
   669         16  DC-GREG-DATE-CYMD-R REDEFINES
   670                              DC-GREG-DATE-CYMD.
   671             20  DC-CYMD-CEN           PIC 99.
   672             20  DC-CYMD-YEAR          PIC 99.
   673             20  DC-CYMD-MONTH         PIC 99.
   674             20  DC-CYMD-DAY           PIC 99.
   675         16  DC-GREG-DATE-MDCY         PIC 9(08).
   676         16  DC-GREG-DATE-MDCY-R REDEFINES
   677                              DC-GREG-DATE-MDCY.
   678             20  DC-MDCY-MONTH         PIC 99.
   679             20  DC-MDCY-DAY           PIC 99.
   680             20  DC-MDCY-CEN           PIC 99.
   681             20  DC-MDCY-YEAR          PIC 99.
   682    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   683        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   684    12  DC-EL310-DATE                  PIC X(21).
   685    12  FILLER                         PIC X(28).
   686*                                COPY ELCCNTL.
   687******************************************************************
   688*                                                                *
   689*                                                                *
   690*                            ELCCNTL.                            *
   691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   692*                            VMOD=2.059                          *
   693*                                                                *
   694*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   695*                                                                *
   696*   FILE TYPE = VSAM,KSDS                                        *
   697*   RECORD SIZE = 750  RECFORM = FIXED                           *
   698*                                                                *
   699*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   700*       ALTERNATE INDEX = NONE                                   *
   701*                                                                *
   702*   LOG = YES                                                    *
   703*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   704******************************************************************
   705*                   C H A N G E   L O G
   706*
   707* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   708*-----------------------------------------------------------------
   709*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  14
* EL201.cbl
   710* EFFECTIVE    NUMBER
   711*-----------------------------------------------------------------
   712* 082503                   PEMA  ADD BENEFIT GROUP
   713* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   714* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   715* 092705    2005050300006  PEMA  ADD SPP LEASES
   716* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   717* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   718* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   719* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   720* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   721* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   722* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   723* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   724* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   725******************************************************************
   726*
   727 01  CONTROL-FILE.
   728     12  CF-RECORD-ID                       PIC XX.
   729         88  VALID-CF-ID                        VALUE 'CF'.
   730
   731     12  CF-CONTROL-PRIMARY.
   732         16  CF-COMPANY-ID                  PIC XXX.
   733         16  CF-RECORD-TYPE                 PIC X.
   734             88  CF-COMPANY-MASTER              VALUE '1'.
   735             88  CF-PROCESSOR-MASTER            VALUE '2'.
   736             88  CF-STATE-MASTER                VALUE '3'.
   737             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   738             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   739             88  CF-CARRIER-MASTER              VALUE '6'.
   740             88  CF-MORTALITY-MASTER            VALUE '7'.
   741             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   742             88  CF-TERMINAL-MASTER             VALUE '9'.
   743             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   744             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   745             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   746             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   747             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   748             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   749             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   750             88  CF-REMINDERS-MASTER            VALUE 'R'.
   751             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   752         16  CF-ACCESS-CD-GENL              PIC X(4).
   753         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   754             20  CF-PROCESSOR               PIC X(4).
   755         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   756             20  CF-STATE-CODE              PIC XX.
   757             20  FILLER                     PIC XX.
   758         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   759             20  FILLER                     PIC XX.
   760             20  CF-HI-BEN-IN-REC           PIC XX.
   761         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   762             20  FILLER                     PIC XXX.
   763             20  CF-CARRIER-CNTL            PIC X.
   764         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   765             20  FILLER                     PIC XX.
   766             20  CF-HI-TYPE-IN-REC          PIC 99.
   767         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  15
* EL201.cbl
   768             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   769                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   770             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   771             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   772         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   773             20  FILLER                     PIC X.
   774             20  CF-CUSTOM-REPORT-NO        PIC 999.
   775         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   776             20  FILLER                     PIC XX.
   777             20  CF-MORTGAGE-PLAN           PIC XX.
   778         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   779
   780     12  CF-LAST-MAINT-DT                   PIC XX.
   781     12  CF-LAST-MAINT-BY                   PIC X(4).
   782     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   783
   784     12  CF-RECORD-BODY                     PIC X(728).
   785
   786
   787****************************************************************
   788*             COMPANY MASTER RECORD                            *
   789****************************************************************
   790
   791     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   792         16  CF-COMPANY-ADDRESS.
   793             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   794             20  CF-CL-IN-CARE-OF           PIC X(30).
   795             20  CF-CL-ADDR-LINE-1          PIC X(30).
   796             20  CF-CL-ADDR-LINE-2          PIC X(30).
   797             20  CF-CL-CITY-STATE           PIC X(30).
   798             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   799             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   800         16  CF-COMPANY-CD                  PIC X.
   801         16  CF-COMPANY-PASSWORD            PIC X(8).
   802         16  CF-SECURITY-OPTION             PIC X.
   803             88  ALL-SECURITY                   VALUE '1'.
   804             88  COMPANY-VERIFY                 VALUE '2'.
   805             88  PROCESSOR-VERIFY               VALUE '3'.
   806             88  NO-SECURITY                    VALUE '4'.
   807             88  ALL-BUT-TERM                   VALUE '5'.
   808         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   809             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   810         16  CF-LGX-INTERFACE-CNTL          PIC X.
   811             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   812         16  CF-INFORCE-LOCATION            PIC X.
   813             88  CERTS-ARE-ONLINE               VALUE '1'.
   814             88  CERTS-ARE-OFFLINE              VALUE '2'.
   815             88  NO-CERTS-AVAILABLE             VALUE '3'.
   816         16  CF-LOWER-CASE-LETTERS          PIC X.
   817         16  CF-CERT-ACCESS-CONTROL         PIC X.
   818             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   819             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   820             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   821             88  CF-ACCNT-CNTL                  VALUE '3'.
   822             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   823
   824         16  CF-FORMS-PRINTER-ID            PIC X(4).
   825         16  CF-CHECK-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  16
* EL201.cbl
   826
   827         16  CF-LGX-CREDIT-USER             PIC X.
   828             88  CO-IS-NOT-USER                 VALUE 'N'.
   829             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   830
   831         16 CF-CREDIT-CALC-CODES.
   832             20  CF-CR-REM-TERM-CALC PIC X.
   833               88  CR-EARN-AFTER-15TH           VALUE '1'.
   834               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   835               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   836               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   837               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   838               88  CR-EARN-AFTER-14TH           VALUE '6'.
   839               88  CR-EARN-AFTER-16TH           VALUE '7'.
   840             20  CF-CR-R78-METHOD           PIC X.
   841               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   842               88  DONT-USE-PLUS-ONE            VALUE '1'.
   843
   844         16  CF-CLAIM-CONTROL-COUNTS.
   845             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   846                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   847
   848             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   849                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   850
   851             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   852                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   853
   854             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   855                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   856
   857         16  CF-CURRENT-MONTH-END           PIC XX.
   858
   859         16  CF-CO-CALC-QUOTE-TOLERANCE.
   860             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   861             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   862             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   863             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   864                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   865                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   866             20  CF-CO-PREM-REJECT-SW       PIC X.
   867                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   868                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   869             20  CF-CO-REF-REJECT-SW        PIC X.
   870                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   871                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   872
   873         16  CF-CO-REPORTING-DT             PIC XX.
   874         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   875         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   876           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   877           88  CF-CO-MONTH-END                  VALUE '1'.
   878
   879         16  CF-LGX-CLAIM-USER              PIC X.
   880             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   881             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   882
   883         16  CF-CREDIT-EDIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  17
* EL201.cbl
   884             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   885             20  CF-MIN-AGE                 PIC 99.
   886             20  CF-DEFAULT-AGE             PIC 99.
   887             20  CF-MIN-TERM                PIC S999      COMP-3.
   888             20  CF-MAX-TERM                PIC S999      COMP-3.
   889             20  CF-DEFAULT-SEX             PIC X.
   890             20  CF-JOINT-AGE-INPUT         PIC X.
   891                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   892             20  CF-BIRTH-DATE-INPUT        PIC X.
   893                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   894             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   895                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   896                 88  CF-ZERO-CARRIER            VALUE '1'.
   897                 88  CF-ZERO-GROUPING           VALUE '2'.
   898                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   899             20  CF-EDIT-SW                 PIC X.
   900                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   901             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   902             20  CF-CR-PR-METHOD            PIC X.
   903               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   904               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   905             20  FILLER                     PIC X.
   906
   907         16  CF-CREDIT-MISC-CONTROLS.
   908             20  CF-REIN-TABLE-SW           PIC X.
   909                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   910             20  CF-COMP-TABLE-SW           PIC X.
   911                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   912             20  CF-EXPERIENCE-RETENTION-AGE
   913                                            PIC S9        COMP-3.
   914             20  CF-CONVERSION-DT           PIC XX.
   915             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   916             20  CF-RUN-FREQUENCY-SW        PIC X.
   917                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   918                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   919
   920             20  CF-CR-CHECK-NO-CONTROL.
   921                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   922                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   923                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   924                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   925                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   926                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   927
   928                 24  CF-CR-CHECK-COUNT       REDEFINES
   929                     CF-CR-CHECK-COUNTER      PIC X(4).
   930
   931                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   932                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   933
   934                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   935                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   936                 24  CF-MAIL-PROCESSING       PIC X.
   937                     88  MAIL-PROCESSING          VALUE 'Y'.
   938
   939         16  CF-MISC-SYSTEM-CONTROL.
   940             20  CF-SYSTEM-C                 PIC X.
   941                 88  CONFIRMATION-SYS-USED       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  18
* EL201.cbl
   942             20  CF-SYSTEM-D                 PIC X.
   943                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   944             20  CF-SOC-SEC-NO-SW            PIC X.
   945                 88  SOC-SEC-NO-USED             VALUE '1'.
   946             20  CF-MEMBER-NO-SW             PIC X.
   947                 88  MEMBER-NO-USED              VALUE '1'.
   948             20  CF-TAX-ID-NUMBER            PIC X(11).
   949             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   950             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   951                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   952                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   953                 88  CF-ALL-APPROVED             VALUE 'Y'.
   954                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   955             20  CF-SYSTEM-E                 PIC X.
   956                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   957
   958         16  CF-LGX-LIFE-USER               PIC X.
   959             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   960             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   961
   962         16  CF-CR-MONTH-END-DT             PIC XX.
   963
   964         16  CF-FILE-MAINT-DATES.
   965             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   966                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   967             20  CF-LAST-BATCH       REDEFINES
   968                 CF-LAST-BATCH-NO               PIC X(4).
   969             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   970             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   971             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   972             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   973             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   974             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   975             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   976             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   977             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   978             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   979
   980         16  CF-NEXT-COMPANY-ID             PIC XXX.
   981         16  FILLER                         PIC X.
   982
   983         16  CF-ALT-MORT-CODE               PIC X(4).
   984         16  CF-MEMBER-CAPTION              PIC X(10).
   985
   986         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   987             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   988             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   989             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   990             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   991             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   992
   993         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   994
   995         16  CF-LIFE-OVERRIDE-L1            PIC X.
   996         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   997         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   998         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   999
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  19
* EL201.cbl
  1000         16  CF-AH-OVERRIDE-L1              PIC X.
  1001         16  CF-AH-OVERRIDE-L2              PIC XX.
  1002         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1003         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1004
  1005         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1006         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1007
  1008         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1009         16  CF-AR-LAST-EL860-DT            PIC XX.
  1010         16  CF-MP-MONTH-END-DT             PIC XX.
  1011
  1012         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1013         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1014             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1015
  1016         16  CF-AR-MONTH-END-DT             PIC XX.
  1017
  1018         16  CF-CRDTCRD-USER                PIC X.
  1019             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1020             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1021
  1022         16  CF-CC-MONTH-END-DT             PIC XX.
  1023
  1024         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1025
  1026         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1027             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1028             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1029             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1030         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1031         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1032         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1033         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1034             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1035             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1036         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1037         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1038         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1039             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1040         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1041
  1042         16  CF-CL-ZIP-CODE.
  1043             20  CF-CL-ZIP-PRIME.
  1044                 24  CF-CL-ZIP-1ST          PIC X.
  1045                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1046                 24  FILLER                 PIC X(4).
  1047             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1048         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1049             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1050             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1051             20  FILLER                     PIC XXX.
  1052
  1053         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1054         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1055         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1056         16  CF-CO-OPTION-START-DATE        PIC XX.
  1057         16  CF-REM-TRM-CALC-OPTION         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  20
* EL201.cbl
  1058           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1059                                                      '3' '4'.
  1060           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1061           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1062           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1063           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1064           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1065           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1066
  1067         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1068
  1069         16  CF-PAYMENT-APPROVAL-LEVELS.
  1070             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1071             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1072             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1073             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1074             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1075             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1076
  1077         16  CF-END-USER-REPORTING-USER     PIC X.
  1078             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1079             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1080
  1081         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1082             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1083             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1084
  1085         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1086
  1087         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1088         16  FILLER                         PIC X.
  1089
  1090         16  CF-CREDIT-ARCHIVE-CNTL.
  1091             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1092             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1093             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1094
  1095         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1096
  1097         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1098             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1099             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1100
  1101         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1102             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1103             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1104
  1105         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1106
  1107         16  CF-CO-ACH-ID-CODE              PIC  X.
  1108             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1109             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1110             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1111         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1112         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1113         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1114         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1115         16  CF-CO-ACH-RECV-NAME            PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  21
* EL201.cbl
  1116         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1117         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1118         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1119         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1120                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1121         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1122                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1123
  1124         16  CF-CO-OVER-SHORT.
  1125             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1126             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1127
  1128*         16  FILLER                         PIC X(102).
  1129         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1130             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1131             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1132
  1133         16  CF-AH-APPROVAL-DAYS.
  1134             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1135             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1136             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1137             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1138
  1139         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1140
  1141         16  CF-APPROV-LEV-5.
  1142             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1143             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1144             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1145
  1146         16  FILLER                         PIC X(68).
  1147****************************************************************
  1148*             PROCESSOR/USER RECORD                            *
  1149****************************************************************
  1150
  1151     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1152         16  CF-PROCESSOR-NAME              PIC X(30).
  1153         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1154         16  CF-PROCESSOR-TITLE             PIC X(26).
  1155         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1156                 88  MESSAGE-YES                VALUE 'Y'.
  1157                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1158
  1159*****************************************************
  1160****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1161****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1162****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1163****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1164*****************************************************
  1165
  1166         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1167             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1168             20  CF-APPLICATION-FORCE       PIC X.
  1169             20  CF-INDIVIDUAL-APP.
  1170                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1171                     28  CF-BROWSE-APP      PIC X.
  1172                     28  CF-UPDATE-APP      PIC X.
  1173
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  22
* EL201.cbl
  1174         16  CF-CURRENT-TERM-ON             PIC X(4).
  1175         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1176             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1177             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1178             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1179             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1180             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1181             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1182             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1183         16  CF-PROCESSOR-CARRIER           PIC X.
  1184             88  NO-CARRIER-SECURITY            VALUE ' '.
  1185         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1186             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1187         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1188             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1189         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1190             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1191
  1192         16  CF-PROC-SYS-ACCESS-SW.
  1193             20  CF-PROC-CREDIT-CLAIMS-SW.
  1194                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1195                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1196                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1197                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1198             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1199                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1200                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1201             20  CF-PROC-LIFE-GNRLDGR-SW.
  1202                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1203                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1204                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1205                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1206             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1207                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1208                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1209         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1210             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1211             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1212         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1213
  1214         16  CF-APPROVAL-LEVEL                  PIC X.
  1215             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1216             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1217             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1218             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1219             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1220
  1221         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1222
  1223         16  CF-LANGUAGE-TYPE                   PIC X.
  1224             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1225             88  CF-LANG-IS-FR                      VALUE 'F'.
  1226
  1227         16  CF-CSR-IND                         PIC X.
  1228         16  FILLER                             PIC X(239).
  1229
  1230****************************************************************
  1231*             PROCESSOR/REMINDERS RECORD                       *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  23
* EL201.cbl
  1232****************************************************************
  1233
  1234     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1235         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1236             20  CF-START-REMIND-DT         PIC XX.
  1237             20  CF-END-REMIND-DT           PIC XX.
  1238             20  CF-REMINDER-TEXT           PIC X(50).
  1239         16  FILLER                         PIC X(296).
  1240
  1241
  1242****************************************************************
  1243*             STATE MASTER RECORD                              *
  1244****************************************************************
  1245
  1246     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1247         16  CF-STATE-ABBREVIATION          PIC XX.
  1248         16  CF-STATE-NAME                  PIC X(25).
  1249         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1250         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1251             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1252             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1253             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1254             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1255                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1256                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1257             20  CF-ST-PREM-REJECT-SW       PIC X.
  1258                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1259                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1260             20  CF-ST-REF-REJECT-SW        PIC X.
  1261                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1262                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1263         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1264         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1265         16  CF-ST-REFUND-RULES.
  1266             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1267             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1268             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1269         16  CF-ST-FST-PMT-EXTENSION.
  1270             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1271             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1272                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1273                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1274                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1275                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1276         16  CF-ST-STATE-CALL.
  1277             20  CF-ST-CALL-UNEARNED        PIC X.
  1278             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1279             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1280         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1281             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1282             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1283         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1284         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1285         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1286         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1287         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1288         16  FILLER                         PIC X.
  1289         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  24
* EL201.cbl
  1290             20  CF-ST-BENEFIT-CD           PIC XX.
  1291             20  CF-ST-BENEFIT-KIND         PIC X.
  1292                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1293                 88  CF-ST-AH-KIND              VALUE 'A'.
  1294             20  CF-ST-REM-TERM-CALC        PIC X.
  1295                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1296                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1297                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1298                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1299                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1300                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1301                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1302                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1303
  1304             20  CF-ST-REFUND-CALC          PIC X.
  1305                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1306                 88  ST-REFD-BY-R78             VALUE '1'.
  1307                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1308                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1309                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1310                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1311                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1312                 88  ST-REFD-UTAH               VALUE '7'.
  1313                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1314                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1315                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1316
  1317             20  CF-ST-EARNING-CALC         PIC X.
  1318                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1319                 88  ST-EARN-BY-R78             VALUE '1'.
  1320                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1321                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1322                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1323                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1324                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1325                 88  ST-EARN-MEAN               VALUE '8'.
  1326                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1327
  1328             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1329                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1330                 88  ST-OVRD-BY-R78             VALUE '1'.
  1331                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1332                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1333                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1334                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1335                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1336                 88  ST-OVRD-MEAN               VALUE '8'.
  1337                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1338             20  FILLER                     PIC X.
  1339
  1340         16  CF-ST-COMMISSION-CAPS.
  1341             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1342             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1343             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1344             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1345         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1346                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1347
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  25
* EL201.cbl
  1348         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1349
  1350         16  CF-ST-STATUTORY-INTEREST.
  1351             20  CF-ST-STAT-DATE-FROM       PIC X.
  1352                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1353                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1354             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1355             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1356             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1357             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1358             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1359
  1360         16  CF-ST-OVER-SHORT.
  1361             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1362             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1363
  1364         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1365
  1366         16  CF-ST-RT-CALC                  PIC X.
  1367
  1368         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1369         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1370         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1371         16  CF-ST-RF-LR-CALC               PIC X.
  1372         16  CF-ST-RF-LL-CALC               PIC X.
  1373         16  CF-ST-RF-LN-CALC               PIC X.
  1374         16  CF-ST-RF-AH-CALC               PIC X.
  1375         16  CF-ST-RF-CP-CALC               PIC X.
  1376*        16  FILLER                         PIC X(206).
  1377*CIDMOD         16  FILLER                         PIC X(192).
  1378         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1379             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1380         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1381         16  CF-ST-VFY-2ND-BENE             PIC X.
  1382         16  CF-ST-CAUSAL-STATE             PIC X.
  1383         16  FILLER                         PIC X(185).
  1384
  1385****************************************************************
  1386*             BENEFIT MASTER RECORD                            *
  1387****************************************************************
  1388
  1389     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1390         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1391             20  CF-BENEFIT-CODE            PIC XX.
  1392             20  CF-BENEFIT-NUMERIC  REDEFINES
  1393                 CF-BENEFIT-CODE            PIC XX.
  1394             20  CF-BENEFIT-ALPHA           PIC XXX.
  1395             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1396             20  CF-BENEFIT-COMMENT         PIC X(10).
  1397
  1398             20  CF-LF-COVERAGE-TYPE        PIC X.
  1399                 88  CF-REDUCING                VALUE 'R'.
  1400                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1401
  1402             20  CF-SPECIAL-CALC-CD         PIC X.
  1403                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1404                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1405                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  26
* EL201.cbl
  1406                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1407                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1408                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1409                 88  CF-FARM-PLAN               VALUE 'F'.
  1410                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1411                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1412                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1413                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1414                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1415                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1416                 88  CF-PRUDENTIAL              VALUE 'P'.
  1417                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1418                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1419                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1420                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1421                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1422                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1423
  1424             20  CF-JOINT-INDICATOR         PIC X.
  1425                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1426
  1427*            20  FILLER                     PIC X(12).
  1428             20  FILLER                     PIC X(11).
  1429             20  CF-BENEFIT-CATEGORY        PIC X.
  1430             20  CF-LOAN-TYPE               PIC X(8).
  1431
  1432             20  CF-CO-REM-TERM-CALC        PIC X.
  1433                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1434                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1435                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1436                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1437                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1438
  1439             20  CF-CO-EARNINGS-CALC        PIC X.
  1440                 88  CO-EARN-BY-R78             VALUE '1'.
  1441                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1442                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1443                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1444                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1445                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1446                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1447                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1448
  1449             20  CF-CO-REFUND-CALC          PIC X.
  1450                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1451                 88  CO-REFD-BY-R78             VALUE '1'.
  1452                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1453                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1454                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1455                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1456                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1457                 88  CO-REFD-MEAN               VALUE '8'.
  1458                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1459                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1460                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1461
  1462             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1463                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  27
* EL201.cbl
  1464                 88  CO-OVRD-BY-R78             VALUE '1'.
  1465                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1466                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1467                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1468                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1469                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1470                 88  CO-OVRD-MEAN               VALUE '8'.
  1471                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1472
  1473             20  CF-CO-BEN-I-G-CD           PIC X.
  1474                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1475                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1476                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1477
  1478         16  FILLER                         PIC X(304).
  1479
  1480
  1481****************************************************************
  1482*             CARRIER MASTER RECORD                            *
  1483****************************************************************
  1484
  1485     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1486         16  CF-ADDRESS-DATA.
  1487             20  CF-MAIL-TO-NAME            PIC X(30).
  1488             20  CF-IN-CARE-OF              PIC X(30).
  1489             20  CF-ADDRESS-LINE-1          PIC X(30).
  1490             20  CF-ADDRESS-LINE-2          PIC X(30).
  1491             20  CF-CITY-STATE              PIC X(30).
  1492             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1493             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1494
  1495         16  CF-CLAIM-NO-CONTROL.
  1496             20  CF-CLAIM-NO-METHOD         PIC X.
  1497                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1498                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1499                 88  CLAIM-NO-SEQ               VALUE '3'.
  1500                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1501             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1502                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1503                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1504                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1505
  1506         16  CF-CHECK-NO-CONTROL.
  1507             20  CF-CHECK-NO-METHOD         PIC X.
  1508                 88  CHECK-NO-MANUAL            VALUE '1'.
  1509                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1510                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1511                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1512             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1513                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1514
  1515         16  CF-DOMICILE-STATE              PIC XX.
  1516
  1517         16  CF-EXPENSE-CONTROLS.
  1518             20  CF-EXPENSE-METHOD          PIC X.
  1519                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1520                 88  DOLLARS-PER-PMT            VALUE '2'.
  1521                 88  PERCENT-OF-PAYMENT         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  28
* EL201.cbl
  1522                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1523             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1524             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1525
  1526         16  CF-CORRESPONDENCE-CONTROL.
  1527             20  CF-LETTER-RESEND-OPT       PIC X.
  1528                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1529                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1530             20  FILLER                     PIC X(4).
  1531
  1532         16  CF-RESERVE-CONTROLS.
  1533             20  CF-MANUAL-SW               PIC X.
  1534                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1535             20  CF-FUTURE-SW               PIC X.
  1536                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1537             20  CF-PTC-SW                  PIC X.
  1538                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1539             20  CF-IBNR-SW                 PIC X.
  1540                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1541             20  CF-PTC-LF-SW               PIC X.
  1542                 88  CF-LF-PTC-USED             VALUE '1'.
  1543             20  CF-CDT-ACCESS-METHOD       PIC X.
  1544                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1545                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1546                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1547             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1548
  1549         16  CF-CLAIM-CALC-METHOD           PIC X.
  1550             88  360-PLUS-MONTHS                VALUE '1'.
  1551             88  365-PLUS-MONTHS                VALUE '2'.
  1552             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1553             88  360-DAILY                      VALUE '4'.
  1554             88  365-DAILY                      VALUE '5'.
  1555
  1556         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1557         16  FILLER                         PIC X(11).
  1558
  1559         16  CF-LIMIT-AMOUNTS.
  1560             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1561             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1562             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1563             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1564             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1565             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1566             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1567             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1568             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1569             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1570
  1571         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1572         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1573         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1574
  1575         16  CF-ZIP-CODE.
  1576             20  CF-ZIP-PRIME.
  1577                 24  CF-ZIP-1ST             PIC X.
  1578                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1579                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  29
* EL201.cbl
  1580             20  CF-ZIP-PLUS4               PIC X(4).
  1581         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1582             20  CF-CAN-POSTAL-1            PIC XXX.
  1583             20  CF-CAN-POSTAL-2            PIC XXX.
  1584             20  FILLER                     PIC XXX.
  1585
  1586         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1587         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1588         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1589
  1590         16  CF-RATING-SWITCH               PIC X.
  1591             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1592             88  CF-NO-RATING                   VALUE 'N'.
  1593
  1594         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1595
  1596         16  CF-CARRIER-OVER-SHORT.
  1597             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1598             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1599
  1600         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1601         16  CF-SECPAY-SWITCH               PIC X.
  1602             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1603             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1604         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1605         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1606         16  FILLER                         PIC X(444).
  1607*        16  FILLER                         PIC X(452).
  1608
  1609
  1610****************************************************************
  1611*             MORTALITY MASTER RECORD                          *
  1612****************************************************************
  1613
  1614     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1615         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1616                                INDEXED BY CF-MORT-NDX.
  1617             20  CF-MORT-TABLE              PIC X(5).
  1618             20  CF-MORT-TABLE-TYPE         PIC X.
  1619                 88  CF-MORT-JOINT              VALUE 'J'.
  1620                 88  CF-MORT-SINGLE             VALUE 'S'.
  1621                 88  CF-MORT-COMBINED           VALUE 'C'.
  1622                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1623                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1624             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1625             20  CF-MORT-AGE-METHOD         PIC XX.
  1626                 88  CF-AGE-LAST                VALUE 'AL'.
  1627                 88  CF-AGE-NEAR                VALUE 'AN'.
  1628             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1629             20  CF-MORT-ADJUSTMENT-DIRECTION
  1630                                            PIC X.
  1631                 88  CF-MINUS                   VALUE '-'.
  1632                 88  CF-PLUS                    VALUE '+'.
  1633             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1634             20  CF-MORT-JOINT-CODE         PIC X.
  1635                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1636             20  CF-MORT-PC-Q               PIC X.
  1637                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  30
* EL201.cbl
  1638             20  CF-MORT-TABLE-CODE         PIC X(4).
  1639             20  CF-MORT-COMMENTS           PIC X(15).
  1640             20  FILLER                     PIC X(14).
  1641
  1642         16  FILLER                         PIC X(251).
  1643
  1644
  1645****************************************************************
  1646*             BUSSINESS TYPE MASTER RECORD                     *
  1647****************************************************************
  1648
  1649     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1650* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1651* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1652* AND RECORD 05 IS TYPES 81-99
  1653         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1654             20  CF-BUSINESS-TITLE          PIC  X(19).
  1655             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1656                                            PIC S9V9(4) COMP-3.
  1657             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1658             20  FILLER                     PIC  X.
  1659         16  FILLER                         PIC  X(248).
  1660
  1661
  1662****************************************************************
  1663*             TERMINAL MASTER RECORD                           *
  1664****************************************************************
  1665
  1666     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1667
  1668         16  CF-COMPANY-TERMINALS.
  1669             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1670                                  PIC X(4).
  1671         16  FILLER               PIC X(248).
  1672
  1673
  1674****************************************************************
  1675*             LIFE EDIT MASTER RECORD                          *
  1676****************************************************************
  1677
  1678     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1679         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1680             20  CF-LIFE-CODE-IN            PIC XX.
  1681             20  CF-LIFE-CODE-OUT           PIC XX.
  1682         16  FILLER                         PIC X(248).
  1683
  1684
  1685****************************************************************
  1686*             AH EDIT MASTER RECORD                            *
  1687****************************************************************
  1688
  1689     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1690         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1691             20  CF-AH-CODE-IN              PIC XXX.
  1692             20  CF-AH-CODE-OUT             PIC XX.
  1693         16  FILLER                         PIC X(248).
  1694
  1695
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  31
* EL201.cbl
  1696****************************************************************
  1697*             CREDIBILITY TABLES                               *
  1698****************************************************************
  1699
  1700     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1701         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1702                             INDEXED BY CF-CRDB-NDX.
  1703             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1704             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1705             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1706         16  FILLER                         PIC  X(332).
  1707
  1708
  1709****************************************************************
  1710*             REPORT CUSTOMIZATION RECORD                      *
  1711****************************************************************
  1712
  1713     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1714         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1715             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1716             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1717             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1718**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1719****       A T-TRANSFER.                                   ****
  1720             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1721
  1722         16  FILLER                         PIC XX.
  1723
  1724         16  CF-CARRIER-CNTL-OPT.
  1725             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1726                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1727                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1728             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1729                                            PIC X.
  1730         16  CF-GROUP-CNTL-OPT.
  1731             20  CF-GROUP-OPT-SEQ           PIC 9.
  1732                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1733                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1734             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1735                                            PIC X(6).
  1736         16  CF-STATE-CNTL-OPT.
  1737             20  CF-STATE-OPT-SEQ           PIC 9.
  1738                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1739                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1740             20  CF-STATE-SELECT OCCURS 3 TIMES
  1741                                            PIC XX.
  1742         16  CF-ACCOUNT-CNTL-OPT.
  1743             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1744                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1745                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1746             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1747                                            PIC X(10).
  1748         16  CF-BUS-TYP-CNTL-OPT.
  1749             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1750                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1751                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1752             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1753                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  32
* EL201.cbl
  1754         16  CF-LF-TYP-CNTL-OPT.
  1755             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1756                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1757                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1758             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1759                                            PIC XX.
  1760         16  CF-AH-TYP-CNTL-OPT.
  1761             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1762                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1763                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1764             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1765                                            PIC XX.
  1766         16  CF-REPTCD1-CNTL-OPT.
  1767             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1768                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1769                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1770             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1771                                            PIC X(10).
  1772         16  CF-REPTCD2-CNTL-OPT.
  1773             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1774                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1775                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1776             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1777                                            PIC X(10).
  1778         16  CF-USER1-CNTL-OPT.
  1779             20  CF-USER1-OPT-SEQ           PIC 9.
  1780                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1781                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1782             20  CF-USER1-SELECT OCCURS 3 TIMES
  1783                                            PIC X(10).
  1784         16  CF-USER2-CNTL-OPT.
  1785             20  CF-USER2-OPT-SEQ           PIC 9.
  1786                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1787                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1788             20  CF-USER2-SELECT OCCURS 3 TIMES
  1789                                            PIC X(10).
  1790         16  CF-USER3-CNTL-OPT.
  1791             20  CF-USER3-OPT-SEQ           PIC 9.
  1792                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1793                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1794             20  CF-USER3-SELECT OCCURS 3 TIMES
  1795                                            PIC X(10).
  1796         16  CF-USER4-CNTL-OPT.
  1797             20  CF-USER4-OPT-SEQ           PIC 9.
  1798                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1799                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1800             20  CF-USER4-SELECT OCCURS 3 TIMES
  1801                                            PIC X(10).
  1802         16  CF-USER5-CNTL-OPT.
  1803             20  CF-USER5-OPT-SEQ           PIC 9.
  1804                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1805                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1806             20  CF-USER5-SELECT OCCURS 3 TIMES
  1807                                            PIC X(10).
  1808         16  CF-REINS-CNTL-OPT.
  1809             20  CF-REINS-OPT-SEQ           PIC 9.
  1810                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1811                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  33
* EL201.cbl
  1812             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1813                 24  CF-REINS-PRIME         PIC XXX.
  1814                 24  CF-REINS-SUB           PIC XXX.
  1815
  1816         16  CF-AGENT-CNTL-OPT.
  1817             20  CF-AGENT-OPT-SEQ           PIC 9.
  1818                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1819                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1820             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1821                                            PIC X(10).
  1822
  1823         16  FILLER                         PIC X(43).
  1824
  1825         16  CF-LOSS-RATIO-SELECT.
  1826             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1827             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1828         16  CF-ENTRY-DATE-SELECT.
  1829             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1830             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1831         16  CF-EFFECTIVE-DATE-SELECT.
  1832             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1833             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1834
  1835         16  CF-EXCEPTION-LIST-IND          PIC X.
  1836             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1837
  1838         16  FILLER                         PIC X(318).
  1839
  1840****************************************************************
  1841*                  EXCEPTION REPORTING RECORD                  *
  1842****************************************************************
  1843
  1844     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1845         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1846             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1847
  1848         16  CF-COMBINED-LIFE-AH-OPT.
  1849             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1850             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1851             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1852             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1853
  1854         16  CF-LIFE-OPT.
  1855             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1856             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1857             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1858             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1859             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1860             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1861             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1862             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1863             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1864             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1865
  1866         16  CF-AH-OPT.
  1867             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1868             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1869             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  34
* EL201.cbl
  1870             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1871             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1872             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1873             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1874             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1875             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1876             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1877
  1878         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1879             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1880             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1881             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1882
  1883         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1884
  1885         16  FILLER                         PIC X(673).
  1886
  1887
  1888****************************************************************
  1889*             MORTGAGE SYSTEM PLAN RECORD                      *
  1890****************************************************************
  1891
  1892     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1893         16  CF-PLAN-TYPE                   PIC X.
  1894             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1895             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1896             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1897         16  CF-PLAN-ABBREV                 PIC XXX.
  1898         16  CF-PLAN-DESCRIPT               PIC X(10).
  1899         16  CF-PLAN-NOTES                  PIC X(20).
  1900         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1901         16  CF-PLAN-UNDERWRITING.
  1902             20  CF-PLAN-TERM-DATA.
  1903                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1904                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1905             20  CF-PLAN-AGE-DATA.
  1906                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1907                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1908                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1909             20  CF-PLAN-BENEFIT-DATA.
  1910                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1911                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1912                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1913                                            PIC S9(7)V99  COMP-3.
  1914         16  CF-PLAN-POLICY-FORMS.
  1915             20  CF-POLICY-FORM             PIC X(12).
  1916             20  CF-MASTER-APPLICATION      PIC X(12).
  1917             20  CF-MASTER-POLICY           PIC X(12).
  1918         16  CF-PLAN-RATING.
  1919             20  CF-RATE-CODE               PIC X(5).
  1920             20  CF-SEX-RATING              PIC X.
  1921                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1922                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1923             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1924             20  CF-SUB-STD-TYPE            PIC X.
  1925                 88  CF-PCT-OF-PREM            VALUE '1'.
  1926                 88  CF-PCT-OF-BENE            VALUE '2'.
  1927         16  CF-PLAN-PREM-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  35
* EL201.cbl
  1928             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1929             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1930         16  CF-PLAN-PYMT-TOLERANCES.
  1931             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1932             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1933         16  CF-PLAN-MISC-DATA.
  1934             20  FILLER                     PIC X.
  1935             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1936             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1937         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1938         16  CF-PLAN-IND-GRP                PIC X.
  1939             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1940                                                     '1'.
  1941             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1942                                                     '2'.
  1943         16  CF-MIB-SEARCH-SW               PIC X.
  1944             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1945             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1946             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1947             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1948         16  CF-ALPHA-SEARCH-SW             PIC X.
  1949             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1950             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1951             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1952             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1953             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1954             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1955             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1956             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1957             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1958             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1959                                                     'A' 'B' 'C'
  1960                                                     'X' 'Y' 'Z'.
  1961         16  CF-EFF-DT-RULE-SW              PIC X.
  1962             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1963             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1964             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1965             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1966             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1967         16  FILLER                         PIC X(4).
  1968         16  CF-HEALTH-QUESTIONS            PIC X.
  1969             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1970         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1971         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1972         16  CF-PLAN-SNGL-JNT               PIC X.
  1973             88  CF-COMBINED-PLAN              VALUE 'C'.
  1974             88  CF-JNT-PLAN                   VALUE 'J'.
  1975             88  CF-SNGL-PLAN                  VALUE 'S'.
  1976         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1977         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1978         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1979         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1980         16  CF-RERATE-CNTL                 PIC  X.
  1981             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1982             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1983             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1984             88  CF-AUTO-RECALC                 VALUE '4'.
  1985         16  CF-BENEFIT-TYPE                PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  36
* EL201.cbl
  1986             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1987             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1988         16  CF-POLICY-FEE                  PIC S999V99
  1989                                                    COMP-3.
  1990         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1991         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1992         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1993         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1994         16  FILLER                         PIC  X(32).
  1995         16  CF-TERMINATION-FORM            PIC  X(04).
  1996         16  FILLER                         PIC  X(08).
  1997         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1998                                                       COMP-3.
  1999         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2000         16  CF-ISSUE-LETTER                PIC  X(4).
  2001         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2002         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2003             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2004             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2005         16  CF-MP-REFUND-CALC              PIC X.
  2006             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2007             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2008             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2009             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2010             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2011             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2012             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2013             88  CF-MP-REFD-MEAN                VALUE '8'.
  2014         16  CF-ALT-RATE-CODE               PIC  X(5).
  2015
  2016
  2017         16  FILLER                         PIC X(498).
  2018****************************************************************
  2019*             MORTGAGE COMPANY MASTER RECORD                   *
  2020****************************************************************
  2021
  2022     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2023         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2024         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2025             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2026             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2027             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2028             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2029             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2030
  2031         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2032         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2033         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2034         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2035         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2036
  2037         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2038             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2039         16  CF-MP-RECON-USE-IND            PIC X(1).
  2040             88  CF-MP-USE-RECON             VALUE 'Y'.
  2041         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2042             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2043         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  37
* EL201.cbl
  2044             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2045             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2046         16  FILLER                         PIC X(1).
  2047         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2048             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2049         16  CF-MORTG-MIB-VERSION           PIC X.
  2050             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2051             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2052             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2053         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2054             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2055                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2056             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2057                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2058             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2059                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2060             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2061                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2062             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2063                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2064             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2065                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2066         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2067         16  FILLER                         PIC X(7).
  2068         16  CF-MORTG-DESTINATION-SYMBOL.
  2069             20  CF-MORTG-MIB-COMM          PIC X(5).
  2070             20  CF-MORTG-MIB-TERM          PIC X(5).
  2071         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2072             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2073         16  FILLER                         PIC X(03).
  2074         16  CF-MP-CHECK-NO-CONTROL.
  2075             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2076                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2077                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2078                                                ' ' LOW-VALUES.
  2079                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2080                                               VALUE '3'.
  2081         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2082         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2083         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2084             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2085                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2086             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2087                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2088             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2089                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2090             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2091                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2092             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2093                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2094             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2095                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2096         16  CF-MORTG-BILLING-AREA.
  2097             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2098                                            PIC X.
  2099         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2100         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2101         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  38
* EL201.cbl
  2102         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2103             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2104             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2105         16  FILLER                         PIC X.
  2106         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2107             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2108             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2109         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2110         16  FILLER                         PIC X(8).
  2111         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2112         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2113         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2114         16  CF-ACH-COMPANY-ID.
  2115             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2116                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2117                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2118                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2119             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2120         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2121             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2122         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2123             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2124             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2125         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2126         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2127         16  FILLER                         PIC X(536).
  2128
  2129****************************************************************
  2130*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2131****************************************************************
  2132
  2133     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2134         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2135             20  CF-FEMALE-HEIGHT.
  2136                 24  CF-FEMALE-FT           PIC 99.
  2137                 24  CF-FEMALE-IN           PIC 99.
  2138             20  CF-FEMALE-MIN-WT           PIC 999.
  2139             20  CF-FEMALE-MAX-WT           PIC 999.
  2140         16  FILLER                         PIC X(428).
  2141
  2142     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2143         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2144             20  CF-MALE-HEIGHT.
  2145                 24  CF-MALE-FT             PIC 99.
  2146                 24  CF-MALE-IN             PIC 99.
  2147             20  CF-MALE-MIN-WT             PIC 999.
  2148             20  CF-MALE-MAX-WT             PIC 999.
  2149         16  FILLER                         PIC X(428).
  2150******************************************************************
  2151*             AUTOMATIC ACTIVITY RECORD                          *
  2152******************************************************************
  2153     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2154         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2155             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2156             20  CF-SYS-LETTER-ID           PIC X(04).
  2157             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2158             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2159             20  CF-SYS-RESET-SW            PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  39
* EL201.cbl
  2160             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2161             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2162
  2163         16  FILLER                         PIC X(50).
  2164
  2165         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2166             20  CF-USER-ACTIVE-SW          PIC X(01).
  2167             20  CF-USER-LETTER-ID          PIC X(04).
  2168             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2169             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2170             20  CF-USER-RESET-SW           PIC X(01).
  2171             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2172             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2173             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2174
  2175         16  FILLER                         PIC X(246).
  2176 01  ws-heading1.
  2177     05  ws-head1                pic x(120)  value '
  2178-     '                                   DAILY CHECK RECONCILIATI
  2179-     'ON                                            '.
  2180     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2181 01  ws-heading2.
  2182     05  filler                  pic x(45) value spaces.
  2183     05  WS-H2-CLIENT-NAME       PIC X(65) VALUE SPACES.
  2184     05  WS-H2-DATE              PIC X(10).
  2185     05  ws-h2-time              pic x(8).
  2186 01  ws-heading3.
  2187     05  filler                  pic x(53) value spaces.
  2188     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2189     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2190     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2191 01  ws-heading4.
  2192     05  filler                  pic x(117)   value ' CAR  GROUP
  2193-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2194-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2195 01  ws-hd1-written.
  2196     05  filler                  pic x(120)  value '
  2197-     '                                   DAILY WRITTEN CHECKS REP
  2198-     'ORT                                           '.
  2199 01  ws-hd4-written.
  2200     05  filler                  pic x(117)   value ' CAR  GROUP
  2201-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2202-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2203 01  ws-detail1.
  2204     05  filler                  pic xx value '  '.
  2205     05  ws-d1-carr              pic x(4).
  2206     05  ws-d1-grp               pic x(7).
  2207     05  ws-d1-state             pic x(4).
  2208     05  ws-d1-account           pic x(12).
  2209     05  ws-d1-eff-dt            pic x(12).
  2210     05  ws-d1-cert-no           pic x(14).
  2211     05  ws-d1-chk-type          pic x(5).
  2212     05  ws-d1-chk-no            pic x(12).
  2213     05  f                       pic xx.
  2214     05  ws-d1-writ-cash-dt      pic x(16).
  2215     05  ws-d1-preparer          pic x(8).
  2216     05  ws-d1-chk-amt-a         pic x(10).
  2217     05  ws-d1-chk-amt redefines
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  40
* EL201.cbl
  2218         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2219     05  filler                  pic xx.
  2220     05  ws-d1-message           pic x(20).
  2221 01  ws-detail2.
  2222     05  filler                  pic x(12) value '    PAYEE - '.
  2223     05  ws-d2-addr-line         pic x(120) value spaces.
  2224 01  ws-total1.
  2225     05  filler                  pic x(5) value '     '.
  2226     05  ws-t1-cnt               pic zzzz9  value zeros.
  2227     05  ws-t1-chks              pic x(24)  value spaces.
  2228     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2229 01  w-doctoken                  pic x(16).
  2230 01 output-data.
  2231    05  filler                   pic x(6) value "TITLE=".
  2232    05  output-title             pic x(26) value 'Check Posting'.
  2233    05  filler                   pic x(8) value "&COMPID=".
  2234    05  out-comp-id              pic xxx.
  2235    05  filler                   pic x(5) value "&MSG=".
  2236    05  output-msg               pic x(50).
  2237 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2238     'cd /apps/prod/cid1p/jcl'.
  2239 01  TRAN-DATA-LINE2.
  2240     05  filler                  pic x(10) value 'unikixjob '.
  2241     05  tdl2-job                pic x(8) value 'cilg201b'.
  2242     05  filler                  pic x(9) value ' -k cid1p'.
  2243     05  filler                  pic x(51) value spaces.
  2244****************************************************************
  2245*
  2246* Copyright (c) 2007 by Clerity Solutions, Inc.
  2247* All rights reserved.
  2248*
  2249****************************************************************
  2250 01  DFHEIV.
  2251   02  DFHEIV0               PIC X(35).
  2252   02  DFHEIV1               PIC X(08).
  2253   02  DFHEIV2               PIC X(08).
  2254   02  DFHEIV3               PIC X(08).
  2255   02  DFHEIV4               PIC X(06).
  2256   02  DFHEIV5               PIC X(04).
  2257   02  DFHEIV6               PIC X(04).
  2258   02  DFHEIV7               PIC X(02).
  2259   02  DFHEIV8               PIC X(02).
  2260   02  DFHEIV9               PIC X(01).
  2261   02  DFHEIV10              PIC S9(7) COMP-3.
  2262   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2263   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2264   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2265   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2266   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2267   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2268   02  DFHEIV17              PIC X(04).
  2269   02  DFHEIV18              PIC X(04).
  2270   02  DFHEIV19              PIC X(04).
  2271   02  DFHEIV20              USAGE IS POINTER.
  2272   02  DFHEIV21              USAGE IS POINTER.
  2273   02  DFHEIV22              USAGE IS POINTER.
  2274   02  DFHEIV23              USAGE IS POINTER.
  2275   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  41
* EL201.cbl
  2276   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2277   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2278   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2279   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2280   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2281   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2282   02  FILLER                PIC X(02).
  2283   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2284   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2285   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2286   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2287   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2288 LINKAGE  SECTION.
  2289*****************************************************************
  2290*                                                               *
  2291* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2292* All rights reserved.                                          *
  2293*                                                               *
  2294*****************************************************************
  2295 01  dfheiblk.
  2296     02  eibtime          pic s9(7) comp-3.
  2297     02  eibdate          pic s9(7) comp-3.
  2298     02  eibtrnid         pic x(4).
  2299     02  eibtaskn         pic s9(7) comp-3.
  2300     02  eibtrmid         pic x(4).
  2301     02  dfheigdi         pic s9(4) comp.
  2302     02  eibcposn         pic s9(4) comp.
  2303     02  eibcalen         pic s9(4) comp.
  2304     02  eibaid           pic x(1).
  2305     02  eibfiller1       pic x(1).
  2306     02  eibfn            pic x(2).
  2307     02  eibfiller2       pic x(2).
  2308     02  eibrcode         pic x(6).
  2309     02  eibfiller3       pic x(2).
  2310     02  eibds            pic x(8).
  2311     02  eibreqid         pic x(8).
  2312     02  eibrsrce         pic x(8).
  2313     02  eibsync          pic x(1).
  2314     02  eibfree          pic x(1).
  2315     02  eibrecv          pic x(1).
  2316     02  eibsend          pic x(1).
  2317     02  eibatt           pic x(1).
  2318     02  eibeoc           pic x(1).
  2319     02  eibfmh           pic x(1).
  2320     02  eibcompl         pic x(1).
  2321     02  eibsig           pic x(1).
  2322     02  eibconf          pic x(1).
  2323     02  eiberr           pic x(1).
  2324     02  eibrldbk         pic x(1).
  2325     02  eiberrcd         pic x(4).
  2326     02  eibsynrb         pic x(1).
  2327     02  eibnodat         pic x(1).
  2328     02  eibfiller5       pic x(2).
  2329     02  eibresp          pic 9(09) comp.
  2330     02  eibresp2         pic 9(09) comp.
  2331     02  dfheigdj         pic s9(4) comp.
  2332     02  dfheigdk         pic s9(4) comp.
  2333 01  DFHCOMMAREA       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  42
* EL201.cbl
  2334 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2335 0000-DFHEXIT SECTION.
  2336     MOVE '9#                    $   ' TO DFHEIV0.
  2337     MOVE 'EL201' TO DFHEIV1.
  2338     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2339***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2340***                                                            ***
  2341***  Even though this program is using WEB Servies we don't    ***
  2342***  have any form fields to browse through, we are getting    ***
  2343***  the information we need through the variables that are    ***
  2344***  included in the URL. These variables are retrieved by     ***
  2345***  the           exec cics web extract                       ***
  2346***                   querystring  (data-value)                ***
  2347***                   querystrlen  (data-value)                ***
  2348***                end-exec                                    ***
  2349***  BTW, you must provide the length it isn't passed to you.  ***
  2350***  Allow for extra on the length or you will get a length    ***
  2351***  error instead of just truncation.                         ***
  2352***                                                            ***
  2353***  This program is expecting                                 ***
  2354*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2355***                                                            ***
  2356***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2357     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2358     move ws-fn-cymd             to dc-greg-date-cymd
  2359     move 'L'                    to dc-option-code
  2360     perform 9700-date-convert   thru 9700-exit
  2361     if no-conversion-error
  2362        move dc-greg-date-1-alpha to ws-h3-date
  2363        move dc-greg-date-1-edit to ws-h2-date
  2364     else
  2365        display ' error current dt invalid ' dc-error-code
  2366     end-if
  2367     string ws-fn-hours   ':'
  2368            ws-fn-minutes ':'
  2369            ws-fn-seconds
  2370        delimited by size into ws-h2-time
  2371     end-string
  2372
  2373* exec cics web extract
  2374*       querystring  (ws-qry-string)
  2375*       querystrlen  (ws-qrystr-len)
  2376*    end-exec
  2377*    MOVE 'X0  QL                .   #00002275' TO DFHEIV0
  2378     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2379     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2380     MOVE X'2020233030303032323735' TO DFHEIV0(25:11)
  2381     CALL 'kxdfhei1' USING DFHEIV0,
  2382           DFHEIV99,
  2383           DFHEIV99,
  2384           ws-qry-string,
  2385           ws-qrystr-len,
  2386           DFHEIV99,
  2387           DFHEIV99,
  2388           DFHEIV99,
  2389           DFHEIV99,
  2390           DFHEIV99,
  2391           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  43
* EL201.cbl
  2392           DFHEIV99,
  2393           DFHEIV99,
  2394           DFHEIV99
  2395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2396     move ws-qry-string (6:3)    to ws-comp-id
  2397                                    out-comp-id
  2398     move 'Successful Run   '    to output-msg
  2399     move ws-comp-id             to elcntl-key
  2400     move '1'                    to elcntl-rec-type
  2401     move +0                     to elcntl-seq
  2402
  2403* exec cics read
  2404*       dataset  ('ELCNTL')
  2405*       into     (control-file)
  2406*       ridfld   (elcntl-key)
  2407*       resp     (ws-response)
  2408*    end-exec
  2409     MOVE LENGTH OF
  2410      control-file
  2411       TO DFHEIV11
  2412     MOVE 'ELCNTL' TO DFHEIV1
  2413*    MOVE '&"IL       E          (  N#00002285' TO DFHEIV0
  2414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2416     MOVE X'204E233030303032323835' TO DFHEIV0(25:11)
  2417     CALL 'kxdfhei1' USING DFHEIV0,
  2418           DFHEIV1,
  2419           control-file,
  2420           DFHEIV11,
  2421           elcntl-key,
  2422           DFHEIV99,
  2423           DFHEIV99,
  2424           DFHEIV99
  2425     MOVE EIBRESP  TO ws-response
  2426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2427     if resp-normal
  2428        move cf-cl-mail-to-name  to ws-h2-client-name
  2429        move cf-company-cd       to ws-comp-cd
  2430     else
  2431        move 'Company Rec not found ' to ws-h2-client-name
  2432                                         output-msg
  2433        display ' error elcntl read ' ws-response ' '
  2434           elcntl-key (1:8)
  2435        go to 0000-return
  2436     end-if
  2437     evaluate true
  2438        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2439           set process-written      to true
  2440           perform 2000-process-written
  2441                                 thru 2000-exit
  2442        when other
  2443           move 'Invalid File ' to output-msg
  2444     end-evaluate
  2445     if connected-to-db
  2446        EXEC SQL
  2447            commit work release
  2448        END-EXEC
  2449        if sqlcode not = 0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  44
* EL201.cbl
  2450           move ' Failed to Commit DB '
  2451                                 to output-msg
  2452           display "Error: commit release "
  2453           display ' sql return code ' sqlcode
  2454           display ' sql err mess    ' sqlerrmc
  2455        end-if
  2456     end-if
  2457     .
  2458 0000-return.
  2459     perform 1030-send-form      thru 1030-exit
  2460
  2461* exec cics
  2462*       return
  2463*    end-exec
  2464*    MOVE '.(                    ''   #00002324' TO DFHEIV0
  2465     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2466     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2467     MOVE X'2020233030303032333234' TO DFHEIV0(25:11)
  2468     CALL 'kxdfhei1' USING DFHEIV0,
  2469           DFHEIV99,
  2470           DFHEIV99,
  2471           DFHEIV99,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99
  2475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2476     .
  2477 1000-CONNECT-DB.
  2478     move 'NTCSO2_ChkApprv'      to svr
  2479     move 'sa'                   to usr
  2480     move 'ntcso2'               to pass
  2481     string
  2482         usr delimited space
  2483         "." delimited size
  2484         pass delimited space into usr-pass
  2485     end-string
  2486     EXEC SQL
  2487        CONNECT TO :svr USER :usr-pass
  2488     END-EXEC
  2489     if sqlcode not = 0
  2490        display "Error: cannot connect "
  2491        display sqlcode
  2492        display sqlerrmc
  2493        move 'Failed to connect to DB'
  2494                                 to output-msg
  2495        go to 0000-return
  2496     else
  2497        set connected-to-db to true
  2498     end-if
  2499     .
  2500 1000-EXIT.
  2501     EXIT.
  2502 1020-read-erchek.
  2503     move ws-comp-cd             to ch-company-cd
  2504     move db-carrier             to ch-carrier
  2505     move db-grouping            to ch-grouping
  2506     move db-state               to ch-state
  2507     move db-account             to ch-account
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  45
* EL201.cbl
  2508     move db-certificate         to ch-cert-prime
  2509     move db-cert-sfx            to ch-cert-sfx
  2510     string db-effdate (1:4)
  2511            db-effdate (6:2)
  2512            db-effdate (9:2)
  2513        delimited by size into dc-greg-date-cymd-r
  2514     end-string
  2515     move 'L'                    to dc-option-code
  2516     perform 9700-date-convert   thru 9700-exit
  2517     if no-conversion-error
  2518        move dc-bin-date-1       to ch-cert-eff-dt
  2519     else
  2520        display ' error cvtdte eff dt ' db-effdate ' '
  2521           dc-error-code
  2522     end-if
  2523     move zeros                  to ws-seq-alpha
  2524     move +5                     to s2
  2525     perform varying s1 from +5 by -1 until s1 < +1
  2526        if db-seq-no (s1:1) numeric
  2527           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2528           subtract +1 from s2
  2529        end-if
  2530     end-perform
  2531     move ws-seq-no-num          to ch-sequence-no
  2532*    display ' dte   **' db-effdate '**'
  2533*    display ' carrier ' ch-carrier
  2534*    display ' group   ' ch-grouping
  2535*    display ' state   ' ch-state
  2536*    display ' acct    ' ch-account
  2537*    display ' cert  **' ch-cert-no '**'
  2538*    display ' seq     ' ch-sequence-no
  2539
  2540* exec cics read
  2541*       update
  2542*       dataset    ('ERCHEK')
  2543*       into       (check-records)
  2544*       ridfld     (ch-control-primary)
  2545*       resp       (ws-response)
  2546*    end-exec
  2547     MOVE LENGTH OF
  2548      check-records
  2549       TO DFHEIV11
  2550     MOVE 'ERCHEK' TO DFHEIV1
  2551*    MOVE '&"IL       EU         (  N#00002390' TO DFHEIV0
  2552     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2553     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2554     MOVE X'204E233030303032333930' TO DFHEIV0(25:11)
  2555     CALL 'kxdfhei1' USING DFHEIV0,
  2556           DFHEIV1,
  2557           check-records,
  2558           DFHEIV11,
  2559           ch-control-primary,
  2560           DFHEIV99,
  2561           DFHEIV99,
  2562           DFHEIV99
  2563     MOVE EIBRESP  TO ws-response
  2564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2565     .
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  46
* EL201.cbl
  2566 1020-exit.
  2567     exit.
  2568 1030-send-form.
  2569
  2570* exec cics document create
  2571*       doctoken   (w-doctoken)
  2572*       template   ('WCHECKS')
  2573*       symbollist (output-data)
  2574*       listlength (length of output-data)
  2575*    end-exec
  2576     MOVE 'WCHECKS'
  2577      TO DFHEIVL0
  2578     MOVE LENGTH OF
  2579      output-data TO DFHEIV16
  2580*    MOVE '\"D tSL               )   #00002401' TO DFHEIV0
  2581     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2582     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2583     MOVE X'2020233030303032343031' TO DFHEIV0(25:11)
  2584     CALL 'kxdfhei1' USING DFHEIV0,
  2585           w-doctoken,
  2586           DFHEIV99,
  2587           DFHEIVL0,
  2588           output-data,
  2589           DFHEIV16,
  2590           DFHEIV99,
  2591           DFHEIV99,
  2592           DFHEIV99
  2593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2594
  2595* exec cics web send
  2596*       doctoken(w-doctoken)
  2597*    end-exec
  2598*    MOVE 'X$D                   *   #00002407' TO DFHEIV0
  2599     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2600     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2601     MOVE X'2020233030303032343037' TO DFHEIV0(25:11)
  2602     CALL 'kxdfhei1' USING DFHEIV0,
  2603           w-doctoken,
  2604           DFHEIV99,
  2605           DFHEIV99,
  2606           DFHEIV99,
  2607           DFHEIV99,
  2608           DFHEIV99,
  2609           DFHEIV99,
  2610           DFHEIV99,
  2611           DFHEIV99
  2612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2613     .
  2614 1030-exit.
  2615     exit.
  2616 1050-disconnect.
  2617     if connected-to-db
  2618        EXEC SQL
  2619            disconnect all
  2620        END-EXEC
  2621        move ' ' to ws-connect-sw
  2622     end-if
  2623     .
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  47
* EL201.cbl
  2624 1050-exit.
  2625     exit.
  2626 2000-process-written.
  2627     perform 2010-open-files     thru 2010-exit
  2628     perform 2020-init           thru 2020-exit
  2629     perform 2050-process-input  thru 2050-exit until
  2630        end-of-input
  2631     move ws-writ-cnt            to ws-t1-cnt
  2632     move ' Written '            to ws-t1-chks
  2633     move ws-tot-writ-amt        to ws-t1-amount
  2634     move spaces                 to cps-written-rpt-rec
  2635     perform 4020-write-a-line   thru 4020-exit
  2636     move ws-total1              to cps-written-rpt-rec
  2637     perform 4020-write-a-line   thru 4020-exit
  2638     perform 2500-close-files    thru 2500-exit
  2639     perform 5000-submit-job     thru 5000-exit
  2640     .
  2641 2000-exit.
  2642     exit.
  2643 2010-open-files.
  2644     move function upper-case(ws-comp-id)
  2645                                 to ws-writ-rpt-comp-id
  2646     if ws-writ-rpt-comp-id = 'AHL'
  2647        move 'miscpymtsahl.csv'  to ws-writ-in-name
  2648     end-if
  2649     open input CPS-WRITTEN-IN
  2650         output CPS-WRITTEN-RPT
  2651     if written-status not = '00'
  2652        display 'error written open ' written-status
  2653        move ' Invalid or missing file '
  2654                                 to output-msg
  2655        go to 0000-return
  2656     end-if
  2657     .
  2658 2010-exit.
  2659     exit.
  2660 2020-init.
  2661     move spaces                 to ws-detail1
  2662     move ws-hd1-written         to ws-head1
  2663     move 'EL201B'               to ws-h1-rpt-id
  2664     move ws-hd4-written         to ws-heading4
  2665     move 'Posting of Written Checks '
  2666                                 to output-title
  2667     if ws-comp-id = 'AHL'
  2668        move 'ahlg201b'          to tdl2-job
  2669     else
  2670        move 'cilg201b'          to tdl2-job
  2671     end-if
  2672     if not connected-to-db
  2673        perform 1000-connect-db  thru 1000-exit
  2674     end-if
  2675***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2676***                                                            ***
  2677**     I do 2 reads to bypass the header record                ***
  2678***                                                            ***
  2679***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2680     perform 2040-read-input     thru 2040-exit
  2681     perform 2040-read-input     thru 2040-exit
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  48
* EL201.cbl
  2682     .
  2683 2020-exit.
  2684     exit.
  2685 2040-read-input.
  2686     read CPS-WRITTEN-IN at end
  2687        set end-of-input   to true
  2688     end-read
  2689     if not end-of-input
  2690        add 1 to ws-in-recs
  2691     end-if
  2692     .
  2693 2040-exit.
  2694     exit.
  2695 2050-process-input.
  2696     unstring cps-written-in-rec
  2697        delimited by ',' into
  2698           wsw-check-no
  2699           wsw-check-dt
  2700           wsw-check-amt
  2701           wsw-vendor-id
  2702           wsw-user-defined
  2703           wsw-voucher-ref
  2704     end-unstring
  2705*    display ' chk no    **' wsw-check-no '**'
  2706*    display ' chk dt    **' wsw-check-dt '**'
  2707*    display ' chk amt   **' wsw-check-amt '**'
  2708*    display ' vend id   **' wsw-vendor-id '**'
  2709*    display ' user def  **' wsw-user-defined '**'
  2710*    display ' vouch ref **' wsw-voucher-ref '**'
  2711     string wsw-check-dt (1:4)
  2712            wsw-check-dt (6:2)
  2713            wsw-check-dt (9:2)
  2714        delimited by size into dc-greg-date-cymd-r
  2715     end-string
  2716     move 'L'                    to dc-option-code
  2717     perform 9700-date-convert   thru 9700-exit
  2718     if no-conversion-error
  2719        move dc-bin-date-1       to ws-bin-check-dt
  2720     else
  2721        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2722           dc-error-code
  2723     end-if
  2724     move spaces                 to wsw-check-key
  2725     perform varying s1 from +30 by -1 until
  2726        (s1 < +1)
  2727        or (wsw-user-defined (s1:1) numeric)
  2728     end-perform
  2729     if s1 > +7
  2730        move wsw-user-defined (s1 - 6:7)
  2731                                 to wsw-check-key
  2732     else
  2733        move 'invalid input '    to ws-d1-message
  2734        go to 2050-continue
  2735     end-if
  2736*    go to 2050-read
  2737     move ' '                    to ws-erchek-sw
  2738                                    ws-table-sw
  2739     perform 2200-get-tbl-row    thru 2200-exit
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  49
* EL201.cbl
  2740     if sqlcode = 0
  2741        set table-found          to true
  2742        perform 1020-read-erchek thru 1020-exit
  2743        if resp-normal
  2744           set erchek-found to true
  2745           perform 2310-upd-erchek
  2746                                 thru 2310-exit
  2747           perform 2320-upd-table thru 2320-exit
  2748        else
  2749           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2750              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2751              ' ' ws-response
  2752           move ' chk rec not found ' to ws-d1-message
  2753        end-if
  2754     else
  2755        move ' tbl row not found ' to ws-d1-message
  2756     end-if
  2757     .
  2758 2050-continue.
  2759     perform 2400-build-print-line thru 2400-exit
  2760     .
  2761 2050-read.
  2762     perform 2040-read-input     thru 2040-exit
  2763     .
  2764 2050-exit.
  2765     exit.
  2766 2200-get-tbl-row.
  2767***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2768***                                                            ***
  2769***  I'm only expecting one row so no cursor is declared       ***
  2770***                                                            ***
  2771***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2772     move ws-comp-id             to ws-compid
  2773     move wsw-check-key-num      to ws-check-key
  2774     move 1                      to ws-type
  2775     exec sql
  2776        SELECT
  2777           CheckKey,
  2778           Company,
  2779           CertCarrier,
  2780           CertGroup,
  2781           CertState,
  2782           CertAccount,
  2783           CertEffDate,
  2784           CertNumber,
  2785           CertNumberSuf,
  2786           CheckSeqNbr,
  2787           CheckType,
  2788           CheckAmount,
  2789           Preparer
  2790        INTO
  2791           :db-checkkey,
  2792           :db-compid,
  2793           :db-carrier,
  2794           :db-grouping,
  2795           :db-state,
  2796           :db-account,
  2797           :db-effdate,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  50
* EL201.cbl
  2798           :db-certificate,
  2799           :db-cert-sfx,
  2800           :db-seq-no,
  2801           :db-type,
  2802           :db-amount,
  2803           :db-preparer
  2804        FROM
  2805           ChkApp_Check
  2806        WHERE
  2807           (CheckKey    = :ws-check-key)
  2808           and (Company = :ws-compid)
  2809     end-exec
  2810     if sqlcode not = 0
  2811        move sqlcode to ws-sql-code
  2812        move ws-sql-code to ws-dis-sql-code
  2813        display ' dis sql code ' ws-dis-sql-code
  2814        display "Error: cannot read row "
  2815        display ' sql return code ' sqlcode
  2816        display ' sql err mess    ' sqlerrmc
  2817     end-if
  2818     .
  2819 2200-exit.
  2820     exit.
  2821 2310-upd-erchek.
  2822     move ws-bin-check-dt        to ch-check-written-dt
  2823     if wsw-check-no (1:1) = '"'
  2824        move wsw-check-no (5:7)  to ch-check-no
  2825     else
  2826        move wsw-check-no (4:7)  to ch-check-no
  2827     end-if
  2828*    move zeros                  to ws-response
  2829
  2830* exec cics rewrite
  2831*       dataset     ('ERCHEK')
  2832*       from        (check-records)
  2833*       resp        (ws-response)
  2834*    end-exec
  2835     MOVE LENGTH OF
  2836      check-records
  2837       TO DFHEIV11
  2838     MOVE 'ERCHEK' TO DFHEIV1
  2839*    MOVE '&& L                  %  N#00002626' TO DFHEIV0
  2840     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2842     MOVE X'204E233030303032363236' TO DFHEIV0(25:11)
  2843     CALL 'kxdfhei1' USING DFHEIV0,
  2844           DFHEIV1,
  2845           check-records,
  2846           DFHEIV11,
  2847           DFHEIV99
  2848     MOVE EIBRESP  TO ws-response
  2849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2850     if resp-normal
  2851        add 1 to ws-writ-cnt
  2852        compute ws-tot-writ-amt =
  2853           ws-tot-writ-amt + ch-amount-paid
  2854        move 'Successful Post '  to ws-d1-message
  2855     else
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  51
* EL201.cbl
  2856        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  2857     end-if
  2858     .
  2859 2310-exit.
  2860     exit.
  2861 2320-upd-table.
  2862     string wsw-check-dt (6:2) '/'
  2863            wsw-check-dt (9:2) '/'
  2864            wsw-check-dt (1:4)
  2865        delimited by size into db-checkdate
  2866     move ch-check-no            to db-checkno
  2867*    move zeros to sqlcode
  2868     EXEC SQL
  2869        UPDATE
  2870           ChkApp_Check
  2871        SET
  2872           CheckNumber = :db-checkno,
  2873           CheckDate = :db-checkdate
  2874        WHERE
  2875           CheckKey = :db-checkkey
  2876     END-EXEC
  2877     if sqlcode not = 0
  2878        move 'Table not updated ' to ws-d1-message
  2879        display "Error: cannot update table   "
  2880        display ' sql retrun code ' sqlcode
  2881        display ' sql err mess    ' sqlerrmc
  2882     end-if
  2883     .
  2884 2320-exit.
  2885     exit.
  2886 2400-build-print-line.
  2887     if table-found
  2888        move db-carrier          to ws-d1-carr
  2889        move db-grouping         to ws-d1-grp
  2890        move db-state            to ws-d1-state
  2891        move db-account          to ws-d1-account
  2892        string
  2893           db-effdate (6:2)   '/'
  2894           db-effdate (9:2)   '/'
  2895           db-effdate (1:4)
  2896           delimited by size into ws-d1-eff-dt
  2897        end-string
  2898        move db-certificate      to ws-d1-cert-no
  2899        move db-cert-sfx         to ws-d1-cert-no (11:1)
  2900        move 'REF'               to ws-d1-chk-type
  2901        move +10                 to s2
  2902        move zeros               to ws-work-amt-alpha
  2903        perform varying s1 from +10 by -1 until s1 < +1
  2904           if db-amount (s1:1) numeric
  2905              move db-amount (s1:1)
  2906                                 to ws-work-amt-alpha (s2:1)
  2907              subtract +1 from s2
  2908           end-if
  2909        end-perform
  2910        move ws-work-amt-num     to ws-d1-chk-amt
  2911        move db-preparer         to ws-d1-preparer
  2912        move db-checkno          to ws-d1-chk-no
  2913        move db-checkdate        to ws-d1-writ-cash-dt
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  52
* EL201.cbl
  2914     else
  2915        move wsw-check-no        to ws-d1-chk-no
  2916     end-if
  2917     perform 4000-write-report   thru 4000-exit
  2918     move spaces                 to ws-detail1
  2919     .
  2920 2400-exit.
  2921     exit.
  2922 2500-close-files.
  2923     close cps-written-in cps-written-rpt
  2924     .
  2925 2500-exit.
  2926     exit.
  2927 4000-write-report.
  2928     if ws-line-cntr > ws-max-lines
  2929        move zeros               to ws-line-cntr
  2930        perform 4010-write-headings thru 4010-exit
  2931     end-if
  2932     move ws-detail1             to cps-written-rpt-rec
  2933     perform 4020-write-a-line   thru 4020-exit
  2934     .
  2935 4000-exit.
  2936     exit.
  2937 4010-write-headings.
  2938     add 1 to ws-page-cntr
  2939     move ws-page-cntr           to ws-h3-page
  2940     move ws-heading1            to cps-written-rpt-rec
  2941     perform 4020-write-a-line   thru 4020-exit
  2942     move ws-heading2            to cps-written-rpt-rec
  2943     perform 4020-write-a-line   thru 4020-exit
  2944     move ws-heading3            to cps-written-rpt-rec
  2945     perform 4020-write-a-line   thru 4020-exit
  2946     move spaces                 to cps-written-rpt-rec
  2947     perform 4020-write-a-line   thru 4020-exit
  2948     move spaces                 to cps-written-rpt-rec
  2949     perform 4020-write-a-line   thru 4020-exit
  2950     move ws-heading4            to cps-written-rpt-rec
  2951     perform 4020-write-a-line   thru 4020-exit
  2952     move spaces                 to cps-written-rpt-rec
  2953     perform 4020-write-a-line   thru 4020-exit
  2954     .
  2955 4010-exit.
  2956     exit.
  2957 4020-write-a-line.
  2958     write cps-written-rpt-rec
  2959     add 1 to ws-line-cntr
  2960     .
  2961 4020-exit.
  2962     exit.
  2963 5000-submit-job.
  2964
  2965* EXEC CICS WRITEQ TD
  2966*       QUEUE ('BTCH')
  2967*       FROM (TRAN-DATA-LINE1)
  2968*       LENGTH (80)
  2969*    END-EXEC
  2970     MOVE 80
  2971       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  53
* EL201.cbl
  2972     MOVE 'BTCH' TO DFHEIV5
  2973*    MOVE '(" L                  &   #00002745' TO DFHEIV0
  2974     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  2975     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2976     MOVE X'2020233030303032373435' TO DFHEIV0(25:11)
  2977     CALL 'kxdfhei1' USING DFHEIV0,
  2978           DFHEIV5,
  2979           TRAN-DATA-LINE1,
  2980           DFHEIV11,
  2981           DFHEIV99,
  2982           DFHEIV99
  2983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2984
  2985* EXEC CICS WRITEQ TD
  2986*       QUEUE ('BTCH')
  2987*       FROM (TRAN-DATA-LINE2)
  2988*       LENGTH (80)
  2989*    END-EXEC
  2990     MOVE 80
  2991       TO DFHEIV11
  2992     MOVE 'BTCH' TO DFHEIV5
  2993*    MOVE '(" L                  &   #00002750' TO DFHEIV0
  2994     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  2995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2996     MOVE X'2020233030303032373530' TO DFHEIV0(25:11)
  2997     CALL 'kxdfhei1' USING DFHEIV0,
  2998           DFHEIV5,
  2999           TRAN-DATA-LINE2,
  3000           DFHEIV11,
  3001           DFHEIV99,
  3002           DFHEIV99
  3003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3004     .
  3005 5000-exit.
  3006     exit.
  3007 9700-DATE-CONVERT.
  3008
  3009* EXEC CICS LINK
  3010*         PROGRAM  ('ELDATCV')
  3011*         COMMAREA (DATE-CONVERSION-DATA)
  3012*         LENGTH   (DC-COMM-LENGTH)
  3013*    END-EXEC.
  3014     MOVE 'ELDATCV' TO DFHEIV1
  3015*    MOVE '."C                   (   #00002759' TO DFHEIV0
  3016     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3018     MOVE X'2020233030303032373539' TO DFHEIV0(25:11)
  3019     CALL 'kxdfhei1' USING DFHEIV0,
  3020           DFHEIV1,
  3021           DATE-CONVERSION-DATA,
  3022           DC-COMM-LENGTH,
  3023           DFHEIV99,
  3024           DFHEIV99,
  3025           DFHEIV99,
  3026           DFHEIV99
  3027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3028
  3029 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-14 11:31 Page  54
* EL201.cbl
  3030      EXIT.
  3031
  3032 9999-DFHBACK SECTION.
  3033     MOVE '9%                    "   ' TO DFHEIV0
  3034     MOVE 'EL201' TO DFHEIV1
  3035     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3036     GOBACK.
  3037 9999-DFHEXIT.
  3038     IF DFHEIGDJ EQUAL 0001
  3039         NEXT SENTENCE.
  3040     MOVE '9%                    "   ' TO DFHEIV0
  3041     MOVE 'EL201' TO DFHEIV1
  3042     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3043     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139268     Code:        8410
