* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49******************************************************************
    50 ENVIRONMENT DIVISION.
    51
    52 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   3
* EL050.cbl
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56
    57 77  FILLER   PIC X(32) VALUE '********************************'.
    58 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    59 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    60
    61 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    62 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    63                                   USAGE POINTER.
    64 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    65 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    67                                   USAGE IS POINTER.
    68 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    69 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    70                                   USAGE IS POINTER.
    71 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79*    COPY ELC50WS.
    80*****************************************************************
    81*                                                               *
    82*                            ELC50WS.                           *
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    84*                            VMOD=2.061.                        *
    85*                                                               *
    86*   THIS IS THE WORKING STORAGE FOR EL050                       *
    87*                                   EL517                       *
    88*****************************************************************
    89******************************************************************
    90*                   C H A N G E   L O G
    91*
    92* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    93*-----------------------------------------------------------------
    94*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    95* EFFECTIVE    NUMBER
    96*-----------------------------------------------------------------
    97* 123102                   PEMA  ADD DCC PROCESSING
    98* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    99* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   100* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   101* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   102* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   103* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   104* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   105* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   106* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   107* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   108* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   109* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   110* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   111* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   4
* EL050.cbl
   112* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   113* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   114* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   115* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   116* 030309  CR2009021700001  PEMA  ADD ER-2883
   117* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   118* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   119* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   120* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   121* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   122* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   123* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   124* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   125* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   127* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   128* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   129* 061412  CR2011022800001  AJRA  NAPERSOFT
   130* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   131* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   132* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   133* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   134* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   135* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   136* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   137*-----------------------------------------------------------------
   138
   139 01  WORK-AREAS.
   140
   141*****************************************************************
   142*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   143*****************************************************************
   144
   145     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   146     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   147     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   148     12  WS-NAME-EDIT-WORK-AREA.
   149         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   150         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   151             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   152         16  WS-WORK-NAME.
   153             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   154             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   155             20  FILLER           PIC X(10)     VALUE SPACES.
   156         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   157             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   158
   159*****************************************************************
   160*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   161*****************************************************************
   162
   163     12  WS-ERRESC-KEY.
   164         16 WS-ERRESC-SEARCH-KEY.
   165             20  WS-ERRESC-COMPANY-CD PIC  X.
   166             20  WS-ERRESC-CARRIER    PIC  X.
   167             20  WS-ERRESC-GROUP      PIC X(6).
   168             20  WS-ERRESC-STATE      PIC XX.
   169             20  WS-ERRESC-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   5
* EL050.cbl
   170         16 WS-ERRESC-RESIDUAL-KEY.
   171             20  WS-ERRESC-AGENT      PIC X(10).
   172             20  WS-ERRESC-RES-STATE  PIC XX.
   173             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   174*                                          YYYYMMDD
   175     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   176     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   177
   178*RESIDENT STATE TAX MASTER(ERRESS)
   179*
   180     12  WS-ERRESS-KEY.
   181         16  WS-ERRESS-COMPANY-CD      PIC  X.
   182         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   183         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   184         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186
   187     12  WS-CONTRACT-DATE              PIC 9(8).
   188*                                          YYYYMMDD
   189     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   190     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   191         16 WS-YEAR-YY                 PIC   9999.
   192         16 FILLER                     PIC 9(4).
   193*                                          YYYYMMDD
   194     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   195     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   196     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   197     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   198
   199     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   200         88  DPRB-1ST-TIME                      VALUE ' '.
   201
   202*****************************************************************
   203*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   204*****************************************************************
   205
   206     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   207     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   208     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   209     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   210     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   211     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   212     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   213     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   214     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   215     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   216         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   217         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   218     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   219         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   220         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   221     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   222
   223     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   224     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   225
   226     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   227     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   6
* EL050.cbl
   228     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   233     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   240     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   241     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   262     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   263     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   264     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   265     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   274     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   275     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   276     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   277     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   278     12  WS-2671-SW               PIC X         VALUE SPACE.
   279     12  WS-2672-SW               PIC X         VALUE SPACE.
   280     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   281         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   282     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   283         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   284     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   285
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   7
* EL050.cbl
   286     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   287         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   288         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   289         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   290         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   291
   292     12  WS-CREDIT-EDIT-CONTROLS.
   293         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   294         16  WS-MIN-AGE           PIC 99                VALUE  0.
   295         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   296         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   297         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   298         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   299
   300     12  WS-AGE-FIELDS.
   301         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   302         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   303         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   304         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   305
   306     12  WS-SAVE-ALLOWABLE-BENEFIT.
   307         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   308         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   309         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   310         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   311         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   312         16  FILLER                      PIC XX.
   313
   314     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   315     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   316     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   317     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   318     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   319     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   320     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   321     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   322     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   323     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   324
   325     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   326     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   327     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   328     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   329     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   330     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   331     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   332     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   333         88  WS-REDUCING              VALUE 'R'.
   334         88  WS-LEVEL                 VALUE 'L' 'P'.
   335     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   336
   337     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   338     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   339     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   340     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   341     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   342     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   343     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   8
* EL050.cbl
   344     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   345     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   346
   347     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   348     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   349     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   350     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   351     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   352     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   353     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   354     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   355     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   356     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   357     12  WS-ACCT-SIG-SW.
   358         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   359         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   360     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   361     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   362     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   364     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   365     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   366     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   367     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   368     12  WS-INITIALS.
   369         16  WS-INIT-1            PIC X         VALUE SPACES.
   370         16  WS-INIT-2            PIC X         VALUE SPACES.
   371
   372     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   373     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   374     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   375     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   376     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   377*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   378     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   380     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   381     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   382     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   383     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   384     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   385     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   386     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   387     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   388     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   389     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   390     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   391     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   392     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   396     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   397     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   398     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   399     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   400******** FLA
   401     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page   9
* EL050.cbl
   402     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   404     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   405     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   406********
   407     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   408     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   409     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   410     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   411     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   412     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   413     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   414     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   415     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   416     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   417
   418     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   419         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   420                                         '0' THRU '9'.
   421
   422     12  NUMBER-OF-MONTHS.
   423         16  SK-MO OCCURS 12 TIMES PIC X.
   424
   425     12  WS-WORK-DATE.
   426         16  WS-YEAR            PIC 99    VALUE 00.
   427         16  WS-MONTH           PIC 99    VALUE 00.
   428         16  WS-DAY             PIC 99    VALUE 00.
   429
   430     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   431     12  WS-WORK-CRIT-DEV       REDEFINES
   432         WS-WORK-LF-CRIT-PER    PIC X(03).
   433
   434     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   435     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   436
   437     12  WS-WORK-DATE-FROM.
   438         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   439         16  FILLER             PIC X  VALUE SPACE.
   440         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   441         16  FILLER             PIC X         VALUE SPACE.
   442         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   443
   444     12  WS-WORK-DATE-THRU.
   445         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   446         16  FILLER             PIC X         VALUE SPACE.
   447         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   448         16  FILLER             PIC X         VALUE SPACE.
   449         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   450
   451     12  WS-LF-INPUT-CD.
   452         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   453         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   454
   455     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   456     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   457         16  WS-AH-INPUT-CD-1   PIC X.
   458         16  WS-AH-INPUT-CD-2-3 PIC XX.
   459
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  10
* EL050.cbl
   460     12  WS-SWITCHES.
   461         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   462         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   463             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   464         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   465             88  BANK-ACCT-FOUND          VALUE 'Y'.
   466         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   467             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   468         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   469             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   470         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   471             88  COMP-MASTER-FOUND        VALUE 'Y'.
   472         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   473             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   474         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   475             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   476         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   477             88  STAT-MASTER-FOUND        VALUE 'Y'.
   478         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   479             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   480         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   481             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   482         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   483             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   484         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   485             88  FORM-MASTER-FOUND        VALUE 'Y'.
   486         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   487             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   488         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   489             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   490         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   491             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   492         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   493             88  NO-BENEFIT-FOUND         VALUE 'N'.
   494         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   495             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   496         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   497             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   498         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   499             88  AH-BENEFIT-FOUND         VALUE ' '.
   500             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   501         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   502             88  LF-BENEFIT-FOUND         VALUE ' '.
   503             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   504         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   505             88  NO-STATE-RECORD          VALUE '1'.
   506         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   507             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   508         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   509             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   510         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   511             88  CERT-WAS-FOUND           VALUE ' '.
   512             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   513         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   514             88  BROWSE-STARTED           VALUE 'Y'.
   515         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   516             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   517         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  11
* EL050.cbl
   518             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   519         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   520             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   521         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   522             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   523         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   524             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   525         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   526             88  APP-CERT-USED            VALUE 'Y' 'A'.
   527         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   528             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   529             88  FIRST-TIME-THROUGH       VALUE '1'.
   530             88  CTBL-NOT-FOUND           VALUE '2'.
   531
   532         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   533             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   534
   535         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   536             88  DLO-ERROR-FOUND          VALUE 'Y'.
   537
   538********FLA
   539     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   540     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   541********
   542     12  RC-SW-1                  PIC X           VALUE '0'.
   543     12  RC-SW-2                  PIC X           VALUE '0'.
   544     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   545     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   546     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   549     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   550     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   551     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   552     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   553     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   554     12  LIT-SPACES               PIC X           VALUE SPACES.
   555     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   556     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   557     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   558     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   559     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   560     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   561     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   562         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   563         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   564     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   565         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   566
   567 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   568     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   569     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   570 01  WS-CRI-SSN-WORK-AREA.
   571     05  WS-CRI-SOC-SEC-NO.
   572         10  WS-SS-REPT-CD       PIC X(5).
   573         10  WS-SS-LAST-NAME     PIC X(5).
   574         10  WS-SS-INITIAL       PIC X.
   575
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  12
* EL050.cbl
   576     05  WS-CRI-REPORT-CODE.
   577         10  FILLER              PIC X(5).
   578         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   579
   580     05  WS-CRI-LAST-NAME.
   581         10  WS-CRI-NAME-MOVE    PIC X(5).
   582         10  FILLER              PIC X(10).
   583
   584 01  WS-NUM-TABLE                PIC X(26)  VALUE
   585     '12345678012345070923456789'.
   586 01  FILLER REDEFINES WS-NUM-TABLE.
   587     05  WS-NUM OCCURS 26        PIC 9.
   588 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   589 01  V1                          PIC S999 COMP-3.
   590 01  V2                          PIC S999 COMP-3.
   591 01  V3                          PIC S999 COMP-3.
   592 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   593 01  FILLER REDEFINES WS-WORK-VIN.
   594     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   595 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   596 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   597 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   598 01  WS-HEX-WORK.
   599     05  FILLER                  PIC X  VALUE LOW-VALUES.
   600     05  WS-HEX-BYTE             PIC X.
   601 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   602 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   603 01  WS-WORK-HIN-ROW-B.
   604     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   605
   606 01  ws-benefit-cd-chg-sw      pic x value spaces.
   607     88  benefit-code-chg           value 'Y'.
   608 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   609 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   610     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   611 01  WS-ROW-D-TABLE.
   612     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   613
   614 01  WS-HIN-TABLE-B.
   615     05  F                       PIC XX VALUE 'A2'.
   616     05  F                       PIC XX VALUE 'B3'.
   617     05  F                       PIC XX VALUE 'C4'.
   618     05  F                       PIC XX VALUE 'D5'.
   619     05  F                       PIC XX VALUE 'E6'.
   620     05  F                       PIC XX VALUE 'F7'.
   621     05  F                       PIC XX VALUE 'G8'.
   622     05  F                       PIC XX VALUE 'H9'.
   623     05  F                       PIC XX VALUE 'I1'.
   624     05  F                       PIC XX VALUE 'J2'.
   625     05  F                       PIC XX VALUE 'K3'.
   626     05  F                       PIC XX VALUE 'L4'.
   627     05  F                       PIC XX VALUE 'M5'.
   628     05  F                       PIC XX VALUE 'N6'.
   629     05  F                       PIC XX VALUE 'O0'.
   630     05  F                       PIC XX VALUE 'P7'.
   631     05  F                       PIC XX VALUE 'Q0'.
   632     05  F                       PIC XX VALUE 'R8'.
   633     05  F                       PIC XX VALUE 'S9'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  13
* EL050.cbl
   634     05  F                       PIC XX VALUE 'T2'.
   635     05  F                       PIC XX VALUE 'U3'.
   636     05  F                       PIC XX VALUE 'V4'.
   637     05  F                       PIC XX VALUE 'W5'.
   638     05  F                       PIC XX VALUE 'X6'.
   639     05  F                       PIC XX VALUE 'Y7'.
   640     05  F                       PIC XX VALUE 'Z8'.
   641 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   642     05  WS-VAL-IN               PIC X.
   643     05  WS-VAL-OUT              PIC 9.
   644 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   645 01  WS-COMPARE-BINARY-DATES.
   646     05  WS-971231                PIC XX VALUE X'92FF'.
   647     05  WS-931231                PIC XX VALUE X'8CFF'.
   648     05  WS-791231                PIC XX VALUE X'77FF'.
   649     05  WS-771001                PIC XX VALUE X'74A1'.
   650     05  WS-820301                PIC XX VALUE X'7B41'.
   651     05  WS-831031                PIC XX VALUE X'7DBF'.
   652     05  WS-831231                PIC XX VALUE X'7DFF'.
   653     05  WS-810831                PIC XX VALUE X'7A7F'.
   654     05  WS-830901                PIC XX VALUE X'7D81'.
   655
   656 01  FILE-ACCESS-IDS.
   657     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   658     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   659     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   660     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   661     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   662     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   663     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   664     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   665     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   666     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   667     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   668     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   669     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   670     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   671     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   672     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   673     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   674 01  DD-IU-SW                    PIC X   VALUE ' '.
   675     88  DD-IU-PRESENT                 VALUE 'Y'.
   676
   677 01  ACCESS-KEYS.
   678     12  ELMSTR-KEY.
   679         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   680         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   681     12  W-CLAIM-KEY.
   682         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   684
   685     12  ELCNTL-KEY.
   686         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   687         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   688         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   689         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   690
   691     12  ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  14
* EL050.cbl
   692         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  CERT-CARRIER         PIC X       VALUE SPACE.
   694         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   695         16  CERT-STATE           PIC XX      VALUE SPACES.
   696         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   697         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   698         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   699
   700     12  ELCERT2-KEY.
   701         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   702         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   703
   704     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   705
   706     12  ELCERT-SAVE.
   707         16  FILLER                      PIC XX    VALUE SPACES.
   708
   709         16  WCS-CONTROL-PRIMARY.
   710             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   711             20  WCS-CARRIER             PIC X     VALUE SPACE.
   712             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   713             20  WCS-STATE               PIC XX    VALUE SPACES.
   714             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   715             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   716             20  WCS-CERT-NO.
   717                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   718                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   719
   720         16  CS-CONTROL-BY-NAME.
   721             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   722             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   723             20  CS-INSURED-INITIALS.
   724                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   725                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-SSN.
   728             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   729             20  CS-SOC-SEC-NO.
   730                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   731                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   732                 24  CS-SSN-LN3.
   733                     28 CS-INSURED-INITIALS-A2   PIC XX
   734                                     VALUE SPACES.
   735                     28 CS-PART-LAST-NAME-A2     PIC X
   736                                     VALUE SPACE.
   737
   738         16  CS-CONTROL-BY-CERT-NO.
   739             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   740             20  CS-CERT-NO-A4           PIC X(11)
   741                                     VALUE SPACES.
   742
   743         16  CS-CONTROL-BY-MEMB.
   744             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   745             20  CS-MEMBER-NO.
   746                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   747                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   748                 24  CS-MEMB-LN4.
   749                     28 CS-INSURED-INITIALS-A5   PIC XX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  15
* EL050.cbl
   750                                      VALUE SPACES.
   751                     28 CS-PART-LAST-NAME-A5     PIC XX
   752                                      VALUE SPACES.
   753
   754         16  FILLER              PIC X(360) VALUE SPACES.
   755
   756     12  ERACCT-KEY.
   757         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   758         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   759         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   760         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   761         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   762         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   763
   764     12  ERCOMP-KEY.
   765         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  COMP-CARRIER         PIC X     VALUE SPACES.
   767         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   768         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   769         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   770         16  COMP-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERLOFC-KEY.
   773         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   774         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   775         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   776         16  LOFC-STATE           PIC XX    VALUE SPACES.
   777         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   779
   780     12  WS-ELCRTT-KEY.
   781         16  WS-ELCRTT-PRIMARY       PIC X(33).
   782         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   783
   784     12  ERBXRF-KEY.
   785         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   787         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   788         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   789
   790     12  ERAGTC-KEY.
   791         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   792         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   793         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   794         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   795         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   796         16  AGTC-TYPE            PIC X     VALUE SPACES.
   797
   798     12  ERPLAN-KEY.
   799         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   801         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   802         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   803         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   804         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   805         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   806         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   807
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  16
* EL050.cbl
   808     12  ERFORM-KEY.
   809         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   811         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   812         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   813
   814     12  ERREIN-KEY.
   815         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   816         16  REIN-TYPE            PIC X     VALUE SPACES.
   817         16  REIN-TABLE-CO.
   818             20  REIN-CODE-1      PIC X     VALUE SPACE.
   819             20  REIN-CODE-2      PIC X     VALUE SPACE.
   820             20  REIN-CODE-3      PIC X     VALUE SPACE.
   821         16  FILLER               PIC X(3)  VALUE SPACES.
   822
   823     12  ERCTBL-KEY.
   824         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   825         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   826         16  CTBL-CNTRL-2.
   827             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   828             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   829
   830     12  ELCRTO-KEY.
   831         16  ELCRTO-COMPANY-CD       PIC X.
   832         16  ELCRTO-CARRIER          PIC X.
   833         16  ELCRTO-GROUPING         PIC X(6).
   834         16  ELCRTO-STATE            PIC XX.
   835         16  ELCRTO-ACCOUNT          PIC X(10).
   836         16  ELCRTO-CERT-EFF-DT      PIC XX.
   837         16  ELCRTO-CERT-NO.
   838             20  ELCRTO-CERT-PRIME   PIC X(10).
   839             20  ELCRTO-CERT-SFX     PIC X.
   840         16  ELCRTO-RECORD-TYPE      PIC X.
   841         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   842
   843
   844     12  WS-ACCESS.
   845         16  FILLER               PIC XX    VALUE SPACES.
   846         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   847
   848     12  WS-CARR-ACCESS.
   849         16  FILLER               PIC X(3)  VALUE SPACES.
   850         16  WS-CARR              PIC X     VALUE SPACE.
   851*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   852*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   853     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   854         88  WS-DMD-LF-RATING   VALUE 'Y'.
   855         88  WS-DMD-AH-RATING   VALUE 'Y'.
   856         88  WS-DMD-NO-RATING   VALUE 'N'.
   857
   858     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   859         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   860                                         'NJ' 'NL'
   861                                         'PJ' 'PL'
   862                                         'SJ' 'SL'.
   863     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   864         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   865                                         'NI' 'NJ' 'NL' 'NU'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  17
* EL050.cbl
   866                                         'PJ' 'PL' 'PI' 'PU'
   867                                         'SI' 'SJ' 'SL' 'SU'
   868                                         'MX' 'MY' 'MZ'.
   869 01  ERPDEF-KEY-SAVE             PIC X(18).
   870 01  ERPDEF-KEY.
   871     12  ERPDEF-COMPANY-CD       PIC X.
   872     12  ERPDEF-STATE            PIC XX.
   873     12  ERPDEF-PROD-CD          PIC XXX.
   874     12  F                       PIC X(7).
   875     12  ERPDEF-BEN-TYPE         PIC X.
   876     12  ERPDEF-BEN-CODE         PIC XX.
   877     12  ERPDEF-EXP-DT           PIC XX.
   878
   879 01  ELSTAT-KEY-SAVE             PIC X(20).
   880 01  ELSTAT-KEY.
   881     12  ELSTAT-COMPANY-ID       PIC XXX.
   882     12  ELSTAT-CARRIER          PIC X.
   883     12  ELSTAT-GROUP            PIC X(6).
   884     12  ELSTAT-STATE            PIC XX.
   885     12  ELSTAT-EXP-DT           PIC 9(8).
   886 01  WS-ERROR-VALUES.
   887     12  ER-1570                     PIC S9(4)   VALUE +1570.
   888     12  ER-1571                     PIC S9(4)   VALUE +1571.
   889     12  er-1572                     pic s9(4)   value +1572.
   890     12  er-1573                     pic s9(4)   value +1573.
   891     12  er-1574                     pic s9(4)   value +1574.
   892     12  ER-1575                     PIC S9(4)   VALUE +1575.
   893     12  ER-1891                     PIC S9(4)   VALUE +1891.
   894     12  ER-1892                     PIC S9(4)   VALUE +1892.
   895     12  ER-1893                     PIC S9(4)   VALUE +1893.
   896     12  ER-1894                     PIC S9(4)   VALUE +1894.
   897     12  ER-1895                     PIC S9(4)   VALUE +1895.
   898     12  ER-1896                     PIC S9(4)   VALUE +1896.
   899     12  ER-1897                     PIC S9(4)   VALUE +1897.
   900     12  ER-1898                     PIC S9(4)   VALUE +1898.
   901     12  ER-1899                     PIC S9(4)   VALUE +1899.
   902     12  ER-1900                     PIC S9(4)   VALUE +1900.
   903     12  ER-1901                     PIC S9(4)   VALUE +1901.
   904     12  ER-1902                     PIC S9(4)   VALUE +1902.
   905     12  ER-1903                     PIC S9(4)   VALUE +1903.
   906     12  ER-1904                     PIC S9(4)   VALUE +1904.
   907     12  ER-1905                     PIC S9(4)   VALUE +1905.
   908     12  ER-1906                     PIC S9(4)   VALUE +1906.
   909     12  ER-1907                     PIC S9(4)   VALUE +1907.
   910     12  ER-1909                     PIC S9(4)   VALUE +1909.
   911     12  ER-1910                     PIC S9(4)   VALUE +1910.
   912     12  ER-1911                     PIC S9(4)   VALUE +1911.
   913     12  ER-1912                     PIC S9(4)   VALUE +1912.
   914     12  ER-1913                     PIC S9(4)   VALUE +1913.
   915     12  ER-1914                     PIC S9(4)   VALUE +1914.
   916     12  ER-1915                     PIC S9(4)   VALUE +1915.
   917     12  ER-1916                     PIC S9(4)   VALUE +1916.
   918     12  ER-1917                     PIC S9(4)   VALUE +1917.
   919     12  ER-1918                     PIC S9(4)   VALUE +1918.
   920     12  ER-1919                     PIC S9(4)   VALUE +1919.
   921     12  ER-1920                     PIC S9(4)   VALUE +1920.
   922     12  ER-1921                     PIC S9(4)   VALUE +1921.
   923     12  ER-1922                     PIC S9(4)   VALUE +1922.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  18
* EL050.cbl
   924     12  ER-1923                     PIC S9(4)   VALUE +1923.
   925     12  ER-1924                     PIC S9(4)   VALUE +1924.
   926     12  ER-1925                     PIC S9(4)   VALUE +1925.
   927     12  ER-1926                     PIC S9(4)   VALUE +1926.
   928     12  ER-1927                     PIC S9(4)   VALUE +1927.
   929     12  ER-2393                     PIC S9(4)   VALUE +2393.
   930     12  ER-2600                     PIC S9(4)   VALUE +2600.
   931     12  ER-2601                     PIC S9(4)   VALUE +2601.
   932     12  ER-2602                     PIC S9(4)   VALUE +2602.
   933     12  ER-2603                     PIC S9(4)   VALUE +2603.
   934     12  ER-2604                     PIC S9(4)   VALUE +2604.
   935     12  ER-2605                     PIC S9(4)   VALUE +2605.
   936     12  ER-2606                     PIC S9(4)   VALUE +2606.
   937     12  ER-2607                     PIC S9(4)   VALUE +2607.
   938     12  ER-2608                     PIC S9(4)   VALUE +2608.
   939     12  ER-2609                     PIC S9(4)   VALUE +2609.
   940     12  ER-2610                     PIC S9(4)   VALUE +2610.
   941     12  ER-2611                     PIC S9(4)   VALUE +2611.
   942     12  ER-2612                     PIC S9(4)   VALUE +2612.
   943     12  ER-2613                     PIC S9(4)   VALUE +2613.
   944     12  ER-2614                     PIC S9(4)   VALUE +2614.
   945     12  ER-2615                     PIC S9(4)   VALUE +2615.
   946     12  ER-2616                     PIC S9(4)   VALUE +2616.
   947     12  ER-2617                     PIC S9(4)   VALUE +2617.
   948     12  ER-2618                     PIC S9(4)   VALUE +2618.
   949     12  ER-2619                     PIC S9(4)   VALUE +2619.
   950     12  ER-2620                     PIC S9(4)   VALUE +2620.
   951     12  ER-2621                     PIC S9(4)   VALUE +2621.
   952     12  ER-2622                     PIC S9(4)   VALUE +2622.
   953     12  ER-2623                     PIC S9(4)   VALUE +2623.
   954     12  ER-2624                     PIC S9(4)   VALUE +2624.
   955     12  ER-2625                     PIC S9(4)   VALUE +2625.
   956     12  ER-2626                     PIC S9(4)   VALUE +2626.
   957     12  ER-2627                     PIC S9(4)   VALUE +2627.
   958     12  ER-2628                     PIC S9(4)   VALUE +2628.
   959     12  ER-2629                     PIC S9(4)   VALUE +2629.
   960     12  ER-2630                     PIC S9(4)   VALUE +2630.
   961     12  ER-2631                     PIC S9(4)   VALUE +2631.
   962     12  ER-2632                     PIC S9(4)   VALUE +2632.
   963     12  ER-2633                     PIC S9(4)   VALUE +2633.
   964     12  ER-2634                     PIC S9(4)   VALUE +2634.
   965     12  ER-2635                     PIC S9(4)   VALUE +2635.
   966     12  ER-2636                     PIC S9(4)   VALUE +2636.
   967     12  ER-2637                     PIC S9(4)   VALUE +2637.
   968     12  ER-2638                     PIC S9(4)   VALUE +2638.
   969     12  ER-2639                     PIC S9(4)   VALUE +2639.
   970     12  ER-2640                     PIC S9(4)   VALUE +2640.
   971     12  ER-2641                     PIC S9(4)   VALUE +2641.
   972     12  ER-2642                     PIC S9(4)   VALUE +2642.
   973     12  ER-2643                     PIC S9(4)   VALUE +2643.
   974     12  ER-2644                     PIC S9(4)   VALUE +2644.
   975     12  ER-2645                     PIC S9(4)   VALUE +2645.
   976     12  ER-2646                     PIC S9(4)   VALUE +2646.
   977     12  ER-2647                     PIC S9(4)   VALUE +2647.
   978     12  ER-2648                     PIC S9(4)   VALUE +2648.
   979     12  ER-2649                     PIC S9(4)   VALUE +2649.
   980     12  ER-2650                     PIC S9(4)   VALUE +2650.
   981     12  ER-2651                     PIC S9(4)   VALUE +2651.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  19
* EL050.cbl
   982     12  ER-2652                     PIC S9(4)   VALUE +2652.
   983     12  ER-2653                     PIC S9(4)   VALUE +2653.
   984     12  ER-2654                     PIC S9(4)   VALUE +2654.
   985     12  ER-2655                     PIC S9(4)   VALUE +2655.
   986     12  ER-2656                     PIC S9(4)   VALUE +2656.
   987     12  ER-2657                     PIC S9(4)   VALUE +2657.
   988     12  ER-2658                     PIC S9(4)   VALUE +2658.
   989     12  ER-2659                     PIC S9(4)   VALUE +2659.
   990     12  ER-2660                     PIC S9(4)   VALUE +2660.
   991     12  ER-2661                     PIC S9(4)   VALUE +2661.
   992     12  ER-2662                     PIC S9(4)   VALUE +2662.
   993     12  ER-2663                     PIC S9(4)   VALUE +2663.
   994     12  ER-2664                     PIC S9(4)   VALUE +2664.
   995     12  ER-2665                     PIC S9(4)   VALUE +2665.
   996     12  ER-2666                     PIC S9(4)   VALUE +2666.
   997     12  ER-2667                     PIC S9(4)   VALUE +2667.
   998     12  ER-2668                     PIC S9(4)   VALUE +2668.
   999     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1000     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1001     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1002     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1003     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1004     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1005     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1006     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1007     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1008     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1009     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1010     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1011     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1012     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1013     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1014     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1015     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1016     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1017     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1018     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1019     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1020     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1021     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1022     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1023     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1024     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1025     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1026     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1027     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1028     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1029     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1030     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1031     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1032     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1033     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1034     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1035     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1036     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1037     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1038     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1039     12  ER-2718                     PIC S9(4)   VALUE +2718.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  20
* EL050.cbl
  1040     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1041     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1042     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1043     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1044     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1045     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1046     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1047     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1048     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1049     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1050     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1051     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1052     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1053     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1054     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1055     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1056     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1057     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1058     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1059     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1060     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1061     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1062     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1063     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1064     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1065     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1066     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1067     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1068     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1069     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1070     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1071     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1072     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1073     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1074     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1075     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1076     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1077     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1078     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1079     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1080     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1081     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1082     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1083     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1084     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1085     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1086     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1087     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1088     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1089     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1090     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1091     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1092     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1093     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1094     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1095     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1096     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1097     12  ER-2777                     PIC S9(4)   VALUE +2777.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  21
* EL050.cbl
  1098     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1099     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1100     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1101     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1102     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1103     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1104     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1105     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1106     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1107     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1108     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1109     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1110     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1111     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1112     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1113     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1114     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1115     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1116     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1117     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1118     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1119     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1120     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1121     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1122     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1123     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1124     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1125     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1126     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1127     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1128     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1129     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1130     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1131     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1132     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1133     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1134     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1135     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1136     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1137     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1138     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1139     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1140     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1141     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1142     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1143     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1144     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1145     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1146     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1147     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1148     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1149     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1150     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1151     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1152     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1153     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1154     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1155     12  ER-7818                     PIC S9(4)   VALUE +7818.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  22
* EL050.cbl
  1156     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1157     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1158     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1159     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1160     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1161     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1162     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1163     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1164     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1165     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1166     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1167     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1168     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1169     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1170     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1171     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1172     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1173     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1174     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1175     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1176     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1177     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1178     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1179     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1180     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1181     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1182     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1183     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1184     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1185     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1186     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1187     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1188     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1189     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1190     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1191     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1192     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1193     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1194     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1195     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1196     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1197     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1198     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1199     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1200     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1201     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1202     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1203     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1204     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1205     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1206     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1207     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1208     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1209     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1210     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1211     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1212     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1213     12  ER-8148                     PIC S9(4)   VALUE +8148.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  23
* EL050.cbl
  1214     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1215     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1216     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1217     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1218     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1219     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1220     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1221     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1222     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1223     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1224     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1225     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1226     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1227     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1228     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1229     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1230     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1231     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1232     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1233******************************************************************
  1234***************   END OF ELC50WS     ****************************
  1235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  24
* EL050.cbl
  1238 01  WORKING-STORAGE-WORK-AREAS.
  1239     12  WS-RESPONSE             PIC S9(8)  COMP.
  1240         88  WS-RESP-NORMAL           VALUE +00.
  1241         88  WS-RESP-ERROR            VALUE +01.
  1242         88  WS-RESP-NOTFND           VALUE +13.
  1243         88  WS-RESP-DUPREC           VALUE +14.
  1244         88  WS-RESP-ENDFILE          VALUE +20.
  1245     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1246     12  WORK-AREAS.
  1247         16  WK-CONV-GREG.
  1248             24  WCG-CENT             PIC XX.
  1249             24  WCG-REST             PIC X(4).
  1250         16  WORK-GREGORIAN-DATE.
  1251             24  WK-GREG-CENT         PIC XX.
  1252             24  WK-GREG-DATE-YYMMDD.
  1253                 28  WK-GREG-YYMM     PIC X(4).
  1254                 28  WK-GREG-DD       PIC XX.
  1255
  1256         16  WORK-SELECT-DATE.
  1257             24  WK-SELECT-CENT            PIC XX.
  1258             24  WK-SELECT-DATE-YYMMDD.
  1259                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1260                 28  FILLER                PIC XX.
  1261
  1262         16  WK-FORM-NO.
  1263             24  WK-FORM-BANK-ID       PIC X(5).
  1264             24  WK-FORM-UNDRWRTR      PIC X(1).
  1265             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1266
  1267         16  WK-MEMBER-NO.
  1268             24  WK-MEMBER-1-6        PIC X(6).
  1269             24  WK-MEMBER-7-12       PIC X(6).
  1270
  1271         16  WK-FULL-CERT-NO.
  1272             24  WK-CERT-POS-1-2      PIC X(2).
  1273             24  WK-CERT-POS-3        PIC X(1).
  1274             24  WK-CERT-POS-4        PIC X(1).
  1275             24  WK-CERT-POS-5-6      PIC X(2).
  1276             24  WK-CERT-POS-7        PIC X(1).
  1277             24  WK-CERT-POS-8-11     PIC X(4).
  1278
  1279         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1280             88  VALID-RATE-CODE        VALUE 'Y'.
  1281             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1282
  1283         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1284         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1285         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1286         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1287         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1288         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1289         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1290         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1291         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1292         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1293
  1294* DLO001
  1295 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  25
* EL050.cbl
  1296     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1297     12  DMPF-RETURN-CODE          PIC XX.
  1298         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1299         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1300         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1301         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1302         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1303         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1304
  1305* DLO002
  1306 01  WS-DLO-INTERNAL-POLICY-FORM.
  1307     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1308     12  DIPF-RETURN-CODE          PIC XX.
  1309         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1310         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1311         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1312         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1313         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1314         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1315
  1316* DLO003
  1317 01  WS-DLO-VALID-BANK-ID.
  1318     12  DVBI-BANK-ID              PIC X(5).
  1319     12  DVBI-BANK-ID-TYPE         PIC X.
  1320         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1321         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1322         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1323         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1324         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1325     12  DVBI-RETURN-CODE          PIC XX.
  1326         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1327         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1328         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1329         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1330         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1331         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1332         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1333         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1334         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO007
  1337 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1338     12  DCUA-RES-STATE            PIC XX.
  1339     12  DCUA-BEN-TYPE             PIC XX.
  1340     12  DCUA-SYS-IDENT            PIC X.
  1341         88  DCUA-CLAIM                        VALUE 'C'.
  1342         88  DCUA-PREMIUM                      VALUE 'P'.
  1343     12  DCUA-COVERAGE-RULE        PIC X.
  1344     12  DCUA-CLIENT-ID            PIC X(10).
  1345     12  DCUA-EFF-DATE             PIC X(8).
  1346     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1347     12  DCUA-RETURN-CODE          PIC XX.
  1348         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1349     12  DCUA-CERT-NUMBER          PIC X(11).
  1350     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1351     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1352
  1353* DLO011
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  26
* EL050.cbl
  1354 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1355     12  DPRB-RATE-CODE            PIC X(4).
  1356     12  DPRB-COVERAGE-CATEG       PIC X.
  1357     12  DPRB-RETURN-CODE          PIC XX.
  1358         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1359         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1360         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1361         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1362         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1363         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1364         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1365         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1366         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1367     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1368     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1369     12  DPRB-BEN-TYPE             PIC XX.
  1370
  1371* DLO017
  1372 01  WS-DLO-VALID-RATE-CODE.
  1373     12  DVRC-RATE-CODE            PIC X(4).
  1374     12  DVRC-RETURN-CODE          PIC XX.
  1375         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1376         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1377         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1378         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1379         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1380         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1381
  1382* DLO019
  1383 01  WS-DLO-ORIG-COV-CAT.
  1384     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1385     12  DOCC-RETURN-CODE          PIC XX.
  1386     12  DOCC-ORIG-COV-CAT         PIC X.
  1387     12  DOCC-UNDERWITER           PIC XX.
  1388     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1389     12  DOCC-FILLER               PIC X(6).
  1390
  1391* DLO021
  1392 01  WS-DLO-VALID-LOAN-OFFICER.
  1393     12  DVLO-LOAN-OFFICER.
  1394         16  DVLO-BILL-TYPE        PIC X.
  1395         16  DVLO-BILL-SOURCE      PIC X.
  1396         16  DVLO-BATCH-TYPE       PIC X.
  1397     12  DVLO-RETURN-CODE          PIC XX.
  1398         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1399         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1400         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1401         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1402         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1403         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1404
  1405* DLO022
  1406 01  WS-DLO-VALID-STATE-CODE.
  1407     12  DVSC-STATE-CODE           PIC XX.
  1408     12  DVSC-RETURN-CODE          PIC XX.
  1409         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1410
  1411* DLO023
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  27
* EL050.cbl
  1412 01  WS-DLO-VALID-CODE-VALUES.
  1413     12  DVCV-SYSTEM-ID            PIC XX.
  1414         88  DVCV-CLAIMS                       VALUE 'CL'.
  1415         88  DVCV-CREDIT                       VALUE 'CR'.
  1416     12  DVCV-RECORD-TYPE          PIC XX.
  1417         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1418         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1419         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1420         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1421         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1422         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1423         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1424         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1425     12  DVCV-RECORD-KEY           PIC X(6).
  1426     12  DVCV-RETURN-CODE          PIC XX.
  1427         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1428         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1429         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1430         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1431         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1432         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1433         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1434     12  DVCV-CODE-DESC            PIC X(60).
  1435     12  DVCV-GEN-DESC-1           PIC X(20).
  1436     12  DVCV-GEN-DESC-2           PIC X(20).
  1437     12  DVCV-GEN-DESC-3           PIC X(20).
  1438
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  28
* EL050.cbl
  1440*    COPY ERCBXRF.
  1441******************************************************************
  1442*                                                                *
  1443*                                                                *
  1444*                            ERCBXRF                             *
  1445*                                                                *
  1446*   ONLINE CREDIT SYSTEM                                         *
  1447*                                                                *
  1448*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1449*                                                                *
  1450*   FILE TYPE = VSAM,KSDS                                        *
  1451*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1452*                                                                *
  1453*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1454*       ALTERNATE PATH = NONE                                    *
  1455*                                                                *
  1456*   LOG = NO                                                     *
  1457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1458*                                                                *
  1459******************************************************************
  1460
  1461 01  BANK-CROSS-REFERENCE.
  1462     12  BK-RECORD-ID                PIC XX.
  1463         88  VALID-BK-ID             VALUE 'BK'.
  1464
  1465     12  BK-CONTROL-PRIMARY.
  1466         16  BK-COMPANY-CD           PIC X.
  1467         16  BK-CARRIER              PIC X.
  1468         16  BK-GROUPING             PIC X(6).
  1469         16  BK-BANK-NO              PIC X(10).
  1470
  1471     12  BK-MAINT-INFORMATION.
  1472         16  BK-LAST-MAINT-DT        PIC XX.
  1473         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1474         16  BK-LAST-MAINT-USER      PIC X(4).
  1475         16  FILLER                  PIC X(9).
  1476
  1477     12  FILLER                      PIC X(37).
  1478
  1479     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1480
  1481     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1482                            DEPENDING ON BK-BANK-POINTER-CNT.
  1483         16  BK-AM-ACCOUNT           PIC X(10).
  1484         16  BK-AM-EXP-DT            PIC XX.
  1485         16  BK-AM-EFF-DT            PIC XX.
  1486         16  BK-AM-STATE             PIC XX.
  1487         16  FILLER                  PIC X(20).
  1488
  1489******************************************************************
  1490
  1491*    COPY ERCCOMP.
  1492******************************************************************
  1493*                                                                *
  1494*                                                                *
  1495*                            ERCCOMP                             *
  1496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1497*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  29
* EL050.cbl
  1498*                                                                *
  1499*   ONLINE CREDIT SYSTEM                                         *
  1500*                                                                *
  1501*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1502*                                                                *
  1503*   FILE TYPE = VSAM,KSDS                                        *
  1504*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1505*                                                                *
  1506*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1507*       ALTERNATE PATH = NONE                                    *
  1508*                                                                *
  1509*   LOG = NO                                                     *
  1510*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1511*                                                                *
  1512******************************************************************
  1513*                   C H A N G E   L O G
  1514*
  1515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1516*-----------------------------------------------------------------
  1517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1518* EFFECTIVE    NUMBER
  1519*-----------------------------------------------------------------
  1520* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1521* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1522* 092205    2005050300006  PEMA  ADD LEASE FEE
  1523* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1524* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1525* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1526* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1527* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1528* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1529******************************************************************
  1530
  1531 01  COMPENSATION-MASTER.
  1532     12  CO-RECORD-ID                          PIC XX.
  1533         88  VALID-CO-ID                          VALUE 'CO'.
  1534
  1535     12  CO-CONTROL-PRIMARY.
  1536         16  CO-COMPANY-CD                     PIC X.
  1537         16  CO-CONTROL.
  1538             20  CO-CTL-1.
  1539                 24  CO-CARR-GROUP.
  1540                     28  CO-CARRIER            PIC X.
  1541                     28  CO-GROUPING.
  1542                         32  CO-GROUP-PREFIX   PIC XXX.
  1543                         32  CO-GROUP-PRIME    PIC XXX.
  1544                 24  CO-RESP-NO.
  1545                     28  CO-RESP-PREFIX        PIC X(4).
  1546                     28  CO-RESP-PRIME         PIC X(6).
  1547             20  CO-CTL-2.
  1548                 24  CO-ACCOUNT.
  1549                     28  CO-ACCT-PREFIX        PIC X(4).
  1550                     28  CO-ACCT-PRIME         PIC X(6).
  1551         16  CO-TYPE                           PIC X.
  1552             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1553             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1554             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1555
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  30
* EL050.cbl
  1556     12  CO-MAINT-INFORMATION.
  1557         16  CO-LAST-MAINT-DT                  PIC XX.
  1558         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1559         16  CO-LAST-MAINT-USER                PIC X(4).
  1560     12  FILLER                                PIC XX.
  1561     12  CO-STMT-TYPE                          PIC XXX.
  1562     12  CO-COMP-TYPE                          PIC X.
  1563         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1564     12  CO-STMT-OWNER                         PIC X(4).
  1565     12  CO-BALANCE-CONTROL                    PIC X.
  1566         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1567         88  CO-NO-BALANCE                        VALUE 'N'.
  1568
  1569     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1570         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1571         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1572         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1573
  1574     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1575         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1576         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1577
  1578     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1579     12  CO-GA-DIRECT-DEP                      PIC X.
  1580     12  CO-FUTURE-SPACE                       PIC X.
  1581         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1582
  1583     12  CO-ACCT-NAME                          PIC X(30).
  1584     12  CO-MAIL-NAME                          PIC X(30).
  1585     12  CO-ADDR-1                             PIC X(30).
  1586     12  CO-ADDR-2                             PIC X(30).
  1587     12  CO-ADDR-3.
  1588         16  CO-ADDR-CITY                      PIC X(27).
  1589         16  CO-ADDR-STATE                     PIC XX.
  1590     12  CO-CSO-1099                           PIC X.
  1591     12  CO-ZIP.
  1592         16  CO-ZIP-PRIME.
  1593             20  CO-ZIP-PRI-1ST                PIC X.
  1594                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1595             20  FILLER                        PIC X(4).
  1596         16  CO-ZIP-PLUS4                      PIC X(4).
  1597     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1598         16  CO-CAN-POSTAL-1                   PIC XXX.
  1599         16  CO-CAN-POSTAL-2                   PIC XXX.
  1600         16  FILLER                            PIC XXX.
  1601     12  CO-SOC-SEC                            PIC X(13).
  1602     12  CO-TELEPHONE.
  1603         16  CO-AREA-CODE                      PIC XXX.
  1604         16  CO-PREFIX                         PIC XXX.
  1605         16  CO-PHONE                          PIC X(4).
  1606
  1607     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1608
  1609     12  CO-AR-BAL-LEVEL                       PIC X.
  1610         88  CO-AR-REF-LVL                        VALUE '1'.
  1611         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1612         88  CO-AR-BILL-LVL                       VALUE '2'.
  1613         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  31
* EL050.cbl
  1614         88  CO-AR-FR-LVL                         VALUE '4'.
  1615
  1616     12  CO-AR-NORMAL-PRINT                    PIC X.
  1617         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1618         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1619
  1620     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1621
  1622     12  CO-AR-REPORTING                       PIC X.
  1623         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1624         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1625
  1626     12  CO-AR-PULL-CHECK                      PIC X.
  1627         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1628         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1629
  1630     12  CO-AR-BALANCE-PRINT                   PIC X.
  1631         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1632
  1633     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1634         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1635         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1636         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1637
  1638     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1639
  1640     12  CO-USER-CODE                          PIC X.
  1641     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1642
  1643******************************************************************
  1644*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1645*    THE LAST MONTH END RUN.
  1646******************************************************************
  1647
  1648     12  CO-LAST-ACTIVITY-DATE.
  1649         16  CO-ACT-YEAR                       PIC 99.
  1650         16  CO-ACT-MONTH                      PIC 99.
  1651         16  CO-ACT-DAY                        PIC 99.
  1652
  1653     12  CO-LAST-STMT-DT.
  1654         16  CO-LAST-STMT-YEAR                 PIC 99.
  1655         16  CO-LAST-STMT-MONTH                PIC 99.
  1656         16  CO-LAST-STMT-DAY                  PIC 99.
  1657
  1658     12  CO-MO-END-TOTALS.
  1659         16  CO-MONTHLY-TOTALS.
  1660             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1661             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1662             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1663             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1664             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-AGING-TOTALS.
  1667             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1668             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1669             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1670             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1671
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  32
* EL050.cbl
  1672         16  CO-YTD-TOTALS.
  1673             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1674             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1675
  1676         16  CO-OVER-UNDER-TOTALS.
  1677             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1678             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1679
  1680     12  CO-MISCELLANEOUS-TOTALS.
  1681         16  CO-FICA-TOTALS.
  1682             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1683             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1684
  1685         16  CO-CLAIM-TOTALS.
  1686             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1687             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1688
  1689******************************************************************
  1690*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1691*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1692******************************************************************
  1693
  1694     12  CO-CURRENT-TOTALS.
  1695         16  CO-CURRENT-LAST-STMT-DT.
  1696             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1697             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1698             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1699
  1700         16  CO-CURRENT-MONTHLY-TOTALS.
  1701             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1703             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1704             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1705             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1706
  1707         16  CO-CURRENT-AGING-TOTALS.
  1708             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1709             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1710             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1712
  1713         16  CO-CURRENT-YTD-TOTALS.
  1714             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1716
  1717     12  CO-PAID-COMM-TOTALS.
  1718         16  CO-YTD-PAID-COMMS.
  1719             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1720             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1721
  1722     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1723         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1724         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1725
  1726     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1727         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1728         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1729         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  33
* EL050.cbl
  1730         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1731         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1732         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1733         88  CO-FINAL-LETTER                  VALUE 'F'.
  1734         88  CO-RECONCILING                   VALUE 'R'.
  1735         88  CO-PHONE-CALL                    VALUE 'P'.
  1736         88  CO-LEGAL                         VALUE 'L'.
  1737         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1738         88  CO-WRITE-OFF                     VALUE 'W'.
  1739         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1740
  1741     12  CO-CSR-CODE                       PIC X(4).
  1742
  1743     12  CO-GA-STATUS-INFO.
  1744         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1745         16  CO-GA-TERMINATION-DT          PIC XX.
  1746         16  CO-GA-STATUS-CODE             PIC X.
  1747             88  CO-GA-ACTIVE                 VALUE 'A'.
  1748             88  CO-GA-INACTIVE               VALUE 'I'.
  1749             88  CO-GA-PENDING                VALUE 'P'.
  1750         16  CO-GA-COMMENTS.
  1751             20  CO-GA-COMMENT-1           PIC X(40).
  1752             20  CO-GA-COMMENT-2           PIC X(40).
  1753             20  CO-GA-COMMENT-3           PIC X(40).
  1754             20  CO-GA-COMMENT-4           PIC X(40).
  1755
  1756     12  CO-RPTCD2                         PIC X(10).
  1757     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1758         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1759         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-TYPE-AGENT                     PIC X(01).
  1762         88  CO-CORPORATION                   VALUE 'C'.
  1763         88  CO-PARTNERSHIP                   VALUE 'P'.
  1764         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1765         88  CO-TRUST                         VALUE 'T'.
  1766         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1767
  1768     12  CO-FAXNO.
  1769         16  CO-FAX-AREA-CODE                  PIC XXX.
  1770         16  CO-FAX-PREFIX                     PIC XXX.
  1771         16  CO-FAX-PHONE                      PIC X(4).
  1772
  1773     12  CO-BANK-INFORMATION.
  1774         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1775         16  CO-BANK-TRANSIT-NON REDEFINES
  1776             CO-BANK-TRANSIT-NO                PIC 9(8).
  1777
  1778         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1779     12  CO-MISC-DEDUCT-INFO REDEFINES
  1780                  CO-BANK-INFORMATION.
  1781         16  CO-MD-GL-ACCT                     PIC X(10).
  1782         16  CO-MD-DIV                         PIC XX.
  1783         16  CO-MD-CENTER                      PIC X(4).
  1784         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1785         16  CO-CREATE-AP-CHECK                PIC X.
  1786         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1787         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  34
* EL050.cbl
  1788     12  CO-ACH-STATUS                         PIC X.
  1789         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1790         88  CO-ACH-PENDING                        VALUE 'P'.
  1791
  1792     12  CO-BILL-SW                            PIC X.
  1793     12  CO-CONTROL-NAME                       PIC X(30).
  1794     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1795     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1796     12  CO-CLP-STATE                          PIC XX.
  1797     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1798     12  CO-SPP-REFUND-EDIT                    PIC X.
  1799
  1800******************************************************************
  1801
  1802*    COPY ERCAGTC.
  1803******************************************************************
  1804*                                                                *
  1805*                                                                *
  1806*                            ERCAGTC                             *
  1807*                            VMOD=2.001                          *
  1808*                                                                *
  1809*   ONLINE CREDIT SYSTEM                                         *
  1810*                                                                *
  1811*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1812*                                                                *
  1813*   FILE TYPE = VSAM,KSDS                                        *
  1814*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1815*                                                                *
  1816*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1817*       ALTERNATE PATH = NONE                                    *
  1818*                                                                *
  1819*   LOG = NO                                                     *
  1820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1821*                                                                *
  1822******************************************************************
  1823*                   C H A N G E   L O G
  1824*
  1825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1826*-----------------------------------------------------------------
  1827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1828* EFFECTIVE    NUMBER
  1829*-----------------------------------------------------------------
  1830* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1831* 111004                         NEW FILE AND COPYBOOK
  1832* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1833******************************************************************
  1834 01  AGENT-COMMISSIONS.
  1835     12  AG-RECORD-ID                          PIC XX.
  1836         88  VALID-CO-ID                          VALUE 'AG'.
  1837     12  AG-CONTROL-PRIMARY.
  1838         16  AG-COMPANY-CD                     PIC X.
  1839         16  AG-CONTROL.
  1840             20  AG-CTL-1.
  1841                 24  AG-CARR-GROUP.
  1842                     28  AG-CARRIER            PIC X.
  1843                     28  AG-GROUPING           PIC X(6).
  1844                 24  AG-BANK                   PIC X(10).
  1845             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  35
* EL050.cbl
  1846                 24  AG-EXP-DT                 PIC XX.
  1847         16  AG-TYPE                           PIC X.
  1848             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1849             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1850     12  AG-MAINT-INFORMATION.
  1851         16  AG-LAST-MAINT-DT                  PIC XX.
  1852         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1853         16  AG-LAST-MAINT-USER                PIC X(4).
  1854         16  FILLER                            PIC X(10).
  1855     12  AG-EFF-DT                             PIC XX.
  1856     12  AG-COMM-STRUCTURE.
  1857         16  AG-AGT-COMMS OCCURS 10.
  1858             20  AG-AGT                PIC X(10).
  1859             20  AG-COM-TYP            PIC X.
  1860             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1861             20  AG-RECALC-LV-INDIC    PIC X.
  1862             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1863             20  AG-LRCALC-LV-INDIC    PIC X.
  1864             20  FILLER                PIC X(05).
  1865     12  FILLER                  PIC X(145).
  1866******************************************************************
  1867*    COPY ERCRESS.
  1868******************************************************************
  1869*                                                                *
  1870*                            ERCRESS                             *
  1871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1872*                            VMOD=2.002                          *
  1873*                                                                *
  1874*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1875*                                                                *
  1876*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1877*   VSAM RESIDENT STATE TAX MASTER                              *
  1878*                                                                *
  1879*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1880*                                                                *
  1881*   FILE TYPE = VSAM,KSDS                                        *
  1882*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1883*                                                                *
  1884*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1885*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1886*                                                                *
  1887*   LOG = NO                                                     *
  1888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1889*                                                                *
  1890*                                                                *
  1891******************************************************************
  1892
  1893 01  RESIDENT-STATE-TAX-MASTER.
  1894
  1895     10  ERRESS-PRIMARY-KEY.
  1896         15  RES-COMPANY-CD        PIC X.
  1897         15  RES-RESIDENT-STATE    PIC XX.
  1898         15  RES-COVERAGE-CATEGORY PIC X.
  1899         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1900*                                      YYYYMMDD
  1901*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1902
  1903     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  36
* EL050.cbl
  1904
  1905         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1906         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1907         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1908         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1909
  1910     10 RES-RECALC-SW              PIC   X.
  1911         88 RECALC                VALUE 'Y'.
  1912         88 NO-RECALC             VALUE 'N'.
  1913     10  RES-MAINT-BY              PIC X(4).
  1914     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1915     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1916*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  37
* EL050.cbl
  1918*    COPY ERCRESC.
  1919******************************************************************
  1920*                                                                *
  1921*                            ERCRESC                             *
  1922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1923*                            VMOD=2.003                          *
  1924*                                                                *
  1925*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1926*                                                                *
  1927*   FILE TYPE = VSAM,KSDS                                        *
  1928*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1929*                                                                *
  1930*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1931*       ALTERNATE PATH1 = NONE                                   *
  1932*                                                                *
  1933*   LOG = NO                                                     *
  1934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1935*                                                                *
  1936******************************************************************
  1937
  1938 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1939
  1940     10  ERRESC-RECORD-KEY.
  1941         15  RESC-COMPANY-CD           PIC   X.
  1942         15  RESC-CARRIER              PIC   X.
  1943         15  RESC-GROUP                PIC   X(6).
  1944         15  RESC-STATE                PIC   XX.
  1945         15  RESC-ACCOUNT              PIC   X(10).
  1946         15  RESC-AGENT                PIC   X(10).
  1947         15  RESC-RESIDENT-STATE       PIC   XX.
  1948         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1949*                                           YYYYMMDD
  1950     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1951
  1952     10  RESC-COMM-RECORD-DATA.
  1953         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1954             20 RESC-COVERAGE-CAT      PIC    X.
  1955             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1956             20 RESC-COMMISSION-TAB REDEFINES
  1957                RESC-COMMISSION-PER    PIC  XXX.
  1958
  1959     10  RESC-MAINT-BY                 PIC X(4).
  1960     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1961     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1962*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  38
* EL050.cbl
  1964*    COPY ERCPLAN.
  1965******************************************************************
  1966*                                                                *
  1967*                                                                *
  1968*                            ERCPLAN                             *
  1969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1970*                            VMOD=2.003                          *
  1971*                                                                *
  1972*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1973*                                                                *
  1974*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1975*   PLAN MASTER                                                  *
  1976*                                                                *
  1977*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1978*                                                                *
  1979*   FILE TYPE = VSAM,KSDS                                        *
  1980*   RECORD SIZE = 420   RECFORM = FIX                            *
  1981*                                                                *
  1982*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1983*       ALTERNATE PATH1 = N/A                                    *
  1984*                                                                *
  1985*   LOG = NO                                                     *
  1986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1987*                                                                *
  1988*                                                                *
  1989******************************************************************
  1990
  1991 01  PLAN-MASTER.
  1992     12  PL-RECORD-ID                      PIC XX.
  1993         88  VALID-PL-ID                      VALUE 'PL'.
  1994
  1995     12  PL-CONTROL-PRIMARY.
  1996         16  PL-COMPANY-CD                 PIC X.
  1997         16  PL-MSTR-CNTRL.
  1998             20  PL-CONTROL-A.
  1999                 24  PL-CARRIER            PIC X.
  2000                 24  PL-GROUPING           PIC X(6).
  2001                 24  PL-STATE              PIC XX.
  2002                 24  PL-ACCOUNT            PIC X(10).
  2003             20  PL-BENEFIT-TYPE           PIC X.
  2004             20  PL-BENEFIT-CODE           PIC XX.
  2005             20  PL-REVISION-NO            PIC X(3).
  2006
  2007     12  PL-CONTROL-BY-VAR-GRP.
  2008         16  PL-COMPANY-CD-A1              PIC X.
  2009         16  PL-VG-CARRIER                 PIC X.
  2010         16  PL-VG-GROUPING                PIC X(6).
  2011         16  PL-VG-STATE                   PIC XX.
  2012         16  PL-VG-ACCOUNT                 PIC X(10).
  2013         16  PL-BENEFIT-TYPE-A1            PIC X.
  2014         16  PL-BENEFIT-CODE-A1            PIC XX.
  2015         16  PL-REVISION-NO-A1             PIC 999.
  2016
  2017     12  PL-MAINT-INFORMATION.
  2018         16  PL-LAST-MAINT-DT              PIC XX.
  2019         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2020         16  PL-LAST-MAINT-USER            PIC X(4).
  2021         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  39
* EL050.cbl
  2022
  2023     12  PL-LIABILITY-LIMITS.
  2024         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2025         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2026             20  PL-LM-AGE                 PIC S99        COMP-3.
  2027             20  PL-LM-DUR                 PIC S999       COMP-3.
  2028             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2029             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2030
  2031     12  FILLER                            PIC X(30).
  2032
  2033     12  PL-GL-ACCOUNT-NOS.
  2034         16  PL-PREMIUM-GL                 PIC X(8).
  2035         16  PL-COMM-GL                    PIC X(8).
  2036         16  PL-CLAIM-GL                   PIC X(8).
  2037     12  FILLER                            PIC X(24).
  2038     12  PL-TOLERANCES.
  2039         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2040         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2041         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2042         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2043         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2044         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2045     12  PL-OVER-SHORT.
  2046         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2047         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2048     12  FILLER                            PIC X(24).
  2049     12  PLAN-MISC.
  2050         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2051         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2052         16  PL-IG                         PIC X.
  2053         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2054         16  PL-POLICY-FORM                PIC X(12).
  2055         16  PL-EDIT-FOR-FORM              PIC X(01).
  2056         16  PL-DEV-CODE                   PIC XXX.
  2057         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2058         16  PL-CALC-METHOD                PIC X.
  2059         16  PL-BENEFIT-GROUP              PIC X(05).
  2060         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2061
  2062         16  FILLER                        PIC X(99).
  2063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  40
* EL050.cbl
  2065*    COPY ELCCERT.
  2066******************************************************************
  2067*                                                                *
  2068*                            ELCCERT.                            *
  2069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2070*                            VMOD=2.013                          *
  2071*                                                                *
  2072*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2073*                                                                *
  2074*   FILE TYPE = VSAM,KSDS                                        *
  2075*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2076*                                                                *
  2077*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2078*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2079*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2080*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2081*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2082*                                                                *
  2083*   LOG = YES                                                    *
  2084*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2085******************************************************************
  2086*                   C H A N G E   L O G
  2087*
  2088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2089*-----------------------------------------------------------------
  2090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2091* EFFECTIVE    NUMBER
  2092*-----------------------------------------------------------------
  2093* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2094* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2095* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2096* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2097* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2098* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2099* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2100* 032612  CR2011110200001  PEMA  AHL CHANGES
  2101******************************************************************
  2102
  2103 01  CERTIFICATE-MASTER.
  2104     12  CM-RECORD-ID                      PIC XX.
  2105         88  VALID-CM-ID                      VALUE 'CM'.
  2106
  2107     12  CM-CONTROL-PRIMARY.
  2108         16  CM-COMPANY-CD                 PIC X.
  2109         16  CM-CARRIER                    PIC X.
  2110         16  CM-GROUPING.
  2111             20  CM-GROUPING-PREFIX        PIC X(3).
  2112             20  CM-GROUPING-PRIME         PIC X(3).
  2113         16  CM-STATE                      PIC XX.
  2114         16  CM-ACCOUNT.
  2115             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2116             20  CM-ACCOUNT-PRIME          PIC X(6).
  2117         16  CM-CERT-EFF-DT                PIC XX.
  2118         16  CM-CERT-NO.
  2119             20  CM-CERT-PRIME             PIC X(10).
  2120             20  CM-CERT-SFX               PIC X.
  2121
  2122     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  41
* EL050.cbl
  2123         16  CM-COMPANY-CD-A1              PIC X.
  2124         16  CM-INSURED-LAST-NAME          PIC X(15).
  2125         16  CM-INSURED-INITIALS.
  2126             20  CM-INSURED-INITIAL1       PIC X.
  2127             20  CM-INSURED-INITIAL2       PIC X.
  2128
  2129     12  CM-CONTROL-BY-SSN.
  2130         16  CM-COMPANY-CD-A2              PIC X.
  2131         16  CM-SOC-SEC-NO.
  2132             20  CM-SSN-STATE              PIC XX.
  2133             20  CM-SSN-ACCOUNT            PIC X(6).
  2134             20  CM-SSN-LN3.
  2135                 25  CM-INSURED-INITIALS-A2.
  2136                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2137                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2138                 25 CM-PART-LAST-NAME-A2         PIC X.
  2139
  2140     12  CM-CONTROL-BY-CERT-NO.
  2141         16  CM-COMPANY-CD-A4              PIC X.
  2142         16  CM-CERT-NO-A4                 PIC X(11).
  2143
  2144     12  CM-CONTROL-BY-MEMB.
  2145         16  CM-COMPANY-CD-A5              PIC X.
  2146         16  CM-MEMBER-NO.
  2147             20  CM-MEMB-STATE             PIC XX.
  2148             20  CM-MEMB-ACCOUNT           PIC X(6).
  2149             20  CM-MEMB-LN4.
  2150                 25  CM-INSURED-INITIALS-A5.
  2151                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2152                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2153                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2154
  2155     12  CM-INSURED-PROFILE-DATA.
  2156         16  CM-INSURED-FIRST-NAME.
  2157             20  CM-INSURED-1ST-INIT       PIC X.
  2158             20  FILLER                    PIC X(9).
  2159         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2160         16  CM-INSURED-SEX                PIC X.
  2161             88  CM-SEX-MALE                  VALUE 'M'.
  2162             88  CM-SEX-FEMAL                 VALUE 'F'.
  2163         16  CM-INSURED-JOINT-AGE          PIC 99.
  2164         16  CM-JOINT-INSURED-NAME.
  2165             20  CM-JT-LAST-NAME           PIC X(15).
  2166             20  CM-JT-FIRST-NAME.
  2167                 24  CM-JT-1ST-INIT        PIC X.
  2168                 24  FILLER                PIC X(9).
  2169             20  CM-JT-INITIAL             PIC X.
  2170
  2171     12  CM-LIFE-DATA.
  2172         16  CM-LF-BENEFIT-CD              PIC XX.
  2173         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2174         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2175         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2176         16  CM-LF-DEV-CODE                PIC XXX.
  2177         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2178         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2179         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2180         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  42
* EL050.cbl
  2181         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2182         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2183         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2184         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2185         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2186         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2187         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2188         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2189         16  FILLER                        PIC XX.
  2190
  2191     12  CM-AH-DATA.
  2192         16  CM-AH-BENEFIT-CD              PIC XX.
  2193         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2194         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2195         16  CM-AH-DEV-CODE                PIC XXX.
  2196         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2197         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2198         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2199         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2200         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2201         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2202         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2203         16  CM-AH-PAID-THRU-DT            PIC XX.
  2204             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2205         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2206         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2207         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2208         16  FILLER                        PIC X.
  2209
  2210     12  CM-LOAN-INFORMATION.
  2211         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2212         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2213                                           PIC S9(5)V99  COMP-3.
  2214         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2215         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2216         16  CM-PAY-FREQUENCY              PIC S99.
  2217         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2218         16  CM-RATE-CLASS                 PIC XX.
  2219         16  CM-BENEFICIARY                PIC X(25).
  2220         16  CM-POLICY-FORM-NO             PIC X(12).
  2221         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2222         16  CM-LAST-ADD-ON-DT             PIC XX.
  2223         16  CM-DEDUCTIBLE-AMOUNTS.
  2224             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2225             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2226         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2227             20  CM-RESIDENT-STATE         PIC XX.
  2228             20  CM-RATE-CODE              PIC X(4).
  2229             20  FILLER                    PIC XX.
  2230         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2231             20  CM-LOAN-OFFICER           PIC X(5).
  2232             20  FILLER                    PIC XXX.
  2233         16  CM-CSR-CODE                   PIC XXX.
  2234         16  CM-UNDERWRITING-CODE          PIC X.
  2235             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2236         16  CM-POST-CARD-IND              PIC X.
  2237         16  CM-NH-INTERFACE-SW            PIC X.
  2238         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  43
* EL050.cbl
  2239             88  CM-SING-PRM                  VALUE '1'.
  2240             88  CM-O-B-COVERAGE              VALUE '2'.
  2241             88  CM-OPEN-END                  VALUE '3'.
  2242         16  CM-IND-GRP-TYPE               PIC X.
  2243             88  CM-INDIVIDUAL                VALUE 'I'.
  2244             88  CM-GROUP                     VALUE 'G'.
  2245         16  CM-SKIP-CODE                  PIC X.
  2246             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2247             88  SKIP-JULY                    VALUE '1'.
  2248             88  SKIP-AUGUST                  VALUE '2'.
  2249             88  SKIP-SEPTEMBER               VALUE '3'.
  2250             88  SKIP-JULY-AUG                VALUE '4'.
  2251             88  SKIP-AUG-SEPT                VALUE '5'.
  2252             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2253             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2254             88  SKIP-JUNE                    VALUE '8'.
  2255             88  SKIP-JUNE-JULY               VALUE '9'.
  2256             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2257             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2258         16  CM-PAYMENT-MODE               PIC X.
  2259             88  PAY-MONTHLY                  VALUE SPACE.
  2260             88  PAY-WEEKLY                   VALUE '1'.
  2261             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2262             88  PAY-BI-WEEKLY                VALUE '3'.
  2263             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2264         16  CM-LOAN-NUMBER                PIC X(8).
  2265         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2266         16  CM-OLD-LOF                    PIC XXX.
  2267*        16  CM-LOAN-OFFICER               PIC XXX.
  2268         16  CM-REIN-TABLE                 PIC XXX.
  2269         16  CM-SPECIAL-REIN-CODE          PIC X.
  2270         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2271         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2272         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2273
  2274     12  CM-STATUS-DATA.
  2275         16  CM-ENTRY-STATUS               PIC X.
  2276         16  CM-ENTRY-DT                   PIC XX.
  2277
  2278         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2279         16  CM-LF-CANCEL-DT               PIC XX.
  2280         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2281
  2282         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2283         16  CM-LF-DEATH-DT                PIC XX.
  2284         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2285
  2286         16  CM-LF-CURRENT-STATUS          PIC X.
  2287             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2288                                                'M' '4' '5' '9'.
  2289             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2290             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2291             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2292             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2293             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2294             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2295             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2296             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  44
* EL050.cbl
  2297             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2298             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2299             88  CM-LF-DECLINED               VALUE 'D'.
  2300             88  CM-LF-VOIDED                 VALUE 'V'.
  2301
  2302         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2303         16  CM-AH-CANCEL-DT               PIC XX.
  2304         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2305
  2306         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2307         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2308         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2309
  2310         16  CM-AH-CURRENT-STATUS          PIC X.
  2311             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2312                                                'M' '4' '5' '9'.
  2313             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2314             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2315             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2316             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2317             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2318             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2319             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2320             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2321             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2322             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2323             88  CM-AH-DECLINED               VALUE 'D'.
  2324             88  CM-AH-VOIDED                 VALUE 'V'.
  2325
  2326         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2327             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2328             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2329             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2330         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2331
  2332         16  CM-ENTRY-BATCH                PIC X(6).
  2333         16  CM-LF-EXIT-BATCH              PIC X(6).
  2334         16  CM-AH-EXIT-BATCH              PIC X(6).
  2335         16  CM-LAST-MONTH-END             PIC XX.
  2336
  2337     12  CM-NOTE-SW                        PIC X.
  2338         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2339         88  CERT-NOTES-PRESENT               VALUE '1'.
  2340         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2341         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2342         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2343         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2344         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2345         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2346     12  CM-COMP-EXCP-SW                   PIC X.
  2347         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2348         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2349     12  CM-INSURED-ADDRESS-SW             PIC X.
  2350         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2351         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2352
  2353*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2354     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  45
* EL050.cbl
  2355     12  FILLER                            PIC X.
  2356
  2357*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2358     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2359     12  FILLER                            PIC X.
  2360*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2361     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2362
  2363     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2364         88  CERT-ADDED-BATCH                 VALUE ' '.
  2365         88  CERT-ADDED-ONLINE                VALUE '1'.
  2366         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2367         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2368         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2369     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2370         88  CERT-AS-LOADED                   VALUE ' '.
  2371         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2372         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2373         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2374         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2375         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2376         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2377         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2378
  2379     12  CM-ACCOUNT-COMM-PCTS.
  2380         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2381         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2382
  2383     12  CM-USER-FIELD                     PIC X.
  2384     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2385     12  CM-CLP-STATE                      PIC XX.
  2386     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2387     12  CM-USER-RESERVED                  PIC XXX.
  2388     12  FILLER REDEFINES CM-USER-RESERVED.
  2389         16  CM-AH-CLASS-CD                PIC XX.
  2390         16  F                             PIC X.
  2391******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  46
* EL050.cbl
  2393*    COPY ERCMAIL.
  2394******************************************************************
  2395*                                                                *
  2396*                                                                *
  2397*                            ERCMAIL                             *
  2398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2399*                            VMOD=2.003                          *
  2400*                                                                *
  2401*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2402*                                                                *
  2403*   FILE TYPE = VSAM,KSDS                                        *
  2404*   RECORD SIZE = 374   RECFORM = FIX                            *
  2405*                                                                *
  2406*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2407*   ALTERNATE PATH    = NOT USED                                 *
  2408*                                                                *
  2409*   LOG = YES                                                    *
  2410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2411******************************************************************
  2412*                   C H A N G E   L O G
  2413*
  2414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2415*-----------------------------------------------------------------
  2416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2417* EFFECTIVE    NUMBER
  2418*-----------------------------------------------------------------
  2419* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2420* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2421* 111108                   PEMA  ADD CRED BENE ADDR2
  2422******************************************************************
  2423
  2424 01  MAILING-DATA.
  2425     12  MA-RECORD-ID                      PIC XX.
  2426         88  VALID-MA-ID                       VALUE 'MA'.
  2427
  2428     12  MA-CONTROL-PRIMARY.
  2429         16  MA-COMPANY-CD                 PIC X.
  2430         16  MA-CARRIER                    PIC X.
  2431         16  MA-GROUPING.
  2432             20  MA-GROUPING-PREFIX        PIC XXX.
  2433             20  MA-GROUPING-PRIME         PIC XXX.
  2434         16  MA-STATE                      PIC XX.
  2435         16  MA-ACCOUNT.
  2436             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2437             20  MA-ACCOUNT-PRIME          PIC X(6).
  2438         16  MA-CERT-EFF-DT                PIC XX.
  2439         16  MA-CERT-NO.
  2440             20  MA-CERT-PRIME             PIC X(10).
  2441             20  MA-CERT-SFX               PIC X.
  2442
  2443     12  FILLER                            PIC XX.
  2444
  2445     12  MA-ACCESS-CONTROL.
  2446         16  MA-SOURCE-SYSTEM              PIC XX.
  2447             88  MA-FROM-CREDIT                VALUE 'CR'.
  2448             88  MA-FROM-VSI                   VALUE 'VS'.
  2449             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2450             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  47
* EL050.cbl
  2451         16  MA-RECORD-ADD-DT              PIC XX.
  2452         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2453         16  MA-LAST-MAINT-DT              PIC XX.
  2454         16  MA-LAST-MAINT-BY              PIC XXXX.
  2455         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2456
  2457     12  MA-PROFILE-INFO.
  2458         16  MA-QUALIFY-CODE-1             PIC XX.
  2459         16  MA-QUALIFY-CODE-2             PIC XX.
  2460         16  MA-QUALIFY-CODE-3             PIC XX.
  2461         16  MA-QUALIFY-CODE-4             PIC XX.
  2462         16  MA-QUALIFY-CODE-5             PIC XX.
  2463
  2464         16  MA-INSURED-LAST-NAME          PIC X(15).
  2465         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2466         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2467         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2468         16  MA-INSURED-BIRTH-DT           PIC XX.
  2469         16  MA-INSURED-SEX                PIC X.
  2470             88  MA-SEX-MALE                   VALUE 'M'.
  2471             88  MA-SEX-FEMALE                 VALUE 'F'.
  2472         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2473
  2474         16  MA-ADDRESS-CORRECTED          PIC X.
  2475         16  MA-JOINT-BIRTH-DT             PIC XX.
  2476*        16  FILLER                        PIC X(12).
  2477
  2478         16  MA-ADDRESS-LINE-1             PIC X(30).
  2479         16  MA-ADDRESS-LINE-2             PIC X(30).
  2480         16  MA-CITY-STATE.
  2481             20  MA-CITY                   PIC X(28).
  2482             20  MA-ADDR-STATE             PIC XX.
  2483         16  MA-ZIP.
  2484             20  MA-ZIP-CODE.
  2485                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2486                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2487                 24  FILLER                PIC X(4).
  2488             20  MA-ZIP-PLUS4              PIC X(4).
  2489         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2490             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2491             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2492             20  FILLER                    PIC X(3).
  2493
  2494         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2495
  2496         16  FILLER                        PIC XXX.
  2497*        16  FILLER                        PIC X(10).
  2498
  2499     12  MA-CRED-BENE-INFO.
  2500         16  MA-CRED-BENE-NAME                 PIC X(25).
  2501         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2502         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2503         16  MA-CRED-BENE-CTYST.
  2504             20  MA-CRED-BENE-CITY             PIC X(28).
  2505             20  MA-CRED-BENE-STATE            PIC XX.
  2506         16  MA-CRED-BENE-ZIP.
  2507             20  MA-CB-ZIP-CODE.
  2508                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  48
* EL050.cbl
  2509                     88  MA-CB-CANADIAN-POST-CODE
  2510                                           VALUE 'A' THRU 'Z'.
  2511                 24  FILLER                    PIC X(4).
  2512             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2513         16  MA-CB-CANADIAN-POSTAL-CODE
  2514                            REDEFINES MA-CRED-BENE-ZIP.
  2515             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2516             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2517             20  FILLER                        PIC X(3).
  2518     12  MA-POST-CARD-MAIL-DATA.
  2519         16  MA-MAIL-DATA OCCURS 7.
  2520             20  MA-MAIL-TYPE              PIC X.
  2521                 88  MA-12MO-MAILING           VALUE '1'.
  2522                 88  MA-EXP-MAILING            VALUE '2'.
  2523             20  MA-MAIL-STATUS            PIC X.
  2524                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2525                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2526                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2527             20  MA-MAIL-DATE              PIC XX.
  2528     12  FILLER                            PIC XX.
  2529     12  FILLER                            PIC XX.
  2530*    12  FILLER                            PIC X(30).
  2531******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  49
* EL050.cbl
  2533*    COPY ERCPNDM.
  2534******************************************************************
  2535*                                                                *
  2536*                                                                *
  2537*                            ERCPNDM                             *
  2538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2539*                            VMOD=2.003                          *
  2540*                                                                *
  2541*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2542*                                                                *
  2543*   FILE TYPE = VSAM,KSDS                                        *
  2544*   RECORD SIZE = 374   RECFORM = FIX                            *
  2545*                                                                *
  2546*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2547*   ALTERNATE PATH    = NOT USED                                 *
  2548*                                                                *
  2549*   LOG = YES                                                    *
  2550*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2551******************************************************************
  2552*                   C H A N G E   L O G
  2553*
  2554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2555*-----------------------------------------------------------------
  2556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2557* EFFECTIVE    NUMBER
  2558*-----------------------------------------------------------------
  2559* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2560* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2561* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2562******************************************************************
  2563
  2564 01  PENDING-MAILING-DATA.
  2565     12  PM-RECORD-ID                      PIC XX.
  2566         88  VALID-MA-ID                       VALUE 'PM'.
  2567
  2568     12  PM-CONTROL-PRIMARY.
  2569         16  PM-COMPANY-CD                 PIC X.
  2570         16  PM-ENTRY-BATCH                PIC X(6).
  2571         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2572         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2573
  2574     12  FILLER                            PIC X(14).
  2575
  2576     12  PM-ACCESS-CONTROL.
  2577         16  PM-SOURCE-SYSTEM              PIC XX.
  2578             88  PM-FROM-CREDIT                VALUE 'CR'.
  2579             88  PM-FROM-VSI                   VALUE 'VS'.
  2580             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2581             88  PM-FROM-OTHER                 VALUE 'OT'.
  2582         16  PM-RECORD-ADD-DT              PIC XX.
  2583         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2584         16  PM-LAST-MAINT-DT              PIC XX.
  2585         16  PM-LAST-MAINT-BY              PIC XXXX.
  2586         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2587
  2588     12  PM-PROFILE-INFO.
  2589         16  PM-QUALIFY-CODE-1             PIC XX.
  2590         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  50
* EL050.cbl
  2591         16  PM-QUALIFY-CODE-3             PIC XX.
  2592         16  PM-QUALIFY-CODE-4             PIC XX.
  2593         16  PM-QUALIFY-CODE-5             PIC XX.
  2594
  2595         16  PM-INSURED-LAST-NAME          PIC X(15).
  2596         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2597         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2598         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2599         16  PM-INSURED-BIRTH-DT           PIC XX.
  2600         16  PM-INSURED-SEX                PIC X.
  2601             88  PM-SEX-MALE                   VALUE 'M'.
  2602             88  PM-SEX-FEMALE                 VALUE 'F'.
  2603         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2604
  2605         16  PM-ADDRESS-CORRECTED          PIC X.
  2606         16  PM-JOINT-BIRTH-DT             PIC XX.
  2607*        16  FILLER                        PIC X(12).
  2608
  2609         16  PM-ADDRESS-LINE-1             PIC X(30).
  2610         16  PM-ADDRESS-LINE-2             PIC X(30).
  2611         16  PM-CITY-STATE.
  2612             20  PM-CITY                   PIC X(28).
  2613             20  PM-STATE                  PIC XX.
  2614         16  PM-ZIP.
  2615             20  PM-ZIP-CODE.
  2616                 24  PM-ZIP-1              PIC X.
  2617                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2618                 24  FILLER                PIC X(4).
  2619             20  PM-ZIP-PLUS4              PIC X(4).
  2620         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2621             20  PM-CAN-POST1              PIC XXX.
  2622             20  PM-CAN-POST2              PIC XXX.
  2623             20  FILLER                    PIC XXX.
  2624
  2625         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2626
  2627         16  FILLER                        PIC X(03).
  2628
  2629     12  PM-CRED-BENE-INFO.
  2630         16  PM-CRED-BENE-NAME             PIC X(25).
  2631         16  PM-CRED-BENE-ADDR             PIC X(30).
  2632         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2633         16  PM-CRED-BENE-CTYST.
  2634             20  PM-CRED-BENE-CITY         PIC X(28).
  2635             20  PM-CRED-BENE-STATE        PIC XX.
  2636         16  PM-CRED-BENE-ZIP.
  2637             20  PM-CB-ZIP-CODE.
  2638                 24  PM-CB-ZIP-1           PIC X.
  2639                     88  PM-CB-CANADIAN-POST-CODE
  2640                                  VALUE 'A' THRU 'Z'.
  2641                 24  FILLER                PIC X(4).
  2642             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2643         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2644             20  PM-CB-CAN-POST1           PIC XXX.
  2645             20  PM-CB-CAN-POST2           PIC XXX.
  2646             20  FILLER                    PIC XXX.
  2647     12  PM-POST-CARD-MAIL-DATA.
  2648         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  51
* EL050.cbl
  2649             20  PM-MAIL-TYPE              PIC X.
  2650                 88  PM-12MO-MAILING           VALUE '1'.
  2651                 88  PM-EXP-MAILING            VALUE '2'.
  2652             20  PM-MAIL-STATUS            PIC X.
  2653                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2654                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2655                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2656             20  PM-MAIL-DATE              PIC XX.
  2657     12  FILLER                            PIC XX.
  2658     12  FILLER                            PIC X(12).
  2659*    12  FILLER                            PIC X(30).
  2660
  2661******************************************************************
  2662*                                COPY ERCLOFC.
  2663******************************************************************
  2664*                                                                *
  2665*                                                                *
  2666*                            ERCLOFC                             *
  2667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2668*                            VMOD=2.003                          *
  2669*                                                                *
  2670*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2671*                                                                *
  2672*   FILE TYPE = VSAM,KSDS                                        *
  2673*   RECORD SIZE = 670   RECFORM = FIX                            *
  2674*                                                                *
  2675*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2676*                                                                *
  2677*   LOG = YES                                                    *
  2678*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2679*                                                                *
  2680******************************************************************
  2681
  2682 01  LOAN-OFFICER-MASTER.
  2683     12  LO-RECORD-ID                PIC XX.
  2684         88  VALID-LO-ID                VALUE 'LO'.
  2685
  2686     12  LO-CONTROL-PRIMARY.
  2687         16  LO-COMPANY-CD           PIC X.
  2688         16  LO-CARRIER              PIC X.
  2689         16  LO-GROUPING.
  2690             20  LO-GROUPING-PREFIX  PIC XXX.
  2691             20  LO-GROUPING-PRIME   PIC XXX.
  2692         16  LO-STATE                PIC XX.
  2693         16  LO-ACCOUNT.
  2694             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2695             20  LO-ACCOUNT-PRIME    PIC X(6).
  2696         16  LO-OFFICER-CODE         PIC X(5).
  2697
  2698     12  LO-OFFICER-NAME             PIC X(30).
  2699
  2700     12  LO-LAST-MAINT-DT            PIC XX.
  2701     12  LO-LAST-USER                PIC X(4).
  2702     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2703
  2704     12  LO-COMP-CONTROL             PIC X.
  2705             88  LO-SHOW-COMP           VALUE 'Y'.
  2706             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  52
* EL050.cbl
  2707     12  LO-DETAIL-CONTROL           PIC X.
  2708             88  LO-PRINT-DETAIL        VALUE 'D'.
  2709             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2710
  2711     12  LO-SV-CARRIER               PIC X.
  2712     12  LO-SV-GROUPING              PIC X(6).
  2713     12  LO-SV-STATE                 PIC XX.
  2714
  2715     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2716     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2717
  2718     12  LO-OFFICER-INFO.
  2719         16  FILLER OCCURS 12 TIMES.
  2720             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2721             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2722             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2723             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2724             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2725             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2726             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2727             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2728     12  FILLER                      PIC X(198).
  2729******************************************************************
  2730*                                COPY ERCPDEF.
  2731******************************************************************
  2732*                                                                *
  2733*                                                                *
  2734*                            ERCPDEF.                            *
  2735*                                                                *
  2736*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2737*                                                                *
  2738*    FILE TYPE = VSAM,KSDS                                       *
  2739*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2740*                                                                *
  2741*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2742*                                                                *
  2743*    LOG = YES                                                   *
  2744*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2745******************************************************************
  2746 01  PRODUCT-MASTER.
  2747    12  PD-RECORD-ID                 PIC X(02).
  2748        88  VALID-PD-ID                  VALUE 'PD'.
  2749    12  PD-CONTROL-PRIMARY.
  2750        16  PD-COMPANY-CD            PIC X.
  2751        16  PD-STATE                 PIC XX.
  2752        16  PD-PRODUCT-CD            PIC XXX.
  2753        16  PD-FILLER                PIC X(7).
  2754        16  PD-BEN-TYPE              PIC X.
  2755        16  PD-BEN-CODE              PIC XX.
  2756        16  PD-PROD-EXP-DT           PIC XX.
  2757    12  FILLER                       PIC X(50).
  2758    12  PD-PRODUCT-DATA OCCURS 8.
  2759        16  PD-PROD-CODE             PIC X.
  2760            88  PD-PROD-LIFE           VALUE 'L'.
  2761            88  PD-PROD-PROP           VALUE 'P'.
  2762            88  PD-PROD-AH             VALUE 'A'.
  2763            88  PD-PROD-IU             VALUE 'I'.
  2764            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  53
* EL050.cbl
  2765        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2766        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2767        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2768        16  PD-MAX-TERM              PIC S999        COMP-3.
  2769        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2770        16  FILLER                   PIC X.
  2771        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2772        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2773        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2774        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2775        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2776        16  PD-REC-CRIT-PERIOD       PIC X.
  2777        16  PD-RTW-MOS               PIC 99.
  2778        16  FILLER                   PIC X(5).
  2779    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2780    12  PD-TERM-LIMITS OCCURS 15.
  2781        16  PD-LOW-TERM              PIC S999        COMP-3.
  2782        16  PD-HI-TERM               PIC S999        COMP-3.
  2783*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2784    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2785        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2786        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2787    12  PD-EARN-FACTORS.
  2788        16  FILLER OCCURS 15.
  2789            20  FILLER OCCURS 15.
  2790                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2791    12  PD-PRODUCT-DESC              PIC X(80).
  2792    12  PD-TRUNCATED                 PIC X.
  2793    12  FILLER                       PIC X(59).
  2794    12  PD-MAINT-INFORMATION.
  2795        16  PD-LAST-MAINT-DT         PIC X(02).
  2796        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2797        16  PD-LAST-MAINT-BY         PIC X(04).
  2798*                                COPY ELCSTATE.
  2799******************************************************************
  2800*                                                                *
  2801*                                                                *
  2802*                            ELCSTATE.                           *
  2803*                                                                *
  2804*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2805*                                                                *
  2806*   FILE TYPE = VSAM,KSDS                                        *
  2807*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2808*                                                                *
  2809*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2810*       ALTERNATE INDEX = NONE                                   *
  2811*                                                                *
  2812*   LOG = YES                                                    *
  2813*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2814******************************************************************
  2815*                   C H A N G E   L O G
  2816*
  2817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2818*-----------------------------------------------------------------
  2819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2820* EFFECTIVE    NUMBER
  2821*-----------------------------------------------------------------
  2822* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  54
* EL050.cbl
  2823******************************************************************
  2824*
  2825 01  STATE-FILE.
  2826     12  SF-RECORD-ID                       PIC XX.
  2827         88  VALID-CF-ID                        VALUE 'SF'.
  2828     12  SF-CONTROL-PRIMARY.
  2829         16  SF-COMPANY-ID                  PIC XXX.
  2830         16  SF-CARRIER-CODE                PIC X.
  2831         16  SF-GROUPING                    PIC X(6).
  2832         16  SF-STATE-CODE                  PIC XX.
  2833         16  SF-EXPIRE-DATE                 PIC 9(8).
  2834****************************************************************
  2835*             STATE CONTROLS
  2836****************************************************************
  2837     12  SF-LAST-MAINT-DT                   PIC XX.
  2838     12  SF-LAST-MAINT-BY                   PIC X(4).
  2839     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2840     12  SF-STATE-RT-CONTROLS.
  2841         16  SF-ST-RT-CALC                  PIC X.
  2842     12  SF-ST-TAX-CONTROLS.
  2843         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2844         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2845         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2846     12  SF-ST-REFUND-OPTIONS.
  2847         16  SF-ST-RF-LR-CALC               PIC X.
  2848         16  SF-ST-RF-LL-CALC               PIC X.
  2849         16  SF-ST-RF-LN-CALC               PIC X.
  2850         16  SF-ST-RF-AH-CALC               PIC X.
  2851         16  SF-ST-RF-CP-CALC               PIC X.
  2852     12  SF-ST-UNEARN-PREM-OPTIONS.
  2853         16  SF-ST-LUEP-R78                 PIC X.
  2854         16  SF-ST-LUEP-PRO                 PIC X.
  2855         16  SF-ST-LUEP-ST                  PIC X.
  2856         16  SF-ST-LUEP-DOM                 PIC X.
  2857         16  SF-ST-AUEP-R78                 PIC X.
  2858         16  SF-ST-AUEP-PRO                 PIC X.
  2859         16  SF-ST-AUEP-ST                  PIC X.
  2860         16  SF-ST-AUEP-DOM                 PIC X.
  2861         16  SF-ST-CUEP-R78                 PIC X.
  2862         16  SF-ST-CUEP-PRO                 PIC X.
  2863         16  SF-ST-CUEP-ST                  PIC X.
  2864         16  SF-ST-CUEP-DOM                 PIC X.
  2865     12  SF-ST-EARN-PREM-OPTIONS.
  2866         16  SF-ST-LEP-R78                  PIC X.
  2867         16  SF-ST-LEP-PRO                  PIC X.
  2868         16  SF-ST-LEP-ST                   PIC X.
  2869         16  SF-ST-LEP-DOM                  PIC X.
  2870         16  SF-ST-AEP-R78                  PIC X.
  2871         16  SF-ST-AEP-PRO                  PIC X.
  2872         16  SF-ST-AEP-ST                   PIC X.
  2873         16  SF-ST-AEP-DOM                  PIC X.
  2874         16  SF-ST-CEP-R78                  PIC X.
  2875         16  SF-ST-CEP-PRO                  PIC X.
  2876         16  SF-ST-CEP-ST                   PIC X.
  2877         16  SF-ST-CEP-DOM                  PIC X.
  2878     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  55
* EL050.cbl
  2880*    COPY ELCCRTT.
  2881******************************************************************
  2882*                                                                *
  2883*                            ELCCRTT.                            *
  2884*                                                                *
  2885*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2886*                                                                *
  2887*   FILE TYPE = VSAM,KSDS                                        *
  2888*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2889*                                                                *
  2890*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2891*                                                                *
  2892*   LOG = YES                                                    *
  2893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2894******************************************************************
  2895*                   C H A N G E   L O G
  2896*
  2897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2898*-----------------------------------------------------------------
  2899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2900* EFFECTIVE    NUMBER
  2901*-----------------------------------------------------------------
  2902* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2903* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2904* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2905* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2906* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2907******************************************************************
  2908
  2909 01  CERTIFICATE-TRAILERS.
  2910     12  CS-RECORD-ID                      PIC XX.
  2911         88  VALID-CS-ID                      VALUE 'CS'.
  2912
  2913     12  CS-CONTROL-PRIMARY.
  2914         16  CS-COMPANY-CD                 PIC X.
  2915         16  CS-CARRIER                    PIC X.
  2916         16  CS-GROUPING                   PIC X(6).
  2917         16  CS-STATE                      PIC XX.
  2918         16  CS-ACCOUNT                    PIC X(10).
  2919         16  CS-CERT-EFF-DT                PIC XX.
  2920         16  CS-CERT-NO.
  2921             20  CS-CERT-PRIME             PIC X(10).
  2922             20  CS-CERT-SFX               PIC X.
  2923         16  CS-TRAILER-TYPE               PIC X.
  2924             88  COMM-TRLR           VALUE 'A'.
  2925             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2926             88  CERT-DATA-TRLR      VALUE 'C'.
  2927
  2928     12  CS-DATA-AREA                      PIC X(516).
  2929
  2930     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2931         16  CS-BANK-COMMISSION-AREA.
  2932             20  CS-BANK-COMMS       OCCURS 10.
  2933                 24  CS-AGT                PIC X(10).
  2934                 24  CS-COM-TYP            PIC X.
  2935                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2936                 24  CS-RECALC-LV-INDIC    PIC X.
  2937                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  56
* EL050.cbl
  2938         16  FILLER                        PIC X(256).
  2939
  2940     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2941****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2942****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2943         16  CS-MB-CLAIM-DATA OCCURS 2.
  2944             20  FILLER OCCURS 10.
  2945                 24  CS-CLAIM-TYPE         PIC X.
  2946                     88  CS-AH-CLM           VALUE 'A'.
  2947                     88  CS-IU-CLM           VALUE 'I'.
  2948                     88  CS-GP-CLM           VALUE 'G'.
  2949                     88  CS-LF-CLM           VALUE 'L'.
  2950                     88  CS-PR-CLM           VALUE 'P'.
  2951                 24  CS-BANK               PIC S999 COMP-3.
  2952                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2953                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2954                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2955         16  FILLER                        PIC X(216).
  2956     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2957         16  CS-VIN-NUMBER                 PIC X(17).
  2958         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2959         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2960         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2961         16  FILLER                        PIC X(496).
  2962******************************************************************
  2963*    COPY ELCCRTO.
  2964******************************************************************
  2965*                                                                *
  2966*                            ELCCRTO.                            *
  2967*                                                                *
  2968*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2969*                                                                *
  2970*   FILE TYPE = VSAM,KSDS                                        *
  2971*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2972*                                                                *
  2973*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2974*                                                                *
  2975*   LOG = YES                                                    *
  2976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2977******************************************************************
  2978*                   C H A N G E   L O G
  2979*
  2980* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2981*-----------------------------------------------------------------
  2982*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2983* EFFECTIVE    NUMBER
  2984*-----------------------------------------------------------------
  2985* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2986* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2987* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2988* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2989* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2990******************************************************************
  2991 01  ORIGINAL-CERTIFICATE.
  2992     12  OC-RECORD-ID                      PIC XX.
  2993         88  VALID-OC-ID                      VALUE 'OC'.
  2994     12  OC-CONTROL-PRIMARY.
  2995         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  57
* EL050.cbl
  2996         16  OC-CARRIER                    PIC X.
  2997         16  OC-GROUPING                   PIC X(6).
  2998         16  OC-STATE                      PIC XX.
  2999         16  OC-ACCOUNT                    PIC X(10).
  3000         16  OC-CERT-EFF-DT                PIC XX.
  3001         16  OC-CERT-NO.
  3002             20  OC-CERT-PRIME             PIC X(10).
  3003             20  OC-CERT-SFX               PIC X.
  3004         16  OC-RECORD-TYPE                PIC X.
  3005         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3006     12  OC-LAST-MAINT-DT                  PIC XX.
  3007     12  OC-LAST-MAINT-BY                  PIC X(4).
  3008     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3009     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3010     12  FILLER                            PIC X(49).
  3011     12  OC-ORIG-REC.
  3012         16  OC-INS-LAST-NAME              PIC X(15).
  3013         16  OC-INS-FIRST-NAME             PIC X(10).
  3014         16  OC-INS-MIDDLE-INIT            PIC X.
  3015         16  OC-INS-AGE                    PIC S999     COMP-3.
  3016         16  OC-JNT-LAST-NAME              PIC X(15).
  3017         16  OC-JNT-FIRST-NAME             PIC X(10).
  3018         16  OC-JNT-MIDDLE-INIT            PIC X.
  3019         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3020         16  OC-LF-BENCD                   PIC XX.
  3021         16  OC-LF-TERM                    PIC S999      COMP-3.
  3022         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3023         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3024         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3025         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3026         16  OC-LF-EXP-DT                  PIC XX.
  3027         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3028         16  OC-LF-CANCEL-DT               PIC XX.
  3029         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3030         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3031         16  OC-AH-BENCD                   PIC XX.
  3032         16  OC-AH-TERM                    PIC S999      COMP-3.
  3033         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3034         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3035         16  OC-AH-EXP-DT                  PIC XX.
  3036         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3037         16  OC-AH-CP                      PIC 99.
  3038         16  OC-AH-CANCEL-DT               PIC XX.
  3039         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3040         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3041         16  OC-CRED-BENE-NAME             PIC X(25).
  3042         16  OC-1ST-PMT-DT                 PIC XX.
  3043         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3044         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3045         16  OC-ISSUE-TRAN-IND             PIC X.
  3046         16  OC-CANCEL-TRAN-IND            PIC X.
  3047         16  FILLER                        PIC X(211).
  3048
  3049     12  FILLER                            PIC X(50).
  3050******************************************************************
  3051
  3052*    COPY ELCDATE.
  3053******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  58
* EL050.cbl
  3054*                                                                *
  3055*                                                                *
  3056*                            ELCDATE.                            *
  3057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3058*                            VMOD=2.003
  3059*                                                                *
  3060*                                                                *
  3061*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3062*                 LENGTH = 200                                   *
  3063******************************************************************
  3064
  3065 01  DATE-CONVERSION-DATA.
  3066     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3067     12  DC-OPTION-CODE                PIC X.
  3068         88  BIN-TO-GREG                VALUE ' '.
  3069         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3070         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3071         88  YMD-GREG-TO-BIN            VALUE '3'.
  3072         88  MDY-GREG-TO-BIN            VALUE '4'.
  3073         88  JULIAN-TO-BIN              VALUE '5'.
  3074         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3075         88  FIND-CENTURY               VALUE '7'.
  3076         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3077         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3078         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3079         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3080         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3081         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3082         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3083         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3084         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3085         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3086         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3087         88  BIN-3-TO-GREG              VALUE 'I'.
  3088         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3089         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3090         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3091         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3092         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3093         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3094         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3095         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3096         88  THREE-CHARACTER-BIN
  3097                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3098         88  GREGORIAN-TO-BIN
  3099                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3100         88  BIN-TO-GREGORIAN
  3101                  VALUES ' ' '1' 'I' '8' 'G'.
  3102         88  JULIAN-TO-BINARY
  3103                  VALUES '5' 'C' 'E' 'F'.
  3104     12  DC-ERROR-CODE                 PIC X.
  3105         88  NO-CONVERSION-ERROR        VALUE ' '.
  3106         88  DATE-CONVERSION-ERROR
  3107                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3108         88  DATE-IS-ZERO               VALUE '1'.
  3109         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3110         88  DATE-IS-INVALID            VALUE '3'.
  3111         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  59
* EL050.cbl
  3112         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3113         88  DATE-INVALID-OPTION        VALUE '9'.
  3114         88  INVALID-CENTURY            VALUE 'A'.
  3115         88  ONLY-CENTURY               VALUE 'B'.
  3116         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3117         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3118     12  DC-END-OF-MONTH               PIC X.
  3119         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3120     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3121         88  USE-NORMAL-PROCESS         VALUE ' '.
  3122         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3123         88  ADJUST-UP-100-YRS          VALUE '2'.
  3124     12  FILLER                        PIC X.
  3125     12  DC-CONVERSION-DATES.
  3126         16  DC-BIN-DATE-1             PIC XX.
  3127         16  DC-BIN-DATE-2             PIC XX.
  3128         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3129         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3130                       DC-GREG-DATE-1-EDIT.
  3131             20  DC-EDIT1-MONTH        PIC 99.
  3132             20  SLASH1-1              PIC X.
  3133             20  DC-EDIT1-DAY          PIC 99.
  3134             20  SLASH1-2              PIC X.
  3135             20  DC-EDIT1-YEAR         PIC 99.
  3136         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3137         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3138                     DC-GREG-DATE-2-EDIT.
  3139             20  DC-EDIT2-MONTH        PIC 99.
  3140             20  SLASH2-1              PIC X.
  3141             20  DC-EDIT2-DAY          PIC 99.
  3142             20  SLASH2-2              PIC X.
  3143             20  DC-EDIT2-YEAR         PIC 99.
  3144         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3145         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3146                     DC-GREG-DATE-1-YMD.
  3147             20  DC-YMD-YEAR           PIC 99.
  3148             20  DC-YMD-MONTH          PIC 99.
  3149             20  DC-YMD-DAY            PIC 99.
  3150         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3151         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3152                      DC-GREG-DATE-1-MDY.
  3153             20  DC-MDY-MONTH          PIC 99.
  3154             20  DC-MDY-DAY            PIC 99.
  3155             20  DC-MDY-YEAR           PIC 99.
  3156         16  DC-GREG-DATE-1-ALPHA.
  3157             20  DC-ALPHA-MONTH        PIC X(10).
  3158             20  DC-ALPHA-DAY          PIC 99.
  3159             20  FILLER                PIC XX.
  3160             20  DC-ALPHA-CENTURY.
  3161                 24 DC-ALPHA-CEN-N     PIC 99.
  3162             20  DC-ALPHA-YEAR         PIC 99.
  3163         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3164         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3165         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3166         16  DC-JULIAN-DATE            PIC 9(05).
  3167         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3168                                       PIC 9(05).
  3169         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  60
* EL050.cbl
  3170             20  DC-JULIAN-YEAR        PIC 99.
  3171             20  DC-JULIAN-DAYS        PIC 999.
  3172         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3173         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3174         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3175     12  DATE-CONVERSION-VARIBLES.
  3176         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3177         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3178             20  FILLER                PIC 9(3).
  3179             20  HOLD-CEN-1-CCYY.
  3180                 24  HOLD-CEN-1-CC     PIC 99.
  3181                 24  HOLD-CEN-1-YY     PIC 99.
  3182             20  HOLD-CEN-1-MO         PIC 99.
  3183             20  HOLD-CEN-1-DA         PIC 99.
  3184         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3185             20  HOLD-CEN-1-R-MO       PIC 99.
  3186             20  HOLD-CEN-1-R-DA       PIC 99.
  3187             20  HOLD-CEN-1-R-CCYY.
  3188                 24  HOLD-CEN-1-R-CC   PIC 99.
  3189                 24  HOLD-CEN-1-R-YY   PIC 99.
  3190             20  FILLER                PIC 9(3).
  3191         16  HOLD-CENTURY-1-X.
  3192             20  FILLER                PIC X(3)  VALUE SPACES.
  3193             20  HOLD-CEN-1-X-CCYY.
  3194                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3195                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3196             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3197             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3198         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3199             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3200             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3201             20  HOLD-CEN-1-R-X-CCYY.
  3202                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3203                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3204             20  FILLER                PIC XXX.
  3205         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3206         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3207         16  DC-JULIAN-DATE-1          PIC 9(07).
  3208         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3209             20  DC-JULIAN-1-CCYY.
  3210                 24  DC-JULIAN-1-CC    PIC 99.
  3211                 24  DC-JULIAN-1-YR    PIC 99.
  3212             20  DC-JULIAN-DA-1        PIC 999.
  3213         16  DC-JULIAN-DATE-2          PIC 9(07).
  3214         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3215             20  DC-JULIAN-2-CCYY.
  3216                 24  DC-JULIAN-2-CC    PIC 99.
  3217                 24  DC-JULIAN-2-YR    PIC 99.
  3218             20  DC-JULIAN-DA-2        PIC 999.
  3219         16  DC-GREG-DATE-A-EDIT.
  3220             20  DC-EDITA-MONTH        PIC 99.
  3221             20  SLASHA-1              PIC X VALUE '/'.
  3222             20  DC-EDITA-DAY          PIC 99.
  3223             20  SLASHA-2              PIC X VALUE '/'.
  3224             20  DC-EDITA-CCYY.
  3225                 24  DC-EDITA-CENT     PIC 99.
  3226                 24  DC-EDITA-YEAR     PIC 99.
  3227         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  61
* EL050.cbl
  3228             20  DC-EDITB-MONTH        PIC 99.
  3229             20  SLASHB-1              PIC X VALUE '/'.
  3230             20  DC-EDITB-DAY          PIC 99.
  3231             20  SLASHB-2              PIC X VALUE '/'.
  3232             20  DC-EDITB-CCYY.
  3233                 24  DC-EDITB-CENT     PIC 99.
  3234                 24  DC-EDITB-YEAR     PIC 99.
  3235         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3236         16  DC-GREG-DATE-CYMD-R REDEFINES
  3237                              DC-GREG-DATE-CYMD.
  3238             20  DC-CYMD-CEN           PIC 99.
  3239             20  DC-CYMD-YEAR          PIC 99.
  3240             20  DC-CYMD-MONTH         PIC 99.
  3241             20  DC-CYMD-DAY           PIC 99.
  3242         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3243         16  DC-GREG-DATE-MDCY-R REDEFINES
  3244                              DC-GREG-DATE-MDCY.
  3245             20  DC-MDCY-MONTH         PIC 99.
  3246             20  DC-MDCY-DAY           PIC 99.
  3247             20  DC-MDCY-CEN           PIC 99.
  3248             20  DC-MDCY-YEAR          PIC 99.
  3249    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3250        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3251    12  DC-EL310-DATE                  PIC X(21).
  3252    12  FILLER                         PIC X(28).
  3253
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  62
* EL050.cbl
  3255*    COPY ELCCALC.
  3256******************************************************************
  3257*                                                                *
  3258*                           ELCCALC.                            *
  3259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3260*                            VMOD=2.025                          *
  3261*                                                                *
  3262*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3263*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3264*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3265*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3266*                                                                *
  3267*  PASSED TO ELRTRM                                              *
  3268*  -----------------                                             *
  3269*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3270*  ORIGINAL TERM                                                 *
  3271*  BEGINNING DATE                                                *
  3272*  ENDING DATE                                                   *
  3273*  COMPANY I.D.                                                  *
  3274*  ACCOUNT MASTER USER FIELD                                     *
  3275*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3276*  FREE LOOK DAYS                                                *
  3277*                                                                *
  3278*  RETURNED FROM ELRTRM                                          *
  3279*  ---------------------                                         *
  3280*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3281*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3282*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3283*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3284*----------------------------------------------------------------*
  3285*  PASSED TO ELRAMT                                              *
  3286*  ----------------                                              *
  3287*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3288*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3289*  ORIGINAL AMOUNT                                               *
  3290*  ALTERNATE BENEFIT (BALLON)                                    *
  3291*  A.P.R. - NET PAY ONLY                                         *
  3292*  METHOD
  3293*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3294*  COMPANY I.D.                                                  *
  3295*  BENEFIT TYPE                                                  *
  3296*                                                                *
  3297*  RETURNED FROM ELRAMT                                          *
  3298*  --------------------                                          *
  3299*  REMAINING AMOUNT 1 - CURRENT                                  *
  3300*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3301*  REMAINING AMOUNT FACTOR
  3302*----------------------------------------------------------------*
  3303*  PASSED TO ELRESV                                              *
  3304*  -----------------                                             *
  3305*  CERTIFICATE EFFECTIVE DATE                                    *
  3306*  VALUATION DATE                                                *
  3307*  PAID THRU DATE                                                *
  3308*  BENEFIT                                                       *
  3309*  INCURRED DATE                                                 *
  3310*  REPORTED DATE                                                 *
  3311*  ISSUE AGE                                                     *
  3312*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  63
* EL050.cbl
  3313*  CDT PERCENT                                                   *
  3314*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3315* *CLAIM TYPE (LIFE, A/H)                                        *
  3316* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3317* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3318*                                                                *
  3319*  RETURNED FROM ELRESV                                          *
  3320*  --------------------                                          *
  3321*  CDT TABLE USED                                                *
  3322*  CDT FACTOR USED                                               *
  3323*  PAY TO CURRENT RESERVE                                        *
  3324*  I.B.N.R. - A/H ONLY                                           *
  3325*  FUTURE (ACCRUED) AH ONLY                                      *
  3326*----------------------------------------------------------------*
  3327*  PASSED TO ELRATE                                              *
  3328*  ----------------                                              *
  3329*  CERT ISSUE DATE                                               *
  3330*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3331*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3332*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3333*  STATE CODE (CLIENT DEFINED)                                   *
  3334*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3335*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3336*  DEVIATION CODE                                                *
  3337*  ISSUE AGE                                                     *
  3338*  ORIGINAL BENEFIT AMOUNT                                       *
  3339*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3340*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3341*  BENEFIT KIND (LIFE OR A/H)                                    *
  3342*  A.P.R.                                                        *
  3343*  METHOD
  3344*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3345*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3346*  COMPANY I.D. (3 CHARACTER)                                    *
  3347*  BENEFIT CODE                                                  *
  3348*  BENEFIT OVERRIDE CODE                                         *
  3349*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3350*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3351*  JOINT INDICATOR (CSL ONLY)                                    *
  3352*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3353*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3354*                                                                *
  3355*  RETURNED FROM ELRATE                                          *
  3356*  --------------------                                          *
  3357*  CALCULATED PREMIUM                                            *
  3358*  PREMIUM RATE                                                  *
  3359*  MORTALITY CODE                                                *
  3360*  MAX ATTAINED AGE                                              *
  3361*  MAX AGE                                                       *
  3362*  MAX TERM                                                      *
  3363*  MAX MONTHLY BENEFIT                                           *
  3364*  MAX TOTAL BENIFIT                                             *
  3365*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3366*----------------------------------------------------------------*
  3367*  PASSED TO ELRFND                                              *
  3368*  ----------------                                              *
  3369*  CERT ISSUE DATE                                               *
  3370*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  64
* EL050.cbl
  3371*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3372*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3373*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3374*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3375*  STATE CODE (CLIENT DEFINED)                                   *
  3376*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3377*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3378*  DEVIATION CODE                                                *
  3379*  ISSUE AGE                                                     *
  3380*  ORIGINAL BENEFIT AMOUNT                                       *
  3381*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3382*  PROCESS TYPE (CANCEL)                                         *
  3383*  BENEFIT KIND (LIFE OR A/H)                                    *
  3384*  A.P.R.                                                        *
  3385*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3386*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3387*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3388*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3389*  COMPANY I.D. (3 CHARACTER)                                    *
  3390*  BENEFIT CODE                                                  *
  3391*  BENEFIT OVERRIDE CODE                                         *
  3392*                                                                *
  3393*  RETURNED FROM ELRFND                                          *
  3394*  --------------------                                          *
  3395*  CALCULATED REFUND                                             *
  3396*----------------------------------------------------------------*
  3397*  PASSED TO ELEARN                                              *
  3398*  ----------------                                              *
  3399*  CERT ISSUE DATE                                               *
  3400*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3401*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3402*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3403*  STATE CODE (CLIENT DEFINED)                                   *
  3404*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3405*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3406*  DEVIATION CODE                                                *
  3407*  ISSUE AGE                                                     *
  3408*  ORIGINAL BENEFIT AMOUNT                                       *
  3409*  BENEFIT KIND (LIFE OR A/H)                                    *
  3410*  A.P.R.                                                        *
  3411*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3412*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3413*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3414*  COMPANY I.D. (3 CHARACTER)                                    *
  3415*  BENEFIT CODE                                                  *
  3416*  BENEFIT OVERRIDE CODE                                         *
  3417*                                                                *
  3418*  RETURNED FROM ELEARN                                          *
  3419*  --------------------                                          *
  3420*  INDICATED  EARNINGS                                           *
  3421*----------------------------------------------------------------*
  3422*                 LENGTH = 450                                   *
  3423*                                                                *
  3424******************************************************************
  3425******************************************************************
  3426*                   C H A N G E   L O G
  3427*
  3428* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  65
* EL050.cbl
  3429*-----------------------------------------------------------------
  3430*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3431* EFFECTIVE    NUMBER
  3432*-----------------------------------------------------------------
  3433* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3434* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3435* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3436* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3437* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3438* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3439* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3440* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3441* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3442******************************************************************
  3443
  3444 01  CALCULATION-PASS-AREA.
  3445     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3446                                     COMP.
  3447
  3448     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3449       88  NO-CP-ERROR                             VALUE ZERO.
  3450       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3451                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3452       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3453       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3454       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3455       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3456       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3457       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3458       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3459       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3460       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3461       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3462       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3463       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3464       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3465       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3466       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3467       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3468       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3469
  3470     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3471       88  NO-CP-ERROR-2                           VALUE ZERO.
  3472***********************  INPUT AREAS ****************************
  3473
  3474     12  CP-CALCULATION-AREA.
  3475         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3476         16  CP-CERT-EFF-DT        PIC XX.
  3477         16  CP-VALUATION-DT       PIC XX.
  3478         16  CP-PAID-THRU-DT       PIC XX.
  3479         16  CP-BENEFIT-TYPE       PIC X.
  3480           88  CP-AH                               VALUE 'A' 'D'
  3481                                                   'I' 'U'.
  3482           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3483           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3484         16  CP-INCURRED-DT        PIC XX.
  3485         16  CP-REPORTED-DT        PIC XX.
  3486         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  66
* EL050.cbl
  3487         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3488         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3489                                     COMP-3.
  3490         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3491                                     COMP-3.
  3492         16  CP-CDT-METHOD         PIC X.
  3493           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3494           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3495           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3496         16  CP-CLAIM-TYPE         PIC X.
  3497           88  CP-AH-CLAIM                         VALUE 'A'.
  3498           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3499         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3506                                     COMP-3.
  3507         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3510                                     COMP-3.
  3511         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3512                                     COMP-3.
  3513         16  CP-REM-TERM-METHOD    PIC X.
  3514           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3515           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3516           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3517           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3518           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3519           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3520           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3521         16  CP-EARNING-METHOD     PIC X.
  3522           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3523           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3524           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3525           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3526           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3527           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3528           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3529           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3530           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3531           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3532           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3533           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3534           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3535           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3536         16  CP-PROCESS-TYPE       PIC X.
  3537           88  CP-CLAIM                            VALUE '1'.
  3538           88  CP-CANCEL                           VALUE '2'.
  3539           88  CP-ISSUE                            VALUE '3'.
  3540         16  CP-SPECIAL-CALC-CD    PIC X.
  3541           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3542           88  CP-1-MTH-INTEREST               VALUE ' '.
  3543           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3544           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  67
* EL050.cbl
  3545           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3546           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3547           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3548           88  CP-FARM-PLAN                    VALUE 'F'.
  3549           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3550           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3551           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3552           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3553           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3554           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3555           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3556           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3557           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3558           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3559                                                     'W' 'X'.
  3560           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3561           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3562           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3563           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3564           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3565           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3566           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3567           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3568           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3569           88  CP-CSL-METH-1                   VALUE '5'.
  3570           88  CP-CSL-METH-2                   VALUE '6'.
  3571           88  CP-CSL-METH-3                   VALUE '7'.
  3572           88  CP-CSL-METH-4                   VALUE '8'.
  3573
  3574         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3575                                     COMP-3.
  3576         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3577         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3578         16  CP-STATE              PIC XX          VALUE SPACE.
  3579         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3580         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3581           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3582               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3583         16  CP-R78-OPTION         PIC X.
  3584           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3585           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3586
  3587         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3588         16  CP-IBNR-RESERVE-SW    PIC X.
  3589         16  CP-CLAIM-STATUS       PIC X.
  3590         16  CP-RATE-FILE          PIC X.
  3591         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3592                                     COMP-3.
  3593
  3594         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3595         16  CP-AH-OVERRIDE-CODE   PIC X.
  3596
  3597         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3600                                   PIC S9(5)V99 COMP-3.
  3601         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  68
* EL050.cbl
  3603         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3604                                     COMP-3.
  3605         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3606                                     COMP-3.
  3607         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3608                                  PIC S9(7)V99 COMP-3.
  3609
  3610         16  CP-PAID-FROM-DATE     PIC X(02).
  3611         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3612         16  CP-EXT-DAYS-CALC      PIC X.
  3613           88  CP-EXT-NO-CHG                   VALUE ' '.
  3614           88  CP-EXT-CHG-LF                   VALUE '1'.
  3615           88  CP-EXT-CHG-AH                   VALUE '2'.
  3616           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3617         16  CP-DOMICILE-STATE     PIC XX.
  3618         16  CP-CARRIER            PIC X.
  3619         16  CP-REIN-FLAG          PIC X.
  3620         16  CP-REM-TRM-CALC-OPTION PIC X.
  3621           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3622                      '2' '3' '4' '5'.
  3623           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3624           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3625           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3626           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3627           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3628           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3629           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3630           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3631         16  CP-SIG-SWITCH         PIC X.
  3632         16  CP-RATING-METHOD      PIC X.
  3633           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3634           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3635           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3636           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3637           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3638           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3639           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3640           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3641           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3642         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3643                                     COMP-3.
  3644         16  CP-BEN-CATEGORY       PIC X.
  3645         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3646         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3647                                   PIC S99V9(5) COMP-3.
  3648         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3649         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3650                                   PIC S99V9(5) COMP-3.
  3651         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3652         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3653         16  CP-EXPIRE-DT          PIC XX.
  3654         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3655         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3656         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3657         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3658         16  CP-DDF-SPEC-CALC      PIC X.
  3659             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3660             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  69
* EL050.cbl
  3661         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3662         16  CP-CANCEL-REASON      PIC X.
  3663         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3664         16  CP-PMT-MODE           PIC X.
  3665         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3666         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3667         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3668         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3669         16  FILLER                PIC X.
  3670
  3671***************    OUTPUT FROM ELRESV   ************************
  3672
  3673         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3674
  3675         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3680                                     COMP-3.
  3681         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3682                                     COMP-3.
  3683         16  FILLER                PIC X(09).
  3684***************    OUTPUT FROM ELRTRM   *************************
  3685
  3686         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3689                                     COMP-3.
  3690         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3693                                     COMP-3.
  3694         16  FILLER                PIC X(12).
  3695
  3696***************    OUTPUT FROM ELRAMT   *************************
  3697
  3698         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3701                                     COMP-3.
  3702         16  FILLER                PIC X(12).
  3703
  3704***************    OUTPUT FROM ELRATE   *************************
  3705
  3706         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-MORTALITY-CODE     PIC X(4).
  3711         16  CP-RATE-EDIT-FLAG     PIC X.
  3712             88  CP-RATES-NEED-APR                  VALUE '1'.
  3713         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3716         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3717         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3718                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  70
* EL050.cbl
  3719         16  FILLER                PIC X(07).
  3720
  3721***************    OUTPUT FROM ELRFND   *************************
  3722
  3723         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-REFUND-TYPE-USED   PIC X.
  3726           88  CP-R-AS-R78                         VALUE '1'.
  3727           88  CP-R-AS-PRORATA                     VALUE '2'.
  3728           88  CP-R-AS-CALIF                       VALUE '3'.
  3729           88  CP-R-AS-TEXAS                       VALUE '4'.
  3730           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3731           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3732           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3733           88  CP-R-AS-MEAN                        VALUE '8'.
  3734           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3735           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3736           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3737           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3738           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3739           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3740         16  FILLER                PIC X(12).
  3741
  3742***************    OUTPUT FROM ELEARN   *************************
  3743
  3744         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-EARNING-TYPE-USED  PIC X.
  3757           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3758           88  CP-E-AS-R78                         VALUE '1'.
  3759           88  CP-E-AS-PRORATA                     VALUE '2'.
  3760           88  CP-E-AS-TEXAS                       VALUE '4'.
  3761           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3762           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3763           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3764           88  CP-E-AS-MEAN                        VALUE '8'.
  3765           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3766         16  FILLER                PIC X(12).
  3767
  3768***************    OUTPUT FROM ELPMNT   *************************
  3769
  3770         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  FILLER                PIC X(12).
  3775
  3776***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  71
* EL050.cbl
  3777         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3790             88  OPEN-RATE-FILE                   VALUE 'O'.
  3791             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3792             88  IO-ERROR                         VALUE 'E'.
  3793
  3794         16  CP-FIRST-PAY-DATE     PIC XX.
  3795
  3796         16  CP-JOINT-INDICATOR    PIC X.
  3797
  3798         16  CP-RESERVE-REMAINING-TERM
  3799                                   PIC S9(4)V9    VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-INSURED-BIRTH-DT   PIC XX.
  3803
  3804         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3805                                     COMP-3.
  3806
  3807         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3808                                     COMP-3.
  3809
  3810         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3811                                     COMP-3.
  3812
  3813         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3814                                     COMP-3.
  3815
  3816         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3817                                     COMP-3.
  3818
  3819         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3820                                     COMP-3.
  3821
  3822         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3823                                     COMP-3.
  3824
  3825         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3826             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3827
  3828         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3833         16  FILLER                PIC X(15).
  3834******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  72
* EL050.cbl
  3836******************************************************************
  3837*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3838*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3839*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3840*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3841*** MODIFICATION.                                              ***
  3842*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3843*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3844******************************************************************
  3845*    COPY ERCPNDB.
  3846******************************************************************
  3847*                                                                *
  3848*                                                                *
  3849*                            ERCPNDB.                            *
  3850*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3851*                            VMOD=2.025                          *
  3852*                                                                *
  3853*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3854*                                                                *
  3855******************************************************************
  3856*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3857*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3858******************************************************************
  3859*                                                                *
  3860*                                                                *
  3861*   FILE TYPE = VSAM,KSDS                                        *
  3862*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3863*                                                                *
  3864*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3865*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3866*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3867*                                                 RKP=13,LEN=36  *
  3868*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3869*                                      AND CHG-SEQ.)             *
  3870*                                                RKP=49,LEN=11   *
  3871*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3872*                                      AND CHG-SEQ.)             *
  3873*                                                RKP=60,LEN=15   *
  3874*                                                                *
  3875*   LOG = NO                                                     *
  3876*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3877******************************************************************
  3878******************************************************************
  3879*                   C H A N G E   L O G
  3880*
  3881* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3882*-----------------------------------------------------------------
  3883*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3884* EFFECTIVE    NUMBER
  3885*-----------------------------------------------------------------
  3886* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3887* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3888* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3889* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3890* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3891* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3892* 032306                   PEMA  ADD BOW LOAN NUMBER
  3893* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  73
* EL050.cbl
  3894* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3895* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3896* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3897* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3898* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3899* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3900* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3901******************************************************************
  3902
  3903 01  PENDING-BUSINESS.
  3904     12  PB-RECORD-ID                     PIC XX.
  3905         88  VALID-PB-ID                        VALUE 'PB'.
  3906
  3907     12  PB-CONTROL-PRIMARY.
  3908         16  PB-COMPANY-CD                PIC X.
  3909         16  PB-ENTRY-BATCH               PIC X(6).
  3910         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3911         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3912
  3913     12  PB-CONTROL-BY-ACCOUNT.
  3914         16  PB-COMPANY-CD-A1             PIC X.
  3915         16  PB-CARRIER                   PIC X.
  3916         16  PB-GROUPING.
  3917             20  PB-GROUPING-PREFIX       PIC XXX.
  3918             20  PB-GROUPING-PRIME        PIC XXX.
  3919         16  PB-STATE                     PIC XX.
  3920         16  PB-ACCOUNT.
  3921             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3922             20  PB-ACCOUNT-PRIME         PIC X(6).
  3923         16  PB-CERT-EFF-DT               PIC XX.
  3924         16  PB-CERT-NO.
  3925             20  PB-CERT-PRIME            PIC X(10).
  3926             20  PB-CERT-SFX              PIC X.
  3927         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3928
  3929         16  PB-RECORD-TYPE               PIC X.
  3930             88  PB-MAILING-DATA                VALUE '0'.
  3931             88  PB-ISSUE                       VALUE '1'.
  3932             88  PB-CANCELLATION                VALUE '2'.
  3933             88  PB-BATCH-TRAILER               VALUE '9'.
  3934
  3935     12  PB-CONTROL-BY-ORIG-BATCH.
  3936         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3937         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3938         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3939         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3940
  3941     12  PB-CONTROL-BY-CSR.
  3942         16  PB-CSR-COMPANY-CD            PIC X.
  3943         16  PB-CSR-ID                    PIC X(4).
  3944         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3945         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3946         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3947******************************************************************
  3948*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3949******************************************************************
  3950
  3951     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  74
* EL050.cbl
  3952     12  PB-LAST-MAINT-BY                 PIC X(4).
  3953     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3954
  3955     12  PB-RECORD-BODY                   PIC X(375).
  3956
  3957     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3958         16  PB-CERT-ORIGIN               PIC X.
  3959             88  CLASIC-CREATED-CERT         VALUE '1'.
  3960         16  PB-I-NAME.
  3961             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3962             20  PB-I-INSURED-FIRST-NAME.
  3963                 24  PB-I-INSURED-1ST-INIT PIC X.
  3964                 24  FILLER                PIC X(9).
  3965             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3966         16  PB-I-AGE                     PIC S99   COMP-3.
  3967         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3968         16  PB-I-BIRTHDAY                PIC XX.
  3969         16  PB-I-INSURED-SEX             PIC X.
  3970             88  PB-SEX-MALE     VALUE 'M'.
  3971             88  PB-SEX-FEMALE   VALUE 'F'.
  3972
  3973         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3974         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3975         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3976         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3977         16  PB-I-SKIP-CODE               PIC X.
  3978             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3979             88  PB-SKIP-JULY              VALUE '1'.
  3980             88  PB-SKIP-AUGUST            VALUE '2'.
  3981             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3982             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3983             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3984             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3985             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3986             88  PB-SKIP-JUNE              VALUE '8'.
  3987             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3988             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3989             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3990         16  PB-I-TERM-TYPE               PIC X.
  3991             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3992             88  PB-PAID-WEEKLY            VALUE 'W'.
  3993             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3994             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3995             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3996         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3997         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3998         16  PB-I-DATA-ENTRY-SW           PIC X.
  3999             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4000             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4001             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4002             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4003         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4004         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4005*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4006         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4007         16  FILLER                       PIC X.
  4008
  4009         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  75
* EL050.cbl
  4010             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4011             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4012                                                   '90' THRU '99'.
  4013         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4014                                          PIC XX.
  4015         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4016         16  PB-I-AMOUNT-FINANCED REDEFINES
  4017                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4018         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4019         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4020                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4021         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4022         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4023         16  PB-I-CLP-AMOUNT REDEFINES
  4024                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4025         16  PB-I-LF-CALC-FLAG            PIC X.
  4026             88 PB-COMP-LF-PREM               VALUE '?'.
  4027         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4028         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4029         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4030         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4031         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4032         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4033         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4034         16  PB-I-LF-ABBR                 PIC XXX.
  4035         16  PB-I-LF-INPUT-CD             PIC XX.
  4036
  4037         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4038             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4039             88  PB-INVALID-AH               VALUE '  ' '00'
  4040                                                   '90' THRU '99'.
  4041         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4042         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4043         16  PB-I-AH-CALC-FLAG            PIC X.
  4044             88 PB-COMP-AH-PREM                  VALUE '?'.
  4045         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4046         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4047         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4048         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4049         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4050         16  PB-I-AH-ABBR                 PIC XXX.
  4051         16  PB-I-AH-INPUT-CD             PIC XXX.
  4052
  4053         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4054         16  PB-I-REIN-TABLE              PIC XXX.
  4055         16  PB-I-BUSINESS-TYPE           PIC 99.
  4056         16  PB-I-INDV-GRP-CD             PIC X.
  4057         16  PB-I-MORT-CODE.
  4058             20  PB-I-TABLE               PIC X.
  4059             20  PB-I-INTEREST            PIC XX.
  4060             20  PB-I-MORT-TYP            PIC X.
  4061         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4062         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4063         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4064         16  PB-I-INDV-GRP-OVRD           PIC X.
  4065         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4066         16  PB-I-SIG-SW                  PIC X.
  4067             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  76
* EL050.cbl
  4068         16  PB-I-RATE-CLASS              PIC XX.
  4069         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4070         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4071         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4072         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4073         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4074         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4075         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4076         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4077         16  PB-I-OB-FLAG                 PIC X.
  4078             88  PB-I-OB                      VALUE 'B'.
  4079             88  PB-I-SUMMARY                 VALUE 'Z'.
  4080         16  PB-I-ENTRY-STATUS            PIC X.
  4081             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4082                                              'M' '5' '9' '2'.
  4083             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4084             88  PB-I-POLICY-PENDING          VALUE '2'.
  4085             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4086             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4087             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4088             88  PB-I-REIN-ONLY               VALUE '9'.
  4089             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4090             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4091             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4092             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4093         16  PB-I-INT-CODE                PIC X.
  4094             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4095             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4096         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4097         16  PB-I-SOC-SEC-NO              PIC X(11).
  4098         16  PB-I-MEMBER-NO               PIC X(12).
  4099         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4100*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4101         16  PB-I-OLD-LOF                 PIC XXX.
  4102         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4103         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4104         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4105         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4106         16  PB-I-LIFE-INDICATOR          PIC X.
  4107             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4108         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4109         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4110                                          PIC S9(5)V99    COMP-3.
  4111         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4112             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4113             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4114         16  PB-I-1ST-PMT-DT              PIC XX.
  4115         16  PB-I-JOINT-INSURED.
  4116             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4117             20 PB-I-JOINT-FIRST-NAME.
  4118                24  PB-I-JOINT-FIRST-INIT PIC X.
  4119                24  FILLER                PIC X(9).
  4120             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4121*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4122         16  PB-I-BENEFICIARY-NAME.
  4123             20  PB-I-BANK-NUMBER         PIC X(10).
  4124             20  FILLER                   PIC X(15).
  4125         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  77
* EL050.cbl
  4126         16  PB-I-REFERENCE               PIC X(12).
  4127         16  FILLER REDEFINES PB-I-REFERENCE.
  4128             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4129             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4130             20  PB-I-CLP-STATE           PIC XX.
  4131         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4132             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4133             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4134             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4135         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4136         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4137         16  PB-I-RESIDENT-STATE          PIC XX.
  4138         16  PB-I-RATE-CODE               PIC X(4).
  4139         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4140         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4141         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4142         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4143         16  PB-I-BANK-NOCHRGB            PIC 99.
  4144         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4145         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4146
  4147     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4148         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4149             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4150         16  PB-C-CANCEL-ORIGIN           PIC X.
  4151             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4152         16  PB-C-LF-CANCEL-DT            PIC XX.
  4153         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4154         16  PB-C-LF-CALC-REQ             PIC X.
  4155             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4156         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4157         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4158         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4159             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4160         16  PB-C-AH-CANCEL-DT            PIC XX.
  4161         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4162         16  PB-C-AH-CALC-REQ             PIC X.
  4163             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4164         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4165         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4166         16  PB-C-LAST-NAME               PIC X(15).
  4167         16  PB-C-REFUND-SW               PIC X.
  4168             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4169             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4170         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4171         16  PB-C-PAYEE-CODE              PIC X(6).
  4172         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4173         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4174         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4175         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4176         16  PB-C-REFERENCE               PIC X(12).
  4177         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4178         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4179         16  PB-C-POST-CARD-IND           PIC X.
  4180         16  PB-C-CANCEL-REASON           PIC X.
  4181         16  PB-C-REF-INTERFACE-SW        PIC X.
  4182         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4183         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  78
* EL050.cbl
  4184         16  FILLER                       PIC X(01).
  4185*        16  FILLER                       PIC X(18).
  4186         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4187*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4188         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4189         16  PB-CANCELED-CERT-DATA.
  4190             20  PB-CI-INSURED-NAME.
  4191                 24  PB-CI-LAST-NAME      PIC X(15).
  4192                 24  PB-CI-INITIALS       PIC XX.
  4193             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4194             20  PB-CI-INSURED-SEX        PIC X.
  4195             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4196             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4197             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4198             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4199             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4200             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4201             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4202             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4203             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4204             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4205             20  PB-CI-RATE-CLASS         PIC XX.
  4206             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4207             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4208             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4209             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4210             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4211             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4212             20  PB-CI-LF-ABBR            PIC X(3).
  4213             20  PB-CI-AH-ABBR            PIC X(3).
  4214             20  PB-CI-OB-FLAG            PIC X.
  4215                 88  PB-CI-OB                VALUE 'B'.
  4216             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4217                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4218                                           'M' '4' '5' '9' '2'.
  4219                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4220                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4221                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4222                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4223                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4224                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4225                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4226                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4227                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4228                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4229                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4230                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4231             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4232                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4233                                           'M' '4' '5' '9' '2'.
  4234                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4235                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4236                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4237                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4238                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4239                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4240                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4241                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  79
* EL050.cbl
  4242                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4243                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4244                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4245                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4246             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4247             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4248             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4249             20  PB-CI-MEMBER-NO          PIC X(12).
  4250             20  PB-CI-INT-CODE           PIC X.
  4251                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4252                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4253             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4254             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4255             20  PB-CI-COMP-EXCP-SW       PIC X.
  4256                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4257                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4258             20  PB-CI-ENTRY-STATUS       PIC X.
  4259             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4260             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4261             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4262             20  PB-CI-DEATH-DT           PIC XX.
  4263             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4264             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4265             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4266             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4267             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4268             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4269             20  PB-CI-ENTRY-DT              PIC XX.
  4270             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4271             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4272             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4273             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4274             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4275             20  PB-CI-OLD-LOF               PIC XXX.
  4276*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4277             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4278             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4279             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4280             20  PB-CI-INDV-GRP-CD           PIC X.
  4281             20  PB-CI-BENEFICIARY-NAME.
  4282                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4283                 24  FILLER                  PIC X(15).
  4284             20  PB-CI-NOTE-SW               PIC X.
  4285             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4286             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4287             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4288             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4289             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4290             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4291             20  PB-CI-FIRST-NAME            PIC X(10).
  4292             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4293
  4294         16  FILLER                       PIC X(13).
  4295*032306  16  FILLER                       PIC X(27).
  4296*        16  FILLER                       PIC X(46).
  4297
  4298     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4299         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  80
* EL050.cbl
  4300         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4301         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4302         16  PB-M-INSURED-MID-INIT        PIC X.
  4303         16  PB-M-INSURED-AGE             PIC 99.
  4304         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4305         16  PB-M-INSURED-SEX             PIC X.
  4306         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4307         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4308         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4309         16  PB-M-INSURED-CITY-STATE.
  4310             20  PB-M-INSURED-CITY        PIC X(28).
  4311             20  PB-M-INSURED-STATE       PIC XX.
  4312         16  PB-M-INSURED-ZIP-CODE.
  4313             20  PB-M-INSURED-ZIP-PRIME.
  4314                 24  PB-M-INSURED-ZIP-1   PIC X.
  4315                     88  PB-M-CANADIAN-POST-CODE
  4316                                             VALUE 'A' THRU 'Z'.
  4317                 24  FILLER               PIC X(4).
  4318             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4319         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4320                                        PB-M-INSURED-ZIP-CODE.
  4321             20  PM-M-INS-CAN-POST1       PIC XXX.
  4322             20  PM-M-INS-CAN-POST2       PIC XXX.
  4323             20  FILLER                   PIC XXX.
  4324         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4325         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4326         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4327         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4328         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4329         16  PB-M-CRED-BENE-CITYST.
  4330             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4331             20  PB-M-CRED-BENE-STATE     PIC XX.
  4332         16  FILLER                       PIC X(92).
  4333
  4334     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4335         16  FILLER                       PIC X(10).
  4336         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4337         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4338         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4339         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4340         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4341         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4342         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4343         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4344         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4345         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4346         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4347         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4348         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4349         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4350         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4351         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4352         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4353         16  PB-ACCOUNT-NAME              PIC X(30).
  4354         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4355         16  PB-REFERENCE                 PIC X(12).
  4356         16  PB-B-RECEIVED-DT             PIC XX.
  4357         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  81
* EL050.cbl
  4358
  4359     12  PB-RECORD-STATUS.
  4360         16  PB-CREDIT-SELECT-DT          PIC XX.
  4361         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4362         16  PB-BILLED-DT                 PIC XX.
  4363         16  PB-BILLING-STATUS            PIC X.
  4364             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4365             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4366             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4367         16  PB-RECORD-BILL               PIC X.
  4368             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4369             88  PB-RECORD-RETURNED           VALUE 'R'.
  4370             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4371             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4372             88  PB-OVERRIDE-AH               VALUE 'A'.
  4373             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4374         16  PB-BATCH-ENTRY               PIC X.
  4375             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4376             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4377             88  PB-REISSUED-CERT             VALUE 'E'.
  4378             88  PB-MONTHLY-CERT              VALUE 'M'.
  4379             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4380             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4381             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4382         16  PB-FORCE-CODE                PIC X.
  4383             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4384             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4385             88  PB-CANCEL-FORCE              VALUE '8'.
  4386             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4387             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4388             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4389             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4390             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4391             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4392             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4393         16  PB-FATAL-FLAG                PIC X.
  4394             88  PB-FATAL-ERRORS              VALUE 'X'.
  4395         16  PB-FORCE-ER-CD               PIC X.
  4396             88  PB-FORCE-ERRORS              VALUE 'F'.
  4397             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4398         16  PB-WARN-ER-CD                PIC X.
  4399             88  PB-WARNING-ERRORS            VALUE 'W'.
  4400         16  FILLER                       PIC X.
  4401         16  PB-OUT-BAL-CD                PIC X.
  4402             88  PB-OUT-OF-BAL                VALUE 'O'.
  4403         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4404         16  PB-AH-OVERRIDE-L1            PIC X.
  4405         16  PB-INPUT-DT                  PIC XX.
  4406         16  PB-INPUT-BY                  PIC X(4).
  4407         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4408         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4409         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4410         16  PB-LF-EARNING-METHOD         PIC X.
  4411         16  PB-AH-EARNING-METHOD         PIC X.
  4412         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4413         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4414         16  PB-REIN-CD                   PIC XXX.
  4415         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  82
* EL050.cbl
  4416         16  PB-AH-REFUND-TYPE            PIC X.
  4417         16  PB-ACCT-EFF-DT               PIC XX.
  4418         16  PB-ACCT-EXP-DT               PIC XX.
  4419         16  PB-COMPANY-ID                PIC X(3).
  4420         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4421         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4422         16  PB-SV-CARRIER                PIC X.
  4423         16  PB-SV-GROUPING               PIC X(6).
  4424         16  PB-SV-STATE                  PIC XX.
  4425         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4426         16  PB-GA-BILLING-INFO.
  4427             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4428                                          PIC XX.
  4429         16  PB-SV-REMIT-TO  REDEFINES
  4430             PB-GA-BILLING-INFO           PIC X(10).
  4431         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4432         16  PB-I-LOAN-OFFICER            PIC X(5).
  4433         16  PB-I-VIN                     PIC X(17).
  4434
  4435         16  FILLER                       PIC X(04).
  4436         16  IMNET-BYPASS-SW              PIC X.
  4437
  4438******************************************************************
  4439*                COMMON EDIT ERRORS                              *
  4440******************************************************************
  4441
  4442     12  PB-COMMON-ERRORS.
  4443         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4444                                           PIC S9(4)     COMP.
  4445
  4446******************************************************************
  4447
  4448* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4449*    COPY ELC50W1.
  4450******************************************************************
  4451*                                                                *
  4452*                                                                *
  4453*                             ELC50W1                            *
  4454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4455*                            VMOD=2.004                          *
  4456*                                                                *
  4457*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4458*                                                                *
  4459*                                                                *
  4460******************************************************************
  4461
  4462     12  WK-WORK-AREA.
  4463         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4464         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4465         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4466         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4467         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4468         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4469         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4470         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4471         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4472         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4473         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  83
* EL050.cbl
  4474         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4475         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4476         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4477         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4478         16  WK-CREDIT-EDIT-CONTROLS.
  4479             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4480             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4481             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4482             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4483             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4484             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4485         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4486         16  WK-SAVE-REIN-DATA.
  4487             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4488             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4489             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4490         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4491             88  ENTRY-FROM-EL6311       VALUE '6'.
  4492         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4493         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4494     12  WK-RECORD-ADDRESSES.
  4495         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4496         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4497         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4498         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4499         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4500         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4501         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4502         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4503     12  WK-OVER-SHORT-AREA.
  4504         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4505         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4506         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4507             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4508         16  FILLER                   PIC X(5) VALUE SPACES.
  4509
  4510*    COPY ELCEDITC.
  4511******************************************************************
  4512*                                                                *
  4513*                                                                *
  4514*                            ELCEDITC                            *
  4515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4516*                            VMOD=2.012                          *
  4517*                                                                *
  4518*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4519*                     EL6313, EL050 AND EL517.                   *
  4520*                                                                *
  4521******************************************************************
  4522******************************************************************
  4523*                   C H A N G E   L O G
  4524*
  4525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4526*-----------------------------------------------------------------
  4527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4528* EFFECTIVE    NUMBER
  4529*-----------------------------------------------------------------
  4530* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4531******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  84
* EL050.cbl
  4532
  4533     12  EDIT-CRITERIA-DATA.
  4534         16  EC-CO-MONTH-END-DT       PIC XX.
  4535         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4536         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4537         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4538         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4539         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4540         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4541         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4542         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4543         16  EC-CO-REM-TERM-CALC      PIC X.
  4544               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4545               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4546               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4547               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4548
  4549         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4550               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4551               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4552               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4553               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4554               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4555               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4556               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4557               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4558               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4559               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4560
  4561         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4562               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4563               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4564               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4565               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4566               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4567               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4568               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4569               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4570
  4571         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4572                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4573                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4574
  4575         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4576                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4577                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4578                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4579                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4580                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4581                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4582                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4583                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4584
  4585         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4586               88  EC-BR-REDUCING                   VALUE 'R'.
  4587               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4588
  4589         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  85
* EL050.cbl
  4590         16  EC-BR-LF-DESC             PIC X(10).
  4591         16  EC-BR-AH-DESC             PIC X(10).
  4592         16  EC-BR-LF-COMMENT          PIC X(10).
  4593         16  EC-BR-AH-COMMENT          PIC X(10).
  4594
  4595         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4596               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4597               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4598               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4599               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4600
  4601         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4602               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4603               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4604               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4605               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4606
  4607         16  EC-BR-LF-REFUND-CALC      PIC X.
  4608                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4609                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4610                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4611                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4612                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4613                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4614                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4615
  4616         16  EC-BR-AH-REFUND-CALC      PIC X.
  4617                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4618                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4619                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4620                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4621                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4622                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4623                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4624                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4625
  4626         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4627                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4628                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4629                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4630
  4631         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4632                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4633                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4634                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4635
  4636         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4637         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4638         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4639         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4640
  4641         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4642         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4643                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4644                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4645                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4646                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4647
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  86
* EL050.cbl
  4648         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4649               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4650               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4651               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4652               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4653               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4654
  4655         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4656               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4657               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4658               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4659               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4660               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4661
  4662         16  EC-ST-LF-REFUND-CALC      PIC X.
  4663                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4664                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4665                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4666                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4667                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4668                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4669                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4670                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4671
  4672         16  EC-ST-AH-REFUND-CALC      PIC X.
  4673                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4674                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4675                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4676                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4677                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4678                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4679                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4680                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4681
  4682         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4683         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4684         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4685         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4686         16  EC-AM-EXPIRATION-DT       PIC XX.
  4687         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4688         16  EC-AM-CLASS-CD            PIC XX.
  4689         16  EC-AM-LF-DEVIATION        PIC XXX.
  4690         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4691         16  EC-AM-AH-DEVIATION        PIC XXX.
  4692         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4693         16  EC-AM-PHONE-NO            PIC X(10).
  4694
  4695         16  EC-AM-LF-REFUND-CALC      PIC X.
  4696                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4697                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4698                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4699                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4700                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4701                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4702                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4703
  4704         16  EC-AM-AH-REFUND-CALC      PIC X.
  4705                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  87
* EL050.cbl
  4706                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4707                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4708                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4709                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4710                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4711                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4712
  4713         16  EC-AM-BEN-I-G-CD          PIC X.
  4714                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4715                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4716                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4717
  4718         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4723         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4724         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4725         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4726         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4727
  4728         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4729         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4730         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4731         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4732         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4733         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4734         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4735         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4736         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4737         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4738         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4739         16  EC-RT-LF-NSP-ST           PIC XX.
  4740         16  EC-RT-AH-NSP-ST           PIC XX.
  4741         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4742         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4743
  4744         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4745             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4746                                             'M' '5' '9' '2'.
  4747             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4748             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4749             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4750             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4751             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4752             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4753             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4754             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4755             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4756             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4757
  4758         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4759             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4760                                             'M' '5' '9' '2'.
  4761             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4762             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4763             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  88
* EL050.cbl
  4764             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4765             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4766             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4767             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4768             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4769             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4770             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4771
  4772         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4773         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4774         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4775         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4776         16  EC-CM-DEATH-DT            PIC XX.
  4777
  4778*DMD CUSTOM CODING FIELDS BELOW
  4779*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4780         16  EC-BR-DMD-RATING-SW       PIC X.
  4781                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4782                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4783                 88  NO-DMD-RATING               VALUE 'N'.
  4784
  4785         16  EC-NEW-CERT               PIC X(11).
  4786         16  EC-NEW-STATE              PIC XX.
  4787         16  FILLER                    PIC X.
  4788*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4789         16  OVER-SHORT-EDIT-FIELDS.
  4790             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4791             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4792             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4793             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4794             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4795             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4796             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4797             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4798             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4799         16  FILLER                    PIC X(71).
  4800******************************************************************
  4801
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  89
* EL050.cbl
  4803*    COPY ELCDIFRD.
  4804******************************************************************
  4805*                                                                *
  4806*                                                                *
  4807*                            ELCDIFRD.                           *
  4808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4809*                            VMOD=2.004                          *
  4810*                                                                *
  4811*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4812*                                                                *
  4813******************************************************************
  4814*
  4815  01  WS-DIFFERENCE-CALCULATION.
  4816        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4817        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4818        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4819        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4820        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4821        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4822        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4823        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4824        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4825        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4826        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4827
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  90
* EL050.cbl
  4829****************************************************************
  4830*
  4831* Copyright (c) 2007 by Clerity Solutions, Inc.
  4832* All rights reserved.
  4833*
  4834****************************************************************
  4835 01  DFHEIV.
  4836   02  DFHEIV0               PIC X(35).
  4837   02  DFHEIV1               PIC X(08).
  4838   02  DFHEIV2               PIC X(08).
  4839   02  DFHEIV3               PIC X(08).
  4840   02  DFHEIV4               PIC X(06).
  4841   02  DFHEIV5               PIC X(04).
  4842   02  DFHEIV6               PIC X(04).
  4843   02  DFHEIV7               PIC X(02).
  4844   02  DFHEIV8               PIC X(02).
  4845   02  DFHEIV9               PIC X(01).
  4846   02  DFHEIV10              PIC S9(7) COMP-3.
  4847   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4848   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4849   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4850   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4851   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4852   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4853   02  DFHEIV17              PIC X(04).
  4854   02  DFHEIV18              PIC X(04).
  4855   02  DFHEIV19              PIC X(04).
  4856   02  DFHEIV20              USAGE IS POINTER.
  4857   02  DFHEIV21              USAGE IS POINTER.
  4858   02  DFHEIV22              USAGE IS POINTER.
  4859   02  DFHEIV23              USAGE IS POINTER.
  4860   02  DFHEIV24              USAGE IS POINTER.
  4861   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4862   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4863   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4864   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4865   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4866   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4867   02  FILLER                PIC X(02).
  4868   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4869   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4870   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4871   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4872   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4873 LINKAGE  SECTION.
  4874*****************************************************************
  4875*                                                               *
  4876* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4877* All rights reserved.                                          *
  4878*                                                               *
  4879*****************************************************************
  4880 01  dfheiblk.
  4881     02  eibtime          pic s9(7) comp-3.
  4882     02  eibdate          pic s9(7) comp-3.
  4883     02  eibtrnid         pic x(4).
  4884     02  eibtaskn         pic s9(7) comp-3.
  4885     02  eibtrmid         pic x(4).
  4886     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  91
* EL050.cbl
  4887     02  eibcposn         pic s9(4) comp.
  4888     02  eibcalen         pic s9(4) comp.
  4889     02  eibaid           pic x(1).
  4890     02  eibfiller1       pic x(1).
  4891     02  eibfn            pic x(2).
  4892     02  eibfiller2       pic x(2).
  4893     02  eibrcode         pic x(6).
  4894     02  eibfiller3       pic x(2).
  4895     02  eibds            pic x(8).
  4896     02  eibreqid         pic x(8).
  4897     02  eibrsrce         pic x(8).
  4898     02  eibsync          pic x(1).
  4899     02  eibfree          pic x(1).
  4900     02  eibrecv          pic x(1).
  4901     02  eibsend          pic x(1).
  4902     02  eibatt           pic x(1).
  4903     02  eibeoc           pic x(1).
  4904     02  eibfmh           pic x(1).
  4905     02  eibcompl         pic x(1).
  4906     02  eibsig           pic x(1).
  4907     02  eibconf          pic x(1).
  4908     02  eiberr           pic x(1).
  4909     02  eibrldbk         pic x(1).
  4910     02  eiberrcd         pic x(4).
  4911     02  eibsynrb         pic x(1).
  4912     02  eibnodat         pic x(1).
  4913     02  eibfiller5       pic x(2).
  4914     02  eibresp          pic 9(09) comp.
  4915     02  eibresp2         pic 9(09) comp.
  4916     02  dfheigdj         pic s9(4) comp.
  4917     02  dfheigdk         pic s9(4) comp.
  4918
  4919 01  DFHCOMMAREA                   PIC X(1036).
  4920
  4921*01 PARMLIST .
  4922*    02  FILLER                    PIC S9(8)   COMP.
  4923*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4924*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4925*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4926*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4927*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4928*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4929*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4930
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  92
* EL050.cbl
  4932*    COPY ELCCNTL.
  4933******************************************************************
  4934*                                                                *
  4935*                                                                *
  4936*                            ELCCNTL.                            *
  4937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4938*                            VMOD=2.059                          *
  4939*                                                                *
  4940*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4941*                                                                *
  4942*   FILE TYPE = VSAM,KSDS                                        *
  4943*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4944*                                                                *
  4945*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4946*       ALTERNATE INDEX = NONE                                   *
  4947*                                                                *
  4948*   LOG = YES                                                    *
  4949*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4950******************************************************************
  4951*                   C H A N G E   L O G
  4952*
  4953* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4954*-----------------------------------------------------------------
  4955*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4956* EFFECTIVE    NUMBER
  4957*-----------------------------------------------------------------
  4958* 082503                   PEMA  ADD BENEFIT GROUP
  4959* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4960* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4961* 092705    2005050300006  PEMA  ADD SPP LEASES
  4962* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4963* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4964* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4965* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4966* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4967* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4968* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4969* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4970* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4971******************************************************************
  4972*
  4973 01  CONTROL-FILE.
  4974     12  CF-RECORD-ID                       PIC XX.
  4975         88  VALID-CF-ID                        VALUE 'CF'.
  4976
  4977     12  CF-CONTROL-PRIMARY.
  4978         16  CF-COMPANY-ID                  PIC XXX.
  4979         16  CF-RECORD-TYPE                 PIC X.
  4980             88  CF-COMPANY-MASTER              VALUE '1'.
  4981             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4982             88  CF-STATE-MASTER                VALUE '3'.
  4983             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4984             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4985             88  CF-CARRIER-MASTER              VALUE '6'.
  4986             88  CF-MORTALITY-MASTER            VALUE '7'.
  4987             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4988             88  CF-TERMINAL-MASTER             VALUE '9'.
  4989             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  93
* EL050.cbl
  4990             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4991             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4992             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4993             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4994             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4995             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4996             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4997             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4998         16  CF-ACCESS-CD-GENL              PIC X(4).
  4999         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5000             20  CF-PROCESSOR               PIC X(4).
  5001         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5002             20  CF-STATE-CODE              PIC XX.
  5003             20  FILLER                     PIC XX.
  5004         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5005             20  FILLER                     PIC XX.
  5006             20  CF-HI-BEN-IN-REC           PIC XX.
  5007         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5008             20  FILLER                     PIC XXX.
  5009             20  CF-CARRIER-CNTL            PIC X.
  5010         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5011             20  FILLER                     PIC XX.
  5012             20  CF-HI-TYPE-IN-REC          PIC 99.
  5013         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5014             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5015                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5016             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5017             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5018         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5019             20  FILLER                     PIC X.
  5020             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5021         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5022             20  FILLER                     PIC XX.
  5023             20  CF-MORTGAGE-PLAN           PIC XX.
  5024         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5025
  5026     12  CF-LAST-MAINT-DT                   PIC XX.
  5027     12  CF-LAST-MAINT-BY                   PIC X(4).
  5028     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5029
  5030     12  CF-RECORD-BODY                     PIC X(728).
  5031
  5032
  5033****************************************************************
  5034*             COMPANY MASTER RECORD                            *
  5035****************************************************************
  5036
  5037     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5038         16  CF-COMPANY-ADDRESS.
  5039             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5040             20  CF-CL-IN-CARE-OF           PIC X(30).
  5041             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5042             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5043             20  CF-CL-CITY-STATE           PIC X(30).
  5044             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5045             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5046         16  CF-COMPANY-CD                  PIC X.
  5047         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  94
* EL050.cbl
  5048         16  CF-SECURITY-OPTION             PIC X.
  5049             88  ALL-SECURITY                   VALUE '1'.
  5050             88  COMPANY-VERIFY                 VALUE '2'.
  5051             88  PROCESSOR-VERIFY               VALUE '3'.
  5052             88  NO-SECURITY                    VALUE '4'.
  5053             88  ALL-BUT-TERM                   VALUE '5'.
  5054         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5055             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5056         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5057             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5058         16  CF-INFORCE-LOCATION            PIC X.
  5059             88  CERTS-ARE-ONLINE               VALUE '1'.
  5060             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5061             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5062         16  CF-LOWER-CASE-LETTERS          PIC X.
  5063         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5064             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5065             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5066             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5067             88  CF-ACCNT-CNTL                  VALUE '3'.
  5068             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5069
  5070         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5071         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5072
  5073         16  CF-LGX-CREDIT-USER             PIC X.
  5074             88  CO-IS-NOT-USER                 VALUE 'N'.
  5075             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5076
  5077         16 CF-CREDIT-CALC-CODES.
  5078             20  CF-CR-REM-TERM-CALC PIC X.
  5079               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5080               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5081               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5082               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5083               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5084               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5085               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5086             20  CF-CR-R78-METHOD           PIC X.
  5087               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5088               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5089
  5090         16  CF-CLAIM-CONTROL-COUNTS.
  5091             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5092                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5093
  5094             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5095                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5096
  5097             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5098                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5099
  5100             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5101                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5102
  5103         16  CF-CURRENT-MONTH-END           PIC XX.
  5104
  5105         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  95
* EL050.cbl
  5106             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5107             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5108             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5109             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5110                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5111                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5112             20  CF-CO-PREM-REJECT-SW       PIC X.
  5113                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5114                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5115             20  CF-CO-REF-REJECT-SW        PIC X.
  5116                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5117                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5118
  5119         16  CF-CO-REPORTING-DT             PIC XX.
  5120         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5121         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5122           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5123           88  CF-CO-MONTH-END                  VALUE '1'.
  5124
  5125         16  CF-LGX-CLAIM-USER              PIC X.
  5126             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5127             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5128
  5129         16  CF-CREDIT-EDIT-CONTROLS.
  5130             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5131             20  CF-MIN-AGE                 PIC 99.
  5132             20  CF-DEFAULT-AGE             PIC 99.
  5133             20  CF-MIN-TERM                PIC S999      COMP-3.
  5134             20  CF-MAX-TERM                PIC S999      COMP-3.
  5135             20  CF-DEFAULT-SEX             PIC X.
  5136             20  CF-JOINT-AGE-INPUT         PIC X.
  5137                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5138             20  CF-BIRTH-DATE-INPUT        PIC X.
  5139                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5140             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5141                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5142                 88  CF-ZERO-CARRIER            VALUE '1'.
  5143                 88  CF-ZERO-GROUPING           VALUE '2'.
  5144                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5145             20  CF-EDIT-SW                 PIC X.
  5146                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5147             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5148             20  CF-CR-PR-METHOD            PIC X.
  5149               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5150               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5151             20  FILLER                     PIC X.
  5152
  5153         16  CF-CREDIT-MISC-CONTROLS.
  5154             20  CF-REIN-TABLE-SW           PIC X.
  5155                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5156             20  CF-COMP-TABLE-SW           PIC X.
  5157                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5158             20  CF-EXPERIENCE-RETENTION-AGE
  5159                                            PIC S9        COMP-3.
  5160             20  CF-CONVERSION-DT           PIC XX.
  5161             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5162             20  CF-RUN-FREQUENCY-SW        PIC X.
  5163                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  96
* EL050.cbl
  5164                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5165
  5166             20  CF-CR-CHECK-NO-CONTROL.
  5167                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5168                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5169                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5170                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5171                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5172                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5173
  5174                 24  CF-CR-CHECK-COUNT       REDEFINES
  5175                     CF-CR-CHECK-COUNTER      PIC X(4).
  5176
  5177                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5178                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5179
  5180                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5181                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5182                 24  CF-MAIL-PROCESSING       PIC X.
  5183                     88  MAIL-PROCESSING          VALUE 'Y'.
  5184
  5185         16  CF-MISC-SYSTEM-CONTROL.
  5186             20  CF-SYSTEM-C                 PIC X.
  5187                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5188             20  CF-SYSTEM-D                 PIC X.
  5189                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5190             20  CF-SOC-SEC-NO-SW            PIC X.
  5191                 88  SOC-SEC-NO-USED             VALUE '1'.
  5192             20  CF-MEMBER-NO-SW             PIC X.
  5193                 88  MEMBER-NO-USED              VALUE '1'.
  5194             20  CF-TAX-ID-NUMBER            PIC X(11).
  5195             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5196             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5197                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5198                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5199                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5200                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5201             20  CF-SYSTEM-E                 PIC X.
  5202                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5203
  5204         16  CF-LGX-LIFE-USER               PIC X.
  5205             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5206             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5207
  5208         16  CF-CR-MONTH-END-DT             PIC XX.
  5209
  5210         16  CF-FILE-MAINT-DATES.
  5211             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5212                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5213             20  CF-LAST-BATCH       REDEFINES
  5214                 CF-LAST-BATCH-NO               PIC X(4).
  5215             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5216             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5217             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5218             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5219             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5220             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5221             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  97
* EL050.cbl
  5222             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5223             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5224             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5225
  5226         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5227         16  FILLER                         PIC X.
  5228
  5229         16  CF-ALT-MORT-CODE               PIC X(4).
  5230         16  CF-MEMBER-CAPTION              PIC X(10).
  5231
  5232         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5233             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5234             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5235             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5236             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5237             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5238
  5239         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5240
  5241         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5242         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5243         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5244         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5245
  5246         16  CF-AH-OVERRIDE-L1              PIC X.
  5247         16  CF-AH-OVERRIDE-L2              PIC XX.
  5248         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5249         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5250
  5251         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5252         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5253
  5254         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5255         16  CF-AR-LAST-EL860-DT            PIC XX.
  5256         16  CF-MP-MONTH-END-DT             PIC XX.
  5257
  5258         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5259         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5260             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5261
  5262         16  CF-AR-MONTH-END-DT             PIC XX.
  5263
  5264         16  CF-CRDTCRD-USER                PIC X.
  5265             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5266             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5267
  5268         16  CF-CC-MONTH-END-DT             PIC XX.
  5269
  5270         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5271
  5272         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5273             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5274             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5275             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5276         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5277         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5278         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5279         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  98
* EL050.cbl
  5280             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5281             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5282         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5283         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5284         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5285             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5286         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5287
  5288         16  CF-CL-ZIP-CODE.
  5289             20  CF-CL-ZIP-PRIME.
  5290                 24  CF-CL-ZIP-1ST          PIC X.
  5291                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5292                 24  FILLER                 PIC X(4).
  5293             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5294         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5295             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5296             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5297             20  FILLER                     PIC XXX.
  5298
  5299         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5300         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5301         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5302         16  CF-CO-OPTION-START-DATE        PIC XX.
  5303         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5304           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5305                                                      '3' '4'.
  5306           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5307           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5308           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5309           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5310           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5311           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5312
  5313         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5314
  5315         16  CF-PAYMENT-APPROVAL-LEVELS.
  5316             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5317             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5318             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5319             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5320             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5321             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5322
  5323         16  CF-END-USER-REPORTING-USER     PIC X.
  5324             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5325             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5326
  5327         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5328             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5329             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5330
  5331         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5332
  5333         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5334         16  FILLER                         PIC X.
  5335
  5336         16  CF-CREDIT-ARCHIVE-CNTL.
  5337             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page  99
* EL050.cbl
  5338             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5339             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5340
  5341         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5342
  5343         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5344             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5345             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5346
  5347         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5348             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5349             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5350
  5351         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5352
  5353         16  CF-CO-ACH-ID-CODE              PIC  X.
  5354             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5355             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5356             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5357         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5358         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5359         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5360         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5361         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5362         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5363         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5364         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5365         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5366                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5367         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5368                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5369
  5370         16  CF-CO-OVER-SHORT.
  5371             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5372             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5373
  5374*         16  FILLER                         PIC X(102).
  5375         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5376             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5377             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5378
  5379         16  CF-AH-APPROVAL-DAYS.
  5380             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5381             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5382             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5383             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5384
  5385         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5386
  5387         16  CF-APPROV-LEV-5.
  5388             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5389             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5390             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5391
  5392         16  FILLER                         PIC X(68).
  5393****************************************************************
  5394*             PROCESSOR/USER RECORD                            *
  5395****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 100
* EL050.cbl
  5396
  5397     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5398         16  CF-PROCESSOR-NAME              PIC X(30).
  5399         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5400         16  CF-PROCESSOR-TITLE             PIC X(26).
  5401         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5402                 88  MESSAGE-YES                VALUE 'Y'.
  5403                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5404
  5405*****************************************************
  5406****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5407****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5408****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5409****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5410*****************************************************
  5411
  5412         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5413             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5414             20  CF-APPLICATION-FORCE       PIC X.
  5415             20  CF-INDIVIDUAL-APP.
  5416                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5417                     28  CF-BROWSE-APP      PIC X.
  5418                     28  CF-UPDATE-APP      PIC X.
  5419
  5420         16  CF-CURRENT-TERM-ON             PIC X(4).
  5421         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5422             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5423             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5424             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5425             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5426             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5427             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5428             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5429         16  CF-PROCESSOR-CARRIER           PIC X.
  5430             88  NO-CARRIER-SECURITY            VALUE ' '.
  5431         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5432             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5433         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5434             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5435         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5436             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5437
  5438         16  CF-PROC-SYS-ACCESS-SW.
  5439             20  CF-PROC-CREDIT-CLAIMS-SW.
  5440                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5441                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5442                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5443                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5444             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5445                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5446                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5447             20  CF-PROC-LIFE-GNRLDGR-SW.
  5448                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5449                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5450                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5451                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5452             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5453                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 101
* EL050.cbl
  5454                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5455         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5456             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5457             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5458         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5459
  5460         16  CF-APPROVAL-LEVEL                  PIC X.
  5461             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5462             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5463             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5464             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5465             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5466
  5467         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5468
  5469         16  CF-LANGUAGE-TYPE                   PIC X.
  5470             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5471             88  CF-LANG-IS-FR                      VALUE 'F'.
  5472
  5473         16  CF-CSR-IND                         PIC X.
  5474         16  FILLER                             PIC X(239).
  5475
  5476****************************************************************
  5477*             PROCESSOR/REMINDERS RECORD                       *
  5478****************************************************************
  5479
  5480     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5481         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5482             20  CF-START-REMIND-DT         PIC XX.
  5483             20  CF-END-REMIND-DT           PIC XX.
  5484             20  CF-REMINDER-TEXT           PIC X(50).
  5485         16  FILLER                         PIC X(296).
  5486
  5487
  5488****************************************************************
  5489*             STATE MASTER RECORD                              *
  5490****************************************************************
  5491
  5492     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5493         16  CF-STATE-ABBREVIATION          PIC XX.
  5494         16  CF-STATE-NAME                  PIC X(25).
  5495         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5496         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5497             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5498             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5499             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5500             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5501                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5502                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5503             20  CF-ST-PREM-REJECT-SW       PIC X.
  5504                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5505                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5506             20  CF-ST-REF-REJECT-SW        PIC X.
  5507                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5508                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5509         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5510         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5511         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 102
* EL050.cbl
  5512             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5513             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5514             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5515         16  CF-ST-FST-PMT-EXTENSION.
  5516             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5517             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5518                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5519                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5520                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5521                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5522         16  CF-ST-STATE-CALL.
  5523             20  CF-ST-CALL-UNEARNED        PIC X.
  5524             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5525             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5526         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5527             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5528             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5529         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5530         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5531         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5532         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5533         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5534         16  FILLER                         PIC X.
  5535         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5536             20  CF-ST-BENEFIT-CD           PIC XX.
  5537             20  CF-ST-BENEFIT-KIND         PIC X.
  5538                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5539                 88  CF-ST-AH-KIND              VALUE 'A'.
  5540             20  CF-ST-REM-TERM-CALC        PIC X.
  5541                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5542                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5543                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5544                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5545                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5546                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5547                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5548                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5549
  5550             20  CF-ST-REFUND-CALC          PIC X.
  5551                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5552                 88  ST-REFD-BY-R78             VALUE '1'.
  5553                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5554                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5555                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5556                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5557                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5558                 88  ST-REFD-UTAH               VALUE '7'.
  5559                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5560                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5561                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5562
  5563             20  CF-ST-EARNING-CALC         PIC X.
  5564                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5565                 88  ST-EARN-BY-R78             VALUE '1'.
  5566                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5567                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5568                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5569                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 103
* EL050.cbl
  5570                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5571                 88  ST-EARN-MEAN               VALUE '8'.
  5572                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5573
  5574             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5575                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5576                 88  ST-OVRD-BY-R78             VALUE '1'.
  5577                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5578                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5579                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5580                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5581                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5582                 88  ST-OVRD-MEAN               VALUE '8'.
  5583                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5584             20  FILLER                     PIC X.
  5585
  5586         16  CF-ST-COMMISSION-CAPS.
  5587             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5588             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5589             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5590             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5591         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5592                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5593
  5594         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5595
  5596         16  CF-ST-STATUTORY-INTEREST.
  5597             20  CF-ST-STAT-DATE-FROM       PIC X.
  5598                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5599                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5600             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5601             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5602             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5603             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5604             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5605
  5606         16  CF-ST-OVER-SHORT.
  5607             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5608             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5609
  5610         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5611
  5612         16  CF-ST-RT-CALC                  PIC X.
  5613
  5614         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5615         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5616         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5617         16  CF-ST-RF-LR-CALC               PIC X.
  5618         16  CF-ST-RF-LL-CALC               PIC X.
  5619         16  CF-ST-RF-LN-CALC               PIC X.
  5620         16  CF-ST-RF-AH-CALC               PIC X.
  5621         16  CF-ST-RF-CP-CALC               PIC X.
  5622*        16  FILLER                         PIC X(206).
  5623*CIDMOD         16  FILLER                         PIC X(192).
  5624         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5625             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5626         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5627         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 104
* EL050.cbl
  5628         16  CF-ST-CAUSAL-STATE             PIC X.
  5629         16  FILLER                         PIC X(185).
  5630
  5631****************************************************************
  5632*             BENEFIT MASTER RECORD                            *
  5633****************************************************************
  5634
  5635     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5636         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5637             20  CF-BENEFIT-CODE            PIC XX.
  5638             20  CF-BENEFIT-NUMERIC  REDEFINES
  5639                 CF-BENEFIT-CODE            PIC XX.
  5640             20  CF-BENEFIT-ALPHA           PIC XXX.
  5641             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5642             20  CF-BENEFIT-COMMENT         PIC X(10).
  5643
  5644             20  CF-LF-COVERAGE-TYPE        PIC X.
  5645                 88  CF-REDUCING                VALUE 'R'.
  5646                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5647
  5648             20  CF-SPECIAL-CALC-CD         PIC X.
  5649                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5650                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5651                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5652                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5653                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5654                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5655                 88  CF-FARM-PLAN               VALUE 'F'.
  5656                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5657                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5658                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5659                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5660                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5661                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5662                 88  CF-PRUDENTIAL              VALUE 'P'.
  5663                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5664                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5665                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5666                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5667                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5668                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5669
  5670             20  CF-JOINT-INDICATOR         PIC X.
  5671                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5672
  5673*            20  FILLER                     PIC X(12).
  5674             20  FILLER                     PIC X(11).
  5675             20  CF-BENEFIT-CATEGORY        PIC X.
  5676             20  CF-LOAN-TYPE               PIC X(8).
  5677
  5678             20  CF-CO-REM-TERM-CALC        PIC X.
  5679                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5680                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5681                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5682                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5683                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5684
  5685             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 105
* EL050.cbl
  5686                 88  CO-EARN-BY-R78             VALUE '1'.
  5687                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5688                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5689                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5690                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5691                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5692                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5693                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5694
  5695             20  CF-CO-REFUND-CALC          PIC X.
  5696                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5697                 88  CO-REFD-BY-R78             VALUE '1'.
  5698                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5699                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5700                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5701                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5702                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5703                 88  CO-REFD-MEAN               VALUE '8'.
  5704                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5705                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5706                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5707
  5708             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5709                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5710                 88  CO-OVRD-BY-R78             VALUE '1'.
  5711                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5712                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5713                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5714                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5715                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5716                 88  CO-OVRD-MEAN               VALUE '8'.
  5717                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5718
  5719             20  CF-CO-BEN-I-G-CD           PIC X.
  5720                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5721                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5722                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5723
  5724         16  FILLER                         PIC X(304).
  5725
  5726
  5727****************************************************************
  5728*             CARRIER MASTER RECORD                            *
  5729****************************************************************
  5730
  5731     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5732         16  CF-ADDRESS-DATA.
  5733             20  CF-MAIL-TO-NAME            PIC X(30).
  5734             20  CF-IN-CARE-OF              PIC X(30).
  5735             20  CF-ADDRESS-LINE-1          PIC X(30).
  5736             20  CF-ADDRESS-LINE-2          PIC X(30).
  5737             20  CF-CITY-STATE              PIC X(30).
  5738             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5739             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5740
  5741         16  CF-CLAIM-NO-CONTROL.
  5742             20  CF-CLAIM-NO-METHOD         PIC X.
  5743                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 106
* EL050.cbl
  5744                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5745                 88  CLAIM-NO-SEQ               VALUE '3'.
  5746                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5747             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5748                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5749                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5750                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5751
  5752         16  CF-CHECK-NO-CONTROL.
  5753             20  CF-CHECK-NO-METHOD         PIC X.
  5754                 88  CHECK-NO-MANUAL            VALUE '1'.
  5755                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5756                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5757                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5758             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5759                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5760
  5761         16  CF-DOMICILE-STATE              PIC XX.
  5762
  5763         16  CF-EXPENSE-CONTROLS.
  5764             20  CF-EXPENSE-METHOD          PIC X.
  5765                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5766                 88  DOLLARS-PER-PMT            VALUE '2'.
  5767                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5768                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5769             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5770             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5771
  5772         16  CF-CORRESPONDENCE-CONTROL.
  5773             20  CF-LETTER-RESEND-OPT       PIC X.
  5774                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5775                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5776             20  FILLER                     PIC X(4).
  5777
  5778         16  CF-RESERVE-CONTROLS.
  5779             20  CF-MANUAL-SW               PIC X.
  5780                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5781             20  CF-FUTURE-SW               PIC X.
  5782                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5783             20  CF-PTC-SW                  PIC X.
  5784                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5785             20  CF-IBNR-SW                 PIC X.
  5786                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5787             20  CF-PTC-LF-SW               PIC X.
  5788                 88  CF-LF-PTC-USED             VALUE '1'.
  5789             20  CF-CDT-ACCESS-METHOD       PIC X.
  5790                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5791                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5792                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5793             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5794
  5795         16  CF-CLAIM-CALC-METHOD           PIC X.
  5796             88  360-PLUS-MONTHS                VALUE '1'.
  5797             88  365-PLUS-MONTHS                VALUE '2'.
  5798             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5799             88  360-DAILY                      VALUE '4'.
  5800             88  365-DAILY                      VALUE '5'.
  5801
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 107
* EL050.cbl
  5802         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5803         16  FILLER                         PIC X(11).
  5804
  5805         16  CF-LIMIT-AMOUNTS.
  5806             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5807             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5808             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5809             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5810             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5811             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5812             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5813             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5814             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5815             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5816
  5817         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5818         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5819         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5820
  5821         16  CF-ZIP-CODE.
  5822             20  CF-ZIP-PRIME.
  5823                 24  CF-ZIP-1ST             PIC X.
  5824                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5825                 24  FILLER                 PIC X(4).
  5826             20  CF-ZIP-PLUS4               PIC X(4).
  5827         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5828             20  CF-CAN-POSTAL-1            PIC XXX.
  5829             20  CF-CAN-POSTAL-2            PIC XXX.
  5830             20  FILLER                     PIC XXX.
  5831
  5832         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5833         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5834         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5835
  5836         16  CF-RATING-SWITCH               PIC X.
  5837             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5838             88  CF-NO-RATING                   VALUE 'N'.
  5839
  5840         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5841
  5842         16  CF-CARRIER-OVER-SHORT.
  5843             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5844             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5845
  5846         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5847         16  CF-SECPAY-SWITCH               PIC X.
  5848             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5849             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5850         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5851         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5852         16  FILLER                         PIC X(444).
  5853*        16  FILLER                         PIC X(452).
  5854
  5855
  5856****************************************************************
  5857*             MORTALITY MASTER RECORD                          *
  5858****************************************************************
  5859
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 108
* EL050.cbl
  5860     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5861         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5862                                INDEXED BY CF-MORT-NDX.
  5863             20  CF-MORT-TABLE              PIC X(5).
  5864             20  CF-MORT-TABLE-TYPE         PIC X.
  5865                 88  CF-MORT-JOINT              VALUE 'J'.
  5866                 88  CF-MORT-SINGLE             VALUE 'S'.
  5867                 88  CF-MORT-COMBINED           VALUE 'C'.
  5868                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5869                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5870             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5871             20  CF-MORT-AGE-METHOD         PIC XX.
  5872                 88  CF-AGE-LAST                VALUE 'AL'.
  5873                 88  CF-AGE-NEAR                VALUE 'AN'.
  5874             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5875             20  CF-MORT-ADJUSTMENT-DIRECTION
  5876                                            PIC X.
  5877                 88  CF-MINUS                   VALUE '-'.
  5878                 88  CF-PLUS                    VALUE '+'.
  5879             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5880             20  CF-MORT-JOINT-CODE         PIC X.
  5881                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5882             20  CF-MORT-PC-Q               PIC X.
  5883                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5884             20  CF-MORT-TABLE-CODE         PIC X(4).
  5885             20  CF-MORT-COMMENTS           PIC X(15).
  5886             20  FILLER                     PIC X(14).
  5887
  5888         16  FILLER                         PIC X(251).
  5889
  5890
  5891****************************************************************
  5892*             BUSSINESS TYPE MASTER RECORD                     *
  5893****************************************************************
  5894
  5895     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5896* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5897* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5898* AND RECORD 05 IS TYPES 81-99
  5899         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5900             20  CF-BUSINESS-TITLE          PIC  X(19).
  5901             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5902                                            PIC S9V9(4) COMP-3.
  5903             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5904             20  FILLER                     PIC  X.
  5905         16  FILLER                         PIC  X(248).
  5906
  5907
  5908****************************************************************
  5909*             TERMINAL MASTER RECORD                           *
  5910****************************************************************
  5911
  5912     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5913
  5914         16  CF-COMPANY-TERMINALS.
  5915             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5916                                  PIC X(4).
  5917         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 109
* EL050.cbl
  5918
  5919
  5920****************************************************************
  5921*             LIFE EDIT MASTER RECORD                          *
  5922****************************************************************
  5923
  5924     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5925         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5926             20  CF-LIFE-CODE-IN            PIC XX.
  5927             20  CF-LIFE-CODE-OUT           PIC XX.
  5928         16  FILLER                         PIC X(248).
  5929
  5930
  5931****************************************************************
  5932*             AH EDIT MASTER RECORD                            *
  5933****************************************************************
  5934
  5935     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5936         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5937             20  CF-AH-CODE-IN              PIC XXX.
  5938             20  CF-AH-CODE-OUT             PIC XX.
  5939         16  FILLER                         PIC X(248).
  5940
  5941
  5942****************************************************************
  5943*             CREDIBILITY TABLES                               *
  5944****************************************************************
  5945
  5946     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5947         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5948                             INDEXED BY CF-CRDB-NDX.
  5949             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5950             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5951             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5952         16  FILLER                         PIC  X(332).
  5953
  5954
  5955****************************************************************
  5956*             REPORT CUSTOMIZATION RECORD                      *
  5957****************************************************************
  5958
  5959     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5960         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5961             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5962             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5963             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5964**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5965****       A T-TRANSFER.                                   ****
  5966             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5967
  5968         16  FILLER                         PIC XX.
  5969
  5970         16  CF-CARRIER-CNTL-OPT.
  5971             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5972                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5973                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5974             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5975                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 110
* EL050.cbl
  5976         16  CF-GROUP-CNTL-OPT.
  5977             20  CF-GROUP-OPT-SEQ           PIC 9.
  5978                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5979                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5980             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5981                                            PIC X(6).
  5982         16  CF-STATE-CNTL-OPT.
  5983             20  CF-STATE-OPT-SEQ           PIC 9.
  5984                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5986             20  CF-STATE-SELECT OCCURS 3 TIMES
  5987                                            PIC XX.
  5988         16  CF-ACCOUNT-CNTL-OPT.
  5989             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5990                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5991                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5992             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5993                                            PIC X(10).
  5994         16  CF-BUS-TYP-CNTL-OPT.
  5995             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5996                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5997                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5998             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5999                                            PIC XX.
  6000         16  CF-LF-TYP-CNTL-OPT.
  6001             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6002                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6003                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6004             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6005                                            PIC XX.
  6006         16  CF-AH-TYP-CNTL-OPT.
  6007             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6008                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6009                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6010             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6011                                            PIC XX.
  6012         16  CF-REPTCD1-CNTL-OPT.
  6013             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6014                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6015                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6016             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6017                                            PIC X(10).
  6018         16  CF-REPTCD2-CNTL-OPT.
  6019             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6020                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6021                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6022             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6023                                            PIC X(10).
  6024         16  CF-USER1-CNTL-OPT.
  6025             20  CF-USER1-OPT-SEQ           PIC 9.
  6026                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6027                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6028             20  CF-USER1-SELECT OCCURS 3 TIMES
  6029                                            PIC X(10).
  6030         16  CF-USER2-CNTL-OPT.
  6031             20  CF-USER2-OPT-SEQ           PIC 9.
  6032                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6033                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 111
* EL050.cbl
  6034             20  CF-USER2-SELECT OCCURS 3 TIMES
  6035                                            PIC X(10).
  6036         16  CF-USER3-CNTL-OPT.
  6037             20  CF-USER3-OPT-SEQ           PIC 9.
  6038                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6039                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6040             20  CF-USER3-SELECT OCCURS 3 TIMES
  6041                                            PIC X(10).
  6042         16  CF-USER4-CNTL-OPT.
  6043             20  CF-USER4-OPT-SEQ           PIC 9.
  6044                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6045                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6046             20  CF-USER4-SELECT OCCURS 3 TIMES
  6047                                            PIC X(10).
  6048         16  CF-USER5-CNTL-OPT.
  6049             20  CF-USER5-OPT-SEQ           PIC 9.
  6050                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6051                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6052             20  CF-USER5-SELECT OCCURS 3 TIMES
  6053                                            PIC X(10).
  6054         16  CF-REINS-CNTL-OPT.
  6055             20  CF-REINS-OPT-SEQ           PIC 9.
  6056                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6057                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6058             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6059                 24  CF-REINS-PRIME         PIC XXX.
  6060                 24  CF-REINS-SUB           PIC XXX.
  6061
  6062         16  CF-AGENT-CNTL-OPT.
  6063             20  CF-AGENT-OPT-SEQ           PIC 9.
  6064                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6065                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6066             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6067                                            PIC X(10).
  6068
  6069         16  FILLER                         PIC X(43).
  6070
  6071         16  CF-LOSS-RATIO-SELECT.
  6072             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6073             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6074         16  CF-ENTRY-DATE-SELECT.
  6075             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6076             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6077         16  CF-EFFECTIVE-DATE-SELECT.
  6078             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6079             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6080
  6081         16  CF-EXCEPTION-LIST-IND          PIC X.
  6082             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6083
  6084         16  FILLER                         PIC X(318).
  6085
  6086****************************************************************
  6087*                  EXCEPTION REPORTING RECORD                  *
  6088****************************************************************
  6089
  6090     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6091         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 112
* EL050.cbl
  6092             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6093
  6094         16  CF-COMBINED-LIFE-AH-OPT.
  6095             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6096             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6097             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6098             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6099
  6100         16  CF-LIFE-OPT.
  6101             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6102             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6103             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6104             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6105             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6106             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6107             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6108             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6109             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6110             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6111
  6112         16  CF-AH-OPT.
  6113             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6114             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6115             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6116             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6117             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6118             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6119             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6120             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6121             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6122             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6123
  6124         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6125             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6126             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6127             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6128
  6129         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6130
  6131         16  FILLER                         PIC X(673).
  6132
  6133
  6134****************************************************************
  6135*             MORTGAGE SYSTEM PLAN RECORD                      *
  6136****************************************************************
  6137
  6138     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6139         16  CF-PLAN-TYPE                   PIC X.
  6140             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6141             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6142             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6143         16  CF-PLAN-ABBREV                 PIC XXX.
  6144         16  CF-PLAN-DESCRIPT               PIC X(10).
  6145         16  CF-PLAN-NOTES                  PIC X(20).
  6146         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6147         16  CF-PLAN-UNDERWRITING.
  6148             20  CF-PLAN-TERM-DATA.
  6149                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 113
* EL050.cbl
  6150                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6151             20  CF-PLAN-AGE-DATA.
  6152                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6153                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6154                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6155             20  CF-PLAN-BENEFIT-DATA.
  6156                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6157                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6158                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6159                                            PIC S9(7)V99  COMP-3.
  6160         16  CF-PLAN-POLICY-FORMS.
  6161             20  CF-POLICY-FORM             PIC X(12).
  6162             20  CF-MASTER-APPLICATION      PIC X(12).
  6163             20  CF-MASTER-POLICY           PIC X(12).
  6164         16  CF-PLAN-RATING.
  6165             20  CF-RATE-CODE               PIC X(5).
  6166             20  CF-SEX-RATING              PIC X.
  6167                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6168                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6169             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6170             20  CF-SUB-STD-TYPE            PIC X.
  6171                 88  CF-PCT-OF-PREM            VALUE '1'.
  6172                 88  CF-PCT-OF-BENE            VALUE '2'.
  6173         16  CF-PLAN-PREM-TOLERANCES.
  6174             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6175             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6176         16  CF-PLAN-PYMT-TOLERANCES.
  6177             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6178             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6179         16  CF-PLAN-MISC-DATA.
  6180             20  FILLER                     PIC X.
  6181             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6182             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6183         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6184         16  CF-PLAN-IND-GRP                PIC X.
  6185             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6186                                                     '1'.
  6187             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6188                                                     '2'.
  6189         16  CF-MIB-SEARCH-SW               PIC X.
  6190             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6191             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6192             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6193             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6194         16  CF-ALPHA-SEARCH-SW             PIC X.
  6195             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6196             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6197             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6198             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6199             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6200             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6201             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6202             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6203             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6204             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6205                                                     'A' 'B' 'C'
  6206                                                     'X' 'Y' 'Z'.
  6207         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 114
* EL050.cbl
  6208             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6209             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6210             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6211             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6212             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6213         16  FILLER                         PIC X(4).
  6214         16  CF-HEALTH-QUESTIONS            PIC X.
  6215             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6216         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6217         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6218         16  CF-PLAN-SNGL-JNT               PIC X.
  6219             88  CF-COMBINED-PLAN              VALUE 'C'.
  6220             88  CF-JNT-PLAN                   VALUE 'J'.
  6221             88  CF-SNGL-PLAN                  VALUE 'S'.
  6222         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6223         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6224         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6225         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6226         16  CF-RERATE-CNTL                 PIC  X.
  6227             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6228             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6229             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6230             88  CF-AUTO-RECALC                 VALUE '4'.
  6231         16  CF-BENEFIT-TYPE                PIC  X.
  6232             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6233             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6234         16  CF-POLICY-FEE                  PIC S999V99
  6235                                                    COMP-3.
  6236         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6237         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6238         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6239         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6240         16  FILLER                         PIC  X(32).
  6241         16  CF-TERMINATION-FORM            PIC  X(04).
  6242         16  FILLER                         PIC  X(08).
  6243         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6244                                                       COMP-3.
  6245         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6246         16  CF-ISSUE-LETTER                PIC  X(4).
  6247         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6248         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6249             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6250             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6251         16  CF-MP-REFUND-CALC              PIC X.
  6252             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6253             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6254             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6255             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6256             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6257             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6258             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6259             88  CF-MP-REFD-MEAN                VALUE '8'.
  6260         16  CF-ALT-RATE-CODE               PIC  X(5).
  6261
  6262
  6263         16  FILLER                         PIC X(498).
  6264****************************************************************
  6265*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 115
* EL050.cbl
  6266****************************************************************
  6267
  6268     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6269         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6270         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6271             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6272             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6273             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6274             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6275             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6276
  6277         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6278         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6279         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6280         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6281         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6282
  6283         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6284             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6285         16  CF-MP-RECON-USE-IND            PIC X(1).
  6286             88  CF-MP-USE-RECON             VALUE 'Y'.
  6287         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6288             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6289         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6290             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6291             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6292         16  FILLER                         PIC X(1).
  6293         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6294             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6295         16  CF-MORTG-MIB-VERSION           PIC X.
  6296             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6297             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6298             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6299         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6300             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6301                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6302             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6303                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6304             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6305                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6306             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6307                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6308             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6309                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6310             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6311                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6312         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6313         16  FILLER                         PIC X(7).
  6314         16  CF-MORTG-DESTINATION-SYMBOL.
  6315             20  CF-MORTG-MIB-COMM          PIC X(5).
  6316             20  CF-MORTG-MIB-TERM          PIC X(5).
  6317         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6318             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6319         16  FILLER                         PIC X(03).
  6320         16  CF-MP-CHECK-NO-CONTROL.
  6321             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6322                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6323                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 116
* EL050.cbl
  6324                                                ' ' LOW-VALUES.
  6325                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6326                                               VALUE '3'.
  6327         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6328         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6329         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6330             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6331                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6332             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6333                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6334             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6335                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6336             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6337                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6338             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6339                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6340             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6341                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6342         16  CF-MORTG-BILLING-AREA.
  6343             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6344                                            PIC X.
  6345         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6346         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6347         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6348         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6349             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6350             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6351         16  FILLER                         PIC X.
  6352         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6353             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6354             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6355         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6356         16  FILLER                         PIC X(8).
  6357         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6358         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6359         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6360         16  CF-ACH-COMPANY-ID.
  6361             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6362                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6363                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6364                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6365             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6366         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6367             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6368         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6369             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6370             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6371         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6372         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6373         16  FILLER                         PIC X(536).
  6374
  6375****************************************************************
  6376*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6377****************************************************************
  6378
  6379     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6380         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6381             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 117
* EL050.cbl
  6382                 24  CF-FEMALE-FT           PIC 99.
  6383                 24  CF-FEMALE-IN           PIC 99.
  6384             20  CF-FEMALE-MIN-WT           PIC 999.
  6385             20  CF-FEMALE-MAX-WT           PIC 999.
  6386         16  FILLER                         PIC X(428).
  6387
  6388     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6389         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6390             20  CF-MALE-HEIGHT.
  6391                 24  CF-MALE-FT             PIC 99.
  6392                 24  CF-MALE-IN             PIC 99.
  6393             20  CF-MALE-MIN-WT             PIC 999.
  6394             20  CF-MALE-MAX-WT             PIC 999.
  6395         16  FILLER                         PIC X(428).
  6396******************************************************************
  6397*             AUTOMATIC ACTIVITY RECORD                          *
  6398******************************************************************
  6399     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6400         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6401             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6402             20  CF-SYS-LETTER-ID           PIC X(04).
  6403             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6404             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6405             20  CF-SYS-RESET-SW            PIC X(01).
  6406             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6407             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6408
  6409         16  FILLER                         PIC X(50).
  6410
  6411         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6412             20  CF-USER-ACTIVE-SW          PIC X(01).
  6413             20  CF-USER-LETTER-ID          PIC X(04).
  6414             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6415             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6416             20  CF-USER-RESET-SW           PIC X(01).
  6417             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6418             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6419             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6420
  6421         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 118
* EL050.cbl
  6423*    COPY ERCACCT.
  6424******************************************************************
  6425*                                                                *
  6426*                                                                *
  6427*                            ERCACCT                             *
  6428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6429*                            VMOD=2.031                          *
  6430*                                                                *
  6431*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6432*                                                                *
  6433*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6434*   VSAM ACCOUNT MASTER FILES.                                   *
  6435*                                                                *
  6436*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6437*                                                                *
  6438*   FILE TYPE = VSAM,KSDS                                        *
  6439*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6440*                                                                *
  6441*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6442*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6443*                                                                *
  6444*   LOG = NO                                                     *
  6445*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6446*                                                                *
  6447*                                                                *
  6448******************************************************************
  6449*                   C H A N G E   L O G
  6450*
  6451* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6452*-----------------------------------------------------------------
  6453*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6454* EFFECTIVE    NUMBER
  6455*-----------------------------------------------------------------
  6456* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6457* 092705    2005050300006  PEMA  ADD SPP LEASES
  6458* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6459* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6460* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6461* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6462* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6463******************************************************************
  6464
  6465 01  ACCOUNT-MASTER.
  6466     12  AM-RECORD-ID                      PIC XX.
  6467         88  VALID-AM-ID                      VALUE 'AM'.
  6468
  6469     12  AM-CONTROL-PRIMARY.
  6470         16  AM-COMPANY-CD                 PIC X.
  6471         16  AM-MSTR-CNTRL.
  6472             20  AM-CONTROL-A.
  6473                 24  AM-CARRIER            PIC X.
  6474                 24  AM-GROUPING.
  6475                     28 AM-GROUPING-PREFIX PIC XXX.
  6476                     28 AM-GROUPING-PRIME  PIC XXX.
  6477                 24  AM-STATE              PIC XX.
  6478                 24  AM-ACCOUNT.
  6479                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6480                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 119
* EL050.cbl
  6481             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6482                                           PIC X(19).
  6483             20  AM-CNTRL-B.
  6484                 24  AM-EXPIRATION-DT      PIC XX.
  6485                 24  FILLER                PIC X(4).
  6486             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6487                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6488
  6489     12  AM-CONTROL-BY-VAR-GRP.
  6490         16  AM-COMPANY-CD-A1              PIC X.
  6491         16  AM-VG-CARRIER                 PIC X.
  6492         16  AM-VG-GROUPING                PIC X(6).
  6493         16  AM-VG-STATE                   PIC XX.
  6494         16  AM-VG-ACCOUNT                 PIC X(10).
  6495         16  AM-VG-DATE.
  6496             20  AM-VG-EXPIRATION-DT       PIC XX.
  6497             20  FILLER                    PIC X(4).
  6498         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6499                                           PIC 9(11)      COMP-3.
  6500     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6501         16  FILLER                        PIC X(10).
  6502         16  AM-VG-KEY3.
  6503             20  AM-VG3-ACCOUNT            PIC X(10).
  6504             20  AM-VG3-EXP-DT             PIC XX.
  6505         16  FILLER                        PIC X(4).
  6506     12  AM-MAINT-INFORMATION.
  6507         16  AM-LAST-MAINT-DT              PIC XX.
  6508         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6509         16  AM-LAST-MAINT-USER            PIC X(4).
  6510         16  FILLER                        PIC XX.
  6511
  6512     12  AM-EFFECTIVE-DT                   PIC XX.
  6513     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6514
  6515     12  AM-PREV-DATES  COMP-3.
  6516         16  AM-PREV-EXP-DT                PIC 9(11).
  6517         16  AM-PREV-EFF-DT                PIC 9(11).
  6518
  6519     12  AM-REPORT-CODE-1                  PIC X(10).
  6520     12  AM-REPORT-CODE-2                  PIC X(10).
  6521
  6522     12  AM-CITY-CODE                      PIC X(4).
  6523     12  AM-COUNTY-PARISH                  PIC X(6).
  6524
  6525     12  AM-NAME                           PIC X(30).
  6526     12  AM-PERSON                         PIC X(30).
  6527     12  AM-ADDRS                          PIC X(30).
  6528     12  AM-CITY.
  6529         16  AM-ADDR-CITY                  PIC X(28).
  6530         16  AM-ADDR-STATE                 PIC XX.
  6531     12  AM-ZIP.
  6532         16  AM-ZIP-PRIME.
  6533             20  AM-ZIP-PRI-1ST            PIC X.
  6534                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6535             20  FILLER                    PIC X(4).
  6536         16  AM-ZIP-PLUS4                  PIC X(4).
  6537     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6538         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 120
* EL050.cbl
  6539         16  AM-CAN-POSTAL-2               PIC XXX.
  6540         16  FILLER                        PIC XXX.
  6541     12  AM-TEL-NO.
  6542         16  AM-AREA-CODE                  PIC 999.
  6543         16  AM-TEL-PRE                    PIC 999.
  6544         16  AM-TEL-NBR                    PIC 9(4).
  6545     12  AM-TEL-LOC                        PIC X.
  6546         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6547         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6548
  6549     12  AM-COMM-STRUCTURE.
  6550         16  AM-DEFN-1.
  6551             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6552                 24  AM-AGT.
  6553                     28  AM-AGT-PREFIX     PIC X(4).
  6554                     28  AM-AGT-PRIME      PIC X(6).
  6555                 24  AM-COM-TYP            PIC X.
  6556                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6557                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6558                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6559                 24  AM-RECALC-LV-INDIC    PIC X.
  6560                 24  AM-RETRO-LV-INDIC     PIC X.
  6561                 24  AM-GL-CODES           PIC X.
  6562                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6563                 24  FILLER                PIC X(01).
  6564         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6565             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6566                 24  FILLER                PIC X(11).
  6567                 24  AM-L-COMA             PIC XXX.
  6568                 24  AM-J-COMA             PIC XXX.
  6569                 24  AM-A-COMA             PIC XXX.
  6570                 24  FILLER                PIC X(6).
  6571
  6572     12  AM-COMM-CHANGE-STATUS             PIC X.
  6573         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6574
  6575     12  AM-CSR-CODE                       PIC X(4).
  6576
  6577     12  AM-BILLING-STATUS                 PIC X.
  6578         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6579         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6580     12  AM-AUTO-REFUND-SW                 PIC X.
  6581         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6582         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6583     12  AM-GPCD                           PIC 99.
  6584     12  AM-IG                             PIC X.
  6585         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6586         88  AM-HAS-GROUP                     VALUE '2'.
  6587     12  AM-STATUS                         PIC X.
  6588         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6589         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6590         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6591         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6592         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6593         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6594     12  AM-REMIT-TO                       PIC 99.
  6595     12  AM-ID-NO                          PIC X(11).
  6596
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 121
* EL050.cbl
  6597     12  AM-CAL-TABLE                      PIC XX.
  6598     12  AM-LF-DEVIATION                   PIC XXX.
  6599     12  AM-AH-DEVIATION                   PIC XXX.
  6600     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6601     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6602     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6603     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6604     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6605     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6606
  6607     12  AM-USER-FIELDS.
  6608         16  AM-FLD-1                      PIC XX.
  6609         16  AM-FLD-2                      PIC XX.
  6610         16  AM-FLD-3                      PIC XX.
  6611         16  AM-FLD-4                      PIC XX.
  6612         16  AM-FLD-5                      PIC XX.
  6613
  6614     12  AM-1ST-PROD-DATE.
  6615         16  AM-1ST-PROD-YR                PIC XX.
  6616         16  AM-1ST-PROD-MO                PIC XX.
  6617         16  AM-1ST-PROD-DA                PIC XX.
  6618     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6619     12  AM-CERTS-PURGED-DATE.
  6620         16  AM-PUR-YR                     PIC XX.
  6621         16  AM-PUR-MO                     PIC XX.
  6622         16  AM-PUR-DA                     PIC XX.
  6623     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6624     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6625     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6626     12  AM-INACTIVE-DATE.
  6627         16  AM-INA-MO                     PIC 99.
  6628         16  AM-INA-DA                     PIC 99.
  6629         16  AM-INA-YR                     PIC 99.
  6630     12  AM-AR-HI-CERT-DATE                PIC XX.
  6631
  6632     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6633     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6634
  6635     12  AM-OB-PAYMENT-MODE                PIC X.
  6636         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6637         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6638         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6639         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6640
  6641     12  AM-AH-ONLY-INDICATOR              PIC X.
  6642         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6643         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6644
  6645     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6646
  6647     12  AM-OVER-SHORT.
  6648         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6649         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6650
  6651     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6652     12  AM-DCC-CLP-STATE                  PIC XX.
  6653
  6654     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 122
* EL050.cbl
  6655     12  AM-RECALC-REIN                    PIC X.
  6656
  6657     12  AM-REI-TABLE                      PIC XXX.
  6658     12  AM-REI-ET-LF                      PIC X.
  6659     12  AM-REI-ET-AH                      PIC X.
  6660     12  AM-REI-PE-LF                      PIC X.
  6661     12  AM-REI-PE-AH                      PIC X.
  6662     12  AM-REI-PRT-ST                     PIC X.
  6663     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6665     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6666     12  AM-REI-GROUP-A                    PIC X(6).
  6667     12  AM-REI-MORT                       PIC X(4).
  6668     12  AM-REI-PRT-OW                     PIC X.
  6669     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6670     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6671     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6672     12  AM-REI-GROUP-B                    PIC X(6).
  6673
  6674     12  AM-TRUST-TYPE                     PIC X(2).
  6675
  6676     12  AM-EMPLOYER-STMT-USED             PIC X.
  6677     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6678
  6679     12  AM-STD-AH-TYPE                    PIC XX.
  6680     12  AM-EARN-METHODS.
  6681         16  AM-EARN-METHOD-R              PIC X.
  6682             88 AM-REF-RL-R78                 VALUE 'R'.
  6683             88 AM-REF-RL-PR                  VALUE 'P'.
  6684             88 AM-REF-RL-MEAN                VALUE 'M'.
  6685             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6686         16  AM-EARN-METHOD-L              PIC X.
  6687             88 AM-REF-LL-R78                 VALUE 'R'.
  6688             88 AM-REF-LL-PR                  VALUE 'P'.
  6689             88 AM-REF-LL-MEAN                VALUE 'M'.
  6690             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6691         16  AM-EARN-METHOD-A              PIC X.
  6692             88 AM-REF-AH-R78                 VALUE 'R'.
  6693             88 AM-REF-AH-PR                  VALUE 'P'.
  6694             88 AM-REF-AH-MEAN                VALUE 'M'.
  6695             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6696             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6697             88 AM-REF-AH-NET                 VALUE 'N'.
  6698
  6699     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6700     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6701     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6702
  6703     12  AM-RET-Y-N                        PIC X.
  6704     12  AM-RET-P-E                        PIC X.
  6705     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6706     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6707     12  AM-RET-GRP                        PIC X(6).
  6708     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6709         16  AM-POOL-PRIME                 PIC XXX.
  6710         16  AM-POOL-SUB                   PIC XXX.
  6711     12  AM-RETRO-EARNINGS.
  6712         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 123
* EL050.cbl
  6713         16  AM-RET-EARN-L                 PIC X.
  6714         16  AM-RET-EARN-A                 PIC X.
  6715     12  AM-RET-ST-TAX-USE                 PIC X.
  6716         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6717         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6718     12  AM-RETRO-BEG-EARNINGS.
  6719         16  AM-RET-BEG-EARN-R             PIC X.
  6720         16  AM-RET-BEG-EARN-L             PIC X.
  6721         16  AM-RET-BEG-EARN-A             PIC X.
  6722     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6723     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6724
  6725     12  AM-USER-SELECT-OPTIONS.
  6726         16  AM-USER-SELECT-1              PIC X(10).
  6727         16  AM-USER-SELECT-2              PIC X(10).
  6728         16  AM-USER-SELECT-3              PIC X(10).
  6729         16  AM-USER-SELECT-4              PIC X(10).
  6730         16  AM-USER-SELECT-5              PIC X(10).
  6731
  6732     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6733
  6734     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6735
  6736     12  AM-RPT045A-SWITCH                 PIC X.
  6737         88  RPT045A-OFF                   VALUE 'N'.
  6738
  6739     12  AM-INSURANCE-LIMITS.
  6740         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6741         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6742
  6743     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6744         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6745
  6746     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6747         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6748         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6749
  6750     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6751
  6752     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6753     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6754     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6755     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6756     12  AM-DCC-UEF-STATE                  PIC XX.
  6757     12  FILLER                            PIC XXX.
  6758     12  AM-REPORT-CODE-3                  PIC X(10).
  6759*    12  FILLER                            PIC X(22).
  6760
  6761     12  AM-RESERVE-DATE.
  6762         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6763         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6764         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6765
  6766     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6767     12  AM-NOTIFICATION-TYPES.
  6768         16  AM-NOTIF-OF-LETTERS           PIC X.
  6769         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6770         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 124
* EL050.cbl
  6771         16  AM-NOTIF-OF-STATUS            PIC X.
  6772
  6773     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6774         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6775         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6776         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6777         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6778
  6779     12  AM-BENEFIT-CONTROLS.
  6780         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6781             20  AM-BENEFIT-CODE           PIC XX.
  6782             20  AM-BENEFIT-TYPE           PIC X.
  6783             20  AM-BENEFIT-REVISION       PIC XXX.
  6784             20  AM-BENEFIT-REM-TERM       PIC X.
  6785             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6786             20  FILLER                    PIC XX.
  6787         16  FILLER                        PIC X(80).
  6788
  6789     12  AM-TRANSFER-DATA.
  6790         16  AM-TRANSFERRED-FROM.
  6791             20  AM-TRNFROM-CARRIER        PIC X.
  6792             20  AM-TRNFROM-GROUPING.
  6793                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6794                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6795             20  AM-TRNFROM-STATE          PIC XX.
  6796             20  AM-TRNFROM-ACCOUNT.
  6797                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6798                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6799             20  AM-TRNFROM-DTE            PIC XX.
  6800         16  AM-TRANSFERRED-TO.
  6801             20  AM-TRNTO-CARRIER          PIC X.
  6802             20  AM-TRNTO-GROUPING.
  6803                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6804                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6805             20  AM-TRNTO-STATE            PIC XX.
  6806             20  AM-TRNTO-ACCOUNT.
  6807                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6808                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6809             20  AM-TRNTO-DTE              PIC XX.
  6810         16  FILLER                        PIC X(10).
  6811
  6812     12  AM-SAVED-REMIT-TO                 PIC 99.
  6813
  6814     12  AM-COMM-STRUCTURE-SAVED.
  6815         16  AM-DEFN-1-SAVED.
  6816             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6817                 24  AM-AGT-SV             PIC X(10).
  6818                 24  AM-COM-TYP-SV         PIC X.
  6819                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6820                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6821                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6822                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6823                 24  FILLER                PIC X.
  6824                 24  AM-GL-CODES-SV        PIC X.
  6825                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6826                 24  FILLER                PIC X.
  6827         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6828             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 125
* EL050.cbl
  6829                 24  FILLER                PIC X(11).
  6830                 24  AM-L-COMA-SV          PIC XXX.
  6831                 24  AM-J-COMA-SV          PIC XXX.
  6832                 24  AM-A-COMA-SV          PIC XXX.
  6833                 24  FILLER                PIC X(6).
  6834
  6835     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6836         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6837            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6838            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6839            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6840
  6841     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6842     12  FILLER                            PIC X(120).
  6843
  6844     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6845         16  AM-CONTROL-NAME               PIC X(30).
  6846         16  AM-EXECUTIVE-ONE.
  6847             20  AM-EXEC1-NAME             PIC X(15).
  6848             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6849                                                          COMP-3.
  6850             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6851                                                          COMP-3.
  6852         16  AM-EXECUTIVE-TWO.
  6853             20  AM-EXEC2-NAME             PIC X(15).
  6854             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6855                                                          COMP-3.
  6856             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6857                                                          COMP-3.
  6858
  6859     12  AM-RETRO-ADDITIONAL-DATA.
  6860         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6861         16  AM-RETRO-PREM-P-E             PIC X.
  6862         16  AM-RETRO-CLMS-P-I             PIC X.
  6863         16  AM-RETRO-RET-BRACKET-LF.
  6864             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6865                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6866                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6867             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6868                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6869                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6870             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6871                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6872                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6873         16  AM-RETRO-RET-BRACKET-AH.
  6874             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6875                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6876                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6877                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6878             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6879                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6880                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6881             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6882                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6883                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6884
  6885     12  AM-COMMENTS.
  6886         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 126
* EL050.cbl
  6887
  6888     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6889         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6890         16  AM-FLI-BILLING-CODE           PIC X.
  6891         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6892         16  AM-FLI-UNITED-IDENT           PIC X.
  6893         16  AM-FLI-INTEREST-LOST-DATA.
  6894             20  AM-FLI-BANK-NO            PIC X(5).
  6895             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6896             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6897             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6898         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6899             20  AM-FLI-AGT                PIC X(9).
  6900             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6901             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6902         16  FILLER                        PIC X(102).
  6903
  6904     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6905         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6906             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6907             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6908             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6909             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6910             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6911         16  FILLER                          PIC X(10).
  6912******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 127
* EL050.cbl
  6914*    COPY ERCREIN.
  6915******************************************************************
  6916*                                                                *
  6917*                            ERCREIN                             *
  6918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6919*                            VMOD=2.010                          *
  6920*                                                                *
  6921*   ONLINE CREDIT SYSTEM                                         *
  6922*                                                                *
  6923*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6924*                                                                *
  6925*   FILE TYPE = VSAM,KSDS                                        *
  6926*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6927*                                                                *
  6928*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6929*       ALTERNATE PATH = NONE                                    *
  6930*                                                                *
  6931*   LOG = NO                                                     *
  6932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6933*                                                                *
  6934******************************************************************
  6935*                   C H A N G E   L O G
  6936*
  6937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6938*-----------------------------------------------------------------
  6939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6940* EFFECTIVE    NUMBER
  6941*-----------------------------------------------------------------
  6942* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6943* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6944******************************************************************
  6945 01  REINSURANCE-RECORD.
  6946     12  RE-RECORD-ID                      PIC XX.
  6947         88  VALID-RE-ID                      VALUE 'RE'.
  6948
  6949     12  RE-CONTROL-PRIMARY.
  6950         16  RE-COMPANY-CD                 PIC X.
  6951         16  RE-KEY.
  6952             20  RE-CODE                   PIC X.
  6953                 88  RE-TABLE-RECORD          VALUE 'A'.
  6954                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6955             20  RE-TABLE                  PIC XXX.
  6956             20  FILLER                    PIC XXX.
  6957         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6958             20  FILLER                    PIC X.
  6959             20  RE-COMPANY.
  6960                 24  RE-COMP-PRIME         PIC XXX.
  6961                 24  RE-COMP-SUB           PIC XXX.
  6962
  6963     12  RE-MAINT-INFORMATION.
  6964         16  RE-LAST-MAINT-DT              PIC XX.
  6965         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6966         16  RE-LAST-MAINT-USER            PIC X(4).
  6967         16  FILLER                        PIC X(10).
  6968
  6969     12  RE-TABLE-DATA.
  6970         16  RE-100-COMP                   PIC 99.
  6971
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 128
* EL050.cbl
  6972         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6973             20  RE-REI-COMP-NO.
  6974                 24  RE-REI-COMP           PIC XXX.
  6975                 24  RE-REI-COMP-SUB       PIC XXX.
  6976             20  RE-LF-QC                  PIC X.
  6977             20  RE-AH-QC                  PIC X.
  6978             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6979             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6980             20  RE-LFAGE-LO               PIC 99.
  6981             20  RE-LFAGE-HI               PIC 99.
  6982             20  RE-AHAGE-LO               PIC 99.
  6983             20  RE-AHAGE-HI               PIC 99.
  6984             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6985             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6986             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6987             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6988             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6989             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6990             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6991             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6992             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6993             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6994             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6995             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6996             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6997             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6998             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6999             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7000             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7001             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7002             20  RE-LF-BEN-CODE            PIC X.
  7003             20  RE-AH-BEN-CODE            PIC X.
  7004             20  RE-INTERACTIVE            PIC X.
  7005             20  RE-REMAINING              PIC X.
  7006             20  RE-LF-RUNOFF-SW           PIC X.
  7007             20  RE-AH-RUNOFF-SW           PIC X.
  7008             20  FILLER                    PIC X(19).
  7009
  7010         16  RE-COMP-INFO-END              PIC X(6).
  7011         16  RE-NSP-ST-CD-LF               PIC XX.
  7012         16  RE-NSP-ST-CD-AH               PIC XX.
  7013         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7014             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7015
  7016         16  FILLER                        PIC X(27).
  7017
  7018     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7019         16  RE-NAME                       PIC X(30).
  7020         16  RE-LF-PE                      PIC X.
  7021         16  RE-AH-PE                      PIC X.
  7022         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7023         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7024         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7025         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7026         16  RE-PRT-ST                     PIC X.
  7027         16  RE-PRT-OW                     PIC X.
  7028         16  RE-MORT-CODE                  PIC X(4).
  7029         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 129
* EL050.cbl
  7030         16  RE-ZERO-LF-FEE                PIC X.
  7031         16  RE-ZERO-AH-FEE                PIC X.
  7032         16  RE-CEDE-NAME                  PIC X(30).
  7033         16  RE-LF-COMM                    PIC X.
  7034         16  RE-AH-COMM                    PIC X.
  7035         16  RE-LF-TAX                     PIC X.
  7036         16  RE-AH-TAX                     PIC X.
  7037         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7038         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7039         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7040
  7041         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7042             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7043
  7044         16  RE-LF-CEDING-FEE-BRACKETS.
  7045             20  RE-LF-FEE-METHOD          PIC X.
  7046                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7047                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7048                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7049                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7050             20  RE-LF-FEE-BASIS           PIC X.
  7051                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7052                 88  RE-LF-NET-CEDED               VALUE '2'.
  7053                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7054                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7055                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7056                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7057                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7058                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7059             20  FILLER                    PIC XXX.
  7060             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7061                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7062                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7063
  7064         16  RE-AH-CEDING-FEE-BRACKETS.
  7065             20  RE-AH-FEE-METHOD          PIC X.
  7066                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7067                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7068                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7069                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7070             20  RE-AH-FEE-BASIS           PIC X.
  7071                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7072                 88  RE-AH-NET-CEDED               VALUE '2'.
  7073                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7074                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7075                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7076                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7077                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7078                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7079             20  FILLER                    PIC XXX.
  7080             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7081                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7082                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7083
  7084         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7085
  7086         16  RE-OLD-CEDING-STMT            PIC X.
  7087
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 130
* EL050.cbl
  7088         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7089         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7090         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7091         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7092         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7093         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7094         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7095         16  RE-MORT-SW                    PIC X.
  7096         16  RE-CEDING-TYPE-FLAG           PIC X.
  7097             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7098             88  RE-CEDED                          VALUE 'C'.
  7099             88  RE-ASSUMED                        VALUE 'A'.
  7100             88  RE-PHANTOM                        VALUE 'P'.
  7101
  7102         16  RE-CEDING-STMT-OPT-A          PIC X.
  7103             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7104         16  RE-CEDING-STMT-OPT-B          PIC X.
  7105             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7106         16  RE-CEDING-STMT-OPT-C          PIC X.
  7107             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7108         16  RE-CEDING-STMT-OPT-D          PIC X.
  7109             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7110         16  RE-CEDING-STMT-OPT-E          PIC X.
  7111             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7112
  7113         16  RE-PRT-CRSV                   PIC X.
  7114
  7115         16  RE-GL-CENTER                  PIC X(4).
  7116
  7117         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7118
  7119         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7120
  7121         16  RE-EARN-STOP-CODE             PIC X.
  7122             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7123             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7124
  7125         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7126             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7127
  7128         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7129         16  FILLER                        PIC X(2281).
  7130
  7131         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7132
  7133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 131
* EL050.cbl
  7135*    COPY ERCCTBL.
  7136******************************************************************
  7137*                                                                *
  7138*                                                                *
  7139*                            ERCCTBL                             *
  7140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7141*                            VMOD=2.003
  7142*                                                                *
  7143*   ONLINE CREDIT SYSTEM                                         *
  7144*                                                                *
  7145*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7146*                                                                *
  7147*   FILE TYPE = VSAM,KSDS                                        *
  7148*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7149*                                                                *
  7150*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7151*       ALTERNATE PATH = NONE                                    *
  7152*                                                                *
  7153*   LOG = NO                                                     *
  7154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7155*                                                                *
  7156*                                                                *
  7157******************************************************************
  7158
  7159 01  COMM-TABLE-RECORD.
  7160     12  CT-RECORD-ID                      PIC XX.
  7161         88  VALID-CT-ID                      VALUE 'CT'.
  7162
  7163     12  CT-CONTROL-PRIMARY.
  7164         16  CT-COMPANY-CD                 PIC X.
  7165         16  CT-TABLE                      PIC XXX.
  7166         16  CT-CNTRL-2.
  7167             20  CT-BEN-TYPE               PIC X.
  7168             20  CT-BEN-CODE               PIC XX.
  7169
  7170     12  CT-MAINT-INFORMATION.
  7171         16  CT-LAST-MAINT-DT              PIC XX.
  7172         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7173         16  CT-LAST-MAINT-USER            PIC X(4).
  7174         16  FILLER                        PIC X(31).
  7175
  7176     12  CT-LIMITS.
  7177         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7178
  7179         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7180
  7181         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7182
  7183     12  CT-RATES.
  7184         16  CT-RTX          OCCURS 27 TIMES.
  7185             20  CT-RT                     PIC SV9(5)     COMP-3.
  7186             20  CT-RT-R   REDEFINES
  7187                 CT-RT                     PIC XXX.
  7188
  7189     12  FILLER                            PIC  X(42).
  7190
  7191******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 132
* EL050.cbl
  7193*    COPY ERCFORM.
  7194******************************************************************
  7195*                                                                *
  7196*                                                                *
  7197*                            ERCFORM.                            *
  7198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7199*                            VMOD=2.003                          *
  7200*                                                                *
  7201*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7202*                                                                *
  7203*    FILE TYPE = VSAM,KSDS                                       *
  7204*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7205*                                                                *
  7206*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7207*                                                                *
  7208*    LOG = YES                                                   *
  7209*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7210******************************************************************
  7211 01  FORM-MASTER.
  7212    12  FO-RECORD-ID                 PIC X(02).
  7213        88  VALID-FO-ID                  VALUE 'FO'.
  7214
  7215    12  FO-CONTROL-PRIMARY.
  7216        16  FO-COMPANY-CD            PIC X(01).
  7217        16  FO-STATE                 PIC X(02).
  7218        16  FO-FORM-ID               PIC X(12).
  7219        16  FO-FORM-EXP-DT           PIC X(02).
  7220
  7221    12  FO-POLICY-FORM-DATA.
  7222        16  FO-IND-GRP-CD            PIC X(01).
  7223        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7224        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7225        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7226        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7227        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7228        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7229        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7230        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7231        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7232        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7233        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7234        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7235        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7236        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7237        16  FO-APP-CERT-USE-CD       PIC X(01).
  7238
  7239    12  FILLER                       PIC X(29).
  7240
  7241    12  FO-FORM-PLAN-TABLE.
  7242        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7243            20  FO-PLAN-TYPE         PIC X(01).
  7244            20  FO-PLAN-ID           PIC X(02).
  7245            20  FO-PLAN-TERM         PIC 9(03).
  7246            20  FO-PLAN-REFUND-METHOD
  7247                                     PIC X.
  7248
  7249    12  FILLER                       PIC X(30).
  7250
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 133
* EL050.cbl
  7251    12  FO-COMMENTS-AREA.
  7252        16  FO-COMMENT-LINE-1        PIC X(78).
  7253
  7254    12  FILLER                       PIC X(20).
  7255
  7256    12  FO-MAINT-INFORMATION.
  7257        16  FO-LAST-MAINT-DT         PIC X(02).
  7258        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7259        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 134
* EL050.cbl
  7261*    COPY ELCMSTR.
  7262******************************************************************
  7263*                                                                *
  7264*                            ELCMSTR.                            *
  7265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7266*                            VMOD=2.012                          *
  7267*                                                                *
  7268*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7269*                                                                *
  7270*   FILE TYPE = VSAM,KSDS                                        *
  7271*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7272*                                                                *
  7273*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7274*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7275*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7276*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7277*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7278*                                                 RKP=75,LEN=21  *
  7279*                                                                *
  7280*   **** NOTE ****                                               *
  7281*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7282*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7283*                                                                *
  7284*   LOG = YES                                                    *
  7285*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7286******************************************************************
  7287*                   C H A N G E   L O G
  7288*
  7289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7290*-----------------------------------------------------------------
  7291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7292* EFFECTIVE    NUMBER
  7293*-----------------------------------------------------------------
  7294* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7295* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7296* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7297******************************************************************
  7298 01  CLAIM-MASTER.
  7299     12  CL-RECORD-ID                PIC XX.
  7300         88  VALID-CL-ID         VALUE 'CL'.
  7301
  7302     12  CL-CONTROL-PRIMARY.
  7303         16  CL-COMPANY-CD           PIC X.
  7304         16  CL-CARRIER              PIC X.
  7305         16  CL-CLAIM-NO             PIC X(7).
  7306         16  CL-CERT-NO.
  7307             20  CL-CERT-PRIME       PIC X(10).
  7308             20  CL-CERT-SFX         PIC X.
  7309
  7310     12  CL-CONTROL-BY-NAME.
  7311         16  CL-COMPANY-CD-A1        PIC X.
  7312         16  CL-INSURED-LAST-NAME    PIC X(15).
  7313         16  CL-INSURED-NAME.
  7314             20  CL-INSURED-1ST-NAME PIC X(12).
  7315             20  CL-INSURED-MID-INIT PIC X.
  7316
  7317     12  CL-CONTROL-BY-SSN.
  7318         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 135
* EL050.cbl
  7319         16  CL-SOC-SEC-NO.
  7320             20  CL-SSN-STATE        PIC XX.
  7321             20  CL-SSN-ACCOUNT      PIC X(6).
  7322             20  CL-SSN-LN3          PIC X(3).
  7323
  7324     12  CL-CONTROL-BY-CERT-NO.
  7325         16  CL-COMPANY-CD-A4        PIC X.
  7326         16  CL-CERT-NO-A4.
  7327             20  CL-CERT-A4-PRIME    PIC X(10).
  7328             20  CL-CERT-A4-SFX      PIC X.
  7329
  7330     12  CL-CONTROL-BY-CCN.
  7331         16  CL-COMPANY-CD-A5        PIC X.
  7332         16  CL-CCN-A5.
  7333             20  CL-CCN.
  7334                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7335                 24  CL-CCN-PRIME-A5 PIC X(12).
  7336             20  CL-CCN-FILLER-A5    PIC X(4).
  7337
  7338     12  CL-INSURED-PROFILE-DATA.
  7339         16  CL-INSURED-BIRTH-DT     PIC XX.
  7340         16  CL-INSURED-SEX-CD       PIC X.
  7341             88  INSURED-IS-MALE        VALUE 'M'.
  7342             88  INSURED-IS-FEMALE      VALUE 'F'.
  7343             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7344         16  CL-INSURED-OCC-CD       PIC X(6).
  7345         16  FILLER                  PIC X(5).
  7346
  7347     12  CL-PROCESSING-INFO.
  7348         16  CL-PROCESSOR-ID         PIC X(4).
  7349         16  CL-CLAIM-STATUS         PIC X.
  7350             88  CLAIM-IS-OPEN          VALUE 'O'.
  7351             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7352         16  CL-CLAIM-TYPE           PIC X.
  7353*            88  AH-CLAIM               VALUE 'A'.
  7354*            88  LIFE-CLAIM             VALUE 'L'.
  7355*            88  PROPERTY-CLAIM         VALUE 'P'.
  7356*            88  IUI-CLAIM              VALUE 'I'.
  7357*            88  GAP-CLAIM              VALUE 'G'.
  7358         16  CL-CLAIM-PREM-TYPE      PIC X.
  7359             88  SINGLE-PREMIUM         VALUE '1'.
  7360             88  O-B-COVERAGE           VALUE '2'.
  7361             88  OPEN-END-COVERAGE      VALUE '3'.
  7362         16  CL-INCURRED-DT          PIC XX.
  7363         16  CL-REPORTED-DT          PIC XX.
  7364         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7365         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7366         16  CL-LAST-PMT-DT          PIC XX.
  7367         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7368         16  CL-PAID-THRU-DT         PIC XX.
  7369         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7370         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7371         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7372         16  CL-PMT-CALC-METHOD      PIC X.
  7373             88  CL-360-DAY-YR          VALUE '1'.
  7374             88  CL-365-DAY-YR          VALUE '2'.
  7375             88  CL-FULL-MONTHS         VALUE '3'.
  7376         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 136
* EL050.cbl
  7377
  7378         16  CL-PRIME-CERT-NO.
  7379             20  CL-PRIME-CERT-PRIME PIC X(10).
  7380             20  CL-PRIME-CERT-SFX   PIC X.
  7381
  7382         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7383             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7384             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7385
  7386         16  CL-MICROFILM-NO         PIC X(10).
  7387         16  CL-PROG-FORM-TYPE       PIC X.
  7388         16  CL-LAST-ADD-ON-DT       PIC XX.
  7389
  7390         16  CL-LAST-REOPEN-DT       PIC XX.
  7391         16  CL-LAST-CLOSE-DT        PIC XX.
  7392         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7393             88  FINAL-PAID             VALUE '1'.
  7394             88  CLAIM-DENIED           VALUE '2'.
  7395             88  AUTO-CLOSE             VALUE '3'.
  7396             88  MANUAL-CLOSE           VALUE '4'.
  7397             88  BENEFITS-CHANGED       VALUE 'C'.
  7398             88  SETUP-ERRORS           VALUE 'E'.
  7399         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7400         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7401         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7402             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7403         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7404         16  FILLER                  PIC X.
  7405
  7406     12  CL-CERTIFICATE-DATA.
  7407         16  CL-CERT-ORIGIN          PIC X.
  7408             88  CERT-WAS-ONLINE        VALUE '1'.
  7409             88  CERT-WAS-CREATED       VALUE '2'.
  7410             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7411         16  CL-CERT-KEY-DATA.
  7412             20  CL-CERT-CARRIER     PIC X.
  7413             20  CL-CERT-GROUPING    PIC X(6).
  7414             20  CL-CERT-STATE       PIC XX.
  7415             20  CL-CERT-ACCOUNT.
  7416                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7417                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7418             20  CL-CERT-EFF-DT      PIC XX.
  7419
  7420     12  CL-STATUS-CONTROLS.
  7421         16  CL-PRIORITY-CD          PIC X.
  7422             88  CONFIDENTIAL-DATA      VALUE '8'.
  7423             88  HIGHEST-PRIORITY       VALUE '9'.
  7424         16  CL-SUPV-ATTN-CD         PIC X.
  7425             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7426             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7427         16  CL-PURGED-DT            PIC XX.
  7428         16  CL-RESTORED-DT          PIC XX.
  7429         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7430         16  CL-NEXT-RESEND-DT       PIC XX.
  7431         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7432         16  CL-CRITICAL-PERIOD      PIC 99.
  7433*        16  FILLER                  PIC XX.
  7434         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 137
* EL050.cbl
  7435         16  CL-LAST-MAINT-USER      PIC X(4).
  7436         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7437         16  CL-LAST-MAINT-TYPE      PIC X.
  7438             88  CLAIM-SET-UP           VALUE ' '.
  7439             88  PAYMENT-MADE           VALUE '1'.
  7440             88  LETTER-SENT            VALUE '2'.
  7441             88  MASTER-WAS-ALTERED     VALUE '3'.
  7442             88  MASTER-WAS-RESTORED    VALUE '4'.
  7443             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7444             88  FILE-CONVERTED         VALUE '6'.
  7445             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7446             88  ERROR-CORRECTION       VALUE 'E'.
  7447         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7448         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7449         16  CL-BENEFICIARY          PIC X(10).
  7450         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7451         16  CL-DENIAL-TYPE          PIC X.
  7452             88  CL-TYPE-DENIAL          VALUE '1'.
  7453             88  CL-TYPE-RESCISSION      VALUE '2'.
  7454             88  CL-TYPE-REFORMATION     VALUE '3'.
  7455             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7456             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7457         16  CL-CRIT-PER-RECURRENT   PIC X.
  7458         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7459         16  CL-RTW-DT               PIC XX.
  7460
  7461     12  CL-TRAILER-CONTROLS.
  7462         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7463             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7464             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7465             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7466         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7467         16  FILLER                  PIC XX.
  7468         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7469         16  CL-ADDRESS-TRAILER-CNT.
  7470             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7471                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7472             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7473                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7474             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7475                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7476             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7477                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7478             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7479                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7480             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7481                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7482             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7483                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7484
  7485     12  CL-CV-REFERENCE-NO.
  7486         16  CL-CV-REFNO-PRIME       PIC X(18).
  7487         16  CL-CV-REFNO-SFX         PIC XX.
  7488
  7489     12  CL-FILE-LOCATION            PIC X(4).
  7490
  7491     12  CL-PROCESS-ERRORS.
  7492         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 138
* EL050.cbl
  7493             88  NO-FATAL-ERRORS        VALUE ZERO.
  7494         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7495             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7496
  7497     12  CL-PRODUCT-CD               PIC X.
  7498
  7499     12  CL-CURRENT-KEY-DATA.
  7500         16  CL-CURRENT-CARRIER      PIC X.
  7501         16  CL-CURRENT-GROUPING     PIC X(6).
  7502         16  CL-CURRENT-STATE        PIC XX.
  7503         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7504
  7505     12  CL-ASSOCIATES               PIC X.
  7506         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7507         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7508         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7509         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7510
  7511     12  CL-ACTIVITY-CODE            PIC 99.
  7512     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7513     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7514
  7515     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7516     12  CL-LAG-REPORT-CODE          PIC 9.
  7517     12  CL-LOAN-TYPE                PIC XX.
  7518     12  CL-LEGAL-STATE              PIC XX.
  7519
  7520     12  CL-YESNOSW                  PIC X.
  7521     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7522         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7523         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7524         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7525     12  cl-insured-claim            pic x.
  7526         88  cl-claim-on-primary         value 'P'.
  7527         88  cl-claim-on-secondary       value 'S'.
  7528     12  cl-benefit-expiration-dt    PIC XX.
  7529
  7530 01  PLAN-RECORDS.
  7531     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7532     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7533
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 139
* EL050.cbl
  7535 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7536                          ACCOUNT-MASTER REINSURANCE-RECORD
  7537                          COMM-TABLE-RECORD FORM-MASTER
  7538                          CLAIM-MASTER PLAN-RECORDS.
  7539 0000-DFHEXIT SECTION.
  7540     MOVE '9#                    $   ' TO DFHEIV0.
  7541     MOVE 'EL050' TO DFHEIV1.
  7542     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7543
  7544     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7545
  7546
  7547* EXEC CICS  HANDLE CONDITION
  7548*           ERROR    (9300-ABEND)
  7549*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7550*    END-EXEC.
  7551*    MOVE '"$.J                  ! " #00007542' TO DFHEIV0
  7552     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7554     MOVE X'2220233030303037353432' TO DFHEIV0(25:11)
  7555     CALL 'kxdfhei1' USING DFHEIV0
  7556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7557
  7558
  7559 0000-COPY-PROCEDURE-DIV.
  7560*                          COPY ELC50PD.
  7561******************************************************************
  7562*                                                                *
  7563*                            ELC50PD                             *
  7564*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7565*                            VMOD=2.188                          *
  7566*                                                                *
  7567******************************************************************
  7568*                   C H A N G E   L O G
  7569*
  7570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7571*-----------------------------------------------------------------
  7572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7573* EFFECTIVE    NUMBER
  7574*-----------------------------------------------------------------
  7575* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7576* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7577* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7578*                             2709 AND 2718
  7579* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7580* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7581* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7582* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7583* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7584*                                IS OPEN OR CNC DT < PD THRU
  7585* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7586* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7587* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7588* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7589* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7590* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7591* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7592* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 140
* EL050.cbl
  7593* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7594* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7595* 020906                   PEMA  EXPAND LOAN OFFICER
  7596* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7597* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7598* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7599* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7600* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7601* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7602* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7603* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7604* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7605* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7606* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7607* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7608* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7609* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7610* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7611* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7612* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7613* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7614* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7615* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7616* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7617* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7618* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7619* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7620* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7621*                                UPDATE VIN ON CERT TRAILER
  7622* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7623* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7624* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7625* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7626* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7627* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7628* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7629* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7630* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7631* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7632* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7633* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7634* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7635* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7636* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7637* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7638* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7639* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7640* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7641* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7642* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7643* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7644* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7645* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7646* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7647* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7648* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7649* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7650* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 141
* EL050.cbl
  7651* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7652* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7653* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7654* 032912  CR2011110200001  PEMA  AHL CHANGES
  7655* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7656* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7657* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7658* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7659* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7660* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7661* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7662* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7663* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7664* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7665* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7666* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7667* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7668* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7669* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7670* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7671* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7672* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7673* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7674* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7675* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7676******************************************************************
  7677************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7678******************************************************************
  7679
  7680     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7681
  7682     MOVE SPACES                 TO PB-FATAL-FLAG
  7683                                    PB-FORCE-ER-CD
  7684                                    PB-WARN-ER-CD
  7685                                    PB-OUT-BAL-CD.
  7686
  7687     MOVE SPACE                  TO WS-IG-OVRD-AH
  7688                                    WS-IG-OVRD-LF
  7689                                    WS-IG-OVRD-AM
  7690                                    WS-IG-OVRD
  7691                                    WS-IG-OVRD-AH-PL
  7692                                    WS-IG-OVRD-LF-PL
  7693                                    WS-IG-OVRD-AH-BEN
  7694                                    WS-IG-OVRD-LF-BEN.
  7695
  7696******************************************************************
  7697*************       INITIALIZE COMMON ERRORS       ***************
  7698******************************************************************
  7699
  7700     MOVE +0                     TO PB-NO-OF-ERRORS.
  7701     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7702
  7703******************************************************************
  7704
  7705     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7706     SET JULIAN-TO-BIN           TO TRUE.
  7707*    MOVE 5                      TO DC-OPTION-CODE.
  7708     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 142
* EL050.cbl
  7709     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7710
  7711     MOVE ZERO                   TO  SUB4.
  7712
  7713 0040-INITIALIZE-GA-BILL-DT.
  7714
  7715     ADD +1                      TO  SUB4.
  7716
  7717     IF  SUB4 GREATER THAN +5
  7718         GO TO 0050-CHECK-CNTL-FOUND.
  7719
  7720     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7721         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7722
  7723     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7724
  7725 0050-CHECK-CNTL-FOUND.
  7726
  7727     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7728        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7729                                         WS-AH-REM-TERM-CALC
  7730                                         EC-CO-REM-TERM-CALC
  7731        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7732        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7733        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7734                                         WS-TOL-AH-CLAIM
  7735        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7736                                         WS-TOL-AH-PREM
  7737                                         EC-CO-TOL-PREM
  7738        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7739                                         WS-TOL-AH-REFUND
  7740                                         EC-CO-TOL-REFUND
  7741        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7742                                         WS-AH-REFUND-OVS-AMT
  7743                                         EC-CO-OVR-SHT-AMT
  7744        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7745                                         WS-TOL-AH-PREM-PCT
  7746                                         EC-CO-TOL-PREM-PCT
  7747        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7748                                         WS-TOL-AH-REFUND-PCT
  7749                                         EC-CO-TOL-REFUND-PCT
  7750        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7751                                         WS-AH-REFUND-OVS-PCT
  7752                                         EC-CO-OVR-SHT-PCT
  7753        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7754        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7755        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7756        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7757        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7758        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7759        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7760        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7761        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7762        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7763        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7764        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7765                                         EC-CO-MONTH-END-DT
  7766        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 143
* EL050.cbl
  7767          GO TO 0100-READ-ACCT.
  7768
  7769     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7770     MOVE SPACES                 TO CNTL-ACCESS.
  7771     MOVE '1'                    TO CNTL-REC-TYPE.
  7772     MOVE +0                     TO CNTL-SEQ-NO.
  7773
  7774     MOVE '1' TO RC-SW-1.
  7775     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7776     IF NOT CF-COMPANY-MASTER
  7777         MOVE ZEROS             TO WK-CO-TOL-PREM
  7778                                   WK-CO-TOL-CLAIM
  7779                                   WK-CO-TOL-REFUND
  7780                                   WK-REFUND-OVS-AMT
  7781                                   WK-REFUND-OVS-PCT
  7782                                   WK-CO-TOL-PREM-PCT
  7783                                   WK-CO-TOL-REFUND-PCT
  7784                                   WK-DEFAULT-APR
  7785                                   WK-CO-MAX-CAP
  7786        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7787                                   WK-CR-R78-METHOD
  7788                                   WK-CO-REF-REJECT-SW
  7789                                   WK-CO-PREM-REJECT-SW
  7790                                   WK-REM-TRM-CALC-OPTION
  7791                                   WK-BIRTH-DATE-INPUT
  7792                                   WK-JOINT-AGE-INPUT
  7793        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7794        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7795        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7796        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7797          GO TO 0099-COMPANY-NOT-FOUND.
  7798
  7799     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7800        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7801     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7802        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7803     IF CF-CO-TOL-CAP NOT NUMERIC
  7804        MOVE +0                    TO CF-CO-TOL-CAP.
  7805     IF CF-DEFAULT-APR NOT NUMERIC
  7806        MOVE +0                    TO CF-DEFAULT-APR.
  7807
  7808     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7809     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7810     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7811     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7812     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7813     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7814     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7815     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7816     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7817     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7818     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7819     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7820
  7821     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7822          CF-CO-OVR-SHT-AMT > +0
  7823        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7824
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 144
* EL050.cbl
  7825     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7826          CF-CO-OVR-SHT-PCT > +0
  7827        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7828
  7829     IF CF-VALID-REM-TRM-OPTION
  7830         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7831     ELSE
  7832         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7833
  7834     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7835     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7836     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7837     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7838
  7839     GO TO 0050-CHECK-CNTL-FOUND.
  7840
  7841 0099-COMPANY-NOT-FOUND.
  7842
  7843     MOVE ER-2616                TO WS-ERROR.
  7844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7845
  7846 0100-READ-ACCT.
  7847
  7848     MOVE SPACES                 TO DATE-RANGE-SW.
  7849
  7850     IF WK-ACCT-ADDR = ZEROS
  7851        GO TO 0102-ACCT-GETMAIN.
  7852
  7853     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7854     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7855     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7856
  7857     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7858        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7859        GO TO 0105-READ-ACCT
  7860     END-IF
  7861
  7862     IF PB-CARRIER NOT = SPACES
  7863        IF PB-CARRIER NOT = AM-VG-CARRIER
  7864           GO TO 0105-READ-ACCT.
  7865
  7866     IF PB-STATE NOT = SPACES
  7867        IF PB-STATE NOT = AM-VG-STATE
  7868           GO TO 0105-READ-ACCT.
  7869
  7870     IF PB-GROUPING NOT = SPACES
  7871        IF PB-GROUPING NOT = AM-VG-GROUPING
  7872           GO TO 0105-READ-ACCT.
  7873
  7874     MOVE 'X'                 TO DATE-RANGE-SW.
  7875
  7876     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7877        MOVE 'X'                 TO DATE-RANGE-SW
  7878        GO TO 0105-READ-ACCT.
  7879
  7880     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7881        GO TO 0105-READ-ACCT.
  7882
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 145
* EL050.cbl
  7883     GO TO 0180-ACCOUNT-FOUND.
  7884
  7885 0102-ACCT-GETMAIN.
  7886     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7887     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7888
  7889 0105-READ-ACCT.
  7890     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7891     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7892     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7893     MOVE PB-STATE               TO ACCT-STATE.
  7894     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7895     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7896
  7897     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7898
  7899     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7900
  7901 0110-FIND-ACCT-TOLERANCES-LOOP.
  7902     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7903
  7904     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7905        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7906        GO TO 0199-ACCT-NOT-FOUND
  7907     END-IF
  7908     IF PB-CARRIER NOT = SPACES
  7909        IF PB-CARRIER NOT = AM-VG-CARRIER
  7910           GO TO 0199-ACCT-NOT-FOUND.
  7911
  7912     IF PB-STATE NOT = SPACES
  7913        IF PB-STATE NOT = AM-VG-STATE
  7914           GO TO 0199-ACCT-NOT-FOUND.
  7915
  7916     IF PB-GROUPING NOT = SPACES
  7917        IF PB-GROUPING NOT = AM-VG-GROUPING
  7918           GO TO 0199-ACCT-NOT-FOUND.
  7919
  7920     MOVE 'X'                    TO DATE-RANGE-SW.
  7921
  7922     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7923        MOVE 'X'                 TO DATE-RANGE-SW
  7924        GO TO 0199-ACCT-NOT-FOUND.
  7925
  7926     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7927        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7928
  7929 0180-ACCOUNT-FOUND.
  7930     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7931     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7932     MOVE AM-STATE               TO PB-SV-STATE.
  7933     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7934
  7935     IF AM-CANCEL-FEE  NOT NUMERIC
  7936        MOVE ZEROS TO AM-CANCEL-FEE.
  7937
  7938     IF AM-MAX-MON-BEN NOT NUMERIC
  7939        MOVE ZEROS TO AM-MAX-MON-BEN.
  7940
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 146
* EL050.cbl
  7941     IF AM-MAX-TOT-BEN NOT NUMERIC
  7942        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7943
  7944     IF AM-CLP-TOL-PCT NOT NUMERIC
  7945        MOVE +0                  TO AM-CLP-TOL-PCT
  7946     END-IF
  7947     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7948        MOVE +0                  TO AM-SPP-LEASE-COMM
  7949     END-IF
  7950     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7951        MOVE ER-2611             TO   WS-ERROR
  7952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7953
  7954     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7955        MOVE ER-2621             TO   WS-ERROR
  7956        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7957
  7958     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7959        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7960        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7961        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7962         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7963
  7964     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7965     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7966     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7967     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7968     IF AM-CLP-TOL-PCT NOT = ZEROS
  7969        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7970     END-IF
  7971     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7972        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7973     END-IF
  7974*    IF PB-COMPANY-ID = 'DCC'
  7975*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7976*                                   WS-ADMIN-FEES
  7977*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7978*          (SUB5 > +10)
  7979*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7980*             AND (AM-A-COM (SUB5) NUMERIC)
  7981*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7982*                + (AM-A-COM (SUB5) * 1000)
  7983*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7984*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7985*                + (AM-A-COM (SUB5) * 1000)
  7986*             END-IF
  7987*             IF AM-COM-TYP (SUB5) = 'N'
  7988*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7989*                + (AM-A-COM (SUB5) * 1000)
  7990*             END-IF
  7991*          END-IF
  7992*       END-PERFORM
  7993*    END-IF
  7994     IF (PB-COMPANY-ID = 'DCC')
  7995        AND (PB-ISSUE)
  7996        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7997        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7998           (SUB5 > +10)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 147
* EL050.cbl
  7999           MOVE +0 TO WS-WK-RATE
  8000           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8001              IF (AM-A-COM (SUB5) NUMERIC)
  8002                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8003                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8004              ELSE
  8005                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8006                 IF PB-ISSUE
  8007                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8008                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8009                 ELSE
  8010                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8011                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8012                 END-IF
  8013                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8014                 MOVE ZEROS             TO WS-SUB1
  8015                                           WS-COMMISSION
  8016                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8017                 MOVE '0530'               TO CTBL-SW
  8018                 MOVE ' '                  TO WS-CTBL-READ-SW
  8019                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8020                 IF FIRST-TIME-THROUGH
  8021                    MOVE 'AA'              TO CTBL-BEN-CODE
  8022                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8023                 END-IF
  8024                 IF CTBL-TABLE-FOUND
  8025                    IF PB-ISSUE
  8026                       COMPUTE WS-COMM-CK-AMT =
  8027                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8028                    ELSE
  8029                       COMPUTE WS-COMM-CK-AMT =
  8030                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8031                    END-IF
  8032                    PERFORM 8800-GET-COMP-RATE
  8033                              THRU 8800-EXIT
  8034                 END-IF
  8035              END-IF
  8036              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8037                + (WS-WK-RATE * 1000)
  8038           END-IF
  8039        END-PERFORM
  8040     END-IF
  8041     IF PB-COMPANY-ID EQUAL 'CRI'
  8042         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8043
  8044     IF PB-COMPANY-ID EQUAL 'NCL'
  8045         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8046     END-IF
  8047
  8048     GO TO 0200-READ-CERT.
  8049
  8050 0199-ACCT-NOT-FOUND.
  8051
  8052     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8053
  8054     IF DATE-RANGE-SW NOT = SPACES
  8055        MOVE ER-2601             TO WS-ERROR
  8056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 148
* EL050.cbl
  8057     ELSE
  8058        MOVE ER-2619             TO WS-ERROR
  8059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8060
  8061     GO TO 9990-RETURN.
  8062
  8063 0200-READ-CERT.
  8064
  8065     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8066     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8067     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8068     MOVE PB-SV-STATE            TO CERT-STATE.
  8069     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8070     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8071     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8072
  8073     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8074
  8075     IF CERT-WAS-NOT-FOUND
  8076        GO TO 0299-CERT-NOT-FOUND.
  8077
  8078     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8079        MOVE ER-2759             TO WS-ERROR
  8080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8081        GO TO 0298-UNLOCK-RETURN.
  8082
  8083     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8084         MOVE ER-2758            TO WS-ERROR
  8085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8086         GO TO 0298-UNLOCK-RETURN.
  8087
  8088     IF PB-ISSUE
  8089        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8090           IF CERT-WAS-CREATED-FOR-CLAIM
  8091              NEXT SENTENCE
  8092            ELSE
  8093              MOVE ER-2626       TO WS-ERROR
  8094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8095              GO TO 0298-UNLOCK-RETURN.
  8096
  8097     IF NOT PB-CANCELLATION
  8098        GO TO 0300-CONTINUE-EDIT.
  8099
  8100     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8101     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8102     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8103     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8104     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8105     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8106
  8107     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8108     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8109     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8110     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8111     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8112     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8113     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8114     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 149
* EL050.cbl
  8115     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8116
  8117     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8118     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8119     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8120     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8121     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8122     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8123     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8124
  8125     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8126     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8127
  8128     MOVE CM-CREDIT-INTERFACE-SW-1
  8129                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8130     MOVE CM-CREDIT-INTERFACE-SW-2
  8131                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8132
  8133     IF CM-O-B-COVERAGE
  8134         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8135
  8136     IF CM-LIVES NOT NUMERIC
  8137         MOVE ZERO                TO CM-LIVES.
  8138
  8139     IF CM-BILLED NOT NUMERIC
  8140         MOVE ZERO                TO CM-BILLED.
  8141
  8142     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8143         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8144         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8145         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8146         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8147         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8148         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8149         MOVE CM-LIVES             TO PB-CI-LIVES
  8150*The next line causes a problem with my change  I dont think it is
  8151*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8152
  8153     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8154     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8155     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8156     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8157     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8158     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8159
  8160     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8161     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8162     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8163     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8164
  8165     IF CM-LIFE-COMM-PCT NUMERIC
  8166         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8167     ELSE
  8168         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8169
  8170     IF CM-AH-COMM-PCT NUMERIC
  8171         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8172     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 150
* EL050.cbl
  8173         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8174
  8175     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8176
  8177     IF CM-LOAN-APR       NOT NUMERIC
  8178           MOVE ZERO               TO CM-LOAN-APR.
  8179
  8180     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8181           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8182
  8183     IF CM-LOAN-TERM      NOT NUMERIC
  8184           MOVE ZERO               TO CM-LOAN-TERM.
  8185
  8186     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8187           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8188
  8189     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8190           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8191
  8192     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8193     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8194     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8195     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8196     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8197     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8198     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8199     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8200     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8201     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8202     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8203     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8204
  8205     IF CM-STATE = CM-SSN-STATE
  8206         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8207
  8208     IF CM-STATE NOT = CM-MEMB-STATE
  8209         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8210
  8211     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8212
  8213     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8214        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8215        IF CM-ADDL-CLP NOT NUMERIC
  8216           MOVE +0               TO CM-ADDL-CLP
  8217        END-IF
  8218        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8219        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8220           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8221        END-IF
  8222     END-IF
  8223     IF PB-COMPANY-ID = 'DCC'
  8224        MOVE +0                  TO WS-ADMIN-FEES
  8225                                    WS-CSO-ADMIN-FEE
  8226                                    WS-COMM-AND-MFEE
  8227                                    WS-1ST-YR-ALLOW
  8228        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8229           (SUB5 > +10)
  8230           MOVE +0 TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 151
* EL050.cbl
  8231           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8232              IF (AM-A-COM (SUB5) NUMERIC)
  8233                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8234                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8235              ELSE
  8236                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8237                 IF PB-ISSUE
  8238                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8239                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8240                 ELSE
  8241                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8242                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8243                 END-IF
  8244                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8245                 MOVE ZEROS             TO WS-SUB1
  8246                                           WS-COMMISSION
  8247                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8248                 MOVE '0530'               TO CTBL-SW
  8249                 MOVE ' '                  TO WS-CTBL-READ-SW
  8250                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8251                 IF FIRST-TIME-THROUGH
  8252                    MOVE 'AA'              TO CTBL-BEN-CODE
  8253                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8254                 END-IF
  8255                 IF CTBL-TABLE-FOUND
  8256                    IF PB-ISSUE
  8257                       COMPUTE WS-COMM-CK-AMT =
  8258                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8259                    ELSE
  8260                       COMPUTE WS-COMM-CK-AMT =
  8261                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8262                    END-IF
  8263                    PERFORM 8800-GET-COMP-RATE
  8264                              THRU 8800-EXIT
  8265                 END-IF
  8266              END-IF
  8267              IF AM-COM-TYP (SUB5) = 'I'
  8268                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8269                   + (WS-WK-RATE * 1000)
  8270              END-IF
  8271              IF AM-COM-TYP (SUB5) = 'N'
  8272                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8273                   + (WS-WK-RATE * 1000)
  8274              END-IF
  8275              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8276                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8277                   + (WS-WK-RATE * 1000)
  8278              END-IF
  8279              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8280                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8281                   + (WS-WK-RATE * 1000)
  8282              END-IF
  8283           END-IF
  8284        END-PERFORM
  8285     END-IF
  8286     GO TO 0300-CONTINUE-EDIT.
  8287
  8288 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 152
* EL050.cbl
  8289      PERFORM 9250-UNLOCK-RETURN
  8290      GO TO 9990-RETURN.
  8291
  8292 0299-CERT-NOT-FOUND.
  8293
  8294     MOVE '1'                     TO CERT-STATUS-SW.
  8295
  8296     IF PB-COMPANY-ID = 'UCL'
  8297         IF WS-ERROR = ER-2799
  8298             GO TO 3000-CONTINUE-EDIT.
  8299
  8300     IF NOT PB-CANCELLATION
  8301         GO TO 0300-CONTINUE-EDIT.
  8302
  8303     MOVE ER-2726                  TO  WS-ERROR.
  8304     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8305     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8306     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8307                                    PB-CI-LF-TERM
  8308                                    PB-C-LF-REM-TERM
  8309                                    PB-CI-AH-TERM
  8310                                    PB-C-AH-REM-TERM
  8311                                    PB-CI-LF-BENEFIT-CD
  8312                                    PB-CI-LF-BENEFIT-AMT
  8313                                    PB-CI-LF-ALT-BENEFIT-AMT
  8314                                    PB-CI-LF-PREMIUM-AMT
  8315                                    PB-CI-LF-ALT-PREMIUM-AMT
  8316                                    PB-CI-AH-BENEFIT-CD
  8317                                    PB-CI-AH-BENEFIT-AMT
  8318                                    PB-CI-AH-PREMIUM-AMT
  8319                                    PB-CI-PAY-FREQUENCY
  8320                                    PB-CI-LOAN-APR
  8321                                    PB-CI-LOAN-TERM
  8322                                    PB-CI-LIFE-COMMISSION
  8323                                    PB-CI-AH-COMMISSION
  8324                                    PB-CI-CURR-SEQ
  8325                                    PB-CI-AH-CANCEL-AMT
  8326                                    PB-CI-LF-CANCEL-AMT
  8327                                    PB-CI-RATE-DEV-PCT-LF
  8328                                    PB-CI-RATE-DEV-PCT-AH
  8329                                    PB-CI-EXTENTION-DAYS
  8330                                    PB-CI-TERM-IN-DAYS
  8331                                    PB-CI-LIVES
  8332                                    PB-CI-LF-CRIT-PER
  8333                                    PB-CI-AH-CRIT-PER
  8334                                    PB-CI-ADDL-CLP
  8335                                    PB-CI-DDF-IU-RATE-UP.
  8336
  8337     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8338                                    PB-CI-AH-SETTLEMENT-DT
  8339                                    PB-CI-DEATH-DT
  8340                                    PB-CI-LF-PRIOR-CANCEL-DT
  8341                                    PB-CI-AH-PRIOR-CANCEL-DT
  8342                                    PB-CI-ENTRY-DT
  8343                                    PB-CI-LF-EXPIRE-DT
  8344                                    PB-CI-AH-EXPIRE-DT
  8345                                    PB-CI-LOAN-1ST-PMT-DT.
  8346
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 153
* EL050.cbl
  8347     IF ACCOUNT-MAST-FOUND
  8348        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8349        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8350
  8351
  8352 0300-CONTINUE-EDIT.
  8353
  8354     IF PB-ISSUE
  8355        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8356            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8357
  8358     IF PB-ISSUE
  8359        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8360            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8361
  8362     IF PB-ISSUE
  8363       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8364          (AM-NO-AH-ONLY)
  8365           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8366               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8367                   MOVE ER-2679 TO WS-ERROR
  8368                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8369
  8370     IF PB-ISSUE
  8371        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8372        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8373        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8374     ELSE
  8375        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8376        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8377        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8378
  8379     MOVE 'N'                    TO PLAN-MASTER-SW
  8380                                    PLAN-MASTER-LIFE-SW
  8381                                    FORM-MASTER-SW
  8382                                    WS-APP-CERT-SW.
  8383
  8384     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8385                                    WS-PL-TOL-LF-REFUND
  8386                                    WS-PL-REF-OVS-AMT
  8387                                    WS-PL-TOL-LF-PREM-PCT
  8388                                    WS-PL-TOL-LF-REFUND-PCT
  8389                                    WS-PL-REF-OVS-PCT
  8390                                    WS-PL-TOL-LF-CLAIM.
  8391
  8392     IF PB-COMPANY-ID = 'NCL'
  8393       IF PB-ISSUE
  8394         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8395             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8396             IF FORM-MASTER-FOUND
  8397                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8398
  8399     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8400        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8401
  8402********************** MON CODE **********************
  8403     IF PB-COMPANY-ID = 'MON'
  8404     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 154
* EL050.cbl
  8405     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8406        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8407             PB-I-LOAN-APR = ZERO)
  8408               MOVE 14.0         TO PB-I-LOAN-APR.
  8409******************************************************
  8410
  8411     IF PB-COMPANY-ID = 'NCL'
  8412       IF PB-ISSUE
  8413           IF FORM-MASTER-FOUND
  8414             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8415                AM-DISMBR-COVERAGE
  8416                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8417                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8418                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8419                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8420                                           PB-I-LIFE-BENEFIT-CD.
  8421
  8422     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8423
  8424     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8425         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8426         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8427         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8428         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8429         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8430           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8431             GO TO 0301-LIFE-BENEFIT-SEARCH
  8432         ELSE
  8433             NEXT SENTENCE
  8434     ELSE
  8435         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8436
  8437     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8438     MOVE '4'                    TO CNTL-REC-TYPE.
  8439     MOVE +0                     TO CNTL-SEQ-NO.
  8440     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8441
  8442     MOVE '1' TO RC-SW-2.
  8443     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8444
  8445     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8446        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8447         GO TO 0305-BENEFIT-NOT-FOUND.
  8448
  8449     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8450
  8451 0301-LIFE-BENEFIT-SEARCH.
  8452
  8453     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8454
  8455     IF NO-BENEFIT-FOUND
  8456        GO TO 0305-BENEFIT-NOT-FOUND.
  8457
  8458     IF WS-BEN-CD = '99'
  8459        GO TO 0305-BENEFIT-NOT-FOUND.
  8460
  8461     IF PB-COMPANY-ID = 'NCL'
  8462         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 155
* EL050.cbl
  8463             GO TO 0304-LIFE-BENEFIT-FOUND.
  8464
  8465     MOVE +1                     TO SUB5.
  8466     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8467
  8468* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8469* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8470     IF PB-COMPANY-ID = 'DMD'
  8471         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8472
  8473 0302-EDIT-ACCT-LF-BENEFITS.
  8474
  8475     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8476        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8477           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8478                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8479           GO TO 03XX-GET-LIFE-ERPLAN.
  8480
  8481     IF SUB5 LESS THAN +20
  8482        ADD +1                   TO SUB5
  8483        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8484
  8485     MOVE +1                     TO SUB5.
  8486
  8487     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8488        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8489
  8490 0303-EDIT-DMD-EXTRA-BENEFITS.
  8491
  8492     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8493        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8494           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8495                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8496           GO TO 03XX-GET-LIFE-ERPLAN.
  8497
  8498     IF SUB5 LESS THAN +30
  8499        ADD +1                   TO SUB5
  8500        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8501
  8502     MOVE +1                     TO SUB5.
  8503
  8504 03XX-EDIT-FOR-NINETY-LF.
  8505
  8506***************************************************************
  8507*                                                             *
  8508*    NINETY BENEFIT PLAN TYPES:                               *
  8509*                                                             *
  8510*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8511*      92 = ALL GROUP REDUCING BENEFITS                       *
  8512*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8513*      94 = ALL GROUP LEVEL BENEFITS                          *
  8514*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8515*           BENEFIT CONTROLS.                                 *
  8516*      99 = ALL BENEFITS                                      *
  8517*                                                             *
  8518***************************************************************
  8519
  8520     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 156
* EL050.cbl
  8521                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8522
  8523     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8524       AND
  8525        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8526        GO TO 03XX-GET-LIFE-ERPLAN.
  8527
  8528     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8529       AND
  8530        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8531        IF CF-REDUCING (SUB3)
  8532           IF (PB-I-INDV-GRP-OVRD = 'I')
  8533              OR
  8534           ((AM-IG = '1') AND
  8535           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8536              OR
  8537           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8538           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8539           (AM-IG NOT = '2'))
  8540              GO TO 03XX-GET-LIFE-ERPLAN.
  8541
  8542     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8543       AND
  8544        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8545        IF CF-REDUCING (SUB3)
  8546           IF (PB-I-INDV-GRP-OVRD = 'G')
  8547              OR
  8548           ((AM-IG = '2') AND
  8549           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8550              OR
  8551           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8552           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8553           (AM-IG NOT = '1'))
  8554              GO TO 03XX-GET-LIFE-ERPLAN.
  8555
  8556     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8557       AND
  8558        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8559        IF CF-LEVEL    (SUB3)
  8560           IF (PB-I-INDV-GRP-OVRD = 'I')
  8561              OR
  8562           ((AM-IG = '1') AND
  8563           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8564              OR
  8565           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8566           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8567            (AM-IG NOT = '2'))
  8568              GO TO 03XX-GET-LIFE-ERPLAN.
  8569
  8570     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8571       AND
  8572        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8573        IF CF-LEVEL    (SUB3)
  8574           IF (PB-I-INDV-GRP-OVRD = 'G')
  8575              OR
  8576           ((AM-IG = '2') AND
  8577           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8578              OR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 157
* EL050.cbl
  8579           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8580           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8581           (AM-IG NOT = '1'))
  8582              GO TO 03XX-GET-LIFE-ERPLAN.
  8583
  8584     IF SUB5 LESS THAN +20
  8585        ADD +1                   TO SUB5
  8586        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8587
  8588     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8589
  8590     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8591        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8592
  8593     MOVE +1                     TO SUB5.
  8594
  8595 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8596
  8597     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8598                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8599
  8600     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8601       AND
  8602        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8603        GO TO 03XX-GET-LIFE-ERPLAN.
  8604
  8605     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8606       AND
  8607        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8608        IF CF-REDUCING (SUB3)
  8609           IF (PB-I-INDV-GRP-OVRD = 'I')
  8610              OR
  8611           ((AM-IG = '1') AND
  8612           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8613              OR
  8614           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8615           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8616           (AM-IG NOT = '2'))
  8617              GO TO 03XX-GET-LIFE-ERPLAN.
  8618
  8619     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8620       AND
  8621        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8622        IF CF-REDUCING (SUB3)
  8623           IF (PB-I-INDV-GRP-OVRD = 'G')
  8624              OR
  8625           ((AM-IG = '2') AND
  8626           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8627              OR
  8628           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8629           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8630           (AM-IG NOT = '1'))
  8631              GO TO 03XX-GET-LIFE-ERPLAN.
  8632
  8633     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8634       AND
  8635        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8636        IF CF-LEVEL    (SUB3)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 158
* EL050.cbl
  8637           IF (PB-I-INDV-GRP-OVRD = 'I')
  8638              OR
  8639           ((AM-IG = '1') AND
  8640           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8641              OR
  8642           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8643           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8644            (AM-IG NOT = '2'))
  8645              GO TO 03XX-GET-LIFE-ERPLAN.
  8646
  8647     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8648       AND
  8649        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8650        IF CF-LEVEL    (SUB3)
  8651           IF (PB-I-INDV-GRP-OVRD = 'G')
  8652              OR
  8653           ((AM-IG = '2') AND
  8654           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8655              OR
  8656           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8657           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8658           (AM-IG NOT = '1'))
  8659              GO TO 03XX-GET-LIFE-ERPLAN.
  8660
  8661     IF SUB5 LESS THAN +30
  8662        ADD +1                   TO SUB5
  8663        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8664
  8665     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8666
  8667 03XX-EDIT-FOR-NINETY-LF-CONT.
  8668
  8669     MOVE +99                    TO SUB5.
  8670
  8671     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8672        IF PB-ISSUE
  8673           MOVE ER-1924          TO  WS-ERROR
  8674           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8675
  8676     GO TO 0304-LIFE-BENEFIT-FOUND.
  8677
  8678 03XX-GET-LIFE-ERPLAN.
  8679
  8680     IF WK-PLAN-ADDR EQUAL +0
  8681        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8682
  8683     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8684     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8685     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8686     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8687     MOVE 'Y'                    TO PLAN-MASTER-SW
  8688                                    PLAN-MASTER-LIFE-SW.
  8689     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8690
  8691 03XX-ERPLAN-LIFE-GETMAIN.
  8692
  8693     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8694     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 159
* EL050.cbl
  8695
  8696 03XX-ERPLAN-LIFE-READ.
  8697
  8698     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8699     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8700     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8701     MOVE PB-SV-STATE            TO PLAN-STATE.
  8702     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8703     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8704     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8705     MOVE WS-SAVE-BENEFIT-REVISION
  8706                                 TO PLAN-REVISION-NO.
  8707
  8708     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8709     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8710
  8711     IF PB-COMPANY-ID = 'NCL'
  8712       IF NOT LF-PLAN-MASTER-FOUND
  8713         IF NOT PB-POLICY-IS-DECLINED  AND
  8714            NOT PB-POLICY-IS-VOIDED
  8715             MOVE  ER-1921         TO  WS-ERROR
  8716             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8717             GO TO 0304-LIFE-BENEFIT-FOUND.
  8718
  8719     IF NOT LF-PLAN-MASTER-FOUND
  8720        GO TO 0304-LIFE-BENEFIT-FOUND.
  8721
  8722 XXXX-CHECK-LF-PLAN-KEY.
  8723
  8724     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8725        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8726        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8727        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8728        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8729        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8730        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8731        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8732        MOVE 'N'                 TO PLAN-MASTER-SW
  8733          GO TO 03XX-ERPLAN-LIFE-READ.
  8734
  8735     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8736
  8737     IF  PB-CANCELLATION
  8738         GO TO  0303-LF-ACCT-BEN-FOUND.
  8739
  8740     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8741        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8742           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8743           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8744              MOVE ER-2644             TO WS-ERROR
  8745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746           ELSE
  8747              NEXT SENTENCE
  8748        ELSE
  8749           IF PB-COMPANY-ID NOT = 'NCL'
  8750              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8751                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8752
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 160
* EL050.cbl
  8753 0303-LF-ACCT-BEN-FOUND.
  8754
  8755     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8756
  8757     IF PL-DEV-CODE NOT = SPACES
  8758        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8759
  8760     IF PL-DEV-PCT NUMERIC AND
  8761        PL-DEV-PCT NOT = ZEROS
  8762        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8763
  8764     IF PL-TOL-PREM-AMT GREATER THAN +0
  8765        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8766
  8767     IF PL-TOL-REF-AMT GREATER THAN +0
  8768        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8769
  8770     IF PL-TOL-PREM-PCT GREATER THAN +0
  8771        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8772
  8773     IF PL-TOL-REF-PCT GREATER THAN +0
  8774        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8775
  8776     IF PL-TOL-CLM-AMT GREATER THAN +0
  8777        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8778
  8779     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8780                          PL-OVER-SHORT-AMT > +0
  8781        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8782
  8783     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8784                          PL-OVER-SHORT-PCT > +0
  8785        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8786
  8787     IF PL-SALES-TAX NUMERIC AND
  8788                          PL-SALES-TAX > +0
  8789         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8790
  8791     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8792        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8793                                    WS-IG-OVRD-AM.
  8794
  8795 0304-LIFE-BENEFIT-FOUND.
  8796
  8797     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8798
  8799     IF PB-ISSUE
  8800        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8801     ELSE
  8802        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8803
  8804     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8805     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8806     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8807     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8808     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8809                                         WS-LF-REFUND-CALC.
  8810     if (ws-lf-earnings-calc = '5')
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 161
* EL050.cbl
  8811        and (pb-i-loan-apr = zeros)
  8812        and (benefit-code-chg)
  8813        move +99.9999 to pb-i-loan-apr
  8814     end-if
  8815
  8816     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8817        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8818
  8819     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8820        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8821     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8822
  8823     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8824     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8825     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8826     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8827     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8828     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8829
  8830     IF PB-COMPANY-ID = 'NCL'  AND
  8831        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8832         NEXT SENTENCE
  8833     ELSE
  8834         IF SUB5 NOT GREATER THAN +20
  8835            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8836               MOVE WS-SAVE-BENEFIT-REM-TERM
  8837                                      TO WS-AM-LF-BENE-REM-TERM
  8838                                         EC-BR-LF-REM-TERM-CALC.
  8839
  8840     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8841     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8842
  8843     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8844
  8845 0305-BENEFIT-NOT-FOUND.
  8846
  8847     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8848     MOVE ER-2604                TO WS-ERROR.
  8849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8850
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 162
* EL050.cbl
  8852
  8853 0310-FIND-AH-BENEFIT-RECORD.
  8854
  8855     MOVE 'N'                    TO PLAN-MASTER-SW
  8856                                    PLAN-MASTER-AH-SW.
  8857
  8858     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8859                                    WS-PL-TOL-AH-REFUND
  8860                                    WS-AH-PL-REF-OVS-AMT
  8861                                    WS-PL-TOL-AH-PREM-PCT
  8862                                    WS-PL-TOL-AH-REFUND-PCT
  8863                                    WS-AH-PL-REF-OVS-PCT
  8864                                    WS-PL-TOL-AH-CLAIM.
  8865     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8866
  8867
  8868     if pb-issue
  8869        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8870           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8871        end-if
  8872        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8873           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8874           GO TO 0399-BENEFIT-NOT-FOUND
  8875        end-if
  8876     end-if
  8877
  8878     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8879        GO TO 0400-FIND-CARRIER.
  8880
  8881     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8882
  8883     IF WK-AH-BEN-ADDR NOT = ZEROS
  8884         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8885         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8886         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8887         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8888           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8889             GO TO 0311-AH-BENEFIT-SEARCH
  8890         ELSE
  8891             NEXT SENTENCE
  8892     ELSE
  8893         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8894
  8895     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8896     MOVE '5'                    TO CNTL-REC-TYPE.
  8897     MOVE +0                     TO CNTL-SEQ-NO.
  8898     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8899
  8900     MOVE '2' TO RC-SW-2.
  8901     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8902
  8903     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8904        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8905          GO TO 0399-BENEFIT-NOT-FOUND.
  8906
  8907     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8908
  8909 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 163
* EL050.cbl
  8910
  8911     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8912
  8913     IF NO-BENEFIT-FOUND
  8914         GO TO 0399-BENEFIT-NOT-FOUND.
  8915
  8916     IF WS-BEN-CD = '99'
  8917        GO TO 0399-BENEFIT-NOT-FOUND.
  8918
  8919     IF PB-COMPANY-ID  =  'NCL'
  8920         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8921             GO TO 0314-A-H-BENEFIT-FOUND.
  8922
  8923     MOVE +1                     TO SUB5.
  8924     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8925
  8926* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8927* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8928     IF PB-COMPANY-ID = 'DMD'
  8929         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8930
  8931 0312-EDIT-ACCT-AH-BENEFITS.
  8932
  8933     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8934        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8935           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8936                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8937           GO TO 03XX-GET-AH-ERPLAN.
  8938
  8939     IF SUB5 LESS THAN +20
  8940        ADD +1                   TO SUB5
  8941        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8942
  8943     MOVE +1                     TO SUB5.
  8944
  8945     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8946        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8947
  8948 0313-EDIT-DMD-EXTRA-BENEFITS.
  8949
  8950     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8951        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8952           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8953                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8954           GO TO 03XX-GET-AH-ERPLAN.
  8955
  8956     IF SUB5 LESS THAN +30
  8957        ADD +1                   TO SUB5
  8958        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8959
  8960     MOVE +1                     TO SUB5.
  8961
  8962 03XX-EDIT-FOR-NINETY-AH.
  8963
  8964***************************************************************
  8965*                                                             *
  8966*    NINETY BENEFIT PLAN TYPES:                               *
  8967*                                                             *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 164
* EL050.cbl
  8968*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8969*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8970*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8971*           BENEFIT CONTROLS.                                 *
  8972*      99 = ALL BENEFITS.                                     *
  8973*                                                             *
  8974***************************************************************
  8975
  8976     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8977                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8978
  8979     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8980       AND
  8981        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8982        GO TO 03XX-GET-AH-ERPLAN.
  8983
  8984     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8985       AND
  8986        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8987           IF (PB-I-INDV-GRP-OVRD = 'I')
  8988              OR
  8989           ((AM-IG = '1') AND
  8990           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8991              OR
  8992           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8993           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8994           (AM-IG NOT = '2'))
  8995              GO TO 03XX-GET-AH-ERPLAN.
  8996
  8997     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8998       AND
  8999        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9000           IF (PB-I-INDV-GRP-OVRD = 'G')
  9001              OR
  9002           ((AM-IG = '2') AND
  9003           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9004              OR
  9005           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9006           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9007           (AM-IG NOT = '1'))
  9008              GO TO 03XX-GET-AH-ERPLAN.
  9009
  9010     IF SUB5 LESS THAN +20
  9011        ADD +1                   TO SUB5
  9012        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9013
  9014     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9015        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9016
  9017     MOVE +1                    TO SUB5.
  9018
  9019 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9020
  9021     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9022                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9023
  9024     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9025       AND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 165
* EL050.cbl
  9026        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9027        GO TO 03XX-GET-AH-ERPLAN.
  9028
  9029     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9030       AND
  9031        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9032           IF (PB-I-INDV-GRP-OVRD = 'I')
  9033              OR
  9034           ((AM-IG = '1') AND
  9035           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9036              OR
  9037           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9038           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9039           (AM-IG NOT = '2'))
  9040              GO TO 03XX-GET-AH-ERPLAN.
  9041
  9042     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9043       AND
  9044        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9045           IF (PB-I-INDV-GRP-OVRD = 'G')
  9046              OR
  9047           ((AM-IG = '2') AND
  9048           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9049              OR
  9050           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9051           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9052           (AM-IG NOT = '1'))
  9053              GO TO 03XX-GET-AH-ERPLAN.
  9054
  9055     IF SUB5 LESS THAN +30
  9056        ADD +1                   TO SUB5
  9057        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9058
  9059 03XX-EDIT-FOR-NINETY-AH-CONT.
  9060
  9061     MOVE +99                    TO SUB5.
  9062
  9063     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9064
  9065     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9066        IF PB-ISSUE
  9067           MOVE ER-1925          TO  WS-ERROR
  9068           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9069
  9070     GO TO 0314-A-H-BENEFIT-FOUND.
  9071
  9072 03XX-GET-AH-ERPLAN.
  9073
  9074     IF WK-PLAN-ADDR EQUAL +0
  9075         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9076
  9077     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9078     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9079     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9080     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9081     MOVE 'Y'                    TO PLAN-MASTER-SW
  9082                                    PLAN-MASTER-AH-SW.
  9083*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 166
* EL050.cbl
  9084     GO TO 03XX-ERPLAN-AH-READ.
  9085
  9086 03XX-ERPLAN-AH-GETMAIN.
  9087
  9088     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9089     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9090
  9091 03XX-ERPLAN-AH-READ.
  9092
  9093     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9094     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9095     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9096     MOVE PB-SV-STATE            TO PLAN-STATE.
  9097     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9098     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9099     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9100     MOVE WS-SAVE-BENEFIT-REVISION
  9101                                 TO PLAN-REVISION-NO.
  9102
  9103     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9104     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9105
  9106     IF PB-COMPANY-ID = 'NCL'
  9107       IF NOT AH-PLAN-MASTER-FOUND
  9108         IF NOT PB-POLICY-IS-DECLINED  AND
  9109            NOT PB-POLICY-IS-VOIDED
  9110             MOVE  ER-1922         TO  WS-ERROR
  9111             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9112             GO TO 0314-A-H-BENEFIT-FOUND.
  9113
  9114     IF NOT AH-PLAN-MASTER-FOUND
  9115        GO TO 0314-A-H-BENEFIT-FOUND.
  9116
  9117 XXXX-CHECK-AH-PLAN-KEY.
  9118
  9119     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9120        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9121        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9122        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9123        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9124        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9125        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9126        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9127        MOVE 'N'                 TO PLAN-MASTER-SW
  9128          GO TO 03XX-ERPLAN-AH-READ.
  9129
  9130     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9131
  9132     IF  PB-CANCELLATION
  9133         GO TO  0313-AH-ACCT-BEN-FOUND.
  9134
  9135     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9136       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9137          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9138          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9139             MOVE ER-2644             TO WS-ERROR
  9140             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9141          ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 167
* EL050.cbl
  9142             NEXT SENTENCE
  9143       ELSE
  9144          IF PB-COMPANY-ID NOT = 'NCL'
  9145             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9146                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9147
  9148 0313-AH-ACCT-BEN-FOUND.
  9149
  9150     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9151
  9152     IF PL-DEV-CODE NOT = SPACES
  9153        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9154
  9155     IF PL-DEV-PCT NUMERIC AND
  9156        PL-DEV-PCT NOT = ZEROS
  9157        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9158
  9159     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9160        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9161
  9162     IF PL-TOL-REF-AMT NOT EQUAL +0
  9163        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9164
  9165     IF PL-TOL-PREM-PCT GREATER THAN +0
  9166        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9167
  9168     IF PL-TOL-REF-PCT GREATER THAN +0
  9169        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9170
  9171     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9172        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9173
  9174     IF PL-OVER-SHORT-AMT NUMERIC AND
  9175                          PL-OVER-SHORT-AMT > +0
  9176        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9177
  9178     IF PL-OVER-SHORT-PCT NUMERIC AND
  9179                          PL-OVER-SHORT-PCT > +0
  9180        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9181
  9182     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9183        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9184        IF WS-IG-OVRD-AM EQUAL SPACES
  9185            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9186
  9187 0314-A-H-BENEFIT-FOUND.
  9188
  9189     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9190
  9191     IF PB-ISSUE
  9192        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9193       ELSE
  9194        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9195
  9196     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9197     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9198     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9199     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 168
* EL050.cbl
  9200                                         WS-AH-REFUND-CALC.
  9201
  9202     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9203        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9204
  9205     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9206        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9207     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9208
  9209     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9210     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9211     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9212     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9213     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9214     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9215
  9216     IF PB-COMPANY-ID = 'NCL'  AND
  9217        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9218         NEXT SENTENCE
  9219     ELSE
  9220         IF SUB5 NOT GREATER THAN +20
  9221            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9222                MOVE WS-SAVE-BENEFIT-REM-TERM
  9223                                      TO WS-AM-AH-BENE-REM-TERM
  9224                                         EC-BR-AH-REM-TERM-CALC.
  9225
  9226     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9227     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9228
  9229     GO TO 0400-FIND-CARRIER.
  9230
  9231 0399-BENEFIT-NOT-FOUND.
  9232
  9233     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9234     MOVE ER-2605                TO WS-ERROR.
  9235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9236
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 169
* EL050.cbl
  9238
  9239 0400-FIND-CARRIER.
  9240
  9241     MOVE PB-SV-CARRIER          TO WS-CARR.
  9242
  9243     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9244     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9245     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9246     MOVE '6'                    TO CNTL-REC-TYPE.
  9247
  9248*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9249     MOVE SPACE                  TO WS-DMD-RATING-SW
  9250                                    EC-BR-DMD-RATING-SW.
  9251
  9252     MOVE '2'                    TO RC-SW-1.
  9253     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9254
  9255     IF NOT CF-CARRIER-MASTER
  9256        GO TO 0400-CARRIER-NOT-FOUND.
  9257
  9258 0400-BUILD-CARR-TOL.
  9259
  9260     IF CF-CR-TOL-PREM NUMERIC AND
  9261        CF-CR-TOL-PREM GREATER THAN +0
  9262        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9263                                    WS-TOL-AH-PREM.
  9264
  9265     IF CF-CR-TOL-REFUND NUMERIC AND
  9266        CF-CR-TOL-REFUND GREATER THAN +0
  9267        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9268                                    WS-TOL-AH-REFUND.
  9269
  9270     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9271        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9272        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9273                                    WS-AH-REFUND-OVS-AMT.
  9274
  9275     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9276        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9277        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9278                                    WS-AH-REFUND-OVS-PCT.
  9279
  9280     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9281        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9282        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9283                                    WS-TOL-AH-PREM-PCT.
  9284
  9285     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9286        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9287        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9288                                     WS-TOL-AH-REFUND-PCT.
  9289
  9290     IF CF-COMPANY-ID EQUAL 'DMD'
  9291         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9292                                    EC-BR-DMD-RATING-SW.
  9293
  9294     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9295     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 170
* EL050.cbl
  9296        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9297     END-IF
  9298     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9299        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9300     END-IF
  9301     IF WS-TOL-CLP-PCT = ZEROS
  9302        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9303     END-IF
  9304
  9305     IF WS-SPP-LEASE-COMM = ZEROS
  9306        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9307     END-IF
  9308     GO TO 0400-FIND-ERPDEF.
  9309
  9310 0400-CARRIER-NOT-FOUND.
  9311
  9312     MOVE ER-2602                TO WS-ERROR.
  9313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9314
  9315 0400-FIND-ERPDEF.
  9316     IF PB-COMPANY-ID = 'DCC'
  9317        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9318        CONTINUE
  9319     ELSE
  9320        GO TO 0400-FIND-ERCOMP
  9321     END-IF
  9322     MOVE ' '                    TO PDEF-MASTER-SW
  9323     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9324     MOVE PB-STATE               TO ERPDEF-STATE
  9325     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9326     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9327     IF PB-ISSUE
  9328        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9329     ELSE
  9330        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9331     END-IF
  9332     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9333     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9334     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9335     IF PDEF-MASTER-FOUND
  9336        MOVE 'N'                 TO PDEF-MASTER-SW
  9337        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9338        IF PDEF-MASTER-FOUND
  9339           IF (ERPDEF-KEY-SAVE (1:16) =
  9340                        PD-CONTROL-PRIMARY (1:16))
  9341              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9342              CONTINUE
  9343           ELSE
  9344              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9345              IF (ERPDEF-KEY-SAVE (1:16) =
  9346                        PD-CONTROL-PRIMARY (1:16))
  9347                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9348                 CONTINUE
  9349              ELSE
  9350                 MOVE 'N'        TO PDEF-MASTER-SW
  9351              END-IF
  9352           END-IF
  9353        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 171
* EL050.cbl
  9354        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9355     END-IF
  9356     IF PDEF-MASTER-FOUND
  9357        IF PD-TRUNCATED = 'Y'
  9358           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9359        END-IF
  9360     END-IF
  9361     .
  9362 0400-FIND-ERCOMP.
  9363     IF PB-COMPANY-ID = 'DCC'
  9364        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9365           (WS-SUB1 > +10)
  9366           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9367                 OR 'A' OR 'N'
  9368              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9369              MOVE PB-CARRIER    TO COMP-CARRIER
  9370              MOVE PB-GROUPING   TO COMP-GROUPING
  9371              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9372              MOVE AM-AGT (WS-SUB1)
  9373                                 TO COMP-FIN-RESP
  9374              MOVE 'G'           TO COMP-TYPE
  9375              PERFORM 8582-READ-COMPENSATION-MASTER
  9376                                 THRU 8582-EXIT
  9377              IF COMP-MASTER-FOUND
  9378                 IF CO-GA-INACTIVE
  9379                    MOVE ER-2763 TO WS-ERROR
  9380                    PERFORM 9900-ERROR-FORMAT
  9381                                 THRU 9900-EXIT
  9382                    MOVE +11     TO WS-SUB1
  9383                 END-IF
  9384                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9385                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9386                    MOVE ER-2788 TO WS-ERROR
  9387                    PERFORM 9900-ERROR-FORMAT
  9388                                 THRU 9900-EXIT
  9389                    MOVE +11     TO WS-SUB1
  9390                 END-IF
  9391              END-IF
  9392           END-IF
  9393        END-PERFORM
  9394     END-IF
  9395     IF PB-COMPANY-ID = 'DCC'
  9396        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9397           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9398                                    WS-CLP-STATE
  9399        ELSE
  9400           MOVE SPACES           TO PB-I-CLP-STATE
  9401                                    WS-CLP-STATE
  9402        END-IF
  9403     END-IF
  9404
  9405     IF (PB-COMPANY-ID = 'DCC')
  9406        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9407        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9408        CONTINUE
  9409     ELSE
  9410        GO TO 0400-FIND-STATE-RECORD
  9411     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 172
* EL050.cbl
  9412     MOVE SPACES                 TO WS-CLP-STATE
  9413     MOVE +0                     TO WS-BANK-FEE
  9414                                    WS-BANK-LFEE
  9415                                    WS-BANK-NOCHRGB
  9416
  9417     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9418     IF (PB-ISSUE)
  9419        AND (PB-I-BANK-NUMBER NOT =
  9420            SPACES AND ZEROS AND LOW-VALUES)
  9421        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9422     ELSE
  9423        IF (PB-CANCELLATION)
  9424           AND (PB-CI-BANK-NUMBER NOT =
  9425                SPACES AND ZEROS AND LOW-VALUES)
  9426           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9427        END-IF
  9428     END-IF
  9429     IF COMP-FIN-RESP NOT = LOW-VALUES
  9430        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9431        MOVE PB-CARRIER          TO COMP-CARRIER
  9432        MOVE PB-GROUPING         TO COMP-GROUPING
  9433        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9434        MOVE 'B'                 TO COMP-TYPE
  9435        PERFORM 8582-READ-COMPENSATION-MASTER
  9436                                 THRU 8582-EXIT
  9437        IF COMP-MASTER-FOUND
  9438           IF CO-MAX-BANK-FEE NOT NUMERIC
  9439              MOVE +0            TO CO-MAX-BANK-FEE
  9440           END-IF
  9441           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9442              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9443           END-IF
  9444           IF CO-GA-INACTIVE
  9445              MOVE ER-2763       TO WS-ERROR
  9446              PERFORM 9900-ERROR-FORMAT
  9447                                 THRU 9900-EXIT
  9448           END-IF
  9449           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9450              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9451              MOVE ER-2788 TO WS-ERROR
  9452              PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454              MOVE +11     TO WS-SUB1
  9455           END-IF
  9456           IF WS-AH-BEN-CATEGORY = 'G'
  9457              MOVE CO-MAX-BANK-FEE
  9458                                 TO WS-BANK-FEE
  9459                                    PB-I-BANK-FEE
  9460           ELSE
  9461              MOVE CO-MAX-BANK-FEE-LEASE
  9462                                 TO WS-BANK-LFEE
  9463                                    PB-I-BANK-FEE
  9464           END-IF
  9465           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9466              AND (WS-AH-REFUND-CALC = 'G'))
  9467                        OR
  9468              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9469              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 173
* EL050.cbl
  9470              CONTINUE
  9471           ELSE
  9472              MOVE ER-2789 TO WS-ERROR
  9473              PERFORM 9900-ERROR-FORMAT
  9474                                 THRU 9900-EXIT
  9475           END-IF
  9476           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9477                                    PB-I-CLP-STATE
  9478           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9479           MOVE CO-CARRIER       TO BXRF-CARRIER
  9480           MOVE CO-GROUPING      TO BXRF-GROUPING
  9481           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9482           MOVE BXRF-MAX-REC-LENGTH
  9483                                 TO BXRF-REC-LENGTH
  9484           PERFORM 8584-READ-BANK-CROSS-REF
  9485                                 THRU 8584-EXIT
  9486           IF BXRF-MASTER-FOUND
  9487              MOVE ' '           TO BANK-ACCT-SW
  9488              MOVE BK-BANK-POINTER-CNT
  9489                                 TO BK-BANK-POINTER-CNT
  9490              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9491                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9492                 OR (BANK-ACCT-FOUND)
  9493                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9494                    AND (BK-AM-EXP-DT (WS-SUB1)
  9495                                 > PB-CERT-EFF-DT)
  9496                    AND (BK-AM-EFF-DT (WS-SUB1)
  9497                                 NOT > PB-CERT-EFF-DT)
  9498                    SET BANK-ACCT-FOUND TO TRUE
  9499                 END-IF
  9500              END-PERFORM
  9501              IF NOT BANK-ACCT-FOUND
  9502                 MOVE ZEROS      TO WS-BANK-FEE
  9503                                    WS-BANK-LFEE
  9504                 MOVE ER-2869    TO WS-ERROR
  9505                 PERFORM 9900-ERROR-FORMAT
  9506                                 THRU 9900-EXIT
  9507              ELSE
  9508                 PERFORM 5000-PROCESS-REPS
  9509                                 THRU 5000-EXIT
  9510                 IF AGENT-MASTER-FOUND
  9511                    MOVE +0      TO WS-BANK-FEE
  9512                                    WS-BANK-LFEE
  9513*                   MOVE AG-SPP-FEES (1)
  9514*                                TO PB-I-BANK-FEE
  9515*                                   WS-BANK-FEE
  9516                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9517                       (WS-SUB1 > +10)
  9518                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9519                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9520                       END-IF
  9521                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9522                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9523                       END-IF
  9524                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9525                          AG-SPP-FEES (WS-SUB1)
  9526                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9527                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 174
* EL050.cbl
  9528                    END-PERFORM
  9529                    IF WS-AH-BEN-CATEGORY = 'G'
  9530                       MOVE WS-BANK-FEE
  9531                                 TO PB-I-BANK-FEE
  9532                    ELSE
  9533                       MOVE WS-BANK-LFEE
  9534                                 TO PB-I-BANK-FEE
  9535                    END-IF
  9536                 END-IF
  9537              END-IF
  9538           END-IF
  9539        ELSE
  9540           MOVE ER-2879          TO WS-ERROR
  9541           PERFORM 9900-ERROR-FORMAT
  9542                                 THRU 9900-EXIT
  9543        END-IF
  9544     ELSE
  9545        MOVE ER-2879             TO WS-ERROR
  9546        PERFORM 9900-ERROR-FORMAT
  9547                                 THRU 9900-EXIT
  9548     END-IF
  9549     IF WS-AH-BEN-CATEGORY = 'G'
  9550        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9551        + WS-BANK-FEE
  9552     ELSE
  9553        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9554        + WS-BANK-LFEE
  9555     END-IF
  9556     .
  9557 0400-FIND-STATE-RECORD.
  9558
  9559     IF WK-STATE-ADDR NOT = ZEROS
  9560         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9561         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9562         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9563         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9564         IF PB-SV-STATE = CF-STATE-CODE
  9565             GO TO 0405-CONTINUE-EDIT
  9566         ELSE
  9567             NEXT SENTENCE
  9568     ELSE
  9569         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9570
  9571     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9572     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9573     MOVE '3'                    TO CNTL-REC-TYPE.
  9574     MOVE +0                     TO CNTL-SEQ-NO.
  9575
  9576     MOVE '3'                    TO RC-SW-2.
  9577     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9578
  9579     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9580        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9581        PB-SV-STATE   NOT = CF-STATE-CODE)
  9582        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9583                                    WS-TOL-AH-CLAIM
  9584                                    WS-MINIMUM-REFUND
  9585                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 175
* EL050.cbl
  9586                                    WS-TOL-AH-PREM
  9587                                    WS-TOL-LF-REFUND
  9588                                    WS-TOL-AH-REFUND
  9589                                    EC-ST-TOL-PREM-PCT
  9590                                    WS-TOL-LF-PREM-PCT
  9591                                    WS-TOL-AH-PREM-PCT
  9592                                    EC-ST-TOL-REFUND-PCT
  9593                                    WS-TOL-LF-REFUND-PCT
  9594                                    WS-TOL-AH-REFUND-PCT
  9595                                    EC-ST-TOL-PREM
  9596                                    EC-ST-TOL-REFUND
  9597                                    EC-ST-FST-PMT-DAYS-MAX
  9598                                    WS-FREE-LOOK-PERIOD
  9599                                    WS-ST-LF-PREM-TAX
  9600                                    WS-ST-AH-PREM-TAX-I
  9601                                    WS-ST-AH-PREM-TAX-G
  9602                                    WS-BANK-FEE
  9603                                    WS-BANK-LFEE
  9604                                    WS-TOL-CLP-PCT
  9605                                    WS-SPP-LEASE-COMM
  9606        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9607                                    EC-ST-FST-PMT-DAYS-CHG
  9608                                    WS-LF-REM-TERM-CALC
  9609                                    WS-LF-REFUND-CALC
  9610                                    EC-ST-LF-REM-TERM-CALC
  9611                                    EC-ST-LF-REFUND-CALC
  9612                                    WS-AH-REM-TERM-CALC
  9613                                    WS-AH-REFUND-CALC
  9614                                    WS-LF-BEN-CATEGORY
  9615                                    WS-AH-BEN-CATEGORY
  9616                                    WS-CLP-STATE
  9617                                    WS-ST-REFUND-CLAIM-FLAG
  9618                                    EC-ST-AH-REM-TERM-CALC
  9619                                    EC-ST-AH-REFUND-CALC
  9620          GO TO 0499-STATE-NOT-FOUND.
  9621
  9622     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9623
  9624 0405-CONTINUE-EDIT.
  9625
  9626     if pb-company-id = 'AHL'
  9627        continue
  9628     else
  9629        IF PB-CERT-PRIME NOT NUMERIC
  9630           MOVE ER-2722          TO WS-ERROR
  9631           PERFORM 9900-ERROR-FORMAT
  9632                                 THRU 9900-EXIT
  9633        end-if
  9634     END-IF
  9635*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9636*       MOVE +0                  TO SUB3
  9637*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9638*       IF SUB3 > +0
  9639*          MOVE ER-2722          TO WS-ERROR
  9640*          PERFORM 9900-ERROR-FORMAT
  9641*                                THRU 9900-EXIT
  9642*       END-IF
  9643*    END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 176
* EL050.cbl
  9644*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9645*       IF PB-CERT-PRIME NOT NUMERIC
  9646*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9647*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9648*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9649*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9650*
  9651*          MOVE ER-2722          TO WS-ERROR
  9652*          PERFORM 9900-ERROR-FORMAT
  9653*                                THRU 9900-EXIT
  9654*       END-IF
  9655*    END-IF
  9656
  9657     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9658
  9659     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9660        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9661                                    WS-TOL-AH-CLAIM.
  9662
  9663     IF CF-ST-REFUND-MIN NOT NUMERIC
  9664        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9665
  9666     IF CF-ST-REFUND-MIN NOT = ZEROS
  9667        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9668
  9669     IF CF-ST-TOL-PREM  NOT = ZEROS
  9670        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9671                                    WS-TOL-AH-PREM
  9672        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9673
  9674     IF CF-ST-TOL-REFUND NOT = ZEROS
  9675        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9676                                    WS-TOL-AH-REFUND
  9677        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9678
  9679     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9680        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9681        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9682                                    WS-AH-REFUND-OVS-AMT
  9683                                    EC-ST-OVR-SHT-AMT.
  9684
  9685     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9686        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9687        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9688                                    WS-TOL-LF-PREM-PCT
  9689                                    WS-TOL-AH-PREM-PCT.
  9690
  9691     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9692        CF-ST-TOL-REF-PCT GREATER THAN +0
  9693        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9694                                    WS-TOL-LF-REFUND-PCT
  9695                                    WS-TOL-AH-REFUND-PCT.
  9696
  9697     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9698        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9699        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9700                                    WS-AH-REFUND-OVS-PCT
  9701                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 177
* EL050.cbl
  9702
  9703     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9704     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9705
  9706     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9707          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9708
  9709     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9710     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9711     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9712
  9713     IF CF-ST-LF-PREM-TAX NUMERIC
  9714        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9715     END-IF
  9716     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9717        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9718     END-IF
  9719     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9720        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9721     END-IF
  9722
  9723     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9724         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9725     END-IF.
  9726
  9727     IF WS-LF-BENEFIT-CD = ZEROS
  9728        GO TO 0410-CHECK-AH.
  9729
  9730     IF CF-ST-RT-CALC NOT = SPACES
  9731        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9732                                    EC-ST-LF-REM-TERM-CALC
  9733     END-IF
  9734
  9735     IF WS-LF-COVERAGE-TYPE = 'R'
  9736        IF WS-LF-EARNINGS-CALC = '5'
  9737           IF CF-ST-RF-LN-CALC > '0'
  9738              MOVE CF-ST-RF-LN-CALC
  9739                                 TO WS-LF-REFUND-CALC
  9740                                    EC-ST-LF-REFUND-CALC
  9741           END-IF
  9742        ELSE
  9743           IF CF-ST-RF-LR-CALC > '0'
  9744              MOVE CF-ST-RF-LR-CALC
  9745                                 TO WS-LF-REFUND-CALC
  9746                                    EC-ST-LF-REFUND-CALC
  9747           END-IF
  9748        END-IF
  9749     ELSE
  9750        IF CF-ST-RF-LL-CALC > '0'
  9751           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9752                                    EC-ST-LF-REFUND-CALC
  9753        END-IF
  9754     END-IF
  9755
  9756     IF CF-ST-RT-CALC NOT = SPACES
  9757        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9758                                    EC-ST-LF-REM-TERM-CALC
  9759     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 178
* EL050.cbl
  9760
  9761     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9762     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9763
  9764     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9765
  9766     IF NO-BENEFIT-FOUND
  9767        GO TO 0410-CHECK-AH.
  9768
  9769     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9770        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9771                                 TO EC-ST-LF-REM-TERM-CALC
  9772                                    WS-LF-REM-TERM-CALC
  9773     END-IF
  9774
  9775     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9776        MOVE CF-ST-REFUND-CALC (SUB3)
  9777                                 TO WS-LF-REFUND-CALC
  9778                                    EC-ST-LF-REFUND-CALC
  9779     END-IF
  9780*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9781
  9782     .
  9783 0410-CHECK-AH.
  9784
  9785     IF WS-AH-BENEFIT-CD = ZEROS
  9786        GO TO 0500-SET-ACCOUNT.
  9787
  9788     IF CF-ST-RT-CALC NOT = SPACES
  9789        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9790                                    EC-ST-AH-REM-TERM-CALC
  9791     END-IF
  9792
  9793     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9794        IF CF-ST-RF-CP-CALC > '0'
  9795           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9796                                    EC-ST-AH-REFUND-CALC
  9797        END-IF
  9798     ELSE
  9799        IF CF-ST-RF-AH-CALC > '0'
  9800           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9801                                    EC-ST-AH-REFUND-CALC
  9802        END-IF
  9803     END-IF
  9804     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9805     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9806
  9807     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9808
  9809     IF NO-BENEFIT-FOUND
  9810        GO TO 0500-SET-ACCOUNT.
  9811
  9812     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9813        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9814                                 TO WS-AH-REM-TERM-CALC
  9815                                    EC-ST-AH-REM-TERM-CALC
  9816     END-IF
  9817
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 179
* EL050.cbl
  9818     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9819        MOVE CF-ST-REFUND-CALC (SUB3)
  9820                                 TO WS-AH-REFUND-CALC
  9821                                    EC-ST-AH-REFUND-CALC
  9822     END-IF
  9823
  9824*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9825
  9826     GO TO 0500-SET-ACCOUNT.
  9827
  9828 0499-STATE-NOT-FOUND.
  9829
  9830     MOVE ER-2603                TO WS-ERROR.
  9831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9832
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 180
* EL050.cbl
  9834
  9835 0500-SET-ACCOUNT.
  9836*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9837     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9838        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9839        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9840        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9841        MOVE '3'                 TO CNTL-REC-TYPE
  9842        MOVE +0                  TO CNTL-SEQ-NO
  9843
  9844        MOVE '3'                 TO RC-SW-2
  9845        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9846
  9847        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9848           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9849           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9850           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9851                                    WS-ST-AH-PREM-TAX-I
  9852                                    WS-ST-AH-PREM-TAX-G
  9853        ELSE
  9854           IF CF-ST-LF-PREM-TAX NUMERIC
  9855              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9856           END-IF
  9857           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9858              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9859           END-IF
  9860           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9861              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9862           END-IF
  9863        END-IF
  9864        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9865     END-IF
  9866*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9867*  FOR DCC ONLY
  9868     IF PB-COMPANY-ID = 'DCC'
  9869
  9870     MOVE ' '                    TO STAT-MASTER-SW
  9871     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9872     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9873     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9874     MOVE PB-STATE               TO ELSTAT-STATE
  9875     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9876        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9877     END-IF
  9878
  9879     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9880     SET BIN-TO-GREG             TO TRUE
  9881     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9882     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9883     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9884
  9885     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9886     IF STAT-MASTER-FOUND
  9887        MOVE 'N'                 TO STAT-MASTER-SW
  9888        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9889        IF STAT-MASTER-FOUND
  9890           IF (ELSTAT-KEY-SAVE (1:12) =
  9891                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 181
* EL050.cbl
  9892              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9893                 MOVE 'F'        TO STAT-MASTER-SW
  9894              ELSE
  9895                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9896                 IF (STAT-MASTER-FOUND)
  9897                    AND (ELSTAT-KEY-SAVE (1:12) =
  9898                        SF-CONTROL-PRIMARY (1:12))
  9899                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9900                    MOVE 'F'     TO STAT-MASTER-SW
  9901                 END-IF
  9902              END-IF
  9903           END-IF
  9904        END-IF
  9905     END-IF
  9906
  9907     IF STAT-MASTER-SW = 'F'
  9908        IF SF-ST-LF-PREM-TAX NUMERIC
  9909           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9910        END-IF
  9911        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9912           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9913        END-IF
  9914        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9915           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9916        END-IF
  9917     END-IF
  9918
  9919     END-IF
  9920     IF (PB-COMPANY-ID = 'DCC')
  9921        AND (PB-ISSUE)
  9922        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9923        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9924        AND (AM-GPCD = 06)
  9925        MOVE 'Y'                 TO WS-GOOD-HIN
  9926        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9927           MOVE PB-I-VIN         TO WS-WORK-VIN
  9928           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9929              (V1 > 16)
  9930              IF WS-WORK-VIN (V1:1) NUMERIC
  9931                 MOVE WS-WORK-VIN-N (V1)
  9932                                 TO WS-ROW-B-VAL (V1)
  9933              ELSE
  9934                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9935                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9936                    OR (V2 > 26)
  9937                 END-PERFORM
  9938                 IF V2 < 27
  9939                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9940                 ELSE
  9941                    MOVE 'N'     TO WS-GOOD-HIN
  9942                 END-IF
  9943              END-IF
  9944              COMPUTE WS-ROW-D-VAL (V1) =
  9945                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9946              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9947                 WS-ROW-D-VAL (V1)
  9948           END-PERFORM
  9949           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 182
* EL050.cbl
  9950           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9951             REMAINDER WS-VIN-REMAINDER
  9952           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9953              CONTINUE
  9954           ELSE
  9955              MOVE 'N'           TO WS-GOOD-HIN
  9956           END-IF
  9957        ELSE
  9958           MOVE 'N'              TO WS-GOOD-HIN
  9959        END-IF
  9960        IF WS-GOOD-HIN NOT = 'Y'
  9961           MOVE ER-3826           TO WS-ERROR
  9962           PERFORM 9900-ERROR-FORMAT
  9963                                 THRU 9900-EXIT
  9964        END-IF
  9965     END-IF
  9966     IF (PB-COMPANY-ID = 'DCC')
  9967        AND (PB-ISSUE)
  9968        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9969        AND (AM-GPCD NOT = 06)
  9970        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9971          MOVE PB-I-VIN          TO WS-WORK-VIN
  9972          MOVE +8                TO V2
  9973          MOVE ZEROS             TO WS-VIN-TOTAL
  9974          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9975           (V1 > 17)
  9976             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9977                MOVE ER-3825     TO WS-ERROR
  9978                PERFORM 9900-ERROR-FORMAT
  9979                                 THRU 9900-EXIT
  9980             ELSE
  9981                IF V1 = 8
  9982                   MOVE 10       TO V2
  9983                END-IF
  9984                IF V1 = 9
  9985                   MOVE 0        TO V2
  9986                END-IF
  9987                IF V1 = 10
  9988                   MOVE 9        TO V2
  9989                END-IF
  9990                IF WS-WORK-VIN (V1:1) NUMERIC
  9991                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9992                    + (WS-WORK-VIN-N (V1) * V2)
  9993                ELSE
  9994                   MOVE WS-WORK-VIN (V1:1)
  9995                                 TO WS-HEX-BYTE
  9996                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9997                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9998                    + (WS-NUM (V3) * V2)
  9999                END-IF
 10000                COMPUTE V2 = V2 - 1
 10001             END-IF
 10002          END-PERFORM
 10003          MOVE ZEROS TO WS-VIN-REMAINDER
 10004          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10005             REMAINDER WS-VIN-REMAINDER
 10006          IF ((WS-WORK-VIN (9:1) = 'X')
 10007             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 183
* EL050.cbl
 10008                     OR
 10009             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10010             CONTINUE
 10011          ELSE
 10012             MOVE ER-3826        TO WS-ERROR
 10013             PERFORM 9900-ERROR-FORMAT
 10014                                 THRU 9900-EXIT
 10015          END-IF
 10016        ELSE
 10017          MOVE ER-3826           TO WS-ERROR
 10018          PERFORM 9900-ERROR-FORMAT
 10019                                 THRU 9900-EXIT
 10020        END-IF
 10021     END-IF
 10022******************************************************************
 10023******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10024******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10025******* METHODS.
 10026******************************************************************
 10027     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10028        IF PB-CANCELLATION
 10029           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10030              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10031                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10032                IF FORM-MASTER-FOUND
 10033                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10034******************************************************************
 10035
 10036     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10037     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10038
 10039     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10040     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10041     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10042     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10043
 10044
 10045     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10046     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10047     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10048
 10049     IF AM-LF-OB-RATE NOT NUMERIC
 10050         MOVE ZERO               TO AM-LF-OB-RATE.
 10051
 10052     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10053         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10054
 10055     IF AM-AH-OB-RATE NOT NUMERIC
 10056         MOVE ZERO               TO AM-AH-OB-RATE.
 10057
 10058     IF WS-LF-JOINT-INDICATOR = 'J'
 10059         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10060     ELSE
 10061         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10062
 10063     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10064
 10065     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 184
* EL050.cbl
 10066         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10067
 10068     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10069         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10070                                       WS-IG-OVRD
 10071     ELSE
 10072         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10073             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10074                                       WS-IG-OVRD
 10075         ELSE
 10076             MOVE AM-IG             TO WS-IG-OVRD-AH
 10077                                       WS-IG-OVRD.
 10078
 10079     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10080         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10081                                       WS-IG-OVRD
 10082     ELSE
 10083         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10084             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10085                                       WS-IG-OVRD
 10086         ELSE
 10087             MOVE AM-IG             TO WS-IG-OVRD-LF
 10088                                       WS-IG-OVRD.
 10089
 10090     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10091     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10092     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10093     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10094     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10095
 10096     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10097     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10098     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10099     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10100
 10101     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10102     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10103     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10104     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10105     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10106     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10107     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10108
 10109     IF WS-ACCT-AH-DEV-PCT > +0
 10110        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10111     ELSE
 10112        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10113
 10114     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10115        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10116     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10117        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10118
 10119        IF AM-EARN-METHOD-L = 'S'
 10120            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10121                                        WS-LF-REFUND-CALC.
 10122
 10123        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 185
* EL050.cbl
 10124            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10125                                        WS-LF-REFUND-CALC.
 10126
 10127     IF WS-LF-COVERAGE-TYPE = 'R'
 10128         IF AM-EARN-METHOD-R = 'R'
 10129            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10130                                    WS-LF-REFUND-CALC.
 10131     IF WS-LF-COVERAGE-TYPE = 'R'
 10132         IF AM-EARN-METHOD-R = 'P'
 10133            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10134                                    WS-LF-REFUND-CALC.
 10135     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10136         IF AM-EARN-METHOD-L = 'R'
 10137            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10138                                    WS-LF-REFUND-CALC.
 10139     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10140         IF AM-EARN-METHOD-L = 'P'
 10141            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10142                                    WS-LF-REFUND-CALC.
 10143     IF WS-LF-COVERAGE-TYPE = 'R'
 10144         IF AM-EARN-METHOD-R = 'A'
 10145            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10146                                    WS-LF-REFUND-CALC.
 10147     IF WS-LF-COVERAGE-TYPE = 'R'
 10148         IF AM-EARN-METHOD-R = 'M'
 10149            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10150                                    WS-LF-REFUND-CALC.
 10151     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10152         IF AM-EARN-METHOD-L = 'A'
 10153            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10154                                    WS-LF-REFUND-CALC.
 10155     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10156         IF AM-EARN-METHOD-L = 'M'
 10157            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10158                                    WS-LF-REFUND-CALC.
 10159
 10160     IF AM-EARN-METHOD-A = 'R'
 10161        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10162                                    WS-AH-REFUND-CALC.
 10163     IF AM-EARN-METHOD-A = 'P'
 10164        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10165                                    WS-AH-REFUND-CALC.
 10166     IF AM-EARN-METHOD-A = 'C'
 10167        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10168                                    WS-AH-REFUND-CALC.
 10169     IF AM-EARN-METHOD-A = 'A'
 10170        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10171                                    WS-AH-REFUND-CALC.
 10172     IF AM-EARN-METHOD-A = 'M'
 10173        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10174                                    WS-AH-REFUND-CALC.
 10175     IF AM-EARN-METHOD-A = 'N'
 10176        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10177                                    WS-AH-REFUND-CALC.
 10178     IF AM-EARN-METHOD-A = 'S'
 10179        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10180                                    WS-AH-REFUND-CALC.
 10181
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 186
* EL050.cbl
 10182     IF AM-TOL-PREM NOT = ZEROS
 10183        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10184                                    WS-TOL-AH-PREM.
 10185
 10186     IF AM-OVR-SHT-AMT NUMERIC AND
 10187                  AM-OVR-SHT-AMT > 0
 10188        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10189                                    EC-AM-LF-OVR-SHT-AMT
 10190                                    WS-AH-REFUND-OVS-AMT
 10191                                    EC-AM-AH-OVR-SHT-AMT.
 10192
 10193     IF AM-OVR-SHT-PCT NUMERIC AND
 10194                    AM-OVR-SHT-PCT > 0
 10195        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10196                                    EC-AM-LF-OVR-SHT-PCT
 10197                                    WS-AH-REFUND-OVS-PCT
 10198                                    EC-AM-AH-OVR-SHT-PCT.
 10199
 10200     IF AM-TOL-REF-PCT NUMERIC AND
 10201                  AM-TOL-REF-PCT > 0
 10202        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10203                                    WS-TOL-AH-REFUND-PCT.
 10204
 10205     IF AM-TOL-REF  NOT = ZEROS  AND
 10206                  AM-TOL-REF NUMERIC
 10207        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10208                                    EC-AM-LF-TOL-REFUND
 10209                                    WS-TOL-AH-REFUND
 10210                                    EC-AM-AH-TOL-REFUND.
 10211
 10212     IF AM-TOL-CLM  NOT = ZEROS
 10213        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10214                                    WS-TOL-AH-CLAIM.
 10215
 10216     IF AM-CLP-TOL-PCT NOT NUMERIC
 10217        MOVE +0                  TO AM-CLP-TOL-PCT
 10218     END-IF
 10219
 10220     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10221        MOVE +0                  TO AM-SPP-LEASE-COMM
 10222     END-IF
 10223     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10224        MOVE WS-PL-TOL-LF-PREM-PCT
 10225                                 TO WS-TOL-LF-PREM-PCT.
 10226
 10227     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10228        MOVE WS-PL-TOL-AH-PREM-PCT
 10229                                 TO WS-TOL-AH-PREM-PCT.
 10230
 10231     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10232        MOVE WS-PL-TOL-LF-REFUND-PCT
 10233                                 TO WS-TOL-LF-REFUND-PCT.
 10234
 10235     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10236        MOVE WS-PL-TOL-AH-REFUND-PCT
 10237                                 TO WS-TOL-AH-REFUND-PCT.
 10238
 10239     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 187
* EL050.cbl
 10240        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10241
 10242     IF WS-PL-REF-OVS-PCT > +0
 10243        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10244
 10245     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10246        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10247     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10248        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10249     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10250        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10251     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10252        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10253     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10254        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10255     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10256        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10257
 10258     IF WS-AH-PL-REF-OVS-AMT > +0
 10259        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10260
 10261     IF WS-AH-PL-REF-OVS-PCT > +0
 10262        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10263
 10264     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10265     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10266
 10267     IF PB-CANCELLATION
 10268        GO TO 3000-CONTINUE-EDIT.
 10269
 10270     MOVE +1 TO SUB1.
 10271     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10272     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10273
 10274     IF CF-COMPANY-ID = 'DMD'
 10275       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10276         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10277        ELSE
 10278         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10279
 10280  0525-FIND-ACCT-COMM.
 10281     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10282        NEXT SENTENCE
 10283      ELSE
 10284         ADD +1 TO SUB1
 10285         IF SUB1 LESS +11
 10286            GO TO 0525-FIND-ACCT-COMM
 10287          ELSE
 10288             GO TO 0560-EDIT-CONTINUE.
 10289
 10290     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10291     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10292                                    PB-I-LIFE-COMMISSION.
 10293***  IF PB-COMPANY-ID = 'CRI'
 10294     IF PB-PREM-ACCTNG-ONLY
 10295         GO TO 0560-EDIT-CONTINUE.
 10296
 10297     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 188
* EL050.cbl
 10298     MOVE ' '    TO WS-CTBL-READ-SW.
 10299
 10300
 10301 0530-GET-AH-COMP.
 10302     IF NO-AH-COVERAGE  OR
 10303        NO-AH-BENEFIT-MATCH
 10304           GO TO 0540-NEXT-READ-STEP.
 10305
 10306     IF AM-A-COM (SUB1) NUMERIC
 10307        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10308         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10309         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10310         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10311         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10312     ELSE
 10313          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10314          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10315          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10316          MOVE ZEROS             TO WS-SUB1
 10317                                    WS-COMMISSION
 10318          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10319          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10320          IF WS-COMMISSION > ZEROS
 10321             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10322             GO TO 0540-NEXT-READ-STEP
 10323          END-IF
 10324          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10325          IF CTBL-TABLE-FOUND
 10326             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10327                                        PB-I-AH-TERM
 10328             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10329             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10330             GO TO 0540-NEXT-READ-STEP
 10331          ELSE
 10332             IF FIRST-TIME-THROUGH
 10333                 GO TO 0530-GET-AH-COMP
 10334             ELSE
 10335                 MOVE ER-2609                TO WS-ERROR
 10336                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10337
 10338 0540-NEXT-READ-STEP.
 10339     MOVE '0540' TO CTBL-SW.
 10340     MOVE ' '    TO WS-CTBL-READ-SW.
 10341
 10342 0540-GET-LF-COMP.
 10343     IF NO-LIFE-COVERAGE  OR
 10344        NO-LF-BENEFIT-MATCH
 10345           GO TO 0560-EDIT-CONTINUE.
 10346
 10347     IF WS-LF-JOINT-INDICATOR = 'J'
 10348        IF AM-J-COM (SUB1) NUMERIC
 10349           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10350           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10351           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10352           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10353           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10354        ELSE
 10355           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 189
* EL050.cbl
 10356           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10357           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10358           MOVE ZEROS                TO WS-SUB1
 10359                                        WS-COMMISSION
 10360           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10361           IF WS-COMMISSION > ZEROS
 10362              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10363              GO TO 0560-EDIT-CONTINUE
 10364           END-IF
 10365           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10366           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10367           IF CTBL-TABLE-FOUND
 10368              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10369              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10370              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10371              GO TO 0560-EDIT-CONTINUE
 10372           ELSE
 10373              IF FIRST-TIME-THROUGH
 10374                  GO TO 0540-GET-LF-COMP
 10375              ELSE
 10376                  MOVE ER-2609                TO WS-ERROR
 10377                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10378                  GO TO 0560-EDIT-CONTINUE.
 10379
 10380     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10381        IF AM-L-COM (SUB1) NUMERIC
 10382           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10383           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10384           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10385           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10386           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10387        ELSE
 10388           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10389           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10390           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10391           MOVE ZEROS                TO WS-SUB1
 10392                                        WS-COMMISSION
 10393           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10394           IF WS-COMMISSION IS GREATER THAN ZEROS
 10395              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10396              GO TO 0560-EDIT-CONTINUE
 10397           END-IF
 10398           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10399           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10400           IF CTBL-TABLE-FOUND
 10401              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10402              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10403              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10404              GO TO 0560-EDIT-CONTINUE
 10405           ELSE
 10406              IF FIRST-TIME-THROUGH
 10407                  GO TO 0540-GET-LF-COMP
 10408              ELSE
 10409                  MOVE ER-2609                TO WS-ERROR
 10410                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10411
 10412*    GO TO 0560-EDIT-CONTINUE.
 10413
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 190
* EL050.cbl
 10414 0560-EDIT-CONTINUE.
 10415     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10416                                    WS-AH-PMF-COMM
 10417*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10418*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10419     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10420        (SUB1 > +10)
 10421        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10422           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10423           MOVE '0530'           TO CTBL-SW
 10424           MOVE ' '              TO WS-CTBL-READ-SW
 10425           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10426           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10427           MOVE '0540'           TO CTBL-SW
 10428           MOVE ' '              TO WS-CTBL-READ-SW
 10429           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10430        END-IF
 10431     END-PERFORM
 10432     GO TO 0564-EDIT-CONTINUE
 10433     .
 10434 0561-CHECK-AH.
 10435     IF (NO-AH-COVERAGE)
 10436        OR (NO-AH-BENEFIT-MATCH)
 10437        CONTINUE
 10438     ELSE
 10439        IF (AM-A-COM (SUB1) NUMERIC)
 10440           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10441           IF (AM-COM-TYP (SUB1) = 'A')
 10442              AND (WS-AH-PMF-COMM = ZEROS)
 10443              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10444           END-IF
 10445           CONTINUE
 10446        ELSE
 10447           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10448           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10449           MOVE PB-AH-OVERRIDE-L1
 10450                                 TO CTBL-BEN-TYPE
 10451           MOVE ZEROS            TO WS-SUB1
 10452                                    WS-COMMISSION
 10453           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10454           PERFORM 8300-READ-CTBL-TABLE
 10455                                 THRU 8300-EXIT
 10456           IF CTBL-TABLE-FOUND
 10457              IF (AM-COM-TYP (SUB1) = 'A')
 10458                 AND (WS-AH-PMF-COMM = ZEROS)
 10459                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10460                                        PB-I-AH-TERM
 10461                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10462                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10463              END-IF
 10464              CONTINUE
 10465           ELSE
 10466              IF FIRST-TIME-THROUGH
 10467                 GO TO 0561-CHECK-AH
 10468              ELSE
 10469                 MOVE ER-2609    TO WS-ERROR
 10470                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10471              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 191
* EL050.cbl
 10472           END-IF
 10473        END-IF
 10474     END-IF
 10475     .
 10476 0561-EXIT.
 10477     EXIT.
 10478 0563-CHECK-LF.
 10479     IF (NO-LIFE-COVERAGE)
 10480        OR (NO-LF-BENEFIT-MATCH)
 10481        CONTINUE
 10482     ELSE
 10483        IF WS-LF-JOINT-INDICATOR = 'J'
 10484           IF AM-J-COM (SUB1) NUMERIC
 10485              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10486              IF (AM-COM-TYP (SUB1) = 'A')
 10487                 AND (WS-LF-PMF-COMM = ZEROS)
 10488                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10489              END-IF
 10490              CONTINUE
 10491           ELSE
 10492              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10493              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10494              MOVE PB-LIFE-OVERRIDE-L1
 10495                                 TO CTBL-BEN-TYPE
 10496              MOVE ZEROS         TO WS-SUB1
 10497                                    WS-COMMISSION
 10498              MOVE AM-J-COMA (SUB1)
 10499                                 TO CTBL-TABLE
 10500              PERFORM 8300-READ-CTBL-TABLE
 10501                                 THRU 8300-EXIT
 10502              IF CTBL-TABLE-FOUND
 10503                 IF (AM-COM-TYP (SUB1) = 'A')
 10504                    AND (WS-LF-PMF-COMM = ZEROS)
 10505                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10506                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10507                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10508                 END-IF
 10509                 CONTINUE
 10510              ELSE
 10511                 IF FIRST-TIME-THROUGH
 10512                    GO TO 0563-CHECK-LF
 10513                 ELSE
 10514                    MOVE ER-2609 TO WS-ERROR
 10515                    PERFORM 9900-ERROR-FORMAT
 10516                                 THRU 9900-EXIT
 10517*                   GO TO 0560-EDIT-CONTINUE
 10518                 END-IF
 10519              END-IF
 10520           END-IF
 10521        ELSE
 10522           IF AM-L-COM (SUB1) NUMERIC
 10523              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10524              IF (AM-COM-TYP (SUB1) = 'A')
 10525                 AND (WS-LF-PMF-COMM = ZEROS)
 10526                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10527              END-IF
 10528              CONTINUE
 10529           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 192
* EL050.cbl
 10530              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10531              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10532              MOVE PB-LIFE-OVERRIDE-L1
 10533                                 TO CTBL-BEN-TYPE
 10534              MOVE ZEROS         TO WS-SUB1
 10535                                    WS-COMMISSION
 10536              MOVE AM-L-COMA (SUB1)
 10537                                 TO CTBL-TABLE
 10538              PERFORM 8300-READ-CTBL-TABLE
 10539                                 THRU 8300-EXIT
 10540              IF CTBL-TABLE-FOUND
 10541                 CONTINUE
 10542              ELSE
 10543                 IF FIRST-TIME-THROUGH
 10544                    GO TO 0563-CHECK-LF
 10545                 ELSE
 10546                    MOVE ER-2609 TO WS-ERROR
 10547                    PERFORM 9900-ERROR-FORMAT
 10548                                 THRU 9900-EXIT
 10549                 END-IF
 10550              END-IF
 10551           END-IF
 10552        END-IF
 10553     END-IF
 10554     .
 10555 0563-EXIT.
 10556     EXIT.
 10557 0564-EDIT-CONTINUE.
 10558
 10559     IF  PB-COMPANY-ID EQUAL 'DMD'
 10560         IF PB-I-NUM-BILLED EQUAL ZEROS
 10561            MOVE ER-8148       TO WS-ERROR
 10562            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10563
 10564*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10565*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10566*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10567*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10568*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10569*         IF NO-CONVERSION-ERROR
 10570*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10571*         ELSE
 10572*             IF PB-COMPANY-ID EQUAL 'HAN'
 10573*                 MOVE ZEROS     TO PB-I-AGE.
 10574     IF PB-I-BIRTHDAY > LOW-VALUES
 10575        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10576        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10577        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10578        PERFORM 8500-DATE-CONVERT
 10579                                 THRU 8500-EXIT
 10580        IF NO-CONVERSION-ERROR
 10581           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10582           IF PB-I-AGE > ZEROS
 10583              IF WS-WORK-AGE NOT = PB-I-AGE
 10584                 MOVE ER-9501    TO WS-ERROR
 10585                 PERFORM 9900-ERROR-FORMAT
 10586                                 THRU 9900-EXIT
 10587              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 193
* EL050.cbl
 10588           ELSE
 10589              MOVE WS-WORK-AGE   TO PB-I-AGE
 10590           END-IF
 10591        END-IF
 10592     END-IF
 10593     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10594                                   WS-INS-AGE-SET
 10595     IF PB-I-AGE = ZEROS
 10596        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10597           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10598                                   WS-INS-AGE-SET
 10599           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10600
 10601     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10602                                   WS-AH-EDIT-AGE.
 10603
 10604     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10605        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10606        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10607        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10608        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10609        IF NO-CONVERSION-ERROR
 10610           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10611           IF PB-I-JOINT-AGE > 0
 10612              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10613                 MOVE ER-9503    TO WS-ERROR
 10614                 PERFORM 9900-ERROR-FORMAT
 10615                                 THRU 9900-EXIT
 10616              END-IF
 10617           ELSE
 10618              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10619           END-IF
 10620        ELSE
 10621           MOVE ZEROS            TO PB-I-JOINT-AGE
 10622        END-IF
 10623     END-IF
 10624     IF PB-I-JOINT-AGE NOT NUMERIC
 10625        MOVE ZERO               TO PB-I-JOINT-AGE.
 10626
 10627     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10628                                   WS-JNT-AGE-SET
 10629     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10630        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10631           (WS-AH-JOINT-INDICATOR = 'J')
 10632           IF PB-I-JOINT-AGE = ZEROS
 10633               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10634                                          WS-JNT-AGE-SET
 10635               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10636           END-IF
 10637        END-IF
 10638     END-IF
 10639
 10640     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10641     IF WS-LF-JOINT-INDICATOR = 'J'
 10642        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10643        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10644            IF  PB-I-JOINT-AGE = ZERO
 10645                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 194
* EL050.cbl
 10646                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10647            ELSE
 10648                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10649                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10650                    IF PB-COMPANY-ID NOT = 'LBL'
 10651                        MOVE ER-2685    TO WS-ERROR
 10652                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10653
 10654     IF WS-AH-JOINT-INDICATOR = 'J'
 10655        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10656            IF  PB-I-JOINT-AGE = ZERO
 10657                MOVE ER-2686       TO WS-ERROR
 10658                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10659            ELSE
 10660                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10661                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10662                                           WS-EDIT-AGE
 10663                    IF PB-COMPANY-ID NOT = 'LBL'
 10664                        MOVE ER-2685    TO WS-ERROR
 10665                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10666
 10667******************************************************************
 10668*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10669******************************************************************
 10670
 10671     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10672        (WS-AH-SPECIAL-CALC-CD = 'O')
 10673        NEXT SENTENCE
 10674     ELSE
 10675        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10676          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10677           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10678            WS-AH-JOINT-INDICATOR = 'J')  AND
 10679           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10680            MOVE ER-2627             TO WS-ERROR
 10681            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10682
 10683     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10684        (WS-AH-SPECIAL-CALC-CD = 'O')
 10685         NEXT SENTENCE
 10686     ELSE
 10687         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10688            WS-AH-JOINT-INDICATOR = 'J'
 10689             IF PB-I-JOINT-INSURED = SPACES
 10690                 IF PB-COMPANY-ID NOT = 'JAL'
 10691                     MOVE ER-2696    TO WS-ERROR
 10692                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     IF PB-COMPANY-ID NOT = 'BOA'
 10695        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10696           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10697           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10698               PB-I-JOINT-INSURED NOT = SPACES)
 10699                MOVE ER-2691         TO WS-ERROR
 10700                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10701
 10702     IF PB-COMPANY-ID = 'BOA'
 10703        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 195
* EL050.cbl
 10704           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10705            IF PB-I-JOINT-AGE NOT = ZEROS
 10706                MOVE ER-2691         TO WS-ERROR
 10707                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10708
 10709     IF PB-COMPANY-ID = 'CRI'
 10710        IF PB-I-SIG-SW = 'J'
 10711           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10712              WS-AH-JOINT-INDICATOR NOT = 'J'
 10713              MOVE ER-2675       TO WS-ERROR
 10714              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10715
 10716     IF PB-COMPANY-ID = 'CRI'
 10717        IF PB-I-SIG-SW = 'S'
 10718           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10719              WS-AH-JOINT-INDICATOR = 'J'
 10720              MOVE ER-2676       TO WS-ERROR
 10721              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10722
 10723     IF PB-COMPANY-ID = 'CVL'
 10724         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10725            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10726              MOVE ER-2783           TO WS-ERROR
 10727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10728     IF (WS-LF-JOINT-INDICATOR = 'J')
 10729        AND (WS-AH-JOINT-INDICATOR = 'J')
 10730        AND (PB-I-LF-TERM > 120)
 10731        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10732        MOVE ER-2783             TO WS-ERROR
 10733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10734     END-IF
 10735     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10736
 10737     IF PB-I-INDV-GRP-OVRD = 'I'
 10738        MOVE ER-2666             TO WS-ERROR
 10739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10740        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10741
 10742     IF PB-I-INDV-GRP-OVRD = 'G'
 10743        MOVE ER-2666             TO WS-ERROR
 10744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10745        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10746
 10747     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10748        NEXT SENTENCE
 10749     ELSE
 10750        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10751
 10752     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10753        IF WS-ERROR = ER-2666
 10754           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10755           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10756
 10757     IF PB-COMPANY-ID = 'CID'
 10758        IF PB-STATE = 'UT' OR 'MO'
 10759           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10760                 OR '76' OR '77')
 10761                      OR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 196
* EL050.cbl
 10762               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10763                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10764                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10765                   OR '2K' OR '2L'))
 10766              AND PB-I-INDV-GRP-CD = 'I'
 10767              MOVE ER-2721             TO WS-ERROR
 10768              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10769           END-IF
 10770        END-IF
 10771     END-IF
 10772
 10773     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10774     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10775        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10776     ELSE
 10777        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10778     END-IF
 10779
 10780*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10781*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10782     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10783                                    ACCOUNT-AH-CK-SW.
 10784
 10785     IF PB-REISSUED-CERT       OR
 10786        PB-REIN-ONLY-CERT      OR
 10787        PB-POLICY-IS-DECLINED  OR
 10788        PB-POLICY-IS-VOIDED
 10789*       OR PB-MONTHLY-CERT
 10790         GO TO 3000-CONTINUE-EDIT.
 10791
 10792     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10793        IF WS-EDIT-AGE           > +65
 10794           MOVE ER-2709          TO WS-ERROR
 10795           PERFORM 9900-ERROR-FORMAT
 10796                                 THRU 9900-EXIT
 10797        ELSE
 10798           IF WS-EDIT-AGE        > +55
 10799              MOVE ER-2718       TO WS-ERROR
 10800              PERFORM 9900-ERROR-FORMAT
 10801                                 THRU 9900-EXIT
 10802           END-IF
 10803        END-IF
 10804     IF PB-COMPANY-ID = 'DCC'
 10805        IF WS-EDIT-AGE           > +65
 10806           MOVE ER-2709          TO WS-ERROR
 10807           PERFORM 9900-ERROR-FORMAT
 10808                                 THRU 9900-EXIT
 10809        END-IF
 10810     END-IF
 10811     .
 10812
 10813 0565-LIFE-PLAN-LIMIT-EDITS.
 10814
 10815     IF NOT LF-PLAN-MASTER-FOUND
 10816        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10817                                    EC-AM-LF-MAX-TOT-BEN
 10818        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10819
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 197
* EL050.cbl
 10820     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10821
 10822     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10823         IF PL-LM-AGE (1) = ZEROS
 10824             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10825
 10826     IF NO-LF-BENEFIT-MATCH          OR
 10827        WS-LF-BENEFIT-CD = ZEROS     OR
 10828        WS-LF-SPECIAL-CALC-CD = 'M'
 10829        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10830
 10831     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10832     MOVE +1                     TO SUB2.
 10833
 10834     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10835        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10836           MOVE +5   TO SUB2
 10837           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10838              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10839              (PL-LM-AGE (SUB2) EQUAL +0)
 10840              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10841              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10842
 10843     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10844
 10845     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10846                               + PB-I-LF-ALT-BENEFIT-AMT.
 10847
 10848 0568-CHECK-LIFE-ATT-AGE.
 10849
 10850     IF PL-ATT-AGE NUMERIC AND
 10851        PL-ATT-AGE > +0
 10852        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10853     END-IF
 10854*    IF PL-ATT-AGE NUMERIC AND
 10855*       PL-ATT-AGE > +0
 10856*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10857*       IF PB-I-BIRTHDAY > LOW-VALUES
 10858*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10859*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10860*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10861*          SET BIN-PLUS-ELAPSED  TO TRUE
 10862*          PERFORM 8500-DATE-CONVERT
 10863*                                THRU 8500-EXIT
 10864*          IF NO-CONVERSION-ERROR
 10865*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10866*             MOVE ER-2669       TO WS-ERROR
 10867*             PERFORM 9900-ERROR-FORMAT
 10868*                                THRU 9900-EXIT
 10869*          END-IF
 10870*       ELSE
 10871*          IF WS-ATT-AGE >= PL-ATT-AGE
 10872*             MOVE ER-2669       TO WS-ERROR
 10873*             PERFORM 9900-ERROR-FORMAT
 10874*                                THRU 9900-EXIT
 10875*          END-IF
 10876*       END-IF
 10877*    END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 198
* EL050.cbl
 10878     .
 10879 0570-CHECK-LIFE-LIMITS.
 10880
 10881     IF PB-COMPANY-ID EQUAL 'CRI'
 10882        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10883           IF SUB2 GREATER THAN +4
 10884              MOVE ER-2637 TO WS-ERROR
 10885              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10886              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10887
 10888     IF PB-COMPANY-ID  =  'NCL'
 10889        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10890            SUB2 GREATER THAN +8
 10891             MOVE 'U'         TO PB-BATCH-ENTRY
 10892             MOVE ER-2637     TO WS-ERROR
 10893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10894             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10895
 10896     IF SUB2 > +8
 10897        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10898           AND (PB-I-SIG-SW = 'Y')
 10899           CONTINUE
 10900        ELSE
 10901           MOVE ER-2637          TO WS-ERROR
 10902           PERFORM 9900-ERROR-FORMAT
 10903                                 THRU 9900-EXIT
 10904        END-IF
 10905        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10906     END-IF
 10907     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10908     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10909     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10910
 10911     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10912        ADD +1  TO SUB2
 10913        GO TO 0570-CHECK-LIFE-LIMITS.
 10914
 10915     IF PB-COMPANY-ID = 'NCL'
 10916         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10917
 10918     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10919        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10920        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10921           AND (PB-I-SIG-SW = 'Y')
 10922           CONTINUE
 10923        ELSE
 10924           MOVE ER-2637          TO WS-ERROR
 10925           PERFORM 9900-ERROR-FORMAT
 10926                                 THRU 9900-EXIT
 10927        END-IF
 10928     END-IF
 10929     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10930
 10931
 10932 0570-CHECK-NCL-LIFE-LIMITS.
 10933
 10934     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10935        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 199
* EL050.cbl
 10936         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10937
 10938     IF APP-CERT-USED
 10939         IF SUB2  LESS THAN  +5
 10940             MOVE +5          TO SUB2
 10941             GO TO 0570-CHECK-LIFE-LIMITS.
 10942
 10943     MOVE ER-2637             TO WS-ERROR.
 10944     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10945
 10946     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10947
 10948 0575-CHECK-NCL-SIG-SWITCH.
 10949
 10950     IF NOT APP-CERT-USED
 10951         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10952
 10953     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10954        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10955        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10956        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10957         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10958
 10959     IF SUB2 GREATER THAN +4
 10960         IF PL-LM-AGE (5) = ZEROS  AND
 10961            PL-LM-AGE (6) = ZEROS  AND
 10962            PL-LM-AGE (7) = ZEROS  AND
 10963            PL-LM-AGE (8) = ZEROS
 10964             MOVE  ER-1927        TO WS-ERROR
 10965             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10966             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10967         ELSE
 10968             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10969                 MOVE  ER-1920    TO WS-ERROR
 10970                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10971
 10972     IF PB-I-SIG-SW  = 'Y'
 10973       IF NOT PB-I-POLICY-ACCEPTED  AND
 10974          NOT PB-I-POLICY-DECLINED
 10975           MOVE 'U'               TO PB-BATCH-ENTRY
 10976           MOVE  ER-1926          TO WS-ERROR
 10977           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10978
 10979
 10980 0580-AH-PLAN-LIMIT-EDITS.
 10981
 10982     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10983        IF PB-I-AH-BENEFIT-AMT > +1250
 10984           MOVE ER-2702          TO WS-ERROR
 10985           PERFORM 9900-ERROR-FORMAT
 10986                                 THRU 9900-EXIT
 10987        END-IF
 10988     END-IF
 10989
 10990     IF (PB-COMPANY-ID = 'DCC')
 10991        AND (PB-MONTHLY-CERT)
 10992        IF PB-I-AH-BENEFIT-AMT > +3000
 10993           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 200
* EL050.cbl
 10994           PERFORM 9900-ERROR-FORMAT
 10995                                 THRU 9900-EXIT
 10996        END-IF
 10997     END-IF
 10998     IF NOT AH-PLAN-MASTER-FOUND
 10999        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11000        GO TO 3000-CONTINUE-EDIT.
 11001
 11002     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11003
 11004     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11005         IF PL-LM-AGE (1) = ZEROS
 11006             GO TO 3000-CONTINUE-EDIT.
 11007
 11008     IF NO-AH-BENEFIT-MATCH          OR
 11009        WS-AH-BENEFIT-CD = ZEROS     OR
 11010        WS-AH-SPECIAL-CALC-CD = 'M'
 11011        GO TO 3000-CONTINUE-EDIT.
 11012
 11013     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11014     MOVE +1                     TO SUB2.
 11015
 11016     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11017        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11018           MOVE +5 TO SUB2
 11019           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11020              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11021              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11022              (PL-LM-AGE (SUB2) EQUAL +0)
 11023              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11024              GO TO 3000-CONTINUE-EDIT.
 11025
 11026     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11027
 11028 0590-CHECK-AH-ATT-AGE.
 11029
 11030     IF PL-ATT-AGE NUMERIC AND
 11031        PL-ATT-AGE GREATER THAN +0
 11032        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11033     END-IF
 11034*       IF WS-ATT-AGE >= PL-ATT-AGE
 11035*          MOVE ER-3054          TO WS-ERROR
 11036*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11037     .
 11038 0597-CHECK-AH-LIMITS.
 11039
 11040     IF PB-COMPANY-ID EQUAL 'CRI'
 11041        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11042           IF SUB2 GREATER THAN +4
 11043              MOVE ER-2638       TO WS-ERROR
 11044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11045              GO TO 3000-CONTINUE-EDIT.
 11046
 11047     IF PB-COMPANY-ID  =  'NCL'
 11048        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11049            SUB2 GREATER THAN +8
 11050             MOVE 'U'            TO PB-BATCH-ENTRY
 11051             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 201
* EL050.cbl
 11052             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11053             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11054
 11055     IF SUB2 > +8
 11056        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11057           AND (PB-I-SIG-SW = 'Y')
 11058           CONTINUE
 11059        ELSE
 11060           MOVE ER-2638          TO WS-ERROR
 11061           PERFORM 9900-ERROR-FORMAT
 11062                                 THRU 9900-EXIT
 11063        END-IF
 11064        GO TO 3000-CONTINUE-EDIT
 11065     END-IF
 11066
 11067     IF PB-COMPANY-ID = 'CRI'
 11068        IF WS-ERROR = ER-2638
 11069           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11070
 11071     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11072     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11073     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11074     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11075
 11076     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11077        ADD +1                   TO SUB2
 11078        GO TO 0597-CHECK-AH-LIMITS.
 11079
 11080     IF PB-COMPANY-ID = 'NCL'
 11081         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11082
 11083     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11084        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11085        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11086                                 > PL-LM-AMT (SUB2))
 11087        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11088           AND (PB-I-SIG-SW = 'Y')
 11089           CONTINUE
 11090        ELSE
 11091           MOVE ER-2638          TO WS-ERROR
 11092           PERFORM 9900-ERROR-FORMAT
 11093                                 THRU 9900-EXIT
 11094        END-IF
 11095     END-IF
 11096
 11097     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11098         IF  WS-ERROR    EQUAL    ER-2638
 11099             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11100                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11101                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11102                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11103                MOVE  ER-1910    TO  WS-ERROR
 11104                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11105
 11106     IF PB-COMPANY-ID = 'CRI'
 11107        IF WS-ERROR = ER-2638
 11108            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11109            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 202
* EL050.cbl
 11110            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11111
 11112     GO TO 3000-CONTINUE-EDIT.
 11113
 11114 0597-CHECK-NCL-AH-LIMITS.
 11115
 11116     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11117        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11118        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11119                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11120         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11121
 11122     IF APP-CERT-USED
 11123         IF SUB2  LESS THAN  +5
 11124             MOVE +5             TO SUB2
 11125             GO TO 0597-CHECK-AH-LIMITS.
 11126
 11127     MOVE ER-2638                TO WS-ERROR.
 11128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11129
 11130     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11131
 11132 0599-CHECK-NCL-SIG-SWITCH.
 11133
 11134     IF NOT APP-CERT-USED
 11135         GO TO 3000-CONTINUE-EDIT.
 11136
 11137     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11138        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11139        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11140        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11141         GO TO 3000-CONTINUE-EDIT.
 11142
 11143     IF SUB2 GREATER THAN +4
 11144         IF PL-LM-AGE (5) = ZEROS  AND
 11145            PL-LM-AGE (6) = ZEROS  AND
 11146            PL-LM-AGE (7) = ZEROS  AND
 11147            PL-LM-AGE (8) = ZEROS
 11148             MOVE  ER-1927        TO WS-ERROR
 11149             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11150             GO TO 3000-CONTINUE-EDIT
 11151         ELSE
 11152             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11153                 MOVE  ER-1920    TO WS-ERROR
 11154                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11155
 11156     IF PB-I-SIG-SW  = 'Y'
 11157       IF NOT PB-I-POLICY-ACCEPTED  AND
 11158          NOT PB-I-POLICY-DECLINED
 11159           MOVE 'U'               TO PB-BATCH-ENTRY
 11160           MOVE  ER-1926          TO WS-ERROR
 11161           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11162
 11163******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 203
* EL050.cbl
 11165
 11166 3000-CONTINUE-EDIT.
 11167
 11168     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11169     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11170     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11171     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11172     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11173
 11174     IF BROWSE-STARTED
 11175        PERFORM 9990-RETURN THRU 9990-EXIT
 11176        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11177
 11178     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11179        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11180        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11181        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11182*       MOVE 1                   TO DC-OPTION-CODE
 11183        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11184        IF DATE-CONVERSION-ERROR
 11185           MOVE ER-2622          TO WS-ERROR
 11186           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11187        ELSE
 11188           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11189              MOVE ER-2623       TO WS-ERROR
 11190              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11191           ELSE
 11192              MOVE ER-2622       TO WS-ERROR
 11193              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11194
 11195     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11196     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11197     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11198*    MOVE 1                      TO DC-OPTION-CODE.
 11199     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11200     IF DATE-CONVERSION-ERROR
 11201        GO TO 3005-EDIT-CONTINUE
 11202     ELSE
 11203        IF DC-ELAPSED-DAYS GREATER +180
 11204           MOVE ER-2613          TO WS-ERROR
 11205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11206        ELSE
 11207           IF DC-ELAPSED-DAYS GREATER +90
 11208              MOVE ER-2612       TO WS-ERROR
 11209              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11210           ELSE
 11211             IF DC-ELAPSED-DAYS GREATER +60
 11212                MOVE ER-2614     TO WS-ERROR
 11213                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11214
 11215 3005-EDIT-CONTINUE.
 11216
 11217     IF PB-CANCELLATION
 11218         GO TO 3700-EDIT-CANCEL.
 11219
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 204
* EL050.cbl
 11221******************************************************************
 11222*                  E D I T   I S S U E                           *
 11223******************************************************************
 11224
 11225 3020-EDIT-ISSUE.
 11226
 11227      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11228      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11229      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11230      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11231      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11232
 11233     IF PB-ISSUE-FORCE
 11234        OR PB-ISSUE-DATE-FORCED
 11235        OR PB-FORCE-OFF
 11236        OR PB-OVERCHARGE-FORCE
 11237        CONTINUE
 11238     ELSE
 11239        MOVE ER-2670             TO WS-ERROR
 11240        PERFORM 9900-ERROR-FORMAT
 11241                                 THRU 9900-EXIT
 11242     END-IF
 11243     .
 11244 3022-SET-POLICY-STATUS.
 11245
 11246     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11247
 11248     IF (PB-REISSUED-CERT)
 11249             OR
 11250        ((PB-COMPANY-ID NOT = 'DCC')
 11251         AND (PB-MONTHLY-CERT))
 11252         MOVE '5'                TO PB-I-ENTRY-STATUS
 11253         MOVE 'E'                TO PB-BATCH-ENTRY
 11254     END-IF
 11255
 11256     IF PB-COMPANY-ID = 'DCC'
 11257        IF PB-MONTHLY-CERT
 11258           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11259        END-IF
 11260     END-IF
 11261     IF PB-POLICY-IS-DECLINED
 11262         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11263     IF PB-POLICY-IS-VOIDED
 11264         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11265     IF PB-NEEDS-UNDERWRITING
 11266         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11267     IF PB-REIN-ONLY-CERT
 11268         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11269     IF PB-PREM-ACCTNG-ONLY
 11270         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11271
 11272     MOVE SPACE                  TO PB-I-OB-FLAG.
 11273
 11274     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11275         MOVE ER-2665            TO WS-ERROR
 11276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11277         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11278
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 205
* EL050.cbl
 11279     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11280        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11281           MOVE 'Z'             TO PB-I-OB-FLAG.
 11282
 11283     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11284        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11285           MOVE 'Z'             TO PB-I-OB-FLAG.
 11286
 11287     IF ACCOUNT-MAST-FOUND
 11288         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11289         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11290         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11291         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11292         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11293         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11294         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11295     END-IF
 11296
 11297     IF ACCOUNT-MAST-FOUND
 11298        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11299         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11300
 11301     IF (ACCOUNT-MAST-FOUND)
 11302        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11303        IF PB-REISSUED-CERT
 11304           CONTINUE
 11305        ELSE
 11306           MOVE ER-2608          TO WS-ERROR
 11307           PERFORM 9900-ERROR-FORMAT
 11308                                 THRU 9900-EXIT
 11309         END-IF
 11310     END-IF
 11311
 11312     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11313        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11314        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11315
 11316**********   DMD CUSTOM CODE FOLLOWS  **********
 11317 3024-EDIT-DMD-FIELDS.
 11318     IF PB-COMPANY-ID NOT = 'DMD'
 11319        GO TO 3025-EDIT-REINSURANCE.
 11320
 11321*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11322*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11323*** ERROR IF THEY ARE NOT EQUAL.
 11324
 11325     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11326     SET BIN-TO-GREG               TO TRUE.
 11327     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11328     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11329**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11330
 11331     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11332     SET BIN-TO-GREG               TO TRUE.
 11333     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11334     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11335**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11336
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 206
* EL050.cbl
 11337     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11338        MOVE ER-8116               TO WS-ERROR
 11339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11340
 11341     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11342
 11343     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11344                                      WK-FULL-CERT-NO.
 11345     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11346
 11347     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11348
 11349     IF PB-VALID-LIFE
 11350        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11351     ELSE
 11352        IF PB-VALID-AH
 11353          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11354
 11355
 11356     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11357     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11358     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11359                                      DCUA-UNDRWRTR-CODE
 11360                                      DCUA-UNDRWRTR-GROUP-CODE
 11361                                      DCUA-RETURN-CODE.
 11362
 11363****************************************************************
 11364*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11365***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11366***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11367***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11368***   TO THIS RECORD.                                        ***
 11369****************************************************************
 11370     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11371     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11372     IF DCUA-SUCCESSFUL-PROCESS
 11373        GO TO 3024-EDIT-DL7-CONT.
 11374
 11375     IF DCUA-RETURN-CODE EQUAL '01'
 11376        MOVE ER-8110               TO WS-ERROR
 11377        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11379        GO TO 3024-EDIT-DL7-CONT.
 11380
 11381     IF DCUA-RETURN-CODE EQUAL '02'
 11382        MOVE ER-8111               TO WS-ERROR
 11383        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11385        GO TO 3024-EDIT-DL7-CONT.
 11386
 11387     IF DCUA-RETURN-CODE EQUAL '03'
 11388        MOVE ER-8074               TO WS-ERROR
 11389        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11391        GO TO 3024-EDIT-DL7-CONT.
 11392
 11393     IF DCUA-RETURN-CODE EQUAL '04'
 11394        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 207
* EL050.cbl
 11395        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11397        GO TO 3024-EDIT-DL7-CONT.
 11398
 11399     IF DCUA-RETURN-CODE EQUAL '05'
 11400        MOVE ER-8076               TO WS-ERROR
 11401        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403        GO TO 3024-EDIT-DL7-CONT.
 11404
 11405     IF DCUA-RETURN-CODE EQUAL '06'
 11406        MOVE ER-8077               TO WS-ERROR
 11407        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11409        GO TO 3024-EDIT-DL7-CONT.
 11410
 11411     IF DCUA-RETURN-CODE EQUAL '07'
 11412        MOVE ER-8078               TO WS-ERROR
 11413        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL7-CONT.
 11416
 11417     IF DCUA-RETURN-CODE EQUAL 'E1'
 11418        MOVE ER-8079               TO WS-ERROR
 11419        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11421        GO TO 3024-EDIT-DL7-CONT.
 11422
 11423     IF DCUA-RETURN-CODE EQUAL 'E2'
 11424        MOVE ER-8080               TO WS-ERROR
 11425        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427        GO TO 3024-EDIT-DL7-CONT.
 11428
 11429     IF DCUA-RETURN-CODE EQUAL 'E3'
 11430        MOVE ER-8098               TO WS-ERROR
 11431        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433        GO TO 3024-EDIT-DL7-CONT.
 11434
 11435     IF DCUA-RETURN-CODE EQUAL 'C1'
 11436        MOVE ER-8099               TO WS-ERROR
 11437        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11439        GO TO 3024-EDIT-DL7-CONT.
 11440
 11441     IF DCUA-RETURN-CODE EQUAL 'U1'
 11442        MOVE ER-8109               TO WS-ERROR
 11443        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445        GO TO 3024-EDIT-DL7-CONT.
 11446
 11447     IF DCUA-RETURN-CODE EQUAL 'N1'
 11448        MOVE ER-8112               TO WS-ERROR
 11449        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451        GO TO 3024-EDIT-DL7-CONT.
 11452
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 208
* EL050.cbl
 11453     IF DCUA-RETURN-CODE EQUAL 'N2'
 11454        MOVE ER-8113               TO WS-ERROR
 11455        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL7-CONT.
 11458
 11459     IF DCUA-RETURN-CODE EQUAL 'N3'
 11460        MOVE ER-8114               TO WS-ERROR
 11461        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 3024-EDIT-DL7-CONT.
 11464
 11465     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11466     MOVE ER-8097                  TO WS-ERROR.
 11467     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11468     GO TO 3024-EDIT-DL7-CONT.
 11469
 11470 3024-EDIT-DL7-CONT.
 11471
 11472     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11473     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11474     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11475        NEXT SENTENCE
 11476     ELSE
 11477        MOVE ER-9263               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11479
 11480******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11481******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11482     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11483        NEXT SENTENCE
 11484     ELSE
 11485        MOVE ER-8039               TO WS-ERROR
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11487
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 209
* EL050.cbl
 11489****************************************************************
 11490*** VALIDATE STATE  : DLO022                                 ***
 11491****************************************************************
 11492     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11493     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11494
 11495     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11496     IF DVSC-SUCCESSFUL-EDIT
 11497        GO TO 3024-EDIT-DL22-CONT.
 11498
 11499     IF DVSC-RETURN-CODE EQUAL '01'
 11500        MOVE ER-8300               TO WS-ERROR
 11501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502        GO TO 3024-EDIT-DL22-CONT.
 11503
 11504     IF DVSC-RETURN-CODE EQUAL '02'
 11505        MOVE ER-8301               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL22-CONT.
 11508
 11509     IF DVSC-RETURN-CODE EQUAL '03'
 11510        MOVE ER-8302               TO WS-ERROR
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL22-CONT.
 11513
 11514     IF DVSC-RETURN-CODE EQUAL 'N1'
 11515        MOVE ER-8304               TO WS-ERROR
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL22-CONT.
 11518
 11519     MOVE ER-8303                  TO WS-ERROR
 11520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11521
 11522 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 210
* EL050.cbl
 11524****************************************************************
 11525*** VALIDATE LOAN OFFICER : DLO021                           ***
 11526****************************************************************
 11527
 11528     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11529     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11530     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11531     IF DVLO-SUCCESSFUL-EDIT
 11532        GO TO 3024-EDIT-DL21-CONT.
 11533
 11534     IF DVLO-RETURN-CODE EQUAL '01'
 11535        MOVE ER-8081               TO WS-ERROR
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL21-CONT.
 11538
 11539     IF DVLO-RETURN-CODE EQUAL '02'
 11540        MOVE ER-8082               TO WS-ERROR
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL21-CONT.
 11543
 11544     IF DVLO-RETURN-CODE EQUAL '03'
 11545        MOVE ER-8083               TO WS-ERROR
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL21-CONT.
 11548
 11549     IF DVLO-RETURN-CODE EQUAL '04'
 11550        MOVE ER-8084               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL21-CONT.
 11553
 11554     IF DVLO-RETURN-CODE EQUAL '05'
 11555        MOVE ER-8085               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL21-CONT.
 11558
 11559     MOVE ER-7825                  TO WS-ERROR
 11560     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11561     GO TO 3024-EDIT-DL21-CONT.
 11562
 11563 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 211
* EL050.cbl
 11565
 11566****************************************************************
 11567*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11568****************************************************************
 11569
 11570     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11571     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11572     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11573     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11574     IF DIPF-SUCCESSFUL-EDIT
 11575        GO TO 3024-EDIT-DL02-CONT.
 11576
 11577     IF DIPF-RETURN-CODE EQUAL '01'
 11578        MOVE ER-8086               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL02-CONT.
 11581
 11582     IF DIPF-RETURN-CODE EQUAL '02'
 11583        MOVE ER-8087               TO WS-ERROR
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL02-CONT.
 11586
 11587     IF DIPF-RETURN-CODE EQUAL '03'
 11588        MOVE ER-8088               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL02-CONT.
 11591
 11592     MOVE ER-8095                  TO WS-ERROR
 11593     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11594     GO TO 3024-EDIT-DL02-CONT.
 11595
 11596 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 212
* EL050.cbl
 11598
 11599****************************************************************
 11600*** VALIDATE BANK ID : DLO003                                ***
 11601****************************************************************
 11602
 11603     MOVE WK-GREG-CENT           TO WCG-CENT.
 11604     MOVE WK-GREG-YYMM           TO WCG-REST.
 11605     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11606        MOVE ER-8040               TO WS-ERROR
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11608
 11609     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11610     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11611     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11612     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11613     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11614     IF DVBI-SUCCESSFUL-EDIT
 11615        GO TO 3024-EDIT-DL03-CONT.
 11616
 11617     IF DVBI-RETURN-CODE EQUAL '01'
 11618        MOVE ER-8089               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL03-CONT.
 11621
 11622     IF DVBI-RETURN-CODE EQUAL '02'
 11623        MOVE ER-8090               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL03-CONT.
 11626
 11627     IF DVBI-RETURN-CODE EQUAL '03'
 11628        MOVE ER-8091               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL03-CONT.
 11631
 11632     IF DVBI-RETURN-CODE EQUAL '04'
 11633        MOVE ER-8092               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL03-CONT.
 11636
 11637     IF DVBI-RETURN-CODE EQUAL '05'
 11638        MOVE ER-8093               TO WS-ERROR
 11639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11640        GO TO 3024-EDIT-DL03-CONT.
 11641
 11642     IF DVBI-RETURN-CODE EQUAL '06'
 11643        MOVE ER-8094               TO WS-ERROR
 11644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11645        GO TO 3024-EDIT-DL03-CONT.
 11646
 11647     MOVE ER-8096                  TO WS-ERROR
 11648     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11649     GO TO 3024-EDIT-DL03-CONT.
 11650
 11651 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 213
* EL050.cbl
 11653
 11654     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11655        NEXT SENTENCE
 11656     ELSE
 11657        MOVE ER-8042               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11659
 11660     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11661     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11662     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11663
 11664     IF DMPF-RETURN-CODE = '01'
 11665        MOVE ER-8067               TO WS-ERROR
 11666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11667        GO TO 3024-EDIT-DL01-CONT.
 11668
 11669     IF DMPF-RETURN-CODE = '02'
 11670        MOVE ER-8068               TO WS-ERROR
 11671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11672        GO TO 3024-EDIT-DL01-CONT.
 11673
 11674     IF DMPF-RETURN-CODE = '03'
 11675        MOVE ER-8069               TO WS-ERROR
 11676        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11677        GO TO 3024-EDIT-DL01-CONT.
 11678
 11679     IF DMPF-RETURN-CODE = 'E1'
 11680        MOVE ER-8070               TO WS-ERROR
 11681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11682        GO TO 3024-EDIT-DL01-CONT.
 11683
 11684     IF DMPF-RETURN-CODE = 'N1'
 11685        MOVE ER-8071               TO WS-ERROR
 11686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11687        GO TO 3024-EDIT-DL01-CONT.
 11688
 11689     IF DMPF-RETURN-CODE NOT = 'OK'
 11690        MOVE ER-8072               TO WS-ERROR
 11691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11692
 11693 3024-EDIT-DL01-CONT.
 11694******************************************************************
 11695***  VALIDATES RATE CODES : DLO017                             ***
 11696******************************************************************
 11697
 11698      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11699      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11700      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11701      IF DVRC-SUCCESSFUL-EDIT
 11702        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11703        GO TO 3024-CHECK-VALID-RATE.
 11704
 11705      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11706
 11707      IF DVRC-RETURN-CODE EQUAL '01'
 11708         MOVE ER-7817                   TO WS-ERROR
 11709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11710         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 214
* EL050.cbl
 11711
 11712      IF DVRC-RETURN-CODE EQUAL '02'
 11713         MOVE ER-7818                   TO WS-ERROR
 11714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11715         GO TO 3025-EDIT-REINSURANCE.
 11716
 11717      IF DVRC-RETURN-CODE EQUAL '03'
 11718         MOVE ER-7819                   TO WS-ERROR
 11719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11720         GO TO 3025-EDIT-REINSURANCE.
 11721
 11722       MOVE ER-7820                     TO WS-ERROR.
 11723       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11724       GO TO 3025-EDIT-REINSURANCE.
 11725
 11726******************************************************************
 11727***  GET PREMIUM RATES : DLO011                                ***
 11728******************************************************************
 11729
 11730 3024-CHECK-VALID-RATE.
 11731
 11732     IF VALID-RATE-CODE
 11733        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11734        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11735        MOVE SPACES                TO DPRB-RETURN-CODE
 11736        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11737     ELSE
 11738         GO TO 3025-EDIT-REINSURANCE.
 11739
 11740      IF DPRB-SUCCESSFUL-PROCESS
 11741         IF PB-VALID-LIFE
 11742             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11743             GO TO 3025-EDIT-REINSURANCE
 11744         ELSE
 11745             IF PB-VALID-AH
 11746                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11747                 GO TO 3025-EDIT-REINSURANCE.
 11748
 11749      IF DPRB-RETURN-CODE EQUAL '01'
 11750         MOVE ER-7812                   TO WS-ERROR
 11751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752         GO TO 3025-EDIT-REINSURANCE.
 11753
 11754      IF DPRB-RETURN-CODE EQUAL '02'
 11755         MOVE ER-7813                   TO WS-ERROR
 11756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757         GO TO 3025-EDIT-REINSURANCE.
 11758
 11759      IF DPRB-RETURN-CODE EQUAL '03'
 11760         MOVE ER-7814                   TO WS-ERROR
 11761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762         GO TO 3025-EDIT-REINSURANCE.
 11763
 11764      IF DPRB-RETURN-CODE EQUAL '04'
 11765         IF NOT DPRB-1ST-TIME
 11766            MOVE ER-7815                   TO WS-ERROR
 11767            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11768            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 215
* EL050.cbl
 11769          ELSE
 11770         IF PB-VALID-LIFE
 11771            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11772          ELSE
 11773            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11774         END-IF
 11775         MOVE SPACES                TO DOCC-RETURN-CODE
 11776         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11777         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11778         IF DOCC-RETURN-CODE = 'OK'
 11779             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11780             GO TO 3024-CHECK-VALID-RATE
 11781           ELSE
 11782             MOVE ER-7823               TO WS-ERROR
 11783             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11784             GO TO 3025-EDIT-REINSURANCE.
 11785
 11786       MOVE ER-7816                     TO WS-ERROR.
 11787       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11788       GO TO 3025-EDIT-REINSURANCE.
 11789
 11790**********   DMD CUSTOM CODE ABOVE    **********
 11791
 11792 3025-EDIT-REINSURANCE.
 11793     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11794         GO TO 3027-EDIT-CONTINUE.
 11795
 11796     MOVE LOW-VALUES               TO ERREIN-KEY.
 11797     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11798     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11799                                      REIN-CODE-2
 11800                                      REIN-CODE-3.
 11801     MOVE 'A'                      TO REIN-TYPE.
 11802
 11803     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11804
 11805     MOVE '3026' TO REIN-SW.
 11806     MOVE ' '                   TO WS-REIN-READ-SW.
 11807
 11808     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11809     IF REIN-TABLE-NOT-FOUND
 11810         GO TO 3026-NO-SPEC-TABLE.
 11811
 11812     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11813     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11814                                   WS-NSP-ST-CD-LF.
 11815     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11816                                   WS-NSP-ST-CD-AH.
 11817
 11818     GO TO 3040-EDIT-CONTINUE.
 11819
 11820 3026-NO-SPEC-TABLE.
 11821
 11822     MOVE ER-2664                TO WS-ERROR.
 11823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11824     GO TO 3040-EDIT-CONTINUE.
 11825
 11826 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 216
* EL050.cbl
 11827
 11828     IF PB-I-REIN-TABLE = SPACES
 11829       GO TO 3040-EDIT-CONTINUE.
 11830
 11831     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11832          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11833          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11834           GO TO 3040-EDIT-CONTINUE.
 11835
 11836     MOVE LOW-VALUES            TO ERREIN-KEY.
 11837     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11838     MOVE 'A'                   TO REIN-TYPE.
 11839     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11840
 11841     MOVE '3028'                TO REIN-SW.
 11842     MOVE ' '                   TO WS-REIN-READ-SW.
 11843
 11844     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11845     IF REIN-TABLE-NOT-FOUND
 11846         GO TO 3028-NO-REIN-TABLE.
 11847
 11848     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11849     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11850                                   WS-NSP-ST-CD-LF.
 11851     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11852                                   WS-NSP-ST-CD-AH.
 11853
 11854     GO TO 3040-EDIT-CONTINUE.
 11855
 11856 3028-NO-REIN-TABLE.
 11857
 11858     MOVE ER-2615                TO WS-ERROR.
 11859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11860     GO TO 3040-EDIT-CONTINUE.
 11861
 11862 3040-EDIT-CONTINUE.
 11863
 11864     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11865         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11866
 11867     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11868         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11869
 11870     IF (NOT PB-REISSUED-CERT)
 11871        AND (NOT PB-MONTHLY-CERT)
 11872        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11873            MOVE '001'           TO PB-I-LF-TERM
 11874            MOVE 'M'             TO PB-I-INSURED-SEX.
 11875
 11876     IF (NOT PB-REISSUED-CERT)
 11877        AND (NOT PB-MONTHLY-CERT)
 11878        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11879            MOVE '001'           TO PB-I-AH-TERM
 11880            MOVE 'M'             TO PB-I-INSURED-SEX.
 11881
 11882 3040-EDIT-1ST-PMT-DT.
 11883     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11884     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 217
* EL050.cbl
 11885         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11886
 11887******************************************************************
 11888*                                                                *
 11889*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11890*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11891*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11892*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11893*                                                                *
 11894******************************************************************
 11895
 11896     IF PB-EFF-DT-PROCESSING
 11897        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11898                                    PB-I-LF-EXPIRE-DT
 11899                                    PB-I-AH-EXPIRE-DT
 11900        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11901        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11902        MOVE ZERO                TO DC-ELAPSED-DAYS
 11903        MOVE +1                  TO DC-ELAPSED-MONTHS
 11904        SET BIN-PLUS-ELAPSED     TO TRUE
 11905*       MOVE 6                   TO DC-OPTION-CODE
 11906        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11907        IF NO-CONVERSION-ERROR
 11908           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11909
 11910******************************************************************
 11911*                                                                *
 11912*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11913*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11914*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11915*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11916*                                                                *
 11917******************************************************************
 11918
 11919     IF PB-EXT-DAYS-PROCESSING
 11920          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11921                                         PB-I-LF-EXPIRE-DT
 11922                                         PB-I-AH-EXPIRE-DT
 11923          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11924          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11925          MOVE +1                     TO DC-ELAPSED-MONTHS
 11926          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11927          SET BIN-PLUS-ELAPSED        TO TRUE
 11928*         MOVE 6                      TO DC-OPTION-CODE
 11929          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11930          IF NO-CONVERSION-ERROR
 11931             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11932
 11933******************************************************************
 11934*                                                                *
 11935*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11936*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11937*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11938*        (EXPIRE DATE - (TERM -1))  *  -1.
 11939*                                                                *
 11940******************************************************************
 11941
 11942     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 218
* EL050.cbl
 11943        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11944           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11945              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11946              MOVE PB-I-AH-TERM      TO WS-TERM
 11947           ELSE
 11948              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11949              MOVE PB-I-LF-TERM      TO WS-TERM
 11950        ELSE
 11951           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11952              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11953              MOVE PB-I-LF-TERM      TO WS-TERM
 11954           ELSE
 11955              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11956              MOVE PB-I-AH-TERM      TO WS-TERM.
 11957
 11958     IF PB-EXPIRE-DT-PROCESSING
 11959        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11960        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11961        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11962        MOVE ZERO                TO DC-ELAPSED-DAYS
 11963                                    DC-ODD-DAYS-OVER
 11964          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11965          SET BIN-PLUS-ELAPSED    TO TRUE
 11966*         MOVE 6                  TO DC-OPTION-CODE
 11967          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11968          IF NO-CONVERSION-ERROR
 11969             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11970
 11971******************************************************************
 11972*                                                                *
 11973*            1ST PAYMENT DATE PROCESSING                         *
 11974*                                                                *
 11975******************************************************************
 11976
 11977     IF PB-1ST-PMT-DT-PROCESSING
 11978        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11979                                    PB-I-AH-EXPIRE-DT
 11980        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11981
 11982     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11983         NEXT SENTENCE
 11984     ELSE
 11985         MOVE ER-2680                 TO WS-ERROR
 11986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11987         GO TO 3060-ORIG-TERM-CHECK.
 11988
 11989     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11990     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11991     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11992*    MOVE 1                      TO DC-OPTION-CODE.
 11993     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11994                                    DC-ELAPSED-DAYS
 11995                                    DC-ODD-DAYS-OVER.
 11996
 11997     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11998
 11999     IF DATE-CONVERSION-ERROR
 12000        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 219
* EL050.cbl
 12001
 12002     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12003     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12004        AND (WS-LF-COVERAGE-TYPE = 'L')
 12005        IF (DC-ELAPSED-MONTHS > 1)
 12006                      OR
 12007           ((DC-ELAPSED-MONTHS = 1)
 12008           AND (DC-ODD-DAYS-OVER > 0))
 12009           MOVE ER-2882          TO WS-ERROR
 12010           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12011        END-IF
 12012     END-IF
 12013     if dc-elapsed-months > 0
 12014        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12015        + dc-odd-days-over
 12016     end-if
 12017     IF PB-EXT-DAYS-PROCESSING
 12018        CONTINUE
 12019     ELSE
 12020        IF DC-ELAPSED-MONTHS = +0
 12021           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12022        ELSE
 12023           IF (WS-LF-EARNINGS-CALC = '4')
 12024              AND (DC-ELAPSED-MONTHS > ZERO)
 12025              AND (DC-ELAPSED-DAYS > ZERO)
 12026              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12027           ELSE
 12028              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12029                                 THRU 6499-EXIT
 12030              MOVE WS-ODD-DAYS-OVER
 12031                                 TO PB-I-EXTENTION-DAYS
 12032           END-IF
 12033        END-IF
 12034     END-IF
 12035******************************************************************
 12036*                                                                *
 12037*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12038*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12039*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12040*            AND ANY ODD DAYS.                                   *
 12041*                                                                *
 12042******************************************************************
 12043
 12044     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12045                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12046     IF WS-LF-EARNINGS-CALC NOT = '4'
 12047        IF DC-ELAPSED-DAYS > ZEROS
 12048           MOVE ER-2681          TO WS-ERROR
 12049           PERFORM 9900-ERROR-FORMAT
 12050                                 THRU 9900-EXIT
 12051        END-IF
 12052     END-IF
 12053
 12054     IF WS-LF-EARNINGS-CALC NOT = '4'
 12055        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12056           MOVE ER-2681          TO WS-ERROR
 12057           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12058
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 220
* EL050.cbl
 12059     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12060        (PB-I-LF-TERM NOT = ZERO) AND
 12061         NOT NO-LIFE-COVERAGE
 12062          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12063          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12064          IF WS-LF-EARNINGS-CALC = '4'
 12065             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12066             PB-I-PAY-FREQUENCY
 12067          END-IF
 12068          MOVE ZERO              TO DC-ELAPSED-DAYS
 12069                                    DC-ODD-DAYS-OVER
 12070          MOVE 1                 TO DC-END-OF-MONTH
 12071          SET BIN-PLUS-ELAPSED        TO TRUE
 12072*         MOVE 6                 TO DC-OPTION-CODE
 12073          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12074          IF NO-CONVERSION-ERROR
 12075             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12076             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12077                (WS-LF-SPECIAL-CALC-CD = 'L')
 12078                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12079                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12080                  MOVE +1             TO DC-ELAPSED-MONTHS
 12081                  SET BIN-PLUS-ELAPSED  TO TRUE
 12082*                 MOVE 6              TO DC-OPTION-CODE
 12083                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12084                  IF NO-CONVERSION-ERROR
 12085                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12086
 12087* okay, i had to move the new att age edit down here because the
 12088* expiration date could get recalculated and i need the exp date
 12089     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12090        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12091        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12092        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12093           AND ZEROS
 12094           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12095           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12096           SET ELAPSED-BETWEEN-BIN TO TRUE
 12097           PERFORM 8500-DATE-CONVERT
 12098                                 THRU 8500-EXIT
 12099           IF NO-CONVERSION-ERROR
 12100              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12101                 MOVE ER-2669       TO WS-ERROR
 12102*                PERFORM 9900-ERROR-FORMAT
 12103*                                THRU 9900-EXIT
 12104              END-IF
 12105           END-IF
 12106        ELSE
 12107           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12108           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12109              MOVE ER-2669       TO WS-ERROR
 12110*             PERFORM 9900-ERROR-FORMAT
 12111*                                THRU 9900-EXIT
 12112           ELSE
 12113              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12114                 MOVE ER-1570    TO WS-ERROR
 12115                 PERFORM 9900-ERROR-FORMAT
 12116                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 221
* EL050.cbl
 12117              END-IF
 12118           END-IF
 12119        END-IF
 12120        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12121           AND ZEROS
 12122           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12123           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12124           SET ELAPSED-BETWEEN-BIN TO TRUE
 12125           PERFORM 8500-DATE-CONVERT
 12126                                 THRU 8500-EXIT
 12127           IF NO-CONVERSION-ERROR
 12128              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12129                 MOVE ER-2669       TO WS-ERROR
 12130*                PERFORM 9900-ERROR-FORMAT
 12131*                                THRU 9900-EXIT
 12132              END-IF
 12133           END-IF
 12134        ELSE
 12135           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12136             (PB-I-LF-TERM / 12)
 12137           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12138              MOVE ER-2669       TO WS-ERROR
 12139*             PERFORM 9900-ERROR-FORMAT
 12140*                                THRU 9900-EXIT
 12141           ELSE
 12142              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12143                 MOVE ER-1571    TO WS-ERROR
 12144                 PERFORM 9900-ERROR-FORMAT
 12145                                 THRU 9900-EXIT
 12146              END-IF
 12147           END-IF
 12148        END-IF
 12149        IF WS-ERROR = ER-2669
 12150           PERFORM 9900-ERROR-FORMAT
 12151                                 THRU 9900-EXIT
 12152        END-IF
 12153     END-IF
 12154     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12155        (PB-I-AH-TERM NOT = ZERO) AND
 12156         NOT NO-AH-COVERAGE
 12157          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12158             AND (PB-COMPANY-ID = 'DCC')
 12159             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12160             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12161          ELSE
 12162             IF WS-LF-EARNINGS-CALC = '4'
 12163                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12164                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12165                PB-I-PAY-FREQUENCY
 12166             ELSE
 12167                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12168                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12169             END-IF
 12170          END-IF
 12171          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12172                                         DC-ODD-DAYS-OVER
 12173          MOVE 1                      TO DC-END-OF-MONTH
 12174          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 222
* EL050.cbl
 12175*         MOVE 6                      TO DC-OPTION-CODE
 12176          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12177          IF NO-CONVERSION-ERROR
 12178             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12179     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12180        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12181        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12182        IF PB-I-BIRTHDAY > LOW-VALUES
 12183           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12184           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12185           SET ELAPSED-BETWEEN-BIN TO TRUE
 12186           PERFORM 8500-DATE-CONVERT
 12187                                 THRU 8500-EXIT
 12188           IF NO-CONVERSION-ERROR
 12189              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12190                 MOVE ER-3054       TO WS-ERROR
 12191*                PERFORM 9900-ERROR-FORMAT
 12192*                                THRU 9900-EXIT
 12193              END-IF
 12194           END-IF
 12195        ELSE
 12196           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12197           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12198              MOVE ER-3054       TO WS-ERROR
 12199*             PERFORM 9900-ERROR-FORMAT
 12200*                                THRU 9900-EXIT
 12201           END-IF
 12202        END-IF
 12203        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12204           AND ZEROS
 12205           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12206           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12207           SET ELAPSED-BETWEEN-BIN TO TRUE
 12208           PERFORM 8500-DATE-CONVERT
 12209                                 THRU 8500-EXIT
 12210           IF NO-CONVERSION-ERROR
 12211              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12212                 MOVE ER-3054       TO WS-ERROR
 12213*                PERFORM 9900-ERROR-FORMAT
 12214*                                THRU 9900-EXIT
 12215              END-IF
 12216           END-IF
 12217        ELSE
 12218           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12219             (PB-I-AH-TERM / 12)
 12220           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12221              MOVE ER-3054       TO WS-ERROR
 12222*             PERFORM 9900-ERROR-FORMAT
 12223*                                THRU 9900-EXIT
 12224           END-IF
 12225        END-IF
 12226        IF WS-ERROR = ER-3054
 12227           PERFORM 9900-ERROR-FORMAT
 12228                                 THRU 9900-EXIT
 12229        END-IF
 12230     END-IF
 12231     MOVE SPACE                       TO DC-END-OF-MONTH.
 12232
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 223
* EL050.cbl
 12233     IF PB-COMPANY-ID = 'NCB'
 12234        GO TO 3040-EDIT-EXTENSION-DAYS.
 12235
 12236     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12237       AND
 12238        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12239        NEXT SENTENCE
 12240     ELSE
 12241        GO TO 3040-EDIT-EXTENSION-DAYS.
 12242
 12243     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12244        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12245        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12246     ELSE
 12247        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12248        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12249
 12250     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12251*    MOVE '1'      TO DC-OPTION-CODE
 12252     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12253     IF (NO-CONVERSION-ERROR)
 12254        AND (DC-ELAPSED-MONTHS > +1)
 12255        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12256        MOVE ER-2668   TO WS-ERROR
 12257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12258
 12259 3040-EDIT-EXTENSION-DAYS.
 12260
 12261     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12262        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12263         GO TO 3050-EDIT-TERM-IN-DAYS
 12264     ELSE
 12265         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12266
 12267     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12268         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12269     ELSE
 12270        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12271           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12272           MOVE ER-2681         TO WS-ERROR
 12273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12274
 12275     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12276        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12277        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12278         GO TO 3060-ORIG-TERM-CHECK.
 12279
 12280     GO TO 3060-ORIG-TERM-CHECK.
 12281
 12282 3050-EDIT-TERM-IN-DAYS.
 12283
 12284     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12285
 12286     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12287         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12288     ELSE
 12289         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12290            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 224
* EL050.cbl
 12291            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12292
 12293     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12294                                       REMAINDER WS-WORK-TERM.
 12295     IF WS-WORK-TERM GREATER THAN ZERO
 12296         ADD +1 TO PB-I-LF-TERM.
 12297
 12298     IF NOT NO-AH-COVERAGE
 12299         MOVE ER-2684            TO WS-ERROR
 12300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12301
 12302
 12303 3060-ORIG-TERM-CHECK.
 12304
 12305******************************************************************
 12306*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12307******************************************************************
 12308
 12309     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12310        NEXT SENTENCE
 12311     ELSE
 12312        IF NOT NO-LIFE-COVERAGE
 12313           IF PB-I-LF-TERM NUMERIC
 12314              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12315              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12316              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12317                  NEXT SENTENCE
 12318           ELSE
 12319              MOVE ER-2647       TO WS-ERROR
 12320              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12321
 12322     IF NOT NO-AH-COVERAGE
 12323         IF PB-I-AH-TERM NUMERIC
 12324            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12325            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12326            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12327             NEXT SENTENCE
 12328          ELSE
 12329              MOVE ER-2658       TO WS-ERROR
 12330              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12331
 12332     IF PB-COMPANY-ID = 'NCB'
 12333        GO TO 3070-LOAN-TERM-CHECK.
 12334
 12335     IF POLICY-HAS-AH
 12336       AND
 12337        POLICY-HAS-LIFE
 12338       AND
 12339        PB-I-LF-TERM NUMERIC
 12340       AND
 12341        PB-I-AH-TERM NUMERIC
 12342        NEXT SENTENCE
 12343     ELSE
 12344        GO TO 3070-LOAN-TERM-CHECK.
 12345
 12346     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12347     IF WS-TEX-FACT-2 LESS THAN +0
 12348        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 225
* EL050.cbl
 12349
 12350     IF WS-TEX-FACT-2 GREATER THAN +1
 12351        MOVE ER-2668             TO WS-ERROR
 12352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12353
 12354 3070-LOAN-TERM-CHECK.
 12355
 12356     IF (WS-LF-BENEFIT-CD = ZERO)
 12357         OR (NO-LF-BENEFIT-MATCH)
 12358            GO TO 3125-EDIT-PMT-FREQ.
 12359*    IF PB-COMPANY-ID NOT = 'DCC'
 12360*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12361*          AND 'V' AND 'W' AND 'X'
 12362*          GO TO 3125-EDIT-PMT-FREQ
 12363*       END-IF
 12364*    ELSE
 12365*       IF WS-AH-DCC-TRUNC = 'T'
 12366*          CONTINUE
 12367*       ELSE
 12368*          GO TO 3125-EDIT-PMT-FREQ
 12369*       END-IF
 12370*    END-IF
 12371     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12372                    OR
 12373        ((PB-COMPANY-ID = 'DCC')
 12374        AND (WS-AH-DCC-TRUNC = 'T'))
 12375        CONTINUE
 12376     ELSE
 12377        GO TO 3125-EDIT-PMT-FREQ
 12378     END-IF
 12379     IF PB-I-LOAN-TERM NOT NUMERIC
 12380         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12381
 12382     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12383        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12384*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12385        PB-I-LOAN-TERM NOT GREATER THAN +360
 12386         NEXT SENTENCE
 12387     ELSE
 12388         MOVE ER-2648            TO WS-ERROR
 12389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12390
 12391     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12392        MOVE ER-3058             TO WS-ERROR
 12393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12394     end-if
 12395
 12396     IF WS-STATE-ABBREVIATION = 'NC'
 12397        IF PB-I-LOAN-TERM > +59
 12398           CONTINUE
 12399        ELSE
 12400           MOVE ER-2792          TO WS-ERROR
 12401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12402        END-IF
 12403     END-IF
 12404
 12405     .
 12406 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 226
* EL050.cbl
 12407     IF (WS-LF-BENEFIT-CD = ZERO)
 12408         OR (NO-LF-BENEFIT-MATCH)
 12409            GO TO 3127-EDIT-LOAN-OFFICER.
 12410     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12411                    OR
 12412        ((PB-COMPANY-ID = 'DCC')
 12413        AND (WS-AH-DCC-TRUNC = 'T'))
 12414                    OR
 12415         (PB-COMPANY-ID = 'AHL')
 12416        CONTINUE
 12417     ELSE
 12418        IF (PB-I-LOAN-TERM > ZEROS)
 12419           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12420           MOVE ER-1575          TO WS-ERROR
 12421           PERFORM 9900-ERROR-FORMAT
 12422                                 THRU 9900-EXIT
 12423        END-IF
 12424     END-IF
 12425     IF WS-LF-EARNINGS-CALC NOT = '4'
 12426         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12427            MOVE ER-2653         TO WS-ERROR
 12428            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12429            GO TO 3127-EDIT-LOAN-OFFICER
 12430         ELSE
 12431            GO TO 3127-EDIT-LOAN-OFFICER.
 12432
 12433     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12434         MOVE ER-2655            TO WS-ERROR
 12435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12436         GO TO 3127-EDIT-LOAN-OFFICER.
 12437
 12438     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12439         MOVE ER-2654            TO WS-ERROR
 12440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12441         GO TO 3127-EDIT-LOAN-OFFICER.
 12442
 12443     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12444         GIVING WS-TEX-FACT-2
 12445             REMAINDER WS-TEX-FACT-3.
 12446
 12447*    IF WS-TEX-FACT-3 NOT = ZERO
 12448*       MOVE ER-2654             TO WS-ERROR
 12449*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12450
 12451
 12452 3127-EDIT-LOAN-OFFICER.
 12453
 12454     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12455        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12456           MOVE ER-2690          TO WS-ERROR
 12457           PERFORM 9900-ERROR-FORMAT
 12458                                 THRU 9900-EXIT
 12459        ELSE
 12460           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12461           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12462           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12463           MOVE PB-SV-STATE      TO LOFC-STATE
 12464           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 227
* EL050.cbl
 12465           MOVE PB-I-LOAN-OFFICER
 12466                                 TO LOFC-CODE
 12467           PERFORM 8586-READ-LOAN-OFFICER
 12468                                 THRU 8586-EXIT
 12469           IF (NOT LOFC-MASTER-FOUND)
 12470              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12471              MOVE ER-3006       TO WS-ERROR
 12472              PERFORM 9900-ERROR-FORMAT
 12473                                 THRU 9900-EXIT
 12474           END-IF
 12475        END-IF
 12476     END-IF
 12477     .
 12478 3129-EDIT-APR.
 12479
 12480     IF (WS-LF-BENEFIT-CD = ZERO)
 12481        OR (NO-LF-BENEFIT-MATCH)
 12482        IF PB-COMPANY-ID NOT = 'DCC'
 12483           GO TO 3130-EDIT-AGE
 12484*       ELSE
 12485*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12486*             GO TO 3130-EDIT-AGE
 12487*          END-IF
 12488        END-IF
 12489     END-IF
 12490
 12491     IF (WS-STATE-ABBREVIATION = 'OH')
 12492         AND (PB-I-RATE-CLASS NOT = 'L ')
 12493         AND (PB-I-LF-TERM GREATER THAN 60)
 12494         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12495         GO TO 3129-APR-CONT.
 12496
 12497     IF (WS-STATE-ABBREVIATION = 'RI')
 12498         AND (PB-I-LF-TERM GREATER THAN 60)
 12499         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12500         GO TO 3129-APR-CONT.
 12501
 12502     IF (WS-STATE-ABBREVIATION = 'UT')
 12503         AND (PB-I-LF-TERM GREATER THAN 62)
 12504         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12505         AND (PB-CERT-EFF-DT LESS WS-830901)
 12506         GO TO 3129-APR-CONT.
 12507
 12508     IF PB-COMPANY-ID = 'LAP'
 12509        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12510           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12511              MOVE ER-2656         TO WS-ERROR
 12512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12513              GO TO 3130-EDIT-AGE.
 12514
 12515     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12516        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12517        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12518        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12519        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12520        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12521         GO TO 3130-EDIT-AGE.
 12522
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 228
* EL050.cbl
 12523 3129-APR-CONT.
 12524     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12525         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12526         GO TO 3130-EDIT-AGE.
 12527
 12528     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12529         WS-AH-BENEFIT-CD (1:1) = 'S')
 12530        AND (PB-COMPANY-ID = 'DCC')
 12531        AND (PB-I-LOAN-APR = ZERO)
 12532        MOVE ER-2657             TO WS-ERROR
 12533        PERFORM 9900-ERROR-FORMAT
 12534                                 THRU 9900-EXIT
 12535        GO TO 3130-EDIT-AGE
 12536     END-IF
 12537*    IF PB-I-LOAN-APR = ZERO
 12538*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12539*    END-IF
 12540
 12541     if pb-i-loan-apr = +99.9999
 12542        move er-2656             to ws-error
 12543        PERFORM 9900-ERROR-FORMAT
 12544                                 THRU 9900-EXIT
 12545        GO TO 3130-EDIT-AGE
 12546     end-if
 12547*    IF PB-I-LOAN-APR = ZERO
 12548*       MOVE ER-2656             TO WS-ERROR
 12549*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12550*       GO TO 3130-EDIT-AGE.
 12551
 12552*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12553     if pb-i-loan-apr not = +99.9999
 12554        IF PB-I-LOAN-APR > +30.000
 12555           MOVE ER-2657          TO WS-ERROR
 12556           PERFORM 9900-ERROR-FORMAT
 12557                                 THRU 9900-EXIT
 12558        end-if
 12559     end-if
 12560     .
 12561 3130-EDIT-AGE.
 12562
 12563******************************************************************
 12564*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12565******************************************************************
 12566
 12567     IF NOT NO-LIFE-COVERAGE
 12568        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12569           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12570               MOVE ER-2628             TO WS-ERROR
 12571               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12572
 12573     IF NOT NO-AH-COVERAGE
 12574        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12575           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12576               MOVE ER-2628         TO WS-ERROR
 12577               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12578
 12579 3133-SEX-CODE.
 12580     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 229
* EL050.cbl
 12581         IF WS-DEFAULT-SEX = 'M'
 12582             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12583          ELSE
 12584             IF WS-DEFAULT-SEX = 'F'
 12585             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12586
 12587     IF PB-I-INSURED-SEX = '1'
 12588         MOVE 'M' TO PB-I-INSURED-SEX.
 12589
 12590     IF PB-I-INSURED-SEX = '2'
 12591         MOVE 'F' TO PB-I-INSURED-SEX.
 12592
 12593 3134-SIG-SW-EDIT.
 12594     IF PB-I-SIG-SW = SPACE
 12595         MOVE 'N'                TO  PB-I-SIG-SW.
 12596
 12597     IF PB-COMPANY-ID = 'NCL'
 12598         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12599             NEXT SENTENCE
 12600         ELSE
 12601             MOVE ER-1923        TO  WS-ERROR
 12602             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12603     ELSE
 12604     IF PB-COMPANY-ID = 'CRI'
 12605         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12606             NEXT SENTENCE
 12607         ELSE
 12608             MOVE ER-2606        TO  WS-ERROR
 12609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12610     ELSE
 12611     IF PB-COMPANY-ID = 'TMS'
 12612         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12613             NEXT SENTENCE
 12614         ELSE
 12615             MOVE ER-2689        TO  WS-ERROR
 12616             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12617     ELSE
 12618         IF PB-I-SIG-SW = 'Y' OR 'N'
 12619             NEXT SENTENCE
 12620         ELSE
 12621             MOVE ER-2651        TO  WS-ERROR
 12622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12623
 12624     IF PB-COMPANY-ID = 'FLA'
 12625         IF (WS-EDIT-AGE GREATER 54  OR
 12626             WS-AH-EDIT-AGE GREATER 54)  AND
 12627            PB-I-SIG-SW = 'N'
 12628            MOVE ER-2651         TO  WS-ERROR
 12629            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12630
 12631 3135-NAME-EDIT.
 12632
 12633     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12634        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12635        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12636           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12637                                 TO PB-I-JOINT-FIRST-NAME
 12638        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 230
* EL050.cbl
 12639     END-IF
 12640     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12641        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12642        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12643           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12644                                 TO PB-I-JOINT-LAST-NAME
 12645        END-PERFORM
 12646     END-IF
 12647     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12648        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12649        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12650           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12651                                 TO PB-I-INSURED-FIRST-NAME
 12652        END-PERFORM
 12653     END-IF
 12654     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12655        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12656        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12657           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12658                                 TO PB-I-INSURED-LAST-NAME
 12659        END-PERFORM
 12660     END-IF
 12661     IF PB-I-INSURED-LAST-NAME = SPACES
 12662       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12663       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12664           MOVE ER-2660    TO WS-ERROR
 12665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12666
 12667 3136-EDIT-SEX.
 12668
 12669******************************************************************
 12670*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12671******************************************************************
 12672
 12673     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12674        (WS-AH-SPECIAL-CALC-CD = 'O')
 12675        NEXT SENTENCE
 12676     ELSE
 12677        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12678           NEXT SENTENCE
 12679        ELSE
 12680           MOVE ER-2629            TO WS-ERROR
 12681           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12682
 12683 3137-EDIT-EFF-DATE.
 12684
 12685     IF PB-REISSUED-CERT       OR
 12686        PB-POLICY-IS-DECLINED  OR
 12687        PB-POLICY-IS-VOIDED
 12688         GO TO 3139-EDIT-COVERAGE-CODES.
 12689
 12690     MOVE SPACE                  TO WS-2671-SW
 12691                                    WS-2672-SW.
 12692
 12693     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12694         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12695             MOVE ER-2703        TO WS-ERROR
 12696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 231
* EL050.cbl
 12697             GO TO 3139-EDIT-COVERAGE-CODES.
 12698
 12699     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12700         GO TO 3139-EDIT-COVERAGE-CODES.
 12701
 12702     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12703     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12704*    MOVE '1'                    TO DC-OPTION-CODE.
 12705     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12706     MOVE +0                     TO DC-ELAPSED-MONTHS
 12707                                    DC-ELAPSED-DAYS.
 12708     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12709
 12710     IF DATE-CONVERSION-ERROR
 12711         GO TO 3139-EDIT-COVERAGE-CODES.
 12712
 12713     IF DC-ELAPSED-DAYS GREATER +180
 12714         MOVE ER-2672            TO WS-ERROR
 12715         MOVE 'Y'                TO WS-2672-SW
 12716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12717     END-IF
 12718
 12719     IF WS-ERROR = ER-2671  AND
 12720        PB-COMPANY-ID  = 'LBL'
 12721        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12722        MOVE SPACE               TO WS-2671-SW
 12723        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12724
 12725     IF PB-ISSUE-DATE-FORCED  AND
 12726      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12727         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12728         MOVE ER-2673            TO WS-ERROR
 12729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12730         MOVE SPACE              TO WS-2671-SW
 12731                                    WS-2672-SW.
 12732
 12733     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12734         IF PB-ISSUE-DATE-FORCED
 12735             MOVE ER-2600          TO  WS-ERROR
 12736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12737         ELSE
 12738             MOVE ER-2692          TO  WS-ERROR
 12739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12740
 12741
 12742 3139-EDIT-COVERAGE-CODES.
 12743
 12744     if pb-company-id not = 'AHL'
 12745        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12746           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12747           MOVE ER-2787          TO WS-ERROR
 12748           PERFORM 9900-ERROR-FORMAT
 12749                                 THRU 9900-EXIT
 12750        END-IF
 12751     end-if
 12752     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12753        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12754                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 232
* EL050.cbl
 12755           MOVE ER-2719          TO WS-ERROR
 12756           PERFORM 9900-ERROR-FORMAT
 12757                                 THRU 9900-EXIT
 12758        END-IF
 12759     END-IF
 12760
 12761     IF PB-POLICY-IS-DECLINED  OR
 12762        PB-POLICY-IS-VOIDED
 12763         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12764
 12765     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12766        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12767         MOVE ER-2630                TO WS-ERROR
 12768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12769
 12770     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12771        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12772        PB-I-LF-PREMIUM-AMT = ZERO
 12773         GO TO 3140-CHECK-AH-FOR-ZERO.
 12774
 12775     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12776        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12777        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12778         GO TO 3140-CHECK-AH-FOR-ZERO.
 12779
 12780     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12781        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12782        MOVE ER-2631             TO WS-ERROR
 12783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12784     END-IF
 12785
 12786
 12787******************************************************************
 12788*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12789******************************************************************
 12790
 12791     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12792        NEXT SENTENCE
 12793     ELSE
 12794        IF PB-I-LF-BENEFIT-AMT = ZERO
 12795           MOVE ER-2632             TO WS-ERROR
 12796           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12797
 12798
 12799******************************************************************
 12800*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12801******************************************************************
 12802
 12803     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12804        CONTINUE
 12805     ELSE
 12806        IF PB-I-LF-PREMIUM-AMT = ZERO
 12807           IF (NOT PB-COMP-LF-PREM)
 12808              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12809              MOVE ER-2633       TO WS-ERROR
 12810              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12811           END-IF
 12812        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 233
* EL050.cbl
 12813     END-IF
 12814     .
 12815 3140-CHECK-AH-FOR-ZERO.
 12816
 12817     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12818        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12819        PB-I-AH-PREMIUM-AMT = ZERO
 12820         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12821
 12822     IF PB-COMPANY-ID = 'CSL'  AND
 12823        PB-I-AH-BENEFIT-CD = ZERO  AND
 12824        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12825        PB-I-AH-PREMIUM-AMT = ZERO
 12826         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12827
 12828     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12829        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12830        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12831         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12832
 12833     IF PB-I-AH-BENEFIT-CD = ZERO
 12834         MOVE ER-2634            TO WS-ERROR
 12835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12836
 12837******************************************************************
 12838*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12839******************************************************************
 12840
 12841     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12842        NEXT SENTENCE
 12843     ELSE
 12844        IF PB-I-AH-BENEFIT-AMT = ZERO
 12845           MOVE ER-2635             TO WS-ERROR
 12846           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12847
 12848******************************************************************
 12849*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12850******************************************************************
 12851
 12852     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12853        NEXT SENTENCE
 12854     ELSE
 12855        IF PB-I-AH-PREMIUM-AMT = ZERO
 12856            IF NOT PB-COMP-AH-PREM
 12857                MOVE ER-2636    TO WS-ERROR
 12858                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12859
 12860
 12861 3140-EDIT-MAX-AMT-SIZES.
 12862* CUSTOM CODE FOR CLIENT    'DMD'
 12863     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12864                                     WS-RES-MUNI-TAX
 12865                                     PB-I-STATE-TAX
 12866                                     PB-I-MUNI-TAX.
 12867
 12868     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12869
 12870     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 234
* EL050.cbl
 12871        GO TO 3150-RATE-OUTSTAND-BAL.
 12872
 12873     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12874        GO TO 3150-RATE-OUTSTAND-BAL.
 12875
 12876     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12877        GO TO 3150-RATE-OUTSTAND-BAL.
 12878
 12879     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12880                             OR 'RIC')
 12881        GO TO 3150-RATE-OUTSTAND-BAL.
 12882
 12883     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12884        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12885            GO TO 3150-RATE-OUTSTAND-BAL
 12886        ELSE
 12887           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12888               GO TO 3150-RATE-OUTSTAND-BAL.
 12889
 12890     IF NOT PB-NO-MONTHS-SKIPPED
 12891        GO TO 3150-RATE-OUTSTAND-BAL.
 12892
 12893     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12894        GO TO 3150-RATE-OUTSTAND-BAL.
 12895
 12896     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12897        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12898           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12899             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12900           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12901           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12902              MOVE ER-2693     TO WS-ERROR
 12903              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12904              GO TO 3150-RATE-OUTSTAND-BAL
 12905           ELSE
 12906              GO TO 3150-RATE-OUTSTAND-BAL.
 12907
 12908 3150-RATE-OUTSTAND-BAL.
 12909
 12910* DMD RATING TEST
 12911     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12912         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12913         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12914         MOVE ER-2687                 TO WS-ERROR
 12915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12916         MOVE 'B'                     TO PB-I-OB-FLAG
 12917         GO TO 3260-EDIT-CONTINUE.
 12918
 12919     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12920         IF  WS-ERROR    EQUAL    ER-2693
 12921             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12922                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12923                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12924                 MOVE  +0            TO  WS-ERROR.
 12925
 12926     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12927         IF  WS-ERROR    EQUAL    ER-2693
 12928             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 235
* EL050.cbl
 12929                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12930                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12931                 MOVE  +0            TO  WS-ERROR.
 12932
 12933     IF PLAN-MASTER-AH-SW = 'Y'
 12934        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12935            IF  WS-ERROR    EQUAL    ER-2693
 12936              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12937                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12938                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12939                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12940                 MOVE  ER-1910           TO  WS-ERROR
 12941                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12942
 12943     IF PLAN-MASTER-AH-SW = 'Y'
 12944        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12945            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12946               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12947               MOVE  ER-1910           TO  WS-ERROR
 12948               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12949
 12950     IF PLAN-MASTER-AH-SW = 'Y'
 12951        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12952            IF  WS-ERROR    EQUAL    ER-2693
 12953                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12954                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12955                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12956                 MOVE  +0       TO  WS-ERROR.
 12957
 12958     IF WS-ERROR = ER-2693
 12959        IF PB-COMPANY-ID = 'JAL' AND
 12960           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12961           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12962           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12963
 12964     IF WS-ERROR = ER-2693
 12965        IF PB-COMPANY-ID = 'NCL'  AND
 12966           PB-I-AH-BENEFIT-CD = 'OA'
 12967           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12968           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12969
 12970     IF WS-ERROR = ER-2693
 12971        IF PB-COMPANY-ID = 'CNL' AND
 12972           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12973           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12974           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12975
 12976     IF WS-ERROR = ER-2693
 12977        IF PB-COMPANY-ID = 'HER'
 12978           IF WS-LEVEL
 12979              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12980              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12981
 12982     IF ((LF-BENEFIT-FOUND) AND
 12983         (NOT NO-LIFE-COVERAGE)  AND
 12984         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12985       OR   ((AH-BENEFIT-FOUND) AND
 12986             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 236
* EL050.cbl
 12987             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12988         NEXT SENTENCE
 12989     ELSE
 12990         GO TO 3215-EDIT-RATES.
 12991
 12992     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12993        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12994           MOVE ER-2674          TO WS-ERROR
 12995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12996           GO TO 3215-EDIT-RATES.
 12997
 12998     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12999        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13000           MOVE ER-2674          TO WS-ERROR
 13001           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13002           GO TO 3215-EDIT-RATES.
 13003
 13004     MOVE 'B'                    TO PB-I-OB-FLAG.
 13005
 13006     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13007         NEXT SENTENCE
 13008     ELSE
 13009         IF NOT NO-LIFE-COVERAGE
 13010             IF WS-ACCT-LF-OB-RT = ZERO
 13011                MOVE ER-2641    TO WS-ERROR
 13012                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13013
 13014     IF PB-COMPANY-ID = 'CRI'
 13015       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13016         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13017         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13018         IF WS-ERROR = ER-2675
 13019            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13020            MOVE ER-2687              TO WS-ERROR
 13021            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13022         ELSE
 13023            MOVE ER-2687              TO WS-ERROR
 13024            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13025
 13026
 13027     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13028         NEXT SENTENCE
 13029     ELSE
 13030       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13031            NEXT SENTENCE
 13032       ELSE
 13033         IF NOT NO-AH-COVERAGE
 13034             IF WS-ACCT-AH-OB-RT = ZERO
 13035                MOVE ER-2642    TO WS-ERROR
 13036                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13037
 13038     IF PB-COMPANY-ID = 'CRI'
 13039       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13040         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13041         IF WS-ERROR = ER-2676
 13042            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13043            MOVE ER-2687              TO WS-ERROR
 13044            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 237
* EL050.cbl
 13045         ELSE
 13046            MOVE ER-2687              TO WS-ERROR
 13047            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13048
 13049     IF PB-COMPANY-ID NOT = 'GIC'
 13050         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13051            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13052     ELSE
 13053         IF PB-I-LF-PREM-CALC = ZEROS
 13054             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13055                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13056
 13057     IF PB-COMPANY-ID NOT = 'GIC'
 13058         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13059            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13060     ELSE
 13061         IF PB-I-AH-PREM-CALC = ZEROS
 13062             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13063                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13064
 13065     MOVE ZEROS TO PB-I-MORT-CODE.
 13066
 13067     GO TO 3260-EDIT-CONTINUE.
 13068
 13069
 13070 3215-EDIT-RATES.
 13071     IF ACCOUNT-MAST-FOUND
 13072         NEXT SENTENCE
 13073     ELSE
 13074         GO TO 3999-END-EDIT.
 13075
 13076 3220-CHECK-LF-RATES.
 13077
 13078     IF PB-COMPANY-ID = 'DCC'
 13079        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13080        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13081        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13082           AND (NOT WS-LF-CASH))
 13083                           OR
 13084           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13085           AND (NOT WS-AH-CASH)))
 13086                       AND
 13087           (PB-I-ENTRY-STATUS NOT = '5')
 13088           MOVE 'M'              TO PB-BATCH-ENTRY
 13089                                    PB-I-ENTRY-STATUS
 13090        END-IF
 13091     END-IF
 13092     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13093                                    PB-I-AH-PREM-CALC
 13094                                    PB-I-LF-ALT-PREM-CALC
 13095                                    PB-I-LF-ALT-RATE
 13096                                    PB-I-LF-REI-RATE
 13097                                    PB-I-LF-ALT-REI-RATE
 13098                                    PB-I-AH-REI-RATE
 13099                                    PB-I-TOT-FEES-CALC.
 13100
 13101     IF PB-COMPANY-ID EQUAL 'DMD'
 13102        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 238
* EL050.cbl
 13103     ELSE
 13104        MOVE ZEROS               TO PB-I-LF-RATE
 13105                                    PB-I-AH-RATE.
 13106
 13107     IF PB-I-TOT-FEES NOT NUMERIC
 13108        MOVE ZEROS               TO PB-I-TOT-FEES
 13109     END-IF
 13110     IF PB-I-LIVES NOT NUMERIC
 13111         MOVE ZERO               TO PB-I-LIVES.
 13112
 13113     IF PB-I-NUM-BILLED NOT NUMERIC
 13114         MOVE ZERO               TO PB-I-NUM-BILLED.
 13115
 13116     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13117        MOVE +0                  TO PB-I-LF-PREM-TAX
 13118     END-IF
 13119
 13120     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13121        MOVE +0                  TO PB-I-AH-PREM-TAX
 13122     END-IF
 13123
 13124     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13125        PB-I-PAY-FREQUENCY = ZEROS
 13126            MOVE 12 TO CP-PAY-FREQUENCY
 13127     ELSE
 13128            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13129
 13130     IF PB-I-STATE-TAX NOT NUMERIC
 13131         MOVE ZEROS               TO PB-I-STATE-TAX.
 13132
 13133     IF PB-I-MUNI-TAX NOT NUMERIC
 13134         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13135
 13136     MOVE SPACES                 TO CP-BEN-CATEGORY
 13137     IF PB-COMPANY-ID  = 'CSL'  AND
 13138        PB-I-LF-TERM NOT = ZERO
 13139        COMPUTE WS-PAYMENT-AMT =
 13140             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13141        COMPUTE WS-CSL-AMT1 =
 13142             PB-I-LF-TERM * AM-MAX-MON-BEN
 13143        COMPUTE WS-CSL-AMT2 =
 13144             WS-PAYMENT-AMT * PB-I-LF-TERM
 13145        IF CP-PAY-FREQUENCY NOT = 12
 13146           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13147           MOVE '8' TO WS-CSL-CALC-CD
 13148        ELSE
 13149           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13150              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13151               AM-MAX-TOT-BEN
 13152               MOVE '6' TO WS-CSL-CALC-CD
 13153           ELSE
 13154              IF (WS-CSL-AMT1  GREATER THAN
 13155                 AM-MAX-TOT-BEN) AND
 13156                 (WS-CSL-AMT2  GREATER THAN
 13157                 AM-MAX-TOT-BEN)
 13158                 MOVE '7' TO WS-CSL-CALC-CD
 13159              ELSE
 13160                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 239
* EL050.cbl
 13161
 13162     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13163         NEXT SENTENCE
 13164     ELSE
 13165         GO TO 3300-CHECK-AH-RATES.
 13166
 13167*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13168
 13169     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13170        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13171              OR
 13172           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13173           MOVE ER-2618          TO WS-ERROR
 13174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13175           GO TO 3300-CHECK-AH-RATES.
 13176
 13177     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13178           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13179                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13180
 13181     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13182         MOVE ER-2687             TO WS-ERROR
 13183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13184         MOVE 'Z000'              TO PB-I-MORT-CODE
 13185         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13186         GO TO 3300-CHECK-AH-RATES.
 13187
 13188     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13189        IF PB-I-LIVES = ZERO
 13190           MOVE ER-2688          TO WS-ERROR
 13191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13192
 13193     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13194
 13195     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13196     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13197     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13198     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13199     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13200     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13201     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13202     MOVE '3'                    TO CP-PROCESS-TYPE.
 13203     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13204     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13205
 13206******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13207     IF PB-COMPANY-ID EQUAL 'CDL'
 13208         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13209            CP-EARN-AS-NET-PAY)
 13210             IF PB-CERT-EFF-DT GREATER  WS-931231
 13211                 MOVE '1'        TO CP-EARNING-METHOD.
 13212*******
 13213
 13214     MOVE PB-SV-STATE            TO CP-STATE.
 13215     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13216     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13217     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13218     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 240
* EL050.cbl
 13219     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13220                                    CP-RATING-BENEFIT-AMT.
 13221     IF CP-STATE-STD-ABBRV = 'OR'
 13222         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13223                                         PB-I-LF-ALT-BENEFIT-AMT.
 13224     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13225     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13226     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13227     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13228     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13229     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13230     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13231     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13232     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13233                                    CP-REMAINING-TERM
 13234                                    CP-LOAN-TERM.
 13235
 13236     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13237         NEXT SENTENCE
 13238     ELSE
 13239         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13240             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13241                                           PB-I-LF-PREMIUM-AMT.
 13242
 13243     IF PB-COMPANY-ID EQUAL 'CSL'
 13244        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13245           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13246                                         PB-I-LF-PREMIUM-AMT.
 13247
 13248     IF PB-COMPANY-ID EQUAL 'NCB'
 13249         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13250            CP-EARN-AS-NET-PAY
 13251             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13252                 PB-I-LF-PREMIUM-AMT.
 13253
 13254     IF (CP-TRUNCATED-LIFE)
 13255        or ((pb-company-id = 'AHL')
 13256           and (pb-i-loan-term > pb-i-lf-term))
 13257        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13258
 13259     IF PB-COMPANY-ID EQUAL 'CRI'
 13260        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13261
 13262     IF CP-TERM-IS-DAYS
 13263         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13264     ELSE
 13265         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13266     IF PB-COMPANY-ID = 'DCC'
 13267        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13268        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13269        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13270        IF WS-LF-BEN-CATEGORY = 'D'
 13271           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13272           MOVE PB-I-LIFE-COMMISSION
 13273                                 TO CP-DCC-ACT-COMM
 13274           MOVE WS-LF-BEN-CATEGORY
 13275                                 TO CP-BEN-CATEGORY
 13276        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 241
* EL050.cbl
 13277        IF (CP-BENEFIT-CD (1:1) = 'P')
 13278           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13279           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13280           add pb-i-ah-premium-amt to cp-original-premium
 13281        END-IF
 13282     END-IF
 13283     IF PB-COMPANY-ID = 'CSL'
 13284         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13285         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13286         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13287
 13288     IF PB-COMPANY-ID = 'CSL'
 13289        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13290
 13291     IF (CP-SPECIAL-CALC-CD = 'H')
 13292        OR (PB-COMPANY-ID = 'DCC')
 13293         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13294                                    TO CP-ALTERNATE-BENEFIT
 13295         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13296
 13297     IF (PB-COMPANY-ID = 'CID')
 13298        AND (WS-LF-EARNINGS-CALC = 'B')
 13299        AND (CP-STATE-STD-ABBRV = 'MN')
 13300        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13301                                 TO CP-ALTERNATE-BENEFIT
 13302        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13303     END-IF
 13304     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13305     MOVE 'R'                   TO CP-RATE-FILE.
 13306     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13307
 13308     IF CP-ERROR-RATE-NOT-FOUND
 13309        MOVE ER-2641            TO WS-ERROR
 13310        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13311        GO TO 3300-CHECK-AH-RATES.
 13312
 13313     IF PB-COMPANY-ID EQUAL 'CRI'
 13314        IF CP-ERROR-NO-LIMITS-CRI
 13315           IF NOT ACCOUNT-LIFE-CHECKED
 13316              MOVE ER-2607      TO WS-ERROR
 13317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13318
 13319******************************************************************
 13320*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13321*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13322******************************************************************
 13323
 13324* CALC LIFE AGE AT EXPIRATION.
 13325
 13326     COMPUTE WS-AGE-AT-EXPIRE =
 13327          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13328
 13329*    IF PB-STATE = 'CO' OR 'UT'
 13330*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13331*        MOVE 'F'            TO PB-FATAL-FLAG
 13332*        MOVE ER-2709        TO WS-ERROR
 13333*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13334*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 242
* EL050.cbl
 13335
 13336*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13337*        MOVE 'X'            TO PB-FATAL-FLAG
 13338*        MOVE ER-2718        TO WS-ERROR
 13339*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13340*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13341
 13342* CALC A & H AGE AT EXPIRATION.
 13343
 13344     COMPUTE WS-AGE-AT-EXPIRE =
 13345          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13346
 13347*    IF PB-STATE = 'CO' OR 'UT'
 13348*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13349*        MOVE 'F'            TO PB-FATAL-FLAG
 13350*        MOVE ER-2709        TO WS-ERROR
 13351*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13352*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13353
 13354*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13355*        MOVE 'X'            TO PB-FATAL-FLAG
 13356*        MOVE ER-2718        TO WS-ERROR
 13357*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13358*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13359
 13360     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13361        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13362
 13363     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13364        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13365     end-if
 13366
 13367     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13368        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13369
 13370     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13371         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13372         MOVE ER-2639        TO WS-ERROR
 13373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13374
 13375
 13376******************************************************************
 13377*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13378******************************************************************
 13379
 13380 PREMIUM-EDITING-IS-BYPASSED.
 13381     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13382        AND (CP-R-MAX-ATT-AGE > +0)
 13383        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13384        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13385           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13386           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13387           MOVE '1'              TO DC-OPTION-CODE
 13388           PERFORM 8500-DATE-CONVERT
 13389                                 THRU 8500-EXIT
 13390           IF NO-CONVERSION-ERROR
 13391              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13392                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 243
* EL050.cbl
 13393*                PERFORM 9900-ERROR-FORMAT
 13394*                                THRU 9900-EXIT
 13395              END-IF
 13396           END-IF
 13397        ELSE
 13398           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13399           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13400              MOVE ER-2661       TO WS-ERROR
 13401*             PERFORM 9900-ERROR-FORMAT
 13402*                                THRU 9900-EXIT
 13403           ELSE
 13404              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13405                 MOVE ER-1570    TO WS-ERROR
 13406                 PERFORM 9900-ERROR-FORMAT
 13407                                 THRU 9900-EXIT
 13408              END-IF
 13409           END-IF
 13410        END-IF
 13411        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13412           MOVE PB-I-JOINT-BIRTHDAY
 13413                                 TO DC-BIN-DATE-1
 13414           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13415           MOVE '1'              TO DC-OPTION-CODE
 13416           PERFORM 8500-DATE-CONVERT
 13417                                 THRU 8500-EXIT
 13418           IF NO-CONVERSION-ERROR
 13419              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13420                 MOVE ER-2661       TO WS-ERROR
 13421*                PERFORM 9900-ERROR-FORMAT
 13422*                                THRU 9900-EXIT
 13423              END-IF
 13424           ELSE
 13425              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13426           END-IF
 13427        ELSE
 13428           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13429             (PB-I-LF-TERM / 12)
 13430           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13431              MOVE ER-2661       TO WS-ERROR
 13432*             PERFORM 9900-ERROR-FORMAT
 13433*                                THRU 9900-EXIT
 13434           ELSE
 13435              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13436                 MOVE ER-1571    TO WS-ERROR
 13437                 PERFORM 9900-ERROR-FORMAT
 13438                                 THRU 9900-EXIT
 13439              END-IF
 13440           END-IF
 13441        END-IF
 13442        IF WS-ERROR = ER-2661
 13443           PERFORM 9900-ERROR-FORMAT
 13444                                 THRU 9900-EXIT
 13445        END-IF
 13446     END-IF
 13447*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13448*       MOVE ER-2661             TO WS-ERROR
 13449*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13450
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 244
* EL050.cbl
 13451     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13452        MOVE ER-2662             TO WS-ERROR
 13453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13454
 13455     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13456        MOVE ER-2677             TO WS-ERROR
 13457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13458
 13459     IF CP-ERROR-LOAN-TERM
 13460        MOVE ER-2648             TO WS-ERROR
 13461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13462
 13463 3221-CHECK-ERROR-RATE-OPEN.
 13464
 13465     IF CP-ERROR-RATE-FILE-NOTOPEN
 13466         GO TO 3990-FILES-NOT-OPEN.
 13467
 13468     IF PB-COMPANY-ID NOT = 'DMD'
 13469        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13470     END-IF
 13471     .
 13472 3221-CONTINUE.
 13473     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13474                                    WS-DCC-AH-RATE
 13475     IF PB-COMPANY-ID = 'DCC'
 13476        IF WS-LF-BEN-CATEGORY = 'D'
 13477           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13478              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13479        END-IF
 13480     END-IF
 13481     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13482*   X'A4FF' = 12/31/2009
 13483     IF (PB-COMPANY-ID = 'CID')
 13484        AND (WS-LF-EARNINGS-CALC = 'B')
 13485        AND (CP-STATE-STD-ABBRV = 'MN')
 13486        AND (PB-CERT-EFF-DT > X'A4FF')
 13487        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13488     END-IF
 13489     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13490
 13491     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13492     IF (PB-COMPANY-ID = 'DCC')
 13493        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13494        AND (PB-I-POLICY-IS-MONTHLY)
 13495        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13496        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13497     END-IF
 13498     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13499     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13500     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13501     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13502     IF (PB-COMPANY-ID = 'DCC')
 13503        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13504        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13505        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13506        MOVE ER-2786             TO WS-ERROR
 13507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13508     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 245
* EL050.cbl
 13509
 13510     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13511
 13512******************************************************************
 13513*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13514******************************************************************
 13515     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13516        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13517
 13518     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13519        GO TO 3225-CHECK-ALT-LIFE-RATE
 13520     ELSE
 13521       IF PB-I-LF-RATE = ZERO
 13522          MOVE ER-2641          TO WS-ERROR
 13523          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13524
 13525 3225-CHECK-ALT-LIFE-RATE.
 13526
 13527     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13528        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13529        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13530         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13531
 13532     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13533         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13534             AND PB-COMPANY-ID NOT = 'DCC')
 13535                   OR
 13536              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13537              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13538              AND PB-COMPANY-ID NOT = 'DCC')
 13539             MOVE ER-2720        TO  WS-ERROR
 13540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13541             GO TO 3225-RATING-CONT
 13542         ELSE
 13543             GO TO 3225-RATING-CONT.
 13544     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13545        AND (AM-GPCD = 01 OR 06 OR 15)
 13546        MOVE ER-2798             TO WS-ERROR
 13547        PERFORM 9900-ERROR-FORMAT
 13548                                 THRU 9900-EXIT
 13549*       GO TO 3225-RATING-CONT
 13550     END-IF
 13551     IF (PB-COMPANY-ID = 'CID')
 13552        AND (WS-LF-EARNINGS-CALC = 'B')
 13553        AND (CP-STATE-STD-ABBRV = 'MN')
 13554        AND (PB-CERT-EFF-DT > X'A4FF')
 13555        GO TO 3225-RATING-CONT
 13556     END-IF
 13557     IF PB-COMPANY-ID = 'DCC'
 13558        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13559           AND (PB-I-POLICY-IS-MONTHLY)
 13560           GO TO 3225-RATING-CONT
 13561        END-IF
 13562     END-IF
 13563
 13564     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13565        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13566        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 246
* EL050.cbl
 13567        NEXT SENTENCE
 13568     ELSE
 13569        MOVE '2'                 TO CP-EARNING-METHOD.
 13570
 13571 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13572
 13573     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13574
 13575     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13576        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13577        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13578         NEXT SENTENCE
 13579     ELSE
 13580         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13581
 13582     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13583     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13584     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13585                                     CP-RATING-BENEFIT-AMT.
 13586     IF CP-STATE-STD-ABBRV = 'OR'
 13587         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13588                                         PB-I-LF-ALT-BENEFIT-AMT.
 13589     IF PB-COMPANY-ID = 'DCC'
 13590        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13591     END-IF
 13592     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13593     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13594     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13595                                    CP-REMAINING-TERM
 13596                                    CP-LOAN-TERM.
 13597     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13598        ADD +1                   TO CP-ORIGINAL-TERM
 13599                                    CP-REMAINING-TERM
 13600                                    CP-LOAN-TERM.
 13601
 13602     MOVE 'R'                   TO CP-RATE-FILE.
 13603     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13604
 13605     IF CP-ERROR-RATE-NOT-FOUND
 13606         MOVE ER-2641            TO WS-ERROR
 13607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13608         GO TO 3300-CHECK-AH-RATES.
 13609
 13610     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13611     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13612
 13613     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13614         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13615
 13616     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13617                               + PB-I-LF-ALT-BENEFIT-AMT.
 13618
 13619     IF ACCOUNT-LIFE-CHECKED  OR
 13620        PB-POLICY-IS-VOIDED   OR
 13621        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13622        GO TO 3225-CONTINUE.
 13623
 13624     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 247
* EL050.cbl
 13625        GO TO 3225-CONTINUE.
 13626
 13627     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13628                             EC-RT-LF-MAX-TOT-BEN
 13629        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13630        MOVE ER-2639       TO WS-ERROR
 13631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633 3225-CONTINUE.
 13634     IF PB-I-LF-ALT-RATE = ZERO
 13635         MOVE ER-2659            TO WS-ERROR
 13636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13639        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13640        MOVE ER-2698             TO WS-ERROR
 13641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13642
 13643 3225-RATING-CONT.
 13644
 13645     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13646         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13647         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13648         IF (PB-COMPANY-ID = 'DCC')
 13649            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13650            CONTINUE
 13651         ELSE
 13652            MOVE ER-2687         TO WS-ERROR
 13653            PERFORM 9900-ERROR-FORMAT
 13654                                 THRU 9900-EXIT
 13655         END-IF
 13656         GO TO 3290-EDIT-LF-REIN-RATE
 13657     END-IF
 13658
 13659* DMD RATING TEST
 13660     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13661         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13662         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13663         MOVE ER-2687                 TO WS-ERROR
 13664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13665         GO TO 3290-EDIT-LF-REIN-RATE.
 13666
 13667 3230-CLIENT-MORT-CD-SPECIALS.
 13668
 13669     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13670     SET BIN-TO-GREG          TO TRUE.
 13671*    MOVE ' '                 TO DC-OPTION-CODE.
 13672     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13673     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13674
 13675 C-POS-3230-MORT-CD.
 13676     IF PB-COMPANY-ID = 'POS' AND
 13677        PB-SV-CARRIER = '2'
 13678         NEXT SENTENCE
 13679     ELSE
 13680         GO TO C-POS-3240-MORT-CD.
 13681
 13682     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 248
* EL050.cbl
 13683        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13684         MOVE '2350' TO PB-I-MORT-CODE
 13685      ELSE
 13686         MOVE '3300' TO PB-I-MORT-CODE.
 13687
 13688
 13689 C-POS-3240-MORT-CD.
 13690     IF PB-COMPANY-ID = 'POS' AND
 13691        PB-SV-CARRIER = '1'
 13692         NEXT SENTENCE
 13693     ELSE
 13694         GO TO 3230-CONTINUE.
 13695
 13696     IF PB-SV-STATE = '45' OR '47'
 13697        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13698         MOVE '5200' TO PB-I-MORT-CODE
 13699     ELSE
 13700         MOVE '8300' TO PB-I-MORT-CODE.
 13701
 13702 3230-CONTINUE.
 13703
 13704     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13705        GO TO 3240-CONTINUE
 13706     END-IF
 13707
 13708     IF PB-CERT-EFF-DT > WS-971231
 13709        GO TO 3240-CONTINUE
 13710     END-IF
 13711
 13712     IF LF-BENEFIT-FOUND AND
 13713        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13714         MOVE 'F250'       TO PB-I-MORT-CODE
 13715     ELSE
 13716         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13717             MOVE '7250'   TO PB-I-MORT-CODE
 13718         ELSE
 13719             MOVE '4251'   TO PB-I-MORT-CODE
 13720         END-IF
 13721     END-IF
 13722
 13723     .
 13724 3240-CONTINUE.
 13725
 13726     IF PB-COMPANY-ID NOT = 'GNL'
 13727         GO TO 3256-CONTINUE.
 13728
 13729     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13730         MOVE 'A300' TO PB-I-MORT-CODE
 13731     ELSE
 13732         MOVE '8350' TO PB-I-MORT-CODE.
 13733
 13734 3256-CONTINUE.
 13735     IF PB-COMPANY-ID NOT = 'ABL'
 13736         GO TO 3260-EDIT-CONTINUE.
 13737
 13738     IF PB-I-LF-TERM GREATER THAN 59
 13739         MOVE 'F550' TO PB-I-MORT-CODE
 13740     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 249
* EL050.cbl
 13741         MOVE 'E550' TO PB-I-MORT-CODE.
 13742
 13743 3260-EDIT-CONTINUE.
 13744     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13745
 13746 3290-EDIT-LF-REIN-RATE.
 13747     IF LF-REIN-NSP-NOT-USED
 13748         GO TO 3290-RATING-CONT.
 13749
 13750     IF PB-COMPANY-ID = 'DCC'
 13751        GO TO 3290-RATING-CONT.
 13752     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13753     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13754     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13755     MOVE '3'                   TO CP-PROCESS-TYPE.
 13756     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13757
 13758******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13759     IF PB-COMPANY-ID EQUAL 'CDL'
 13760         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13761            CP-EARN-AS-NET-PAY)
 13762             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13763*            MOVE SPACE          TO DC-OPTION-CODE
 13764             SET BIN-TO-GREG     TO TRUE
 13765             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13766***  Y2K PROJ 7744
 13767             IF DC-GREG-DATE-CYMD GREATER 19931231
 13768                 MOVE '1'        TO CP-EARNING-METHOD.
 13769***  Y2K PROJ 7744
 13770*******
 13771
 13772     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13773     MOVE PB-SV-STATE           TO CP-STATE.
 13774     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13775     MOVE ZERO                  TO CP-DEVIATION-CODE
 13776                                   CP-RATE-DEV-PCT.
 13777     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13778     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13779                                   CP-RATING-BENEFIT-AMT.
 13780
 13781************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13782     IF PB-COMPANY-ID EQUAL 'NCB'
 13783         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13784            CP-EARN-AS-NET-PAY
 13785             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13786                 PB-I-LF-PREMIUM-AMT.
 13787************
 13788
 13789     IF CP-STATE-STD-ABBRV = 'OR'
 13790         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13791                                         PB-I-LF-ALT-BENEFIT-AMT.
 13792     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13793     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13794     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13795     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13796     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13797     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13798     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 250
* EL050.cbl
 13799     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13800                                   CP-REMAINING-TERM
 13801                                   CP-LOAN-TERM.
 13802     IF CP-TRUNCATED-LIFE
 13803        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13804
 13805     IF CP-TERM-IS-DAYS
 13806         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13807     ELSE
 13808         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13809
 13810     IF PB-COMPANY-ID = 'DCC'
 13811        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13812     END-IF
 13813     IF PB-COMPANY-ID NOT = 'TIC'
 13814          MOVE ZERO          TO CP-CLASS-CODE.
 13815
 13816     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13817
 13818     MOVE 'R'                   TO CP-RATE-FILE.
 13819     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13820
 13821     IF CP-ERROR-RATE-NOT-FOUND
 13822        IF PB-I-OB
 13823           MOVE ER-2625      TO WS-ERROR
 13824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13825           GO TO 3299-EDIT-CONTINUE
 13826        ELSE
 13827           MOVE ER-2643      TO WS-ERROR
 13828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829           GO TO 3299-EDIT-CONTINUE.
 13830
 13831     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13832
 13833     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13834     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13835
 13836     IF PB-I-LF-REI-RATE = ZERO
 13837         MOVE ER-2643        TO WS-ERROR
 13838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13839
 13840 3290-CHECK-ALT-REIN-RATE.
 13841
 13842     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13843        GO TO 3290-RATING-CONT.
 13844
 13845     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13846     MOVE '2'                    TO CP-EARNING-METHOD.
 13847     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13848     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13849     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13850     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13851                                     CP-RATING-BENEFIT-AMT.
 13852     IF CP-STATE-STD-ABBRV = 'OR'
 13853         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13854                                         PB-I-LF-ALT-BENEFIT-AMT.
 13855     IF PB-COMPANY-ID = 'DCC'
 13856        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 251
* EL050.cbl
 13857     END-IF
 13858     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13859     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13860     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13861                                    CP-REMAINING-TERM
 13862                                    CP-LOAN-TERM.
 13863     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13864        ADD +1                   TO CP-ORIGINAL-TERM
 13865                                    CP-REMAINING-TERM
 13866                                    CP-LOAN-TERM.
 13867
 13868     MOVE 'R'                   TO CP-RATE-FILE.
 13869     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13870
 13871     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13872
 13873     IF PB-I-LF-ALT-REI-RATE = ZERO
 13874         MOVE ER-2643            TO WS-ERROR
 13875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13876
 13877 3290-RATING-CONT.
 13878
 13879     IF PB-I-OB
 13880*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13881        GO TO 3300-CHECK-AH-RATES.
 13882
 13883 3299-EDIT-CONTINUE.
 13884
 13885     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13886         NEXT SENTENCE
 13887     ELSE
 13888         MOVE ER-2620           TO WS-ERROR
 13889         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13890
 13891 3300-CHECK-AH-RATES.
 13892     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13893         NEXT SENTENCE
 13894     ELSE
 13895         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13896
 13897     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13898        ((CF-COMPANY-ID = 'DMD') AND
 13899                (NO-DMD-RATING))
 13900         IF (PB-COMPANY-ID = 'DCC')
 13901            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13902            CONTINUE
 13903         ELSE
 13904            MOVE ER-2687         TO WS-ERROR
 13905            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13906         END-IF
 13907         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13908         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13909     END-IF
 13910
 13911     IF PB-I-OB
 13912        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13913
 13914     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 252
* EL050.cbl
 13915         MOVE ER-2687             TO WS-ERROR
 13916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13917         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13918         GO TO 3999-END-EDIT.
 13919
 13920*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13921     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13922        IF PB-I-AH-CRIT-PER = ZERO
 13923           IF PB-COMPANY-ID = 'DCC'
 13924              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13925              CONTINUE
 13926           ELSE
 13927              MOVE ER-2618       TO WS-ERROR
 13928              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13929              GO TO 3999-END-EDIT
 13930           END-IF
 13931        END-IF
 13932     END-IF
 13933     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13934     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13935     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13936     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13937     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13938     MOVE PB-SV-STATE            TO CP-STATE.
 13939     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13940     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13941     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13942*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13943     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13944     MOVE '3'                    TO CP-PROCESS-TYPE.
 13945     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13946     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13947                                    CP-RATING-BENEFIT-AMT.
 13948     IF PB-COMPANY-ID = 'CID'
 13949               OR
 13950        CP-STATE-STD-ABBRV = 'OR'
 13951         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13952                                         PB-I-AH-TERM.
 13953     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13954        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13955           AND (PB-I-POLICY-IS-MONTHLY)
 13956           MOVE PB-I-LF-BENEFIT-AMT
 13957                                 TO CP-NET-BENEFIT-AMT
 13958           move pb-i-ah-premium-amt to cp-original-premium
 13959           add pb-i-lf-premium-amt to cp-original-premium
 13960        END-IF
 13961     END-IF
 13962     MOVE SPACES                 TO CP-BEN-CATEGORY
 13963     IF PB-COMPANY-ID = 'DCC'
 13964        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13965        EVALUATE TRUE
 13966           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13967              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13968              MOVE PB-I-LF-BENEFIT-AMT
 13969                                 TO CP-RATING-BENEFIT-AMT
 13970              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13971           WHEN WS-AH-BEN-CATEGORY = 'G'
 13972              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 253
* EL050.cbl
 13973                                 TO CP-RATING-BENEFIT-AMT
 13974           WHEN WS-AH-BEN-CATEGORY = 'D'
 13975              MOVE WS-AH-PMF-COMM
 13976                                 TO CP-DCC-PMF-COMM
 13977              MOVE PB-I-AH-COMMISSION
 13978                                 TO CP-DCC-ACT-COMM
 13979        END-EVALUATE
 13980     END-IF
 13981     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13982     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13983     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13984     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13985     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13986     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13987     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13988                                    CP-REMAINING-TERM
 13989                                    WS-WORK-TERM.
 13990     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13991
 13992     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13993     SET BIN-TO-GREG             TO TRUE.
 13994*    MOVE ' '                    TO DC-OPTION-CODE.
 13995     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13996     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13997
 13998     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13999     IF NOT VALID-SKIP-CODE
 14000         MOVE ER-2683            TO WS-ERROR
 14001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14002         GO TO 3320-RATE-CONTINUE.
 14003
 14004     IF PB-NO-MONTHS-SKIPPED
 14005         GO TO 3320-RATE-CONTINUE.
 14006
 14007     MOVE SPACE TO NUMBER-OF-MONTHS.
 14008
 14009     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14010         MOVE 'S'                TO SK-MO (6).
 14011     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14012         MOVE 'S'                TO SK-MO (7).
 14013     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14014         MOVE 'S'                TO SK-MO (8).
 14015     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14016         MOVE 'S'                TO SK-MO (9).
 14017     IF PB-I-SKIP-CODE = 'A'
 14018         MOVE 'S'                TO SK-MO (10).
 14019
 14020     MOVE 1                      TO SUB2.
 14021     MOVE PB-I-AH-TERM           TO SUB3.
 14022     MOVE WS-MONTH               TO SUB1.
 14023     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14024     GO TO 3320-RATE-CONTINUE.
 14025
 14026 3310-GET-SKIP-MO.
 14027     IF SUB1 = 13
 14028         MOVE 1                  TO SUB1.
 14029
 14030     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 254
* EL050.cbl
 14031         SUBTRACT 1 FROM WS-WORK-TERM.
 14032
 14033     ADD 1 TO SUB2
 14034              SUB1.
 14035
 14036 3320-RATE-CONTINUE.
 14037
 14038     IF WS-WORK-TERM = ZERO
 14039         MOVE 1                  TO WS-WORK-TERM.
 14040
 14041     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14042                                    CP-LOAN-TERM.
 14043
 14044     IF PB-COMPANY-ID EQUAL 'DMD'
 14045         NEXT SENTENCE
 14046     ELSE
 14047         MOVE ZERO               TO PB-I-AH-RATE
 14048                                    PB-I-AH-REI-RATE.
 14049
 14050
 14051     IF PB-COMPANY-ID EQUAL 'CRI'
 14052        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14053
 14054     IF PB-COMPANY-ID = 'CSL'
 14055         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14056         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14057         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14058         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14059
 14060     IF PB-COMPANY-ID = 'DCC'
 14061        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14062           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14063              PB-I-RATE-DEV-PCT-LF
 14064        END-IF
 14065        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14066                                 TO CP-ALTERNATE-BENEFIT
 14067        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14068        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14069        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14070     END-IF
 14071     IF (PB-COMPANY-ID = 'CID')
 14072        AND (WS-LF-EARNINGS-CALC = 'B')
 14073        AND (CP-STATE-STD-ABBRV = 'MN')
 14074        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14075     ELSE
 14076        MOVE ' '                 TO CP-AH-BALLOON-SW
 14077     END-IF
 14078     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14079     MOVE 'R'                   TO CP-RATE-FILE.
 14080     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14081
 14082     IF CP-ERROR-RATE-NOT-FOUND
 14083        IF PB-I-OB
 14084           MOVE ER-2624          TO WS-ERROR
 14085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14086           GO TO 3340-CALCULATE-PREMIUM-AMT
 14087        ELSE
 14088          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 255
* EL050.cbl
 14089              NEXT SENTENCE
 14090          ELSE
 14091           MOVE ER-2642          TO WS-ERROR
 14092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14093           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14094
 14095     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14096        CP-ERROR-DIV-BY-ZERO
 14097           MOVE ER-3782          TO WS-ERROR
 14098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
 14100     IF PB-COMPANY-ID EQUAL 'CRI'
 14101        IF CP-ERROR-NO-LIMITS-CRI
 14102           IF NOT ACCOUNT-AH-CHECKED
 14103              MOVE ER-2607          TO WS-ERROR
 14104              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14105
 14106     IF ACCOUNT-AH-CHECKED
 14107        NEXT SENTENCE
 14108     ELSE
 14109       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14110          MOVE ER-2640           TO WS-ERROR
 14111          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14112
 14113     IF PB-COMPANY-ID = 'CRI'
 14114         IF WS-ERROR = ER-2640
 14115             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14116     IF ACCOUNT-AH-CHECKED
 14117        CONTINUE
 14118     ELSE
 14119        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14120           AND (CP-R-MAX-ATT-AGE > +0)
 14121           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14122           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14123              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14124              MOVE PB-I-AH-EXPIRE-DT
 14125                                 TO DC-BIN-DATE-2
 14126              MOVE '1'           TO DC-OPTION-CODE
 14127              PERFORM 8500-DATE-CONVERT
 14128                                 THRU 8500-EXIT
 14129              IF NO-CONVERSION-ERROR
 14130                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14131                    MOVE ER-2661       TO WS-ERROR
 14132*                   PERFORM 9900-ERROR-FORMAT
 14133*                                THRU 9900-EXIT
 14134                 END-IF
 14135              END-IF
 14136           ELSE
 14137              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14138              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14139                 MOVE ER-2661    TO WS-ERROR
 14140*                PERFORM 9900-ERROR-FORMAT
 14141*                                THRU 9900-EXIT
 14142              ELSE
 14143                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14144                    MOVE ER-1570 TO WS-ERROR
 14145                    PERFORM 9900-ERROR-FORMAT
 14146                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 256
* EL050.cbl
 14147                 END-IF
 14148              END-IF
 14149           END-IF
 14150           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14151              MOVE PB-I-JOINT-BIRTHDAY
 14152                                    TO DC-BIN-DATE-1
 14153              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14154              MOVE '1'              TO DC-OPTION-CODE
 14155              PERFORM 8500-DATE-CONVERT
 14156                                    THRU 8500-EXIT
 14157              IF NO-CONVERSION-ERROR
 14158                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14159                    MOVE ER-2661       TO WS-ERROR
 14160*                   PERFORM 9900-ERROR-FORMAT
 14161*                                   THRU 9900-EXIT
 14162                 END-IF
 14163              END-IF
 14164           ELSE
 14165              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14166                (PB-I-AH-TERM / 12)
 14167              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14168                 MOVE ER-2661       TO WS-ERROR
 14169*                PERFORM 9900-ERROR-FORMAT
 14170*                                   THRU 9900-EXIT
 14171              ELSE
 14172                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14173                    MOVE ER-1571 TO WS-ERROR
 14174                    PERFORM 9900-ERROR-FORMAT
 14175                                 THRU 9900-EXIT
 14176                 END-IF
 14177              END-IF
 14178           END-IF
 14179           IF WS-ERROR = ER-2661
 14180              PERFORM 9900-ERROR-FORMAT
 14181                                    THRU 9900-EXIT
 14182           END-IF
 14183        END-IF
 14184     END-IF
 14185*    IF ACCOUNT-AH-CHECKED
 14186*       NEXT SENTENCE
 14187*    ELSE
 14188*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14189*          MOVE ER-2661          TO WS-ERROR
 14190*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14191
 14192     IF ACCOUNT-AH-CHECKED
 14193        NEXT SENTENCE
 14194     ELSE
 14195        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14196           MOVE ER-2663          TO WS-ERROR
 14197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14198
 14199     IF ACCOUNT-AH-CHECKED OR
 14200        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14201         PB-POLICY-IS-VOIDED
 14202        NEXT SENTENCE
 14203     ELSE
 14204        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 257
* EL050.cbl
 14205           MOVE ER-2667            TO WS-ERROR
 14206           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14207
 14208     IF PB-COMPANY-ID = 'CRI'
 14209         IF WS-ERROR = ER-2667
 14210             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14211
 14212     IF ACCOUNT-AH-CHECKED
 14213        NEXT SENTENCE
 14214     ELSE
 14215        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14216           MOVE ER-2678            TO WS-ERROR
 14217           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14218
 14219     IF CP-ERROR-RATE-FILE-NOTOPEN
 14220         GO TO 3990-FILES-NOT-OPEN.
 14221
 14222 3321-CONTINUE.
 14223     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14224     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14225     IF (PB-COMPANY-ID = 'DCC')
 14226        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14227        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14228                                    PB-I-LF-ALT-PREM-CALC
 14229        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14230        IF WS-AH-BEN-CATEGORY = 'G'
 14231           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14232           + PB-I-ADDL-CLP)
 14233           * (1 + WS-TOL-CLP-PCT)
 14234*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14235        ELSE
 14236           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14237           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14238*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14239        END-IF
 14240        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14241                                 TO PB-I-AH-PREM-CALC
 14242        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14243           MOVE ER-8152          TO WS-ERROR
 14244           PERFORM 9900-ERROR-FORMAT
 14245                                 THRU 9900-EXIT
 14246        ELSE
 14247           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14248                 PB-I-ADDL-CLP)
 14249              MOVE ER-8148       TO WS-ERROR
 14250              PERFORM 9900-ERROR-FORMAT
 14251                                 THRU 9900-EXIT
 14252           END-IF
 14253        END-IF
 14254     END-IF
 14255     IF (PB-COMPANY-ID = 'DCC')
 14256        AND (PB-I-POLICY-IS-MONTHLY)
 14257        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14258        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14259        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14260           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14261        END-IF
 14262     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 258
* EL050.cbl
 14263     IF (PB-COMPANY-ID = 'DCC')
 14264        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14265        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14266        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14267        MOVE ER-2786             TO WS-ERROR
 14268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14269     END-IF
 14270     MOVE +0                     TO PB-I-AH-CLP
 14271     IF PB-COMPANY-ID = 'DCC'
 14272        IF WS-AH-BEN-CATEGORY = 'D'
 14273           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14274              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14275        ELSE
 14276           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14277              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14278           END-IF
 14279        END-IF
 14280     END-IF
 14281     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14282
 14283     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14284         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14285
 14286     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14287         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14288
 14289     IF PB-COMPANY-ID = 'CRI'
 14290         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14291            PB-I-PAYMENT-AMOUNT = ZERO
 14292             NEXT SENTENCE
 14293         ELSE
 14294             COMPUTE PB-I-AH-PREM-CALC =
 14295                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14296                 (CP-PREMIUM-RATE / 100)
 14297             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14298                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14299                                             PB-I-RATE-DEV-PCT-AH.
 14300
 14301     IF PB-I-AH-RATE  = ZERO
 14302       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14303           NEXT SENTENCE
 14304       ELSE
 14305         MOVE ER-2642            TO WS-ERROR
 14306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14307
 14308     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14309     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14310     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14311     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14312     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14313     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14314
 14315     IF (PB-COMPANY-ID = 'DCC')
 14316        AND (WS-AH-BEN-CATEGORY = 'G')
 14317        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14318        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14319        IF CP-DEVIATION-CODE NOT = '000'
 14320           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 259
* EL050.cbl
 14321           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14322           IF NO-CP-ERROR
 14323              COMPUTE PB-I-DDF-IU-RATE-UP =
 14324              PB-I-AH-CLP - CP-CALC-PREMIUM
 14325           ELSE
 14326              MOVE ER-3057        TO WS-ERROR
 14327              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14328           END-IF
 14329        END-IF
 14330     END-IF
 14331     .
 14332 3335-EDIT-AH-REIN-NSP-RATE.
 14333     IF AH-REIN-NSP-NOT-USED
 14334         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14335
 14336     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14337     IF PB-COMPANY-ID = 'DCC'
 14338         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14339     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14340     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14341     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14342     MOVE PB-SV-STATE            TO CP-STATE.
 14343     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14344     MOVE ZERO                   TO CP-DEVIATION-CODE
 14345                                    CP-RATE-DEV-PCT.
 14346*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14347     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14348     MOVE '3'                    TO CP-PROCESS-TYPE.
 14349     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14350     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14351                                    CP-RATING-BENEFIT-AMT.
 14352     IF CP-STATE-STD-ABBRV = 'OR'
 14353         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14354                                         PB-I-AH-TERM.
 14355     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14356     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14357     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14358     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14359     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14360     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14361                                    CP-REMAINING-TERM
 14362                                    WS-WORK-TERM.
 14363     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14364     IF PB-COMPANY-ID = 'DCC'
 14365        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14366     END-IF
 14367     IF  PB-COMPANY-ID = 'TIC'
 14368         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14369            MOVE ZERO TO CP-CLASS-CODE.
 14370
 14371     IF PB-COMPANY-ID NOT = 'TIC'
 14372          MOVE ZERO          TO CP-CLASS-CODE.
 14373
 14374     MOVE ZERO               TO CP-DEVIATION-CODE.
 14375
 14376     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14377
 14378     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 260
* EL050.cbl
 14379
 14380     MOVE 'R'                   TO CP-RATE-FILE.
 14381     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14382
 14383     IF CP-ERROR-RATE-NOT-FOUND
 14384         MOVE ER-2645        TO WS-ERROR
 14385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14386         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14387
 14388     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14389
 14390     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14391     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14392
 14393     IF PB-I-AH-REI-RATE = ZERO
 14394         MOVE ER-2645        TO WS-ERROR
 14395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14396
 14397
 14398 3340-CALCULATE-PREMIUM-AMT.
 14399
 14400     IF PB-COMPANY-ID = 'NCL'
 14401         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14402             WS-AH-SPECIAL-CALC-CD = 'O')
 14403             GO TO 3999-END-EDIT.
 14404
 14405     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14406                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14407                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14408                         OR 'AHL'
 14409         NEXT SENTENCE
 14410     ELSE
 14411         IF WS-STATE-ABBREVIATION = 'CT'
 14412             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14413                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14414                 COMPUTE PB-I-LF-PREM-CALC =
 14415                                     PB-I-LF-PREM-CALC * .90
 14416                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14417                                     PB-I-LF-ALT-PREM-CALC * .90
 14418                 COMPUTE PB-I-AH-PREM-CALC =
 14419                                     PB-I-AH-PREM-CALC * .90.
 14420
 14421     IF PB-COMP-LF-PREM
 14422        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14423        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14424
 14425     IF PB-COMP-AH-PREM
 14426        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14427
 14428 3340-CHECK-DCC-TOT-FEES.
 14429     IF (PB-COMPANY-ID = 'DCC')
 14430        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14431        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14432        AND (PB-I-POLICY-IS-MONTHLY)
 14433        CONTINUE
 14434     ELSE
 14435        GO TO 3340-EDIT-LF-AH-TOL
 14436     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 261
* EL050.cbl
 14437     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14438     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14439     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14440        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14441           PB-I-RATE-DEV-PCT-LF
 14442     END-IF
 14443     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14444        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14445           PB-I-RATE-DEV-PCT-AH
 14446     END-IF
 14447     MOVE 'N'                    TO CP-BEN-CATEGORY
 14448     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14449
 14450     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14451     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14452     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14453     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14454     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14455     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14456     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14457     MOVE '3'                    TO CP-PROCESS-TYPE.
 14458     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14459     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14460
 14461     MOVE PB-SV-STATE            TO CP-STATE.
 14462     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14463     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14464     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14465     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14466     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14467                                    CP-RATING-BENEFIT-AMT.
 14468     IF CP-STATE-STD-ABBRV = 'OR'
 14469         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14470                                         PB-I-LF-ALT-BENEFIT-AMT.
 14471     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14472     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14473     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14474     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14475     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14476     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14477     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14478     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14479     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14480                                    CP-REMAINING-TERM
 14481                                    CP-LOAN-TERM.
 14482     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14483        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14484           PB-I-LF-PREMIUM-AMT
 14485     end-if
 14486
 14487     IF CP-TRUNCATED-LIFE
 14488        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14489
 14490     IF CP-TERM-IS-DAYS
 14491         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14492     ELSE
 14493         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14494
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 262
* EL050.cbl
 14495     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14496     IF CP-SPECIAL-CALC-CD = 'H'
 14497         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14498                                    TO CP-ALTERNATE-BENEFIT
 14499         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14500     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14501     MOVE 'R'                    TO CP-RATE-FILE
 14502     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14503     IF NOT CP-ERROR-RATE-NOT-FOUND
 14504        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14505        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14506           AND (CP-BENEFIT-CD (1:1) = 'S')
 14507           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14508                                    PB-I-LF-PREMIUM-AMT
 14509        END-IF
 14510     ELSE
 14511        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14512     END-IF
 14513     .
 14514 3340-EDIT-LF-AH-TOL.
 14515
 14516***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14517***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14518***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14519***
 14520     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14521         PB-I-AH-PREMIUM-AMT
 14522          GIVING WS-CALC-WORK.
 14523
 14524     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14525        AND WS-CALC-WORK NOT = ZERO
 14526         MOVE ER-2649            TO WS-ERROR
 14527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14528
 14529     SUBTRACT PB-I-LF-PREM-CALC
 14530             FROM PB-I-LF-PREMIUM-AMT
 14531                 GIVING WS-UNSIGN-WRK1.
 14532
 14533     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14534             FROM PB-I-LF-ALT-PREMIUM-AMT
 14535                 GIVING WS-UNSIGN-WRK4.
 14536
 14537     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14538                                + WS-UNSIGN-WRK4.
 14539
 14540     SUBTRACT PB-I-AH-PREM-CALC
 14541             FROM PB-I-AH-PREMIUM-AMT
 14542                 GIVING WS-UNSIGN-WRK2.
 14543
 14544******************************************************************
 14545*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14546******************************************************************
 14547
 14548     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14549         MOVE ZERO TO WS-UNSIGN-WRK1.
 14550
 14551     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14552         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 263
* EL050.cbl
 14553
 14554     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14555             GIVING WS-UNSIGN-WRK3.
 14556
 14557 3342-CONTINUE.
 14558
 14559     IF (PB-I-LF-RATE = ZERO  AND
 14560         PB-I-AH-RATE = ZERO)
 14561         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14562            WS-AH-SPECIAL-CALC-CD = 'O'
 14563              NEXT SENTENCE
 14564         ELSE
 14565             GO TO 3345-EDIT-CONTINUE.
 14566
 14567     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14568         NEXT SENTENCE
 14569     ELSE
 14570     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14571        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14572           IF (PB-REISSUED-CERT         OR
 14573               PB-POLICY-IS-DECLINED    OR
 14574               PB-POLICY-IS-VOIDED)
 14575              NEXT SENTENCE
 14576           ELSE
 14577              IF WS-PREM-REJECT-SW = SPACE
 14578                 MOVE ER-2652    TO WS-ERROR
 14579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580                 GO TO 3344-CHECK-AH
 14581              ELSE
 14582                 MOVE ER-2650    TO WS-ERROR
 14583                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14584                 GO TO 3344-CHECK-AH.
 14585
 14586***
 14587***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14588***
 14589
 14590     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14591         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14592            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14593             (1 + WS-TOL-LF-PREM-PCT)
 14594         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14595            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14596             (1 - WS-TOL-LF-PREM-PCT)
 14597     ELSE
 14598         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14599         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14600
 14601***
 14602***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14603***
 14604
 14605     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14606         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14607          WS-TOL-LF-PREM.
 14608
 14609     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14610         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 264
* EL050.cbl
 14611          WS-TOL-LF-PREM.
 14612
 14613     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14614        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14615
 14616     IF PB-REISSUED-CERT
 14617        or PB-POLICY-IS-DECLINED
 14618        or PB-POLICY-IS-VOIDED
 14619        continue
 14620     ELSE
 14621        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14622              > WS-TOL-LF-HIGH-PREM-AMT)
 14623           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14624              < WS-TOL-LF-LOW-PREM-AMT))
 14625                      or
 14626           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14627              > WS-TOL-LF-HIGH-PREM-PCT)
 14628           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14629              < WS-TOL-LF-LOW-PREM-PCT))
 14630           IF WS-PREM-REJECT-SW = SPACE
 14631              MOVE ER-2652       TO WS-ERROR
 14632              PERFORM 9900-ERROR-FORMAT
 14633                                 THRU 9900-EXIT
 14634           ELSE
 14635              MOVE ER-2650       TO WS-ERROR
 14636              PERFORM 9900-ERROR-FORMAT
 14637                                 THRU 9900-EXIT
 14638           end-if
 14639        end-if
 14640     end-if
 14641
 14642*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14643*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14644*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14645*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14646
 14647     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14648        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14649                      OR
 14650           ((PB-COMPANY-ID = 'DCC')
 14651           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14652           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14653           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14654        END-IF
 14655     END-IF
 14656
 14657     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14658        IF WS-COMP-MAX-CAP GREATER THAN +0
 14659           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14660              IF (PB-REISSUED-CERT         OR
 14661                  PB-POLICY-IS-DECLINED    OR
 14662                  PB-POLICY-IS-VOIDED)
 14663                 NEXT SENTENCE
 14664              ELSE
 14665                  MOVE ER-2646   TO  WS-ERROR
 14666                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14667
 14668 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 265
* EL050.cbl
 14669
 14670      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14671          GO TO 3344-CHECK-AH.
 14672
 14673      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14674          GO TO 3344-CHECK-AH.
 14675
 14676      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14677                                     WS-UNSIGN-WRK6.
 14678
 14679      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14680          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14681                                 + PB-I-LF-PREMIUM-AMT
 14682                                 - PB-I-LF-PREM-CALC.
 14683
 14684      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14685          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14686                                 + PB-I-LF-ALT-PREMIUM-AMT
 14687                                 - PB-I-LF-ALT-PREM-CALC.
 14688
 14689      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14690          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14691              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14692                 MOVE ER-2652    TO  WS-ERROR
 14693                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14694              ELSE
 14695                 MOVE ER-2650    TO  WS-ERROR
 14696                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14697
 14698      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14699          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14700              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14701                 MOVE ER-2652    TO  WS-ERROR
 14702                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14703              ELSE
 14704                 MOVE ER-2650    TO  WS-ERROR
 14705                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14706
 14707 3344-CHECK-AH.
 14708
 14709****************************************************************
 14710***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14711***
 14712
 14713     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14714         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14715             (1 + WS-TOL-AH-PREM-PCT)
 14716         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14717             (1 - WS-TOL-AH-PREM-PCT)
 14718     ELSE
 14719         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14720         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14721
 14722***
 14723***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14724***
 14725
 14726     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 266
* EL050.cbl
 14727         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14728
 14729     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14730         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14731
 14732     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14733        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14734
 14735     IF (PB-REISSUED-CERT)
 14736        OR (PB-POLICY-IS-DECLINED)
 14737        OR (PB-POLICY-IS-VOIDED)
 14738        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14739        CONTINUE
 14740     ELSE
 14741        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14742              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14743                          or
 14744           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14745              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14746           IF WS-PREM-REJECT-SW = SPACE
 14747              MOVE ER-3052       TO WS-ERROR
 14748              PERFORM 9900-ERROR-FORMAT
 14749                                 THRU 9900-EXIT
 14750           ELSE
 14751              MOVE ER-3050       TO WS-ERROR
 14752              PERFORM 9900-ERROR-FORMAT
 14753                                 THRU 9900-EXIT
 14754           END-IF
 14755        END-IF
 14756     END-IF
 14757     if (pb-company-id = 'DCC')
 14758        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14759        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14760        and (pb-i-policy-is-monthly)
 14761        compute ws-tol-ah-high-prem-amt =
 14762           pb-i-tot-fees-calc + ws-tol-ah-prem
 14763        compute ws-tol-ah-low-prem-amt =
 14764           pb-i-tot-fees-calc - ws-tol-ah-prem
 14765        if ws-tol-ah-prem-pct > zeros
 14766           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14767              (1 + ws-tol-ah-prem-pct)
 14768           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14769              (1 - ws-tol-ah-prem-pct)
 14770        else
 14771           move +9999999.99      to ws-tol-ah-high-prem-pct
 14772           move +0               to ws-tol-ah-low-prem-pct
 14773        end-if
 14774        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14775            or
 14776           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14777                          or
 14778           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14779           or
 14780           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14781            move er-3049         to ws-error
 14782           perform 9900-error-format
 14783                                 thru 9900-exit
 14784
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 267
* EL050.cbl
 14785        end-if
 14786     end-if
 14787     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14788         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14789             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14790             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14791
 14792     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14793        IF WS-COMP-MAX-CAP GREATER THAN +0
 14794           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14795              IF (PB-REISSUED-CERT         OR
 14796                  PB-POLICY-IS-DECLINED    OR
 14797                  PB-POLICY-IS-VOIDED)
 14798                 NEXT SENTENCE
 14799              ELSE
 14800                  MOVE ER-2646   TO  WS-ERROR
 14801                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14802
 14803     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14804        (WS-COMP-MAX-CAP EQUAL +0)
 14805           GO TO 3345-EDIT-CONTINUE.
 14806
 14807     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14808        GREATER THAN WS-COMP-MAX-CAP
 14809           MOVE ER-2646          TO  WS-ERROR
 14810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811
 14812 3345-EDIT-CONTINUE.
 14813
 14814*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14815*       IF PB-ENTRY-BATCH   NUMERIC
 14816*          IF PB-ISSUE
 14817*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14818*          ELSE
 14819*              IF PB-CANCELLATION
 14820*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14821
 14822*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14823*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14824*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14825*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14826*        ELSE
 14827*            MOVE  ER-1909            TO  WS-ERROR
 14828*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14829
 14830     IF PB-I-POLICY-ACCEPTED
 14831        IF PB-POLICY-IS-DECLINED  OR
 14832           PB-REISSUED-CERT  OR
 14833           PB-REIN-ONLY-CERT  OR
 14834           PB-POLICY-IS-VOIDED
 14835            MOVE  ER-1891         TO  WS-ERROR
 14836            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14837        ELSE
 14838            MOVE SPACE            TO  PB-BATCH-ENTRY
 14839            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14840
 14841     IF PB-I-POLICY-DECLINED
 14842        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 268
* EL050.cbl
 14843           PB-REIN-ONLY-CERT  OR
 14844           PB-POLICY-IS-VOIDED
 14845            MOVE  ER-1906         TO  WS-ERROR
 14846            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14847        ELSE
 14848            MOVE  'D'             TO  PB-BATCH-ENTRY
 14849                                      PB-I-ENTRY-STATUS.
 14850
 14851     IF PB-I-NEEDS-UNDERWRITING
 14852        IF PB-POLICY-IS-DECLINED OR
 14853           PB-REISSUED-CERT  OR
 14854           PB-REIN-ONLY-CERT  OR
 14855           PB-POLICY-IS-VOIDED
 14856            MOVE  ER-1907         TO  WS-ERROR
 14857            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14858        ELSE
 14859            MOVE 'U'              TO  PB-BATCH-ENTRY
 14860                                      PB-I-ENTRY-STATUS.
 14861
 14862     IF PB-NEEDS-UNDERWRITING
 14863        MOVE  ER-1901             TO  WS-ERROR
 14864        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14865     IF PB-COMPANY-ID = 'DCC'
 14866        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14867        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14868        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14869           AND (NOT WS-LF-CASH))
 14870                           OR
 14871           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14872           AND (NOT WS-AH-CASH)))
 14873                       AND
 14874           (PB-I-ENTRY-STATUS NOT = '5')
 14875           MOVE 'M'              TO PB-BATCH-ENTRY
 14876                                    PB-I-ENTRY-STATUS
 14877        END-IF
 14878     END-IF
 14879     IF  PB-COMPANY-ID NOT = 'NCL'
 14880         GO TO 3999-END-EDIT.
 14881
 14882     IF PB-REISSUED-CERT  OR
 14883        PB-POLICY-IS-DECLINED  OR
 14884        PB-POLICY-IS-VOIDED  OR
 14885        PB-I-OB
 14886         GO TO 3999-END-EDIT.
 14887
 14888     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14889         MOVE  ER-2644            TO  WS-ERROR
 14890         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14891         GO TO 3999-END-EDIT.
 14892
 14893     MOVE 'N'                     TO  FORM-MASTER-SW.
 14894     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14895
 14896     IF NOT FORM-MASTER-FOUND
 14897         GO TO 3999-END-EDIT.
 14898
 14899     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14900                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 269
* EL050.cbl
 14901
 14902     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14903         MOVE  +1                 TO SUB6
 14904         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14905
 14906     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14907         MOVE  +1                 TO SUB6
 14908         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14909
 14910     IF LF-FORM-MASTER-FOUND  OR
 14911        AH-FORM-MASTER-FOUND
 14912         GO TO 3360-CHECK-FORM-LIMITS
 14913     ELSE
 14914         GO TO 3999-END-EDIT.
 14915
 14916******************************************************************
 14917*                  3350-GET-ERFORM                               *
 14918*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14919*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14920******************************************************************
 14921
 14922 3350-GET-ERFORM.
 14923
 14924     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14925         GO TO  3350-ERFORM-GETMAIN.
 14926
 14927     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14928     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14929     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14930     MOVE 'Y'                     TO FORM-MASTER-SW.
 14931
 14932     IF PB-CANCELLATION
 14933         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14934            PB-SV-STATE          EQUAL   FO-STATE       AND
 14935            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14936              GO TO 3350-EXIT
 14937         ELSE
 14938             NEXT SENTENCE
 14939     ELSE
 14940         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14941            PB-SV-STATE          EQUAL   FO-STATE       AND
 14942            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14943              GO TO 3350-EXIT.
 14944
 14945 3350-ERFORM-GETMAIN.
 14946
 14947     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14948     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14949
 14950 3350-ERFORM-READ.
 14951
 14952     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14953     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14954     IF PB-CANCELLATION
 14955         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14956     ELSE
 14957         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14958     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 270
* EL050.cbl
 14959
 14960     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14961
 14962     IF FORM-MASTER-FOUND
 14963       IF PB-CANCELLATION
 14964          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14965             PB-SV-STATE          EQUAL   FO-STATE       AND
 14966             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14967              GO  TO 3350-EXIT
 14968          ELSE
 14969              NEXT SENTENCE
 14970       ELSE
 14971          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14972             PB-SV-STATE          EQUAL   FO-STATE       AND
 14973             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14974              GO  TO 3350-EXIT.
 14975
 14976     MOVE  'N'                    TO  FORM-MASTER-SW.
 14977     MOVE  ER-1895                TO  WS-ERROR.
 14978     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14979
 14980 3350-EXIT.
 14981      EXIT.
 14982
 14983******************************************************************
 14984*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14985*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14986*   VALID FOR THE POLICY FORM USED.                              *
 14987******************************************************************
 14988
 14989 3355-EDIT-FORM-LF-BENEFITS.
 14990
 14991     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14992        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14993         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14994         GO TO   3355-EXIT.
 14995
 14996     IF  SUB6    LESS THAN   +40
 14997         ADD  +1      TO  SUB6
 14998         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14999
 15000     MOVE  ER-1896         TO  WS-ERROR.
 15001     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15002
 15003 3355-EXIT.
 15004      EXIT.
 15005
 15006******************************************************************
 15007*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15008*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15009*   VALID FOR THE POLICY FORM USED.                              *
 15010******************************************************************
 15011
 15012 3356-EDIT-FORM-AH-BENEFITS.
 15013
 15014     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15015        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15016         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 271
* EL050.cbl
 15017         GO TO  3356-EXIT.
 15018
 15019      IF  SUB6    LESS THAN     +40
 15020          ADD  +1      TO  SUB6
 15021          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15022
 15023     MOVE  ER-1897         TO  WS-ERROR.
 15024     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15025
 15026 3356-EXIT.
 15027      EXIT.
 15028
 15029******************************************************************
 15030*                  3357-BENEFIT-SEARCH                           *
 15031*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15032*   CANCELLATIONS ONLY.                                          *
 15033******************************************************************
 15034 3357-BENEFIT-SEARCH.
 15035     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15036         MOVE +1                          TO SUB6
 15037         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15038
 15039     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15040         MOVE +1                          TO SUB6
 15041         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15042
 15043 3357-EXIT.
 15044     EXIT.
 15045
 15046******************************************************************
 15047*                  3358-BENEFIT-LIFE-SEARCH                      *
 15048*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15049*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15050*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15051******************************************************************
 15052 3358-BENEFIT-LIFE-SEARCH.
 15053     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15054       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15055         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15056           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15057              IF FO-PLAN-REFUND-METHOD (SUB6)
 15058                     IS GREATER THAN SPACES
 15059                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15060                                          WS-LF-REFUND-CALC
 15061                 GO TO 3358-EXIT.
 15062
 15063     IF SUB6 LESS THAN +40
 15064         ADD +1                 TO SUB6
 15065         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15066
 15067 3358-EXIT.
 15068     EXIT.
 15069******************************************************************
 15070*                  3359-BENEFIT-AH-SEARCH                        *
 15071*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15072*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15073*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15074******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 272
* EL050.cbl
 15075 3359-BENEFIT-AH-SEARCH.
 15076     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15077       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15078         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15079           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15080              IF FO-PLAN-REFUND-METHOD (SUB6)
 15081                      IS GREATER THAN SPACES
 15082                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15083                                          WS-AH-REFUND-CALC
 15084                 GO TO 3359-EXIT.
 15085
 15086     IF SUB6 LESS THAN +40
 15087         ADD +1                 TO SUB6
 15088         GO TO 3359-BENEFIT-AH-SEARCH.
 15089
 15090 3359-EXIT.
 15091     EXIT.
 15092
 15093******************************************************************
 15094*                  3360-CHECK-FORM-LIMITS                        *
 15095*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15096*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15097******************************************************************
 15098
 15099 3360-CHECK-FORM-LIMITS.
 15100
 15101     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15102         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15103
 15104     IF NOT LF-FORM-MASTER-FOUND
 15105         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15106
 15107 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15108
 15109     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15110       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15111        WS-LF-JOINT-INDICATOR = 'J'  AND
 15112        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15113         IF PB-COMPANY-ID = 'NCL'
 15114            MOVE  ER-1911          TO  WS-ERROR
 15115            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15116         ELSE
 15117            MOVE  ER-1892          TO  WS-ERROR
 15118            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15119
 15120 3360-CHECK-FORM-LF-ATT-AGE.
 15121
 15122     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15123
 15124     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15125         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15126         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15127            IF PB-COMPANY-ID = 'NCL'
 15128                MOVE  ER-1913      TO  WS-ERROR
 15129                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15130            ELSE
 15131                MOVE  ER-1894      TO  WS-ERROR
 15132                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 273
* EL050.cbl
 15133
 15134 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15135
 15136     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15137         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15138         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15139            IF PB-COMPANY-ID = 'NCL'
 15140                MOVE  ER-1914      TO  WS-ERROR
 15141                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15142            ELSE
 15143                MOVE  ER-1899      TO  WS-ERROR
 15144                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15145
 15146 3360-CHECK-FORM-LF-TERM-BAMT.
 15147
 15148     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15149         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15150         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15151           IF  PB-COMPANY-ID = 'NCL'
 15152               MOVE  ER-1916       TO  WS-ERROR
 15153               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15154           ELSE
 15155               MOVE  ER-1902       TO  WS-ERROR
 15156               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15157
 15158     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15159                                    PB-I-LF-ALT-BENEFIT-AMT.
 15160
 15161     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15162         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15163         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15164             IF  PB-COMPANY-ID = 'NCL'
 15165                 MOVE  ER-1918     TO  WS-ERROR
 15166                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15167             ELSE
 15168                 MOVE  ER-1904     TO  WS-ERROR
 15169                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15170
 15171******************************************************************
 15172*                  3360-CHECK-FORM-AH-LIMITS                     *
 15173*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15174*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15175******************************************************************
 15176
 15177 3360-CHECK-FORM-AH-LIMITS.
 15178
 15179     IF NOT AH-FORM-MASTER-FOUND
 15180         GO TO 3999-END-EDIT.
 15181
 15182 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15183
 15184     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15185       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15186        WS-AH-JOINT-INDICATOR = 'J'  AND
 15187        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15188         IF PB-COMPANY-ID = 'NCL'
 15189            MOVE  ER-1912          TO  WS-ERROR
 15190            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 274
* EL050.cbl
 15191         ELSE
 15192            MOVE  ER-1893          TO  WS-ERROR
 15193            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15194
 15195 3360-CHECK-FORM-AH-ATT-AGE.
 15196
 15197     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15198
 15199     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15200         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15201         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15202            IF PB-COMPANY-ID = 'NCL'
 15203                MOVE  ER-1913      TO  WS-ERROR
 15204                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15205            ELSE
 15206                MOVE  ER-1894      TO  WS-ERROR
 15207                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15208
 15209 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15210
 15211     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15212         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15213         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15214            IF PB-COMPANY-ID = 'NCL'
 15215                MOVE  ER-1915      TO  WS-ERROR
 15216                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15217            ELSE
 15218                MOVE  ER-1900      TO  WS-ERROR
 15219                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15220
 15221 3360-CHECK-FORM-AH-TERM-BAMT.
 15222
 15223     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15224         FO-AH-MAX-TERM    GREATER THAN  +0
 15225         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15226             IF  PB-COMPANY-ID = 'NCL'
 15227                 MOVE  ER-1917     TO  WS-ERROR
 15228                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15229             ELSE
 15230                  MOVE  ER-1903    TO  WS-ERROR
 15231                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15232
 15233     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15234         FO-MAX-AH-AMT    GREATER THAN  +0
 15235         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15236             IF  PB-COMPANY-ID = 'NCL'
 15237                 MOVE  ER-1919     TO  WS-ERROR
 15238                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15239             ELSE
 15240                 MOVE  ER-1905     TO  WS-ERROR
 15241                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15242
 15243     GO TO 3999-END-EDIT.
 15244
 15245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 275
* EL050.cbl
 15247******************************************************************
 15248*                  E D I T   C A N C E L                         *
 15249******************************************************************
 15250
 15251 3700-EDIT-CANCEL.
 15252     IF PB-COMPANY-ID = 'DMD'
 15253         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15254                                         WS-RES-MUNI-TAX
 15255                                         PB-CI-STATE-TAX
 15256                                         PB-CI-MUNI-TAX
 15257         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15258
 15259*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15260*       IF PB-ENTRY-BATCH  NUMERIC
 15261*          IF PB-CANCELLATION
 15262*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15263*          ELSE
 15264*             IF PB-ISSUE
 15265*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15266
 15267     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15268        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15269     END-IF
 15270*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15271*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15272
 15273     IF CM-ENTRY-STATUS = 'V'
 15274        MOVE ER-2780             TO WS-ERROR
 15275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15276        GO TO 3999-END-EDIT.
 15277
 15278     IF CM-ENTRY-STATUS = 'D'
 15279        MOVE ER-2781             TO WS-ERROR
 15280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15281        GO TO 3999-END-EDIT.
 15282
 15283     IF CM-ENTRY-STATUS = 'U'
 15284        MOVE ER-2782             TO WS-ERROR
 15285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15286
 15287***************************************************************
 15288*                                                             *
 15289*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15290*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15291*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15292*   OF ANOTHER COVERAGE.                                      *
 15293*                                                             *
 15294***************************************************************
 15295
 15296     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15297                                    PB-C-AH-CANCEL-VOID-SW.
 15298
 15299     IF PB-C-LF-CANCEL-AMT = ZERO
 15300        NEXT SENTENCE
 15301     ELSE
 15302        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15303           AND
 15304           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 276
* EL050.cbl
 15305               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15306               MOVE ER-2745           TO WS-ERROR
 15307               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15308
 15309     IF PB-C-AH-CANCEL-AMT = ZERO
 15310        NEXT SENTENCE
 15311     ELSE
 15312        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15313           AND
 15314           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15315               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15316               MOVE ER-2745           TO WS-ERROR
 15317               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15318
 15319     IF WS-LF-EARNINGS-CALC = '4'
 15320        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15321
 15322     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15323     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15324     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15325     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15326     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15327     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15328
 15329     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15330                                      PB-C-AH-REF-CALC.
 15331     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15332
 15333******************************************************************
 15334*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15335*             TO VALIDATE COVERAGE.                              *
 15336******************************************************************
 15337
 15338     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15339        PB-C-LF-CANCEL-AMT = ZEROS
 15340          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15341      ELSE
 15342          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15343
 15344     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15345        PB-C-AH-CANCEL-AMT = ZEROS
 15346          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15347      ELSE
 15348          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15349
 15350     EVALUATE TRUE
 15351         WHEN PB-CANCEL-FORCE             OR
 15352              PB-CANCEL-DATE-FORCED       OR
 15353              PB-FORCE-OFF
 15354                  IF PB-COMPANY-ID = 'ACE'
 15355                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15356                  END-IF
 15357         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15358               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15359              (PB-COMPANY-ID = 'ACE' )
 15360                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15361         WHEN OTHER
 15362              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 277
* EL050.cbl
 15363                 MOVE ER-2794              TO WS-ERROR
 15364              ELSE
 15365                 MOVE ER-2749              TO WS-ERROR
 15366              END-IF
 15367              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15368     END-EVALUATE.
 15369
 15370
 15371*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15372*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15373*            MOVE  ER-1909            TO  WS-ERROR
 15374*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15375*        ELSE
 15376*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15377
 15378     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15379     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15380        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15381     ELSE
 15382        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15383     END-IF
 15384     .
 15385 3705-EDIT-CANCEL-DT.
 15386
 15387     IF LF-COVERAGE-CANCELLED
 15388        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15389         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15390         MOVE WS-CURRENT-MONTH-END
 15391                                 TO DC-BIN-DATE-2
 15392         SET ELAPSED-BETWEEN-BIN TO TRUE
 15393*        MOVE 1                  TO DC-OPTION-CODE
 15394         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15395         IF DATE-CONVERSION-ERROR
 15396            NEXT SENTENCE
 15397          ELSE
 15398             IF DC-ELAPSED-DAYS GREATER +180
 15399                IF PB-CANCEL-DATE-FORCED  OR
 15400                   PB-CANCEL-DATE-FORCED-NO-FEE
 15401                      MOVE ER-2751  TO WS-ERROR
 15402                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15403                 ELSE
 15404                   MOVE ER-2752  TO WS-ERROR
 15405                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15406
 15407     IF AH-COVERAGE-CANCELLED
 15408        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15409         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15410         MOVE WS-CURRENT-MONTH-END
 15411                                 TO DC-BIN-DATE-2
 15412         SET ELAPSED-BETWEEN-BIN TO TRUE
 15413*        MOVE 1                  TO DC-OPTION-CODE
 15414         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15415         IF DATE-CONVERSION-ERROR
 15416            NEXT SENTENCE
 15417          ELSE
 15418             IF DC-ELAPSED-DAYS GREATER +180
 15419                IF PB-CANCEL-DATE-FORCED OR
 15420                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 278
* EL050.cbl
 15421                      MOVE ER-2751  TO WS-ERROR
 15422                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15423                 ELSE
 15424                   MOVE ER-2752  TO WS-ERROR
 15425                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15426
 15427     IF WS-ERROR = ER-2752
 15428        AND (PB-COMPANY-ID = 'ABL'
 15429         OR  PB-COMPANY-ID = 'FGL'
 15430         OR  PB-COMPANY-ID = 'IST'
 15431         OR  PB-COMPANY-ID = 'JHL'
 15432         OR  PB-COMPANY-ID = 'LAP'
 15433         OR  PB-COMPANY-ID = 'LBL'
 15434         OR  PB-COMPANY-ID = 'NCB'
 15435         OR  PB-COMPANY-ID = 'NLI'
 15436         OR  PB-COMPANY-ID = 'OFI'
 15437         OR  PB-COMPANY-ID = 'PLI'
 15438         OR  PB-COMPANY-ID = 'TAO'
 15439         OR  PB-COMPANY-ID = 'TIC'
 15440         OR  PB-COMPANY-ID = 'HER'
 15441         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15442         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15443            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15444            MOVE ER-2762     TO WS-ERROR
 15445            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15446
 15447     IF LF-COVERAGE-CANCELLED
 15448        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15449        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15450             MOVE ER-2733         TO WS-ERROR
 15451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15452
 15453     IF AH-COVERAGE-CANCELLED
 15454        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15455        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15456              MOVE ER-2733        TO WS-ERROR
 15457              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15458
 15459     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15460        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15461        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15462           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15463            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15464              IF PB-COMPANY-ID NOT = 'LAP'
 15465               MOVE ER-2704            TO WS-ERROR
 15466               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15467
 15468     IF CERT-WAS-NOT-FOUND
 15469         GO TO 3999-END-EDIT.
 15470
 15471     IF PB-COMPANY-ID EQUAL 'CDC'
 15472        IF LF-COVERAGE-CANCELLED
 15473           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15474            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15475            MOVE PB-C-LF-CANCEL-DT
 15476                                 TO DC-BIN-DATE-2
 15477            SET ELAPSED-BETWEEN-BIN TO TRUE
 15478*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 279
* EL050.cbl
 15479            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15480            IF DATE-CONVERSION-ERROR
 15481               NEXT SENTENCE
 15482             ELSE
 15483                IF DC-ELAPSED-DAYS GREATER +60
 15484                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15485
 15486     IF PB-COMPANY-ID EQUAL 'CDC'
 15487        IF AH-COVERAGE-CANCELLED
 15488           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15489            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15490            MOVE PB-C-AH-CANCEL-DT
 15491                                 TO DC-BIN-DATE-2
 15492            MOVE +0              TO DC-ELAPSED-DAYS
 15493                                    DC-ELAPSED-MONTHS
 15494            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15495*           MOVE 1               TO DC-OPTION-CODE
 15496            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15497            IF DATE-CONVERSION-ERROR
 15498               NEXT SENTENCE
 15499             ELSE
 15500                IF DC-ELAPSED-DAYS GREATER +60
 15501                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15502
 15503     MOVE +0                     TO DC-ELAPSED-DAYS
 15504                                    DC-ELAPSED-MONTHS.
 15505
 15506     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15507        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15508          MOVE 'Z'                TO PB-CI-OB-FLAG
 15509          MOVE ER-2767            TO WS-ERROR
 15510          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15511          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15512          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15513          GO TO 3775-OVER-REF-CHK
 15514        ELSE
 15515          MOVE ZEROS              TO PB-CI-LIVES
 15516                                     PB-C-LIVES
 15517          IF PB-CI-OB-FLAG NOT = 'B'
 15518             MOVE SPACE           TO PB-CI-OB-FLAG.
 15519
 15520     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15521         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15522     ELSE
 15523         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15524
 15525     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15526        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15527            MOVE ER-2760         TO WS-ERROR
 15528            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15529
 15530     IF LF-COVERAGE-CANCELLED
 15531        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15532         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15533            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15534               MOVE ER-2774       TO WS-ERROR
 15535               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15536
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 280
* EL050.cbl
 15537     IF AH-COVERAGE-CANCELLED
 15538        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15539         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15540            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15541               MOVE ER-2775       TO WS-ERROR
 15542               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15543
 15544     IF LF-COVERAGE-CANCELLED
 15545        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15546         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15547            MOVE ER-2776         TO WS-ERROR
 15548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15549
 15550     IF AH-COVERAGE-CANCELLED
 15551        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15552         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15553            MOVE ER-2777         TO WS-ERROR
 15554            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15555
 15556     IF LF-COVERAGE-CANCELLED
 15557        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15558        if pb-ci-lf-expire-dt = low-values or spaces
 15559           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15560           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15561           MOVE PB-CI-EXTENTION-DAYS
 15562                                 TO DC-ELAPSED-DAYS
 15563           SET BIN-PLUS-ELAPSED  TO TRUE
 15564           PERFORM 8500-DATE-CONVERT
 15565                                 THRU 8500-EXIT
 15566           IF DATE-CONVERSION-ERROR
 15567              move low-values    to dc-bin-date-2
 15568           end-if
 15569        else
 15570           move pb-ci-lf-expire-dt
 15571                                 to dc-bin-date-2
 15572        end-if
 15573        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15574           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15575                             OR  'FIA'
 15576              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15577           ELSE
 15578              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15579              MOVE ER-2731       TO WS-ERROR
 15580              PERFORM 9900-ERROR-FORMAT
 15581                                 THRU 9900-EXIT
 15582           end-if
 15583        end-if
 15584     end-if
 15585*    IF LF-COVERAGE-CANCELLED
 15586*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15587*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15588*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15589*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15590*        SET BIN-PLUS-ELAPSED      TO TRUE
 15591*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15592*        IF DATE-CONVERSION-ERROR
 15593*           NEXT SENTENCE
 15594*         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 281
* EL050.cbl
 15595*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15596*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15597*                            OR  'FIA'
 15598*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15599*              ELSE
 15600*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15601*               MOVE ER-2731       TO WS-ERROR
 15602*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15603     .
 15604 3705-EDIT-AH-CANCEL-DT.
 15605     IF AH-COVERAGE-CANCELLED
 15606        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15607        if pb-ci-AH-expire-dt = low-values or spaces
 15608           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15609           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15610           MOVE PB-CI-EXTENTION-DAYS
 15611                                 TO DC-ELAPSED-DAYS
 15612           SET BIN-PLUS-ELAPSED  TO TRUE
 15613           PERFORM 8500-DATE-CONVERT
 15614                                 THRU 8500-EXIT
 15615           IF DATE-CONVERSION-ERROR
 15616              move low-values    to dc-bin-date-2
 15617           end-if
 15618        else
 15619           move pb-ci-ah-expire-dt
 15620                                 to dc-bin-date-2
 15621        end-if
 15622        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15623           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15624                             OR  'FIA'
 15625              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15626           ELSE
 15627              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15628              MOVE ER-2771       TO WS-ERROR
 15629              PERFORM 9900-ERROR-FORMAT
 15630                                 THRU 9900-EXIT
 15631           end-if
 15632        end-if
 15633     end-if
 15634*    IF AH-COVERAGE-CANCELLED
 15635*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15636*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15637*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15638*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15639**       MOVE 6                    TO DC-OPTION-CODE
 15640*        SET BIN-PLUS-ELAPSED      TO TRUE
 15641*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15642*        IF DATE-CONVERSION-ERROR
 15643*           NEXT SENTENCE
 15644*         ELSE
 15645*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15646*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15647*                             OR 'FIA'
 15648*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15649*             ELSE
 15650*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15651*              MOVE ER-2771       TO WS-ERROR
 15652*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 282
* EL050.cbl
 15653     .
 15654 3705-EDIT-CONTINUED.
 15655
 15656*    IF LF-COVERAGE-CANCELLED
 15657*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15658*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15659*            MOVE ER-2727         TO WS-ERROR
 15660*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15661*
 15662*    IF AH-COVERAGE-CANCELLED
 15663*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15664*        IF PB-COMPANY-ID = 'ACE'
 15665*           MOVE ER-2727        TO WS-ERROR
 15666*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15667*        ELSE
 15668*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15669*              MOVE ER-2727     TO WS-ERROR
 15670*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15671
 15672     IF PB-COMPANY-ID = 'ACE'
 15673       IF AH-COVERAGE-CANCELLED
 15674         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15675           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15676              MOVE ER-2732      TO WS-ERROR
 15677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15678
 15679     IF PB-COMPANY-ID      EQUAL   'HER'
 15680        IF WS-ERROR        EQUAL   ER-2727
 15681            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15682            MOVE  ER-2725          TO  WS-ERROR
 15683            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15684
 15685     IF PB-C-CLAIM-CREATED-CANCEL
 15686            MOVE ER-2748         TO WS-ERROR
 15687            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15688
 15689     IF PB-C-LAST-NAME NOT = SPACES
 15690         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15691            MOVE ER-2747         TO WS-ERROR
 15692            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15693
 15694 3710-EDIT-LUMP-SUM-PRIOR.
 15695
 15696     IF AH-COVERAGE-CANCELLED
 15697         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15698             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15699                MOVE ER-2735    TO WS-ERROR
 15700                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15701
 15702     IF LF-COVERAGE-CANCELLED
 15703         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15704             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15705                MOVE ER-2735    TO WS-ERROR
 15706                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15707
 15708 3710-EDIT-PRIOR-DEATH.
 15709
 15710*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 283
* EL050.cbl
 15711*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15712*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15713*           (NOT PB-CI-OB)
 15714*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15715*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15716*                   MOVE ER-2732  TO WS-ERROR
 15717*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15718*
 15719*    IF AH-COVERAGE-CANCELLED
 15720*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15721*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15722*           (NOT PB-CI-OB)
 15723*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15724*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15725*                   MOVE ER-2732  TO WS-ERROR
 15726*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15727
 15728     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15729         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15730            (NOT PB-COMP-LF-CANCEL)
 15731             NEXT SENTENCE
 15732         ELSE
 15733           IF PB-C-LF-CANCEL-VOIDED
 15734              NEXT SENTENCE
 15735           ELSE
 15736              MOVE ER-2753      TO WS-ERROR
 15737              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15738
 15739     IF CANCEL-FUTURE-DT
 15740         GO TO 3999-END-EDIT.
 15741
 15742 3715-GET-REMAIN-TERM-LF.
 15743
 15744     IF NO-LF-BENEFIT-MATCH  OR
 15745        WS-LF-BENEFIT-CD = ZEROS
 15746        GO TO 3730-GET-AH-REMAIN-TERM.
 15747
 15748     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15749     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15750     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15751     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15752     MOVE PB-SV-STATE            TO CP-STATE.
 15753     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15754     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15755     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15756     MOVE '2'                    TO CP-PROCESS-TYPE.
 15757     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15758     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15759     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15760     IF (PB-COMPANY-ID = 'CID')
 15761        AND (CP-STATE-STD-ABBRV = 'WI')
 15762        MOVE '7'                 TO CP-REM-TERM-METHOD
 15763        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15764     ELSE
 15765        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15766        MOVE WS-REM-TRM-CALC-OPTION
 15767                                 TO CP-REM-TRM-CALC-OPTION
 15768     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 284
* EL050.cbl
 15769**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15770     IF (PB-COMPANY-ID = 'CID')
 15771        AND (CP-STATE-STD-ABBRV = 'MO')
 15772        AND (PB-CERT-EFF-DT >= X'9B41')
 15773        AND (PB-CERT-EFF-DT <= X'A2FB')
 15774        MOVE '7'                 TO CP-REM-TERM-METHOD
 15775        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15776     END-IF
 15777     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15778                                    CP-LOAN-TERM.
 15779     IF CP-TRUNCATED-LIFE
 15780        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15781
 15782     IF CP-TERM-IS-DAYS
 15783         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15784     ELSE
 15785         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15786
 15787     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15788
 15789     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15790
 15791     IF LF-COVERAGE-CANCELLED
 15792        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15793        NEXT SENTENCE
 15794      ELSE
 15795          GO TO 3730-GET-AH-REMAIN-TERM.
 15796
 15797 3720-GET-LF-REFUND.
 15798
 15799     IF PB-C-LF-CANCEL-VOIDED OR
 15800        PB-C-AH-CANCEL-VOIDED
 15801        GO TO 3780-UPDATE-CANCEL-CERT.
 15802
 15803     IF PB-COMPANY-ID EQUAL 'BOA'
 15804         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15805         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15806         GO TO 3730-GET-AH-REMAIN-TERM.
 15807
 15808     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15809        (WS-AH-SPECIAL-CALC-CD = 'M')
 15810         MOVE ER-2767            TO WS-ERROR
 15811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15812         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15813         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15814         GO TO 3780-UPDATE-CANCEL-CERT.
 15815
 15816*    if (ws-lf-earnings-calc = '6')
 15817*       or (pb-c-lf-refund-override = '6')
 15818*       move cp-remaining-term-1 to cp-remaining-term-2
 15819*    end-if
 15820     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15821
 15822     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15823     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15824     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15825     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15826     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 285
* EL050.cbl
 15827     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15828     IF (PB-COMPANY-ID = 'DCC')
 15829        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15830        IF PDEF-MASTER-FOUND
 15831           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15832              (V1 > +8)
 15833              OR (PD-PROD-CODE (V1) = 'L')
 15834           END-PERFORM
 15835           IF V1 < +9
 15836              MOVE PD-MAX-AMT (V1)
 15837                           TO CP-R-MAX-TOT-BEN
 15838                              EC-AM-LF-MAX-TOT-BEN
 15839           END-IF
 15840        ELSE
 15841        MOVE ' '                 TO PDEF-MASTER-SW
 15842        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15843        MOVE PB-STATE            TO ERPDEF-STATE
 15844        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15845        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15846        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15847        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15848        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15849        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15850        IF PDEF-MASTER-FOUND
 15851           MOVE 'N'              TO PDEF-MASTER-SW
 15852           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15853           IF PDEF-MASTER-FOUND
 15854              IF (ERPDEF-KEY-SAVE (1:16) =
 15855                           PD-CONTROL-PRIMARY (1:16))
 15856                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15857                 CONTINUE
 15858              ELSE
 15859                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15860                 IF (ERPDEF-KEY-SAVE (1:16) =
 15861                           PD-CONTROL-PRIMARY (1:16))
 15862                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15863                    CONTINUE
 15864                 ELSE
 15865                    MOVE 'N'     TO PDEF-MASTER-SW
 15866                 END-IF
 15867              END-IF
 15868              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15869
 15870              IF PDEF-MASTER-FOUND
 15871                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15872                    (V1 > +8)
 15873                    OR (PD-PROD-CODE (V1) = 'L')
 15874                 END-PERFORM
 15875                 IF V1 < +9
 15876                    MOVE PD-MAX-AMT (V1)
 15877                                 TO CP-R-MAX-TOT-BEN
 15878                                    EC-AM-LF-MAX-TOT-BEN
 15879                 END-IF
 15880              END-IF
 15881           END-IF
 15882           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15883        END-IF
 15884        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 286
* EL050.cbl
 15885     END-IF
 15886     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15887
 15888     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15889
 15890     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15891                                    PB-C-LF-REM-TERM.
 15892
 15893     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15894     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15895
 15896     IF PB-COMPANY-ID EQUAL 'FLC'
 15897        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15898           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15899           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15900                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15901                    - CM-LF-ITD-DEATH-AMT
 15902           IF PB-C-LF-REF-CALC LESS THAN +0
 15903              MOVE +0            TO PB-C-LF-REF-CALC
 15904              GO TO 3730-GET-AH-REMAIN-TERM
 15905           ELSE
 15906              GO TO 3730-GET-AH-REMAIN-TERM.
 15907
 15908     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15909                            OR '4' OR '5' OR '6' OR '8'
 15910                            OR '9' OR 'G'
 15911        MOVE PB-C-LF-REFUND-OVERRIDE
 15912                                 TO CP-EARNING-METHOD.
 15913
 15914     if pb-company-id = 'AHL'
 15915        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15916        if cp-class-code = spaces
 15917           move zeros            to cp-class-code
 15918        end-if
 15919     ELSE
 15920        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15921     END-IF
 15922*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15923     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15924     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15925                                    CP-RATING-BENEFIT-AMT.
 15926     IF CP-STATE-STD-ABBRV = 'OR'
 15927         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15928                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15929     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15930     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15931     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15932     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15933     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15934     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15935     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15936     IF WS-DEFAULT-APR NOT NUMERIC
 15937         MOVE ZEROS TO WS-DEFAULT-APR.
 15938****   N O T E   ****
 15939*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15940*      THE OH HARD CODING IN ELCRFNDP
 15941
 15942     IF PB-COMPANY-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 287
* EL050.cbl
 15943        IF CP-STATE-STD-ABBRV = 'OH'
 15944           MOVE WS-LF-EARNINGS-CALC
 15945                                 TO CP-EARNING-METHOD
 15946        END-IF
 15947     END-IF
 15948
 15949****   N O T E   ****
 15950
 15951     IF CP-EARN-AS-NET-PAY
 15952         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15953            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15954                MOVE WS-DEFAULT-APR
 15955                                 TO  CP-LOAN-APR
 15956                MOVE ER-3780     TO  WS-ERROR
 15957                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15958            ELSE
 15959                MOVE ER-3781     TO  WS-ERROR
 15960                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15961*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15962     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15963
 15964     IF CP-REFUND-TYPE-USED NOT = SPACE
 15965         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15966
 15967     IF CP-ERROR-RATE-IS-ZERO OR
 15968        CP-ERROR-RATE-NOT-FOUND
 15969        MOVE ER-2740             TO WS-ERROR
 15970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15971
 15972     IF CP-ERROR-RATE-FILE-NOTOPEN
 15973        MOVE ER-2617             TO WS-ERROR
 15974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15975
 15976     IF PB-COMPANY-ID = 'DCC'
 15977        AND PB-CI-ENTRY-STATUS = 'M'
 15978        MOVE +0                  TO PB-C-LF-REF-CALC
 15979     ELSE
 15980        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15981     END-IF
 15982
 15983     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15984         GO TO 3730-GET-AH-REMAIN-TERM.
 15985
 15986*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15987*       ADD +1                   TO PB-C-LF-REM-TERM
 15988*                                   CP-REMAINING-TERM
 15989*                                   CP-ORIGINAL-TERM.
 15990
 15991     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15992     MOVE '2'                    TO CP-EARNING-METHOD
 15993                                    CP-RATING-METHOD.
 15994     IF PB-COMPANY-ID = 'CID'
 15995        IF (CP-STATE-STD-ABBRV = 'MN')
 15996           AND (PB-CERT-EFF-DT > X'A4FF')
 15997           AND (WS-LF-EARNINGS-CALC = 'B')
 15998           MOVE '5'              TO CP-EARNING-METHOD
 15999           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16000        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 288
* EL050.cbl
 16001     END-IF
 16002     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16003                                        CP-REMAINING-BENEFIT
 16004                                        CP-RATING-BENEFIT-AMT.
 16005     IF CP-STATE-STD-ABBRV = 'OR'
 16006         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16007                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16008     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16009     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16010
 16011     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16012
 16013     IF CP-ERROR-RATE-IS-ZERO OR
 16014        CP-ERROR-RATE-NOT-FOUND
 16015        MOVE ER-2740             TO WS-ERROR
 16016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16017
 16018     IF CP-ERROR-RATE-FILE-NOTOPEN
 16019        MOVE ER-2617             TO WS-ERROR
 16020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16021
 16022     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16023
 16024******************************************************************
 16025
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 289
* EL050.cbl
 16027 3730-GET-AH-REMAIN-TERM.
 16028     IF NO-AH-BENEFIT-MATCH  OR
 16029        WS-AH-BENEFIT-CD = ZEROS
 16030         GO TO 3770-CHECK-REFUNDS.
 16031
 16032     IF PB-CI-AH-LUMP-SUM-DISAB
 16033         IF  PB-C-AH-CANCEL-AMT = ZERO
 16034            IF NOT PB-COMP-AH-CANCEL
 16035             GO TO 3770-CHECK-REFUNDS.
 16036
 16037     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16038     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16039     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16040     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16041     MOVE PB-SV-STATE            TO CP-STATE.
 16042     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16043     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16044     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16045     MOVE '2'                    TO CP-PROCESS-TYPE.
 16046     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16047     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16048     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16049     IF (PB-COMPANY-ID = 'CID')
 16050        AND (CP-STATE-STD-ABBRV = 'WI')
 16051        MOVE '7'                 TO CP-REM-TERM-METHOD
 16052        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16053     ELSE
 16054        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16055        MOVE WS-REM-TRM-CALC-OPTION
 16056                                 TO CP-REM-TRM-CALC-OPTION
 16057     END-IF
 16058     IF (PB-COMPANY-ID = 'CID')
 16059        AND (CP-STATE-STD-ABBRV = 'MO')
 16060        AND (PB-CERT-EFF-DT >= X'9B41')
 16061        AND (PB-CERT-EFF-DT <= X'A2FB')
 16062        MOVE '7'                 TO CP-REM-TERM-METHOD
 16063        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16064     END-IF
 16065     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16066                                    CP-LOAN-TERM.
 16067     IF NOT CP-TERM-IS-DAYS
 16068         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16069
 16070     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16071
 16072     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16073
 16074     IF AH-COVERAGE-CANCELLED
 16075        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16076        NEXT SENTENCE
 16077      ELSE
 16078         GO TO 3770-CHECK-REFUNDS.
 16079
 16080 3740-GET-AH-REFUND.
 16081
 16082     IF PB-C-LF-CANCEL-VOIDED OR
 16083        PB-C-AH-CANCEL-VOIDED
 16084        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 290
* EL050.cbl
 16085
 16086     IF PB-COMPANY-ID = 'BOA'
 16087         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16088         GO TO 3770-CHECK-REFUNDS.
 16089
 16090     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16091*    MOVE ' '                    TO DC-OPTION-CODE
 16092     SET BIN-TO-GREG             TO TRUE
 16093     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16094     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16095                                    PB-C-AH-REM-TERM.
 16096     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16097     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16098
 16099     IF PB-COMPANY-ID EQUAL 'FLC'
 16100        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16101           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16102           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16103                    - CM-AH-ITD-AH-PMT)
 16104           IF PB-C-AH-REF-CALC LESS THAN +0
 16105              MOVE +0            TO PB-C-AH-REF-CALC
 16106              GO TO 3770-CHECK-REFUNDS
 16107           ELSE
 16108              GO TO 3770-CHECK-REFUNDS.
 16109
 16110     IF PB-COMPANY-ID = 'DCC'
 16111        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16112            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16113           MOVE 'S'              TO CP-EARNING-METHOD
 16114        END-IF
 16115     END-IF
 16116     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16117                            OR '4' OR '5' OR '6' OR '8'
 16118                            OR '9' OR 'G' OR 'S'
 16119        MOVE PB-C-AH-REFUND-OVERRIDE
 16120                                 TO CP-EARNING-METHOD.
 16121
 16122     if pb-company-id = 'AHL'
 16123        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16124        if cp-class-code = spaces
 16125           move zeros            to cp-class-code
 16126        end-if
 16127     ELSE
 16128        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16129     END-IF
 16130*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16131     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16132     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16133                                    CP-RATING-BENEFIT-AMT.
 16134     IF CP-STATE-STD-ABBRV = 'OR'
 16135         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16136                                         PB-CI-AH-TERM.
 16137     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16138     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16139     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16140     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16141     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16142     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 291
* EL050.cbl
 16143
 16144     IF CP-STATE-STD-ABBRV = 'OH'
 16145        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16146                                AND 'CID' AND 'DCC' AND 'AHL')
 16147           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16148              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16149              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16150              MOVE '6' TO CP-EARNING-METHOD
 16151           END-IF
 16152        END-IF
 16153        IF PB-COMPANY-ID = 'CID'
 16154           IF NO-LIFE-COVERAGE
 16155              IF CP-CRITICAL-PERIOD
 16156                 MOVE '2'       TO CP-EARNING-METHOD
 16157              ELSE
 16158                 MOVE '6'       TO CP-EARNING-METHOD
 16159              END-IF
 16160           ELSE
 16161              IF WS-LF-COVERAGE-TYPE = 'L'
 16162                 MOVE '2'       TO CP-EARNING-METHOD
 16163              ELSE
 16164                 IF (PB-CI-LF-TERM > +60) OR
 16165                    (WS-LF-EARNINGS-CALC = '5')
 16166                    IF CP-CRITICAL-PERIOD
 16167                       MOVE '2'  TO CP-EARNING-METHOD
 16168                    ELSE
 16169                       MOVE '6'  TO CP-EARNING-METHOD
 16170                    END-IF
 16171                 ELSE
 16172                    MOVE '1'     TO CP-EARNING-METHOD
 16173                 END-IF
 16174              END-IF
 16175           END-IF
 16176        END-IF
 16177     END-IF
 16178
 16179*    IF CP-STATE-STD-ABBRV = 'VA'
 16180*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16181*          IF CP-ORIGINAL-TERM GREATER 61
 16182*             MOVE '6' TO CP-EARNING-METHOD
 16183*          ELSE
 16184*             MOVE '1' TO CP-EARNING-METHOD.
 16185
 16186     IF WS-DEFAULT-APR NOT NUMERIC
 16187         MOVE ZEROS TO WS-DEFAULT-APR.
 16188     IF CP-EARN-AS-NET-PAY
 16189         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16190            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16191                MOVE WS-DEFAULT-APR
 16192                                 TO  CP-LOAN-APR
 16193                MOVE ER-3780     TO  WS-ERROR
 16194                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16195            ELSE
 16196                MOVE ER-3781     TO  WS-ERROR
 16197                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16198     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16199     IF PB-COMPANY-ID = 'DCC'
 16200        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 292
* EL050.cbl
 16201        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16202        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16203     END-IF
 16204     IF PB-COMPANY-ID = 'DCC'
 16205        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16206        AND (CP-EARNING-METHOD = 'D')
 16207        AND (CP-CANCEL-REASON NOT = 'R')
 16208        CONTINUE
 16209     ELSE
 16210        GO TO 3750-CONTINUE
 16211     END-IF
 16212     MOVE ' '                    TO DD-IU-SW
 16213     IF NOT PDEF-MASTER-FOUND
 16214        MOVE ' '                 TO PDEF-MASTER-SW
 16215        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16216        MOVE PB-STATE            TO ERPDEF-STATE
 16217        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16218        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16219        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16220        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16221        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16222        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16223        IF PDEF-MASTER-FOUND
 16224           MOVE 'N'              TO PDEF-MASTER-SW
 16225           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16226           IF PDEF-MASTER-FOUND
 16227              IF (ERPDEF-KEY-SAVE (1:16) =
 16228                           PD-CONTROL-PRIMARY (1:16))
 16229                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16230                 CONTINUE
 16231              ELSE
 16232                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16233                 IF (ERPDEF-KEY-SAVE (1:16) =
 16234                           PD-CONTROL-PRIMARY (1:16))
 16235                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16236                    CONTINUE
 16237                 ELSE
 16238                    MOVE ER-2740 TO WS-ERROR
 16239                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16240                    GO TO 3770-CHECK-REFUNDS
 16241                 END-IF
 16242              END-IF
 16243           END-IF
 16244           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16245        END-IF
 16246     END-IF
 16247     IF PDEF-MASTER-FOUND
 16248        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16249           (V1 > +8)
 16250           OR (PD-PROD-CODE (V1) = 'I')
 16251        END-PERFORM
 16252        IF V1 < +9
 16253           SET DD-IU-PRESENT        TO TRUE
 16254        END-IF
 16255        IF WS-AH-DCC-TRUNC = 'T'
 16256           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16257        ELSE
 16258           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 293
* EL050.cbl
 16259        END-IF
 16260        EVALUATE TRUE
 16261           WHEN WS-TERM > +168
 16262              MOVE 15               TO V1
 16263           WHEN WS-TERM > +156
 16264              MOVE 14               TO V1
 16265           WHEN WS-TERM > +144
 16266              MOVE 13               TO V1
 16267           WHEN WS-TERM > +132
 16268              MOVE 12               TO V1
 16269           WHEN WS-TERM > +120
 16270              MOVE 11               TO V1
 16271           WHEN WS-TERM > +108
 16272              MOVE 10               TO V1
 16273           WHEN WS-TERM > +96
 16274              MOVE 9                TO V1
 16275           WHEN WS-TERM > +84
 16276              MOVE 8                TO V1
 16277           WHEN WS-TERM > +72
 16278              MOVE 7                TO V1
 16279           WHEN WS-TERM > +60
 16280              MOVE 6                TO V1
 16281           WHEN WS-TERM > +48
 16282              MOVE 5                TO V1
 16283           WHEN WS-TERM > +36
 16284              MOVE 4                TO V1
 16285           WHEN WS-TERM > +24
 16286              MOVE 3                TO V1
 16287           WHEN WS-TERM > +12
 16288              MOVE 2                TO V1
 16289           WHEN OTHER
 16290              MOVE 1                TO V1
 16291        END-EVALUATE
 16292
 16293        EVALUATE TRUE
 16294*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16295*             < +13)
 16296*             AND (DD-IU-PRESENT)
 16297*             MOVE 2                TO V2
 16298*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16299*             MOVE 1                TO V2
 16300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16301              MOVE 2                TO V2
 16302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16303              MOVE 3                TO V2
 16304           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16305              MOVE 4                TO V2
 16306           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16307              MOVE 5                TO V2
 16308           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16309              MOVE 6                TO V2
 16310           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16311              MOVE 7                TO V2
 16312           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16313              MOVE 8                TO V2
 16314           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16315              MOVE 9                TO V2
 16316           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 294
* EL050.cbl
 16317              MOVE 10               TO V2
 16318           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16319              MOVE 11               TO V2
 16320           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16321              MOVE 12               TO V2
 16322           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16323              MOVE 13               TO V2
 16324           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16325              MOVE 14               TO V2
 16326           WHEN OTHER
 16327              MOVE 15               TO V2
 16328        END-EVALUATE
 16329
 16330        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16331                                 TO CP-DDF-LO-FACT
 16332        MOVE PD-UEP-FACTOR (V1 V2)
 16333                                 TO CP-DDF-HI-FACT
 16334
 16335        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16336        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16337        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16338           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16339        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16340        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16341        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16342           + PD-1ST-YR-ADMIN-ALLOW
 16343
 16344        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16345*       IF PI-CLP-YN = 'Y'
 16346*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16347*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16348*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16349*       END-IF
 16350
 16351        IF DD-IU-PRESENT
 16352           MOVE 'I'              TO CP-EARNING-METHOD
 16353        END-IF
 16354        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16355                                     CP-CLP-RATE-UP
 16356        IF CP-IU-RATE-UP NOT = ZEROS
 16357           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16358              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16359           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16360              / (1 - WS-WORK-FACT)
 16361        END-IF
 16362     END-IF
 16363     .
 16364 3750-CONTINUE.
 16365     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16366
 16367     IF CP-REFUND-TYPE-USED NOT = SPACE
 16368         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16369
 16370     IF CP-ERROR-RATE-IS-ZERO OR
 16371        CP-ERROR-RATE-NOT-FOUND
 16372        MOVE ER-2740             TO WS-ERROR
 16373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16374
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 295
* EL050.cbl
 16375     IF CP-ERROR-RATE-FILE-NOTOPEN
 16376        MOVE ER-2617             TO WS-ERROR
 16377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16378     IF PB-COMPANY-ID = 'DCC'
 16379        AND PB-CI-ENTRY-STATUS = 'M'
 16380        MOVE +0                  TO PB-C-AH-REF-CALC
 16381     ELSE
 16382        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16383     END-IF
 16384     IF PB-COMPANY-ID = 'DCC'
 16385        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16386        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16387        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16388        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16389        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16390        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16391        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16392        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16393        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16394     END-IF
 16395     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 296
* EL050.cbl
 16397
 16398 3770-CHECK-REFUNDS.
 16399
 16400     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16401        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16402           MOVE ER-2766          TO WS-ERROR
 16403           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16404           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16405           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16406              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16407
 16408     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16409        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16410           MOVE ER-2766          TO WS-ERROR
 16411           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16412           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16413           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16414              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16415
 16416     IF PB-COMP-LF-CANCEL
 16417        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16418        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16419           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16420              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16421
 16422     IF PB-COMP-AH-CANCEL
 16423        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16424        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16425           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16426              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16427
 16428     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16429             GIVING WS-UNSIGN-WRK1
 16430     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16431             GIVING WS-UNSIGN-WRK2.
 16432
 16433     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16434         MOVE ZERO TO WS-UNSIGN-WRK1.
 16435
 16436     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16437         MOVE ZERO TO WS-UNSIGN-WRK2.
 16438
 16439     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16440
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 297
* EL050.cbl
 16442
 16443 3772-CONTINUE.
 16444
 16445**********************************
 16446*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16447*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16448*** DOUBLES THE TOLERANCE AMOUNT.
 16449***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16450**********************************
 16451     IF PB-COMPANY-ID = 'MON'
 16452     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16453         IF WS-REF-REJECT-SW = SPACE
 16454             MOVE ER-2754        TO WS-ERROR
 16455             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16456           ELSE
 16457             MOVE ER-2736        TO WS-ERROR
 16458             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16459**********************************
 16460
 16461 3773-CONTINUE.
 16462
 16463     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16464        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16465           MOVE ER-2723          TO WS-ERROR
 16466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467
 16468     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16469        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16470           MOVE ER-2724          TO WS-ERROR
 16471           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16472
 16473     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16474         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16475             (1 + WS-LF-REFUND-OVS-PCT)
 16476     ELSE
 16477         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16478
 16479     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16480         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16481             (1 - WS-TOL-LF-REFUND-PCT)
 16482     ELSE
 16483         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16484
 16485     IF (PB-COMPANY-ID = 'DCC')
 16486        AND (PB-CI-ENTRY-STATUS = 'M')
 16487        AND (PB-C-LF-CANCEL-AMT > +0)
 16488        MOVE ER-3843             TO WS-ERROR
 16489        PERFORM 9900-ERROR-FORMAT
 16490                                 THRU 9900-EXIT
 16491     END-IF
 16492     EVALUATE TRUE
 16493        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16494           CONTINUE
 16495        WHEN PB-C-LF-CANCEL-AMT = +0
 16496                 AND PB-C-LF-REF-CALC > +0
 16497           CONTINUE
 16498        WHEN WS-LF-REFUND-OVS-AMT = 0
 16499                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 298
* EL050.cbl
 16500           CONTINUE
 16501        WHEN OTHER
 16502           IF WS-TOL-LF-REFUND  = +0
 16503              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16504           END-IF
 16505           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16506                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16507                          (PB-C-LF-CANCEL-AMT))
 16508              CONTINUE
 16509           ELSE
 16510              IF WS-LF-REFUND-OVS-AMT = +0
 16511                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16512              END-IF
 16513              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16514                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16515                                       PB-C-LF-CANCEL-AMT)
 16516                 CONTINUE
 16517              ELSE
 16518                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16519                   MOVE ER-2754   TO  WS-ERROR
 16520                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16521                 ELSE
 16522                    MOVE ER-2736   TO  WS-ERROR
 16523                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16524                 END-IF
 16525              END-IF
 16526           END-IF
 16527     END-EVALUATE.
 16528
 16529     EVALUATE TRUE
 16530        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16531           CONTINUE
 16532        WHEN PB-C-LF-CANCEL-AMT = +0
 16533                 AND PB-C-LF-REF-CALC > +0
 16534           CONTINUE
 16535        WHEN OTHER
 16536           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16537               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16538              CONTINUE
 16539           ELSE
 16540              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16541               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16542                CONTINUE
 16543              ELSE
 16544                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16545                     MOVE ER-2754   TO  WS-ERROR
 16546                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16547                 ELSE
 16548                     MOVE ER-2736   TO  WS-ERROR
 16549                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16550                 END-IF
 16551              END-IF
 16552           END-IF
 16553     END-EVALUATE.
 16554
 16555     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16556         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16557             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 299
* EL050.cbl
 16558     ELSE
 16559         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16560
 16561     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16562         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16563             (1 - WS-TOL-AH-REFUND-PCT)
 16564     ELSE
 16565         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16566
 16567     IF (PB-COMPANY-ID = 'DCC')
 16568        AND (PB-CI-ENTRY-STATUS = 'M')
 16569        AND (PB-C-AH-CANCEL-AMT > +0)
 16570        MOVE ER-3843             TO WS-ERROR
 16571        PERFORM 9900-ERROR-FORMAT
 16572                                 THRU 9900-EXIT
 16573     END-IF
 16574     EVALUATE TRUE
 16575        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16576           CONTINUE
 16577*       WHEN PB-C-AH-REF-CALC = +0 AND
 16578*                  PB-C-AH-CANCEL-AMT > +0
 16579        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16580                   PB-C-AH-REF-CALC > +0
 16581           CONTINUE
 16582        WHEN WS-AH-REFUND-OVS-AMT = +0
 16583                AND WS-TOL-AH-REFUND = +0
 16584           CONTINUE
 16585        WHEN OTHER
 16586           IF WS-TOL-AH-REFUND = +0
 16587              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16588           END-IF
 16589           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16590               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16591                                         PB-C-AH-CANCEL-AMT)
 16592              CONTINUE
 16593           ELSE
 16594              IF WS-AH-REFUND-OVS-AMT = +0
 16595                 MOVE +9999999.99 TO
 16596                         WS-AH-REFUND-OVS-AMT
 16597              END-IF
 16598              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16599                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16600                                         PB-C-AH-CANCEL-AMT)
 16601                 CONTINUE
 16602              ELSE
 16603                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16604                    MOVE ER-2754   TO  WS-ERROR
 16605                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16606                 ELSE
 16607                    MOVE ER-2736   TO  WS-ERROR
 16608                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16609                 END-IF
 16610              END-IF
 16611           END-IF
 16612     END-EVALUATE.
 16613
 16614     EVALUATE TRUE
 16615        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 300
* EL050.cbl
 16616           CONTINUE
 16617*       WHEN PB-C-AH-REF-CALC > +0 AND
 16618*                  PB-C-AH-CANCEL-AMT = +0
 16619        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16620                   PB-C-AH-REF-CALC = +0
 16621           CONTINUE
 16622        WHEN OTHER
 16623           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16624               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16625              CONTINUE
 16626           ELSE
 16627              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16628                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16629                 CONTINUE
 16630              ELSE
 16631                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16632                     MOVE ER-2754   TO  WS-ERROR
 16633                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16634                 ELSE
 16635                     MOVE ER-2736   TO  WS-ERROR
 16636                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16637                 END-IF
 16638              END-IF
 16639           END-IF
 16640     END-EVALUATE.
 16641
 16642     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16643        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16644        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16645           AND  PB-C-LF-REF-CALC < +1.00
 16646           AND  PB-C-AH-REF-CALC < +1.00
 16647           CONTINUE
 16648        ELSE
 16649           IF (PB-COMPANY-ID = 'DCC')
 16650              AND (PB-CI-ENTRY-STATUS = 'M')
 16651              CONTINUE
 16652           ELSE
 16653              MOVE ER-2741       TO WS-ERROR
 16654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16655           END-IF
 16656        END-IF
 16657     END-IF
 16658
 16659     IF (PB-C-LF-CANCEL-AMT = ZERO
 16660        AND WS-LF-BENEFIT-CD NOT = ZERO
 16661        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16662        AND PB-C-LF-REF-CALC NOT = ZERO)
 16663        OR
 16664        (PB-C-LF-CANCEL-AMT = ZERO
 16665        AND WS-LF-BENEFIT-CD NOT = ZERO
 16666        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16667             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16668                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16669                NEXT SENTENCE
 16670             ELSE
 16671                MOVE ER-2739        TO WS-ERROR
 16672                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16673
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 301
* EL050.cbl
 16674     IF (PB-C-AH-CANCEL-AMT = ZERO
 16675        AND WS-AH-BENEFIT-CD NOT = ZERO
 16676        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16677        AND PB-C-AH-REF-CALC NOT = ZERO)
 16678        OR
 16679        (PB-C-AH-CANCEL-AMT = ZERO
 16680        AND WS-AH-BENEFIT-CD NOT = ZERO
 16681        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16682             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16683                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16684                NEXT SENTENCE
 16685             ELSE
 16686                MOVE ER-2738        TO WS-ERROR
 16687                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16688
 16689 3775-OVER-REF-CHK.
 16690
 16691     IF PB-CI-ENTRY-STATUS = '5'
 16692        GO TO 3780-UPDATE-CANCEL-CERT.
 16693
 16694     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16695                              PB-CI-LF-ALT-PREMIUM-AMT.
 16696
 16697     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16698        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16699                                 PB-C-LF-REF-CALC
 16700      ELSE
 16701        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16702                                 PB-C-LF-CANCEL-AMT.
 16703
 16704     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16705        MOVE ER-2755             TO WS-ERROR
 16706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16707
 16708     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16709
 16710     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16711        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16712                                 PB-C-AH-REF-CALC
 16713      ELSE
 16714        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16715                                 PB-C-AH-CANCEL-AMT.
 16716
 16717     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16718        MOVE ER-2778             TO WS-ERROR
 16719        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16720
 16721     IF PB-CI-OB-FLAG NOT = 'Z'
 16722        NEXT SENTENCE
 16723       ELSE
 16724         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16725            MOVE ER-2757           TO WS-ERROR
 16726            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728 3780-UPDATE-CANCEL-CERT.
 16729
 16730     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16731        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 302
* EL050.cbl
 16732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16733
 16734     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16735         MOVE ER-2729              TO WS-ERROR
 16736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16737
 16738     IF PB-CI-LF-BENEFIT-CD = ZERO
 16739         GO TO 3780-UPDATE-CONT-1.
 16740
 16741     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16742         GO TO 3780-UPDATE-CONT-1.
 16743
 16744     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16745       AND
 16746        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16747       AND
 16748        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16749       AND
 16750        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16751            NEXT SENTENCE
 16752       ELSE
 16753        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16754          AND
 16755***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16756***       AND
 16757           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16758            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16759               MOVE ER-2730      TO WS-ERROR
 16760               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16761               GO TO 3999-END-EDIT
 16762            ELSE
 16763               GO TO 3999-END-EDIT
 16764        ELSE
 16765            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16766               MOVE ER-2765           TO WS-ERROR
 16767               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16768               GO TO 3785-CHECK-NH.
 16769*              GO TO 3999-END-EDIT.
 16770
 16771 3780-UPDATE-CONT-1.
 16772     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16773
 16774     IF PB-CI-AH-BENEFIT-CD = ZERO
 16775         GO TO 3780-UPDATE-CONT-2.
 16776
 16777     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16778         GO TO 3780-UPDATE-CONT-2.
 16779
 16780     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16781
 16782     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16783       AND
 16784        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16785       AND
 16786        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16787       AND
 16788        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16789            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 303
* EL050.cbl
 16790       ELSE
 16791        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16792          AND
 16793***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16794***       AND
 16795           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16796           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16797            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16798               MOVE ER-2773      TO WS-ERROR
 16799               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16800               GO TO 3999-END-EDIT
 16801            ELSE
 16802               GO TO 3999-END-EDIT
 16803            END-IF
 16804           ELSE
 16805             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16806                MOVE ER-2890 TO WS-ERROR
 16807                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16808                GO TO 3999-END-EDIT
 16809             ELSE
 16810                GO TO 3785-CHECK-NH
 16811             END-IF
 16812           END-IF
 16813          ELSE
 16814            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16815              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16816                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16817                   MOVE ER-2890 TO WS-ERROR
 16818                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16819                   GO TO 3999-END-EDIT
 16820                ELSE
 16821                   MOVE ER-2765 TO WS-ERROR
 16822                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16823                   GO TO 3785-CHECK-NH
 16824                END-IF
 16825              ELSE
 16826               MOVE ER-2765      TO WS-ERROR
 16827               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16828               GO TO 3785-CHECK-NH.
 16829*              GO TO 3999-END-EDIT.
 16830
 16831 3780-UPDATE-CONT-2.
 16832
 16833     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16834        AND WS-LF-BENEFIT-CD = ZERO
 16835           MOVE ER-2743           TO WS-ERROR
 16836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16837
 16838     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16839        AND WS-AH-BENEFIT-CD = ZERO
 16840           MOVE ER-2744           TO WS-ERROR
 16841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16842
 16843     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16844        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16845        AND
 16846        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16847         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 304
* EL050.cbl
 16848           MOVE ER-2746           TO WS-ERROR
 16849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16850
 16851     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16852       AND
 16853        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16854             MOVE ER-2737        TO WS-ERROR
 16855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16856
 16857     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16858       AND
 16859        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16860             MOVE ER-2737        TO WS-ERROR
 16861             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16862
 16863     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16864         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16865             OR 'CID' OR 'DCC' OR 'AHL'
 16866             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16867         ELSE
 16868             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16869                 MOVE ER-2768    TO WS-ERROR
 16870                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16871             ELSE
 16872                 MOVE ER-2756    TO WS-ERROR
 16873                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16874
 16875     IF CERT-PEND-ISSUE-RETURNED
 16876        MOVE ER-2772             TO WS-ERROR
 16877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16878 3785-CHECK-NH.
 16879     IF PB-STATE NOT = 'NH'
 16880        GO TO 3999-END-EDIT
 16881     END-IF
 16882
 16883     MOVE ER-2796                TO WS-ERROR
 16884     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16885     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16886        OR (CM-NH-INTERFACE-SW = 'Y')
 16887        MOVE ER-2793             TO WS-ERROR
 16888        PERFORM 9900-ERROR-FORMAT
 16889                                 THRU 9900-EXIT
 16890     END-IF
 16891     MOVE +0                     TO WS-PAYMENT-AMT
 16892     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16893        GO TO 3999-END-EDIT
 16894     END-IF
 16895     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16896        GO TO 3999-END-EDIT
 16897     END-IF
 16898     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16899     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16900     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16901        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16902     END-IF
 16903     MOVE '1'                    TO DC-OPTION-CODE
 16904     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16905     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 305
* EL050.cbl
 16906        IF DC-ELAPSED-DAYS < +16
 16907           GO TO 3999-END-EDIT
 16908        END-IF
 16909     END-IF
 16910     MOVE +0                     TO DC-ELAPSED-DAYS
 16911     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16912     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16913     MOVE '1'                    TO DC-OPTION-CODE
 16914     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16915     IF NO-CONVERSION-ERROR
 16916        IF DC-ELAPSED-DAYS > +30
 16917           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16918        ELSE
 16919           GO TO 3999-END-EDIT
 16920        END-IF
 16921     ELSE
 16922        GO TO 3999-END-EDIT
 16923     END-IF
 16924     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16925        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16926           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16927     IF WS-PAYMENT-AMT < 600.00
 16928        GO TO 3999-END-EDIT
 16929     END-IF
 16930     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16931
 16932     IF (ERMAIL-FOUND = ' ')
 16933         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16934         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16935        GO TO 3999-END-EDIT
 16936     END-IF
 16937     MOVE ER-2795                TO WS-ERROR
 16938     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16939
 16940     GO TO 3999-END-EDIT.
 16941******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 306
* EL050.cbl
 16943 3990-FILES-NOT-OPEN.
 16944
 16945     MOVE ER-2617                TO WS-ERROR.
 16946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16947     GO TO 9990-RETURN.
 16948
 16949 3999-END-EDIT.
 16950
 16951     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16952
 16953     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16954         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16955         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16956             PERFORM 9250-UNLOCK-RETURN
 16957             GO TO 9990-RETURN
 16958          ELSE
 16959             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16960             GO TO 9990-RETURN.
 16961
 16962     IF PB-CANCELLATION
 16963          GO TO 9990-RETURN.
 16964
 16965     IF CERT-WAS-NOT-FOUND
 16966        MOVE SPACES              TO CERTIFICATE-MASTER.
 16967
 16968     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16969
 16970     IF CERT-WAS-FOUND
 16971         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16972             PERFORM 9250-UNLOCK-RETURN
 16973          ELSE
 16974            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16975      ELSE
 16976         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16977
 16978     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16979        IF PB-COMPANY-ID = 'DCC' AND
 16980           (PB-CARRIER = '2' OR '4' OR '6')
 16981              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16982        END-IF
 16983     END-IF.
 16984
 16985     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16986         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16987     END-IF.
 16988     move ' '                    to ws-ins-age-defaulted
 16989     perform 8150-read-elcrtt    thru 8150-exit
 16990     if ws-ins-age-defaulted = 'Y'
 16991        move er-1573             to ws-error
 16992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16993     end-if
 16994
 16995     if ws-jnt-age-defaulted = 'Y'
 16996        move er-1574             to ws-error
 16997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16998     end-if
 16999
 17000     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 307
* EL050.cbl
 17001     IF ((PB-COMPANY-ID = 'DCC')
 17002        AND (WS-NO-SECURE-PAY))
 17003                  OR
 17004        (WS-LF-SPECIAL-CALC-CD = 'O'
 17005        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17006        SET SKIP-ADDR-EDIT       TO TRUE
 17007     END-IF
 17008     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17009        AND (NOT SKIP-ADDR-EDIT)
 17010        MOVE ER-2963             TO WS-ERROR
 17011        PERFORM 9900-ERROR-FORMAT
 17012                                 THRU 9900-EXIT
 17013        GO TO 9990-RETURN
 17014     END-IF
 17015     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17016     IF ERPNDM-FOUND NOT = 'X'
 17017        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17018           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17019           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17020           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17021           AND (NOT SKIP-ADDR-EDIT)
 17022           MOVE ER-2694          TO WS-ERROR
 17023           PERFORM 9900-ERROR-FORMAT
 17024                                 THRU 9900-EXIT
 17025        END-IF
 17026        MOVE ' '                 TO STATE-RECORD-ERROR
 17027        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17028        MOVE PM-STATE            TO CNTL-ACCESS
 17029        MOVE '3'                 TO CNTL-REC-TYPE
 17030        MOVE +0                  TO CNTL-SEQ-NO
 17031        MOVE '0'                 TO RC-SW-2
 17032        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17033        IF (NO-STATE-RECORD)
 17034           OR (CF-RECORD-TYPE NOT = '3')
 17035           OR (PM-STATE NOT = CF-STATE-CODE)
 17036           IF (PM-STATE = SPACES)
 17037              AND (SKIP-ADDR-EDIT)
 17038              CONTINUE
 17039           ELSE
 17040              MOVE ER-2963       TO WS-ERROR
 17041              PERFORM 9900-ERROR-FORMAT
 17042                                 THRU 9900-EXIT
 17043           END-IF
 17044        END-IF
 17045        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17046           MOVE ER-2883          TO WS-ERROR
 17047           PERFORM 9900-ERROR-FORMAT
 17048                                 THRU 9900-EXIT
 17049        END-IF
 17050        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17051           MOVE ' '                 TO STATE-RECORD-ERROR
 17052           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17053           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17054           MOVE '3'                 TO CNTL-REC-TYPE
 17055           MOVE +0                  TO CNTL-SEQ-NO
 17056           MOVE '0'                 TO RC-SW-2
 17057           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17058           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 308
* EL050.cbl
 17059              OR (CF-RECORD-TYPE NOT = '3')
 17060              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17061              MOVE ER-2964          TO WS-ERROR
 17062              PERFORM 9900-ERROR-FORMAT
 17063                                    THRU 9900-EXIT
 17064           END-IF
 17065        END-IF
 17066     ELSE
 17067        IF NOT SKIP-ADDR-EDIT
 17068           MOVE ER-2393          TO WS-ERROR
 17069           PERFORM 9900-ERROR-FORMAT
 17070                                 THRU 9900-EXIT
 17071        END-IF
 17072     END-IF
 17073
 17074     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17075
 17076     IF (ERMAIL-FOUND = ' ' AND
 17077        ERPNDM-FOUND = ' ')
 17078        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17079           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17080           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17081          OR
 17082           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17083          OR
 17084           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17085           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17086           GO TO 3999-UNLOCK-ERMAIL.
 17087
 17088     IF ERPNDM-FOUND = 'X'
 17089        GO TO 3999-UNLOCK-ERMAIL.
 17090
 17091     IF PM-INSURED-LAST-NAME      = SPACES
 17092        AND PM-INSURED-FIRST-NAME = SPACES
 17093        AND PM-ADDRESS-LINE-1     = SPACES
 17094        AND PM-ADDRESS-LINE-2     = SPACES
 17095        AND PM-CITY-STATE         = SPACES
 17096        AND PM-CRED-BENE-NAME     = SPACES
 17097        AND PM-CRED-BENE-ADDR     = SPACES
 17098        AND PM-CRED-BENE-CTYST    = SPACES
 17099        GO TO 3999-UNLOCK-ERMAIL
 17100     END-IF
 17101
 17102     MOVE SPACES                 TO MAILING-DATA.
 17103
 17104     MOVE 'MA'                   TO MA-RECORD-ID.
 17105     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17106     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17107     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17108     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17109     MOVE PB-SV-STATE            TO MA-STATE.
 17110     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17111     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17112
 17113     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17114     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17115
 17116     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 309
* EL050.cbl
 17117        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17118     ELSE
 17119        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17120        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17121        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17122
 17123     GO TO 9990-RETURN.
 17124
 17125 3999-UNLOCK-ERMAIL.
 17126     IF ERMAIL-FOUND = ' '
 17127        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17128
 17129     GO TO 9990-RETURN.
 17130******************************************************************
 17131
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 310
* EL050.cbl
 17133 4000-UPDATE-CANCELLED-CERT.
 17134     IF CERT-WAS-NOT-FOUND
 17135        GO TO 4299-EXIT.
 17136
 17137*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17138     IF PB-C-NH-INT-ON-REFS > ZEROS
 17139        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17140     END-IF
 17141     IF PB-C-REF-INTERFACE-SW = 'Y'
 17142        MOVE PB-C-REF-INTERFACE-SW
 17143                                 TO CM-NH-INTERFACE-SW
 17144     END-IF
 17145     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17146     IF ERMAIL-FOUND = 'X'
 17147        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17148        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17149        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17150        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17151           MOVE ER-2694          TO WS-ERROR
 17152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17153     END-IF
 17154
 17155     IF PB-C-POST-CARD-IND = 'Y'
 17156        MOVE +8                  TO SUB
 17157*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17158        IF ERMAIL-FOUND = ' '
 17159           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17160              (SUB > +7)
 17161              OR (MA-MAIL-STATUS (SUB) = '1')
 17162           END-PERFORM
 17163        END-IF
 17164        IF (SUB > +7)
 17165           OR (ERMAIL-FOUND = 'X')
 17166           MOVE ER-3789          TO WS-ERROR
 17167           PERFORM 9900-ERROR-FORMAT
 17168                                 THRU 9900-EXIT
 17169        END-IF
 17170     ELSE
 17171        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17172     END-IF
 17173
 17174     IF ERMAIL-FOUND = ' '
 17175        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17176     END-IF.
 17177
 17178     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17179
 17180     IF PB-CI-OB-FLAG = 'Z'
 17181        GO TO 4150-SUMMARY-CERT-CANCEL.
 17182
 17183     IF PB-C-LF-CANCEL-VOIDED
 17184         PERFORM 4200-REVERSE-LF-CANCEL.
 17185     IF PB-C-AH-CANCEL-VOIDED
 17186         PERFORM 4200-REVERSE-AH-CANCEL.
 17187
 17188 4100-APPLY-LF-CANCEL.
 17189
 17190     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 311
* EL050.cbl
 17191
 17192 4100-CHECK-LF-ERRORS.
 17193
 17194     ADD +1                       TO WS-SUB.
 17195
 17196     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17197        IF LF-COVERAGE-CANCELLED
 17198           GO TO 4100-LF-CANCEL-CONT
 17199        ELSE
 17200           GO TO 4100-UPDATE-LF-COVERAGE.
 17201
 17202     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17203                                   ER-2729 OR
 17204                                   ER-2730 OR
 17205                                   ER-2731 OR
 17206                                   ER-2732 OR
 17207                                   ER-2737 OR
 17208                                   ER-2740 OR
 17209                                   ER-2743 OR
 17210                                   ER-2749 OR
 17211                                   ER-2750 OR
 17212                                   ER-2755 OR
 17213                                   ER-2757 OR
 17214                                   ER-2760 OR
 17215                                   ER-2772 OR
 17216                                   ER-2774 OR
 17217                                   ER-2776 OR
 17218                                   ER-2794
 17219        GO TO 4100-UPDATE-LF-COVERAGE.
 17220
 17221     GO TO 4100-CHECK-LF-ERRORS.
 17222
 17223 4100-UPDATE-LF-COVERAGE.
 17224
 17225     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17226     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17227     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17228        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17229     END-IF
 17230     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17231                                      TO CM-CREDIT-INTERFACE-SW-2.
 17232     IF CM-LF-CANCEL-DT = LOW-VALUE
 17233         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17234
 17235     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17236         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17237                                         CM-LF-STATUS-AT-CANCEL.
 17238
 17239     GO TO 4100-APPLY-AH-CANCEL.
 17240
 17241 4100-LF-CANCEL-CONT.
 17242     IF PB-C-LF-CANCEL-VOIDED
 17243         GO TO 4100-APPLY-AH-CANCEL.
 17244
 17245     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17246         GO TO 4100-APPLY-AH-CANCEL.
 17247
 17248     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 312
* EL050.cbl
 17249        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17250           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17251        ELSE
 17252           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17253
 17254     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17255     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17256
 17257     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17258         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17259
 17260     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17261        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17262         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17263         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17264
 17265     IF PB-RECORD-RETURNED
 17266        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17267      ELSE
 17268        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17269
 17270 4100-APPLY-AH-CANCEL.
 17271
 17272     MOVE +0                      TO WS-SUB.
 17273
 17274 4100-CHECK-AH-ERRORS.
 17275
 17276     ADD +1                       TO WS-SUB.
 17277
 17278     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17279        IF AH-COVERAGE-CANCELLED
 17280           GO TO 4100-AH-CANCEL-CONT
 17281        ELSE
 17282           GO TO 4100-UPDATE-AH-COVERAGE.
 17283
 17284     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17285                                   ER-2729 OR
 17286                                   ER-2732 OR
 17287                                   ER-2737 OR
 17288                                   ER-2740 OR
 17289                                   ER-2744 OR
 17290                                   ER-2749 OR
 17291                                   ER-2750 OR
 17292                                   ER-2755 OR
 17293                                   ER-2757 OR
 17294                                   ER-2760 OR
 17295                                   ER-2771 OR
 17296                                   ER-2772 OR
 17297                                   ER-2773 OR
 17298                                   ER-2775 OR
 17299                                   ER-2777 OR
 17300                                   ER-2794
 17301        GO TO 4100-UPDATE-AH-COVERAGE.
 17302
 17303     GO TO 4100-CHECK-AH-ERRORS.
 17304
 17305 4100-UPDATE-AH-COVERAGE.
 17306
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 313
* EL050.cbl
 17307     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17308     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17309     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17310     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17311                                      TO CM-CREDIT-INTERFACE-SW-2.
 17312     IF CM-AH-CANCEL-DT = LOW-VALUE
 17313         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17314
 17315     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17316         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17317                                         CM-AH-STATUS-AT-CANCEL.
 17318
 17319     IF LF-COVERAGE-CANCELLED
 17320         IF PB-RECORD-RETURNED
 17321              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17322          ELSE
 17323              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17324
 17325     GO TO 4299-EXIT.
 17326
 17327 4100-AH-CANCEL-CONT.
 17328     IF PB-C-AH-CANCEL-VOIDED
 17329         GO TO 4299-EXIT.
 17330
 17331     if cm-credit-interface-sw-2 = ' '
 17332        if pb-fatal-errors or pb-unforced-errors
 17333           move '4'              to cm-credit-interface-sw-2
 17334        else
 17335           move '1'              to cm-credit-interface-sw-2
 17336        end-if
 17337     end-if
 17338     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17339         GO TO 4299-EXIT.
 17340
 17341     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17342        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17343           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17344        ELSE
 17345           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17346
 17347     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17348     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17349
 17350     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17351         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17352
 17353     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17354         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17355         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17356
 17357     IF PB-RECORD-RETURNED
 17358        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17359      ELSE
 17360        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17361
 17362     GO TO 4299-EXIT.
 17363
 17364 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 314
* EL050.cbl
 17365     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17366
 17367     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17368        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17369                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17370     ELSE
 17371        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17372                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17373
 17374     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17375        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17376                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17377     ELSE
 17378        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17379                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17380
 17381     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17382        NEXT SENTENCE
 17383     ELSE
 17384        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17385
 17386     GO TO 4299-EXIT.
 17387
 17388 4200-REVERSE-LF-CANCEL.
 17389     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17390
 17391     IF CM-LF-CANCEL-APPLIED
 17392        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17393        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17394        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17395
 17396     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17397
 17398     IF PB-RECORD-RETURNED
 17399        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17400       ELSE
 17401        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17402
 17403 4200-REVERSE-LF-EXIT.
 17404       EXIT.
 17405
 17406 4200-REVERSE-AH-CANCEL.
 17407     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17408
 17409     IF CM-AH-CANCEL-APPLIED
 17410        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17411        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17412        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17413
 17414     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17415
 17416     IF PB-RECORD-RETURNED
 17417        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17418       ELSE
 17419        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17420
 17421 4200-REVERSE-AH-EXIT.
 17422       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 315
* EL050.cbl
 17423
 17424 4299-EXIT.
 17425       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 316
* EL050.cbl
 17427
 17428 4500-UPDATE-NEW-CERT.
 17429     IF CERT-WAS-FOUND
 17430         NEXT SENTENCE
 17431       ELSE
 17432         GO TO 4520-BUILD-NEW-KEY.
 17433
 17434     IF  CLASIC-CREATED-CERT
 17435         GO TO 4999-EXIT.
 17436
 17437     IF  CERT-WAS-CREATED-FOR-CLAIM
 17438         GO TO 4520-BUILD-NEW-KEY.
 17439
 17440     IF CERT-ADDED-BATCH
 17441        IF CM-RECORD-ID = 'CM'
 17442            GO TO 4999-EXIT.
 17443
 17444 4520-BUILD-NEW-KEY.
 17445* BUILD CONTROL PRIMARY
 17446
 17447     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17448                                       CM-COMPANY-CD-A1
 17449                                       CM-COMPANY-CD-A2
 17450                                       CM-COMPANY-CD-A4
 17451                                       CM-COMPANY-CD-A5.
 17452
 17453     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17454     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17455     MOVE PB-SV-STATE               TO CM-STATE.
 17456     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17457     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17458     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17459     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17460
 17461     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17462
 17463     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17464     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17465     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17466     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17467
 17468     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17469        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17470
 17471     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17472         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17473         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17474         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17475         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17476     ELSE
 17477         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17478
 17479     IF PB-COMPANY-ID   EQUAL  'CRI'
 17480         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17481         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17482         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17483         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17484         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 317
* EL050.cbl
 17485
 17486     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17487        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17488         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17489
 17490     IF PB-COMPANY-ID  = 'LBL'
 17491        IF PB-I-JOINT-COVERAGE
 17492            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17493                                           PB-I-MEMBER-NO
 17494            GO TO 4550-CONT-CERT-PROCESS.
 17495
 17496     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17497        NEXT SENTENCE
 17498     ELSE
 17499        GO TO 4540-BUILD-MEMBER-NO.
 17500
 17501******************************************************************
 17502*                                                                *
 17503*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17504*    FOR 'MON'.                                                  *
 17505*                                                                *
 17506******************************************************************
 17507
 17508     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17509     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17510     MOVE +1                     TO WS-SUB1
 17511                                    WS-SUB2.
 17512
 17513 4530-EDIT-MEMB-NAME.
 17514
 17515     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17516        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17517        ADD +1                       TO WS-SUB2.
 17518
 17519     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17520        ADD +1                       TO WS-SUB1
 17521        GO TO 4530-EDIT-MEMB-NAME.
 17522
 17523     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17524     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17525     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17526*    MOVE SPACE                      TO DC-OPTION-CODE.
 17527     SET  BIN-TO-GREG                TO TRUE.
 17528     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17529     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17530
 17531     GO TO 4550-CONT-CERT-PROCESS.
 17532
 17533******************************************************************
 17534*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17535******************************************************************
 17536
 17537 4540-BUILD-MEMBER-NO.
 17538
 17539     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17540         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17541         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17542         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 318
* EL050.cbl
 17543         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17544     ELSE
 17545         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17546
 17547     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17548        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17549         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17550
 17551 4550-CONT-CERT-PROCESS.
 17552
 17553*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17554*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17555*    ELSE
 17556*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17557
 17558     IF CERT-WAS-CREATED-FOR-CLAIM
 17559        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17560        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17561
 17562     IF CERT-AND-CLAIM-ONLINE
 17563        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17564        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17565
 17566     MOVE 'CM'                     TO CM-RECORD-ID.
 17567     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17568
 17569     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17570        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17571        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17572     ELSE
 17573        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17574        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17575
 17576     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17577     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17578     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17579     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17580     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17581     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17582     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17583                                      CM-LF-ITD-CANCEL-AMT
 17584                                      CM-LF-ITD-DEATH-AMT
 17585                                      CM-AH-ITD-AH-PMT
 17586                                      CM-AH-ITD-LUMP-PMT
 17587                                      CM-AH-ITD-CANCEL-AMT
 17588                                      CM-LF-NSP-PREMIUM-AMT
 17589                                      CM-AH-NSP-PREMIUM-AMT.
 17590*                                     CM-CLAIM-DEDUCT-WITHHELD
 17591*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17592     if pb-i-loan-apr = +99.9999
 17593        move zeros                 to cm-loan-apr
 17594     else
 17595        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17596     end-if
 17597     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17598     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17599     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17600     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 319
* EL050.cbl
 17601     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17602     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17603     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17604     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17605     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17606     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17607     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17608
 17609     IF PB-I-LIVES NOT NUMERIC
 17610         MOVE ZERO                 TO PB-I-LIVES.
 17611
 17612     IF PB-I-NUM-BILLED NOT NUMERIC
 17613         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17614
 17615     MOVE PB-I-LIVES               TO CM-LIVES.
 17616     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17617
 17618     IF PB-COMPANY-ID EQUAL  'DMD'
 17619         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17620         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17621
 17622     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17623     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17624     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17625     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17626     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17627     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17628
 17629     IF PB-I-LF-POLICY-FEE NUMERIC
 17630        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17631     ELSE
 17632        MOVE +0                    TO CM-LF-POLICY-FEE.
 17633
 17634     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17635        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17636        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17637     ELSE
 17638        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17639
 17640     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17641     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17642     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17643     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17644     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17645     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17646     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17647     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17648     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17649
 17650     IF PB-I-AH-POLICY-FEE NUMERIC
 17651        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17652     ELSE
 17653        MOVE +0                    TO CM-AH-POLICY-FEE.
 17654
 17655     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17656        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17657     ELSE
 17658        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 320
* EL050.cbl
 17659
 17660     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17661     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17662
 17663     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17664                                      CM-LF-DEATH-EXIT-DT
 17665                                      CM-AH-SETTLEMENT-EXIT-DT.
 17666
 17667*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17668*                       'TIH' OR 'OFL' OR 'FLA' OR
 17669*                       'TII' OR 'TMS' OR 'CRI' OR
 17670*                       'NCL'
 17671     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17672
 17673     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17674         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17675            MOVE '2'                TO CM-PREMIUM-TYPE.
 17676
 17677     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17678         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17679            MOVE '2'                TO CM-PREMIUM-TYPE.
 17680
 17681     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17682         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17683     ELSE
 17684         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17685         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17686
 17687     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17688     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17689     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17690     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17691     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17692     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17693     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17694     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17695
 17696     IF PB-NO-MONTHS-SKIPPED
 17697         MOVE SPACE                 TO CM-SKIP-CODE
 17698     ELSE
 17699         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17700
 17701     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17702     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17703                                       CM-LF-STATUS-AT-CANCEL.
 17704
 17705     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17706     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17707                                       CM-AH-STATUS-AT-CANCEL.
 17708
 17709     MOVE '1'                       TO CM-ENTRY-STATUS.
 17710
 17711     IF PB-REISSUED-CERT
 17712        MOVE '5'                    TO CM-ENTRY-STATUS.
 17713
 17714     IF PB-MONTHLY-CERT
 17715        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17716
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 321
* EL050.cbl
 17717     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17718     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17719     IF PB-POLICY-IS-DECLINED
 17720        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17721
 17722     IF PB-POLICY-IS-VOIDED
 17723        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17724
 17725     IF PB-NEEDS-UNDERWRITING
 17726        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17727
 17728     IF PB-REIN-ONLY-CERT
 17729        MOVE '9'                    TO CM-ENTRY-STATUS.
 17730
 17731     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17732         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17733     ELSE
 17734         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17735
 17736     IF PB-RECORD-RETURNED
 17737        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17738      ELSE
 17739        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17740
 17741     IF PB-I-MAIL-ADDRS-PRESENT
 17742        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17743
 17744     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17745                                       CM-ENTRY-DT.
 17746
 17747 4999-EXIT.
 17748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 322
* EL050.cbl
 17750
 17751 5000-PROCESS-REPS.
 17752     MOVE ' '                    TO AGTC-MASTER-SW
 17753     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17754     MOVE CO-TYPE                TO AGTC-TYPE
 17755     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17756     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17757     IF (AGTC-MASTER-SW NOT = 'N')
 17758        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17759        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17760        PERFORM 8583-READ-ERAGTC-NEXT
 17761                                 THRU 8583-EXIT
 17762     END-IF
 17763     IF AGTC-MASTER-SW = 'N'
 17764        CONTINUE
 17765     ELSE
 17766        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17767           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17768              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17769              MOVE 'Y'           TO AGTC-MASTER-SW
 17770           END-IF
 17771        END-IF
 17772     END-IF
 17773     .
 17774 5000-EXIT.
 17775     EXIT.
 17776 6370-EDIT-INPUT-LF-CODE.
 17777     move ' ' to ws-benefit-cd-chg-sw
 17778     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17779        MOVE +1                  TO SUB
 17780        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17781        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17782        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17783        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17784        GO TO 6370-SEARCH-LOOP.
 17785
 17786     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17787
 17788     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17789     MOVE SPACES                 TO CNTL-ACCESS.
 17790*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17791     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17792     MOVE +0                     TO CNTL-SEQ-NO.
 17793     MOVE '4' TO RC-SW-2.
 17794     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17795
 17796     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17797        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17798        GO TO 6370-NO-LF-FOUND.
 17799
 17800     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17801     MOVE +1                     TO SUB.
 17802
 17803 6370-SEARCH-LOOP.
 17804     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17805         GO TO 6370-NO-LF-FOUND.
 17806
 17807     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 323
* EL050.cbl
 17808        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17809           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17810           set benefit-code-chg to true
 17811        end-if
 17812        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17813        GO TO 6370-HER-NET-PAY-CHECK.
 17814
 17815     ADD 1   TO SUB.
 17816*    IF SUB GREATER 120
 17817     IF SUB GREATER 200
 17818         GO TO 6370-NO-LF-FOUND.
 17819
 17820     GO TO 6370-SEARCH-LOOP.
 17821
 17822 6370-NO-LF-FOUND.
 17823
 17824     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17825        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17826        set benefit-code-chg to true
 17827     end-if
 17828     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17829
 17830 6370-HER-NET-PAY-CHECK.
 17831
 17832     IF PB-COMPANY-ID = 'CID'
 17833        IF PB-SV-STATE = 'CA' OR 'MN'
 17834           IF PB-I-LF-BENEFIT-CD = '02'
 17835              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17836           ELSE
 17837              IF PB-I-LF-BENEFIT-CD = '04'
 17838                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17839              END-IF
 17840           END-IF
 17841        END-IF
 17842     END-IF
 17843
 17844     IF PB-COMPANY-ID NOT = 'HER'
 17845         GO TO 6370-EXIT.
 17846
 17847     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17848         GO TO 6370-EXIT.
 17849
 17850     IF PB-I-LF-TERM NOT NUMERIC
 17851         MOVE ZEROS              TO PB-I-LF-TERM.
 17852
 17853     IF PB-I-LOAN-TERM NOT NUMERIC
 17854         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17855
 17856     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17857         GO TO 6370-EXIT.
 17858
 17859     IF PB-I-LF-BENEFIT-CD = '33'
 17860         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17861
 17862     IF PB-I-LF-BENEFIT-CD = '34'
 17863         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17864
 17865 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 324
* EL050.cbl
 17866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 325
* EL050.cbl
 17868
 17869 6380-EDIT-INPUT-AH-CODE.
 17870     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17871        MOVE +1                  TO SUB
 17872        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17873        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17874        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17875        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17876        GO TO 6380-SEARCH-LOOP.
 17877
 17878     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17879
 17880     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17881     MOVE SPACES                 TO CNTL-ACCESS.
 17882     MOVE 'A'                    TO CNTL-REC-TYPE.
 17883*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17884     MOVE +0                     TO CNTL-SEQ-NO.
 17885     MOVE '5' TO RC-SW-2.
 17886     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17887
 17888     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17889        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17890        GO TO 6380-NO-AH-FOUND.
 17891
 17892     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17893     MOVE +1 TO SUB.
 17894
 17895 6380-SEARCH-LOOP.
 17896     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17897         GO TO 6380-NO-AH-FOUND.
 17898
 17899     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17900         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17901         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17902
 17903     ADD 1   TO SUB.
 17904     IF SUB GREATER THAN 96
 17905*    IF SUB GREATER THAN 300
 17906         GO TO 6380-NO-AH-FOUND.
 17907
 17908     GO TO 6380-SEARCH-LOOP.
 17909
 17910 6380-NO-AH-FOUND.
 17911
 17912     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17913
 17914     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17915         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17916     ELSE
 17917         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17918
 17919 6380-CSO-AH-ONLY-CHECKS.
 17920
 17921     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17922        NEXT SENTENCE
 17923      ELSE
 17924        GO TO 6380-EXIT.
 17925
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 326
* EL050.cbl
 17926     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17927         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17928
 17929
 17930     GO TO 6380-EXIT
 17931     .
 17932 6380-CSO-LIFE-WITH-AH-CHECKS.
 17933
 17934
 17935     .
 17936 6380-EXIT.
 17937     EXIT.
 17938
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 327
* EL050.cbl
 17940
 17941 6400-COMPUTE-EXTENSION-DAYS.
 17942
 17943******************************************************************
 17944*                                                                *
 17945*                   COMPUTE EXTENSION DAYS                       *
 17946*                                                                *
 17947*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17948*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17949*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17950*    THE EXTENSION DAYS.                                         *
 17951*                                                                *
 17952******************************************************************
 17953
 17954     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17955     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17956
 17957******************************************************************
 17958*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17959*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17960******************************************************************
 17961
 17962     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17963        COMPUTE WS-ODD-DAYS-OVER =
 17964               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17965     ELSE
 17966        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17967
 17968     IF WS-ODD-DAYS-OVER = ZEROS
 17969           GO TO 6499-EXIT
 17970     ELSE
 17971        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17972           IF WS-WDF-MONTH = 02
 17973              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17974              ADD 2       TO  WS-ODD-DAYS-OVER
 17975              GO TO 6499-EXIT
 17976           ELSE
 17977              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17978                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17979                 GO TO 6499-EXIT
 17980               ELSE
 17981                 GO TO 6499-EXIT
 17982        ELSE
 17983           GO TO 6499-EXIT.
 17984
 17985 6412-CHECK-TO-DAY.
 17986
 17987        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17988           IF WS-WDT-DAY = 28
 17989              ADD 2              TO WS-ODD-DAYS-OVER
 17990           ELSE
 17991              IF WS-WDT-DAY = 29
 17992                 ADD 1           TO WS-ODD-DAYS-OVER
 17993              ELSE
 17994                 NEXT SENTENCE
 17995        ELSE
 17996           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17997              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 328
* EL050.cbl
 17998
 17999     GO TO 6499-EXIT.
 18000
 18001
 18002 6415-CHECK-LEAP-YEAR.
 18003
 18004     IF DC-DAYS-IN-MONTH = 29
 18005        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18006
 18007 6415-EXIT.
 18008     EXIT.
 18009
 18010 6499-EXIT.
 18011      EXIT.
 18012
 18013 6500-END.
 18014     EXIT.
 18015
 18016
 18017******************************************************************
 18018************* PROCEDURE DIVISION FOR EL050 ***********************
 18019********************** ELC50PD END *******************************
 18020
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 329
* EL050.cbl
 18022
 18023**START***********************************************************
 18024*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18025*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18026******************************************************************
 18027*
 18028 6600-GET-STATE-MUNICIPAL-TAX.
 18029
 18030     IF PB-COMPANY-ID NOT = 'DMD'
 18031         GO TO 6640-EXIT.
 18032
 18033     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18034     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18035     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18036*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18037*
 18038***  Y2K PROJ 7744
 18039     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18040     SET BIN-TO-GREG          TO TRUE.
 18041     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18042
 18043     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18044
 18045     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18046     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18047
 18048
 18049* EXEC CICS HANDLE CONDITION
 18050*        INVREQ    (6610-START-BROWSE)
 18051*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18052*        NOTFND    (6630-END-OF-FILE)
 18053*    END-EXEC.
 18054*    MOVE '"$8JI                 ! # #00018036' TO DFHEIV0
 18055     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18057     MOVE X'2320233030303138303336' TO DFHEIV0(25:11)
 18058     CALL 'kxdfhei1' USING DFHEIV0
 18059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18060
 18061
 18062 6610-START-BROWSE.
 18063
 18064
 18065* EXEC CICS HANDLE CONDITION
 18066*        NOTFND    (6630-END-OF-FILE)
 18067*        DISABLED  (6630-ERRESS-PROBLEM)
 18068*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18069*        ENDFILE   (6630-END-OF-FILE)
 18070*    END-EXEC.
 18071*    MOVE '"$IcJ''                ! $ #00018044' TO DFHEIV0
 18072     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18074     MOVE X'2420233030303138303434' TO DFHEIV0(25:11)
 18075     CALL 'kxdfhei1' USING DFHEIV0
 18076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18077
 18078
 18079
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 330
* EL050.cbl
 18080* EXEC CICS STARTBR
 18081*        DATASET (FILE-ID-ERRESS)
 18082*        RIDFLD  (WS-ERRESS-KEY)
 18083*        GTEQ
 18084*    END-EXEC.
 18085     MOVE 0
 18086       TO DFHEIV11
 18087*    MOVE '&,         G          &   #00018051' TO DFHEIV0
 18088     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18089     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18090     MOVE X'2020233030303138303531' TO DFHEIV0(25:11)
 18091     CALL 'kxdfhei1' USING DFHEIV0,
 18092           FILE-ID-ERRESS,
 18093           WS-ERRESS-KEY,
 18094           DFHEIV99,
 18095           DFHEIV11,
 18096           DFHEIV99
 18097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18098
 18099
 18100 6620-READ-NEXT-ERRESS-MASTER.
 18101
 18102
 18103* EXEC CICS HANDLE CONDITION
 18104*        NOTFND    (6630-END-OF-FILE)
 18105*        ENDFILE   (6630-END-OF-FILE)
 18106*        DISABLED  (6630-ERRESS-PROBLEM)
 18107*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18108*    END-EXEC.
 18109*    MOVE '"$I''cJ                ! % #00018059' TO DFHEIV0
 18110     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18112     MOVE X'2520233030303138303539' TO DFHEIV0(25:11)
 18113     CALL 'kxdfhei1' USING DFHEIV0
 18114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18115
 18116
 18117
 18118* EXEC CICS READNEXT
 18119*        DATASET (FILE-ID-ERRESS)
 18120*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18121*        RIDFLD  (WS-ERRESS-KEY)
 18122*    END-EXEC.
 18123     MOVE LENGTH OF
 18124      RESIDENT-STATE-TAX-MASTER
 18125       TO DFHEIV12
 18126     MOVE 0
 18127       TO DFHEIV11
 18128*    MOVE '&.IL                  )   #00018066' TO DFHEIV0
 18129     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18130     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18131     MOVE X'2020233030303138303636' TO DFHEIV0(25:11)
 18132     CALL 'kxdfhei1' USING DFHEIV0,
 18133           FILE-ID-ERRESS,
 18134           RESIDENT-STATE-TAX-MASTER,
 18135           DFHEIV12,
 18136           WS-ERRESS-KEY,
 18137           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 331
* EL050.cbl
 18138           DFHEIV11,
 18139           DFHEIV99,
 18140           DFHEIV99
 18141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18142
 18143
 18144     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18145
 18146* EXEC CICS ENDBR
 18147*            DATASET (FILE-ID-ERRESS)
 18148*       END-EXEC
 18149     MOVE 0
 18150       TO DFHEIV11
 18151*    MOVE '&2                    $   #00018073' TO DFHEIV0
 18152     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18153     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18154     MOVE X'2020233030303138303733' TO DFHEIV0(25:11)
 18155     CALL 'kxdfhei1' USING DFHEIV0,
 18156           FILE-ID-ERRESS,
 18157           DFHEIV11,
 18158           DFHEIV99
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18160        GO TO 6630-END-OF-FILE.
 18161
 18162     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18163        NEXT SENTENCE
 18164      ELSE
 18165        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18166
 18167*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18168*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18169*
 18170     MOVE +2                     TO WS-SUB1.
 18171
 18172     IF PB-ISSUE
 18173     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18174        MOVE +1                  TO WS-SUB1.
 18175
 18176     IF PB-CANCELLATION
 18177     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18178        MOVE +1                  TO WS-SUB1.
 18179*
 18180*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18181*
 18182***  Y2K PROJ 7744
 18183     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18184***  Y2K PROJ 7744
 18185
 18186*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18187* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18188* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18189
 18190     ADD 1                    TO WS-YEAR-YY.
 18191
 18192     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18193         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18194                              TO WS-RES-STATE-TAX
 18195         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 332
* EL050.cbl
 18196                              TO WS-RES-MUNI-TAX
 18197     ELSE
 18198         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18199                              TO WS-RES-STATE-TAX
 18200         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18201                              TO WS-RES-MUNI-TAX.
 18202
 18203*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18204
 18205     IF PB-CANCELLATION
 18206         GO TO 6640-CANCEL-TAX.
 18207
 18208     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18209         COMPUTE PB-I-STATE-TAX ROUNDED =
 18210                                   PB-I-LF-PREMIUM-AMT
 18211                                 * WS-RES-STATE-TAX
 18212         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18213                                   PB-I-LF-PREMIUM-AMT
 18214                                 * WS-RES-MUNI-TAX
 18215     ELSE
 18216     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18217         COMPUTE PB-I-STATE-TAX ROUNDED =
 18218                                   PB-I-AH-PREMIUM-AMT
 18219                                 * WS-RES-STATE-TAX
 18220         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18221                                   PB-I-AH-PREMIUM-AMT
 18222                                 * WS-RES-MUNI-TAX.
 18223
 18224
 18225* EXEC CICS ENDBR
 18226*         DATASET (FILE-ID-ERRESS)
 18227*    END-EXEC.
 18228     MOVE 0
 18229       TO DFHEIV11
 18230*    MOVE '&2                    $   #00018140' TO DFHEIV0
 18231     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18232     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18233     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 18234     CALL 'kxdfhei1' USING DFHEIV0,
 18235           FILE-ID-ERRESS,
 18236           DFHEIV11,
 18237           DFHEIV99
 18238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18239
 18240
 18241     GO TO 6640-EXIT.
 18242
 18243 6640-CANCEL-TAX.
 18244     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18245
 18246     IF PB-C-LF-CANCEL-AMT > ZEROS
 18247         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18248                                   PB-C-LF-CANCEL-AMT
 18249                                 * WS-RES-STATE-TAX
 18250         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18251                                   PB-C-LF-CANCEL-AMT
 18252                                *  WS-RES-MUNI-TAX
 18253     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 333
* EL050.cbl
 18254     IF PB-C-AH-CANCEL-AMT > ZEROS
 18255         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18256                                   PB-C-AH-CANCEL-AMT
 18257                                 * WS-RES-STATE-TAX
 18258         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18259                                   PB-C-AH-CANCEL-AMT
 18260                                *  WS-RES-MUNI-TAX.
 18261
 18262
 18263* EXEC CICS ENDBR
 18264*         DATASET (FILE-ID-ERRESS)
 18265*    END-EXEC.
 18266     MOVE 0
 18267       TO DFHEIV11
 18268*    MOVE '&2                    $   #00018165' TO DFHEIV0
 18269     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18271     MOVE X'2020233030303138313635' TO DFHEIV0(25:11)
 18272     CALL 'kxdfhei1' USING DFHEIV0,
 18273           FILE-ID-ERRESS,
 18274           DFHEIV11,
 18275           DFHEIV99
 18276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18277
 18278
 18279     GO TO 6640-EXIT.
 18280
 18281 6630-END-OF-FILE.
 18282     MOVE ER-8002              TO WS-ERROR.
 18283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18284
 18285     GO TO 6640-EXIT.
 18286
 18287 6630-ERRESS-PROBLEM.
 18288     MOVE ER-8044              TO WS-ERROR.
 18289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18290
 18291 6640-EXIT.
 18292     EXIT.
 18293
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 334
* EL050.cbl
 18295 6650-GET-RES-STATE-COMM.
 18296
 18297     IF PB-COMPANY-ID NOT = 'DMD'
 18298         GO TO 6700-COMM-EXIT.
 18299
 18300     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18301     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18302     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18303     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18304     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18305     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18306     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18307
 18308*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18309*
 18310***  Y2K PROJ 7744
 18311     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18312     SET BIN-TO-GREG          TO TRUE.
 18313     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18314
 18315     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18316***  Y2K PROJ 7744
 18317
 18318     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18319
 18320
 18321* EXEC CICS HANDLE CONDITION
 18322*        INVREQ    (6660-START-BROWSE)
 18323*        DISABLED  (6690-ERRESC-PROBLEM)
 18324*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18325*        NOTFND    (6690-END-OF-FILE)
 18326*    END-EXEC.
 18327*    MOVE '"$8cJI                ! & #00018210' TO DFHEIV0
 18328     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18330     MOVE X'2620233030303138323130' TO DFHEIV0(25:11)
 18331     CALL 'kxdfhei1' USING DFHEIV0
 18332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18333
 18334
 18335
 18336* EXEC CICS RESETBR
 18337*        DATASET (FILE-ID-ERRESC)
 18338*        RIDFLD  (WS-ERRESC-KEY)
 18339*    END-EXEC.
 18340     MOVE 0
 18341       TO DFHEIV11
 18342*    MOVE '&4         G          &   #00018217' TO DFHEIV0
 18343     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18344     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18345     MOVE X'2020233030303138323137' TO DFHEIV0(25:11)
 18346     CALL 'kxdfhei1' USING DFHEIV0,
 18347           FILE-ID-ERRESC,
 18348           WS-ERRESC-KEY,
 18349           DFHEIV99,
 18350           DFHEIV11,
 18351           DFHEIV99
 18352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 335
* EL050.cbl
 18353
 18354
 18355 6660-START-BROWSE.
 18356
 18357
 18358* EXEC CICS HANDLE CONDITION
 18359*        NOTFND    (6690-END-OF-FILE)
 18360*        DISABLED  (6690-ERRESC-PROBLEM)
 18361*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18362*        ENDFILE   (6690-END-OF-FILE)
 18363*    END-EXEC.
 18364*    MOVE '"$IcJ''                ! '' #00018224' TO DFHEIV0
 18365     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18367     MOVE X'2720233030303138323234' TO DFHEIV0(25:11)
 18368     CALL 'kxdfhei1' USING DFHEIV0
 18369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18370
 18371
 18372
 18373* EXEC CICS STARTBR
 18374*        DATASET (FILE-ID-ERRESC)
 18375*        RIDFLD  (WS-ERRESC-KEY)
 18376*        GTEQ
 18377*    END-EXEC.
 18378     MOVE 0
 18379       TO DFHEIV11
 18380*    MOVE '&,         G          &   #00018231' TO DFHEIV0
 18381     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18383     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 18384     CALL 'kxdfhei1' USING DFHEIV0,
 18385           FILE-ID-ERRESC,
 18386           WS-ERRESC-KEY,
 18387           DFHEIV99,
 18388           DFHEIV11,
 18389           DFHEIV99
 18390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18391
 18392
 18393     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18394
 18395 6670-READ-NEXT-ERRESC-MASTER.
 18396
 18397
 18398* EXEC CICS HANDLE CONDITION
 18399*        NOTFND    (6690-END-OF-FILE)
 18400*        DISABLED  (6690-ERRESC-PROBLEM)
 18401*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18402*        ENDFILE   (6690-END-OF-FILE)
 18403*    END-EXEC.
 18404*    MOVE '"$IcJ''                ! ( #00018241' TO DFHEIV0
 18405     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18407     MOVE X'2820233030303138323431' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0
 18409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18410
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 336
* EL050.cbl
 18411
 18412
 18413* EXEC CICS READNEXT
 18414*        DATASET (FILE-ID-ERRESC)
 18415*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18416*        RIDFLD  (ERRESC-RECORD-KEY)
 18417*    END-EXEC.
 18418     MOVE LENGTH OF
 18419      ACCOUNT-RESIDENT-ST-COMMISSION
 18420       TO DFHEIV12
 18421     MOVE 0
 18422       TO DFHEIV11
 18423*    MOVE '&.IL                  )   #00018248' TO DFHEIV0
 18424     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18425     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18426     MOVE X'2020233030303138323438' TO DFHEIV0(25:11)
 18427     CALL 'kxdfhei1' USING DFHEIV0,
 18428           FILE-ID-ERRESC,
 18429           ACCOUNT-RESIDENT-ST-COMMISSION,
 18430           DFHEIV12,
 18431           ERRESC-RECORD-KEY,
 18432           DFHEIV99,
 18433           DFHEIV11,
 18434           DFHEIV99,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18440        NEXT SENTENCE
 18441     ELSE
 18442
 18443* EXEC CICS ENDBR
 18444*            DATASET (FILE-ID-ERRESC)
 18445*       END-EXEC
 18446     MOVE 0
 18447       TO DFHEIV11
 18448*    MOVE '&2                    $   #00018257' TO DFHEIV0
 18449     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18450     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18451     MOVE X'2020233030303138323537' TO DFHEIV0(25:11)
 18452     CALL 'kxdfhei1' USING DFHEIV0,
 18453           FILE-ID-ERRESC,
 18454           DFHEIV11,
 18455           DFHEIV99
 18456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18457        GO TO 6690-END-OF-FILE.
 18458
 18459     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18460
 18461* EXEC CICS ENDBR
 18462*            DATASET (FILE-ID-ERRESC)
 18463*       END-EXEC
 18464     MOVE 0
 18465       TO DFHEIV11
 18466*    MOVE '&2                    $   #00018263' TO DFHEIV0
 18467     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 337
* EL050.cbl
 18469     MOVE X'2020233030303138323633' TO DFHEIV0(25:11)
 18470     CALL 'kxdfhei1' USING DFHEIV0,
 18471           FILE-ID-ERRESC,
 18472           DFHEIV11,
 18473           DFHEIV99
 18474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18475        GO TO 6690-END-OF-FILE.
 18476
 18477     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18478        NEXT SENTENCE
 18479      ELSE
 18480        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18481
 18482* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18483*
 18484     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18485
 18486     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18487
 18488     IF WS-SUB1 > ZERO
 18489         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18490             PERFORM 6680-SET-COMMISSION
 18491         ELSE
 18492             PERFORM 6680-SET-TABLE-CODE.
 18493
 18494
 18495* EXEC CICS ENDBR
 18496*         DATASET (FILE-ID-ERRESC)
 18497*    END-EXEC.
 18498     MOVE 0
 18499       TO DFHEIV11
 18500*    MOVE '&2                    $   #00018285' TO DFHEIV0
 18501     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18503     MOVE X'2020233030303138323835' TO DFHEIV0(25:11)
 18504     CALL 'kxdfhei1' USING DFHEIV0,
 18505           FILE-ID-ERRESC,
 18506           DFHEIV11,
 18507           DFHEIV99
 18508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18509
 18510
 18511     GO TO 6700-COMM-EXIT.
 18512
 18513 6680-SET-TABLE-CODE.
 18514     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18515        MOVE ZEROS             TO WS-SUB1
 18516     ELSE
 18517* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18518* TO COMPUTE AH COMMISSION.
 18519        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18520        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18521        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18522        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18523        PERFORM 6680-READ-CTBL-TABLE
 18524        IF WS-CTBL-READ-SW NOT = 'Y'
 18525           MOVE ZEROS          TO WS-SUB1.
 18526
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 338
* EL050.cbl
 18527 6680-READ-CTBL-TABLE.
 18528*
 18529* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18530* TO COMPUTE LIFE COMMISSION
 18531
 18532     IF CTBL-SW = '0540'
 18533        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18534        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18535        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18536
 18537     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18538
 18539     IF CTBL-TABLE-FOUND
 18540        IF CTBL-SW = '0530'
 18541             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18542                                    * PB-I-AH-TERM
 18543             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18544             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18545        ELSE
 18546             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18547             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18548             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18549     ELSE
 18550        IF FIRST-TIME-THROUGH
 18551            GO TO 6680-READ-CTBL-TABLE
 18552        ELSE
 18553            MOVE ZEROS         TO WS-SUB1.
 18554
 18555 6680-SET-COMMISSION.
 18556     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18557           MOVE ZEROS          TO WS-SUB1
 18558       ELSE
 18559           MOVE RESC-COMMISSION-PER (WS-SUB)
 18560                               TO WS-COMMISSION
 18561           IF CTBL-SW = '0530'
 18562               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18563           ELSE
 18564               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18565
 18566 6680-SEARCH-CATEGORY.
 18567     ADD +1                   TO WS-SUB.
 18568     IF WS-SUB > +12
 18569         GO TO 6680-EXIT.
 18570
 18571     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18572          MOVE WS-SUB         TO WS-SUB1
 18573          GO TO 6680-EXIT.
 18574
 18575     GO TO 6680-SEARCH-CATEGORY.
 18576
 18577 6680-EXIT.
 18578     EXIT.
 18579
 18580 6690-END-OF-FILE.
 18581     GO TO 6700-COMM-EXIT.
 18582
 18583 6690-ERRESC-PROBLEM.
 18584      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 339
* EL050.cbl
 18585      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18586
 18587      GO TO 6700-COMM-EXIT.
 18588
 18589 6700-COMM-EXIT.
 18590     EXIT.
 18591
 18592 7000-GET-RATE.
 18593
 18594* EXEC CICS LINK
 18595*        PROGRAM    ('ELRATE')
 18596*        COMMAREA   (CALCULATION-PASS-AREA)
 18597*        LENGTH     (CP-COMM-LENGTH)
 18598*    END-EXEC.
 18599     MOVE 'ELRATE' TO DFHEIV1
 18600*    MOVE '."C                   (   #00018371' TO DFHEIV0
 18601     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18603     MOVE X'2020233030303138333731' TO DFHEIV0(25:11)
 18604     CALL 'kxdfhei1' USING DFHEIV0,
 18605           DFHEIV1,
 18606           CALCULATION-PASS-AREA,
 18607           CP-COMM-LENGTH,
 18608           DFHEIV99,
 18609           DFHEIV99,
 18610           DFHEIV99,
 18611           DFHEIV99
 18612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18613
 18614
 18615 7000-EXIT.
 18616     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 340
* EL050.cbl
 18618 7100-FIND-BENEFIT-IN-STATE.
 18619     MOVE 'N'                    TO BEN-SEARCH-SW.
 18620
 18621     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18622         VARYING SUB3 FROM 1 BY 1 UNTIL
 18623            ((SUB3 GREATER 50) OR
 18624              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18625               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18626
 18627     IF SUB3 NOT = 51
 18628         MOVE 'Y'                TO BEN-SEARCH-SW.
 18629
 18630     GO TO 7199-EXIT.
 18631
 18632 7100-BENEFIT-DUMMY.
 18633
 18634 7100-DUMMY-EXIT.
 18635     EXIT.
 18636
 18637 7199-EXIT.
 18638     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 341
* EL050.cbl
 18640 7200-FIND-BENEFIT.
 18641     MOVE 'N'                    TO BEN-SEARCH-SW.
 18642
 18643     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18644         VARYING SUB3 FROM 1 BY 1 UNTIL
 18645            ((SUB3 GREATER 8) OR
 18646            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18647
 18648     IF SUB3 NOT = 9
 18649         MOVE 'Y'                TO BEN-SEARCH-SW.
 18650
 18651     GO TO 7200-EXIT.
 18652
 18653 7200-BENEFIT-DUMMY.
 18654
 18655 7200-DUMMY-EXIT.
 18656     EXIT.
 18657
 18658 7200-EXIT.
 18659     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 342
* EL050.cbl
 18661 7250-LOOK-FOR-RESCINDED-CLAIM.
 18662     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18663                                    W-CL-COMP-CD.
 18664     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18665                                    W-CL-CERT-NO.
 18666
 18667
 18668* EXEC CICS HANDLE CONDITION
 18669*        NOTFND  (7250-CONTINUE)
 18670*        ENDFILE (7250-CONTINUE)
 18671*    END-EXEC.
 18672*    MOVE '"$I''                  ! ) #00018429' TO DFHEIV0
 18673     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18675     MOVE X'2920233030303138343239' TO DFHEIV0(25:11)
 18676     CALL 'kxdfhei1' USING DFHEIV0
 18677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18678
 18679
 18680
 18681* EXEC CICS IGNORE CONDITION
 18682*        DUPKEY
 18683*    END-EXEC.
 18684*    MOVE '"*$                   !   #00018434' TO DFHEIV0
 18685     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18687     MOVE X'2020233030303138343334' TO DFHEIV0(25:11)
 18688     CALL 'kxdfhei1' USING DFHEIV0
 18689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18690
 18691
 18692
 18693* EXEC CICS STARTBR
 18694*        DATASET   (CLMS-ID)
 18695*        RIDFLD    (ELMSTR-KEY)
 18696*        GENERIC   EQUAL
 18697*        KEYLENGTH (ELMSTR-LENGTH)
 18698*    END-EXEC.
 18699     MOVE 0
 18700       TO DFHEIV11
 18701*    MOVE '&,   KG    E          &   #00018438' TO DFHEIV0
 18702     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18703     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18704     MOVE X'2020233030303138343338' TO DFHEIV0(25:11)
 18705     CALL 'kxdfhei1' USING DFHEIV0,
 18706           CLMS-ID,
 18707           ELMSTR-KEY,
 18708           ELMSTR-LENGTH,
 18709           DFHEIV11,
 18710           DFHEIV99
 18711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18712
 18713
 18714     MOVE 'Y'                    TO W-BROWSE-SW.
 18715
 18716 7250-NEXT-CLAIM.
 18717
 18718
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 343
* EL050.cbl
 18719* EXEC CICS READNEXT
 18720*        DATASET   (CLMS-ID)
 18721*        RIDFLD    (ELMSTR-KEY)
 18722*        SET       (ADDRESS OF CLAIM-MASTER)
 18723*    END-EXEC.
 18724     MOVE 0
 18725       TO DFHEIV11
 18726*    MOVE '&.S                   )   #00018449' TO DFHEIV0
 18727     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18728     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18729     MOVE X'2020233030303138343439' TO DFHEIV0(25:11)
 18730     CALL 'kxdfhei1' USING DFHEIV0,
 18731           CLMS-ID,
 18732           DFHEIV20,
 18733           DFHEIV99,
 18734           ELMSTR-KEY,
 18735           DFHEIV99,
 18736           DFHEIV11,
 18737           DFHEIV99,
 18738           DFHEIV99
 18739     SET ADDRESS OF CLAIM-MASTER TO
 18740         DFHEIV20
 18741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18742
 18743
 18744     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18745        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18746         GO TO 7250-CONTINUE
 18747     END-IF.
 18748
 18749     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18750        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18751        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18752        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18753        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18754         GO TO 7250-NEXT-CLAIM
 18755     END-IF.
 18756
 18757     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18758        OR (CL-CLAIM-TYPE = 'I')
 18759        OR (CL-CLAIM-TYPE = 'G')
 18760          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18761              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18762              GO TO 7250-CONTINUE
 18763          END-IF
 18764     END-IF.
 18765
 18766     GO TO 7250-NEXT-CLAIM.
 18767
 18768 7250-CONTINUE.
 18769
 18770     IF W-BROWSE-SW = 'Y'
 18771
 18772* EXEC CICS ENDBR
 18773*            DATASET   (CLMS-ID)
 18774*        END-EXEC
 18775     MOVE 0
 18776       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 344
* EL050.cbl
 18777*    MOVE '&2                    $   #00018482' TO DFHEIV0
 18778     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18780     MOVE X'2020233030303138343832' TO DFHEIV0(25:11)
 18781     CALL 'kxdfhei1' USING DFHEIV0,
 18782           CLMS-ID,
 18783           DFHEIV11,
 18784           DFHEIV99
 18785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18786         MOVE 'N' TO W-BROWSE-SW
 18787     END-IF.
 18788
 18789 7250-EXIT.
 18790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 345
* EL050.cbl
 18792 7300-CHECK-FOR-OPEN-CLMS.
 18793
 18794*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18795*    MOVE SPACES                 TO CNTL-ACCESS.
 18796*    MOVE '1'                    TO CNTL-REC-TYPE.
 18797*    MOVE +0                     TO CNTL-SEQ-NO.
 18798
 18799*    MOVE '3'                    TO RC-SW-1.
 18800*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18801
 18802*    IF NOT CF-COMPANY-MASTER
 18803*         PERFORM 0099-COMPANY-NOT-FOUND
 18804*         GO TO 7300-EXIT.
 18805
 18806     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18807                                    W-CL-COMP-CD.
 18808     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18809                                    W-CL-CERT-NO.
 18810
 18811
 18812* EXEC CICS HANDLE CONDITION
 18813*        NOTFND  (7300-CONTINUE)
 18814*        ENDFILE (7300-CONTINUE)
 18815*    END-EXEC.
 18816*    MOVE '"$I''                  ! * #00018510' TO DFHEIV0
 18817     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18819     MOVE X'2A20233030303138353130' TO DFHEIV0(25:11)
 18820     CALL 'kxdfhei1' USING DFHEIV0
 18821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18822
 18823
 18824
 18825* EXEC CICS IGNORE CONDITION
 18826*        DUPKEY
 18827*    END-EXEC.
 18828*    MOVE '"*$                   !   #00018515' TO DFHEIV0
 18829     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18831     MOVE X'2020233030303138353135' TO DFHEIV0(25:11)
 18832     CALL 'kxdfhei1' USING DFHEIV0
 18833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18834
 18835
 18836
 18837* EXEC CICS STARTBR
 18838*        DATASET   (CLMS-ID)
 18839*        RIDFLD    (ELMSTR-KEY)
 18840*        GENERIC   EQUAL
 18841*        KEYLENGTH (ELMSTR-LENGTH)
 18842*    END-EXEC.
 18843     MOVE 0
 18844       TO DFHEIV11
 18845*    MOVE '&,   KG    E          &   #00018519' TO DFHEIV0
 18846     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18848     MOVE X'2020233030303138353139' TO DFHEIV0(25:11)
 18849     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 346
* EL050.cbl
 18850           CLMS-ID,
 18851           ELMSTR-KEY,
 18852           ELMSTR-LENGTH,
 18853           DFHEIV11,
 18854           DFHEIV99
 18855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18856
 18857
 18858     MOVE 'Y'                    TO W-BROWSE-SW.
 18859
 18860 7300-NEXT-CLAIM.
 18861
 18862
 18863* EXEC CICS READNEXT
 18864*        DATASET   (CLMS-ID)
 18865*        RIDFLD    (ELMSTR-KEY)
 18866*        SET       (ADDRESS OF CLAIM-MASTER)
 18867*    END-EXEC.
 18868     MOVE 0
 18869       TO DFHEIV11
 18870*    MOVE '&.S                   )   #00018530' TO DFHEIV0
 18871     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18873     MOVE X'2020233030303138353330' TO DFHEIV0(25:11)
 18874     CALL 'kxdfhei1' USING DFHEIV0,
 18875           CLMS-ID,
 18876           DFHEIV20,
 18877           DFHEIV99,
 18878           ELMSTR-KEY,
 18879           DFHEIV99,
 18880           DFHEIV11,
 18881           DFHEIV99,
 18882           DFHEIV99
 18883     SET ADDRESS OF CLAIM-MASTER TO
 18884         DFHEIV20
 18885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18886
 18887
 18888     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18889        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18890         GO TO 7300-CONTINUE.
 18891
 18892     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18893        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18894        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18895        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18896        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18897         GO TO 7300-NEXT-CLAIM.
 18898
 18899*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18900     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18901        OR (CL-CLAIM-TYPE = 'I')
 18902        OR (CL-CLAIM-TYPE = 'G')
 18903        IF CLAIM-IS-OPEN
 18904           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18905             AND PB-C-AH-CANCEL-DT > SPACES
 18906              MOVE ER-2896        TO WS-ERROR
 18907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 347
* EL050.cbl
 18908           END-IF
 18909           EVALUATE TRUE
 18910             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18911                 MOVE ER-2884      TO WS-ERROR
 18912             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18913                 MOVE ER-2887      TO WS-ERROR
 18914             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18915                 MOVE ER-2886      TO WS-ERROR
 18916             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18917                 MOVE ER-2888      TO WS-ERROR
 18918             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18919                 MOVE ER-2885      TO WS-ERROR
 18920             WHEN OTHER
 18921                 MOVE ER-2768      TO WS-ERROR
 18922           END-EVALUATE
 18923           IF PB-C-AH-CANCEL-VOIDED OR
 18924              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18925                NOT AH-COVERAGE-CANCELLED)
 18926               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18927               MOVE ER-2768      TO WS-ERROR
 18928           END-IF
 18929           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18930           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18931              PB-FORCE-CODE NOT EQUAL '8'
 18932               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18933           END-IF
 18934           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18935           GO TO 7300-NEXT-CLAIM
 18936        ELSE
 18937           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18938*****THIS IS A RESCISSION OR REFORMATION
 18939              IF (AH-COVERAGE-CANCELLED AND
 18940                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18941                    MOVE ER-2890 TO WS-ERROR
 18942                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18943                    GO TO 7300-NEXT-CLAIM
 18944              END-IF
 18945           ELSE
 18946              IF CL-DENIAL-TYPE = '1'  AND
 18947                 CL-TOTAL-PAID-AMT = 0
 18948                    GO TO 7300-NEXT-CLAIM
 18949              END-IF
 18950              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18951               AND PB-C-AH-CANCEL-DT > SPACES
 18952                 MOVE ER-2756        TO WS-ERROR
 18953                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18954                 GO TO 7300-NEXT-CLAIM
 18955              END-IF
 18956           END-IF
 18957        END-IF
 18958     ELSE
 18959*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18960        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18961           IF CLAIM-IS-OPEN
 18962              MOVE ER-2889      TO WS-ERROR
 18963              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18964              GO TO 7300-NEXT-CLAIM
 18965           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 348
* EL050.cbl
 18966              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18967*****THIS IS A RESCISSION OR REFORMATION
 18968                 IF (LF-COVERAGE-CANCELLED AND
 18969                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18970                       MOVE ER-2890 TO WS-ERROR
 18971                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18972                       GO TO 7300-NEXT-CLAIM
 18973                 END-IF
 18974              ELSE
 18975                 IF CL-DENIAL-TYPE = '1'  AND
 18976                    CL-TOTAL-PAID-AMT = 0
 18977                       GO TO 7300-NEXT-CLAIM
 18978                 END-IF
 18979                 IF (AH-COVERAGE-CANCELLED AND
 18980                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18981                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18982                    (LF-COVERAGE-CANCELLED AND
 18983                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18984                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18985                       MOVE ER-2965 TO WS-ERROR
 18986                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18987                       GO TO 7300-NEXT-CLAIM
 18988                 END-IF
 18989                 IF LF-COVERAGE-CANCELLED
 18990                  IF CL-TOTAL-PAID-AMT > 0
 18991                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18992                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18993                        MOVE ER-2891 TO WS-ERROR
 18994                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18995                        GO TO 7300-NEXT-CLAIM
 18996                      END-IF
 18997                    ELSE
 18998****only show this error if cert num matches exactly
 18999                      IF PB-CERT-NO = CL-CERT-NO
 19000                         MOVE ER-2892 TO WS-ERROR
 19001                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19002                         GO TO 7300-NEXT-CLAIM
 19003                      END-IF
 19004                    END-IF
 19005                  END-IF
 19006                 END-IF
 19007              END-IF
 19008           END-IF
 19009        END-IF
 19010     END-IF
 19011
 19012     GO TO 7300-NEXT-CLAIM.
 19013
 19014 7300-CONTINUE.
 19015
 19016     IF W-BROWSE-SW = 'Y'
 19017
 19018* EXEC CICS ENDBR
 19019*            DATASET   (CLMS-ID)
 19020*        END-EXEC.
 19021     MOVE 0
 19022       TO DFHEIV11
 19023*    MOVE '&2                    $   #00018665' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 349
* EL050.cbl
 19024     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19026     MOVE X'2020233030303138363635' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0,
 19028           CLMS-ID,
 19029           DFHEIV11,
 19030           DFHEIV99
 19031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19032
 19033
 19034 7300-EXIT.
 19035     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 350
* EL050.cbl
 19037
 19038 7400-GET-REMAIN-TERM.
 19039
 19040* EXEC CICS LINK
 19041*        PROGRAM    ('ELRTRM')
 19042*        COMMAREA   (CALCULATION-PASS-AREA)
 19043*        LENGTH     (CP-COMM-LENGTH)
 19044*    END-EXEC.
 19045     MOVE 'ELRTRM' TO DFHEIV1
 19046*    MOVE '."C                   (   #00018674' TO DFHEIV0
 19047     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19049     MOVE X'2020233030303138363734' TO DFHEIV0(25:11)
 19050     CALL 'kxdfhei1' USING DFHEIV0,
 19051           DFHEIV1,
 19052           CALCULATION-PASS-AREA,
 19053           CP-COMM-LENGTH,
 19054           DFHEIV99,
 19055           DFHEIV99,
 19056           DFHEIV99,
 19057           DFHEIV99
 19058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19059
 19060
 19061 7400-EXIT.
 19062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 351
* EL050.cbl
 19064
 19065 7500-GET-REMAIN-AMOUNT.
 19066
 19067* EXEC CICS LINK
 19068*        PROGRAM    ('ELRAMT')
 19069*        COMMAREA   (CALCULATION-PASS-AREA)
 19070*        LENGTH     (CP-COMM-LENGTH)
 19071*    END-EXEC.
 19072     MOVE 'ELRAMT' TO DFHEIV1
 19073*    MOVE '."C                   (   #00018685' TO DFHEIV0
 19074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138363835' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           DFHEIV1,
 19079           CALCULATION-PASS-AREA,
 19080           CP-COMM-LENGTH,
 19081           DFHEIV99,
 19082           DFHEIV99,
 19083           DFHEIV99,
 19084           DFHEIV99
 19085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19086
 19087
 19088 7500-EXIT.
 19089     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 352
* EL050.cbl
 19091
 19092 7600-GET-REFUND.
 19093
 19094* EXEC CICS LINK
 19095*        PROGRAM    ('ELRFND')
 19096*        COMMAREA   (CALCULATION-PASS-AREA)
 19097*        LENGTH     (CP-COMM-LENGTH)
 19098*    END-EXEC.
 19099     MOVE 'ELRFND' TO DFHEIV1
 19100*    MOVE '."C                   (   #00018696' TO DFHEIV0
 19101     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19103     MOVE X'2020233030303138363936' TO DFHEIV0(25:11)
 19104     CALL 'kxdfhei1' USING DFHEIV0,
 19105           DFHEIV1,
 19106           CALCULATION-PASS-AREA,
 19107           CP-COMM-LENGTH,
 19108           DFHEIV99,
 19109           DFHEIV99,
 19110           DFHEIV99,
 19111           DFHEIV99
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19113
 19114
 19115 7600-EXIT.
 19116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 353
* EL050.cbl
 19118 7700-CALL-DL1.
 19119
 19120* EXEC CICS LINK
 19121*        PROGRAM    ('DLO001')
 19122*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19123*        LENGTH     (DLO001-COMM-LENGTH)
 19124*    END-EXEC.
 19125     MOVE 'DLO001' TO DFHEIV1
 19126*    MOVE '."C                   (   #00018706' TO DFHEIV0
 19127     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19129     MOVE X'2020233030303138373036' TO DFHEIV0(25:11)
 19130     CALL 'kxdfhei1' USING DFHEIV0,
 19131           DFHEIV1,
 19132           WS-DLO-MASTER-POLICY-FORM,
 19133           DLO001-COMM-LENGTH,
 19134           DFHEIV99,
 19135           DFHEIV99,
 19136           DFHEIV99,
 19137           DFHEIV99
 19138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19139
 19140
 19141 7700-EXIT.
 19142     EXIT.
 19143
 19144 7710-CALL-DL2.
 19145
 19146* EXEC CICS LINK
 19147*        PROGRAM    ('DLO002')
 19148*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19149*        LENGTH     (DLO002-COMM-LENGTH)
 19150*    END-EXEC.
 19151     MOVE 'DLO002' TO DFHEIV1
 19152*    MOVE '."C                   (   #00018716' TO DFHEIV0
 19153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19155     MOVE X'2020233030303138373136' TO DFHEIV0(25:11)
 19156     CALL 'kxdfhei1' USING DFHEIV0,
 19157           DFHEIV1,
 19158           WS-DLO-INTERNAL-POLICY-FORM,
 19159           DLO002-COMM-LENGTH,
 19160           DFHEIV99,
 19161           DFHEIV99,
 19162           DFHEIV99,
 19163           DFHEIV99
 19164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19165
 19166
 19167 7710-EXIT.
 19168     EXIT.
 19169
 19170 7720-CALL-DL3.
 19171
 19172* EXEC CICS LINK
 19173*        PROGRAM    ('DLO003')
 19174*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19175*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 354
* EL050.cbl
 19176*    END-EXEC.
 19177     MOVE 'DLO003' TO DFHEIV1
 19178*    MOVE '."C                   (   #00018726' TO DFHEIV0
 19179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19181     MOVE X'2020233030303138373236' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0,
 19183           DFHEIV1,
 19184           WS-DLO-VALID-BANK-ID,
 19185           DLO003-COMM-LENGTH,
 19186           DFHEIV99,
 19187           DFHEIV99,
 19188           DFHEIV99,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193 7720-EXIT.
 19194     EXIT.
 19195
 19196 7730-CALL-DL7.
 19197
 19198* EXEC CICS LINK
 19199*        PROGRAM    ('DLO007')
 19200*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19201*        LENGTH     (DLO007-COMM-LENGTH)
 19202*    END-EXEC.
 19203     MOVE 'DLO007' TO DFHEIV1
 19204*    MOVE '."C                   (   #00018736' TO DFHEIV0
 19205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303138373336' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           DFHEIV1,
 19210           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19211           DLO007-COMM-LENGTH,
 19212           DFHEIV99,
 19213           DFHEIV99,
 19214           DFHEIV99,
 19215           DFHEIV99
 19216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19217
 19218
 19219 7730-EXIT.
 19220     EXIT.
 19221
 19222 7740-CALL-DL11.
 19223
 19224* EXEC CICS LINK
 19225*        PROGRAM    ('DLO011')
 19226*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19227*        LENGTH     (DLO011-COMM-LENGTH)
 19228*    END-EXEC.
 19229     MOVE 'DLO011' TO DFHEIV1
 19230*    MOVE '."C                   (   #00018746' TO DFHEIV0
 19231     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19233     MOVE X'2020233030303138373436' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 355
* EL050.cbl
 19234     CALL 'kxdfhei1' USING DFHEIV0,
 19235           DFHEIV1,
 19236           WS-DLO-PREM-RATES-BEN-TYPE,
 19237           DLO011-COMM-LENGTH,
 19238           DFHEIV99,
 19239           DFHEIV99,
 19240           DFHEIV99,
 19241           DFHEIV99
 19242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19243
 19244
 19245 7740-EXIT.
 19246     EXIT.
 19247
 19248 7750-CALL-DL17.
 19249
 19250* EXEC CICS LINK
 19251*        PROGRAM    ('DLO017')
 19252*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19253*        LENGTH     (DLO017-COMM-LENGTH)
 19254*    END-EXEC.
 19255     MOVE 'DLO017' TO DFHEIV1
 19256*    MOVE '."C                   (   #00018756' TO DFHEIV0
 19257     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303138373536' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           DFHEIV1,
 19262           WS-DLO-VALID-RATE-CODE,
 19263           DLO017-COMM-LENGTH,
 19264           DFHEIV99,
 19265           DFHEIV99,
 19266           DFHEIV99,
 19267           DFHEIV99
 19268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19269
 19270
 19271 7750-EXIT.
 19272     EXIT.
 19273
 19274 7755-CALL-DL19.
 19275
 19276* EXEC CICS LINK
 19277*        PROGRAM    ('DLO019')
 19278*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19279*        LENGTH     (DLO019-COMM-LENGTH)
 19280*    END-EXEC.
 19281     MOVE 'DLO019' TO DFHEIV1
 19282*    MOVE '."C                   (   #00018766' TO DFHEIV0
 19283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19285     MOVE X'2020233030303138373636' TO DFHEIV0(25:11)
 19286     CALL 'kxdfhei1' USING DFHEIV0,
 19287           DFHEIV1,
 19288           WS-DLO-ORIG-COV-CAT,
 19289           DLO019-COMM-LENGTH,
 19290           DFHEIV99,
 19291           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 356
* EL050.cbl
 19292           DFHEIV99,
 19293           DFHEIV99
 19294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19295
 19296
 19297 7755-EXIT.
 19298     EXIT.
 19299
 19300 7760-CALL-DL21.
 19301
 19302* EXEC CICS LINK
 19303*        PROGRAM    ('DLO021')
 19304*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19305*        LENGTH     (DLO021-COMM-LENGTH)
 19306*    END-EXEC.
 19307     MOVE 'DLO021' TO DFHEIV1
 19308*    MOVE '."C                   (   #00018776' TO DFHEIV0
 19309     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303138373736' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0,
 19313           DFHEIV1,
 19314           WS-DLO-VALID-LOAN-OFFICER,
 19315           DLO021-COMM-LENGTH,
 19316           DFHEIV99,
 19317           DFHEIV99,
 19318           DFHEIV99,
 19319           DFHEIV99
 19320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19321
 19322
 19323 7760-EXIT.
 19324     EXIT.
 19325
 19326 7770-CALL-DL22.
 19327
 19328* EXEC CICS LINK
 19329*        PROGRAM    ('DLO022')
 19330*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19331*        LENGTH     (DLO022-COMM-LENGTH)
 19332*    END-EXEC.
 19333     MOVE 'DLO022' TO DFHEIV1
 19334*    MOVE '."C                   (   #00018786' TO DFHEIV0
 19335     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19337     MOVE X'2020233030303138373836' TO DFHEIV0(25:11)
 19338     CALL 'kxdfhei1' USING DFHEIV0,
 19339           DFHEIV1,
 19340           WS-DLO-VALID-STATE-CODE,
 19341           DLO022-COMM-LENGTH,
 19342           DFHEIV99,
 19343           DFHEIV99,
 19344           DFHEIV99,
 19345           DFHEIV99
 19346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19347
 19348
 19349 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 357
* EL050.cbl
 19350     EXIT.
 19351
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 358
* EL050.cbl
 19353
 19354 7800-REWRITE-CERT.
 19355******************************************************************
 19356*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19357*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19358******************************************************************
 19359
 19360     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19361        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19362        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19363        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19364
 19365* EXEC CICS REWRITE
 19366*                  DATASET (CERT-ID)
 19367*                  FROM    (CERTIFICATE-MASTER)
 19368*              END-EXEC
 19369     MOVE LENGTH OF
 19370      CERTIFICATE-MASTER
 19371       TO DFHEIV11
 19372*    MOVE '&& L                  %   #00018807' TO DFHEIV0
 19373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19375     MOVE X'2020233030303138383037' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0,
 19377           CERT-ID,
 19378           CERTIFICATE-MASTER,
 19379           DFHEIV11,
 19380           DFHEIV99
 19381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19382        GO TO 7800-EXIT.
 19383
 19384       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19385       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19386
 19387 7800-EXIT.
 19388      EXIT.
 19389
 19390 7900-DELETE-CERT.
 19391
 19392* EXEC CICS DELETE
 19393*        DATASET (CERT-ID)
 19394*    END-EXEC.
 19395*    MOVE '&(                    &   #00018820' TO DFHEIV0
 19396     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19397     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19398     MOVE X'2020233030303138383230' TO DFHEIV0(25:11)
 19399     CALL 'kxdfhei1' USING DFHEIV0,
 19400           CERT-ID,
 19401           DFHEIV99,
 19402           DFHEIV99,
 19403           DFHEIV99,
 19404           DFHEIV99
 19405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19406
 19407
 19408 7900-EXIT.
 19409     EXIT.
 19410
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 359
* EL050.cbl
 19411 8000-WRITE-CERT.
 19412
 19413* EXEC CICS HANDLE CONDITION
 19414*        DUPKEY    (8000-FREE-MAIN)
 19415*    END-EXEC.
 19416*    MOVE '"$$                   ! + #00018828' TO DFHEIV0
 19417     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19419     MOVE X'2B20233030303138383238' TO DFHEIV0(25:11)
 19420     CALL 'kxdfhei1' USING DFHEIV0
 19421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19422
 19423
 19424
 19425* EXEC CICS WRITE
 19426*        DATASET     (CERT-ID)
 19427*        FROM        (CERTIFICATE-MASTER)
 19428*        RIDFLD      (ELCERT-KEY)
 19429*    END-EXEC.
 19430     MOVE LENGTH OF
 19431      CERTIFICATE-MASTER
 19432       TO DFHEIV11
 19433*    MOVE '&$ L                  ''   #00018832' TO DFHEIV0
 19434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19436     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
 19437     CALL 'kxdfhei1' USING DFHEIV0,
 19438           CERT-ID,
 19439           CERTIFICATE-MASTER,
 19440           DFHEIV11,
 19441           ELCERT-KEY,
 19442           DFHEIV99,
 19443           DFHEIV99
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447 8000-FREE-MAIN.
 19448
 19449 8000-EXIT.
 19450      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 360
* EL050.cbl
 19452
 19453 8100-READ-ERPNDM.
 19454
 19455* EXEC CICS HANDLE CONDITION
 19456*         NOTFND     (8100-NOTFND)
 19457*         ENDFILE    (8100-NOTFND)
 19458*    END-EXEC.
 19459*    MOVE '"$I''                  ! , #00018845' TO DFHEIV0
 19460     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19462     MOVE X'2C20233030303138383435' TO DFHEIV0(25:11)
 19463     CALL 'kxdfhei1' USING DFHEIV0
 19464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19465
 19466
 19467     MOVE SPACES                 TO ERPNDM-FOUND.
 19468     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19469
 19470
 19471* EXEC CICS READ
 19472*         DATASET   (FILE-ERPNDM)
 19473*         RIDFLD    (PM-CONTROL-PRIMARY)
 19474*         INTO      (PENDING-MAILING-DATA)
 19475*    END-EXEC.
 19476     MOVE LENGTH OF
 19477      PENDING-MAILING-DATA
 19478       TO DFHEIV11
 19479*    MOVE '&"IL       E          (   #00018853' TO DFHEIV0
 19480     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19481     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19482     MOVE X'2020233030303138383533' TO DFHEIV0(25:11)
 19483     CALL 'kxdfhei1' USING DFHEIV0,
 19484           FILE-ERPNDM,
 19485           PENDING-MAILING-DATA,
 19486           DFHEIV11,
 19487           PM-CONTROL-PRIMARY,
 19488           DFHEIV99,
 19489           DFHEIV99,
 19490           DFHEIV99
 19491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19492
 19493
 19494     GO TO 8100-EXIT.
 19495
 19496 8100-NOTFND.
 19497
 19498     MOVE 'X'                    TO ERPNDM-FOUND.
 19499     MOVE ER-2694                TO WS-ERROR.
 19500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19501     MOVE ER-2883                TO WS-ERROR
 19502     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19503     .
 19504 8100-EXIT.
 19505     EXIT.
 19506
 19507 8110-READ-ERMAIL.
 19508
 19509* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 361
* EL050.cbl
 19510*         NOTFND     (8110-NOTFND)
 19511*         ENDFILE    (8110-NOTFND)
 19512*    END-EXEC.
 19513*    MOVE '"$I''                  ! - #00018873' TO DFHEIV0
 19514     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19516     MOVE X'2D20233030303138383733' TO DFHEIV0(25:11)
 19517     CALL 'kxdfhei1' USING DFHEIV0
 19518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19519
 19520
 19521     MOVE SPACES                 TO ERMAIL-FOUND.
 19522     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19523     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19524     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19525     MOVE PB-SV-STATE            TO MA-STATE.
 19526
 19527
 19528* EXEC CICS READ
 19529*         UPDATE
 19530*         DATASET   (FILE-ERMAIL)
 19531*         RIDFLD    (MA-CONTROL-PRIMARY)
 19532*         INTO      (MAILING-DATA)
 19533*    END-EXEC.
 19534     MOVE LENGTH OF
 19535      MAILING-DATA
 19536       TO DFHEIV11
 19537*    MOVE '&"IL       EU         (   #00018884' TO DFHEIV0
 19538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19539     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19540     MOVE X'2020233030303138383834' TO DFHEIV0(25:11)
 19541     CALL 'kxdfhei1' USING DFHEIV0,
 19542           FILE-ERMAIL,
 19543           MAILING-DATA,
 19544           DFHEIV11,
 19545           MA-CONTROL-PRIMARY,
 19546           DFHEIV99,
 19547           DFHEIV99,
 19548           DFHEIV99
 19549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19550
 19551
 19552     GO TO 8110-EXIT.
 19553
 19554 8110-NOTFND.
 19555     MOVE 'X'                    TO ERMAIL-FOUND.
 19556
 19557 8110-EXIT.
 19558     EXIT.
 19559
 19560 8120-REWRITE-ERMAIL.
 19561
 19562* EXEC CICS REWRITE
 19563*         DATASET    (FILE-ERMAIL)
 19564*         FROM       (MAILING-DATA)
 19565*    END-EXEC.
 19566     MOVE LENGTH OF
 19567      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 362
* EL050.cbl
 19568       TO DFHEIV11
 19569*    MOVE '&& L                  %   #00018900' TO DFHEIV0
 19570     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19571     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19572     MOVE X'2020233030303138393030' TO DFHEIV0(25:11)
 19573     CALL 'kxdfhei1' USING DFHEIV0,
 19574           FILE-ERMAIL,
 19575           MAILING-DATA,
 19576           DFHEIV11,
 19577           DFHEIV99
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581 8120-EXIT.
 19582     EXIT.
 19583
 19584 8130-WRITE-ERMAIL.
 19585
 19586* EXEC CICS HANDLE CONDITION
 19587*         DUPKEY   (8130-EXIT)
 19588*    END-EXEC.
 19589*    MOVE '"$$                   ! . #00018909' TO DFHEIV0
 19590     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19592     MOVE X'2E20233030303138393039' TO DFHEIV0(25:11)
 19593     CALL 'kxdfhei1' USING DFHEIV0
 19594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19595
 19596
 19597
 19598* EXEC CICS WRITE
 19599*         DATASET     (FILE-ERMAIL)
 19600*         RIDFLD      (MA-CONTROL-PRIMARY)
 19601*         FROM        (MAILING-DATA)
 19602*    END-EXEC.
 19603     MOVE LENGTH OF
 19604      MAILING-DATA
 19605       TO DFHEIV11
 19606*    MOVE '&$ L                  ''   #00018913' TO DFHEIV0
 19607     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19608     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19609     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
 19610     CALL 'kxdfhei1' USING DFHEIV0,
 19611           FILE-ERMAIL,
 19612           MAILING-DATA,
 19613           DFHEIV11,
 19614           MA-CONTROL-PRIMARY,
 19615           DFHEIV99,
 19616           DFHEIV99
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19618
 19619
 19620 8130-EXIT.
 19621     EXIT.
 19622
 19623 8140-UNLOCK-ERMAIL.
 19624
 19625* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 363
* EL050.cbl
 19626*         DATASET   (FILE-ERMAIL)
 19627*    END-EXEC.
 19628*    MOVE '&*                    #   #00018923' TO DFHEIV0
 19629     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19631     MOVE X'2020233030303138393233' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0,
 19633           FILE-ERMAIL,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638 8140-EXIT.
 19639     EXIT.
 19640
 19641 8150-read-elcrtt.
 19642
 19643
 19644* EXEC CICS HANDLE CONDITION
 19645*        NOTFND   (8150-exit)
 19646*    END-EXEC
 19647*    MOVE '"$I                   ! / #00018932' TO DFHEIV0
 19648     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19650     MOVE X'2F20233030303138393332' TO DFHEIV0(25:11)
 19651     CALL 'kxdfhei1' USING DFHEIV0
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19653
 19654     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19655     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19656
 19657
 19658* EXEC CICS READ
 19659*        DATASET  (CRTT-ID)
 19660*        RIDFLD   (WS-ELCRTT-KEY)
 19661*        INTO     (CERTIFICATE-TRAILERS)
 19662*    END-EXEC
 19663     MOVE LENGTH OF
 19664      CERTIFICATE-TRAILERS
 19665       TO DFHEIV11
 19666*    MOVE '&"IL       E          (   #00018939' TO DFHEIV0
 19667     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19669     MOVE X'2020233030303138393339' TO DFHEIV0(25:11)
 19670     CALL 'kxdfhei1' USING DFHEIV0,
 19671           CRTT-ID,
 19672           CERTIFICATE-TRAILERS,
 19673           DFHEIV11,
 19674           WS-ELCRTT-KEY,
 19675           DFHEIV99,
 19676           DFHEIV99,
 19677           DFHEIV99
 19678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19679
 19680     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19681     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19682
 19683     .
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 364
* EL050.cbl
 19684 8150-exit.
 19685     exit.
 19686 8180-UPDATE-VIN-NUMBER.
 19687
 19688* EXEC CICS HANDLE CONDITION
 19689*        NOTFND   (8180-NOTFND)
 19690*    END-EXEC.
 19691*    MOVE '"$I                   ! 0 #00018952' TO DFHEIV0
 19692     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19694     MOVE X'3020233030303138393532' TO DFHEIV0(25:11)
 19695     CALL 'kxdfhei1' USING DFHEIV0
 19696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19697
 19698
 19699     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19700     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19701
 19702
 19703* EXEC CICS READ
 19704*        UPDATE
 19705*        DATASET  (CRTT-ID)
 19706*        RIDFLD   (WS-ELCRTT-KEY)
 19707*        INTO     (CERTIFICATE-TRAILERS)
 19708*    END-EXEC.
 19709     MOVE LENGTH OF
 19710      CERTIFICATE-TRAILERS
 19711       TO DFHEIV11
 19712*    MOVE '&"IL       EU         (   #00018959' TO DFHEIV0
 19713     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19715     MOVE X'2020233030303138393539' TO DFHEIV0(25:11)
 19716     CALL 'kxdfhei1' USING DFHEIV0,
 19717           CRTT-ID,
 19718           CERTIFICATE-TRAILERS,
 19719           DFHEIV11,
 19720           WS-ELCRTT-KEY,
 19721           DFHEIV99,
 19722           DFHEIV99,
 19723           DFHEIV99
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19728         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19729
 19730* EXEC CICS REWRITE
 19731*           DATASET  (CRTT-ID)
 19732*           FROM     (CERTIFICATE-TRAILERS)
 19733*        END-EXEC
 19734     MOVE LENGTH OF
 19735      CERTIFICATE-TRAILERS
 19736       TO DFHEIV11
 19737*    MOVE '&& L                  %   #00018968' TO DFHEIV0
 19738     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19739     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19740     MOVE X'2020233030303138393638' TO DFHEIV0(25:11)
 19741     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 365
* EL050.cbl
 19742           CRTT-ID,
 19743           CERTIFICATE-TRAILERS,
 19744           DFHEIV11,
 19745           DFHEIV99
 19746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19747     ELSE
 19748
 19749* EXEC CICS UNLOCK
 19750*          DATASET  (CRTT-ID)
 19751*       END-EXEC
 19752*    MOVE '&*                    #   #00018973' TO DFHEIV0
 19753     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19754     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303138393733' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           CRTT-ID,
 19758           DFHEIV99
 19759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19760     END-IF.
 19761
 19762     GO TO 8180-EXIT.
 19763
 19764 8180-NOTFND.
 19765
 19766     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19767     MOVE 'CS'         TO CS-RECORD-ID.
 19768     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19769     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19770     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19771     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19772
 19773* EXEC CICS WRITE
 19774*       DATASET  (CRTT-ID)
 19775*       RIDFLD   (WS-ELCRTT-KEY)
 19776*       FROM     (CERTIFICATE-TRAILERS)
 19777*    END-EXEC.
 19778     MOVE LENGTH OF
 19779      CERTIFICATE-TRAILERS
 19780       TO DFHEIV11
 19781*    MOVE '&$ L                  ''   #00018988' TO DFHEIV0
 19782     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19784     MOVE X'2020233030303138393838' TO DFHEIV0(25:11)
 19785     CALL 'kxdfhei1' USING DFHEIV0,
 19786           CRTT-ID,
 19787           CERTIFICATE-TRAILERS,
 19788           DFHEIV11,
 19789           WS-ELCRTT-KEY,
 19790           DFHEIV99,
 19791           DFHEIV99
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795 8180-EXIT.
 19796     EXIT.
 19797
 19798 8190-UPDATE-REFUND-CLAIM-FLAG.
 19799
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 366
* EL050.cbl
 19800* EXEC CICS HANDLE CONDITION
 19801*        NOTFND   (8190-NOTFND)
 19802*    END-EXEC.
 19803*    MOVE '"$I                   ! 1 #00018998' TO DFHEIV0
 19804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19806     MOVE X'3120233030303138393938' TO DFHEIV0(25:11)
 19807     CALL 'kxdfhei1' USING DFHEIV0
 19808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19809
 19810
 19811     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19812     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19813
 19814
 19815* EXEC CICS READ
 19816*        UPDATE
 19817*        DATASET  (CRTT-ID)
 19818*        RIDFLD   (WS-ELCRTT-KEY)
 19819*        INTO     (CERTIFICATE-TRAILERS)
 19820*    END-EXEC.
 19821     MOVE LENGTH OF
 19822      CERTIFICATE-TRAILERS
 19823       TO DFHEIV11
 19824*    MOVE '&"IL       EU         (   #00019005' TO DFHEIV0
 19825     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19827     MOVE X'2020233030303139303035' TO DFHEIV0(25:11)
 19828     CALL 'kxdfhei1' USING DFHEIV0,
 19829           CRTT-ID,
 19830           CERTIFICATE-TRAILERS,
 19831           DFHEIV11,
 19832           WS-ELCRTT-KEY,
 19833           DFHEIV99,
 19834           DFHEIV99,
 19835           DFHEIV99
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19840
 19841* EXEC CICS REWRITE
 19842*       DATASET  (CRTT-ID)
 19843*       FROM     (CERTIFICATE-TRAILERS)
 19844*    END-EXEC.
 19845     MOVE LENGTH OF
 19846      CERTIFICATE-TRAILERS
 19847       TO DFHEIV11
 19848*    MOVE '&& L                  %   #00019013' TO DFHEIV0
 19849     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19850     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19851     MOVE X'2020233030303139303133' TO DFHEIV0(25:11)
 19852     CALL 'kxdfhei1' USING DFHEIV0,
 19853           CRTT-ID,
 19854           CERTIFICATE-TRAILERS,
 19855           DFHEIV11,
 19856           DFHEIV99
 19857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 367
* EL050.cbl
 19858
 19859
 19860     GO TO 8190-EXIT.
 19861
 19862 8190-NOTFND.
 19863
 19864     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19865     MOVE 'CS'         TO CS-RECORD-ID.
 19866     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19867     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19868     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19869     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19870
 19871* EXEC CICS WRITE
 19872*       DATASET  (CRTT-ID)
 19873*       RIDFLD   (WS-ELCRTT-KEY)
 19874*       FROM     (CERTIFICATE-TRAILERS)
 19875*    END-EXEC.
 19876     MOVE LENGTH OF
 19877      CERTIFICATE-TRAILERS
 19878       TO DFHEIV11
 19879*    MOVE '&$ L                  ''   #00019028' TO DFHEIV0
 19880     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19881     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19882     MOVE X'2020233030303139303238' TO DFHEIV0(25:11)
 19883     CALL 'kxdfhei1' USING DFHEIV0,
 19884           CRTT-ID,
 19885           CERTIFICATE-TRAILERS,
 19886           DFHEIV11,
 19887           WS-ELCRTT-KEY,
 19888           DFHEIV99,
 19889           DFHEIV99
 19890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19891
 19892
 19893 8190-EXIT.
 19894     EXIT.
 19895
 19896 8195-UPDATE-AGE-FLAGS.
 19897
 19898* EXEC CICS HANDLE CONDITION
 19899*        NOTFND   (8195-NOTFND)
 19900*    END-EXEC.
 19901*    MOVE '"$I                   ! 2 #00019038' TO DFHEIV0
 19902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19904     MOVE X'3220233030303139303338' TO DFHEIV0(25:11)
 19905     CALL 'kxdfhei1' USING DFHEIV0
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19910     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19911
 19912
 19913* EXEC CICS READ
 19914*        UPDATE
 19915*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 368
* EL050.cbl
 19916*        RIDFLD   (WS-ELCRTT-KEY)
 19917*        INTO     (CERTIFICATE-TRAILERS)
 19918*    END-EXEC.
 19919     MOVE LENGTH OF
 19920      CERTIFICATE-TRAILERS
 19921       TO DFHEIV11
 19922*    MOVE '&"IL       EU         (   #00019045' TO DFHEIV0
 19923     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19925     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 19926     CALL 'kxdfhei1' USING DFHEIV0,
 19927           CRTT-ID,
 19928           CERTIFICATE-TRAILERS,
 19929           DFHEIV11,
 19930           WS-ELCRTT-KEY,
 19931           DFHEIV99,
 19932           DFHEIV99,
 19933           DFHEIV99
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936
 19937     IF WS-INS-AGE-SET = 'Y'
 19938        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19939     END-IF
 19940     IF WS-JNT-AGE-SET = 'Y'
 19941        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19942     END-IF
 19943
 19944
 19945* EXEC CICS REWRITE
 19946*       DATASET  (CRTT-ID)
 19947*       FROM     (CERTIFICATE-TRAILERS)
 19948*    END-EXEC.
 19949     MOVE LENGTH OF
 19950      CERTIFICATE-TRAILERS
 19951       TO DFHEIV11
 19952*    MOVE '&& L                  %   #00019059' TO DFHEIV0
 19953     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19954     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19955     MOVE X'2020233030303139303539' TO DFHEIV0(25:11)
 19956     CALL 'kxdfhei1' USING DFHEIV0,
 19957           CRTT-ID,
 19958           CERTIFICATE-TRAILERS,
 19959           DFHEIV11,
 19960           DFHEIV99
 19961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19962
 19963
 19964     GO TO 8195-EXIT.
 19965
 19966 8195-NOTFND.
 19967
 19968     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19969     MOVE 'CS'         TO CS-RECORD-ID.
 19970     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19971     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19972     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19973     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 369
* EL050.cbl
 19974     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19975
 19976* EXEC CICS WRITE
 19977*       DATASET  (CRTT-ID)
 19978*       RIDFLD   (WS-ELCRTT-KEY)
 19979*       FROM     (CERTIFICATE-TRAILERS)
 19980*    END-EXEC.
 19981     MOVE LENGTH OF
 19982      CERTIFICATE-TRAILERS
 19983       TO DFHEIV11
 19984*    MOVE '&$ L                  ''   #00019075' TO DFHEIV0
 19985     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19987     MOVE X'2020233030303139303735' TO DFHEIV0(25:11)
 19988     CALL 'kxdfhei1' USING DFHEIV0,
 19989           CRTT-ID,
 19990           CERTIFICATE-TRAILERS,
 19991           DFHEIV11,
 19992           WS-ELCRTT-KEY,
 19993           DFHEIV99,
 19994           DFHEIV99
 19995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19996
 19997
 19998 8195-EXIT.
 19999     EXIT.
 20000
 20001 8200-READ-REIN-TABLE.
 20002
 20003* EXEC CICS HANDLE CONDITION
 20004*         NOTFND   (8200-NOTFND)
 20005*    END-EXEC.
 20006*    MOVE '"$I                   ! 3 #00019085' TO DFHEIV0
 20007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20009     MOVE X'3320233030303139303835' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0
 20011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20012
 20013
 20014
 20015* EXEC CICS READ
 20016*        DATASET     (REIN-ID)
 20017*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20018*        RIDFLD      (ERREIN-KEY)
 20019*    END-EXEC.
 20020*    MOVE '&"S        E          (   #00019089' TO DFHEIV0
 20021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20023     MOVE X'2020233030303139303839' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0,
 20025           REIN-ID,
 20026           DFHEIV20,
 20027           DFHEIV99,
 20028           ERREIN-KEY,
 20029           DFHEIV99,
 20030           DFHEIV99,
 20031           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 370
* EL050.cbl
 20032     SET ADDRESS OF REINSURANCE-RECORD TO
 20033         DFHEIV20
 20034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20035
 20036
 20037     GO TO 8200-EXIT.
 20038
 20039 8200-NOTFND.
 20040     MOVE 'N'             TO WS-REIN-READ-SW.
 20041
 20042 8200-EXIT.
 20043      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 371
* EL050.cbl
 20045
 20046 8300-READ-CTBL-TABLE.
 20047
 20048* EXEC CICS HANDLE CONDITION
 20049*        NOTFND    (8300-NOTFND)
 20050*        DISABLED  (8300-ERRESS-PROBLEM)
 20051*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20052*        ENDFILE   (8300-NOTFND)
 20053*    END-EXEC.
 20054*    MOVE '"$IcJ''                ! 4 #00019105' TO DFHEIV0
 20055     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20057     MOVE X'3420233030303139313035' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0
 20059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20060
 20061
 20062
 20063* EXEC CICS READ
 20064*        DATASET     (CTBL-ID)
 20065*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20066*        RIDFLD      (ERCTBL-KEY)
 20067*    END-EXEC.
 20068*    MOVE '&"S        E          (   #00019112' TO DFHEIV0
 20069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20071     MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
 20072     CALL 'kxdfhei1' USING DFHEIV0,
 20073           CTBL-ID,
 20074           DFHEIV20,
 20075           DFHEIV99,
 20076           ERCTBL-KEY,
 20077           DFHEIV99,
 20078           DFHEIV99,
 20079           DFHEIV99
 20080     SET ADDRESS OF COMM-TABLE-RECORD TO
 20081         DFHEIV20
 20082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20083
 20084
 20085     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20086
 20087     GO TO 8300-EXIT.
 20088
 20089 8300-NOTFND.
 20090
 20091     IF CTBL-SW = '0530'
 20092         MOVE 'AA'                     TO WS-AH-COMP-CD
 20093         MOVE '0550'                   TO CTBL-SW
 20094         MOVE '1'                      TO WS-CTBL-READ-SW
 20095         GO TO 8300-EXIT.
 20096
 20097     IF CTBL-SW = '0540'
 20098         MOVE 'AA'                     TO WS-LF-COMP-CD
 20099         MOVE '0550'                   TO CTBL-SW
 20100         MOVE '1'                      TO WS-CTBL-READ-SW
 20101         GO TO 8300-EXIT.
 20102
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 372
* EL050.cbl
 20103     IF CTBL-SW = '0550'
 20104         MOVE '2'                      TO WS-CTBL-READ-SW
 20105         GO TO 8300-EXIT.
 20106
 20107     GO TO 8300-EXIT.
 20108
 20109 8300-ERRESS-PROBLEM.
 20110
 20111      MOVE ER-8050              TO WS-ERROR.
 20112      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20113
 20114     GO TO 8300-EXIT.
 20115
 20116 8300-EXIT.
 20117      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 373
* EL050.cbl
 20119
 20120
 20121 8400-GETMAIN-ERFORM.
 20122
 20123
 20124* EXEC CICS   GETMAIN
 20125*        LENGTH  (500)
 20126*        SET     (ADDRESS OF FORM-MASTER)
 20127*    END-EXEC.
 20128     MOVE 500
 20129       TO DFHEIV11
 20130*    MOVE '," L                  $   #00019156' TO DFHEIV0
 20131     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20132     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20133     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 20134     CALL 'kxdfhei1' USING DFHEIV0,
 20135           DFHEIV20,
 20136           DFHEIV11,
 20137           DFHEIV99
 20138     SET ADDRESS OF FORM-MASTER TO
 20139         DFHEIV20
 20140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20141
 20142
 20143     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20144
 20145 8400-EXIT.
 20146      EXIT.
 20147
 20148 8450-READ-FORM-MASTER.
 20149
 20150
 20151* EXEC CICS  HANDLE CONDITION
 20152*        NOTFND   (8450-FORM-NOT-FOUND)
 20153*        ENDFILE  (8450-FORM-NOT-FOUND)
 20154*    END-EXEC.
 20155*    MOVE '"$I''                  ! 5 #00019168' TO DFHEIV0
 20156     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20158     MOVE X'3520233030303139313638' TO DFHEIV0(25:11)
 20159     CALL 'kxdfhei1' USING DFHEIV0
 20160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20161
 20162
 20163
 20164* EXEC CICS   READ
 20165*        DATASET   (FORM-ID)
 20166*        RIDFLD    (ERFORM-KEY)
 20167*        INTO      (FORM-MASTER)
 20168*        GTEQ
 20169*    END-EXEC.
 20170     MOVE LENGTH OF
 20171      FORM-MASTER
 20172       TO DFHEIV11
 20173*    MOVE '&"IL       G          (   #00019173' TO DFHEIV0
 20174     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20176     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 374
* EL050.cbl
 20177     CALL 'kxdfhei1' USING DFHEIV0,
 20178           FORM-ID,
 20179           FORM-MASTER,
 20180           DFHEIV11,
 20181           ERFORM-KEY,
 20182           DFHEIV99,
 20183           DFHEIV99,
 20184           DFHEIV99
 20185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20186
 20187
 20188     MOVE  'Y'           TO  FORM-MASTER-SW.
 20189
 20190     GO TO  8450-EXIT.
 20191
 20192 8450-FORM-NOT-FOUND.
 20193
 20194     MOVE  'N'           TO  FORM-MASTER-SW.
 20195
 20196 8450-EXIT.
 20197      EXIT.
 20198
 20199 8500-DATE-CONVERT.
 20200
 20201* EXEC CICS LINK
 20202*        PROGRAM    ('ELDATCV')
 20203*        COMMAREA   (DATE-CONVERSION-DATA)
 20204*        LENGTH     (DC-COMM-LENGTH)
 20205*    END-EXEC.
 20206     MOVE 'ELDATCV' TO DFHEIV1
 20207*    MOVE '."C                   (   #00019192' TO DFHEIV0
 20208     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20210     MOVE X'2020233030303139313932' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0,
 20212           DFHEIV1,
 20213           DATE-CONVERSION-DATA,
 20214           DC-COMM-LENGTH,
 20215           DFHEIV99,
 20216           DFHEIV99,
 20217           DFHEIV99,
 20218           DFHEIV99
 20219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20220
 20221
 20222 8500-EXIT.
 20223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 375
* EL050.cbl
 20225
 20226 8555-RELOAD-CONTROL-FILE.
 20227     CONTINUE.
 20228
 20229 8555-EXIT.
 20230     EXIT.
 20231
 20232 8557-GETMAIN-ERPLAN.
 20233
 20234
 20235* EXEC CICS GETMAIN
 20236*        LENGTH    (840)
 20237*        SET       (ADDRESS OF PLAN-RECORDS)
 20238*    END-EXEC.
 20239     MOVE 840
 20240       TO DFHEIV11
 20241*    MOVE '," L                  $   #00019210' TO DFHEIV0
 20242     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20244     MOVE X'2020233030303139323130' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0,
 20246           DFHEIV20,
 20247           DFHEIV11,
 20248           DFHEIV99
 20249     SET ADDRESS OF PLAN-RECORDS TO
 20250         DFHEIV20
 20251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20252
 20253
 20254     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20255
 20256 8557-EXIT.
 20257     EXIT.
 20258
 20259 8560-GETMAIN.
 20260
 20261* EXEC CICS GETMAIN
 20262*        LENGTH    (2000)
 20263*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20264*    END-EXEC.
 20265     MOVE 2000
 20266       TO DFHEIV11
 20267*    MOVE '," L                  $   #00019221' TO DFHEIV0
 20268     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20270     MOVE X'2020233030303139323231' TO DFHEIV0(25:11)
 20271     CALL 'kxdfhei1' USING DFHEIV0,
 20272           DFHEIV20,
 20273           DFHEIV11,
 20274           DFHEIV99
 20275     SET ADDRESS OF ACCOUNT-MASTER TO
 20276         DFHEIV20
 20277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20278
 20279
 20280     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20281
 20282 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 376
* EL050.cbl
 20283     EXIT.
 20284
 20285 8570-START-ACCOUNT-MASTER.
 20286
 20287* EXEC CICS HANDLE CONDITION
 20288*        NOTFND    (0199-ACCT-NOT-FOUND)
 20289*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20290*    END-EXEC.
 20291*    MOVE '"$I''                  ! 6 #00019232' TO DFHEIV0
 20292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20294     MOVE X'3620233030303139323332' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0
 20296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20297
 20298
 20299
 20300* EXEC CICS STARTBR
 20301*        DATASET    (ACCT-ID)
 20302*        RIDFLD     (ERACCT-KEY)
 20303*        GTEQ
 20304*    END-EXEC.
 20305     MOVE 0
 20306       TO DFHEIV11
 20307*    MOVE '&,         G          &   #00019237' TO DFHEIV0
 20308     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20309     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20310     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 20311     CALL 'kxdfhei1' USING DFHEIV0,
 20312           ACCT-ID,
 20313           ERACCT-KEY,
 20314           DFHEIV99,
 20315           DFHEIV11,
 20316           DFHEIV99
 20317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20318
 20319
 20320 8570-EXIT.
 20321     EXIT.
 20322
 20323 8580-READ-ACCOUNT-MASTER.
 20324
 20325* EXEC CICS HANDLE CONDITION
 20326*        NOTFND    (0199-ACCT-NOT-FOUND)
 20327*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20328*    END-EXEC.
 20329*    MOVE '"$I''                  ! 7 #00019247' TO DFHEIV0
 20330     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20332     MOVE X'3720233030303139323437' TO DFHEIV0(25:11)
 20333     CALL 'kxdfhei1' USING DFHEIV0
 20334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20335
 20336
 20337
 20338* EXEC CICS READNEXT
 20339*        DATASET     (ACCT-ID)
 20340*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 377
* EL050.cbl
 20341*        RIDFLD      (ERACCT-KEY)
 20342*    END-EXEC.
 20343     MOVE LENGTH OF
 20344      ACCOUNT-MASTER
 20345       TO DFHEIV12
 20346     MOVE 0
 20347       TO DFHEIV11
 20348*    MOVE '&.IL                  )   #00019252' TO DFHEIV0
 20349     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20350     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20351     MOVE X'2020233030303139323532' TO DFHEIV0(25:11)
 20352     CALL 'kxdfhei1' USING DFHEIV0,
 20353           ACCT-ID,
 20354           ACCOUNT-MASTER,
 20355           DFHEIV12,
 20356           ERACCT-KEY,
 20357           DFHEIV99,
 20358           DFHEIV11,
 20359           DFHEIV99,
 20360           DFHEIV99
 20361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20362
 20363
 20364 8580-EXIT.
 20365     EXIT.
 20366
 20367 8582-READ-COMPENSATION-MASTER.
 20368
 20369* EXEC CICS HANDLE CONDITION
 20370*        NOTFND    (8582-COMP-NOT-FOUND)
 20371*        ENDFILE   (8582-COMP-NOT-FOUND)
 20372*    END-EXEC.
 20373*    MOVE '"$I''                  ! 8 #00019262' TO DFHEIV0
 20374     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20376     MOVE X'3820233030303139323632' TO DFHEIV0(25:11)
 20377     CALL 'kxdfhei1' USING DFHEIV0
 20378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20379
 20380
 20381
 20382* EXEC CICS READ
 20383*        DATASET     (COMP-ID)
 20384*        INTO        (COMPENSATION-MASTER)
 20385*        RIDFLD      (ERCOMP-KEY)
 20386*    END-EXEC.
 20387     MOVE LENGTH OF
 20388      COMPENSATION-MASTER
 20389       TO DFHEIV11
 20390*    MOVE '&"IL       E          (   #00019267' TO DFHEIV0
 20391     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20393     MOVE X'2020233030303139323637' TO DFHEIV0(25:11)
 20394     CALL 'kxdfhei1' USING DFHEIV0,
 20395           COMP-ID,
 20396           COMPENSATION-MASTER,
 20397           DFHEIV11,
 20398           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 378
* EL050.cbl
 20399           DFHEIV99,
 20400           DFHEIV99,
 20401           DFHEIV99
 20402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20403
 20404
 20405     MOVE 'Y'                    TO COMP-MASTER-SW
 20406
 20407     GO TO 8582-EXIT
 20408     .
 20409 8582-COMP-NOT-FOUND.
 20410
 20411     MOVE 'N'                    TO COMP-MASTER-SW.
 20412
 20413 8582-EXIT.
 20414     EXIT.
 20415
 20416 8583-READ-ERAGTC.
 20417
 20418* EXEC CICS HANDLE CONDITION
 20419*        NOTFND    (8583-AGTC-NOT-FOUND)
 20420*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20421*    END-EXEC.
 20422*    MOVE '"$I''                  ! 9 #00019285' TO DFHEIV0
 20423     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20425     MOVE X'3920233030303139323835' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0
 20427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20428
 20429
 20430
 20431* EXEC CICS STARTBR
 20432*        DATASET    (AGTC-ID)
 20433*        RIDFLD     (ERAGTC-KEY)
 20434*        GTEQ
 20435*    END-EXEC.
 20436     MOVE 0
 20437       TO DFHEIV11
 20438*    MOVE '&,         G          &   #00019290' TO DFHEIV0
 20439     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20441     MOVE X'2020233030303139323930' TO DFHEIV0(25:11)
 20442     CALL 'kxdfhei1' USING DFHEIV0,
 20443           AGTC-ID,
 20444           ERAGTC-KEY,
 20445           DFHEIV99,
 20446           DFHEIV11,
 20447           DFHEIV99
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451 8583-READ-ERAGTC-NEXT.
 20452
 20453* EXEC CICS READNEXT
 20454*        DATASET     (AGTC-ID)
 20455*        INTO        (AGENT-COMMISSIONS)
 20456*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 379
* EL050.cbl
 20457*    END-EXEC.
 20458     MOVE LENGTH OF
 20459      AGENT-COMMISSIONS
 20460       TO DFHEIV12
 20461     MOVE 0
 20462       TO DFHEIV11
 20463*    MOVE '&.IL                  )   #00019297' TO DFHEIV0
 20464     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20466     MOVE X'2020233030303139323937' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0,
 20468           AGTC-ID,
 20469           AGENT-COMMISSIONS,
 20470           DFHEIV12,
 20471           ERAGTC-KEY,
 20472           DFHEIV99,
 20473           DFHEIV11,
 20474           DFHEIV99,
 20475           DFHEIV99
 20476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20477
 20478
 20479*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20480
 20481     GO TO 8583-EXIT
 20482     .
 20483 8583-AGTC-NOT-FOUND.
 20484
 20485     MOVE 'N'                    TO AGTC-MASTER-SW.
 20486
 20487 8583-EXIT.
 20488     EXIT.
 20489
 20490 8584-READ-BANK-CROSS-REF.
 20491
 20492* EXEC CICS HANDLE CONDITION
 20493*        NOTFND    (8584-BXRF-NOT-FOUND)
 20494*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20495*    END-EXEC.
 20496*    MOVE '"$I''                  ! : #00019315' TO DFHEIV0
 20497     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20499     MOVE X'3A20233030303139333135' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0
 20501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20502
 20503
 20504
 20505* EXEC CICS READ
 20506*        DATASET     (BXRF-ID)
 20507*        INTO        (BANK-CROSS-REFERENCE)
 20508*        RIDFLD      (ERBXRF-KEY)
 20509*        LENGTH      (BXRF-REC-LENGTH)
 20510*    END-EXEC.
 20511*    MOVE '&"IL       E          (   #00019320' TO DFHEIV0
 20512     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20514     MOVE X'2020233030303139333230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 380
* EL050.cbl
 20515     CALL 'kxdfhei1' USING DFHEIV0,
 20516           BXRF-ID,
 20517           BANK-CROSS-REFERENCE,
 20518           BXRF-REC-LENGTH,
 20519           ERBXRF-KEY,
 20520           DFHEIV99,
 20521           DFHEIV99,
 20522           DFHEIV99
 20523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20524
 20525
 20526     MOVE 'Y'                    TO BXRF-MASTER-SW
 20527
 20528     GO TO 8584-EXIT
 20529     .
 20530 8584-BXRF-NOT-FOUND.
 20531
 20532     MOVE 'N'                    TO BXRF-MASTER-SW.
 20533
 20534 8584-EXIT.
 20535     EXIT.
 20536
 20537 8585-READ-PLAN-MASTER.
 20538
 20539
 20540* EXEC CICS HANDLE CONDITION
 20541*        NOTFND    (8585-PLAN-NOT-FOUND)
 20542*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20543*    END-EXEC.
 20544*    MOVE '"$I''                  ! ; #00019340' TO DFHEIV0
 20545     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20547     MOVE X'3B20233030303139333430' TO DFHEIV0(25:11)
 20548     CALL 'kxdfhei1' USING DFHEIV0
 20549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20550
 20551
 20552
 20553* EXEC CICS READ
 20554*        DATASET     (PLAN-ID)
 20555*        INTO        (PLAN-MASTER)
 20556*        RIDFLD      (ERPLAN-KEY)
 20557*    END-EXEC.
 20558     MOVE LENGTH OF
 20559      PLAN-MASTER
 20560       TO DFHEIV11
 20561*    MOVE '&"IL       E          (   #00019345' TO DFHEIV0
 20562     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20564     MOVE X'2020233030303139333435' TO DFHEIV0(25:11)
 20565     CALL 'kxdfhei1' USING DFHEIV0,
 20566           PLAN-ID,
 20567           PLAN-MASTER,
 20568           DFHEIV11,
 20569           ERPLAN-KEY,
 20570           DFHEIV99,
 20571           DFHEIV99,
 20572           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 381
* EL050.cbl
 20573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20574
 20575
 20576     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20577
 20578     GO TO 8585-EXIT.
 20579
 20580 8585-PLAN-NOT-FOUND.
 20581
 20582     MOVE 'N'                    TO PLAN-MASTER-SW.
 20583
 20584 8585-EXIT.
 20585     EXIT.
 20586
 20587 8586-READ-LOAN-OFFICER.
 20588
 20589* EXEC CICS READ
 20590*        DATASET     (LOFC-ID)
 20591*        INTO        (LOAN-OFFICER-MASTER)
 20592*        RIDFLD      (ERLOFC-KEY)
 20593*        RESP        (WS-RESPONSE)
 20594*    END-EXEC
 20595     MOVE LENGTH OF
 20596      LOAN-OFFICER-MASTER
 20597       TO DFHEIV11
 20598*    MOVE '&"IL       E          (  N#00019363' TO DFHEIV0
 20599     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20601     MOVE X'204E233030303139333633' TO DFHEIV0(25:11)
 20602     CALL 'kxdfhei1' USING DFHEIV0,
 20603           LOFC-ID,
 20604           LOAN-OFFICER-MASTER,
 20605           DFHEIV11,
 20606           ERLOFC-KEY,
 20607           DFHEIV99,
 20608           DFHEIV99,
 20609           DFHEIV99
 20610     MOVE EIBRESP  TO WS-RESPONSE
 20611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20612
 20613     IF WS-RESP-NORMAL
 20614        MOVE 'Y'                 TO LOFC-MASTER-SW
 20615     ELSE
 20616        MOVE 'N'                 TO LOFC-MASTER-SW
 20617     END-IF
 20618     .
 20619 8586-EXIT.
 20620     EXIT.
 20621 8587-START-ERPDEF.
 20622
 20623* EXEC CICS STARTBR
 20624*       DATASET   (PDEF-ID)
 20625*       RIDFLD    (ERPDEF-KEY)
 20626*       GTEQ
 20627*       RESP      (WS-RESPONSE)
 20628*    END-EXEC
 20629     MOVE 0
 20630       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 382
* EL050.cbl
 20631*    MOVE '&,         G          &  N#00019379' TO DFHEIV0
 20632     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20634     MOVE X'204E233030303139333739' TO DFHEIV0(25:11)
 20635     CALL 'kxdfhei1' USING DFHEIV0,
 20636           PDEF-ID,
 20637           ERPDEF-KEY,
 20638           DFHEIV99,
 20639           DFHEIV11,
 20640           DFHEIV99
 20641     MOVE EIBRESP  TO WS-RESPONSE
 20642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20643     IF WS-RESP-NORMAL
 20644        MOVE 'Y'                 TO PDEF-MASTER-SW
 20645     ELSE
 20646        MOVE 'N'                 TO PDEF-MASTER-SW
 20647     END-IF
 20648     .
 20649 8587-EXIT.
 20650     EXIT.
 20651 8588-READ-ERPDEF.
 20652
 20653* EXEC CICS READNEXT
 20654*       DATASET   (PDEF-ID)
 20655*       RIDFLD    (ERPDEF-KEY)
 20656*       INTO      (PRODUCT-MASTER)
 20657*       RESP      (WS-RESPONSE)
 20658*    END-EXEC
 20659     MOVE LENGTH OF
 20660      PRODUCT-MASTER
 20661       TO DFHEIV12
 20662     MOVE 0
 20663       TO DFHEIV11
 20664*    MOVE '&.IL                  )  N#00019394' TO DFHEIV0
 20665     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20667     MOVE X'204E233030303139333934' TO DFHEIV0(25:11)
 20668     CALL 'kxdfhei1' USING DFHEIV0,
 20669           PDEF-ID,
 20670           PRODUCT-MASTER,
 20671           DFHEIV12,
 20672           ERPDEF-KEY,
 20673           DFHEIV99,
 20674           DFHEIV11,
 20675           DFHEIV99,
 20676           DFHEIV99
 20677     MOVE EIBRESP  TO WS-RESPONSE
 20678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20679     IF WS-RESP-NORMAL
 20680        MOVE 'Y'                 TO PDEF-MASTER-SW
 20681     ELSE
 20682        MOVE 'N'                 TO PDEF-MASTER-SW
 20683     END-IF
 20684     .
 20685 8588-EXIT.
 20686     EXIT.
 20687 8589-ENDBR-ERPDEF.
 20688
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 383
* EL050.cbl
 20689* EXEC CICS ENDBR
 20690*       DATASET   (PDEF-ID)
 20691*    END-EXEC
 20692     MOVE 0
 20693       TO DFHEIV11
 20694*    MOVE '&2                    $   #00019409' TO DFHEIV0
 20695     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20696     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20697     MOVE X'2020233030303139343039' TO DFHEIV0(25:11)
 20698     CALL 'kxdfhei1' USING DFHEIV0,
 20699           PDEF-ID,
 20700           DFHEIV11,
 20701           DFHEIV99
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20703     .
 20704 8589-EXIT.
 20705     EXIT.
 20706 8590-READ-CERT-MASTER.
 20707     IF PB-COMPANY-ID = 'UCL'
 20708         GO TO 8690-READ-CERT-MASTER-UCL.
 20709
 20710
 20711* EXEC CICS HANDLE CONDITION
 20712*         NOTFND    (0299-CERT-NOT-FOUND)
 20713*    END-EXEC.
 20714*    MOVE '"$I                   ! < #00019419' TO DFHEIV0
 20715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20717     MOVE X'3C20233030303139343139' TO DFHEIV0(25:11)
 20718     CALL 'kxdfhei1' USING DFHEIV0
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722
 20723* EXEC CICS READ
 20724*        DATASET     (CERT-ID)
 20725*        INTO        (CERTIFICATE-MASTER)
 20726*        RIDFLD      (ELCERT-KEY)
 20727*        UPDATE
 20728*    END-EXEC.
 20729     MOVE LENGTH OF
 20730      CERTIFICATE-MASTER
 20731       TO DFHEIV11
 20732*    MOVE '&"IL       EU         (   #00019423' TO DFHEIV0
 20733     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20734     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20735     MOVE X'2020233030303139343233' TO DFHEIV0(25:11)
 20736     CALL 'kxdfhei1' USING DFHEIV0,
 20737           CERT-ID,
 20738           CERTIFICATE-MASTER,
 20739           DFHEIV11,
 20740           ELCERT-KEY,
 20741           DFHEIV99,
 20742           DFHEIV99,
 20743           DFHEIV99
 20744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20745
 20746
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 384
* EL050.cbl
 20747 8590-EXIT.
 20748     EXIT.
 20749
 20750 8690-READ-CERT-MASTER-UCL.
 20751
 20752* EXEC CICS HANDLE CONDITION
 20753*         NOTFND    (8700-READ-CERT-MASTER)
 20754*    END-EXEC.
 20755*    MOVE '"$I                   ! = #00019434' TO DFHEIV0
 20756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20758     MOVE X'3D20233030303139343334' TO DFHEIV0(25:11)
 20759     CALL 'kxdfhei1' USING DFHEIV0
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763 8690-READ-CERT-CONT.
 20764
 20765* EXEC CICS READ
 20766*        DATASET     (CERT-ID)
 20767*        INTO        (CERTIFICATE-MASTER)
 20768*        RIDFLD      (ELCERT-KEY)
 20769*        UPDATE
 20770*    END-EXEC.
 20771     MOVE LENGTH OF
 20772      CERTIFICATE-MASTER
 20773       TO DFHEIV11
 20774*    MOVE '&"IL       EU         (   #00019439' TO DFHEIV0
 20775     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20776     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20777     MOVE X'2020233030303139343339' TO DFHEIV0(25:11)
 20778     CALL 'kxdfhei1' USING DFHEIV0,
 20779           CERT-ID,
 20780           CERTIFICATE-MASTER,
 20781           DFHEIV11,
 20782           ELCERT-KEY,
 20783           DFHEIV99,
 20784           DFHEIV99,
 20785           DFHEIV99
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20787
 20788
 20789     GO TO 8590-EXIT.
 20790
 20791 8700-READ-CERT-MASTER.
 20792     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20793     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20794
 20795* EXEC CICS HANDLE CONDITION
 20796*         DUPKEY    (8720-COMP-ACCOUNTS)
 20797*         ENDFILE   (8730-END-BROWSE)
 20798*         NOTFND    (8740-NOT-FOUND)
 20799*    END-EXEC.
 20800*    MOVE '"$$''I                 ! > #00019451' TO DFHEIV0
 20801     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20803     MOVE X'3E20233030303139343531' TO DFHEIV0(25:11)
 20804     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 385
* EL050.cbl
 20805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20806
 20807
 20808
 20809* EXEC CICS STARTBR
 20810*        DATASET     ('ELCERT5')
 20811*        RIDFLD      (ELCERT2-KEY)
 20812*        EQUAL
 20813*    END-EXEC.
 20814     MOVE 'ELCERT5' TO DFHEIV1
 20815     MOVE 0
 20816       TO DFHEIV11
 20817*    MOVE '&,         E          &   #00019457' TO DFHEIV0
 20818     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20820     MOVE X'2020233030303139343537' TO DFHEIV0(25:11)
 20821     CALL 'kxdfhei1' USING DFHEIV0,
 20822           DFHEIV1,
 20823           ELCERT2-KEY,
 20824           DFHEIV99,
 20825           DFHEIV11,
 20826           DFHEIV99
 20827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20828
 20829
 20830 8710-READ-NEXT.
 20831
 20832* EXEC CICS READNEXT
 20833*        DATASET     ('ELCERT5')
 20834*        INTO        (CERTIFICATE-MASTER)
 20835*        RIDFLD      (ELCERT2-KEY)
 20836*    END-EXEC.
 20837     MOVE LENGTH OF
 20838      CERTIFICATE-MASTER
 20839       TO DFHEIV12
 20840     MOVE 'ELCERT5' TO DFHEIV1
 20841     MOVE 0
 20842       TO DFHEIV11
 20843*    MOVE '&.IL                  )   #00019464' TO DFHEIV0
 20844     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20846     MOVE X'2020233030303139343634' TO DFHEIV0(25:11)
 20847     CALL 'kxdfhei1' USING DFHEIV0,
 20848           DFHEIV1,
 20849           CERTIFICATE-MASTER,
 20850           DFHEIV12,
 20851           ELCERT2-KEY,
 20852           DFHEIV99,
 20853           DFHEIV11,
 20854           DFHEIV99,
 20855           DFHEIV99
 20856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20857
 20858
 20859 8720-COMP-ACCOUNTS.
 20860
 20861* EXEC CICS ENTER
 20862*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 386
* EL050.cbl
 20863*         FROM (PB-C-LAST-NAME)
 20864*    END-EXEC.
 20865     MOVE 001
 20866       TO DFHEIV11
 20867*    MOVE ':$F                   %   #00019471' TO DFHEIV0
 20868     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20869     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20870     MOVE X'2020233030303139343731' TO DFHEIV0(25:11)
 20871     CALL 'kxdfhei1' USING DFHEIV0,
 20872           DFHEIV11,
 20873           PB-C-LAST-NAME,
 20874           DFHEIV99,
 20875           DFHEIV99
 20876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20877
 20878
 20879
 20880* EXEC CICS ENTER
 20881*         TRACEID (002)
 20882*         FROM (CM-INSURED-LAST-NAME)
 20883*    END-EXEC.
 20884     MOVE 002
 20885       TO DFHEIV11
 20886*    MOVE ':$F                   %   #00019476' TO DFHEIV0
 20887     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20889     MOVE X'2020233030303139343736' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0,
 20891           DFHEIV11,
 20892           CM-INSURED-LAST-NAME,
 20893           DFHEIV99,
 20894           DFHEIV99
 20895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20896
 20897
 20898     IF PB-CERT-NO NOT = CM-CERT-NO
 20899         GO TO 8730-END-BROWSE.
 20900
 20901     IF PB-ACCOUNT = CM-ACCOUNT
 20902         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20903             MOVE ER-2799        TO WS-ERROR
 20904             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20905             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20906             GO TO 8730-END-BROWSE.
 20907
 20908     GO TO 8710-READ-NEXT.
 20909
 20910 8730-END-BROWSE.
 20911
 20912* EXEC CICS ENDBR
 20913*         DATASET    ('ELCERT5')
 20914*    END-EXEC.
 20915     MOVE 'ELCERT5' TO DFHEIV1
 20916     MOVE 0
 20917       TO DFHEIV11
 20918*    MOVE '&2                    $   #00019494' TO DFHEIV0
 20919     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 387
* EL050.cbl
 20921     MOVE X'2020233030303139343934' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0,
 20923           DFHEIV1,
 20924           DFHEIV11,
 20925           DFHEIV99
 20926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20927
 20928
 20929 8740-NOT-FOUND.
 20930     GO TO 0299-CERT-NOT-FOUND.
 20931
 20932 8750-START-ELSTAT.
 20933
 20934* EXEC CICS STARTBR
 20935*       DATASET   (STAT-ID)
 20936*       RIDFLD    (ELSTAT-KEY)
 20937*       GTEQ
 20938*       RESP      (WS-RESPONSE)
 20939*    END-EXEC
 20940     MOVE 0
 20941       TO DFHEIV11
 20942*    MOVE '&,         G          &  N#00019502' TO DFHEIV0
 20943     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20944     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20945     MOVE X'204E233030303139353032' TO DFHEIV0(25:11)
 20946     CALL 'kxdfhei1' USING DFHEIV0,
 20947           STAT-ID,
 20948           ELSTAT-KEY,
 20949           DFHEIV99,
 20950           DFHEIV11,
 20951           DFHEIV99
 20952     MOVE EIBRESP  TO WS-RESPONSE
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20954     IF WS-RESP-NORMAL
 20955        MOVE 'Y'                 TO STAT-MASTER-SW
 20956     ELSE
 20957        MOVE 'N'                 TO STAT-MASTER-SW
 20958     END-IF
 20959     .
 20960 8750-EXIT.
 20961     EXIT.
 20962 8752-READ-ELSTAT.
 20963
 20964* EXEC CICS READNEXT
 20965*       DATASET   (STAT-ID)
 20966*       RIDFLD    (ELSTAT-KEY)
 20967*       INTO      (STATE-FILE)
 20968*       RESP      (WS-RESPONSE)
 20969*    END-EXEC
 20970     MOVE LENGTH OF
 20971      STATE-FILE
 20972       TO DFHEIV12
 20973     MOVE 0
 20974       TO DFHEIV11
 20975*    MOVE '&.IL                  )  N#00019517' TO DFHEIV0
 20976     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20977     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20978     MOVE X'204E233030303139353137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 388
* EL050.cbl
 20979     CALL 'kxdfhei1' USING DFHEIV0,
 20980           STAT-ID,
 20981           STATE-FILE,
 20982           DFHEIV12,
 20983           ELSTAT-KEY,
 20984           DFHEIV99,
 20985           DFHEIV11,
 20986           DFHEIV99,
 20987           DFHEIV99
 20988     MOVE EIBRESP  TO WS-RESPONSE
 20989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20990     IF WS-RESP-NORMAL
 20991        MOVE 'Y'                 TO STAT-MASTER-SW
 20992     ELSE
 20993        MOVE 'N'                 TO STAT-MASTER-SW
 20994     END-IF
 20995     .
 20996 8752-EXIT.
 20997     EXIT.
 20998 8800-GET-COMP-RATE.
 20999     MOVE +1 TO IB.
 21000     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21001         ADD +9 TO IB
 21002         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21003             ADD +9 TO IB
 21004             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21005                MOVE ZEROS       TO WS-WK-RATE
 21006                GO TO 8800-EXIT.
 21007
 21008     IF PB-I-AGE GREATER CT-AGE (1)
 21009         ADD +3 TO IB
 21010         IF PB-I-AGE GREATER CT-AGE (2)
 21011             ADD +3 TO IB
 21012             IF PB-I-AGE GREATER CT-AGE (3)
 21013                MOVE ZEROS       TO WS-WK-RATE
 21014                GO TO 8800-EXIT.
 21015
 21016     IF WS-WORK-TERM GREATER CT-TRM (1)
 21017         ADD +1 TO IB
 21018         IF WS-WORK-TERM GREATER CT-TRM (2)
 21019             ADD +1 TO IB
 21020             IF WS-WORK-TERM GREATER CT-TRM (3)
 21021                MOVE ZEROS       TO WS-WK-RATE
 21022                GO TO 8800-EXIT.
 21023
 21024     IF CT-RT (IB) NOT NUMERIC
 21025         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21026         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21027         GO TO 8800-GET-COMP-RATE.
 21028
 21029     MOVE CT-RT (IB) TO WS-WK-RATE.
 21030
 21031 8800-EXIT.
 21032     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 389
* EL050.cbl
 21034 8900-ADDRESS-FILE.
 21035     IF ERACCT-FILE-ADDRESSED
 21036         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21037         GO TO 8900-ADDRESS-EXIT.
 21038
 21039     IF ELCNTL-FILE-ADDRESSED
 21040         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21041         GO TO 8900-ADDRESS-EXIT.
 21042
 21043     IF ERPLAN-FILE-ADDRESSED
 21044         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21045         GO TO 8900-ADDRESS-EXIT.
 21046
 21047     IF ERFORM-FILE-ADDRESSED
 21048         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21049         GO TO 8900-ADDRESS-EXIT.
 21050
 21051 8900-ADDRESS-EXIT.
 21052     EXIT.
 21053
 21054 9000-READ-CONTROL.
 21055
 21056* EXEC CICS HANDLE CONDITION
 21057*        NOTFND    (9000-NOTFND)
 21058*    END-EXEC.
 21059*    MOVE '"$I                   ! ? #00019588' TO DFHEIV0
 21060     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21062     MOVE X'3F20233030303139353838' TO DFHEIV0(25:11)
 21063     CALL 'kxdfhei1' USING DFHEIV0
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067
 21068* EXEC CICS READ
 21069*        DATASET     (CNTL-ID)
 21070*        SET         (ADDRESS OF CONTROL-FILE)
 21071*        RIDFLD      (ELCNTL-KEY)
 21072*        GTEQ
 21073*    END-EXEC.
 21074*    MOVE '&"S        G          (   #00019592' TO DFHEIV0
 21075     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21077     MOVE X'2020233030303139353932' TO DFHEIV0(25:11)
 21078     CALL 'kxdfhei1' USING DFHEIV0,
 21079           CNTL-ID,
 21080           DFHEIV20,
 21081           DFHEIV99,
 21082           ELCNTL-KEY,
 21083           DFHEIV99,
 21084           DFHEIV99,
 21085           DFHEIV99
 21086     SET ADDRESS OF CONTROL-FILE TO
 21087         DFHEIV20
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21089
 21090
 21091     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 390
* EL050.cbl
 21092
 21093 9000-NOTFND.
 21094     IF RC-SW-1 = '1'
 21095        MOVE ER-2616              TO WS-ERROR
 21096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21097        GO TO 9000-EXIT.
 21098
 21099     IF RC-SW-1 = '2'
 21100        MOVE ER-2602              TO WS-ERROR
 21101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21102
 21103 9000-EXIT.
 21104      EXIT.
 21105
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 391
* EL050.cbl
 21107 9100-READ-CONTROL.
 21108
 21109* EXEC CICS HANDLE CONDITION
 21110*        NOTFND  (9100-NOTFND)
 21111*        ENDFILE (9100-NOTFND)
 21112*    END-EXEC.
 21113*    MOVE '"$I''                  ! @ #00019616' TO DFHEIV0
 21114     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21116     MOVE X'4020233030303139363136' TO DFHEIV0(25:11)
 21117     CALL 'kxdfhei1' USING DFHEIV0
 21118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21119
 21120
 21121
 21122* EXEC CICS READ
 21123*        DATASET     (CNTL-ID)
 21124*        INTO        (CONTROL-FILE)
 21125*        RIDFLD      (ELCNTL-KEY)
 21126*        GTEQ
 21127*    END-EXEC.
 21128     MOVE LENGTH OF
 21129      CONTROL-FILE
 21130       TO DFHEIV11
 21131*    MOVE '&"IL       G          (   #00019621' TO DFHEIV0
 21132     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21134     MOVE X'2020233030303139363231' TO DFHEIV0(25:11)
 21135     CALL 'kxdfhei1' USING DFHEIV0,
 21136           CNTL-ID,
 21137           CONTROL-FILE,
 21138           DFHEIV11,
 21139           ELCNTL-KEY,
 21140           DFHEIV99,
 21141           DFHEIV99,
 21142           DFHEIV99
 21143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21144
 21145
 21146     GO TO 9100-EXIT.
 21147
 21148 9100-NOTFND.
 21149     IF RC-SW-2 = '0'
 21150        MOVE '1'                  TO STATE-RECORD-ERROR
 21151        GO TO 9100-EXIT
 21152     END-IF
 21153     IF RC-SW-2 = '1'
 21154        MOVE '1'                  TO LF-BENEFIT-ERROR
 21155        MOVE ER-2604              TO WS-ERROR
 21156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21157        GO TO 9100-EXIT.
 21158
 21159     IF RC-SW-2 = '2'
 21160        MOVE '1'                  TO AH-BENEFIT-ERROR
 21161        MOVE ER-2605              TO WS-ERROR
 21162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21163        GO TO 9100-EXIT.
 21164
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 392
* EL050.cbl
 21165     IF RC-SW-2 = '3'
 21166         MOVE ER-2603           TO WS-ERROR
 21167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21168         GO TO 9100-EXIT.
 21169
 21170     IF RC-SW-2 = '4'
 21171         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21172         GO TO 9100-EXIT.
 21173
 21174     IF RC-SW-2 = '5'
 21175         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21176         IF WS-AH-INPUT-CD-1 = SPACE
 21177             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21178         ELSE
 21179             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21180
 21181 9100-EXIT.
 21182      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 393
* EL050.cbl
 21184 9200-CONTROL-GETMAIN.
 21185
 21186* EXEC CICS GETMAIN
 21187*         LENGTH   (750)
 21188*         SET      (ADDRESS OF CONTROL-FILE)
 21189*    END-EXEC.
 21190     MOVE 750
 21191       TO DFHEIV11
 21192*    MOVE '," L                  $   #00019667' TO DFHEIV0
 21193     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21195     MOVE X'2020233030303139363637' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0,
 21197           DFHEIV20,
 21198           DFHEIV11,
 21199           DFHEIV99
 21200     SET ADDRESS OF CONTROL-FILE TO
 21201         DFHEIV20
 21202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21203
 21204
 21205     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21206
 21207 9200-EXIT.
 21208     EXIT.
 21209
 21210 9250-UNLOCK-RETURN.
 21211
 21212* EXEC CICS UNLOCK
 21213*        DATASET   (CERT-ID)
 21214*    END-EXEC.
 21215*    MOVE '&*                    #   #00019678' TO DFHEIV0
 21216     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21217     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21218     MOVE X'2020233030303139363738' TO DFHEIV0(25:11)
 21219     CALL 'kxdfhei1' USING DFHEIV0,
 21220           CERT-ID,
 21221           DFHEIV99
 21222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21223
 21224
 21225 9300-ABEND.
 21226     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21227
 21228
 21229* EXEC CICS LINK
 21230*        PROGRAM   ('EL004')
 21231*        COMMAREA  (WS-ERROR-LINE)
 21232*        LENGTH    (72)
 21233*    END-EXEC.
 21234     MOVE 'EL004' TO DFHEIV1
 21235     MOVE 72
 21236       TO DFHEIV11
 21237*    MOVE '."C                   (   #00019685' TO DFHEIV0
 21238     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21240     MOVE X'2020233030303139363835' TO DFHEIV0(25:11)
 21241     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 394
* EL050.cbl
 21242           DFHEIV1,
 21243           WS-ERROR-LINE,
 21244           DFHEIV11,
 21245           DFHEIV99,
 21246           DFHEIV99,
 21247           DFHEIV99,
 21248           DFHEIV99
 21249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21250
 21251
 21252     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21253
 21254
 21255* EXEC CICS ABEND
 21256*        ABCODE ('EL50')
 21257*    END-EXEC.
 21258     MOVE 'EL50' TO DFHEIV5
 21259*    MOVE '.,A                   "   #00019693' TO DFHEIV0
 21260     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21261     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21262     MOVE X'2020233030303139363933' TO DFHEIV0(25:11)
 21263     CALL 'kxdfhei1' USING DFHEIV0,
 21264           DFHEIV5
 21265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21266
 21267
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 395
* EL050.cbl
 21269
 21270******************************************************************
 21271*                                                                *
 21272*            E R R O R   F O R M A T   R O U T I N E             *
 21273*                                                                *
 21274******************************************************************
 21275
 21276 9900-ERROR-FORMAT.
 21277
 21278     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21279                    PB-COMMON-ERROR (2) OR
 21280                    PB-COMMON-ERROR (3) OR
 21281                    PB-COMMON-ERROR (4) OR
 21282                    PB-COMMON-ERROR (5) OR
 21283                    PB-COMMON-ERROR (6) OR
 21284                    PB-COMMON-ERROR (7) OR
 21285                    PB-COMMON-ERROR (8) OR
 21286                    PB-COMMON-ERROR (9) OR
 21287                    PB-COMMON-ERROR (10)
 21288        GO TO 9900-EXIT.
 21289
 21290     IF PB-NO-OF-ERRORS = +10
 21291        GO TO 9900-EXIT.
 21292
 21293     ADD +1  TO PB-NO-OF-ERRORS.
 21294     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21295                                       (PB-NO-OF-ERRORS).
 21296 9900-EXIT.
 21297     EXIT.
 21298
 21299 9990-RETURN.
 21300     IF BROWSE-STARTED
 21301
 21302* EXEC CICS ENDBR
 21303*            DATASET  (ACCT-ID)
 21304*       END-EXEC.
 21305     MOVE 0
 21306       TO DFHEIV11
 21307*    MOVE '&2                    $   #00019730' TO DFHEIV0
 21308     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21309     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21310     MOVE X'2020233030303139373330' TO DFHEIV0(25:11)
 21311     CALL 'kxdfhei1' USING DFHEIV0,
 21312           ACCT-ID,
 21313           DFHEIV11,
 21314           DFHEIV99
 21315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21316
 21317
 21318 9990-EXIT.
 21319     EXIT.
 21320
 21321
 21322****Check for CRTO record, add one if not found.
 21323 9991-CHECK-FOR-ELCRTO.
 21324
 21325* EXEC CICS HANDLE CONDITION
 21326*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 396
* EL050.cbl
 21327*         ENDFILE (9991-CRTO-NOT-FOUND)
 21328*     END-EXEC.
 21329*    MOVE '"$I''                  ! A #00019740' TO DFHEIV0
 21330     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21332     MOVE X'4120233030303139373430' TO DFHEIV0(25:11)
 21333     CALL 'kxdfhei1' USING DFHEIV0
 21334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21335
 21336     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21337     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21338     MOVE +0                     TO ELCRTO-SEQ-NO
 21339
 21340
 21341* EXEC CICS READ
 21342*       DATASET   ('ELCRTO')
 21343*       INTO      (ORIGINAL-CERTIFICATE)
 21344*       RIDFLD    (ELCRTO-KEY)
 21345*       GTEQ
 21346*       RESP      (WS-RESPONSE)
 21347*    END-EXEC
 21348     MOVE LENGTH OF
 21349      ORIGINAL-CERTIFICATE
 21350       TO DFHEIV11
 21351     MOVE 'ELCRTO' TO DFHEIV1
 21352*    MOVE '&"IL       G          (  N#00019748' TO DFHEIV0
 21353     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21355     MOVE X'204E233030303139373438' TO DFHEIV0(25:11)
 21356     CALL 'kxdfhei1' USING DFHEIV0,
 21357           DFHEIV1,
 21358           ORIGINAL-CERTIFICATE,
 21359           DFHEIV11,
 21360           ELCRTO-KEY,
 21361           DFHEIV99,
 21362           DFHEIV99,
 21363           DFHEIV99
 21364     MOVE EIBRESP  TO WS-RESPONSE
 21365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21366
 21367     IF WS-RESP-NORMAL
 21368        AND (OC-CONTROL-PRIMARY (1:33) =
 21369                 PB-CONTROL-BY-ACCOUNT (1:33))
 21370        AND (OC-RECORD-TYPE =  'I')
 21371           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21372               GO TO 9991-CHECK-INDICATORS
 21373           ELSE
 21374               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21375               GO TO 9991-CRTO-ADD-REC
 21376           END-IF
 21377     END-IF.
 21378
 21379 9991-CRTO-NOT-FOUND.
 21380
 21381     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21382     MOVE 'OC'                TO OC-RECORD-ID
 21383     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21384                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 397
* EL050.cbl
 21385     MOVE +4096               TO OC-KEY-SEQ-NO.
 21386
 21387 9991-CRTO-ADD-REC.
 21388
 21389     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21390     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21391     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21392     MOVE 'I'                 TO OC-RECORD-TYPE
 21393     IF PB-ISSUE
 21394         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21395         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21396         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21397         MOVE PB-I-AGE               TO OC-INS-AGE
 21398         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21399         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21400         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21401         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21402         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21403         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21404         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21405         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21406         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21407         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21408         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21409         IF PB-I-JOINT-COMMISSION > +0
 21410             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21411         ELSE
 21412             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21413         END-IF
 21414         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21415         MOVE +0                     TO OC-LF-CANCEL-AMT
 21416                                        OC-LF-ITD-CANCEL-AMT
 21417         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21418         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21419         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21420         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21421         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21422         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21423         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21424         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21425         MOVE +0                     TO OC-AH-CANCEL-AMT
 21426                                        OC-AH-ITD-CANCEL-AMT
 21427         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21428         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21429         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21430     ELSE
 21431         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21432         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21433         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21434         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21435         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21436         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21437         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21438         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21439         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21440          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21441             MOVE SPACES             TO OC-LF-BENCD
 21442             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 398
* EL050.cbl
 21443                                        OC-LF-BEN-AMT
 21444                                        OC-LF-PRM-AMT
 21445                                        OC-LF-ALT-BEN-AMT
 21446                                        OC-LF-ALT-PRM-AMT
 21447                                        OC-LF-COMM-PCT
 21448                                        OC-LF-CANCEL-AMT
 21449             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21450             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21451         ELSE
 21452             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21453             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21454             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21455             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21456             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21457             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21458             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21459             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21460             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21461             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21462         END-IF
 21463         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21464         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21465          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21466             MOVE SPACES             TO OC-AH-BENCD
 21467             MOVE ZEROS              TO OC-AH-TERM
 21468                                        OC-AH-BEN-AMT
 21469                                        OC-AH-PRM-AMT
 21470                                        OC-AH-COMM-PCT
 21471                                        OC-AH-CANCEL-AMT
 21472                                        OC-AH-CP
 21473             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21474             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21475         ELSE
 21476             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21477             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21478             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21479             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21480             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21481             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21482             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21483             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21484             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21485         END-IF
 21486         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21487         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21488         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21489         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21490     END-IF
 21491     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21492
 21493     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21494
 21495
 21496* EXEC CICS READ
 21497*         DATASET   (FILE-ERMAIL)
 21498*         RIDFLD    (MA-CONTROL-PRIMARY)
 21499*         INTO      (MAILING-DATA)
 21500*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 399
* EL050.cbl
 21501*    END-EXEC
 21502     MOVE LENGTH OF
 21503      MAILING-DATA
 21504       TO DFHEIV11
 21505*    MOVE '&"IL       E          (  N#00019884' TO DFHEIV0
 21506     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21508     MOVE X'204E233030303139383834' TO DFHEIV0(25:11)
 21509     CALL 'kxdfhei1' USING DFHEIV0,
 21510           FILE-ERMAIL,
 21511           MAILING-DATA,
 21512           DFHEIV11,
 21513           MA-CONTROL-PRIMARY,
 21514           DFHEIV99,
 21515           DFHEIV99,
 21516           DFHEIV99
 21517     MOVE EIBRESP  TO WS-RESPONSE
 21518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21519
 21520     IF WS-RESP-NORMAL
 21521         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21522     END-IF.
 21523
 21524     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21525     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21526
 21527
 21528* EXEC CICS READ
 21529*         DATASET  (CRTT-ID)
 21530*         RIDFLD   (WS-ELCRTT-KEY)
 21531*         INTO     (CERTIFICATE-TRAILERS)
 21532*         RESP     (WS-RESPONSE)
 21533*    END-EXEC
 21534     MOVE LENGTH OF
 21535      CERTIFICATE-TRAILERS
 21536       TO DFHEIV11
 21537*    MOVE '&"IL       E          (  N#00019898' TO DFHEIV0
 21538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21540     MOVE X'204E233030303139383938' TO DFHEIV0(25:11)
 21541     CALL 'kxdfhei1' USING DFHEIV0,
 21542           CRTT-ID,
 21543           CERTIFICATE-TRAILERS,
 21544           DFHEIV11,
 21545           WS-ELCRTT-KEY,
 21546           DFHEIV99,
 21547           DFHEIV99,
 21548           DFHEIV99
 21549     MOVE EIBRESP  TO WS-RESPONSE
 21550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21551
 21552     IF WS-RESP-NORMAL
 21553         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21554         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21555     END-IF.
 21556
 21557
 21558* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 400
* EL050.cbl
 21559*       DATASET   ('ELCRTO')
 21560*       FROM      (ORIGINAL-CERTIFICATE)
 21561*       RIDFLD    (OC-CONTROL-PRIMARY)
 21562*       RESP      (WS-RESPONSE)
 21563*    END-EXEC.
 21564     MOVE LENGTH OF
 21565      ORIGINAL-CERTIFICATE
 21566       TO DFHEIV11
 21567     MOVE 'ELCRTO' TO DFHEIV1
 21568*    MOVE '&$ L                  ''  N#00019910' TO DFHEIV0
 21569     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21571     MOVE X'204E233030303139393130' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0,
 21573           DFHEIV1,
 21574           ORIGINAL-CERTIFICATE,
 21575           DFHEIV11,
 21576           OC-CONTROL-PRIMARY,
 21577           DFHEIV99,
 21578           DFHEIV99
 21579     MOVE EIBRESP  TO WS-RESPONSE
 21580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21581
 21582
 21583     GO TO 9991-EXIT.
 21584
 21585 9991-CHECK-INDICATORS.
 21586
 21587     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21588         GO TO 9991-EXIT
 21589     END-IF.
 21590
 21591     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21592         GO TO 9991-EXIT
 21593     END-IF.
 21594
 21595
 21596* EXEC CICS READ
 21597*       DATASET   ('ELCRTO')
 21598*       INTO      (ORIGINAL-CERTIFICATE)
 21599*       RIDFLD    (OC-CONTROL-PRIMARY)
 21600*       UPDATE
 21601*       RESP      (WS-RESPONSE)
 21602*    END-EXEC
 21603     MOVE LENGTH OF
 21604      ORIGINAL-CERTIFICATE
 21605       TO DFHEIV11
 21606     MOVE 'ELCRTO' TO DFHEIV1
 21607*    MOVE '&"IL       EU         (  N#00019929' TO DFHEIV0
 21608     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21610     MOVE X'204E233030303139393239' TO DFHEIV0(25:11)
 21611     CALL 'kxdfhei1' USING DFHEIV0,
 21612           DFHEIV1,
 21613           ORIGINAL-CERTIFICATE,
 21614           DFHEIV11,
 21615           OC-CONTROL-PRIMARY,
 21616           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 401
* EL050.cbl
 21617           DFHEIV99,
 21618           DFHEIV99
 21619     MOVE EIBRESP  TO WS-RESPONSE
 21620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21621     IF WS-RESP-NORMAL
 21622        IF PB-ISSUE
 21623          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21624          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21625          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21626          MOVE PB-I-AGE               TO OC-INS-AGE
 21627          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21628          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21629          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21630          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21631          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21632          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21633          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21634          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21635          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21636          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21637          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21638          IF PB-I-JOINT-COMMISSION > +0
 21639              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21640          ELSE
 21641              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21642          END-IF
 21643          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21644          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21645          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21646          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21647          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21648          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21649          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21650          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21651          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21652
 21653          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21654
 21655* EXEC CICS READ
 21656*             DATASET   (FILE-ERMAIL)
 21657*             RIDFLD    (MA-CONTROL-PRIMARY)
 21658*             INTO      (MAILING-DATA)
 21659*             RESP      (WS-RESPONSE)
 21660*         END-EXEC
 21661     MOVE LENGTH OF
 21662      MAILING-DATA
 21663       TO DFHEIV11
 21664*    MOVE '&"IL       E          (  N#00019969' TO DFHEIV0
 21665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21667     MOVE X'204E233030303139393639' TO DFHEIV0(25:11)
 21668     CALL 'kxdfhei1' USING DFHEIV0,
 21669           FILE-ERMAIL,
 21670           MAILING-DATA,
 21671           DFHEIV11,
 21672           MA-CONTROL-PRIMARY,
 21673           DFHEIV99,
 21674           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 402
* EL050.cbl
 21675           DFHEIV99
 21676     MOVE EIBRESP  TO WS-RESPONSE
 21677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21678          IF WS-RESP-NORMAL
 21679             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21680          END-IF
 21681
 21682          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21683          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21684
 21685* EXEC CICS READ
 21686*             DATASET  (CRTT-ID)
 21687*             RIDFLD   (WS-ELCRTT-KEY)
 21688*             INTO     (CERTIFICATE-TRAILERS)
 21689*             RESP     (WS-RESPONSE)
 21690*         END-EXEC
 21691     MOVE LENGTH OF
 21692      CERTIFICATE-TRAILERS
 21693       TO DFHEIV11
 21694*    MOVE '&"IL       E          (  N#00019981' TO DFHEIV0
 21695     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21696     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21697     MOVE X'204E233030303139393831' TO DFHEIV0(25:11)
 21698     CALL 'kxdfhei1' USING DFHEIV0,
 21699           CRTT-ID,
 21700           CERTIFICATE-TRAILERS,
 21701           DFHEIV11,
 21702           WS-ELCRTT-KEY,
 21703           DFHEIV99,
 21704           DFHEIV99,
 21705           DFHEIV99
 21706     MOVE EIBRESP  TO WS-RESPONSE
 21707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21708          IF WS-RESP-NORMAL
 21709             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21710                               OC-INS-AGE-DEFAULT-FLAG
 21711             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21712                               OC-JNT-AGE-DEFAULT-FLAG
 21713          END-IF
 21714
 21715        ELSE
 21716          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21717             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21718             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21719             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21720          END-IF
 21721          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21722             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21723             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21724             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21725          END-IF
 21726          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21727        END-IF
 21728
 21729* EXEC CICS REWRITE
 21730*          DATASET   ('ELCRTO')
 21731*          FROM      (ORIGINAL-CERTIFICATE)
 21732*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 403
* EL050.cbl
 21733*       END-EXEC
 21734     MOVE LENGTH OF
 21735      ORIGINAL-CERTIFICATE
 21736       TO DFHEIV11
 21737     MOVE 'ELCRTO' TO DFHEIV1
 21738*    MOVE '&& L                  %  N#00020007' TO DFHEIV0
 21739     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21740     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21741     MOVE X'204E233030303230303037' TO DFHEIV0(25:11)
 21742     CALL 'kxdfhei1' USING DFHEIV0,
 21743           DFHEIV1,
 21744           ORIGINAL-CERTIFICATE,
 21745           DFHEIV11,
 21746           DFHEIV99
 21747     MOVE EIBRESP  TO WS-RESPONSE
 21748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21749     END-IF.
 21750
 21751 9991-EXIT.
 21752     EXIT.
 21753
 21754
 21755 9999-RETURN.
 21756     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21757
 21758
 21759* EXEC CICS RETURN
 21760*    END-EXEC.
 21761*    MOVE '.(                    ''   #00020021' TO DFHEIV0
 21762     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21763     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21764     MOVE X'2020233030303230303231' TO DFHEIV0(25:11)
 21765     CALL 'kxdfhei1' USING DFHEIV0,
 21766           DFHEIV99,
 21767           DFHEIV99,
 21768           DFHEIV99,
 21769           DFHEIV99,
 21770           DFHEIV99,
 21771           DFHEIV99
 21772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21773
 21774
 21775
 21776* GOBACK.
 21777     MOVE '9%                    "   ' TO DFHEIV0
 21778     MOVE 'EL050' TO DFHEIV1
 21779     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21780     GOBACK.
 21781
 21782 9999-DFHBACK SECTION.
 21783     MOVE '9%                    "   ' TO DFHEIV0
 21784     MOVE 'EL050' TO DFHEIV1
 21785     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21786     GOBACK.
 21787 9999-DFHEXIT.
 21788     IF DFHEIGDJ EQUAL 0001
 21789         NEXT SENTENCE
 21790     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 404
* EL050.cbl
 21791         GO TO 9300-ABEND,
 21792               3990-FILES-NOT-OPEN
 21793         DEPENDING ON DFHEIGDI
 21794     ELSE IF DFHEIGDJ EQUAL 3
 21795         GO TO 6610-START-BROWSE,
 21796               6630-ERRESS-PROBLEM,
 21797               6630-END-OF-FILE
 21798         DEPENDING ON DFHEIGDI
 21799     ELSE IF DFHEIGDJ EQUAL 4
 21800         GO TO 6630-END-OF-FILE,
 21801               6630-ERRESS-PROBLEM,
 21802               6630-ERRESS-PROBLEM,
 21803               6630-END-OF-FILE
 21804         DEPENDING ON DFHEIGDI
 21805     ELSE IF DFHEIGDJ EQUAL 5
 21806         GO TO 6630-END-OF-FILE,
 21807               6630-END-OF-FILE,
 21808               6630-ERRESS-PROBLEM,
 21809               6630-ERRESS-PROBLEM
 21810         DEPENDING ON DFHEIGDI
 21811     ELSE IF DFHEIGDJ EQUAL 6
 21812         GO TO 6660-START-BROWSE,
 21813               6690-ERRESC-PROBLEM,
 21814               6690-ERRESC-PROBLEM,
 21815               6690-END-OF-FILE
 21816         DEPENDING ON DFHEIGDI
 21817     ELSE IF DFHEIGDJ EQUAL 7
 21818         GO TO 6690-END-OF-FILE,
 21819               6690-ERRESC-PROBLEM,
 21820               6690-ERRESC-PROBLEM,
 21821               6690-END-OF-FILE
 21822         DEPENDING ON DFHEIGDI
 21823     ELSE IF DFHEIGDJ EQUAL 8
 21824         GO TO 6690-END-OF-FILE,
 21825               6690-ERRESC-PROBLEM,
 21826               6690-ERRESC-PROBLEM,
 21827               6690-END-OF-FILE
 21828         DEPENDING ON DFHEIGDI
 21829     ELSE IF DFHEIGDJ EQUAL 9
 21830         GO TO 7250-CONTINUE,
 21831               7250-CONTINUE
 21832         DEPENDING ON DFHEIGDI
 21833     ELSE IF DFHEIGDJ EQUAL 10
 21834         GO TO 7300-CONTINUE,
 21835               7300-CONTINUE
 21836         DEPENDING ON DFHEIGDI
 21837     ELSE IF DFHEIGDJ EQUAL 11
 21838         GO TO 8000-FREE-MAIN
 21839         DEPENDING ON DFHEIGDI
 21840     ELSE IF DFHEIGDJ EQUAL 12
 21841         GO TO 8100-NOTFND,
 21842               8100-NOTFND
 21843         DEPENDING ON DFHEIGDI
 21844     ELSE IF DFHEIGDJ EQUAL 13
 21845         GO TO 8110-NOTFND,
 21846               8110-NOTFND
 21847         DEPENDING ON DFHEIGDI
 21848     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 405
* EL050.cbl
 21849         GO TO 8130-EXIT
 21850         DEPENDING ON DFHEIGDI
 21851     ELSE IF DFHEIGDJ EQUAL 15
 21852         GO TO 8150-exit
 21853         DEPENDING ON DFHEIGDI
 21854     ELSE IF DFHEIGDJ EQUAL 16
 21855         GO TO 8180-NOTFND
 21856         DEPENDING ON DFHEIGDI
 21857     ELSE IF DFHEIGDJ EQUAL 17
 21858         GO TO 8190-NOTFND
 21859         DEPENDING ON DFHEIGDI
 21860     ELSE IF DFHEIGDJ EQUAL 18
 21861         GO TO 8195-NOTFND
 21862         DEPENDING ON DFHEIGDI
 21863     ELSE IF DFHEIGDJ EQUAL 19
 21864         GO TO 8200-NOTFND
 21865         DEPENDING ON DFHEIGDI
 21866     ELSE IF DFHEIGDJ EQUAL 20
 21867         GO TO 8300-NOTFND,
 21868               8300-ERRESS-PROBLEM,
 21869               8300-ERRESS-PROBLEM,
 21870               8300-NOTFND
 21871         DEPENDING ON DFHEIGDI
 21872     ELSE IF DFHEIGDJ EQUAL 21
 21873         GO TO 8450-FORM-NOT-FOUND,
 21874               8450-FORM-NOT-FOUND
 21875         DEPENDING ON DFHEIGDI
 21876     ELSE IF DFHEIGDJ EQUAL 22
 21877         GO TO 0199-ACCT-NOT-FOUND,
 21878               0199-ACCT-NOT-FOUND
 21879         DEPENDING ON DFHEIGDI
 21880     ELSE IF DFHEIGDJ EQUAL 23
 21881         GO TO 0199-ACCT-NOT-FOUND,
 21882               0199-ACCT-NOT-FOUND
 21883         DEPENDING ON DFHEIGDI
 21884     ELSE IF DFHEIGDJ EQUAL 24
 21885         GO TO 8582-COMP-NOT-FOUND,
 21886               8582-COMP-NOT-FOUND
 21887         DEPENDING ON DFHEIGDI
 21888     ELSE IF DFHEIGDJ EQUAL 25
 21889         GO TO 8583-AGTC-NOT-FOUND,
 21890               8583-AGTC-NOT-FOUND
 21891         DEPENDING ON DFHEIGDI
 21892     ELSE IF DFHEIGDJ EQUAL 26
 21893         GO TO 8584-BXRF-NOT-FOUND,
 21894               8584-BXRF-NOT-FOUND
 21895         DEPENDING ON DFHEIGDI
 21896     ELSE IF DFHEIGDJ EQUAL 27
 21897         GO TO 8585-PLAN-NOT-FOUND,
 21898               8585-PLAN-NOT-FOUND
 21899         DEPENDING ON DFHEIGDI
 21900     ELSE IF DFHEIGDJ EQUAL 28
 21901         GO TO 0299-CERT-NOT-FOUND
 21902         DEPENDING ON DFHEIGDI
 21903     ELSE IF DFHEIGDJ EQUAL 29
 21904         GO TO 8700-READ-CERT-MASTER
 21905         DEPENDING ON DFHEIGDI
 21906     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:55 Page 406
* EL050.cbl
 21907         GO TO 8720-COMP-ACCOUNTS,
 21908               8730-END-BROWSE,
 21909               8740-NOT-FOUND
 21910         DEPENDING ON DFHEIGDI
 21911     ELSE IF DFHEIGDJ EQUAL 31
 21912         GO TO 9000-NOTFND
 21913         DEPENDING ON DFHEIGDI
 21914     ELSE IF DFHEIGDJ EQUAL 32
 21915         GO TO 9100-NOTFND,
 21916               9100-NOTFND
 21917         DEPENDING ON DFHEIGDI
 21918     ELSE IF DFHEIGDJ EQUAL 33
 21919         GO TO 9991-CRTO-NOT-FOUND,
 21920               9991-CRTO-NOT-FOUND
 21921         DEPENDING ON DFHEIGDI.
 21922     MOVE '9%                    "   ' TO DFHEIV0
 21923     MOVE 'EL050' TO DFHEIV1
 21924     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21925     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40016     Code:       88403
