* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL691.
     4*
     5*AUTHOR.    LOGIC, INC.
     6*           DALLAS, TEXAS.
     7
     8*DATE-COMPILED.
     9
    10*REMARKS.
    11*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    12*    THE DETAIL OF AN ARCHIVED LETTER.
    13
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   2
* EL691.cbl
    14*    TRANS ID = EXN1
    15
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    25* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    26* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    27* 122612    2012101700002  AJRA  UPDATE BILLING NOTE ON RECEIVED
    28* 100813    2013100700002  AJRA  VERITY RESEND LETTER ID ON CHANGE
    29******************************************************************
    30
    31 DATA DIVISION.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    36 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   3
* EL691.cbl
    38
    39 01  W-WORK-AREAS.
    40     12  FILLER                  PIC  X(18)
    41                                      VALUE 'PROGRAM WORK AREA:'.
    42     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
    43     12  W-CALL-PGM              PIC  X(08).
    44     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
    45     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
    46     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
    47
    48     12  W-TIME-IN               PIC S9(07).
    49     12  FILLER REDEFINES W-TIME-IN.
    50         16  FILLER              PIC  X(01).
    51         16  W-TIME-OUT          PIC  9(02)V9(02).
    52         16  FILLER              PIC  X(02).
    53
    54     12  W-DEEDIT-FIELD          PIC  X(15).
    55     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
    56
    57     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
    58     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
    59     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
    60     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
    61     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
    62     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
    63     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
    64     12  W-RESPONSE              PIC S9(8)   COMP.
    65         88  RESP-NORMAL                  VALUE +00.
    66         88  RESP-NOTFND                  VALUE +13.
    67         88  RESP-DUPREC                  VALUE +14.
    68         88  RESP-DUPKEY                  VALUE +15.
    69         88  RESP-NOTOPEN                 VALUE +19.
    70         88  RESP-ENDFILE                 VALUE +20.
    71
    72     12  W-ARCH-SAVE-KEY         PIC  X(03).
    73     12  W-ARCH-KEY.
    74         16  W-ARCH-COMPANY-CD   PIC  X(01).
    75         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
    76
    77     12  W-ARCT-KEY.
    78         16  W-ARCT-COMPANY-CD   PIC  X(01).
    79         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
    80         16  W-ARCT-RECORD-TYPE  PIC  X(01).
    81             88  W-ARCT-COMMENT-DATA   VALUE '3'.
    82         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
    83
    84     12  W-CERT-NOTE-MSG.
    85         16  FILLER              PIC X(29)
    86             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
    87         16  W-CERT-NOTE-RECV-DT PIC X(8).
    88
    89     12  WS-FIND-BILLING-NOTE.
    90         16  WS-FBN-NOTE         PIC X(25).
    91         16  WS-FBN-LTRID        PIC X(4).
    92
    93     12  WS-RECEIVED-NOTE.
    94         16  FILLER              PIC X(12)
    95             VALUE ' - RECEIVED '.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   4
* EL691.cbl
    96         16  WS-BN-RECV-DATE     PIC X(8).
    97
    98     12  WS-Z-RECORD-IND         PIC X(1) VALUE 'N'.
    99         88 Z-RECORD-FOUND                VALUE 'Y'.
   100         88 Z-RECORD-NOT-FOUND            VALUE 'N'.
   101
   102     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
   103     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
   104     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   105     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   106     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   107     12  ERCNOT-KEY.
   108         16  ERCNOT-PARTIAL-KEY.
   109             20 ERCNOT-COMPANY-CD    PIC X.
   110             20 ERCNOT-CARRIER       PIC X.
   111             20 ERCNOT-GROUPING      PIC X(06).
   112             20 ERCNOT-STATE         PIC XX.
   113             20 ERCNOT-ACCOUNT       PIC X(10).
   114             20 ERCNOT-EFF-DT        PIC XX.
   115             20 ERCNOT-CERT-NO.
   116                25 ERCNOT-CERT-PRIME PIC X(10).
   117                25 ERCNOT-CERT-SFX   PIC X.
   118             20 ERCNOT-REC-TYP       PIC X.
   119         16 ERCNOT-SEQ           PIC S9(4) COMP.
   120     12  SV-PRIOR-KEY.
   121         16 SV-COMPANY-CD            PIC X.
   122         16 SV-CARRIER               PIC X.
   123         16 SV-GROUPING              PIC X(06).
   124         16 SV-STATE                 PIC XX.
   125         16 SV-ACCOUNT               PIC X(10).
   126         16 SV-EFF-DT                PIC XX.
   127         16 SV-CERT-NO.
   128            20 SV-CERT-PRIME         PIC X(10).
   129            20 SV-CERT-SFX           PIC X(1).
   130         16 SV-REC-TYP               PIC X.
   131         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   132     12  ELCERT-KEY.
   133         16  ELCERT-COMPANY-CD        PIC X.
   134         16  ELCERT-CARRIER           PIC X.
   135         16  ELCERT-GROUPING          PIC X(6).
   136         16  ELCERT-STATE             PIC XX.
   137         16  ELCERT-ACCOUNT           PIC X(10).
   138         16  ELCERT-EFF-DT            PIC XX.
   139         16  ELCERT-CERT-NO.
   140             20  ELCERT-CERT-PRIME    PIC X(10).
   141             20  ELCERT-CERT-SFX      PIC X.
   142     12  ELEOBC-FILE-ID          PIC X(08)  VALUE 'ELEOBC'.
   143     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   144     12  ELEOBC-KEY.
   145         16  EOBC-COMPANY-CD     PIC X.
   146         16  EOBC-REC-TYPE       PIC X.
   147         16  EOBC-CODE           PIC X(4).
   148         16  FILLER              PIC X(9).
   149     12  ERNOTE-FILE-ID          PIC X(08)  VALUE 'ERNOTE'.
   150     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   151     12  ERNOTE-KEY.
   152         16  ERNOTE-COMPANY-CD   PIC X.
   153         16  ERNOTE-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   5
* EL691.cbl
   154         16  ERNOTE-GROUPING     PIC X(6).
   155         16  ERNOTE-STATE        PIC XX.
   156         16  ERNOTE-ACCOUNT      PIC X(10).
   157         16  ERNOTE-CERT-EFF-DT  PIC XX.
   158         16  ERNOTE-CERT-PRIME   PIC X(10).
   159         16  ERNOTE-CERT-SFX     PIC X.
   160     12  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
   161     12  ELLETR-KEY.
   162         16  LETR-PART-KEY.
   163             20  LETR-COMPANY-CD PIC X.
   164             20  LETR-LETTER-ID  PIC X(4).
   165         16  LETR-FILLER         PIC X(8).
   166         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   167     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   168
   169
   170 01  FILLER                      PIC  X(22)
   171                                 VALUE 'INTERFACE AREA STARTS:'.
   172*    COPY ELCINTF.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ELCINTF.                            *
   177*                            VMOD=2.017                          *
   178*                                                                *
   179*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   180*                                                                *
   181*       LENGTH = 1024                                            *
   182*                                                                *
   183******************************************************************
   184*                   C H A N G E   L O G
   185*
   186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   187*-----------------------------------------------------------------
   188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   189* EFFECTIVE    NUMBER
   190*-----------------------------------------------------------------
   191* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   192******************************************************************
   193 01  PROGRAM-INTERFACE-BLOCK.
   194     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   195     12  PI-CALLING-PROGRAM              PIC X(8).
   196     12  PI-SAVED-PROGRAM-1              PIC X(8).
   197     12  PI-SAVED-PROGRAM-2              PIC X(8).
   198     12  PI-SAVED-PROGRAM-3              PIC X(8).
   199     12  PI-SAVED-PROGRAM-4              PIC X(8).
   200     12  PI-SAVED-PROGRAM-5              PIC X(8).
   201     12  PI-SAVED-PROGRAM-6              PIC X(8).
   202     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   203     12  PI-COMPANY-ID                   PIC XXX.
   204     12  PI-COMPANY-CD                   PIC X.
   205
   206     12  PI-COMPANY-PASSWORD             PIC X(8).
   207
   208     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   209
   210     12  PI-CONTROL-IN-PROGRESS.
   211         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   6
* EL691.cbl
   212         16  PI-GROUPING                 PIC X(6).
   213         16  PI-STATE                    PIC XX.
   214         16  PI-ACCOUNT                  PIC X(10).
   215         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   216                                         PIC X(10).
   217         16  PI-CLAIM-CERT-GRP.
   218             20  PI-CLAIM-NO             PIC X(7).
   219             20  PI-CERT-NO.
   220                 25  PI-CERT-PRIME       PIC X(10).
   221                 25  PI-CERT-SFX         PIC X.
   222             20  PI-CERT-EFF-DT          PIC XX.
   223         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   224             20  PI-PLAN-CODE            PIC X(2).
   225             20  PI-REVISION-NUMBER      PIC X(3).
   226             20  PI-PLAN-EFF-DT          PIC X(2).
   227             20  PI-PLAN-EXP-DT          PIC X(2).
   228             20  FILLER                  PIC X(11).
   229         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   230             20  PI-OE-REFERENCE-1.
   231                 25  PI-OE-REF-1-PRIME   PIC X(18).
   232                 25  PI-OE-REF-1-SUFF    PIC XX.
   233
   234     12  PI-SESSION-IN-PROGRESS          PIC X.
   235         88  CLAIM-SESSION                   VALUE '1'.
   236         88  CREDIT-SESSION                  VALUE '2'.
   237         88  WARRANTY-SESSION                VALUE '3'.
   238         88  MORTGAGE-SESSION                VALUE '4'.
   239         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   240
   241
   242*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   243
   244     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   245     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   246
   247     12  PI-CREDIT-USER                  PIC X.
   248         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   249         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   250
   251     12  PI-CLAIM-USER                   PIC X.
   252         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   253         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   254
   255     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   256         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   257         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   258         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   259         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   260         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   261
   262     12  PI-PROCESSOR-ID                 PIC X(4).
   263
   264     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   265
   266     12  PI-MEMBER-CAPTION               PIC X(10).
   267
   268     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   269         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   7
* EL691.cbl
   270
   271     12  PI-LIFE-OVERRIDE-L1             PIC X.
   272     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   273     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   274     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   275
   276     12  PI-AH-OVERRIDE-L1               PIC X.
   277     12  PI-AH-OVERRIDE-L2               PIC XX.
   278     12  PI-AH-OVERRIDE-L6               PIC X(6).
   279     12  PI-AH-OVERRIDE-L12              PIC X(12).
   280
   281     12  PI-NEW-SYSTEM                   PIC X(2).
   282
   283     12  PI-PRIMARY-CERT-NO              PIC X(11).
   284     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   285         88  PI-USES-PAID-TO                 VALUE '1'.
   286     12  PI-CRDTCRD-SYSTEM.
   287         16  PI-CRDTCRD-USER             PIC X.
   288             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   289             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   290         16  PI-CC-MONTH-END-DT          PIC XX.
   291     12  PI-PROCESSOR-PRINTER            PIC X(4).
   292
   293     12  PI-OE-REFERENCE-2.
   294         16  PI-OE-REF-2-PRIME           PIC X(10).
   295         16  PI-OE-REF-2-SUFF            PIC X.
   296
   297     12  PI-REM-TRM-CALC-OPTION          PIC X.
   298
   299     12  PI-LANGUAGE-TYPE                PIC X.
   300             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   301             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   302             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   303
   304     12  PI-POLICY-LINKAGE-IND           PIC X.
   305         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   306         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   307                                                   LOW-VALUES.
   308
   309     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   310     12  PI-CLAIM-PW-SESSION             PIC X(1).
   311         88  PI-CLAIM-CREDIT                 VALUE '1'.
   312         88  PI-CLAIM-CONVEN                 VALUE '2'.
   313
   314     12  PI-PROCESSOR-CSR-IND            PIC X.
   315         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   316         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   317
   318     12  FILLER                          PIC X(3).
   319
   320     12  PI-SYSTEM-LEVEL                 PIC X(145).
   321
   322     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   323         PI-SYSTEM-LEVEL.
   324
   325         16  PI-ENTRY-CODES.
   326             20  PI-ENTRY-CD-1           PIC X.
   327             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   8
* EL691.cbl
   328
   329         16  PI-RETURN-CODES.
   330             20  PI-RETURN-CD-1          PIC X.
   331             20  PI-RETURN-CD-2          PIC X.
   332
   333         16  PI-UPDATE-STATUS-SAVE.
   334             20  PI-UPDATE-BY            PIC X(4).
   335             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   336
   337         16  PI-LOWER-CASE-LETTERS       PIC X.
   338             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   339
   340*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   341*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   342*            88  CARRIER-CLM-CNTL            VALUE '2'.
   343
   344         16  PI-CERT-ACCESS-CONTROL      PIC X.
   345             88  ST-ACCNT-CNTL               VALUE ' '.
   346             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   347             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   348             88  ACCNT-CNTL                  VALUE '3'.
   349             88  CARR-ACCNT-CNTL             VALUE '4'.
   350
   351         16  PI-PROCESSOR-CAP-LIST.
   352             20  PI-SYSTEM-CONTROLS.
   353                24 PI-SYSTEM-DISPLAY     PIC X.
   354                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   355                24 PI-SYSTEM-MODIFY      PIC X.
   356                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   357             20  FILLER                  PIC XX.
   358             20  PI-DISPLAY-CAP          PIC X.
   359                 88  DISPLAY-CAP             VALUE 'Y'.
   360             20  PI-MODIFY-CAP           PIC X.
   361                 88  MODIFY-CAP              VALUE 'Y'.
   362             20  PI-MSG-AT-LOGON-CAP     PIC X.
   363                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   364             20  PI-FORCE-CAP            PIC X.
   365                 88  FORCE-CAP               VALUE 'Y'.
   366
   367         16  PI-PROGRAM-CONTROLS.
   368             20  PI-PGM-PRINT-OPT        PIC X.
   369             20  PI-PGM-FORMAT-OPT       PIC X.
   370             20  PI-PGM-PROCESS-OPT      PIC X.
   371             20  PI-PGM-TOTALS-OPT       PIC X.
   372
   373         16  PI-HELP-INTERFACE.
   374             20  PI-LAST-ERROR-NO        PIC X(4).
   375             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   376
   377         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   378             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   379
   380         16  PI-CR-CONTROL-IN-PROGRESS.
   381             20  PI-CR-CARRIER           PIC X.
   382             20  PI-CR-GROUPING          PIC X(6).
   383             20  PI-CR-STATE             PIC XX.
   384             20  PI-CR-ACCOUNT           PIC X(10).
   385             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page   9
* EL691.cbl
   386             20  PI-CR-TYPE              PIC X.
   387
   388         16  PI-CR-BATCH-NUMBER          PIC X(6).
   389
   390         16  PI-CR-MONTH-END-DT          PIC XX.
   391
   392         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   393             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   394             88  PI-ZERO-CARRIER             VALUE '1'.
   395             88  PI-ZERO-GROUPING            VALUE '2'.
   396             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   397
   398         16  PI-CARRIER-SECURITY         PIC X.
   399             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   400
   401         16  PI-ACCOUNT-SECURITY         PIC X(10).
   402             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   403             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   404
   405         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   406             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   407                                         INDEXED BY PI-ACCESS-NDX
   408                                         PIC X.
   409
   410         16  PI-GA-BILLING-CONTROL       PIC X.
   411             88  PI-GA-BILLING               VALUE '1'.
   412
   413         16  PI-MAIL-PROCESSING          PIC X.
   414             88  PI-MAIL-YES                 VALUE 'Y'.
   415
   416         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   417
   418         16  PI-AR-SYSTEM.
   419             20  PI-AR-PROCESSING-CNTL   PIC X.
   420                 88  PI-AR-PROCESSING        VALUE 'Y'.
   421             20  PI-AR-SUMMARY-CODE      PIC X(6).
   422             20  PI-AR-MONTH-END-DT      PIC XX.
   423
   424         16  PI-MP-SYSTEM.
   425             20  PI-MORTGAGE-USER            PIC X.
   426                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   427                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   428             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   429                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   430                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   431                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   432                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   433                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   434             20  PI-MP-MONTH-END-DT          PIC XX.
   435             20  PI-MP-REFERENCE-NO.
   436                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   437                 24  PI-MP-REFERENCE-SFX     PIC XX.
   438
   439         16  PI-LABEL-CONTROL            PIC X(01).
   440             88  PI-CREATE-LABELS                    VALUE 'Y'.
   441             88  PI-BYPASS-LABELS                    VALUE 'N'.
   442
   443         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  10
* EL691.cbl
   444             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   445
   446         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   447             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   448             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   449
   450         16  FILLER                      PIC X(14).
   451
   452     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   453******************************************************************
   454     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   455*    COPY ELC1042.
   456******************************************************************
   457*                                                                *
   458*                                                                *
   459*                           ELC1042                              *
   460*                            VMOD=2.002                          *
   461*                                                                *
   462*    NOTE                                                        *
   463*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   464*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   465*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   466*        TO THESE PROGRAMS.                                      *
   467*                                                                *
   468*    NOTE                                                        *
   469*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   470*        USE ONLY!                                               *
   471*                                                                *
   472******************************************************************
   473
   474         16  PI-1042-WA.
   475             20  PI-ACTION       PIC  X(01).
   476                 88 PI-SHOW-MODE           VALUE '1'.
   477                 88 PI-CLEAR-MODE          VALUE '2'.
   478                 88 PI-CREATE-MODE         VALUE '3'.
   479             20  PI-COMM-CONTROL PIC  X(12).
   480             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   481             20  PI-EOF-SW       PIC  X(01).
   482                 88  PI-FILE-EOF           VALUE 'Y'.
   483             20  PI-FILETYP      PIC  X(01).
   484             20  PI-FORM-SQUEEZE-CONTROL
   485                                 PIC  X(01).
   486                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   487                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   488             20  PI-LAST-CONTROL PIC  X(12).
   489             20  PI-TEMP-STOR-ITEMS
   490                                 PIC S9(04) COMP.
   491             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   492             20  PI-UPDATE-SW    PIC  9(01).
   493                 88 ANY-UPDATES            VALUE 1.
   494             20  PI-104-SCREEN-SENT-IND
   495                                 PIC  X(01).
   496                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   497                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   498             20  PI-1042-SCREEN-SENT-IND
   499                                 PIC  X(01).
   500                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   501                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  11
* EL691.cbl
   502             20  PI-1042-ARCHIVE-IND
   503                                 PIC  X(01).
   504                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   505             20  FILLER          PIC  X(29).
   506*    COPY ELC689PI.
   507******************************************************************
   508*                                                                *
   509*                            ELC689PI                            *
   510*                            VMOD=2.003                          *
   511*                                                                *
   512*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   513*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   514*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   515*                                                                *
   516*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   517*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   518*    BETWEEN PROGRAMS.                                           *
   519*                                                                *
   520*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   521*                                                                *
   522*               EL631 - EL689  - EL6891 - EL6892                 *
   523*                                                                *
   524******************************************************************
   525*                   C H A N G E   L O G
   526*
   527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   528*-----------------------------------------------------------------
   529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   530* EFFECTIVE    NUMBER
   531*-----------------------------------------------------------------
   532* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   533* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   534* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   535******************************************************************
   536
   537
   538         16  PI-689-WORK-AREA.
   539             20  PI-689-ALT-PRINTER-ID
   540                                 PIC  X(04).
   541             20  PI-689-ARCHIVE-NUMBER
   542                                 PIC  9(08).
   543             20  PI-689-ARCHIVE-SW
   544                                 PIC  X(01).
   545                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   546             20  PI-689-DATA-SOURCE
   547                                 PIC  X(01).
   548                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   549                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   550                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   551                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   552                 88  PI-689-SRC-CHECKS         VALUE '5'.
   553             20  PI-689-ERROR-IND
   554                                 PIC  X(01).
   555                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   556             20  PI-689-ERROR    PIC  9(04).
   557                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   558                 88  PI-689-FATAL-ERROR
   559                     VALUES 0004 0006 0008 0013 0023 0029 0033
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  12
* EL691.cbl
   560                            0042 0047 0051 0066 0067 0070
   561                            0168 0169 0174 0175 0176 0177 0179
   562                            0180 0181 0182 0184 0185 0189 0190
   563                            0191
   564                            0215 0279 0280
   565                            0412 0413 0454
   566                            0533 0537
   567                            2055 2114 2208 2209 2216 2232 2369
   568                            2398 2433 2908 2999
   569                            3000 3770 3771 3775
   570                            7250 7365 7367 7368 7369 7370 7371
   571                            7272 7373 7374 7376 7377 7378 7379
   572                            7381 7388 7390 7393 7395 7396 7398
   573                            9095 9096 9281 9298 9299 9320 9327
   574                            9426 9427.
   575                 88  PI-689-STOP-ERROR
   576                     VALUES 0004 0008 0013 0023 0029 0033
   577                            0042 0047 0066 0067 0070
   578                            0168 0169 0174 0175 0176 0177
   579                            0181 0182 0184 0185 0189 0190
   580                            0279 0280
   581                            0412 0413 0454
   582                            2055 2208 2209 2216 2232
   583                            2398 2999
   584                            3000 3770 3771 3775
   585                            7250 7365 7369 7370 7371
   586                            7272 7373 7374 7376 7377 7378 7379
   587                            7381 7388 7390 7393 7396 7398
   588                            9095 9096 9299 9320 9426.
   589             20  PI-689-FOLLOW-UP-DATE
   590                                 PIC  X(02).
   591             20  PI-689-FORM-NUMBER
   592                                 PIC  X(04).
   593             20  PI-689-LABEL-SOURCE
   594                                 PIC X(01).
   595                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   596                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   597                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   598                 88  PI-689-SOURCE-COMP     VALUE '4'.
   599                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   600                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   601                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   602             20  PI-689-NUMBER-COPIES
   603                                 PIC  9(01).
   604             20  PI-689-NUMBER-LABEL-LINES
   605                                 PIC  9(01).
   606             20  PI-689-NUMBER-TEXT-RECORDS
   607                                 PIC  9(03).
   608             20  PI-689-PRINT-ORDER-SW
   609                                 PIC  X(01).
   610                 88  PI-689-PRINT-FIRST     VALUE '1'.
   611                 88  PI-689-PRINT-SECOND    VALUE '2'.
   612                 88  PI-689-PRINT-LATER     VALUE '3'.
   613                 88  PI-689-PRINT-ONLY      VALUE '4'.
   614             20  PI-689-PRINT-RESTRICTION
   615                                 PIC  X(01).
   616                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   617                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  13
* EL691.cbl
   618                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   619             20  PI-689-PRINT-SW PIC  X(01).
   620                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   621             20  PI-689-RESEND-DATE-1
   622                                 PIC  X(02).
   623             20  PI-689-RESEND-LETR-1
   624                                 PIC X(4).
   625             20  PI-689-TEMP-STOR-ID
   626                                 PIC  X(08).
   627             20  PI-689-USE-SCREEN-IND
   628                                 PIC  X(01).
   629                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   630             20  PI-689-ARCH-POINTER
   631                                 PIC S9(08) COMP.
   632                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   633             20  PI-689-ARCT-POINTER
   634                                 PIC S9(08) COMP.
   635                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   636             20  PI-689-VARIABLE-DATA-GRP.
   637                 24  PI-689-VARIABLE-DATA-1
   638                                 PIC  X(30).
   639                 24  PI-689-VARIABLE-DATA-2
   640                                 PIC  X(30).
   641                 24  PI-689-VARIABLE-DATA-3
   642                                 PIC  X(30).
   643                 24  PI-689-VARIABLE-DATA-4
   644                                 PIC  X(30).
   645
   646         16  PI-689-KEY-DATA-FIELDS.
   647             20  PI-689-ACCOUNT  PIC  X(10).
   648             20  PI-689-CARRIER  PIC  X(01).
   649             20  PI-689-CERT-NO.
   650                 24  PI-689-CERT-PRIME
   651                                 PIC  X(10).
   652                 24  PI-689-CERT-SFX
   653                                 PIC  X(01).
   654             20  PI-689-CHG-SEQ-NO
   655                                 PIC S9(04)    COMP.
   656             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   657                                 PIC  X(02).
   658             20  PI-689-ENTRY-BATCH
   659                                 PIC  X(06).
   660             20  PI-689-EFF-DATE PIC  X(02).
   661             20  PI-689-EXP-DATE PIC  X(02).
   662             20  PI-689-GROUPING PIC  X(06).
   663             20  PI-689-RESP-PERSON
   664                                 PIC  X(10).
   665             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   666             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   667                                 PIC  X(04).
   668             20  PI-689-STATE    PIC  X(02).
   669             20  PI-689-TYPE     PIC  X(01).
   670             20  PI-689-CONTROL  PIC S9(08)    COMP.
   671             20  PI-689-ALT-SEQ-NO
   672                                 PIC S9(04)    COMP.
   673         16  PI-689-DATE-EDIT    PIC  X(08).
   674         16  PI-689-FOLLOW-UP-EDIT
   675                                 PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  14
* EL691.cbl
   676         16  PI-689-RESEND1-EDIT PIC  X(08).
   677         16  PI-689-SEQ-EDIT     PIC  X(08).
   678         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   679         16  PI-689-LBL-OVERRIDE PIC  X(01).
   680             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   681         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   682         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   683         16  PI-690-WORK-AREA.
   684             20  PI-690-ARCHIVE-TABLE.
   685                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   686                                 PIC S9(08) COMP.
   687             20  PI-690-CURSOR   PIC S9(04) COMP.
   688             20  PI-690-FIRST-DATA.
   689                 24  PI-690-FIRST-CERT-NO.
   690                     28  PI-690-FIRST-CERT-PRIME
   691                                 PIC  X(10).
   692                     28  PI-690-FIRST-SUFFIX
   693                                 PIC  X(01).
   694                 24  PI-690-FIRST-CARRIER
   695                                 PIC  X(01).
   696                 24  PI-690-FIRST-GROUPING
   697                                 PIC  X(06).
   698                 24  PI-690-FIRST-STATE
   699                                 PIC  X(02).
   700                 24  PI-690-FIRST-ACCOUNT
   701                                 PIC  X(10).
   702                 24  PI-690-FIRST-EFFECT-DATE
   703                                 PIC  X(02).
   704                 24  PI-690-FIRST-ENTRY.
   705                     28  PI-690-FIRST-CONTROL-PREFIX
   706                                 PIC  X(02).
   707                     28  PI-690-FIRST-CONTROL
   708                                 PIC S9(08) COMP.
   709                 24  PI-690-FIRST-FORM
   710                                 PIC  X(04).
   711                 24  PI-690-FIRST-PROCESSOR
   712                                 PIC  X(04).
   713                 24  PI-690-FIRST-ARCHIVE-NO
   714                                 PIC S9(08) COMP.
   715             20  PI-690-INIT-DATA.
   716                 24  PI-690-INIT-CERT-NO.
   717                     28  PI-690-INIT-CERT-PRIME
   718                                 PIC  X(10).
   719                     28  PI-690-INIT-SUFFIX
   720                                 PIC  X(01).
   721                 24  PI-690-INIT-CARRIER
   722                                 PIC  X(01).
   723                 24  PI-690-INIT-GROUPING
   724                                 PIC  X(06).
   725                 24  PI-690-INIT-STATE
   726                                 PIC  X(02).
   727                 24  PI-690-INIT-ACCOUNT
   728                                 PIC  X(10).
   729                 24  PI-690-INIT-EFFECT-DATE
   730                                 PIC  X(02).
   731                 24  PI-690-INIT-EFF-DTE
   732                                 PIC  X(08).
   733                 24  PI-690-INIT-ENTRY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  15
* EL691.cbl
   734                     28  PI-690-INIT-CONTROL-PREFIX
   735                                 PIC  X(02).
   736                     28  PI-690-INIT-CONTROL
   737                                 PIC S9(08) COMP.
   738                 24  PI-690-INIT-FORM
   739                                 PIC  X(04).
   740                 24  PI-690-INIT-PROCESSOR
   741                                 PIC  X(04).
   742                 24  PI-690-INIT-ARCHIVE-NO
   743                                 PIC S9(08) COMP.
   744             20  PI-690-LAST-DATA.
   745                 24  PI-690-LAST-CERT-NO.
   746                     28  PI-690-LAST-CERT-PRIME
   747                                 PIC  X(10).
   748                     28  PI-690-LAST-SUFFIX
   749                                 PIC  X(01).
   750                 24  PI-690-LAST-CARRIER
   751                                 PIC  X(01).
   752                 24  PI-690-LAST-GROUPING
   753                                 PIC  X(06).
   754                 24  PI-690-LAST-STATE
   755                                 PIC  X(02).
   756                 24  PI-690-LAST-ACCOUNT
   757                                 PIC  X(10).
   758                 24  PI-690-LAST-EFFECT-DATE
   759                                 PIC  X(02).
   760                 24  PI-690-LAST-ENTRY.
   761                     28  PI-690-LAST-CONTROL-PREFIX
   762                                 PIC  X(02).
   763                     28  PI-690-LAST-CONTROL
   764                                 PIC S9(08) COMP.
   765                 24  PI-690-LAST-FORM
   766                                 PIC  X(04).
   767                 24  PI-690-LAST-PROCESSOR
   768                                 PIC  X(04).
   769                 24  PI-690-LAST-ARCHIVE-NO
   770                                 PIC S9(08) COMP.
   771             20  PI-690-LAST-ARCH-NDX
   772                                 PIC S9(04) COMP.
   773             20  PI-690-BRWS-TYPE-IND
   774                                 PIC  9(01).
   775                 88  PI-690-BRWS-CERTRP               VALUE 1.
   776                 88  PI-690-BRWS-FORM                 VALUE 2.
   777                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   778                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   779                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   780                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   781             20  PI-690-LAST-BROWSE-IND
   782                                 PIC  X(01).
   783                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   784                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   785             20  PI-690-STATUS-SELECTION-IND
   786                                 PIC  X(01).
   787                 88  PI-690-SELECT-ALL       VALUE 'N'.
   788                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   789                                               'X' 'P' 'V' 'N'.
   790         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   791         16  PI-ARCHIVE-RECEIVED    PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  16
* EL691.cbl
   792         16  PI-ARCHIVE-STOPPED     PIC X(01).
   793         16  PI-ARCHIVE-FINAL       PIC X(01).
   794         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   795         16  PI-ARCHIVE-LTRID       PIC X(4).
   796         16  FILLER              PIC X(59).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  17
* EL691.cbl
   798
   799 01  W-CONSTANT-AREA.
   800     12  FILLER                  PIC  X(18)
   801                                 VALUE 'PROGRAM CONSTANTS:'.
   802     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   803
   804     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   805     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   806     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   807     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   808     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   809     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   810     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   811         16  FILLER              PIC  X(02).
   812         16  W-MAP-NUM           PIC  X(06).
   813     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
   814     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
   815     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
   816     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
   817     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
   818     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
   819     12  SLASH                   PIC X       VALUE '/'.
   820     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
   821     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
   822     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
   823     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
   824
   825 01  ERROR-MESSAGES.
   826     12  ER-0000                 PIC  X(04) VALUE '0000'.
   827     12  ER-0004                 PIC  X(04) VALUE '0004'.
   828     12  ER-0029                 PIC  X(04) VALUE '0029'.
   829     12  ER-0051                 PIC  X(04) VALUE '0051'.
   830     12  ER-0070                 PIC  X(04) VALUE '0070'.
   831     12  ER-0295                 PIC  X(04) VALUE '0295'.
   832     12  ER-0296                 PIC  X(04) VALUE '0296'.
   833     12  ER-0539                 PIC  X(04) VALUE '0539'.
   834     12  ER-0895                 PIC  X(04) VALUE '0895'.
   835     12  ER-0897                 PIC  X(04) VALUE '0897'.
   836     12  ER-1236                 PIC  X(04) VALUE '1236'.
   837     12  ER-3112                 PIC  X(04) VALUE '3112'.
   838     12  ER-7008                 PIC  X(04) VALUE '7008'.
   839     12  ER-7363                 PIC  X(04) VALUE '7363'.
   840     12  ER-7371                 PIC  X(04) VALUE '7371'.
   841     12  ER-7373                 PIC  X(04) VALUE '7373'.
   842     12  ER-7388                 PIC  X(04) VALUE '7388'.
   843     12  ER-9097                 PIC  X(04) VALUE '9097'.
   844     12  ER-9245                 PIC  X(04) VALUE '9245'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  18
* EL691.cbl
   846*    COPY ELCAID.
   847******************************************************************
   848*                                                                *
   849*                            ELCAID.                             *
   850*                            VMOD=2.001                          *
   851*                                                                *
   852*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   853*                                                                *
   854*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   855*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   856******************************************************************
   857
   858 01  DFHAID.
   859   02  DFHNULL   PIC  X  VALUE  ' '.
   860   02  DFHENTER  PIC  X  VALUE  QUOTE.
   861   02  DFHCLEAR  PIC  X  VALUE  '_'.
   862   02  DFHPEN    PIC  X  VALUE  '='.
   863   02  DFHOPID   PIC  X  VALUE  'W'.
   864   02  DFHPA1    PIC  X  VALUE  '%'.
   865   02  DFHPA2    PIC  X  VALUE  '>'.
   866   02  DFHPA3    PIC  X  VALUE  ','.
   867   02  DFHPF1    PIC  X  VALUE  '1'.
   868   02  DFHPF2    PIC  X  VALUE  '2'.
   869   02  DFHPF3    PIC  X  VALUE  '3'.
   870   02  DFHPF4    PIC  X  VALUE  '4'.
   871   02  DFHPF5    PIC  X  VALUE  '5'.
   872   02  DFHPF6    PIC  X  VALUE  '6'.
   873   02  DFHPF7    PIC  X  VALUE  '7'.
   874   02  DFHPF8    PIC  X  VALUE  '8'.
   875   02  DFHPF9    PIC  X  VALUE  '9'.
   876   02  DFHPF10   PIC  X  VALUE  ':'.
   877   02  DFHPF11   PIC  X  VALUE  '#'.
   878   02  DFHPF12   PIC  X  VALUE  '@'.
   879   02  DFHPF13   PIC  X  VALUE  'A'.
   880   02  DFHPF14   PIC  X  VALUE  'B'.
   881   02  DFHPF15   PIC  X  VALUE  'C'.
   882   02  DFHPF16   PIC  X  VALUE  'D'.
   883   02  DFHPF17   PIC  X  VALUE  'E'.
   884   02  DFHPF18   PIC  X  VALUE  'F'.
   885   02  DFHPF19   PIC  X  VALUE  'G'.
   886   02  DFHPF20   PIC  X  VALUE  'H'.
   887   02  DFHPF21   PIC  X  VALUE  'I'.
   888*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   889   02  DFHPF22   PIC  X  VALUE  '['.
   890   02  DFHPF23   PIC  X  VALUE  '.'.
   891   02  DFHPF24   PIC  X  VALUE  '<'.
   892   02  DFHMSRE   PIC  X  VALUE  'X'.
   893   02  DFHSTRF   PIC  X  VALUE  'h'.
   894   02  DFHTRIG   PIC  X  VALUE  '"'.
   895 01  FILLER    REDEFINES DFHAID.
   896     12  FILLER                  PIC  X(08).
   897     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  19
* EL691.cbl
   899*    COPY ELCATTR.
   900******************************************************************
   901*                                                                *
   902*                            ELCATTR.                            *
   903*                            VMOD=2.001                          *
   904*                                                                *
   905*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   906*                                                                *
   907*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   908*                                                                *
   909*                   POS 1   P=PROTECTED                          *
   910*                           U=UNPROTECTED                        *
   911*                           S=ASKIP                              *
   912*                   POS 2   A=ALPHA/NUMERIC                      *
   913*                           N=NUMERIC                            *
   914*                   POS 3   N=NORMAL                             *
   915*                           B=BRIGHT                             *
   916*                           D=DARK                               *
   917*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   918*                           OF=MODIFIED DATA TAG OFF             *
   919*                                                                *
   920*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   921******************************************************************
   922 01  ATTRIBUTE-LIST.
   923     12  AL-PABOF            PIC X       VALUE 'Y'.
   924     12  AL-PABON            PIC X       VALUE 'Z'.
   925     12  AL-PADOF            PIC X       VALUE '%'.
   926     12  AL-PADON            PIC X       VALUE '_'.
   927     12  AL-PANOF            PIC X       VALUE '-'.
   928     12  AL-PANON            PIC X       VALUE '/'.
   929     12  AL-SABOF            PIC X       VALUE '8'.
   930     12  AL-SABON            PIC X       VALUE '9'.
   931     12  AL-SADOF            PIC X       VALUE '@'.
   932     12  AL-SADON            PIC X       VALUE QUOTE.
   933     12  AL-SANOF            PIC X       VALUE '0'.
   934     12  AL-SANON            PIC X       VALUE '1'.
   935     12  AL-UABOF            PIC X       VALUE 'H'.
   936     12  AL-UABON            PIC X       VALUE 'I'.
   937     12  AL-UADOF            PIC X       VALUE '<'.
   938     12  AL-UADON            PIC X       VALUE '('.
   939     12  AL-UANOF            PIC X       VALUE ' '.
   940     12  AL-UANON            PIC X       VALUE 'A'.
   941     12  AL-UNBOF            PIC X       VALUE 'Q'.
   942     12  AL-UNBON            PIC X       VALUE 'R'.
   943     12  AL-UNDOF            PIC X       VALUE '*'.
   944     12  AL-UNDON            PIC X       VALUE ')'.
   945     12  AL-UNNOF            PIC X       VALUE '&'.
   946     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  20
* EL691.cbl
   948*    COPY ELCDATE.
   949******************************************************************
   950*                                                                *
   951*                                                                *
   952*                            ELCDATE.                            *
   953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   954*                            VMOD=2.003
   955*                                                                *
   956*                                                                *
   957*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   958*                 LENGTH = 200                                   *
   959******************************************************************
   960
   961 01  DATE-CONVERSION-DATA.
   962     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   963     12  DC-OPTION-CODE                PIC X.
   964         88  BIN-TO-GREG                VALUE ' '.
   965         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   966         88  EDIT-GREG-TO-BIN           VALUE '2'.
   967         88  YMD-GREG-TO-BIN            VALUE '3'.
   968         88  MDY-GREG-TO-BIN            VALUE '4'.
   969         88  JULIAN-TO-BIN              VALUE '5'.
   970         88  BIN-PLUS-ELAPSED           VALUE '6'.
   971         88  FIND-CENTURY               VALUE '7'.
   972         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   973         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   974         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   975         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   976         88  JULIAN-TO-BIN-3            VALUE 'C'.
   977         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   978         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   979         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   980         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   981         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   982         88  CHECK-LEAP-YEAR            VALUE 'H'.
   983         88  BIN-3-TO-GREG              VALUE 'I'.
   984         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   985         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   986         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   987         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   988         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   989         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   990         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   991         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   992         88  THREE-CHARACTER-BIN
   993                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   994         88  GREGORIAN-TO-BIN
   995                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   996         88  BIN-TO-GREGORIAN
   997                  VALUES ' ' '1' 'I' '8' 'G'.
   998         88  JULIAN-TO-BINARY
   999                  VALUES '5' 'C' 'E' 'F'.
  1000     12  DC-ERROR-CODE                 PIC X.
  1001         88  NO-CONVERSION-ERROR        VALUE ' '.
  1002         88  DATE-CONVERSION-ERROR
  1003                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1004         88  DATE-IS-ZERO               VALUE '1'.
  1005         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  21
* EL691.cbl
  1006         88  DATE-IS-INVALID            VALUE '3'.
  1007         88  DATE1-GREATER-DATE2        VALUE '4'.
  1008         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1009         88  DATE-INVALID-OPTION        VALUE '9'.
  1010         88  INVALID-CENTURY            VALUE 'A'.
  1011         88  ONLY-CENTURY               VALUE 'B'.
  1012         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1013         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1014     12  DC-END-OF-MONTH               PIC X.
  1015         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1016     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1017         88  USE-NORMAL-PROCESS         VALUE ' '.
  1018         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1019         88  ADJUST-UP-100-YRS          VALUE '2'.
  1020     12  FILLER                        PIC X.
  1021     12  DC-CONVERSION-DATES.
  1022         16  DC-BIN-DATE-1             PIC XX.
  1023         16  DC-BIN-DATE-2             PIC XX.
  1024         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1025         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1026                       DC-GREG-DATE-1-EDIT.
  1027             20  DC-EDIT1-MONTH        PIC 99.
  1028             20  SLASH1-1              PIC X.
  1029             20  DC-EDIT1-DAY          PIC 99.
  1030             20  SLASH1-2              PIC X.
  1031             20  DC-EDIT1-YEAR         PIC 99.
  1032         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1033         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1034                     DC-GREG-DATE-2-EDIT.
  1035             20  DC-EDIT2-MONTH        PIC 99.
  1036             20  SLASH2-1              PIC X.
  1037             20  DC-EDIT2-DAY          PIC 99.
  1038             20  SLASH2-2              PIC X.
  1039             20  DC-EDIT2-YEAR         PIC 99.
  1040         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1041         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1042                     DC-GREG-DATE-1-YMD.
  1043             20  DC-YMD-YEAR           PIC 99.
  1044             20  DC-YMD-MONTH          PIC 99.
  1045             20  DC-YMD-DAY            PIC 99.
  1046         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1047         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1048                      DC-GREG-DATE-1-MDY.
  1049             20  DC-MDY-MONTH          PIC 99.
  1050             20  DC-MDY-DAY            PIC 99.
  1051             20  DC-MDY-YEAR           PIC 99.
  1052         16  DC-GREG-DATE-1-ALPHA.
  1053             20  DC-ALPHA-MONTH        PIC X(10).
  1054             20  DC-ALPHA-DAY          PIC 99.
  1055             20  FILLER                PIC XX.
  1056             20  DC-ALPHA-CENTURY.
  1057                 24 DC-ALPHA-CEN-N     PIC 99.
  1058             20  DC-ALPHA-YEAR         PIC 99.
  1059         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1060         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1061         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1062         16  DC-JULIAN-DATE            PIC 9(05).
  1063         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  22
* EL691.cbl
  1064                                       PIC 9(05).
  1065         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1066             20  DC-JULIAN-YEAR        PIC 99.
  1067             20  DC-JULIAN-DAYS        PIC 999.
  1068         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1069         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1070         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1071     12  DATE-CONVERSION-VARIBLES.
  1072         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1073         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1074             20  FILLER                PIC 9(3).
  1075             20  HOLD-CEN-1-CCYY.
  1076                 24  HOLD-CEN-1-CC     PIC 99.
  1077                 24  HOLD-CEN-1-YY     PIC 99.
  1078             20  HOLD-CEN-1-MO         PIC 99.
  1079             20  HOLD-CEN-1-DA         PIC 99.
  1080         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1081             20  HOLD-CEN-1-R-MO       PIC 99.
  1082             20  HOLD-CEN-1-R-DA       PIC 99.
  1083             20  HOLD-CEN-1-R-CCYY.
  1084                 24  HOLD-CEN-1-R-CC   PIC 99.
  1085                 24  HOLD-CEN-1-R-YY   PIC 99.
  1086             20  FILLER                PIC 9(3).
  1087         16  HOLD-CENTURY-1-X.
  1088             20  FILLER                PIC X(3)  VALUE SPACES.
  1089             20  HOLD-CEN-1-X-CCYY.
  1090                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1091                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1092             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1093             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1094         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1095             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1096             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1097             20  HOLD-CEN-1-R-X-CCYY.
  1098                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1099                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1100             20  FILLER                PIC XXX.
  1101         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1102         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1103         16  DC-JULIAN-DATE-1          PIC 9(07).
  1104         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1105             20  DC-JULIAN-1-CCYY.
  1106                 24  DC-JULIAN-1-CC    PIC 99.
  1107                 24  DC-JULIAN-1-YR    PIC 99.
  1108             20  DC-JULIAN-DA-1        PIC 999.
  1109         16  DC-JULIAN-DATE-2          PIC 9(07).
  1110         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1111             20  DC-JULIAN-2-CCYY.
  1112                 24  DC-JULIAN-2-CC    PIC 99.
  1113                 24  DC-JULIAN-2-YR    PIC 99.
  1114             20  DC-JULIAN-DA-2        PIC 999.
  1115         16  DC-GREG-DATE-A-EDIT.
  1116             20  DC-EDITA-MONTH        PIC 99.
  1117             20  SLASHA-1              PIC X VALUE '/'.
  1118             20  DC-EDITA-DAY          PIC 99.
  1119             20  SLASHA-2              PIC X VALUE '/'.
  1120             20  DC-EDITA-CCYY.
  1121                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  23
* EL691.cbl
  1122                 24  DC-EDITA-YEAR     PIC 99.
  1123         16  DC-GREG-DATE-B-EDIT.
  1124             20  DC-EDITB-MONTH        PIC 99.
  1125             20  SLASHB-1              PIC X VALUE '/'.
  1126             20  DC-EDITB-DAY          PIC 99.
  1127             20  SLASHB-2              PIC X VALUE '/'.
  1128             20  DC-EDITB-CCYY.
  1129                 24  DC-EDITB-CENT     PIC 99.
  1130                 24  DC-EDITB-YEAR     PIC 99.
  1131         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1132         16  DC-GREG-DATE-CYMD-R REDEFINES
  1133                              DC-GREG-DATE-CYMD.
  1134             20  DC-CYMD-CEN           PIC 99.
  1135             20  DC-CYMD-YEAR          PIC 99.
  1136             20  DC-CYMD-MONTH         PIC 99.
  1137             20  DC-CYMD-DAY           PIC 99.
  1138         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1139         16  DC-GREG-DATE-MDCY-R REDEFINES
  1140                              DC-GREG-DATE-MDCY.
  1141             20  DC-MDCY-MONTH         PIC 99.
  1142             20  DC-MDCY-DAY           PIC 99.
  1143             20  DC-MDCY-CEN           PIC 99.
  1144             20  DC-MDCY-YEAR          PIC 99.
  1145    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1146        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1147    12  DC-EL310-DATE                  PIC X(21).
  1148    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  24
* EL691.cbl
  1150*    COPY ELCTEXT.
  1151******************************************************************
  1152*                                                                *
  1153*                                                                *
  1154*                            ELCTEXT.                            *
  1155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1156*                            VMOD=2.008                          *
  1157*                                                                *
  1158*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1159*                                     FORM LETTERS,              *
  1160*                                     CERT FORM DISPLAY.
  1161*                                                                *
  1162*   FILE TYPE = VSAM,KSDS                                        *
  1163*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1164*                                                                *
  1165*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1166*       ALTERNATE INDEX = NONE                                   *
  1167*                                                                *
  1168*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1169*       ALTERNATE INDEX = NONE                                   *
  1170*                                                                *
  1171*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1172*       ALTERNATE INDEX = NONE                                   *
  1173*                                                                *
  1174*   LOG = NO                                                     *
  1175*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1176******************************************************************
  1177 01  TEXT-FILES.
  1178     12  TEXT-FILE-ID                PIC XX.
  1179         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1180         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1181         88  HELP-FILE-TEXT             VALUE 'TH'.
  1182
  1183     12  TX-CONTROL-PRIMARY.
  1184         16  TX-COMPANY-CD           PIC X.
  1185             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1186         16  TX-ACCESS-CD-GENL       PIC X(12).
  1187
  1188         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1189             20  TX-LETTER-NO        PIC X(4).
  1190             20  FILLER              PIC X(8).
  1191
  1192         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1193             20  TX-FORM-NO          PIC X(12).
  1194
  1195         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1196             20  TX-HELP-TYPE        PIC X.
  1197                 88  HELP-FOR-GENERAL   VALUE ' '.
  1198                 88  HELP-BY-SCREEN     VALUE 'S'.
  1199                 88  HELP-BY-ERROR      VALUE 'E'.
  1200             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1201                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1202             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1203                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1204             20  FILLER              PIC X(4).
  1205
  1206         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1207
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  25
* EL691.cbl
  1208     12  TX-PROCESS-CONTROL          PIC XX.
  1209         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1210
  1211     12  TX-TEXT-LINE                PIC X(70).
  1212
  1213     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1214         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1215         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1216         88  TX-VALID-FORM-SQUEEZE-VALUE
  1217                                        VALUE 'Y' ' '.
  1218
  1219     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1220         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1221         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1222         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1223         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1224         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1225         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1226         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1227                                              'K' 'N' ' '
  1228                                              'Z'.
  1229
  1230     12  TX-ARCHIVE-SW               PIC X.
  1231         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1232         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1233         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1234
  1235     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1236     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1237
  1238     12  TX-BSR-CODE                 PIC X.
  1239         88  TX-BSR-LETTER              VALUE 'B'.
  1240         88  TX-NON-BSR-LETTER          VALUE ' '.
  1241
  1242     12  FILLER                      PIC X.
  1243*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  26
* EL691.cbl
  1245*    COPY ELCNWA.
  1246*****************************************************************
  1247*                                                               *
  1248*                                                               *
  1249*                            ELCNWA.                            *
  1250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1251*                            VMOD=2.003                         *
  1252*                                                               *
  1253*            M O V E   N A M E   W O R K   A R E A.             *
  1254*                                                               *
  1255*****************************************************************.
  1256
  1257 01  WS-NAME-WORK-AREA.
  1258     05  WS-INSURED-LAST-NAME        PIC X(15).
  1259     05  WS-INSURED-1ST-NAME         PIC X(12).
  1260     05  WS-INSURED-MID-INIT         PIC X.
  1261
  1262     05  WS-NAME-WORK.
  1263         10  WS-NW                   PIC X
  1264             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1265
  1266     05  WS-NAME-WORK2.
  1267         10  WS-NW2                  PIC X
  1268             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1269                                        NWA-INDEX0.
  1270
  1271     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1272                                     COMP-3.
  1273
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  27
* EL691.cbl
  1275*    COPY ELCEMIB.
  1276******************************************************************
  1277*                                                                *
  1278*                                                                *
  1279*                            ELCEMIB.                            *
  1280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1281*                            VMOD=2.005                          *
  1282*                                                                *
  1283*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1284*                                                                *
  1285******************************************************************
  1286 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1287     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1288     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1289     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1290     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1291     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1292     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1293     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1294     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1295     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1296         88  EMI-NO-ERRORS                    VALUE '1'.
  1297         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1298         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1299     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1300         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1301     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1302         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1303         88  EMI-AREA1-FULL                   VALUE '2'.
  1304     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1305         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1306         88  EMI-AREA2-FULL                   VALUE '2'.
  1307     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1308         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1309         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1310         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1311         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1312         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1313     12  EMI-ERROR-LINES.
  1314         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1315         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1316         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1317         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1318             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1319                 24  EMI-ERR-NUM         PIC X(4).
  1320                 24  EMI-FILLER          PIC X.
  1321                 24  EMI-SEV             PIC X.
  1322                 24  FILLER              PIC X.
  1323             20  FILLER                  PIC X(02).
  1324     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1325         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1326             20  EMI-ERROR-NUMBER    PIC X(4).
  1327             20  EMI-FILL            PIC X.
  1328             20  EMI-SEVERITY        PIC X.
  1329             20  FILLER              PIC X.
  1330             20  EMI-ERROR-TEXT.
  1331                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1332                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  28
* EL691.cbl
  1333     12  EMI-SEVERITY-SAVE           PIC X.
  1334         88  EMI-NOTE                    VALUE 'N'.
  1335         88  EMI-WARNING                 VALUE 'W'.
  1336         88  EMI-FORCABLE                VALUE 'F'.
  1337         88  EMI-FATAL                   VALUE 'X'.
  1338     12  EMI-MESSAGE-FLAG            PIC X.
  1339         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1340         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1341     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1342     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1343         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1344         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1345         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1346     12  emi-claim-no                pic x(7).
  1347     12  emi-claim-type              pic x(6).
  1348     12  FILLER                      PIC X(124)  VALUE SPACES.
  1349     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1350     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1351     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1352     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1353 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  29
* EL691.cbl
  1355*    COPY ELCLOGOF.
  1356******************************************************************
  1357*                                                                *
  1358*                                                                *
  1359*                            ELCLOGOF.                           *
  1360*                            VMOD=2.001                          *
  1361*                                                                *
  1362*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1363*                                                                *
  1364******************************************************************
  1365 01  CLASIC-LOGOFF.
  1366     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1367     12  LOGOFF-TEXT.
  1368         16  FILLER          PIC X(5)    VALUE SPACES.
  1369         16  LOGOFF-MSG.
  1370             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1371             20  FILLER      PIC X       VALUE SPACES.
  1372             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1373         16  FILLER          PIC X(80)
  1374           VALUE '* YOU ARE NOW LOGGED OFF'.
  1375         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1376         16  FILLER          PIC X       VALUE QUOTE.
  1377         16  LOGOFF-SYS-MSG  PIC X(17)
  1378           VALUE 'S CLAS-IC SYSTEM '.
  1379     12  TEXT-MESSAGES.
  1380         16  UNACCESS-MSG    PIC X(29)
  1381             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1382         16  PGMIDERR-MSG    PIC X(17)
  1383             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  30
* EL691.cbl
  1385*    COPY ELCSCTM.
  1386******************************************************************
  1387*                                                                *
  1388*                                                                *
  1389*                            ELCSCTM                             *
  1390*                            VMOD=2.001                          *
  1391*                                                                *
  1392*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1393*                                                                *
  1394******************************************************************
  1395 01  SECURITY-MESSAGE.
  1396     12  FILLER                          PIC X(30)
  1397            VALUE '** LOGIC SECURITY VIOLATION -'.
  1398     12  SM-READ                         PIC X(6).
  1399     12  FILLER                          PIC X(5)
  1400            VALUE ' PGM='.
  1401     12  SM-PGM                          PIC X(6).
  1402     12  FILLER                          PIC X(5)
  1403            VALUE ' OPR='.
  1404     12  SM-PROCESSOR-ID                 PIC X(4).
  1405     12  FILLER                          PIC X(6)
  1406            VALUE ' TERM='.
  1407     12  SM-TERMID                       PIC X(4).
  1408     12  FILLER                          PIC XX   VALUE SPACE.
  1409     12  SM-JUL-DATE                     PIC 9(5).
  1410     12  FILLER                          PIC X    VALUE SPACE.
  1411     12  SM-TIME                         PIC 99.99.
  1412
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  31
* EL691.cbl
  1414*    COPY ELCSCRTY.
  1415******************************************************************
  1416*                                                                *
  1417*                                                                *
  1418*                            ELCSCRTY                            *
  1419*                            VMOD=2.001                          *
  1420*                                                                *
  1421*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1422*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1423*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1424*                                                                *
  1425******************************************************************
  1426 01  SECURITY-CONTROL.
  1427     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1428     12  FILLER                       PIC XX    VALUE 'SC'.
  1429     12  SC-CREDIT-CODES.
  1430         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1431             20  SC-CREDIT-DISPLAY    PIC X.
  1432             20  SC-CREDIT-UPDATE     PIC X.
  1433     12  SC-CLAIMS-CODES.
  1434         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1435             20  SC-CLAIMS-DISPLAY    PIC X.
  1436             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  32
* EL691.cbl
  1438
  1439*    COPY EL691S.
  1440 01  EL691AI.
  1441     05  FILLER            PIC  X(0012).
  1442*    -------------------------------
  1443     05  RUNDTEL PIC S9(0004) COMP.
  1444     05  RUNDTEF PIC  X(0001).
  1445     05  FILLER REDEFINES RUNDTEF.
  1446         10  RUNDTEA PIC  X(0001).
  1447     05  RUNDTEI PIC  X(0008).
  1448*    -------------------------------
  1449     05  RUNTIMEL PIC S9(0004) COMP.
  1450     05  RUNTIMEF PIC  X(0001).
  1451     05  FILLER REDEFINES RUNTIMEF.
  1452         10  RUNTIMEA PIC  X(0001).
  1453     05  RUNTIMEI PIC  X(0005).
  1454*    -------------------------------
  1455     05  COMPANYL PIC S9(0004) COMP.
  1456     05  COMPANYF PIC  X(0001).
  1457     05  FILLER REDEFINES COMPANYF.
  1458         10  COMPANYA PIC  X(0001).
  1459     05  COMPANYI PIC  X(0003).
  1460*    -------------------------------
  1461     05  USERIDL PIC S9(0004) COMP.
  1462     05  USERIDF PIC  X(0001).
  1463     05  FILLER REDEFINES USERIDF.
  1464         10  USERIDA PIC  X(0001).
  1465     05  USERIDI PIC  X(0004).
  1466*    -------------------------------
  1467     05  CARRIERL PIC S9(0004) COMP.
  1468     05  CARRIERF PIC  X(0001).
  1469     05  FILLER REDEFINES CARRIERF.
  1470         10  CARRIERA PIC  X(0001).
  1471     05  CARRIERI PIC  X(0001).
  1472*    -------------------------------
  1473     05  GROUPL PIC S9(0004) COMP.
  1474     05  GROUPF PIC  X(0001).
  1475     05  FILLER REDEFINES GROUPF.
  1476         10  GROUPA PIC  X(0001).
  1477     05  GROUPI PIC  X(0006).
  1478*    -------------------------------
  1479     05  STATEL PIC S9(0004) COMP.
  1480     05  STATEF PIC  X(0001).
  1481     05  FILLER REDEFINES STATEF.
  1482         10  STATEA PIC  X(0001).
  1483     05  STATEI PIC  X(0002).
  1484*    -------------------------------
  1485     05  ACCTL PIC S9(0004) COMP.
  1486     05  ACCTF PIC  X(0001).
  1487     05  FILLER REDEFINES ACCTF.
  1488         10  ACCTA PIC  X(0001).
  1489     05  ACCTI PIC  X(0010).
  1490*    -------------------------------
  1491     05  CERTL PIC S9(0004) COMP.
  1492     05  CERTF PIC  X(0001).
  1493     05  FILLER REDEFINES CERTF.
  1494         10  CERTA PIC  X(0001).
  1495     05  CERTI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  33
* EL691.cbl
  1496*    -------------------------------
  1497     05  SFXL PIC S9(0004) COMP.
  1498     05  SFXF PIC  X(0001).
  1499     05  FILLER REDEFINES SFXF.
  1500         10  SFXA PIC  X(0001).
  1501     05  SFXI PIC  X(0001).
  1502*    -------------------------------
  1503     05  MAINTL PIC S9(0004) COMP.
  1504     05  MAINTF PIC  X(0001).
  1505     05  FILLER REDEFINES MAINTF.
  1506         10  MAINTA PIC  X(0001).
  1507     05  MAINTI PIC  X(0001).
  1508*    -------------------------------
  1509     05  MAINTBYL PIC S9(0004) COMP.
  1510     05  MAINTBYF PIC  X(0001).
  1511     05  FILLER REDEFINES MAINTBYF.
  1512         10  MAINTBYA PIC  X(0001).
  1513     05  MAINTBYI PIC  X(0004).
  1514*    -------------------------------
  1515     05  MAINTDTL PIC S9(0004) COMP.
  1516     05  MAINTDTF PIC  X(0001).
  1517     05  FILLER REDEFINES MAINTDTF.
  1518         10  MAINTDTA PIC  X(0001).
  1519     05  MAINTDTI PIC  X(0008).
  1520*    -------------------------------
  1521     05  MAINTTML PIC S9(0004) COMP.
  1522     05  MAINTTMF PIC  X(0001).
  1523     05  FILLER REDEFINES MAINTTMF.
  1524         10  MAINTTMA PIC  X(0001).
  1525     05  MAINTTMI PIC  X(0005).
  1526*    -------------------------------
  1527     05  ARCHNOL PIC S9(0004) COMP.
  1528     05  ARCHNOF PIC  X(0001).
  1529     05  FILLER REDEFINES ARCHNOF.
  1530         10  ARCHNOA PIC  X(0001).
  1531     05  ARCHNOI PIC  X(0008).
  1532*    -------------------------------
  1533     05  ENDARCHL PIC S9(0004) COMP.
  1534     05  ENDARCHF PIC  X(0001).
  1535     05  FILLER REDEFINES ENDARCHF.
  1536         10  ENDARCHA PIC  X(0001).
  1537     05  ENDARCHI PIC  X(0008).
  1538*    -------------------------------
  1539     05  FORMNOL PIC S9(0004) COMP.
  1540     05  FORMNOF PIC  X(0001).
  1541     05  FILLER REDEFINES FORMNOF.
  1542         10  FORMNOA PIC  X(0001).
  1543     05  FORMNOI PIC  X(0004).
  1544*    -------------------------------
  1545     05  RESFORML PIC S9(0004) COMP.
  1546     05  RESFORMF PIC  X(0001).
  1547     05  FILLER REDEFINES RESFORMF.
  1548         10  RESFORMA PIC  X(0001).
  1549     05  RESFORMI PIC  X(0004).
  1550*    -------------------------------
  1551     05  CREATDTL PIC S9(0004) COMP.
  1552     05  CREATDTF PIC  X(0001).
  1553     05  FILLER REDEFINES CREATDTF.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  34
* EL691.cbl
  1554         10  CREATDTA PIC  X(0001).
  1555     05  CREATDTI PIC  X(0008).
  1556*    -------------------------------
  1557     05  RESENDL PIC S9(0004) COMP.
  1558     05  RESENDF PIC  X(0001).
  1559     05  FILLER REDEFINES RESENDF.
  1560         10  RESENDA PIC  X(0001).
  1561     05  RESENDI PIC  X(0008).
  1562*    -------------------------------
  1563     05  CREATBYL PIC S9(0004) COMP.
  1564     05  CREATBYF PIC  X(0001).
  1565     05  FILLER REDEFINES CREATBYF.
  1566         10  CREATBYA PIC  X(0001).
  1567     05  CREATBYI PIC  X(0004).
  1568*    -------------------------------
  1569     05  PRINTDTL PIC S9(0004) COMP.
  1570     05  PRINTDTF PIC  X(0001).
  1571     05  FILLER REDEFINES PRINTDTF.
  1572         10  PRINTDTA PIC  X(0001).
  1573     05  PRINTDTI PIC  X(0008).
  1574*    -------------------------------
  1575     05  RESPRNTL PIC S9(0004) COMP.
  1576     05  RESPRNTF PIC  X(0001).
  1577     05  FILLER REDEFINES RESPRNTF.
  1578         10  RESPRNTA PIC  X(0001).
  1579     05  RESPRNTI PIC  X(0008).
  1580*    -------------------------------
  1581     05  STCOMPL PIC S9(0004) COMP.
  1582     05  STCOMPF PIC  X(0001).
  1583     05  FILLER REDEFINES STCOMPF.
  1584         10  STCOMPA PIC  X(0001).
  1585     05  STCOMPI PIC  X(0019).
  1586*    -------------------------------
  1587     05  REPLYL PIC S9(0004) COMP.
  1588     05  REPLYF PIC  X(0001).
  1589     05  FILLER REDEFINES REPLYF.
  1590         10  REPLYA PIC  X(0001).
  1591     05  REPLYI PIC  X(0008).
  1592*    -------------------------------
  1593     05  STRECVL PIC S9(0004) COMP.
  1594     05  STRECVF PIC  X(0001).
  1595     05  FILLER REDEFINES STRECVF.
  1596         10  STRECVA PIC  X(0001).
  1597     05  STRECVI PIC  X(0019).
  1598*    -------------------------------
  1599     05  STOPDTEL PIC S9(0004) COMP.
  1600     05  STOPDTEF PIC  X(0001).
  1601     05  FILLER REDEFINES STOPDTEF.
  1602         10  STOPDTEA PIC  X(0001).
  1603     05  STOPDTEI PIC  X(0008).
  1604*    -------------------------------
  1605     05  STSTOPL PIC S9(0004) COMP.
  1606     05  STSTOPF PIC  X(0001).
  1607     05  FILLER REDEFINES STSTOPF.
  1608         10  STSTOPA PIC  X(0001).
  1609     05  STSTOPI PIC  X(0019).
  1610*    -------------------------------
  1611     05  FINDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  35
* EL691.cbl
  1612     05  FINDATEF PIC  X(0001).
  1613     05  FILLER REDEFINES FINDATEF.
  1614         10  FINDATEA PIC  X(0001).
  1615     05  FINDATEI PIC  X(0008).
  1616*    -------------------------------
  1617     05  STFINLL PIC S9(0004) COMP.
  1618     05  STFINLF PIC  X(0001).
  1619     05  FILLER REDEFINES STFINLF.
  1620         10  STFINLA PIC  X(0001).
  1621     05  STFINLI PIC  X(0019).
  1622*    -------------------------------
  1623     05  FINLACTL PIC S9(0004) COMP.
  1624     05  FINLACTF PIC  X(0001).
  1625     05  FILLER REDEFINES FINLACTF.
  1626         10  FINLACTA PIC  X(0001).
  1627     05  FINLACTI PIC  X(0001).
  1628*    -------------------------------
  1629     05  COMMENTL PIC S9(0004) COMP.
  1630     05  COMMENTF PIC  X(0001).
  1631     05  FILLER REDEFINES COMMENTF.
  1632         10  COMMENTA PIC  X(0001).
  1633     05  COMMENTI PIC  X(0069).
  1634*    -------------------------------
  1635     05  ERRMSG1L PIC S9(0004) COMP.
  1636     05  ERRMSG1F PIC  X(0001).
  1637     05  FILLER REDEFINES ERRMSG1F.
  1638         10  ERRMSG1A PIC  X(0001).
  1639     05  ERRMSG1I PIC  X(0079).
  1640*    -------------------------------
  1641     05  ERRMSG2L PIC S9(0004) COMP.
  1642     05  ERRMSG2F PIC  X(0001).
  1643     05  FILLER REDEFINES ERRMSG2F.
  1644         10  ERRMSG2A PIC  X(0001).
  1645     05  ERRMSG2I PIC  X(0079).
  1646 01  EL691AO REDEFINES EL691AI.
  1647     05  FILLER            PIC  X(0012).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  RUNDTEO PIC  X(0008).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  RUNTIMEO PIC  99.99.
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  COMPANYO PIC  X(0003).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  USERIDO PIC  X(0004).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  CARRIERO PIC  X(0001).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  GROUPO PIC  X(0006).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  STATEO PIC  X(0002).
  1669*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  36
* EL691.cbl
  1670     05  FILLER            PIC  X(0003).
  1671     05  ACCTO PIC  X(0010).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  CERTO PIC  X(0010).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  SFXO PIC  X(0001).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  MAINTO PIC  X(0001).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  MAINTBYO PIC  X(0004).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  MAINTDTO PIC  99B99B99.
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  MAINTTMO PIC  99.99.
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  ARCHNOO PIC  X(0008).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  ENDARCHO PIC  X(0008).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  FORMNOO PIC  X(0004).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  RESFORMO PIC  X(0004).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  CREATDTO PIC  99B99B99.
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  RESENDO PIC  99B99B99.
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  CREATBYO PIC  X(0004).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  PRINTDTO PIC  99B99B99.
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  RESPRNTO PIC  99B99B99.
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  STCOMPO PIC  X(0019).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  REPLYO PIC  99B99B99.
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  STRECVO PIC  X(0019).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  37
* EL691.cbl
  1728     05  STOPDTEO PIC  99B99B99.
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  STSTOPO PIC  X(0019).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  FINDATEO PIC  99B99B99.
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  STFINLO PIC  X(0019).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  FINLACTO PIC  X(0001).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  COMMENTO PIC  X(0069).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  ERRMSG1O PIC  X(0079).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  ERRMSG2O PIC  X(0079).
  1750*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  38
* EL691.cbl
  1752****************************************************************
  1753*
  1754* Copyright (c) 2007 by Clerity Solutions, Inc.
  1755* All rights reserved.
  1756*
  1757****************************************************************
  1758 01  DFHEIV.
  1759   02  DFHEIV0               PIC X(35).
  1760   02  DFHEIV1               PIC X(08).
  1761   02  DFHEIV2               PIC X(08).
  1762   02  DFHEIV3               PIC X(08).
  1763   02  DFHEIV4               PIC X(06).
  1764   02  DFHEIV5               PIC X(04).
  1765   02  DFHEIV6               PIC X(04).
  1766   02  DFHEIV7               PIC X(02).
  1767   02  DFHEIV8               PIC X(02).
  1768   02  DFHEIV9               PIC X(01).
  1769   02  DFHEIV10              PIC S9(7) COMP-3.
  1770   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1771   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1772   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1773   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1774   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1775   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1776   02  DFHEIV17              PIC X(04).
  1777   02  DFHEIV18              PIC X(04).
  1778   02  DFHEIV19              PIC X(04).
  1779   02  DFHEIV20              USAGE IS POINTER.
  1780   02  DFHEIV21              USAGE IS POINTER.
  1781   02  DFHEIV22              USAGE IS POINTER.
  1782   02  DFHEIV23              USAGE IS POINTER.
  1783   02  DFHEIV24              USAGE IS POINTER.
  1784   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1785   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1786   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1787   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1788   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1789   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1790   02  FILLER                PIC X(02).
  1791   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1792   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1793   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1794   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1795   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1796 LINKAGE  SECTION.
  1797*****************************************************************
  1798*                                                               *
  1799* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1800* All rights reserved.                                          *
  1801*                                                               *
  1802*****************************************************************
  1803 01  dfheiblk.
  1804     02  eibtime          pic s9(7) comp-3.
  1805     02  eibdate          pic s9(7) comp-3.
  1806     02  eibtrnid         pic x(4).
  1807     02  eibtaskn         pic s9(7) comp-3.
  1808     02  eibtrmid         pic x(4).
  1809     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  39
* EL691.cbl
  1810     02  eibcposn         pic s9(4) comp.
  1811     02  eibcalen         pic s9(4) comp.
  1812     02  eibaid           pic x(1).
  1813     02  eibfiller1       pic x(1).
  1814     02  eibfn            pic x(2).
  1815     02  eibfiller2       pic x(2).
  1816     02  eibrcode         pic x(6).
  1817     02  eibfiller3       pic x(2).
  1818     02  eibds            pic x(8).
  1819     02  eibreqid         pic x(8).
  1820     02  eibrsrce         pic x(8).
  1821     02  eibsync          pic x(1).
  1822     02  eibfree          pic x(1).
  1823     02  eibrecv          pic x(1).
  1824     02  eibsend          pic x(1).
  1825     02  eibatt           pic x(1).
  1826     02  eibeoc           pic x(1).
  1827     02  eibfmh           pic x(1).
  1828     02  eibcompl         pic x(1).
  1829     02  eibsig           pic x(1).
  1830     02  eibconf          pic x(1).
  1831     02  eiberr           pic x(1).
  1832     02  eibrldbk         pic x(1).
  1833     02  eiberrcd         pic x(4).
  1834     02  eibsynrb         pic x(1).
  1835     02  eibnodat         pic x(1).
  1836     02  eibfiller5       pic x(2).
  1837     02  eibresp          pic 9(09) comp.
  1838     02  eibresp2         pic 9(09) comp.
  1839     02  dfheigdj         pic s9(4) comp.
  1840     02  dfheigdk         pic s9(4) comp.
  1841 01  DFHCOMMAREA                 PIC X(1024).
  1842
  1843*    COPY ERCARCH.
  1844******************************************************************
  1845*                                                                *
  1846*                            ERCARCH.                            *
  1847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1848*                            VMOD=2.002                          *
  1849*                                                                *
  1850*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1854*                                                                *
  1855*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1856*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1857*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1858*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1859*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1860*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1861*                                                                *
  1862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1863******************************************************************
  1864*                   C H A N G E   L O G
  1865*
  1866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1867*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  40
* EL691.cbl
  1868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1869* EFFECTIVE    NUMBER
  1870*-----------------------------------------------------------------
  1871* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1872* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1873* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1874******************************************************************
  1875 01  LETTER-ARCHIVE.
  1876     12  LA-RECORD-ID                PIC  X(02).
  1877         88  LA-VALID-ID                VALUE 'LA'.
  1878
  1879     12  LA-CONTROL-PRIMARY.
  1880         16  LA-COMPANY-CD           PIC  X(01).
  1881         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1882
  1883     12  LA-CONTROL-BY-CERT-RESP.
  1884         16  LA-COMPANY-CD-A2        PIC  X(01).
  1885         16  LA-CERT-NO-A2.
  1886             20  LA-CERT-PRIME-A2    PIC  X(10).
  1887             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1888         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1889             20  LA-RESP-PERSON-A2   PIC  X(10).
  1890             20  LA-TYPE-A2          PIC  X(01).
  1891         16  LA-CARRIER-A2           PIC  X(01).
  1892         16  LA-GROUPING-A2          PIC  X(06).
  1893         16  LA-STATE-A2             PIC  X(02).
  1894         16  LA-ACCOUNT-A2           PIC  X(10).
  1895         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1896         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1897
  1898     12  LA-CONTROL-BY-FORM.
  1899         16  LA-COMPANY-CD-A3        PIC  X(01).
  1900         16  LA-FORM-A3              PIC  X(04).
  1901         16  LA-CARRIER-A3           PIC  X(01).
  1902         16  LA-GROUPING-A3          PIC  X(06).
  1903         16  LA-STATE-A3             PIC  X(02).
  1904         16  LA-ACCOUNT-A3           PIC  X(10).
  1905         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1906
  1907     12  LA-CONTROL-BY-PROCESSOR.
  1908         16  LA-COMPANY-CD-A4        PIC  X(01).
  1909         16  LA-PROCESSOR-CD         PIC  X(04).
  1910         16  LA-CARRIER-A4           PIC  X(01).
  1911         16  LA-GROUPING-A4          PIC  X(06).
  1912         16  LA-STATE-A4             PIC  X(02).
  1913         16  LA-ACCOUNT-A4           PIC  X(10).
  1914         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1915
  1916     12  LA-CONTROL-BY-KEY-FIELDS.
  1917         16  LA-COMPANY-CD-A5        PIC  X(01).
  1918         16  LA-CARRIER-A5           PIC  X(01).
  1919         16  LA-GROUPING-A5          PIC  X(06).
  1920         16  LA-STATE-A5             PIC  X(02).
  1921         16  LA-ACCOUNT-A5           PIC  X(10).
  1922         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1923
  1924     12  LA-CONTROL-BY-GROUP-CODE.
  1925         16  LA-COMPANY-CD-A6        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  41
* EL691.cbl
  1926         16  LA-ENTRY-A6.
  1927             20  LA-FILLER           PIC  X(02).
  1928             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1929         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1930
  1931     12  FILLER                      PIC  X(09).
  1932
  1933     12  LA-HEADER-RECORD.
  1934         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1935         16  LA-CREATION-DATE        PIC  X(02).
  1936         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1937         16  LA-FINAL-ACT-DATE       REDEFINES
  1938               LA-FOLLOW-UP-DATE     PIC  X(02).
  1939         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1940         16  LA-NO-OF-COPIES         PIC S9(01).
  1941         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1942         16  LA-REPLY-DATE           PIC  X(02).
  1943         16  LA-RESEND-DATES.
  1944             20  LA-RESEND-DATE      PIC  X(02).
  1945             20  LA-SENT-DATE        PIC  X(02).
  1946             20  FILLER              PIC  X(08).
  1947         16  LA-SOURCE-INFORMATION.
  1948             20  LA-DATA-SOURCE      PIC  X(01).
  1949             20  LA-ADDR-SOURCE      PIC  X(01).
  1950         16  LA-STATUS               PIC  X(01).
  1951             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1952             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1953             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1954             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1955             88  LA-STATUS-PURGED         VALUE 'P'.
  1956             88  LA-STATUS-VOIDED         VALUE 'V'.
  1957         16  LA-LAST-RESENT-PRINT-DATE
  1958                                     PIC  X(02).
  1959         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1960             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1961                                          VALUE 'C'.
  1962             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1963                                          VALUE 'F'.
  1964             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1965                                          VALUE 'P'.
  1966         16  LA-PURGED-DATE          PIC  X(02).
  1967         16  LA-VOIDED-DATE          PIC  X(02).
  1968         16  LA-RESEND-LETR          PIC  X(4).
  1969         16  FILLER                  PIC  X(08).
  1970*        16  LA-RESEND-LETR-2        PIC  X(4).
  1971*        16  LA-RESEND-LETR-3        PIC  X(4).
  1972*        16  FILLER                  PIC  X(59).
  1973         16  LA-ARCHIVE-STATUS       PIC  X.
  1974             88  LA-TEMP                VALUE 'T'.
  1975             88  LA-QWS                 VALUE 'Q'.
  1976             88  LA-BATCH               VALUE 'B'.
  1977         16  LA-FINAL-ACT-IND        PIC  X(1).
  1978         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1979         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1980         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1981                                     PIC X(4).
  1982         16  FILLER                  PIC  X(42).
  1983*        16  FILLER                  PIC  X(71).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  42
* EL691.cbl
  1984         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1985         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1986         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1987                                     PIC  X(4).
  1988         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1989
  1990******************************************************************
  1991
  1992*    COPY ERCARCT.
  1993******************************************************************
  1994*                                                                *
  1995*                            ERCARCT.                            *
  1996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1997*                            VMOD=2.002                          *
  1998*                                                                *
  1999*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2000*                                                                *
  2001*   FILE TYPE = VSAM,KSDS                                        *
  2002*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2003*                                                                *
  2004*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2005*                                                                *
  2006*   LOG = NO                                                     *
  2007*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2008******************************************************************
  2009*                   C H A N G E   L O G
  2010*
  2011* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2012*-----------------------------------------------------------------
  2013*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2014* EFFECTIVE    NUMBER
  2015*-----------------------------------------------------------------
  2016* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2017******************************************************************
  2018 01  LETTER-ARCHIVE-TEXT.
  2019     12  LT-RECORD-ID                PIC  X(02).
  2020         88  LT-VALID-ID                VALUE 'LT'.
  2021
  2022     12  LT-CONTROL-PRIMARY.
  2023         16  LT-COMPANY-CD           PIC  X(01).
  2024         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2025         16  LT-RECORD-TYPE          PIC  X(01).
  2026             88  LT-ADDRESS-DATA        VALUE '1'.
  2027             88  LT-TEXT-DATA           VALUE '2'.
  2028             88  LT-COMMENT-DATA        VALUE '3'.
  2029         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2030
  2031     12  FILLER                      PIC  X(28).
  2032     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2033
  2034     12  LT-TEXT-RECORD.
  2035         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2036                            INDEXED BY LT-NDX.
  2037             20  LT-TEXT-LINE        PIC  X(70).
  2038             20  LT-SKIP-CONTROL     PIC  X(02).
  2039                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2040                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2041             20  FILLER              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  43
* EL691.cbl
  2042
  2043     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2044         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2045             20  LT-COMMENT-LINE     PIC X(69).
  2046             20  LT-COMMENT-CHG-DT   PIC X(02).
  2047             20  LT-COMMENT-CHG-BY   PIC X(04).
  2048             20  FILLER              PIC X(05).
  2049
  2050
  2051*    COPY ERCCNOT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ERCCNOT                             *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.003                          *
  2057*                                                                *
  2058*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  2059*                                                                *
  2060*        FILE TYPE= VSAM,KSDS                                    *
  2061*        RECORD SIZE = 150    RECFORM = FIXED                    *
  2062*                                                                *
  2063*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  2064*                                                                *
  2065*        LOG = YES                                               *
  2066*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2067*                                                                *
  2068******************************************************************
  2069*                   C H A N G E   L O G
  2070*
  2071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2072*-----------------------------------------------------------------
  2073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2074* EFFECTIVE    NUMBER
  2075*-----------------------------------------------------------------
  2076* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  2077******************************************************************
  2078
  2079 01  CERT-NOTE-FILE.
  2080     12  CZ-RECORD-ID                PIC  XX.
  2081         88  VALID-CZ-ID                  VALUE 'CZ'.
  2082
  2083     12  CZ-CONTROL-PRIMARY.
  2084         16  CZ-COMPANY-CD           PIC X.
  2085         16  CZ-CARRIER              PIC X.
  2086         16  CZ-GROUPING.
  2087             20 CZ-GROUPING-PREFIX   PIC XXX.
  2088             20 CZ-GROUPING-PRIME    PIC XXX.
  2089         16  CZ-STATE                PIC XX.
  2090         16  CZ-ACCOUNT.
  2091             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  2092             20 CZ-ACCOUNT-PRIME     PIC X(6).
  2093         16  CZ-CERT-EFF-DT          PIC XX.
  2094         16  CZ-CERT-NO.
  2095             20  CZ-CERT-PRIME       PIC X(10).
  2096             20  CZ-CERT-SFX         PIC X.
  2097         16  CZ-RECORD-TYPE          PIC X.
  2098             88  CERT-NOTE           VALUE '1'.
  2099             88  CLAIM-CERT-NOTE     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  44
* EL691.cbl
  2100         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  2101
  2102     12  CZ-LAST-MAINT-DT            PIC XX.
  2103     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2104     12  CZ-LAST-MAINT-USER          PIC X(4).
  2105
  2106     12  CZ-NOTE-INFORMATION.
  2107         16  CZ-NOTE                 PIC X(63).
  2108         16  FILLER                  PIC X(39).
  2109******************************************************************
  2110
  2111*    COPY ELCCERT.
  2112******************************************************************
  2113*                                                                *
  2114*                            ELCCERT.                            *
  2115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2116*                            VMOD=2.013                          *
  2117*                                                                *
  2118*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2119*                                                                *
  2120*   FILE TYPE = VSAM,KSDS                                        *
  2121*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2122*                                                                *
  2123*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2124*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2125*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2126*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2127*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2128*                                                                *
  2129*   LOG = YES                                                    *
  2130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2131******************************************************************
  2132*                   C H A N G E   L O G
  2133*
  2134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2135*-----------------------------------------------------------------
  2136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2137* EFFECTIVE    NUMBER
  2138*-----------------------------------------------------------------
  2139* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2140* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2141* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2142* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2143* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2144* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2145* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2146* 032612  CR2011110200001  PEMA  AHL CHANGES
  2147******************************************************************
  2148
  2149 01  CERTIFICATE-MASTER.
  2150     12  CM-RECORD-ID                      PIC XX.
  2151         88  VALID-CM-ID                      VALUE 'CM'.
  2152
  2153     12  CM-CONTROL-PRIMARY.
  2154         16  CM-COMPANY-CD                 PIC X.
  2155         16  CM-CARRIER                    PIC X.
  2156         16  CM-GROUPING.
  2157             20  CM-GROUPING-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  45
* EL691.cbl
  2158             20  CM-GROUPING-PRIME         PIC X(3).
  2159         16  CM-STATE                      PIC XX.
  2160         16  CM-ACCOUNT.
  2161             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2162             20  CM-ACCOUNT-PRIME          PIC X(6).
  2163         16  CM-CERT-EFF-DT                PIC XX.
  2164         16  CM-CERT-NO.
  2165             20  CM-CERT-PRIME             PIC X(10).
  2166             20  CM-CERT-SFX               PIC X.
  2167
  2168     12  CM-CONTROL-BY-NAME.
  2169         16  CM-COMPANY-CD-A1              PIC X.
  2170         16  CM-INSURED-LAST-NAME          PIC X(15).
  2171         16  CM-INSURED-INITIALS.
  2172             20  CM-INSURED-INITIAL1       PIC X.
  2173             20  CM-INSURED-INITIAL2       PIC X.
  2174
  2175     12  CM-CONTROL-BY-SSN.
  2176         16  CM-COMPANY-CD-A2              PIC X.
  2177         16  CM-SOC-SEC-NO.
  2178             20  CM-SSN-STATE              PIC XX.
  2179             20  CM-SSN-ACCOUNT            PIC X(6).
  2180             20  CM-SSN-LN3.
  2181                 25  CM-INSURED-INITIALS-A2.
  2182                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2183                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2184                 25 CM-PART-LAST-NAME-A2         PIC X.
  2185
  2186     12  CM-CONTROL-BY-CERT-NO.
  2187         16  CM-COMPANY-CD-A4              PIC X.
  2188         16  CM-CERT-NO-A4                 PIC X(11).
  2189
  2190     12  CM-CONTROL-BY-MEMB.
  2191         16  CM-COMPANY-CD-A5              PIC X.
  2192         16  CM-MEMBER-NO.
  2193             20  CM-MEMB-STATE             PIC XX.
  2194             20  CM-MEMB-ACCOUNT           PIC X(6).
  2195             20  CM-MEMB-LN4.
  2196                 25  CM-INSURED-INITIALS-A5.
  2197                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2198                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2199                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2200
  2201     12  CM-INSURED-PROFILE-DATA.
  2202         16  CM-INSURED-FIRST-NAME.
  2203             20  CM-INSURED-1ST-INIT       PIC X.
  2204             20  FILLER                    PIC X(9).
  2205         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2206         16  CM-INSURED-SEX                PIC X.
  2207             88  CM-SEX-MALE                  VALUE 'M'.
  2208             88  CM-SEX-FEMAL                 VALUE 'F'.
  2209         16  CM-INSURED-JOINT-AGE          PIC 99.
  2210         16  CM-JOINT-INSURED-NAME.
  2211             20  CM-JT-LAST-NAME           PIC X(15).
  2212             20  CM-JT-FIRST-NAME.
  2213                 24  CM-JT-1ST-INIT        PIC X.
  2214                 24  FILLER                PIC X(9).
  2215             20  CM-JT-INITIAL             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  46
* EL691.cbl
  2216
  2217     12  CM-LIFE-DATA.
  2218         16  CM-LF-BENEFIT-CD              PIC XX.
  2219         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2220         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2221         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2222         16  CM-LF-DEV-CODE                PIC XXX.
  2223         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2224         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2228         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2229         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2230         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2231         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2232         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2233         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2234         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2235         16  FILLER                        PIC XX.
  2236
  2237     12  CM-AH-DATA.
  2238         16  CM-AH-BENEFIT-CD              PIC XX.
  2239         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2240         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2241         16  CM-AH-DEV-CODE                PIC XXX.
  2242         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2243         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2246         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2247         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2248         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2249         16  CM-AH-PAID-THRU-DT            PIC XX.
  2250             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2251         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2252         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2253         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2254         16  FILLER                        PIC X.
  2255
  2256     12  CM-LOAN-INFORMATION.
  2257         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2258         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2259                                           PIC S9(5)V99  COMP-3.
  2260         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2261         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2262         16  CM-PAY-FREQUENCY              PIC S99.
  2263         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2264         16  CM-RATE-CLASS                 PIC XX.
  2265         16  CM-BENEFICIARY                PIC X(25).
  2266         16  CM-POLICY-FORM-NO             PIC X(12).
  2267         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2268         16  CM-LAST-ADD-ON-DT             PIC XX.
  2269         16  CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2271             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2272         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2273             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  47
* EL691.cbl
  2274             20  CM-RATE-CODE              PIC X(4).
  2275             20  FILLER                    PIC XX.
  2276         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2277             20  CM-LOAN-OFFICER           PIC X(5).
  2278             20  FILLER                    PIC XXX.
  2279         16  CM-CSR-CODE                   PIC XXX.
  2280         16  CM-UNDERWRITING-CODE          PIC X.
  2281             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2282         16  CM-POST-CARD-IND              PIC X.
  2283         16  CM-NH-INTERFACE-SW            PIC X.
  2284         16  CM-PREMIUM-TYPE               PIC X.
  2285             88  CM-SING-PRM                  VALUE '1'.
  2286             88  CM-O-B-COVERAGE              VALUE '2'.
  2287             88  CM-OPEN-END                  VALUE '3'.
  2288         16  CM-IND-GRP-TYPE               PIC X.
  2289             88  CM-INDIVIDUAL                VALUE 'I'.
  2290             88  CM-GROUP                     VALUE 'G'.
  2291         16  CM-SKIP-CODE                  PIC X.
  2292             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2293             88  SKIP-JULY                    VALUE '1'.
  2294             88  SKIP-AUGUST                  VALUE '2'.
  2295             88  SKIP-SEPTEMBER               VALUE '3'.
  2296             88  SKIP-JULY-AUG                VALUE '4'.
  2297             88  SKIP-AUG-SEPT                VALUE '5'.
  2298             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2299             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2300             88  SKIP-JUNE                    VALUE '8'.
  2301             88  SKIP-JUNE-JULY               VALUE '9'.
  2302             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2303             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2304         16  CM-PAYMENT-MODE               PIC X.
  2305             88  PAY-MONTHLY                  VALUE SPACE.
  2306             88  PAY-WEEKLY                   VALUE '1'.
  2307             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2308             88  PAY-BI-WEEKLY                VALUE '3'.
  2309             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2310         16  CM-LOAN-NUMBER                PIC X(8).
  2311         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2312         16  CM-OLD-LOF                    PIC XXX.
  2313*        16  CM-LOAN-OFFICER               PIC XXX.
  2314         16  CM-REIN-TABLE                 PIC XXX.
  2315         16  CM-SPECIAL-REIN-CODE          PIC X.
  2316         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2317         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2318         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2319
  2320     12  CM-STATUS-DATA.
  2321         16  CM-ENTRY-STATUS               PIC X.
  2322         16  CM-ENTRY-DT                   PIC XX.
  2323
  2324         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2325         16  CM-LF-CANCEL-DT               PIC XX.
  2326         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2327
  2328         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2329         16  CM-LF-DEATH-DT                PIC XX.
  2330         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2331
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  48
* EL691.cbl
  2332         16  CM-LF-CURRENT-STATUS          PIC X.
  2333             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2334                                                'M' '4' '5' '9'.
  2335             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2336             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2337             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2338             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2339             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2340             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2341             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2342             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2343             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2344             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2345             88  CM-LF-DECLINED               VALUE 'D'.
  2346             88  CM-LF-VOIDED                 VALUE 'V'.
  2347
  2348         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2349         16  CM-AH-CANCEL-DT               PIC XX.
  2350         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2351
  2352         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2353         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2354         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2355
  2356         16  CM-AH-CURRENT-STATUS          PIC X.
  2357             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2358                                                'M' '4' '5' '9'.
  2359             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2360             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2361             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2362             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2363             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2364             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2365             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2366             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2367             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2368             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2369             88  CM-AH-DECLINED               VALUE 'D'.
  2370             88  CM-AH-VOIDED                 VALUE 'V'.
  2371
  2372         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2373             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2374             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2375             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2376         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2377
  2378         16  CM-ENTRY-BATCH                PIC X(6).
  2379         16  CM-LF-EXIT-BATCH              PIC X(6).
  2380         16  CM-AH-EXIT-BATCH              PIC X(6).
  2381         16  CM-LAST-MONTH-END             PIC XX.
  2382
  2383     12  CM-NOTE-SW                        PIC X.
  2384         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2385         88  CERT-NOTES-PRESENT               VALUE '1'.
  2386         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2387         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2388         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2389         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  49
* EL691.cbl
  2390         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2391         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2392     12  CM-COMP-EXCP-SW                   PIC X.
  2393         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2394         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2395     12  CM-INSURED-ADDRESS-SW             PIC X.
  2396         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2397         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2398
  2399*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2400     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2401     12  FILLER                            PIC X.
  2402
  2403*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2404     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2405     12  FILLER                            PIC X.
  2406*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2407     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2408
  2409     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2410         88  CERT-ADDED-BATCH                 VALUE ' '.
  2411         88  CERT-ADDED-ONLINE                VALUE '1'.
  2412         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2413         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2414         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2415     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2416         88  CERT-AS-LOADED                   VALUE ' '.
  2417         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2418         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2419         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2420         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2421         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2422         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2423         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2424
  2425     12  CM-ACCOUNT-COMM-PCTS.
  2426         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2427         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2428
  2429     12  CM-USER-FIELD                     PIC X.
  2430     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2431     12  CM-CLP-STATE                      PIC XX.
  2432     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2433     12  CM-USER-RESERVED                  PIC XXX.
  2434     12  FILLER REDEFINES CM-USER-RESERVED.
  2435         16  CM-AH-CLASS-CD                PIC XX.
  2436         16  F                             PIC X.
  2437******************************************************************
  2438
  2439*    COPY ELCEOBC.
  2440******************************************************************
  2441*                                                                *
  2442*                                                                *
  2443*                            ELCEOBC                             *
  2444*                            VMOD=2.001                          *
  2445*                                                                *
  2446*   CLAIM SYSTEM EOB CODE TABLE                                  *
  2447*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  50
* EL691.cbl
  2448*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2449*   VSAM EOB CODE TABLE                                          *
  2450*                                                                *
  2451*   FILE DESCRIPTION = EOB CODE TABLE                            *
  2452*                                                                *
  2453*   FILE TYPE = VSAM,KSDS                                        *
  2454*   RECORD SIZE = 350   RECFORM = FIX                            *
  2455*                                                                *
  2456*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  2457*                                                                *
  2458*   LOG = NO                                                     *
  2459*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2460*                                                                *
  2461*                                                                *
  2462******************************************************************
  2463*                   C H A N G E   L O G
  2464*
  2465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2466*-----------------------------------------------------------------
  2467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2468* EFFECTIVE    NUMBER
  2469*-----------------------------------------------------------------
  2470* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  2471* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  2472******************************************************************
  2473 01  EOB-CODES.
  2474     12  EO-RECORD-ID                      PIC XX.
  2475         88  VALID-DN-ID                      VALUE 'EO'.
  2476     12  EO-CONTROL-PRIMARY.
  2477         16  EO-COMPANY-CD                 PIC X.
  2478         16  EO-RECORD-TYPE                PIC X.
  2479             88  EO-EOB-RECS                  VALUE '1'.
  2480             88  EO-VERIF-RECS                VALUE '2'.
  2481             88  EO-GCE-RECS                  VALUE '3'.
  2482         16  EO-EOB-CODE                   PIC X(4).
  2483         16  FILLER                        PIC X(9).
  2484     12  EO-MAINT-INFORMATION.
  2485         16  EO-LAST-MAINT-DT              PIC XX.
  2486         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2487         16  EO-LAST-MAINT-USER            PIC X(4).
  2488         16  FILLER                        PIC XX.
  2489     12  EO-DESCRIPTION                    PIC X(275).
  2490     12  FILLER                            PIC X(46).
  2491******************************************************************
  2492
  2493*    COPY ERCNOTE.
  2494******************************************************************
  2495*                                                                *
  2496*                                                                *
  2497*                            ERCNOTE                             *
  2498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2499*                            VMOD=2.003                          *
  2500*                                                                *
  2501*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2502*                                                                *
  2503*        FILE TYPE= VSAM,KSDS                                    *
  2504*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2505*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  51
* EL691.cbl
  2506*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2507*                                                                *
  2508*        LOG = YES                                               *
  2509*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2510*                                                                *
  2511******************************************************************
  2512*                   C H A N G E   L O G
  2513*
  2514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2515*-----------------------------------------------------------------
  2516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2517* EFFECTIVE    NUMBER
  2518*-----------------------------------------------------------------
  2519* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2520*                                FILE WILL CONTAIN BILLING NOTES O
  2521******************************************************************
  2522
  2523 01  CERTIFICATE-NOTE.
  2524     12  CN-RECORD-ID                PIC  XX.
  2525         88  VALID-CN-ID                  VALUE 'CN'.
  2526
  2527     12  CN-CONTROL-PRIMARY.
  2528         16  CN-COMPANY-CD           PIC X.
  2529         16  CN-CARRIER              PIC X.
  2530         16  CN-GROUPING.
  2531             20 CN-GROUPING-PREFIX   PIC XXX.
  2532             20 CN-GROUPING-PRIME    PIC XXX.
  2533         16  CN-STATE                PIC XX.
  2534         16  CN-ACCOUNT.
  2535             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2536             20 CN-ACCOUNT-PRIME     PIC X(6).
  2537         16  CN-CERT-EFF-DT          PIC XX.
  2538         16  CN-CERT-NO.
  2539             20  CN-CERT-PRIME       PIC X(10).
  2540             20  CN-CERT-SFX         PIC X.
  2541
  2542     12  CN-BILLING-START-LINE-NO    PIC 99.
  2543     12  CN-BILLING-END-LINE-NO      PIC 99.
  2544
  2545     12  CN-LINES.
  2546         16  CN-LINE OCCURS 10       PIC X(77).
  2547
  2548     12  CN-LAST-MAINT-DT            PIC XX.
  2549     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2550     12  CN-LAST-MAINT-USER          PIC X(4).
  2551     12  FILLER                      PIC X(6).
  2552******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  52
* EL691.cbl
  2554
  2555 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2556                          LETTER-ARCHIVE-TEXT CERT-NOTE-FILE
  2557                          CERTIFICATE-MASTER EOB-CODES
  2558                          CERTIFICATE-NOTE.
  2559 0000-DFHEXIT SECTION.
  2560     MOVE '9#                    $   ' TO DFHEIV0.
  2561     MOVE 'EL691' TO DFHEIV1.
  2562     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2563     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2564
  2565     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2566     MOVE '5'                    TO DC-OPTION-CODE.
  2567     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2568     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2569     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2570                                    W-CURRENT-SAVE.
  2571
  2572     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2573     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2574                                 TO EMI-SAVE-AREA.
  2575
  2576     IF  EIBCALEN EQUAL 0
  2577         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2578         GO TO 8300-SEND-TEXT
  2579     END-IF.
  2580
  2581     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2582         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2583             MOVE PI-SAVED-PROGRAM-5
  2584                                 TO PI-SAVED-PROGRAM-6
  2585             MOVE PI-SAVED-PROGRAM-4
  2586                                 TO PI-SAVED-PROGRAM-5
  2587             MOVE PI-SAVED-PROGRAM-3
  2588                                 TO PI-SAVED-PROGRAM-4
  2589             MOVE PI-SAVED-PROGRAM-2
  2590                                 TO PI-SAVED-PROGRAM-3
  2591             MOVE PI-SAVED-PROGRAM-1
  2592                                 TO PI-SAVED-PROGRAM-2
  2593             MOVE PI-RETURN-TO-PROGRAM
  2594                                 TO PI-SAVED-PROGRAM-1
  2595             MOVE PI-CALLING-PROGRAM
  2596                                 TO PI-RETURN-TO-PROGRAM
  2597             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2598         ELSE
  2599             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2600             MOVE PI-RETURN-TO-PROGRAM
  2601                                     TO PI-CALLING-PROGRAM
  2602             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2603             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2604             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2605             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2606             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2607             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2608             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2609         END-IF
  2610     ELSE
  2611         GO TO 0200-RECEIVE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  53
* EL691.cbl
  2612     END-IF.
  2613
  2614     GO TO 1000-SHOW.
  2615
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  54
* EL691.cbl
  2617
  2618 0200-RECEIVE.
  2619
  2620
  2621* EXEC CICS HANDLE AID
  2622*        CLEAR    (9300-DFHCLEAR)
  2623*        PA1      (9200-PA)
  2624*        PA2      (9200-PA)
  2625*        PA3      (9200-PA)
  2626*    END-EXEC.
  2627*    MOVE '"&=!"#               V! " #00002616' TO DFHEIV0
  2628     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2629     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2630     MOVE X'2220233030303032363136' TO DFHEIV0(25:11)
  2631     CALL 'kxdfhei1' USING DFHEIV0
  2632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2633
  2634
  2635
  2636* EXEC CICS HANDLE CONDITION
  2637*        PGMIDERR (9700-PGMID-ERROR)
  2638*        ERROR    (9800-ABEND)
  2639*    END-EXEC.
  2640*    MOVE '"$L.                  ! # #00002623' TO DFHEIV0
  2641     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2643     MOVE X'2320233030303032363233' TO DFHEIV0(25:11)
  2644     CALL 'kxdfhei1' USING DFHEIV0
  2645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2646
  2647
  2648
  2649* EXEC CICS RECEIVE
  2650*        MAP      (W-MAP)
  2651*        MAPSET   (W-MAPSET)
  2652*        INTO     (EL691AI)
  2653*    END-EXEC.
  2654     MOVE LENGTH OF
  2655      EL691AI
  2656       TO DFHEIV11
  2657*    MOVE '8"T I  L              ''   #00002628' TO DFHEIV0
  2658     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2660     MOVE X'2020233030303032363238' TO DFHEIV0(25:11)
  2661     CALL 'kxdfhei1' USING DFHEIV0,
  2662           W-MAP,
  2663           EL691AI,
  2664           DFHEIV11,
  2665           W-MAPSET,
  2666           DFHEIV99,
  2667           DFHEIV99
  2668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2669
  2670
  2671     IF  NOT DISPLAY-CAP
  2672         MOVE 'READ'             TO SM-READ
  2673         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2674         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  55
* EL691.cbl
  2675         MOVE -1                 TO MAINTL
  2676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2677         GO TO 8100-SEND-INITIAL-MAP
  2678     END-IF.
  2679
  2680
  2681 0300-CHECK-PFKEYS.
  2682
  2683     IF  EIBAID EQUAL DFHPF23
  2684         MOVE EIBAID             TO PI-ENTRY-CD-1
  2685         MOVE W-XCTL-005         TO W-CALL-PGM
  2686         GO TO 9400-XCTL
  2687     END-IF.
  2688
  2689     IF  EIBAID EQUAL DFHPF24
  2690         MOVE W-XCTL-626         TO W-CALL-PGM
  2691         GO TO 9400-XCTL
  2692     END-IF.
  2693
  2694     IF  EIBAID EQUAL DFHPF6
  2695         MOVE W-XCTL-1279        TO W-CALL-PGM
  2696         GO TO 9400-XCTL
  2697     END-IF
  2698
  2699     IF  MAINTI EQUAL 'C'  AND
  2700         EIBAID EQUAL DFHENTER
  2701          GO TO 0700-PROCESS-CHANGES
  2702     END-IF.
  2703
  2704     MOVE ER-0029                TO EMI-ERROR.
  2705
  2706
  2707 0320-INPUT-ERROR.
  2708
  2709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2710     MOVE -1                     TO  MAINTL.
  2711     GO TO 8200-SEND-DATAONLY.
  2712
  2713
  2714 0700-PROCESS-CHANGES.
  2715
  2716     IF  NOT MODIFY-CAP
  2717         MOVE 'UPDATE'           TO SM-READ
  2718         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2719         MOVE ER-0070            TO EMI-ERROR
  2720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2721         MOVE -1                 TO MAINTL
  2722         GO TO 8100-SEND-INITIAL-MAP
  2723     END-IF.
  2724
  2725     IF RESFORML > ZEROS
  2726        AND RESFORMI > SPACES
  2727        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  2728        MOVE RESFORMI            TO LETR-LETTER-ID
  2729        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  2730        MOVE SPACES              TO LETR-FILLER
  2731        MOVE 0                   TO LETR-SEQ-NO
  2732        PERFORM 1500-CHECK-Z-RECORD THRU 1500-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  56
* EL691.cbl
  2733        IF Z-RECORD-NOT-FOUND
  2734           MOVE ER-1236          TO EMI-ERROR
  2735           MOVE -1               TO RESFORML
  2736           MOVE AL-UABON         TO RESFORMA
  2737           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2738        END-IF
  2739     END-IF
  2740
  2741     MOVE 'N'                    TO W-NEED-COMMENT.
  2742
  2743     IF RESENDL GREATER ZERO
  2744         MOVE 'Y'                TO W-NEED-COMMENT
  2745         IF RESENDI = SPACES
  2746             MOVE AL-UANON       TO  RESENDA
  2747             MOVE +1             TO  W-UPDATE-SW
  2748             MOVE LOW-VALUES     TO  W-RESEND-DATE
  2749         ELSE
  2750             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2751             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2752             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2753                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2754                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2755                 MOVE '4'        TO  DC-OPTION-CODE
  2756                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2757                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2758                 IF DC-ERROR-CODE NOT = SPACES
  2759                     MOVE ER-0295         TO  EMI-ERROR
  2760                     MOVE -1              TO  RESENDL
  2761                     MOVE AL-UABON        TO  RESENDA
  2762                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2763                 ELSE
  2764                     MOVE AL-UANON       TO  RESENDA
  2765                     MOVE +1             TO  W-UPDATE-SW
  2766                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2767                 END-IF
  2768             ELSE
  2769                 MOVE ER-0295    TO  EMI-ERROR
  2770                 MOVE -1         TO  RESENDL
  2771                 MOVE AL-UABON   TO  RESENDA
  2772                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2773             END-IF
  2774         END-IF
  2775     END-IF.
  2776
  2777     IF FINDATEL GREATER ZERO
  2778         IF FINDATEI = SPACES
  2779             MOVE AL-UANON       TO  FINDATEA
  2780             MOVE +1             TO  W-UPDATE-SW
  2781             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  2782             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  2783         ELSE
  2784             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  2785             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  2786             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2787             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2788                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  2789                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  2790                 MOVE '4'                 TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  57
* EL691.cbl
  2791                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2792                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2793                 IF DC-ERROR-CODE NOT = SPACES
  2794                     MOVE ER-0296        TO  EMI-ERROR
  2795                     MOVE -1             TO  FINDATEL
  2796                     MOVE AL-UABON       TO  FINDATEA
  2797                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2798                 ELSE
  2799                     MOVE AL-UANON       TO  FINDATEA
  2800                     MOVE +1             TO  W-UPDATE-SW
  2801                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  2802                 END-IF
  2803             ELSE
  2804                 MOVE ER-0296    TO  EMI-ERROR
  2805                 MOVE -1         TO  FINDATEL
  2806                 MOVE AL-UABON   TO  FINDATEA
  2807                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2808             END-IF
  2809         END-IF
  2810     END-IF.
  2811
  2812     IF REPLYL GREATER ZERO
  2813         IF REPLYI = SPACES
  2814             MOVE AL-UANON       TO  REPLYA
  2815             MOVE +1             TO  W-UPDATE-SW
  2816             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  2817             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  2818                                     WS-RECEIVED-NOTE
  2819             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  2820         ELSE
  2821             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  2822             MOVE REPLYI         TO  W-DEEDIT-FIELD
  2823             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2824             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2825                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  2826                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  2827                 MOVE '4'        TO  DC-OPTION-CODE
  2828                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  2829                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2830                 IF DC-ERROR-CODE NOT = SPACES
  2831                     MOVE ER-9245        TO  EMI-ERROR
  2832                     MOVE -1             TO  REPLYL
  2833                     MOVE AL-UABON       TO  REPLYA
  2834                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2835                 ELSE
  2836                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2837                       MOVE ER-0539      TO  EMI-ERROR
  2838                       MOVE -1           TO  REPLYL
  2839                       MOVE AL-UABON     TO  REPLYA
  2840                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2841                   ELSE
  2842                       MOVE AL-UANON     TO  REPLYA
  2843                       MOVE +1           TO  W-UPDATE-SW
  2844                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  2845                       MOVE DC-GREG-DATE-1-EDIT TO
  2846                                        W-CERT-NOTE-RECV-DT
  2847                                        WS-BN-RECV-DATE
  2848                   END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  58
* EL691.cbl
  2849                 END-IF
  2850             ELSE
  2851                 MOVE ER-9245    TO  EMI-ERROR
  2852                 MOVE -1         TO  REPLYL
  2853                 MOVE AL-UABON   TO  REPLYA
  2854                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2855             END-IF
  2856         END-IF
  2857     END-IF.
  2858
  2859     IF STOPDTEL GREATER ZERO
  2860         IF STOPDTEI = SPACES
  2861             MOVE AL-UANON       TO  STOPDTEA
  2862             MOVE +1             TO  W-UPDATE-SW
  2863             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  2864             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  2865             MOVE AL-UANOF       TO  RESENDA
  2866                                     RESFORMA
  2867                                     FINDATEA
  2868                                     FINLACTA
  2869                                     REPLYA
  2870                                     COMMENTA
  2871         ELSE
  2872             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  2873             MOVE 'Y'            TO  W-NEED-COMMENT
  2874             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  2875             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2876             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2877                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  2878                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  2879                 MOVE '4'        TO  DC-OPTION-CODE
  2880                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2881                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2882                 IF DC-ERROR-CODE NOT = SPACES
  2883                     MOVE ER-0897         TO  EMI-ERROR
  2884                     MOVE -1              TO  STOPDTEL
  2885                     MOVE AL-UABON        TO  STOPDTEA
  2886                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2887                 ELSE
  2888                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2889                       MOVE ER-0895      TO  EMI-ERROR
  2890                       MOVE -1           TO  STOPDTEL
  2891                       MOVE AL-UABON     TO  STOPDTEA
  2892                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2893                   ELSE
  2894                     MOVE AL-UANON       TO  STOPDTEA
  2895                     MOVE +1             TO  W-UPDATE-SW
  2896                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  2897                   END-IF
  2898                 END-IF
  2899             ELSE
  2900                 MOVE ER-0897    TO  EMI-ERROR
  2901                 MOVE -1         TO  STOPDTEL
  2902                 MOVE AL-UABON   TO  STOPDTEA
  2903                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2904             END-IF
  2905         END-IF
  2906     END-IF.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  59
* EL691.cbl
  2907
  2908     IF W-NEED-COMMENT = 'Y'  AND
  2909        COMMENTL NOT > ZERO
  2910           MOVE -1         TO  COMMENTL
  2911           MOVE ER-7363    TO  EMI-ERROR
  2912           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2913     END-IF.
  2914
  2915     IF COMMENTL GREATER ZERO
  2916      OR  RESFORML GREATER ZERO
  2917      OR  FINLACTL GREATER ZERO
  2918         MOVE +1          TO  W-UPDATE-SW
  2919     END-IF.
  2920
  2921     IF W-ERROR-COUNT GREATER ZERO
  2922         GO TO 8200-SEND-DATAONLY
  2923     END-IF.
  2924
  2925     IF W-UPDATE-SW NOT GREATER ZERO
  2926         MOVE ER-3112    TO  EMI-ERROR
  2927         MOVE -1         TO  MAINTL
  2928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2929         GO TO 8200-SEND-DATAONLY
  2930     END-IF.
  2931
  2932     IF PI-ARCHIVE-STOPPED = 'Y'
  2933        MOVE AL-SANOF       TO RESENDA
  2934                               RESFORMA
  2935                               FINDATEA
  2936                               FINLACTA
  2937                               REPLYA
  2938                               COMMENTA
  2939     END-IF.
  2940
  2941     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  2942
  2943     IF RESENDL GREATER ZERO
  2944         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  2945     END-IF.
  2946
  2947     IF FINDATEL GREATER ZERO
  2948         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  2949     END-IF.
  2950
  2951     IF REPLYL GREATER ZERO
  2952         MOVE W-RECEIVED-DATE    TO  LA-REPLY-DATE
  2953         IF W-RECEIVED-DATE NOT EQUAL LOW-VALUES
  2954             PERFORM 4000-ADD-CERT-NOTE THRU 4099-EXIT
  2955             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  2956         END-IF
  2957     END-IF.
  2958
  2959     IF RESFORML GREATER ZERO
  2960        MOVE RESFORMI            TO  LA-RESEND-LETR
  2961     END-IF.
  2962
  2963     IF FINLACTL GREATER ZERO
  2964        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  60
* EL691.cbl
  2965     END-IF.
  2966
  2967     IF STOPDTEL GREATER ZERO
  2968        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  2969     END-IF.
  2970
  2971     PERFORM 3100-REWRITE THRU 3100-EXIT.
  2972
  2973     IF COMMENTL NOT GREATER ZERO
  2974
  2975         MOVE ER-0000            TO  EMI-ERROR
  2976         MOVE ' '                TO  MAINTO
  2977         MOVE -1                 TO  MAINTL
  2978         MOVE AL-UANOF           TO  MAINTA
  2979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2980         GO TO 1000-SHOW
  2981     END-IF.
  2982
  2983     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  2984
  2985     IF PI-COMMENT-INDEX EQUAL +20
  2986         MOVE ER-0051    TO  EMI-ERROR
  2987         MOVE -1         TO  MAINTL
  2988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2989         GO TO 8200-SEND-DATAONLY
  2990     END-IF
  2991
  2992     SET PI-COMMENT-INDEX UP BY +1.
  2993     SET LC-NDX TO PI-COMMENT-INDEX.
  2994     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX).
  2995     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  2996     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  2997     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  2998
  2999
  3000     IF W-ADD-ARCT = 'N'
  3001         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  3002     ELSE
  3003         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  3004     END-IF.
  3005
  3006
  3007     MOVE ER-0000                TO  EMI-ERROR.
  3008     MOVE ' '                    TO  MAINTO.
  3009     MOVE -1                     TO  MAINTL.
  3010     MOVE AL-UANOF               TO  MAINTA.
  3011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3012     GO TO 1000-SHOW.
  3013
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  61
* EL691.cbl
  3015
  3016 1000-SHOW.
  3017***************************************************************
  3018*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  3019*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  3020***************************************************************
  3021     MOVE LOW-VALUES              TO W-ARCT-KEY.
  3022     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  3023                                     W-ARCT-COMPANY-CD.
  3024     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  3025                                     W-ARCT-ARCHIVE-NO.
  3026     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  3027     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  3028
  3029
  3030* EXEC CICS HANDLE CONDITION
  3031*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3032*         NOTFND     (1070-ARCH-NOT-FOUND)
  3033*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3034*    END-EXEC.
  3035*    MOVE '"$JI''                 ! $ #00002992' TO DFHEIV0
  3036     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3038     MOVE X'2420233030303032393932' TO DFHEIV0(25:11)
  3039     CALL 'kxdfhei1' USING DFHEIV0
  3040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3041
  3042
  3043
  3044* EXEC CICS READ
  3045*        DATASET (W-ARCH-FILE-ID)
  3046*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3047*        RIDFLD  (W-ARCH-KEY)
  3048*    END-EXEC.
  3049*    MOVE '&"S        E          (   #00002998' TO DFHEIV0
  3050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3052     MOVE X'2020233030303032393938' TO DFHEIV0(25:11)
  3053     CALL 'kxdfhei1' USING DFHEIV0,
  3054           W-ARCH-FILE-ID,
  3055           DFHEIV20,
  3056           DFHEIV99,
  3057           W-ARCH-KEY,
  3058           DFHEIV99,
  3059           DFHEIV99,
  3060           DFHEIV99
  3061     SET ADDRESS OF LETTER-ARCHIVE TO
  3062         DFHEIV20
  3063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3064
  3065
  3066     MOVE LA-FORM-A3             TO FORMNOO.
  3067     MOVE LA-FORM-A3             TO PI-ARCHIVE-LTRID
  3068     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  3069     MOVE LA-CARRIER-A2          TO CARRIERO.
  3070     MOVE LA-GROUPING-A2         TO GROUPO.
  3071     MOVE LA-STATE-A2            TO STATEO.
  3072     MOVE LA-ACCOUNT-A2          TO ACCTO.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  62
* EL691.cbl
  3073     MOVE LA-CERT-PRIME-A2       TO CERTO.
  3074     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  3075
  3076     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  3077          MOVE SPACES            TO ENDARCHO
  3078     ELSE
  3079          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  3080     END-IF
  3081
  3082     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  3083         MOVE SPACES             TO CREATDTI
  3084     ELSE
  3085         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  3086         MOVE ' '                TO DC-OPTION-CODE
  3087         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3088         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  3089     END-IF.
  3090
  3091     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  3092
  3093     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  3094         MOVE SPACES             TO PRINTDTI
  3095     ELSE
  3096         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  3097         MOVE ' '                TO DC-OPTION-CODE
  3098         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3099         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  3100     END-IF.
  3101
  3102     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  3103         MOVE SPACES             TO RESENDI
  3104     ELSE
  3105         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  3106         MOVE ' '                TO DC-OPTION-CODE
  3107         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3108         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  3109     END-IF.
  3110
  3111     MOVE LA-RESEND-LETR         TO RESFORMI.
  3112
  3113     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  3114         MOVE SPACES             TO RESPRNTI
  3115         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  3116     ELSE
  3117         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  3118         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  3119         MOVE ' '                TO DC-OPTION-CODE
  3120         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3121         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  3122     END-IF.
  3123
  3124     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  3125         MOVE SPACES             TO FINDATEI
  3126         MOVE SPACES             TO PI-ARCHIVE-FINAL
  3127     ELSE
  3128         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  3129         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  3130         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  63
* EL691.cbl
  3131         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3132         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  3133     END-IF.
  3134
  3135     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  3136
  3137     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  3138         MOVE SPACES             TO REPLYI
  3139         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  3140     ELSE
  3141         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  3142         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  3143         MOVE ' '                TO DC-OPTION-CODE
  3144         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3145         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  3146     END-IF.
  3147
  3148     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  3149         MOVE SPACES             TO STOPDTEI
  3150         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  3151     ELSE
  3152         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  3153         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  3154         MOVE ' '                TO DC-OPTION-CODE
  3155         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3156         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  3157     END-IF.
  3158
  3159     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  3160         MOVE SPACES             TO MAINTDTI
  3161     ELSE
  3162         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  3163         MOVE ' '                TO DC-OPTION-CODE
  3164         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3165         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  3166     END-IF.
  3167
  3168     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  3169         MOVE ZEROES             TO MAINTTMO
  3170     ELSE
  3171         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  3172         MOVE W-TIME-OUT         TO MAINTTMO
  3173     END-IF.
  3174
  3175     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  3176
  3177     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  3178       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
  3179          MOVE AL-SANOF          TO RESENDA
  3180                                    RESFORMA
  3181                                    FINDATEA
  3182                                    FINLACTA
  3183                                    REPLYA
  3184                                    COMMENTA
  3185     END-IF.
  3186
  3187     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  3188         MOVE AL-SANOF           TO STOPDTEA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  64
* EL691.cbl
  3189     END-IF.
  3190
  3191
  3192* EXEC CICS HANDLE CONDITION
  3193*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  3194*         NOTFND     (1000-ARCT-NOT-FOUND)
  3195*         ENDFILE    (1000-ARCT-NOT-FOUND)
  3196*    END-EXEC.
  3197*    MOVE '"$JI''                 ! % #00003129' TO DFHEIV0
  3198     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3200     MOVE X'2520233030303033313239' TO DFHEIV0(25:11)
  3201     CALL 'kxdfhei1' USING DFHEIV0
  3202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3203
  3204
  3205
  3206* EXEC CICS READ
  3207*        DATASET  (W-ARCT-FILE-ID)
  3208*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3209*        RIDFLD   (W-ARCT-KEY)
  3210*    END-EXEC.
  3211*    MOVE '&"S        E          (   #00003135' TO DFHEIV0
  3212     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3214     MOVE X'2020233030303033313335' TO DFHEIV0(25:11)
  3215     CALL 'kxdfhei1' USING DFHEIV0,
  3216           W-ARCT-FILE-ID,
  3217           DFHEIV20,
  3218           DFHEIV99,
  3219           W-ARCT-KEY,
  3220           DFHEIV99,
  3221           DFHEIV99,
  3222           DFHEIV99
  3223     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3224         DFHEIV20
  3225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3226
  3227
  3228     SET LC-NDX TO W-ZEROS.
  3229     PERFORM 20 TIMES
  3230         SET LC-NDX UP BY +1
  3231         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  3232             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  3233             SET PI-COMMENT-INDEX TO LC-NDX
  3234         END-IF
  3235     END-PERFORM.
  3236
  3237     MOVE -1                     TO MAINTL.
  3238     GO TO 8100-SEND-INITIAL-MAP.
  3239
  3240 1000-ARCT-NOT-FOUND.
  3241
  3242     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3243     MOVE -1                     TO MAINTL.
  3244     GO TO 8100-SEND-INITIAL-MAP.
  3245
  3246 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  65
* EL691.cbl
  3247     EXIT.
  3248
  3249
  3250 1070-ARCH-NOT-FOUND.
  3251
  3252     MOVE ER-7371                TO EMI-ERROR.
  3253     MOVE -1                     TO ARCHNOL.
  3254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3255     GO TO 8100-SEND-INITIAL-MAP.
  3256
  3257
  3258 1500-CHECK-Z-RECORD.
  3259
  3260     MOVE 'N' TO WS-Z-RECORD-IND
  3261
  3262
  3263* EXEC CICS STARTBR
  3264*         DATASET    ('ELLETR')
  3265*         RIDFLD     (ELLETR-KEY)
  3266*         GTEQ
  3267*         RESP      (W-RESPONSE)
  3268*    END-EXEC.
  3269     MOVE 'ELLETR' TO DFHEIV1
  3270     MOVE 0
  3271       TO DFHEIV11
  3272*    MOVE '&,         G          &  N#00003175' TO DFHEIV0
  3273     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3275     MOVE X'204E233030303033313735' TO DFHEIV0(25:11)
  3276     CALL 'kxdfhei1' USING DFHEIV0,
  3277           DFHEIV1,
  3278           ELLETR-KEY,
  3279           DFHEIV99,
  3280           DFHEIV11,
  3281           DFHEIV99
  3282     MOVE EIBRESP  TO W-RESPONSE
  3283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3284
  3285     IF NOT RESP-NORMAL
  3286         GO TO 1500-ENDBR
  3287     END-IF.
  3288
  3289 1500-READNEXT.
  3290
  3291
  3292* EXEC CICS READNEXT
  3293*        DATASET   ('ELLETR')
  3294*        INTO      (TEXT-FILES)
  3295*        RIDFLD    (ELLETR-KEY)
  3296*        RESP      (W-RESPONSE)
  3297*    END-EXEC
  3298     MOVE LENGTH OF
  3299      TEXT-FILES
  3300       TO DFHEIV12
  3301     MOVE 'ELLETR' TO DFHEIV1
  3302     MOVE 0
  3303       TO DFHEIV11
  3304*    MOVE '&.IL                  )  N#00003187' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  66
* EL691.cbl
  3305     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3306     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3307     MOVE X'204E233030303033313837' TO DFHEIV0(25:11)
  3308     CALL 'kxdfhei1' USING DFHEIV0,
  3309           DFHEIV1,
  3310           TEXT-FILES,
  3311           DFHEIV12,
  3312           ELLETR-KEY,
  3313           DFHEIV99,
  3314           DFHEIV11,
  3315           DFHEIV99,
  3316           DFHEIV99
  3317     MOVE EIBRESP  TO W-RESPONSE
  3318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3319     IF RESP-NORMAL
  3320        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  3321           GO TO 1500-ENDBR
  3322        END-IF
  3323
  3324        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  3325           MOVE 'Y' TO WS-Z-RECORD-IND
  3326           GO TO 1500-ENDBR
  3327        ELSE
  3328           GO TO 1500-READNEXT
  3329        END-IF
  3330     ELSE
  3331        GO TO 1500-ENDBR
  3332     END-IF.
  3333
  3334 1500-ENDBR.
  3335
  3336
  3337* EXEC CICS ENDBR
  3338*        DATASET     ('ELLETR')
  3339*    END-EXEC.
  3340     MOVE 'ELLETR' TO DFHEIV1
  3341     MOVE 0
  3342       TO DFHEIV11
  3343*    MOVE '&2                    $   #00003210' TO DFHEIV0
  3344     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3346     MOVE X'2020233030303033323130' TO DFHEIV0(25:11)
  3347     CALL 'kxdfhei1' USING DFHEIV0,
  3348           DFHEIV1,
  3349           DFHEIV11,
  3350           DFHEIV99
  3351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3352
  3353
  3354 1500-EXIT.
  3355      EXIT.
  3356
  3357
  3358 3000-READ-FOR-UPDATE SECTION.
  3359
  3360
  3361* EXEC CICS HANDLE CONDITION
  3362*         NOTOPEN    (8010-ARCH-NOT-OPEN)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  67
* EL691.cbl
  3363*         NOTFND     (1070-ARCH-NOT-FOUND)
  3364*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3365*    END-EXEC.
  3366*    MOVE '"$JI''                 ! & #00003220' TO DFHEIV0
  3367     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3369     MOVE X'2620233030303033323230' TO DFHEIV0(25:11)
  3370     CALL 'kxdfhei1' USING DFHEIV0
  3371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3372
  3373
  3374     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  3375     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  3376
  3377
  3378* EXEC CICS READ
  3379*        DATASET (W-ARCH-FILE-ID)
  3380*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3381*        RIDFLD  (W-ARCH-KEY)
  3382*        UPDATE
  3383*    END-EXEC.
  3384*    MOVE '&"S        EU         (   #00003229' TO DFHEIV0
  3385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3386     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3387     MOVE X'2020233030303033323239' TO DFHEIV0(25:11)
  3388     CALL 'kxdfhei1' USING DFHEIV0,
  3389           W-ARCH-FILE-ID,
  3390           DFHEIV20,
  3391           DFHEIV99,
  3392           W-ARCH-KEY,
  3393           DFHEIV99,
  3394           DFHEIV99,
  3395           DFHEIV99
  3396     SET ADDRESS OF LETTER-ARCHIVE TO
  3397         DFHEIV20
  3398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3399
  3400
  3401 3000-EXIT.
  3402     EXIT.
  3403
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  68
* EL691.cbl
  3405
  3406 3100-REWRITE SECTION.
  3407
  3408     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3409                                     MAINTBYI.
  3410     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3411     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3412
  3413     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3414                                     W-TIME-IN.
  3415     MOVE W-TIME-OUT             TO  MAINTTMO.
  3416
  3417
  3418* EXEC CICS REWRITE
  3419*        DATASET (W-ARCH-FILE-ID)
  3420*        FROM    (LETTER-ARCHIVE)
  3421*    END-EXEC.
  3422     MOVE LENGTH OF
  3423      LETTER-ARCHIVE
  3424       TO DFHEIV11
  3425*    MOVE '&& L                  %   #00003252' TO DFHEIV0
  3426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3428     MOVE X'2020233030303033323532' TO DFHEIV0(25:11)
  3429     CALL 'kxdfhei1' USING DFHEIV0,
  3430           W-ARCH-FILE-ID,
  3431           LETTER-ARCHIVE,
  3432           DFHEIV11,
  3433           DFHEIV99
  3434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3435
  3436
  3437 3100-EXIT.
  3438     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  69
* EL691.cbl
  3440 3200-READ-ARCT-FOR-UPDATE  SECTION.
  3441
  3442
  3443* EXEC CICS HANDLE CONDITION
  3444*         NOTFND     (3200-NOT-FOUND)
  3445*         ENDFILE    (3200-NOT-FOUND)
  3446*    END-EXEC.
  3447*    MOVE '"$I''                  ! '' #00003262' TO DFHEIV0
  3448     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3450     MOVE X'2720233030303033323632' TO DFHEIV0(25:11)
  3451     CALL 'kxdfhei1' USING DFHEIV0
  3452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3453
  3454
  3455     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  3456     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  3457     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  3458     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  3459
  3460
  3461* EXEC CICS READ
  3462*        DATASET  (W-ARCT-FILE-ID)
  3463*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3464*        RIDFLD   (W-ARCT-KEY)
  3465*        UPDATE
  3466*    END-EXEC.
  3467*    MOVE '&"S        EU         (   #00003272' TO DFHEIV0
  3468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3470     MOVE X'2020233030303033323732' TO DFHEIV0(25:11)
  3471     CALL 'kxdfhei1' USING DFHEIV0,
  3472           W-ARCT-FILE-ID,
  3473           DFHEIV20,
  3474           DFHEIV99,
  3475           W-ARCT-KEY,
  3476           DFHEIV99,
  3477           DFHEIV99,
  3478           DFHEIV99
  3479     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3480         DFHEIV20
  3481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3482
  3483
  3484     MOVE 'N' TO W-ADD-ARCT.
  3485     GO TO 3200-EXIT.
  3486
  3487 3200-NOT-FOUND.
  3488
  3489
  3490* EXEC CICS GETMAIN
  3491*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3492*         LENGTH   (W-ARCT-LENGTH)
  3493*    END-EXEC.
  3494*    MOVE '," L                  $   #00003284' TO DFHEIV0
  3495     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3497     MOVE X'2020233030303033323834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  70
* EL691.cbl
  3498     CALL 'kxdfhei1' USING DFHEIV0,
  3499           DFHEIV20,
  3500           W-ARCT-LENGTH,
  3501           DFHEIV99
  3502     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3503         DFHEIV20
  3504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3505
  3506
  3507     MOVE 'Y'                    TO W-ADD-ARCT.
  3508     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  3509     MOVE 'LT'                   TO LT-RECORD-ID.
  3510     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  3511     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  3512     MOVE '3'                    TO LT-RECORD-TYPE.
  3513     MOVE +0                     TO LT-LINE-SEQ-NO.
  3514     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  3515     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3516
  3517 3200-EXIT.
  3518     EXIT.
  3519
  3520 3300-REWRITE-ARCT SECTION.
  3521
  3522
  3523* EXEC CICS REWRITE
  3524*        DATASET (W-ARCT-FILE-ID)
  3525*        FROM    (LETTER-ARCHIVE-TEXT)
  3526*    END-EXEC.
  3527     MOVE LENGTH OF
  3528      LETTER-ARCHIVE-TEXT
  3529       TO DFHEIV11
  3530*    MOVE '&& L                  %   #00003304' TO DFHEIV0
  3531     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3532     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3533     MOVE X'2020233030303033333034' TO DFHEIV0(25:11)
  3534     CALL 'kxdfhei1' USING DFHEIV0,
  3535           W-ARCT-FILE-ID,
  3536           LETTER-ARCHIVE-TEXT,
  3537           DFHEIV11,
  3538           DFHEIV99
  3539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3540
  3541
  3542 3300-EXIT.
  3543     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  71
* EL691.cbl
  3545
  3546 3350-INSERT-ARCT SECTION.
  3547
  3548* EXEC CICS WRITE
  3549*         DATASET   (W-ARCT-FILE-ID)
  3550*         FROM      (LETTER-ARCHIVE-TEXT)
  3551*         RIDFLD    (LT-CONTROL-PRIMARY)
  3552*    END-EXEC.
  3553     MOVE LENGTH OF
  3554      LETTER-ARCHIVE-TEXT
  3555       TO DFHEIV11
  3556*    MOVE '&$ L                  ''   #00003314' TO DFHEIV0
  3557     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3558     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3559     MOVE X'2020233030303033333134' TO DFHEIV0(25:11)
  3560     CALL 'kxdfhei1' USING DFHEIV0,
  3561           W-ARCT-FILE-ID,
  3562           LETTER-ARCHIVE-TEXT,
  3563           DFHEIV11,
  3564           LT-CONTROL-PRIMARY,
  3565           DFHEIV99,
  3566           DFHEIV99
  3567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3568
  3569
  3570 3350-EXIT.
  3571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  72
* EL691.cbl
  3573
  3574
  3575 4000-ADD-CERT-NOTE  SECTION.
  3576
  3577     MOVE SPACES                 TO  ERCNOT-KEY
  3578                                     ELCERT-KEY.
  3579
  3580     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  3581                                     ELCERT-COMPANY-CD.
  3582     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  3583                                     ELCERT-CARRIER.
  3584     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  3585                                     ELCERT-GROUPING.
  3586     MOVE PI-STATE               TO  ERCNOT-STATE
  3587                                     ELCERT-STATE.
  3588     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  3589                                     ELCERT-ACCOUNT.
  3590     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  3591                                     ELCERT-EFF-DT.
  3592     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  3593                                     ELCERT-CERT-PRIME.
  3594     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  3595                                     ELCERT-CERT-SFX.
  3596     MOVE '1'                    TO  ERCNOT-REC-TYP
  3597     MOVE ZEROS                  TO  ERCNOT-SEQ.
  3598     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  3599
  3600
  3601
  3602* EXEC CICS HANDLE CONDITION
  3603*         NOTFND(4010-ENDBR)
  3604*         ENDFILE(4010-ENDBR)
  3605*    END-EXEC.
  3606*    MOVE '"$I''                  ! ( #00003351' TO DFHEIV0
  3607     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3609     MOVE X'2820233030303033333531' TO DFHEIV0(25:11)
  3610     CALL 'kxdfhei1' USING DFHEIV0
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3612
  3613
  3614
  3615* EXEC CICS STARTBR
  3616*         DATASET(ERCNOT-FILE-ID)
  3617*         RIDFLD(ERCNOT-KEY)
  3618*         KEYLENGTH(ERCNOT-START-LENGTH)
  3619*         GENERIC
  3620*         GTEQ
  3621*    END-EXEC.
  3622     MOVE 0
  3623       TO DFHEIV11
  3624*    MOVE '&,   KG    G          &   #00003356' TO DFHEIV0
  3625     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3626     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3627     MOVE X'2020233030303033333536' TO DFHEIV0(25:11)
  3628     CALL 'kxdfhei1' USING DFHEIV0,
  3629           ERCNOT-FILE-ID,
  3630           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  73
* EL691.cbl
  3631           ERCNOT-START-LENGTH,
  3632           DFHEIV11,
  3633           DFHEIV99
  3634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3635
  3636
  3637 4001-LOOP.
  3638
  3639* EXEC CICS READNEXT
  3640*         SET(ADDRESS OF CERT-NOTE-FILE)
  3641*         DATASET(ERCNOT-FILE-ID)
  3642*         RIDFLD(ERCNOT-KEY)
  3643*    END-EXEC.
  3644     MOVE 0
  3645       TO DFHEIV11
  3646*    MOVE '&.S                   )   #00003365' TO DFHEIV0
  3647     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3648     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3649     MOVE X'2020233030303033333635' TO DFHEIV0(25:11)
  3650     CALL 'kxdfhei1' USING DFHEIV0,
  3651           ERCNOT-FILE-ID,
  3652           DFHEIV20,
  3653           DFHEIV99,
  3654           ERCNOT-KEY,
  3655           DFHEIV99,
  3656           DFHEIV11,
  3657           DFHEIV99,
  3658           DFHEIV99
  3659     SET ADDRESS OF CERT-NOTE-FILE TO
  3660         DFHEIV20
  3661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3662
  3663
  3664     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3665         GO TO 4010-ENDBR
  3666     END-IF.
  3667
  3668     IF (CZ-CARRIER = SV-CARRIER)
  3669        AND (CZ-GROUPING = SV-GROUPING)
  3670        AND (CZ-STATE = SV-STATE)
  3671        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3672        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3673        AND (CZ-CERT-NO = SV-CERT-NO)
  3674        AND (CZ-RECORD-TYPE = SV-REC-TYP)
  3675          MOVE CZ-NOTE-SEQUENCE TO SV-NOTE-SEQUENCE
  3676          GO TO 4001-LOOP
  3677     END-IF.
  3678
  3679 4010-ENDBR.
  3680
  3681
  3682* EXEC CICS ENDBR
  3683*         DATASET(ERCNOT-FILE-ID)
  3684*    END-EXEC.
  3685     MOVE 0
  3686       TO DFHEIV11
  3687*    MOVE '&2                    $   #00003388' TO DFHEIV0
  3688     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  74
* EL691.cbl
  3689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3690     MOVE X'2020233030303033333838' TO DFHEIV0(25:11)
  3691     CALL 'kxdfhei1' USING DFHEIV0,
  3692           ERCNOT-FILE-ID,
  3693           DFHEIV11,
  3694           DFHEIV99
  3695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3696
  3697
  3698     MOVE SV-PRIOR-KEY           TO  ERCNOT-KEY.
  3699     MOVE SPACES                 TO  CERT-NOTE-FILE.
  3700     ADD 1                       TO  ERCNOT-SEQ.
  3701     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
  3702     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  3703     MOVE W-CERT-NOTE-MSG        TO  CZ-NOTE.
  3704     MOVE PI-PROCESSOR-ID        TO  CZ-LAST-MAINT-USER.
  3705     MOVE W-SAVE-BIN-DATE        TO  CZ-LAST-MAINT-DT.
  3706     MOVE EIBTIME                TO  CZ-LAST-MAINT-HHMMSS.
  3707
  3708
  3709* EXEC CICS WRITE
  3710*         DATASET(ERCNOT-FILE-ID)
  3711*         FROM(CERT-NOTE-FILE)
  3712*         RIDFLD(ERCNOT-KEY)
  3713*         RESP(W-RESPONSE)
  3714*    END-EXEC.
  3715     MOVE LENGTH OF
  3716      CERT-NOTE-FILE
  3717       TO DFHEIV11
  3718*    MOVE '&$ L                  ''  N#00003402' TO DFHEIV0
  3719     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3721     MOVE X'204E233030303033343032' TO DFHEIV0(25:11)
  3722     CALL 'kxdfhei1' USING DFHEIV0,
  3723           ERCNOT-FILE-ID,
  3724           CERT-NOTE-FILE,
  3725           DFHEIV11,
  3726           ERCNOT-KEY,
  3727           DFHEIV99,
  3728           DFHEIV99
  3729     MOVE EIBRESP  TO W-RESPONSE
  3730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3731
  3732
  3733     IF RESP-NORMAL
  3734         PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT
  3735     END-IF.
  3736
  3737 4099-EXIT.
  3738     EXIT.
  3739
  3740
  3741 4500-UPDATE-BILL-NOTE SECTION.
  3742
  3743
  3744* EXEC CICS GETMAIN
  3745*         SET      (ADDRESS OF EOB-CODES)
  3746*         LENGTH   (ELEOBC-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  75
* EL691.cbl
  3747*    END-EXEC
  3748*    MOVE '," L                  $   #00003419' TO DFHEIV0
  3749     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3750     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3751     MOVE X'2020233030303033343139' TO DFHEIV0(25:11)
  3752     CALL 'kxdfhei1' USING DFHEIV0,
  3753           DFHEIV20,
  3754           ELEOBC-LENGTH,
  3755           DFHEIV99
  3756     SET ADDRESS OF EOB-CODES TO
  3757         DFHEIV20
  3758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3759
  3760     MOVE LOW-VALUES             TO ELEOBC-KEY
  3761     MOVE PI-COMPANY-CD          TO EOBC-COMPANY-CD
  3762     MOVE '5'                    TO EOBC-REC-TYPE
  3763
  3764
  3765* EXEC CICS STARTBR
  3766*        DATASET   (ELEOBC-FILE-ID)
  3767*        RIDFLD    (ELEOBC-KEY)
  3768*        GTEQ
  3769*        RESP      (W-RESPONSE)
  3770*    END-EXEC
  3771     MOVE 0
  3772       TO DFHEIV11
  3773*    MOVE '&,         G          &  N#00003428' TO DFHEIV0
  3774     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3775     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3776     MOVE X'204E233030303033343238' TO DFHEIV0(25:11)
  3777     CALL 'kxdfhei1' USING DFHEIV0,
  3778           ELEOBC-FILE-ID,
  3779           ELEOBC-KEY,
  3780           DFHEIV99,
  3781           DFHEIV11,
  3782           DFHEIV99
  3783     MOVE EIBRESP  TO W-RESPONSE
  3784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3785
  3786     IF NOT RESP-NORMAL
  3787        GO TO 4500-EXIT
  3788     END-IF
  3789      .
  3790 4500-READNEXT-ELEOBC.
  3791
  3792
  3793* EXEC CICS READNEXT
  3794*       INTO    (EOB-CODES)
  3795*       DATASET (ELEOBC-FILE-ID)
  3796*       RIDFLD  (ELEOBC-KEY)
  3797*       RESP    (W-RESPONSE)
  3798*    END-EXEC
  3799     MOVE LENGTH OF
  3800      EOB-CODES
  3801       TO DFHEIV12
  3802     MOVE 0
  3803       TO DFHEIV11
  3804*    MOVE '&.IL                  )  N#00003441' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  76
* EL691.cbl
  3805     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3806     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3807     MOVE X'204E233030303033343431' TO DFHEIV0(25:11)
  3808     CALL 'kxdfhei1' USING DFHEIV0,
  3809           ELEOBC-FILE-ID,
  3810           EOB-CODES,
  3811           DFHEIV12,
  3812           ELEOBC-KEY,
  3813           DFHEIV99,
  3814           DFHEIV11,
  3815           DFHEIV99,
  3816           DFHEIV99
  3817     MOVE EIBRESP  TO W-RESPONSE
  3818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3819
  3820     IF RESP-NORMAL
  3821         IF EO-RECORD-TYPE NOT = '5'
  3822             GO TO 4500-EXIT
  3823         END-IF
  3824     ELSE
  3825         GO TO 4500-EXIT
  3826     END-IF
  3827
  3828     IF EO-RECORD-TYPE = '5' AND
  3829        EO-EOB-CODE = PI-ARCHIVE-LTRID
  3830           CONTINUE
  3831     ELSE
  3832         GO TO 4500-READNEXT-ELEOBC
  3833     END-IF
  3834
  3835     MOVE SPACES TO WS-FIND-BILLING-NOTE
  3836     MOVE EO-DESCRIPTION TO WS-FBN-NOTE
  3837     MOVE PI-ARCHIVE-LTRID TO WS-FBN-LTRID
  3838
  3839
  3840* EXEC CICS GETMAIN
  3841*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  3842*         LENGTH   (ERNOTE-LENGTH)
  3843*    END-EXEC
  3844*    MOVE '," L                  $   #00003467' TO DFHEIV0
  3845     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3846     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3847     MOVE X'2020233030303033343637' TO DFHEIV0(25:11)
  3848     CALL 'kxdfhei1' USING DFHEIV0,
  3849           DFHEIV20,
  3850           ERNOTE-LENGTH,
  3851           DFHEIV99
  3852     SET ADDRESS OF CERTIFICATE-NOTE TO
  3853         DFHEIV20
  3854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3855
  3856     MOVE PI-COMPANY-CD          TO  ERNOTE-COMPANY-CD
  3857     MOVE PI-CARRIER             TO  ERNOTE-CARRIER
  3858     MOVE PI-GROUPING            TO  ERNOTE-GROUPING
  3859     MOVE PI-STATE               TO  ERNOTE-STATE
  3860     MOVE PI-ACCOUNT             TO  ERNOTE-ACCOUNT
  3861     MOVE PI-CERT-EFF-DT         TO  ERNOTE-CERT-EFF-DT
  3862     MOVE PI-CERT-PRIME          TO  ERNOTE-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  77
* EL691.cbl
  3863     MOVE PI-CERT-SFX            TO  ERNOTE-CERT-SFX
  3864
  3865
  3866* EXEC CICS READ
  3867*       DATASET    (ERNOTE-FILE-ID)
  3868*       RIDFLD     (ERNOTE-KEY)
  3869*       INTO       (CERTIFICATE-NOTE)
  3870*       RESP       (W-RESPONSE)
  3871*       UPDATE
  3872*    END-EXEC
  3873     MOVE LENGTH OF
  3874      CERTIFICATE-NOTE
  3875       TO DFHEIV11
  3876*    MOVE '&"IL       EU         (  N#00003481' TO DFHEIV0
  3877     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3878     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3879     MOVE X'204E233030303033343831' TO DFHEIV0(25:11)
  3880     CALL 'kxdfhei1' USING DFHEIV0,
  3881           ERNOTE-FILE-ID,
  3882           CERTIFICATE-NOTE,
  3883           DFHEIV11,
  3884           ERNOTE-KEY,
  3885           DFHEIV99,
  3886           DFHEIV99,
  3887           DFHEIV99
  3888     MOVE EIBRESP  TO W-RESPONSE
  3889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3890
  3891     IF RESP-NORMAL
  3892       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  3893           (NOTE-SUB > +10) OR
  3894           (CN-LINE (NOTE-SUB) (1:29) =
  3895                             WS-FIND-BILLING-NOTE (1:29))
  3896       END-PERFORM
  3897       IF CN-LINE (NOTE-SUB) (1:29) NOT =
  3898                              WS-FIND-BILLING-NOTE (1:29)
  3899
  3900* EXEC CICS UNLOCK
  3901*           DATASET    (ERNOTE-FILE-ID)
  3902*        END-EXEC
  3903*    MOVE '&*                    #   #00003497' TO DFHEIV0
  3904     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3905     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3906     MOVE X'2020233030303033343937' TO DFHEIV0(25:11)
  3907     CALL 'kxdfhei1' USING DFHEIV0,
  3908           ERNOTE-FILE-ID,
  3909           DFHEIV99
  3910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3911         GO TO 4500-EXIT
  3912       END-IF
  3913
  3914       MOVE WS-RECEIVED-NOTE TO CN-LINE (NOTE-SUB) (50:20)
  3915       MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  3916       MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
  3917       MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  3918
  3919* EXEC CICS REWRITE
  3920*         DATASET    (ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  78
* EL691.cbl
  3921*         FROM       (CERTIFICATE-NOTE)
  3922*         RESP       (W-RESPONSE)
  3923*      END-EXEC
  3924     MOVE LENGTH OF
  3925      CERTIFICATE-NOTE
  3926       TO DFHEIV11
  3927*    MOVE '&& L                  %  N#00003507' TO DFHEIV0
  3928     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3929     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3930     MOVE X'204E233030303033353037' TO DFHEIV0(25:11)
  3931     CALL 'kxdfhei1' USING DFHEIV0,
  3932           ERNOTE-FILE-ID,
  3933           CERTIFICATE-NOTE,
  3934           DFHEIV11,
  3935           DFHEIV99
  3936     MOVE EIBRESP  TO W-RESPONSE
  3937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3938
  3939       .
  3940
  3941 4500-EXIT.
  3942     EXIT.
  3943
  3944
  3945 4800-CERTIFICATE-UPDATE SECTION.
  3946
  3947
  3948* EXEC CICS HANDLE CONDITION
  3949*        NOTFND   (4899-EXIT)
  3950*    END-EXEC.
  3951*    MOVE '"$I                   ! ) #00003521' TO DFHEIV0
  3952     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3954     MOVE X'2920233030303033353231' TO DFHEIV0(25:11)
  3955     CALL 'kxdfhei1' USING DFHEIV0
  3956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3957
  3958
  3959
  3960* EXEC CICS READ
  3961*    EQUAL
  3962*    DATASET   (ELCERT-FILE-ID)
  3963*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3964*    RIDFLD    (ELCERT-KEY)
  3965*    UPDATE
  3966*    RESP      (W-RESPONSE)
  3967*    END-EXEC.
  3968*    MOVE '&"S        EU         (  N#00003525' TO DFHEIV0
  3969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3970     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3971     MOVE X'204E233030303033353235' TO DFHEIV0(25:11)
  3972     CALL 'kxdfhei1' USING DFHEIV0,
  3973           ELCERT-FILE-ID,
  3974           DFHEIV20,
  3975           DFHEIV99,
  3976           ELCERT-KEY,
  3977           DFHEIV99,
  3978           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  79
* EL691.cbl
  3979           DFHEIV99
  3980     SET ADDRESS OF CERTIFICATE-MASTER TO
  3981         DFHEIV20
  3982     MOVE EIBRESP  TO W-RESPONSE
  3983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3984
  3985
  3986     IF RESP-NORMAL
  3987        IF CM-NOTE-SW = ' '
  3988           MOVE '1'        TO CM-NOTE-SW
  3989        ELSE
  3990           IF CM-NOTE-SW = '2'
  3991              MOVE '3'      TO CM-NOTE-SW
  3992           ELSE
  3993              IF CM-NOTE-SW = '4'
  3994                  MOVE '5'    TO CM-NOTE-SW
  3995              ELSE
  3996                 IF CM-NOTE-SW = '6'
  3997                    MOVE '7'  TO CM-NOTE-SW
  3998                 END-IF
  3999              END-IF
  4000           END-IF
  4001        END-IF
  4002
  4003* EXEC CICS REWRITE
  4004*          FROM      (CERTIFICATE-MASTER)
  4005*          DATASET   (ELCERT-FILE-ID)
  4006*       END-EXEC
  4007     MOVE LENGTH OF
  4008      CERTIFICATE-MASTER
  4009       TO DFHEIV11
  4010*    MOVE '&& L                  %   #00003550' TO DFHEIV0
  4011     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4013     MOVE X'2020233030303033353530' TO DFHEIV0(25:11)
  4014     CALL 'kxdfhei1' USING DFHEIV0,
  4015           ELCERT-FILE-ID,
  4016           CERTIFICATE-MASTER,
  4017           DFHEIV11,
  4018           DFHEIV99
  4019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4020     END-IF.
  4021
  4022 4899-EXIT.
  4023      EXIT.
  4024
  4025
  4026
  4027 8010-ARCH-NOT-OPEN.
  4028
  4029     MOVE ER-7388                TO EMI-ERROR.
  4030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4031     MOVE -1                     TO MAINTL.
  4032     GO TO 8200-SEND-DATAONLY.
  4033
  4034 8015-ARCT-NOT-OPEN.
  4035
  4036     MOVE ER-7373                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  80
* EL691.cbl
  4037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4038     MOVE -1                     TO MAINTL.
  4039     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  81
* EL691.cbl
  4041
  4042 8100-SEND-INITIAL-MAP.
  4043
  4044     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4045
  4046     IF  NOT EMI-NO-ERRORS
  4047         MOVE EMI-MESSAGE-AREA (1)
  4048                                 TO ERRMSG1O
  4049     ELSE
  4050         MOVE SPACES             TO ERRMSG1O
  4051     END-IF.
  4052
  4053
  4054* EXEC CICS SEND
  4055*        MAP    (W-MAP)
  4056*        MAPSET (W-MAPSET)
  4057*        FROM   (EL691AO)
  4058*        ERASE
  4059*        CURSOR
  4060*    END-EXEC.
  4061     MOVE LENGTH OF
  4062      EL691AO
  4063       TO DFHEIV12
  4064     MOVE -1
  4065       TO DFHEIV11
  4066*    MOVE '8$     CT  E    H L F ,   #00003587' TO DFHEIV0
  4067     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4068     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4069     MOVE X'2020233030303033353837' TO DFHEIV0(25:11)
  4070     CALL 'kxdfhei1' USING DFHEIV0,
  4071           W-MAP,
  4072           EL691AO,
  4073           DFHEIV12,
  4074           W-MAPSET,
  4075           DFHEIV99,
  4076           DFHEIV99,
  4077           DFHEIV99,
  4078           DFHEIV11,
  4079           DFHEIV99,
  4080           DFHEIV99,
  4081           DFHEIV99
  4082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4083
  4084
  4085     GO TO 9000-RETURN-TRANS.
  4086
  4087 8100-EXIT.
  4088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  82
* EL691.cbl
  4090
  4091 8200-SEND-DATAONLY.
  4092
  4093     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4094
  4095     IF  NOT EMI-NO-ERRORS
  4096         MOVE EMI-MESSAGE-AREA (1)
  4097                                 TO ERRMSG1O
  4098     ELSE
  4099         MOVE SPACES             TO ERRMSG1O
  4100     END-IF.
  4101
  4102
  4103* EXEC CICS SEND
  4104*        MAP    (W-MAP)
  4105*        MAPSET (W-MAPSET)
  4106*        FROM   (EL691AO)
  4107*        DATAONLY
  4108*        CURSOR
  4109*    END-EXEC.
  4110     MOVE LENGTH OF
  4111      EL691AO
  4112       TO DFHEIV12
  4113     MOVE -1
  4114       TO DFHEIV11
  4115*    MOVE '8$D    CT       H L F ,   #00003612' TO DFHEIV0
  4116     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4117     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4118     MOVE X'2020233030303033363132' TO DFHEIV0(25:11)
  4119     CALL 'kxdfhei1' USING DFHEIV0,
  4120           W-MAP,
  4121           EL691AO,
  4122           DFHEIV12,
  4123           W-MAPSET,
  4124           DFHEIV99,
  4125           DFHEIV99,
  4126           DFHEIV99,
  4127           DFHEIV11,
  4128           DFHEIV99,
  4129           DFHEIV99,
  4130           DFHEIV99
  4131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4132
  4133
  4134     GO TO 9000-RETURN-TRANS.
  4135
  4136 8200-EXIT.
  4137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  83
* EL691.cbl
  4139
  4140 8300-SEND-TEXT.
  4141
  4142
  4143* EXEC CICS SEND TEXT
  4144*        FROM    (LOGOFF-TEXT)
  4145*        LENGTH  (LOGOFF-LENGTH)
  4146*        ERASE
  4147*        FREEKB
  4148*    END-EXEC.
  4149*    MOVE '8&      T  E F  H   F -   #00003628' TO DFHEIV0
  4150     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4151     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4152     MOVE X'2020233030303033363238' TO DFHEIV0(25:11)
  4153     CALL 'kxdfhei1' USING DFHEIV0,
  4154           LOGOFF-TEXT,
  4155           LOGOFF-LENGTH,
  4156           DFHEIV99,
  4157           DFHEIV99,
  4158           DFHEIV99,
  4159           DFHEIV99,
  4160           DFHEIV99,
  4161           DFHEIV99,
  4162           DFHEIV99,
  4163           DFHEIV99,
  4164           DFHEIV99,
  4165           DFHEIV99
  4166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4167
  4168
  4169     GO TO 9000-RETURN-TRANS.
  4170
  4171 8300-EXIT.
  4172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  84
* EL691.cbl
  4174
  4175 8600-DEEDIT.
  4176
  4177
  4178* EXEC CICS BIF DEEDIT
  4179*         FIELD    (W-DEEDIT-FIELD)
  4180*         LENGTH   (15)
  4181*    END-EXEC.
  4182     MOVE 15
  4183       TO DFHEIV11
  4184*    MOVE '@"L                   #   #00003643' TO DFHEIV0
  4185     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4186     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4187     MOVE X'2020233030303033363433' TO DFHEIV0(25:11)
  4188     CALL 'kxdfhei1' USING DFHEIV0,
  4189           W-DEEDIT-FIELD,
  4190           DFHEIV11
  4191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4192
  4193
  4194 8600-EXIT.
  4195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  85
* EL691.cbl
  4197
  4198 9000-RETURN-TRANS.
  4199
  4200     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4201     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  4202
  4203* EXEC CICS RETURN
  4204*        TRANSID    (W-TRANSACTION)
  4205*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4206*        LENGTH     (PI-COMM-LENGTH)
  4207*    END-EXEC.
  4208*    MOVE '.(CT                  ''   #00003656' TO DFHEIV0
  4209     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4210     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4211     MOVE X'2020233030303033363536' TO DFHEIV0(25:11)
  4212     CALL 'kxdfhei1' USING DFHEIV0,
  4213           W-TRANSACTION,
  4214           PROGRAM-INTERFACE-BLOCK,
  4215           PI-COMM-LENGTH,
  4216           DFHEIV99,
  4217           DFHEIV99,
  4218           DFHEIV99
  4219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4220
  4221
  4222 9000-EXIT.
  4223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  86
* EL691.cbl
  4225
  4226 9200-PA.
  4227
  4228     MOVE ER-7008                TO EMI-ERROR.
  4229     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4230     MOVE -1                     TO MAINTL.
  4231     GO TO 8200-SEND-DATAONLY.
  4232
  4233 9200-EXIT.
  4234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  87
* EL691.cbl
  4236
  4237 9300-DFHCLEAR.
  4238
  4239     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  4240     GO TO 9400-XCTL.
  4241
  4242 9300-EXIT.
  4243     EXIT.
  4244
  4245 9400-XCTL.
  4246
  4247
  4248* EXEC CICS XCTL
  4249*        PROGRAM  (W-CALL-PGM)
  4250*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4251*        LENGTH   (PI-COMM-LENGTH)
  4252*    END-EXEC.
  4253*    MOVE '.$C                   %   #00003687' TO DFHEIV0
  4254     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4255     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4256     MOVE X'2020233030303033363837' TO DFHEIV0(25:11)
  4257     CALL 'kxdfhei1' USING DFHEIV0,
  4258           W-CALL-PGM,
  4259           PROGRAM-INTERFACE-BLOCK,
  4260           PI-COMM-LENGTH,
  4261           DFHEIV99
  4262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4263
  4264
  4265 9400-EXIT.
  4266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  88
* EL691.cbl
  4268
  4269 9500-LINK-DATE-CONVERT.
  4270
  4271
  4272* EXEC CICS LINK
  4273*        PROGRAM    ('ELDATCV')
  4274*        COMMAREA   (DATE-CONVERSION-DATA)
  4275*        LENGTH     (DC-COMM-LENGTH)
  4276*    END-EXEC.
  4277     MOVE 'ELDATCV' TO DFHEIV1
  4278*    MOVE '."C                   (   #00003699' TO DFHEIV0
  4279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4281     MOVE X'2020233030303033363939' TO DFHEIV0(25:11)
  4282     CALL 'kxdfhei1' USING DFHEIV0,
  4283           DFHEIV1,
  4284           DATE-CONVERSION-DATA,
  4285           DC-COMM-LENGTH,
  4286           DFHEIV99,
  4287           DFHEIV99,
  4288           DFHEIV99,
  4289           DFHEIV99
  4290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4291
  4292
  4293 9500-EXIT.
  4294     EXIT.
  4295
  4296 9600-FORMAT-DATE-TIME.
  4297
  4298     MOVE W-SAVE-DATE            TO RUNDTEO.
  4299     MOVE EIBTIME                TO W-TIME-IN.
  4300     MOVE W-TIME-OUT             TO RUNTIMEO.
  4301     MOVE PI-COMPANY-ID          TO COMPANYO.
  4302     MOVE PI-PROCESSOR-ID        TO USERIDO.
  4303     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  4304
  4305     IF PI-ARCHIVE-COMPLETE = 'Y'
  4306        MOVE AL-SANOF           TO STCOMPA
  4307        MOVE AL-SADOF           TO STRECVA
  4308                                   STSTOPA
  4309                                   STFINLA
  4310     ELSE
  4311       IF PI-ARCHIVE-RECEIVED = 'Y'
  4312           MOVE AL-SANOF        TO STRECVA
  4313           MOVE AL-SADOF        TO STCOMPA
  4314                                   STSTOPA
  4315                                   STFINLA
  4316       ELSE
  4317         IF PI-ARCHIVE-STOPPED = 'Y'
  4318             MOVE AL-SANOF      TO STSTOPA
  4319             MOVE AL-SADOF      TO STCOMPA
  4320                                   STRECVA
  4321                                   STFINLA
  4322         ELSE
  4323           IF PI-ARCHIVE-FINAL = 'Y'
  4324               MOVE AL-SANOF    TO STFINLA
  4325               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  89
* EL691.cbl
  4326                                   STRECVA
  4327                                   STSTOPA
  4328           ELSE
  4329               MOVE AL-SADOF    TO STCOMPA
  4330                                   STRECVA
  4331                                   STSTOPA
  4332                                   STFINLA
  4333           END-IF
  4334         END-IF
  4335       END-IF
  4336     END-IF.
  4337
  4338
  4339 9600-EXIT.
  4340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  90
* EL691.cbl
  4342
  4343 9700-PGMID-ERROR.
  4344
  4345
  4346* EXEC CICS  HANDLE CONDITION
  4347*        PGMIDERR  (8300-SEND-TEXT)
  4348*    END-EXEC.
  4349*    MOVE '"$L                   ! * #00003757' TO DFHEIV0
  4350     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4352     MOVE X'2A20233030303033373537' TO DFHEIV0(25:11)
  4353     CALL 'kxdfhei1' USING DFHEIV0
  4354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4355
  4356
  4357     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  4358     MOVE ' '                    TO PI-ENTRY-CD-1.
  4359     MOVE W-XCTL-005             TO W-CALL-PGM
  4360                                    LOGOFF-PGM.
  4361     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  4362
  4363     PERFORM 9400-XCTL THRU 9400-EXIT.
  4364
  4365 9700-EXIT.
  4366     EXIT.
  4367
  4368 9800-ABEND.
  4369
  4370     MOVE W-LINK-004             TO W-CALL-PGM.
  4371     MOVE DFHEIBLK               TO EMI-LINE1
  4372
  4373
  4374* EXEC CICS  LINK
  4375*        PROGRAM   (W-CALL-PGM)
  4376*        COMMAREA  (EMI-LINE1)
  4377*        LENGTH    (72)
  4378*    END-EXEC.
  4379     MOVE 72
  4380       TO DFHEIV11
  4381*    MOVE '."C                   (   #00003777' TO DFHEIV0
  4382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4384     MOVE X'2020233030303033373737' TO DFHEIV0(25:11)
  4385     CALL 'kxdfhei1' USING DFHEIV0,
  4386           W-CALL-PGM,
  4387           EMI-LINE1,
  4388           DFHEIV11,
  4389           DFHEIV99,
  4390           DFHEIV99,
  4391           DFHEIV99,
  4392           DFHEIV99
  4393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4394
  4395
  4396     GO TO 8200-SEND-DATAONLY.
  4397
  4398 9800-EXIT.
  4399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  91
* EL691.cbl
  4401
  4402 9900-ERROR-FORMAT.
  4403
  4404     IF  EMI-ERROR EQUAL ER-9097
  4405         NEXT SENTENCE
  4406     ELSE
  4407         IF  EMI-ERRORS-COMPLETE
  4408                 OR
  4409             EMI-ERROR EQUAL W-LAST-ERROR
  4410             GO TO 9900-EXIT
  4411     END-IF.
  4412
  4413     ADD +1  TO  W-ERROR-COUNT.
  4414     MOVE W-LINK-001             TO W-CALL-PGM.
  4415
  4416
  4417* EXEC CICS LINK
  4418*        PROGRAM    (W-CALL-PGM)
  4419*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  4420*        LENGTH     (EMI-COMM-LENGTH)
  4421*    END-EXEC.
  4422*    MOVE '."C                   (   #00003803' TO DFHEIV0
  4423     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4425     MOVE X'2020233030303033383033' TO DFHEIV0(25:11)
  4426     CALL 'kxdfhei1' USING DFHEIV0,
  4427           W-CALL-PGM,
  4428           ERROR-MESSAGE-INTERFACE-BLOCK,
  4429           EMI-COMM-LENGTH,
  4430           DFHEIV99,
  4431           DFHEIV99,
  4432           DFHEIV99,
  4433           DFHEIV99
  4434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4435
  4436
  4437     MOVE EMI-ERROR              TO W-LAST-ERROR.
  4438
  4439 9900-EXIT.
  4440     EXIT.
  4441
  4442 9905-INITIALIZE-SECURITY.
  4443******************************************************************
  4444*                                                                *
  4445*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  4446*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  4447*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  4448*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  4449*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  4450*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  4451*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  4452*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  4453*                                                                *
  4454*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  4455*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  4456*                                                                *
  4457******************************************************************
  4458
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  92
* EL691.cbl
  4459     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  4460         MOVE 'Y'                TO PI-DISPLAY-CAP
  4461                                    PI-MODIFY-CAP
  4462     ELSE
  4463
  4464* EXEC CICS READQ TS
  4465*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  4466*            INTO   (SECURITY-CONTROL)
  4467*            LENGTH (SC-COMM-LENGTH)
  4468*            ITEM   (1)
  4469*        END-EXEC
  4470     MOVE 1
  4471       TO DFHEIV11
  4472*    MOVE '*$II   L              ''   #00003835' TO DFHEIV0
  4473     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4475     MOVE X'2020233030303033383335' TO DFHEIV0(25:11)
  4476     CALL 'kxdfhei1' USING DFHEIV0,
  4477           PI-SECURITY-TEMP-STORE-ID,
  4478           SECURITY-CONTROL,
  4479           SC-COMM-LENGTH,
  4480           DFHEIV11,
  4481           DFHEIV99,
  4482           DFHEIV99
  4483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4484         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  4485                                 TO PI-DISPLAY-CAP
  4486         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  4487                                 TO PI-MODIFY-CAP
  4488     END-IF.
  4489
  4490 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  93
* EL691.cbl
  4492
  4493 9995-SECURITY-VIOLATION.
  4494
  4495     MOVE EIBDATE                TO SM-JUL-DATE.
  4496     MOVE EIBTRMID               TO SM-TERMID.
  4497     MOVE W-THIS-PGM             TO SM-PGM.
  4498     MOVE EIBTIME                TO W-TIME-IN.
  4499     MOVE W-TIME-OUT             TO SM-TIME.
  4500     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  4501
  4502
  4503* EXEC CICS LINK
  4504*         PROGRAM  ('EL003')
  4505*         COMMAREA (SECURITY-MESSAGE)
  4506*         LENGTH   (80)
  4507*    END-EXEC.
  4508     MOVE 'EL003' TO DFHEIV1
  4509     MOVE 80
  4510       TO DFHEIV11
  4511*    MOVE '."C                   (   #00003859' TO DFHEIV0
  4512     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4514     MOVE X'2020233030303033383539' TO DFHEIV0(25:11)
  4515     CALL 'kxdfhei1' USING DFHEIV0,
  4516           DFHEIV1,
  4517           SECURITY-MESSAGE,
  4518           DFHEIV11,
  4519           DFHEIV99,
  4520           DFHEIV99,
  4521           DFHEIV99,
  4522           DFHEIV99
  4523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4524
  4525
  4526 9995-EXIT.
  4527     EXIT.
  4528
  4529 9999-GOBACK.
  4530
  4531
  4532* GOBACK.
  4533     MOVE '9%                    "   ' TO DFHEIV0
  4534     MOVE 'EL691' TO DFHEIV1
  4535     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4536     GOBACK.
  4537
  4538 9999-EXIT.
  4539     EXIT.
  4540
  4541 9999-DFHBACK SECTION.
  4542     MOVE '9%                    "   ' TO DFHEIV0
  4543     MOVE 'EL691' TO DFHEIV1
  4544     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4545     GOBACK.
  4546 9999-DFHEXIT.
  4547     IF DFHEIGDJ EQUAL 0001
  4548         NEXT SENTENCE
  4549     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:04 Page  94
* EL691.cbl
  4550         GO TO 9300-DFHCLEAR,
  4551               9200-PA,
  4552               9200-PA,
  4553               9200-PA
  4554         DEPENDING ON DFHEIGDI
  4555     ELSE IF DFHEIGDJ EQUAL 3
  4556         GO TO 9700-PGMID-ERROR,
  4557               9800-ABEND
  4558         DEPENDING ON DFHEIGDI
  4559     ELSE IF DFHEIGDJ EQUAL 4
  4560         GO TO 8010-ARCH-NOT-OPEN,
  4561               1070-ARCH-NOT-FOUND,
  4562               1070-ARCH-NOT-FOUND
  4563         DEPENDING ON DFHEIGDI
  4564     ELSE IF DFHEIGDJ EQUAL 5
  4565         GO TO 8015-ARCT-NOT-OPEN,
  4566               1000-ARCT-NOT-FOUND,
  4567               1000-ARCT-NOT-FOUND
  4568         DEPENDING ON DFHEIGDI
  4569     ELSE IF DFHEIGDJ EQUAL 6
  4570         GO TO 8010-ARCH-NOT-OPEN,
  4571               1070-ARCH-NOT-FOUND,
  4572               1070-ARCH-NOT-FOUND
  4573         DEPENDING ON DFHEIGDI
  4574     ELSE IF DFHEIGDJ EQUAL 7
  4575         GO TO 3200-NOT-FOUND,
  4576               3200-NOT-FOUND
  4577         DEPENDING ON DFHEIGDI
  4578     ELSE IF DFHEIGDJ EQUAL 8
  4579         GO TO 4010-ENDBR,
  4580               4010-ENDBR
  4581         DEPENDING ON DFHEIGDI
  4582     ELSE IF DFHEIGDJ EQUAL 9
  4583         GO TO 4899-EXIT
  4584         DEPENDING ON DFHEIGDI
  4585     ELSE IF DFHEIGDJ EQUAL 10
  4586         GO TO 8300-SEND-TEXT
  4587         DEPENDING ON DFHEIGDI.
  4588     MOVE '9%                    "   ' TO DFHEIV0
  4589     MOVE 'EL691' TO DFHEIV1
  4590     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4591     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5072     Code:       11004
