* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1278.cbl
    55 ENVIRONMENT DIVISION.
    56 DATA DIVISION.
    57 WORKING-STORAGE SECTION.
    58 01  DFH-START PIC X(04).
    59 77  FILLER  PIC  X(32) VALUE '********************************'.
    60 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    61 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    62 77  S1                          PIC S999 COMP-3 VALUE +0.
    63 77  P1                          PIC S999 COMP-3 VALUE +0.
    64 77  P2                          PIC S999 COMP-3 VALUE +0.
    65 77  C0                          PIC S999 COMP-3 VALUE +0.
    66 77  C1                          PIC S999 COMP-3 VALUE +0.
    67 77  C2                          PIC S999 COMP-3 VALUE +0.
    68 77  C3                          PIC S999 COMP-3 VALUE +0.
    69 77  WS-STOP-SW                  PIC X  VALUE ' '.
    70     88  I-SAY-TO-STOP      VALUE 'Y'.
    71 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    72     88  OPEN-LF-CLAIM              VALUE 'Y'.
    73 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    74     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    75 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    76     88  OPEN-AH-CLAIM              VALUE 'Y'.
    77 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    78     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    79 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    80     88  FOUND-A-CLAIM              VALUE 'Y'.
    81 77  WS-ST-REF-IND               PIC X.
    82 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    83 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    84 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    85 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    86 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    87 77  DD-IU-SW                    PIC X   VALUE ' '.
    88     88  DD-IU-PRESENT                 VALUE 'Y'.
    89 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    90 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    94 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    95 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    96 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    97 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    98     88  NO-CERT-RW                 VALUE 'N'.
    99     88  CERT-RW                    VALUE 'Y'.
   100 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   101     88  ERMAIL-FOUND                 VALUE 'Y'.
   102
   103*                            COPY ELCSCTM.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCTM                             *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   111*                                                                *
   112******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1278.cbl
   113 01  SECURITY-MESSAGE.
   114     12  FILLER                          PIC X(30)
   115            VALUE '** LOGIC SECURITY VIOLATION -'.
   116     12  SM-READ                         PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' PGM='.
   119     12  SM-PGM                          PIC X(6).
   120     12  FILLER                          PIC X(5)
   121            VALUE ' OPR='.
   122     12  SM-PROCESSOR-ID                 PIC X(4).
   123     12  FILLER                          PIC X(6)
   124            VALUE ' TERM='.
   125     12  SM-TERMID                       PIC X(4).
   126     12  FILLER                          PIC XX   VALUE SPACE.
   127     12  SM-JUL-DATE                     PIC 9(5).
   128     12  FILLER                          PIC X    VALUE SPACE.
   129     12  SM-TIME                         PIC 99.99.
   130
   131
   132*                            COPY ELCSCRTY.
   133******************************************************************
   134*                                                                *
   135*                                                                *
   136*                            ELCSCRTY                            *
   137*                            VMOD=2.001                          *
   138*                                                                *
   139*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   140*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   141*        SAVED IN PI-SECURITY-ADDRESS.                           *
   142*                                                                *
   143******************************************************************
   144 01  SECURITY-CONTROL.
   145     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   146     12  FILLER                       PIC XX    VALUE 'SC'.
   147     12  SC-CREDIT-CODES.
   148         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   149             20  SC-CREDIT-DISPLAY    PIC X.
   150             20  SC-CREDIT-UPDATE     PIC X.
   151     12  SC-CLAIMS-CODES.
   152         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   153             20  SC-CLAIMS-DISPLAY    PIC X.
   154             20  SC-CLAIMS-UPDATE     PIC X.
   155
   156 01  FILLER          COMP-3.
   157     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   158     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   159     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   160     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   161     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   162     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   163     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   164     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   165     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   166
   167 01  WS-DATE-AREA.
   168     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   169     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   170     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1278.cbl
   171     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   172     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   173     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   174
   175 01  ERPDEF-KEY-SAVE             PIC X(18).
   176 01  ERPDEF-KEY.
   177     12  ERPDEF-COMPANY-CD       PIC X.
   178     12  ERPDEF-STATE            PIC XX.
   179     12  ERPDEF-PROD-CD          PIC XXX.
   180     12  F                       PIC X(7).
   181     12  ERPDEF-BEN-TYPE         PIC X.
   182     12  ERPDEF-BEN-CODE         PIC XX.
   183     12  ERPDEF-EXP-DT           PIC XX.
   184 01  ELMSTR-KEY.
   185     12  ELMSTR-COMP-CD          PIC X.
   186     12  ELMSTR-CERT-NO          PIC X(11).
   187 01  ELCRTO-KEY.
   188     05  ELCRTO-COMPANY-CD       PIC X.
   189     05  ELCRTO-CARRIER          PIC X.
   190     05  ELCRTO-GROUPING         PIC X(6).
   191     05  ELCRTO-STATE            PIC XX.
   192     05  ELCRTO-ACCOUNT          PIC X(10).
   193     05  ELCRTO-CERT-EFF-DT      PIC XX.
   194     05  ELCRTO-CERT-NO.
   195         10  ELCRTO-CERT-PRIME   PIC X(10).
   196         10  ELCRTO-CERT-SFX     PIC X.
   197     05  ELCRTO-RECORD-TYPE      PIC X.
   198     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   199
   200 01  STANDARD-AREAS.
   201     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   202     12  SUB3                    PIC S9(04) COMP VALUE +0.
   203     12  SUB4                    PIC S9(04) COMP VALUE +0.
   204     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   205     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   206     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   207     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   208     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   209     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   210     12  PGM-NAME                PIC  X(08).
   211     12  TIME-IN                 PIC S9(07).
   212     12  TIME-OUT-R  REDEFINES  TIME-IN.
   213         16  FILLER              PIC  X(01).
   214         16  TIME-OUT            PIC  9(02)V99.
   215         16  FILLER              PIC  X(02).
   216     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   217     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   218     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   219     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   220     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   221     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   222     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   223     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   224     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   225     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   226     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   227     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   228     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1278.cbl
   229     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   230     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   231     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   232     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   233         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   234     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   235         88  BROWSE-STARTED                      VALUE 'Y'.
   236     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   237         88  FORM-FOUND                          VALUE 'Y'.
   238     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   239         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   240     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   241         88  WS-REDUCING                         VALUE 'R'.
   242         88  WS-LEVEL                            VALUE 'L'  'P'.
   243     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   244         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   245     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   246         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   247     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   248     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   249         'CLAIM PMTS'.
   250     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   251         'ITD REFUND'.
   252     12  WS-ACCESS.
   253         16  FILLER              PIC  X(02).
   254         16  WS-BEN-CD           PIC  X(02).
   255     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   256     12  WS-LOOKUP-TYPE          PIC  X(01).
   257     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   258     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   259     12  WS-CALC-CD              PIC  X(01).
   260     12  DEEDIT-FIELD            PIC  X(15).
   261     12  DEEDIT-FIELD-V0  REDEFINES
   262         DEEDIT-FIELD            PIC S9(15).
   263     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   264     12  RETURN-FROM             PIC  X(08).
   265     12  QID.
   266         16  QID-TERM            PIC  X(04).
   267         16  FILLER              PIC  X(04)      VALUE '127H'.
   268     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   269         88  FIRST-ENTRY                         VALUE 'Y'.
   270     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   271         88  PDEF-FOUND                          VALUE 'Y'.
   272     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   273         88  CERT-FOUND                          VALUE 'Y'.
   274         88  CERT-NOT-FOUND                      VALUE 'N'.
   275     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   276         88  CNTL-FOUND                          VALUE 'Y'.
   277         88  CNTL-NOT-FOUND                      VALUE 'N'.
   278     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   279         88  BEN-FOUND                           VALUE 'Y'.
   280     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   281         88  STATE-FOUND                         VALUE 'Y'.
   282     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   283         88  ST-BEN-FOUND                        VALUE 'Y'.
   284     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   285         88  ACCT-FOUND                          VALUE 'Y'.
   286     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1278.cbl
   287         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   288     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   289                                                 VALUE ZERO.
   290         88  BENEFIT-FOUND                       VALUE +1.
   291     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   292                                                 VALUE ZERO.
   293     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   294                                                 VALUE ZERO.
   295     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   296     12  WS-SUB1                 PIC S99    COMP.
   297     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   298     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   299     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   300     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   301     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   302     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   303     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   304     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   305     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   306     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   307     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   308     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   309     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   310     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   311     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   312     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   313     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   314     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   315     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   316     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   317     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   319     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   320     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   321     12  ERROR-MESSAGES.
   322         16  ER-0000             PIC  X(04)      VALUE '0000'.
   323         16  ER-0004             PIC  X(04)      VALUE '0004'.
   324         16  ER-0008             PIC  X(04)      VALUE '0008'.
   325         16  ER-0028             PIC  X(04)      VALUE '0028'.
   326         16  ER-0029             PIC  X(04)      VALUE '0029'.
   327         16  ER-0070             PIC  X(04)      VALUE '0070'.
   328         16  ER-0142             PIC  X(04)      VALUE '0142'.
   329         16  ER-0214             PIC  X(04)      VALUE '0214'.
   330         16  ER-0681             PIC  X(04)      VALUE '0681'.
   331         16  ER-0682             PIC  X(04)      VALUE '0682'.
   332         16  ER-0683             PIC  X(04)      VALUE '0683'.
   333         16  ER-0684             PIC  X(04)      VALUE '0684'.
   334         16  ER-2227             PIC  X(04)      VALUE '2227'.
   335         16  ER-2601             PIC  X(04)      VALUE '2601'.
   336         16  ER-2616             PIC  X(04)      VALUE '2616'.
   337         16  ER-2617             PIC  X(04)      VALUE '2617'.
   338         16  ER-2619             PIC  X(04)      VALUE '2619'.
   339         16  ER-2740             PIC  X(04)      VALUE '2740'.
   340         16  ER-2756             PIC  X(04)      VALUE '2756'.
   341         16  ER-2768             PIC  X(04)      VALUE '2768'.
   342         16  ER-2774             PIC  X(04)      VALUE '2774'.
   343         16  ER-2775             PIC  X(04)      VALUE '2775'.
   344         16  ER-2965             PIC  X(04)      VALUE '2965'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1278.cbl
   345         16  ER-2966             PIC  X(04)      VALUE '2966'.
   346         16  ER-2967             PIC  X(04)      VALUE '2967'.
   347         16  ER-2968             PIC  X(04)      VALUE '2968'.
   348         16  ER-2969             PIC  X(04)      VALUE '2969'.
   349         16  ER-3037             PIC  X(04)      VALUE '3037'.
   350         16  ER-3038             PIC  X(04)      VALUE '3038'.
   351         16  ER-3039             PIC  X(04)      VALUE '3039'.
   352         16  ER-3780             PIC  X(04)      VALUE '3780'.
   353         16  ER-3781             PIC  X(04)      VALUE '3781'.
   354         16  ER-3830             PIC  X(04)      VALUE '3830'.
   355         16  ER-8160             PIC  X(04)      VALUE '8160'.
   356         16  ER-8161             PIC  X(04)      VALUE '8161'.
   357         16  ER-9999             PIC  X(04)      VALUE '9999'.
   358     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   359     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   360     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   361     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   362
   363     12  WS-RESPONSE             PIC S9(8)       COMP.
   364         88  WS-RESP-NORMAL                      VALUE +00.
   365         88  WS-RESP-NOTFND                      VALUE +13.
   366         88  WS-RESP-DUPREC                      VALUE +14.
   367         88  WS-RESP-DUPKEY                      VALUE +15.
   368         88  WS-RESP-NOTOPEN                     VALUE +19.
   369         88  WS-RESP-ENDFILE                     VALUE +20.
   370
   371     12  WS-01-CANCEL-ERR        PIC X(25)
   372         VALUE 'CANCEL DATE ERROR'.
   373     12  WS-02-CANCEL-ERR        PIC X(25)
   374         VALUE 'CERT NOT FOUND'.
   375     12  WS-04-CANCEL-ERR        PIC X(25)
   376         VALUE 'CANCEL AMOUNT ERROR'.
   377     12  WS-05-CANCEL-ERR        PIC X(25)
   378         VALUE 'CANCEL OPTION ERROR'.
   379     12  WS-06-CANCEL-ERR        PIC X(25)
   380         VALUE 'PREVIOUSLY CANCELLED'.
   381     12  WS-07-CANCEL-ERR        PIC X(25)
   382         VALUE 'INVALID DATA'.
   383     12  WS-08-CANCEL-ERR        PIC X(25)
   384         VALUE 'NO ACCOUNT MASTER'.
   385     12  WS-09-CANCEL-ERR        PIC X(25)
   386         VALUE 'SUFFIX ALREADY EXISTS'.
   387     12  WS-99-CANCEL-ERR        PIC X(25)
   388         VALUE 'MISC CANCEL ERROR'.
   389
   390 01  WS-SAVE-ALLOWABLE-BENEFIT.
   391     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   392     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   393     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   394     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   395     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   396     16  FILLER                    PIC XX.
   397 01  CTBL-KEY-SAVE               PIC X(5).
   398 01  CTBL-KEY.
   399     05  CTBL-COMPANY-CD         PIC X.
   400     05  CTBL-TABLE              PIC XXX.
   401     05  CTBL-BEN-TYPE           PIC X.
   402     05  CTBL-BEN-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1278.cbl
   403 01  CANCEL-GEN-PASS-AREA.
   404     05  CG-OPTION-CODE          PIC X.
   405         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   406         88  CG-FLAT-CANCEL        VALUE '1'.
   407         88  CG-CANCEL             VALUE '2'.
   408         88  CG-CANCEL-REISSUE     VALUE '3'.
   409     05  CG-ERROR-CODE           PIC 99.
   410         88  CG-SUCCESS            VALUE 00.
   411         88  CG-DATE-ERROR         VALUE 01.
   412         88  CG-CERT-NOT-FOUND     VALUE 02.
   413         88  CG-AMOUNT-ERROR       VALUE 04.
   414         88  CG-OPTION-ERROR       VALUE 05.
   415         88  CG-PREV-CAN           VALUE 06.
   416         88  CG-INVALID-DATA       VALUE 07.
   417         88  CG-NO-ACCT-MSTR       VALUE 08.
   418         88  CG-SFX-A-EXIST        VALUE 09.
   419         88  CG-MISC-ERROR         VALUE 99.
   420     05  CG-COMPANY-ID           PIC XXX.
   421     05  CG-PROC-ID              PIC XXXX.
   422     05  CG-CURRENT-DT           PIC XX.
   423     05  CG-MONTH-END-DT         PIC XX.
   424     05  CG-CERT-KEY.
   425         10  CG-CERT-COMPANY-CD  PIC X.
   426         10  CG-CERT-CARRIER     PIC X.
   427         10  CG-CERT-GROUP       PIC X(6).
   428         10  CG-CERT-STATE       PIC XX.
   429         10  CG-CERT-ACCOUNT     PIC X(10).
   430         10  CG-CERT-EFF-DT      PIC XX.
   431         10  CG-CERT-CERT-NO     PIC X(11).
   432     05  CG-LF-CAN-DATA.
   433         10  CG-LF-CAN-DT        PIC XX.
   434         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   435     05  CG-AH-CAN-DATA.
   436         10  CG-AH-CAN-DT        PIC XX.
   437         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   438     05  CG-CERT-PROFILE-DATA.
   439         10  CG-INS-LNAME        PIC X(15).
   440         10  CG-INS-FNAME        PIC X(10).
   441         10  CG-INS-MID-INIT     PIC X.
   442         10  CG-INS-AGE          PIC 99.
   443         10  CG-JNT-LNAME        PIC X(15).
   444         10  CG-JNT-FNAME        PIC X(10).
   445         10  CG-JNT-MID-INIT     PIC X.
   446         10  CG-JNT-AGE          PIC 99.
   447     05  CG-LF-ISS-DATA.
   448         10  CG-LF-BENCD         PIC XX.
   449         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   450         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   451     05  CG-AH-ISS-DATA.
   452         10  CG-AH-BENCD         PIC XX.
   453         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   454     05  CG-BATCH-NO             PIC X(6).
   455     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   456     05  FILLER                  PIC X(306).
   457 01  WS-CAN-QUOTE-NOTE.
   458     12  WS-CN-DT-QUOTED         PIC  X(09).
   459     12  FILLER                  PIC  X(10)      VALUE
   460         'RF QUOTE: '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1278.cbl
   461     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   462     12  FILLER                  PIC  X(4)       VALUE
   463         ' LF '.
   464     12  WS-CN-LF-REF-METH       PIC  X.
   465     12  FILLER                  PIC  X          VALUE ','.
   466     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   467     12  FILLER                  PIC  X(5)       VALUE
   468         ' AH '.
   469     12  WS-CN-AH-REF-METH       PIC  X.
   470     12  FILLER                  PIC  XX         VALUE ','.
   471     12  FILLER                  PIC  X(6)       VALUE
   472         'TOTAL '.
   473     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   474     12  FILLER                  PIC  X(01)      VALUE ' '.
   475     12  WS-CN-CANCEL-DT         PIC  X(08).
   476     12  FILLER                  PIC  X(01)      VALUE ';'.
   477     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   478
   479 01  WS-CM-CONTROL-PRIMARY.
   480     12  WS-CM-COMPANY-CD        PIC  X(01).
   481     12  WS-CM-CARRIER           PIC  X(01).
   482     12  WS-CM-GROUPING          PIC  X(06).
   483     12  WS-CM-STATE             PIC  X(02).
   484     12  WS-CM-ACCOUNT           PIC  X(10).
   485     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   486     12  WS-CM-CERT-NO.
   487         16  WS-CM-CERT-PRIME    PIC  X(10).
   488         16  WS-CM-CERT-SFX      PIC  X(01).
   489
   490 01  WS-MA-CONTROL-PRIMARY.
   491     12  WS-MA-COMPANY-CD        PIC  X(01).
   492     12  WS-MA-CARRIER           PIC  X(01).
   493     12  WS-MA-GROUPING          PIC  X(06).
   494     12  WS-MA-STATE             PIC  X(02).
   495     12  WS-MA-ACCOUNT           PIC  X(10).
   496     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   497     12  WS-MA-CERT-NO.
   498         16  WS-MA-CERT-PRIME    PIC  X(10).
   499         16  WS-MA-CERT-SFX      PIC  X(01).
   500 01  WS-CF-CONTROL-PRIMARY.
   501     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   502     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   503*        88  COMPANY-MASTER                      VALUE '1'.
   504*        88  STATE-MASTER                        VALUE '3'.
   505*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   506*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   507     12  WS-CF-ACCESS.
   508         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   509         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   510             20  FILLER          PIC  X(01).
   511             20  WS-CF-CARRIER   PIC  X(01).
   512     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   513
   514 01  WS-AM-CONTROL-PRIMARY.
   515     12  WS-AM-COMPANY-CD        PIC  X(01).
   516     12  WS-AM-CARRIER           PIC  X(01).
   517     12  WS-AM-GROUPING          PIC  X(06).
   518     12  WS-AM-STATE             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1278.cbl
   519     12  WS-AM-ACCOUNT           PIC  X(10).
   520     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   521     12  WS-AM-FILLER            PIC  X(04).
   522
   523 01  WS-CN-CONTROL-PRIMARY.
   524     12  WS-CN-COMPANY-CD        PIC  X(01).
   525     12  WS-CN-CARRIER           PIC  X(01).
   526     12  WS-CN-GROUPING          PIC  X(06).
   527     12  WS-CN-STATE             PIC  X(02).
   528     12  WS-CN-ACCOUNT           PIC  X(10).
   529     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   530     12  WS-CN-CERT-NO.
   531         16  WS-CN-CERT-PRIME    PIC  X(10).
   532         16  WS-CN-CERT-SFX      PIC  X.
   533     12  WS-CN-REC-TYPE          PIC X.
   534     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   535
   536 01  WS-FO-CONTROL-PRIMARY.
   537     12  WS-FO-COMPANY-CD        PIC  X(01).
   538     12  WS-FO-STATE             PIC  X(02).
   539     12  WS-FO-FORM-ID           PIC  X(12).
   540     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1278.cbl
   542*                            COPY ERCCNOT.
   543******************************************************************
   544*                                                                *
   545*                            ERCCNOT                             *
   546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   547*                            VMOD=2.003                          *
   548*                                                                *
   549*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   550*                                                                *
   551*        FILE TYPE= VSAM,KSDS                                    *
   552*        RECORD SIZE = 150    RECFORM = FIXED                    *
   553*                                                                *
   554*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   555*                                                                *
   556*        LOG = YES                                               *
   557*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   558*                                                                *
   559******************************************************************
   560*                   C H A N G E   L O G
   561*
   562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   563*-----------------------------------------------------------------
   564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   565* EFFECTIVE    NUMBER
   566*-----------------------------------------------------------------
   567* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   568******************************************************************
   569
   570 01  CERT-NOTE-FILE.
   571     12  CZ-RECORD-ID                PIC  XX.
   572         88  VALID-CZ-ID                  VALUE 'CZ'.
   573
   574     12  CZ-CONTROL-PRIMARY.
   575         16  CZ-COMPANY-CD           PIC X.
   576         16  CZ-CARRIER              PIC X.
   577         16  CZ-GROUPING.
   578             20 CZ-GROUPING-PREFIX   PIC XXX.
   579             20 CZ-GROUPING-PRIME    PIC XXX.
   580         16  CZ-STATE                PIC XX.
   581         16  CZ-ACCOUNT.
   582             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   583             20 CZ-ACCOUNT-PRIME     PIC X(6).
   584         16  CZ-CERT-EFF-DT          PIC XX.
   585         16  CZ-CERT-NO.
   586             20  CZ-CERT-PRIME       PIC X(10).
   587             20  CZ-CERT-SFX         PIC X.
   588         16  CZ-RECORD-TYPE          PIC X.
   589             88  CERT-NOTE           VALUE '1'.
   590             88  CLAIM-CERT-NOTE     VALUE '2'.
   591         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   592
   593     12  CZ-LAST-MAINT-DT            PIC XX.
   594     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   595     12  CZ-LAST-MAINT-USER          PIC X(4).
   596
   597     12  CZ-NOTE-INFORMATION.
   598         16  CZ-NOTE                 PIC X(63).
   599         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1278.cbl
   600******************************************************************
   601*                            COPY ELCDATE.
   602******************************************************************
   603*                                                                *
   604*                                                                *
   605*                            ELCDATE.                            *
   606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   607*                            VMOD=2.003
   608*                                                                *
   609*                                                                *
   610*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   611*                 LENGTH = 200                                   *
   612******************************************************************
   613
   614 01  DATE-CONVERSION-DATA.
   615     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   616     12  DC-OPTION-CODE                PIC X.
   617         88  BIN-TO-GREG                VALUE ' '.
   618         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   619         88  EDIT-GREG-TO-BIN           VALUE '2'.
   620         88  YMD-GREG-TO-BIN            VALUE '3'.
   621         88  MDY-GREG-TO-BIN            VALUE '4'.
   622         88  JULIAN-TO-BIN              VALUE '5'.
   623         88  BIN-PLUS-ELAPSED           VALUE '6'.
   624         88  FIND-CENTURY               VALUE '7'.
   625         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   626         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   627         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   628         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   629         88  JULIAN-TO-BIN-3            VALUE 'C'.
   630         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   631         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   632         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   633         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   634         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   635         88  CHECK-LEAP-YEAR            VALUE 'H'.
   636         88  BIN-3-TO-GREG              VALUE 'I'.
   637         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   638         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   639         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   640         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   641         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   642         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   643         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   644         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   645         88  THREE-CHARACTER-BIN
   646                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   647         88  GREGORIAN-TO-BIN
   648                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   649         88  BIN-TO-GREGORIAN
   650                  VALUES ' ' '1' 'I' '8' 'G'.
   651         88  JULIAN-TO-BINARY
   652                  VALUES '5' 'C' 'E' 'F'.
   653     12  DC-ERROR-CODE                 PIC X.
   654         88  NO-CONVERSION-ERROR        VALUE ' '.
   655         88  DATE-CONVERSION-ERROR
   656                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   657         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1278.cbl
   658         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   659         88  DATE-IS-INVALID            VALUE '3'.
   660         88  DATE1-GREATER-DATE2        VALUE '4'.
   661         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   662         88  DATE-INVALID-OPTION        VALUE '9'.
   663         88  INVALID-CENTURY            VALUE 'A'.
   664         88  ONLY-CENTURY               VALUE 'B'.
   665         88  ONLY-LEAP-YEAR             VALUE 'C'.
   666         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   667     12  DC-END-OF-MONTH               PIC X.
   668         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   669     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   670         88  USE-NORMAL-PROCESS         VALUE ' '.
   671         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   672         88  ADJUST-UP-100-YRS          VALUE '2'.
   673     12  FILLER                        PIC X.
   674     12  DC-CONVERSION-DATES.
   675         16  DC-BIN-DATE-1             PIC XX.
   676         16  DC-BIN-DATE-2             PIC XX.
   677         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   678         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   679                       DC-GREG-DATE-1-EDIT.
   680             20  DC-EDIT1-MONTH        PIC 99.
   681             20  SLASH1-1              PIC X.
   682             20  DC-EDIT1-DAY          PIC 99.
   683             20  SLASH1-2              PIC X.
   684             20  DC-EDIT1-YEAR         PIC 99.
   685         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   686         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   687                     DC-GREG-DATE-2-EDIT.
   688             20  DC-EDIT2-MONTH        PIC 99.
   689             20  SLASH2-1              PIC X.
   690             20  DC-EDIT2-DAY          PIC 99.
   691             20  SLASH2-2              PIC X.
   692             20  DC-EDIT2-YEAR         PIC 99.
   693         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   694         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   695                     DC-GREG-DATE-1-YMD.
   696             20  DC-YMD-YEAR           PIC 99.
   697             20  DC-YMD-MONTH          PIC 99.
   698             20  DC-YMD-DAY            PIC 99.
   699         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   700         16  DC-GREG-DATE-1-MDY-R REDEFINES
   701                      DC-GREG-DATE-1-MDY.
   702             20  DC-MDY-MONTH          PIC 99.
   703             20  DC-MDY-DAY            PIC 99.
   704             20  DC-MDY-YEAR           PIC 99.
   705         16  DC-GREG-DATE-1-ALPHA.
   706             20  DC-ALPHA-MONTH        PIC X(10).
   707             20  DC-ALPHA-DAY          PIC 99.
   708             20  FILLER                PIC XX.
   709             20  DC-ALPHA-CENTURY.
   710                 24 DC-ALPHA-CEN-N     PIC 99.
   711             20  DC-ALPHA-YEAR         PIC 99.
   712         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   713         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   714         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   715         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1278.cbl
   716         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   717                                       PIC 9(05).
   718         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   719             20  DC-JULIAN-YEAR        PIC 99.
   720             20  DC-JULIAN-DAYS        PIC 999.
   721         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   722         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   723         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   724     12  DATE-CONVERSION-VARIBLES.
   725         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   726         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   727             20  FILLER                PIC 9(3).
   728             20  HOLD-CEN-1-CCYY.
   729                 24  HOLD-CEN-1-CC     PIC 99.
   730                 24  HOLD-CEN-1-YY     PIC 99.
   731             20  HOLD-CEN-1-MO         PIC 99.
   732             20  HOLD-CEN-1-DA         PIC 99.
   733         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   734             20  HOLD-CEN-1-R-MO       PIC 99.
   735             20  HOLD-CEN-1-R-DA       PIC 99.
   736             20  HOLD-CEN-1-R-CCYY.
   737                 24  HOLD-CEN-1-R-CC   PIC 99.
   738                 24  HOLD-CEN-1-R-YY   PIC 99.
   739             20  FILLER                PIC 9(3).
   740         16  HOLD-CENTURY-1-X.
   741             20  FILLER                PIC X(3)  VALUE SPACES.
   742             20  HOLD-CEN-1-X-CCYY.
   743                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   744                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   745             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   746             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   747         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   748             20  HOLD-CEN-1-R-X-MO     PIC XX.
   749             20  HOLD-CEN-1-R-X-DA     PIC XX.
   750             20  HOLD-CEN-1-R-X-CCYY.
   751                 24  HOLD-CEN-1-R-X-CC PIC XX.
   752                 24  HOLD-CEN-1-R-X-YY PIC XX.
   753             20  FILLER                PIC XXX.
   754         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   755         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   756         16  DC-JULIAN-DATE-1          PIC 9(07).
   757         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   758             20  DC-JULIAN-1-CCYY.
   759                 24  DC-JULIAN-1-CC    PIC 99.
   760                 24  DC-JULIAN-1-YR    PIC 99.
   761             20  DC-JULIAN-DA-1        PIC 999.
   762         16  DC-JULIAN-DATE-2          PIC 9(07).
   763         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   764             20  DC-JULIAN-2-CCYY.
   765                 24  DC-JULIAN-2-CC    PIC 99.
   766                 24  DC-JULIAN-2-YR    PIC 99.
   767             20  DC-JULIAN-DA-2        PIC 999.
   768         16  DC-GREG-DATE-A-EDIT.
   769             20  DC-EDITA-MONTH        PIC 99.
   770             20  SLASHA-1              PIC X VALUE '/'.
   771             20  DC-EDITA-DAY          PIC 99.
   772             20  SLASHA-2              PIC X VALUE '/'.
   773             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1278.cbl
   774                 24  DC-EDITA-CENT     PIC 99.
   775                 24  DC-EDITA-YEAR     PIC 99.
   776         16  DC-GREG-DATE-B-EDIT.
   777             20  DC-EDITB-MONTH        PIC 99.
   778             20  SLASHB-1              PIC X VALUE '/'.
   779             20  DC-EDITB-DAY          PIC 99.
   780             20  SLASHB-2              PIC X VALUE '/'.
   781             20  DC-EDITB-CCYY.
   782                 24  DC-EDITB-CENT     PIC 99.
   783                 24  DC-EDITB-YEAR     PIC 99.
   784         16  DC-GREG-DATE-CYMD         PIC 9(08).
   785         16  DC-GREG-DATE-CYMD-R REDEFINES
   786                              DC-GREG-DATE-CYMD.
   787             20  DC-CYMD-CEN           PIC 99.
   788             20  DC-CYMD-YEAR          PIC 99.
   789             20  DC-CYMD-MONTH         PIC 99.
   790             20  DC-CYMD-DAY           PIC 99.
   791         16  DC-GREG-DATE-MDCY         PIC 9(08).
   792         16  DC-GREG-DATE-MDCY-R REDEFINES
   793                              DC-GREG-DATE-MDCY.
   794             20  DC-MDCY-MONTH         PIC 99.
   795             20  DC-MDCY-DAY           PIC 99.
   796             20  DC-MDCY-CEN           PIC 99.
   797             20  DC-MDCY-YEAR          PIC 99.
   798    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   799        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   800    12  DC-EL310-DATE                  PIC X(21).
   801    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1278.cbl
   803*                            COPY ELCLOGOF.
   804******************************************************************
   805*                                                                *
   806*                                                                *
   807*                            ELCLOGOF.                           *
   808*                            VMOD=2.001                          *
   809*                                                                *
   810*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   811*                                                                *
   812******************************************************************
   813 01  CLASIC-LOGOFF.
   814     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   815     12  LOGOFF-TEXT.
   816         16  FILLER          PIC X(5)    VALUE SPACES.
   817         16  LOGOFF-MSG.
   818             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   819             20  FILLER      PIC X       VALUE SPACES.
   820             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   821         16  FILLER          PIC X(80)
   822           VALUE '* YOU ARE NOW LOGGED OFF'.
   823         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   824         16  FILLER          PIC X       VALUE QUOTE.
   825         16  LOGOFF-SYS-MSG  PIC X(17)
   826           VALUE 'S CLAS-IC SYSTEM '.
   827     12  TEXT-MESSAGES.
   828         16  UNACCESS-MSG    PIC X(29)
   829             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   830         16  PGMIDERR-MSG    PIC X(17)
   831             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1278.cbl
   833*                            COPY ELCATTR.
   834******************************************************************
   835*                                                                *
   836*                            ELCATTR.                            *
   837*                            VMOD=2.001                          *
   838*                                                                *
   839*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   840*                                                                *
   841*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   842*                                                                *
   843*                   POS 1   P=PROTECTED                          *
   844*                           U=UNPROTECTED                        *
   845*                           S=ASKIP                              *
   846*                   POS 2   A=ALPHA/NUMERIC                      *
   847*                           N=NUMERIC                            *
   848*                   POS 3   N=NORMAL                             *
   849*                           B=BRIGHT                             *
   850*                           D=DARK                               *
   851*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   852*                           OF=MODIFIED DATA TAG OFF             *
   853*                                                                *
   854*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   855******************************************************************
   856 01  ATTRIBUTE-LIST.
   857     12  AL-PABOF            PIC X       VALUE 'Y'.
   858     12  AL-PABON            PIC X       VALUE 'Z'.
   859     12  AL-PADOF            PIC X       VALUE '%'.
   860     12  AL-PADON            PIC X       VALUE '_'.
   861     12  AL-PANOF            PIC X       VALUE '-'.
   862     12  AL-PANON            PIC X       VALUE '/'.
   863     12  AL-SABOF            PIC X       VALUE '8'.
   864     12  AL-SABON            PIC X       VALUE '9'.
   865     12  AL-SADOF            PIC X       VALUE '@'.
   866     12  AL-SADON            PIC X       VALUE QUOTE.
   867     12  AL-SANOF            PIC X       VALUE '0'.
   868     12  AL-SANON            PIC X       VALUE '1'.
   869     12  AL-UABOF            PIC X       VALUE 'H'.
   870     12  AL-UABON            PIC X       VALUE 'I'.
   871     12  AL-UADOF            PIC X       VALUE '<'.
   872     12  AL-UADON            PIC X       VALUE '('.
   873     12  AL-UANOF            PIC X       VALUE ' '.
   874     12  AL-UANON            PIC X       VALUE 'A'.
   875     12  AL-UNBOF            PIC X       VALUE 'Q'.
   876     12  AL-UNBON            PIC X       VALUE 'R'.
   877     12  AL-UNDOF            PIC X       VALUE '*'.
   878     12  AL-UNDON            PIC X       VALUE ')'.
   879     12  AL-UNNOF            PIC X       VALUE '&'.
   880     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1278.cbl
   882*                            COPY ELCEMIB.
   883******************************************************************
   884*                                                                *
   885*                                                                *
   886*                            ELCEMIB.                            *
   887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   888*                            VMOD=2.005                          *
   889*                                                                *
   890*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   891*                                                                *
   892******************************************************************
   893 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   894     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   895     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   896     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   897     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   898     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   899     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   900     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   901     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   902     12  EMI-SWITCH1             PIC X        VALUE '1'.
   903         88  EMI-NO-ERRORS                    VALUE '1'.
   904         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   905         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   906     12  EMI-SWITCH2             PIC X        VALUE '1'.
   907         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   908     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   909         88  EMI-AREA1-EMPTY                  VALUE '1'.
   910         88  EMI-AREA1-FULL                   VALUE '2'.
   911     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   912         88  EMI-AREA2-EMPTY                  VALUE '1'.
   913         88  EMI-AREA2-FULL                   VALUE '2'.
   914     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   915         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   916         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   917         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   918         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   919         88  EMI-BYPASS-FATALS                VALUE 'X'.
   920     12  EMI-ERROR-LINES.
   921         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   922         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   923         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   924         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   925             20  EMI-ERR-CODES OCCURS 10 TIMES.
   926                 24  EMI-ERR-NUM         PIC X(4).
   927                 24  EMI-FILLER          PIC X.
   928                 24  EMI-SEV             PIC X.
   929                 24  FILLER              PIC X.
   930             20  FILLER                  PIC X(02).
   931     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   932         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   933             20  EMI-ERROR-NUMBER    PIC X(4).
   934             20  EMI-FILL            PIC X.
   935             20  EMI-SEVERITY        PIC X.
   936             20  FILLER              PIC X.
   937             20  EMI-ERROR-TEXT.
   938                 24  EMI-TEXT-VARIABLE   PIC X(10).
   939                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1278.cbl
   940     12  EMI-SEVERITY-SAVE           PIC X.
   941         88  EMI-NOTE                    VALUE 'N'.
   942         88  EMI-WARNING                 VALUE 'W'.
   943         88  EMI-FORCABLE                VALUE 'F'.
   944         88  EMI-FATAL                   VALUE 'X'.
   945     12  EMI-MESSAGE-FLAG            PIC X.
   946         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   947         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   948     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   949     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   950         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   951         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   952         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   953     12  FILLER                      PIC X(137)  VALUE SPACES.
   954     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   955     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   956     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   957     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1278.cbl
   959 01  WS-PASS-631.
   960     12  WS-PASS-WORK-AREA         PIC X(384).
   961     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   962     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   963*        COPY ELC631PI.
   964******************************************************************
   965*                                                                *
   966*                                                                *
   967*                            ELC631PI                            *
   968*                            VMOD=2.012                          *
   969*                                                                *
   970*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   971*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   972*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   973*                                                                *
   974*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   975*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   976*    BETWEEN PROGRAMS.                                           *
   977*                                                                *
   978*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   979*                                                                *
   980*               EL631 - EL6311 - EL6312 - EL6313                 *
   981*                                                                *
   982******************************************************************
   983
   984         16  PI-631-DATA.
   985             20  PI-ERPNDB-KEY.
   986                 24  PI-PB-COMPANY-CD     PIC X.
   987                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   988                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   989                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   990
   991             20  PI-ERPNDB-ALT-KEY.
   992                 24  PI-PB-COMPANY-CD-A1  PIC X.
   993                 24  PI-PB-CARRIER        PIC X.
   994                 24  PI-PB-GROUPING       PIC X(6).
   995                 24  PI-PB-STATE          PIC XX.
   996                 24  PI-PB-ACCOUNT        PIC X(10).
   997                 24  PI-PB-CERT-EFF-DT    PIC XX.
   998                 24  PI-PB-CERT-NO.
   999                     28  PI-PB-CERT-PRIME PIC X(10).
  1000                     28  PI-PB-CERT-SFX   PIC X.
  1001                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1002                 24  PI-PB-RECORD-TYPE    PIC X.
  1003
  1004             20  PI-ERPNDB-CSR-KEY.
  1005                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1006                 24  PI-PB-CSR-ID             PIC X(4).
  1007                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1008                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1009                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1010
  1011             20  PI-BROWSE-TYPE               PIC X.
  1012                 88  PI-FILE-BROWSE             VALUE ' '.
  1013                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1014                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1015                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1016                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1278.cbl
  1017
  1018             20  PI-MAINT-FUNCTION            PIC X.
  1019                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1020                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1021                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1022                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1023                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1024                 88  PI-PF5-FUNCTION            VALUE '5'.
  1025                 88  PI-PF6-FUNCTION            VALUE '6'.
  1026
  1027             20  PI-FILE-SWITCHES.
  1028                 24  PI-ALL-ISSUES-SW         PIC X.
  1029                     88  ALL-ISSUES             VALUE 'Y'.
  1030                 24  PI-ALL-CANCELS-SW        PIC X.
  1031                     88  ALL-CANCELS            VALUE 'Y'.
  1032                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1033                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1034                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1035                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1036                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1037                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1038                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1039                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1040                 24  PI-HOLD-REC-SW           PIC X.
  1041                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1042                 24  PI-CHANGE-REC-SW         PIC X.
  1043                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1044                 24  PI-CHK-REQ-REC-SW        PIC X.
  1045                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1046                 24  PI-ISSUE-WARNING-SW      PIC X.
  1047                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1048                 24  PI-CANCEL-WARNING-SW     PIC X.
  1049                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1050             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1051                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1052             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1053                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1054
  1055             20  PI-MAP-NAME                  PIC X(8).
  1056
  1057             20  PI-CURSOR                    PIC S9(4) COMP.
  1058
  1059             20  PI-PREV-ALT-KEY              PIC X(36).
  1060             20  PI-PREV-CSR-KEY              PIC X(15).
  1061             20  PI-PREV-KEY.
  1062                 24  PI-PREV-COMPANY-CD       PIC X.
  1063                 24  PI-PREV-BATCH            PIC X(6).
  1064                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1065                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1066             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1067             20  PI-BROWSE-SW                 PIC X.
  1068                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1069                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1070             20  PI-SV-CARRIER                PIC X.
  1071             20  PI-SV-GROUPING               PIC X(6).
  1072             20  PI-SV-STATE                  PIC XX.
  1073             20  PI-EDIT-SW                   PIC X.
  1074             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1278.cbl
  1075                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1076                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1077             20  PI-CRITERIA-DATA             PIC X(350).
  1078             20  PI-BMODE                     PIC X.
  1079             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1080             20  PI-BPMTS                     PIC S999     COMP-3.
  1081             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1082             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1083             20  PI-CSR-SESSION-SW            PIC X.
  1084                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1085             20  PI-ERRORS-SW                 PIC X.
  1086                 88  FATAL-ERRORS               VALUE 'X'.
  1087*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1088             20  FILLER                       PIC X(5).
  1089
  1090         16  FILLER                PIC X(94).
  1091
  1092
  1093*                            COPY ELCINTF.
  1094******************************************************************
  1095*                                                                *
  1096*                                                                *
  1097*                            ELCINTF.                            *
  1098*                            VMOD=2.017                          *
  1099*                                                                *
  1100*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1101*                                                                *
  1102*       LENGTH = 1024                                            *
  1103*                                                                *
  1104******************************************************************
  1105*                   C H A N G E   L O G
  1106*
  1107* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1108*-----------------------------------------------------------------
  1109*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1110* EFFECTIVE    NUMBER
  1111*-----------------------------------------------------------------
  1112* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1113******************************************************************
  1114 01  PROGRAM-INTERFACE-BLOCK.
  1115     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1116     12  PI-CALLING-PROGRAM              PIC X(8).
  1117     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1118     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1119     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1120     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1121     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1122     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1123     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1124     12  PI-COMPANY-ID                   PIC XXX.
  1125     12  PI-COMPANY-CD                   PIC X.
  1126
  1127     12  PI-COMPANY-PASSWORD             PIC X(8).
  1128
  1129     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1130
  1131     12  PI-CONTROL-IN-PROGRESS.
  1132         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1278.cbl
  1133         16  PI-GROUPING                 PIC X(6).
  1134         16  PI-STATE                    PIC XX.
  1135         16  PI-ACCOUNT                  PIC X(10).
  1136         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1137                                         PIC X(10).
  1138         16  PI-CLAIM-CERT-GRP.
  1139             20  PI-CLAIM-NO             PIC X(7).
  1140             20  PI-CERT-NO.
  1141                 25  PI-CERT-PRIME       PIC X(10).
  1142                 25  PI-CERT-SFX         PIC X.
  1143             20  PI-CERT-EFF-DT          PIC XX.
  1144         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1145             20  PI-PLAN-CODE            PIC X(2).
  1146             20  PI-REVISION-NUMBER      PIC X(3).
  1147             20  PI-PLAN-EFF-DT          PIC X(2).
  1148             20  PI-PLAN-EXP-DT          PIC X(2).
  1149             20  FILLER                  PIC X(11).
  1150         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1151             20  PI-OE-REFERENCE-1.
  1152                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1153                 25  PI-OE-REF-1-SUFF    PIC XX.
  1154
  1155     12  PI-SESSION-IN-PROGRESS          PIC X.
  1156         88  CLAIM-SESSION                   VALUE '1'.
  1157         88  CREDIT-SESSION                  VALUE '2'.
  1158         88  WARRANTY-SESSION                VALUE '3'.
  1159         88  MORTGAGE-SESSION                VALUE '4'.
  1160         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1161
  1162
  1163*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1164
  1165     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1166     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1167
  1168     12  PI-CREDIT-USER                  PIC X.
  1169         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1170         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1171
  1172     12  PI-CLAIM-USER                   PIC X.
  1173         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1174         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1175
  1176     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1177         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1178         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1179         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1180         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1181         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1182
  1183     12  PI-PROCESSOR-ID                 PIC X(4).
  1184
  1185     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1186
  1187     12  PI-MEMBER-CAPTION               PIC X(10).
  1188
  1189     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1190         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1278.cbl
  1191
  1192     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1193     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1194     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1195     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1196
  1197     12  PI-AH-OVERRIDE-L1               PIC X.
  1198     12  PI-AH-OVERRIDE-L2               PIC XX.
  1199     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1200     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1201
  1202     12  PI-NEW-SYSTEM                   PIC X(2).
  1203
  1204     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1205     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1206         88  PI-USES-PAID-TO                 VALUE '1'.
  1207     12  PI-CRDTCRD-SYSTEM.
  1208         16  PI-CRDTCRD-USER             PIC X.
  1209             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1210             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1211         16  PI-CC-MONTH-END-DT          PIC XX.
  1212     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1213
  1214     12  PI-OE-REFERENCE-2.
  1215         16  PI-OE-REF-2-PRIME           PIC X(10).
  1216         16  PI-OE-REF-2-SUFF            PIC X.
  1217
  1218     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1219
  1220     12  PI-LANGUAGE-TYPE                PIC X.
  1221             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1222             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1223             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1224
  1225     12  PI-POLICY-LINKAGE-IND           PIC X.
  1226         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1227         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1228                                                   LOW-VALUES.
  1229
  1230     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1231     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1232         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1233         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1234
  1235     12  PI-PROCESSOR-CSR-IND            PIC X.
  1236         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1237         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1238
  1239     12  FILLER                          PIC X(3).
  1240
  1241     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1242
  1243     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1244         PI-SYSTEM-LEVEL.
  1245
  1246         16  PI-ENTRY-CODES.
  1247             20  PI-ENTRY-CD-1           PIC X.
  1248             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1278.cbl
  1249
  1250         16  PI-RETURN-CODES.
  1251             20  PI-RETURN-CD-1          PIC X.
  1252             20  PI-RETURN-CD-2          PIC X.
  1253
  1254         16  PI-UPDATE-STATUS-SAVE.
  1255             20  PI-UPDATE-BY            PIC X(4).
  1256             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1257
  1258         16  PI-LOWER-CASE-LETTERS       PIC X.
  1259             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1260
  1261*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1262*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1263*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1264
  1265         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1266             88  ST-ACCNT-CNTL               VALUE ' '.
  1267             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1268             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1269             88  ACCNT-CNTL                  VALUE '3'.
  1270             88  CARR-ACCNT-CNTL             VALUE '4'.
  1271
  1272         16  PI-PROCESSOR-CAP-LIST.
  1273             20  PI-SYSTEM-CONTROLS.
  1274                24 PI-SYSTEM-DISPLAY     PIC X.
  1275                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1276                24 PI-SYSTEM-MODIFY      PIC X.
  1277                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1278             20  FILLER                  PIC XX.
  1279             20  PI-DISPLAY-CAP          PIC X.
  1280                 88  DISPLAY-CAP             VALUE 'Y'.
  1281             20  PI-MODIFY-CAP           PIC X.
  1282                 88  MODIFY-CAP              VALUE 'Y'.
  1283             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1284                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1285             20  PI-FORCE-CAP            PIC X.
  1286                 88  FORCE-CAP               VALUE 'Y'.
  1287
  1288         16  PI-PROGRAM-CONTROLS.
  1289             20  PI-PGM-PRINT-OPT        PIC X.
  1290             20  PI-PGM-FORMAT-OPT       PIC X.
  1291             20  PI-PGM-PROCESS-OPT      PIC X.
  1292             20  PI-PGM-TOTALS-OPT       PIC X.
  1293
  1294         16  PI-HELP-INTERFACE.
  1295             20  PI-LAST-ERROR-NO        PIC X(4).
  1296             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1297
  1298         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1299             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1300
  1301         16  PI-CR-CONTROL-IN-PROGRESS.
  1302             20  PI-CR-CARRIER           PIC X.
  1303             20  PI-CR-GROUPING          PIC X(6).
  1304             20  PI-CR-STATE             PIC XX.
  1305             20  PI-CR-ACCOUNT           PIC X(10).
  1306             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1278.cbl
  1307             20  PI-CR-TYPE              PIC X.
  1308
  1309         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1310
  1311         16  PI-CR-MONTH-END-DT          PIC XX.
  1312
  1313         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1314             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1315             88  PI-ZERO-CARRIER             VALUE '1'.
  1316             88  PI-ZERO-GROUPING            VALUE '2'.
  1317             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1318
  1319         16  PI-CARRIER-SECURITY         PIC X.
  1320             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1321
  1322         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1323             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1324             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1325
  1326         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1327             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1328                                         INDEXED BY PI-ACCESS-NDX
  1329                                         PIC X.
  1330
  1331         16  PI-GA-BILLING-CONTROL       PIC X.
  1332             88  PI-GA-BILLING               VALUE '1'.
  1333
  1334         16  PI-MAIL-PROCESSING          PIC X.
  1335             88  PI-MAIL-YES                 VALUE 'Y'.
  1336
  1337         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1338
  1339         16  PI-AR-SYSTEM.
  1340             20  PI-AR-PROCESSING-CNTL   PIC X.
  1341                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1342             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1343             20  PI-AR-MONTH-END-DT      PIC XX.
  1344
  1345         16  PI-MP-SYSTEM.
  1346             20  PI-MORTGAGE-USER            PIC X.
  1347                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1348                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1349             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1350                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1351                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1352                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1353                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1354                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1355             20  PI-MP-MONTH-END-DT          PIC XX.
  1356             20  PI-MP-REFERENCE-NO.
  1357                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1358                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1359
  1360         16  PI-LABEL-CONTROL            PIC X(01).
  1361             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1362             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1363
  1364         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1278.cbl
  1365             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1366
  1367         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1368             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1369             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1370
  1371         16  FILLER                      PIC X(14).
  1372
  1373     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1374******************************************************************
  1375     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1376         16  FILLER                PIC  X(500).
  1377         16  PI-PEND-SW            PIC  X(01).
  1378         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1379         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1380         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1381         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1382         16  PI-EARNING-METHOD-LF  PIC  X.
  1383         16  PI-EARNING-METHOD-AH  PIC  X.
  1384         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1385         16  PI-LF-REFUND-METH     PIC  X.
  1386         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1387         16  PI-AH-REFUND-METH     PIC  X.
  1388         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1389         16  PI-MODIFY-CERT-CAP    PIC  X.
  1390             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1391         16  PI-CLP-YN             PIC X.
  1392         16  PI-CANCEL-REASON      PIC X.
  1393         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1278.cbl
  1395*                            COPY ELCAID.
  1396******************************************************************
  1397*                                                                *
  1398*                            ELCAID.                             *
  1399*                            VMOD=2.001                          *
  1400*                                                                *
  1401*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1402*                                                                *
  1403*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1404*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1405******************************************************************
  1406
  1407 01  DFHAID.
  1408   02  DFHNULL   PIC  X  VALUE  ' '.
  1409   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1410   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1411   02  DFHPEN    PIC  X  VALUE  '='.
  1412   02  DFHOPID   PIC  X  VALUE  'W'.
  1413   02  DFHPA1    PIC  X  VALUE  '%'.
  1414   02  DFHPA2    PIC  X  VALUE  '>'.
  1415   02  DFHPA3    PIC  X  VALUE  ','.
  1416   02  DFHPF1    PIC  X  VALUE  '1'.
  1417   02  DFHPF2    PIC  X  VALUE  '2'.
  1418   02  DFHPF3    PIC  X  VALUE  '3'.
  1419   02  DFHPF4    PIC  X  VALUE  '4'.
  1420   02  DFHPF5    PIC  X  VALUE  '5'.
  1421   02  DFHPF6    PIC  X  VALUE  '6'.
  1422   02  DFHPF7    PIC  X  VALUE  '7'.
  1423   02  DFHPF8    PIC  X  VALUE  '8'.
  1424   02  DFHPF9    PIC  X  VALUE  '9'.
  1425   02  DFHPF10   PIC  X  VALUE  ':'.
  1426   02  DFHPF11   PIC  X  VALUE  '#'.
  1427   02  DFHPF12   PIC  X  VALUE  '@'.
  1428   02  DFHPF13   PIC  X  VALUE  'A'.
  1429   02  DFHPF14   PIC  X  VALUE  'B'.
  1430   02  DFHPF15   PIC  X  VALUE  'C'.
  1431   02  DFHPF16   PIC  X  VALUE  'D'.
  1432   02  DFHPF17   PIC  X  VALUE  'E'.
  1433   02  DFHPF18   PIC  X  VALUE  'F'.
  1434   02  DFHPF19   PIC  X  VALUE  'G'.
  1435   02  DFHPF20   PIC  X  VALUE  'H'.
  1436   02  DFHPF21   PIC  X  VALUE  'I'.
  1437*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1438   02  DFHPF22   PIC  X  VALUE  '['.
  1439   02  DFHPF23   PIC  X  VALUE  '.'.
  1440   02  DFHPF24   PIC  X  VALUE  '<'.
  1441   02  DFHMSRE   PIC  X  VALUE  'X'.
  1442   02  DFHSTRF   PIC  X  VALUE  'h'.
  1443   02  DFHTRIG   PIC  X  VALUE  '"'.
  1444
  1445 01  FILLER  REDEFINES  DFHAID.
  1446     12  FILLER                  PIC  X(08).
  1447     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1278.cbl
  1449*                            COPY EL1278S.
  1450 01  EL127HI.
  1451     05  FILLER            PIC  X(0012).
  1452*    -------------------------------
  1453     05  HDATEL PIC S9(0004) COMP.
  1454     05  HDATEF PIC  X(0001).
  1455     05  FILLER REDEFINES HDATEF.
  1456         10  HDATEA PIC  X(0001).
  1457     05  HDATEI PIC  X(0008).
  1458*    -------------------------------
  1459     05  HTIMEL PIC S9(0004) COMP.
  1460     05  HTIMEF PIC  X(0001).
  1461     05  FILLER REDEFINES HTIMEF.
  1462         10  HTIMEA PIC  X(0001).
  1463     05  HTIMEI PIC  999V99.
  1464*    -------------------------------
  1465     05  CMPNYIDL PIC S9(0004) COMP.
  1466     05  CMPNYIDF PIC  X(0001).
  1467     05  FILLER REDEFINES CMPNYIDF.
  1468         10  CMPNYIDA PIC  X(0001).
  1469     05  CMPNYIDI PIC  X(0003).
  1470*    -------------------------------
  1471     05  USERIDL PIC S9(0004) COMP.
  1472     05  USERIDF PIC  X(0001).
  1473     05  FILLER REDEFINES USERIDF.
  1474         10  USERIDA PIC  X(0001).
  1475     05  USERIDI PIC  X(0004).
  1476*    -------------------------------
  1477     05  HCARIERL PIC S9(0004) COMP.
  1478     05  HCARIERF PIC  X(0001).
  1479     05  FILLER REDEFINES HCARIERF.
  1480         10  HCARIERA PIC  X(0001).
  1481     05  HCARIERI PIC  X(0001).
  1482*    -------------------------------
  1483     05  HGROUPL PIC S9(0004) COMP.
  1484     05  HGROUPF PIC  X(0001).
  1485     05  FILLER REDEFINES HGROUPF.
  1486         10  HGROUPA PIC  X(0001).
  1487     05  HGROUPI PIC  X(0006).
  1488*    -------------------------------
  1489     05  HSTATEL PIC S9(0004) COMP.
  1490     05  HSTATEF PIC  X(0001).
  1491     05  FILLER REDEFINES HSTATEF.
  1492         10  HSTATEA PIC  X(0001).
  1493     05  HSTATEI PIC  X(0002).
  1494*    -------------------------------
  1495     05  HACCTNOL PIC S9(0004) COMP.
  1496     05  HACCTNOF PIC  X(0001).
  1497     05  FILLER REDEFINES HACCTNOF.
  1498         10  HACCTNOA PIC  X(0001).
  1499     05  HACCTNOI PIC  X(0010).
  1500*    -------------------------------
  1501     05  HEFFDTL PIC S9(0004) COMP.
  1502     05  HEFFDTF PIC  X(0001).
  1503     05  FILLER REDEFINES HEFFDTF.
  1504         10  HEFFDTA PIC  X(0001).
  1505     05  HEFFDTI PIC  X(0008).
  1506*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1278.cbl
  1507     05  HCERTNOL PIC S9(0004) COMP.
  1508     05  HCERTNOF PIC  X(0001).
  1509     05  FILLER REDEFINES HCERTNOF.
  1510         10  HCERTNOA PIC  X(0001).
  1511     05  HCERTNOI PIC  X(0010).
  1512*    -------------------------------
  1513     05  HCRTSFXL PIC S9(0004) COMP.
  1514     05  HCRTSFXF PIC  X(0001).
  1515     05  FILLER REDEFINES HCRTSFXF.
  1516         10  HCRTSFXA PIC  X(0001).
  1517     05  HCRTSFXI PIC  X(0001).
  1518*    -------------------------------
  1519     05  HLNAMEL PIC S9(0004) COMP.
  1520     05  HLNAMEF PIC  X(0001).
  1521     05  FILLER REDEFINES HLNAMEF.
  1522         10  HLNAMEA PIC  X(0001).
  1523     05  HLNAMEI PIC  X(0015).
  1524*    -------------------------------
  1525     05  HFNAMEL PIC S9(0004) COMP.
  1526     05  HFNAMEF PIC  X(0001).
  1527     05  FILLER REDEFINES HFNAMEF.
  1528         10  HFNAMEA PIC  X(0001).
  1529     05  HFNAMEI PIC  X(0010).
  1530*    -------------------------------
  1531     05  HINITL PIC S9(0004) COMP.
  1532     05  HINITF PIC  X(0001).
  1533     05  FILLER REDEFINES HINITF.
  1534         10  HINITA PIC  X(0001).
  1535     05  HINITI PIC  X(0001).
  1536*    -------------------------------
  1537     05  LCLMDTHL PIC S9(0004) COMP.
  1538     05  LCLMDTHF PIC  X(0001).
  1539     05  FILLER REDEFINES LCLMDTHF.
  1540         10  LCLMDTHA PIC  X(0001).
  1541     05  LCLMDTHI PIC  X(0022).
  1542*    -------------------------------
  1543     05  LCLMDTL PIC S9(0004) COMP.
  1544     05  LCLMDTF PIC  X(0001).
  1545     05  FILLER REDEFINES LCLMDTF.
  1546         10  LCLMDTA PIC  X(0001).
  1547     05  LCLMDTI PIC  X(0008).
  1548*    -------------------------------
  1549     05  HPCYNL PIC S9(0004) COMP.
  1550     05  HPCYNF PIC  X(0001).
  1551     05  FILLER REDEFINES HPCYNF.
  1552         10  HPCYNA PIC  X(0001).
  1553     05  HPCYNI PIC  X(0001).
  1554*    -------------------------------
  1555     05  ACLMDTHL PIC S9(0004) COMP.
  1556     05  ACLMDTHF PIC  X(0001).
  1557     05  FILLER REDEFINES ACLMDTHF.
  1558         10  ACLMDTHA PIC  X(0001).
  1559     05  ACLMDTHI PIC  X(0023).
  1560*    -------------------------------
  1561     05  ACLMDTL PIC S9(0004) COMP.
  1562     05  ACLMDTF PIC  X(0001).
  1563     05  FILLER REDEFINES ACLMDTF.
  1564         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1278.cbl
  1565     05  ACLMDTI PIC  X(0008).
  1566*    -------------------------------
  1567     05  PMTHDL PIC S9(0004) COMP.
  1568     05  PMTHDF PIC  X(0001).
  1569     05  FILLER REDEFINES PMTHDF.
  1570         10  PMTHDA PIC  X(0001).
  1571     05  PMTHDI PIC  X(0010).
  1572*    -------------------------------
  1573     05  CNCDTHDL PIC S9(0004) COMP.
  1574     05  CNCDTHDF PIC  X(0001).
  1575     05  FILLER REDEFINES CNCDTHDF.
  1576         10  CNCDTHDA PIC  X(0001).
  1577     05  CNCDTHDI PIC  X(0007).
  1578*    -------------------------------
  1579     05  HLKINDL PIC S9(0004) COMP.
  1580     05  HLKINDF PIC  X(0001).
  1581     05  FILLER REDEFINES HLKINDF.
  1582         10  HLKINDA PIC  X(0001).
  1583     05  HLKINDI PIC  X(0002).
  1584*    -------------------------------
  1585     05  HLCDL PIC S9(0004) COMP.
  1586     05  HLCDF PIC  X(0001).
  1587     05  FILLER REDEFINES HLCDF.
  1588         10  HLCDA PIC  X(0001).
  1589     05  HLCDI PIC  X(0002).
  1590*    -------------------------------
  1591     05  HLEDESCL PIC S9(0004) COMP.
  1592     05  HLEDESCF PIC  X(0001).
  1593     05  FILLER REDEFINES HLEDESCF.
  1594         10  HLEDESCA PIC  X(0001).
  1595     05  HLEDESCI PIC  X(0003).
  1596*    -------------------------------
  1597     05  HLTERML PIC S9(0004) COMP.
  1598     05  HLTERMF PIC  X(0001).
  1599     05  FILLER REDEFINES HLTERMF.
  1600         10  HLTERMA PIC  X(0001).
  1601     05  HLTERMI PIC  9(3).
  1602*    -------------------------------
  1603     05  HLREML PIC S9(0004) COMP.
  1604     05  HLREMF PIC  X(0001).
  1605     05  FILLER REDEFINES HLREMF.
  1606         10  HLREMA PIC  X(0001).
  1607     05  HLREMI PIC  X(0003).
  1608*    -------------------------------
  1609     05  HLPREML PIC S9(0004) COMP.
  1610     05  HLPREMF PIC  X(0001).
  1611     05  FILLER REDEFINES HLPREMF.
  1612         10  HLPREMA PIC  X(0001).
  1613     05  HLPREMI PIC  X(0011).
  1614*    -------------------------------
  1615     05  HLITDRL PIC S9(0004) COMP.
  1616     05  HLITDRF PIC  X(0001).
  1617     05  FILLER REDEFINES HLITDRF.
  1618         10  HLITDRA PIC  X(0001).
  1619     05  HLITDRI PIC  X(0011).
  1620*    -------------------------------
  1621     05  HLREFNDL PIC S9(0004) COMP.
  1622     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1278.cbl
  1623     05  FILLER REDEFINES HLREFNDF.
  1624         10  HLREFNDA PIC  X(0001).
  1625     05  HLREFNDI PIC  X(0011).
  1626*    -------------------------------
  1627     05  HLCANCL PIC S9(0004) COMP.
  1628     05  HLCANCF PIC  X(0001).
  1629     05  FILLER REDEFINES HLCANCF.
  1630         10  HLCANCA PIC  X(0001).
  1631     05  HLCANCI PIC  X(0008).
  1632*    -------------------------------
  1633     05  HLCAL1L PIC S9(0004) COMP.
  1634     05  HLCAL1F PIC  X(0001).
  1635     05  FILLER REDEFINES HLCAL1F.
  1636         10  HLCAL1A PIC  X(0001).
  1637     05  HLCAL1I PIC  X(0001).
  1638*    -------------------------------
  1639     05  HLCALCL PIC S9(0004) COMP.
  1640     05  HLCALCF PIC  X(0001).
  1641     05  FILLER REDEFINES HLCALCF.
  1642         10  HLCALCA PIC  X(0001).
  1643     05  HLCALCI PIC  X(0012).
  1644*    -------------------------------
  1645     05  HAKINDL PIC S9(0004) COMP.
  1646     05  HAKINDF PIC  X(0001).
  1647     05  FILLER REDEFINES HAKINDF.
  1648         10  HAKINDA PIC  X(0001).
  1649     05  HAKINDI PIC  X(0002).
  1650*    -------------------------------
  1651     05  HACDL PIC S9(0004) COMP.
  1652     05  HACDF PIC  X(0001).
  1653     05  FILLER REDEFINES HACDF.
  1654         10  HACDA PIC  X(0001).
  1655     05  HACDI PIC  X(0002).
  1656*    -------------------------------
  1657     05  HAEDESCL PIC S9(0004) COMP.
  1658     05  HAEDESCF PIC  X(0001).
  1659     05  FILLER REDEFINES HAEDESCF.
  1660         10  HAEDESCA PIC  X(0001).
  1661     05  HAEDESCI PIC  X(0003).
  1662*    -------------------------------
  1663     05  HATERML PIC S9(0004) COMP.
  1664     05  HATERMF PIC  X(0001).
  1665     05  FILLER REDEFINES HATERMF.
  1666         10  HATERMA PIC  X(0001).
  1667     05  HATERMI PIC  9(3).
  1668*    -------------------------------
  1669     05  HAREML PIC S9(0004) COMP.
  1670     05  HAREMF PIC  X(0001).
  1671     05  FILLER REDEFINES HAREMF.
  1672         10  HAREMA PIC  X(0001).
  1673     05  HAREMI PIC  X(0003).
  1674*    -------------------------------
  1675     05  HAPREML PIC S9(0004) COMP.
  1676     05  HAPREMF PIC  X(0001).
  1677     05  FILLER REDEFINES HAPREMF.
  1678         10  HAPREMA PIC  X(0001).
  1679     05  HAPREMI PIC  X(0011).
  1680*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1278.cbl
  1681     05  HAITDRL PIC S9(0004) COMP.
  1682     05  HAITDRF PIC  X(0001).
  1683     05  FILLER REDEFINES HAITDRF.
  1684         10  HAITDRA PIC  X(0001).
  1685     05  HAITDRI PIC  X(0011).
  1686*    -------------------------------
  1687     05  HAREFNDL PIC S9(0004) COMP.
  1688     05  HAREFNDF PIC  X(0001).
  1689     05  FILLER REDEFINES HAREFNDF.
  1690         10  HAREFNDA PIC  X(0001).
  1691     05  HAREFNDI PIC  X(0011).
  1692*    -------------------------------
  1693     05  HACANCL PIC S9(0004) COMP.
  1694     05  HACANCF PIC  X(0001).
  1695     05  FILLER REDEFINES HACANCF.
  1696         10  HACANCA PIC  X(0001).
  1697     05  HACANCI PIC  X(0008).
  1698*    -------------------------------
  1699     05  HACAL1L PIC S9(0004) COMP.
  1700     05  HACAL1F PIC  X(0001).
  1701     05  FILLER REDEFINES HACAL1F.
  1702         10  HACAL1A PIC  X(0001).
  1703     05  HACAL1I PIC  X(0001).
  1704*    -------------------------------
  1705     05  HACALCL PIC S9(0004) COMP.
  1706     05  HACALCF PIC  X(0001).
  1707     05  FILLER REDEFINES HACALCF.
  1708         10  HACALCA PIC  X(0001).
  1709     05  HACALCI PIC  X(0012).
  1710*    -------------------------------
  1711     05  TOPREML PIC S9(0004) COMP.
  1712     05  TOPREMF PIC  X(0001).
  1713     05  FILLER REDEFINES TOPREMF.
  1714         10  TOPREMA PIC  X(0001).
  1715     05  TOPREMI PIC  X(0011).
  1716*    -------------------------------
  1717     05  TOITDRL PIC S9(0004) COMP.
  1718     05  TOITDRF PIC  X(0001).
  1719     05  FILLER REDEFINES TOITDRF.
  1720         10  TOITDRA PIC  X(0001).
  1721     05  TOITDRI PIC  X(0011).
  1722*    -------------------------------
  1723     05  TORFNDL PIC S9(0004) COMP.
  1724     05  TORFNDF PIC  X(0001).
  1725     05  FILLER REDEFINES TORFNDF.
  1726         10  TORFNDA PIC  X(0001).
  1727     05  TORFNDI PIC  X(0011).
  1728*    -------------------------------
  1729     05  CANREAHL PIC S9(0004) COMP.
  1730     05  CANREAHF PIC  X(0001).
  1731     05  FILLER REDEFINES CANREAHF.
  1732         10  CANREAHA PIC  X(0001).
  1733     05  CANREAHI PIC  X(0015).
  1734*    -------------------------------
  1735     05  CANREAL PIC S9(0004) COMP.
  1736     05  CANREAF PIC  X(0001).
  1737     05  FILLER REDEFINES CANREAF.
  1738         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1278.cbl
  1739     05  CANREAI PIC  X(0001).
  1740*    -------------------------------
  1741     05  CLPYNHL PIC S9(0004) COMP.
  1742     05  CLPYNHF PIC  X(0001).
  1743     05  FILLER REDEFINES CLPYNHF.
  1744         10  CLPYNHA PIC  X(0001).
  1745     05  CLPYNHI PIC  X(0005).
  1746*    -------------------------------
  1747     05  CLPYNL PIC S9(0004) COMP.
  1748     05  CLPYNF PIC  X(0001).
  1749     05  FILLER REDEFINES CLPYNF.
  1750         10  CLPYNA PIC  X(0001).
  1751     05  CLPYNI PIC  X(0001).
  1752*    -------------------------------
  1753     05  HLREDL PIC S9(0004) COMP.
  1754     05  HLREDF PIC  X(0001).
  1755     05  FILLER REDEFINES HLREDF.
  1756         10  HLREDA PIC  X(0001).
  1757     05  HLREDI PIC  X(0014).
  1758*    -------------------------------
  1759     05  FREMTRML PIC S9(0004) COMP.
  1760     05  FREMTRMF PIC  X(0001).
  1761     05  FILLER REDEFINES FREMTRMF.
  1762         10  FREMTRMA PIC  X(0001).
  1763     05  FREMTRMI PIC  X(0003).
  1764*    -------------------------------
  1765     05  HERMSG1L PIC S9(0004) COMP.
  1766     05  HERMSG1F PIC  X(0001).
  1767     05  FILLER REDEFINES HERMSG1F.
  1768         10  HERMSG1A PIC  X(0001).
  1769     05  HERMSG1I PIC  X(0079).
  1770*    -------------------------------
  1771     05  HERMSG2L PIC S9(0004) COMP.
  1772     05  HERMSG2F PIC  X(0001).
  1773     05  FILLER REDEFINES HERMSG2F.
  1774         10  HERMSG2A PIC  X(0001).
  1775     05  HERMSG2I PIC  X(0079).
  1776*    -------------------------------
  1777     05  HPFKEYL PIC S9(0004) COMP.
  1778     05  HPFKEYF PIC  X(0001).
  1779     05  FILLER REDEFINES HPFKEYF.
  1780         10  HPFKEYA PIC  X(0001).
  1781     05  HPFKEYI PIC  99.
  1782*    -------------------------------
  1783     05  PFKEY11L PIC S9(0004) COMP.
  1784     05  PFKEY11F PIC  X(0001).
  1785     05  FILLER REDEFINES PFKEY11F.
  1786         10  PFKEY11A PIC  X(0001).
  1787     05  PFKEY11I PIC  X(0034).
  1788 01  EL127HO REDEFINES EL127HI.
  1789     05  FILLER            PIC  X(0012).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  HDATEO PIC  X(0008).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  HTIMEO PIC  99.99.
  1796*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1278.cbl
  1797     05  FILLER            PIC  X(0003).
  1798     05  CMPNYIDO PIC  X(0003).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  USERIDO PIC  X(0004).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  HCARIERO PIC  X(0001).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  HGROUPO PIC  X(0006).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  HSTATEO PIC  X(0002).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  HACCTNOO PIC  X(0010).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  HEFFDTO PIC  X(0008).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  HCERTNOO PIC  X(0010).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  HCRTSFXO PIC  X(0001).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  HLNAMEO PIC  X(0015).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  HFNAMEO PIC  X(0010).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  HINITO PIC  X(0001).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  LCLMDTHO PIC  X(0022).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  LCLMDTO PIC  X(0008).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  HPCYNO PIC  X(0001).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  ACLMDTHO PIC  X(0023).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  ACLMDTO PIC  X(0008).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  PMTHDO PIC  X(0010).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  CNCDTHDO PIC  X(0007).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1278.cbl
  1855     05  HLKINDO PIC  X(0002).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  HLCDO PIC  X(0002).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  HLEDESCO PIC  X(0003).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  HLTERMO PIC  ZZ9.
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  HLREMO PIC  ZZ9.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HLCANCO PIC  X(0008).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HLCAL1O PIC  X(0001).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  HLCALCO PIC  X(0012).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  HAKINDO PIC  X(0002).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  HACDO PIC  X(0002).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  HAEDESCO PIC  X(0003).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  HATERMO PIC  ZZ9.
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  HAREMO PIC  ZZ9.
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1278.cbl
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HACAL1O PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HACALCO PIC  X(0012).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  CANREAHO PIC  X(0015).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  CANREAO PIC  X(0001).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  CLPYNHO PIC  X(0005).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  CLPYNO PIC  X(0001).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  FREMTRMO PIC  ZZ9.
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  HERMSG1O PIC  X(0079).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  HERMSG2O PIC  X(0079).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  HPFKEYO PIC  99.
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  PFKEY11O PIC  X(0034).
  1958*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1278.cbl
  1960*                            COPY ELCCALC.
  1961******************************************************************
  1962*                                                                *
  1963*                           ELCCALC.                            *
  1964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1965*                            VMOD=2.025                          *
  1966*                                                                *
  1967*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1968*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1969*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1970*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1971*                                                                *
  1972*  PASSED TO ELRTRM                                              *
  1973*  -----------------                                             *
  1974*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1975*  ORIGINAL TERM                                                 *
  1976*  BEGINNING DATE                                                *
  1977*  ENDING DATE                                                   *
  1978*  COMPANY I.D.                                                  *
  1979*  ACCOUNT MASTER USER FIELD                                     *
  1980*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1981*  FREE LOOK DAYS                                                *
  1982*                                                                *
  1983*  RETURNED FROM ELRTRM                                          *
  1984*  ---------------------                                         *
  1985*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1986*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1987*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1988*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1989*----------------------------------------------------------------*
  1990*  PASSED TO ELRAMT                                              *
  1991*  ----------------                                              *
  1992*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1993*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1994*  ORIGINAL AMOUNT                                               *
  1995*  ALTERNATE BENEFIT (BALLON)                                    *
  1996*  A.P.R. - NET PAY ONLY                                         *
  1997*  METHOD
  1998*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1999*  COMPANY I.D.                                                  *
  2000*  BENEFIT TYPE                                                  *
  2001*                                                                *
  2002*  RETURNED FROM ELRAMT                                          *
  2003*  --------------------                                          *
  2004*  REMAINING AMOUNT 1 - CURRENT                                  *
  2005*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2006*  REMAINING AMOUNT FACTOR
  2007*----------------------------------------------------------------*
  2008*  PASSED TO ELRESV                                              *
  2009*  -----------------                                             *
  2010*  CERTIFICATE EFFECTIVE DATE                                    *
  2011*  VALUATION DATE                                                *
  2012*  PAID THRU DATE                                                *
  2013*  BENEFIT                                                       *
  2014*  INCURRED DATE                                                 *
  2015*  REPORTED DATE                                                 *
  2016*  ISSUE AGE                                                     *
  2017*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1278.cbl
  2018*  CDT PERCENT                                                   *
  2019*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2020* *CLAIM TYPE (LIFE, A/H)                                        *
  2021* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2022* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2023*                                                                *
  2024*  RETURNED FROM ELRESV                                          *
  2025*  --------------------                                          *
  2026*  CDT TABLE USED                                                *
  2027*  CDT FACTOR USED                                               *
  2028*  PAY TO CURRENT RESERVE                                        *
  2029*  I.B.N.R. - A/H ONLY                                           *
  2030*  FUTURE (ACCRUED) AH ONLY                                      *
  2031*----------------------------------------------------------------*
  2032*  PASSED TO ELRATE                                              *
  2033*  ----------------                                              *
  2034*  CERT ISSUE DATE                                               *
  2035*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2036*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2037*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2038*  STATE CODE (CLIENT DEFINED)                                   *
  2039*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2040*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2041*  DEVIATION CODE                                                *
  2042*  ISSUE AGE                                                     *
  2043*  ORIGINAL BENEFIT AMOUNT                                       *
  2044*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2045*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2046*  BENEFIT KIND (LIFE OR A/H)                                    *
  2047*  A.P.R.                                                        *
  2048*  METHOD
  2049*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2050*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2051*  COMPANY I.D. (3 CHARACTER)                                    *
  2052*  BENEFIT CODE                                                  *
  2053*  BENEFIT OVERRIDE CODE                                         *
  2054*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2055*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2056*  JOINT INDICATOR (CSL ONLY)                                    *
  2057*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2058*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2059*                                                                *
  2060*  RETURNED FROM ELRATE                                          *
  2061*  --------------------                                          *
  2062*  CALCULATED PREMIUM                                            *
  2063*  PREMIUM RATE                                                  *
  2064*  MORTALITY CODE                                                *
  2065*  MAX ATTAINED AGE                                              *
  2066*  MAX AGE                                                       *
  2067*  MAX TERM                                                      *
  2068*  MAX MONTHLY BENEFIT                                           *
  2069*  MAX TOTAL BENIFIT                                             *
  2070*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2071*----------------------------------------------------------------*
  2072*  PASSED TO ELRFND                                              *
  2073*  ----------------                                              *
  2074*  CERT ISSUE DATE                                               *
  2075*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1278.cbl
  2076*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2077*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2078*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2079*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2080*  STATE CODE (CLIENT DEFINED)                                   *
  2081*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2082*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2083*  DEVIATION CODE                                                *
  2084*  ISSUE AGE                                                     *
  2085*  ORIGINAL BENEFIT AMOUNT                                       *
  2086*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2087*  PROCESS TYPE (CANCEL)                                         *
  2088*  BENEFIT KIND (LIFE OR A/H)                                    *
  2089*  A.P.R.                                                        *
  2090*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2091*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2092*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2093*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2094*  COMPANY I.D. (3 CHARACTER)                                    *
  2095*  BENEFIT CODE                                                  *
  2096*  BENEFIT OVERRIDE CODE                                         *
  2097*                                                                *
  2098*  RETURNED FROM ELRFND                                          *
  2099*  --------------------                                          *
  2100*  CALCULATED REFUND                                             *
  2101*----------------------------------------------------------------*
  2102*  PASSED TO ELEARN                                              *
  2103*  ----------------                                              *
  2104*  CERT ISSUE DATE                                               *
  2105*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2106*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2107*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2108*  STATE CODE (CLIENT DEFINED)                                   *
  2109*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2110*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2111*  DEVIATION CODE                                                *
  2112*  ISSUE AGE                                                     *
  2113*  ORIGINAL BENEFIT AMOUNT                                       *
  2114*  BENEFIT KIND (LIFE OR A/H)                                    *
  2115*  A.P.R.                                                        *
  2116*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2117*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2118*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2119*  COMPANY I.D. (3 CHARACTER)                                    *
  2120*  BENEFIT CODE                                                  *
  2121*  BENEFIT OVERRIDE CODE                                         *
  2122*                                                                *
  2123*  RETURNED FROM ELEARN                                          *
  2124*  --------------------                                          *
  2125*  INDICATED  EARNINGS                                           *
  2126*----------------------------------------------------------------*
  2127*                 LENGTH = 450                                   *
  2128*                                                                *
  2129******************************************************************
  2130******************************************************************
  2131*                   C H A N G E   L O G
  2132*
  2133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1278.cbl
  2134*-----------------------------------------------------------------
  2135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2136* EFFECTIVE    NUMBER
  2137*-----------------------------------------------------------------
  2138* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2139* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2140* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2141* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2142* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2143* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2144* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2145* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2146* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2147******************************************************************
  2148
  2149 01  CALCULATION-PASS-AREA.
  2150     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2151                                     COMP.
  2152
  2153     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2154       88  NO-CP-ERROR                             VALUE ZERO.
  2155       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2156                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2157       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2158       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2159       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2160       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2161       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2162       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2163       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2164       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2165       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2166       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2167       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2168       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2169       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2170       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2171       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2172       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2173       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2174
  2175     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2176       88  NO-CP-ERROR-2                           VALUE ZERO.
  2177***********************  INPUT AREAS ****************************
  2178
  2179     12  CP-CALCULATION-AREA.
  2180         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2181         16  CP-CERT-EFF-DT        PIC XX.
  2182         16  CP-VALUATION-DT       PIC XX.
  2183         16  CP-PAID-THRU-DT       PIC XX.
  2184         16  CP-BENEFIT-TYPE       PIC X.
  2185           88  CP-AH                               VALUE 'A' 'D'
  2186                                                   'I' 'U'.
  2187           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2188           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2189         16  CP-INCURRED-DT        PIC XX.
  2190         16  CP-REPORTED-DT        PIC XX.
  2191         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1278.cbl
  2192         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2193         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2194                                     COMP-3.
  2195         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2196                                     COMP-3.
  2197         16  CP-CDT-METHOD         PIC X.
  2198           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2199           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2200           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2201         16  CP-CLAIM-TYPE         PIC X.
  2202           88  CP-AH-CLAIM                         VALUE 'A'.
  2203           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2204         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2205                                     COMP-3.
  2206         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2207                                     COMP-3.
  2208         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2209                                     COMP-3.
  2210         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2211                                     COMP-3.
  2212         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2213                                     COMP-3.
  2214         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2215                                     COMP-3.
  2216         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2217                                     COMP-3.
  2218         16  CP-REM-TERM-METHOD    PIC X.
  2219           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2220           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2221           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2222           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2223           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2224           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2225           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2226         16  CP-EARNING-METHOD     PIC X.
  2227           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2228           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2229           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2230           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2231           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2232           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2233           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2234           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2235           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2236           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2237           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2238           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2239           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2240           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2241         16  CP-PROCESS-TYPE       PIC X.
  2242           88  CP-CLAIM                            VALUE '1'.
  2243           88  CP-CANCEL                           VALUE '2'.
  2244           88  CP-ISSUE                            VALUE '3'.
  2245         16  CP-SPECIAL-CALC-CD    PIC X.
  2246           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2247           88  CP-1-MTH-INTEREST               VALUE ' '.
  2248           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2249           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1278.cbl
  2250           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2251           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2252           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2253           88  CP-FARM-PLAN                    VALUE 'F'.
  2254           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2255           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2256           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2257           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2258           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2259           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2260           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2261           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2262           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2263           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2264                                                     'W' 'X'.
  2265           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2266           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2267           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2268           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2269           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2270           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2271           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2272           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2273           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2274           88  CP-CSL-METH-1                   VALUE '5'.
  2275           88  CP-CSL-METH-2                   VALUE '6'.
  2276           88  CP-CSL-METH-3                   VALUE '7'.
  2277           88  CP-CSL-METH-4                   VALUE '8'.
  2278
  2279         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2280                                     COMP-3.
  2281         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2282         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2283         16  CP-STATE              PIC XX          VALUE SPACE.
  2284         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2285         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2286           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2287               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2288         16  CP-R78-OPTION         PIC X.
  2289           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2290           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2291
  2292         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2293         16  CP-IBNR-RESERVE-SW    PIC X.
  2294         16  CP-CLAIM-STATUS       PIC X.
  2295         16  CP-RATE-FILE          PIC X.
  2296         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2297                                     COMP-3.
  2298
  2299         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2300         16  CP-AH-OVERRIDE-CODE   PIC X.
  2301
  2302         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2303                                     COMP-3.
  2304         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2305                                   PIC S9(5)V99 COMP-3.
  2306         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2307                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1278.cbl
  2308         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2309                                     COMP-3.
  2310         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2311                                     COMP-3.
  2312         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2313                                  PIC S9(7)V99 COMP-3.
  2314
  2315         16  CP-PAID-FROM-DATE     PIC X(02).
  2316         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2317         16  CP-EXT-DAYS-CALC      PIC X.
  2318           88  CP-EXT-NO-CHG                   VALUE ' '.
  2319           88  CP-EXT-CHG-LF                   VALUE '1'.
  2320           88  CP-EXT-CHG-AH                   VALUE '2'.
  2321           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2322         16  CP-DOMICILE-STATE     PIC XX.
  2323         16  CP-CARRIER            PIC X.
  2324         16  CP-REIN-FLAG          PIC X.
  2325         16  CP-REM-TRM-CALC-OPTION PIC X.
  2326           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2327                      '2' '3' '4' '5'.
  2328           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2329           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2330           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2331           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2332           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2333           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2334           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2335           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2336         16  CP-SIG-SWITCH         PIC X.
  2337         16  CP-RATING-METHOD      PIC X.
  2338           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2339           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2340           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2341           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2342           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2343           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2344           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2345           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2346           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2347         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2348                                     COMP-3.
  2349         16  CP-BEN-CATEGORY       PIC X.
  2350         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2351         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2352                                   PIC S99V9(5) COMP-3.
  2353         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2354         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2355                                   PIC S99V9(5) COMP-3.
  2356         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2357         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2358         16  CP-EXPIRE-DT          PIC XX.
  2359         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2360         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2361         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2362         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2363         16  CP-DDF-SPEC-CALC      PIC X.
  2364             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2365             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1278.cbl
  2366         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2367         16  CP-CANCEL-REASON      PIC X.
  2368         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2369         16  CP-PMT-MODE           PIC X.
  2370         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2371         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2372         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2373         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2374         16  FILLER                PIC X.
  2375
  2376***************    OUTPUT FROM ELRESV   ************************
  2377
  2378         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2379
  2380         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2381                                     COMP-3.
  2382         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2383                                     COMP-3.
  2384         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2385                                     COMP-3.
  2386         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2387                                     COMP-3.
  2388         16  FILLER                PIC X(09).
  2389***************    OUTPUT FROM ELRTRM   *************************
  2390
  2391         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2392                                     COMP-3.
  2393         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2394                                     COMP-3.
  2395         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2396                                     COMP-3.
  2397         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2398                                     COMP-3.
  2399         16  FILLER                PIC X(12).
  2400
  2401***************    OUTPUT FROM ELRAMT   *************************
  2402
  2403         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2404                                     COMP-3.
  2405         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2406                                     COMP-3.
  2407         16  FILLER                PIC X(12).
  2408
  2409***************    OUTPUT FROM ELRATE   *************************
  2410
  2411         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2412                                     COMP-3.
  2413         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2414                                     COMP-3.
  2415         16  CP-MORTALITY-CODE     PIC X(4).
  2416         16  CP-RATE-EDIT-FLAG     PIC X.
  2417             88  CP-RATES-NEED-APR                  VALUE '1'.
  2418         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2419                                     COMP-3.
  2420         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2421         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2422         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2423                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1278.cbl
  2424         16  FILLER                PIC X(07).
  2425
  2426***************    OUTPUT FROM ELRFND   *************************
  2427
  2428         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2429                                     COMP-3.
  2430         16  CP-REFUND-TYPE-USED   PIC X.
  2431           88  CP-R-AS-R78                         VALUE '1'.
  2432           88  CP-R-AS-PRORATA                     VALUE '2'.
  2433           88  CP-R-AS-CALIF                       VALUE '3'.
  2434           88  CP-R-AS-TEXAS                       VALUE '4'.
  2435           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2436           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2437           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2438           88  CP-R-AS-MEAN                        VALUE '8'.
  2439           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2440           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2441           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2442           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2443           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2444           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2445         16  FILLER                PIC X(12).
  2446
  2447***************    OUTPUT FROM ELEARN   *************************
  2448
  2449         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2450                                     COMP-3.
  2451         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2452                                     COMP-3.
  2453         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2454                                     COMP-3.
  2455         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2456                                     COMP-3.
  2457         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2458                                     COMP-3.
  2459         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2460                                     COMP-3.
  2461         16  CP-EARNING-TYPE-USED  PIC X.
  2462           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2463           88  CP-E-AS-R78                         VALUE '1'.
  2464           88  CP-E-AS-PRORATA                     VALUE '2'.
  2465           88  CP-E-AS-TEXAS                       VALUE '4'.
  2466           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2467           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2468           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2469           88  CP-E-AS-MEAN                        VALUE '8'.
  2470           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2471         16  FILLER                PIC X(12).
  2472
  2473***************    OUTPUT FROM ELPMNT   *************************
  2474
  2475         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2476                                     COMP-3.
  2477         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2478                                     COMP-3.
  2479         16  FILLER                PIC X(12).
  2480
  2481***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1278.cbl
  2482         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2483                                     COMP-3.
  2484         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2485                                     COMP-3.
  2486         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2487                                     COMP-3.
  2488         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2489                                     COMP-3.
  2490         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2491                                     COMP-3.
  2492         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2493                                     COMP-3.
  2494         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2495             88  OPEN-RATE-FILE                   VALUE 'O'.
  2496             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2497             88  IO-ERROR                         VALUE 'E'.
  2498
  2499         16  CP-FIRST-PAY-DATE     PIC XX.
  2500
  2501         16  CP-JOINT-INDICATOR    PIC X.
  2502
  2503         16  CP-RESERVE-REMAINING-TERM
  2504                                   PIC S9(4)V9    VALUE ZERO
  2505                                     COMP-3.
  2506
  2507         16  CP-INSURED-BIRTH-DT   PIC XX.
  2508
  2509         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2510                                     COMP-3.
  2511
  2512         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2513                                     COMP-3.
  2514
  2515         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2516                                     COMP-3.
  2517
  2518         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2519                                     COMP-3.
  2520
  2521         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2522                                     COMP-3.
  2523
  2524         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2525                                     COMP-3.
  2526
  2527         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2528                                     COMP-3.
  2529
  2530         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2531             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2532
  2533         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2534                                     COMP-3.
  2535         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2536                                     COMP-3.
  2537         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2538         16  FILLER                PIC X(15).
  2539******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1278.cbl
  2541*                            COPY ERCNOTE.
  2542******************************************************************
  2543*                                                                *
  2544*                                                                *
  2545*                            ERCNOTE                             *
  2546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2547*                            VMOD=2.003                          *
  2548*                                                                *
  2549*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2550*                                                                *
  2551*        FILE TYPE= VSAM,KSDS                                    *
  2552*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2553*                                                                *
  2554*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2555*                                                                *
  2556*        LOG = YES                                               *
  2557*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2558*                                                                *
  2559******************************************************************
  2560*                   C H A N G E   L O G
  2561*
  2562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2563*-----------------------------------------------------------------
  2564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2565* EFFECTIVE    NUMBER
  2566*-----------------------------------------------------------------
  2567* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2568*                                FILE WILL CONTAIN BILLING NOTES O
  2569******************************************************************
  2570
  2571 01  CERTIFICATE-NOTE.
  2572     12  CN-RECORD-ID                PIC  XX.
  2573         88  VALID-CN-ID                  VALUE 'CN'.
  2574
  2575     12  CN-CONTROL-PRIMARY.
  2576         16  CN-COMPANY-CD           PIC X.
  2577         16  CN-CARRIER              PIC X.
  2578         16  CN-GROUPING.
  2579             20 CN-GROUPING-PREFIX   PIC XXX.
  2580             20 CN-GROUPING-PRIME    PIC XXX.
  2581         16  CN-STATE                PIC XX.
  2582         16  CN-ACCOUNT.
  2583             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2584             20 CN-ACCOUNT-PRIME     PIC X(6).
  2585         16  CN-CERT-EFF-DT          PIC XX.
  2586         16  CN-CERT-NO.
  2587             20  CN-CERT-PRIME       PIC X(10).
  2588             20  CN-CERT-SFX         PIC X.
  2589
  2590     12  CN-BILLING-START-LINE-NO    PIC 99.
  2591     12  CN-BILLING-END-LINE-NO      PIC 99.
  2592
  2593     12  CN-LINES.
  2594         16  CN-LINE OCCURS 10       PIC X(77).
  2595
  2596     12  CN-LAST-MAINT-DT            PIC XX.
  2597     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2598     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1278.cbl
  2599     12  FILLER                      PIC X(6).
  2600******************************************************************
  2601*                            COPY ERCCTBL.
  2602******************************************************************
  2603*                                                                *
  2604*                                                                *
  2605*                            ERCCTBL                             *
  2606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2607*                            VMOD=2.003
  2608*                                                                *
  2609*   ONLINE CREDIT SYSTEM                                         *
  2610*                                                                *
  2611*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2612*                                                                *
  2613*   FILE TYPE = VSAM,KSDS                                        *
  2614*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2615*                                                                *
  2616*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2617*       ALTERNATE PATH = NONE                                    *
  2618*                                                                *
  2619*   LOG = NO                                                     *
  2620*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2621*                                                                *
  2622*                                                                *
  2623******************************************************************
  2624
  2625 01  COMM-TABLE-RECORD.
  2626     12  CT-RECORD-ID                      PIC XX.
  2627         88  VALID-CT-ID                      VALUE 'CT'.
  2628
  2629     12  CT-CONTROL-PRIMARY.
  2630         16  CT-COMPANY-CD                 PIC X.
  2631         16  CT-TABLE                      PIC XXX.
  2632         16  CT-CNTRL-2.
  2633             20  CT-BEN-TYPE               PIC X.
  2634             20  CT-BEN-CODE               PIC XX.
  2635
  2636     12  CT-MAINT-INFORMATION.
  2637         16  CT-LAST-MAINT-DT              PIC XX.
  2638         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2639         16  CT-LAST-MAINT-USER            PIC X(4).
  2640         16  FILLER                        PIC X(31).
  2641
  2642     12  CT-LIMITS.
  2643         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2644
  2645         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2646
  2647         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2648
  2649     12  CT-RATES.
  2650         16  CT-RTX          OCCURS 27 TIMES.
  2651             20  CT-RT                     PIC SV9(5)     COMP-3.
  2652             20  CT-RT-R   REDEFINES
  2653                 CT-RT                     PIC XXX.
  2654
  2655     12  FILLER                            PIC  X(42).
  2656
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1278.cbl
  2657******************************************************************
  2658
  2659****************************************************************
  2660*
  2661* Copyright (c) 2007 by Clerity Solutions, Inc.
  2662* All rights reserved.
  2663*
  2664****************************************************************
  2665 01  DFHEIV.
  2666   02  DFHEIV0               PIC X(35).
  2667   02  DFHEIV1               PIC X(08).
  2668   02  DFHEIV2               PIC X(08).
  2669   02  DFHEIV3               PIC X(08).
  2670   02  DFHEIV4               PIC X(06).
  2671   02  DFHEIV5               PIC X(04).
  2672   02  DFHEIV6               PIC X(04).
  2673   02  DFHEIV7               PIC X(02).
  2674   02  DFHEIV8               PIC X(02).
  2675   02  DFHEIV9               PIC X(01).
  2676   02  DFHEIV10              PIC S9(7) COMP-3.
  2677   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2678   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2679   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2680   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2681   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2682   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2683   02  DFHEIV17              PIC X(04).
  2684   02  DFHEIV18              PIC X(04).
  2685   02  DFHEIV19              PIC X(04).
  2686   02  DFHEIV20              USAGE IS POINTER.
  2687   02  DFHEIV21              USAGE IS POINTER.
  2688   02  DFHEIV22              USAGE IS POINTER.
  2689   02  DFHEIV23              USAGE IS POINTER.
  2690   02  DFHEIV24              USAGE IS POINTER.
  2691   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2692   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2693   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2694   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2695   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2696   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2697   02  FILLER                PIC X(02).
  2698   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2699   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2700   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2701   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2702   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2703 LINKAGE  SECTION.
  2704*****************************************************************
  2705*                                                               *
  2706* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2707* All rights reserved.                                          *
  2708*                                                               *
  2709*****************************************************************
  2710 01  dfheiblk.
  2711     02  eibtime          pic s9(7) comp-3.
  2712     02  eibdate          pic s9(7) comp-3.
  2713     02  eibtrnid         pic x(4).
  2714     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1278.cbl
  2715     02  eibtrmid         pic x(4).
  2716     02  dfheigdi         pic s9(4) comp.
  2717     02  eibcposn         pic s9(4) comp.
  2718     02  eibcalen         pic s9(4) comp.
  2719     02  eibaid           pic x(1).
  2720     02  eibfiller1       pic x(1).
  2721     02  eibfn            pic x(2).
  2722     02  eibfiller2       pic x(2).
  2723     02  eibrcode         pic x(6).
  2724     02  eibfiller3       pic x(2).
  2725     02  eibds            pic x(8).
  2726     02  eibreqid         pic x(8).
  2727     02  eibrsrce         pic x(8).
  2728     02  eibsync          pic x(1).
  2729     02  eibfree          pic x(1).
  2730     02  eibrecv          pic x(1).
  2731     02  eibsend          pic x(1).
  2732     02  eibatt           pic x(1).
  2733     02  eibeoc           pic x(1).
  2734     02  eibfmh           pic x(1).
  2735     02  eibcompl         pic x(1).
  2736     02  eibsig           pic x(1).
  2737     02  eibconf          pic x(1).
  2738     02  eiberr           pic x(1).
  2739     02  eibrldbk         pic x(1).
  2740     02  eiberrcd         pic x(4).
  2741     02  eibsynrb         pic x(1).
  2742     02  eibnodat         pic x(1).
  2743     02  eibfiller5       pic x(2).
  2744     02  eibresp          pic 9(09) comp.
  2745     02  eibresp2         pic 9(09) comp.
  2746     02  dfheigdj         pic s9(4) comp.
  2747     02  dfheigdk         pic s9(4) comp.
  2748
  2749 01  DFHCOMMAREA                 PIC  X(1024).
  2750
  2751*01 PARMLIST .
  2752*    12  FILLER                  PIC S9(08)      COMP.
  2753*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2754*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2755*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2756*                            COPY ELCCNTL.
  2757******************************************************************
  2758*                                                                *
  2759*                                                                *
  2760*                            ELCCNTL.                            *
  2761*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2762*                            VMOD=2.059                          *
  2763*                                                                *
  2764*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2765*                                                                *
  2766*   FILE TYPE = VSAM,KSDS                                        *
  2767*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2768*                                                                *
  2769*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2770*       ALTERNATE INDEX = NONE                                   *
  2771*                                                                *
  2772*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1278.cbl
  2773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2774******************************************************************
  2775*                   C H A N G E   L O G
  2776*
  2777* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2778*-----------------------------------------------------------------
  2779*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2780* EFFECTIVE    NUMBER
  2781*-----------------------------------------------------------------
  2782* 082503                   PEMA  ADD BENEFIT GROUP
  2783* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2784* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2785* 092705    2005050300006  PEMA  ADD SPP LEASES
  2786* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2787* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2788* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2789* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2790* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2791* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2792******************************************************************
  2793*
  2794 01  CONTROL-FILE.
  2795     12  CF-RECORD-ID                       PIC XX.
  2796         88  VALID-CF-ID                        VALUE 'CF'.
  2797
  2798     12  CF-CONTROL-PRIMARY.
  2799         16  CF-COMPANY-ID                  PIC XXX.
  2800         16  CF-RECORD-TYPE                 PIC X.
  2801             88  CF-COMPANY-MASTER              VALUE '1'.
  2802             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2803             88  CF-STATE-MASTER                VALUE '3'.
  2804             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2805             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2806             88  CF-CARRIER-MASTER              VALUE '6'.
  2807             88  CF-MORTALITY-MASTER            VALUE '7'.
  2808             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2809             88  CF-TERMINAL-MASTER             VALUE '9'.
  2810             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2811             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2812             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2813             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2814             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2815             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2816             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2817             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2818             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2819         16  CF-ACCESS-CD-GENL              PIC X(4).
  2820         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2821             20  CF-PROCESSOR               PIC X(4).
  2822         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2823             20  CF-STATE-CODE              PIC XX.
  2824             20  FILLER                     PIC XX.
  2825         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2826             20  FILLER                     PIC XX.
  2827             20  CF-HI-BEN-IN-REC           PIC XX.
  2828         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2829             20  FILLER                     PIC XXX.
  2830             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1278.cbl
  2831         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2832             20  FILLER                     PIC XX.
  2833             20  CF-HI-TYPE-IN-REC          PIC 99.
  2834         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2835             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2836                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2837             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2838             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2839         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2840             20  FILLER                     PIC X.
  2841             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2842         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2843             20  FILLER                     PIC XX.
  2844             20  CF-MORTGAGE-PLAN           PIC XX.
  2845         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2846
  2847     12  CF-LAST-MAINT-DT                   PIC XX.
  2848     12  CF-LAST-MAINT-BY                   PIC X(4).
  2849     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2850
  2851     12  CF-RECORD-BODY                     PIC X(728).
  2852
  2853
  2854****************************************************************
  2855*             COMPANY MASTER RECORD                            *
  2856****************************************************************
  2857
  2858     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2859         16  CF-COMPANY-ADDRESS.
  2860             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2861             20  CF-CL-IN-CARE-OF           PIC X(30).
  2862             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2863             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2864             20  CF-CL-CITY-STATE           PIC X(30).
  2865             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2866             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2867         16  CF-COMPANY-CD                  PIC X.
  2868         16  CF-COMPANY-PASSWORD            PIC X(8).
  2869         16  CF-SECURITY-OPTION             PIC X.
  2870             88  ALL-SECURITY                   VALUE '1'.
  2871             88  COMPANY-VERIFY                 VALUE '2'.
  2872             88  PROCESSOR-VERIFY               VALUE '3'.
  2873             88  NO-SECURITY                    VALUE '4'.
  2874             88  ALL-BUT-TERM                   VALUE '5'.
  2875         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2876             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2877         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2878             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2879         16  CF-INFORCE-LOCATION            PIC X.
  2880             88  CERTS-ARE-ONLINE               VALUE '1'.
  2881             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2882             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2883         16  CF-LOWER-CASE-LETTERS          PIC X.
  2884         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2885             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2886             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2887             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2888             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1278.cbl
  2889             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2890
  2891         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2892         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2893
  2894         16  CF-LGX-CREDIT-USER             PIC X.
  2895             88  CO-IS-NOT-USER                 VALUE 'N'.
  2896             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2897
  2898         16 CF-CREDIT-CALC-CODES.
  2899             20  CF-CR-REM-TERM-CALC PIC X.
  2900               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2901               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2902               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2903               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2904               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2905               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2906               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2907             20  CF-CR-R78-METHOD           PIC X.
  2908               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2909               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2910
  2911         16  CF-CLAIM-CONTROL-COUNTS.
  2912             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2913                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2914
  2915             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2916                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2917
  2918             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2919                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2920
  2921             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2922                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2923
  2924         16  CF-CURRENT-MONTH-END           PIC XX.
  2925
  2926         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2927             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2928             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2929             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2930             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2931                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2932                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2933             20  CF-CO-PREM-REJECT-SW       PIC X.
  2934                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2935                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2936             20  CF-CO-REF-REJECT-SW        PIC X.
  2937                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2938                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2939
  2940         16  CF-CO-REPORTING-DT             PIC XX.
  2941         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2942         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2943           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2944           88  CF-CO-MONTH-END                  VALUE '1'.
  2945
  2946         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1278.cbl
  2947             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2948             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2949
  2950         16  CF-CREDIT-EDIT-CONTROLS.
  2951             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2952             20  CF-MIN-AGE                 PIC 99.
  2953             20  CF-DEFAULT-AGE             PIC 99.
  2954             20  CF-MIN-TERM                PIC S999      COMP-3.
  2955             20  CF-MAX-TERM                PIC S999      COMP-3.
  2956             20  CF-DEFAULT-SEX             PIC X.
  2957             20  CF-JOINT-AGE-INPUT         PIC X.
  2958                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2959             20  CF-BIRTH-DATE-INPUT        PIC X.
  2960                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2961             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2962                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2963                 88  CF-ZERO-CARRIER            VALUE '1'.
  2964                 88  CF-ZERO-GROUPING           VALUE '2'.
  2965                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2966             20  CF-EDIT-SW                 PIC X.
  2967                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2968             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2969             20  CF-CR-PR-METHOD            PIC X.
  2970               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2971               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2972             20  FILLER                     PIC X.
  2973
  2974         16  CF-CREDIT-MISC-CONTROLS.
  2975             20  CF-REIN-TABLE-SW           PIC X.
  2976                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2977             20  CF-COMP-TABLE-SW           PIC X.
  2978                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2979             20  CF-EXPERIENCE-RETENTION-AGE
  2980                                            PIC S9        COMP-3.
  2981             20  CF-CONVERSION-DT           PIC XX.
  2982             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2983             20  CF-RUN-FREQUENCY-SW        PIC X.
  2984                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2985                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2986
  2987             20  CF-CR-CHECK-NO-CONTROL.
  2988                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2989                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2990                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2991                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2992                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2993                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2994
  2995                 24  CF-CR-CHECK-COUNT       REDEFINES
  2996                     CF-CR-CHECK-COUNTER      PIC X(4).
  2997
  2998                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2999                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3000
  3001                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3002                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3003                 24  CF-MAIL-PROCESSING       PIC X.
  3004                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1278.cbl
  3005
  3006         16  CF-MISC-SYSTEM-CONTROL.
  3007             20  CF-SYSTEM-C                 PIC X.
  3008                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3009             20  CF-SYSTEM-D                 PIC X.
  3010                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3011             20  CF-SOC-SEC-NO-SW            PIC X.
  3012                 88  SOC-SEC-NO-USED             VALUE '1'.
  3013             20  CF-MEMBER-NO-SW             PIC X.
  3014                 88  MEMBER-NO-USED              VALUE '1'.
  3015             20  CF-TAX-ID-NUMBER            PIC X(11).
  3016             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3017             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3018                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3019                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3020                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3021                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3022             20  CF-SYSTEM-E                 PIC X.
  3023                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3024
  3025         16  CF-LGX-LIFE-USER               PIC X.
  3026             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3027             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3028
  3029         16  CF-CR-MONTH-END-DT             PIC XX.
  3030
  3031         16  CF-FILE-MAINT-DATES.
  3032             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3033                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3034             20  CF-LAST-BATCH       REDEFINES
  3035                 CF-LAST-BATCH-NO               PIC X(4).
  3036             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3037             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3038             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3039             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3040             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3041             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3042             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3043             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3044             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3045             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3046
  3047         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3048         16  FILLER                         PIC X.
  3049
  3050         16  CF-ALT-MORT-CODE               PIC X(4).
  3051         16  CF-MEMBER-CAPTION              PIC X(10).
  3052
  3053         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3054             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3055             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3056             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3057             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3058             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3059
  3060         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3061
  3062         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1278.cbl
  3063         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3064         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3065         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3066
  3067         16  CF-AH-OVERRIDE-L1              PIC X.
  3068         16  CF-AH-OVERRIDE-L2              PIC XX.
  3069         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3070         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3071
  3072         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3073         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3074
  3075         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3076         16  CF-AR-LAST-EL860-DT            PIC XX.
  3077         16  CF-MP-MONTH-END-DT             PIC XX.
  3078
  3079         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3080         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3081             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3082
  3083         16  CF-AR-MONTH-END-DT             PIC XX.
  3084
  3085         16  CF-CRDTCRD-USER                PIC X.
  3086             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3087             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3088
  3089         16  CF-CC-MONTH-END-DT             PIC XX.
  3090
  3091         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3092
  3093         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3094             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3095             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3096             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3097         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3098         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3099         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3100         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3101             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3102             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3103         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3104         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3105         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3106             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3107         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3108
  3109         16  CF-CL-ZIP-CODE.
  3110             20  CF-CL-ZIP-PRIME.
  3111                 24  CF-CL-ZIP-1ST          PIC X.
  3112                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3113                 24  FILLER                 PIC X(4).
  3114             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3115         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3116             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3117             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3118             20  FILLER                     PIC XXX.
  3119
  3120         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1278.cbl
  3121         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3122         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3123         16  CF-CO-OPTION-START-DATE        PIC XX.
  3124         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3125           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3126                                                      '3' '4'.
  3127           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3128           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3129           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3130           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3131           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3132           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3133
  3134         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3135
  3136         16  CF-PAYMENT-APPROVAL-LEVELS.
  3137             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3138             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3139             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3140             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3141             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3142             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3143
  3144         16  CF-END-USER-REPORTING-USER     PIC X.
  3145             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3146             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3147
  3148         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3149             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3150             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3151
  3152         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3153
  3154         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3155         16  FILLER                         PIC X.
  3156
  3157         16  CF-CREDIT-ARCHIVE-CNTL.
  3158             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3159             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3160             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3161
  3162         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3163
  3164         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3165             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3166             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3167
  3168         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3169             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3170             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3171
  3172         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3173
  3174         16  CF-CO-ACH-ID-CODE              PIC  X.
  3175             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3176             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3177             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3178         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1278.cbl
  3179         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3180         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3181         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3182         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3183         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3184         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3185         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3186         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3187                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3188         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3189                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3190
  3191         16  CF-CO-OVER-SHORT.
  3192             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3193             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3194
  3195*         16  FILLER                         PIC X(102).
  3196         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3197             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3198             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3199
  3200         16  CF-AH-APPROVAL-DAYS.
  3201             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3202             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3203             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3204             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3205
  3206         16  FILLER                         PIC X(82).
  3207****************************************************************
  3208*             PROCESSOR/USER RECORD                            *
  3209****************************************************************
  3210
  3211     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3212         16  CF-PROCESSOR-NAME              PIC X(30).
  3213         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3214         16  CF-PROCESSOR-TITLE             PIC X(26).
  3215         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3216                 88  MESSAGE-YES                VALUE 'Y'.
  3217                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3218
  3219*****************************************************
  3220****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3221****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3222****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3223****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3224*****************************************************
  3225
  3226         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3227             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3228             20  CF-APPLICATION-FORCE       PIC X.
  3229             20  CF-INDIVIDUAL-APP.
  3230                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3231                     28  CF-BROWSE-APP      PIC X.
  3232                     28  CF-UPDATE-APP      PIC X.
  3233
  3234         16  CF-CURRENT-TERM-ON             PIC X(4).
  3235         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3236             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1278.cbl
  3237             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3238             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3239             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3240             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3241             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3242             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3243         16  CF-PROCESSOR-CARRIER           PIC X.
  3244             88  NO-CARRIER-SECURITY            VALUE ' '.
  3245         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3246             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3247         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3248             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3249         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3250             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3251
  3252         16  CF-PROC-SYS-ACCESS-SW.
  3253             20  CF-PROC-CREDIT-CLAIMS-SW.
  3254                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3255                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3256                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3257                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3258             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3259                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3260                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3261             20  CF-PROC-LIFE-GNRLDGR-SW.
  3262                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3263                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3264                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3265                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3266             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3267                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3268                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3269         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3270             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3271             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3272         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3273
  3274         16  CF-APPROVAL-LEVEL                  PIC X.
  3275             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3276             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3277             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3278             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3279
  3280         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3281
  3282         16  CF-LANGUAGE-TYPE                   PIC X.
  3283             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3284             88  CF-LANG-IS-FR                      VALUE 'F'.
  3285
  3286         16  CF-CSR-IND                         PIC X.
  3287         16  FILLER                             PIC X(239).
  3288
  3289****************************************************************
  3290*             PROCESSOR/REMINDERS RECORD                       *
  3291****************************************************************
  3292
  3293     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3294         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1278.cbl
  3295             20  CF-START-REMIND-DT         PIC XX.
  3296             20  CF-END-REMIND-DT           PIC XX.
  3297             20  CF-REMINDER-TEXT           PIC X(50).
  3298         16  FILLER                         PIC X(296).
  3299
  3300
  3301****************************************************************
  3302*             STATE MASTER RECORD                              *
  3303****************************************************************
  3304
  3305     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3306         16  CF-STATE-ABBREVIATION          PIC XX.
  3307         16  CF-STATE-NAME                  PIC X(25).
  3308         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3309         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3310             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3311             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3312             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3313             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3314                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3315                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3316             20  CF-ST-PREM-REJECT-SW       PIC X.
  3317                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3318                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3319             20  CF-ST-REF-REJECT-SW        PIC X.
  3320                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3321                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3322         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3323         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3324         16  CF-ST-REFUND-RULES.
  3325             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3326             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3327             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3328         16  CF-ST-FST-PMT-EXTENSION.
  3329             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3330             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3331                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3332                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3333                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3334                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3335         16  CF-ST-STATE-CALL.
  3336             20  CF-ST-CALL-UNEARNED        PIC X.
  3337             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3338             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3339         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3340             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3341             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3342         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3343         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3344         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3345         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3346         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3347         16  FILLER                         PIC X.
  3348         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3349             20  CF-ST-BENEFIT-CD           PIC XX.
  3350             20  CF-ST-BENEFIT-KIND         PIC X.
  3351                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3352                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1278.cbl
  3353             20  CF-ST-REM-TERM-CALC        PIC X.
  3354                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3355                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3356                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3357                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3358                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3359                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3360                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3361                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3362
  3363             20  CF-ST-REFUND-CALC          PIC X.
  3364                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3365                 88  ST-REFD-BY-R78             VALUE '1'.
  3366                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3367                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3368                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3369                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3370                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3371                 88  ST-REFD-UTAH               VALUE '7'.
  3372                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3373                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3374                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3375
  3376             20  CF-ST-EARNING-CALC         PIC X.
  3377                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3378                 88  ST-EARN-BY-R78             VALUE '1'.
  3379                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3380                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3381                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3382                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3383                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3384                 88  ST-EARN-MEAN               VALUE '8'.
  3385                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3386
  3387             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3388                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3389                 88  ST-OVRD-BY-R78             VALUE '1'.
  3390                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3391                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3392                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3393                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3394                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3395                 88  ST-OVRD-MEAN               VALUE '8'.
  3396                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3397             20  FILLER                     PIC X.
  3398
  3399         16  CF-ST-COMMISSION-CAPS.
  3400             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3401             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3402             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3403             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3404         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3405                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3406
  3407         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3408
  3409         16  CF-ST-STATUTORY-INTEREST.
  3410             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1278.cbl
  3411                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3412                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3413             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3414             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3415             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3416             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3417             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3418
  3419         16  CF-ST-OVER-SHORT.
  3420             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3421             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3422
  3423         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3424
  3425         16  CF-ST-RT-CALC                  PIC X.
  3426
  3427         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3428         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3429         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3430         16  CF-ST-RF-LR-CALC               PIC X.
  3431         16  CF-ST-RF-LL-CALC               PIC X.
  3432         16  CF-ST-RF-LN-CALC               PIC X.
  3433         16  CF-ST-RF-AH-CALC               PIC X.
  3434         16  CF-ST-RF-CP-CALC               PIC X.
  3435*        16  FILLER                         PIC X(206).
  3436*CIDMOD         16  FILLER                         PIC X(192).
  3437         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3438             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3439         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3440         16  CF-ST-VFY-2ND-BENE             PIC X.
  3441         16  FILLER                         PIC X(186).
  3442
  3443****************************************************************
  3444*             BENEFIT MASTER RECORD                            *
  3445****************************************************************
  3446
  3447     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3448         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3449             20  CF-BENEFIT-CODE            PIC XX.
  3450             20  CF-BENEFIT-NUMERIC  REDEFINES
  3451                 CF-BENEFIT-CODE            PIC XX.
  3452             20  CF-BENEFIT-ALPHA           PIC XXX.
  3453             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3454             20  CF-BENEFIT-COMMENT         PIC X(10).
  3455
  3456             20  CF-LF-COVERAGE-TYPE        PIC X.
  3457                 88  CF-REDUCING                VALUE 'R'.
  3458                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3459
  3460             20  CF-SPECIAL-CALC-CD         PIC X.
  3461                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3462                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3463                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3464                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3465                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3466                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3467                 88  CF-FARM-PLAN               VALUE 'F'.
  3468                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1278.cbl
  3469                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3470                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3471                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3472                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3473                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3474                 88  CF-PRUDENTIAL              VALUE 'P'.
  3475                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3476                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3477                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3478                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3479                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3480                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3481
  3482             20  CF-JOINT-INDICATOR         PIC X.
  3483                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3484
  3485*            20  FILLER                     PIC X(12).
  3486             20  FILLER                     PIC X(11).
  3487             20  CF-BENEFIT-CATEGORY        PIC X.
  3488             20  CF-LOAN-TYPE               PIC X(8).
  3489
  3490             20  CF-CO-REM-TERM-CALC        PIC X.
  3491                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3492                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3493                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3494                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3495                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3496
  3497             20  CF-CO-EARNINGS-CALC        PIC X.
  3498                 88  CO-EARN-BY-R78             VALUE '1'.
  3499                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3500                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3501                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3502                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3503                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3504                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3505                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3506
  3507             20  CF-CO-REFUND-CALC          PIC X.
  3508                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3509                 88  CO-REFD-BY-R78             VALUE '1'.
  3510                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3511                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3512                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3513                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3514                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3515                 88  CO-REFD-MEAN               VALUE '8'.
  3516                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3517                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3518                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3519
  3520             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3521                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3522                 88  CO-OVRD-BY-R78             VALUE '1'.
  3523                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3524                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3525                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3526                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1278.cbl
  3527                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3528                 88  CO-OVRD-MEAN               VALUE '8'.
  3529                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3530
  3531             20  CF-CO-BEN-I-G-CD           PIC X.
  3532                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3533                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3534                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3535
  3536         16  FILLER                         PIC X(304).
  3537
  3538
  3539****************************************************************
  3540*             CARRIER MASTER RECORD                            *
  3541****************************************************************
  3542
  3543     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3544         16  CF-ADDRESS-DATA.
  3545             20  CF-MAIL-TO-NAME            PIC X(30).
  3546             20  CF-IN-CARE-OF              PIC X(30).
  3547             20  CF-ADDRESS-LINE-1          PIC X(30).
  3548             20  CF-ADDRESS-LINE-2          PIC X(30).
  3549             20  CF-CITY-STATE              PIC X(30).
  3550             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3551             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3552
  3553         16  CF-CLAIM-NO-CONTROL.
  3554             20  CF-CLAIM-NO-METHOD         PIC X.
  3555                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3556                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3557                 88  CLAIM-NO-SEQ               VALUE '3'.
  3558                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3559             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3560                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3561                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3562                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3563
  3564         16  CF-CHECK-NO-CONTROL.
  3565             20  CF-CHECK-NO-METHOD         PIC X.
  3566                 88  CHECK-NO-MANUAL            VALUE '1'.
  3567                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3568                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3569                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3570             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3571                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3572
  3573         16  CF-DOMICILE-STATE              PIC XX.
  3574
  3575         16  CF-EXPENSE-CONTROLS.
  3576             20  CF-EXPENSE-METHOD          PIC X.
  3577                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3578                 88  DOLLARS-PER-PMT            VALUE '2'.
  3579                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3580                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3581             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3582             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3583
  3584         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1278.cbl
  3585             20  CF-LETTER-RESEND-OPT       PIC X.
  3586                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3587                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3588             20  FILLER                     PIC X(4).
  3589
  3590         16  CF-RESERVE-CONTROLS.
  3591             20  CF-MANUAL-SW               PIC X.
  3592                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3593             20  CF-FUTURE-SW               PIC X.
  3594                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3595             20  CF-PTC-SW                  PIC X.
  3596                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3597             20  CF-IBNR-SW                 PIC X.
  3598                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3599             20  CF-PTC-LF-SW               PIC X.
  3600                 88  CF-LF-PTC-USED             VALUE '1'.
  3601             20  CF-CDT-ACCESS-METHOD       PIC X.
  3602                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3603                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3604                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3605             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3606
  3607         16  CF-CLAIM-CALC-METHOD           PIC X.
  3608             88  360-PLUS-MONTHS                VALUE '1'.
  3609             88  365-PLUS-MONTHS                VALUE '2'.
  3610             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3611             88  360-DAILY                      VALUE '4'.
  3612             88  365-DAILY                      VALUE '5'.
  3613
  3614         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3615         16  FILLER                         PIC X(11).
  3616
  3617         16  CF-LIMIT-AMOUNTS.
  3618             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3619             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3620             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3621             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3622             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3623             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3624             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3625             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3626             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3627             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3628
  3629         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3630         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3631         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3632
  3633         16  CF-ZIP-CODE.
  3634             20  CF-ZIP-PRIME.
  3635                 24  CF-ZIP-1ST             PIC X.
  3636                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3637                 24  FILLER                 PIC X(4).
  3638             20  CF-ZIP-PLUS4               PIC X(4).
  3639         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3640             20  CF-CAN-POSTAL-1            PIC XXX.
  3641             20  CF-CAN-POSTAL-2            PIC XXX.
  3642             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1278.cbl
  3643
  3644         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3645         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3646         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3647
  3648         16  CF-RATING-SWITCH               PIC X.
  3649             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3650             88  CF-NO-RATING                   VALUE 'N'.
  3651
  3652         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3653
  3654         16  CF-CARRIER-OVER-SHORT.
  3655             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3656             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3657
  3658         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3659         16  CF-SECPAY-SWITCH               PIC X.
  3660             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3661             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3662         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3663         16  FILLER                         PIC X(448).
  3664*        16  FILLER                         PIC X(452).
  3665
  3666
  3667****************************************************************
  3668*             MORTALITY MASTER RECORD                          *
  3669****************************************************************
  3670
  3671     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3672         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3673                                INDEXED BY CF-MORT-NDX.
  3674             20  CF-MORT-TABLE              PIC X(5).
  3675             20  CF-MORT-TABLE-TYPE         PIC X.
  3676                 88  CF-MORT-JOINT              VALUE 'J'.
  3677                 88  CF-MORT-SINGLE             VALUE 'S'.
  3678                 88  CF-MORT-COMBINED           VALUE 'C'.
  3679                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3680                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3681             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3682             20  CF-MORT-AGE-METHOD         PIC XX.
  3683                 88  CF-AGE-LAST                VALUE 'AL'.
  3684                 88  CF-AGE-NEAR                VALUE 'AN'.
  3685             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3686             20  CF-MORT-ADJUSTMENT-DIRECTION
  3687                                            PIC X.
  3688                 88  CF-MINUS                   VALUE '-'.
  3689                 88  CF-PLUS                    VALUE '+'.
  3690             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3691             20  CF-MORT-JOINT-CODE         PIC X.
  3692                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3693             20  CF-MORT-PC-Q               PIC X.
  3694                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3695             20  CF-MORT-TABLE-CODE         PIC X(4).
  3696             20  CF-MORT-COMMENTS           PIC X(15).
  3697             20  FILLER                     PIC X(14).
  3698
  3699         16  FILLER                         PIC X(251).
  3700
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1278.cbl
  3701
  3702****************************************************************
  3703*             BUSSINESS TYPE MASTER RECORD                     *
  3704****************************************************************
  3705
  3706     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3707* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3708* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3709* AND RECORD 05 IS TYPES 81-99
  3710         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3711             20  CF-BUSINESS-TITLE          PIC  X(19).
  3712             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3713                                            PIC S9V9(4) COMP-3.
  3714             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3715             20  FILLER                     PIC  X.
  3716         16  FILLER                         PIC  X(248).
  3717
  3718
  3719****************************************************************
  3720*             TERMINAL MASTER RECORD                           *
  3721****************************************************************
  3722
  3723     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3724
  3725         16  CF-COMPANY-TERMINALS.
  3726             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3727                                  PIC X(4).
  3728         16  FILLER               PIC X(248).
  3729
  3730
  3731****************************************************************
  3732*             LIFE EDIT MASTER RECORD                          *
  3733****************************************************************
  3734
  3735     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3736         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3737             20  CF-LIFE-CODE-IN            PIC XX.
  3738             20  CF-LIFE-CODE-OUT           PIC XX.
  3739         16  FILLER                         PIC X(248).
  3740
  3741
  3742****************************************************************
  3743*             AH EDIT MASTER RECORD                            *
  3744****************************************************************
  3745
  3746     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3747         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3748             20  CF-AH-CODE-IN              PIC XXX.
  3749             20  CF-AH-CODE-OUT             PIC XX.
  3750         16  FILLER                         PIC X(248).
  3751
  3752
  3753****************************************************************
  3754*             CREDIBILITY TABLES                               *
  3755****************************************************************
  3756
  3757     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3758         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1278.cbl
  3759                             INDEXED BY CF-CRDB-NDX.
  3760             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3761             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3762             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3763         16  FILLER                         PIC  X(332).
  3764
  3765
  3766****************************************************************
  3767*             REPORT CUSTOMIZATION RECORD                      *
  3768****************************************************************
  3769
  3770     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3771         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3772             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3773             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3774             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3775**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3776****       A T-TRANSFER.                                   ****
  3777             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3778
  3779         16  FILLER                         PIC XX.
  3780
  3781         16  CF-CARRIER-CNTL-OPT.
  3782             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3783                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3784                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3785             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3786                                            PIC X.
  3787         16  CF-GROUP-CNTL-OPT.
  3788             20  CF-GROUP-OPT-SEQ           PIC 9.
  3789                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3790                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3791             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3792                                            PIC X(6).
  3793         16  CF-STATE-CNTL-OPT.
  3794             20  CF-STATE-OPT-SEQ           PIC 9.
  3795                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3796                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3797             20  CF-STATE-SELECT OCCURS 3 TIMES
  3798                                            PIC XX.
  3799         16  CF-ACCOUNT-CNTL-OPT.
  3800             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3801                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3802                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3803             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3804                                            PIC X(10).
  3805         16  CF-BUS-TYP-CNTL-OPT.
  3806             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3807                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3808                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3809             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3810                                            PIC XX.
  3811         16  CF-LF-TYP-CNTL-OPT.
  3812             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3813                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3814                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3815             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3816                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1278.cbl
  3817         16  CF-AH-TYP-CNTL-OPT.
  3818             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3819                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3820                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3821             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3822                                            PIC XX.
  3823         16  CF-REPTCD1-CNTL-OPT.
  3824             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3825                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3826                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3827             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3828                                            PIC X(10).
  3829         16  CF-REPTCD2-CNTL-OPT.
  3830             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3831                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3832                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3833             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3834                                            PIC X(10).
  3835         16  CF-USER1-CNTL-OPT.
  3836             20  CF-USER1-OPT-SEQ           PIC 9.
  3837                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3838                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3839             20  CF-USER1-SELECT OCCURS 3 TIMES
  3840                                            PIC X(10).
  3841         16  CF-USER2-CNTL-OPT.
  3842             20  CF-USER2-OPT-SEQ           PIC 9.
  3843                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3844                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3845             20  CF-USER2-SELECT OCCURS 3 TIMES
  3846                                            PIC X(10).
  3847         16  CF-USER3-CNTL-OPT.
  3848             20  CF-USER3-OPT-SEQ           PIC 9.
  3849                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3850                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3851             20  CF-USER3-SELECT OCCURS 3 TIMES
  3852                                            PIC X(10).
  3853         16  CF-USER4-CNTL-OPT.
  3854             20  CF-USER4-OPT-SEQ           PIC 9.
  3855                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3856                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3857             20  CF-USER4-SELECT OCCURS 3 TIMES
  3858                                            PIC X(10).
  3859         16  CF-USER5-CNTL-OPT.
  3860             20  CF-USER5-OPT-SEQ           PIC 9.
  3861                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3862                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3863             20  CF-USER5-SELECT OCCURS 3 TIMES
  3864                                            PIC X(10).
  3865         16  CF-REINS-CNTL-OPT.
  3866             20  CF-REINS-OPT-SEQ           PIC 9.
  3867                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3868                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3869             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3870                 24  CF-REINS-PRIME         PIC XXX.
  3871                 24  CF-REINS-SUB           PIC XXX.
  3872
  3873         16  CF-AGENT-CNTL-OPT.
  3874             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1278.cbl
  3875                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3876                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3877             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3878                                            PIC X(10).
  3879
  3880         16  FILLER                         PIC X(43).
  3881
  3882         16  CF-LOSS-RATIO-SELECT.
  3883             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3884             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3885         16  CF-ENTRY-DATE-SELECT.
  3886             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3887             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3888         16  CF-EFFECTIVE-DATE-SELECT.
  3889             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3890             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3891
  3892         16  CF-EXCEPTION-LIST-IND          PIC X.
  3893             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3894
  3895         16  FILLER                         PIC X(318).
  3896
  3897****************************************************************
  3898*                  EXCEPTION REPORTING RECORD                  *
  3899****************************************************************
  3900
  3901     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3902         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3903             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3904
  3905         16  CF-COMBINED-LIFE-AH-OPT.
  3906             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3907             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3908             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3909             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3910
  3911         16  CF-LIFE-OPT.
  3912             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3913             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3914             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3915             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3916             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3917             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3918             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3919             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3920             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3921             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3922
  3923         16  CF-AH-OPT.
  3924             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3925             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3926             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3927             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3928             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3929             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3930             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3931             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3932             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1278.cbl
  3933             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3934
  3935         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3936             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3937             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3938             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3939
  3940         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3941
  3942         16  FILLER                         PIC X(673).
  3943
  3944
  3945****************************************************************
  3946*             MORTGAGE SYSTEM PLAN RECORD                      *
  3947****************************************************************
  3948
  3949     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3950         16  CF-PLAN-TYPE                   PIC X.
  3951             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3952             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3953             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3954         16  CF-PLAN-ABBREV                 PIC XXX.
  3955         16  CF-PLAN-DESCRIPT               PIC X(10).
  3956         16  CF-PLAN-NOTES                  PIC X(20).
  3957         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3958         16  CF-PLAN-UNDERWRITING.
  3959             20  CF-PLAN-TERM-DATA.
  3960                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3961                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3962             20  CF-PLAN-AGE-DATA.
  3963                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3964                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3965                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3966             20  CF-PLAN-BENEFIT-DATA.
  3967                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3968                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3969                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3970                                            PIC S9(7)V99  COMP-3.
  3971         16  CF-PLAN-POLICY-FORMS.
  3972             20  CF-POLICY-FORM             PIC X(12).
  3973             20  CF-MASTER-APPLICATION      PIC X(12).
  3974             20  CF-MASTER-POLICY           PIC X(12).
  3975         16  CF-PLAN-RATING.
  3976             20  CF-RATE-CODE               PIC X(5).
  3977             20  CF-SEX-RATING              PIC X.
  3978                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3979                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3980             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3981             20  CF-SUB-STD-TYPE            PIC X.
  3982                 88  CF-PCT-OF-PREM            VALUE '1'.
  3983                 88  CF-PCT-OF-BENE            VALUE '2'.
  3984         16  CF-PLAN-PREM-TOLERANCES.
  3985             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3986             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3987         16  CF-PLAN-PYMT-TOLERANCES.
  3988             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3989             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3990         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1278.cbl
  3991             20  FILLER                     PIC X.
  3992             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3993             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3994         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3995         16  CF-PLAN-IND-GRP                PIC X.
  3996             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3997                                                     '1'.
  3998             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3999                                                     '2'.
  4000         16  CF-MIB-SEARCH-SW               PIC X.
  4001             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4002             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4003             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4004             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4005         16  CF-ALPHA-SEARCH-SW             PIC X.
  4006             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4007             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4008             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4009             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4010             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4011             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4012             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4013             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4014             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4015             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4016                                                     'A' 'B' 'C'
  4017                                                     'X' 'Y' 'Z'.
  4018         16  CF-EFF-DT-RULE-SW              PIC X.
  4019             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4020             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4021             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4022             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4023             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4024         16  FILLER                         PIC X(4).
  4025         16  CF-HEALTH-QUESTIONS            PIC X.
  4026             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4027         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4028         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4029         16  CF-PLAN-SNGL-JNT               PIC X.
  4030             88  CF-COMBINED-PLAN              VALUE 'C'.
  4031             88  CF-JNT-PLAN                   VALUE 'J'.
  4032             88  CF-SNGL-PLAN                  VALUE 'S'.
  4033         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4034         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4035         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4036         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4037         16  CF-RERATE-CNTL                 PIC  X.
  4038             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4039             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4040             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4041             88  CF-AUTO-RECALC                 VALUE '4'.
  4042         16  CF-BENEFIT-TYPE                PIC  X.
  4043             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4044             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4045         16  CF-POLICY-FEE                  PIC S999V99
  4046                                                    COMP-3.
  4047         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4048         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1278.cbl
  4049         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4050         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4051         16  FILLER                         PIC  X(32).
  4052         16  CF-TERMINATION-FORM            PIC  X(04).
  4053         16  FILLER                         PIC  X(08).
  4054         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4055                                                       COMP-3.
  4056         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4057         16  CF-ISSUE-LETTER                PIC  X(4).
  4058         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4059         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4060             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4061             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4062         16  CF-MP-REFUND-CALC              PIC X.
  4063             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4064             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4065             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4066             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4067             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4068             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4069             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4070             88  CF-MP-REFD-MEAN                VALUE '8'.
  4071         16  CF-ALT-RATE-CODE               PIC  X(5).
  4072
  4073
  4074         16  FILLER                         PIC X(498).
  4075****************************************************************
  4076*             MORTGAGE COMPANY MASTER RECORD                   *
  4077****************************************************************
  4078
  4079     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4080         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4081         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4082             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4083             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4084             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4085             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4086             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4087
  4088         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4089         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4090         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4091         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4092         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4093
  4094         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4095             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4096         16  CF-MP-RECON-USE-IND            PIC X(1).
  4097             88  CF-MP-USE-RECON             VALUE 'Y'.
  4098         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4099             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4100         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4101             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4102             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4103         16  FILLER                         PIC X(1).
  4104         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4105             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4106         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1278.cbl
  4107             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4108             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4109             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4110         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4111             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4112                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4113             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4114                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4115             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4116                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4117             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4118                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4119             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4120                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4121             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4122                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4123         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4124         16  FILLER                         PIC X(7).
  4125         16  CF-MORTG-DESTINATION-SYMBOL.
  4126             20  CF-MORTG-MIB-COMM          PIC X(5).
  4127             20  CF-MORTG-MIB-TERM          PIC X(5).
  4128         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4129             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4130         16  FILLER                         PIC X(03).
  4131         16  CF-MP-CHECK-NO-CONTROL.
  4132             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4133                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4134                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4135                                                ' ' LOW-VALUES.
  4136                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4137                                               VALUE '3'.
  4138         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4139         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4140         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4141             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4142                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4143             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4144                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4145             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4146                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4147             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4148                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4149             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4150                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4151             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4152                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4153         16  CF-MORTG-BILLING-AREA.
  4154             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4155                                            PIC X.
  4156         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4157         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4158         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4159         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4160             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4161             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4162         16  FILLER                         PIC X.
  4163         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4164             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1278.cbl
  4165             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4166         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4167         16  FILLER                         PIC X(8).
  4168         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4169         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4170         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4171         16  CF-ACH-COMPANY-ID.
  4172             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4173                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4174                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4175                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4176             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4177         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4178             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4179         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4180             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4181             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4182         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4183         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4184         16  FILLER                         PIC X(536).
  4185
  4186****************************************************************
  4187*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4188****************************************************************
  4189
  4190     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4191         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4192             20  CF-FEMALE-HEIGHT.
  4193                 24  CF-FEMALE-FT           PIC 99.
  4194                 24  CF-FEMALE-IN           PIC 99.
  4195             20  CF-FEMALE-MIN-WT           PIC 999.
  4196             20  CF-FEMALE-MAX-WT           PIC 999.
  4197         16  FILLER                         PIC X(428).
  4198
  4199     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4200         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4201             20  CF-MALE-HEIGHT.
  4202                 24  CF-MALE-FT             PIC 99.
  4203                 24  CF-MALE-IN             PIC 99.
  4204             20  CF-MALE-MIN-WT             PIC 999.
  4205             20  CF-MALE-MAX-WT             PIC 999.
  4206         16  FILLER                         PIC X(428).
  4207******************************************************************
  4208*             AUTOMATIC ACTIVITY RECORD                          *
  4209******************************************************************
  4210     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4211         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4212             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4213             20  CF-SYS-LETTER-ID           PIC X(04).
  4214             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4215             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4216             20  CF-SYS-RESET-SW            PIC X(01).
  4217             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4218             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4219
  4220         16  FILLER                         PIC X(50).
  4221
  4222         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1278.cbl
  4223             20  CF-USER-ACTIVE-SW          PIC X(01).
  4224             20  CF-USER-LETTER-ID          PIC X(04).
  4225             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4226             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4227             20  CF-USER-RESET-SW           PIC X(01).
  4228             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4229             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4230             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4231
  4232         16  FILLER                         PIC X(246).
  4233*                            COPY ERCACCT.
  4234******************************************************************
  4235*                                                                *
  4236*                                                                *
  4237*                            ERCACCT                             *
  4238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4239*                            VMOD=2.031                          *
  4240*                                                                *
  4241*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4242*                                                                *
  4243*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4244*   VSAM ACCOUNT MASTER FILES.                                   *
  4245*                                                                *
  4246*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4247*                                                                *
  4248*   FILE TYPE = VSAM,KSDS                                        *
  4249*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4250*                                                                *
  4251*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4252*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4253*                                                                *
  4254*   LOG = NO                                                     *
  4255*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4256*                                                                *
  4257*                                                                *
  4258******************************************************************
  4259*                   C H A N G E   L O G
  4260*
  4261* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4262*-----------------------------------------------------------------
  4263*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4264* EFFECTIVE    NUMBER
  4265*-----------------------------------------------------------------
  4266* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4267* 092705    2005050300006  PEMA  ADD SPP LEASES
  4268* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4269* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4270* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4271* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4272* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4273******************************************************************
  4274
  4275 01  ACCOUNT-MASTER.
  4276     12  AM-RECORD-ID                      PIC XX.
  4277         88  VALID-AM-ID                      VALUE 'AM'.
  4278
  4279     12  AM-CONTROL-PRIMARY.
  4280         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL1278.cbl
  4281         16  AM-MSTR-CNTRL.
  4282             20  AM-CONTROL-A.
  4283                 24  AM-CARRIER            PIC X.
  4284                 24  AM-GROUPING.
  4285                     28 AM-GROUPING-PREFIX PIC XXX.
  4286                     28 AM-GROUPING-PRIME  PIC XXX.
  4287                 24  AM-STATE              PIC XX.
  4288                 24  AM-ACCOUNT.
  4289                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4290                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4291             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4292                                           PIC X(19).
  4293             20  AM-CNTRL-B.
  4294                 24  AM-EXPIRATION-DT      PIC XX.
  4295                 24  FILLER                PIC X(4).
  4296             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4297                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4298
  4299     12  AM-CONTROL-BY-VAR-GRP.
  4300         16  AM-COMPANY-CD-A1              PIC X.
  4301         16  AM-VG-CARRIER                 PIC X.
  4302         16  AM-VG-GROUPING                PIC X(6).
  4303         16  AM-VG-STATE                   PIC XX.
  4304         16  AM-VG-ACCOUNT                 PIC X(10).
  4305         16  AM-VG-DATE.
  4306             20  AM-VG-EXPIRATION-DT       PIC XX.
  4307             20  FILLER                    PIC X(4).
  4308         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4309                                           PIC 9(11)      COMP-3.
  4310     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4311         16  FILLER                        PIC X(10).
  4312         16  AM-VG-KEY3.
  4313             20  AM-VG3-ACCOUNT            PIC X(10).
  4314             20  AM-VG3-EXP-DT             PIC XX.
  4315         16  FILLER                        PIC X(4).
  4316     12  AM-MAINT-INFORMATION.
  4317         16  AM-LAST-MAINT-DT              PIC XX.
  4318         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4319         16  AM-LAST-MAINT-USER            PIC X(4).
  4320         16  FILLER                        PIC XX.
  4321
  4322     12  AM-EFFECTIVE-DT                   PIC XX.
  4323     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4324
  4325     12  AM-PREV-DATES  COMP-3.
  4326         16  AM-PREV-EXP-DT                PIC 9(11).
  4327         16  AM-PREV-EFF-DT                PIC 9(11).
  4328
  4329     12  AM-REPORT-CODE-1                  PIC X(10).
  4330     12  AM-REPORT-CODE-2                  PIC X(10).
  4331
  4332     12  AM-CITY-CODE                      PIC X(4).
  4333     12  AM-COUNTY-PARISH                  PIC X(6).
  4334
  4335     12  AM-NAME                           PIC X(30).
  4336     12  AM-PERSON                         PIC X(30).
  4337     12  AM-ADDRS                          PIC X(30).
  4338     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL1278.cbl
  4339         16  AM-ADDR-CITY                  PIC X(28).
  4340         16  AM-ADDR-STATE                 PIC XX.
  4341     12  AM-ZIP.
  4342         16  AM-ZIP-PRIME.
  4343             20  AM-ZIP-PRI-1ST            PIC X.
  4344                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4345             20  FILLER                    PIC X(4).
  4346         16  AM-ZIP-PLUS4                  PIC X(4).
  4347     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4348         16  AM-CAN-POSTAL-1               PIC XXX.
  4349         16  AM-CAN-POSTAL-2               PIC XXX.
  4350         16  FILLER                        PIC XXX.
  4351     12  AM-TEL-NO.
  4352         16  AM-AREA-CODE                  PIC 999.
  4353         16  AM-TEL-PRE                    PIC 999.
  4354         16  AM-TEL-NBR                    PIC 9(4).
  4355     12  AM-TEL-LOC                        PIC X.
  4356         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4357         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4358
  4359     12  AM-COMM-STRUCTURE.
  4360         16  AM-DEFN-1.
  4361             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4362                 24  AM-AGT.
  4363                     28  AM-AGT-PREFIX     PIC X(4).
  4364                     28  AM-AGT-PRIME      PIC X(6).
  4365                 24  AM-COM-TYP            PIC X.
  4366                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4367                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4368                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4369                 24  AM-RECALC-LV-INDIC    PIC X.
  4370                 24  AM-RETRO-LV-INDIC     PIC X.
  4371                 24  AM-GL-CODES           PIC X.
  4372                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4373                 24  FILLER                PIC X(01).
  4374         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4375             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4376                 24  FILLER                PIC X(11).
  4377                 24  AM-L-COMA             PIC XXX.
  4378                 24  AM-J-COMA             PIC XXX.
  4379                 24  AM-A-COMA             PIC XXX.
  4380                 24  FILLER                PIC X(6).
  4381
  4382     12  AM-COMM-CHANGE-STATUS             PIC X.
  4383         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4384
  4385     12  AM-CSR-CODE                       PIC X(4).
  4386
  4387     12  AM-BILLING-STATUS                 PIC X.
  4388         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4389         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4390     12  AM-AUTO-REFUND-SW                 PIC X.
  4391         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4392         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4393     12  AM-GPCD                           PIC 99.
  4394     12  AM-IG                             PIC X.
  4395         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4396         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL1278.cbl
  4397     12  AM-STATUS                         PIC X.
  4398         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4399         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4400         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4401         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4402         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4403         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4404     12  AM-REMIT-TO                       PIC 99.
  4405     12  AM-ID-NO                          PIC X(11).
  4406
  4407     12  AM-CAL-TABLE                      PIC XX.
  4408     12  AM-LF-DEVIATION                   PIC XXX.
  4409     12  AM-AH-DEVIATION                   PIC XXX.
  4410     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4411     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4412     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4413     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4414     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4415     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4416
  4417     12  AM-USER-FIELDS.
  4418         16  AM-FLD-1                      PIC XX.
  4419         16  AM-FLD-2                      PIC XX.
  4420         16  AM-FLD-3                      PIC XX.
  4421         16  AM-FLD-4                      PIC XX.
  4422         16  AM-FLD-5                      PIC XX.
  4423
  4424     12  AM-1ST-PROD-DATE.
  4425         16  AM-1ST-PROD-YR                PIC XX.
  4426         16  AM-1ST-PROD-MO                PIC XX.
  4427         16  AM-1ST-PROD-DA                PIC XX.
  4428     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4429     12  AM-CERTS-PURGED-DATE.
  4430         16  AM-PUR-YR                     PIC XX.
  4431         16  AM-PUR-MO                     PIC XX.
  4432         16  AM-PUR-DA                     PIC XX.
  4433     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4434     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4435     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4436     12  AM-INACTIVE-DATE.
  4437         16  AM-INA-MO                     PIC 99.
  4438         16  AM-INA-DA                     PIC 99.
  4439         16  AM-INA-YR                     PIC 99.
  4440     12  AM-AR-HI-CERT-DATE                PIC XX.
  4441
  4442     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4443     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4444
  4445     12  AM-OB-PAYMENT-MODE                PIC X.
  4446         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4447         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4448         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4449         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4450
  4451     12  AM-AH-ONLY-INDICATOR              PIC X.
  4452         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4453         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4454
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL1278.cbl
  4455     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4456
  4457     12  AM-OVER-SHORT.
  4458         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4459         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4460
  4461     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4462     12  AM-DCC-CLP-STATE                  PIC XX.
  4463
  4464     12  AM-RECALC-COMM                    PIC X.
  4465     12  AM-RECALC-REIN                    PIC X.
  4466
  4467     12  AM-REI-TABLE                      PIC XXX.
  4468     12  AM-REI-ET-LF                      PIC X.
  4469     12  AM-REI-ET-AH                      PIC X.
  4470     12  AM-REI-PE-LF                      PIC X.
  4471     12  AM-REI-PE-AH                      PIC X.
  4472     12  AM-REI-PRT-ST                     PIC X.
  4473     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4474     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4475     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4476     12  AM-REI-GROUP-A                    PIC X(6).
  4477     12  AM-REI-MORT                       PIC X(4).
  4478     12  AM-REI-PRT-OW                     PIC X.
  4479     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4480     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4481     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4482     12  AM-REI-GROUP-B                    PIC X(6).
  4483
  4484     12  AM-TRUST-TYPE                     PIC X(2).
  4485
  4486     12  AM-EMPLOYER-STMT-USED             PIC X.
  4487     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4488
  4489     12  AM-STD-AH-TYPE                    PIC XX.
  4490     12  AM-EARN-METHODS.
  4491         16  AM-EARN-METHOD-R              PIC X.
  4492             88 AM-REF-RL-R78                 VALUE 'R'.
  4493             88 AM-REF-RL-PR                  VALUE 'P'.
  4494             88 AM-REF-RL-MEAN                VALUE 'M'.
  4495             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4496         16  AM-EARN-METHOD-L              PIC X.
  4497             88 AM-REF-LL-R78                 VALUE 'R'.
  4498             88 AM-REF-LL-PR                  VALUE 'P'.
  4499             88 AM-REF-LL-MEAN                VALUE 'M'.
  4500             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4501         16  AM-EARN-METHOD-A              PIC X.
  4502             88 AM-REF-AH-R78                 VALUE 'R'.
  4503             88 AM-REF-AH-PR                  VALUE 'P'.
  4504             88 AM-REF-AH-MEAN                VALUE 'M'.
  4505             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4506             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4507             88 AM-REF-AH-NET                 VALUE 'N'.
  4508
  4509     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4510     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4511     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4512
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL1278.cbl
  4513     12  AM-RET-Y-N                        PIC X.
  4514     12  AM-RET-P-E                        PIC X.
  4515     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4516     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4517     12  AM-RET-GRP                        PIC X(6).
  4518     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4519         16  AM-POOL-PRIME                 PIC XXX.
  4520         16  AM-POOL-SUB                   PIC XXX.
  4521     12  AM-RETRO-EARNINGS.
  4522         16  AM-RET-EARN-R                 PIC X.
  4523         16  AM-RET-EARN-L                 PIC X.
  4524         16  AM-RET-EARN-A                 PIC X.
  4525     12  AM-RET-ST-TAX-USE                 PIC X.
  4526         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4527         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4528     12  AM-RETRO-BEG-EARNINGS.
  4529         16  AM-RET-BEG-EARN-R             PIC X.
  4530         16  AM-RET-BEG-EARN-L             PIC X.
  4531         16  AM-RET-BEG-EARN-A             PIC X.
  4532     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4533     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4534
  4535     12  AM-USER-SELECT-OPTIONS.
  4536         16  AM-USER-SELECT-1              PIC X(10).
  4537         16  AM-USER-SELECT-2              PIC X(10).
  4538         16  AM-USER-SELECT-3              PIC X(10).
  4539         16  AM-USER-SELECT-4              PIC X(10).
  4540         16  AM-USER-SELECT-5              PIC X(10).
  4541
  4542     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4543
  4544     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4545
  4546     12  AM-RPT045A-SWITCH                 PIC X.
  4547         88  RPT045A-OFF                   VALUE 'N'.
  4548
  4549     12  AM-INSURANCE-LIMITS.
  4550         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4551         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4552
  4553     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4554         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4555
  4556     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4557         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4558         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4559
  4560     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4561
  4562     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4563     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4564     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4565     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4566     12  AM-DCC-UEF-STATE                  PIC XX.
  4567     12  FILLER                            PIC XXX.
  4568     12  AM-REPORT-CODE-3                  PIC X(10).
  4569*    12  FILLER                            PIC X(22).
  4570
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL1278.cbl
  4571     12  AM-RESERVE-DATE.
  4572         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4573         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4574         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4575
  4576     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4577     12  AM-NOTIFICATION-TYPES.
  4578         16  AM-NOTIF-OF-LETTERS           PIC X.
  4579         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4580         16  AM-NOTIF-OF-REPORTS           PIC X.
  4581         16  AM-NOTIF-OF-STATUS            PIC X.
  4582
  4583     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4584         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4585         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4586         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4587         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4588
  4589     12  AM-BENEFIT-CONTROLS.
  4590         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4591             20  AM-BENEFIT-CODE           PIC XX.
  4592             20  AM-BENEFIT-TYPE           PIC X.
  4593             20  AM-BENEFIT-REVISION       PIC XXX.
  4594             20  AM-BENEFIT-REM-TERM       PIC X.
  4595             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4596             20  FILLER                    PIC XX.
  4597         16  FILLER                        PIC X(80).
  4598
  4599     12  AM-TRANSFER-DATA.
  4600         16  AM-TRANSFERRED-FROM.
  4601             20  AM-TRNFROM-CARRIER        PIC X.
  4602             20  AM-TRNFROM-GROUPING.
  4603                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4604                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4605             20  AM-TRNFROM-STATE          PIC XX.
  4606             20  AM-TRNFROM-ACCOUNT.
  4607                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4608                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4609             20  AM-TRNFROM-DTE            PIC XX.
  4610         16  AM-TRANSFERRED-TO.
  4611             20  AM-TRNTO-CARRIER          PIC X.
  4612             20  AM-TRNTO-GROUPING.
  4613                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4614                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4615             20  AM-TRNTO-STATE            PIC XX.
  4616             20  AM-TRNTO-ACCOUNT.
  4617                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4618                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4619             20  AM-TRNTO-DTE              PIC XX.
  4620         16  FILLER                        PIC X(10).
  4621
  4622     12  AM-SAVED-REMIT-TO                 PIC 99.
  4623
  4624     12  AM-COMM-STRUCTURE-SAVED.
  4625         16  AM-DEFN-1-SAVED.
  4626             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4627                 24  AM-AGT-SV             PIC X(10).
  4628                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL1278.cbl
  4629                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4630                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4631                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4632                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4633                 24  FILLER                PIC X.
  4634                 24  AM-GL-CODES-SV        PIC X.
  4635                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4636                 24  FILLER                PIC X.
  4637         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4638             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4639                 24  FILLER                PIC X(11).
  4640                 24  AM-L-COMA-SV          PIC XXX.
  4641                 24  AM-J-COMA-SV          PIC XXX.
  4642                 24  AM-A-COMA-SV          PIC XXX.
  4643                 24  FILLER                PIC X(6).
  4644
  4645     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4646         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4647            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4648            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4649            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4650
  4651     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4652     12  FILLER                            PIC X(120).
  4653
  4654     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4655         16  AM-CONTROL-NAME               PIC X(30).
  4656         16  AM-EXECUTIVE-ONE.
  4657             20  AM-EXEC1-NAME             PIC X(15).
  4658             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4659                                                          COMP-3.
  4660             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4661                                                          COMP-3.
  4662         16  AM-EXECUTIVE-TWO.
  4663             20  AM-EXEC2-NAME             PIC X(15).
  4664             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4665                                                          COMP-3.
  4666             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4667                                                          COMP-3.
  4668
  4669     12  AM-RETRO-ADDITIONAL-DATA.
  4670         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4671         16  AM-RETRO-PREM-P-E             PIC X.
  4672         16  AM-RETRO-CLMS-P-I             PIC X.
  4673         16  AM-RETRO-RET-BRACKET-LF.
  4674             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4675                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4676                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4677             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4678                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4679                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4680             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4681                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4682                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4683         16  AM-RETRO-RET-BRACKET-AH.
  4684             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4685                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4686                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL1278.cbl
  4687                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4688             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4689                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4690                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4691             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4692                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4693                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4694
  4695     12  AM-COMMENTS.
  4696         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4697
  4698     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4699         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4700         16  AM-FLI-BILLING-CODE           PIC X.
  4701         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4702         16  AM-FLI-UNITED-IDENT           PIC X.
  4703         16  AM-FLI-INTEREST-LOST-DATA.
  4704             20  AM-FLI-BANK-NO            PIC X(5).
  4705             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4706             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4707             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4708         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4709             20  AM-FLI-AGT                PIC X(9).
  4710             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4711             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4712         16  FILLER                        PIC X(102).
  4713
  4714     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4715         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4716             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4717             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4718             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4719             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4720             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4721         16  FILLER                          PIC X(10).
  4722******************************************************************
  4723*                            COPY ELCCERT.
  4724******************************************************************
  4725*                                                                *
  4726*                            ELCCERT.                            *
  4727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4728*                            VMOD=2.013                          *
  4729*                                                                *
  4730*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4731*                                                                *
  4732*   FILE TYPE = VSAM,KSDS                                        *
  4733*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4734*                                                                *
  4735*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4736*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4737*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4738*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4739*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4740*                                                                *
  4741*   LOG = YES                                                    *
  4742*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4743******************************************************************
  4744*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL1278.cbl
  4745*
  4746* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4747*-----------------------------------------------------------------
  4748*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4749* EFFECTIVE    NUMBER
  4750*-----------------------------------------------------------------
  4751* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4752* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4753* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4754* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4755* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4756* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4757* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4758* 032612  CR2011110200001  PEMA  AHL CHANGES
  4759******************************************************************
  4760
  4761 01  CERTIFICATE-MASTER.
  4762     12  CM-RECORD-ID                      PIC XX.
  4763         88  VALID-CM-ID                      VALUE 'CM'.
  4764
  4765     12  CM-CONTROL-PRIMARY.
  4766         16  CM-COMPANY-CD                 PIC X.
  4767         16  CM-CARRIER                    PIC X.
  4768         16  CM-GROUPING.
  4769             20  CM-GROUPING-PREFIX        PIC X(3).
  4770             20  CM-GROUPING-PRIME         PIC X(3).
  4771         16  CM-STATE                      PIC XX.
  4772         16  CM-ACCOUNT.
  4773             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4774             20  CM-ACCOUNT-PRIME          PIC X(6).
  4775         16  CM-CERT-EFF-DT                PIC XX.
  4776         16  CM-CERT-NO.
  4777             20  CM-CERT-PRIME             PIC X(10).
  4778             20  CM-CERT-SFX               PIC X.
  4779
  4780     12  CM-CONTROL-BY-NAME.
  4781         16  CM-COMPANY-CD-A1              PIC X.
  4782         16  CM-INSURED-LAST-NAME          PIC X(15).
  4783         16  CM-INSURED-INITIALS.
  4784             20  CM-INSURED-INITIAL1       PIC X.
  4785             20  CM-INSURED-INITIAL2       PIC X.
  4786
  4787     12  CM-CONTROL-BY-SSN.
  4788         16  CM-COMPANY-CD-A2              PIC X.
  4789         16  CM-SOC-SEC-NO.
  4790             20  CM-SSN-STATE              PIC XX.
  4791             20  CM-SSN-ACCOUNT            PIC X(6).
  4792             20  CM-SSN-LN3.
  4793                 25  CM-INSURED-INITIALS-A2.
  4794                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4795                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4796                 25 CM-PART-LAST-NAME-A2         PIC X.
  4797
  4798     12  CM-CONTROL-BY-CERT-NO.
  4799         16  CM-COMPANY-CD-A4              PIC X.
  4800         16  CM-CERT-NO-A4                 PIC X(11).
  4801
  4802     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL1278.cbl
  4803         16  CM-COMPANY-CD-A5              PIC X.
  4804         16  CM-MEMBER-NO.
  4805             20  CM-MEMB-STATE             PIC XX.
  4806             20  CM-MEMB-ACCOUNT           PIC X(6).
  4807             20  CM-MEMB-LN4.
  4808                 25  CM-INSURED-INITIALS-A5.
  4809                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4810                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4811                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4812
  4813     12  CM-INSURED-PROFILE-DATA.
  4814         16  CM-INSURED-FIRST-NAME.
  4815             20  CM-INSURED-1ST-INIT       PIC X.
  4816             20  FILLER                    PIC X(9).
  4817         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4818         16  CM-INSURED-SEX                PIC X.
  4819             88  CM-SEX-MALE                  VALUE 'M'.
  4820             88  CM-SEX-FEMAL                 VALUE 'F'.
  4821         16  CM-INSURED-JOINT-AGE          PIC 99.
  4822         16  CM-JOINT-INSURED-NAME.
  4823             20  CM-JT-LAST-NAME           PIC X(15).
  4824             20  CM-JT-FIRST-NAME.
  4825                 24  CM-JT-1ST-INIT        PIC X.
  4826                 24  FILLER                PIC X(9).
  4827             20  CM-JT-INITIAL             PIC X.
  4828
  4829     12  CM-LIFE-DATA.
  4830         16  CM-LF-BENEFIT-CD              PIC XX.
  4831         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4832         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4833         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4834         16  CM-LF-DEV-CODE                PIC XXX.
  4835         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4836         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4837         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4838         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4839         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4840         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4841         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4842         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4843         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4844         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4845         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4846         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4847         16  FILLER                        PIC XX.
  4848
  4849     12  CM-AH-DATA.
  4850         16  CM-AH-BENEFIT-CD              PIC XX.
  4851         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4852         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4853         16  CM-AH-DEV-CODE                PIC XXX.
  4854         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4855         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4856         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4857         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4858         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4859         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4860         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL1278.cbl
  4861         16  CM-AH-PAID-THRU-DT            PIC XX.
  4862             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4863         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4864         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4865         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4866         16  FILLER                        PIC X.
  4867
  4868     12  CM-LOAN-INFORMATION.
  4869         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4870         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4871                                           PIC S9(5)V99  COMP-3.
  4872         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4873         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4874         16  CM-PAY-FREQUENCY              PIC S99.
  4875         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4876         16  CM-RATE-CLASS                 PIC XX.
  4877         16  CM-BENEFICIARY                PIC X(25).
  4878         16  CM-POLICY-FORM-NO             PIC X(12).
  4879         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4880         16  CM-LAST-ADD-ON-DT             PIC XX.
  4881         16  CM-DEDUCTIBLE-AMOUNTS.
  4882             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4883             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4884         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4885             20  CM-RESIDENT-STATE         PIC XX.
  4886             20  CM-RATE-CODE              PIC X(4).
  4887             20  FILLER                    PIC XX.
  4888         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4889             20  CM-LOAN-OFFICER           PIC X(5).
  4890             20  FILLER                    PIC XXX.
  4891         16  CM-CSR-CODE                   PIC XXX.
  4892         16  CM-UNDERWRITING-CODE          PIC X.
  4893             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4894         16  CM-POST-CARD-IND              PIC X.
  4895         16  CM-NH-INTERFACE-SW            PIC X.
  4896         16  CM-PREMIUM-TYPE               PIC X.
  4897             88  CM-SING-PRM                  VALUE '1'.
  4898             88  CM-O-B-COVERAGE              VALUE '2'.
  4899             88  CM-OPEN-END                  VALUE '3'.
  4900         16  CM-IND-GRP-TYPE               PIC X.
  4901             88  CM-INDIVIDUAL                VALUE 'I'.
  4902             88  CM-GROUP                     VALUE 'G'.
  4903         16  CM-SKIP-CODE                  PIC X.
  4904             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4905             88  SKIP-JULY                    VALUE '1'.
  4906             88  SKIP-AUGUST                  VALUE '2'.
  4907             88  SKIP-SEPTEMBER               VALUE '3'.
  4908             88  SKIP-JULY-AUG                VALUE '4'.
  4909             88  SKIP-AUG-SEPT                VALUE '5'.
  4910             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4911             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4912             88  SKIP-JUNE                    VALUE '8'.
  4913             88  SKIP-JUNE-JULY               VALUE '9'.
  4914             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4915             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4916         16  CM-PAYMENT-MODE               PIC X.
  4917             88  PAY-MONTHLY                  VALUE SPACE.
  4918             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL1278.cbl
  4919             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4920             88  PAY-BI-WEEKLY                VALUE '3'.
  4921             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4922         16  CM-LOAN-NUMBER                PIC X(8).
  4923         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4924         16  CM-OLD-LOF                    PIC XXX.
  4925*        16  CM-LOAN-OFFICER               PIC XXX.
  4926         16  CM-REIN-TABLE                 PIC XXX.
  4927         16  CM-SPECIAL-REIN-CODE          PIC X.
  4928         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4929         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4930         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4931
  4932     12  CM-STATUS-DATA.
  4933         16  CM-ENTRY-STATUS               PIC X.
  4934         16  CM-ENTRY-DT                   PIC XX.
  4935
  4936         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4937         16  CM-LF-CANCEL-DT               PIC XX.
  4938         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4939
  4940         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4941         16  CM-LF-DEATH-DT                PIC XX.
  4942         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4943
  4944         16  CM-LF-CURRENT-STATUS          PIC X.
  4945             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4946                                                'M' '4' '5' '9'.
  4947             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4948             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4949             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4950             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4951             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4952             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4953             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4954             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4955             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4956             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4957             88  CM-LF-DECLINED               VALUE 'D'.
  4958             88  CM-LF-VOIDED                 VALUE 'V'.
  4959
  4960         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4961         16  CM-AH-CANCEL-DT               PIC XX.
  4962         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4963
  4964         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4965         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4966         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4967
  4968         16  CM-AH-CURRENT-STATUS          PIC X.
  4969             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4970                                                'M' '4' '5' '9'.
  4971             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4972             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4973             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4974             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4975             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4976             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL1278.cbl
  4977             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4978             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4979             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4980             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4981             88  CM-AH-DECLINED               VALUE 'D'.
  4982             88  CM-AH-VOIDED                 VALUE 'V'.
  4983
  4984         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4985             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4986             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4987             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4988         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4989
  4990         16  CM-ENTRY-BATCH                PIC X(6).
  4991         16  CM-LF-EXIT-BATCH              PIC X(6).
  4992         16  CM-AH-EXIT-BATCH              PIC X(6).
  4993         16  CM-LAST-MONTH-END             PIC XX.
  4994
  4995     12  CM-NOTE-SW                        PIC X.
  4996         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4997         88  CERT-NOTES-PRESENT               VALUE '1'.
  4998         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4999         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5000         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5001         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5002         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5003         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5004     12  CM-COMP-EXCP-SW                   PIC X.
  5005         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5006         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5007     12  CM-INSURED-ADDRESS-SW             PIC X.
  5008         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5009         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5010
  5011*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5012     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5013     12  FILLER                            PIC X.
  5014
  5015*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5016     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5017     12  FILLER                            PIC X.
  5018*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5019     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5020
  5021     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5022         88  CERT-ADDED-BATCH                 VALUE ' '.
  5023         88  CERT-ADDED-ONLINE                VALUE '1'.
  5024         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5025         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5026         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5027     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5028         88  CERT-AS-LOADED                   VALUE ' '.
  5029         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5030         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5031         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5032         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5033         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5034         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL1278.cbl
  5035         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5036
  5037     12  CM-ACCOUNT-COMM-PCTS.
  5038         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5039         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5040
  5041     12  CM-USER-FIELD                     PIC X.
  5042     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5043     12  CM-CLP-STATE                      PIC XX.
  5044     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5045     12  CM-USER-RESERVED                  PIC XXX.
  5046     12  FILLER REDEFINES CM-USER-RESERVED.
  5047         16  CM-AH-CLASS-CD                PIC XX.
  5048         16  F                             PIC X.
  5049******************************************************************
  5050*                            COPY ERCMAIL.
  5051******************************************************************
  5052*                                                                *
  5053*                                                                *
  5054*                            ERCMAIL                             *
  5055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5056*                            VMOD=2.003                          *
  5057*                                                                *
  5058*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5059*                                                                *
  5060*   FILE TYPE = VSAM,KSDS                                        *
  5061*   RECORD SIZE = 374   RECFORM = FIX                            *
  5062*                                                                *
  5063*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5064*   ALTERNATE PATH    = NOT USED                                 *
  5065*                                                                *
  5066*   LOG = YES                                                    *
  5067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5068******************************************************************
  5069*                   C H A N G E   L O G
  5070*
  5071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5072*-----------------------------------------------------------------
  5073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5074* EFFECTIVE    NUMBER
  5075*-----------------------------------------------------------------
  5076* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5077* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5078* 111108                   PEMA  ADD CRED BENE ADDR2
  5079******************************************************************
  5080
  5081 01  MAILING-DATA.
  5082     12  MA-RECORD-ID                      PIC XX.
  5083         88  VALID-MA-ID                       VALUE 'MA'.
  5084
  5085     12  MA-CONTROL-PRIMARY.
  5086         16  MA-COMPANY-CD                 PIC X.
  5087         16  MA-CARRIER                    PIC X.
  5088         16  MA-GROUPING.
  5089             20  MA-GROUPING-PREFIX        PIC XXX.
  5090             20  MA-GROUPING-PRIME         PIC XXX.
  5091         16  MA-STATE                      PIC XX.
  5092         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL1278.cbl
  5093             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5094             20  MA-ACCOUNT-PRIME          PIC X(6).
  5095         16  MA-CERT-EFF-DT                PIC XX.
  5096         16  MA-CERT-NO.
  5097             20  MA-CERT-PRIME             PIC X(10).
  5098             20  MA-CERT-SFX               PIC X.
  5099
  5100     12  FILLER                            PIC XX.
  5101
  5102     12  MA-ACCESS-CONTROL.
  5103         16  MA-SOURCE-SYSTEM              PIC XX.
  5104             88  MA-FROM-CREDIT                VALUE 'CR'.
  5105             88  MA-FROM-VSI                   VALUE 'VS'.
  5106             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5107             88  MA-FROM-OTHER                 VALUE 'OT'.
  5108         16  MA-RECORD-ADD-DT              PIC XX.
  5109         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5110         16  MA-LAST-MAINT-DT              PIC XX.
  5111         16  MA-LAST-MAINT-BY              PIC XXXX.
  5112         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5113
  5114     12  MA-PROFILE-INFO.
  5115         16  MA-QUALIFY-CODE-1             PIC XX.
  5116         16  MA-QUALIFY-CODE-2             PIC XX.
  5117         16  MA-QUALIFY-CODE-3             PIC XX.
  5118         16  MA-QUALIFY-CODE-4             PIC XX.
  5119         16  MA-QUALIFY-CODE-5             PIC XX.
  5120
  5121         16  MA-INSURED-LAST-NAME          PIC X(15).
  5122         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5123         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5124         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5125         16  MA-INSURED-BIRTH-DT           PIC XX.
  5126         16  MA-INSURED-SEX                PIC X.
  5127             88  MA-SEX-MALE                   VALUE 'M'.
  5128             88  MA-SEX-FEMALE                 VALUE 'F'.
  5129         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5130
  5131         16  MA-ADDRESS-CORRECTED          PIC X.
  5132         16  MA-JOINT-BIRTH-DT             PIC XX.
  5133*        16  FILLER                        PIC X(12).
  5134
  5135         16  MA-ADDRESS-LINE-1             PIC X(30).
  5136         16  MA-ADDRESS-LINE-2             PIC X(30).
  5137         16  MA-CITY-STATE.
  5138             20  MA-CITY                   PIC X(28).
  5139             20  MA-ADDR-STATE             PIC XX.
  5140         16  MA-ZIP.
  5141             20  MA-ZIP-CODE.
  5142                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5143                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5144                 24  FILLER                PIC X(4).
  5145             20  MA-ZIP-PLUS4              PIC X(4).
  5146         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5147             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5148             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5149             20  FILLER                    PIC X(3).
  5150
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL1278.cbl
  5151         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5152
  5153         16  FILLER                        PIC XXX.
  5154*        16  FILLER                        PIC X(10).
  5155
  5156     12  MA-CRED-BENE-INFO.
  5157         16  MA-CRED-BENE-NAME                 PIC X(25).
  5158         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5159         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5160         16  MA-CRED-BENE-CTYST.
  5161             20  MA-CRED-BENE-CITY             PIC X(28).
  5162             20  MA-CRED-BENE-STATE            PIC XX.
  5163         16  MA-CRED-BENE-ZIP.
  5164             20  MA-CB-ZIP-CODE.
  5165                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5166                     88  MA-CB-CANADIAN-POST-CODE
  5167                                           VALUE 'A' THRU 'Z'.
  5168                 24  FILLER                    PIC X(4).
  5169             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5170         16  MA-CB-CANADIAN-POSTAL-CODE
  5171                            REDEFINES MA-CRED-BENE-ZIP.
  5172             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5173             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5174             20  FILLER                        PIC X(3).
  5175     12  MA-POST-CARD-MAIL-DATA.
  5176         16  MA-MAIL-DATA OCCURS 7.
  5177             20  MA-MAIL-TYPE              PIC X.
  5178                 88  MA-12MO-MAILING           VALUE '1'.
  5179                 88  MA-EXP-MAILING            VALUE '2'.
  5180             20  MA-MAIL-STATUS            PIC X.
  5181                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5182                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5183                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5184             20  MA-MAIL-DATE              PIC XX.
  5185     12  FILLER                            PIC XX.
  5186     12  FILLER                            PIC XX.
  5187*    12  FILLER                            PIC X(30).
  5188******************************************************************
  5189*                            COPY ELCCRTO.
  5190******************************************************************
  5191*                                                                *
  5192*                            ELCCRTO.                            *
  5193*                                                                *
  5194*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5195*                                                                *
  5196*   FILE TYPE = VSAM,KSDS                                        *
  5197*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5198*                                                                *
  5199*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5200*                                                                *
  5201*   LOG = YES                                                    *
  5202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5203******************************************************************
  5204*                   C H A N G E   L O G
  5205*
  5206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5207*-----------------------------------------------------------------
  5208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL1278.cbl
  5209* EFFECTIVE    NUMBER
  5210*-----------------------------------------------------------------
  5211* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5212* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5213* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5214******************************************************************
  5215 01  ORIGINAL-CERTIFICATE.
  5216     12  OC-RECORD-ID                      PIC XX.
  5217         88  VALID-OC-ID                      VALUE 'OC'.
  5218     12  OC-CONTROL-PRIMARY.
  5219         16  OC-COMPANY-CD                 PIC X.
  5220         16  OC-CARRIER                    PIC X.
  5221         16  OC-GROUPING                   PIC X(6).
  5222         16  OC-STATE                      PIC XX.
  5223         16  OC-ACCOUNT                    PIC X(10).
  5224         16  OC-CERT-EFF-DT                PIC XX.
  5225         16  OC-CERT-NO.
  5226             20  OC-CERT-PRIME             PIC X(10).
  5227             20  OC-CERT-SFX               PIC X.
  5228         16  OC-RECORD-TYPE                PIC X.
  5229         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5230     12  OC-LAST-MAINT-DT                  PIC XX.
  5231     12  OC-LAST-MAINT-BY                  PIC X(4).
  5232     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5233     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5234     12  FILLER                            PIC X(49).
  5235     12  OC-ORIG-REC.
  5236         16  OC-INS-LAST-NAME              PIC X(15).
  5237         16  OC-INS-FIRST-NAME             PIC X(10).
  5238         16  OC-INS-MIDDLE-INIT            PIC X.
  5239         16  OC-INS-AGE                    PIC S999     COMP-3.
  5240         16  OC-JNT-LAST-NAME              PIC X(15).
  5241         16  OC-JNT-FIRST-NAME             PIC X(10).
  5242         16  OC-JNT-MIDDLE-INIT            PIC X.
  5243         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5244         16  OC-LF-BENCD                   PIC XX.
  5245         16  OC-LF-TERM                    PIC S999      COMP-3.
  5246         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5247         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5248         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5249         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5250         16  OC-LF-EXP-DT                  PIC XX.
  5251         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5252         16  OC-LF-CANCEL-DT               PIC XX.
  5253         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5254         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5255         16  OC-AH-BENCD                   PIC XX.
  5256         16  OC-AH-TERM                    PIC S999      COMP-3.
  5257         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5258         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5259         16  OC-AH-EXP-DT                  PIC XX.
  5260         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5261         16  OC-AH-CP                      PIC 99.
  5262         16  OC-AH-CANCEL-DT               PIC XX.
  5263         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5264         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5265         16  OC-CRED-BENE-NAME             PIC X(25).
  5266         16  OC-1ST-PMT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL1278.cbl
  5267         16  FILLER                        PIC X(215).
  5268
  5269     12  FILLER                            PIC X(50).
  5270******************************************************************
  5271*                            COPY ERCFORM.
  5272******************************************************************
  5273*                                                                *
  5274*                                                                *
  5275*                            ERCFORM.                            *
  5276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5277*                            VMOD=2.003                          *
  5278*                                                                *
  5279*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5280*                                                                *
  5281*    FILE TYPE = VSAM,KSDS                                       *
  5282*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5283*                                                                *
  5284*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5285*                                                                *
  5286*    LOG = YES                                                   *
  5287*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5288******************************************************************
  5289 01  FORM-MASTER.
  5290    12  FO-RECORD-ID                 PIC X(02).
  5291        88  VALID-FO-ID                  VALUE 'FO'.
  5292
  5293    12  FO-CONTROL-PRIMARY.
  5294        16  FO-COMPANY-CD            PIC X(01).
  5295        16  FO-STATE                 PIC X(02).
  5296        16  FO-FORM-ID               PIC X(12).
  5297        16  FO-FORM-EXP-DT           PIC X(02).
  5298
  5299    12  FO-POLICY-FORM-DATA.
  5300        16  FO-IND-GRP-CD            PIC X(01).
  5301        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5302        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5303        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5304        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5305        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5306        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5307        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5308        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5309        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5310        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5311        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5312        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5313        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5314        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5315        16  FO-APP-CERT-USE-CD       PIC X(01).
  5316
  5317    12  FILLER                       PIC X(29).
  5318
  5319    12  FO-FORM-PLAN-TABLE.
  5320        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5321            20  FO-PLAN-TYPE         PIC X(01).
  5322            20  FO-PLAN-ID           PIC X(02).
  5323            20  FO-PLAN-TERM         PIC 9(03).
  5324            20  FO-PLAN-REFUND-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL1278.cbl
  5325                                     PIC X.
  5326
  5327    12  FILLER                       PIC X(30).
  5328
  5329    12  FO-COMMENTS-AREA.
  5330        16  FO-COMMENT-LINE-1        PIC X(78).
  5331
  5332    12  FILLER                       PIC X(20).
  5333
  5334    12  FO-MAINT-INFORMATION.
  5335        16  FO-LAST-MAINT-DT         PIC X(02).
  5336        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5337        16  FO-LAST-MAINT-BY         PIC X(04).
  5338*                            COPY ELCMSTR.
  5339******************************************************************
  5340*                                                                *
  5341*                            ELCMSTR.                            *
  5342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5343*                            VMOD=2.012                          *
  5344*                                                                *
  5345*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5346*                                                                *
  5347*   FILE TYPE = VSAM,KSDS                                        *
  5348*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5349*                                                                *
  5350*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5351*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5352*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5353*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5354*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5355*                                                 RKP=75,LEN=21  *
  5356*                                                                *
  5357*   **** NOTE ****                                               *
  5358*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5359*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5360*                                                                *
  5361*   LOG = YES                                                    *
  5362*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5363******************************************************************
  5364*                   C H A N G E   L O G
  5365*
  5366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5367*-----------------------------------------------------------------
  5368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5369* EFFECTIVE    NUMBER
  5370*-----------------------------------------------------------------
  5371* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5372* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5373******************************************************************
  5374 01  CLAIM-MASTER.
  5375     12  CL-RECORD-ID                PIC XX.
  5376         88  VALID-CL-ID         VALUE 'CL'.
  5377
  5378     12  CL-CONTROL-PRIMARY.
  5379         16  CL-COMPANY-CD           PIC X.
  5380         16  CL-CARRIER              PIC X.
  5381         16  CL-CLAIM-NO             PIC X(7).
  5382         16  CL-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL1278.cbl
  5383             20  CL-CERT-PRIME       PIC X(10).
  5384             20  CL-CERT-SFX         PIC X.
  5385
  5386     12  CL-CONTROL-BY-NAME.
  5387         16  CL-COMPANY-CD-A1        PIC X.
  5388         16  CL-INSURED-LAST-NAME    PIC X(15).
  5389         16  CL-INSURED-NAME.
  5390             20  CL-INSURED-1ST-NAME PIC X(12).
  5391             20  CL-INSURED-MID-INIT PIC X.
  5392
  5393     12  CL-CONTROL-BY-SSN.
  5394         16  CL-COMPANY-CD-A2        PIC X.
  5395         16  CL-SOC-SEC-NO.
  5396             20  CL-SSN-STATE        PIC XX.
  5397             20  CL-SSN-ACCOUNT      PIC X(6).
  5398             20  CL-SSN-LN3          PIC X(3).
  5399
  5400     12  CL-CONTROL-BY-CERT-NO.
  5401         16  CL-COMPANY-CD-A4        PIC X.
  5402         16  CL-CERT-NO-A4.
  5403             20  CL-CERT-A4-PRIME    PIC X(10).
  5404             20  CL-CERT-A4-SFX      PIC X.
  5405
  5406     12  CL-CONTROL-BY-CCN.
  5407         16  CL-COMPANY-CD-A5        PIC X.
  5408         16  CL-CCN-A5.
  5409             20  CL-CCN.
  5410                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5411                 24  CL-CCN-PRIME-A5 PIC X(12).
  5412             20  CL-CCN-FILLER-A5    PIC X(4).
  5413
  5414     12  CL-INSURED-PROFILE-DATA.
  5415         16  CL-INSURED-BIRTH-DT     PIC XX.
  5416         16  CL-INSURED-SEX-CD       PIC X.
  5417             88  INSURED-IS-MALE        VALUE 'M'.
  5418             88  INSURED-IS-FEMALE      VALUE 'F'.
  5419             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5420         16  CL-INSURED-OCC-CD       PIC X(6).
  5421         16  FILLER                  PIC X(5).
  5422
  5423     12  CL-PROCESSING-INFO.
  5424         16  CL-PROCESSOR-ID         PIC X(4).
  5425         16  CL-CLAIM-STATUS         PIC X.
  5426             88  CLAIM-IS-OPEN          VALUE 'O'.
  5427             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5428         16  CL-CLAIM-TYPE           PIC X.
  5429*            88  AH-CLAIM               VALUE 'A'.
  5430*            88  LIFE-CLAIM             VALUE 'L'.
  5431*            88  PROPERTY-CLAIM         VALUE 'P'.
  5432*            88  IUI-CLAIM              VALUE 'I'.
  5433*            88  GAP-CLAIM              VALUE 'G'.
  5434         16  CL-CLAIM-PREM-TYPE      PIC X.
  5435             88  SINGLE-PREMIUM         VALUE '1'.
  5436             88  O-B-COVERAGE           VALUE '2'.
  5437             88  OPEN-END-COVERAGE      VALUE '3'.
  5438         16  CL-INCURRED-DT          PIC XX.
  5439         16  CL-REPORTED-DT          PIC XX.
  5440         16  CL-FILE-ESTABLISH-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL1278.cbl
  5441         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5442         16  CL-LAST-PMT-DT          PIC XX.
  5443         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5444         16  CL-PAID-THRU-DT         PIC XX.
  5445         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5446         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5447         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5448         16  CL-PMT-CALC-METHOD      PIC X.
  5449             88  CL-360-DAY-YR          VALUE '1'.
  5450             88  CL-365-DAY-YR          VALUE '2'.
  5451             88  CL-FULL-MONTHS         VALUE '3'.
  5452         16  CL-CAUSE-CD             PIC X(6).
  5453
  5454         16  CL-PRIME-CERT-NO.
  5455             20  CL-PRIME-CERT-PRIME PIC X(10).
  5456             20  CL-PRIME-CERT-SFX   PIC X.
  5457
  5458         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5459             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5460             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5461
  5462         16  CL-MICROFILM-NO         PIC X(10).
  5463         16  CL-PROG-FORM-TYPE       PIC X.
  5464         16  CL-LAST-ADD-ON-DT       PIC XX.
  5465
  5466         16  CL-LAST-REOPEN-DT       PIC XX.
  5467         16  CL-LAST-CLOSE-DT        PIC XX.
  5468         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5469             88  FINAL-PAID             VALUE '1'.
  5470             88  CLAIM-DENIED           VALUE '2'.
  5471             88  AUTO-CLOSE             VALUE '3'.
  5472             88  MANUAL-CLOSE           VALUE '4'.
  5473             88  BENEFITS-CHANGED       VALUE 'C'.
  5474             88  SETUP-ERRORS           VALUE 'E'.
  5475         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5476         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5477         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5478             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5479         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5480         16  FILLER                  PIC X.
  5481
  5482     12  CL-CERTIFICATE-DATA.
  5483         16  CL-CERT-ORIGIN          PIC X.
  5484             88  CERT-WAS-ONLINE        VALUE '1'.
  5485             88  CERT-WAS-CREATED       VALUE '2'.
  5486             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5487         16  CL-CERT-KEY-DATA.
  5488             20  CL-CERT-CARRIER     PIC X.
  5489             20  CL-CERT-GROUPING    PIC X(6).
  5490             20  CL-CERT-STATE       PIC XX.
  5491             20  CL-CERT-ACCOUNT.
  5492                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5493                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5494             20  CL-CERT-EFF-DT      PIC XX.
  5495
  5496     12  CL-STATUS-CONTROLS.
  5497         16  CL-PRIORITY-CD          PIC X.
  5498             88  CONFIDENTIAL-DATA      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL1278.cbl
  5499             88  HIGHEST-PRIORITY       VALUE '9'.
  5500         16  CL-SUPV-ATTN-CD         PIC X.
  5501             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5502             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5503         16  CL-PURGED-DT            PIC XX.
  5504         16  CL-RESTORED-DT          PIC XX.
  5505         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5506         16  CL-NEXT-RESEND-DT       PIC XX.
  5507         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5508         16  FILLER                  PIC XX.
  5509         16  CL-LAST-MAINT-DT        PIC XX.
  5510         16  CL-LAST-MAINT-USER      PIC X(4).
  5511         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5512         16  CL-LAST-MAINT-TYPE      PIC X.
  5513             88  CLAIM-SET-UP           VALUE ' '.
  5514             88  PAYMENT-MADE           VALUE '1'.
  5515             88  LETTER-SENT            VALUE '2'.
  5516             88  MASTER-WAS-ALTERED     VALUE '3'.
  5517             88  MASTER-WAS-RESTORED    VALUE '4'.
  5518             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5519             88  FILE-CONVERTED         VALUE '6'.
  5520             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5521             88  ERROR-CORRECTION       VALUE 'E'.
  5522         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5523         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5524         16  CL-BENEFICIARY          PIC X(10).
  5525         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5526         16  CL-DENIAL-TYPE          PIC X.
  5527             88  CL-TYPE-DENIAL          VALUE '1'.
  5528             88  CL-TYPE-RESCISSION      VALUE '2'.
  5529             88  CL-TYPE-REFORMATION     VALUE '3'.
  5530             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5531             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5532         16  FILLER                  PIC X(5).
  5533
  5534     12  CL-TRAILER-CONTROLS.
  5535         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5536             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5537             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5538             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5539         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5540         16  FILLER                  PIC XX.
  5541         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5542         16  CL-ADDRESS-TRAILER-CNT.
  5543             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5544                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5545             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5546                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5547             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5548                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5549             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5550                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5551             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5552                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5553             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5554                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5555             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5556                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL1278.cbl
  5557
  5558     12  CL-CV-REFERENCE-NO.
  5559         16  CL-CV-REFNO-PRIME       PIC X(18).
  5560         16  CL-CV-REFNO-SFX         PIC XX.
  5561
  5562     12  CL-FILE-LOCATION            PIC X(4).
  5563
  5564     12  CL-PROCESS-ERRORS.
  5565         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5566             88  NO-FATAL-ERRORS        VALUE ZERO.
  5567         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5568             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5569
  5570     12  CL-PRODUCT-CD               PIC X.
  5571
  5572     12  CL-CURRENT-KEY-DATA.
  5573         16  CL-CURRENT-CARRIER      PIC X.
  5574         16  CL-CURRENT-GROUPING     PIC X(6).
  5575         16  CL-CURRENT-STATE        PIC XX.
  5576         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5577
  5578     12  CL-ASSOCIATES               PIC X.
  5579         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5580         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5581         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5582         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5583
  5584     12  CL-ACTIVITY-CODE            PIC 99.
  5585     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5586     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5587
  5588     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5589     12  CL-LAG-REPORT-CODE          PIC 9.
  5590     12  CL-LOAN-TYPE                PIC XX.
  5591     12  CL-LEGAL-STATE              PIC XX.
  5592
  5593*    12  FILLER                      PIC X(5).
  5594     12  CL-YESNOSW                  PIC X.
  5595     12  FILLER                      PIC X(4).
  5596*                            COPY ERCPDEF.
  5597******************************************************************
  5598*                                                                *
  5599*                                                                *
  5600*                            ERCPDEF.                            *
  5601*                                                                *
  5602*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5603*                                                                *
  5604*    FILE TYPE = VSAM,KSDS                                       *
  5605*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5606*                                                                *
  5607*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5608*                                                                *
  5609*    LOG = YES                                                   *
  5610*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5611******************************************************************
  5612 01  PRODUCT-MASTER.
  5613    12  PD-RECORD-ID                 PIC X(02).
  5614        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL1278.cbl
  5615    12  PD-CONTROL-PRIMARY.
  5616        16  PD-COMPANY-CD            PIC X.
  5617        16  PD-STATE                 PIC XX.
  5618        16  PD-PRODUCT-CD            PIC XXX.
  5619        16  PD-FILLER                PIC X(7).
  5620        16  PD-BEN-TYPE              PIC X.
  5621        16  PD-BEN-CODE              PIC XX.
  5622        16  PD-PROD-EXP-DT           PIC XX.
  5623    12  FILLER                       PIC X(50).
  5624    12  PD-PRODUCT-DATA OCCURS 8.
  5625        16  PD-PROD-CODE             PIC X.
  5626            88  PD-PROD-LIFE           VALUE 'L'.
  5627            88  PD-PROD-PROP           VALUE 'P'.
  5628            88  PD-PROD-AH             VALUE 'A'.
  5629            88  PD-PROD-IU             VALUE 'I'.
  5630            88  PD-PROD-GAP            VALUE 'G'.
  5631        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5632        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5633        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5634        16  PD-MAX-TERM              PIC S999        COMP-3.
  5635        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5636        16  FILLER                   PIC X.
  5637        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5638        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5639        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5640        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5641        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5642        16  PD-REC-CRIT-PERIOD       PIC X.
  5643        16  PD-RTW-MOS               PIC 99.
  5644        16  FILLER                   PIC X(5).
  5645    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5646    12  PD-TERM-LIMITS OCCURS 15.
  5647        16  PD-LOW-TERM              PIC S999        COMP-3.
  5648        16  PD-HI-TERM               PIC S999        COMP-3.
  5649*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5650    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5651        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5652        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5653    12  PD-EARN-FACTORS.
  5654        16  FILLER OCCURS 15.
  5655            20  FILLER OCCURS 15.
  5656                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5657    12  PD-PRODUCT-DESC              PIC X(80).
  5658    12  PD-TRUNCATED                 PIC X.
  5659    12  FILLER                       PIC X(59).
  5660    12  PD-MAINT-INFORMATION.
  5661        16  PD-LAST-MAINT-DT         PIC X(02).
  5662        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5663        16  PD-LAST-MAINT-BY         PIC X(04).
  5664 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5665                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5666                          MAILING-DATA ORIGINAL-CERTIFICATE
  5667                          FORM-MASTER CLAIM-MASTER
  5668                          PRODUCT-MASTER.
  5669 0000-DFHEXIT SECTION.
  5670     MOVE '9#                    $   ' TO DFHEIV0.
  5671     MOVE 'EL1278' TO DFHEIV1.
  5672     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL1278.cbl
  5673*    SERVICE RELOAD PARMLIST.
  5674
  5675     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5676     MOVE '5'                    TO  DC-OPTION-CODE.
  5677
  5678     PERFORM 9600-DATE-LINK.
  5679
  5680     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5681     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5682     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5683     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5684     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5685     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5686     MOVE EIBTRMID               TO  QID-TERM.
  5687
  5688     IF EIBCALEN  IS EQUAL TO  ZERO
  5689         GO TO 8700-UNAUTHORIZED-ACCESS.
  5690
  5691     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5692         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5693             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5694             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5695             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5696             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5697             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5698             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5699             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5700             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5701         ELSE
  5702             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5703             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5704             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5705             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5706             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5707             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5708             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5709             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5710             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5711
  5712     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5713         GO TO 9300-CLEAR.
  5714
  5715     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5716         NEXT SENTENCE
  5717     ELSE
  5718
  5719* EXEC CICS READQ TS
  5720*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5721*            INTO    (SECURITY-CONTROL)
  5722*            LENGTH  (SC-COMM-LENGTH)
  5723*            ITEM    (SC-ITEM)
  5724*        END-EXEC
  5725*    MOVE '*$II   L              ''   #00005714' TO DFHEIV0
  5726     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5727     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5728     MOVE X'2020233030303035373134' TO DFHEIV0(25:11)
  5729     CALL 'kxdfhei1' USING DFHEIV0,
  5730           PI-SECURITY-TEMP-STORE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL1278.cbl
  5731           SECURITY-CONTROL,
  5732           SC-COMM-LENGTH,
  5733           SC-ITEM,
  5734           DFHEIV99,
  5735           DFHEIV99
  5736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5737         MOVE SC-CREDIT-DISPLAY (33)
  5738                                 TO  PI-DISPLAY-CAP
  5739         MOVE SC-CREDIT-UPDATE  (33)
  5740                                 TO  PI-MODIFY-CAP
  5741         MOVE SC-CREDIT-UPDATE  (32)
  5742                                 TO  PI-MODIFY-CERT-CAP
  5743         IF NOT  DISPLAY-CAP
  5744             MOVE 'READ'         TO  SM-READ
  5745             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5746             MOVE ER-0070        TO  EMI-ERROR
  5747             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5748             GO TO 8100-SEND-INITIAL-MAP.
  5749
  5750     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5751         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5752         MOVE LOW-VALUES         TO  EL127HI
  5753         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5754                                     PI-LF-CANCEL-DATE
  5755                                     WS-AH-CANCEL-DATE
  5756                                     PI-AH-CANCEL-DATE
  5757         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5758                                     PI-LF-CANCEL-DATE-ED
  5759                                     WS-AH-CANCEL-DATE-ED
  5760                                     PI-AH-CANCEL-DATE-ED
  5761         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5762                                     PI-EARNING-METHOD-AH
  5763         PERFORM 0500-FORMAT-SCREEN
  5764         GO TO 8100-SEND-INITIAL-MAP.
  5765
  5766     IF NOT  MODIFY-CAP
  5767         MOVE 'UPDATE'           TO  SM-READ
  5768         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5769         MOVE ER-0070            TO  EMI-ERROR
  5770         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5771         GO TO 8100-SEND-INITIAL-MAP.
  5772
  5773
  5774* EXEC CICS HANDLE CONDITION
  5775*        PGMIDERR  (9500-PGMID-ERROR)
  5776*        ERROR     (9900-ABEND)
  5777*    END-EXEC.
  5778*    MOVE '"$L.                  ! " #00005756' TO DFHEIV0
  5779     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5781     MOVE X'2220233030303035373536' TO DFHEIV0(25:11)
  5782     CALL 'kxdfhei1' USING DFHEIV0
  5783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5784
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL1278.cbl
  5786 0200-RECEIVE.
  5787     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5788         MOVE ER-0008            TO  EMI-ERROR
  5789         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5790         MOVE -1                 TO  HLCANCL
  5791         GO TO 8200-SEND-DATAONLY.
  5792
  5793
  5794* EXEC CICS RECEIVE
  5795*        MAP     (MAP-NAME)
  5796*        MAPSET  (MAPSET-NAME)
  5797*        INTO    (EL127HI)
  5798*    END-EXEC.
  5799     MOVE LENGTH OF
  5800      EL127HI
  5801       TO DFHEIV11
  5802*    MOVE '8"T I  L              ''   #00005768' TO DFHEIV0
  5803     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5805     MOVE X'2020233030303035373638' TO DFHEIV0(25:11)
  5806     CALL 'kxdfhei1' USING DFHEIV0,
  5807           MAP-NAME,
  5808           EL127HI,
  5809           DFHEIV11,
  5810           MAPSET-NAME,
  5811           DFHEIV99,
  5812           DFHEIV99
  5813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5814
  5815
  5816     IF HPFKEYL  IS EQUAL TO  ZERO
  5817         GO TO 0300-CHECK-PFKEYS.
  5818
  5819     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5820         MOVE ER-0004            TO  EMI-ERROR
  5821         GO TO 0320-INPUT-ERROR.
  5822
  5823     IF HPFKEYI NUMERIC
  5824         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5825             MOVE PF-VALUES (HPFKEYI)
  5826                                 TO  EIBAID
  5827         ELSE
  5828             MOVE ER-0029        TO  EMI-ERROR
  5829             GO TO 0320-INPUT-ERROR.
  5830
  5831 0300-CHECK-PFKEYS.
  5832     IF EIBAID  IS EQUAL TO  DFHPF23
  5833         GO TO 8800-PF23.
  5834
  5835     IF EIBAID  IS EQUAL TO  DFHPF24
  5836         GO TO 9100-RETURN-MAIN-MENU.
  5837
  5838     IF EIBAID = DFHPF11
  5839        GO TO 1700-WRITE-CERT-NOTE
  5840     END-IF
  5841
  5842     IF EIBAID  IS EQUAL TO  DFHPF12
  5843         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL1278.cbl
  5844
  5845     IF EIBAID = DFHENTER OR DFHPF10
  5846        GO TO 0400-EDIT-INPUT-DATA
  5847     END-IF
  5848
  5849     MOVE ER-0029                TO  EMI-ERROR.
  5850
  5851 0320-INPUT-ERROR.
  5852     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5853
  5854     MOVE AL-UNBON               TO  HPFKEYA.
  5855
  5856     IF HPFKEYL  IS EQUAL TO  ZERO
  5857         MOVE -1                 TO  HLCANCL
  5858     ELSE
  5859         MOVE -1                 TO  HPFKEYL.
  5860
  5861     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL1278.cbl
  5863 0400-EDIT-INPUT-DATA.
  5864     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5865                                     WS-NEW-LF-CANCEL-SW.
  5866
  5867     IF (HPCYNL > 0)
  5868        AND (HPCYNI = 'Y' OR 'N')
  5869        PERFORM 1800-READ-ELCERT-UPDATE
  5870                                 THRU 1800-EXIT
  5871        IF WS-RESP-NORMAL
  5872           MOVE HPCYNI           TO CM-POST-CARD-IND
  5873           PERFORM 1810-REWRITE-ELCERT
  5874                                 THRU 1810-EXIT
  5875        END-IF
  5876     END-IF
  5877     IF HLCAL1L GREATER ZERO
  5878         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5879     IF CLPYNI = 'Y'
  5880        MOVE 'Y'                   TO PI-CLP-YN
  5881        MOVE AL-UANON              TO CLPYNA
  5882     ELSE
  5883        MOVE ' '                   TO PI-CLP-YN
  5884        MOVE AL-UANON              TO CLPYNA
  5885     END-IF
  5886     IF CANREAI = 'R'
  5887        MOVE 'R'                 TO PI-CANCEL-REASON
  5888        MOVE AL-UANON            TO CANREAA
  5889     ELSE
  5890        MOVE ' '                 TO PI-CANCEL-REASON
  5891        MOVE AL-UANON            TO CANREAA
  5892     END-IF
  5893
  5894     IF HLCANCL  IS EQUAL TO  ZERO
  5895       AND HACANCL  IS EQUAL TO  ZERO
  5896         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5897         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5898         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5899         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5900         GO TO 0420-CHECK-ERRORS.
  5901
  5902     IF HLCANCL  IS EQUAL TO  ZERO
  5903         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5904         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5905         GO TO 0410-CHECK-AH-DATE.
  5906
  5907     IF HLCANCI = SPACES
  5908        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  5909                                      WS-LF-CANCEL-DATE
  5910        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  5911                                      WS-LF-CANCEL-DATE-ED
  5912                                      PI-LF-REFUND-METH
  5913        MOVE +0                    TO PI-LF-REFUND-AMT
  5914        GO TO 0410-CHECK-AH-DATE
  5915     END-IF
  5916
  5917     MOVE AL-UNNON               TO  HLCANCA.
  5918     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5919     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  5920
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL1278.cbl
  5921     PERFORM 8600-DEEDIT.
  5922
  5923     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5924     MOVE '4'                    TO  DC-OPTION-CODE.
  5925
  5926     PERFORM 9600-DATE-LINK.
  5927
  5928     IF DATE-CONVERSION-ERROR
  5929         MOVE -1                 TO  HLCANCL
  5930         MOVE AL-UABON           TO  HLCANCA
  5931         MOVE ER-2227            TO  EMI-ERROR
  5932         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5933     ELSE
  5934        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5935           MOVE -1               TO  HACANCL
  5936           MOVE AL-UABON         TO  HACANCA
  5937           MOVE ER-2774          TO  EMI-ERROR
  5938           PERFORM 9700-ERROR-FORMAT
  5939                                 THRU  9799-EXIT
  5940        ELSE
  5941           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  5942                                    PI-LF-CANCEL-DATE
  5943           MOVE DC-GREG-DATE-1-EDIT
  5944                                 TO HLCANCO
  5945                                    WS-LF-CANCEL-DATE-ED
  5946                                    PI-LF-CANCEL-DATE-ED
  5947        END-IF
  5948     END-IF
  5949     .
  5950 0410-CHECK-AH-DATE.
  5951     IF HACAL1L GREATER ZERO
  5952         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  5953
  5954     IF HACANCL  IS EQUAL TO  ZERO
  5955         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5956         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5957         GO TO 0420-CHECK-ERRORS.
  5958     IF HACANCI = SPACES
  5959        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  5960                                      WS-AH-CANCEL-DATE
  5961        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  5962                                      WS-AH-CANCEL-DATE-ED
  5963                                      PI-AH-REFUND-METH
  5964        MOVE +0                    TO PI-AH-REFUND-AMT
  5965        GO TO 0420-CHECK-ERRORS
  5966     END-IF
  5967
  5968     MOVE AL-UNNON               TO  HACANCA.
  5969     MOVE HACANCI                TO  DEEDIT-FIELD.
  5970     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  5971
  5972     PERFORM 8600-DEEDIT.
  5973
  5974     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5975     MOVE '4'                    TO  DC-OPTION-CODE.
  5976
  5977     PERFORM 9600-DATE-LINK.
  5978
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL1278.cbl
  5979     IF DATE-CONVERSION-ERROR
  5980         MOVE -1                 TO  HACANCL
  5981         MOVE AL-UABON           TO  HACANCA
  5982         MOVE ER-2227            TO  EMI-ERROR
  5983         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5984     ELSE
  5985        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5986           MOVE -1               TO  HACANCL
  5987           MOVE AL-UABON         TO  HACANCA
  5988           MOVE ER-2775          TO  EMI-ERROR
  5989           PERFORM 9700-ERROR-FORMAT
  5990                                 THRU  9799-EXIT
  5991        ELSE
  5992           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  5993                                    PI-AH-CANCEL-DATE
  5994           MOVE DC-GREG-DATE-1-EDIT
  5995                                 TO HACANCO
  5996                                    WS-AH-CANCEL-DATE-ED
  5997                                    PI-AH-CANCEL-DATE-ED
  5998        END-IF
  5999     END-IF
  6000     .
  6001 0420-CHECK-ERRORS.
  6002     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6003         NEXT SENTENCE
  6004     ELSE
  6005         GO TO 8200-SEND-DATAONLY.
  6006
  6007     PERFORM 0500-FORMAT-SCREEN.
  6008     IF EIBAID = DFHPF10
  6009        perform 4000-GEN-CANCEL-TRANS
  6010                                 thru 4000-exit
  6011        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6012        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6013        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6014        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6015        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6016        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6017                               PI-ALL-CANCELS-SW
  6018        IF PI-PROCESSOR-IS-CSR
  6019            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6020        ELSE
  6021            MOVE ' '        TO PI-CSR-SESSION-SW
  6022        END-IF
  6023        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6024                               PI-CANCELS-IN-ERROR-SW
  6025                               PI-ONLY-BATCH-HEADERS-SW
  6026                               PI-ALL-OUT-OF-BAL-SW
  6027                               PI-HOLD-REC-SW
  6028                               PI-CHANGE-REC-SW
  6029                               PI-CHK-REQ-REC-SW
  6030                               PI-ISSUE-WARNING-SW
  6031                               PI-CANCEL-WARNING-SW
  6032        MOVE '1'            TO PI-BROWSE-TYPE
  6033        MOVE DFHENTER       TO  EIBAID
  6034
  6035
  6036* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL1278.cbl
  6037*           PROGRAM    ('EL6311')
  6038*           COMMAREA   (WS-PASS-631)
  6039*           LENGTH     (1300)
  6040*       END-EXEC
  6041     MOVE 'EL6311' TO DFHEIV1
  6042     MOVE 1300
  6043       TO DFHEIV11
  6044*    MOVE '.$C                   $   #00005993' TO DFHEIV0
  6045     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6047     MOVE X'2020233030303035393933' TO DFHEIV0(25:11)
  6048     CALL 'kxdfhei1' USING DFHEIV0,
  6049           DFHEIV1,
  6050           WS-PASS-631,
  6051           DFHEIV11
  6052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6053
  6054*        PERFORM 0500-FORMAT-SCREEN
  6055     END-IF
  6056     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL1278.cbl
  6058 0500-FORMAT-SCREEN  SECTION.
  6059     MOVE LOW-VALUES             TO  EL127HO.
  6060     MOVE PI-CARRIER             TO  HCARIERO.
  6061     MOVE PI-GROUPING            TO  HGROUPO.
  6062     MOVE PI-STATE               TO  HSTATEO.
  6063     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6064     MOVE ' '                    TO  DC-OPTION-CODE.
  6065     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6066
  6067     PERFORM 9600-DATE-LINK.
  6068
  6069     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6070     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6071     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6072     MOVE PI-CLP-YN              TO  CLPYNO
  6073     MOVE PI-CANCEL-REASON       TO  CANREAO
  6074     .
  6075 0510-GET-CERT.
  6076     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6077     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6078     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6079     MOVE PI-STATE               TO  WS-CM-STATE.
  6080     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6081     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6082     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6083     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6084
  6085     PERFORM 0900-READ-CERT-FILE.
  6086
  6087     IF CERT-NOT-FOUND
  6088         MOVE -1                 TO  HLCANCL
  6089         MOVE AL-SANON           TO  HLCANCA
  6090         MOVE ER-0214            TO  EMI-ERROR
  6091         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6092         GO TO 8100-SEND-INITIAL-MAP.
  6093
  6094     IF CM-CLAIM-ATTACHED-COUNT = +0
  6095        GO TO 0510-SKIP-CLAIM-CHECK
  6096     END-IF
  6097*    DISPLAY ' STARTING CLAIM TEST '
  6098     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6099     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6100
  6101* EXEC CICS STARTBR
  6102*       DATASET     ('ELMSTR5')
  6103*       RIDFLD      (ELMSTR-KEY)
  6104*       RESP        (WS-RESPONSE)
  6105*    END-EXEC
  6106     MOVE 'ELMSTR5' TO DFHEIV1
  6107     MOVE 0
  6108       TO DFHEIV11
  6109*    MOVE '&,         G          &  N#00006045' TO DFHEIV0
  6110     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6111     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6112     MOVE X'204E233030303036303435' TO DFHEIV0(25:11)
  6113     CALL 'kxdfhei1' USING DFHEIV0,
  6114           DFHEIV1,
  6115           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL1278.cbl
  6116           DFHEIV99,
  6117           DFHEIV11,
  6118           DFHEIV99
  6119     MOVE EIBRESP  TO WS-RESPONSE
  6120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6121     IF WS-RESP-NORMAL
  6122     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6123
  6124* EXEC CICS READNEXT
  6125*          DATASET   ('ELMSTR5')
  6126*          RIDFLD    (ELMSTR-KEY)
  6127*          SET       (ADDRESS OF CLAIM-MASTER)
  6128*          RESP      (WS-RESPONSE)
  6129*       END-EXEC
  6130     MOVE 'ELMSTR5' TO DFHEIV1
  6131     MOVE 0
  6132       TO DFHEIV11
  6133*    MOVE '&.S                   )  N#00006052' TO DFHEIV0
  6134     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6135     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6136     MOVE X'204E233030303036303532' TO DFHEIV0(25:11)
  6137     CALL 'kxdfhei1' USING DFHEIV0,
  6138           DFHEIV1,
  6139           DFHEIV20,
  6140           DFHEIV99,
  6141           ELMSTR-KEY,
  6142           DFHEIV99,
  6143           DFHEIV11,
  6144           DFHEIV99,
  6145           DFHEIV99
  6146     SET ADDRESS OF CLAIM-MASTER TO
  6147         DFHEIV20
  6148     MOVE EIBRESP  TO WS-RESPONSE
  6149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6150        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6151           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6152           AND (CM-CERT-NO = CL-CERT-NO)
  6153           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6154              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6155              SET FOUND-A-CLAIM  TO TRUE
  6156              IF CL-CLAIM-TYPE = 'L'
  6157                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6158                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6159                 END-IF
  6160                 IF CLAIM-IS-OPEN
  6161                    SET OPEN-LF-CLAIM TO TRUE
  6162                 ELSE
  6163                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6164                       MOVE CL-LAST-CLOSE-DT
  6165                                 TO WS-LF-LAST-CLOSE-DT
  6166                    END-IF
  6167                    SET CLOSED-LF-CLAIM TO TRUE
  6168                 END-IF
  6169              ELSE
  6170                 IF CLAIM-IS-OPEN
  6171                    MOVE CL-PAID-THRU-DT
  6172                                 TO WS-AH-PAID-THRU-DT
  6173                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL1278.cbl
  6174                 ELSE
  6175                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6176                       MOVE CL-PAID-THRU-DT
  6177                                 TO WS-AH-PAID-THRU-DT
  6178                    END-IF
  6179                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6180                       MOVE CL-LAST-CLOSE-DT
  6181                                 TO WS-AH-LAST-CLOSE-DT
  6182                    END-IF
  6183                    SET CLOSED-AH-CLAIM TO TRUE
  6184                 END-IF
  6185              END-IF
  6186           END-IF
  6187        ELSE
  6188           SET I-SAY-TO-STOP TO TRUE
  6189        END-IF
  6190     END-PERFORM
  6191     END-IF
  6192     IF FOUND-A-CLAIM
  6193        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6194           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6195           MOVE ' '              TO DC-OPTION-CODE
  6196           PERFORM 9600-DATE-LINK
  6197           IF NO-CONVERSION-ERROR
  6198              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6199              MOVE AL-SANOF      TO LCLMDTHA
  6200           END-IF
  6201        END-IF
  6202        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6203           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6204           MOVE ' '              TO DC-OPTION-CODE
  6205           PERFORM 9600-DATE-LINK
  6206           IF NO-CONVERSION-ERROR
  6207              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6208              MOVE AL-SANOF      TO ACLMDTHA
  6209           END-IF
  6210        END-IF
  6211        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6212        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6213        MOVE CM-STATE            TO WS-CF-ACCESS
  6214        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6215
  6216* EXEC CICS READ
  6217*          DATASET  (ELCNTL-ID)
  6218*          SET      (ADDRESS OF CONTROL-FILE)
  6219*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6220*          RESP     (WS-RESPONSE)
  6221*       END-EXEC
  6222*    MOVE '&"S        E          (  N#00006123' TO DFHEIV0
  6223     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6224     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6225     MOVE X'204E233030303036313233' TO DFHEIV0(25:11)
  6226     CALL 'kxdfhei1' USING DFHEIV0,
  6227           ELCNTL-ID,
  6228           DFHEIV20,
  6229           DFHEIV99,
  6230           WS-CF-CONTROL-PRIMARY,
  6231           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL1278.cbl
  6232           DFHEIV99,
  6233           DFHEIV99
  6234     SET ADDRESS OF CONTROL-FILE TO
  6235         DFHEIV20
  6236     MOVE EIBRESP  TO WS-RESPONSE
  6237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6238        IF WS-RESP-NORMAL
  6239           MOVE CF-ST-REF-AH-DEATH-IND
  6240                                 TO WS-ST-REF-IND
  6241        END-IF
  6242     END-IF
  6243     .
  6244 0510-SKIP-CLAIM-CHECK.
  6245     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6246     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6247     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6248     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6249
  6250* EXEC CICS READ
  6251*        DATASET  (ERMAIL-ID)
  6252*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6253*        SET      (ADDRESS OF MAILING-DATA)
  6254*        RESP     (WS-RESPONSE)
  6255*    END-EXEC.
  6256*    MOVE '&"S        E          (  N#00006140' TO DFHEIV0
  6257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6259     MOVE X'204E233030303036313430' TO DFHEIV0(25:11)
  6260     CALL 'kxdfhei1' USING DFHEIV0,
  6261           ERMAIL-ID,
  6262           DFHEIV20,
  6263           DFHEIV99,
  6264           WS-MA-CONTROL-PRIMARY,
  6265           DFHEIV99,
  6266           DFHEIV99,
  6267           DFHEIV99
  6268     SET ADDRESS OF MAILING-DATA TO
  6269         DFHEIV20
  6270     MOVE EIBRESP  TO WS-RESPONSE
  6271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6272
  6273     IF WS-RESP-NORMAL
  6274        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6275           (S1 > +7)
  6276           OR (MA-MAIL-STATUS (S1) = '1')
  6277        END-PERFORM
  6278        IF S1 > +7
  6279           MOVE AL-SANOF         TO HPCYNA
  6280        END-IF
  6281     END-IF
  6282     IF CM-POST-CARD-IND = 'Y'
  6283        MOVE 'Y'                 TO HPCYNO
  6284     ELSE
  6285        MOVE 'N'                 TO HPCYNO
  6286     END-IF
  6287     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6288        OR (NOT CERT-AS-LOADED)
  6289        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL1278.cbl
  6290     END-IF
  6291*    IF (CERT-ADDED-BATCH)
  6292*       CONTINUE
  6293*    ELSE
  6294*       MOVE AL-SANOF            TO HPCYNA
  6295*    END-IF
  6296     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6297     MOVE '5'                    TO  DC-OPTION-CODE.
  6298
  6299     PERFORM 9600-DATE-LINK.
  6300
  6301     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6302     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6303     MOVE '1'                    TO  DC-OPTION-CODE.
  6304
  6305     PERFORM 9600-DATE-LINK.
  6306
  6307     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6308
  6309     MOVE ZEROS TO WS-TOT-ITDR.
  6310     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6311
  6312 0510-CHECK-LF-STATUS.
  6313
  6314     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6315         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6316                                    PI-LF-CANCEL-DATE
  6317         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6318                                    PI-LF-CANCEL-DATE-ED
  6319                                    PI-LF-REFUND-METH
  6320         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6321         GO TO 0510-CHECK-AH-STATUS.
  6322
  6323     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6324        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6325          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6326          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6327          IF FIRST-ENTRY
  6328              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6329              MOVE SPACES               TO DC-OPTION-CODE
  6330              PERFORM 9600-DATE-LINK
  6331              IF NOT DATE-CONVERSION-ERROR
  6332                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6333                                            PI-LF-CANCEL-DATE-ED
  6334                                            WS-LF-CANCEL-DATE-ED
  6335                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6336                                            WS-LF-CANCEL-DATE.
  6337
  6338     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6339        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6340          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6341          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6342          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6343        IF FIRST-ENTRY
  6344            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6345            MOVE SPACES               TO DC-OPTION-CODE
  6346            PERFORM 9600-DATE-LINK
  6347            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL1278.cbl
  6348                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6349                                          PI-LF-CANCEL-DATE-ED
  6350                                          WS-LF-CANCEL-DATE-ED
  6351                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6352                                          WS-LF-CANCEL-DATE.
  6353
  6354 0510-CHECK-AH-STATUS.
  6355
  6356     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6357         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6358                                    PI-AH-CANCEL-DATE
  6359         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6360                                    PI-AH-CANCEL-DATE-ED
  6361                                    PI-AH-REFUND-METH
  6362         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6363         GO TO 0510-CONT.
  6364
  6365     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6366        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6367          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6368          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6369        IF FIRST-ENTRY
  6370            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6371            MOVE SPACES               TO DC-OPTION-CODE
  6372            PERFORM 9600-DATE-LINK
  6373            IF NOT DATE-CONVERSION-ERROR
  6374                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6375                                            PI-AH-CANCEL-DATE-ED
  6376                                            WS-AH-CANCEL-DATE-ED
  6377                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6378                                            WS-AH-CANCEL-DATE.
  6379
  6380     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6381        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6382          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6383          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6384          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6385         IF FIRST-ENTRY
  6386             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6387             MOVE SPACES               TO DC-OPTION-CODE
  6388             PERFORM 9600-DATE-LINK
  6389             IF NOT DATE-CONVERSION-ERROR
  6390                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6391                                            PI-AH-CANCEL-DATE-ED
  6392                                            WS-AH-CANCEL-DATE-ED
  6393                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6394                                            WS-AH-CANCEL-DATE.
  6395
  6396     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6397         MOVE 'CANC DT'              TO  CNCDTHDO
  6398         GO TO 0510-CONT.
  6399
  6400     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6401         MOVE 'DTH DT '              TO  CNCDTHDO
  6402         IF FIRST-ENTRY
  6403             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6404             MOVE ' '                TO  DC-OPTION-CODE
  6405             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL1278.cbl
  6406             IF NOT DATE-CONVERSION-ERROR
  6407                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6408                                             PI-AH-CANCEL-DATE-ED
  6409                                             WS-AH-CANCEL-DATE-ED
  6410                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6411                                             WS-AH-CANCEL-DATE.
  6412
  6413 0510-CONT.
  6414
  6415     IF WS-TOT-ITDR GREATER THAN ZEROS
  6416         MOVE WS-TOT-ITDR TO TOITDRO.
  6417
  6418 0520-GET-COMPANY-RECORD.
  6419     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6420     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6421     MOVE SPACES                 TO  WS-CF-ACCESS.
  6422     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6423
  6424     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6425
  6426     IF CNTL-NOT-FOUND
  6427         MOVE -1                 TO  HLCANCL
  6428         MOVE AL-SANON           TO  HLCANCA
  6429         MOVE ER-2616            TO  EMI-ERROR
  6430         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6431         GO TO 8100-SEND-INITIAL-MAP.
  6432
  6433     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6434       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6435         MOVE CF-LIFE-OVERRIDE-L1
  6436                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6437         MOVE CF-LIFE-OVERRIDE-L2
  6438                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6439         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6440         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6441         MOVE CF-CR-REM-TERM-CALC
  6442                                 TO  WS-CF-CR-REM-TERM-CALC
  6443         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6444         IF CF-DEFAULT-APR NUMERIC
  6445             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6446             GO TO 0525-GET-LF-BENEFIT
  6447         ELSE
  6448             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6449             GO TO 0525-GET-LF-BENEFIT.
  6450
  6451     MOVE -1                     TO  HLCANCL.
  6452     MOVE AL-SANON               TO  HLCANCA.
  6453     MOVE ER-2616                TO  EMI-ERROR.
  6454
  6455     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6456
  6457     GO TO 8100-SEND-INITIAL-MAP.
  6458
  6459 0525-GET-LF-BENEFIT.
  6460
  6461     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6462        GO TO 0527-GET-AH-BENEFIT
  6463     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL1278.cbl
  6464
  6465     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6466     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6467                                     HLCDO.
  6468     MOVE WS-CF-LIFE-OVERRIDE-L2
  6469                                 TO  HLKINDO.
  6470
  6471     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6472
  6473     IF BENEFIT-FOUND
  6474         NEXT SENTENCE
  6475     ELSE
  6476         MOVE -1                 TO  HLCDL
  6477         MOVE AL-SANON           TO  HLCDA
  6478         MOVE ER-0028            TO  EMI-ERROR
  6479         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6480         GO TO 8100-SEND-INITIAL-MAP.
  6481
  6482     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6483         MOVE AL-UNNOF           TO  HLTERMA.
  6484
  6485*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6486     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6487                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6488
  6489     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6490         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6491                                 TO  WS-LF-CO-REM-TERM-CALC.
  6492
  6493     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6494         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6495                                 TO  WS-LF-CO-EARNINGS-CALC
  6496                                     WS-LF-CO-REFUND-CALC.
  6497
  6498     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6499         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6500                                 TO  WS-LF-SPECIAL-CALC-CD.
  6501
  6502     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6503         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6504                                 TO  WS-LF-CO-REFUND-CALC.
  6505
  6506 0527-GET-AH-BENEFIT.
  6507
  6508     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6509        GO TO 0530-GET-STATE-RECORD
  6510     END-IF
  6511
  6512     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6513     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6514                                     HACDO.
  6515     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6516
  6517     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6518
  6519     IF BENEFIT-FOUND
  6520         NEXT SENTENCE
  6521     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL1278.cbl
  6522         MOVE -1                 TO  HACDL
  6523         MOVE AL-SANON           TO  HACDA
  6524         MOVE ER-0028            TO  EMI-ERROR
  6525         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6526         GO TO 8100-SEND-INITIAL-MAP.
  6527
  6528     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6529         MOVE AL-UNNOF           TO  HATERMA.
  6530
  6531*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6532
  6533     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6534         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6535                                 TO  WS-AH-CO-REM-TERM-CALC.
  6536
  6537     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6538         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6539                                 TO  WS-AH-CO-EARNINGS-CALC
  6540                                     WS-AH-CO-REFUND-CALC.
  6541
  6542     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6543         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6544                                 TO  WS-AH-SPECIAL-CALC-CD.
  6545
  6546     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6547         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6548                                 TO  WS-AH-CO-REFUND-CALC.
  6549     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6550        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6551                                 TO WS-AH-BEN-CATEGORY
  6552     END-IF
  6553     .
  6554 0530-GET-STATE-RECORD.
  6555     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6556     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6557     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6558     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6559
  6560     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6561
  6562     IF CNTL-NOT-FOUND
  6563         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6564                                     WS-LF-ST-REM-TERM-CALC
  6565         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6566         GO TO 0560-FIND-ACCOUNT.
  6567
  6568     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6569       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6570       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6571         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6572     ELSE
  6573         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6574                                     WS-LF-ST-REM-TERM-CALC
  6575         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6576         GO TO 0560-FIND-ACCOUNT.
  6577
  6578     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6579     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL1278.cbl
  6580
  6581     IF CM-LF-BENEFIT-CD  = '00'
  6582         GO TO 0550-GET-AH-BEN-IN-STATE.
  6583
  6584 0540-GET-LF-BEN-IN-STATE.
  6585     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6586     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6587
  6588     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6589     IF CF-ST-RT-CALC NOT = SPACES
  6590        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6591     END-IF
  6592
  6593     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6594        IF CF-ST-RF-LR-CALC > '0'
  6595           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6596        END-IF
  6597        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6598           IF CF-ST-RF-LN-CALC > '0'
  6599              MOVE CF-ST-RF-LN-CALC
  6600                                 TO WS-LF-ST-REFUND-CALC
  6601           END-IF
  6602        END-IF
  6603     ELSE
  6604        IF CF-ST-RF-LL-CALC > '0'
  6605           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6606        END-IF
  6607     END-IF
  6608
  6609     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6610
  6611     IF NO-BENEFIT-FOUND
  6612*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6613         GO TO 0550-GET-AH-BEN-IN-STATE.
  6614
  6615     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6616         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6617                                 TO  WS-LF-ST-REM-TERM-CALC.
  6618
  6619     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6620         MOVE CF-ST-REFUND-CALC (SUB3)
  6621                                 TO  WS-LF-ST-REFUND-CALC.
  6622
  6623 0550-GET-AH-BEN-IN-STATE.
  6624     IF CM-AH-BENEFIT-CD  = '00'
  6625         GO TO 0560-FIND-ACCOUNT.
  6626
  6627     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6628     IF CF-ST-RT-CALC NOT = SPACES
  6629        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6630     END-IF
  6631
  6632     IF CF-ST-RF-AH-CALC > '0'
  6633        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6634     END-IF
  6635     IF WS-AH-SPECIAL-CALC-CD = 'C'
  6636        IF CF-ST-RF-CP-CALC > '0'
  6637           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL1278.cbl
  6638        END-IF
  6639     END-IF
  6640
  6641     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6642     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6643
  6644     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6645
  6646     IF NO-BENEFIT-FOUND
  6647*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6648         GO TO 0560-FIND-ACCOUNT.
  6649
  6650     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6651         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6652                                 TO  WS-AH-ST-REM-TERM-CALC.
  6653
  6654     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6655         MOVE CF-ST-REFUND-CALC (SUB3)
  6656                                 TO  WS-AH-ST-REFUND-CALC.
  6657
  6658 0560-FIND-ACCOUNT.
  6659     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6660     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6661     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6662     MOVE CM-STATE               TO  WS-AM-STATE.
  6663     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6664     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6665     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6666
  6667     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6668
  6669     IF ACCT-FOUND
  6670         NEXT SENTENCE
  6671     ELSE
  6672         GO TO 0585-NO-ACCT.
  6673
  6674 0570-READ-NEXT-RANGE.
  6675     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6676
  6677     IF ACCT-FOUND
  6678         NEXT SENTENCE
  6679     ELSE
  6680         GO TO 0580-ACCT-NOT-FOUND.
  6681
  6682     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6683       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6684       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6685       AND CM-STATE  IS EQUAL TO  AM-STATE
  6686       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6687         NEXT SENTENCE
  6688     ELSE
  6689         GO TO 0580-ACCT-NOT-FOUND.
  6690
  6691     MOVE 'X'                    TO  DATE-RANGE-SW.
  6692
  6693     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
  6694         MOVE 'X'                TO  DATE-RANGE-SW
  6695         GO TO 0580-ACCT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL1278.cbl
  6696
  6697     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6698         GO TO 0570-READ-NEXT-RANGE.
  6699
  6700     IF WS-BROWSE-STARTED-SW = 'Y'
  6701
  6702* EXEC CICS ENDBR
  6703*          DATASET    ('ERACCT')
  6704*       END-EXEC
  6705     MOVE 'ERACCT' TO DFHEIV1
  6706     MOVE 0
  6707       TO DFHEIV11
  6708*    MOVE '&2                    $   #00006574' TO DFHEIV0
  6709     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6711     MOVE X'2020233030303036353734' TO DFHEIV0(25:11)
  6712     CALL 'kxdfhei1' USING DFHEIV0,
  6713           DFHEIV1,
  6714           DFHEIV11,
  6715           DFHEIV99
  6716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6717        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6718     END-IF
  6719     MOVE ' '                    TO  DATE-RANGE-SW.
  6720     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6721
  6722     GO TO 0590-SET-ACCOUNT.
  6723
  6724 0580-ACCT-NOT-FOUND.
  6725     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6726         MOVE ER-2601            TO  EMI-ERROR
  6727     ELSE
  6728         MOVE ER-2619            TO  EMI-ERROR.
  6729
  6730     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6731
  6732     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6733
  6734 0585-NO-ACCT.
  6735     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6736     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6737                                     WS-AM-EARN-METHOD-R
  6738                                     WS-AM-EARN-METHOD-A
  6739                                     WS-LF-AM-REM-TERM-CALC
  6740                                     WS-AH-AM-REM-TERM-CALC.
  6741
  6742     GO TO 0600-CHECK-FOR-LIFE.
  6743
  6744 0590-SET-ACCOUNT.
  6745******************************************************************
  6746******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6747******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6748******* METHODS.
  6749******************************************************************
  6750     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6751     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
  6752     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6753          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL1278.cbl
  6754                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6755                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6756                  IF FORM-FOUND
  6757                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6758******************************************************************
  6759
  6760     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6761     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6762                                     WS-AM-EARN-METHOD-R
  6763                                     WS-AM-EARN-METHOD-A.
  6764
  6765*    EVALUATE AM-EARN-METHOD-R
  6766*       WHEN 'R'
  6767*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6768*       WHEN 'P'
  6769*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6770*       WHEN 'C'
  6771*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6772*       WHEN 'A'
  6773*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6774*       WHEN 'M'
  6775*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6776*       WHEN 'S'
  6777*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6778*    END-EVALUATE.
  6779
  6780*    EVALUATE AM-EARN-METHOD-L
  6781*       WHEN 'R'
  6782*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6783*       WHEN 'P'
  6784*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6785*       WHEN 'C'
  6786*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6787*       WHEN 'A'
  6788*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6789*       WHEN 'M'
  6790*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6791*       WHEN 'S'
  6792*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6793*    END-EVALUATE.
  6794
  6795*    EVALUATE AM-EARN-METHOD-A
  6796*       WHEN 'R'
  6797*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6798*       WHEN 'P'
  6799*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6800*       WHEN 'C'
  6801*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6802*       WHEN 'A'
  6803*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6804*       WHEN 'M'
  6805*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6806*       WHEN 'N'
  6807*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6808*       WHEN 'S'
  6809*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
  6810*    END-EVALUATE.
  6811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL1278.cbl
  6812     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6813                                     WS-TOT-LF-PREM
  6814                                     WS-TOT-AH-RFND
  6815                                     WS-TOT-LF-RFND.
  6816
  6817 0600-CHECK-FOR-LIFE.
  6818     IF CM-LF-BENEFIT-CD  = '00'
  6819         GO TO 0640-AH-BENEFIT.
  6820
  6821 0610-GET-LIFE-BENEFIT.
  6822
  6823     IF ACCT-FOUND
  6824         MOVE +1                 TO SUB3
  6825         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6826     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6827     MOVE WS-KIND                TO  HLEDESCO.
  6828     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6829     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6830        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6831                             + CM-LF-ALT-PREMIUM-AMT
  6832     ELSE
  6833        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6834     END-IF
  6835
  6836     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6837     EVALUATE TRUE
  6838        WHEN ((OPEN-LF-CLAIM)
  6839           OR (CLOSED-LF-CLAIM))
  6840           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6841           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6842                                    WS-TOT-LF-RFND
  6843                                    PI-LF-REFUND-AMT
  6844           IF CM-AH-BENEFIT-CD NOT = '00'
  6845              MOVE ZEROS         TO HAREFNDO
  6846                                    WS-TOT-AH-RFND
  6847                                    PI-AH-REFUND-AMT
  6848              MOVE SPACES        TO PI-AH-REFUND-METH
  6849           END-IF
  6850           MOVE ER-2965          TO EMI-ERROR
  6851           PERFORM 9700-ERROR-FORMAT
  6852                                 THRU  9799-EXIT
  6853           GO TO 0640-AH-BENEFIT
  6854        WHEN OPEN-LF-CLAIM
  6855           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6856           AND WS-ST-REF-IND = '4'
  6857           MOVE ER-2966          TO EMI-ERROR
  6858           PERFORM 9700-ERROR-FORMAT
  6859                                 THRU  9799-EXIT
  6860        WHEN OPEN-LF-CLAIM
  6861           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6862           AND WS-ST-REF-IND NOT = '4'
  6863           MOVE ER-2967          TO EMI-ERROR
  6864           PERFORM 9700-ERROR-FORMAT
  6865                                 THRU  9799-EXIT
  6866           GO TO 0640-AH-BENEFIT
  6867        WHEN CLOSED-LF-CLAIM
  6868           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6869           AND WS-ST-REF-IND = '4'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL1278.cbl
  6870           MOVE ER-2968          TO EMI-ERROR
  6871           PERFORM 9700-ERROR-FORMAT
  6872                                 THRU  9799-EXIT
  6873        WHEN CLOSED-LF-CLAIM
  6874           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6875           AND WS-ST-REF-IND NOT = '4'
  6876           MOVE ER-2969          TO EMI-ERROR
  6877           PERFORM 9700-ERROR-FORMAT
  6878                                 THRU  9799-EXIT
  6879           GO TO 0640-AH-BENEFIT
  6880        WHEN OTHER
  6881           CONTINUE
  6882     END-EVALUATE
  6883     .
  6884 0620-GET-REM-TERM.
  6885     MOVE WS-CF-LIFE-OVERRIDE-L1
  6886                                 TO  CP-LIFE-OVERRIDE-CODE.
  6887     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6888     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6889     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6890     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6891     MOVE CM-STATE               TO  CP-STATE.
  6892     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6893     MOVE WS-CF-LF-COVERAGE-TYPE
  6894                                 TO  CP-BENEFIT-TYPE.
  6895     MOVE WS-KIND                TO  HLEDESCO.
  6896     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6897     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6898     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6899     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6900     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6901     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6902     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6903     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6904     MOVE WS-CF-CR-REM-TERM-CALC
  6905                                 TO  CP-REM-TERM-METHOD.
  6906
  6907     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6908         MOVE WS-LF-CO-REM-TERM-CALC
  6909                                 TO  CP-REM-TERM-METHOD.
  6910
  6911     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6912         MOVE WS-LF-ST-REM-TERM-CALC
  6913                                 TO  CP-REM-TERM-METHOD.
  6914
  6915     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6916         MOVE WS-LF-AM-REM-TERM-CALC
  6917                                 TO  CP-REM-TERM-METHOD.
  6918
  6919     IF (PI-COMPANY-ID = 'CID')
  6920        AND (CP-STATE-STD-ABBRV = 'WI')
  6921        MOVE '7'                 TO CP-REM-TERM-METHOD
  6922        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6923     END-IF
  6924     IF (PI-COMPANY-ID = 'CID')
  6925        AND (CP-STATE-STD-ABBRV = 'MO')
  6926        AND (CM-CERT-EFF-DT >= X'9B41')
  6927        AND (CM-CERT-EFF-DT <= X'A2FB')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL1278.cbl
  6928        MOVE '7'                 TO CP-REM-TERM-METHOD
  6929        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6930     END-IF
  6931     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6932                                     CP-ORIGINAL-TERM
  6933                                     CP-LOAN-TERM.
  6934
  6935     IF CP-TRUNCATED-LIFE
  6936         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  6937
  6938     IF CP-TERM-IS-DAYS
  6939         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  6940             MOVE CM-LF-TERM-IN-DAYS
  6941                                 TO  CP-TERM-OR-EXT-DAYS
  6942         ELSE
  6943             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  6944     ELSE
  6945         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6946             MOVE CM-PMT-EXTENSION-DAYS
  6947                                 TO  CP-TERM-OR-EXT-DAYS
  6948         ELSE
  6949             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6950
  6951*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6952     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6953     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6954     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6955     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6956
  6957
  6958* EXEC CICS READ
  6959*        DATASET  (ELCNTL-ID)
  6960*        SET      (ADDRESS OF CONTROL-FILE)
  6961*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6962*        RESP     (WS-RESPONSE)
  6963*    END-EXEC.
  6964*    MOVE '&"S        E          (  N#00006817' TO DFHEIV0
  6965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6967     MOVE X'204E233030303036383137' TO DFHEIV0(25:11)
  6968     CALL 'kxdfhei1' USING DFHEIV0,
  6969           ELCNTL-ID,
  6970           DFHEIV20,
  6971           DFHEIV99,
  6972           WS-CF-CONTROL-PRIMARY,
  6973           DFHEIV99,
  6974           DFHEIV99,
  6975           DFHEIV99
  6976     SET ADDRESS OF CONTROL-FILE TO
  6977         DFHEIV20
  6978     MOVE EIBRESP  TO WS-RESPONSE
  6979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6980
  6981
  6982     IF WS-RESP-NOTOPEN
  6983         MOVE ER-2617            TO  EMI-ERROR
  6984         GO TO 0320-INPUT-ERROR.
  6985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL1278.cbl
  6986     IF WS-RESP-NOTFND
  6987         MOVE ZERO               TO  CP-FREE-LOOK
  6988     ELSE
  6989         MOVE CF-ST-FREE-LOOK-PERIOD
  6990                                 TO CP-FREE-LOOK.
  6991
  6992     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6993        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6994        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  6995     END-IF
  6996
  6997     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  6998
  6999     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7000        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7001        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7002        COMPUTE CP-REMAINING-TERM-1 =
  7003                CP-REMAINING-TERM-1 - +1
  7004        COMPUTE CP-REMAINING-TERM-2 =
  7005                CP-REMAINING-TERM-2 - +1
  7006     END-IF
  7007
  7008     IF CP-REMAINING-TERM-1 NEGATIVE
  7009        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7010     END-IF
  7011     IF CP-REMAINING-TERM-2 NEGATIVE
  7012        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7013     END-IF
  7014     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7015
  7016     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7017         GO TO 0640-AH-BENEFIT.
  7018*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7019*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7020
  7021     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7022         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7023             MOVE ER-0681        TO  EMI-ERROR
  7024             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7025
  7026     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7027         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7028             MOVE ER-0682        TO  EMI-ERROR
  7029             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7030
  7031 0630-CONTINUE-LIFE.
  7032
  7033     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7034        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7035        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7036                                    FREMTRMO
  7037     ELSE
  7038        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7039                                     FREMTRMO
  7040     END-IF
  7041     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  7042     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7043     if pi-company-id = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL1278.cbl
  7044        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7045        if cp-class-code = spaces
  7046           move zeros            to cp-class-code
  7047        end-if
  7048     ELSE
  7049        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7050     END-IF
  7051     IF (PI-COMPANY-ID = 'DCC')
  7052        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7053        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7054        PERFORM 0730-GET-DDF-FACTORS
  7055                                 THRU 0730-EXIT
  7056        IF PDEF-FOUND
  7057           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7058              (P1 > +8)
  7059              OR (PD-PROD-CODE (P1) = 'L')
  7060           END-PERFORM
  7061           IF P1 < +9
  7062              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7063           END-IF
  7064        END-IF
  7065     END-IF
  7066     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7067
  7068     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7069
  7070     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7071        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7072                             + CM-LF-ALT-PREMIUM-AMT
  7073     ELSE
  7074        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7075     END-IF
  7076
  7077     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7078                                     WS-TOT-LF-PREM.
  7079
  7080     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7081        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7082        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7083     ELSE
  7084        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7085     END-IF
  7086
  7087     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7088     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7089
  7090     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7091         MOVE WS-LF-ST-REFUND-CALC
  7092                                 TO  CP-EARNING-METHOD.
  7093
  7094     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7095         MOVE WS-LF-FO-REFUND-CALC
  7096                                 TO  CP-EARNING-METHOD.
  7097
  7098     IF CP-RATING-METHOD = '4'
  7099        MOVE '4'                 TO CP-EARNING-METHOD
  7100     END-IF
  7101*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL1278.cbl
  7102*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7103*            MOVE WS-AM-EARN-METHOD-R
  7104*                                TO  CP-EARNING-METHOD
  7105*        END-IF
  7106*    ELSE
  7107*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7108*            MOVE WS-AM-EARN-METHOD-L
  7109*                                TO  CP-EARNING-METHOD.
  7110
  7111     if pi-company-id = 'AHL'
  7112        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7113        if cp-class-code = spaces
  7114           move zeros            to cp-class-code
  7115        end-if
  7116     ELSE
  7117        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7118     END-IF
  7119     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7120     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7121                                     CP-RATING-BENEFIT-AMT.
  7122     IF CP-STATE-STD-ABBRV = 'OR'
  7123         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7124                                         CM-LF-ALT-BENEFIT-AMT.
  7125****   N O T E   ****
  7126*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7127*      THE OH HARD CODING IN ELCRFNDP
  7128
  7129     IF PI-COMPANY-ID = 'CID'
  7130        IF CP-STATE-STD-ABBRV = 'OH'
  7131           MOVE WS-LF-CO-EARNINGS-CALC
  7132                                 TO CP-EARNING-METHOD
  7133        END-IF
  7134     END-IF
  7135
  7136****   N O T E   ****
  7137
  7138****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7139****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7140****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7141****     THE APPROPRIATE OPTIONS HERE
  7142*    IF PI-COMPANY-ID = 'CID'
  7143*       IF (CP-STATE-STD-ABBRV = 'MN')
  7144*          AND (CM-CERT-EFF-DT > X'A4FF')
  7145*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7146*          MOVE '5'              TO CP-EARNING-METHOD
  7147*       END-IF
  7148*    END-IF
  7149     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7150     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7151     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7152     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7153     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7154     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7155
  7156*    IF CP-EARN-AS-NET-PAY
  7157*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7158*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7159*               MOVE WS-CF-DEFAULT-APR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL1278.cbl
  7160*                                TO  CP-LOAN-APR
  7161*               MOVE ER-3780     TO  EMI-ERROR
  7162*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7163*           ELSE
  7164*               MOVE ER-3781     TO  EMI-ERROR
  7165*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7166
  7167*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7168*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7169*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7170*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7171*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7172*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7173*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7174*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7175*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7176*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7177*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7178*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7179*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7180*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7181*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7182*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7183*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7184     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7185     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7186
  7187     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7188
  7189     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7190
  7191     IF CP-ERROR-RATE-IS-ZERO
  7192       OR CP-ERROR-RATE-NOT-FOUND
  7193         MOVE ER-2740            TO  EMI-ERROR
  7194         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7195
  7196     IF CP-ERROR-RATE-FILE-NOTOPEN
  7197         MOVE ER-2617            TO  EMI-ERROR
  7198         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7199
  7200     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7201     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7202                                     WS-TOT-LF-RFND
  7203                                     PI-LF-REFUND-AMT.
  7204     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7205
  7206     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7207
  7208     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7209         GO TO 0640-AH-BENEFIT.
  7210
  7211*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7212*        ADD +1                  TO  CP-REMAINING-TERM
  7213*                                    CP-ORIGINAL-TERM.
  7214
  7215     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7216     MOVE '2'                    TO  CP-EARNING-METHOD
  7217                                     CP-RATING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL1278.cbl
  7218     IF PI-COMPANY-ID = 'CID'
  7219        IF (CP-STATE-STD-ABBRV = 'MN')
  7220           AND (CM-CERT-EFF-DT > X'A4FF')
  7221           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7222           MOVE '5'              TO CP-EARNING-METHOD
  7223           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7224        END-IF
  7225     END-IF
  7226     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7227                                     CP-REMAINING-BENEFIT
  7228                                     CP-RATING-BENEFIT-AMT.
  7229     IF CP-STATE-STD-ABBRV = 'OR'
  7230         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7231                                         CM-LF-ALT-BENEFIT-AMT.
  7232     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7233     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7234
  7235     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7236
  7237     IF CP-ERROR-RATE-IS-ZERO
  7238       OR CP-ERROR-RATE-NOT-FOUND
  7239         MOVE ER-2740            TO  EMI-ERROR
  7240         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7241
  7242     IF CP-ERROR-RATE-FILE-NOTOPEN
  7243         MOVE ER-2617            TO  EMI-ERROR
  7244         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7245
  7246     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7247
  7248     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7249                                     WS-TOT-LF-RFND
  7250                                     PI-LF-REFUND-AMT.
  7251
  7252     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7253
  7254 0640-AH-BENEFIT.
  7255     IF CM-AH-BENEFIT-CD = '00'
  7256         GO TO 0680-CONTINUE.
  7257
  7258 0650-GET-AH-BENEFIT.
  7259     IF ACCT-FOUND
  7260         MOVE +1                 TO SUB3
  7261         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7262     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7263     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7264     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7265     MOVE WS-KIND                TO  HAEDESCO.
  7266     EVALUATE TRUE
  7267        WHEN ((OPEN-LF-CLAIM)
  7268           OR (CLOSED-LF-CLAIM))
  7269           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7270           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7271                                    WS-TOT-AH-RFND
  7272                                    PI-AH-REFUND-AMT
  7273           MOVE SPACES           TO PI-AH-REFUND-METH
  7274           MOVE ER-2965          TO EMI-ERROR
  7275           PERFORM 9700-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL1278.cbl
  7276                                 THRU  9799-EXIT
  7277           GO TO 0680-CONTINUE
  7278        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7279           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7280           AND (EMI-ERROR = ER-2965)
  7281           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7282           MOVE ZEROS            TO HAREFNDO
  7283                                    WS-TOT-AH-RFND
  7284                                    PI-AH-REFUND-AMT
  7285           MOVE SPACES           TO PI-AH-REFUND-METH
  7286           GO TO 0680-CONTINUE
  7287        WHEN (OPEN-AH-CLAIM)
  7288           AND (WS-ST-REF-IND = '1')
  7289           MOVE ZEROS            TO HAREFNDO
  7290                                    WS-TOT-AH-RFND
  7291                                    PI-AH-REFUND-AMT
  7292           MOVE ER-3039          TO EMI-ERROR
  7293           PERFORM 9700-ERROR-FORMAT
  7294                                 THRU  9799-EXIT
  7295           GO TO 0680-CONTINUE
  7296        WHEN (OPEN-AH-CLAIM)
  7297           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7298           MOVE ER-3037          TO EMI-ERROR
  7299           PERFORM 9700-ERROR-FORMAT
  7300                                 THRU  9799-EXIT
  7301*          CONTINUE
  7302        WHEN (OPEN-AH-CLAIM)
  7303           AND (WS-ST-REF-IND = '5')
  7304           MOVE ER-3038          TO EMI-ERROR
  7305           PERFORM 9700-ERROR-FORMAT
  7306                                 THRU  9799-EXIT
  7307*          CONTINUE
  7308        WHEN (OPEN-AH-CLAIM)
  7309           AND (WS-ST-REF-IND = ' ')
  7310           MOVE ER-2768          TO EMI-ERROR
  7311           PERFORM 9700-ERROR-FORMAT
  7312                                 THRU  9799-EXIT
  7313        WHEN (CLOSED-AH-CLAIM)
  7314           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7315           MOVE ZEROS            TO HAREFNDO
  7316                                    WS-TOT-AH-RFND
  7317                                    PI-AH-REFUND-AMT
  7318           MOVE ER-2756          TO EMI-ERROR
  7319           PERFORM 9700-ERROR-FORMAT
  7320                                 THRU  9799-EXIT
  7321           IF WS-TOT-LF-RFND > 0
  7322              MOVE ZEROS         TO HLREFNDO
  7323                                    WS-TOT-LF-RFND
  7324                                    PI-LF-REFUND-AMT
  7325              MOVE SPACES        TO PI-LF-REFUND-METH
  7326           END-IF
  7327           GO TO 0680-CONTINUE
  7328*       WHEN OTHER
  7329*          CONTINUE
  7330     END-EVALUATE
  7331     .
  7332 0660-GET-REM-TERM.
  7333     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL1278.cbl
  7334     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7335     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7336     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7337     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7338*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7339     MOVE WS-KIND                TO  HAEDESCO.
  7340     MOVE CM-STATE               TO  CP-STATE.
  7341     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7342     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7343     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7344     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7345     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7346     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7347     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7348     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7349     MOVE WS-CF-CR-REM-TERM-CALC
  7350                                 TO  CP-REM-TERM-METHOD.
  7351
  7352     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7353         MOVE WS-AH-CO-REM-TERM-CALC
  7354                                 TO  CP-REM-TERM-METHOD.
  7355
  7356     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7357         MOVE WS-AH-ST-REM-TERM-CALC
  7358                                 TO  CP-REM-TERM-METHOD.
  7359
  7360     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7361         MOVE WS-AH-AM-REM-TERM-CALC
  7362                                 TO  CP-REM-TERM-METHOD.
  7363     IF (PI-COMPANY-ID = 'CID')
  7364        AND (CP-STATE-STD-ABBRV = 'WI')
  7365        MOVE '7'                 TO CP-REM-TERM-METHOD
  7366        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7367     END-IF
  7368     IF (PI-COMPANY-ID = 'CID')
  7369        AND (CP-STATE-STD-ABBRV = 'MO')
  7370        AND (CM-CERT-EFF-DT >= X'9B41')
  7371        AND (CM-CERT-EFF-DT <= X'A2FB')
  7372        MOVE '7'                 TO CP-REM-TERM-METHOD
  7373        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7374     END-IF
  7375
  7376     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7377                                     CP-ORIGINAL-TERM
  7378                                     CP-LOAN-TERM.
  7379
  7380     IF  NOT  CP-TERM-IS-DAYS
  7381         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7382             MOVE CM-PMT-EXTENSION-DAYS
  7383                                 TO  CP-TERM-OR-EXT-DAYS
  7384         ELSE
  7385             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7386
  7387*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7388     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7389     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7390     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7391     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL1278.cbl
  7392
  7393
  7394* EXEC CICS READ
  7395*        DATASET  (ELCNTL-ID)
  7396*        SET      (ADDRESS OF CONTROL-FILE)
  7397*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7398*        RESP     (WS-RESPONSE)
  7399*    END-EXEC.
  7400*    MOVE '&"S        E          (  N#00007235' TO DFHEIV0
  7401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7403     MOVE X'204E233030303037323335' TO DFHEIV0(25:11)
  7404     CALL 'kxdfhei1' USING DFHEIV0,
  7405           ELCNTL-ID,
  7406           DFHEIV20,
  7407           DFHEIV99,
  7408           WS-CF-CONTROL-PRIMARY,
  7409           DFHEIV99,
  7410           DFHEIV99,
  7411           DFHEIV99
  7412     SET ADDRESS OF CONTROL-FILE TO
  7413         DFHEIV20
  7414     MOVE EIBRESP  TO WS-RESPONSE
  7415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7416
  7417
  7418     IF WS-RESP-NOTOPEN
  7419         MOVE ER-2617            TO  EMI-ERROR
  7420         GO TO 0320-INPUT-ERROR.
  7421
  7422     IF WS-RESP-NOTFND
  7423         MOVE ZERO               TO CP-FREE-LOOK
  7424     ELSE
  7425         MOVE CF-ST-FREE-LOOK-PERIOD
  7426                                 TO CP-FREE-LOOK.
  7427
  7428     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7429
  7430     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7431
  7432     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7433         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7434             MOVE ER-0683        TO  EMI-ERROR
  7435             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7436
  7437     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7438         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7439             MOVE ER-0684        TO  EMI-ERROR
  7440             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7441
  7442 0670-CONTINUE-AH.
  7443     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7444                                     WS-TOT-AH-PREM.
  7445     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7446
  7447     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7448         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7449
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL1278.cbl
  7450     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7451        GO TO 0680-CONTINUE.
  7452     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7453     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7454     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7455
  7456     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7457         MOVE WS-AH-ST-REFUND-CALC
  7458                                 TO  CP-EARNING-METHOD.
  7459
  7460     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7461         MOVE WS-AH-FO-REFUND-CALC
  7462                                 TO  CP-EARNING-METHOD.
  7463
  7464*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7465*        MOVE WS-AM-EARN-METHOD-A
  7466*                                TO  CP-EARNING-METHOD.
  7467
  7468     if pi-company-id = 'AHL'
  7469        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7470        if cp-class-code = spaces
  7471           move zeros            to cp-class-code
  7472        end-if
  7473     ELSE
  7474        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7475     END-IF
  7476     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7477     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7478                                     CP-RATING-BENEFIT-AMT.
  7479     IF CP-STATE-STD-ABBRV = 'OR'
  7480         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7481                                         CM-AH-ORIG-TERM.
  7482     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7483     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7484     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7485     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7486     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7487     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7488
  7489     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7490     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7491     MOVE ' '                    TO  DC-OPTION-CODE.
  7492
  7493     PERFORM 9600-DATE-LINK.
  7494
  7495     IF CP-STATE-STD-ABBRV = 'OH'
  7496        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7497         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7498           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7499           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7500             MOVE '6'            TO  CP-EARNING-METHOD
  7501         END-IF
  7502        END-IF
  7503        IF PI-COMPANY-ID = 'CID'
  7504           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7505                           LOW-VALUES)
  7506              IF CP-CRITICAL-PERIOD
  7507                 MOVE '2'       TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL1278.cbl
  7508              ELSE
  7509                 MOVE '6'       TO CP-EARNING-METHOD
  7510              END-IF
  7511           ELSE
  7512              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7513                 MOVE '2'       TO CP-EARNING-METHOD
  7514              ELSE
  7515                 IF ((CM-LF-ORIG-TERM > 60) AND
  7516                    (CM-RATE-CLASS NOT = 'L '))
  7517                               OR
  7518                    (WS-LF-CO-EARNINGS-CALC = '5')
  7519                    IF CP-CRITICAL-PERIOD
  7520                       MOVE '2'  TO CP-EARNING-METHOD
  7521                    ELSE
  7522                       MOVE '6'  TO CP-EARNING-METHOD
  7523                    END-IF
  7524                 ELSE
  7525                    MOVE '1'     TO CP-EARNING-METHOD
  7526                 END-IF
  7527              END-IF
  7528           END-IF
  7529        END-IF
  7530     END-IF
  7531
  7532     IF CP-STATE-STD-ABBRV = 'VA'
  7533       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7534         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7535            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7536                MOVE '6'            TO  CP-EARNING-METHOD
  7537            ELSE
  7538                MOVE '1'            TO  CP-EARNING-METHOD.
  7539
  7540     IF CP-EARN-AS-NET-PAY
  7541         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7542            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7543                MOVE WS-CF-DEFAULT-APR
  7544                                 TO  CP-LOAN-APR
  7545                MOVE ER-3780     TO  EMI-ERROR
  7546                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7547            ELSE
  7548                MOVE ER-3781     TO  EMI-ERROR
  7549                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7550     IF PI-COMPANY-ID = 'DCC'
  7551        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7552           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7553           MOVE 'S'              TO CP-EARNING-METHOD
  7554        END-IF
  7555     END-IF
  7556     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7557     IF (PI-COMPANY-ID = 'DCC')
  7558        AND (CP-EARNING-METHOD = 'D')
  7559        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7560                                    WS-DDF-CSO-ADMIN-FEE
  7561                                    WS-DDF-1ST-YR-TOT-EXP
  7562                                    WS-DDF-COMM-AND-MFEE
  7563        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7564           S1 > +10
  7565           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL1278.cbl
  7566              IF (AM-A-COM (S1) NUMERIC)
  7567                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7568                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7569              ELSE
  7570                 MOVE +0         TO WS-COMM-PCT C0
  7571                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7572                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7573              END-IF
  7574              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7575                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7576                    + WS-COMM-PCT
  7577              END-IF
  7578              IF AM-COM-TYP (S1) = 'N'
  7579                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7580                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7581              END-IF
  7582              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7583                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7584                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7585              END-IF
  7586              IF AM-COM-TYP (S1) = 'I'
  7587                 COMPUTE WS-DDF-COMM-AND-MFEE
  7588                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7589              END-IF
  7590           END-IF
  7591        END-PERFORM
  7592        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7593        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7594        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7595           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7596     END-IF
  7597     IF (PI-COMPANY-ID = 'DCC')
  7598        AND (CP-EARNING-METHOD = 'D')
  7599        AND (PI-CANCEL-REASON NOT = 'R')
  7600        PERFORM 0730-GET-DDF-FACTORS
  7601                                 THRU 0730-EXIT
  7602        IF NOT PDEF-FOUND
  7603           MOVE ER-9999          TO EMI-ERROR
  7604           PERFORM 9700-ERROR-FORMAT
  7605                                 THRU 9799-EXIT
  7606           GO TO 8200-SEND-DATAONLY
  7607        END-IF
  7608        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7609                                 TO CP-DDF-LO-FACT
  7610        MOVE PD-UEP-FACTOR (P1 P2)
  7611                                 TO CP-DDF-HI-FACT
  7612        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7613        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7614        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7615        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7616           + PD-1ST-YR-ADMIN-ALLOW
  7617        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7618        IF PI-CLP-YN = 'Y'
  7619           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7620           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7621                                    CP-DDF-CLP
  7622           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7623        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL1278.cbl
  7624        IF DD-IU-PRESENT
  7625           MOVE 'I'              TO CP-EARNING-METHOD
  7626        END-IF
  7627        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7628                                    CP-CLP-RATE-UP
  7629        IF (CP-CALC-GROSS-FEE)
  7630           AND (CP-IU-RATE-UP NOT = ZEROS)
  7631           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7632              / CP-ORIGINAL-PREMIUM)
  7633           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7634              / (1 - TEX-FACT-8)
  7635        END-IF
  7636     END-IF
  7637     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7638
  7639     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7640
  7641     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7642
  7643     IF CP-ERROR-RATE-IS-ZERO
  7644       OR CP-ERROR-RATE-NOT-FOUND
  7645         MOVE ER-2740            TO  EMI-ERROR
  7646         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7647
  7648     IF CP-ERROR-RATE-FILE-NOTOPEN
  7649         MOVE ER-2617            TO  EMI-ERROR
  7650         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7651
  7652     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7653     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7654                                     WS-TOT-AH-RFND
  7655                                     PI-AH-REFUND-AMT.
  7656
  7657     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7658
  7659     MOVE AL-UANON               TO  HACANCA.
  7660
  7661 0680-CONTINUE.
  7662     IF BROWSE-STARTED
  7663         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7664         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7665
  7666     IF CM-LF-BENEFIT-CD = '00'
  7667         MOVE -1                 TO  HACANCL
  7668     ELSE
  7669         MOVE -1                 TO  HLCANCL.
  7670
  7671     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7672                           WS-TOT-PREM.
  7673     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7674                           WS-TOT-RFND.
  7675
  7676     MOVE WS-TOT-PREM            TO  TOPREMO.
  7677     MOVE WS-TOT-RFND            TO  TORFNDO.
  7678
  7679 0680-EXIT.
  7680     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL1278.cbl
  7682 0700-LINK-REM-TERM SECTION.
  7683
  7684* EXEC CICS LINK
  7685*        PROGRAM   (ELRTRM-ID)
  7686*        COMMAREA  (CALCULATION-PASS-AREA)
  7687*        LENGTH    (CP-COMM-LENGTH)
  7688*    END-EXEC.
  7689*    MOVE '."C                   ''   #00007507' TO DFHEIV0
  7690     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7691     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7692     MOVE X'2020233030303037353037' TO DFHEIV0(25:11)
  7693     CALL 'kxdfhei1' USING DFHEIV0,
  7694           ELRTRM-ID,
  7695           CALCULATION-PASS-AREA,
  7696           CP-COMM-LENGTH,
  7697           DFHEIV99,
  7698           DFHEIV99,
  7699           DFHEIV99
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703 0700-EXIT.
  7704     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL1278.cbl
  7706 0710-LINK-REM-AMOUNT SECTION.
  7707
  7708* EXEC CICS LINK
  7709*        PROGRAM   (ELRAMT-ID)
  7710*        COMMAREA  (CALCULATION-PASS-AREA)
  7711*        LENGTH    (CP-COMM-LENGTH)
  7712*    END-EXEC.
  7713*    MOVE '."C                   ''   #00007517' TO DFHEIV0
  7714     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7716     MOVE X'2020233030303037353137' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           ELRAMT-ID,
  7719           CALCULATION-PASS-AREA,
  7720           CP-COMM-LENGTH,
  7721           DFHEIV99,
  7722           DFHEIV99,
  7723           DFHEIV99
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726
  7727 0710-EXIT.
  7728     EXIT.
  7729 0730-GET-DDF-FACTORS.
  7730     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7731     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7732     MOVE CM-STATE               TO ERPDEF-STATE
  7733     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7734     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7735     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7736     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7737     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7738
  7739* EXEC CICS STARTBR
  7740*        DATASET  ('ERPDEF')
  7741*        RIDFLD   (ERPDEF-KEY)
  7742*        GTEQ
  7743*        RESP     (WS-RESPONSE)
  7744*    END-EXEC
  7745     MOVE 'ERPDEF' TO DFHEIV1
  7746     MOVE 0
  7747       TO DFHEIV11
  7748*    MOVE '&,         G          &  N#00007534' TO DFHEIV0
  7749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7751     MOVE X'204E233030303037353334' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0,
  7753           DFHEIV1,
  7754           ERPDEF-KEY,
  7755           DFHEIV99,
  7756           DFHEIV11,
  7757           DFHEIV99
  7758     MOVE EIBRESP  TO WS-RESPONSE
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7760     IF NOT WS-RESP-NORMAL
  7761        GO TO 0730-EXIT
  7762     END-IF
  7763     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL1278.cbl
  7764 0730-READNEXT.
  7765
  7766* EXEC CICS READNEXT
  7767*       DATASET  ('ERPDEF')
  7768*       SET      (ADDRESS OF PRODUCT-MASTER)
  7769*       RIDFLD   (ERPDEF-KEY)
  7770*       RESP     (WS-RESPONSE)
  7771*    END-EXEC
  7772     MOVE 'ERPDEF' TO DFHEIV1
  7773     MOVE 0
  7774       TO DFHEIV11
  7775*    MOVE '&.S                   )  N#00007545' TO DFHEIV0
  7776     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7777     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7778     MOVE X'204E233030303037353435' TO DFHEIV0(25:11)
  7779     CALL 'kxdfhei1' USING DFHEIV0,
  7780           DFHEIV1,
  7781           DFHEIV20,
  7782           DFHEIV99,
  7783           ERPDEF-KEY,
  7784           DFHEIV99,
  7785           DFHEIV11,
  7786           DFHEIV99,
  7787           DFHEIV99
  7788     SET ADDRESS OF PRODUCT-MASTER TO
  7789         DFHEIV20
  7790     MOVE EIBRESP  TO WS-RESPONSE
  7791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7792     IF NOT WS-RESP-NORMAL
  7793        GO TO 0730-ENDBR
  7794     END-IF
  7795     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7796        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7797           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7798        ELSE
  7799           GO TO 0730-READNEXT
  7800        END-IF
  7801     ELSE
  7802        GO TO 0730-ENDBR
  7803     END-IF
  7804     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7805        (P1 > +8)
  7806        OR (PD-PROD-CODE (P1) = 'I')
  7807     END-PERFORM
  7808     IF P1 < +9
  7809        SET DD-IU-PRESENT        TO TRUE
  7810     END-IF
  7811     IF CM-LOAN-TERM = ZEROS
  7812        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7813     END-IF
  7814     IF PD-TRUNCATED = 'Y'
  7815        MOVE CM-LOAN-TERM        TO WS-TERM
  7816     ELSE
  7817        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7818     END-IF
  7819     EVALUATE TRUE
  7820        WHEN WS-TERM > +168
  7821           MOVE 15               TO P1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL1278.cbl
  7822        WHEN WS-TERM > +156
  7823           MOVE 14               TO P1
  7824        WHEN WS-TERM > +144
  7825           MOVE 13               TO P1
  7826        WHEN WS-TERM > +132
  7827           MOVE 12               TO P1
  7828        WHEN WS-TERM > +120
  7829           MOVE 11               TO P1
  7830        WHEN WS-TERM > +108
  7831           MOVE 10               TO P1
  7832        WHEN WS-TERM > +96
  7833           MOVE 9                TO P1
  7834        WHEN WS-TERM > +84
  7835           MOVE 8                TO P1
  7836        WHEN WS-TERM > +72
  7837           MOVE 7                TO P1
  7838        WHEN WS-TERM > +60
  7839           MOVE 6                TO P1
  7840        WHEN WS-TERM > +48
  7841           MOVE 5                TO P1
  7842        WHEN WS-TERM > +36
  7843           MOVE 4                TO P1
  7844        WHEN WS-TERM > +24
  7845           MOVE 3                TO P1
  7846        WHEN WS-TERM > +12
  7847           MOVE 2                TO P1
  7848        WHEN OTHER
  7849           MOVE 1                TO P1
  7850     END-EVALUATE
  7851     EVALUATE TRUE
  7852*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7853*          AND (DD-IU-PRESENT)
  7854*          MOVE 2                TO P2
  7855*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7856*          MOVE 1                TO P2
  7857        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7858           MOVE 2                TO P2
  7859        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7860           MOVE 3                TO P2
  7861        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7862           MOVE 4                TO P2
  7863        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7864           MOVE 5                TO P2
  7865        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7866           MOVE 6                TO P2
  7867        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7868           MOVE 7                TO P2
  7869        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7870           MOVE 8                TO P2
  7871        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7872           MOVE 9                TO P2
  7873        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7874           MOVE 10               TO P2
  7875        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7876           MOVE 11               TO P2
  7877        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7878           MOVE 12               TO P2
  7879        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL1278.cbl
  7880           MOVE 13               TO P2
  7881        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7882           MOVE 14               TO P2
  7883        WHEN OTHER
  7884           MOVE 15               TO P2
  7885     END-EVALUATE
  7886     .
  7887 0730-ENDBR.
  7888
  7889* EXEC CICS ENDBR
  7890*       DATASET  ('ERPDEF')
  7891*    END-EXEC
  7892     MOVE 'ERPDEF' TO DFHEIV1
  7893     MOVE 0
  7894       TO DFHEIV11
  7895*    MOVE '&2                    $   #00007647' TO DFHEIV0
  7896     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7898     MOVE X'2020233030303037363437' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0,
  7900           DFHEIV1,
  7901           DFHEIV11,
  7902           DFHEIV99
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7904     .
  7905 0730-EXIT.
  7906     EXIT.
  7907 0740-GET-ERCTBL.
  7908     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7909     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7910     MOVE 'A'                    TO CTBL-BEN-TYPE
  7911     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7912     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7913     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7914     IF WS-RESP-NORMAL
  7915        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7916     ELSE
  7917        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7918        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7919        MOVE 'A'                    TO CTBL-BEN-TYPE
  7920        MOVE 'AA'                   TO CTBL-BEN-CODE
  7921        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7922        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7923        IF WS-RESP-NORMAL
  7924           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7925        END-IF
  7926     END-IF
  7927     .
  7928 0740-EXIT.
  7929     EXIT.
  7930 0750-READ-ERCTBL.
  7931
  7932* EXEC CICS READ
  7933*         INTO    (COMM-TABLE-RECORD)
  7934*         DATASET ('ERCTBL')
  7935*         RIDFLD  (CTBL-KEY)
  7936*         RESP    (WS-RESPONSE)
  7937*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL1278.cbl
  7938     MOVE LENGTH OF
  7939      COMM-TABLE-RECORD
  7940       TO DFHEIV11
  7941     MOVE 'ERCTBL' TO DFHEIV1
  7942*    MOVE '&"IL       E          (  N#00007677' TO DFHEIV0
  7943     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7945     MOVE X'204E233030303037363737' TO DFHEIV0(25:11)
  7946     CALL 'kxdfhei1' USING DFHEIV0,
  7947           DFHEIV1,
  7948           COMM-TABLE-RECORD,
  7949           DFHEIV11,
  7950           CTBL-KEY,
  7951           DFHEIV99,
  7952           DFHEIV99,
  7953           DFHEIV99
  7954     MOVE EIBRESP  TO WS-RESPONSE
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7956     .
  7957 0750-EXIT.
  7958     EXIT.
  7959 0760-FIND-COMM.
  7960     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7961        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7962        OR (C1 > +3)
  7963     END-PERFORM
  7964     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7965        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7966        OR (C2 > +3)
  7967     END-PERFORM
  7968     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7969        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7970        OR (C3 > +3)
  7971     END-PERFORM
  7972     IF C1 > +3
  7973        MOVE +1                  TO C1
  7974     END-IF
  7975     IF C2 > +3
  7976        MOVE +1                  TO C2
  7977     END-IF
  7978     IF C3 > +3
  7979        MOVE +1                  TO C3
  7980     END-IF
  7981     IF C1 = +3
  7982        MOVE +18                 TO C0
  7983     ELSE
  7984        IF C1 = +2
  7985           MOVE +9               TO C0
  7986        END-IF
  7987     END-IF
  7988     IF C2 = +3
  7989        ADD +6                   TO C0
  7990     ELSE
  7991        IF C2 = +2
  7992           ADD +3                TO C0
  7993        END-IF
  7994     END-IF
  7995     ADD C3                      TO C0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL1278.cbl
  7996     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7997     .
  7998 0760-EXIT.
  7999     EXIT.
  8000 0800-LINK-REFUND SECTION.
  8001     IF CP-AH
  8002       IF PI-EARNING-METHOD-AH NOT = SPACES
  8003         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8004        ELSE
  8005         NEXT SENTENCE
  8006      ELSE
  8007       IF PI-EARNING-METHOD-LF NOT = SPACES
  8008         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8009
  8010
  8011* EXEC CICS LINK
  8012*        PROGRAM   (ELRFND-ID)
  8013*        COMMAREA  (CALCULATION-PASS-AREA)
  8014*        LENGTH    (CP-COMM-LENGTH)
  8015*    END-EXEC.
  8016*    MOVE '."C                   ''   #00007737' TO DFHEIV0
  8017     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8018     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8019     MOVE X'2020233030303037373337' TO DFHEIV0(25:11)
  8020     CALL 'kxdfhei1' USING DFHEIV0,
  8021           ELRFND-ID,
  8022           CALCULATION-PASS-AREA,
  8023           CP-COMM-LENGTH,
  8024           DFHEIV99,
  8025           DFHEIV99,
  8026           DFHEIV99
  8027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8028
  8029
  8030 0899-EXIT.
  8031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL1278.cbl
  8033 0900-READ-CERT-FILE  SECTION.
  8034
  8035* EXEC CICS HANDLE CONDITION
  8036*        NOTFND  (0910-NOT-FOUND)
  8037*    END-EXEC.
  8038*    MOVE '"$I                   ! # #00007747' TO DFHEIV0
  8039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8041     MOVE X'2320233030303037373437' TO DFHEIV0(25:11)
  8042     CALL 'kxdfhei1' USING DFHEIV0
  8043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8044
  8045
  8046
  8047* EXEC CICS READ
  8048*        DATASET  (ELCERT-ID)
  8049*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8050*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8051*    END-EXEC.
  8052*    MOVE '&"S        E          (   #00007751' TO DFHEIV0
  8053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037373531' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           ELCERT-ID,
  8058           DFHEIV20,
  8059           DFHEIV99,
  8060           WS-CM-CONTROL-PRIMARY,
  8061           DFHEIV99,
  8062           DFHEIV99,
  8063           DFHEIV99
  8064     SET ADDRESS OF CERTIFICATE-MASTER TO
  8065         DFHEIV20
  8066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8067
  8068
  8069*    SERVICE RELOAD CERTIFICATE-MASTER.
  8070
  8071     GO TO 0999-EXIT.
  8072
  8073 0910-NOT-FOUND.
  8074     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8075
  8076 0999-EXIT.
  8077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL1278.cbl
  8079 1000-READ-CONTROL  SECTION.
  8080
  8081* EXEC CICS HANDLE CONDITION
  8082*        NOTFND   (1010-NOTFND)
  8083*        NOTOPEN  (1020-NOTOPEN)
  8084*    END-EXEC.
  8085*    MOVE '"$IJ                  ! $ #00007768' TO DFHEIV0
  8086     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8088     MOVE X'2420233030303037373638' TO DFHEIV0(25:11)
  8089     CALL 'kxdfhei1' USING DFHEIV0
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8091
  8092
  8093
  8094* EXEC CICS READ
  8095*        DATASET  (ELCNTL-ID)
  8096*        SET      (ADDRESS OF CONTROL-FILE)
  8097*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8098*        GTEQ
  8099*    END-EXEC.
  8100*    MOVE '&"S        G          (   #00007773' TO DFHEIV0
  8101     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8103     MOVE X'2020233030303037373733' TO DFHEIV0(25:11)
  8104     CALL 'kxdfhei1' USING DFHEIV0,
  8105           ELCNTL-ID,
  8106           DFHEIV20,
  8107           DFHEIV99,
  8108           WS-CF-CONTROL-PRIMARY,
  8109           DFHEIV99,
  8110           DFHEIV99,
  8111           DFHEIV99
  8112     SET ADDRESS OF CONTROL-FILE TO
  8113         DFHEIV20
  8114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8115
  8116
  8117*    SERVICE RELOAD CONTROL-FILE.
  8118
  8119     GO TO 1099-EXIT.
  8120
  8121 1010-NOTFND.
  8122     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8123
  8124     GO TO 1099-EXIT.
  8125
  8126 1020-NOTOPEN.
  8127     MOVE ER-2617                TO  EMI-ERROR.
  8128
  8129     GO TO 0320-INPUT-ERROR.
  8130
  8131 1099-EXIT.
  8132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL1278.cbl
  8134 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8135     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8136
  8137     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8138         VARYING  SUB3  FROM  1  BY  1
  8139             UNTIL  ((SUB3  IS GREATER THAN  50)
  8140               OR ((CF-ST-BENEFIT-CD (SUB3)
  8141                      IS EQUAL TO  WS-BEN-CD)
  8142               AND (WS-LOOKUP-TYPE
  8143                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8144
  8145     IF SUB3  IS NOT EQUAL TO  51
  8146         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8147
  8148     GO TO 1199-EXIT.
  8149
  8150 1110-BENEFIT-DUMMY.
  8151
  8152 1119-EXIT.
  8153     EXIT.
  8154
  8155 1199-EXIT.
  8156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL1278.cbl
  8158 1200-START-ACCOUNT-MASTER  SECTION.
  8159
  8160* EXEC CICS HANDLE CONDITION
  8161*        NOTFND   (1290-ACCT-NOT-FOUND)
  8162*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8163*    END-EXEC.
  8164*    MOVE '"$I''                  ! % #00007822' TO DFHEIV0
  8165     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8167     MOVE X'2520233030303037383232' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0
  8169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8170
  8171
  8172     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8173
  8174
  8175* EXEC CICS STARTBR
  8176*        DATASET  (ERACCT-ID)
  8177*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8178*        GTEQ
  8179*    END-EXEC.
  8180     MOVE 0
  8181       TO DFHEIV11
  8182*    MOVE '&,         G          &   #00007829' TO DFHEIV0
  8183     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8184     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8185     MOVE X'2020233030303037383239' TO DFHEIV0(25:11)
  8186     CALL 'kxdfhei1' USING DFHEIV0,
  8187           ERACCT-ID,
  8188           WS-AM-CONTROL-PRIMARY,
  8189           DFHEIV99,
  8190           DFHEIV11,
  8191           DFHEIV99
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8193
  8194
  8195     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8196     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8197
  8198     GO TO 1299-EXIT.
  8199
  8200 1290-ACCT-NOT-FOUND.
  8201     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8202
  8203 1299-EXIT.
  8204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL1278.cbl
  8206 1300-READ-ACCOUNT-MASTER  SECTION.
  8207
  8208* EXEC CICS HANDLE CONDITION
  8209*        NOTFND   (0580-ACCT-NOT-FOUND)
  8210*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8211*    END-EXEC.
  8212*    MOVE '"$I''                  ! & #00007847' TO DFHEIV0
  8213     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8215     MOVE X'2620233030303037383437' TO DFHEIV0(25:11)
  8216     CALL 'kxdfhei1' USING DFHEIV0
  8217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8218
  8219
  8220
  8221* EXEC CICS READNEXT
  8222*        DATASET  (ERACCT-ID)
  8223*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8224*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8225*    END-EXEC.
  8226     MOVE 0
  8227       TO DFHEIV11
  8228*    MOVE '&.S                   )   #00007852' TO DFHEIV0
  8229     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8230     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8231     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8232     CALL 'kxdfhei1' USING DFHEIV0,
  8233           ERACCT-ID,
  8234           DFHEIV20,
  8235           DFHEIV99,
  8236           WS-AM-CONTROL-PRIMARY,
  8237           DFHEIV99,
  8238           DFHEIV11,
  8239           DFHEIV99,
  8240           DFHEIV99
  8241     SET ADDRESS OF ACCOUNT-MASTER TO
  8242         DFHEIV20
  8243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8244
  8245
  8246*    SERVICE RELOAD ACCOUNT-MASTER.
  8247
  8248 1399-EXIT.
  8249     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL1278.cbl
  8251 1400-GET-REFUND-TYPE  SECTION.
  8252     IF LIFE-REFUND-SEARCH
  8253         NEXT SENTENCE
  8254     ELSE
  8255         GO TO 1410-AH-REFUND-TYPE.
  8256
  8257     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8258         MOVE SPACES             TO  HLCALCO
  8259                                     HLCAL1O
  8260         GO TO 1499-EXIT.
  8261
  8262     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8263
  8264     EVALUATE TRUE
  8265        WHEN CP-R-AS-REPOSSESSION
  8266           MOVE 'REPOSSESSION'     TO  HLCALCO
  8267        WHEN CP-R-AS-R78
  8268           MOVE 'RULE 78'          TO  HLCALCO
  8269        WHEN  CP-R-AS-PRORATA
  8270           MOVE 'PRO RATA'         TO  HLCALCO
  8271        WHEN CP-R-AS-CALIF
  8272           MOVE 'CALIF'            TO  HLCALCO
  8273        WHEN CP-R-AS-TEXAS
  8274           MOVE 'IRREG'            TO  HLCALCO
  8275        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8276           MOVE 'UTAH'             TO  HLCALCO
  8277        WHEN CP-R-AS-FARM-PLAN
  8278           MOVE 'FARM PLAN'        TO  HLCALCO
  8279        WHEN CP-R-AS-NET-PAY
  8280           MOVE 'NET PAY'          TO  HLCALCO
  8281        WHEN CP-R-AS-ANTICIPATION
  8282           MOVE 'ANTICIPATION'     TO  HLCALCO
  8283        WHEN CP-R-AS-MEAN
  8284           MOVE 'MEAN'             TO  HLCALCO
  8285        WHEN CP-R-AS-SUM-OF-DIGITS
  8286           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8287        WHEN OTHER
  8288           MOVE 'UNDEFINED'        TO  HLCALCO
  8289     END-EVALUATE.
  8290
  8291     GO TO 1499-EXIT.
  8292
  8293 1410-AH-REFUND-TYPE.
  8294     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8295         MOVE SPACES             TO  HACALCO
  8296                                     HACAL1O
  8297         GO TO 1499-EXIT.
  8298
  8299     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8300
  8301     EVALUATE TRUE
  8302        WHEN CP-R-AS-REPOSSESSION
  8303           MOVE 'REPOSSESSION'     TO HACALCO
  8304        WHEN CP-R-AS-R78
  8305           MOVE 'RULE 78'          TO HACALCO
  8306        WHEN CP-R-AS-PRORATA
  8307           MOVE 'PRO RATA'         TO HACALCO
  8308        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL1278.cbl
  8309           MOVE 'CALIF'            TO HACALCO
  8310        WHEN CP-R-AS-TEXAS
  8311           MOVE 'IRREG'            TO HACALCO
  8312        WHEN CP-R-AS-FARM-PLAN
  8313           MOVE 'FARM PLAN'        TO HACALCO
  8314        WHEN CP-R-AS-NET-PAY
  8315           MOVE 'NET PAY'          TO HACALCO
  8316        WHEN CP-R-AS-ANTICIPATION
  8317           MOVE 'ANTICIPATION'     TO HACALCO
  8318        WHEN CP-R-AS-MEAN
  8319           MOVE 'MEAN'             TO HACALCO
  8320        WHEN CP-R-AS-SUM-OF-DIGITS
  8321           MOVE 'SUM OF DIGIT'     TO HACALCO
  8322        WHEN CP-GAP-ACTUARIAL
  8323           MOVE 'SP ACTUARIAL'     TO HACALCO
  8324        WHEN CP-R-AS-SPP-DDF
  8325           MOVE 'SPEC DDF'         TO HACALCO
  8326        WHEN CP-R-AS-SPP-DDF-IU
  8327           MOVE 'SPEC DDF IU'      TO HACALCO
  8328        WHEN OTHER
  8329           MOVE 'UNKNOWN'          TO HLCALCO
  8330     END-EVALUATE
  8331     .
  8332 1499-EXIT.
  8333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL1278.cbl
  8335 1500-END-BROWSE  SECTION.
  8336     IF BROWSE-STARTED
  8337
  8338* EXEC CICS ENDBR
  8339*            DATASET  (ERACCT-ID)
  8340*        END-EXEC.
  8341     MOVE 0
  8342       TO DFHEIV11
  8343*    MOVE '&2                    $   #00007949' TO DFHEIV0
  8344     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8346     MOVE X'2020233030303037393439' TO DFHEIV0(25:11)
  8347     CALL 'kxdfhei1' USING DFHEIV0,
  8348           ERACCT-ID,
  8349           DFHEIV11,
  8350           DFHEIV99
  8351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8352
  8353
  8354 1599-EXIT.
  8355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL1278.cbl
  8357 1600-LOCATE-BENEFIT  SECTION.
  8358
  8359* EXEC CICS HANDLE CONDITION
  8360*        NOTFND  (1699-EXIT)
  8361*    END-EXEC.
  8362*    MOVE '"$I                   ! '' #00007957' TO DFHEIV0
  8363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8365     MOVE X'2720233030303037393537' TO DFHEIV0(25:11)
  8366     CALL 'kxdfhei1' USING DFHEIV0
  8367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8368
  8369
  8370     MOVE SPACES                 TO  WS-KIND.
  8371     MOVE ZERO                   TO  WS-NOT-FOUND.
  8372     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8373     MOVE SPACES                 TO  WS-CF-STATE.
  8374     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8375
  8376
  8377* EXEC CICS READ
  8378*        DATASET  (ELCNTL-ID)
  8379*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8380*        SET      (ADDRESS OF CONTROL-FILE)
  8381*        GTEQ
  8382*    END-EXEC.
  8383*    MOVE '&"S        G          (   #00007967' TO DFHEIV0
  8384     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8386     MOVE X'2020233030303037393637' TO DFHEIV0(25:11)
  8387     CALL 'kxdfhei1' USING DFHEIV0,
  8388           ELCNTL-ID,
  8389           DFHEIV20,
  8390           DFHEIV99,
  8391           WS-CF-CONTROL-PRIMARY,
  8392           DFHEIV99,
  8393           DFHEIV99,
  8394           DFHEIV99
  8395     SET ADDRESS OF CONTROL-FILE TO
  8396         DFHEIV20
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8398
  8399
  8400*    SERVICE RELOAD CONTROL-FILE.
  8401
  8402     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8403       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8404         GO TO 1699-EXIT.
  8405
  8406     MOVE +1                     TO  WS-INDEX.
  8407
  8408 1610-LOOKUP-BENEFIT.
  8409     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8410         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8411                                 TO  WS-KIND
  8412         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8413                                 TO  WS-CALC-CD
  8414         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL1278.cbl
  8415                                 TO  WS-BENEFIT-DESCRIP
  8416         MOVE +1                 TO  WS-NOT-FOUND
  8417         GO TO 1699-EXIT.
  8418
  8419     IF CF-BENEFIT-CODE (WS-INDEX)
  8420             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8421         GO TO 1699-EXIT.
  8422
  8423     IF WS-INDEX  IS LESS THAN  +8
  8424         ADD +1                  TO  WS-INDEX
  8425         GO TO 1610-LOOKUP-BENEFIT.
  8426
  8427 1699-EXIT.
  8428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL1278.cbl
  8430 1700-WRITE-CERT-NOTE      SECTION.
  8431     IF NOT MODIFY-CERT-CAP
  8432         MOVE 'UPDATE'           TO  SM-READ
  8433         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8434         MOVE ER-0070            TO  EMI-ERROR
  8435         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8436         GO TO 8200-SEND-DATAONLY.
  8437
  8438**MOVE CANCEL QUOTE NOTE INFO
  8439     IF PI-LF-REFUND-AMT NUMERIC
  8440        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8441        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8442     ELSE
  8443        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8444                                    PI-LF-REFUND-AMT
  8445        MOVE SPACE               TO WS-CN-LF-REF-METH
  8446                                    PI-LF-REFUND-METH.
  8447
  8448     IF PI-AH-REFUND-AMT NUMERIC
  8449        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8450        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8451     ELSE
  8452        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8453                                    PI-AH-REFUND-AMT
  8454        MOVE SPACE               TO WS-CN-AH-REF-METH
  8455                                    PI-AH-REFUND-METH.
  8456
  8457     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8458                                   PI-AH-REFUND-AMT.
  8459
  8460     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8461
  8462     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8463     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8464     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8465        MOVE PI-LF-CANCEL-DATE-ED
  8466                                 TO WS-CN-CANCEL-DT
  8467     ELSE
  8468        MOVE PI-AH-CANCEL-DATE-ED
  8469                                 TO WS-CN-CANCEL-DT
  8470     END-IF
  8471     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8472     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8473     MOVE PI-CARRIER             TO CZ-CARRIER
  8474     MOVE PI-GROUPING            TO CZ-GROUPING
  8475     MOVE PI-STATE               TO CZ-STATE
  8476     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8477     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8478     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8479     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8480     MOVE '1'                    TO CZ-RECORD-TYPE
  8481     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8482     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8483     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8484     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8485     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8486     MOVE ' '                    TO WS-STOP-SW
  8487     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL1278.cbl
  8488
  8489* EXEC CICS WRITE
  8490*           FROM      (CERT-NOTE-FILE)
  8491*           DATASET   (ERNOTE-ID)
  8492*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8493*           RESP      (WS-RESPONSE)
  8494*       END-EXEC
  8495     MOVE LENGTH OF
  8496      CERT-NOTE-FILE
  8497       TO DFHEIV11
  8498*    MOVE '&$ L                  ''  N#00008062' TO DFHEIV0
  8499     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8501     MOVE X'204E233030303038303632' TO DFHEIV0(25:11)
  8502     CALL 'kxdfhei1' USING DFHEIV0,
  8503           ERNOTE-ID,
  8504           CERT-NOTE-FILE,
  8505           DFHEIV11,
  8506           CZ-CONTROL-PRIMARY,
  8507           DFHEIV99,
  8508           DFHEIV99
  8509     MOVE EIBRESP  TO WS-RESPONSE
  8510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8511        IF WS-RESP-DUPREC
  8512           ADD +1                TO CZ-NOTE-SEQUENCE
  8513        ELSE
  8514           SET I-SAY-TO-STOP     TO TRUE
  8515        END-IF
  8516     END-PERFORM
  8517     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8518     IF WS-RESP-NORMAL
  8519        EVALUATE CM-NOTE-SW
  8520           WHEN '1'
  8521           WHEN '3'
  8522           WHEN '5'
  8523           WHEN '7'
  8524              SET NO-CERT-RW     TO TRUE
  8525           WHEN ' '
  8526              MOVE '1'           TO CM-NOTE-SW
  8527           WHEN '2'
  8528              MOVE '3'           TO CM-NOTE-SW
  8529           WHEN '4'
  8530              MOVE '5'           TO CM-NOTE-SW
  8531           WHEN '6'
  8532              MOVE '7'           TO CM-NOTE-SW
  8533        END-EVALUATE
  8534     END-IF
  8535     IF NOT NO-CERT-RW
  8536        PERFORM 1810-REWRITE-ELCERT
  8537                                 THRU 1810-EXIT
  8538     ELSE
  8539
  8540* EXEC CICS UNLOCK
  8541*          DATASET    (ELCERT-ID)
  8542*       END-EXEC
  8543*    MOVE '&*                    #   #00008096' TO DFHEIV0
  8544     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8545     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL1278.cbl
  8546     MOVE X'2020233030303038303936' TO DFHEIV0(25:11)
  8547     CALL 'kxdfhei1' USING DFHEIV0,
  8548           ELCERT-ID,
  8549           DFHEIV99
  8550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8551     END-IF
  8552     MOVE ER-8160                TO EMI-ERROR.
  8553     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8554     GO TO 8200-SEND-DATAONLY.
  8555
  8556 1799-EXIT.
  8557     EXIT.
  8558 1800-READ-ELCERT-UPDATE.
  8559     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8560     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8561     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8562     MOVE PI-STATE               TO  WS-CM-STATE.
  8563     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8564     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8565     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8566     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8567
  8568* EXEC CICS READ
  8569*        UPDATE
  8570*        DATASET  (ELCERT-ID)
  8571*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8572*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8573*        RESP     (WS-RESPONSE)
  8574*    END-EXEC
  8575*    MOVE '&"S        EU         (  N#00008115' TO DFHEIV0
  8576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8577     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8578     MOVE X'204E233030303038313135' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0,
  8580           ELCERT-ID,
  8581           DFHEIV20,
  8582           DFHEIV99,
  8583           WS-CM-CONTROL-PRIMARY,
  8584           DFHEIV99,
  8585           DFHEIV99,
  8586           DFHEIV99
  8587     SET ADDRESS OF CERTIFICATE-MASTER TO
  8588         DFHEIV20
  8589     MOVE EIBRESP  TO WS-RESPONSE
  8590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8591     .
  8592 1800-EXIT.
  8593     EXIT.
  8594 1810-REWRITE-ELCERT.
  8595
  8596* EXEC CICS REWRITE
  8597*        FROM      (CERTIFICATE-MASTER)
  8598*        DATASET   (ELCERT-ID)
  8599*        RESP     (WS-RESPONSE)
  8600*    END-EXEC.
  8601     MOVE LENGTH OF
  8602      CERTIFICATE-MASTER
  8603       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL1278.cbl
  8604*    MOVE '&& L                  %  N#00008126' TO DFHEIV0
  8605     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8606     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8607     MOVE X'204E233030303038313236' TO DFHEIV0(25:11)
  8608     CALL 'kxdfhei1' USING DFHEIV0,
  8609           ELCERT-ID,
  8610           CERTIFICATE-MASTER,
  8611           DFHEIV11,
  8612           DFHEIV99
  8613     MOVE EIBRESP  TO WS-RESPONSE
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8615
  8616     .
  8617 1810-EXIT.
  8618     EXIT.
  8619 4000-GEN-CANCEL-TRANS.
  8620     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8621
  8622     MOVE '2'                    TO CG-OPTION-CODE
  8623     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8624     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8625     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8626     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8627     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8628     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8629     MOVE PI-STATE               TO CG-CERT-STATE
  8630     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8631     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8632     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8633     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8634     MOVE ZEROS                  TO CG-LF-BENCD
  8635                                    CG-AH-BENCD
  8636                                    CG-LF-CAN-AMT
  8637                                    CG-AH-CAN-AMT
  8638     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8639                                    CG-AH-CAN-DT
  8640     MOVE SPACES                 TO CG-BATCH-NO
  8641     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8642       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8643        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8644           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8645           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8646           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8647        END-IF
  8648     END-IF
  8649     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8650       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8651        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8652           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8653           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8654           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
  8655        END-IF
  8656     END-IF
  8657
  8658* EXEC CICS LINK
  8659*        PROGRAM  ('ELCANC')
  8660*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8661*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL1278.cbl
  8662     MOVE LENGTH OF
  8663      CANCEL-GEN-PASS-AREA
  8664       TO DFHEIV11
  8665     MOVE 'ELCANC' TO DFHEIV1
  8666*    MOVE '."C                   ''   #00008172' TO DFHEIV0
  8667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8669     MOVE X'2020233030303038313732' TO DFHEIV0(25:11)
  8670     CALL 'kxdfhei1' USING DFHEIV0,
  8671           DFHEIV1,
  8672           CANCEL-GEN-PASS-AREA,
  8673           DFHEIV11,
  8674           DFHEIV99,
  8675           DFHEIV99,
  8676           DFHEIV99
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8678     IF CG-SUCCESS
  8679        CONTINUE
  8680     ELSE
  8681        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8682        move '3'                 to emi-switch1
  8683        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8684        EVALUATE TRUE
  8685           WHEN CG-DATE-ERROR
  8686             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8687           WHEN CG-CERT-NOT-FOUND
  8688             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8689           WHEN CG-AMOUNT-ERROR
  8690             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8691           WHEN CG-OPTION-ERROR
  8692             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8693           WHEN CG-PREV-CAN
  8694             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8695           WHEN CG-INVALID-DATA
  8696             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8697           WHEN CG-NO-ACCT-MSTR
  8698             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8699           WHEN CG-SFX-A-EXIST
  8700             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8701           WHEN CG-MISC-ERROR
  8702             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8703           WHEN OTHER
  8704             move ' error - elcanc - return '
  8705                                 to emi-error-text (1) (12:25)
  8706        END-EVALUATE
  8707        go to 8200-send-dataonly
  8708     end-if
  8709     .
  8710 4000-exit.
  8711     exit.
  8712
  8713 4400-ADD-ORIG-REC.
  8714
  8715     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8716     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8717     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8718     MOVE PI-STATE               TO  WS-CM-STATE.
  8719     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL1278.cbl
  8720     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8721     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8722     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8723
  8724
  8725* EXEC CICS READ
  8726*        DATASET  (ELCERT-ID)
  8727*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8728*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8729*        RESP     (WS-RESPONSE)
  8730*    END-EXEC
  8731*    MOVE '&"S        E          (  N#00008222' TO DFHEIV0
  8732     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8734     MOVE X'204E233030303038323232' TO DFHEIV0(25:11)
  8735     CALL 'kxdfhei1' USING DFHEIV0,
  8736           ELCERT-ID,
  8737           DFHEIV20,
  8738           DFHEIV99,
  8739           WS-CM-CONTROL-PRIMARY,
  8740           DFHEIV99,
  8741           DFHEIV99,
  8742           DFHEIV99
  8743     SET ADDRESS OF CERTIFICATE-MASTER TO
  8744         DFHEIV20
  8745     MOVE EIBRESP  TO WS-RESPONSE
  8746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8747     IF WS-RESP-NORMAL
  8748         CONTINUE
  8749     ELSE
  8750        MOVE ER-0142                TO EMI-ERROR
  8751        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8752        GO TO 8100-SEND-INITIAL-MAP
  8753     END-IF
  8754
  8755******************************************************************
  8756*            A D D   O R I G   C E R T   I N F O                 *
  8757******************************************************************
  8758
  8759     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8760
  8761     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8762     MOVE ' '                    TO WS-ERMAIL-SW
  8763
  8764
  8765* EXEC CICS READ
  8766*       DATASET   ('ERMAIL')
  8767*       SET       (ADDRESS OF MAILING-DATA)
  8768*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8769*       RESP      (WS-RESPONSE)
  8770*    END-EXEC
  8771     MOVE 'ERMAIL' TO DFHEIV1
  8772*    MOVE '&"S        E          (  N#00008245' TO DFHEIV0
  8773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8775     MOVE X'204E233030303038323435' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0,
  8777           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL1278.cbl
  8778           DFHEIV20,
  8779           DFHEIV99,
  8780           WS-MA-CONTROL-PRIMARY,
  8781           DFHEIV99,
  8782           DFHEIV99,
  8783           DFHEIV99
  8784     SET ADDRESS OF MAILING-DATA TO
  8785         DFHEIV20
  8786     MOVE EIBRESP  TO WS-RESPONSE
  8787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8788
  8789     IF WS-RESP-NORMAL
  8790        SET ERMAIL-FOUND TO TRUE
  8791     END-IF
  8792
  8793     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8794     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8795     MOVE +0                  TO ELCRTO-SEQ-NO
  8796
  8797
  8798* EXEC CICS READ
  8799*       DATASET   ('ELCRTO')
  8800*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8801*       RIDFLD    (ELCRTO-KEY)
  8802*       GTEQ
  8803*       RESP      (WS-RESPONSE)
  8804*    END-EXEC
  8805     MOVE 'ELCRTO' TO DFHEIV1
  8806*    MOVE '&"S        G          (  N#00008260' TO DFHEIV0
  8807     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8808     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8809     MOVE X'204E233030303038323630' TO DFHEIV0(25:11)
  8810     CALL 'kxdfhei1' USING DFHEIV0,
  8811           DFHEIV1,
  8812           DFHEIV20,
  8813           DFHEIV99,
  8814           ELCRTO-KEY,
  8815           DFHEIV99,
  8816           DFHEIV99,
  8817           DFHEIV99
  8818     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8819         DFHEIV20
  8820     MOVE EIBRESP  TO WS-RESPONSE
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8822
  8823     display ' just read gteq ' ws-response
  8824     IF WS-RESP-NORMAL
  8825        AND (OC-CONTROL-PRIMARY (1:33) =
  8826                 WS-CM-CONTROL-PRIMARY)
  8827        AND (OC-RECORD-TYPE = 'I')
  8828        display ' resp norm, key =, type i '
  8829        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  8830
  8831* EXEC CICS READ
  8832*             DATASET   ('ELCRTO')
  8833*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8834*             RIDFLD    (OC-CONTROL-PRIMARY)
  8835*             UPDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL1278.cbl
  8836*             RESP      (WS-RESPONSE)
  8837*          END-EXEC
  8838     MOVE 'ELCRTO' TO DFHEIV1
  8839*    MOVE '&"S        EU         (  N#00008275' TO DFHEIV0
  8840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8841     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8842     MOVE X'204E233030303038323735' TO DFHEIV0(25:11)
  8843     CALL 'kxdfhei1' USING DFHEIV0,
  8844           DFHEIV1,
  8845           DFHEIV20,
  8846           DFHEIV99,
  8847           OC-CONTROL-PRIMARY,
  8848           DFHEIV99,
  8849           DFHEIV99,
  8850           DFHEIV99
  8851     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8852         DFHEIV20
  8853     MOVE EIBRESP  TO WS-RESPONSE
  8854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8855           DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
  8856           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8857           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8858           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8859           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8860           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8861           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8862           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8863           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8864           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8865            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8866               MOVE SPACES             TO OC-LF-BENCD
  8867               MOVE ZEROS              TO OC-LF-TERM
  8868                                          OC-LF-BEN-AMT
  8869                                          OC-LF-PRM-AMT
  8870                                          OC-LF-ALT-BEN-AMT
  8871                                          OC-LF-ALT-PRM-AMT
  8872                                          OC-LF-COMM-PCT
  8873                                          OC-LF-CANCEL-AMT
  8874               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  8875               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8876           ELSE
  8877               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8878               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  8879               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  8880               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  8881               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  8882               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  8883               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  8884               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  8885               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  8886               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  8887           END-IF
  8888           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  8889           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8890            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8891               MOVE SPACES             TO OC-AH-BENCD
  8892               MOVE ZEROS              TO OC-AH-TERM
  8893                                          OC-AH-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL1278.cbl
  8894                                          OC-AH-PRM-AMT
  8895                                          OC-AH-COMM-PCT
  8896                                          OC-AH-CANCEL-AMT
  8897                                          OC-AH-CP
  8898               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  8899               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8900           ELSE
  8901               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  8902               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8903               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8904               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  8905               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8906               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8907               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8908               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  8909               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  8910           END-IF
  8911           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  8912           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8913           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  8914           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8915           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  8916           MOVE '5'                    TO DC-OPTION-CODE
  8917           PERFORM 9600-DATE-LINK
  8918           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  8919           IF ERMAIL-FOUND
  8920               MOVE MA-CRED-BENE-NAME
  8921                           TO OC-CRED-BENE-NAME
  8922           END-IF
  8923
  8924* EXEC CICS REWRITE
  8925*             DATASET   ('ELCRTO')
  8926*             FROM      (ORIGINAL-CERTIFICATE)
  8927*             RESP      (WS-RESPONSE)
  8928*          END-EXEC
  8929     MOVE LENGTH OF
  8930      ORIGINAL-CERTIFICATE
  8931       TO DFHEIV11
  8932     MOVE 'ELCRTO' TO DFHEIV1
  8933*    MOVE '&& L                  %  N#00008350' TO DFHEIV0
  8934     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8935     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8936     MOVE X'204E233030303038333530' TO DFHEIV0(25:11)
  8937     CALL 'kxdfhei1' USING DFHEIV0,
  8938           DFHEIV1,
  8939           ORIGINAL-CERTIFICATE,
  8940           DFHEIV11,
  8941           DFHEIV99
  8942     MOVE EIBRESP  TO WS-RESPONSE
  8943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8944           display ' just rewrote ' ws-response
  8945           IF NOT WS-RESP-NORMAL
  8946              MOVE ER-3830          TO EMI-ERROR
  8947              PERFORM 9700-ERROR-FORMAT
  8948                                 THRU 9799-EXIT
  8949              GO TO 8200-SEND-DATAONLY
  8950           END-IF
  8951
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL1278.cbl
  8952           GO TO 4400-EXIT
  8953
  8954        ELSE
  8955           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8956        END-IF
  8957     ELSE
  8958        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8959        MOVE 'OC'                TO OC-RECORD-ID
  8960        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  8961        MOVE 'I'                 TO OC-RECORD-TYPE
  8962        MOVE +4096               TO OC-KEY-SEQ-NO
  8963     END-IF
  8964
  8965     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8966     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8967     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8968     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8969     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8970     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8971     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8972     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8973     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8974      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8975         MOVE SPACES             TO OC-LF-BENCD
  8976         MOVE ZEROS              TO OC-LF-TERM
  8977                                    OC-LF-BEN-AMT
  8978                                    OC-LF-PRM-AMT
  8979                                    OC-LF-ALT-BEN-AMT
  8980                                    OC-LF-ALT-PRM-AMT
  8981                                    OC-LF-COMM-PCT
  8982                                    OC-LF-CANCEL-AMT
  8983         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  8984         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8985     ELSE
  8986         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  8987         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  8988         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  8989         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  8990         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  8991         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  8992         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  8993         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  8994         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  8995         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  8996     END-IF
  8997     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  8998     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8999      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9000         MOVE SPACES             TO OC-AH-BENCD
  9001         MOVE ZEROS              TO OC-AH-TERM
  9002                                    OC-AH-BEN-AMT
  9003                                    OC-AH-PRM-AMT
  9004                                    OC-AH-COMM-PCT
  9005                                    OC-AH-CANCEL-AMT
  9006                                    OC-AH-CP
  9007         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9008         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9009     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL1278.cbl
  9010         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9011         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9012         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9013         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9014         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9015         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9016         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9017         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9018         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9019         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9020     END-IF
  9021     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9022     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9023     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9024     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9025     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9026     MOVE '5'                    TO DC-OPTION-CODE
  9027     PERFORM 9600-DATE-LINK
  9028     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9029     IF ERMAIL-FOUND
  9030         MOVE MA-CRED-BENE-NAME
  9031                     TO OC-CRED-BENE-NAME
  9032     END-IF
  9033     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9034     .
  9035 4400-WRITE-ELCRTO.
  9036
  9037
  9038* EXEC CICS WRITE
  9039*       DATASET   ('ELCRTO')
  9040*       FROM      (ORIGINAL-CERTIFICATE)
  9041*       RIDFLD    (OC-CONTROL-PRIMARY)
  9042*       RESP      (WS-RESPONSE)
  9043*    END-EXEC
  9044     MOVE LENGTH OF
  9045      ORIGINAL-CERTIFICATE
  9046       TO DFHEIV11
  9047     MOVE 'ELCRTO' TO DFHEIV1
  9048*    MOVE '&$ L                  ''  N#00008448' TO DFHEIV0
  9049     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9050     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9051     MOVE X'204E233030303038343438' TO DFHEIV0(25:11)
  9052     CALL 'kxdfhei1' USING DFHEIV0,
  9053           DFHEIV1,
  9054           ORIGINAL-CERTIFICATE,
  9055           DFHEIV11,
  9056           OC-CONTROL-PRIMARY,
  9057           DFHEIV99,
  9058           DFHEIV99
  9059     MOVE EIBRESP  TO WS-RESPONSE
  9060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9061
  9062    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9063        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9064        GO TO 4400-WRITE-ELCRTO
  9065    ELSE
  9066        IF NOT WS-RESP-NORMAL
  9067           MOVE ER-3830          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL1278.cbl
  9068           PERFORM 9700-ERROR-FORMAT
  9069                                 THRU 9799-EXIT
  9070           GO TO 8200-SEND-DATAONLY
  9071        END-IF
  9072    END-IF
  9073
  9074     .
  9075 4400-EXIT.
  9076    EXIT.
  9077
  9078
  9079 5000-GET-LF-AM-REM-TERM.
  9080     MOVE +1                     TO SUB3.
  9081
  9082 5100-GET-LF-AM-REM-TERM.
  9083     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9084        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9085           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9086                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9087           GO TO 5300-MOVE-LF-REM-TERM.
  9088
  9089     IF SUB3 LESS THAN +20
  9090        ADD +1                   TO SUB3
  9091        GO TO 5100-GET-LF-AM-REM-TERM.
  9092
  9093     MOVE +1                     TO SUB3.
  9094
  9095     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9096         GO TO 5200-EDIT-FOR-NINETY-LF.
  9097
  9098 5100-GET-LF-DMD-AM-REM-TERM.
  9099
  9100     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9101        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9102           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9103                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9104           GO TO 5300-MOVE-LF-REM-TERM.
  9105
  9106     IF SUB3 LESS THAN +30
  9107        ADD +1                   TO SUB3
  9108        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9109
  9110     MOVE +1                     TO SUB3.
  9111
  9112 5200-EDIT-FOR-NINETY-LF.
  9113
  9114***************************************************************
  9115*                                                             *
  9116*    NINETY BENEFIT PLAN TYPES:                               *
  9117*                                                             *
  9118*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9119*      92 = ALL GROUP REDUCING BENEFITS                       *
  9120*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9121*      94 = ALL GROUP LEVEL BENEFITS                          *
  9122*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9123*           BENEFIT CONTROLS.                                 *
  9124*      99 = ALL BENEFITS                                      *
  9125*                                                             *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL1278.cbl
  9126***************************************************************
  9127
  9128     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9129                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9130
  9131     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9132       AND
  9133        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9134           GO TO 5300-MOVE-LF-REM-TERM.
  9135
  9136     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9137       AND
  9138        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9139        IF CF-REDUCING (WS-INDEX)
  9140           IF CM-INDIVIDUAL
  9141               GO TO 5300-MOVE-LF-REM-TERM.
  9142
  9143     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9144       AND
  9145        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9146        IF CF-REDUCING (WS-INDEX)
  9147           IF CM-GROUP
  9148               GO TO 5300-MOVE-LF-REM-TERM.
  9149
  9150     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9151       AND
  9152        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9153        IF CF-LEVEL (WS-INDEX)
  9154           IF CM-INDIVIDUAL
  9155               GO TO 5300-MOVE-LF-REM-TERM.
  9156
  9157     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9158       AND
  9159        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9160        IF CF-LEVEL (WS-INDEX)
  9161           IF CM-GROUP
  9162               GO TO 5300-MOVE-LF-REM-TERM.
  9163
  9164     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9165       AND
  9166        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9167            GO TO 5300-MOVE-LF-REM-TERM.
  9168
  9169     IF SUB3 LESS THAN +20
  9170        ADD +1           TO SUB3
  9171          GO TO 5200-EDIT-FOR-NINETY-LF.
  9172
  9173     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9174
  9175     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9176         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9177         GO TO 5900-EXIT.
  9178
  9179     MOVE 1                       TO SUB3.
  9180
  9181 5200-EDIT-FOR-DMD-NINETY-LF.
  9182
  9183     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL1278.cbl
  9184                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9185
  9186     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9187       AND
  9188        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9189           GO TO 5300-MOVE-LF-REM-TERM.
  9190
  9191     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9192       AND
  9193        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9194        IF CF-REDUCING (WS-INDEX)
  9195           IF CM-INDIVIDUAL
  9196               GO TO 5300-MOVE-LF-REM-TERM.
  9197
  9198     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9199       AND
  9200        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9201        IF CF-REDUCING (WS-INDEX)
  9202           IF CM-GROUP
  9203               GO TO 5300-MOVE-LF-REM-TERM.
  9204
  9205     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9206       AND
  9207        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9208        IF CF-LEVEL (WS-INDEX)
  9209           IF CM-INDIVIDUAL
  9210               GO TO 5300-MOVE-LF-REM-TERM.
  9211
  9212     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9213       AND
  9214        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9215        IF CF-LEVEL (WS-INDEX)
  9216           IF CM-GROUP
  9217               GO TO 5300-MOVE-LF-REM-TERM.
  9218
  9219     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9220       AND
  9221        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9222            GO TO 5300-MOVE-LF-REM-TERM.
  9223
  9224     IF SUB3 LESS THAN +30
  9225        ADD +1                   TO SUB3
  9226          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9227
  9228     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9229
  9230     GO TO 5900-EXIT.
  9231
  9232 5300-MOVE-LF-REM-TERM.
  9233     MOVE WS-SAVE-BENEFIT-REM-TERM
  9234                                 TO WS-LF-AM-REM-TERM-CALC.
  9235
  9236 5900-EXIT.
  9237      EXIT.
  9238
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL1278.cbl
  9240
  9241 6000-GET-AH-AM-REM-TERM.
  9242     MOVE +1                     TO SUB3.
  9243
  9244 6100-GET-AH-AM-REM-TERM.
  9245
  9246     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9247        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9248           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9249                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9250           GO TO 6300-MOVE-AH-REM-TERM.
  9251
  9252     IF SUB3 LESS THAN +20
  9253        ADD +1                   TO SUB3
  9254        GO TO 6100-GET-AH-AM-REM-TERM.
  9255
  9256     MOVE +1                     TO SUB3.
  9257
  9258     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9259         GO TO 6200-EDIT-FOR-NINETY-AH.
  9260
  9261 6100-GET-AH-AM-DMD-REM-TERM.
  9262     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9263        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9264           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9265                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9266           GO TO 6300-MOVE-AH-REM-TERM.
  9267
  9268     IF SUB3 LESS THAN +30
  9269        ADD +1                   TO SUB3
  9270        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9271
  9272     MOVE +1                     TO SUB3.
  9273
  9274 6200-EDIT-FOR-NINETY-AH.
  9275
  9276***************************************************************
  9277*                                                             *
  9278*    NINETY BENEFIT PLAN TYPES:                               *
  9279*                                                             *
  9280*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9281*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9282*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9283*           BENEFIT CONTROLS.                                 *
  9284*      99 = ALL BENEFITS.                                     *
  9285*                                                             *
  9286***************************************************************
  9287
  9288     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9289                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9290
  9291     IF AM-BENEFIT-CODE (SUB3) = '99'
  9292       AND
  9293        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9294           GO TO 6300-MOVE-AH-REM-TERM.
  9295
  9296     IF AM-BENEFIT-CODE (SUB3) = '91'
  9297       AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL1278.cbl
  9298        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9299           IF CM-INDIVIDUAL
  9300               GO TO 6300-MOVE-AH-REM-TERM.
  9301
  9302     IF AM-BENEFIT-CODE (SUB3) = '92'
  9303       AND
  9304        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9305           IF CM-GROUP
  9306               GO TO 6300-MOVE-AH-REM-TERM.
  9307
  9308     IF AM-BENEFIT-CODE (SUB3) = '98'
  9309       AND
  9310        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9311           GO TO 6300-MOVE-AH-REM-TERM.
  9312
  9313     IF SUB3 LESS THAN +20
  9314        ADD +1                    TO SUB3
  9315        GO TO 6200-EDIT-FOR-NINETY-AH.
  9316
  9317     MOVE +1                      TO SUB3.
  9318
  9319     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9320         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9321         GO TO 6900-EXIT.
  9322
  9323 6200-EDIT-FOR-DMD-NINETY-AH.
  9324
  9325     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9326                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9327
  9328     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9329       AND
  9330        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9331           GO TO 6300-MOVE-AH-REM-TERM.
  9332
  9333     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9334       AND
  9335        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9336           IF CM-INDIVIDUAL
  9337               GO TO 6300-MOVE-AH-REM-TERM.
  9338
  9339     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9340       AND
  9341        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9342           IF CM-GROUP
  9343               GO TO 6300-MOVE-AH-REM-TERM.
  9344
  9345     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9346       AND
  9347        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9348           GO TO 6300-MOVE-AH-REM-TERM.
  9349
  9350     IF SUB3 LESS THAN +30
  9351        ADD +1                   TO SUB3
  9352        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9353
  9354     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9355
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL1278.cbl
  9356     GO TO 6900-EXIT.
  9357
  9358 6300-MOVE-AH-REM-TERM.
  9359
  9360     MOVE WS-SAVE-BENEFIT-REM-TERM
  9361                                 TO WS-AH-AM-REM-TERM-CALC.
  9362
  9363 6900-EXIT.
  9364      EXIT.
  9365
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL1278.cbl
  9367 7000-GET-ERFORM     SECTION.
  9368
  9369* EXEC CICS HANDLE CONDITION
  9370*        NOTFND  (7000-EXIT)
  9371*    END-EXEC.
  9372*    MOVE '"$I                   ! ( #00008761' TO DFHEIV0
  9373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9375     MOVE X'2820233030303038373631' TO DFHEIV0(25:11)
  9376     CALL 'kxdfhei1' USING DFHEIV0
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9378
  9379
  9380     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9381     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9382     MOVE PI-STATE               TO  WS-FO-STATE.
  9383     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9384     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9385
  9386
  9387* EXEC CICS READ
  9388*        DATASET  (ERFORM-ID)
  9389*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9390*        SET      (ADDRESS OF FORM-MASTER)
  9391*        GTEQ
  9392*    END-EXEC.
  9393*    MOVE '&"S        G          (   #00008771' TO DFHEIV0
  9394     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9396     MOVE X'2020233030303038373731' TO DFHEIV0(25:11)
  9397     CALL 'kxdfhei1' USING DFHEIV0,
  9398           ERFORM-ID,
  9399           DFHEIV20,
  9400           DFHEIV99,
  9401           WS-FO-CONTROL-PRIMARY,
  9402           DFHEIV99,
  9403           DFHEIV99,
  9404           DFHEIV99
  9405     SET ADDRESS OF FORM-MASTER TO
  9406         DFHEIV20
  9407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9408
  9409
  9410     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9411        PI-STATE          EQUAL FO-STATE      AND
  9412        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9413         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9414         GO TO 7000-EXIT.
  9415 7000-EXIT.
  9416     EXIT.
  9417 7100-BENEFIT-SEARCH SECTION.
  9418
  9419     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9420        MOVE +1                  TO  SUB4
  9421        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9422
  9423     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9424        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL1278.cbl
  9425        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9426 7100-EXIT.
  9427     EXIT.
  9428 7150-BENEFIT-LIFE-SEARCH.
  9429     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9430       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9431         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9432          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9433            IF FO-PLAN-REFUND-METHOD (SUB4)
  9434                    IS GREATER THAN SPACES
  9435               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9436                                    WS-LF-FO-REFUND-CALC
  9437               GO TO 7150-EXIT.
  9438
  9439     IF SUB4 LESS THAN +40
  9440         ADD +1              TO SUB4
  9441         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9442
  9443 7150-EXIT.
  9444     EXIT.
  9445 7250-BENEFIT-AH-SEARCH.
  9446     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9447       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9448         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9449          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9450            IF FO-PLAN-REFUND-METHOD (SUB4)
  9451                    IS GREATER THAN SPACES
  9452               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9453                                    WS-AH-FO-REFUND-CALC
  9454               GO TO 7250-EXIT.
  9455
  9456     IF SUB4 LESS THAN +40
  9457         ADD +1              TO SUB4
  9458         GO TO 7250-BENEFIT-AH-SEARCH.
  9459
  9460 7250-EXIT.
  9461     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL1278.cbl
  9463
  9464 8100-SEND-INITIAL-MAP  SECTION.
  9465     MOVE SAVE-DATE              TO  HDATEO.
  9466     MOVE EIBTIME                TO  TIME-IN.
  9467     MOVE TIME-OUT               TO  HTIMEO.
  9468     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9469     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9470     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9471     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9472
  9473     IF CM-LF-BENEFIT-CD = '00'
  9474         MOVE -1                 TO  HACANCL
  9475     ELSE
  9476         MOVE -1                 TO  HLCANCL.
  9477
  9478     IF PI-COMPANY-ID NOT = 'DCC'
  9479        MOVE AL-SADOF            TO CANREAHA
  9480                                    CLPYNHA
  9481                                    CANREAA
  9482                                    CLPYNA
  9483     END-IF
  9484
  9485
  9486* EXEC CICS SEND
  9487*        FROM    (EL127HO)
  9488*        MAPSET  (MAPSET-NAME)
  9489*        MAP     (MAP-NAME)
  9490*        CURSOR
  9491*        ERASE
  9492*    END-EXEC.
  9493     MOVE LENGTH OF
  9494      EL127HO
  9495       TO DFHEIV12
  9496     MOVE -1
  9497       TO DFHEIV11
  9498*    MOVE '8$     CT  E    H L F ,   #00008853' TO DFHEIV0
  9499     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9500     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9501     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9502     CALL 'kxdfhei1' USING DFHEIV0,
  9503           MAP-NAME,
  9504           EL127HO,
  9505           DFHEIV12,
  9506           MAPSET-NAME,
  9507           DFHEIV99,
  9508           DFHEIV99,
  9509           DFHEIV99,
  9510           DFHEIV11,
  9511           DFHEIV99,
  9512           DFHEIV99,
  9513           DFHEIV99
  9514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9515
  9516
  9517     GO TO 9000-RETURN-TRAN.
  9518
  9519 8200-SEND-DATAONLY  SECTION.
  9520     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL1278.cbl
  9521         GO TO 8100-SEND-INITIAL-MAP.
  9522
  9523     MOVE SAVE-DATE              TO  HDATEO.
  9524     MOVE EIBTIME                TO  TIME-IN.
  9525     MOVE TIME-OUT               TO  HTIMEO.
  9526     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9527     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9528     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9529     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9530     MOVE -1                     TO  HLCANCL.
  9531
  9532
  9533* EXEC CICS SEND DATAONLY
  9534*        FROM    (EL127HO)
  9535*        MAPSET  (MAPSET-NAME)
  9536*        MAP     (MAP-NAME)
  9537*        CURSOR
  9538*    END-EXEC.
  9539     MOVE LENGTH OF
  9540      EL127HO
  9541       TO DFHEIV12
  9542     MOVE -1
  9543       TO DFHEIV11
  9544*    MOVE '8$D    CT       H L F ,   #00008876' TO DFHEIV0
  9545     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9546     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9547     MOVE X'2020233030303038383736' TO DFHEIV0(25:11)
  9548     CALL 'kxdfhei1' USING DFHEIV0,
  9549           MAP-NAME,
  9550           EL127HO,
  9551           DFHEIV12,
  9552           MAPSET-NAME,
  9553           DFHEIV99,
  9554           DFHEIV99,
  9555           DFHEIV99,
  9556           DFHEIV11,
  9557           DFHEIV99,
  9558           DFHEIV99,
  9559           DFHEIV99
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9561
  9562
  9563     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL1278.cbl
  9565 8300-SEND-TEXT  SECTION.
  9566
  9567* EXEC CICS SEND TEXT
  9568*        FROM    (LOGOFF-TEXT)
  9569*        LENGTH  (LOGOFF-LENGTH)
  9570*        ERASE
  9571*        FREEKB
  9572*    END-EXEC.
  9573*    MOVE '8&      T  E F  H   F -   #00008886' TO DFHEIV0
  9574     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9575     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9576     MOVE X'2020233030303038383836' TO DFHEIV0(25:11)
  9577     CALL 'kxdfhei1' USING DFHEIV0,
  9578           LOGOFF-TEXT,
  9579           LOGOFF-LENGTH,
  9580           DFHEIV99,
  9581           DFHEIV99,
  9582           DFHEIV99,
  9583           DFHEIV99,
  9584           DFHEIV99,
  9585           DFHEIV99,
  9586           DFHEIV99,
  9587           DFHEIV99,
  9588           DFHEIV99,
  9589           DFHEIV99
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9591
  9592
  9593
  9594* EXEC CICS RETURN
  9595*    END-EXEC.
  9596*    MOVE '.(                    &   #00008893' TO DFHEIV0
  9597     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9599     MOVE X'2020233030303038383933' TO DFHEIV0(25:11)
  9600     CALL 'kxdfhei1' USING DFHEIV0,
  9601           DFHEIV99,
  9602           DFHEIV99,
  9603           DFHEIV99,
  9604           DFHEIV99,
  9605           DFHEIV99
  9606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9607
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL1278.cbl
  9609 8600-DEEDIT  SECTION.
  9610
  9611* EXEC CICS BIF DEEDIT
  9612*        FIELD   (DEEDIT-FIELD)
  9613*        LENGTH  (15)
  9614*    END-EXEC.
  9615     MOVE 15
  9616       TO DFHEIV11
  9617*    MOVE '@"L                   #   #00008897' TO DFHEIV0
  9618     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9620     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9621     CALL 'kxdfhei1' USING DFHEIV0,
  9622           DEEDIT-FIELD,
  9623           DFHEIV11
  9624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL1278.cbl
  9627 8700-UNAUTHORIZED-ACCESS  SECTION.
  9628     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9629
  9630     GO TO 8300-SEND-TEXT.
  9631
  9632 8800-PF23  SECTION.
  9633     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9634     MOVE XCTL-005               TO  PGM-NAME.
  9635
  9636     GO TO 9200-XCTL.
  9637
  9638 8900-RETURN-CICS  SECTION.
  9639
  9640* EXEC CICS RETURN
  9641*    END-EXEC.
  9642*    MOVE '.(                    &   #00008914' TO DFHEIV0
  9643     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9645     MOVE X'2020233030303038393134' TO DFHEIV0(25:11)
  9646     CALL 'kxdfhei1' USING DFHEIV0,
  9647           DFHEIV99,
  9648           DFHEIV99,
  9649           DFHEIV99,
  9650           DFHEIV99,
  9651           DFHEIV99
  9652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9653
  9654
  9655 9000-RETURN-TRAN  SECTION.
  9656     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9657     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9658
  9659
  9660* EXEC CICS RETURN
  9661*        TRANSID   (TRANS-ID)
  9662*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9663*        LENGTH    (PI-COMM-LENGTH)
  9664*    END-EXEC.
  9665*    MOVE '.(CT                  &   #00008921' TO DFHEIV0
  9666     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9667     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9668     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9669     CALL 'kxdfhei1' USING DFHEIV0,
  9670           TRANS-ID,
  9671           PROGRAM-INTERFACE-BLOCK,
  9672           PI-COMM-LENGTH,
  9673           DFHEIV99,
  9674           DFHEIV99
  9675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9676
  9677
  9678 9100-RETURN-MAIN-MENU  SECTION.
  9679     MOVE XCTL-126               TO  PGM-NAME.
  9680
  9681     GO TO 9200-XCTL.
  9682
  9683 9200-XCTL  SECTION.
  9684
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL1278.cbl
  9685* EXEC CICS XCTL
  9686*        PROGRAM   (PGM-NAME)
  9687*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9688*        LENGTH    (PI-COMM-LENGTH)
  9689*    END-EXEC.
  9690*    MOVE '.$C                   $   #00008933' TO DFHEIV0
  9691     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9693     MOVE X'2020233030303038393333' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0,
  9695           PGM-NAME,
  9696           PROGRAM-INTERFACE-BLOCK,
  9697           PI-COMM-LENGTH
  9698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9699
  9700
  9701 9300-CLEAR  SECTION.
  9702     MOVE ' '                    TO  PI-PEND-SW.
  9703     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9704
  9705     GO TO 9200-XCTL.
  9706
  9707 9400-PF12  SECTION.
  9708     MOVE XCTL-010               TO  PGM-NAME.
  9709
  9710     GO TO 9200-XCTL.
  9711
  9712 9500-PGMID-ERROR  SECTION.
  9713
  9714* EXEC CICS HANDLE CONDITION
  9715*        PGMIDERR  (8300-SEND-TEXT)
  9716*    END-EXEC.
  9717*    MOVE '"$L                   ! ) #00008951' TO DFHEIV0
  9718     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9720     MOVE X'2920233030303038393531' TO DFHEIV0(25:11)
  9721     CALL 'kxdfhei1' USING DFHEIV0
  9722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9723
  9724
  9725     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9726     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9727     MOVE XCTL-005               TO  PGM-NAME.
  9728     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9729     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9730
  9731     GO TO 9200-XCTL.
  9732
  9733 9600-DATE-LINK  SECTION.
  9734     MOVE LINK-ELDATCV           TO  PGM-NAME
  9735
  9736
  9737* EXEC CICS LINK
  9738*        PROGRAM   (PGM-NAME)
  9739*        COMMAREA  (DATE-CONVERSION-DATA)
  9740*        LENGTH    (DC-COMM-LENGTH)
  9741*    END-EXEC.
  9742*    MOVE '."C                   ''   #00008966' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL1278.cbl
  9743     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9744     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9745     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9746     CALL 'kxdfhei1' USING DFHEIV0,
  9747           PGM-NAME,
  9748           DATE-CONVERSION-DATA,
  9749           DC-COMM-LENGTH,
  9750           DFHEIV99,
  9751           DFHEIV99,
  9752           DFHEIV99
  9753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9754
  9755
  9756
  9757 9700-ERROR-FORMAT  SECTION.
  9758     IF NOT EMI-ERRORS-COMPLETE
  9759         MOVE LINK-001               TO  PGM-NAME
  9760
  9761* EXEC CICS LINK
  9762*            PROGRAM   (PGM-NAME)
  9763*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9764*            LENGTH    (EMI-COMM-LENGTH)
  9765*        END-EXEC.
  9766*    MOVE '."C                   ''   #00008976' TO DFHEIV0
  9767     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9769     MOVE X'2020233030303038393736' TO DFHEIV0(25:11)
  9770     CALL 'kxdfhei1' USING DFHEIV0,
  9771           PGM-NAME,
  9772           ERROR-MESSAGE-INTERFACE-BLOCK,
  9773           EMI-COMM-LENGTH,
  9774           DFHEIV99,
  9775           DFHEIV99,
  9776           DFHEIV99
  9777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9778
  9779
  9780 9799-EXIT.
  9781     EXIT.
  9782
  9783 9800-SECURITY-VIOLATION  SECTION.
  9784*                            COPY ELCSCTP.
  9785******************************************************************
  9786*                                                                *
  9787*                            ELCSCTP                             *
  9788*                            VMOD=2.001                          *
  9789*                                                                *
  9790*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9791******************************************************************
  9792
  9793
  9794     MOVE EIBDATE          TO SM-JUL-DATE.
  9795     MOVE EIBTRMID         TO SM-TERMID.
  9796     MOVE THIS-PGM         TO SM-PGM.
  9797     MOVE EIBTIME          TO TIME-IN.
  9798     MOVE TIME-OUT         TO SM-TIME.
  9799     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9800
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL1278.cbl
  9801
  9802* EXEC CICS LINK
  9803*         PROGRAM  ('EL003')
  9804*         COMMAREA (SECURITY-MESSAGE)
  9805*         LENGTH   (80)
  9806*    END-EXEC.
  9807     MOVE 'EL003' TO DFHEIV1
  9808     MOVE 80
  9809       TO DFHEIV11
  9810*    MOVE '."C                   ''   #00009003' TO DFHEIV0
  9811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9813     MOVE X'2020233030303039303033' TO DFHEIV0(25:11)
  9814     CALL 'kxdfhei1' USING DFHEIV0,
  9815           DFHEIV1,
  9816           SECURITY-MESSAGE,
  9817           DFHEIV11,
  9818           DFHEIV99,
  9819           DFHEIV99,
  9820           DFHEIV99
  9821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9822
  9823
  9824******************************************************************
  9825
  9826
  9827 9899-EXIT.
  9828     EXIT.
  9829
  9830 9900-ABEND  SECTION.
  9831     MOVE LINK-004               TO  PGM-NAME.
  9832     MOVE DFHEIBLK               TO  EMI-LINE1.
  9833
  9834
  9835* EXEC CICS LINK
  9836*        PROGRAM   (PGM-NAME)
  9837*        COMMAREA  (EMI-LINE1)
  9838*        LENGTH    (72)
  9839*    END-EXEC.
  9840     MOVE 72
  9841       TO DFHEIV11
  9842*    MOVE '."C                   ''   #00009019' TO DFHEIV0
  9843     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9845     MOVE X'2020233030303039303139' TO DFHEIV0(25:11)
  9846     CALL 'kxdfhei1' USING DFHEIV0,
  9847           PGM-NAME,
  9848           EMI-LINE1,
  9849           DFHEIV11,
  9850           DFHEIV99,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9854
  9855
  9856     MOVE -1                     TO  HLCANCL.
  9857
  9858     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL1278.cbl
  9859
  9860 9999-LAST-PARAGRAPH.
  9861
  9862* GOBACK.
  9863     MOVE '9%                    "   ' TO DFHEIV0
  9864     MOVE 'EL1278' TO DFHEIV1
  9865     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9866     GOBACK.
  9867
  9868 9999-DFHBACK SECTION.
  9869     MOVE '9%                    "   ' TO DFHEIV0
  9870     MOVE 'EL1278' TO DFHEIV1
  9871     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9872     GOBACK.
  9873 9999-DFHEXIT.
  9874     IF DFHEIGDJ EQUAL 0001
  9875         NEXT SENTENCE
  9876     ELSE IF DFHEIGDJ EQUAL 2
  9877         GO TO 9500-PGMID-ERROR,
  9878               9900-ABEND
  9879         DEPENDING ON DFHEIGDI
  9880     ELSE IF DFHEIGDJ EQUAL 3
  9881         GO TO 0910-NOT-FOUND
  9882         DEPENDING ON DFHEIGDI
  9883     ELSE IF DFHEIGDJ EQUAL 4
  9884         GO TO 1010-NOTFND,
  9885               1020-NOTOPEN
  9886         DEPENDING ON DFHEIGDI
  9887     ELSE IF DFHEIGDJ EQUAL 5
  9888         GO TO 1290-ACCT-NOT-FOUND,
  9889               1290-ACCT-NOT-FOUND
  9890         DEPENDING ON DFHEIGDI
  9891     ELSE IF DFHEIGDJ EQUAL 6
  9892         GO TO 0580-ACCT-NOT-FOUND,
  9893               0580-ACCT-NOT-FOUND
  9894         DEPENDING ON DFHEIGDI
  9895     ELSE IF DFHEIGDJ EQUAL 7
  9896         GO TO 1699-EXIT
  9897         DEPENDING ON DFHEIGDI
  9898     ELSE IF DFHEIGDJ EQUAL 8
  9899         GO TO 7000-EXIT
  9900         DEPENDING ON DFHEIGDI
  9901     ELSE IF DFHEIGDJ EQUAL 9
  9902         GO TO 8300-SEND-TEXT
  9903         DEPENDING ON DFHEIGDI.
  9904     MOVE '9%                    "   ' TO DFHEIV0
  9905     MOVE 'EL1278' TO DFHEIV1
  9906     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9907     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8548     Code:       26057
