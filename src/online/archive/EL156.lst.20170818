* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64******************************************************************
    65
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   3
* EL156.cbl
    67 ENVIRONMENT DIVISION.
    68
    69 DATA DIVISION.
    70
    71 WORKING-STORAGE SECTION.
    72 01  DFH-START PIC X(04).
    73
    74 77  FILLER  PIC X(32)  VALUE '********************************'.
    75 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    76 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    77 77  WS-SSN  PIC X(9) VALUE ZEROS.
    78 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    79 77  C0                          PIC S999 COMP-3 VALUE +0.
    80 77  C1                          PIC S999 COMP-3 VALUE +0.
    81 77  C2                          PIC S999 COMP-3 VALUE +0.
    82 77  C3                          PIC S999 COMP-3 VALUE +0.
    83 77  s1                          PIC S999 COMP-3 VALUE +0.
    84 77  s2                          pic s999 comp-3 value +0.
    85 77  P1                          PIC S999 COMP-3 VALUE +0.
    86 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    87 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    88 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    89 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    90 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    91 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    92 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    93 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    94 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    95 77  ws-max-bens                 pic s999 comp-3 value +0.
    96 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    97 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    98 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    99 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   100 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   101 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   102
   103*    COPY ELCSCTM.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCTM                             *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-MESSAGE.
   114     12  FILLER                          PIC X(30)
   115            VALUE '** LOGIC SECURITY VIOLATION -'.
   116     12  SM-READ                         PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' PGM='.
   119     12  SM-PGM                          PIC X(6).
   120     12  FILLER                          PIC X(5)
   121            VALUE ' OPR='.
   122     12  SM-PROCESSOR-ID                 PIC X(4).
   123     12  FILLER                          PIC X(6)
   124            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   4
* EL156.cbl
   125     12  SM-TERMID                       PIC X(4).
   126     12  FILLER                          PIC XX   VALUE SPACE.
   127     12  SM-JUL-DATE                     PIC 9(5).
   128     12  FILLER                          PIC X    VALUE SPACE.
   129     12  SM-TIME                         PIC 99.99.
   130
   131
   132*    COPY ELCSCRTY.
   133******************************************************************
   134*                                                                *
   135*                                                                *
   136*                            ELCSCRTY                            *
   137*                            VMOD=2.001                          *
   138*                                                                *
   139*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   140*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   141*        SAVED IN PI-SECURITY-ADDRESS.                           *
   142*                                                                *
   143******************************************************************
   144 01  SECURITY-CONTROL.
   145     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   146     12  FILLER                       PIC XX    VALUE 'SC'.
   147     12  SC-CREDIT-CODES.
   148         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   149             20  SC-CREDIT-DISPLAY    PIC X.
   150             20  SC-CREDIT-UPDATE     PIC X.
   151     12  SC-CLAIMS-CODES.
   152         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   153             20  SC-CLAIMS-DISPLAY    PIC X.
   154             20  SC-CLAIMS-UPDATE     PIC X.
   155
   156 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   157 01  WS-DATE-AREA.
   158     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   159     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   160     12  SAVE-DATE-CCYYMMDD.
   161         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   162         16  SAVE-DATE-YMD.
   163             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   164             20  FILLER              PIC X(04)   VALUE SPACES.
   165
   166 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   167 01  STANDARD-AREAS.
   168     12  WS-RESPONSE         PIC S9(8)   COMP.
   169         88  WS-RESP-NORMAL              VALUE +00.
   170         88  WS-RESP-ERROR               VALUE +01.
   171         88  WS-RESP-NOTFND              VALUE +13.
   172         88  WS-RESP-DUPREC              VALUE +14.
   173         88  WS-RESP-ENDFILE             VALUE +20.
   174     12  PMT-HEAD-A.
   175         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   176         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   177         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   178-        '     RESERVES  TYPE    AMOUNT'.
   179     12  PMT-HEAD-B.
   180         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   181         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   182         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   5
* EL156.cbl
   183     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   184     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   185     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   186     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   187     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   188     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   189     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   190     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   191     12  PGM-NAME            PIC X(8).
   192     12  TIME-IN             PIC S9(7).
   193     12  TIME-OUT-R  REDEFINES TIME-IN.
   194         16  FILLER          PIC X.
   195         16  TIME-OUT        PIC 99V99.
   196         16  FILLER          PIC XX.
   197     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   198     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   199     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   200     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   201     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   202     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   203     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   204     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   205     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   206     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   207     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   208     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   209     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   210     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   211     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   212     12  WS-BLANK            PIC X       VALUE ' '.
   213
   214 01  MISC-WORK-AREAS.
   215     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   216     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   217     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   218     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   219     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   220     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   221     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   222     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   223     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   224     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   225     12  W-CALLED-NAME           PIC X(08).
   226     12  W-EOB-CODES.
   227         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   228             20  W-EOB-CODE      PIC XXX.
   229             20  W-EOB-FILLER    PIC X.
   230     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   231     12  W-NAME-LAST             PIC X(15).
   232     12  W-NAME-FIRST            PIC X(15).
   233     12  W-NAME-MIDDLE.
   234         16  FILLER              PIC X.
   235         16  W-NAME-MIDDLE-2     PIC X.
   236         16  FILLER              PIC X(13).
   237     12  W-DMD-CHECK-NO.
   238         16  W-DMD-CHECK-NO-1    PIC X(4).
   239         16  W-DMD-CHECK-NO-2    PIC X.
   240         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   6
* EL156.cbl
   241
   242     12  WS-COMPUTE-FROM-DT  PIC XX.
   243     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   244     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   245     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   246     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   247     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   248     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   249         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   250         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   251     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   252         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   253     12  WS-UPDATE-SW        PIC X VALUE ' '.
   254     12  WS-GROUPING.
   255         16  WS-GROUP-1      PIC X VALUE SPACES.
   256         16  FILLER          PIC X(05) VALUE SPACES.
   257     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   258     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   259     12  WS-WORK-STATE-ACCT.
   260         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   261         16  FILLER          PIC X       VALUE '/'.
   262         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   263     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   264     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   265     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   266     12  QID.
   267         16  QID-TERM        PIC X(4)    VALUE SPACES.
   268         16  FILLER          PIC X(4)    VALUE '156A'.
   269     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   270     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   271     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   272     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   273     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   274     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   275     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   276     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   277     12  WS-STATUS           PIC X       VALUE SPACES.
   278     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   279     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   280     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   281     12  ws-extended-exp-dt  pic xx      value low-values.
   282     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   283     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   284     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   285     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   286     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   287     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   288     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   289     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   290     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   291     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   292     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   293     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   294     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   295     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   296     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   297     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   298     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   7
* EL156.cbl
   299     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   300     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   301     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   302     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   303     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   304     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   305     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   306     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   307     12  WORK-DATE-FROM.
   308         16  WDF-MONTH       PIC 99        VALUE ZERO.
   309         16  WDF-DAY         PIC 99        VALUE ZERO.
   310         16  WDF-YEAR        PIC 99        VALUE ZERO.
   311     12  WORK-DATE-THRU.
   312         16  WDT-MONTH       PIC 99        VALUE ZERO.
   313         16  WDT-DAY         PIC 99        VALUE ZERO.
   314         16  WDT-YEAR        PIC 99        VALUE ZERO.
   315     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   316     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   317     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   318     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   319     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   320     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   321     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   322     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   323     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   324     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   325     12  WS-PY-WK REDEFINES WS-PY-WORK.
   326         16  WS-PY-NUM       PIC S9(7)V99.
   327         16  WS-PY-SIGN      PIC X.
   328     12  WS-DY-WORK          PIC S9(5).
   329     12  WS-DY-WK REDEFINES WS-DY-WORK.
   330         16  WS-DY-NUM       PIC S9(4).
   331         16  WS-DY-SIGN      PIC X.
   332     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   333         88  COMP-REC-FOUND              VALUE 'Y'.
   334     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   335         88  BENEFIT-FOUND       VALUE 'Y'.
   336         88  NO-BENEFIT-FOUND    VALUE 'N'.
   337     12  WS-TERMS.
   338         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   339         16  FILLER          PIC X       VALUE '/'.
   340         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   341         16  WST-REM-DAYS-GRP.
   342             20  WST-SLASH   PIC X       VALUE '/'.
   343             20  WST-REM-DAYS
   344                             PIC --9.
   345     12  WS-ACCESS.
   346         16  FILLER          PIC XX      VALUE SPACES.
   347         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   348     12  WS-STATE-ACCESS.
   349         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   350         16  FILLER          PIC XX      VALUE SPACES.
   351     12  WS-CARR-ACCESS.
   352         16  FILLER          PIC X(3)    VALUE SPACES.
   353         16  WS-CARR         PIC X       VALUE SPACES.
   354     12  DATE-WORK.
   355         16  FILLER          PIC XX      VALUE SPACES.
   356         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   8
* EL156.cbl
   357     12  WS-SAVE-INPUT.
   358         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   359         16  WS-PAYEE        PIC XX      VALUE SPACE.
   360         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   361         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   362         16  WS-OFFLINE      PIC X       VALUE SPACE.
   363         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   364         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   365         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   366         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   367         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   368         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   369         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   370         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   371         16  WS-ETYPE        PIC X       VALUE SPACE.
   372         16  WS-CASH         PIC X       VALUE SPACE.
   373         16  WS-GROUPED      PIC X       VALUE SPACE.
   374         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   375         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   376         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   377         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   378         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   379         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   380         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   381         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   382         16  ws-int-to-rem-borr pic x value spaces.
   383     12  LAST-ERROR-LINE.
   384         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   385         16  FILLER              PIC X(30)
   386             VALUE ' FATAL ERRORS ENCOUNTERED'.
   387         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   388         16  FILLER              PIC X(28)
   389             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   390     12  WS-CHECK-AREA.
   391         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   392         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   393     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   394     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   395         16  FILLER              PIC XX.
   396         16  WS-A-CHECK-NUM-5    PIC 9(5).
   397     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   398         16  FILLER              PIC X.
   399         16  WS-A-CHECK-NUM-6    PIC 9(6).
   400     12  OPTION-1-SAVE-AREA.
   401         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   402         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   403     12  WS-WORK-ZIP.
   404         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   405         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   406     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   407                                 PIC 9(9).
   408     12  WS-FLI-PMTNOTE.
   409         16  WS-PMTOPTION        PIC XX.
   410         16  WS-DOCNAME          PIC X(28).
   411         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   412             20  WS-AMOUNT       PIC X(8).
   413             20  FILLER          PIC X(20).
   414         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   9
* EL156.cbl
   415             20  WS-NUM-AMT      PIC 9(6)V99.
   416             20  FILLER          PIC X(20).
   417
   418     12  WS-HAN-PMTNOTE.
   419         16  WS-HAN-PMT-CODE     PIC X.
   420         16  WS-HAN-PMT-NOTE     PIC X(39).
   421
   422     12  WS-NCL-PMT-OPTION       PIC XX.
   423         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   424
   425     12  WS-CLAIM-SEQUENCE.
   426         16  FILLER              PIC X VALUE '('.
   427         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   428         16  FILLER              PIC X(04) VALUE ' OF '.
   429         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   430         16  FILLER              PIC X VALUE ')'.
   431
   432     12  WS-REFUND-AMT           PIC Z(7).99.
   433     12  WS-CALC-INT             PIC S9(7)V99.
   434     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   435
   436     12  SUB                     PIC 99 VALUE ZEROS.
   437
   438     12  WS-BOANOTE1.
   439         16  WS-BOANOTE1-DESC    PIC X(11).
   440         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   441         16  FILLER              PIC X(17).
   442     12  WS-BOANOTE2.
   443         16  WS-BOANOTE2-DESC    PIC X(11).
   444         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   445         16  FILLER              PIC X(17).
   446
   447     12  WS-NCLNOTE1.
   448         16  WS-NCLNOTE1-DESC    PIC X(11).
   449         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   450         16  FILLER              PIC X(17).
   451     12  WS-NCLNOTE2.
   452         16  WS-NCLNOTE2-DESC    PIC X(11).
   453         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   454         16  FILLER              PIC X(17).
   455
   456     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   457     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   458     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   459     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   460     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   461     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   462     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   463     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   464     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   465     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   466
   467     12  WS-AIG-WORK-AREAS.
   468         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   469             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   470         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   471             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   472         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  10
* EL156.cbl
   473             20  WS-FROM-MO      PIC 99.
   474             20  WS-FROM-DA      PIC 99.
   475             20  WS-FROM-YR      PIC 99.
   476         16  WS-TEMP-DATE-MDY.
   477             20  WS-TEMP-MO      PIC 99.
   478             20  WS-TEMP-DA      PIC 99.
   479             20  WS-TEMP-YR      PIC 99.
   480         16  WS-BIN-FROM-DT      PIC XX.
   481         16  WS-TEMP-INC-MDY.
   482             20  WS-TEMP-INC-MO  PIC 99.
   483             20  WS-TEMP-INC-DA  PIC 99.
   484             20  WS-TEMP-INC-YR  PIC 99.
   485         16  WS-PMT-DUE-MDY.
   486             20  WS-PMT-DUE-MO   PIC 99.
   487             20  WS-PMT-DUE-DA   PIC 99.
   488             20  WS-PMT-DUE-YR   PIC 99.
   489         16  WS-PMT-DUE-DT       PIC XX.
   490         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   491         16  WS-RETRO-ELIM-DT    PIC XX.
   492         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   493             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   494         16  WS-SAVE-DUE-DA      PIC 99.
   495         16  WS-CDAYS            PIC S9(05).
   496         16  WS-DAYS-OFF         PIC S9(05).
   497         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   498             88  ELIM-SATISFIED            VALUE 'Y'.
   499         16  WS-AIG-CHECKNO.
   500             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   501             20  WS-A-CHECKNO-3-7.
   502                 24  FILLER              PIC X(3)    VALUE SPACES.
   503                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   504                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   505         16  WS-AIG-GROUPING.
   506             20  WS-A-BENE               PIC XXX.
   507             20  FILLER                  PIC XXX.
   508         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   509             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   510             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   511         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   512                 VALUE 'UNEMPLOYMENT PAYMENT'.
   513         16  WS-CHK-THRU-DT              PIC XX.
   514         16  WS-HOLD-BIN-DATE-1          PIC XX.
   515
   516 01  MISC-CSO-AREA.
   517     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   518     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   519     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   520         88  APPROVAL-NEEDED                        VALUE 'Y'.
   521     12  WS-APPROV-NOTE                  PIC X(43)
   522         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   523     12  WS-3550-APPROV-NOTE             PIC X(43)
   524         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   525     12  WS-REAUDIT-NOTE                 PIC X(43)
   526         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   527     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   528     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   529     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   530     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  11
* EL156.cbl
   531     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   532     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   533     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   534         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   535     12  WS-PAYEE-CITY-STATE     PIC X(30).
   536     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   537         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   538     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   539     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   540     12  WS-WORK-NAME            PIC X(30).
   541     12  FILLER  REDEFINES WS-WORK-NAME.
   542         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   543     12  WS-INSURED-NAME         PIC X(30).
   544     12  FILLER  REDEFINES WS-INSURED-NAME.
   545         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   546     12  WS-PAYEE-NAME           PIC X(30).
   547     12  FILLER  REDEFINES WS-PAYEE-NAME.
   548         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   549
   550 01  ERROR-MESSAGES.
   551     12  ER-0000                 PIC X(4)  VALUE '0000'.
   552     12  ER-0004                 PIC X(4)  VALUE '0004'.
   553     12  ER-0008                 PIC X(4)  VALUE '0008'.
   554     12  ER-0019                 PIC X(4)  VALUE '0019'.
   555     12  ER-0029                 PIC X(4)  VALUE '0029'.
   556     12  ER-0042                 PIC X(4)  VALUE '0042'.
   557     12  ER-0070                 PIC X(4)  VALUE '0070'.
   558     12  ER-0130                 PIC X(4)  VALUE '0130'.
   559     12  ER-0149                 PIC X(4)  VALUE '0149'.
   560     12  ER-0154                 PIC X(4)  VALUE '0154'.
   561     12  ER-0168                 PIC X(4)  VALUE '0168'.
   562     12  ER-0169                 PIC X(4)  VALUE '0169'.
   563     12  ER-0172                 PIC X(4)  VALUE '0174'.
   564     12  ER-0198                 PIC X(4)  VALUE '0198'.
   565     12  ER-0204                 PIC X(4)  VALUE '0204'.
   566     12  ER-0206                 PIC X(4)  VALUE '0206'.
   567     12  ER-0252                 PIC X(4)  VALUE '0252'.
   568     12  ER-0254                 PIC X(4)  VALUE '0254'.
   569     12  ER-0282                 PIC X(4)  VALUE '0282'.
   570     12  ER-0283                 PIC X(4)  VALUE '0283'.
   571     12  ER-0294                 PIC X(4)  VALUE '0294'.
   572     12  ER-0338                 PIC X(4)  VALUE '0338'.
   573     12  ER-0419                 PIC X(4)  VALUE '0419'.
   574     12  ER-0420                 PIC X(4)  VALUE '0420'.
   575     12  ER-0421                 PIC X(4)  VALUE '0421'.
   576     12  ER-0422                 PIC X(4)  VALUE '0422'.
   577     12  ER-0433                 PIC X(4)  VALUE '0433'.
   578     12  ER-0436                 PIC X(4)  VALUE '0436'.
   579     12  ER-0437                 PIC X(4)  VALUE '0437'.
   580     12  ER-0438                 PIC X(4)  VALUE '0438'.
   581     12  ER-0439                 PIC X(4)  VALUE '0439'.
   582     12  ER-0440                 PIC X(4)  VALUE '0440'.
   583     12  ER-0441                 PIC X(4)  VALUE '0441'.
   584     12  ER-0442                 PIC X(4)  VALUE '0442'.
   585     12  ER-0443                 PIC X(4)  VALUE '0443'.
   586     12  ER-0444                 PIC X(4)  VALUE '0444'.
   587     12  ER-0445                 PIC X(4)  VALUE '0445'.
   588     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  12
* EL156.cbl
   589     12  ER-0447                 PIC X(4)  VALUE '0447'.
   590     12  ER-0448                 PIC X(4)  VALUE '0448'.
   591     12  ER-0449                 PIC X(4)  VALUE '0449'.
   592     12  ER-0452                 PIC X(4)  VALUE '0452'.
   593     12  ER-0458                 PIC X(4)  VALUE '0458'.
   594     12  ER-0459                 PIC X(4)  VALUE '0459'.
   595     12  ER-0460                 PIC X(4)  VALUE '0460'.
   596     12  ER-0461                 PIC X(4)  VALUE '0461'.
   597     12  ER-0462                 PIC X(4)  VALUE '0462'.
   598     12  ER-0463                 PIC X(4)  VALUE '0463'.
   599     12  ER-0464                 PIC X(4)  VALUE '0464'.
   600     12  ER-0465                 PIC X(4)  VALUE '0465'.
   601     12  ER-0466                 PIC X(4)  VALUE '0466'.
   602     12  ER-0467                 PIC X(4)  VALUE '0467'.
   603     12  ER-0468                 PIC X(4)  VALUE '0468'.
   604     12  ER-0469                 PIC X(4)  VALUE '0469'.
   605     12  ER-0473                 PIC X(4)  VALUE '0473'.
   606     12  ER-0474                 PIC X(4)  VALUE '0474'.
   607     12  ER-0475                 PIC X(4)  VALUE '0475'.
   608     12  ER-0476                 PIC X(4)  VALUE '0476'.
   609     12  ER-0477                 PIC X(4)  VALUE '0477'.
   610     12  ER-0478                 PIC X(4)  VALUE '0478'.
   611     12  ER-0479                 PIC X(4)  VALUE '0479'.
   612     12  ER-0481                 PIC X(4)  VALUE '0481'.
   613     12  ER-0491                 PIC X(4)  VALUE '0491'.
   614     12  ER-0492                 PIC X(4)  VALUE '0492'.
   615     12  ER-0493                 PIC X(4)  VALUE '0493'.
   616     12  ER-0494                 PIC X(4)  VALUE '0494'.
   617     12  ER-0495                 PIC X(4)  VALUE '0495'.
   618     12  ER-0499                 PIC X(4)  VALUE '0499'.
   619     12  ER-0500                 PIC X(4)  VALUE '0500'.
   620     12  ER-0501                 PIC X(4)  VALUE '0501'.
   621     12  ER-0502                 PIC X(4)  VALUE '0502'.
   622     12  ER-0508                 PIC X(4)  VALUE '0508'.
   623     12  ER-0513                 PIC X(4)  VALUE '0513'.
   624     12  ER-0518                 PIC X(4)  VALUE '0518'.
   625     12  ER-0524                 PIC X(4)  VALUE '0524'.
   626     12  ER-0525                 PIC X(4)  VALUE '0525'.
   627     12  ER-0526                 PIC X(4)  VALUE '0526'.
   628     12  ER-0530                 PIC X(4)  VALUE '0530'.
   629     12  ER-0540                 PIC X(4)  VALUE '0540'.
   630     12  ER-0541                 PIC X(4)  VALUE '0541'.
   631     12  ER-0542                 PIC X(4)  VALUE '0542'.
   632     12  ER-0543                 PIC X(4)  VALUE '0543'.
   633     12  ER-0545                 PIC X(4)  VALUE '0545'.
   634     12  ER-0552                 PIC X(4)  VALUE '0552'.
   635     12  ER-0555                 PIC X(4)  VALUE '0555'.
   636     12  ER-0556                 PIC X(4)  VALUE '0556'.
   637     12  ER-0557                 PIC X(4)  VALUE '0557'.
   638     12  ER-0572                 PIC X(4)  VALUE '0572'.
   639     12  ER-0573                 PIC X(4)  VALUE '0573'.
   640     12  ER-0594                 PIC X(4)  VALUE '0594'.
   641     12  ER-0616                 PIC X(4)  VALUE '0616'.
   642     12  ER-0617                 PIC X(4)  VALUE '0617'.
   643     12  ER-0618                 PIC X(4)  VALUE '0618'.
   644     12  ER-0657                 PIC X(4)  VALUE '0657'.
   645     12  ER-0658                 PIC X(4)  VALUE '0658'.
   646     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  13
* EL156.cbl
   647     12  ER-0730                 PIC X(4)  VALUE '0730'.
   648     12  ER-0737                 PIC X(4)  VALUE '0737'.
   649     12  ER-0760                 PIC X(4)  VALUE '0760'.
   650     12  ER-0768                 PIC X(4)  VALUE '0768'.
   651     12  ER-0769                 PIC X(4)  VALUE '0769'.
   652     12  ER-0770                 PIC X(4)  VALUE '0770'.
   653     12  ER-0802                 PIC X(4)  VALUE '0802'.
   654     12  ER-0803                 PIC X(4)  VALUE '0803'.
   655     12  ER-0819                 PIC X(4)  VALUE '0819'.
   656     12  ER-0834                 PIC X(4)  VALUE '0834'.
   657     12  ER-0836                 PIC X(4)  VALUE '0836'.
   658     12  ER-0844                 PIC X(4)  VALUE '0844'.
   659     12  ER-0845                 PIC X(4)  VALUE '0845'.
   660     12  ER-0846                 PIC X(4)  VALUE '0846'.
   661     12  ER-0849                 PIC X(4)  VALUE '0849'.
   662     12  ER-0851                 PIC X(4)  VALUE '0851'.
   663     12  ER-0872                 PIC X(4)  VALUE '0872'.
   664     12  ER-0873                 PIC X(4)  VALUE '0873'.
   665     12  ER-0874                 PIC X(4)  VALUE '0874'.
   666     12  ER-0879                 PIC X(4)  VALUE '0879'.
   667     12  ER-0919                 PIC X(4)  VALUE '0919'.
   668     12  ER-0921                 PIC X(4)  VALUE '0921'.
   669     12  ER-0923                 PIC X(4)  VALUE '0923'.
   670     12  ER-0925                 PIC X(4)  VALUE '0925'.
   671     12  ER-0944                 PIC X(4)  VALUE '0944'.
   672     12  ER-0945                 PIC X(4)  VALUE '0945'.
   673     12  ER-0946                 PIC X(4)  VALUE '0946'.
   674     12  ER-0947                 PIC X(4)  VALUE '0947'.
   675     12  ER-0948                 PIC X(4)  VALUE '0948'.
   676     12  ER-0949                 PIC X(4)  VALUE '0949'.
   677     12  ER-0950                 PIC X(4)  VALUE '0950'.
   678     12  ER-0951                 PIC X(4)  VALUE '0951'.
   679     12  ER-0954                 PIC X(4)  VALUE '0954'.
   680     12  ER-0956                 PIC X(4)  VALUE '0956'.
   681     12  ER-0967                 PIC X(4)  VALUE '0967'.
   682     12  ER-0968                 PIC X(4)  VALUE '0968'.
   683     12  ER-0974                 PIC X(4)  VALUE '0974'.
   684     12  ER-0975                 PIC X(4)  VALUE '0975'.
   685     12  ER-1561                 PIC X(4)  VALUE '1561'.
   686     12  ER-1566                 PIC X(4)  VALUE '1566'.
   687     12  ER-1567                 PIC X(4)  VALUE '1567'.
   688     12  ER-1569                 PIC X(4)  VALUE '1569'.
   689     12  er-1582                 pic x(4)  value '1582'.
   690     12  er-1657                 pic x(4)  value '1657'.
   691     12  er-1658                 pic x(4)  value '1658'.
   692     12  er-1667                 pic x(4)  value '1667'.
   693     12  er-1670                 pic x(4)  value '1670'.
   694     12  er-1671                 pic x(4)  value '1671'.
   695     12  er-1672                 pic x(4)  value '1672'.
   696     12  er-1673                 pic x(4)  value '1673'.
   697     12  er-1674                 pic x(4)  value '1674'.
   698     12  er-1677                 pic x(4)  value '1677'.
   699     12  ER-1775                 PIC X(4)  VALUE '1775'.
   700     12  ER-1880                 PIC X(4)  VALUE '1880'.
   701     12  ER-2044                 PIC X(4)  VALUE '2044'.
   702     12  ER-3140                 PIC X(4)  VALUE '3140'.
   703     12  ER-3141                 PIC X(4)  VALUE '3141'.
   704     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  14
* EL156.cbl
   705     12  ER-3516                 PIC X(4)  VALUE '3516'.
   706     12  ER-3527                 PIC X(4)  VALUE '3527'.
   707     12  ER-3528                 PIC X(4)  VALUE '3528'.
   708     12  ER-3529                 PIC X(4)  VALUE '3529'.
   709     12  ER-3530                 PIC X(4)  VALUE '3530'.
   710     12  ER-3531                 PIC X(4)  VALUE '3531'.
   711     12  ER-3532                 PIC X(4)  VALUE '3532'.
   712     12  ER-3533                 PIC X(4)  VALUE '3533'.
   713     12  ER-3534                 PIC X(4)  VALUE '3534'.
   714     12  ER-3535                 PIC X(4)  VALUE '3535'.
   715     12  ER-3536                 PIC X(4)  VALUE '3536'.
   716     12  ER-3537                 PIC X(4)  VALUE '3537'.
   717     12  ER-3538                 PIC X(4)  VALUE '3538'.
   718     12  ER-3539                 PIC X(4)  VALUE '3539'.
   719     12  ER-3540                 PIC X(4)  VALUE '3540'.
   720     12  ER-3541                 PIC X(4)  VALUE '3541'.
   721     12  ER-3542                 PIC X(4)  VALUE '3542'.
   722     12  ER-3543                 PIC X(4)  VALUE '3543'.
   723     12  ER-3546                 PIC X(4)  VALUE '3546'.
   724     12  ER-3549                 PIC X(4)  VALUE '3549'.
   725     12  ER-3818                 PIC X(4)  VALUE '3818'.
   726     12  ER-7540                 PIC X(4)  VALUE '7540'.
   727     12  ER-7576                 PIC X(4)  VALUE '7576'.
   728     12  ER-7579                 PIC X(4)  VALUE '7579'.
   729     12  ER-7580                 PIC X(4)  VALUE '7580'.
   730     12  ER-7583                 PIC X(4)  VALUE '7583'.
   731     12  ER-7830                 PIC X(4)  VALUE '7830'.
   732     12  ER-7831                 PIC X(4)  VALUE '7831'.
   733     12  ER-7832                 PIC X(4)  VALUE '7832'.
   734     12  ER-7833                 PIC X(4)  VALUE '7833'.
   735     12  ER-7834                 PIC X(4)  VALUE '7834'.
   736     12  ER-7835                 PIC X(4)  VALUE '7835'.
   737     12  ER-7836                 PIC X(4)  VALUE '7836'.
   738     12  ER-7837                 PIC X(4)  VALUE '7837'.
   739     12  ER-7838                 PIC X(4)  VALUE '7838'.
   740     12  ER-7841                 PIC X(4)  VALUE '7841'.
   741     12  ER-7844                 PIC X(4)  VALUE '7844'.
   742     12  ER-7845                 PIC X(4)  VALUE '7845'.
   743     12  ER-8000                 PIC X(4)  VALUE '8000'.
   744     12  ER-8051                 PIC X(4)  VALUE '8051'.
   745     12  ER-8052                 PIC X(4)  VALUE '8052'.
   746     12  ER-8053                 PIC X(4)  VALUE '8053'.
   747     12  ER-8054                 PIC X(4)  VALUE '8054'.
   748     12  ER-8055                 PIC X(4)  VALUE '8055'.
   749     12  ER-8056                 PIC X(4)  VALUE '8056'.
   750     12  ER-8057                 PIC X(4)  VALUE '8057'.
   751     12  ER-8058                 PIC X(4)  VALUE '8058'.
   752     12  ER-8059                 PIC X(4)  VALUE '8059'.
   753     12  ER-8060                 PIC X(4)  VALUE '8060'.
   754     12  ER-8061                 PIC X(4)  VALUE '8061'.
   755     12  ER-8062                 PIC X(4)  VALUE '8062'.
   756     12  ER-8063                 PIC X(4)  VALUE '8063'.
   757     12  ER-8064                 PIC X(4)  VALUE '8064'.
   758     12  ER-8065                 PIC X(4)  VALUE '8065'.
   759     12  ER-8066                 PIC X(4)  VALUE '8066'.
   760     12  ER-8146                 PIC X(4)  VALUE '8146'.
   761     12  ER-8147                 PIC X(4)  VALUE '8147'.
   762     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  15
* EL156.cbl
   763     12  ER-8153                 PIC X(4)  VALUE '8153'.
   764     12  ER-8154                 PIC X(4)  VALUE '8154'.
   765     12  ER-8155                 PIC X(4)  VALUE '8155'.
   766     12  ER-8310                 PIC X(4)  VALUE '8310'.
   767     12  ER-8311                 PIC X(4)  VALUE '8311'.
   768     12  ER-8312                 PIC X(4)  VALUE '8312'.
   769     12  ER-8313                 PIC X(4)  VALUE '8313'.
   770     12  ER-8314                 PIC X(4)  VALUE '8314'.
   771     12  ER-8315                 PIC X(4)  VALUE '8315'.
   772     12  ER-8316                 PIC X(4)  VALUE '8316'.
   773     12  ER-8317                 PIC X(4)  VALUE '8317'.
   774
   775 01  CSO-WORK-FIELDS.
   776     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   777       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   778
   779     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   780     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   781         88  CERT-NOTE-ADDED           VALUE 'Y'.
   782     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   783         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   784     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   785
   786     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   787
   788 01  SC-NP6-CERT-NOTE.
   789     12  FILLER                  PIC X(12)
   790               VALUE 'REM BENEFIT '.
   791     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   792     12  SC-NP6-COMM             PIC X(8)
   793               VALUE ' + 6 MO '.
   794     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   795     12  FILLER                  PIC X(12)
   796               VALUE ' = AMT PAID '.
   797     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   798
   799 01  SC-NP6-ORIG-NOTE.
   800     12  FILLER                  PIC X(63)  VALUE
   801         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   802 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   803     88  PDEF-FOUND                   VALUE 'Y'.
   804 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   805     88  ACCT-FOUND                   VALUE 'Y'.
   806 01  CTBL-KEY-SAVE               PIC X(5).
   807 01  CTBL-KEY.
   808     05  CTBL-COMPANY-CD         PIC X.
   809     05  CTBL-TABLE              PIC XXX.
   810     05  CTBL-BEN-TYPE           PIC X.
   811     05  CTBL-BEN-CODE           PIC XX.
   812 01  ERPDEF-KEY-SAVE             PIC X(18).
   813 01  ERPDEF-KEY.
   814     12  ERPDEF-COMPANY-CD       PIC X.
   815     12  ERPDEF-STATE            PIC XX.
   816     12  ERPDEF-PROD-CD          PIC XXX.
   817     12  F                       PIC X(7).
   818     12  ERPDEF-BEN-TYPE         PIC X.
   819     12  ERPDEF-BEN-CODE         PIC XX.
   820     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  16
* EL156.cbl
   821 01  ELCRTT-KEY.
   822     05  CTRLR-COMP-CD       PIC X.
   823     05  CTRLR-CARRIER       PIC X.
   824     05  CTRLR-GROUPING      PIC X(6).
   825     05  CTRLR-STATE         PIC X(2).
   826     05  CTRLR-ACCOUNT       PIC X(10).
   827     05  CTRLR-EFF-DT        PIC XX.
   828     05  CTRLR-CERT-NO       PIC X(11).
   829     05  CTRLR-REC-TYPE      PIC X.
   830 01  ACCESS-KEYS.
   831     12  ELARCH-KEY.
   832         16  ARCH-CO             PIC X.
   833         16  ARCH-NUMBER         PIC S9(08) COMP.
   834         16  ARCH-REC-TYPE       PIC X.
   835         16  ARCH-SEQ            PIC S9(04) COMP.
   836     12  ELMSTR-KEY.
   837         16  MSTR-COMP-CD        PIC X.
   838         16  MSTR-CARRIER        PIC X.
   839         16  MSTR-CLAIM-NO       PIC X(7).
   840         16  MSTR-CERT-NO        PIC X(11).
   841     12  ELCNTL-KEY.
   842         16  CNTL-COMP-ID        PIC X(3).
   843         16  CNTL-REC-TYPE       PIC X.
   844         16  CNTL-ACCESS         PIC X(4).
   845         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   846     12  ELCERT-KEY.
   847         16  CERT-COMP-CD        PIC X.
   848         16  CERT-CARRIER        PIC X.
   849         16  CERT-GROUPING       PIC X(6).
   850         16  CERT-STATE          PIC XX.
   851         16  CERT-ACCOUNT        PIC X(10).
   852         16  CERT-EFF-DT         PIC XX.
   853         16  CERT-CERT-NO        PIC X(11).
   854     12  ELTRLR-KEY.
   855         16  TRLR-COMP-CD        PIC X.
   856         16  TRLR-CARRIER        PIC X.
   857         16  TRLR-CLAIM-NO       PIC X(7).
   858         16  TRLR-CERT-NO        PIC X(11).
   859         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   860     12  ELACTQ-KEY.
   861         16  ACTQ-COMP-CD        PIC X.
   862         16  ACTQ-CARRIER        PIC X.
   863         16  ACTQ-CLAIM-NO       PIC X(7).
   864         16  ACTQ-CERT-NO        PIC X(11).
   865     12  W-NOTE-KEY.
   866         16  W-NOTE-COMP-CD      PIC X.
   867         16  W-NOTE-CERT-KEY.
   868             20  W-NOTE-CARRIER  PIC X.
   869             20  W-NOTE-GROUPING PIC X(6).
   870             20  W-NOTE-STATE    PIC XX.
   871             20  W-NOTE-ACCOUNT  PIC X(10).
   872             20  W-NOTE-EFF-DT   PIC XX.
   873             20  W-NOTE-CERT-NO  PIC X(11).
   874     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   875     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   876     12  ERACCT-KEY.
   877         16  ERACCT-PARTIAL-KEY.
   878             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  17
* EL156.cbl
   879             20  ACCT-CARRIER    PIC X.
   880             20  ACCT-GROUPING   PIC X(6).
   881             20  ACCT-STATE      PIC XX.
   882             20  ACCT-ACCOUNT    PIC X(10).
   883         16  ACCT-EXP-DT         PIC XX.
   884         16  FILLER              PIC X(4) VALUE SPACES.
   885     12  ELCHKQ-KEY.
   886         16  CHKQ-COMP-CD        PIC X.
   887         16  CHKQ-CONTROL        PIC S9(8) COMP.
   888         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   889     12  ELBENE-KEY.
   890         16  BENE-COMP-CD         PIC X.
   891         16  BENE-RECORD-TYPE     PIC X.
   892         16  BENE-NUMBER          PIC X(10).
   893     12  ERCOMP-KEY.
   894         16  COMP-COMP-CD        PIC X.
   895         16  COMP-CARRIER        PIC X.
   896         16  COMP-GROUP          PIC X(06).
   897         16  COMP-FIN-RESP       PIC X(10).
   898         16  COMP-ACCOUNT        PIC X(10).
   899         16  COMP-TYPE           PIC X.
   900
   901     12  DLO035-KEY.
   902         16  DL35-PROCESS-TYPE   PIC X.
   903         16  DL35-CREDIT-CARD    PIC X(20).
   904         16  DL35-BEN-TYPE       PIC XX.
   905         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   906         16  DL35-RETURN-CODE    PIC XX.
   907
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  18
* EL156.cbl
   909*    COPY ELCDATE.
   910******************************************************************
   911*                                                                *
   912*                                                                *
   913*                            ELCDATE.                            *
   914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   915*                            VMOD=2.003
   916*                                                                *
   917*                                                                *
   918*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   919*                 LENGTH = 200                                   *
   920******************************************************************
   921
   922 01  DATE-CONVERSION-DATA.
   923     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   924     12  DC-OPTION-CODE                PIC X.
   925         88  BIN-TO-GREG                VALUE ' '.
   926         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   927         88  EDIT-GREG-TO-BIN           VALUE '2'.
   928         88  YMD-GREG-TO-BIN            VALUE '3'.
   929         88  MDY-GREG-TO-BIN            VALUE '4'.
   930         88  JULIAN-TO-BIN              VALUE '5'.
   931         88  BIN-PLUS-ELAPSED           VALUE '6'.
   932         88  FIND-CENTURY               VALUE '7'.
   933         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   934         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   935         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   936         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   937         88  JULIAN-TO-BIN-3            VALUE 'C'.
   938         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   939         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   940         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   941         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   942         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   943         88  CHECK-LEAP-YEAR            VALUE 'H'.
   944         88  BIN-3-TO-GREG              VALUE 'I'.
   945         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   946         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   947         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   948         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   949         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   950         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   951         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   952         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   953         88  THREE-CHARACTER-BIN
   954                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   955         88  GREGORIAN-TO-BIN
   956                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   957         88  BIN-TO-GREGORIAN
   958                  VALUES ' ' '1' 'I' '8' 'G'.
   959         88  JULIAN-TO-BINARY
   960                  VALUES '5' 'C' 'E' 'F'.
   961     12  DC-ERROR-CODE                 PIC X.
   962         88  NO-CONVERSION-ERROR        VALUE ' '.
   963         88  DATE-CONVERSION-ERROR
   964                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   965         88  DATE-IS-ZERO               VALUE '1'.
   966         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  19
* EL156.cbl
   967         88  DATE-IS-INVALID            VALUE '3'.
   968         88  DATE1-GREATER-DATE2        VALUE '4'.
   969         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   970         88  DATE-INVALID-OPTION        VALUE '9'.
   971         88  INVALID-CENTURY            VALUE 'A'.
   972         88  ONLY-CENTURY               VALUE 'B'.
   973         88  ONLY-LEAP-YEAR             VALUE 'C'.
   974         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   975     12  DC-END-OF-MONTH               PIC X.
   976         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   977     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   978         88  USE-NORMAL-PROCESS         VALUE ' '.
   979         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   980         88  ADJUST-UP-100-YRS          VALUE '2'.
   981     12  FILLER                        PIC X.
   982     12  DC-CONVERSION-DATES.
   983         16  DC-BIN-DATE-1             PIC XX.
   984         16  DC-BIN-DATE-2             PIC XX.
   985         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   986         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   987                       DC-GREG-DATE-1-EDIT.
   988             20  DC-EDIT1-MONTH        PIC 99.
   989             20  SLASH1-1              PIC X.
   990             20  DC-EDIT1-DAY          PIC 99.
   991             20  SLASH1-2              PIC X.
   992             20  DC-EDIT1-YEAR         PIC 99.
   993         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   994         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   995                     DC-GREG-DATE-2-EDIT.
   996             20  DC-EDIT2-MONTH        PIC 99.
   997             20  SLASH2-1              PIC X.
   998             20  DC-EDIT2-DAY          PIC 99.
   999             20  SLASH2-2              PIC X.
  1000             20  DC-EDIT2-YEAR         PIC 99.
  1001         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1002         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1003                     DC-GREG-DATE-1-YMD.
  1004             20  DC-YMD-YEAR           PIC 99.
  1005             20  DC-YMD-MONTH          PIC 99.
  1006             20  DC-YMD-DAY            PIC 99.
  1007         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1008         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1009                      DC-GREG-DATE-1-MDY.
  1010             20  DC-MDY-MONTH          PIC 99.
  1011             20  DC-MDY-DAY            PIC 99.
  1012             20  DC-MDY-YEAR           PIC 99.
  1013         16  DC-GREG-DATE-1-ALPHA.
  1014             20  DC-ALPHA-MONTH        PIC X(10).
  1015             20  DC-ALPHA-DAY          PIC 99.
  1016             20  FILLER                PIC XX.
  1017             20  DC-ALPHA-CENTURY.
  1018                 24 DC-ALPHA-CEN-N     PIC 99.
  1019             20  DC-ALPHA-YEAR         PIC 99.
  1020         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1021         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1022         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1023         16  DC-JULIAN-DATE            PIC 9(05).
  1024         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  20
* EL156.cbl
  1025                                       PIC 9(05).
  1026         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1027             20  DC-JULIAN-YEAR        PIC 99.
  1028             20  DC-JULIAN-DAYS        PIC 999.
  1029         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1030         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1031         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1032     12  DATE-CONVERSION-VARIBLES.
  1033         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1034         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1035             20  FILLER                PIC 9(3).
  1036             20  HOLD-CEN-1-CCYY.
  1037                 24  HOLD-CEN-1-CC     PIC 99.
  1038                 24  HOLD-CEN-1-YY     PIC 99.
  1039             20  HOLD-CEN-1-MO         PIC 99.
  1040             20  HOLD-CEN-1-DA         PIC 99.
  1041         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1042             20  HOLD-CEN-1-R-MO       PIC 99.
  1043             20  HOLD-CEN-1-R-DA       PIC 99.
  1044             20  HOLD-CEN-1-R-CCYY.
  1045                 24  HOLD-CEN-1-R-CC   PIC 99.
  1046                 24  HOLD-CEN-1-R-YY   PIC 99.
  1047             20  FILLER                PIC 9(3).
  1048         16  HOLD-CENTURY-1-X.
  1049             20  FILLER                PIC X(3)  VALUE SPACES.
  1050             20  HOLD-CEN-1-X-CCYY.
  1051                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1052                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1053             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1054             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1055         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1056             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1057             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1058             20  HOLD-CEN-1-R-X-CCYY.
  1059                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1060                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1061             20  FILLER                PIC XXX.
  1062         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1063         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1064         16  DC-JULIAN-DATE-1          PIC 9(07).
  1065         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1066             20  DC-JULIAN-1-CCYY.
  1067                 24  DC-JULIAN-1-CC    PIC 99.
  1068                 24  DC-JULIAN-1-YR    PIC 99.
  1069             20  DC-JULIAN-DA-1        PIC 999.
  1070         16  DC-JULIAN-DATE-2          PIC 9(07).
  1071         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1072             20  DC-JULIAN-2-CCYY.
  1073                 24  DC-JULIAN-2-CC    PIC 99.
  1074                 24  DC-JULIAN-2-YR    PIC 99.
  1075             20  DC-JULIAN-DA-2        PIC 999.
  1076         16  DC-GREG-DATE-A-EDIT.
  1077             20  DC-EDITA-MONTH        PIC 99.
  1078             20  SLASHA-1              PIC X VALUE '/'.
  1079             20  DC-EDITA-DAY          PIC 99.
  1080             20  SLASHA-2              PIC X VALUE '/'.
  1081             20  DC-EDITA-CCYY.
  1082                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  21
* EL156.cbl
  1083                 24  DC-EDITA-YEAR     PIC 99.
  1084         16  DC-GREG-DATE-B-EDIT.
  1085             20  DC-EDITB-MONTH        PIC 99.
  1086             20  SLASHB-1              PIC X VALUE '/'.
  1087             20  DC-EDITB-DAY          PIC 99.
  1088             20  SLASHB-2              PIC X VALUE '/'.
  1089             20  DC-EDITB-CCYY.
  1090                 24  DC-EDITB-CENT     PIC 99.
  1091                 24  DC-EDITB-YEAR     PIC 99.
  1092         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1093         16  DC-GREG-DATE-CYMD-R REDEFINES
  1094                              DC-GREG-DATE-CYMD.
  1095             20  DC-CYMD-CEN           PIC 99.
  1096             20  DC-CYMD-YEAR          PIC 99.
  1097             20  DC-CYMD-MONTH         PIC 99.
  1098             20  DC-CYMD-DAY           PIC 99.
  1099         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1100         16  DC-GREG-DATE-MDCY-R REDEFINES
  1101                              DC-GREG-DATE-MDCY.
  1102             20  DC-MDCY-MONTH         PIC 99.
  1103             20  DC-MDCY-DAY           PIC 99.
  1104             20  DC-MDCY-CEN           PIC 99.
  1105             20  DC-MDCY-YEAR          PIC 99.
  1106    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1107        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1108    12  DC-EL310-DATE                  PIC X(21).
  1109    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  22
* EL156.cbl
  1111*    COPY ELCLOGOF.
  1112******************************************************************
  1113*                                                                *
  1114*                                                                *
  1115*                            ELCLOGOF.                           *
  1116*                            VMOD=2.001                          *
  1117*                                                                *
  1118*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1119*                                                                *
  1120******************************************************************
  1121 01  CLASIC-LOGOFF.
  1122     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1123     12  LOGOFF-TEXT.
  1124         16  FILLER          PIC X(5)    VALUE SPACES.
  1125         16  LOGOFF-MSG.
  1126             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1127             20  FILLER      PIC X       VALUE SPACES.
  1128             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1129         16  FILLER          PIC X(80)
  1130           VALUE '* YOU ARE NOW LOGGED OFF'.
  1131         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1132         16  FILLER          PIC X       VALUE QUOTE.
  1133         16  LOGOFF-SYS-MSG  PIC X(17)
  1134           VALUE 'S CLAS-IC SYSTEM '.
  1135     12  TEXT-MESSAGES.
  1136         16  UNACCESS-MSG    PIC X(29)
  1137             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1138         16  PGMIDERR-MSG    PIC X(17)
  1139             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  23
* EL156.cbl
  1141*    COPY ELCCALC.
  1142******************************************************************
  1143*                                                                *
  1144*                           ELCCALC.                            *
  1145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1146*                            VMOD=2.025                          *
  1147*                                                                *
  1148*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1149*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1150*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1151*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1152*                                                                *
  1153*  PASSED TO ELRTRM                                              *
  1154*  -----------------                                             *
  1155*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1156*  ORIGINAL TERM                                                 *
  1157*  BEGINNING DATE                                                *
  1158*  ENDING DATE                                                   *
  1159*  COMPANY I.D.                                                  *
  1160*  ACCOUNT MASTER USER FIELD                                     *
  1161*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1162*  FREE LOOK DAYS                                                *
  1163*                                                                *
  1164*  RETURNED FROM ELRTRM                                          *
  1165*  ---------------------                                         *
  1166*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1167*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1168*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1169*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1170*----------------------------------------------------------------*
  1171*  PASSED TO ELRAMT                                              *
  1172*  ----------------                                              *
  1173*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1174*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1175*  ORIGINAL AMOUNT                                               *
  1176*  ALTERNATE BENEFIT (BALLON)                                    *
  1177*  A.P.R. - NET PAY ONLY                                         *
  1178*  METHOD
  1179*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1180*  COMPANY I.D.                                                  *
  1181*  BENEFIT TYPE                                                  *
  1182*                                                                *
  1183*  RETURNED FROM ELRAMT                                          *
  1184*  --------------------                                          *
  1185*  REMAINING AMOUNT 1 - CURRENT                                  *
  1186*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1187*  REMAINING AMOUNT FACTOR
  1188*----------------------------------------------------------------*
  1189*  PASSED TO ELRESV                                              *
  1190*  -----------------                                             *
  1191*  CERTIFICATE EFFECTIVE DATE                                    *
  1192*  VALUATION DATE                                                *
  1193*  PAID THRU DATE                                                *
  1194*  BENEFIT                                                       *
  1195*  INCURRED DATE                                                 *
  1196*  REPORTED DATE                                                 *
  1197*  ISSUE AGE                                                     *
  1198*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  24
* EL156.cbl
  1199*  CDT PERCENT                                                   *
  1200*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1201* *CLAIM TYPE (LIFE, A/H)                                        *
  1202* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1203* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1204*                                                                *
  1205*  RETURNED FROM ELRESV                                          *
  1206*  --------------------                                          *
  1207*  CDT TABLE USED                                                *
  1208*  CDT FACTOR USED                                               *
  1209*  PAY TO CURRENT RESERVE                                        *
  1210*  I.B.N.R. - A/H ONLY                                           *
  1211*  FUTURE (ACCRUED) AH ONLY                                      *
  1212*----------------------------------------------------------------*
  1213*  PASSED TO ELRATE                                              *
  1214*  ----------------                                              *
  1215*  CERT ISSUE DATE                                               *
  1216*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1217*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1218*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1219*  STATE CODE (CLIENT DEFINED)                                   *
  1220*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1221*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1222*  DEVIATION CODE                                                *
  1223*  ISSUE AGE                                                     *
  1224*  ORIGINAL BENEFIT AMOUNT                                       *
  1225*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1226*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1227*  BENEFIT KIND (LIFE OR A/H)                                    *
  1228*  A.P.R.                                                        *
  1229*  METHOD
  1230*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1231*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1232*  COMPANY I.D. (3 CHARACTER)                                    *
  1233*  BENEFIT CODE                                                  *
  1234*  BENEFIT OVERRIDE CODE                                         *
  1235*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1236*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1237*  JOINT INDICATOR (CSL ONLY)                                    *
  1238*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1239*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1240*                                                                *
  1241*  RETURNED FROM ELRATE                                          *
  1242*  --------------------                                          *
  1243*  CALCULATED PREMIUM                                            *
  1244*  PREMIUM RATE                                                  *
  1245*  MORTALITY CODE                                                *
  1246*  MAX ATTAINED AGE                                              *
  1247*  MAX AGE                                                       *
  1248*  MAX TERM                                                      *
  1249*  MAX MONTHLY BENEFIT                                           *
  1250*  MAX TOTAL BENIFIT                                             *
  1251*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1252*----------------------------------------------------------------*
  1253*  PASSED TO ELRFND                                              *
  1254*  ----------------                                              *
  1255*  CERT ISSUE DATE                                               *
  1256*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  25
* EL156.cbl
  1257*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1258*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1259*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1260*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1261*  STATE CODE (CLIENT DEFINED)                                   *
  1262*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1263*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1264*  DEVIATION CODE                                                *
  1265*  ISSUE AGE                                                     *
  1266*  ORIGINAL BENEFIT AMOUNT                                       *
  1267*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1268*  PROCESS TYPE (CANCEL)                                         *
  1269*  BENEFIT KIND (LIFE OR A/H)                                    *
  1270*  A.P.R.                                                        *
  1271*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1272*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1273*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1274*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1275*  COMPANY I.D. (3 CHARACTER)                                    *
  1276*  BENEFIT CODE                                                  *
  1277*  BENEFIT OVERRIDE CODE                                         *
  1278*                                                                *
  1279*  RETURNED FROM ELRFND                                          *
  1280*  --------------------                                          *
  1281*  CALCULATED REFUND                                             *
  1282*----------------------------------------------------------------*
  1283*  PASSED TO ELEARN                                              *
  1284*  ----------------                                              *
  1285*  CERT ISSUE DATE                                               *
  1286*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1287*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1288*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1289*  STATE CODE (CLIENT DEFINED)                                   *
  1290*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1291*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1292*  DEVIATION CODE                                                *
  1293*  ISSUE AGE                                                     *
  1294*  ORIGINAL BENEFIT AMOUNT                                       *
  1295*  BENEFIT KIND (LIFE OR A/H)                                    *
  1296*  A.P.R.                                                        *
  1297*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1298*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1299*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1300*  COMPANY I.D. (3 CHARACTER)                                    *
  1301*  BENEFIT CODE                                                  *
  1302*  BENEFIT OVERRIDE CODE                                         *
  1303*                                                                *
  1304*  RETURNED FROM ELEARN                                          *
  1305*  --------------------                                          *
  1306*  INDICATED  EARNINGS                                           *
  1307*----------------------------------------------------------------*
  1308*                 LENGTH = 450                                   *
  1309*                                                                *
  1310******************************************************************
  1311******************************************************************
  1312*                   C H A N G E   L O G
  1313*
  1314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  26
* EL156.cbl
  1315*-----------------------------------------------------------------
  1316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1317* EFFECTIVE    NUMBER
  1318*-----------------------------------------------------------------
  1319* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1320* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1321* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1322* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1323* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1324* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1325* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1326* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1327* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1328* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1329* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1330******************************************************************
  1331
  1332 01  CALCULATION-PASS-AREA.
  1333     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1334                                     COMP.
  1335
  1336     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1337       88  NO-CP-ERROR                             VALUE ZERO.
  1338       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1339                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1340       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1341       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1342       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1343       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1344       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1345       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1346       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1347       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1348       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1349       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1350       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1351       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1352       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1353       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1354       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1355       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1356       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1357
  1358     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1359       88  NO-CP-ERROR-2                           VALUE ZERO.
  1360***********************  INPUT AREAS ****************************
  1361
  1362     12  CP-CALCULATION-AREA.
  1363         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1364         16  CP-CERT-EFF-DT        PIC XX.
  1365         16  CP-VALUATION-DT       PIC XX.
  1366         16  CP-PAID-THRU-DT       PIC XX.
  1367         16  CP-BENEFIT-TYPE       PIC X.
  1368           88  CP-AH                               VALUE 'A' 'D'
  1369                                                   'I' 'U'.
  1370           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1371           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1372         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  27
* EL156.cbl
  1373         16  CP-REPORTED-DT        PIC XX.
  1374         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1375         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1376         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-CDT-METHOD         PIC X.
  1381           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1382           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1383           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1384         16  CP-CLAIM-TYPE         PIC X.
  1385           88  CP-AH-CLAIM                         VALUE 'A'.
  1386           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1387         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1388                                     COMP-3.
  1389         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1390                                     COMP-3.
  1391         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1392                                     COMP-3.
  1393         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1398                                     COMP-3.
  1399         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1400                                     COMP-3.
  1401         16  CP-REM-TERM-METHOD    PIC X.
  1402           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1403           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1404           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1405           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1406           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1407           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1408           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1409         16  CP-EARNING-METHOD     PIC X.
  1410           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1411           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1412           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1413           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1414           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1415           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1416           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1417           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1418           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1419           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1420           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1421           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1422           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1423           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1424         16  CP-PROCESS-TYPE       PIC X.
  1425           88  CP-CLAIM                            VALUE '1'.
  1426           88  CP-CANCEL                           VALUE '2'.
  1427           88  CP-ISSUE                            VALUE '3'.
  1428         16  CP-SPECIAL-CALC-CD    PIC X.
  1429           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1430           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  28
* EL156.cbl
  1431           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1432           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1433           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1434           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1435           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1436           88  CP-FARM-PLAN                    VALUE 'F'.
  1437           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1438           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1439           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1440           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1441           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1442           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1443           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1444           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1445           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1446           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1447                                                     'W' 'X'.
  1448           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1449           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1450           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1451           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1452           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1453           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1454           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1455           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1456           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1457           88  CP-CSL-METH-1                   VALUE '5'.
  1458           88  CP-CSL-METH-2                   VALUE '6'.
  1459           88  CP-CSL-METH-3                   VALUE '7'.
  1460           88  CP-CSL-METH-4                   VALUE '8'.
  1461
  1462         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1463                                     COMP-3.
  1464         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1465         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1466         16  CP-STATE              PIC XX          VALUE SPACE.
  1467         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1468         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1469           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1470               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1471         16  CP-R78-OPTION         PIC X.
  1472           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1473           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1474
  1475         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1476         16  CP-IBNR-RESERVE-SW    PIC X.
  1477         16  CP-CLAIM-STATUS       PIC X.
  1478         16  CP-RATE-FILE          PIC X.
  1479         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1480                                     COMP-3.
  1481
  1482         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1483         16  CP-AH-OVERRIDE-CODE   PIC X.
  1484
  1485         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1486                                     COMP-3.
  1487         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1488                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  29
* EL156.cbl
  1489         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1490                                     COMP-3.
  1491         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1492                                     COMP-3.
  1493         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1494                                     COMP-3.
  1495         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1496                                  PIC S9(7)V99 COMP-3.
  1497
  1498         16  CP-PAID-FROM-DATE     PIC X(02).
  1499         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1500         16  CP-EXT-DAYS-CALC      PIC X.
  1501           88  CP-EXT-NO-CHG                   VALUE ' '.
  1502           88  CP-EXT-CHG-LF                   VALUE '1'.
  1503           88  CP-EXT-CHG-AH                   VALUE '2'.
  1504           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1505         16  CP-DOMICILE-STATE     PIC XX.
  1506         16  CP-CARRIER            PIC X.
  1507         16  CP-REIN-FLAG          PIC X.
  1508         16  CP-REM-TRM-CALC-OPTION PIC X.
  1509           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1510                      '2' '3' '4' '5'.
  1511           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1512           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1513           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1514           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1515           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1516           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1517           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1518           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1519         16  CP-SIG-SWITCH         PIC X.
  1520         16  CP-RATING-METHOD      PIC X.
  1521           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1522           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1523           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1524           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1525           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1526           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1527           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1528           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1529           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1530         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1531                                     COMP-3.
  1532         16  CP-BEN-CATEGORY       PIC X.
  1533         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1534         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1535                                   PIC S99V9(5) COMP-3.
  1536         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1537         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1538                                   PIC S99V9(5) COMP-3.
  1539         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1540         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1541         16  CP-EXPIRE-DT          PIC XX.
  1542         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1543         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1544         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1545         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1546         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  30
* EL156.cbl
  1547             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1548             88  CP-CALC-CLP              VALUE 'C'.
  1549         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1550         16  CP-CANCEL-REASON      PIC X.
  1551         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1552         16  CP-PMT-MODE           PIC X.
  1553         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1554         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1555         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1556         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1557         16  FILLER                PIC X.
  1558
  1559***************    OUTPUT FROM ELRESV   ************************
  1560
  1561         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1562
  1563         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1570                                     COMP-3.
  1571         16  FILLER                PIC X(09).
  1572***************    OUTPUT FROM ELRTRM   *************************
  1573
  1574         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1575                                     COMP-3.
  1576         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1581                                     COMP-3.
  1582         16  FILLER                PIC X(12).
  1583
  1584***************    OUTPUT FROM ELRAMT   *************************
  1585
  1586         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1587                                     COMP-3.
  1588         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1589                                     COMP-3.
  1590         16  FILLER                PIC X(12).
  1591
  1592***************    OUTPUT FROM ELRATE   *************************
  1593
  1594         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1597                                     COMP-3.
  1598         16  CP-MORTALITY-CODE     PIC X(4).
  1599         16  CP-RATE-EDIT-FLAG     PIC X.
  1600             88  CP-RATES-NEED-APR                  VALUE '1'.
  1601         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1604         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  31
* EL156.cbl
  1605         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1606                                   PIC S9(7)V99 COMP-3.
  1607         16  FILLER                PIC X(07).
  1608
  1609***************    OUTPUT FROM ELRFND   *************************
  1610
  1611         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1612                                     COMP-3.
  1613         16  CP-REFUND-TYPE-USED   PIC X.
  1614           88  CP-R-AS-R78                         VALUE '1'.
  1615           88  CP-R-AS-PRORATA                     VALUE '2'.
  1616           88  CP-R-AS-CALIF                       VALUE '3'.
  1617           88  CP-R-AS-TEXAS                       VALUE '4'.
  1618           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1619           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1620           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1621           88  CP-R-AS-MEAN                        VALUE '8'.
  1622           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1623           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1624           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1625           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1626           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1627           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1628         16  FILLER                PIC X(12).
  1629
  1630***************    OUTPUT FROM ELEARN   *************************
  1631
  1632         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-EARNING-TYPE-USED  PIC X.
  1645           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1646           88  CP-E-AS-R78                         VALUE '1'.
  1647           88  CP-E-AS-PRORATA                     VALUE '2'.
  1648           88  CP-E-AS-TEXAS                       VALUE '4'.
  1649           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1650           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1651           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1652           88  CP-E-AS-MEAN                        VALUE '8'.
  1653           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1654         16  FILLER                PIC X(12).
  1655
  1656***************    OUTPUT FROM ELPMNT   *************************
  1657
  1658         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1661                                     COMP-3.
  1662         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  32
* EL156.cbl
  1663
  1664***************   MISC WORK AREAS    *****************************
  1665         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1666                                     COMP-3.
  1667         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1668                                     COMP-3.
  1669         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1670                                     COMP-3.
  1671         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1678             88  OPEN-RATE-FILE                   VALUE 'O'.
  1679             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1680             88  IO-ERROR                         VALUE 'E'.
  1681
  1682         16  CP-FIRST-PAY-DATE     PIC XX.
  1683
  1684         16  CP-JOINT-INDICATOR    PIC X.
  1685
  1686         16  CP-RESERVE-REMAINING-TERM
  1687                                   PIC S9(4)V9    VALUE ZERO
  1688                                     COMP-3.
  1689
  1690         16  CP-INSURED-BIRTH-DT   PIC XX.
  1691
  1692         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1693                                     COMP-3.
  1694
  1695         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1696                                     COMP-3.
  1697
  1698         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1699                                     COMP-3.
  1700
  1701         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1702                                     COMP-3.
  1703
  1704         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1705                                     COMP-3.
  1706
  1707         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1708                                     COMP-3.
  1709
  1710         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1711                                     COMP-3.
  1712
  1713         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1714             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1715
  1716         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1717                                     COMP-3.
  1718         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1719                                     COMP-3.
  1720         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  33
* EL156.cbl
  1721         16  cp-extra-periods      pic 9 value zeros.
  1722         16  cp-net-only-state     pic x value spaces.
  1723         16  FILLER                PIC X(13).
  1724******************************************************************
  1725*    COPY ELCICALC.
  1726******************************************************************
  1727*                                                                *
  1728*                           ELCCICALC.                           *
  1729*                            VMOD=2.001                          *
  1730*                                                                *
  1731*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1732*                 CALCULATION MODULE                             *
  1733*                                                                *
  1734*  PASSED TO ELCLMI                                              *
  1735*  -----------------                                             *
  1736*  STATE                                                         *
  1737*  PRODUCT                                                       *
  1738*  COVERAGE                                                      *
  1739*  EFFECTIVE DATE                                                *
  1740*  INCURRED DATE                                                 *
  1741*  ESTABLISHED DATE                                              *
  1742*  LAST PAID DATE                                                *
  1743*  REPORTED DATE                                                 *
  1744*  CLAIM PAYMENT AMOUNT                                          *
  1745*                                                                *
  1746*  RETURNED FROM ELRTRM                                          *
  1747*  ---------------------                                         *
  1748*  RETURN CODE                                                   *
  1749*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1750*  CLAIM INTEREST AMOUNT                                         *
  1751*----------------------------------------------------------------*
  1752*----------------------------------------------------------------*
  1753*                 LENGTH = 100                                   *
  1754*                                                                *
  1755******************************************************************
  1756******************************************************************
  1757*                   C H A N G E   L O G
  1758*
  1759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1760*-----------------------------------------------------------------
  1761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1762* EFFECTIVE    NUMBER
  1763*-----------------------------------------------------------------
  1764* 120905    2004040700004  PEMA  NEW COPYBOOK
  1765* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1766******************************************************************
  1767
  1768 01  CLAIM-INT-PASS-AREA.
  1769     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1770                                     COMP.
  1771
  1772     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1773       88  NO-CI-ERROR                             VALUE ZERO.
  1774       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1775       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1776       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1777       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1778       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  34
* EL156.cbl
  1779       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1780       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1781       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1782       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1783***********************  INPUT AREAS ****************************
  1784
  1785     12  CP-CALCULATION-AREA.
  1786         16  CP-COMPANY-CD         PIC X.
  1787         16  CP-STATE              PIC XX.
  1788         16  CP-PRODUCT            PIC XX.
  1789         16  CP-COVERAGE           PIC XX.
  1790         16  CP-INC-DT             PIC XX.
  1791         16  CP-EST-DT             PIC XX.
  1792         16  CP-LSTPD-DT           PIC XX.
  1793         16  CP-RPT-DT             PIC XX.
  1794         16  CP-PRF-DT             PIC XX.
  1795         16  CP-EFF-DT             PIC XX.
  1796         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1797         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1798         16  FILLER                PIC X(37).
  1799
  1800***************    OUTPUT FROM ELCLMI   ************************
  1801
  1802         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1803
  1804         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1805         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1806         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1807         16  FILLER                PIC X(19).
  1808******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  35
* EL156.cbl
  1810*    COPY ELCATTR.
  1811******************************************************************
  1812*                                                                *
  1813*                            ELCATTR.                            *
  1814*                            VMOD=2.001                          *
  1815*                                                                *
  1816*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1817*                                                                *
  1818*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1819*                                                                *
  1820*                   POS 1   P=PROTECTED                          *
  1821*                           U=UNPROTECTED                        *
  1822*                           S=ASKIP                              *
  1823*                   POS 2   A=ALPHA/NUMERIC                      *
  1824*                           N=NUMERIC                            *
  1825*                   POS 3   N=NORMAL                             *
  1826*                           B=BRIGHT                             *
  1827*                           D=DARK                               *
  1828*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1829*                           OF=MODIFIED DATA TAG OFF             *
  1830*                                                                *
  1831*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1832******************************************************************
  1833 01  ATTRIBUTE-LIST.
  1834     12  AL-PABOF            PIC X       VALUE 'Y'.
  1835     12  AL-PABON            PIC X       VALUE 'Z'.
  1836     12  AL-PADOF            PIC X       VALUE '%'.
  1837     12  AL-PADON            PIC X       VALUE '_'.
  1838     12  AL-PANOF            PIC X       VALUE '-'.
  1839     12  AL-PANON            PIC X       VALUE '/'.
  1840     12  AL-SABOF            PIC X       VALUE '8'.
  1841     12  AL-SABON            PIC X       VALUE '9'.
  1842     12  AL-SADOF            PIC X       VALUE '@'.
  1843     12  AL-SADON            PIC X       VALUE QUOTE.
  1844     12  AL-SANOF            PIC X       VALUE '0'.
  1845     12  AL-SANON            PIC X       VALUE '1'.
  1846     12  AL-UABOF            PIC X       VALUE 'H'.
  1847     12  AL-UABON            PIC X       VALUE 'I'.
  1848     12  AL-UADOF            PIC X       VALUE '<'.
  1849     12  AL-UADON            PIC X       VALUE '('.
  1850     12  AL-UANOF            PIC X       VALUE ' '.
  1851     12  AL-UANON            PIC X       VALUE 'A'.
  1852     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1853     12  AL-UNBON            PIC X       VALUE 'R'.
  1854     12  AL-UNDOF            PIC X       VALUE '*'.
  1855     12  AL-UNDON            PIC X       VALUE ')'.
  1856     12  AL-UNNOF            PIC X       VALUE '&'.
  1857     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  36
* EL156.cbl
  1859*    COPY ELCEMIB.
  1860******************************************************************
  1861*                                                                *
  1862*                                                                *
  1863*                            ELCEMIB.                            *
  1864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1865*                            VMOD=2.005                          *
  1866*                                                                *
  1867*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1868*                                                                *
  1869******************************************************************
  1870 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1871     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1872     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1873     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1874     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1875     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1876     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1877     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1878     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1879     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1880         88  EMI-NO-ERRORS                    VALUE '1'.
  1881         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1882         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1883     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1884         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1885     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1886         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1887         88  EMI-AREA1-FULL                   VALUE '2'.
  1888     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1889         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1890         88  EMI-AREA2-FULL                   VALUE '2'.
  1891     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1892         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1893         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1894         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1895         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1896         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1897     12  EMI-ERROR-LINES.
  1898         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1899         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1900         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1901         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1902             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1903                 24  EMI-ERR-NUM         PIC X(4).
  1904                 24  EMI-FILLER          PIC X.
  1905                 24  EMI-SEV             PIC X.
  1906                 24  FILLER              PIC X.
  1907             20  FILLER                  PIC X(02).
  1908     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1909         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1910             20  EMI-ERROR-NUMBER    PIC X(4).
  1911             20  EMI-FILL            PIC X.
  1912             20  EMI-SEVERITY        PIC X.
  1913             20  FILLER              PIC X.
  1914             20  EMI-ERROR-TEXT.
  1915                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1916                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  37
* EL156.cbl
  1917     12  EMI-SEVERITY-SAVE           PIC X.
  1918         88  EMI-NOTE                    VALUE 'N'.
  1919         88  EMI-WARNING                 VALUE 'W'.
  1920         88  EMI-FORCABLE                VALUE 'F'.
  1921         88  EMI-FATAL                   VALUE 'X'.
  1922     12  EMI-MESSAGE-FLAG            PIC X.
  1923         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1924         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1925     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1926     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1927         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1928         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1929         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1930     12  emi-claim-no                pic x(7).
  1931     12  emi-claim-type              pic x(6).
  1932     12  FILLER                      PIC X(124)  VALUE SPACES.
  1933     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1934     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1935     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1936     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  38
* EL156.cbl
  1938*    COPY ELCLNKLT.
  1939******************************************************************
  1940*                                                                *
  1941*                                                                *
  1942*                           ELCLNKLT                             *
  1943*                            VMOD=2.003                          *
  1944*                                                                *
  1945*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1946*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1947*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1948*                                                                *
  1949*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1950*   COMPLETING THE REQUIRED FIELDS.                              *
  1951*                                                                *
  1952*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1953*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1954*                              9999 INDICATES AN UNKNOWN ABEND   *
  1955*                                   WAS DETECTED.                *
  1956*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1957*                              CODES FOUND IN THE ERROR FILE.    *
  1958******************************************************************
  1959 01  W-1523-LINKDATA.
  1960     12  W-1523-COMMON-PI-DATA.
  1961         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1962         16  FILLER              PIC  X(67).
  1963         16  W-1523-COMPANY-CD   PIC  X(01).
  1964         16  FILLER              PIC  X(10).
  1965         16  W-1523-CONTROL-IN-PROGRESS.
  1966             20  W-1523-CARRIER  PIC  X(01).
  1967             20  W-1523-GROUPING PIC  X(06).
  1968             20  W-1523-STATE    PIC  X(02).
  1969             20  W-1523-ACCOUNT  PIC  X(10).
  1970             20  W-1523-CLAIM-CERT-GRP.
  1971                 24  W-1523-CLAIM-NO
  1972                                 PIC  X(07).
  1973                 24  W-1523-CERT-NO.
  1974                     28  W-1523-CERT-PRIME
  1975                                 PIC  X(10).
  1976                     28  W-1523-CERT-SFX
  1977                                 PIC  X(01).
  1978                 24  W-1523-CERT-EFF-DT
  1979                                 PIC  X(02).
  1980         16  FILLER              PIC X(265).
  1981
  1982     12  W-1523-WORK-AREA.
  1983         16  W-1523-FORM-NUMBER  PIC  X(04).
  1984         16  W-1523-NUMBER-COPIES
  1985                                 PIC  9(01).
  1986         16  W-1523-ADDR-TYPE    PIC  X(02).
  1987         16  W-1523-FOLLOW-UP-DATE
  1988                                 PIC  X(02).
  1989         16  W-1523-RESEND-DATE  PIC  X(02).
  1990         16  W-1523-ERROR-CODE   PIC  9(04).
  1991             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1992             88  W-1523-FATAL-ERROR
  1993                                    VALUES  0006 0013 0042
  1994                                            0154 0168 0169
  1995                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  39
* EL156.cbl
  1996                                            0179 0186 0281
  1997                                            0332 2055 3697
  1998                                            3698 3699 3770
  1999                                            3771 3772 7675
  2000                                            9106 9808 9883
  2001                                            9887.
  2002             88  W-1523-STOP-ERRORS
  2003                                    VALUES  0013 0042 0154
  2004                                            0168 0169 0172
  2005                                            0281 0332 2055
  2006                                            3698 3699 7675
  2007                                            9106 9808 9883
  2008                                            9999.
  2009         16  W-1523-REASON       PIC  X(70).
  2010         16  W-1523-ARCHIVE-NUMBER
  2011                                 PIC  9(08).
  2012     12  W-1523-POINTER-AREA.
  2013         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2014         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2015         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2016         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2017         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  40
* EL156.cbl
  2019*    COPY ELCNWA.
  2020*****************************************************************
  2021*                                                               *
  2022*                                                               *
  2023*                            ELCNWA.                            *
  2024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2025*                            VMOD=2.003                         *
  2026*                                                               *
  2027*            M O V E   N A M E   W O R K   A R E A.             *
  2028*                                                               *
  2029*****************************************************************.
  2030
  2031 01  WS-NAME-WORK-AREA.
  2032     05  WS-INSURED-LAST-NAME        PIC X(15).
  2033     05  WS-INSURED-1ST-NAME         PIC X(12).
  2034     05  WS-INSURED-MID-INIT         PIC X.
  2035
  2036     05  WS-NAME-WORK.
  2037         10  WS-NW                   PIC X
  2038             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2039
  2040     05  WS-NAME-WORK2.
  2041         10  WS-NW2                  PIC X
  2042             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2043                                        NWA-INDEX0.
  2044
  2045     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2046                                     COMP-3.
  2047
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  41
* EL156.cbl
  2049*    COPY ELCDMO.
  2050******************************************************************
  2051*                                                                *
  2052*                                                                *
  2053*                            ELCDMO.                             *
  2054*                            VMOD=2.004                          *
  2055*                                                                *
  2056*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2057*        COMMUNICATION AREA                                      *
  2058*   FILE TYPE = NA                                               *
  2059*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2060*                                                                *
  2061******************************************************************
  2062 01  DMO-COMMUNICATION-AREA.
  2063     12  DM-RECORD-TYPE                  PIC  X(02).
  2064             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2065             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2066             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2067     12  DM-DIST-CODE                    PIC  X(04).
  2068     12  DM-MAIL-CODE                    PIC  X(05).
  2069     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2070     12  DM-INSURED-NAME                 PIC  X(30).
  2071     12  DM-CLAIM-NO                     PIC  X(07).
  2072     12  DM-CLAIM-TYPE                   PIC  X.
  2073
  2074     12  DM-STATUS-DATA-AREA.
  2075         16  DM-CLAIM-STATUS             PIC  X.
  2076             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2077             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2078             88  DM-CLOSED                        VALUE '3'.
  2079             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2080             88  DM-DEFAULT                       VALUE '9'.
  2081         16  DM-STATUS-DATE              PIC  X(08).
  2082******YYYYMMDD
  2083         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2084             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2085             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2086             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2087             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2088             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2089             88  DM-RE-OPENED                     VALUE 'R'.
  2090             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2091             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2092             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2093         16  DM-STAT-CARRIER             PIC X.
  2094
  2095     12  DM-DRAFT-DATA-AREA.
  2096         16  DM-PAYMENT-TYPE             PIC  X.
  2097             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2098         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2099         16  DM-PAYMENT-DATE             PIC  X(08).
  2100******YYYYMMDD
  2101         16  DM-CERT-NO                  PIC  X(11).
  2102         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2103         16  DM-CARRIER                  PIC  X.
  2104
  2105     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  42
* EL156.cbl
  2107*    COPY ELCDMDCD.
  2108******************************************************************
  2109*                                                                *
  2110*                                                                *
  2111*                            ELCDMDCD.                           *
  2112*                            VMOD=2.001                          *
  2113*                                                                *
  2114*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2115*       COMMUNICATIONS AREA                                      *
  2116*                                                                *
  2117******************************************************************
  2118 01  CD-COMMUNICATION-AREA.
  2119     12  CD-SYSTEM-ID            PIC  X(02).
  2120         88 CD-CLAIMS                      VALUE 'CL'.
  2121         88 CD-CREDIT                      VALUE 'CR'.
  2122     12  CD-RECORD-TYPE          PIC  X(02).
  2123         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2124         88 CD-EOB-CODE                    VALUE 'EO'.
  2125         88 CD-ICD9-CODE                   VALUE 'I9'.
  2126         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2127         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2128         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2129         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2130         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2131     12  CD-RECORD-KEY           PIC  X(06).
  2132         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2133     12  CD-RETURN-CODE          PIC  X(02).
  2134     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2135     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2136     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2137     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  43
* EL156.cbl
  2139*    COPY ELCDCTB.
  2140******************************************************************
  2141*                                                                *
  2142*                                                                *
  2143*                            ELCDCTB.                            *
  2144*                            VMOD=2.002                          *
  2145*                                                                *
  2146*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2147*       COMMUNICATIONS AREA                                      *
  2148*                                                                *
  2149******************************************************************
  2150 01  DCT-COMMUNICATION-AREA.
  2151     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2152     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2153     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2154     12  DCT-PRODUCT-CODE         PIC  X(02).
  2155     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2156     12  DCT-RETURN-CODE          PIC  X(02).
  2157     12  DCT-MAIL-CODE            PIC  X(05).
  2158     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2159     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  44
* EL156.cbl
  2161 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2162 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2163 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2164 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  45
* EL156.cbl
  2166*    COPY ELCINTF.
  2167******************************************************************
  2168*                                                                *
  2169*                                                                *
  2170*                            ELCINTF.                            *
  2171*                            VMOD=2.017                          *
  2172*                                                                *
  2173*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2174*                                                                *
  2175*       LENGTH = 1024                                            *
  2176*                                                                *
  2177******************************************************************
  2178*                   C H A N G E   L O G
  2179*
  2180* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2181*-----------------------------------------------------------------
  2182*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2183* EFFECTIVE    NUMBER
  2184*-----------------------------------------------------------------
  2185* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2186******************************************************************
  2187 01  PROGRAM-INTERFACE-BLOCK.
  2188     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2189     12  PI-CALLING-PROGRAM              PIC X(8).
  2190     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2191     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2192     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2193     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2194     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2195     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2196     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2197     12  PI-COMPANY-ID                   PIC XXX.
  2198     12  PI-COMPANY-CD                   PIC X.
  2199
  2200     12  PI-COMPANY-PASSWORD             PIC X(8).
  2201
  2202     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2203
  2204     12  PI-CONTROL-IN-PROGRESS.
  2205         16  PI-CARRIER                  PIC X.
  2206         16  PI-GROUPING                 PIC X(6).
  2207         16  PI-STATE                    PIC XX.
  2208         16  PI-ACCOUNT                  PIC X(10).
  2209         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2210                                         PIC X(10).
  2211         16  PI-CLAIM-CERT-GRP.
  2212             20  PI-CLAIM-NO             PIC X(7).
  2213             20  PI-CERT-NO.
  2214                 25  PI-CERT-PRIME       PIC X(10).
  2215                 25  PI-CERT-SFX         PIC X.
  2216             20  PI-CERT-EFF-DT          PIC XX.
  2217         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2218             20  PI-PLAN-CODE            PIC X(2).
  2219             20  PI-REVISION-NUMBER      PIC X(3).
  2220             20  PI-PLAN-EFF-DT          PIC X(2).
  2221             20  PI-PLAN-EXP-DT          PIC X(2).
  2222             20  FILLER                  PIC X(11).
  2223         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  46
* EL156.cbl
  2224             20  PI-OE-REFERENCE-1.
  2225                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2226                 25  PI-OE-REF-1-SUFF    PIC XX.
  2227
  2228     12  PI-SESSION-IN-PROGRESS          PIC X.
  2229         88  CLAIM-SESSION                   VALUE '1'.
  2230         88  CREDIT-SESSION                  VALUE '2'.
  2231         88  WARRANTY-SESSION                VALUE '3'.
  2232         88  MORTGAGE-SESSION                VALUE '4'.
  2233         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2234
  2235
  2236*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2237
  2238     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2239     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2240
  2241     12  PI-CREDIT-USER                  PIC X.
  2242         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2243         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2244
  2245     12  PI-CLAIM-USER                   PIC X.
  2246         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2247         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2248
  2249     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2250         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2251         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2252         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2253         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2254         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2255
  2256     12  PI-PROCESSOR-ID                 PIC X(4).
  2257
  2258     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2259
  2260     12  PI-MEMBER-CAPTION               PIC X(10).
  2261
  2262     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2263         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2264
  2265     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2266     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2267     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2268     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2269
  2270     12  PI-AH-OVERRIDE-L1               PIC X.
  2271     12  PI-AH-OVERRIDE-L2               PIC XX.
  2272     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2273     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2274
  2275     12  PI-NEW-SYSTEM                   PIC X(2).
  2276
  2277     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2278     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2279         88  PI-USES-PAID-TO                 VALUE '1'.
  2280     12  PI-CRDTCRD-SYSTEM.
  2281         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  47
* EL156.cbl
  2282             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2283             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2284         16  PI-CC-MONTH-END-DT          PIC XX.
  2285     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2286
  2287     12  PI-OE-REFERENCE-2.
  2288         16  PI-OE-REF-2-PRIME           PIC X(10).
  2289         16  PI-OE-REF-2-SUFF            PIC X.
  2290
  2291     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2292
  2293     12  PI-LANGUAGE-TYPE                PIC X.
  2294             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2295             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2296             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2297
  2298     12  PI-POLICY-LINKAGE-IND           PIC X.
  2299         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2300         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2301                                                   LOW-VALUES.
  2302
  2303     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2304     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2305         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2306         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2307
  2308     12  PI-PROCESSOR-CSR-IND            PIC X.
  2309         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2310         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2311
  2312     12  FILLER                          PIC X(3).
  2313
  2314     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2315
  2316     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2317         PI-SYSTEM-LEVEL.
  2318
  2319         16  PI-ENTRY-CODES.
  2320             20  PI-ENTRY-CD-1           PIC X.
  2321             20  PI-ENTRY-CD-2           PIC X.
  2322
  2323         16  PI-RETURN-CODES.
  2324             20  PI-RETURN-CD-1          PIC X.
  2325             20  PI-RETURN-CD-2          PIC X.
  2326
  2327         16  PI-UPDATE-STATUS-SAVE.
  2328             20  PI-UPDATE-BY            PIC X(4).
  2329             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2330
  2331         16  PI-LOWER-CASE-LETTERS       PIC X.
  2332             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2333
  2334*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2335*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2336*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2337
  2338         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2339             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  48
* EL156.cbl
  2340             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2341             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2342             88  ACCNT-CNTL                  VALUE '3'.
  2343             88  CARR-ACCNT-CNTL             VALUE '4'.
  2344
  2345         16  PI-PROCESSOR-CAP-LIST.
  2346             20  PI-SYSTEM-CONTROLS.
  2347                24 PI-SYSTEM-DISPLAY     PIC X.
  2348                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2349                24 PI-SYSTEM-MODIFY      PIC X.
  2350                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2351             20  FILLER                  PIC XX.
  2352             20  PI-DISPLAY-CAP          PIC X.
  2353                 88  DISPLAY-CAP             VALUE 'Y'.
  2354             20  PI-MODIFY-CAP           PIC X.
  2355                 88  MODIFY-CAP              VALUE 'Y'.
  2356             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2357                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2358             20  PI-FORCE-CAP            PIC X.
  2359                 88  FORCE-CAP               VALUE 'Y'.
  2360
  2361         16  PI-PROGRAM-CONTROLS.
  2362             20  PI-PGM-PRINT-OPT        PIC X.
  2363             20  PI-PGM-FORMAT-OPT       PIC X.
  2364             20  PI-PGM-PROCESS-OPT      PIC X.
  2365             20  PI-PGM-TOTALS-OPT       PIC X.
  2366
  2367         16  PI-HELP-INTERFACE.
  2368             20  PI-LAST-ERROR-NO        PIC X(4).
  2369             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2370
  2371         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2372             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2373
  2374         16  PI-CR-CONTROL-IN-PROGRESS.
  2375             20  PI-CR-CARRIER           PIC X.
  2376             20  PI-CR-GROUPING          PIC X(6).
  2377             20  PI-CR-STATE             PIC XX.
  2378             20  PI-CR-ACCOUNT           PIC X(10).
  2379             20  PI-CR-FIN-RESP          PIC X(10).
  2380             20  PI-CR-TYPE              PIC X.
  2381
  2382         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2383
  2384         16  PI-CR-MONTH-END-DT          PIC XX.
  2385
  2386         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2387             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2388             88  PI-ZERO-CARRIER             VALUE '1'.
  2389             88  PI-ZERO-GROUPING            VALUE '2'.
  2390             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2391
  2392         16  PI-CARRIER-SECURITY         PIC X.
  2393             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2394
  2395         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2396             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2397             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  49
* EL156.cbl
  2398
  2399         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2400             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2401                                         INDEXED BY PI-ACCESS-NDX
  2402                                         PIC X.
  2403
  2404         16  PI-GA-BILLING-CONTROL       PIC X.
  2405             88  PI-GA-BILLING               VALUE '1'.
  2406
  2407         16  PI-MAIL-PROCESSING          PIC X.
  2408             88  PI-MAIL-YES                 VALUE 'Y'.
  2409
  2410         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2411
  2412         16  PI-AR-SYSTEM.
  2413             20  PI-AR-PROCESSING-CNTL   PIC X.
  2414                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2415             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2416             20  PI-AR-MONTH-END-DT      PIC XX.
  2417
  2418         16  PI-MP-SYSTEM.
  2419             20  PI-MORTGAGE-USER            PIC X.
  2420                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2421                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2422             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2423                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2424                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2425                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2426                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2427                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2428             20  PI-MP-MONTH-END-DT          PIC XX.
  2429             20  PI-MP-REFERENCE-NO.
  2430                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2431                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2432
  2433         16  PI-LABEL-CONTROL            PIC X(01).
  2434             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2435             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2436
  2437         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2438             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2439
  2440         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2441             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2442             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2443
  2444         16  FILLER                      PIC X(14).
  2445
  2446     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2447******************************************************************
  2448     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2449         16  PI-SAVE-FORM        PIC X(12).
  2450         16  PI-ACCT-KEY         PIC X(26).
  2451         16  PI-PAYEE-NAME       PIC X(30).
  2452         16  PI-DAILY-RATE       PIC S9(3)V99.
  2453         16  PI-MONTH-END-SAVE   PIC XX.
  2454         16  PI-BENEFIT-SAVE.
  2455             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  50
* EL156.cbl
  2456             20  PI-BEN-TYPE     PIC X.
  2457         16  PI-MANUAL-SW        PIC 9.
  2458         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2459         16  PI-PASS-SW          PIC X.
  2460         16  PI-PFKEY-USED       PIC X.
  2461         16  PI-CK-ASSIGN        PIC X.
  2462         16  PI-FATAL-COUNT      PIC 99.
  2463         16  PI-FORCE-COUNT      PIC 99.
  2464         16  PI-SAVE-INPUT.
  2465             20  PI-PMTTYPE      PIC X.
  2466             20  PI-PAYEE.
  2467                 24  PI-PAYEE-TYPE PIC X.
  2468                 24  PI-PAYEE-SEQ  PIC X.
  2469                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2470                   PI-PAYEE-SEQ    PIC S9.
  2471             20  PI-PMTNOTE1     PIC X(60).
  2472             20  PI-PMTNOTE2     PIC X(60).
  2473             20  PI-OFFLINE      PIC X.
  2474             20  PI-ECHECKNO     PIC X(7).
  2475             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2476                 28  PI-ECHECKNO-N     PIC X.
  2477                 28  PI-ECHECKNO-6     PIC X(6).
  2478             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2479                 24  PI-ECHECKNO-CR    PIC XX.
  2480                 24  PI-ECHECKNO-5     PIC X(5).
  2481             20  PI-HOLDTIL      PIC 9(6).
  2482             20  PI-EPYFROM      PIC 9(6).
  2483             20  PI-EPYTHRU      PIC 9(6).
  2484             20  PI-EDAYS        PIC S9(5).
  2485             20  PI-EPYAMT       PIC S9(7)V99.
  2486             20  PI-ERESV        PIC S9(7)V99.
  2487             20  PI-EEXPENS      PIC 9(6)V99.
  2488             20  PI-ETYPE        PIC X.
  2489             20  PI-CASH         PIC X.
  2490             20  PI-GROUPED      PIC X.
  2491             20  PI-INT-RATE     PIC S99V9(5).
  2492             20  PI-AIGFROM      PIC 9(6).
  2493             20  PI-LOAN-NO      PIC X(20).
  2494             20  PI-PROOF-DATE   PIC 9(6).
  2495             20  PI-PRINT-EOB-YN PIC X.
  2496             20  PI-PRINT-CLM-FRM-YN PIC X.
  2497             20  PI-PRINT-SURVEY-YN PIC X.
  2498             20  PI-SPECIAL-RELEASE-YN PIC X.
  2499             20  pi-int-to-rem-borr pic x.
  2500         16  PI-SAVE-COMPUTED.
  2501             20  PI-CCHECKNO     PIC X(7).
  2502             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2503                 28  PI-CCHECKNO-N     PIC X.
  2504                 28  PI-CCHECKNO-6     PIC X(6).
  2505             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2506                 24  PI-CCHECKNO-CR    PIC XX.
  2507                 24  PI-CCHECKNO-5     PIC X(5).
  2508             20  PI-CPYFROM      PIC XX.
  2509             20  PI-CPYTHRU      PIC XX.
  2510             20  PI-CDAYS        PIC S9(5).
  2511             20  PI-CPYAMT       PIC S9(7)V99.
  2512             20  PI-CRESV        PIC 9(6)V99.
  2513             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  51
* EL156.cbl
  2514             20  PI-PMT-APPR-SW  PIC X.
  2515                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2516                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2517                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2518         16  PI-PREV-CLMNO       PIC X(7).
  2519         16  PI-LF-COVERAGE-TYPE PIC X.
  2520         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2521         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2522         16  PI-PROVISIONAL-IND  PIC X.
  2523             88 PI-PROV-PMT      VALUE 'P'.
  2524         16  PI-PREV-TRLR-KEY    PIC X(22).
  2525         16  PI-SPLIT-PMT-SW     PIC X.
  2526         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2527         16  PI-ACTIVITY-CODE    PIC 99.
  2528         16  PI-RESET-SW         PIC X.
  2529         16  PI-SPECIAL-BEN-SW   PIC X.
  2530             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2531         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2532         16  PI-EXP-DT           PIC XX.
  2533         16  PI-LOAN-DUE-DAY     PIC 99.
  2534         16  PI-3RD-PARTY-SW     PIC X.
  2535         16  PI-LOAN-UPDATE-SW   PIC X.
  2536
  2537         16  PI-DMD-DATA.
  2538             20  PI-SV-CERT-KEY       PIC X(21).
  2539             20  PI-SV-CERT-NO        PIC X(11).
  2540             20  PI-SV-BEN            PIC X(10).
  2541             20  PI-SV-CCN            PIC X(16).
  2542             20  PI-INTEREST-PAID-IND PIC X.
  2543                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2544             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2545             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2546             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2547             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2548         16  PI-AT-EOB-CODES.
  2549             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2550         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2551         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2552         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2553         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2554         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2555         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2556         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2557         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2558         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2559         16  PI-LF-BENEFIT-CD         PIC X(2).
  2560         16  PI-EOB-CODES-EXIST PIC X.
  2561         16  PI-SET-NOTE2-MDT   PIC X.
  2562         16  PI-VFY-2ND-BENE          PIC X.
  2563         16  PI-CLM-TYPE              PIC X.
  2564         16  PI-APPROVAL-LEVEL        PIC X.
  2565         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2566         16  PI-REAUDIT-NEEDED        PIC X.
  2567         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2568         16  PI-AH-BENEFIT-CD         PIC XX.
  2569         16  pi-ah-term               pic s999 comp-3.
  2570         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2571         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  52
* EL156.cbl
  2572         16  pi-max-ext-used          pic x.
  2573         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2574         16  PI-JOINT-COV-IND         PIC X.
  2575             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2576             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2577         16  PI-JOINT-INSURED-IND     PIC X.
  2578             88  PI-JOINT-INSURED        VALUE 'Y'.
  2579             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2580         16  pi-int-payees-name       pic x(30).
  2581         16  PI-RB-JOINT-COV-IND      PIC X.
  2582             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2583             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2584         16  pi-ach-payment           pic x.
  2585*00781          16  FILLER                   PIC X(176).
  2586*052506         16  FILLER                   PIC X(161).
  2587*031808         16  FILLER                   PIC X(154).
  2588*091808         16  FILLER                   PIC X(152).
  2589*041710         16  FILLER                   PIC X(94).
  2590         16  FILLER                   PIC X(34).
  2591
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  53
* EL156.cbl
  2593*    COPY ELCJPFX.
  2594******************************************************************
  2595*                                                                *
  2596*                                                                *
  2597*                            ELCJPFX.                            *
  2598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2599*                            VMOD=2.002                          *
  2600*                                                                *
  2601*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2602*                                                                *
  2603*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2604*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2605*        ELCNTL - CONTROL FILE                                   *
  2606*        ELMSTR - CLAIM MASTERS                                  *
  2607*        ELTRLR - ACTIVITY TRAILERS                              *
  2608*        ELCHKQ - CHECK QUE                                      *
  2609******************************************************************
  2610 01  JOURNAL-RECORD.
  2611     12  jp-date                     pic s9(5) comp-3.
  2612     12  jp-time                     pic s9(7) comp-3.
  2613     12  JP-USER-ID                  PIC X(4).
  2614     12  JP-FILE-ID                  PIC X(8).
  2615     12  JP-PROGRAM-ID               PIC X(8).
  2616     12  JP-RECORD-TYPE              PIC X.
  2617         88 JP-ADD              VALUE 'A'.
  2618         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2619         88 JP-AFTER-CHANGE     VALUE 'C'.
  2620         88 JP-DELETE           VALUE 'D'.
  2621         88 JP-GENERIC-DELETE   VALUE 'G'.
  2622         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2623         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2624     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2625     12  JP-RECORD-AREA
  2626
  2627
  2628                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  54
* EL156.cbl
  2630*    COPY ELCAID.
  2631******************************************************************
  2632*                                                                *
  2633*                            ELCAID.                             *
  2634*                            VMOD=2.001                          *
  2635*                                                                *
  2636*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2637*                                                                *
  2638*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2639*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2640******************************************************************
  2641
  2642 01  DFHAID.
  2643   02  DFHNULL   PIC  X  VALUE  ' '.
  2644   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2645   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2646   02  DFHPEN    PIC  X  VALUE  '='.
  2647   02  DFHOPID   PIC  X  VALUE  'W'.
  2648   02  DFHPA1    PIC  X  VALUE  '%'.
  2649   02  DFHPA2    PIC  X  VALUE  '>'.
  2650   02  DFHPA3    PIC  X  VALUE  ','.
  2651   02  DFHPF1    PIC  X  VALUE  '1'.
  2652   02  DFHPF2    PIC  X  VALUE  '2'.
  2653   02  DFHPF3    PIC  X  VALUE  '3'.
  2654   02  DFHPF4    PIC  X  VALUE  '4'.
  2655   02  DFHPF5    PIC  X  VALUE  '5'.
  2656   02  DFHPF6    PIC  X  VALUE  '6'.
  2657   02  DFHPF7    PIC  X  VALUE  '7'.
  2658   02  DFHPF8    PIC  X  VALUE  '8'.
  2659   02  DFHPF9    PIC  X  VALUE  '9'.
  2660   02  DFHPF10   PIC  X  VALUE  ':'.
  2661   02  DFHPF11   PIC  X  VALUE  '#'.
  2662   02  DFHPF12   PIC  X  VALUE  '@'.
  2663   02  DFHPF13   PIC  X  VALUE  'A'.
  2664   02  DFHPF14   PIC  X  VALUE  'B'.
  2665   02  DFHPF15   PIC  X  VALUE  'C'.
  2666   02  DFHPF16   PIC  X  VALUE  'D'.
  2667   02  DFHPF17   PIC  X  VALUE  'E'.
  2668   02  DFHPF18   PIC  X  VALUE  'F'.
  2669   02  DFHPF19   PIC  X  VALUE  'G'.
  2670   02  DFHPF20   PIC  X  VALUE  'H'.
  2671   02  DFHPF21   PIC  X  VALUE  'I'.
  2672*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2673   02  DFHPF22   PIC  X  VALUE  '['.
  2674   02  DFHPF23   PIC  X  VALUE  '.'.
  2675   02  DFHPF24   PIC  X  VALUE  '<'.
  2676   02  DFHMSRE   PIC  X  VALUE  'X'.
  2677   02  DFHSTRF   PIC  X  VALUE  'h'.
  2678   02  DFHTRIG   PIC  X  VALUE  '"'.
  2679 01  FILLER    REDEFINES DFHAID.
  2680     12  FILLER              PIC X(8).
  2681     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  55
* EL156.cbl
  2683*    COPY EL156S.
  2684 01  EL156AI.
  2685     05  FILLER            PIC  X(0012).
  2686*    -------------------------------
  2687     05  RUNDTEAL PIC S9(0004) COMP.
  2688     05  RUNDTEAF PIC  X(0001).
  2689     05  FILLER REDEFINES RUNDTEAF.
  2690         10  RUNDTEAA PIC  X(0001).
  2691     05  RUNDTEAI PIC  X(0008).
  2692*    -------------------------------
  2693     05  RUNTIMAL PIC S9(0004) COMP.
  2694     05  RUNTIMAF PIC  X(0001).
  2695     05  FILLER REDEFINES RUNTIMAF.
  2696         10  RUNTIMAA PIC  X(0001).
  2697     05  RUNTIMAI PIC  X(0005).
  2698*    -------------------------------
  2699     05  SEQUL PIC S9(0004) COMP.
  2700     05  SEQUF PIC  X(0001).
  2701     05  FILLER REDEFINES SEQUF.
  2702         10  SEQUA PIC  X(0001).
  2703     05  SEQUI PIC  X(0010).
  2704*    -------------------------------
  2705     05  CLMNOL PIC S9(0004) COMP.
  2706     05  CLMNOF PIC  X(0001).
  2707     05  FILLER REDEFINES CLMNOF.
  2708         10  CLMNOA PIC  X(0001).
  2709     05  CLMNOI PIC  X(0007).
  2710*    -------------------------------
  2711     05  CARRL PIC S9(0004) COMP.
  2712     05  CARRF PIC  X(0001).
  2713     05  FILLER REDEFINES CARRF.
  2714         10  CARRA PIC  X(0001).
  2715     05  CARRI PIC  X(0001).
  2716*    -------------------------------
  2717     05  CERTNOL PIC S9(0004) COMP.
  2718     05  CERTNOF PIC  X(0001).
  2719     05  FILLER REDEFINES CERTNOF.
  2720         10  CERTNOA PIC  X(0001).
  2721     05  CERTNOI PIC  X(0010).
  2722*    -------------------------------
  2723     05  SUFXL PIC S9(0004) COMP.
  2724     05  SUFXF PIC  X(0001).
  2725     05  FILLER REDEFINES SUFXF.
  2726         10  SUFXA PIC  X(0001).
  2727     05  SUFXI PIC  X(0001).
  2728*    -------------------------------
  2729     05  CLMTYPL PIC S9(0004) COMP.
  2730     05  CLMTYPF PIC  X(0001).
  2731     05  FILLER REDEFINES CLMTYPF.
  2732         10  CLMTYPA PIC  X(0001).
  2733     05  CLMTYPI PIC  X(0006).
  2734*    -------------------------------
  2735     05  CLMSTATL PIC S9(0004) COMP.
  2736     05  CLMSTATF PIC  X(0001).
  2737     05  FILLER REDEFINES CLMSTATF.
  2738         10  CLMSTATA PIC  X(0001).
  2739     05  CLMSTATI PIC  X(0006).
  2740*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  56
* EL156.cbl
  2741     05  LSTNMEL PIC S9(0004) COMP.
  2742     05  LSTNMEF PIC  X(0001).
  2743     05  FILLER REDEFINES LSTNMEF.
  2744         10  LSTNMEA PIC  X(0001).
  2745     05  LSTNMEI PIC  X(0015).
  2746*    -------------------------------
  2747     05  FSTNMEL PIC S9(0004) COMP.
  2748     05  FSTNMEF PIC  X(0001).
  2749     05  FILLER REDEFINES FSTNMEF.
  2750         10  FSTNMEA PIC  X(0001).
  2751     05  FSTNMEI PIC  X(0012).
  2752*    -------------------------------
  2753     05  MINITL PIC S9(0004) COMP.
  2754     05  MINITF PIC  X(0001).
  2755     05  FILLER REDEFINES MINITF.
  2756         10  MINITA PIC  X(0001).
  2757     05  MINITI PIC  X(0001).
  2758*    -------------------------------
  2759     05  PRIMHDGL PIC S9(0004) COMP.
  2760     05  PRIMHDGF PIC  X(0001).
  2761     05  FILLER REDEFINES PRIMHDGF.
  2762         10  PRIMHDGA PIC  X(0001).
  2763     05  PRIMHDGI PIC  X(0012).
  2764*    -------------------------------
  2765     05  PCERTNOL PIC S9(0004) COMP.
  2766     05  PCERTNOF PIC  X(0001).
  2767     05  FILLER REDEFINES PCERTNOF.
  2768         10  PCERTNOA PIC  X(0001).
  2769     05  PCERTNOI PIC  X(0010).
  2770*    -------------------------------
  2771     05  PSUFXL PIC S9(0004) COMP.
  2772     05  PSUFXF PIC  X(0001).
  2773     05  FILLER REDEFINES PSUFXF.
  2774         10  PSUFXA PIC  X(0001).
  2775     05  PSUFXI PIC  X(0001).
  2776*    -------------------------------
  2777     05  STATUSL PIC S9(0004) COMP.
  2778     05  STATUSF PIC  X(0001).
  2779     05  FILLER REDEFINES STATUSF.
  2780         10  STATUSA PIC  X(0001).
  2781     05  STATUSI PIC  X(0010).
  2782*    -------------------------------
  2783     05  LOANHL PIC S9(0004) COMP.
  2784     05  LOANHF PIC  X(0001).
  2785     05  FILLER REDEFINES LOANHF.
  2786         10  LOANHA PIC  X(0001).
  2787     05  LOANHI PIC  X(0014).
  2788*    -------------------------------
  2789     05  LOANNOL PIC S9(0004) COMP.
  2790     05  LOANNOF PIC  X(0001).
  2791     05  FILLER REDEFINES LOANNOF.
  2792         10  LOANNOA PIC  X(0001).
  2793     05  LOANNOI PIC  X(0025).
  2794*    -------------------------------
  2795     05  DUEDAYHL PIC S9(0004) COMP.
  2796     05  DUEDAYHF PIC  X(0001).
  2797     05  FILLER REDEFINES DUEDAYHF.
  2798         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  57
* EL156.cbl
  2799     05  DUEDAYHI PIC  X(0008).
  2800*    -------------------------------
  2801     05  DUEDAYL PIC S9(0004) COMP.
  2802     05  DUEDAYF PIC  X(0001).
  2803     05  FILLER REDEFINES DUEDAYF.
  2804         10  DUEDAYA PIC  X(0001).
  2805     05  DUEDAYI PIC  X(0002).
  2806*    -------------------------------
  2807     05  ZINTHL PIC S9(0004) COMP.
  2808     05  ZINTHF PIC  X(0001).
  2809     05  FILLER REDEFINES ZINTHF.
  2810         10  ZINTHA PIC  X(0001).
  2811     05  ZINTHI PIC  X(0009).
  2812*    -------------------------------
  2813     05  ZINTL PIC S9(0004) COMP.
  2814     05  ZINTF PIC  X(0001).
  2815     05  FILLER REDEFINES ZINTF.
  2816         10  ZINTA PIC  X(0001).
  2817     05  ZINTI PIC  99V99999.
  2818*    -------------------------------
  2819     05  PTHRHDGL PIC S9(0004) COMP.
  2820     05  PTHRHDGF PIC  X(0001).
  2821     05  FILLER REDEFINES PTHRHDGF.
  2822         10  PTHRHDGA PIC  X(0001).
  2823     05  PTHRHDGI PIC  X(0014).
  2824*    -------------------------------
  2825     05  PDTHRUL PIC S9(0004) COMP.
  2826     05  PDTHRUF PIC  X(0001).
  2827     05  FILLER REDEFINES PDTHRUF.
  2828         10  PDTHRUA PIC  X(0001).
  2829     05  PDTHRUI PIC  X(0008).
  2830*    -------------------------------
  2831     05  TOTPAIDL PIC S9(0004) COMP.
  2832     05  TOTPAIDF PIC  X(0001).
  2833     05  FILLER REDEFINES TOTPAIDF.
  2834         10  TOTPAIDA PIC  X(0001).
  2835     05  TOTPAIDI PIC  X(0010).
  2836*    -------------------------------
  2837     05  COVERL PIC S9(0004) COMP.
  2838     05  COVERF PIC  X(0001).
  2839     05  FILLER REDEFINES COVERF.
  2840         10  COVERA PIC  X(0001).
  2841     05  COVERI PIC  X(0010).
  2842*    -------------------------------
  2843     05  INCURL PIC S9(0004) COMP.
  2844     05  INCURF PIC  X(0001).
  2845     05  FILLER REDEFINES INCURF.
  2846         10  INCURA PIC  X(0001).
  2847     05  INCURI PIC  X(0008).
  2848*    -------------------------------
  2849     05  LSTDTEL PIC S9(0004) COMP.
  2850     05  LSTDTEF PIC  X(0001).
  2851     05  FILLER REDEFINES LSTDTEF.
  2852         10  LSTDTEA PIC  X(0001).
  2853     05  LSTDTEI PIC  X(0008).
  2854*    -------------------------------
  2855     05  CRTSTATL PIC S9(0004) COMP.
  2856     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  58
* EL156.cbl
  2857     05  FILLER REDEFINES CRTSTATF.
  2858         10  CRTSTATA PIC  X(0001).
  2859     05  CRTSTATI PIC  X(0010).
  2860*    -------------------------------
  2861     05  EFFECTL PIC S9(0004) COMP.
  2862     05  EFFECTF PIC  X(0001).
  2863     05  FILLER REDEFINES EFFECTF.
  2864         10  EFFECTA PIC  X(0001).
  2865     05  EFFECTI PIC  X(0008).
  2866*    -------------------------------
  2867     05  TERMSL PIC S9(0004) COMP.
  2868     05  TERMSF PIC  X(0001).
  2869     05  FILLER REDEFINES TERMSF.
  2870         10  TERMSA PIC  X(0001).
  2871     05  TERMSI PIC  X(0011).
  2872*    -------------------------------
  2873     05  STACCTL PIC S9(0004) COMP.
  2874     05  STACCTF PIC  X(0001).
  2875     05  FILLER REDEFINES STACCTF.
  2876         10  STACCTA PIC  X(0001).
  2877     05  STACCTI PIC  X(0013).
  2878*    -------------------------------
  2879     05  EXPDTEHL PIC S9(0004) COMP.
  2880     05  EXPDTEHF PIC  X(0001).
  2881     05  FILLER REDEFINES EXPDTEHF.
  2882         10  EXPDTEHA PIC  X(0001).
  2883     05  EXPDTEHI PIC  X(0014).
  2884*    -------------------------------
  2885     05  EXPDTEL PIC S9(0004) COMP.
  2886     05  EXPDTEF PIC  X(0001).
  2887     05  FILLER REDEFINES EXPDTEF.
  2888         10  EXPDTEA PIC  X(0001).
  2889     05  EXPDTEI PIC  X(0008).
  2890*    -------------------------------
  2891     05  BENECAPL PIC S9(0004) COMP.
  2892     05  BENECAPF PIC  X(0001).
  2893     05  FILLER REDEFINES BENECAPF.
  2894         10  BENECAPA PIC  X(0001).
  2895     05  BENECAPI PIC  X(0013).
  2896*    -------------------------------
  2897     05  BENEL PIC S9(0004) COMP.
  2898     05  BENEF PIC  X(0001).
  2899     05  FILLER REDEFINES BENEF.
  2900         10  BENEA PIC  X(0001).
  2901     05  BENEI PIC  X(0009).
  2902*    -------------------------------
  2903     05  FORMTYPL PIC S9(0004) COMP.
  2904     05  FORMTYPF PIC  X(0001).
  2905     05  FILLER REDEFINES FORMTYPF.
  2906         10  FORMTYPA PIC  X(0001).
  2907     05  FORMTYPI PIC  X(0001).
  2908*    -------------------------------
  2909     05  PMTTYPEL PIC S9(0004) COMP.
  2910     05  PMTTYPEF PIC  X(0001).
  2911     05  FILLER REDEFINES PMTTYPEF.
  2912         10  PMTTYPEA PIC  X(0001).
  2913     05  PMTTYPEI PIC  X(0001).
  2914*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  59
* EL156.cbl
  2915     05  PAYEEL PIC S9(0004) COMP.
  2916     05  PAYEEF PIC  X(0001).
  2917     05  FILLER REDEFINES PAYEEF.
  2918         10  PAYEEA PIC  X(0001).
  2919     05  PAYEEI PIC  X(0002).
  2920*    -------------------------------
  2921     05  CHECKNOL PIC S9(0004) COMP.
  2922     05  CHECKNOF PIC  X(0001).
  2923     05  FILLER REDEFINES CHECKNOF.
  2924         10  CHECKNOA PIC  X(0001).
  2925     05  CHECKNOI PIC  X(0007).
  2926*    -------------------------------
  2927     05  OFFLINEL PIC S9(0004) COMP.
  2928     05  OFFLINEF PIC  X(0001).
  2929     05  FILLER REDEFINES OFFLINEF.
  2930         10  OFFLINEA PIC  X(0001).
  2931     05  OFFLINEI PIC  X(0001).
  2932*    -------------------------------
  2933     05  HOLDTILL PIC S9(0004) COMP.
  2934     05  HOLDTILF PIC  X(0001).
  2935     05  FILLER REDEFINES HOLDTILF.
  2936         10  HOLDTILA PIC  X(0001).
  2937     05  HOLDTILI PIC  X(0008).
  2938*    -------------------------------
  2939     05  NOTE1L PIC S9(0004) COMP.
  2940     05  NOTE1F PIC  X(0001).
  2941     05  FILLER REDEFINES NOTE1F.
  2942         10  NOTE1A PIC  X(0001).
  2943     05  NOTE1I PIC  X(0060).
  2944*    -------------------------------
  2945     05  ITRB1L PIC S9(0004) COMP.
  2946     05  ITRB1F PIC  X(0001).
  2947     05  FILLER REDEFINES ITRB1F.
  2948         10  ITRB1A PIC  X(0001).
  2949     05  ITRB1I PIC  X(0008).
  2950*    -------------------------------
  2951     05  NOTE2L PIC S9(0004) COMP.
  2952     05  NOTE2F PIC  X(0001).
  2953     05  FILLER REDEFINES NOTE2F.
  2954         10  NOTE2A PIC  X(0001).
  2955     05  NOTE2I PIC  X(0060).
  2956*    -------------------------------
  2957     05  ITRB2L PIC S9(0004) COMP.
  2958     05  ITRB2F PIC  X(0001).
  2959     05  FILLER REDEFINES ITRB2F.
  2960         10  ITRB2A PIC  X(0001).
  2961     05  ITRB2I PIC  X(0010).
  2962*    -------------------------------
  2963     05  EOBYNL PIC S9(0004) COMP.
  2964     05  EOBYNF PIC  X(0001).
  2965     05  FILLER REDEFINES EOBYNF.
  2966         10  EOBYNA PIC  X(0001).
  2967     05  EOBYNI PIC  X(0001).
  2968*    -------------------------------
  2969     05  CLMFMYNL PIC S9(0004) COMP.
  2970     05  CLMFMYNF PIC  X(0001).
  2971     05  FILLER REDEFINES CLMFMYNF.
  2972         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  60
* EL156.cbl
  2973     05  CLMFMYNI PIC  X(0001).
  2974*    -------------------------------
  2975     05  SURVYYNL PIC S9(0004) COMP.
  2976     05  SURVYYNF PIC  X(0001).
  2977     05  FILLER REDEFINES SURVYYNF.
  2978         10  SURVYYNA PIC  X(0001).
  2979     05  SURVYYNI PIC  X(0001).
  2980*    -------------------------------
  2981     05  SPRELYNL PIC S9(0004) COMP.
  2982     05  SPRELYNF PIC  X(0001).
  2983     05  FILLER REDEFINES SPRELYNF.
  2984         10  SPRELYNA PIC  X(0001).
  2985     05  SPRELYNI PIC  X(0001).
  2986*    -------------------------------
  2987     05  PINTHL PIC S9(0004) COMP.
  2988     05  PINTHF PIC  X(0001).
  2989     05  FILLER REDEFINES PINTHF.
  2990         10  PINTHA PIC  X(0001).
  2991     05  PINTHI PIC  X(0004).
  2992*    -------------------------------
  2993     05  PINTL PIC S9(0004) COMP.
  2994     05  PINTF PIC  X(0001).
  2995     05  FILLER REDEFINES PINTF.
  2996         10  PINTA PIC  X(0001).
  2997     05  PINTI PIC  X(0008).
  2998*    -------------------------------
  2999     05  ITRBYNL PIC S9(0004) COMP.
  3000     05  ITRBYNF PIC  X(0001).
  3001     05  FILLER REDEFINES ITRBYNF.
  3002         10  ITRBYNA PIC  X(0001).
  3003     05  ITRBYNI PIC  X(0001).
  3004*    -------------------------------
  3005     05  PROOFDTL PIC S9(0004) COMP.
  3006     05  PROOFDTF PIC  X(0001).
  3007     05  FILLER REDEFINES PROOFDTF.
  3008         10  PROOFDTA PIC  X(0001).
  3009     05  PROOFDTI PIC  X(0008).
  3010*    -------------------------------
  3011     05  AIGFRMHL PIC S9(0004) COMP.
  3012     05  AIGFRMHF PIC  X(0001).
  3013     05  FILLER REDEFINES AIGFRMHF.
  3014         10  AIGFRMHA PIC  X(0001).
  3015     05  AIGFRMHI PIC  X(0012).
  3016*    -------------------------------
  3017     05  AIGFROML PIC S9(0004) COMP.
  3018     05  AIGFROMF PIC  X(0001).
  3019     05  FILLER REDEFINES AIGFROMF.
  3020         10  AIGFROMA PIC  X(0001).
  3021     05  AIGFROMI PIC  X(0008).
  3022*    -------------------------------
  3023     05  PMTHDGAL PIC S9(0004) COMP.
  3024     05  PMTHDGAF PIC  X(0001).
  3025     05  FILLER REDEFINES PMTHDGAF.
  3026         10  PMTHDGAA PIC  X(0001).
  3027     05  PMTHDGAI PIC  X(0066).
  3028*    -------------------------------
  3029     05  EPYFROML PIC S9(0004) COMP.
  3030     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  61
* EL156.cbl
  3031     05  FILLER REDEFINES EPYFROMF.
  3032         10  EPYFROMA PIC  X(0001).
  3033     05  EPYFROMI PIC  X(0008).
  3034*    -------------------------------
  3035     05  EPYTHRUL PIC S9(0004) COMP.
  3036     05  EPYTHRUF PIC  X(0001).
  3037     05  FILLER REDEFINES EPYTHRUF.
  3038         10  EPYTHRUA PIC  X(0001).
  3039     05  EPYTHRUI PIC  X(0008).
  3040*    -------------------------------
  3041     05  EDAYSL PIC S9(0004) COMP.
  3042     05  EDAYSF PIC  X(0001).
  3043     05  FILLER REDEFINES EDAYSF.
  3044         10  EDAYSA PIC  X(0001).
  3045     05  EDAYSI PIC  S9(6).
  3046*    -------------------------------
  3047     05  EPYAMTL PIC S9(0004) COMP.
  3048     05  EPYAMTF PIC  X(0001).
  3049     05  FILLER REDEFINES EPYAMTF.
  3050         10  EPYAMTA PIC  X(0001).
  3051     05  EPYAMTI PIC  S9(8)V99.
  3052*    -------------------------------
  3053     05  ERESVL PIC S9(0004) COMP.
  3054     05  ERESVF PIC  X(0001).
  3055     05  FILLER REDEFINES ERESVF.
  3056         10  ERESVA PIC  X(0001).
  3057     05  ERESVI PIC  S9(7)V99.
  3058*    -------------------------------
  3059     05  ETYPEL PIC S9(0004) COMP.
  3060     05  ETYPEF PIC  X(0001).
  3061     05  FILLER REDEFINES ETYPEF.
  3062         10  ETYPEA PIC  X(0001).
  3063     05  ETYPEI PIC  X(0001).
  3064*    -------------------------------
  3065     05  EEXPENSL PIC S9(0004) COMP.
  3066     05  EEXPENSF PIC  X(0001).
  3067     05  FILLER REDEFINES EEXPENSF.
  3068         10  EEXPENSA PIC  X(0001).
  3069     05  EEXPENSI PIC  9(6)V99.
  3070*    -------------------------------
  3071     05  CPYFROML PIC S9(0004) COMP.
  3072     05  CPYFROMF PIC  X(0001).
  3073     05  FILLER REDEFINES CPYFROMF.
  3074         10  CPYFROMA PIC  X(0001).
  3075     05  CPYFROMI PIC  X(0008).
  3076*    -------------------------------
  3077     05  CPYTHRUL PIC S9(0004) COMP.
  3078     05  CPYTHRUF PIC  X(0001).
  3079     05  FILLER REDEFINES CPYTHRUF.
  3080         10  CPYTHRUA PIC  X(0001).
  3081     05  CPYTHRUI PIC  X(0008).
  3082*    -------------------------------
  3083     05  CDAYSL PIC S9(0004) COMP.
  3084     05  CDAYSF PIC  X(0001).
  3085     05  FILLER REDEFINES CDAYSF.
  3086         10  CDAYSA PIC  X(0001).
  3087     05  CDAYSI PIC  9(6).
  3088*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  62
* EL156.cbl
  3089     05  CPYAMTL PIC S9(0004) COMP.
  3090     05  CPYAMTF PIC  X(0001).
  3091     05  FILLER REDEFINES CPYAMTF.
  3092         10  CPYAMTA PIC  X(0001).
  3093     05  CPYAMTI PIC  S9(8)V99.
  3094*    -------------------------------
  3095     05  CRESVL PIC S9(0004) COMP.
  3096     05  CRESVF PIC  X(0001).
  3097     05  FILLER REDEFINES CRESVF.
  3098         10  CRESVA PIC  X(0001).
  3099     05  CRESVI PIC  9(6)V99.
  3100*    -------------------------------
  3101     05  CEXPENSL PIC S9(0004) COMP.
  3102     05  CEXPENSF PIC  X(0001).
  3103     05  FILLER REDEFINES CEXPENSF.
  3104         10  CEXPENSA PIC  X(0001).
  3105     05  CEXPENSI PIC  9(6)V99.
  3106*    -------------------------------
  3107     05  ERRMSG0L PIC S9(0004) COMP.
  3108     05  ERRMSG0F PIC  X(0001).
  3109     05  FILLER REDEFINES ERRMSG0F.
  3110         10  ERRMSG0A PIC  X(0001).
  3111     05  ERRMSG0I PIC  X(0072).
  3112*    -------------------------------
  3113     05  ERRMSG1L PIC S9(0004) COMP.
  3114     05  ERRMSG1F PIC  X(0001).
  3115     05  FILLER REDEFINES ERRMSG1F.
  3116         10  ERRMSG1A PIC  X(0001).
  3117     05  ERRMSG1I PIC  X(0072).
  3118*    -------------------------------
  3119     05  ERRMSG2L PIC S9(0004) COMP.
  3120     05  ERRMSG2F PIC  X(0001).
  3121     05  FILLER REDEFINES ERRMSG2F.
  3122         10  ERRMSG2A PIC  X(0001).
  3123     05  ERRMSG2I PIC  X(0072).
  3124*    -------------------------------
  3125     05  ENTERPFL PIC S9(0004) COMP.
  3126     05  ENTERPFF PIC  X(0001).
  3127     05  FILLER REDEFINES ENTERPFF.
  3128         10  ENTERPFA PIC  X(0001).
  3129     05  ENTERPFI PIC  99.
  3130*    -------------------------------
  3131     05  PF6TITL PIC S9(0004) COMP.
  3132     05  PF6TITF PIC  X(0001).
  3133     05  FILLER REDEFINES PF6TITF.
  3134         10  PF6TITA PIC  X(0001).
  3135     05  PF6TITI PIC  X(0016).
  3136 01  EL156AO REDEFINES EL156AI.
  3137     05  FILLER            PIC  X(0012).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  RUNDTEAO PIC  X(0008).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  RUNTIMAO PIC  99.99.
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  63
* EL156.cbl
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  CLMNOO PIC  X(0007).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  CARRO PIC  X(0001).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  CERTNOO PIC  X(0010).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  SUFXO PIC  X(0001).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  CLMTYPO PIC  X(0006).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  CLMSTATO PIC  X(0006).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  LSTNMEO PIC  X(0015).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  FSTNMEO PIC  X(0012).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  MINITO PIC  X(0001).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  PRIMHDGO PIC  X(0012).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  PCERTNOO PIC  X(0010).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  PSUFXO PIC  X(0001).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  STATUSO PIC  X(0010).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  LOANHO PIC  X(0014).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  LOANNOO PIC  X(0025).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  DUEDAYHO PIC  X(0008).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  DUEDAYO PIC  X(0002).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  ZINTHO PIC  X(0009).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  ZINTO PIC  9.99999.
  3204*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  64
* EL156.cbl
  3205     05  FILLER            PIC  X(0003).
  3206     05  PTHRHDGO PIC  X(0014).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  PDTHRUO PIC  X(0008).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  TOTPAIDO PIC  Z(6).99-.
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  COVERO PIC  X(0010).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  INCURO PIC  X(0008).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  LSTDTEO PIC  X(0008).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  CRTSTATO PIC  X(0010).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  EFFECTO PIC  X(0008).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  TERMSO PIC  X(0011).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  STACCTO PIC  X(0013).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  EXPDTEHO PIC  X(0014).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  EXPDTEO PIC  X(0008).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  BENECAPO PIC  X(0013).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  BENEO PIC  Z(6).99.
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  FORMTYPO PIC  X(0001).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  PMTTYPEO PIC  X(0001).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  PAYEEO PIC  X(0002).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  CHECKNOO PIC  X(0007).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  OFFLINEO PIC  X(0001).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  65
* EL156.cbl
  3263     05  HOLDTILO PIC  99B99B99.
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  NOTE1O PIC  X(0060).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  ITRB1O PIC  X(0008).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  NOTE2O PIC  X(0060).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ITRB2O PIC  X(0010).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  EOBYNO PIC  X(0001).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  CLMFMYNO PIC  X(0001).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  SURVYYNO PIC  X(0001).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  SPRELYNO PIC  X(0001).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  PINTHO PIC  X(0004).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  PINTO PIC  Z,ZZ9.99.
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  ITRBYNO PIC  X(0001).
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  PROOFDTO PIC  99B99B99.
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  AIGFRMHO PIC  X(0012).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  AIGFROMO PIC  99B99B99.
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  PMTHDGAO PIC  X(0066).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  EPYFROMO PIC  99B99B99.
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  EPYTHRUO PIC  99B99B99.
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  EDAYSO PIC  Z(4)9-.
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  66
* EL156.cbl
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  ERESVO PIC  Z(5).99-.
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  ETYPEO PIC  X(0001).
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  EEXPENSO PIC  Z(5).99.
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  CPYFROMO PIC  99B99B99.
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  CPYTHRUO PIC  99B99B99.
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  CDAYSO PIC  Z(4)9-.
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  CPYAMTO PIC  Z(6).99-.
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  CRESVO PIC  Z(5).99.
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  CEXPENSO PIC  Z(5).99.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  ERRMSG0O PIC  X(0072).
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  ERRMSG1O PIC  X(0072).
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  ERRMSG2O PIC  X(0072).
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  ENTERPFO PIC  X(0002).
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  PF6TITO PIC  X(0016).
  3363*    -------------------------------
  3364 01  EL156BI REDEFINES EL156AI.
  3365     05  FILLER            PIC  X(0012).
  3366*    -------------------------------
  3367     05  RUNDTEBL PIC S9(0004) COMP.
  3368     05  RUNDTEBF PIC  X(0001).
  3369     05  FILLER REDEFINES RUNDTEBF.
  3370         10  RUNDTEBA PIC  X(0001).
  3371     05  RUNDTEBI PIC  X(0008).
  3372*    -------------------------------
  3373     05  RUNTIMBL PIC S9(0004) COMP.
  3374     05  RUNTIMBF PIC  X(0001).
  3375     05  FILLER REDEFINES RUNTIMBF.
  3376         10  RUNTIMBA PIC  X(0001).
  3377     05  RUNTIMBI PIC  X(0005).
  3378*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  67
* EL156.cbl
  3379     05  PAYDTBL PIC S9(0004) COMP.
  3380     05  PAYDTBF PIC  X(0001).
  3381     05  FILLER REDEFINES PAYDTBF.
  3382         10  PAYDTBA PIC  X(0001).
  3383     05  PAYDTBI PIC  X(0008).
  3384*    -------------------------------
  3385     05  PAYTYPBL PIC S9(0004) COMP.
  3386     05  PAYTYPBF PIC  X(0001).
  3387     05  FILLER REDEFINES PAYTYPBF.
  3388         10  PAYTYPBA PIC  X(0001).
  3389     05  PAYTYPBI PIC  X(0015).
  3390*    -------------------------------
  3391     05  PAYAMTBL PIC S9(0004) COMP.
  3392     05  PAYAMTBF PIC  X(0001).
  3393     05  FILLER REDEFINES PAYAMTBF.
  3394         10  PAYAMTBA PIC  X(0001).
  3395     05  PAYAMTBI PIC  X(0011).
  3396*    -------------------------------
  3397     05  LOANHBL PIC S9(0004) COMP.
  3398     05  LOANHBF PIC  X(0001).
  3399     05  FILLER REDEFINES LOANHBF.
  3400         10  LOANHBA PIC  X(0001).
  3401     05  LOANHBI PIC  X(0012).
  3402*    -------------------------------
  3403     05  LOANNBL PIC S9(0004) COMP.
  3404     05  LOANNBF PIC  X(0001).
  3405     05  FILLER REDEFINES LOANNBF.
  3406         10  LOANNBA PIC  X(0001).
  3407     05  LOANNBI PIC  X(0025).
  3408*    -------------------------------
  3409     05  CKNUMHDL PIC S9(0004) COMP.
  3410     05  CKNUMHDF PIC  X(0001).
  3411     05  FILLER REDEFINES CKNUMHDF.
  3412         10  CKNUMHDA PIC  X(0001).
  3413     05  CKNUMHDI PIC  X(0012).
  3414*    -------------------------------
  3415     05  CKNUMBL PIC S9(0004) COMP.
  3416     05  CKNUMBF PIC  X(0001).
  3417     05  FILLER REDEFINES CKNUMBF.
  3418         10  CKNUMBA PIC  X(0001).
  3419     05  CKNUMBI PIC  X(0007).
  3420*    -------------------------------
  3421     05  AGTHDGL PIC S9(0004) COMP.
  3422     05  AGTHDGF PIC  X(0001).
  3423     05  FILLER REDEFINES AGTHDGF.
  3424         10  AGTHDGA PIC  X(0001).
  3425     05  AGTHDGI PIC  X(0016).
  3426*    -------------------------------
  3427     05  NAMEBL PIC S9(0004) COMP.
  3428     05  NAMEBF PIC  X(0001).
  3429     05  FILLER REDEFINES NAMEBF.
  3430         10  NAMEBA PIC  X(0001).
  3431     05  NAMEBI PIC  X(0030).
  3432*    -------------------------------
  3433     05  NAMEB2L PIC S9(0004) COMP.
  3434     05  NAMEB2F PIC  X(0001).
  3435     05  FILLER REDEFINES NAMEB2F.
  3436         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  68
* EL156.cbl
  3437     05  NAMEB2I PIC  X(0030).
  3438*    -------------------------------
  3439     05  ADDR1BL PIC S9(0004) COMP.
  3440     05  ADDR1BF PIC  X(0001).
  3441     05  FILLER REDEFINES ADDR1BF.
  3442         10  ADDR1BA PIC  X(0001).
  3443     05  ADDR1BI PIC  X(0030).
  3444*    -------------------------------
  3445     05  ADDR1B2L PIC S9(0004) COMP.
  3446     05  ADDR1B2F PIC  X(0001).
  3447     05  FILLER REDEFINES ADDR1B2F.
  3448         10  ADDR1B2A PIC  X(0001).
  3449     05  ADDR1B2I PIC  X(0030).
  3450*    -------------------------------
  3451     05  ADDR2BL PIC S9(0004) COMP.
  3452     05  ADDR2BF PIC  X(0001).
  3453     05  FILLER REDEFINES ADDR2BF.
  3454         10  ADDR2BA PIC  X(0001).
  3455     05  ADDR2BI PIC  X(0030).
  3456*    -------------------------------
  3457     05  ADDR2B2L PIC S9(0004) COMP.
  3458     05  ADDR2B2F PIC  X(0001).
  3459     05  FILLER REDEFINES ADDR2B2F.
  3460         10  ADDR2B2A PIC  X(0001).
  3461     05  ADDR2B2I PIC  X(0030).
  3462*    -------------------------------
  3463     05  CITYSTBL PIC S9(0004) COMP.
  3464     05  CITYSTBF PIC  X(0001).
  3465     05  FILLER REDEFINES CITYSTBF.
  3466         10  CITYSTBA PIC  X(0001).
  3467     05  CITYSTBI PIC  X(0030).
  3468*    -------------------------------
  3469     05  CITYST2L PIC S9(0004) COMP.
  3470     05  CITYST2F PIC  X(0001).
  3471     05  FILLER REDEFINES CITYST2F.
  3472         10  CITYST2A PIC  X(0001).
  3473     05  CITYST2I PIC  X(0030).
  3474*    -------------------------------
  3475     05  ZIPBL PIC S9(0004) COMP.
  3476     05  ZIPBF PIC  X(0001).
  3477     05  FILLER REDEFINES ZIPBF.
  3478         10  ZIPBA PIC  X(0001).
  3479     05  ZIPBI PIC  X(0009).
  3480*    -------------------------------
  3481     05  ZIPB2L PIC S9(0004) COMP.
  3482     05  ZIPB2F PIC  X(0001).
  3483     05  FILLER REDEFINES ZIPB2F.
  3484         10  ZIPB2A PIC  X(0001).
  3485     05  ZIPB2I PIC  X(0009).
  3486*    -------------------------------
  3487     05  INTHDBL PIC S9(0004) COMP.
  3488     05  INTHDBF PIC  X(0001).
  3489     05  FILLER REDEFINES INTHDBF.
  3490         10  INTHDBA PIC  X(0001).
  3491     05  INTHDBI PIC  X(0012).
  3492*    -------------------------------
  3493     05  INTAMTBL PIC S9(0004) COMP.
  3494     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  69
* EL156.cbl
  3495     05  FILLER REDEFINES INTAMTBF.
  3496         10  INTAMTBA PIC  X(0001).
  3497     05  INTAMTBI PIC  X(0011).
  3498*    -------------------------------
  3499     05  PMTHDGBL PIC S9(0004) COMP.
  3500     05  PMTHDGBF PIC  X(0001).
  3501     05  FILLER REDEFINES PMTHDGBF.
  3502         10  PMTHDGBA PIC  X(0001).
  3503     05  PMTHDGBI PIC  X(0034).
  3504*    -------------------------------
  3505     05  CLMNOBL PIC S9(0004) COMP.
  3506     05  CLMNOBF PIC  X(0001).
  3507     05  FILLER REDEFINES CLMNOBF.
  3508         10  CLMNOBA PIC  X(0001).
  3509     05  CLMNOBI PIC  X(0007).
  3510*    -------------------------------
  3511     05  CARRBL PIC S9(0004) COMP.
  3512     05  CARRBF PIC  X(0001).
  3513     05  FILLER REDEFINES CARRBF.
  3514         10  CARRBA PIC  X(0001).
  3515     05  CARRBI PIC  X(0001).
  3516*    -------------------------------
  3517     05  CERTNOBL PIC S9(0004) COMP.
  3518     05  CERTNOBF PIC  X(0001).
  3519     05  FILLER REDEFINES CERTNOBF.
  3520         10  CERTNOBA PIC  X(0001).
  3521     05  CERTNOBI PIC  X(0010).
  3522*    -------------------------------
  3523     05  SUFXBL PIC S9(0004) COMP.
  3524     05  SUFXBF PIC  X(0001).
  3525     05  FILLER REDEFINES SUFXBF.
  3526         10  SUFXBA PIC  X(0001).
  3527     05  SUFXBI PIC  X(0001).
  3528*    -------------------------------
  3529     05  CLMTYPBL PIC S9(0004) COMP.
  3530     05  CLMTYPBF PIC  X(0001).
  3531     05  FILLER REDEFINES CLMTYPBF.
  3532         10  CLMTYPBA PIC  X(0001).
  3533     05  CLMTYPBI PIC  X(0006).
  3534*    -------------------------------
  3535     05  INCURBL PIC S9(0004) COMP.
  3536     05  INCURBF PIC  X(0001).
  3537     05  FILLER REDEFINES INCURBF.
  3538         10  INCURBA PIC  X(0001).
  3539     05  INCURBI PIC  X(0008).
  3540*    -------------------------------
  3541     05  PYFROMBL PIC S9(0004) COMP.
  3542     05  PYFROMBF PIC  X(0001).
  3543     05  FILLER REDEFINES PYFROMBF.
  3544         10  PYFROMBA PIC  X(0001).
  3545     05  PYFROMBI PIC  X(0008).
  3546*    -------------------------------
  3547     05  PYTHRUBL PIC S9(0004) COMP.
  3548     05  PYTHRUBF PIC  X(0001).
  3549     05  FILLER REDEFINES PYTHRUBF.
  3550         10  PYTHRUBA PIC  X(0001).
  3551     05  PYTHRUBI PIC  X(0008).
  3552*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  70
* EL156.cbl
  3553     05  DAYSBL PIC S9(0004) COMP.
  3554     05  DAYSBF PIC  X(0001).
  3555     05  FILLER REDEFINES DAYSBF.
  3556         10  DAYSBA PIC  X(0001).
  3557     05  DAYSBI PIC  X(0005).
  3558*    -------------------------------
  3559     05  BYBL PIC S9(0004) COMP.
  3560     05  BYBF PIC  X(0001).
  3561     05  FILLER REDEFINES BYBF.
  3562         10  BYBA PIC  X(0001).
  3563     05  BYBI PIC  X(0004).
  3564*    -------------------------------
  3565     05  PROOFDBL PIC S9(0004) COMP.
  3566     05  PROOFDBF PIC  X(0001).
  3567     05  FILLER REDEFINES PROOFDBF.
  3568         10  PROOFDBA PIC  X(0001).
  3569     05  PROOFDBI PIC  X(0008).
  3570*    -------------------------------
  3571     05  ACCTBL PIC S9(0004) COMP.
  3572     05  ACCTBF PIC  X(0001).
  3573     05  FILLER REDEFINES ACCTBF.
  3574         10  ACCTBA PIC  X(0001).
  3575     05  ACCTBI PIC  X(0010).
  3576*    -------------------------------
  3577     05  STATEBL PIC S9(0004) COMP.
  3578     05  STATEBF PIC  X(0001).
  3579     05  FILLER REDEFINES STATEBF.
  3580         10  STATEBA PIC  X(0001).
  3581     05  STATEBI PIC  X(0002).
  3582*    -------------------------------
  3583     05  GROUPBL PIC S9(0004) COMP.
  3584     05  GROUPBF PIC  X(0001).
  3585     05  FILLER REDEFINES GROUPBF.
  3586         10  GROUPBA PIC  X(0001).
  3587     05  GROUPBI PIC  X(0006).
  3588*    -------------------------------
  3589     05  ACARRBL PIC S9(0004) COMP.
  3590     05  ACARRBF PIC  X(0001).
  3591     05  FILLER REDEFINES ACARRBF.
  3592         10  ACARRBA PIC  X(0001).
  3593     05  ACARRBI PIC  X(0001).
  3594*    -------------------------------
  3595     05  ACCTNMBL PIC S9(0004) COMP.
  3596     05  ACCTNMBF PIC  X(0001).
  3597     05  FILLER REDEFINES ACCTNMBF.
  3598         10  ACCTNMBA PIC  X(0001).
  3599     05  ACCTNMBI PIC  X(0030).
  3600*    -------------------------------
  3601     05  UNDISBL PIC S9(0004) COMP.
  3602     05  UNDISBF PIC  X(0001).
  3603     05  FILLER REDEFINES UNDISBF.
  3604         10  UNDISBA PIC  X(0001).
  3605     05  UNDISBI PIC  X(0010).
  3606*    -------------------------------
  3607     05  RATEBL PIC S9(0004) COMP.
  3608     05  RATEBF PIC  X(0001).
  3609     05  FILLER REDEFINES RATEBF.
  3610         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  71
* EL156.cbl
  3611     05  RATEBI PIC  X(0006).
  3612*    -------------------------------
  3613     05  ERMSG1BL PIC S9(0004) COMP.
  3614     05  ERMSG1BF PIC  X(0001).
  3615     05  FILLER REDEFINES ERMSG1BF.
  3616         10  ERMSG1BA PIC  X(0001).
  3617     05  ERMSG1BI PIC  X(0072).
  3618*    -------------------------------
  3619     05  ENTPFBL PIC S9(0004) COMP.
  3620     05  ENTPFBF PIC  X(0001).
  3621     05  FILLER REDEFINES ENTPFBF.
  3622         10  ENTPFBA PIC  X(0001).
  3623     05  ENTPFBI PIC  99.
  3624 01  EL156BO REDEFINES EL156AI.
  3625     05  FILLER            PIC  X(0012).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  RUNDTEBO PIC  X(0008).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  RUNTIMBO PIC  99.99.
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  PAYDTBO PIC  99B99B99.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  PAYTYPBO PIC  X(0015).
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  LOANHBO PIC  X(0012).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  LOANNBO PIC  X(0025).
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  CKNUMHDO PIC  X(0012).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  CKNUMBO PIC  X(0007).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  AGTHDGO PIC  X(0016).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  NAMEBO PIC  X(0030).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  NAMEB2O PIC  X(0030).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  ADDR1BO PIC  X(0030).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  ADDR1B2O PIC  X(0030).
  3668*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  72
* EL156.cbl
  3669     05  FILLER            PIC  X(0003).
  3670     05  ADDR2BO PIC  X(0030).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  ADDR2B2O PIC  X(0030).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  CITYSTBO PIC  X(0030).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  CITYST2O PIC  X(0030).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  ZIPBO PIC  ZZZZ99999.
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  ZIPB2O PIC  ZZZZZZZZZ.
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  INTHDBO PIC  X(0012).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  PMTHDGBO PIC  X(0034).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  CLMNOBO PIC  X(0007).
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  CARRBO PIC  X(0001).
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  CERTNOBO PIC  X(0010).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  SUFXBO PIC  X(0001).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  CLMTYPBO PIC  X(0006).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  INCURBO PIC  X(0008).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  PYFROMBO PIC  99B99B99.
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  PYTHRUBO PIC  99B99B99.
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  DAYSBO PIC  X(0005).
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  BYBO PIC  X(0004).
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  73
* EL156.cbl
  3727     05  PROOFDBO PIC  99B99B99.
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  ACCTBO PIC  X(0010).
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
  3733     05  STATEBO PIC  X(0002).
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  GROUPBO PIC  X(0006).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  ACARRBO PIC  X(0001).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
  3742     05  ACCTNMBO PIC  X(0030).
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  UNDISBO PIC  ZZZ,Z99.99.
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  RATEBO PIC  ZZZ.99.
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  ERMSG1BO PIC  X(0072).
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  ENTPFBO PIC  X(0002).
  3755*    -------------------------------
  3756****************************************************************
  3757*
  3758* Copyright (c) 2007-2013 Dell Inc.
  3759* All rights reserved.
  3760*
  3761****************************************************************
  3762 01  DFHEIV.
  3763   02  DFHEIV0               PIC X(35).
  3764   02  DFHEIV1               PIC X(08).
  3765   02  DFHEIV2               PIC X(08).
  3766   02  DFHEIV3               PIC X(08).
  3767   02  DFHEIV4               PIC X(06).
  3768   02  DFHEIV5               PIC X(04).
  3769   02  DFHEIV6               PIC X(04).
  3770   02  DFHEIV7               PIC X(02).
  3771   02  DFHEIV8               PIC X(02).
  3772   02  DFHEIV9               PIC X(01).
  3773   02  DFHEIV10              PIC S9(7) COMP-3.
  3774   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3775   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3776   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3777   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3778   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3779   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3780   02  DFHEIV17              PIC X(04).
  3781   02  DFHEIV18              PIC X(04).
  3782   02  DFHEIV19              PIC X(04).
  3783   02  DFHEIV20              USAGE IS POINTER.
  3784   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  74
* EL156.cbl
  3785   02  DFHEIV22              USAGE IS POINTER.
  3786   02  DFHEIV23              USAGE IS POINTER.
  3787   02  DFHEIV24              USAGE IS POINTER.
  3788   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3789   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3790   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3791   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3792   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3793   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3794   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3796   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3797   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3798   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3799   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3800   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3801   02  FILLER                PIC X(02).
  3802   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3803   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3804   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3805   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3806   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3807   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3808   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3809 LINKAGE  SECTION.
  3810*****************************************************************
  3811*                                                               *
  3812* Copyright (c) 2007-2013 Dell Inc.                             *
  3813* All rights reserved.                                          *
  3814*                                                               *
  3815*****************************************************************
  3816 01  dfheiblk.
  3817     02  eibtime          pic s9(7) comp-3.
  3818     02  eibdate          pic s9(7) comp-3.
  3819     02  eibtrnid         pic x(4).
  3820     02  eibtaskn         pic s9(7) comp-3.
  3821     02  eibtrmid         pic x(4).
  3822     02  dfheigdi         pic s9(4) comp.
  3823     02  eibcposn         pic s9(4) comp.
  3824     02  eibcalen         pic s9(4) comp.
  3825     02  eibaid           pic x(1).
  3826     02  eibfiller1       pic x(1).
  3827     02  eibfn            pic x(2).
  3828     02  eibfiller2       pic x(2).
  3829     02  eibrcode         pic x(6).
  3830     02  eibfiller3       pic x(2).
  3831     02  eibds            pic x(8).
  3832     02  eibreqid         pic x(8).
  3833     02  eibrsrce         pic x(8).
  3834     02  eibsync          pic x(1).
  3835     02  eibfree          pic x(1).
  3836     02  eibrecv          pic x(1).
  3837     02  eibsend          pic x(1).
  3838     02  eibatt           pic x(1).
  3839     02  eibeoc           pic x(1).
  3840     02  eibfmh           pic x(1).
  3841     02  eibcompl         pic x(1).
  3842     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  75
* EL156.cbl
  3843     02  eibconf          pic x(1).
  3844     02  eiberr           pic x(1).
  3845     02  eibrldbk         pic x(1).
  3846     02  eiberrcd         pic x(4).
  3847     02  eibsynrb         pic x(1).
  3848     02  eibnodat         pic x(1).
  3849     02  eibfiller5       pic x(2).
  3850     02  eibresp          pic s9(8) comp.
  3851     02  eibresp2         pic s9(8) comp.
  3852     02  dfheigdj         pic s9(4) comp.
  3853     02  dfheigdk         pic s9(4) comp.
  3854 01  DFHCOMMAREA             PIC X(1024).
  3855
  3856*    COPY ELCMSTR.
  3857******************************************************************
  3858*                                                                *
  3859*                            ELCMSTR.                            *
  3860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3861*                            VMOD=2.012                          *
  3862*                                                                *
  3863*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3864*                                                                *
  3865*   FILE TYPE = VSAM,KSDS                                        *
  3866*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3867*                                                                *
  3868*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3869*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3870*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3871*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3872*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3873*                                                 RKP=75,LEN=21  *
  3874*                                                                *
  3875*   **** NOTE ****                                               *
  3876*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3877*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3878*                                                                *
  3879*   LOG = YES                                                    *
  3880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3881******************************************************************
  3882*                   C H A N G E   L O G
  3883*
  3884* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3885*-----------------------------------------------------------------
  3886*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3887* EFFECTIVE    NUMBER
  3888*-----------------------------------------------------------------
  3889* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3890* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3891* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3892* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3893* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3894******************************************************************
  3895 01  CLAIM-MASTER.
  3896     12  CL-RECORD-ID                PIC XX.
  3897         88  VALID-CL-ID         VALUE 'CL'.
  3898
  3899     12  CL-CONTROL-PRIMARY.
  3900         16  CL-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  76
* EL156.cbl
  3901         16  CL-CARRIER              PIC X.
  3902         16  CL-CLAIM-NO             PIC X(7).
  3903         16  CL-CERT-NO.
  3904             20  CL-CERT-PRIME       PIC X(10).
  3905             20  CL-CERT-SFX         PIC X.
  3906
  3907     12  CL-CONTROL-BY-NAME.
  3908         16  CL-COMPANY-CD-A1        PIC X.
  3909         16  CL-INSURED-LAST-NAME    PIC X(15).
  3910         16  CL-INSURED-NAME.
  3911             20  CL-INSURED-1ST-NAME PIC X(12).
  3912             20  CL-INSURED-MID-INIT PIC X.
  3913
  3914     12  CL-CONTROL-BY-SSN.
  3915         16  CL-COMPANY-CD-A2        PIC X.
  3916         16  CL-SOC-SEC-NO.
  3917             20  CL-SSN-STATE        PIC XX.
  3918             20  CL-SSN-ACCOUNT      PIC X(6).
  3919             20  CL-SSN-LN3          PIC X(3).
  3920
  3921     12  CL-CONTROL-BY-CERT-NO.
  3922         16  CL-COMPANY-CD-A4        PIC X.
  3923         16  CL-CERT-NO-A4.
  3924             20  CL-CERT-A4-PRIME    PIC X(10).
  3925             20  CL-CERT-A4-SFX      PIC X.
  3926
  3927     12  CL-CONTROL-BY-CCN.
  3928         16  CL-COMPANY-CD-A5        PIC X.
  3929         16  CL-CCN-A5.
  3930             20  CL-CCN.
  3931                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3932                 24  CL-CCN-PRIME-A5 PIC X(12).
  3933             20  CL-CCN-FILLER-A5    PIC X(4).
  3934
  3935     12  CL-INSURED-PROFILE-DATA.
  3936         16  CL-INSURED-BIRTH-DT     PIC XX.
  3937         16  CL-INSURED-SEX-CD       PIC X.
  3938             88  INSURED-IS-MALE        VALUE 'M'.
  3939             88  INSURED-IS-FEMALE      VALUE 'F'.
  3940             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3941         16  CL-INSURED-OCC-CD       PIC X(6).
  3942         16  FILLER                  PIC X(5).
  3943
  3944     12  CL-PROCESSING-INFO.
  3945         16  CL-PROCESSOR-ID         PIC X(4).
  3946         16  CL-CLAIM-STATUS         PIC X.
  3947             88  CLAIM-IS-OPEN          VALUE 'O'.
  3948             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3949         16  CL-CLAIM-TYPE           PIC X.
  3950*            88  AH-CLAIM               VALUE 'A'.
  3951*            88  LIFE-CLAIM             VALUE 'L'.
  3952*            88  PROPERTY-CLAIM         VALUE 'P'.
  3953*            88  IUI-CLAIM              VALUE 'I'.
  3954*            88  GAP-CLAIM              VALUE 'G'.
  3955*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3956         16  CL-CLAIM-PREM-TYPE      PIC X.
  3957             88  SINGLE-PREMIUM         VALUE '1'.
  3958             88  O-B-COVERAGE           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  77
* EL156.cbl
  3959             88  OPEN-END-COVERAGE      VALUE '3'.
  3960         16  CL-INCURRED-DT          PIC XX.
  3961         16  CL-REPORTED-DT          PIC XX.
  3962         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3963         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3964         16  CL-LAST-PMT-DT          PIC XX.
  3965         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3966         16  CL-PAID-THRU-DT         PIC XX.
  3967         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3968         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3969         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3970         16  CL-PMT-CALC-METHOD      PIC X.
  3971             88  CL-360-DAY-YR          VALUE '1'.
  3972             88  CL-365-DAY-YR          VALUE '2'.
  3973             88  CL-FULL-MONTHS         VALUE '3'.
  3974         16  CL-CAUSE-CD             PIC X(6).
  3975
  3976         16  CL-PRIME-CERT-NO.
  3977             20  CL-PRIME-CERT-PRIME PIC X(10).
  3978             20  CL-PRIME-CERT-SFX   PIC X.
  3979
  3980         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3981             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3982             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3983
  3984         16  CL-MICROFILM-NO         PIC X(10).
  3985         16  FILLER REDEFINES CL-MICROFILM-NO.
  3986             20  CL-BENEFIT-PERIOD   PIC 99.
  3987             20  FILLER              PIC X(8).
  3988         16  CL-PROG-FORM-TYPE       PIC X.
  3989         16  CL-LAST-ADD-ON-DT       PIC XX.
  3990
  3991         16  CL-LAST-REOPEN-DT       PIC XX.
  3992         16  CL-LAST-CLOSE-DT        PIC XX.
  3993         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3994             88  FINAL-PAID             VALUE '1'.
  3995             88  CLAIM-DENIED           VALUE '2'.
  3996             88  AUTO-CLOSE             VALUE '3'.
  3997             88  MANUAL-CLOSE           VALUE '4'.
  3998             88  BENEFITS-CHANGED       VALUE 'C'.
  3999             88  SETUP-ERRORS           VALUE 'E'.
  4000         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4001         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4002         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4003             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4004         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4005         16  FILLER                  PIC X.
  4006
  4007     12  CL-CERTIFICATE-DATA.
  4008         16  CL-CERT-ORIGIN          PIC X.
  4009             88  CERT-WAS-ONLINE        VALUE '1'.
  4010             88  CERT-WAS-CREATED       VALUE '2'.
  4011             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4012         16  CL-CERT-KEY-DATA.
  4013             20  CL-CERT-CARRIER     PIC X.
  4014             20  CL-CERT-GROUPING    PIC X(6).
  4015             20  CL-CERT-STATE       PIC XX.
  4016             20  CL-CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  78
* EL156.cbl
  4017                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4018                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4019             20  CL-CERT-EFF-DT      PIC XX.
  4020
  4021     12  CL-STATUS-CONTROLS.
  4022         16  CL-PRIORITY-CD          PIC X.
  4023             88  CONFIDENTIAL-DATA      VALUE '8'.
  4024             88  HIGHEST-PRIORITY       VALUE '9'.
  4025         16  CL-SUPV-ATTN-CD         PIC X.
  4026             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4027             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4028         16  CL-PURGED-DT            PIC XX.
  4029         16  CL-RESTORED-DT          PIC XX.
  4030         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4031         16  CL-NEXT-RESEND-DT       PIC XX.
  4032         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4033         16  CL-CRITICAL-PERIOD      PIC 99.
  4034*        16  FILLER                  PIC XX.
  4035         16  CL-LAST-MAINT-DT        PIC XX.
  4036         16  CL-LAST-MAINT-USER      PIC X(4).
  4037         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4038         16  CL-LAST-MAINT-TYPE      PIC X.
  4039             88  CLAIM-SET-UP           VALUE ' '.
  4040             88  PAYMENT-MADE           VALUE '1'.
  4041             88  LETTER-SENT            VALUE '2'.
  4042             88  MASTER-WAS-ALTERED     VALUE '3'.
  4043             88  MASTER-WAS-RESTORED    VALUE '4'.
  4044             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4045             88  FILE-CONVERTED         VALUE '6'.
  4046             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4047             88  ERROR-CORRECTION       VALUE 'E'.
  4048         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4049         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4050         16  CL-BENEFICIARY          PIC X(10).
  4051         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4052         16  CL-DENIAL-TYPE          PIC X.
  4053             88  CL-TYPE-DENIAL          VALUE '1'.
  4054             88  CL-TYPE-RESCISSION      VALUE '2'.
  4055             88  CL-TYPE-REFORMATION     VALUE '3'.
  4056             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4057             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4058         16  filler                  pic x(5).
  4059*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4060*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4061*        16  CL-RTW-DT               PIC XX.
  4062
  4063     12  CL-TRAILER-CONTROLS.
  4064         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4065             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4066             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4067             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4068         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4069         16  FILLER                  PIC XX.
  4070         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4071         16  CL-ADDRESS-TRAILER-CNT.
  4072             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4073                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4074             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  79
* EL156.cbl
  4075                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4076             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4077                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4078             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4079                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4080             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4081                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4082             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4083                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4084             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4085                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4086
  4087     12  CL-CV-REFERENCE-NO.
  4088         16  CL-CV-REFNO-PRIME       PIC X(18).
  4089         16  CL-CV-REFNO-SFX         PIC XX.
  4090
  4091     12  CL-FILE-LOCATION            PIC X(4).
  4092
  4093     12  CL-PROCESS-ERRORS.
  4094         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4095             88  NO-FATAL-ERRORS        VALUE ZERO.
  4096         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4097             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4098
  4099     12  CL-PRODUCT-CD               PIC X.
  4100
  4101     12  CL-CURRENT-KEY-DATA.
  4102         16  CL-CURRENT-CARRIER      PIC X.
  4103         16  CL-CURRENT-GROUPING     PIC X(6).
  4104         16  CL-CURRENT-STATE        PIC XX.
  4105         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4106
  4107     12  CL-ASSOCIATES               PIC X.
  4108         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4109         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4110         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4111         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4112
  4113     12  CL-ACTIVITY-CODE            PIC 99.
  4114     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4115     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4116
  4117     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4118     12  CL-LAG-REPORT-CODE          PIC 9.
  4119     12  CL-LOAN-TYPE                PIC XX.
  4120     12  CL-LEGAL-STATE              PIC XX.
  4121
  4122     12  CL-YESNOSW                  PIC X.
  4123     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4124         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4125         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4126         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4127     12  cl-insured-type             pic x.
  4128         88  cl-claim-on-primary         value 'P'.
  4129         88  cl-claim-on-co-borrower     value 'C'.
  4130     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  80
* EL156.cbl
  4132*    COPY ELCCNTL.
  4133******************************************************************
  4134*                                                                *
  4135*                                                                *
  4136*                            ELCCNTL.                            *
  4137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4138*                            VMOD=2.059                          *
  4139*                                                                *
  4140*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4141*                                                                *
  4142*   FILE TYPE = VSAM,KSDS                                        *
  4143*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4144*                                                                *
  4145*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4146*       ALTERNATE INDEX = NONE                                   *
  4147*                                                                *
  4148*   LOG = YES                                                    *
  4149*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4150******************************************************************
  4151*                   C H A N G E   L O G
  4152*
  4153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4154*-----------------------------------------------------------------
  4155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4156* EFFECTIVE    NUMBER
  4157*-----------------------------------------------------------------
  4158* 082503                   PEMA  ADD BENEFIT GROUP
  4159* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4160* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4161* 092705    2005050300006  PEMA  ADD SPP LEASES
  4162* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4163* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4164* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4165* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4166* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4167* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4168* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4169* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4170* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4171* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4172******************************************************************
  4173*
  4174 01  CONTROL-FILE.
  4175     12  CF-RECORD-ID                       PIC XX.
  4176         88  VALID-CF-ID                        VALUE 'CF'.
  4177
  4178     12  CF-CONTROL-PRIMARY.
  4179         16  CF-COMPANY-ID                  PIC XXX.
  4180         16  CF-RECORD-TYPE                 PIC X.
  4181             88  CF-COMPANY-MASTER              VALUE '1'.
  4182             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4183             88  CF-STATE-MASTER                VALUE '3'.
  4184             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4185             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4186             88  CF-CARRIER-MASTER              VALUE '6'.
  4187             88  CF-MORTALITY-MASTER            VALUE '7'.
  4188             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4189             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  81
* EL156.cbl
  4190             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4191             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4192             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4193             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4194             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4195             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4196             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4197             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4198             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4199         16  CF-ACCESS-CD-GENL              PIC X(4).
  4200         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4201             20  CF-PROCESSOR               PIC X(4).
  4202         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4203             20  CF-STATE-CODE              PIC XX.
  4204             20  FILLER                     PIC XX.
  4205         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4206             20  FILLER                     PIC XX.
  4207             20  CF-HI-BEN-IN-REC           PIC XX.
  4208         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4209             20  FILLER                     PIC XXX.
  4210             20  CF-CARRIER-CNTL            PIC X.
  4211         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4212             20  FILLER                     PIC XX.
  4213             20  CF-HI-TYPE-IN-REC          PIC 99.
  4214         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4215             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4216                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4217             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4218             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4219         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4220             20  FILLER                     PIC X.
  4221             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4222         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4223             20  FILLER                     PIC XX.
  4224             20  CF-MORTGAGE-PLAN           PIC XX.
  4225         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4226
  4227     12  CF-LAST-MAINT-DT                   PIC XX.
  4228     12  CF-LAST-MAINT-BY                   PIC X(4).
  4229     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4230
  4231     12  CF-RECORD-BODY                     PIC X(728).
  4232
  4233
  4234****************************************************************
  4235*             COMPANY MASTER RECORD                            *
  4236****************************************************************
  4237
  4238     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4239         16  CF-COMPANY-ADDRESS.
  4240             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4241             20  CF-CL-IN-CARE-OF           PIC X(30).
  4242             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4243             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4244             20  CF-CL-CITY-STATE           PIC X(30).
  4245             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4246             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4247         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  82
* EL156.cbl
  4248         16  CF-COMPANY-PASSWORD            PIC X(8).
  4249         16  CF-SECURITY-OPTION             PIC X.
  4250             88  ALL-SECURITY                   VALUE '1'.
  4251             88  COMPANY-VERIFY                 VALUE '2'.
  4252             88  PROCESSOR-VERIFY               VALUE '3'.
  4253             88  NO-SECURITY                    VALUE '4'.
  4254             88  ALL-BUT-TERM                   VALUE '5'.
  4255         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4256             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4257         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4258             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4259         16  CF-INFORCE-LOCATION            PIC X.
  4260             88  CERTS-ARE-ONLINE               VALUE '1'.
  4261             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4262             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4263         16  CF-LOWER-CASE-LETTERS          PIC X.
  4264         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4265             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4266             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4267             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4268             88  CF-ACCNT-CNTL                  VALUE '3'.
  4269             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4270
  4271         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4272         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4273
  4274         16  CF-LGX-CREDIT-USER             PIC X.
  4275             88  CO-IS-NOT-USER                 VALUE 'N'.
  4276             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4277
  4278         16 CF-CREDIT-CALC-CODES.
  4279             20  CF-CR-REM-TERM-CALC PIC X.
  4280               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4281               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4282               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4283               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4284               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4285               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4286               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4287             20  CF-CR-R78-METHOD           PIC X.
  4288               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4289               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4290
  4291         16  CF-CLAIM-CONTROL-COUNTS.
  4292             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4293                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4294
  4295             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4296                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4297
  4298             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4299                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4300
  4301             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4302                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4303
  4304         16  CF-CURRENT-MONTH-END           PIC XX.
  4305
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  83
* EL156.cbl
  4306         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4307             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4308             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4309             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4310             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4311                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4312                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4313             20  CF-CO-PREM-REJECT-SW       PIC X.
  4314                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4315                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4316             20  CF-CO-REF-REJECT-SW        PIC X.
  4317                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4318                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4319
  4320         16  CF-CO-REPORTING-DT             PIC XX.
  4321         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4322         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4323           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4324           88  CF-CO-MONTH-END                  VALUE '1'.
  4325
  4326         16  CF-LGX-CLAIM-USER              PIC X.
  4327             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4328             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4329
  4330         16  CF-CREDIT-EDIT-CONTROLS.
  4331             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4332             20  CF-MIN-AGE                 PIC 99.
  4333             20  CF-DEFAULT-AGE             PIC 99.
  4334             20  CF-MIN-TERM                PIC S999      COMP-3.
  4335             20  CF-MAX-TERM                PIC S999      COMP-3.
  4336             20  CF-DEFAULT-SEX             PIC X.
  4337             20  CF-JOINT-AGE-INPUT         PIC X.
  4338                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4339             20  CF-BIRTH-DATE-INPUT        PIC X.
  4340                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4341             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4342                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4343                 88  CF-ZERO-CARRIER            VALUE '1'.
  4344                 88  CF-ZERO-GROUPING           VALUE '2'.
  4345                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4346             20  CF-EDIT-SW                 PIC X.
  4347                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4348             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4349             20  CF-CR-PR-METHOD            PIC X.
  4350               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4351               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4352             20  FILLER                     PIC X.
  4353
  4354         16  CF-CREDIT-MISC-CONTROLS.
  4355             20  CF-REIN-TABLE-SW           PIC X.
  4356                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4357             20  CF-COMP-TABLE-SW           PIC X.
  4358                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4359             20  CF-EXPERIENCE-RETENTION-AGE
  4360                                            PIC S9        COMP-3.
  4361             20  CF-CONVERSION-DT           PIC XX.
  4362             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4363             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  84
* EL156.cbl
  4364                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4365                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4366
  4367             20  CF-CR-CHECK-NO-CONTROL.
  4368                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4369                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4370                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4371                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4372                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4373                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4374
  4375                 24  CF-CR-CHECK-COUNT       REDEFINES
  4376                     CF-CR-CHECK-COUNTER      PIC X(4).
  4377
  4378                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4379                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4380
  4381                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4382                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4383                 24  CF-MAIL-PROCESSING       PIC X.
  4384                     88  MAIL-PROCESSING          VALUE 'Y'.
  4385
  4386         16  CF-MISC-SYSTEM-CONTROL.
  4387             20  CF-SYSTEM-C                 PIC X.
  4388                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4389             20  CF-SYSTEM-D                 PIC X.
  4390                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4391             20  CF-SOC-SEC-NO-SW            PIC X.
  4392                 88  SOC-SEC-NO-USED             VALUE '1'.
  4393             20  CF-MEMBER-NO-SW             PIC X.
  4394                 88  MEMBER-NO-USED              VALUE '1'.
  4395             20  CF-TAX-ID-NUMBER            PIC X(11).
  4396             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4397             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4398                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4399                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4400                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4401                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4402             20  CF-SYSTEM-E                 PIC X.
  4403                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4404
  4405         16  CF-LGX-LIFE-USER               PIC X.
  4406             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4407             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4408
  4409         16  CF-CR-MONTH-END-DT             PIC XX.
  4410
  4411         16  CF-FILE-MAINT-DATES.
  4412             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4413                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4414             20  CF-LAST-BATCH       REDEFINES
  4415                 CF-LAST-BATCH-NO               PIC X(4).
  4416             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4417             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4418             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4419             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4420             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4421             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  85
* EL156.cbl
  4422             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4423             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4424             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4425             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4426
  4427         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4428         16  FILLER                         PIC X.
  4429
  4430         16  CF-ALT-MORT-CODE               PIC X(4).
  4431         16  CF-MEMBER-CAPTION              PIC X(10).
  4432
  4433         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4434             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4435             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4436             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4437             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4438             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4439
  4440         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4441
  4442         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4443         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4444         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4445         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4446
  4447         16  CF-AH-OVERRIDE-L1              PIC X.
  4448         16  CF-AH-OVERRIDE-L2              PIC XX.
  4449         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4450         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4451
  4452         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4453         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4454
  4455         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4456         16  CF-AR-LAST-EL860-DT            PIC XX.
  4457         16  CF-MP-MONTH-END-DT             PIC XX.
  4458
  4459         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4460         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4461             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4462
  4463         16  CF-AR-MONTH-END-DT             PIC XX.
  4464
  4465         16  CF-CRDTCRD-USER                PIC X.
  4466             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4467             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4468
  4469         16  CF-CC-MONTH-END-DT             PIC XX.
  4470
  4471         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4472
  4473         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4474             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4475             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4476             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4477         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4478         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4479         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  86
* EL156.cbl
  4480         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4481             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4482             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4483         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4484         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4485         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4486             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4487         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4488
  4489         16  CF-CL-ZIP-CODE.
  4490             20  CF-CL-ZIP-PRIME.
  4491                 24  CF-CL-ZIP-1ST          PIC X.
  4492                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4493                 24  FILLER                 PIC X(4).
  4494             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4495         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4496             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4497             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4498             20  FILLER                     PIC XXX.
  4499
  4500         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4501         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4502         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4503         16  CF-CO-OPTION-START-DATE        PIC XX.
  4504         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4505           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4506                                                      '3' '4'.
  4507           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4508           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4509           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4510           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4511           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4512           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4513
  4514         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4515
  4516         16  CF-PAYMENT-APPROVAL-LEVELS.
  4517             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4518             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4519             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4520             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4521             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4522             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4523
  4524         16  CF-END-USER-REPORTING-USER     PIC X.
  4525             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4526             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4527
  4528         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4529             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4530             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4531
  4532         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4533
  4534         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4535         16  FILLER                         PIC X.
  4536
  4537         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  87
* EL156.cbl
  4538             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4539             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4540             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4541
  4542         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4543
  4544         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4545             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4546             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4547
  4548         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4549             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4550             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4551
  4552         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4553
  4554         16  CF-CO-ACH-ID-CODE              PIC  X.
  4555             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4556             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4557             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4558         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4559         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4560         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4561         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4562         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4563         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4564         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4565         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4566         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4567                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4568         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4569                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4570
  4571         16  CF-CO-OVER-SHORT.
  4572             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4573             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4574
  4575*         16  FILLER                         PIC X(102).
  4576         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4577             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4578             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4579
  4580         16  CF-AH-APPROVAL-DAYS.
  4581             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4582             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4583             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4584             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4585
  4586         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4587
  4588         16  CF-APPROV-LEV-5.
  4589             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4590             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4591             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4592
  4593         16  FILLER                         PIC X(68).
  4594****************************************************************
  4595*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  88
* EL156.cbl
  4596****************************************************************
  4597
  4598     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4599         16  CF-PROCESSOR-NAME              PIC X(30).
  4600         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4601         16  CF-PROCESSOR-TITLE             PIC X(26).
  4602         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4603                 88  MESSAGE-YES                VALUE 'Y'.
  4604                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4605
  4606*****************************************************
  4607****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4608****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4609****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4610****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4611*****************************************************
  4612
  4613         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4614             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4615             20  CF-APPLICATION-FORCE       PIC X.
  4616             20  CF-INDIVIDUAL-APP.
  4617                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4618                     28  CF-BROWSE-APP      PIC X.
  4619                     28  CF-UPDATE-APP      PIC X.
  4620
  4621         16  CF-CURRENT-TERM-ON             PIC X(4).
  4622         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4623             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4624             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4625             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4626             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4627             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4628             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4629             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4630         16  CF-PROCESSOR-CARRIER           PIC X.
  4631             88  NO-CARRIER-SECURITY            VALUE ' '.
  4632         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4633             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4634         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4635             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4636         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4637             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4638
  4639         16  CF-PROC-SYS-ACCESS-SW.
  4640             20  CF-PROC-CREDIT-CLAIMS-SW.
  4641                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4642                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4643                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4644                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4645             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4646                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4647                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4648             20  CF-PROC-LIFE-GNRLDGR-SW.
  4649                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4650                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4651                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4652                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4653             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  89
* EL156.cbl
  4654                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4655                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4656         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4657             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4658             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4659         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4660
  4661         16  CF-APPROVAL-LEVEL                  PIC X.
  4662             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4663             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4664             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4665             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4666             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4667
  4668         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4669
  4670         16  CF-LANGUAGE-TYPE                   PIC X.
  4671             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4672             88  CF-LANG-IS-FR                      VALUE 'F'.
  4673
  4674         16  CF-CSR-IND                         PIC X.
  4675         16  FILLER                             PIC X(239).
  4676
  4677****************************************************************
  4678*             PROCESSOR/REMINDERS RECORD                       *
  4679****************************************************************
  4680
  4681     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4682         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4683             20  CF-START-REMIND-DT         PIC XX.
  4684             20  CF-END-REMIND-DT           PIC XX.
  4685             20  CF-REMINDER-TEXT           PIC X(50).
  4686         16  FILLER                         PIC X(296).
  4687
  4688
  4689****************************************************************
  4690*             STATE MASTER RECORD                              *
  4691****************************************************************
  4692
  4693     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4694         16  CF-STATE-ABBREVIATION          PIC XX.
  4695         16  CF-STATE-NAME                  PIC X(25).
  4696         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4697         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4698             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4699             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4700             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4701             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4702                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4703                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4704             20  CF-ST-PREM-REJECT-SW       PIC X.
  4705                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4706                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4707             20  CF-ST-REF-REJECT-SW        PIC X.
  4708                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4709                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4710         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4711         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  90
* EL156.cbl
  4712         16  CF-ST-REFUND-RULES.
  4713             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4714             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4715             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4716         16  CF-ST-FST-PMT-EXTENSION.
  4717             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4718             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4719                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4720                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4721                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4722                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4723         16  CF-ST-STATE-CALL.
  4724             20  CF-ST-CALL-UNEARNED        PIC X.
  4725             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4726             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4727         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4728             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4729             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4730         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4731         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4732         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4733         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4734         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4735         16  FILLER                         PIC X.
  4736         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4737             20  CF-ST-BENEFIT-CD           PIC XX.
  4738             20  CF-ST-BENEFIT-KIND         PIC X.
  4739                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4740                 88  CF-ST-AH-KIND              VALUE 'A'.
  4741             20  CF-ST-REM-TERM-CALC        PIC X.
  4742                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4743                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4744                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4745                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4746                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4747                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4748                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4749                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4750
  4751             20  CF-ST-REFUND-CALC          PIC X.
  4752                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4753                 88  ST-REFD-BY-R78             VALUE '1'.
  4754                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4755                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4756                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4757                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4758                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4759                 88  ST-REFD-UTAH               VALUE '7'.
  4760                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4761                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4762                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4763
  4764             20  CF-ST-EARNING-CALC         PIC X.
  4765                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4766                 88  ST-EARN-BY-R78             VALUE '1'.
  4767                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4768                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4769                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  91
* EL156.cbl
  4770                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4771                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4772                 88  ST-EARN-MEAN               VALUE '8'.
  4773                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4774
  4775             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4776                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4777                 88  ST-OVRD-BY-R78             VALUE '1'.
  4778                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4779                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4780                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4781                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4782                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4783                 88  ST-OVRD-MEAN               VALUE '8'.
  4784                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4785             20  cf-st-extra-periods        pic 9.
  4786*            20  FILLER                     PIC X.
  4787
  4788         16  CF-ST-COMMISSION-CAPS.
  4789             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4790             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4791             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4792             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4793         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4794                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4795
  4796         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4797
  4798         16  CF-ST-STATUTORY-INTEREST.
  4799             20  CF-ST-STAT-DATE-FROM       PIC X.
  4800                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4801                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4802             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4803             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4804             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4805             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4806             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4807
  4808         16  CF-ST-OVER-SHORT.
  4809             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4810             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4811
  4812         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4813
  4814         16  CF-ST-RT-CALC                  PIC X.
  4815
  4816         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4817         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4818         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4819         16  CF-ST-RF-LR-CALC               PIC X.
  4820         16  CF-ST-RF-LL-CALC               PIC X.
  4821         16  CF-ST-RF-LN-CALC               PIC X.
  4822         16  CF-ST-RF-AH-CALC               PIC X.
  4823         16  CF-ST-RF-CP-CALC               PIC X.
  4824*        16  FILLER                         PIC X(206).
  4825*CIDMOD         16  FILLER                         PIC X(192).
  4826         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4827             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  92
* EL156.cbl
  4828         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4829         16  CF-ST-VFY-2ND-BENE             PIC X.
  4830         16  CF-ST-CAUSAL-STATE             PIC X.
  4831         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4832         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4833         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4834             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4835         16  CF-ST-NET-ONLY-STATE           PIC X.
  4836             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4837         16  FILLER                         PIC X(181).
  4838
  4839****************************************************************
  4840*             BENEFIT MASTER RECORD                            *
  4841****************************************************************
  4842
  4843     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4844         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4845             20  CF-BENEFIT-CODE            PIC XX.
  4846             20  CF-BENEFIT-NUMERIC  REDEFINES
  4847                 CF-BENEFIT-CODE            PIC XX.
  4848             20  CF-BENEFIT-ALPHA           PIC XXX.
  4849             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4850             20  CF-BENEFIT-COMMENT         PIC X(10).
  4851
  4852             20  CF-LF-COVERAGE-TYPE        PIC X.
  4853                 88  CF-REDUCING                VALUE 'R'.
  4854                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4855
  4856             20  CF-SPECIAL-CALC-CD         PIC X.
  4857                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4858                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4859                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4860                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4861                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4862                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4863                 88  CF-FARM-PLAN               VALUE 'F'.
  4864                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4865                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4866                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4867                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4868                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4869                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4870                 88  CF-PRUDENTIAL              VALUE 'P'.
  4871                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4872                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4873                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4874                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4875                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4876                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4877
  4878             20  CF-JOINT-INDICATOR         PIC X.
  4879                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4880
  4881*            20  FILLER                     PIC X(12).
  4882             20  cf-maximum-benefits        pic s999 comp-3.
  4883             20  FILLER                     PIC X(09).
  4884             20  CF-BENEFIT-CATEGORY        PIC X.
  4885             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  93
* EL156.cbl
  4886
  4887             20  CF-CO-REM-TERM-CALC        PIC X.
  4888                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4889                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4890                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4891                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4892                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4893
  4894             20  CF-CO-EARNINGS-CALC        PIC X.
  4895                 88  CO-EARN-BY-R78             VALUE '1'.
  4896                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4897                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4898                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4899                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4900                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4901                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4902                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4903
  4904             20  CF-CO-REFUND-CALC          PIC X.
  4905                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4906                 88  CO-REFD-BY-R78             VALUE '1'.
  4907                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4908                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4909                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4910                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4911                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4912                 88  CO-REFD-MEAN               VALUE '8'.
  4913                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4914                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4915                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4916
  4917             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4918                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4919                 88  CO-OVRD-BY-R78             VALUE '1'.
  4920                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4921                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4922                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4923                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4924                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4925                 88  CO-OVRD-MEAN               VALUE '8'.
  4926                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4927
  4928             20  CF-CO-BEN-I-G-CD           PIC X.
  4929                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4930                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4931                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4932
  4933         16  FILLER                         PIC X(304).
  4934
  4935
  4936****************************************************************
  4937*             CARRIER MASTER RECORD                            *
  4938****************************************************************
  4939
  4940     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4941         16  CF-ADDRESS-DATA.
  4942             20  CF-MAIL-TO-NAME            PIC X(30).
  4943             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  94
* EL156.cbl
  4944             20  CF-ADDRESS-LINE-1          PIC X(30).
  4945             20  CF-ADDRESS-LINE-2          PIC X(30).
  4946             20  CF-CITY-STATE              PIC X(30).
  4947             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4948             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4949
  4950         16  CF-CLAIM-NO-CONTROL.
  4951             20  CF-CLAIM-NO-METHOD         PIC X.
  4952                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4953                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4954                 88  CLAIM-NO-SEQ               VALUE '3'.
  4955                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4956             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4957                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4958                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4959                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4960
  4961         16  CF-CHECK-NO-CONTROL.
  4962             20  CF-CHECK-NO-METHOD         PIC X.
  4963                 88  CHECK-NO-MANUAL            VALUE '1'.
  4964                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4965                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4966                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4967             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4968                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4969
  4970         16  CF-DOMICILE-STATE              PIC XX.
  4971
  4972         16  CF-EXPENSE-CONTROLS.
  4973             20  CF-EXPENSE-METHOD          PIC X.
  4974                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4975                 88  DOLLARS-PER-PMT            VALUE '2'.
  4976                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4977                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4978             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4979             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4980
  4981         16  CF-CORRESPONDENCE-CONTROL.
  4982             20  CF-LETTER-RESEND-OPT       PIC X.
  4983                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4984                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4985             20  FILLER                     PIC X(4).
  4986
  4987         16  CF-RESERVE-CONTROLS.
  4988             20  CF-MANUAL-SW               PIC X.
  4989                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4990             20  CF-FUTURE-SW               PIC X.
  4991                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4992             20  CF-PTC-SW                  PIC X.
  4993                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4994             20  CF-IBNR-SW                 PIC X.
  4995                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4996             20  CF-PTC-LF-SW               PIC X.
  4997                 88  CF-LF-PTC-USED             VALUE '1'.
  4998             20  CF-CDT-ACCESS-METHOD       PIC X.
  4999                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5000                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5001                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  95
* EL156.cbl
  5002             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5003
  5004         16  CF-CLAIM-CALC-METHOD           PIC X.
  5005             88  360-PLUS-MONTHS                VALUE '1'.
  5006             88  365-PLUS-MONTHS                VALUE '2'.
  5007             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5008             88  360-DAILY                      VALUE '4'.
  5009             88  365-DAILY                      VALUE '5'.
  5010
  5011         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5012         16  FILLER                         PIC X(11).
  5013
  5014         16  CF-LIMIT-AMOUNTS.
  5015             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5016             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5017             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5018             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5019             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5020             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5021             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5022             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5023             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5024             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5025
  5026         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5027         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5028         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5029
  5030         16  CF-ZIP-CODE.
  5031             20  CF-ZIP-PRIME.
  5032                 24  CF-ZIP-1ST             PIC X.
  5033                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5034                 24  FILLER                 PIC X(4).
  5035             20  CF-ZIP-PLUS4               PIC X(4).
  5036         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5037             20  CF-CAN-POSTAL-1            PIC XXX.
  5038             20  CF-CAN-POSTAL-2            PIC XXX.
  5039             20  FILLER                     PIC XXX.
  5040
  5041         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5042         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5043         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5044
  5045         16  CF-RATING-SWITCH               PIC X.
  5046             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5047             88  CF-NO-RATING                   VALUE 'N'.
  5048
  5049         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5050
  5051         16  CF-CARRIER-OVER-SHORT.
  5052             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5053             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5054
  5055         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5056         16  CF-SECPAY-SWITCH               PIC X.
  5057             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5058             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5059         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  96
* EL156.cbl
  5060         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5061         16  FILLER                         PIC X(444).
  5062*        16  FILLER                         PIC X(452).
  5063
  5064
  5065****************************************************************
  5066*             MORTALITY MASTER RECORD                          *
  5067****************************************************************
  5068
  5069     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5070         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5071                                INDEXED BY CF-MORT-NDX.
  5072             20  CF-MORT-TABLE              PIC X(5).
  5073             20  CF-MORT-TABLE-TYPE         PIC X.
  5074                 88  CF-MORT-JOINT              VALUE 'J'.
  5075                 88  CF-MORT-SINGLE             VALUE 'S'.
  5076                 88  CF-MORT-COMBINED           VALUE 'C'.
  5077                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5078                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5079             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5080             20  CF-MORT-AGE-METHOD         PIC XX.
  5081                 88  CF-AGE-LAST                VALUE 'AL'.
  5082                 88  CF-AGE-NEAR                VALUE 'AN'.
  5083             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5084             20  CF-MORT-ADJUSTMENT-DIRECTION
  5085                                            PIC X.
  5086                 88  CF-MINUS                   VALUE '-'.
  5087                 88  CF-PLUS                    VALUE '+'.
  5088             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5089             20  CF-MORT-JOINT-CODE         PIC X.
  5090                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5091             20  CF-MORT-PC-Q               PIC X.
  5092                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5093             20  CF-MORT-TABLE-CODE         PIC X(4).
  5094             20  CF-MORT-COMMENTS           PIC X(15).
  5095             20  FILLER                     PIC X(14).
  5096
  5097         16  FILLER                         PIC X(251).
  5098
  5099
  5100****************************************************************
  5101*             BUSSINESS TYPE MASTER RECORD                     *
  5102****************************************************************
  5103
  5104     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5105* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5106* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5107* AND RECORD 05 IS TYPES 81-99
  5108         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5109             20  CF-BUSINESS-TITLE          PIC  X(19).
  5110             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5111                                            PIC S9V9(4) COMP-3.
  5112             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5113             20  FILLER                     PIC  X.
  5114         16  FILLER                         PIC  X(248).
  5115
  5116
  5117****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  97
* EL156.cbl
  5118*             TERMINAL MASTER RECORD                           *
  5119****************************************************************
  5120
  5121     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5122
  5123         16  CF-COMPANY-TERMINALS.
  5124             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5125                                  PIC X(4).
  5126         16  FILLER               PIC X(248).
  5127
  5128
  5129****************************************************************
  5130*             LIFE EDIT MASTER RECORD                          *
  5131****************************************************************
  5132
  5133     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5134         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5135             20  CF-LIFE-CODE-IN            PIC XX.
  5136             20  CF-LIFE-CODE-OUT           PIC XX.
  5137         16  FILLER                         PIC X(248).
  5138
  5139
  5140****************************************************************
  5141*             AH EDIT MASTER RECORD                            *
  5142****************************************************************
  5143
  5144     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5145         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5146             20  CF-AH-CODE-IN              PIC XXX.
  5147             20  CF-AH-CODE-OUT             PIC XX.
  5148         16  FILLER                         PIC X(248).
  5149
  5150
  5151****************************************************************
  5152*             CREDIBILITY TABLES                               *
  5153****************************************************************
  5154
  5155     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5156         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5157                             INDEXED BY CF-CRDB-NDX.
  5158             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5159             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5160             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5161         16  FILLER                         PIC  X(332).
  5162
  5163
  5164****************************************************************
  5165*             REPORT CUSTOMIZATION RECORD                      *
  5166****************************************************************
  5167
  5168     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5169         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5170             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5171             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5172             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5173**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5174****       A T-TRANSFER.                                   ****
  5175             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  98
* EL156.cbl
  5176
  5177         16  FILLER                         PIC XX.
  5178
  5179         16  CF-CARRIER-CNTL-OPT.
  5180             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5181                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5182                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5183             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5184                                            PIC X.
  5185         16  CF-GROUP-CNTL-OPT.
  5186             20  CF-GROUP-OPT-SEQ           PIC 9.
  5187                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5188                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5189             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5190                                            PIC X(6).
  5191         16  CF-STATE-CNTL-OPT.
  5192             20  CF-STATE-OPT-SEQ           PIC 9.
  5193                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5194                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5195             20  CF-STATE-SELECT OCCURS 3 TIMES
  5196                                            PIC XX.
  5197         16  CF-ACCOUNT-CNTL-OPT.
  5198             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5199                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5200                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5201             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5202                                            PIC X(10).
  5203         16  CF-BUS-TYP-CNTL-OPT.
  5204             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5205                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5206                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5207             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5208                                            PIC XX.
  5209         16  CF-LF-TYP-CNTL-OPT.
  5210             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5211                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5212                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5213             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5214                                            PIC XX.
  5215         16  CF-AH-TYP-CNTL-OPT.
  5216             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5217                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5218                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5219             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5220                                            PIC XX.
  5221         16  CF-REPTCD1-CNTL-OPT.
  5222             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5223                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5224                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5225             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5226                                            PIC X(10).
  5227         16  CF-REPTCD2-CNTL-OPT.
  5228             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5229                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5230                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5231             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5232                                            PIC X(10).
  5233         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  99
* EL156.cbl
  5234             20  CF-USER1-OPT-SEQ           PIC 9.
  5235                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5236                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5237             20  CF-USER1-SELECT OCCURS 3 TIMES
  5238                                            PIC X(10).
  5239         16  CF-USER2-CNTL-OPT.
  5240             20  CF-USER2-OPT-SEQ           PIC 9.
  5241                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5242                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5243             20  CF-USER2-SELECT OCCURS 3 TIMES
  5244                                            PIC X(10).
  5245         16  CF-USER3-CNTL-OPT.
  5246             20  CF-USER3-OPT-SEQ           PIC 9.
  5247                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5248                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5249             20  CF-USER3-SELECT OCCURS 3 TIMES
  5250                                            PIC X(10).
  5251         16  CF-USER4-CNTL-OPT.
  5252             20  CF-USER4-OPT-SEQ           PIC 9.
  5253                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5254                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5255             20  CF-USER4-SELECT OCCURS 3 TIMES
  5256                                            PIC X(10).
  5257         16  CF-USER5-CNTL-OPT.
  5258             20  CF-USER5-OPT-SEQ           PIC 9.
  5259                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5260                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5261             20  CF-USER5-SELECT OCCURS 3 TIMES
  5262                                            PIC X(10).
  5263         16  CF-REINS-CNTL-OPT.
  5264             20  CF-REINS-OPT-SEQ           PIC 9.
  5265                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5266                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5267             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5268                 24  CF-REINS-PRIME         PIC XXX.
  5269                 24  CF-REINS-SUB           PIC XXX.
  5270
  5271         16  CF-AGENT-CNTL-OPT.
  5272             20  CF-AGENT-OPT-SEQ           PIC 9.
  5273                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5274                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5275             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5276                                            PIC X(10).
  5277
  5278         16  FILLER                         PIC X(43).
  5279
  5280         16  CF-LOSS-RATIO-SELECT.
  5281             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5282             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5283         16  CF-ENTRY-DATE-SELECT.
  5284             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5285             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5286         16  CF-EFFECTIVE-DATE-SELECT.
  5287             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5288             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5289
  5290         16  CF-EXCEPTION-LIST-IND          PIC X.
  5291             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 100
* EL156.cbl
  5292
  5293         16  FILLER                         PIC X(318).
  5294
  5295****************************************************************
  5296*                  EXCEPTION REPORTING RECORD                  *
  5297****************************************************************
  5298
  5299     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5300         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5301             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5302
  5303         16  CF-COMBINED-LIFE-AH-OPT.
  5304             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5305             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5306             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5307             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5308
  5309         16  CF-LIFE-OPT.
  5310             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5311             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5312             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5313             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5314             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5315             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5316             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5317             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5318             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5319             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5320
  5321         16  CF-AH-OPT.
  5322             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5323             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5324             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5325             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5326             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5327             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5328             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5329             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5330             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5331             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5332
  5333         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5334             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5335             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5336             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5337
  5338         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5339
  5340         16  FILLER                         PIC X(673).
  5341
  5342
  5343****************************************************************
  5344*             MORTGAGE SYSTEM PLAN RECORD                      *
  5345****************************************************************
  5346
  5347     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5348         16  CF-PLAN-TYPE                   PIC X.
  5349             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 101
* EL156.cbl
  5350             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5351             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5352         16  CF-PLAN-ABBREV                 PIC XXX.
  5353         16  CF-PLAN-DESCRIPT               PIC X(10).
  5354         16  CF-PLAN-NOTES                  PIC X(20).
  5355         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5356         16  CF-PLAN-UNDERWRITING.
  5357             20  CF-PLAN-TERM-DATA.
  5358                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5359                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5360             20  CF-PLAN-AGE-DATA.
  5361                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5362                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5363                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5364             20  CF-PLAN-BENEFIT-DATA.
  5365                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5366                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5367                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5368                                            PIC S9(7)V99  COMP-3.
  5369         16  CF-PLAN-POLICY-FORMS.
  5370             20  CF-POLICY-FORM             PIC X(12).
  5371             20  CF-MASTER-APPLICATION      PIC X(12).
  5372             20  CF-MASTER-POLICY           PIC X(12).
  5373         16  CF-PLAN-RATING.
  5374             20  CF-RATE-CODE               PIC X(5).
  5375             20  CF-SEX-RATING              PIC X.
  5376                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5377                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5378             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5379             20  CF-SUB-STD-TYPE            PIC X.
  5380                 88  CF-PCT-OF-PREM            VALUE '1'.
  5381                 88  CF-PCT-OF-BENE            VALUE '2'.
  5382         16  CF-PLAN-PREM-TOLERANCES.
  5383             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5384             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5385         16  CF-PLAN-PYMT-TOLERANCES.
  5386             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5387             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5388         16  CF-PLAN-MISC-DATA.
  5389             20  FILLER                     PIC X.
  5390             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5391             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5392         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5393         16  CF-PLAN-IND-GRP                PIC X.
  5394             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5395                                                     '1'.
  5396             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5397                                                     '2'.
  5398         16  CF-MIB-SEARCH-SW               PIC X.
  5399             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5400             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5401             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5402             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5403         16  CF-ALPHA-SEARCH-SW             PIC X.
  5404             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5405             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5406             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5407             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 102
* EL156.cbl
  5408             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5409             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5410             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5411             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5412             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5413             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5414                                                     'A' 'B' 'C'
  5415                                                     'X' 'Y' 'Z'.
  5416         16  CF-EFF-DT-RULE-SW              PIC X.
  5417             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5418             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5419             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5420             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5421             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5422         16  FILLER                         PIC X(4).
  5423         16  CF-HEALTH-QUESTIONS            PIC X.
  5424             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5425         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5426         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5427         16  CF-PLAN-SNGL-JNT               PIC X.
  5428             88  CF-COMBINED-PLAN              VALUE 'C'.
  5429             88  CF-JNT-PLAN                   VALUE 'J'.
  5430             88  CF-SNGL-PLAN                  VALUE 'S'.
  5431         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5432         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5433         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5434         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5435         16  CF-RERATE-CNTL                 PIC  X.
  5436             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5437             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5438             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5439             88  CF-AUTO-RECALC                 VALUE '4'.
  5440         16  CF-BENEFIT-TYPE                PIC  X.
  5441             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5442             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5443         16  CF-POLICY-FEE                  PIC S999V99
  5444                                                    COMP-3.
  5445         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5446         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5447         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5448         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5449         16  FILLER                         PIC  X(32).
  5450         16  CF-TERMINATION-FORM            PIC  X(04).
  5451         16  FILLER                         PIC  X(08).
  5452         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5453                                                       COMP-3.
  5454         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5455         16  CF-ISSUE-LETTER                PIC  X(4).
  5456         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5457         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5458             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5459             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5460         16  CF-MP-REFUND-CALC              PIC X.
  5461             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5462             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5463             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5464             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5465             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 103
* EL156.cbl
  5466             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5467             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5468             88  CF-MP-REFD-MEAN                VALUE '8'.
  5469         16  CF-ALT-RATE-CODE               PIC  X(5).
  5470
  5471
  5472         16  FILLER                         PIC X(498).
  5473****************************************************************
  5474*             MORTGAGE COMPANY MASTER RECORD                   *
  5475****************************************************************
  5476
  5477     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5478         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5479         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5480             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5481             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5482             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5483             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5484             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5485
  5486         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5487         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5488         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5489         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5490         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5491
  5492         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5493             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5494         16  CF-MP-RECON-USE-IND            PIC X(1).
  5495             88  CF-MP-USE-RECON             VALUE 'Y'.
  5496         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5497             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5498         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5499             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5500             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5501         16  FILLER                         PIC X(1).
  5502         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5503             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5504         16  CF-MORTG-MIB-VERSION           PIC X.
  5505             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5506             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5507             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5508         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5509             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5510                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5511             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5512                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5513             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5514                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5515             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5516                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5517             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5518                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5519             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5520                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5521         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5522         16  FILLER                         PIC X(7).
  5523         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 104
* EL156.cbl
  5524             20  CF-MORTG-MIB-COMM          PIC X(5).
  5525             20  CF-MORTG-MIB-TERM          PIC X(5).
  5526         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5527             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5528         16  FILLER                         PIC X(03).
  5529         16  CF-MP-CHECK-NO-CONTROL.
  5530             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5531                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5532                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5533                                                ' ' LOW-VALUES.
  5534                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5535                                               VALUE '3'.
  5536         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5537         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5538         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5539             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5540                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5541             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5542                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5543             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5544                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5545             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5546                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5547             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5548                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5549             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5550                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5551         16  CF-MORTG-BILLING-AREA.
  5552             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5553                                            PIC X.
  5554         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5555         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5556         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5557         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5558             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5559             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5560         16  FILLER                         PIC X.
  5561         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5562             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5563             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5564         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5565         16  FILLER                         PIC X(8).
  5566         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5567         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5568         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5569         16  CF-ACH-COMPANY-ID.
  5570             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5571                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5572                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5573                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5574             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5575         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5576             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5577         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5578             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5579             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5580         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5581         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 105
* EL156.cbl
  5582         16  FILLER                         PIC X(536).
  5583
  5584****************************************************************
  5585*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5586****************************************************************
  5587
  5588     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5589         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5590             20  CF-FEMALE-HEIGHT.
  5591                 24  CF-FEMALE-FT           PIC 99.
  5592                 24  CF-FEMALE-IN           PIC 99.
  5593             20  CF-FEMALE-MIN-WT           PIC 999.
  5594             20  CF-FEMALE-MAX-WT           PIC 999.
  5595         16  FILLER                         PIC X(428).
  5596
  5597     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5598         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5599             20  CF-MALE-HEIGHT.
  5600                 24  CF-MALE-FT             PIC 99.
  5601                 24  CF-MALE-IN             PIC 99.
  5602             20  CF-MALE-MIN-WT             PIC 999.
  5603             20  CF-MALE-MAX-WT             PIC 999.
  5604         16  FILLER                         PIC X(428).
  5605******************************************************************
  5606*             AUTOMATIC ACTIVITY RECORD                          *
  5607******************************************************************
  5608     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5609         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5610             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5611             20  CF-SYS-LETTER-ID           PIC X(04).
  5612             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5613             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5614             20  CF-SYS-RESET-SW            PIC X(01).
  5615             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5616             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5617
  5618         16  FILLER                         PIC X(50).
  5619
  5620         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5621             20  CF-USER-ACTIVE-SW          PIC X(01).
  5622             20  CF-USER-LETTER-ID          PIC X(04).
  5623             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5624             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5625             20  CF-USER-RESET-SW           PIC X(01).
  5626             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5627             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5628             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5629
  5630         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 106
* EL156.cbl
  5632*    COPY ELCCERT.
  5633******************************************************************
  5634*                                                                *
  5635*                            ELCCERT.                            *
  5636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5637*                            VMOD=2.013                          *
  5638*                                                                *
  5639*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5640*                                                                *
  5641*   FILE TYPE = VSAM,KSDS                                        *
  5642*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5643*                                                                *
  5644*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5645*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5646*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5647*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5648*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5649*                                                                *
  5650*   LOG = YES                                                    *
  5651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5652******************************************************************
  5653*                   C H A N G E   L O G
  5654*
  5655* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5656*-----------------------------------------------------------------
  5657*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5658* EFFECTIVE    NUMBER
  5659*-----------------------------------------------------------------
  5660* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5661* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5662* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5663* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5664* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5665* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5666* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5667* 032612  CR2011110200001  PEMA  AHL CHANGES
  5668* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5669* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5670******************************************************************
  5671
  5672 01  CERTIFICATE-MASTER.
  5673     12  CM-RECORD-ID                      PIC XX.
  5674         88  VALID-CM-ID                      VALUE 'CM'.
  5675
  5676     12  CM-CONTROL-PRIMARY.
  5677         16  CM-COMPANY-CD                 PIC X.
  5678         16  CM-CARRIER                    PIC X.
  5679         16  CM-GROUPING.
  5680             20  CM-GROUPING-PREFIX        PIC X(3).
  5681             20  CM-GROUPING-PRIME         PIC X(3).
  5682         16  CM-STATE                      PIC XX.
  5683         16  CM-ACCOUNT.
  5684             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5685             20  CM-ACCOUNT-PRIME          PIC X(6).
  5686         16  CM-CERT-EFF-DT                PIC XX.
  5687         16  CM-CERT-NO.
  5688             20  CM-CERT-PRIME             PIC X(10).
  5689             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 107
* EL156.cbl
  5690
  5691     12  CM-CONTROL-BY-NAME.
  5692         16  CM-COMPANY-CD-A1              PIC X.
  5693         16  CM-INSURED-LAST-NAME          PIC X(15).
  5694         16  CM-INSURED-INITIALS.
  5695             20  CM-INSURED-INITIAL1       PIC X.
  5696             20  CM-INSURED-INITIAL2       PIC X.
  5697
  5698     12  CM-CONTROL-BY-SSN.
  5699         16  CM-COMPANY-CD-A2              PIC X.
  5700         16  CM-SOC-SEC-NO.
  5701             20  CM-SSN-STATE              PIC XX.
  5702             20  CM-SSN-ACCOUNT            PIC X(6).
  5703             20  CM-SSN-LN3.
  5704                 25  CM-INSURED-INITIALS-A2.
  5705                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5706                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5707                 25 CM-PART-LAST-NAME-A2         PIC X.
  5708
  5709     12  CM-CONTROL-BY-CERT-NO.
  5710         16  CM-COMPANY-CD-A4              PIC X.
  5711         16  CM-CERT-NO-A4                 PIC X(11).
  5712
  5713     12  CM-CONTROL-BY-MEMB.
  5714         16  CM-COMPANY-CD-A5              PIC X.
  5715         16  CM-MEMBER-NO.
  5716             20  CM-MEMB-STATE             PIC XX.
  5717             20  CM-MEMB-ACCOUNT           PIC X(6).
  5718             20  CM-MEMB-LN4.
  5719                 25  CM-INSURED-INITIALS-A5.
  5720                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5721                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5722                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5723
  5724     12  CM-INSURED-PROFILE-DATA.
  5725         16  CM-INSURED-FIRST-NAME.
  5726             20  CM-INSURED-1ST-INIT       PIC X.
  5727             20  FILLER                    PIC X(9).
  5728         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5729         16  CM-INSURED-SEX                PIC X.
  5730             88  CM-SEX-MALE                  VALUE 'M'.
  5731             88  CM-SEX-FEMAL                 VALUE 'F'.
  5732         16  CM-INSURED-JOINT-AGE          PIC 99.
  5733         16  CM-JOINT-INSURED-NAME.
  5734             20  CM-JT-LAST-NAME           PIC X(15).
  5735             20  CM-JT-FIRST-NAME.
  5736                 24  CM-JT-1ST-INIT        PIC X.
  5737                 24  FILLER                PIC X(9).
  5738             20  CM-JT-INITIAL             PIC X.
  5739
  5740     12  CM-LIFE-DATA.
  5741         16  CM-LF-BENEFIT-CD              PIC XX.
  5742         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5743         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5744         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5745         16  CM-LF-DEV-CODE                PIC XXX.
  5746         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5747         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 108
* EL156.cbl
  5748         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5749         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5750         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5751         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5752         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5753         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5754         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5755         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5756         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5757         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5758         16  cm-temp-epiq                  pic xx.
  5759             88  EPIQ-CLASS                  value 'EQ'.
  5760*        16  FILLER                        PIC XX.
  5761
  5762     12  CM-AH-DATA.
  5763         16  CM-AH-BENEFIT-CD              PIC XX.
  5764         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5765         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5766         16  CM-AH-DEV-CODE                PIC XXX.
  5767         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5768         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5769         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5770         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5771         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5772         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5773         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5774         16  CM-AH-PAID-THRU-DT            PIC XX.
  5775             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5776         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5777         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5778         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5779         16  FILLER                        PIC X.
  5780
  5781     12  CM-LOAN-INFORMATION.
  5782         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5783         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5784                                           PIC S9(5)V99  COMP-3.
  5785         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5786         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5787         16  CM-PAY-FREQUENCY              PIC S99.
  5788         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5789         16  CM-RATE-CLASS                 PIC XX.
  5790         16  CM-BENEFICIARY                PIC X(25).
  5791         16  CM-POLICY-FORM-NO             PIC X(12).
  5792         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5793         16  CM-LAST-ADD-ON-DT             PIC XX.
  5794         16  CM-DEDUCTIBLE-AMOUNTS.
  5795             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5796             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5797         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5798             20  CM-RESIDENT-STATE         PIC XX.
  5799             20  CM-RATE-CODE              PIC X(4).
  5800             20  FILLER                    PIC XX.
  5801         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5802             20  CM-LOAN-OFFICER           PIC X(5).
  5803             20  FILLER                    PIC XXX.
  5804         16  CM-CSR-CODE                   PIC XXX.
  5805         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 109
* EL156.cbl
  5806             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5807         16  CM-POST-CARD-IND              PIC X.
  5808         16  CM-NH-INTERFACE-SW            PIC X.
  5809         16  CM-PREMIUM-TYPE               PIC X.
  5810             88  CM-SING-PRM                  VALUE '1'.
  5811             88  CM-O-B-COVERAGE              VALUE '2'.
  5812             88  CM-OPEN-END                  VALUE '3'.
  5813         16  CM-IND-GRP-TYPE               PIC X.
  5814             88  CM-INDIVIDUAL                VALUE 'I'.
  5815             88  CM-GROUP                     VALUE 'G'.
  5816         16  CM-SKIP-CODE                  PIC X.
  5817             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5818             88  SKIP-JULY                    VALUE '1'.
  5819             88  SKIP-AUGUST                  VALUE '2'.
  5820             88  SKIP-SEPTEMBER               VALUE '3'.
  5821             88  SKIP-JULY-AUG                VALUE '4'.
  5822             88  SKIP-AUG-SEPT                VALUE '5'.
  5823             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5824             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5825             88  SKIP-JUNE                    VALUE '8'.
  5826             88  SKIP-JUNE-JULY               VALUE '9'.
  5827             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5828             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5829         16  CM-PAYMENT-MODE               PIC X.
  5830             88  PAY-MONTHLY                  VALUE SPACE.
  5831             88  PAY-WEEKLY                   VALUE '1'.
  5832             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5833             88  PAY-BI-WEEKLY                VALUE '3'.
  5834             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5835         16  CM-LOAN-NUMBER                PIC X(8).
  5836         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5837         16  CM-OLD-LOF                    PIC XXX.
  5838*        16  CM-LOAN-OFFICER               PIC XXX.
  5839         16  CM-REIN-TABLE                 PIC XXX.
  5840         16  CM-SPECIAL-REIN-CODE          PIC X.
  5841         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5842         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5843         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5844
  5845     12  CM-STATUS-DATA.
  5846         16  CM-ENTRY-STATUS               PIC X.
  5847         16  CM-ENTRY-DT                   PIC XX.
  5848
  5849         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5850         16  CM-LF-CANCEL-DT               PIC XX.
  5851         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5852
  5853         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5854         16  CM-LF-DEATH-DT                PIC XX.
  5855         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5856
  5857         16  CM-LF-CURRENT-STATUS          PIC X.
  5858             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5859                                                'M' '4' '5' '9'.
  5860             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5861             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5862             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5863             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 110
* EL156.cbl
  5864             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5865             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5866             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5867             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5868             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5869             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5870             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5871             88  CM-LF-DECLINED               VALUE 'D'.
  5872             88  CM-LF-VOIDED                 VALUE 'V'.
  5873
  5874         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5875         16  CM-AH-CANCEL-DT               PIC XX.
  5876         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5877
  5878         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5879         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5880         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5881
  5882         16  CM-AH-CURRENT-STATUS          PIC X.
  5883             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5884                                                'M' '4' '5' '9'.
  5885             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5886             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5887             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5888             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5889             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5890             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5891             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5892             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5893             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5894             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5895             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5896             88  CM-AH-DECLINED               VALUE 'D'.
  5897             88  CM-AH-VOIDED                 VALUE 'V'.
  5898
  5899         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5900             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5901             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5902             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5903         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5904
  5905         16  CM-ENTRY-BATCH                PIC X(6).
  5906         16  CM-LF-EXIT-BATCH              PIC X(6).
  5907         16  CM-AH-EXIT-BATCH              PIC X(6).
  5908         16  CM-LAST-MONTH-END             PIC XX.
  5909
  5910     12  CM-NOTE-SW                        PIC X.
  5911         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5912         88  CERT-NOTES-PRESENT               VALUE '1'.
  5913         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5914         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5915         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5916         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5917         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5918         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5919     12  CM-COMP-EXCP-SW                   PIC X.
  5920         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5921         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 111
* EL156.cbl
  5922     12  CM-INSURED-ADDRESS-SW             PIC X.
  5923         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5924         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5925
  5926*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5927     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5928     12  FILLER                            PIC X.
  5929
  5930*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5931     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5932     12  FILLER                            PIC X.
  5933*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5934     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5935
  5936     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5937         88  CERT-ADDED-BATCH                 VALUE ' '.
  5938         88  CERT-ADDED-ONLINE                VALUE '1'.
  5939         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5940         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5941         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5942     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5943         88  CERT-AS-LOADED                   VALUE ' '.
  5944         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5945         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5946         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5947         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5948         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5949         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5950         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5951
  5952     12  CM-ACCOUNT-COMM-PCTS.
  5953         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5954         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5955
  5956     12  CM-USER-FIELD                     PIC X.
  5957     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5958     12  CM-CLP-STATE                      PIC XX.
  5959     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5960     12  CM-USER-RESERVED                  PIC XXX.
  5961     12  FILLER REDEFINES CM-USER-RESERVED.
  5962         16  CM-AH-CLASS-CD                PIC XX.
  5963         16  F                             PIC X.
  5964******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 112
* EL156.cbl
  5966*    COPY ELCTRLR.
  5967******************************************************************
  5968*                                                                *
  5969*                            ELCTRLR.                            *
  5970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5971*                            VMOD=2.014                          *
  5972*                                                                *
  5973*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5974*                                                                *
  5975*   FILE TYPE = VSAM,KSDS                                        *
  5976*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5977*                                                                *
  5978*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5979*       ALTERNATE INDEX = NONE                                   *
  5980*                                                                *
  5981*   LOG = YES                                                    *
  5982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5983******************************************************************
  5984*                   C H A N G E   L O G
  5985*
  5986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5987*-----------------------------------------------------------------
  5988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5989* EFFECTIVE    NUMBER
  5990*-----------------------------------------------------------------
  5991* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5992* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5993* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5994* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5995* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5996* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5997* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5998* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5999* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6000* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6001* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6002* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6003* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6004* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6005* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6006* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6007* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6008* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6009* 040814    2014030500002  AJRA  ADD ICD CODES
  6010* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6011* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6012******************************************************************
  6013 01  ACTIVITY-TRAILERS.
  6014     12  AT-RECORD-ID                    PIC XX.
  6015         88  VALID-AT-ID                       VALUE 'AT'.
  6016
  6017     12  AT-CONTROL-PRIMARY.
  6018         16  AT-COMPANY-CD               PIC X.
  6019         16  AT-CARRIER                  PIC X.
  6020         16  AT-CLAIM-NO                 PIC X(7).
  6021         16  AT-CERT-NO.
  6022             20  AT-CERT-PRIME           PIC X(10).
  6023             20  AT-CERT-SFX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 113
* EL156.cbl
  6024         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6025             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6026             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6027             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6028             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6029             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6030             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6031             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6032             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6033             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6034             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6035             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6036             88  AT-BENEFICIARY-TRL           VALUE +91.
  6037             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6038             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6039             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6040             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6041
  6042     12  AT-TRAILER-TYPE                 PIC X.
  6043         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6044         88  PAYMENT-TR                       VALUE '2'.
  6045         88  AUTO-PAY-TR                      VALUE '3'.
  6046         88  CORRESPONDENCE-TR                VALUE '4'.
  6047         88  ADDRESS-TR                       VALUE '5'.
  6048         88  GENERAL-INFO-TR                  VALUE '6'.
  6049         88  AUTO-PROMPT-TR                   VALUE '7'.
  6050         88  DENIAL-TR                        VALUE '8'.
  6051         88  INCURRED-CHG-TR                  VALUE '9'.
  6052         88  FORM-CONTROL-TR                  VALUE 'A'.
  6053
  6054     12  AT-RECORDED-DT                  PIC XX.
  6055     12  AT-RECORDED-BY                  PIC X(4).
  6056     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6057
  6058     12  AT-TRAILER-BODY                 PIC X(165).
  6059
  6060     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6061         16  AT-RESERVE-CONTROLS.
  6062             20  AT-MANUAL-SW            PIC X.
  6063                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6064             20  AT-FUTURE-SW            PIC X.
  6065                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6066             20  AT-PTC-SW               PIC X.
  6067                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6068             20  AT-IBNR-SW              PIC X.
  6069                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6070             20  AT-PTC-LF-SW            PIC X.
  6071                 88  AT-LF-PTC-USED          VALUE '1'.
  6072             20  AT-CDT-ACCESS-METHOD    PIC X.
  6073                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6074                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6075                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6076             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6077         16  AT-LAST-COMPUTED-DT         PIC XX.
  6078         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6079         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6080         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6081         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 114
* EL156.cbl
  6082         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6083         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6084         16  AT-EXPENSE-CONTROLS.
  6085             20  AT-EXPENSE-METHOD       PIC X.
  6086                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6087                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6088                 88  PERCENT-OF-PMT           VALUE '3'.
  6089                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6090             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6091             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6092         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6093         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6094
  6095         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6096         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6097
  6098*        16  FILLER                      PIC X(53).
  6099         16  FILLER                      PIC X(47).
  6100
  6101         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6102         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6103
  6104         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6105             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6106             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6107*                    C = CLOSED
  6108*                    O = OPEN
  6109             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6110*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6111
  6112     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6113         16  AT-PAYMENT-TYPE             PIC X.
  6114             88  PARTIAL-PAYMENT                VALUE '1'.
  6115             88  FINAL-PAYMENT                  VALUE '2'.
  6116             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6117             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6118             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6119             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6120             88  VOIDED-PAYMENT                 VALUE '9'.
  6121             88  TRANSFER                       VALUE 'T'.
  6122             88  LIFE-INTEREST                  VALUE 'I'.
  6123
  6124         16  AT-CLAIM-TYPE               PIC X.
  6125             88  PAID-FOR-AH                    VALUE 'A'.
  6126             88  PAID-FOR-LIFE                  VALUE 'L'.
  6127             88  PAID-FOR-IUI                   VALUE 'I'.
  6128             88  PAID-FOR-GAP                   VALUE 'G'.
  6129             88  PAID-FOR-FAM                   VALUE 'F'.
  6130         16  AT-CLAIM-PREM-TYPE          PIC X.
  6131             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6132             88  AT-O-B-COVERAGE                VALUE '2'.
  6133             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6134         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6135         16  AT-CHECK-NO                 PIC X(7).
  6136         16  AT-PAID-FROM-DT             PIC XX.
  6137         16  AT-PAID-THRU-DT             PIC XX.
  6138         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6139         16  AT-ACH-PAYMENT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 115
* EL156.cbl
  6140*        16  FILLER                      PIC X.
  6141         16  AT-PAYEES-NAME              PIC X(30).
  6142         16  AT-PAYMENT-ORIGIN           PIC X.
  6143             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6144             88  ONLINE-AUTO-PMT                VALUE '2'.
  6145             88  OFFLINE-PMT                    VALUE '3'.
  6146         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6147         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6148         16  AT-VOID-DATA.
  6149             20  AT-VOID-DT              PIC XX.
  6150*00144       20  AT-VOID-REASON          PIC X(30).
  6151             20  AT-VOID-REASON          PIC X(26).
  6152         16  AT-PMT-APPROVED-BY          PIC X(04).
  6153         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6154         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6155         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6156                                         PIC S99V9(5)  COMP-3.
  6157         16  AT-CREDIT-INTERFACE.
  6158             20  AT-PMT-SELECT-DT        PIC XX.
  6159                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6160             20  AT-PMT-ACCEPT-DT        PIC XX.
  6161                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6162             20  AT-VOID-SELECT-DT       PIC XX.
  6163                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6164             20  AT-VOID-ACCEPT-DT       PIC XX.
  6165                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6166
  6167         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6168                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6169                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6170         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6171
  6172         16  AT-FORCE-CONTROL            PIC X.
  6173             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6174         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6175         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6176         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6177         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6178         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6179         16  AT-BENEFIT-TYPE             PIC X.
  6180
  6181         16  AT-EXPENSE-TYPE             PIC X.
  6182         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6183
  6184         16  AT-PAYEE-TYPE-CD.
  6185             20  AT-PAYEE-TYPE           PIC X.
  6186                 88  INSURED-PAID           VALUE 'I'.
  6187                 88  BENEFICIARY-PAID       VALUE 'B'.
  6188                 88  ACCOUNT-PAID           VALUE 'A'.
  6189                 88  OTHER-1-PAID           VALUE 'O'.
  6190                 88  OTHER-2-PAID           VALUE 'Q'.
  6191                 88  DOCTOR-PAID            VALUE 'P'.
  6192                 88  EMPLOYER-PAID          VALUE 'E'.
  6193             20  AT-PAYEE-SEQ            PIC X.
  6194
  6195         16  AT-CASH-PAYMENT             PIC X.
  6196         16  AT-GROUPED-PAYMENT          PIC X.
  6197         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 116
* EL156.cbl
  6198         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6199         16  AT-APPROVED-LEVEL           PIC X.
  6200         16  AT-VOID-TYPE                PIC X.
  6201             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6202             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6203         16  AT-AIG-UNEMP-IND            PIC X.
  6204             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6205         16  AT-ASSOCIATES               PIC X.
  6206             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6207             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6208
  6209         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6210         16  AT-CV-PMT-CODE              PIC X.
  6211             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6212             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6213             88  FULL-ADD-PAYMENT           VALUE '3'.
  6214             88  HALF-ADD-PAYMENT           VALUE '4'.
  6215             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6216             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6217             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6218             88  ADDL-PAYMENT               VALUE '8'.
  6219
  6220         16  AT-EOB-CODE1                PIC XXX.
  6221         16  AT-EOB-CODE2                PIC XXX.
  6222         16  AT-EOB-CODE3                PIC XXX.
  6223         16  FILLER REDEFINES AT-EOB-CODE3.
  6224             20  AT-PRINT-CLM-FORM       PIC X.
  6225             20  AT-PRINT-SURVEY         PIC X.
  6226             20  AT-SPECIAL-RELEASE      PIC X.
  6227         16  AT-EOB-CODE4                PIC XXX.
  6228         16  FILLER REDEFINES AT-EOB-CODE4.
  6229             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6230             20  FILLER                  PIC X.
  6231         16  AT-EOB-CODE5                PIC XXX.
  6232         16  FILLER REDEFINES AT-EOB-CODE5.
  6233             20  AT-PMT-PROOF-DT         PIC XX.
  6234             20  FILLER                  PIC X.
  6235
  6236         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6237             88  AT-PRINT-EOB            VALUE 'Y'.
  6238
  6239         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6240         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6241
  6242     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6243         16  AT-SCHEDULE-START-DT        PIC XX.
  6244         16  AT-SCHEDULE-END-DT          PIC XX.
  6245         16  AT-TERMINATED-DT            PIC XX.
  6246         16  AT-LAST-PMT-TYPE            PIC X.
  6247             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6248             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6249         16  AT-FIRST-PMT-DATA.
  6250             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6251             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6252             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6253         16  AT-REGULAR-PMT-DATA.
  6254             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6255             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 117
* EL156.cbl
  6256             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6257         16  AT-AUTO-PAYEE-CD.
  6258             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6259                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6260                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6261                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6262                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6263                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6264             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6265         16  AT-AUTO-PAY-DAY             PIC 99.
  6266         16  AT-AUTO-CASH                PIC X.
  6267             88  AT-CASH                      VALUE 'Y'.
  6268             88  AT-NON-CASH                  VALUE 'N'.
  6269*        16  FILLER                      PIC X(129).
  6270         16  AT-AUTO-END-LETTER          PIC X(4).
  6271         16  FILLER                      PIC X(125).
  6272
  6273         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6274         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6275
  6276     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6277         16  AT-LETTER-SENT-DT           PIC XX.
  6278         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6279         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6280         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6281         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6282         16  AT-LETTER-ORIGIN            PIC X.
  6283             88  ONLINE-CREATION              VALUE '1' '3'.
  6284             88  OFFLINE-CREATION             VALUE '2' '4'.
  6285             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6286             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6287         16  AT-STD-LETTER-FORM          PIC X(4).
  6288         16  AT-REASON-TEXT              PIC X(70).
  6289         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6290         16  AT-ADDRESEE-TYPE            PIC X.
  6291              88  INSURED-ADDRESEE            VALUE 'I'.
  6292              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6293              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6294              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6295              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6296              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6297              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6298         16  AT-ADDRESSEE-NAME           PIC X(30).
  6299         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6300         16  AT-RESEND-PRINT-DATE        PIC XX.
  6301         16  AT-CORR-SOL-UNSOL           PIC X.
  6302         16  AT-LETTER-PURGED-DT         PIC XX.
  6303*
  6304*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6305*
  6306         16  AT-CSO-REDEFINITION.
  6307             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6308             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6309             20  AT-LETTER-TO-BENE       PIC X(1).
  6310             20  AT-STOP-LETTER-DT       PIC X(2).
  6311             20  FILLER                  PIC X(19).
  6312*             20  FILLER                  PIC X(27).
  6313             20  AT-CSO-LETTER-STATUS    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 118
* EL156.cbl
  6314                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6315                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6316                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6317             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6318             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6319*
  6320*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6321*
  6322*        16  FILLER                      PIC X(26).
  6323*
  6324*        16  AT-DMD-BSR-CODE             PIC X.
  6325*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6326*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6327*
  6328*        16  AT-DMD-LETTER-STATUS        PIC X.
  6329*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6330*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6331*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6332*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6333*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6334
  6335         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6336         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6337
  6338     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6339         16  AT-ADDRESS-TYPE             PIC X.
  6340             88  INSURED-ADDRESS               VALUE 'I'.
  6341             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6342             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6343             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6344             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6345             88  OTHER-ADDRESS-1               VALUE 'O'.
  6346             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6347         16  AT-MAIL-TO-NAME             PIC X(30).
  6348         16  AT-ADDRESS-LINE-1           PIC X(30).
  6349         16  AT-ADDRESS-LINE-2           PIC X(30).
  6350         16  AT-CITY-STATE.
  6351             20  AT-CITY                 PIC X(28).
  6352             20  AT-STATE                PIC XX.
  6353         16  AT-ZIP.
  6354             20  AT-ZIP-CODE.
  6355                 24  AT-ZIP-1ST          PIC X.
  6356                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6357                 24  FILLER              PIC X(4).
  6358             20  AT-ZIP-PLUS4            PIC X(4).
  6359         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6360             20  AT-CAN-POSTAL-1         PIC XXX.
  6361             20  AT-CAN-POSTAL-2         PIC XXX.
  6362             20  FILLER                  PIC XXX.
  6363         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6364*         16  FILLER                      PIC X(23).
  6365         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6366         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6367         16  FILLER                      PIC X(13).
  6368         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6369         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6370
  6371     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 119
* EL156.cbl
  6372         16  AT-INFO-LINE-1              PIC X(60).
  6373         16  FILLER REDEFINES AT-INFO-LINE-1.
  6374             20  AT-NOTE-ERROR-NO OCCURS 15
  6375                                         PIC X(4).
  6376         16  AT-INFO-LINE-2              PIC X(60).
  6377         16  FILLER REDEFINES AT-INFO-LINE-2.
  6378             20  AT-ICD-CODE-1           PIC X(8).
  6379             20  AT-ICD-CODE-2           PIC X(8).
  6380             20  FILLER                  PIC X(44).
  6381         16  AT-INFO-TRAILER-TYPE        PIC X.
  6382             88  AT-ERRORS-NOTE          VALUE 'E'.
  6383             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6384             88  AT-CALL-NOTE            VALUE 'C'.
  6385             88  AT-MAINT-NOTE           VALUE 'M'.
  6386             88  AT-CERT-CHANGE          VALUE 'X'.
  6387             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6388             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6389             88  AT-CERT-CANCELLED       VALUE 'T'.
  6390         16  AT-CALL-TYPE                PIC X.
  6391             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6392             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6393         16  AT-NOTE-CONTINUATION        PIC X.
  6394             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6395         16  AT-EOB-CODES-EXIST          PIC X.
  6396             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6397         16  FILLER                      PIC X(35).
  6398         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6399         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6400
  6401     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6402         16  AT-PROMPT-LINE-1            PIC X(60).
  6403         16  AT-PROMPT-LINE-2            PIC X(60).
  6404         16  AT-PROMPT-START-DT          PIC XX.
  6405         16  AT-PROMPT-END-DT            PIC XX.
  6406         16  FILLER                      PIC X(35).
  6407         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6408         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6409
  6410     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6411         16  AT-DENIAL-INFO-1            PIC X(60).
  6412         16  AT-DENIAL-INFO-2            PIC X(60).
  6413         16  AT-DENIAL-DT                PIC XX.
  6414         16  AT-RETRACTION-DT            PIC XX.
  6415         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6416*         16  FILLER                      PIC X(31).
  6417         16  AT-DENIAL-PROOF-DT          PIC XX.
  6418         16  FILLER                      PIC X(29).
  6419         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6420         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6421
  6422     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6423         16  AT-OLD-INCURRED-DT          PIC XX.
  6424         16  AT-OLD-REPORTED-DT          PIC XX.
  6425         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6426         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6427         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6428         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6429         16  AT-OLD-PAID-THRU-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 120
* EL156.cbl
  6430         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6431         16  FILLER                      PIC X(26).
  6432         16  AT-OLD-DIAG-CODE            PIC X(6).
  6433         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6434         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6435         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6436         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6437         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6438         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6439         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6440         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6441         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6442         16  FILLER                      PIC X(9).
  6443         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6444
  6445     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6446         16  AT-FORM-SEND-ON-DT          PIC XX.
  6447         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6448         16  AT-FORM-RE-SEND-DT          PIC XX.
  6449         16  AT-FORM-ANSWERED-DT         PIC XX.
  6450         16  AT-FORM-PRINTED-DT          PIC XX.
  6451         16  AT-FORM-REPRINT-DT          PIC XX.
  6452         16  AT-FORM-TYPE                PIC X.
  6453             88  INITIAL-FORM                  VALUE '1'.
  6454             88  PROGRESS-FORM                 VALUE '2'.
  6455         16  AT-INSTRUCT-LN-1            PIC X(28).
  6456         16  AT-INSTRUCT-LN-2            PIC X(28).
  6457         16  AT-INSTRUCT-LN-3            PIC X(28).
  6458         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6459         16  AT-FORM-ADDRESS             PIC X.
  6460             88  FORM-TO-INSURED              VALUE 'I'.
  6461             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6462             88  FORM-TO-OTHER-1              VALUE 'O'.
  6463             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6464         16  AT-RELATED-1.
  6465             20 AT-REL-CARR-1            PIC X.
  6466             20 AT-REL-CLAIM-1           PIC X(7).
  6467             20 AT-REL-CERT-1            PIC X(11).
  6468         16  AT-RELATED-2.
  6469             20 AT-REL-CARR-2            PIC X.
  6470             20 AT-REL-CLAIM-2           PIC X(7).
  6471             20 AT-REL-CERT-2            PIC X(11).
  6472         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6473         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6474         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6475         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6476         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6477         16  AT-STOP-FORM-DT             PIC X(2).
  6478
  6479         16  FILLER                      PIC X(09).
  6480         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6481         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6482******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 121
* EL156.cbl
  6484*    COPY ELCACTQ.
  6485******************************************************************
  6486*                                                                *
  6487*                            ELCACTQ.                            *
  6488*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6489*                            VMOD=2.004                          *
  6490*                                                                *
  6491*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6492*                                                                *
  6493*   FILE TYPE = VSAM,KSDS                                        *
  6494*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6495*                                                                *
  6496*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6497*       ALTERNATE INDEX = NONE                                   *
  6498*                                                                *
  6499*   LOG = YES                                                    *
  6500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6501*                                                                *
  6502*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6503******************************************************************
  6504
  6505 01  ACTIVITY-QUE.
  6506     12  AQ-RECORD-ID                PIC XX.
  6507         88  VALID-AQ-ID                VALUE 'AQ'.
  6508
  6509     12  AQ-CONTROL-PRIMARY.
  6510         16  AQ-COMPANY-CD           PIC X.
  6511         16  AQ-CARRIER              PIC X.
  6512         16  AQ-CLAIM-NO             PIC X(7).
  6513         16  AQ-CERT-NO.
  6514             20  AQ-CERT-PRIME       PIC X(10).
  6515             20  AQ-CERT-SFX         PIC X.
  6516
  6517     12  AQ-PENDING-ACTIVITY-FLAGS.
  6518         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6519         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6520             88  PENDING-PAYMENTS       VALUE '1'.
  6521         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6522             88  PENDING-FULL-PRINT     VALUE '1'.
  6523             88  PENDING-PART-PRINT     VALUE '2'.
  6524         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6525             88  PENDING-LETTERS        VALUE '1'.
  6526         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6527             88  PENDING-RESTORE        VALUE 'C'.
  6528             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6529
  6530     12  FILLER                      PIC X(20).
  6531
  6532     12  AQ-RESEND-DATE              PIC XX.
  6533     12  AQ-FOLLOWUP-DATE            PIC XX.
  6534     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6535     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6536     12  AQ-AUTO-LETTER              PIC X(4).
  6537     12  FILLER                      PIC XX.
  6538     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6539*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 122
* EL156.cbl
  6541*    COPY ERCACCT.
  6542******************************************************************
  6543*                                                                *
  6544*                                                                *
  6545*                            ERCACCT                             *
  6546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6547*                            VMOD=2.031                          *
  6548*                                                                *
  6549*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6550*                                                                *
  6551*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6552*   VSAM ACCOUNT MASTER FILES.                                   *
  6553*                                                                *
  6554*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6555*                                                                *
  6556*   FILE TYPE = VSAM,KSDS                                        *
  6557*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6558*                                                                *
  6559*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6560*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6561*                                                                *
  6562*   LOG = NO                                                     *
  6563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6564*                                                                *
  6565*                                                                *
  6566******************************************************************
  6567*                   C H A N G E   L O G
  6568*
  6569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6570*-----------------------------------------------------------------
  6571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6572* EFFECTIVE    NUMBER
  6573*-----------------------------------------------------------------
  6574* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6575* 092705    2005050300006  PEMA  ADD SPP LEASES
  6576* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6577* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6578* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6579* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6580* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6581* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6582******************************************************************
  6583
  6584 01  ACCOUNT-MASTER.
  6585     12  AM-RECORD-ID                      PIC XX.
  6586         88  VALID-AM-ID                      VALUE 'AM'.
  6587
  6588     12  AM-CONTROL-PRIMARY.
  6589         16  AM-COMPANY-CD                 PIC X.
  6590         16  AM-MSTR-CNTRL.
  6591             20  AM-CONTROL-A.
  6592                 24  AM-CARRIER            PIC X.
  6593                 24  AM-GROUPING.
  6594                     28 AM-GROUPING-PREFIX PIC XXX.
  6595                     28 AM-GROUPING-PRIME  PIC XXX.
  6596                 24  AM-STATE              PIC XX.
  6597                 24  AM-ACCOUNT.
  6598                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 123
* EL156.cbl
  6599                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6600             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6601                                           PIC X(19).
  6602             20  AM-CNTRL-B.
  6603                 24  AM-EXPIRATION-DT      PIC XX.
  6604                 24  FILLER                PIC X(4).
  6605             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6606                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6607
  6608     12  AM-CONTROL-BY-VAR-GRP.
  6609         16  AM-COMPANY-CD-A1              PIC X.
  6610         16  AM-VG-CARRIER                 PIC X.
  6611         16  AM-VG-GROUPING                PIC X(6).
  6612         16  AM-VG-STATE                   PIC XX.
  6613         16  AM-VG-ACCOUNT                 PIC X(10).
  6614         16  AM-VG-DATE.
  6615             20  AM-VG-EXPIRATION-DT       PIC XX.
  6616             20  FILLER                    PIC X(4).
  6617         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6618                                           PIC 9(11)      COMP-3.
  6619     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6620         16  FILLER                        PIC X(10).
  6621         16  AM-VG-KEY3.
  6622             20  AM-VG3-ACCOUNT            PIC X(10).
  6623             20  AM-VG3-EXP-DT             PIC XX.
  6624         16  FILLER                        PIC X(4).
  6625     12  AM-MAINT-INFORMATION.
  6626         16  AM-LAST-MAINT-DT              PIC XX.
  6627         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6628         16  AM-LAST-MAINT-USER            PIC X(4).
  6629         16  FILLER                        PIC XX.
  6630
  6631     12  AM-EFFECTIVE-DT                   PIC XX.
  6632     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6633
  6634     12  AM-PREV-DATES  COMP-3.
  6635         16  AM-PREV-EXP-DT                PIC 9(11).
  6636         16  AM-PREV-EFF-DT                PIC 9(11).
  6637
  6638     12  AM-REPORT-CODE-1                  PIC X(10).
  6639     12  AM-REPORT-CODE-2                  PIC X(10).
  6640
  6641     12  AM-CITY-CODE                      PIC X(4).
  6642     12  AM-COUNTY-PARISH                  PIC X(6).
  6643
  6644     12  AM-NAME                           PIC X(30).
  6645     12  AM-PERSON                         PIC X(30).
  6646     12  AM-ADDRS                          PIC X(30).
  6647     12  AM-CITY.
  6648         16  AM-ADDR-CITY                  PIC X(28).
  6649         16  AM-ADDR-STATE                 PIC XX.
  6650     12  AM-ZIP.
  6651         16  AM-ZIP-PRIME.
  6652             20  AM-ZIP-PRI-1ST            PIC X.
  6653                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6654             20  FILLER                    PIC X(4).
  6655         16  AM-ZIP-PLUS4                  PIC X(4).
  6656     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 124
* EL156.cbl
  6657         16  AM-CAN-POSTAL-1               PIC XXX.
  6658         16  AM-CAN-POSTAL-2               PIC XXX.
  6659         16  FILLER                        PIC XXX.
  6660     12  AM-TEL-NO.
  6661         16  AM-AREA-CODE                  PIC 999.
  6662         16  AM-TEL-PRE                    PIC 999.
  6663         16  AM-TEL-NBR                    PIC 9(4).
  6664     12  AM-TEL-LOC                        PIC X.
  6665         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6666         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6667
  6668     12  AM-COMM-STRUCTURE.
  6669         16  AM-DEFN-1.
  6670             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6671                 24  AM-AGT.
  6672                     28  AM-AGT-PREFIX     PIC X(4).
  6673                     28  AM-AGT-PRIME      PIC X(6).
  6674                 24  AM-COM-TYP            PIC X.
  6675                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6676                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6677                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6678                 24  AM-RECALC-LV-INDIC    PIC X.
  6679                 24  AM-RETRO-LV-INDIC     PIC X.
  6680                 24  AM-GL-CODES           PIC X.
  6681                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6682                 24  FILLER                PIC X(01).
  6683         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6684             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6685                 24  FILLER                PIC X(11).
  6686                 24  AM-L-COMA             PIC XXX.
  6687                 24  AM-J-COMA             PIC XXX.
  6688                 24  AM-A-COMA             PIC XXX.
  6689                 24  FILLER                PIC X(6).
  6690
  6691     12  AM-COMM-CHANGE-STATUS             PIC X.
  6692         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6693
  6694     12  AM-CSR-CODE                       PIC X(4).
  6695
  6696     12  AM-BILLING-STATUS                 PIC X.
  6697         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6698         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6699     12  AM-AUTO-REFUND-SW                 PIC X.
  6700         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6701         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6702     12  AM-GPCD                           PIC 99.
  6703     12  AM-IG                             PIC X.
  6704         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6705         88  AM-HAS-GROUP                     VALUE '2'.
  6706     12  AM-STATUS                         PIC X.
  6707         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6708         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6709         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6710         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6711         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6712         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6713         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6714         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 125
* EL156.cbl
  6715         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6716         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6717     12  AM-REMIT-TO                       PIC 99.
  6718     12  AM-ID-NO                          PIC X(11).
  6719
  6720     12  AM-CAL-TABLE                      PIC XX.
  6721     12  AM-LF-DEVIATION                   PIC XXX.
  6722     12  AM-AH-DEVIATION                   PIC XXX.
  6723     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6724     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6725     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6726     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6727     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6728     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6729
  6730     12  AM-USER-FIELDS.
  6731         16  AM-FLD-1                      PIC XX.
  6732         16  AM-FLD-2                      PIC XX.
  6733         16  AM-FLD-3                      PIC XX.
  6734         16  AM-FLD-4                      PIC XX.
  6735         16  AM-FLD-5                      PIC XX.
  6736
  6737     12  AM-1ST-PROD-DATE.
  6738         16  AM-1ST-PROD-YR                PIC XX.
  6739         16  AM-1ST-PROD-MO                PIC XX.
  6740         16  AM-1ST-PROD-DA                PIC XX.
  6741     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6742     12  AM-CERTS-PURGED-DATE.
  6743         16  AM-PUR-YR                     PIC XX.
  6744         16  AM-PUR-MO                     PIC XX.
  6745         16  AM-PUR-DA                     PIC XX.
  6746     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6747     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6748     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6749     12  AM-INACTIVE-DATE.
  6750         16  AM-INA-MO                     PIC 99.
  6751         16  AM-INA-DA                     PIC 99.
  6752         16  AM-INA-YR                     PIC 99.
  6753     12  AM-AR-HI-CERT-DATE                PIC XX.
  6754
  6755     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6756     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6757
  6758     12  AM-OB-PAYMENT-MODE                PIC X.
  6759         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6760         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6761         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6762         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6763
  6764     12  AM-AH-ONLY-INDICATOR              PIC X.
  6765         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6766         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6767
  6768     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6769
  6770     12  AM-OVER-SHORT.
  6771         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6772         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 126
* EL156.cbl
  6773
  6774     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6775     12  AM-DCC-CLP-STATE                  PIC XX.
  6776
  6777     12  AM-RECALC-COMM                    PIC X.
  6778     12  AM-RECALC-REIN                    PIC X.
  6779
  6780     12  AM-REI-TABLE                      PIC XXX.
  6781     12  AM-REI-ET-LF                      PIC X.
  6782     12  AM-REI-ET-AH                      PIC X.
  6783     12  AM-REI-PE-LF                      PIC X.
  6784     12  AM-REI-PE-AH                      PIC X.
  6785     12  AM-REI-PRT-ST                     PIC X.
  6786     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6787     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6788     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6789     12  AM-REI-GROUP-A                    PIC X(6).
  6790     12  AM-REI-MORT                       PIC X(4).
  6791     12  AM-REI-PRT-OW                     PIC X.
  6792     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6793     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6794     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6795     12  AM-REI-GROUP-B                    PIC X(6).
  6796
  6797     12  AM-TRUST-TYPE                     PIC X(2).
  6798
  6799     12  AM-EMPLOYER-STMT-USED             PIC X.
  6800     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6801
  6802     12  AM-STD-AH-TYPE                    PIC XX.
  6803     12  AM-EARN-METHODS.
  6804         16  AM-EARN-METHOD-R              PIC X.
  6805             88 AM-REF-RL-R78                 VALUE 'R'.
  6806             88 AM-REF-RL-PR                  VALUE 'P'.
  6807             88 AM-REF-RL-MEAN                VALUE 'M'.
  6808             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6809         16  AM-EARN-METHOD-L              PIC X.
  6810             88 AM-REF-LL-R78                 VALUE 'R'.
  6811             88 AM-REF-LL-PR                  VALUE 'P'.
  6812             88 AM-REF-LL-MEAN                VALUE 'M'.
  6813             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6814         16  AM-EARN-METHOD-A              PIC X.
  6815             88 AM-REF-AH-R78                 VALUE 'R'.
  6816             88 AM-REF-AH-PR                  VALUE 'P'.
  6817             88 AM-REF-AH-MEAN                VALUE 'M'.
  6818             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6819             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6820             88 AM-REF-AH-NET                 VALUE 'N'.
  6821
  6822     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6823     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6824     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6825
  6826     12  AM-RET-Y-N                        PIC X.
  6827     12  AM-RET-P-E                        PIC X.
  6828     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6829     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6830     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 127
* EL156.cbl
  6831     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6832         16  AM-POOL-PRIME                 PIC XXX.
  6833         16  AM-POOL-SUB                   PIC XXX.
  6834     12  AM-RETRO-EARNINGS.
  6835         16  AM-RET-EARN-R                 PIC X.
  6836         16  AM-RET-EARN-L                 PIC X.
  6837         16  AM-RET-EARN-A                 PIC X.
  6838     12  AM-RET-ST-TAX-USE                 PIC X.
  6839         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6840         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6841     12  AM-RETRO-BEG-EARNINGS.
  6842         16  AM-RET-BEG-EARN-R             PIC X.
  6843         16  AM-RET-BEG-EARN-L             PIC X.
  6844         16  AM-RET-BEG-EARN-A             PIC X.
  6845     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6846     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6847
  6848     12  AM-USER-SELECT-OPTIONS.
  6849         16  AM-USER-SELECT-1              PIC X(10).
  6850         16  AM-USER-SELECT-2              PIC X(10).
  6851         16  AM-USER-SELECT-3              PIC X(10).
  6852         16  AM-USER-SELECT-4              PIC X(10).
  6853         16  AM-USER-SELECT-5              PIC X(10).
  6854
  6855     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6856
  6857     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6858
  6859     12  AM-RPT045A-SWITCH                 PIC X.
  6860         88  RPT045A-OFF                   VALUE 'N'.
  6861
  6862     12  AM-INSURANCE-LIMITS.
  6863         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6864         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6865
  6866     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6867         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6868
  6869     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6870         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6871         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6872
  6873     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6874
  6875     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6876     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6877     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6878     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6879     12  AM-DCC-UEF-STATE                  PIC XX.
  6880     12  FILLER                            PIC XXX.
  6881     12  AM-REPORT-CODE-3                  PIC X(10).
  6882*    12  FILLER                            PIC X(22).
  6883
  6884     12  AM-RESERVE-DATE.
  6885         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6886         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6887         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6888
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 128
* EL156.cbl
  6889     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6890     12  AM-NOTIFICATION-TYPES.
  6891         16  AM-NOTIF-OF-LETTERS           PIC X.
  6892         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6893         16  AM-NOTIF-OF-REPORTS           PIC X.
  6894         16  AM-NOTIF-OF-STATUS            PIC X.
  6895
  6896     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6897         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6898         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6899         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6900         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6901
  6902     12  AM-BENEFIT-CONTROLS.
  6903         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6904             20  AM-BENEFIT-CODE           PIC XX.
  6905             20  AM-BENEFIT-TYPE           PIC X.
  6906             20  AM-BENEFIT-REVISION       PIC XXX.
  6907             20  AM-BENEFIT-REM-TERM       PIC X.
  6908             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6909             20  FILLER                    PIC XX.
  6910         16  FILLER                        PIC X(80).
  6911
  6912     12  AM-TRANSFER-DATA.
  6913         16  AM-TRANSFERRED-FROM.
  6914             20  AM-TRNFROM-CARRIER        PIC X.
  6915             20  AM-TRNFROM-GROUPING.
  6916                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6917                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6918             20  AM-TRNFROM-STATE          PIC XX.
  6919             20  AM-TRNFROM-ACCOUNT.
  6920                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6921                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6922             20  AM-TRNFROM-DTE            PIC XX.
  6923         16  AM-TRANSFERRED-TO.
  6924             20  AM-TRNTO-CARRIER          PIC X.
  6925             20  AM-TRNTO-GROUPING.
  6926                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6927                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6928             20  AM-TRNTO-STATE            PIC XX.
  6929             20  AM-TRNTO-ACCOUNT.
  6930                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6931                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6932             20  AM-TRNTO-DTE              PIC XX.
  6933         16  FILLER                        PIC X(10).
  6934
  6935     12  AM-SAVED-REMIT-TO                 PIC 99.
  6936
  6937     12  AM-COMM-STRUCTURE-SAVED.
  6938         16  AM-DEFN-1-SAVED.
  6939             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6940                 24  AM-AGT-SV             PIC X(10).
  6941                 24  AM-COM-TYP-SV         PIC X.
  6942                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6943                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6944                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6945                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6946                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 129
* EL156.cbl
  6947                 24  AM-GL-CODES-SV        PIC X.
  6948                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6949                 24  FILLER                PIC X.
  6950         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6951             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6952                 24  FILLER                PIC X(11).
  6953                 24  AM-L-COMA-SV          PIC XXX.
  6954                 24  AM-J-COMA-SV          PIC XXX.
  6955                 24  AM-A-COMA-SV          PIC XXX.
  6956                 24  FILLER                PIC X(6).
  6957
  6958     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6959         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6960            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6961            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6962            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6963
  6964     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6965     12  FILLER                            PIC X(120).
  6966
  6967     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6968         16  AM-CONTROL-NAME               PIC X(30).
  6969         16  AM-EXECUTIVE-ONE.
  6970             20  AM-EXEC1-NAME             PIC X(15).
  6971             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6972                                                          COMP-3.
  6973             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6974                                                          COMP-3.
  6975         16  AM-EXECUTIVE-TWO.
  6976             20  AM-EXEC2-NAME             PIC X(15).
  6977             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6978                                                          COMP-3.
  6979             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6980                                                          COMP-3.
  6981
  6982     12  AM-RETRO-ADDITIONAL-DATA.
  6983         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6984         16  AM-RETRO-PREM-P-E             PIC X.
  6985         16  AM-RETRO-CLMS-P-I             PIC X.
  6986         16  AM-RETRO-RET-BRACKET-LF.
  6987             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6988                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6989                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6990             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6991                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6992                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6993             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6994                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6995                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6996         16  AM-RETRO-RET-BRACKET-AH.
  6997             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6998                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6999                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7000                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7001             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7002                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7003                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7004             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 130
* EL156.cbl
  7005                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7006                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7007
  7008     12  AM-COMMENTS.
  7009         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7010
  7011     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7012         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7013         16  AM-FLI-BILLING-CODE           PIC X.
  7014         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7015         16  AM-FLI-UNITED-IDENT           PIC X.
  7016         16  AM-FLI-INTEREST-LOST-DATA.
  7017             20  AM-FLI-BANK-NO            PIC X(5).
  7018             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7019             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7020             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7021         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7022             20  AM-FLI-AGT                PIC X(9).
  7023             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7024             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7025         16  FILLER                        PIC X(102).
  7026
  7027     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7028         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7029             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7030             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7031             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7032             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7033             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7034         16  FILLER                          PIC X(10).
  7035******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 131
* EL156.cbl
  7037*    COPY ELCCHKQ.
  7038******************************************************************
  7039*                                                                *
  7040*                                                                *
  7041*                            ELCCHKQ.                            *
  7042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7043*                            VMOD=2.007                          *
  7044*                                                                *
  7045*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7046*                                                                *
  7047*   FILE TYPE = VSAM,KSDS                                        *
  7048*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7049*                                                                *
  7050*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7051*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7052*                                                                *
  7053*   LOG = YES                                                    *
  7054*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7055******************************************************************
  7056 01  CHECK-QUE.
  7057     12  CQ-RECORD-ID                PIC XX.
  7058         88  VALID-CQ-ID         VALUE 'CQ'.
  7059
  7060     12  CQ-CONTROL-PRIMARY.
  7061         16  CQ-COMPANY-CD           PIC X.
  7062         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7063         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7064
  7065     12  CQ-CONTROL-BY-PAYEE.
  7066         16  CQ-CONTROL-BY-NUMBER.
  7067             20  CQ-COMPANY-CD-A1     PIC X.
  7068             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7069         16  CQ-PAYEE-CARRIER        PIC X.
  7070         16  CQ-PAYEE-GROUPING       PIC X(6).
  7071         16  CQ-PAYEE-STATE          PIC XX.
  7072         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7073         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7074
  7075     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7076         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7077         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7078         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7079         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7080         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7081         16  FILLER                  PIC X(3).
  7082
  7083     12  CQ-ENTRY-TYPE               PIC X.
  7084             88  CHECK-ON-QUE           VALUE 'Q'.
  7085             88  ALIGNMENT-CHECK        VALUE 'A'.
  7086             88  SPOILED-CHECK          VALUE 'S'.
  7087             88  PAYMENT-ABORTED        VALUE 'X'.
  7088
  7089     12  CQ-CLAIM-MAST-CNTL.
  7090         16  CQ-CARRIER              PIC X.
  7091         16  CQ-CLAIM-NO             PIC X(7).
  7092         16  CQ-CERT-NO.
  7093             20  CQ-CERT-PRIME       PIC X(10).
  7094             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 132
* EL156.cbl
  7095         16  CQ-CLAIM-TYPE           PIC X.
  7096             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7097             88  CQ-AH-CLAIM            VALUE 'A'.
  7098         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7099             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7100             88  CQ-O-B-COVERAGE        VALUE '2'.
  7101             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7102
  7103     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7104     12  CQ-CHECK-NUMBER             PIC X(7).
  7105     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7106     12  CQ-PAYMENT-TYPE             PIC X.
  7107             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7108             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7109             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7110             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7111             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7112             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7113             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7114             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7115     12  CQ-VOID-INDICATOR           PIC X.
  7116             88  CHECK-IS-STOPPED          VALUE 'S'.
  7117             88  CHECK-IS-VOID             VALUE 'V'.
  7118     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7119     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7120     12  CQ-CHECK-BY-USER            PIC X(4).
  7121     12  CQ-PRE-NUMBERING-SW         PIC X.
  7122       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7123       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7124
  7125     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7126     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7127     12  CQ-LEDGER-FLAG              PIC X(01).
  7128     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7129     12  CQ-LAST-UPDATED-DT          PIC XX.
  7130     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7131     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7132
  7133     12  FILLER                      PIC X(04).
  7134
  7135******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 133
* EL156.cbl
  7137*    COPY ELCBENE.
  7138******************************************************************
  7139*                                                                *
  7140*                            ELCBENE.                            *
  7141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7142*                            VMOD=2.006                          *
  7143*                                                                *
  7144*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7145*                                                                *
  7146*   FILE TYPE = VSAM,KSDS                                        *
  7147*   RECORD SIZE = 500   RECFORM = FIX                            *
  7148*                                                                *
  7149*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7150*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7151*                                                                *
  7152*   LOG = YES                                                    *
  7153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7154*                                                                *
  7155*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7156******************************************************************
  7157*                   C H A N G E   L O G
  7158*
  7159* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7160*-----------------------------------------------------------------
  7161*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7162* EFFECTIVE    NUMBER
  7163*-----------------------------------------------------------------
  7164* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7165******************************************************************
  7166
  7167 01  BENEFICIARY-MASTER.
  7168     12  BE-RECORD-ID                PIC XX.
  7169         88  VALID-BE-ID                VALUE 'BE'.
  7170
  7171     12  BE-CONTROL-PRIMARY.
  7172         16  BE-COMPANY-CD           PIC X.
  7173         16  BE-RECORD-TYPE          PIC X.
  7174             88  BENEFICIARY-RECORD  VALUE 'B'.
  7175             88  ADJUSTOR-RECORD     VALUE 'A'.
  7176         16  BE-BENEFICIARY          PIC X(10).
  7177     12  BE-CONTROL-BY-NAME.
  7178         16  BE-COMPANY-CD-A1        PIC X.
  7179         16  BE-RECORD-TYPE-A1       PIC X.
  7180         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7181         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7182
  7183     12  BE-LAST-MAINT-DT            PIC XX.
  7184     12  BE-LAST-MAINT-BY            PIC X(4).
  7185     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7186
  7187     12  BE-ADDRESS-DATA.
  7188         16  BE-MAIL-TO-NAME         PIC X(30).
  7189         16  BE-ADDRESS-LINE-1       PIC X(30).
  7190         16  BE-ADDRESS-LINE-2       PIC X(30).
  7191         16  BE-ADDRESS-LINE-3       PIC X(30).
  7192         16  BE-CITY-STATE.
  7193             20  BE-CITY             PIC X(28).
  7194             20  BE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 134
* EL156.cbl
  7195         16  BE-ZIP-CODE.
  7196             20  BE-ZIP-PRIME.
  7197                 24  BE-ZIP-1ST      PIC X.
  7198                     88  BE-CANADIAN-POST-CODE
  7199                                         VALUE 'A' THRU 'Z'.
  7200                 24  FILLER          PIC X(4).
  7201             20  BE-ZIP-PLUS4        PIC X(4).
  7202         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7203             20  BE-CAN-POSTAL-1     PIC XXX.
  7204             20  BE-CAN-POSTAL-2     PIC XXX.
  7205             20  FILLER              PIC XXX.
  7206         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7207         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7208
  7209******************************************************************
  7210*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7211*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7212******************************************************************
  7213     12  BE-CARRIER                  PIC X.
  7214
  7215     12  BE-ADDRESS-DATA2.
  7216         16  BE-MAIL-TO-NAME2        PIC X(30).
  7217         16  BE-ADDRESS-LINE-12      PIC X(30).
  7218         16  BE-ADDRESS-LINE-22      PIC X(30).
  7219         16  BE-ADDRESS-LINE-32      PIC X(30).
  7220         16  BE-CITY-STATE2.
  7221             20  BE-CITY2            PIC X(28).
  7222             20  BE-STATE2           PIC XX.
  7223         16  BE-ZIP-CODE2.
  7224             20  BE-ZIP-PRIME2.
  7225                 24  BE-ZIP-1ST2     PIC X.
  7226                     88  BE-CANADIAN-POST-CODE2
  7227                                         VALUE 'A' THRU 'Z'.
  7228                 24  FILLER          PIC X(4).
  7229             20  BE-ZIP-PLUS42       PIC X(4).
  7230         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7231             20  BE-CAN-POSTAL-12    PIC XXX.
  7232             20  BE-CAN-POSTAL-22    PIC XXX.
  7233             20  FILLER              PIC XXX.
  7234         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7235         16  BE-ACH-DATA.
  7236             20  BE-ACH-YES-OR-NO    PIC X.
  7237                 88  BE-ON-ACH       VALUE 'Y'.
  7238                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7239             20  BE-ACH-ABA-ROUTING-NUMBER
  7240                                     PIC X(15).
  7241             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7242                                     PIC X(20).
  7243             20  FILLER              PIC X(25).
  7244         16  BE-BILLING-STMT-DATA.
  7245*            20  BE-BSR              PIC X.
  7246*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7247*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7248*            20  BE-BSR-FROM         PIC X(30).
  7249*            20  BE-BSR-DEPT         PIC X(30).
  7250             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7251             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7252             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 135
* EL156.cbl
  7253                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7254                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7255
  7256     12  FILLER                      PIC X(28).
  7257******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 136
* EL156.cbl
  7259*    COPY ELCARCH.
  7260******************************************************************
  7261*                                                                *
  7262*                            ELCARCH.                            *
  7263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7264*                            VMOD=2.007                          *
  7265*                                                                *
  7266*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7267*                                                                *
  7268*   FILE TYPE = VSAM,KSDS                                        *
  7269*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7270*                                                                *
  7271*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7272*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7273*                                                                *
  7274*   LOG = NO                                                     *
  7275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7276*                                                                *
  7277*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7278******************************************************************
  7279 01  LETTER-ARCHIVE.
  7280     12  LA-RECORD-ID                PIC XX.
  7281         88  VALID-LA-ID                VALUE 'LA'.
  7282
  7283     12  LA-CONTROL-PRIMARY.
  7284         16  LA-COMPANY-CD           PIC X.
  7285         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7286         16  LA-RECORD-TYPE          PIC X.
  7287             88  LA-HEADER-DATA         VALUE '1'.
  7288             88  LA-ADDRESS-DATA        VALUE '2'.
  7289             88  LA-TEXT-DATA           VALUE '3'.
  7290             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7291         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7292
  7293     12  LA-CONTROL-BY-TYPE.
  7294         16  LA-COMPANY-CD-A1        PIC X.
  7295         16  LA-RECORD-TYPE-A1       PIC X.
  7296         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7297         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7298
  7299     12  LA-TEXT-RECORD.
  7300         16  LA-SKIP-CONTROL         PIC XX.
  7301             88  NO-LINES-SKIPPED       VALUE SPACES.
  7302             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7303         16  LA-TEXT-LINE            PIC X(70).
  7304
  7305     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7306         16  FILLER                  PIC XX.
  7307         16  LA-ADDRESS-LINE         PIC X(30).
  7308         16  FILLER                  PIC X(40).
  7309
  7310     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7311         16  FILLER                  PIC XX.
  7312         16  LA-CARRIER              PIC X.
  7313         16  LA-CLAIM-NO             PIC X(7).
  7314         16  LA-CERT-NO.
  7315             20  LA-CERT-PRIME       PIC X(10).
  7316             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 137
* EL156.cbl
  7317         16  LA-NO-OF-COPIES         PIC S9.
  7318         16  LA-RESEND-DATE          PIC XX.
  7319         16  LA-PROCESSOR-CD         PIC X(4).
  7320         16  LA-CREATION-DT          PIC XX.
  7321         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7322         16  LA-RESEND-PRINT-DATE    PIC XX.
  7323         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7324         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7325*
  7326* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7327*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7328*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7329*   I        20  LA-DMD-RES-ST           PIC XX.
  7330*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7331*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7332*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7333*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7334*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7335*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7336*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7337*   I        20  LA-DMD-UND-CODE         PIC XX.
  7338*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7339*   V    16  FILLER                  PIC X(15).
  7340* -----
  7341*
  7342* REINSERTED  CSO  MODS
  7343*
  7344         16  FILLER.
  7345             20  FILLER                  PIC X(29).
  7346             20  LA-CSO-LETTER-STATUS    PIC X.
  7347                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7348                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7349                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7350             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7351             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7352*
  7353
  7354     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7355         16  FILLER                  PIC XX.
  7356         16  LA4-CARRIER             PIC X.
  7357         16  LA4-CLAIM-NO            PIC X(7).
  7358         16  LA4-CERT-NO.
  7359             20  LA4-CERT-PRIME      PIC X(10).
  7360             20  LA4-CERT-SFX        PIC X.
  7361         16  LA4-NO-OF-COPIES        PIC S9.
  7362         16  LA4-RESEND-DATE         PIC XX.
  7363         16  LA4-PROCESSOR-CD        PIC X(4).
  7364         16  LA4-CREATION-DT         PIC XX.
  7365         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7366         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7367         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7368         16  LA4-FORM-TYPE           PIC X.
  7369             88  LA4-INITIAL-FORM    VALUE '1'.
  7370             88  LA4-PROGRESS-FORM   VALUE '2'.
  7371         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7372         16  LA4-STATE               PIC X(02).
  7373         16  FILLER                  PIC X(31).
  7374******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 138
* EL156.cbl
  7376*    COPY ELCDAR.
  7377******************************************************************
  7378*                                                                *
  7379*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7380*   FILE TYPE = VSAM,KSDS                                        *
  7381*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7382*   BASE CLUSTER = DLYACTV                                       *
  7383*   LOG = YES                                                    *
  7384*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7385*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7386*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7387*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7388*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7389*               BY PROGRAM "LGINFCE".                            *
  7390*                                                                *
  7391******************************************************************
  7392 01  DAILY-ACTIVITY-RECORD.
  7393     05  DA-KEY.
  7394         10  DA-COMP-CD          PIC X.
  7395         10  DA-CARRIER          PIC X.
  7396         10  DA-CLAIM-NO         PIC X(7).
  7397         10  DA-CERT-NO.
  7398             15  DA-CERT-PRIME   PIC X(10).
  7399             15  DA-CERT-SFX     PIC X.
  7400     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7401     05  DA-RECORD-TYPE          PIC X.
  7402     05  FILLER                  PIC X(2).
  7403******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 139
* EL156.cbl
  7405*    COPY ERCCOMP.
  7406******************************************************************
  7407*                                                                *
  7408*                                                                *
  7409*                            ERCCOMP                             *
  7410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7411*                            VMOD=2.019                          *
  7412*                                                                *
  7413*   ONLINE CREDIT SYSTEM                                         *
  7414*                                                                *
  7415*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7416*                                                                *
  7417*   FILE TYPE = VSAM,KSDS                                        *
  7418*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7419*                                                                *
  7420*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7421*       ALTERNATE PATH = NONE                                    *
  7422*                                                                *
  7423*   LOG = NO                                                     *
  7424*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7425*                                                                *
  7426******************************************************************
  7427*                   C H A N G E   L O G
  7428*
  7429* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7430*-----------------------------------------------------------------
  7431*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7432* EFFECTIVE    NUMBER
  7433*-----------------------------------------------------------------
  7434* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7435* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7436* 092205    2005050300006  PEMA  ADD LEASE FEE
  7437* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7438* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7439* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7440* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7441* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7442* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7443******************************************************************
  7444
  7445 01  COMPENSATION-MASTER.
  7446     12  CO-RECORD-ID                          PIC XX.
  7447         88  VALID-CO-ID                          VALUE 'CO'.
  7448
  7449     12  CO-CONTROL-PRIMARY.
  7450         16  CO-COMPANY-CD                     PIC X.
  7451         16  CO-CONTROL.
  7452             20  CO-CTL-1.
  7453                 24  CO-CARR-GROUP.
  7454                     28  CO-CARRIER            PIC X.
  7455                     28  CO-GROUPING.
  7456                         32  CO-GROUP-PREFIX   PIC XXX.
  7457                         32  CO-GROUP-PRIME    PIC XXX.
  7458                 24  CO-RESP-NO.
  7459                     28  CO-RESP-PREFIX        PIC X(4).
  7460                     28  CO-RESP-PRIME         PIC X(6).
  7461             20  CO-CTL-2.
  7462                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 140
* EL156.cbl
  7463                     28  CO-ACCT-PREFIX        PIC X(4).
  7464                     28  CO-ACCT-PRIME         PIC X(6).
  7465         16  CO-TYPE                           PIC X.
  7466             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7467             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7468             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7469
  7470     12  CO-MAINT-INFORMATION.
  7471         16  CO-LAST-MAINT-DT                  PIC XX.
  7472         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7473         16  CO-LAST-MAINT-USER                PIC X(4).
  7474     12  FILLER                                PIC XX.
  7475     12  CO-STMT-TYPE                          PIC XXX.
  7476     12  CO-COMP-TYPE                          PIC X.
  7477         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7478     12  CO-STMT-OWNER                         PIC X(4).
  7479     12  CO-BALANCE-CONTROL                    PIC X.
  7480         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7481         88  CO-NO-BALANCE                        VALUE 'N'.
  7482
  7483     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7484         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7485         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7486         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7487
  7488     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7489         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7490         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7491
  7492     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7493     12  CO-GA-DIRECT-DEP                      PIC X.
  7494     12  CO-FUTURE-SPACE                       PIC X.
  7495         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7496
  7497     12  CO-ACCT-NAME                          PIC X(30).
  7498     12  CO-MAIL-NAME                          PIC X(30).
  7499     12  CO-ADDR-1                             PIC X(30).
  7500     12  CO-ADDR-2                             PIC X(30).
  7501     12  CO-ADDR-3.
  7502         16  CO-ADDR-CITY                      PIC X(27).
  7503         16  CO-ADDR-STATE                     PIC XX.
  7504     12  CO-CSO-1099                           PIC X.
  7505     12  CO-ZIP.
  7506         16  CO-ZIP-PRIME.
  7507             20  CO-ZIP-PRI-1ST                PIC X.
  7508                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7509             20  FILLER                        PIC X(4).
  7510         16  CO-ZIP-PLUS4                      PIC X(4).
  7511     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7512         16  CO-CAN-POSTAL-1                   PIC XXX.
  7513         16  CO-CAN-POSTAL-2                   PIC XXX.
  7514         16  FILLER                            PIC XXX.
  7515     12  CO-SOC-SEC                            PIC X(13).
  7516     12  CO-TELEPHONE.
  7517         16  CO-AREA-CODE                      PIC XXX.
  7518         16  CO-PREFIX                         PIC XXX.
  7519         16  CO-PHONE                          PIC X(4).
  7520
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 141
* EL156.cbl
  7521     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7522
  7523     12  CO-AR-BAL-LEVEL                       PIC X.
  7524         88  CO-AR-REF-LVL                        VALUE '1'.
  7525         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7526         88  CO-AR-BILL-LVL                       VALUE '2'.
  7527         88  CO-AR-AGT-LVL                        VALUE '3'.
  7528         88  CO-AR-FR-LVL                         VALUE '4'.
  7529
  7530     12  CO-AR-NORMAL-PRINT                    PIC X.
  7531         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7532         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7533
  7534     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7535
  7536     12  CO-AR-REPORTING                       PIC X.
  7537         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7538         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7539
  7540     12  CO-AR-PULL-CHECK                      PIC X.
  7541         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7542         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7543
  7544     12  CO-AR-BALANCE-PRINT                   PIC X.
  7545         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7546
  7547     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7548         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7549         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7550         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7551
  7552     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7553
  7554     12  CO-USER-CODE                          PIC X.
  7555     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7556
  7557******************************************************************
  7558*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7559*    THE LAST MONTH END RUN.
  7560******************************************************************
  7561
  7562     12  CO-LAST-ACTIVITY-DATE.
  7563         16  CO-ACT-YEAR                       PIC 99.
  7564         16  CO-ACT-MONTH                      PIC 99.
  7565         16  CO-ACT-DAY                        PIC 99.
  7566
  7567     12  CO-LAST-STMT-DT.
  7568         16  CO-LAST-STMT-YEAR                 PIC 99.
  7569         16  CO-LAST-STMT-MONTH                PIC 99.
  7570         16  CO-LAST-STMT-DAY                  PIC 99.
  7571
  7572     12  CO-MO-END-TOTALS.
  7573         16  CO-MONTHLY-TOTALS.
  7574             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7575             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7576             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7577             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7578             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 142
* EL156.cbl
  7579
  7580         16  CO-AGING-TOTALS.
  7581             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7582             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7583             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7584             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7585
  7586         16  CO-YTD-TOTALS.
  7587             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7588             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7589
  7590         16  CO-OVER-UNDER-TOTALS.
  7591             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7592             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7593
  7594     12  CO-MISCELLANEOUS-TOTALS.
  7595         16  CO-FICA-TOTALS.
  7596             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7597             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7598
  7599         16  CO-CLAIM-TOTALS.
  7600             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7601             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7602
  7603******************************************************************
  7604*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7605*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7606******************************************************************
  7607
  7608     12  CO-CURRENT-TOTALS.
  7609         16  CO-CURRENT-LAST-STMT-DT.
  7610             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7611             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7612             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7613
  7614         16  CO-CURRENT-MONTHLY-TOTALS.
  7615             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7616             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7617             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7618             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7619             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7620
  7621         16  CO-CURRENT-AGING-TOTALS.
  7622             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7623             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7624             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7625             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7626
  7627         16  CO-CURRENT-YTD-TOTALS.
  7628             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7629             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7630
  7631     12  CO-PAID-COMM-TOTALS.
  7632         16  CO-YTD-PAID-COMMS.
  7633             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7634             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7635
  7636     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 143
* EL156.cbl
  7637         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7638         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7639
  7640     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7641         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7642         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7643         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7644         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7645         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7646         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7647         88  CO-FINAL-LETTER                  VALUE 'F'.
  7648         88  CO-RECONCILING                   VALUE 'R'.
  7649         88  CO-PHONE-CALL                    VALUE 'P'.
  7650         88  CO-LEGAL                         VALUE 'L'.
  7651         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7652         88  CO-WRITE-OFF                     VALUE 'W'.
  7653         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7654
  7655     12  CO-CSR-CODE                       PIC X(4).
  7656
  7657     12  CO-GA-STATUS-INFO.
  7658         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7659         16  CO-GA-TERMINATION-DT          PIC XX.
  7660         16  CO-GA-STATUS-CODE             PIC X.
  7661             88  CO-GA-ACTIVE                 VALUE 'A'.
  7662             88  CO-GA-INACTIVE               VALUE 'I'.
  7663             88  CO-GA-PENDING                VALUE 'P'.
  7664         16  CO-GA-COMMENTS.
  7665             20  CO-GA-COMMENT-1           PIC X(40).
  7666             20  CO-GA-COMMENT-2           PIC X(40).
  7667             20  CO-GA-COMMENT-3           PIC X(40).
  7668             20  CO-GA-COMMENT-4           PIC X(40).
  7669
  7670     12  CO-RPTCD2                         PIC X(10).
  7671     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7672         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7673         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7674
  7675     12  CO-TYPE-AGENT                     PIC X(01).
  7676         88  CO-CORPORATION                   VALUE 'C'.
  7677         88  CO-PARTNERSHIP                   VALUE 'P'.
  7678         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7679         88  CO-TRUST                         VALUE 'T'.
  7680         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7681
  7682     12  CO-FAXNO.
  7683         16  CO-FAX-AREA-CODE                  PIC XXX.
  7684         16  CO-FAX-PREFIX                     PIC XXX.
  7685         16  CO-FAX-PHONE                      PIC X(4).
  7686
  7687     12  CO-BANK-INFORMATION.
  7688         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7689         16  CO-BANK-TRANSIT-NON REDEFINES
  7690             CO-BANK-TRANSIT-NO                PIC 9(8).
  7691
  7692         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7693     12  CO-MISC-DEDUCT-INFO REDEFINES
  7694                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 144
* EL156.cbl
  7695         16  CO-MD-GL-ACCT                     PIC X(10).
  7696         16  CO-MD-DIV                         PIC XX.
  7697         16  CO-MD-CENTER                      PIC X(4).
  7698         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7699         16  CO-CREATE-AP-CHECK                PIC X.
  7700         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7701         16  FILLER                            PIC XXX.
  7702     12  CO-ACH-STATUS                         PIC X.
  7703         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7704         88  CO-ACH-PENDING                        VALUE 'P'.
  7705
  7706     12  CO-BILL-SW                            PIC X.
  7707     12  CO-CONTROL-NAME                       PIC X(30).
  7708     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7709     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7710     12  CO-CLP-STATE                          PIC XX.
  7711     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7712     12  CO-SPP-REFUND-EDIT                    PIC X.
  7713
  7714******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 145
* EL156.cbl
  7716*    COPY ERCDMDNT.
  7717******************************************************************
  7718*                                                                *
  7719*                            ERCDMDNT                            *
  7720*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7721*                            VMOD=2.005                          *
  7722*                                                                *
  7723*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7724*                                                                *
  7725*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7726*                                                                *
  7727*        FILE TYPE= VSAM,KSDS                                    *
  7728*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7729*                                                                *
  7730*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7731*                                                                *
  7732*        LOG = YES                                               *
  7733*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7734*                                                                *
  7735******************************************************************
  7736
  7737 01  CERTIFICATE-NOTE.
  7738     12  CN-RECORD-ID                     PIC  XX.
  7739         88  VALID-CN-ID                      VALUE 'CN'.
  7740
  7741     12  CN-CONTROL-PRIMARY.
  7742         16  CN-COMPANY-CD                PIC X.
  7743         16  CN-CERT-KEY.
  7744             20  CN-CARRIER               PIC X.
  7745             20  CN-GROUPING.
  7746                 24  CN-GROUPING-PREFIX   PIC XXX.
  7747                 24  CN-GROUPING-PRIME    PIC XXX.
  7748             20  CN-STATE                 PIC XX.
  7749             20  CN-ACCOUNT.
  7750                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7751                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7752             20  CN-CERT-EFF-DT           PIC XX.
  7753             20  CN-CERT-NO.
  7754                 24  CN-CERT-PRIME        PIC X(10).
  7755                 24  CN-CERT-SFX          PIC X.
  7756
  7757     12  CN-BILLING-START-LINE-NO         PIC 99.
  7758     12  CN-BILLING-END-LINE-NO           PIC 99.
  7759
  7760     12  CN-LINES.
  7761         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7762
  7763     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7764         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7765         16  CN-CSI-GENERAL-DATA-AREA.
  7766             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7767
  7768         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7769             CN-CSI-GENERAL-DATA-AREA.
  7770             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7771             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7772             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7773             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 146
* EL156.cbl
  7774             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7775             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7776             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7777             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7778             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7779             20  FILLER                       PIC XX.
  7780             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7781             20  FILLER                       PIC X(38).
  7782
  7783         16  CN-CSI-PRODUCT-DATA-AREA.
  7784             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7785
  7786         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7787             CN-CSI-PRODUCT-DATA-AREA.
  7788             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7789             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7790             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7791             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7792             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7793             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7794             20  FILLER                   PIC XX.
  7795             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7796             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7797             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7798             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7799             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7800             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7801             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7802             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7803             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7804             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7805             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7806             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7807             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7808             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7809             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7810             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7811             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7812             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7813             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7814             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7815             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7816             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7817             20  FILLER                   PIC X(25).
  7818
  7819         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7820             CN-CSI-CREDIT-CARD-DATA.
  7821             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7822             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7823             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7824             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7825             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7826             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7827             20  FILLER                   PIC XX.
  7828             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7829             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7830             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7831             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 147
* EL156.cbl
  7832             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7833             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7834             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7835             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7836             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7837             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7838             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7839             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7840             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7841             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7842             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7843             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7844             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7845             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7846             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7847             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7848             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7849             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7850             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7851             20  FILLER                   PIC X(17).
  7852
  7853         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7854             CN-CSI-FAMILY-LEAVE-DATA.
  7855             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7856             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7857             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7858             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7859             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7860             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7861             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7862             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7863             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7864             20  CN-CSI-SL-INT-ON-PROCEEDS
  7865                                          PIC S9(5)V99  COMP-3.
  7866             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7867             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7868             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7869             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7870             20  CN-CSI-SL-POLICY-BENEFITS
  7871                                          PIC S9(5)V99  COMP-3.
  7872             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7873             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7874             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7875             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7876             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7877             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7878             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7879             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7880             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7881             20  CN-CSI-SL-STATE-NOT      PIC X.
  7882             20  FILLER                   PIC XX.
  7883
  7884         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7885             CN-CSI-SENIOR-LIFE-DATA.
  7886             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7887             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7888             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7889                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 148
* EL156.cbl
  7890             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7891             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7892             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7893             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7894             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7895             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7896             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7897             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7898             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7899             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7900             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7901             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7902             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7903             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7904             20  CN-CSI-PP-REPAIR         PIC X.
  7905             20  CN-CSI-PP-REPLACE        PIC X.
  7906             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7907             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7908             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7909             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7910             20  FILLER                   PIC X(5).
  7911
  7912         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7913             CN-CSI-PURCH-PROP-DATA.
  7914             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7915             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7916             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7917             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7918             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7919             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7920             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7921             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7922             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7923             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7924             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7925             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7926             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7927             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7928             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7929             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7930             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7931             20  CN-CSI-EW-REPLACE        PIC X.
  7932             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7933             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7934             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7935             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7936             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7937             20  FILLER                   PIC X(4).
  7938
  7939     12  CN-LAST-MAINT-DT                 PIC XX.
  7940     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7941     12  CN-LAST-MAINT-USER               PIC X(4).
  7942     12  FILLER                           PIC X(6).
  7943
  7944******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 149
* EL156.cbl
  7946*    COPY ERCCNOT.
  7947******************************************************************
  7948*                                                                *
  7949*                            ERCCNOT                             *
  7950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7951*                            VMOD=2.003                          *
  7952*                                                                *
  7953*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7954*                                                                *
  7955*        FILE TYPE= VSAM,KSDS                                    *
  7956*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7957*                                                                *
  7958*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7959*                                                                *
  7960*        LOG = YES                                               *
  7961*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7962*                                                                *
  7963******************************************************************
  7964*                   C H A N G E   L O G
  7965*
  7966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7967*-----------------------------------------------------------------
  7968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7969* EFFECTIVE    NUMBER
  7970*-----------------------------------------------------------------
  7971* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7972******************************************************************
  7973
  7974 01  CERT-NOTE-FILE.
  7975     12  CZ-RECORD-ID                PIC  XX.
  7976         88  VALID-CZ-ID                  VALUE 'CZ'.
  7977
  7978     12  CZ-CONTROL-PRIMARY.
  7979         16  CZ-COMPANY-CD           PIC X.
  7980         16  CZ-CARRIER              PIC X.
  7981         16  CZ-GROUPING.
  7982             20 CZ-GROUPING-PREFIX   PIC XXX.
  7983             20 CZ-GROUPING-PRIME    PIC XXX.
  7984         16  CZ-STATE                PIC XX.
  7985         16  CZ-ACCOUNT.
  7986             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7987             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7988         16  CZ-CERT-EFF-DT          PIC XX.
  7989         16  CZ-CERT-NO.
  7990             20  CZ-CERT-PRIME       PIC X(10).
  7991             20  CZ-CERT-SFX         PIC X.
  7992         16  CZ-RECORD-TYPE          PIC X.
  7993             88  CERT-NOTE           VALUE '1'.
  7994             88  CLAIM-CERT-NOTE     VALUE '2'.
  7995         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7996
  7997     12  CZ-LAST-MAINT-DT            PIC XX.
  7998     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7999     12  CZ-LAST-MAINT-USER          PIC X(4).
  8000
  8001     12  CZ-NOTE-INFORMATION.
  8002         16  CZ-NOTE                 PIC X(63).
  8003         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 150
* EL156.cbl
  8004******************************************************************
  8005*                            COPY ERCPDEF.
  8006******************************************************************
  8007*                                                                *
  8008*                                                                *
  8009*                            ERCPDEF.                            *
  8010*                                                                *
  8011*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8012*                                                                *
  8013*    FILE TYPE = VSAM,KSDS                                       *
  8014*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8015*                                                                *
  8016*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8017*                                                                *
  8018*    LOG = YES                                                   *
  8019*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8020******************************************************************
  8021*                   C H A N G E   L O G
  8022*
  8023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8024*-----------------------------------------------------------------
  8025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8026* EFFECTIVE    NUMBER
  8027*-----------------------------------------------------------------
  8028* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8029* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8030* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8031******************************************************************
  8032 01  PRODUCT-MASTER.
  8033    12  PD-RECORD-ID                 PIC X(02).
  8034        88  VALID-PD-ID                  VALUE 'PD'.
  8035    12  PD-CONTROL-PRIMARY.
  8036        16  PD-COMPANY-CD            PIC X.
  8037        16  PD-STATE                 PIC XX.
  8038        16  PD-PRODUCT-CD            PIC XXX.
  8039        16  PD-FILLER                PIC X(7).
  8040        16  PD-BEN-TYPE              PIC X.
  8041        16  PD-BEN-CODE              PIC XX.
  8042        16  PD-PROD-EXP-DT           PIC XX.
  8043    12  FILLER                       PIC X(50).
  8044    12  PD-PRODUCT-DATA OCCURS 8.
  8045        16  PD-PROD-CODE             PIC X.
  8046            88  PD-PROD-LIFE           VALUE 'L'.
  8047            88  PD-PROD-PROP           VALUE 'P'.
  8048            88  PD-PROD-AH             VALUE 'A'.
  8049            88  PD-PROD-IU             VALUE 'I'.
  8050            88  PD-PROD-GAP            VALUE 'G'.
  8051            88  PD-PROD-FAML           VALUE 'F'.
  8052        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8053        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8054        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8055        16  PD-MAX-TERM              PIC S999        COMP-3.
  8056        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8057        16  FILLER                   PIC X.
  8058        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8059        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8060        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8061        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 151
* EL156.cbl
  8062        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8063        16  PD-REC-CRIT-PERIOD       PIC 99.
  8064        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8065            20  PD-RECURRING-YN      PIC X.
  8066            20  FILLER               PIC X.
  8067        16  PD-RTW-MOS               PIC 99.
  8068        16  PD-MAX-EXTENSION         PIC 99.
  8069        16  pd-ben-pct               pic sv999 comp-3.
  8070*       16  FILLER                   PIC XX.
  8071    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8072    12  PD-TERM-LIMITS OCCURS 15.
  8073        16  PD-LOW-TERM              PIC S999        COMP-3.
  8074        16  PD-HI-TERM               PIC S999        COMP-3.
  8075*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8076    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8077        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8078        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8079    12  PD-EARN-FACTORS.
  8080        16  FILLER OCCURS 15.
  8081            20  FILLER OCCURS 15.
  8082                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8083    12  PD-PRODUCT-DESC              PIC X(80).
  8084    12  PD-TRUNCATED                 PIC X.
  8085    12  FILLER                       PIC X(59).
  8086    12  PD-MAINT-INFORMATION.
  8087        16  PD-LAST-MAINT-DT         PIC X(02).
  8088        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8089        16  PD-LAST-MAINT-BY         PIC X(04).
  8090*                            COPY ELCCRTT.
  8091******************************************************************
  8092*                                                                *
  8093*                            ELCCRTT.                            *
  8094*                                                                *
  8095*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8096*                                                                *
  8097*   FILE TYPE = VSAM,KSDS                                        *
  8098*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8099*                                                                *
  8100*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8101*                                                                *
  8102*   LOG = YES                                                    *
  8103*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8104******************************************************************
  8105*                   C H A N G E   L O G
  8106*
  8107* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8108*-----------------------------------------------------------------
  8109*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8110* EFFECTIVE    NUMBER
  8111*-----------------------------------------------------------------
  8112* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8113* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8114* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8115* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8116* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8117* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8118* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8119* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 152
* EL156.cbl
  8120* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8121******************************************************************
  8122
  8123 01  CERTIFICATE-TRAILERS.
  8124     12  CS-RECORD-ID                      PIC XX.
  8125         88  VALID-CS-ID                      VALUE 'CS'.
  8126
  8127     12  CS-CONTROL-PRIMARY.
  8128         16  CS-COMPANY-CD                 PIC X.
  8129         16  CS-CARRIER                    PIC X.
  8130         16  CS-GROUPING                   PIC X(6).
  8131         16  CS-STATE                      PIC XX.
  8132         16  CS-ACCOUNT                    PIC X(10).
  8133         16  CS-CERT-EFF-DT                PIC XX.
  8134         16  CS-CERT-NO.
  8135             20  CS-CERT-PRIME             PIC X(10).
  8136             20  CS-CERT-SFX               PIC X.
  8137         16  CS-TRAILER-TYPE               PIC X.
  8138             88  COMM-TRLR           VALUE 'A'.
  8139             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8140             88  CERT-DATA-TRLR      VALUE 'C'.
  8141
  8142     12  CS-DATA-AREA                      PIC X(516).
  8143
  8144     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8145         16  CS-BANK-COMMISSION-AREA.
  8146             20  CS-BANK-COMMS       OCCURS 10.
  8147                 24  CS-AGT                PIC X(10).
  8148                 24  CS-COM-TYP            PIC X.
  8149                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8150                 24  CS-RECALC-LV-INDIC    PIC X.
  8151                 24  FILLER                PIC X(10).
  8152         16  FILLER                        PIC X(256).
  8153
  8154     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8155****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8156         16  CS-MB-CLAIM-DATA OCCURS 24.
  8157             20  CS-CLAIM-NO               PIC X(7).
  8158             20  CS-CLAIM-TYPE             PIC X.
  8159                 88  CS-AH-CLM               VALUE 'A'.
  8160                 88  CS-IU-CLM               VALUE 'I'.
  8161                 88  CS-GP-CLM               VALUE 'G'.
  8162                 88  CS-LF-CLM               VALUE 'L'.
  8163                 88  CS-PR-CLM               VALUE 'P'.
  8164                 88  CS-FL-CLM               VALUE 'F'.
  8165             20  CS-INSURED-TYPE           PIC X.
  8166                 88  CS-PRIM-INSURED          VALUE 'P'.
  8167                 88  CS-CO-BORROWER           VALUE 'C'.
  8168             20  CS-BENEFIT-PERIOD         PIC 99.
  8169             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8170             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8171             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8172         16  FILLER                        PIC X(12).
  8173     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8174         16  CS-VIN-NUMBER                 PIC X(17).
  8175         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8176         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8177         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 153
* EL156.cbl
  8178         16  cs-agent-name.
  8179             20  cs-agent-fname            pic x(20).
  8180             20  cs-agent-mi               pic x.
  8181             20  cs-agent-lname            pic x(25).
  8182         16  cs-license-no                 pic x(15).
  8183         16  cs-npn-number                 pic x(10).
  8184         16  cs-agent-edit-status          pic x.
  8185             88  cs-ae-refer-to-manager      value 'M'.
  8186             88  cs-ae-cover-sheet           value 'C'.
  8187             88  cs-ae-sig-form              value 'S'.
  8188             88  cs-ae-verified              value 'V'.
  8189             88  cs-unidentified-signature   value 'U'.
  8190             88  cs-cert-returned            value 'R'.
  8191             88  cs-accept-no-commission     value 'N'.
  8192         16  cs-year                       pic 9999.
  8193         16  cs-make                       pic x(20).
  8194         16  cs-model                      pic x(20).
  8195         16  cs-future                     pic x(20).
  8196         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8197         16  FILLER                        PIC X(356). *> was 420
  8198*        16  FILLER                        PIC X(496).
  8199 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8200                          CONTROL-FILE CERTIFICATE-MASTER
  8201                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8202                          ACCOUNT-MASTER CHECK-QUE
  8203                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8204                          DAILY-ACTIVITY-RECORD
  8205                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8206                          CERT-NOTE-FILE PRODUCT-MASTER
  8207                          CERTIFICATE-TRAILERS.
  8208 0000-DFHEXIT SECTION.
  8209     MOVE '9#                    $   ' TO DFHEIV0.
  8210     MOVE 'EL156' TO DFHEIV1.
  8211     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8212
  8213     IF EIBCALEN = 0
  8214         GO TO 8800-UNAUTHORIZED-ACCESS.
  8215
  8216     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8217     MOVE EIBTRMID               TO QID-TERM.
  8218     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8219     MOVE '2'                    TO EMI-SWITCH2.
  8220     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8221     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8222
  8223     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8224     MOVE '5'                    TO DC-OPTION-CODE.
  8225     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8226     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8227                                    SAVE-BIN-DATE.
  8228     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8229     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8230
  8231     IF SAVE-DATE-YY > 70
  8232         MOVE 19                 TO SAVE-DATE-CC
  8233     ELSE
  8234         MOVE 20                 TO SAVE-DATE-CC.
  8235
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 154
* EL156.cbl
  8236     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8237         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8238     END-IF.
  8239
  8240     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8241        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8242     ELSE
  8243        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8244     END-IF
  8245
  8246     IF PI-PRINT-CLM-FRM-YN = 'N'
  8247         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8248     ELSE
  8249         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8250     END-IF
  8251
  8252     IF PI-PRINT-SURVEY-YN = 'N'
  8253         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8254     ELSE
  8255         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8256     END-IF
  8257
  8258     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8259         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8260     ELSE
  8261         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8262     END-IF
  8263
  8264* EXEC CICS HANDLE CONDITION
  8265*        NOTOPEN   (9990-ABEND)
  8266*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8267*        MAPFAIL   (0400-FIRST-TIME)
  8268*        DUPREC    (6180-DUPREC)
  8269*        ERROR     (9990-ABEND)
  8270*    END-EXEC.
  8271*    MOVE '"$JL?%.               ! " #00008259' TO DFHEIV0
  8272     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8274     MOVE X'2220233030303038323539' TO DFHEIV0(25:11)
  8275     CALL 'kxdfhei1' USING DFHEIV0
  8276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8277
  8278
  8279     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8280         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8281
  8282     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8283         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8284             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8285             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8286             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8287             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8288             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8289             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8290             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8291             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8292             MOVE LOW-VALUES           TO EL156AI
  8293             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 155
* EL156.cbl
  8294         ELSE
  8295             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8296             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8297             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8298             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8299             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8300             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8301             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8302             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8303
  8304     IF RETURNED-FROM NOT = SPACES
  8305        IF (RETURNED-FROM = 'EL614')
  8306           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8307           IF WS-SAVED-EOB-CODES NOT = SPACES
  8308              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8309           ELSE
  8310              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8311           END-IF
  8312        END-IF
  8313         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8314            MOVE 'Y'             TO FIRST-ENTRY
  8315            IF RETURNED-FROM = 'EL614'
  8316               AND (PI-PASS-SW NOT = 'C')
  8317               IF WS-SAVED-EOB-CODES NOT = SPACES
  8318                  MOVE WS-SAVED-EOB-CODES
  8319                                 TO PI-PMTNOTE2
  8320                                    WS-PMTNOTE2
  8321                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8322               ELSE
  8323                  MOVE SPACES    TO PI-PMTNOTE2
  8324                                    WS-PMTNOTE2
  8325                                    PI-EOB-CODES-EXIST
  8326               END-IF
  8327            END-IF
  8328            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8329            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8330            IF RETURNED-FROM = 'EL614'
  8331               GO TO 1000-EDIT-DATA
  8332            END-IF
  8333            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8334               (PAYEEI   = LOW-VALUES OR SPACES)
  8335               GO TO 8100-SEND-INITIAL-MAP
  8336            ELSE
  8337               GO TO 1000-EDIT-DATA.
  8338
  8339     IF EIBTRNID NOT = TRANS-ID
  8340         GO TO 0400-FIRST-TIME.
  8341
  8342     IF EIBAID = DFHCLEAR
  8343        IF PI-PASS-SW = 'C'
  8344           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8345           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8346           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8347           MOVE 'Y'            TO RETURNED-FROM-B
  8348           GO TO 1000-EDIT-DATA
  8349        ELSE
  8350           GO TO 9400-CLEAR.
  8351
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 156
* EL156.cbl
  8352     IF PI-PASS-SW = 'C'
  8353         MOVE MAP-NAMEB          TO MAP-NAME
  8354         IF EIBAID = DFHPF1 OR DFHPF13
  8355             GO TO 5000-UPDATE
  8356           ELSE
  8357             IF EIBAID NOT = DFHENTER
  8358                 MOVE LOW-VALUES TO EL156BI
  8359                 MOVE MAP-NAMEB  TO MAP-NAME
  8360                 MOVE ER-0029    TO EMI-ERROR
  8361                 MOVE -1         TO  ENTPFBL
  8362                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8363                 GO TO 8200-SEND-DATAONLY.
  8364
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 157
* EL156.cbl
  8366 0200-RECEIVE.
  8367     MOVE LOW-VALUES             TO EL156AI.
  8368     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8369         MOVE ER-0008            TO EMI-ERROR
  8370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371         IF PI-PASS-SW = 'C'
  8372             MOVE -1             TO ENTPFBL
  8373             GO TO 8200-SEND-DATAONLY
  8374         ELSE
  8375             MOVE -1             TO PMTTYPEL
  8376             GO TO 8200-SEND-DATAONLY.
  8377
  8378     IF PI-COMPANY-ID = 'DMD'
  8379         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8380
  8381     IF PI-PASS-SW = 'C'
  8382         MOVE MAP-NAMEB          TO MAP-NAME.
  8383
  8384
  8385* EXEC CICS RECEIVE
  8386*        MAP   (MAP-NAME)
  8387*        MAPSET(MAPSET-NAME)
  8388*        ASIS
  8389*        INTO  (EL156AI)
  8390*    END-EXEC.
  8391     MOVE LENGTH OF
  8392      EL156AI
  8393       TO DFHEIV11
  8394*    MOVE '8"TAI  L              ''   #00008372' TO DFHEIV0
  8395     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038333732' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           MAP-NAME,
  8400           EL156AI,
  8401           DFHEIV11,
  8402           MAPSET-NAME,
  8403           DFHEIV99,
  8404           DFHEIV99
  8405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8406
  8407
  8408     IF PI-PASS-SW NOT = 'C'
  8409         GO TO 0250-MAPA.
  8410
  8411     IF ENTPFBL NOT > ZERO
  8412         MOVE MAP-NAMEB          TO MAP-NAME
  8413         MOVE ER-0029            TO EMI-ERROR
  8414         MOVE -1                 TO  ENTPFBL
  8415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416         GO TO 8200-SEND-DATAONLY.
  8417
  8418     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8419         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8420       ELSE
  8421         MOVE MAP-NAMEB           TO MAP-NAME
  8422         MOVE ER-0029             TO EMI-ERROR
  8423         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 158
* EL156.cbl
  8424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8425         GO TO 8200-SEND-DATAONLY.
  8426
  8427     IF EIBAID = DFHPF1 OR DFHPF13
  8428         IF MODIFY-CAP
  8429            GO TO 5000-UPDATE
  8430          ELSE
  8431            MOVE 'UPDATE'           TO SM-READ
  8432            PERFORM 9995-SECURITY-VIOLATION
  8433            MOVE MAP-NAMEB          TO MAP-NAME
  8434            MOVE ER-0070            TO EMI-ERROR
  8435            MOVE -1                 TO  ENTPFBL
  8436            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8437            GO TO 8200-SEND-DATAONLY.
  8438
  8439 0250-MAPA.
  8440     IF ENTERPFL = 0
  8441         GO TO 0300-CHECK-PFKEYS.
  8442
  8443     IF EIBAID NOT = DFHENTER
  8444         MOVE ER-0004            TO EMI-ERROR
  8445         GO TO 0320-INPUT-ERROR.
  8446
  8447     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8448         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8449     ELSE
  8450         MOVE ER-0029            TO EMI-ERROR
  8451         GO TO 0320-INPUT-ERROR.
  8452
  8453 0300-CHECK-PFKEYS.
  8454     IF EIBAID = DFHPF7 OR DFHPF8
  8455         GO TO 8820-PF7-8.
  8456
  8457     IF EIBAID = DFHPF23
  8458         GO TO 8810-PF23.
  8459
  8460     IF EIBAID = DFHPF24
  8461         GO TO 9200-RETURN-MAIN-MENU.
  8462
  8463     IF EIBAID = DFHPF12
  8464         GO TO 9500-PF12.
  8465
  8466     IF EIBAID = DFHPF1
  8467        IF PI-PASS-SW = 'A' OR 'B'
  8468          GO TO 0330-BROWSE-FORWARD.
  8469
  8470     IF EIBAID = DFHPF2
  8471        IF PI-PASS-SW = 'A' OR 'B'
  8472          GO TO 0350-BROWSE-BACKWARD.
  8473
  8474     IF EIBAID = DFHPF6
  8475        IF PI-EOB-CODES-EXIST = 'Y'
  8476           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8477        ELSE
  8478           MOVE SPACES              TO WS-PMTNOTE2
  8479        END-IF
  8480         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8481         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 159
* EL156.cbl
  8482            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8483         END-IF
  8484         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8485         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8486             MOVE 'EL614'        TO PGM-NAME
  8487             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8488             GO TO 9300-XCTL
  8489         ELSE
  8490             MOVE XCTL-157       TO PGM-NAME
  8491             GO TO 9300-XCTL.
  8492
  8493     IF EIBAID = DFHPF9
  8494        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8495        MOVE XCTL-141            TO PGM-NAME
  8496        GO TO 9300-XCTL.
  8497
  8498     IF EIBAID = DFHPF10
  8499        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8500        MOVE XCTL-155            TO PGM-NAME
  8501        GO TO 9300-XCTL.
  8502
  8503     MOVE SPACES                 TO ERRMSG0O
  8504                                    ERRMSG1O
  8505                                    ERRMSG2O.
  8506
  8507     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8508         IF PI-PASS-SW NOT = 'B'
  8509             MOVE ER-0422        TO EMI-ERROR
  8510             GO TO 0320-INPUT-ERROR
  8511           ELSE
  8512             GO TO 0700-TEST-FOR-CHANGES.
  8513
  8514     IF EIBAID = DFHPF11
  8515        IF PI-PASS-SW = 'C'
  8516           MOVE ER-0029          TO EMI-ERROR
  8517           GO TO 0320-INPUT-ERROR.
  8518
  8519     IF EIBAID = DFHENTER OR DFHPF11
  8520        NEXT SENTENCE
  8521     ELSE
  8522        MOVE ER-0029             TO EMI-ERROR
  8523        GO TO 0320-INPUT-ERROR.
  8524
  8525     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8526
  8527     if pi-epyfrom not = zeros
  8528        if pi-epyfrom not = ws-epyfrom
  8529           move zeros        to ws-edays
  8530        end-if
  8531     end-if
  8532
  8533     if pi-epythru not = zeros
  8534        if pi-epythru not = ws-epythru
  8535           move zeros        to ws-edays
  8536        end-if
  8537     end-if
  8538
  8539     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 160
* EL156.cbl
  8540         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8541         GO TO 1000-EDIT-DATA
  8542     ELSE
  8543         IF PI-FATAL-COUNT NOT = 0 OR
  8544            PI-FORCE-COUNT NOT = 0
  8545             GO TO 1000-EDIT-DATA
  8546         ELSE
  8547             GO TO 2000-EDIT-DONE.
  8548
  8549 0320-INPUT-ERROR.
  8550     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8551
  8552     IF ENTERPFL = 0
  8553         MOVE -1                 TO PMTTYPEL
  8554     ELSE
  8555         MOVE AL-UNBON           TO ENTERPFA
  8556         MOVE -1                 TO ENTERPFL.
  8557
  8558     GO TO 8200-SEND-DATAONLY.
  8559
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 161
* EL156.cbl
  8561 0330-BROWSE-FORWARD.
  8562
  8563     MOVE CLMNOI            TO PI-CLAIM-NO.
  8564     MOVE CARRI             TO PI-CARRIER.
  8565     MOVE CERTNOI           TO PI-CERT-PRIME.
  8566     MOVE SUFXI             TO PI-CERT-SFX.
  8567
  8568     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8569     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8570     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8571     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8572
  8573     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8574
  8575
  8576* EXEC CICS HANDLE CONDITION
  8577*         NOTFND   (0380-CLAIM-END-FILE)
  8578*         ENDFILE  (0380-CLAIM-END-FILE)
  8579*    END-EXEC.
  8580*    MOVE '"$I''                  ! # #00008546' TO DFHEIV0
  8581     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8583     MOVE X'2320233030303038353436' TO DFHEIV0(25:11)
  8584     CALL 'kxdfhei1' USING DFHEIV0
  8585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8586
  8587
  8588
  8589* EXEC CICS STARTBR
  8590*         DATASET    ('ELMSTR')
  8591*         RIDFLD     (ELMSTR-KEY)
  8592*         GTEQ
  8593*    END-EXEC.
  8594     MOVE 'ELMSTR' TO DFHEIV1
  8595     MOVE 0
  8596       TO DFHEIV11
  8597*    MOVE '&,         G          &   #00008551' TO DFHEIV0
  8598     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8600     MOVE X'2020233030303038353531' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0,
  8602           DFHEIV1,
  8603           ELMSTR-KEY,
  8604           DFHEIV99,
  8605           DFHEIV11,
  8606           DFHEIV99
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8608
  8609
  8610     MOVE 'Y' TO WS-BROWSE-START-SW.
  8611
  8612 0335-READNEXT.
  8613
  8614
  8615* EXEC CICS READNEXT
  8616*         DATASET    ('ELMSTR')
  8617*         RIDFLD     (ELMSTR-KEY)
  8618*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 162
* EL156.cbl
  8619*    END-EXEC.
  8620     MOVE 'ELMSTR' TO DFHEIV1
  8621     MOVE 0
  8622       TO DFHEIV11
  8623*    MOVE '&.S                   )   #00008561' TO DFHEIV0
  8624     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8625     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8626     MOVE X'2020233030303038353631' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0,
  8628           DFHEIV1,
  8629           DFHEIV20,
  8630           DFHEIV99,
  8631           ELMSTR-KEY,
  8632           DFHEIV99,
  8633           DFHEIV11,
  8634           DFHEIV99,
  8635           DFHEIV99
  8636     SET ADDRESS OF CLAIM-MASTER TO
  8637         DFHEIV20
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8639
  8640
  8641     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8642        GO TO 0380-CLAIM-END-FILE.
  8643
  8644     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8645        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8646        GO TO 0335-READNEXT.
  8647
  8648     IF PI-COMPANY-ID = 'CRI'
  8649         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8650            GO TO 0380-CLAIM-END-FILE.
  8651
  8652     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8653         GO TO 0335-READNEXT.
  8654
  8655     IF PI-CARRIER-SECURITY > SPACES
  8656         IF CL-CARRIER = PI-CARRIER-SECURITY
  8657             NEXT SENTENCE
  8658         ELSE
  8659             GO TO 0335-READNEXT.
  8660
  8661     IF PI-ACCOUNT-SECURITY > SPACES
  8662         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8663             NEXT SENTENCE
  8664         ELSE
  8665             GO TO 0335-READNEXT.
  8666
  8667     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8668     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8669     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8670
  8671     GO TO 0400-FIRST-TIME.
  8672
  8673 0350-BROWSE-BACKWARD.
  8674
  8675     MOVE CLMNOI            TO PI-CLAIM-NO
  8676                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 163
* EL156.cbl
  8677     MOVE CARRI             TO PI-CARRIER.
  8678     MOVE CERTNOI           TO PI-CERT-PRIME.
  8679     MOVE SUFXI             TO PI-CERT-SFX.
  8680
  8681     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8682
  8683     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8684     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8685     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8686
  8687
  8688* EXEC CICS HANDLE CONDITION
  8689*         NOTFND   (0380-CLAIM-END-FILE)
  8690*         ENDFILE  (0380-CLAIM-END-FILE)
  8691*    END-EXEC.
  8692*    MOVE '"$I''                  ! $ #00008613' TO DFHEIV0
  8693     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8695     MOVE X'2420233030303038363133' TO DFHEIV0(25:11)
  8696     CALL 'kxdfhei1' USING DFHEIV0
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8698
  8699
  8700
  8701* EXEC CICS STARTBR
  8702*         DATASET    ('ELMSTR')
  8703*         RIDFLD     (ELMSTR-KEY)
  8704*         GTEQ
  8705*    END-EXEC.
  8706     MOVE 'ELMSTR' TO DFHEIV1
  8707     MOVE 0
  8708       TO DFHEIV11
  8709*    MOVE '&,         G          &   #00008618' TO DFHEIV0
  8710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8712     MOVE X'2020233030303038363138' TO DFHEIV0(25:11)
  8713     CALL 'kxdfhei1' USING DFHEIV0,
  8714           DFHEIV1,
  8715           ELMSTR-KEY,
  8716           DFHEIV99,
  8717           DFHEIV11,
  8718           DFHEIV99
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
  8721
  8722     MOVE 'Y' TO WS-BROWSE-START-SW.
  8723
  8724
  8725* EXEC CICS READNEXT
  8726*         DATASET    ('ELMSTR')
  8727*         RIDFLD     (ELMSTR-KEY)
  8728*         SET        (ADDRESS OF CLAIM-MASTER)
  8729*    END-EXEC.
  8730     MOVE 'ELMSTR' TO DFHEIV1
  8731     MOVE 0
  8732       TO DFHEIV11
  8733*    MOVE '&.S                   )   #00008626' TO DFHEIV0
  8734     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 164
* EL156.cbl
  8735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8736     MOVE X'2020233030303038363236' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0,
  8738           DFHEIV1,
  8739           DFHEIV20,
  8740           DFHEIV99,
  8741           ELMSTR-KEY,
  8742           DFHEIV99,
  8743           DFHEIV11,
  8744           DFHEIV99,
  8745           DFHEIV99
  8746     SET ADDRESS OF CLAIM-MASTER TO
  8747         DFHEIV20
  8748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8749
  8750
  8751
  8752* EXEC CICS READPREV
  8753*         DATASET    ('ELMSTR')
  8754*         RIDFLD     (ELMSTR-KEY)
  8755*         SET        (ADDRESS OF CLAIM-MASTER)
  8756*    END-EXEC.
  8757     MOVE 'ELMSTR' TO DFHEIV1
  8758     MOVE 0
  8759       TO DFHEIV11
  8760*    MOVE '&0S                   )   #00008632' TO DFHEIV0
  8761     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8763     MOVE X'2020233030303038363332' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           DFHEIV1,
  8766           DFHEIV20,
  8767           DFHEIV99,
  8768           ELMSTR-KEY,
  8769           DFHEIV99,
  8770           DFHEIV11,
  8771           DFHEIV99,
  8772           DFHEIV99
  8773     SET ADDRESS OF CLAIM-MASTER TO
  8774         DFHEIV20
  8775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8776
  8777
  8778 0360-BROWSE-BACKWARD.
  8779
  8780
  8781* EXEC CICS READPREV
  8782*         DATASET    ('ELMSTR')
  8783*         RIDFLD     (ELMSTR-KEY)
  8784*         SET        (ADDRESS OF CLAIM-MASTER)
  8785*    END-EXEC.
  8786     MOVE 'ELMSTR' TO DFHEIV1
  8787     MOVE 0
  8788       TO DFHEIV11
  8789*    MOVE '&0S                   )   #00008640' TO DFHEIV0
  8790     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8792     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 165
* EL156.cbl
  8793     CALL 'kxdfhei1' USING DFHEIV0,
  8794           DFHEIV1,
  8795           DFHEIV20,
  8796           DFHEIV99,
  8797           ELMSTR-KEY,
  8798           DFHEIV99,
  8799           DFHEIV11,
  8800           DFHEIV99,
  8801           DFHEIV99
  8802     SET ADDRESS OF CLAIM-MASTER TO
  8803         DFHEIV20
  8804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8805
  8806
  8807     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8808        GO TO 0380-CLAIM-END-FILE.
  8809
  8810     IF PI-COMPANY-ID = 'CRI'
  8811         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8812            GO TO 0380-CLAIM-END-FILE.
  8813
  8814     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8815         GO TO 0360-BROWSE-BACKWARD.
  8816
  8817     IF PI-CARRIER-SECURITY > SPACES
  8818         IF CL-CARRIER = PI-CARRIER-SECURITY
  8819             NEXT SENTENCE
  8820         ELSE
  8821             GO TO 0360-BROWSE-BACKWARD.
  8822
  8823     IF PI-ACCOUNT-SECURITY > SPACES
  8824         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8825             NEXT SENTENCE
  8826         ELSE
  8827             GO TO 0360-BROWSE-BACKWARD.
  8828
  8829     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8830     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8831     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8832
  8833     GO TO 0400-FIRST-TIME.
  8834
  8835 0380-CLAIM-END-FILE.
  8836
  8837     MOVE ER-0130     TO EMI-ERROR.
  8838     MOVE -1          TO CLMNOL.
  8839     MOVE AL-UABON    TO CARRA
  8840                         CLMNOA
  8841                         CERTNOA
  8842                         SUFXA.
  8843
  8844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8845
  8846     GO TO 8200-SEND-DATAONLY.
  8847
  8848 0400-FIRST-TIME.
  8849
  8850     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 166
* EL156.cbl
  8851        MOVE 'N'         TO WS-BROWSE-START-SW
  8852
  8853* EXEC CICS ENDBR
  8854*            DATASET    ('ELMSTR')
  8855*       END-EXEC.
  8856     MOVE 'ELMSTR' TO DFHEIV1
  8857     MOVE 0
  8858       TO DFHEIV11
  8859*    MOVE '&2                    $   #00008691' TO DFHEIV0
  8860     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8862     MOVE X'2020233030303038363931' TO DFHEIV0(25:11)
  8863     CALL 'kxdfhei1' USING DFHEIV0,
  8864           DFHEIV1,
  8865           DFHEIV11,
  8866           DFHEIV99
  8867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8868
  8869
  8870     IF PI-PROCESSOR-ID = 'LGXX'
  8871         NEXT SENTENCE
  8872     ELSE
  8873
  8874* EXEC CICS READQ TS
  8875*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8876*            INTO    (SECURITY-CONTROL)
  8877*            LENGTH  (SC-COMM-LENGTH)
  8878*            ITEM    (SC-ITEM)
  8879*        END-EXEC
  8880*    MOVE '*$II   L              ''   #00008698' TO DFHEIV0
  8881     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8882     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8883     MOVE X'2020233030303038363938' TO DFHEIV0(25:11)
  8884     CALL 'kxdfhei1' USING DFHEIV0,
  8885           PI-SECURITY-TEMP-STORE-ID,
  8886           SECURITY-CONTROL,
  8887           SC-COMM-LENGTH,
  8888           SC-ITEM,
  8889           DFHEIV99,
  8890           DFHEIV99
  8891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8892         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8893         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8894
  8895     MOVE LOW-VALUES             TO EL156AI.
  8896     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8897     MOVE 'Y'                    TO FIRST-ENTRY.
  8898     GO TO 7000-SHOW-CLAIM.
  8899
  8900 0500-CREATE-TEMP-STORAGE.
  8901     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8902
  8903
  8904* EXEC CICS WRITEQ TS
  8905*        QUEUE (QID)
  8906*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8907*        LENGTH(PI-COMM-LENGTH)
  8908*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 167
* EL156.cbl
  8909*    MOVE '*"     L              ''   #00008715' TO DFHEIV0
  8910     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303038373135' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           QID,
  8915           PROGRAM-INTERFACE-BLOCK,
  8916           PI-COMM-LENGTH,
  8917           DFHEIV99,
  8918           DFHEIV99,
  8919           DFHEIV99
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922
  8923
  8924* EXEC CICS WRITEQ TS
  8925*        QUEUE (QID)
  8926*        FROM  (EL156AI)
  8927*        LENGTH(MAP-LENGTH)
  8928*    END-EXEC.
  8929*    MOVE '*"     L              ''   #00008721' TO DFHEIV0
  8930     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8932     MOVE X'2020233030303038373231' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0,
  8934           QID,
  8935           EL156AI,
  8936           MAP-LENGTH,
  8937           DFHEIV99,
  8938           DFHEIV99,
  8939           DFHEIV99
  8940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8941
  8942
  8943 0599-EXIT.
  8944      EXIT.
  8945
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 168
* EL156.cbl
  8947 0600-RECOVER-TEMP-STORAGE.
  8948
  8949* EXEC CICS READQ TS
  8950*        QUEUE (QID)
  8951*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8952*        LENGTH(PI-COMM-LENGTH)
  8953*    END-EXEC.
  8954*    MOVE '*$I    L              ''   #00008732' TO DFHEIV0
  8955     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8957     MOVE X'2020233030303038373332' TO DFHEIV0(25:11)
  8958     CALL 'kxdfhei1' USING DFHEIV0,
  8959           QID,
  8960           PROGRAM-INTERFACE-BLOCK,
  8961           PI-COMM-LENGTH,
  8962           DFHEIV99,
  8963           DFHEIV99,
  8964           DFHEIV99
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8966
  8967
  8968
  8969* EXEC CICS READQ TS
  8970*        QUEUE (QID)
  8971*        INTO  (EL156AI)
  8972*        LENGTH(MAP-LENGTH)
  8973*    END-EXEC.
  8974*    MOVE '*$I    L              ''   #00008738' TO DFHEIV0
  8975     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8976     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8977     MOVE X'2020233030303038373338' TO DFHEIV0(25:11)
  8978     CALL 'kxdfhei1' USING DFHEIV0,
  8979           QID,
  8980           EL156AI,
  8981           MAP-LENGTH,
  8982           DFHEIV99,
  8983           DFHEIV99,
  8984           DFHEIV99
  8985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8986
  8987
  8988     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8989
  8990     IF PMTTYPEI NOT = LOW-VALUES
  8991         MOVE AL-UANON           TO PMTTYPEA.
  8992
  8993     IF PAYEEI NOT = LOW-VALUES
  8994         MOVE AL-UANON           TO PAYEEA.
  8995
  8996     IF NOTE1I NOT = LOW-VALUES
  8997         MOVE AL-UANON           TO NOTE1A.
  8998
  8999     IF (RETURNED-FROM = 'EL614')
  9000        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9001     END-IF
  9002*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9003*       AND (PI-EOB-CODES-EXIST = 'Y')
  9004*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 169
* EL156.cbl
  9005*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9006     IF PI-SET-NOTE2-MDT = 'Y'
  9007         MOVE AL-SANON           TO NOTE2A
  9008     END-IF
  9009
  9010     IF OFFLINEI NOT = LOW-VALUES
  9011         MOVE AL-UANON           TO OFFLINEA.
  9012
  9013*    IF GROUPEDI NOT = LOW-VALUES
  9014*        MOVE AL-UANON           TO GROUPEDA.
  9015
  9016*    IF CASHI NOT = LOW-VALUES
  9017*        MOVE AL-UANON           TO CASHA.
  9018
  9019     IF CHECKNOI NOT = LOW-VALUES
  9020         MOVE AL-UANON           TO CHECKNOA.
  9021
  9022     IF HOLDTILI NOT = LOW-VALUES
  9023         MOVE AL-UANON           TO HOLDTILA.
  9024
  9025     IF EPYFROMI NOT = LOW-VALUES
  9026         MOVE AL-UANON           TO EPYFROMA.
  9027
  9028     IF AIGFROMI NOT = LOW-VALUES
  9029         MOVE AL-UANON           TO AIGFROMA.
  9030
  9031     IF EPYTHRUI NOT = LOW-VALUES
  9032         MOVE AL-UANON           TO EPYTHRUA.
  9033
  9034     IF EDAYSI NOT = LOW-VALUES
  9035         MOVE AL-UNNON           TO EDAYSA.
  9036
  9037     IF EPYAMTL NOT = +0
  9038         MOVE AL-UNNON           TO EPYAMTA.
  9039
  9040     IF ERESVL NOT = +0
  9041         MOVE AL-UNNON           TO ERESVA.
  9042
  9043     IF EEXPENSL NOT = +0
  9044         MOVE AL-UNNON           TO EEXPENSA.
  9045
  9046     IF ETYPEI NOT = LOW-VALUES
  9047         MOVE AL-UNNON           TO ETYPEA.
  9048
  9049     IF PROOFDTI NOT = 0
  9050         MOVE AL-UNNON           TO PROOFDTA.
  9051
  9052     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9053        MOVE AL-UANON            TO EOBYNA
  9054     END-IF
  9055     IF CLMFMYNI = 'Y' OR 'N'
  9056        MOVE AL-UANON            TO CLMFMYNA
  9057     END-IF
  9058
  9059     IF SURVYYNI = 'Y' OR 'N'
  9060        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9061           MOVE AL-UANON         TO SURVYYNA
  9062        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 170
* EL156.cbl
  9063     END-IF
  9064
  9065     IF SPRELYNI = 'Y' OR 'N'
  9066        MOVE AL-UANON            TO SPRELYNA
  9067     END-IF
  9068
  9069     .
  9070 0699-EXIT.
  9071      EXIT.
  9072
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 171
* EL156.cbl
  9074 0700-TEST-FOR-CHANGES.
  9075     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9076         MOVE ER-0433            TO EMI-ERROR
  9077         GO TO 0750-FUNCTION-ERROR.
  9078
  9079     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9080
  9081     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9082         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9083         MOVE 'A'                TO PI-PASS-SW
  9084         GO TO 1000-EDIT-DATA.
  9085
  9086     IF PI-FATAL-COUNT NOT = 0
  9087         MOVE ER-0499            TO EMI-ERROR
  9088         GO TO 0750-FUNCTION-ERROR.
  9089
  9090     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9091         MOVE ER-0500            TO EMI-ERROR
  9092         GO TO 0750-FUNCTION-ERROR.
  9093
  9094     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9095        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9096           MOVE ER-0542          TO EMI-ERROR
  9097           MOVE -1               TO EPYAMTL
  9098           GO TO 0750-FUNCTION-ERROR.
  9099
  9100     IF PI-OFFLINE = 'Y'  OR
  9101        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9102        MOVE EIBAID              TO PI-PFKEY-USED
  9103        GO TO 5000-UPDATE.
  9104
  9105     GO TO 6000-BUILD-SCREEN-B.
  9106
  9107 0750-FUNCTION-ERROR.
  9108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9109
  9110     IF ENTERPFL > 0
  9111         MOVE -1                 TO ENTERPFL
  9112         MOVE AL-UNBON           TO ENTERPFA
  9113         GO TO 8200-SEND-DATAONLY
  9114     ELSE
  9115         MOVE -1                 TO ENTERPFL
  9116         MOVE AL-UNNOF           TO ENTERPFA
  9117         GO TO 8200-SEND-DATAONLY.
  9118
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 172
* EL156.cbl
  9120 0800-DELETE-TS.
  9121
  9122* EXEC CICS HANDLE CONDITION
  9123*        QIDERR(0800-EXIT)
  9124*    END-EXEC.
  9125*    MOVE '"$N                   ! % #00008877' TO DFHEIV0
  9126     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9128     MOVE X'2520233030303038383737' TO DFHEIV0(25:11)
  9129     CALL 'kxdfhei1' USING DFHEIV0
  9130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9131
  9132
  9133
  9134* EXEC CICS DELETEQ TS
  9135*        QUEUE(QID)
  9136*    END-EXEC.
  9137*    MOVE '*&                    #   #00008881' TO DFHEIV0
  9138     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9139     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9140     MOVE X'2020233030303038383831' TO DFHEIV0(25:11)
  9141     CALL 'kxdfhei1' USING DFHEIV0,
  9142           QID,
  9143           DFHEIV99
  9144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9145
  9146
  9147 0800-EXIT.
  9148      EXIT.
  9149 0900-GET-DDF-LIMITS.
  9150
  9151     if cm-clp-state = zeros or spaces or low-values
  9152        move cm-state            to cm-clp-state
  9153     end-if
  9154     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9155     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9156     MOVE cm-clp-state           TO ERPDEF-STATE
  9157     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9158     evaluate true
  9159        when (cl-claim-type = 'L' or 'P')
  9160           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9161             and 'CU')
  9162           move 'L'              to erpdef-ben-type
  9163           move pi-lf-benefit-cd to erpdef-ben-code
  9164        when (cl-claim-type not = 'L' and 'P')
  9165           and (pi-ah-benefit-cd not = '00' and '  ')
  9166           move 'A'              to erpdef-ben-type
  9167           move pi-ah-benefit-cd to erpdef-ben-code
  9168        when (cl-claim-type not = 'L' and 'P')
  9169           and (pi-ah-benefit-cd = '00' or '  ')
  9170           move 'L'              to erpdef-ben-type
  9171           move pi-lf-benefit-cd to erpdef-ben-code
  9172        when (cl-claim-type = 'L' or 'P')
  9173           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9174           move 'A'              to erpdef-ben-type
  9175           move pi-ah-benefit-cd to erpdef-ben-code
  9176        when other
  9177           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 173
* EL156.cbl
  9178           move pi-ah-benefit-cd to erpdef-ben-code
  9179     end-evaluate
  9180*    if (cl-claim-type = 'L' or 'P')
  9181*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9182*          and 'CU')
  9183*       move 'L'                 to erpdef-ben-type
  9184*       move pi-lf-benefit-cd    to erpdef-ben-code
  9185*    else
  9186*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9187*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9188*    end-if
  9189     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9190
  9191     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9192
  9193
  9194* EXEC CICS STARTBR
  9195*        DATASET  ('ERPDEF')
  9196*        RIDFLD   (ERPDEF-KEY)
  9197*        GTEQ
  9198*        RESP     (WS-RESPONSE)
  9199*    END-EXEC
  9200     MOVE 'ERPDEF' TO DFHEIV1
  9201     MOVE 0
  9202       TO DFHEIV11
  9203*    MOVE '&,         G          &  N#00008931' TO DFHEIV0
  9204     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9206     MOVE X'204E233030303038393331' TO DFHEIV0(25:11)
  9207     CALL 'kxdfhei1' USING DFHEIV0,
  9208           DFHEIV1,
  9209           ERPDEF-KEY,
  9210           DFHEIV99,
  9211           DFHEIV11,
  9212           DFHEIV99
  9213     MOVE EIBRESP  TO WS-RESPONSE
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9215
  9216     IF NOT WS-RESP-NORMAL
  9217        GO TO 0900-EXIT
  9218     END-IF
  9219
  9220     .
  9221 0900-READNEXT.
  9222
  9223
  9224* EXEC CICS READNEXT
  9225*       DATASET  ('ERPDEF')
  9226*       SET      (ADDRESS OF PRODUCT-MASTER)
  9227*       RIDFLD   (ERPDEF-KEY)
  9228*       RESP     (WS-RESPONSE)
  9229*    END-EXEC
  9230     MOVE 'ERPDEF' TO DFHEIV1
  9231     MOVE 0
  9232       TO DFHEIV11
  9233*    MOVE '&.S                   )  N#00008945' TO DFHEIV0
  9234     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 174
* EL156.cbl
  9236     MOVE X'204E233030303038393435' TO DFHEIV0(25:11)
  9237     CALL 'kxdfhei1' USING DFHEIV0,
  9238           DFHEIV1,
  9239           DFHEIV20,
  9240           DFHEIV99,
  9241           ERPDEF-KEY,
  9242           DFHEIV99,
  9243           DFHEIV11,
  9244           DFHEIV99,
  9245           DFHEIV99
  9246     SET ADDRESS OF PRODUCT-MASTER TO
  9247         DFHEIV20
  9248     MOVE EIBRESP  TO WS-RESPONSE
  9249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9250
  9251     IF NOT WS-RESP-NORMAL
  9252        GO TO 0900-ENDBR
  9253     END-IF
  9254
  9255     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9256        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9257           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9258        ELSE
  9259           GO TO 0900-READNEXT
  9260        END-IF
  9261     ELSE
  9262        GO TO 0900-ENDBR
  9263     END-IF
  9264
  9265     IF CM-LOAN-TERM = ZEROS
  9266        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9267     END-IF
  9268
  9269     .
  9270 0900-ENDBR.
  9271
  9272
  9273* EXEC CICS ENDBR
  9274*       DATASET  ('ERPDEF')
  9275*    END-EXEC
  9276     MOVE 'ERPDEF' TO DFHEIV1
  9277     MOVE 0
  9278       TO DFHEIV11
  9279*    MOVE '&2                    $   #00008973' TO DFHEIV0
  9280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9282     MOVE X'2020233030303038393733' TO DFHEIV0(25:11)
  9283     CALL 'kxdfhei1' USING DFHEIV0,
  9284           DFHEIV1,
  9285           DFHEIV11,
  9286           DFHEIV99
  9287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9288
  9289     .
  9290 0900-EXIT.
  9291     EXIT.
  9292 1000-EDIT-DATA.
  9293
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 175
* EL156.cbl
  9294     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9295         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9296         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9297
  9298     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9299
  9300     IF NOT MODIFY-CAP
  9301         MOVE ER-0070            TO EMI-ERROR
  9302         MOVE -1                 TO PMTTYPEL
  9303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9304         GO TO 2000-EDIT-DONE.
  9305
  9306     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9307                         '5' AND '6'
  9308         MOVE ER-0420            TO EMI-ERROR
  9309         MOVE -1                 TO PMTTYPEL
  9310         MOVE AL-UABON           TO PMTTYPEA
  9311         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312     ELSE
  9313         MOVE AL-UANON           TO PMTTYPEA.
  9314
  9315*    IF PI-OFFLINE = 'Y'
  9316*       IF PI-GROUPED = 'Y'
  9317*          MOVE ER-1880         TO EMI-ERROR
  9318*          MOVE -1              TO GROUPEDL
  9319*          MOVE AL-UABON        TO GROUPEDA
  9320*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9321*
  9322*    IF GROUPEDL > +0
  9323*       IF PI-GROUPED = 'Y' OR 'N'
  9324*          MOVE AL-UANON TO GROUPEDA
  9325*       ELSE
  9326*          MOVE ER-3140            TO EMI-ERROR
  9327*          MOVE -1                 TO GROUPEDL
  9328*          MOVE AL-UABON           TO GROUPEDA
  9329*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9330*
  9331*    IF CASHL > +0
  9332*       IF PI-CASH = 'Y' OR 'N'
  9333*          MOVE AL-UANON           TO CASHA
  9334*       ELSE
  9335*          MOVE ER-3141            TO EMI-ERROR
  9336*          MOVE -1                 TO CASHL
  9337*          MOVE AL-UABON           TO CASHA
  9338*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9339
  9340     IF LOANNOL > +0
  9341         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9342
  9343 1000-EDIT-PAYEE.
  9344
  9345     IF PI-PAYEE-SEQ NOT NUMERIC
  9346         MOVE ER-0294            TO  EMI-ERROR
  9347         MOVE -1                 TO  PAYEEL
  9348         MOVE AL-UABON           TO  PAYEEA
  9349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9350         GO TO 1000-CONT-EDIT.
  9351
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 176
* EL156.cbl
  9352     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9353                         'E' OR 'O' OR 'Q'
  9354         NEXT SENTENCE
  9355     ELSE
  9356         MOVE ER-0294            TO  EMI-ERROR
  9357         MOVE -1                 TO  PAYEEL
  9358         MOVE AL-UABON           TO  PAYEEA
  9359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360         GO TO 1000-CONT-EDIT.
  9361
  9362     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9363        (PI-PAYEE-SEQ NOT < '1' AND
  9364         PI-PAYEE-SEQ NOT > '9'))
  9365      OR
  9366        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9367         (PI-PAYEE-SEQ NOT > '9'))
  9368         MOVE AL-UANON            TO PAYEEA
  9369     ELSE
  9370         MOVE ER-0294            TO EMI-ERROR
  9371         MOVE -1                 TO PAYEEL
  9372         MOVE AL-UABON           TO PAYEEA
  9373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9374
  9375     IF PI-COMPANY-ID = 'DMD'
  9376         IF PI-PAYEE-TYPE = 'B' AND
  9377            PI-PAYEE-SEQ NOT = '0'
  9378               MOVE ER-7841            TO EMI-ERROR
  9379               MOVE -1                 TO PAYEEL
  9380               MOVE AL-UABON           TO PAYEEA
  9381               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9382
  9383     IF PI-COMPANY-ID = 'JHL'
  9384         IF PI-PAYEE = 'B0'
  9385             NEXT SENTENCE
  9386           ELSE
  9387
  9388* EXEC CICS HANDLE CONDITION
  9389*            ENDFILE(1950-NOT-FOUND)
  9390*            NOTFND (1950-NOT-FOUND)
  9391*        END-EXEC
  9392*    MOVE '"$''I                  ! & #00009075' TO DFHEIV0
  9393     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9395     MOVE X'2620233030303039303735' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0
  9397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9398         MOVE 'N'                    TO FOUND-TOL-SW
  9399         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9400         MOVE '2'                    TO CNTL-REC-TYPE
  9401         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9402         MOVE +0                     TO CNTL-SEQ-NO
  9403         MOVE 'PROC'                 TO FILE-SWITCH
  9404         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9405         IF PI-PAYEE = 'I1' AND
  9406            APPROVAL-LEVEL-2
  9407             NEXT SENTENCE
  9408           ELSE
  9409         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 177
* EL156.cbl
  9410             MOVE ER-3546        TO EMI-ERROR
  9411             MOVE -1             TO PAYEEL
  9412             MOVE AL-UABON       TO PAYEEA
  9413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9414
  9415     IF PI-PAYEE-TYPE = 'E'
  9416        IF PI-PMTTYPE = '5' OR '6'
  9417            NEXT SENTENCE
  9418        ELSE
  9419            MOVE ER-3539            TO EMI-ERROR
  9420            MOVE -1                 TO PAYEEL
  9421            MOVE AL-UABON           TO PAYEEA
  9422            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9423
  9424 1000-CONT-EDIT.
  9425
  9426     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9427        IF PI-EPYAMT NOT NEGATIVE
  9428            MOVE ER-0421         TO EMI-ERROR
  9429            MOVE -1              TO OFFLINEL
  9430            MOVE AL-UABON        TO OFFLINEA
  9431            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432        ELSE
  9433            MOVE AL-UANON        TO OFFLINEA.
  9434
  9435     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9436        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9437           CONTINUE
  9438        ELSE
  9439           IF PI-PRINT-EOB-YN = 'S' AND
  9440              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9441                CONTINUE
  9442           ELSE
  9443              MOVE ER-1561       TO EMI-ERROR
  9444              MOVE -1            TO EOBYNL
  9445              MOVE AL-UABON      TO EOBYNA
  9446              PERFORM 9900-ERROR-FORMAT
  9447                                 THRU 9900-EXIT
  9448           END-IF
  9449        END-IF
  9450
  9451        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9452            MOVE ER-1566        TO EMI-ERROR
  9453            MOVE -1             TO CLMFMYNL
  9454            MOVE AL-UABON       TO CLMFMYNA
  9455            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9456        END-IF
  9457
  9458        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9459            MOVE ER-1567        TO EMI-ERROR
  9460            MOVE -1             TO SURVYYNL
  9461            MOVE AL-UABON       TO SURVYYNA
  9462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463        END-IF
  9464
  9465        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9466            MOVE ER-1569        TO EMI-ERROR
  9467            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 178
* EL156.cbl
  9468            MOVE AL-UABON       TO SPRELYNA
  9469            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9470        END-IF
  9471
  9472     END-IF
  9473     IF PI-EPYAMT IS NEGATIVE
  9474         IF PI-OFFLINE NOT = 'Y'
  9475             MOVE ER-0836        TO  EMI-ERROR
  9476             MOVE -1             TO  OFFLINEL
  9477             MOVE AL-UABON       TO  OFFLINEA
  9478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9479
  9480     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9481        MOVE ER-0872             TO EMI-ERROR
  9482        MOVE -1                  TO PROOFDTL
  9483        MOVE AL-UABON            TO PROOFDTA
  9484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9485     ELSE
  9486        MOVE '4'                TO DC-OPTION-CODE
  9487        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9488        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9489        IF DATE-CONVERSION-ERROR
  9490            MOVE ER-0873        TO EMI-ERROR
  9491            MOVE -1                  TO PROOFDTL
  9492            MOVE AL-UABON            TO PROOFDTA
  9493            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9494        ELSE
  9495            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9496            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9497                MOVE ER-0873    TO EMI-ERROR
  9498                MOVE -1                  TO PROOFDTL
  9499                MOVE AL-UABON            TO PROOFDTA
  9500                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9501            END-IF
  9502        END-IF
  9503     END-IF.
  9504
  9505     IF PI-COMPANY-ID = 'DMD'
  9506        IF NOTE1L NOT = ZEROS
  9507            MOVE ER-7844        TO  EMI-ERROR
  9508            MOVE -1             TO  NOTE1L
  9509            MOVE AL-UABON       TO  NOTE1A
  9510            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9511
  9512     IF PI-COMPANY-ID = 'DMD'
  9513        IF NOTE2L NOT = ZEROS
  9514          GO TO 1004-DMD-EOB-CHECKS.
  9515
  9516     IF NOTE1L NOT > +0
  9517         GO TO 1005-CHECK-ERRORS.
  9518
  9519     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9520         GO TO 1005-CHECK-ERRORS.
  9521
  9522     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9523         GO TO 1003-HAN-PMT-NOTES.
  9524
  9525     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 179
* EL156.cbl
  9526
  9527     IF WS-PMTOPTION NUMERIC
  9528        IF WS-PMTOPTION > '00' AND < '17'
  9529           NEXT SENTENCE
  9530        ELSE
  9531           MOVE ER-0618          TO EMI-ERROR
  9532           MOVE -1               TO NOTE1L
  9533           MOVE AL-UABON         TO NOTE1A
  9534           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9535     ELSE
  9536        GO TO 1005-CHECK-ERRORS.
  9537
  9538     IF WS-PMTOPTION = '05' AND
  9539        WS-DOCNAME = SPACES
  9540          MOVE ER-0616             TO EMI-ERROR
  9541          MOVE -1                  TO NOTE1L
  9542          MOVE AL-UABON            TO NOTE1A
  9543          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9544
  9545     IF WS-PMTOPTION = '15' OR '16'
  9546
  9547* EXEC CICS BIF DEEDIT
  9548*            FIELD (WS-AMOUNT)
  9549*            LENGTH(08)
  9550*        END-EXEC
  9551     MOVE 08
  9552       TO DFHEIV11
  9553*    MOVE '@"L                   #   #00009227' TO DFHEIV0
  9554     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9555     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9556     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
  9557     CALL 'kxdfhei1' USING DFHEIV0,
  9558           WS-AMOUNT,
  9559           DFHEIV11
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9561        IF (WS-NUM-AMT = ZEROS) OR
  9562           (WS-AMOUNT NOT NUMERIC)
  9563           MOVE ER-0617          TO EMI-ERROR
  9564           MOVE -1               TO NOTE1L
  9565           MOVE AL-UABON         TO NOTE1A
  9566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
  9568     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9569
  9570     GO TO 1005-CHECK-ERRORS.
  9571
  9572 1003-HAN-PMT-NOTES.
  9573
  9574     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9575
  9576     IF WS-HAN-PMT-CODE = SPACE
  9577         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9578     ELSE
  9579     IF WS-HAN-PMT-CODE = 'A'
  9580         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9581                                 TO WS-HAN-PMT-NOTE
  9582     ELSE
  9583     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 180
* EL156.cbl
  9584         MOVE ':FINAL PAYMENT / DECEASED'
  9585                                 TO WS-HAN-PMT-NOTE
  9586     ELSE
  9587     IF WS-HAN-PMT-CODE = 'C'
  9588         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9589                                 TO WS-HAN-PMT-NOTE
  9590     ELSE
  9591     IF WS-HAN-PMT-CODE = 'D'
  9592         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9593                                 TO WS-HAN-PMT-NOTE
  9594     ELSE
  9595     IF WS-HAN-PMT-CODE = 'E'
  9596         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9597                                 TO WS-HAN-PMT-NOTE
  9598     ELSE
  9599     IF WS-HAN-PMT-CODE = 'F'
  9600         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9601                                 TO WS-HAN-PMT-NOTE
  9602     ELSE
  9603     IF WS-HAN-PMT-CODE = 'P'
  9604         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9605
  9606     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9607     GO TO 1005-CHECK-ERRORS.
  9608
  9609 1004-DMD-EOB-CHECKS.
  9610
  9611     INITIALIZE PI-AT-EOB-CODES.
  9612
  9613     IF NOTE2I (20:21) > SPACES
  9614         MOVE ER-7845          TO EMI-ERROR
  9615         MOVE -1               TO NOTE2L
  9616         MOVE AL-UABON         TO NOTE2A
  9617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618         GO TO 1005-CHECK-ERRORS
  9619      ELSE
  9620         MOVE NOTE2I             TO W-EOB-CODES.
  9621
  9622     MOVE +1                     TO W-EOB-NDX.
  9623
  9624 1004-CHECK-EACH-EOB.
  9625
  9626     IF W-EOB-NDX > +5
  9627             OR
  9628        W-EOB-CODE (W-EOB-NDX) = SPACES
  9629         GO TO 1004-CHECK-DUP-EOB.
  9630
  9631     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9632         MOVE ER-0956            TO EMI-ERROR
  9633         MOVE -1                 TO NOTE2L
  9634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9635         GO TO 1005-CHECK-ERRORS.
  9636
  9637     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9638     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9639     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9640     MOVE 'DLO023'               TO PGM-NAME.
  9641
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 181
* EL156.cbl
  9642
  9643* EXEC CICS LINK
  9644*        PROGRAM    (PGM-NAME)
  9645*        COMMAREA   (CD-COMMUNICATION-AREA)
  9646*        LENGTH     (CD-RCRD-LENGTH)
  9647*    END-EXEC.
  9648*    MOVE '."C                   (   #00009312' TO DFHEIV0
  9649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9651     MOVE X'2020233030303039333132' TO DFHEIV0(25:11)
  9652     CALL 'kxdfhei1' USING DFHEIV0,
  9653           PGM-NAME,
  9654           CD-COMMUNICATION-AREA,
  9655           CD-RCRD-LENGTH,
  9656           DFHEIV99,
  9657           DFHEIV99,
  9658           DFHEIV99,
  9659           DFHEIV99
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9661
  9662
  9663     IF CD-RETURN-CODE = 'OK'
  9664         GO TO 1004-CONT.
  9665
  9666     MOVE -1                     TO NOTE2L.
  9667
  9668     IF CD-RETURN-CODE = '01'
  9669         MOVE ER-8310            TO EMI-ERROR
  9670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9671         GO TO 1005-CHECK-ERRORS.
  9672
  9673     IF CD-RETURN-CODE = '02'
  9674         MOVE ER-8311            TO EMI-ERROR
  9675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9676         GO TO 1005-CHECK-ERRORS.
  9677
  9678     IF CD-RETURN-CODE = '03'
  9679         MOVE ER-8312            TO EMI-ERROR
  9680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9681         GO TO 1005-CHECK-ERRORS.
  9682
  9683     IF CD-RETURN-CODE = '04'
  9684         MOVE ER-8313            TO EMI-ERROR
  9685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9686         GO TO 1005-CHECK-ERRORS.
  9687
  9688     IF CD-RETURN-CODE = '05'
  9689         MOVE ER-8314            TO EMI-ERROR
  9690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9691         GO TO 1005-CHECK-ERRORS.
  9692
  9693     IF CD-RETURN-CODE = '06'
  9694         MOVE ER-8315            TO EMI-ERROR
  9695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9696         GO TO 1005-CHECK-ERRORS.
  9697
  9698     IF CD-RETURN-CODE = 'E1'
  9699         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 182
* EL156.cbl
  9700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9701         GO TO 1005-CHECK-ERRORS.
  9702
  9703     IF CD-RETURN-CODE = 'N1'
  9704         MOVE ER-8317            TO EMI-ERROR
  9705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9706         GO TO 1005-CHECK-ERRORS.
  9707
  9708 1004-CONT.
  9709     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9710
  9711     ADD +1 TO W-EOB-NDX.
  9712     GO TO 1004-CHECK-EACH-EOB.
  9713
  9714 1004-CHECK-DUP-EOB.
  9715     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9716         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9717                               PI-AT-EOB-CODE (3) OR
  9718                               PI-AT-EOB-CODE (4) OR
  9719                               PI-AT-EOB-CODE (5)))
  9720                  OR
  9721        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9722         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9723                               PI-AT-EOB-CODE (4) OR
  9724                               PI-AT-EOB-CODE (5)))
  9725                  OR
  9726        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9727         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9728                               PI-AT-EOB-CODE (5)))
  9729                  OR
  9730        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9731         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9732            MOVE ER-8000            TO EMI-ERROR
  9733            MOVE AL-UABON           TO NOTE2A
  9734            MOVE -1                 TO NOTE2L
  9735            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9736            GO TO 1005-CHECK-ERRORS.
  9737
  9738 1005-CHECK-ERRORS.
  9739*    IF PI-COMPANY-ID NOT = 'DMD'
  9740        GO TO 1006-CHECK-ERRORS.
  9741
  9742*********  DMD CODE START ******************
  9743*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9744*       GO TO 1006-CHECK-ERRORS.
  9745*
  9746*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9747*
  9748*    COMPUTE W-PAYMENT-TOTAL
  9749*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9750*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9751*               AND
  9752*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9753*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9754*          MOVE ER-0967    TO EMI-ERROR
  9755*          MOVE -1         TO PMTTYPEL
  9756*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9757*
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 183
* EL156.cbl
  9758*    GO TO 1006-CHECK-ERRORS.
  9759*********  DMD CODE END ******************
  9760
  9761 1006-CHECK-ERRORS.
  9762     if emi-forcable-ctr = zeros
  9763        and emi-fatal-ctr = zeros
  9764        continue
  9765     else
  9766        IF NOT EMI-NO-ERRORS
  9767           GO TO 2000-EDIT-DONE
  9768        end-if
  9769     end-if
  9770
  9771* EXEC CICS HANDLE CONDITION
  9772*        NOTFND(1950-NOT-FOUND)
  9773*    END-EXEC.
  9774*    MOVE '"$I                   ! '' #00009425' TO DFHEIV0
  9775     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9777     MOVE X'2720233030303039343235' TO DFHEIV0(25:11)
  9778     CALL 'kxdfhei1' USING DFHEIV0
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9783     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9784     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9785     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9786     MOVE 'MSTR'                 TO FILE-SWITCH.
  9787
  9788     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9789
  9790     IF PI-COMPANY-ID = 'DMD'
  9791         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9792
  9793     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9794        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9795           MOVE ER-0873    TO EMI-ERROR
  9796           MOVE -1                  TO PROOFDTL
  9797           MOVE AL-UABON            TO PROOFDTA
  9798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9799        END-IF
  9800     END-IF
  9801     if cl-benefit-period = zeros
  9802        move er-1667             to emi-error
  9803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804     end-if
  9805     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9806     MOVE +95                    TO TRLR-SEQ-NO
  9807
  9808* EXEC CICS READ
  9809*       DATASET  ('ELTRLR')
  9810*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9811*       RIDFLD   (ELTRLR-KEY)
  9812*       RESP     (WS-RESPONSE)
  9813*    END-EXEC
  9814     MOVE 'ELTRLR' TO DFHEIV1
  9815*    MOVE '&"S        E          (  N#00009454' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 184
* EL156.cbl
  9816     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9818     MOVE X'204E233030303039343534' TO DFHEIV0(25:11)
  9819     CALL 'kxdfhei1' USING DFHEIV0,
  9820           DFHEIV1,
  9821           DFHEIV20,
  9822           DFHEIV99,
  9823           ELTRLR-KEY,
  9824           DFHEIV99,
  9825           DFHEIV99,
  9826           DFHEIV99
  9827     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9828         DFHEIV20
  9829     MOVE EIBRESP  TO WS-RESPONSE
  9830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9831
  9832     if ws-resp-normal
  9833        perform varying s1 from +1 by +1 until
  9834           at-note-error-no (s1) = spaces
  9835           if at-note-error-no (s1) = '1662'
  9836              continue
  9837           else
  9838              move at-note-error-no (s1)
  9839                                 to emi-error
  9840              if at-note-error-no (s1) = '1653'
  9841                 evaluate true
  9842                    when cl-claim-type = 'L'
  9843                       move '  LF  '
  9844                                 to emi-claim-type
  9845                    when cl-claim-type = 'I'
  9846                       move '  IU  '
  9847                                 to emi-claim-type
  9848                    when cl-claim-type = 'A'
  9849                       move '  AH  '
  9850                                 to emi-claim-type
  9851                    when other
  9852                       move ' FMLA '
  9853                                 to emi-claim-type
  9854                 end-evaluate
  9855              end-if
  9856              PERFORM 9900-ERROR-FORMAT
  9857                                 THRU 9900-EXIT
  9858           end-if
  9859        end-perform
  9860     end-if
  9861     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9862         IF PI-PMTTYPE = '5' OR '6'
  9863             NEXT SENTENCE
  9864         ELSE
  9865             MOVE ER-0555             TO EMI-ERROR
  9866             MOVE -1                  TO PMTTYPEL
  9867             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9868
  9869     IF CL-LAST-CLOSE-REASON = '2'
  9870         IF CL-CLAIM-STATUS = 'C'
  9871             MOVE ER-0760        TO  EMI-ERROR
  9872             MOVE -1             TO  PMTTYPEL
  9873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 185
* EL156.cbl
  9874
  9875     IF PI-ACTIVITY-CODE = 9
  9876         MOVE ER-3538            TO  EMI-ERROR
  9877         MOVE -1                 TO  PMTTYPEL
  9878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879
  9880     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9881         GO TO 1008-READ-CERT.
  9882**********************AIG LOGIC STARTS *********************
  9883     IF CL-CERT-PRIME = 'INCOMPLETE'
  9884         MOVE ER-3540            TO  EMI-ERROR
  9885         MOVE -1                 TO  PMTTYPEL
  9886         MOVE AL-UABON           TO  PMTTYPEA
  9887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9888         GO TO 2000-EDIT-DONE.
  9889
  9890     IF PI-PMTTYPE = '4'
  9891         IF PI-EPYAMT IS NEGATIVE
  9892             IF PI-ECHECKNO-CR = 'CR'
  9893                 NEXT SENTENCE
  9894             ELSE
  9895                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9896
  9897     IF PI-PMTTYPE = '4'
  9898         IF PI-ECHECKNO-CR = 'CR'
  9899             IF PI-EPYAMT IS NEGATIVE
  9900                 NEXT SENTENCE
  9901             ELSE
  9902                 MOVE ER-0834    TO  EMI-ERROR
  9903                 MOVE -1         TO  EPYAMTL
  9904                 MOVE AL-UNBON   TO  EPYAMTA
  9905                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF PI-PMTTYPE = '4'
  9908         IF PI-EPYAMT IS NEGATIVE
  9909             IF PI-OFFLINE = 'Y'
  9910                 NEXT SENTENCE
  9911             ELSE
  9912                 MOVE 'Y'        TO  PI-OFFLINE
  9913                                     WS-OFFLINE
  9914                                     OFFLINEO
  9915                 MOVE AL-UANON   TO  OFFLINEA.
  9916
  9917*    IF PI-PMTTYPE = '4'
  9918*        IF PI-EPYAMT IS NEGATIVE
  9919*            IF PI-CASH = 'Y'
  9920*                NEXT SENTENCE
  9921*            ELSE
  9922*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9923*                MOVE AL-UANON   TO  CASHA
  9924*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9925*
  9926*    IF PI-CASH NOT = 'Y' AND 'N'
  9927*         IF PI-OFFLINE = 'Y'  AND
  9928*            PI-ECHECKNO-CR = 'CR'
  9929*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9930*              MOVE AL-UANON     TO  CASHA
  9931*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 186
* EL156.cbl
  9932*
  9933*    IF PI-CASH NOT = 'Y' AND 'N'
  9934*        IF PI-PMTTYPE = '5' OR '6'
  9935*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9936*            MOVE AL-UANON       TO  CASHA
  9937*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9938*
  9939*    IF PI-CASH NOT = 'Y' AND 'N'
  9940*       IF CL-ASSOCIATES = 'N' OR 'A'
  9941*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9942*           MOVE AL-UANON        TO  CASHA
  9943*       ELSE
  9944*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9945*           MOVE AL-UANON        TO  CASHA.
  9946*
  9947*    IF PI-PMTTYPE = '5' OR '6'
  9948*        IF PI-CASH = 'N'
  9949*            MOVE ER-0819        TO  EMI-ERROR
  9950*            MOVE AL-UANON       TO  CASHA
  9951*            MOVE -1             TO  CASHL
  9952*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9953*
  9954*    IF CL-ASSOCIATES = 'N' OR 'A'
  9955*       IF CASHI = 'N'
  9956*        MOVE ER-3537            TO  EMI-ERROR
  9957*        MOVE AL-UANON           TO  CASHA
  9958*        MOVE -1                 TO  CASHL
  9959*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9960
  9961 1007-DEFAULT-AIG-CHECKNO.
  9962
  9963     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9964         MOVE ER-3532            TO  EMI-ERROR
  9965         MOVE -1                 TO  PMTTYPEL
  9966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9967**********************AIG LOGIC ENDS ***********************
  9968
  9969 1008-READ-CERT.
  9970
  9971     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9972     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9973     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9974     MOVE CL-CERT-STATE          TO CERT-STATE.
  9975     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9976     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9977     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9978     MOVE 'CERT'                 TO FILE-SWITCH.
  9979
  9980     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9981
  9982     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9983        MOVE CM-LF-LOAN-EXPIRE-DT
  9984                                 TO WS-EXP-DT PI-EXP-DT
  9985                                    ws-extended-exp-dt
  9986     ELSE
  9987        MOVE CM-AH-LOAN-EXPIRE-DT
  9988                                 TO WS-EXP-DT PI-EXP-DT
  9989                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 187
* EL156.cbl
  9990     end-if
  9991     if pi-dcc-product-code not = spaces
  9992        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9993        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9994        PERFORM 0900-GET-DDF-limits
  9995                                 THRU 0900-EXIT
  9996        IF PDEF-FOUND
  9997           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9998              (P1 > +8)
  9999              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10000           END-PERFORM
 10001           IF P1 < +9
 10002              MOVE '6'           TO DC-OPTION-CODE
 10003              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10004              MOVE PD-MAX-EXTENSION (P1)
 10005                                 TO DC-ELAPSED-MONTHS
 10006              PERFORM 9700-LINK-DATE-CONVERT
 10007                                 THRU 9700-EXIT
 10008              if no-conversion-error
 10009                 move dc-bin-date-2 to ws-extended-exp-dt
 10010              end-if
 10011           else
 10012              move er-1674       to emi-error
 10013              PERFORM 9900-ERROR-FORMAT
 10014                                 THRU 9900-EXIT
 10015           end-if
 10016        end-if
 10017     end-if
 10018*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10019*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10020
 10021     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10022         MOVE ER-0458            TO EMI-ERROR
 10023         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10024
 10025     IF (CL-INCURRED-DT > WS-EXP-DT)
 10026        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10027        MOVE ER-1677             TO EMI-ERROR
 10028        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10029     END-IF
 10030     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10031     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10032         MOVE ER-0459            TO EMI-ERROR
 10033         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10034
 10035     IF CL-REPORTED-DT = LOW-VALUES
 10036        MOVE ER-0530             TO EMI-ERROR
 10037        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10038
 10039     IF PI-COMPANY-ID = 'NCL'
 10040        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10041            MOVE ER-0770            TO EMI-ERROR
 10042            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10043
 10044     IF PI-COMPANY-ID = 'NCL'
 10045        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10046            MOVE ER-0737            TO EMI-ERROR
 10047            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 188
* EL156.cbl
 10048
 10049     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10050         MOVE ER-0768            TO  EMI-ERROR
 10051         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10052
 10053     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10054         MOVE ER-0769            TO  EMI-ERROR
 10055         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10056
 10057     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10058         GO TO 1020-DO-LIFE-EDITS
 10059     ELSE
 10060         GO TO 1030-DO-AH-EDITS.
 10061
 10062 1010-GENERAL-ERROR.
 10063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10064
 10065     IF EMI-MESSAGE-FORMATTED
 10066         MOVE -1                 TO PMTTYPEL.
 10067
 10068 1010-EXIT.
 10069     EXIT.
 10070
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 189
* EL156.cbl
 10072 1020-DO-LIFE-EDITS.
 10073     IF CM-LF-BENEFIT-CD = '00'
 10074         IF PI-PMTTYPE = '5' OR '6'
 10075             MOVE ER-0658        TO EMI-ERROR
 10076             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10077         ELSE
 10078            if (pi-company-id = 'DCC' or 'CAP')
 10079               and (pi-dcc-product-code not = spaces)
 10080               continue
 10081            else
 10082               MOVE ER-1775      TO EMI-ERROR
 10083               PERFORM 1040-PMTTYPE-ERROR
 10084                                 THRU 1040-EXIT
 10085            end-if
 10086         end-if
 10087     end-if
 10088
 10089     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10090     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10091         MOVE ER-0460            TO EMI-ERROR
 10092         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10093
 10094     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10095     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10096     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10097     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10098     MOVE '4'                    TO  CNTL-REC-TYPE.
 10099     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10100     MOVE 'BENE'                 TO  FILE-SWITCH.
 10101     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10102     IF NO-BENEFIT-FOUND
 10103         GO TO 1950-NOT-FOUND.
 10104
 10105     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10106
 10107     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10108         IF PI-PMTTYPE = '4'
 10109             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10110                PI-LF-COVERAGE-TYPE = 'P'
 10111                 NEXT SENTENCE
 10112             ELSE
 10113                 MOVE ER-0461        TO EMI-ERROR
 10114                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10115         ELSE
 10116            NEXT SENTENCE
 10117     ELSE
 10118         IF PI-PMTTYPE = '2'
 10119            IF NOT CM-O-B-COVERAGE
 10120              AND CM-LF-CURRENT-STATUS = '7'
 10121                MOVE ER-0462     TO EMI-ERROR
 10122                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10123
 10124     IF PI-PMTTYPE = '2'
 10125         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10126            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10127             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10128             MOVE ER-0730            TO  EMI-ERROR
 10129             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 190
* EL156.cbl
 10130             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10131
 10132     IF PI-PMTTYPE = '2'
 10133         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10134            PI-LF-COVERAGE-TYPE = 'P'
 10135             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10136                 MOVE ER-0462    TO  EMI-ERROR
 10137                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10138
 10139     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10140       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10141         MOVE ER-0466            TO EMI-ERROR
 10142         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10143
 10144     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10145         IF PI-PMTTYPE = '3'
 10146             MOVE 0436           TO EMI-ERROR
 10147             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10148             GO TO 1045-EDIT-PAYEE-ADDR
 10149         ELSE
 10150             GO TO 1045-EDIT-PAYEE-ADDR.
 10151
 10152     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10153        PI-LF-COVERAGE-TYPE = 'P'
 10154         IF PI-PMTTYPE = '3'
 10155             MOVE ER-0436          TO  EMI-ERROR
 10156             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10157         ELSE
 10158             NEXT SENTENCE
 10159     ELSE
 10160         IF PI-PMTTYPE = '1' OR '3'
 10161             MOVE ER-0436            TO EMI-ERROR
 10162             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10163*
 10164     IF PI-COMPANY-ID = 'CID' AND
 10165        CL-CERT-STATE = 'SC'  AND
 10166        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10167           MOVE ER-0879    TO  EMI-ERROR
 10168           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10169           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10170     END-IF.
 10171     IF PI-COMPANY-ID = 'AHL'
 10172        evaluate true
 10173           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10174              MOVE ER-0879       TO  EMI-ERROR
 10175              PERFORM 1040-PMTTYPE-ERROR
 10176                                 THRU 1040-EXIT
 10177              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10178           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10179                 '6D' OR '6H' OR '6R'
 10180              MOVE ER-0879       TO  EMI-ERROR
 10181              PERFORM 1040-PMTTYPE-ERROR
 10182                                 THRU 1040-EXIT
 10183              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10184           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10185              MOVE ER-0879       TO  EMI-ERROR
 10186              PERFORM 1040-PMTTYPE-ERROR
 10187                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 191
* EL156.cbl
 10188              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10189        end-evaluate
 10190     END-IF
 10191     GO TO 1045-EDIT-PAYEE-ADDR.
 10192
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 192
* EL156.cbl
 10194 1030-DO-AH-EDITS.
 10195     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10196     IF CM-AH-BENEFIT-CD = '00'
 10197         IF PI-PMTTYPE = '5' OR '6'
 10198             MOVE ER-0658        TO EMI-ERROR
 10199             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10200         ELSE
 10201             MOVE ER-1775        TO EMI-ERROR
 10202             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10203
 10204     IF CL-TOTAL-PAID-AMT = ZEROS
 10205         IF PI-PMTTYPE = '4'
 10206             MOVE ER-0438        TO EMI-ERROR
 10207             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10208
 10209     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10210         IF PI-PMTTYPE = '3'
 10211             MOVE ER-0463        TO EMI-ERROR
 10212             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10213         ELSE
 10214             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10215              AND CM-LF-CURRENT-STATUS = '7'
 10216                 MOVE ER-0465    TO EMI-ERROR
 10217                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10218
 10219     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10220         IF PI-PMTTYPE = '3'
 10221             MOVE ER-0464        TO EMI-ERROR
 10222             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10223         ELSE
 10224             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10225                 MOVE ER-0469    TO EMI-ERROR
 10226                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10227
 10228     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10229         IF PI-PMTTYPE = '3'
 10230             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10231                 MOVE ER-0467    TO EMI-ERROR
 10232                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10233             ELSE
 10234                 NEXT SENTENCE
 10235         ELSE
 10236             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10237                 MOVE ER-0468    TO EMI-ERROR
 10238                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10239
 10240     GO TO 1045-EDIT-PAYEE-ADDR.
 10241
 10242 1040-PMTTYPE-ERROR.
 10243     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10244
 10245     IF EMI-MESSAGE-FORMATTED
 10246         MOVE -1                 TO PMTTYPEL
 10247         MOVE AL-UABON           TO PMTTYPEA.
 10248
 10249 1040-EXIT.
 10250     EXIT.
 10251
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 193
* EL156.cbl
 10253 1045-EDIT-PAYEE-ADDR.
 10254
 10255     IF PI-OFFLINE = 'N' AND
 10256        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10257           < PI-PAYEE-SEQ-NUM)
 10258        OR
 10259         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10260         (PI-PAYEE-TYPE = 'B')                 AND
 10261         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10262        OR
 10263         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10264           < PI-PAYEE-SEQ-NUM)
 10265        OR
 10266         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10267           < PI-PAYEE-SEQ-NUM)
 10268        OR
 10269         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10270           < PI-PAYEE-SEQ-NUM)
 10271        OR
 10272         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10273           < PI-PAYEE-SEQ-NUM)
 10274        OR
 10275         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10276           < PI-PAYEE-SEQ-NUM))
 10277             MOVE ER-0437        TO EMI-ERROR
 10278             MOVE -1             TO PAYEEL
 10279             MOVE AL-UABON       TO PAYEEA
 10280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10281
 10282     IF PI-OFFLINE    = 'N' AND
 10283        PI-PAYEE-TYPE = 'B' AND
 10284        PI-PAYEE-SEQ  = '0'
 10285         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10286         IF BENE-FOUND-SW = 'N'
 10287             MOVE ER-0437        TO EMI-ERROR
 10288             MOVE -1             TO PAYEEL
 10289             MOVE AL-UABON       TO PAYEEA
 10290             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10291
 10292     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10293        IF PI-OFFLINE    = 'N'  AND
 10294           PI-PAYEE-TYPE = 'B'  AND
 10295           PI-PAYEE-SEQ  = '9'
 10296             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10297             IF BENE-FOUND-SW = 'N'
 10298                MOVE ER-0437        TO EMI-ERROR
 10299                MOVE -1             TO PAYEEL
 10300                MOVE AL-UABON       TO PAYEEA
 10301                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10302
 10303*    IF PI-COMPANY-ID = 'CRI'
 10304*        IF CL-CLAIM-TYPE = 'L'
 10305*            MOVE 'N'                TO  WS-GROUPED
 10306*                                        PI-GROUPED
 10307*                                        GROUPEDI
 10308*            MOVE AL-UANON           TO  GROUPEDA
 10309*            GO TO 1050-EDIT-CHECK-NO
 10310*        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 194
* EL156.cbl
 10311*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10312*            IF WS-GROUP-1 = 'C'
 10313*                NEXT SENTENCE
 10314*            ELSE
 10315*                MOVE 'N'            TO  WS-GROUPED
 10316*                                        PI-GROUPED
 10317*                                        GROUPEDI
 10318*                MOVE AL-UANON       TO  GROUPEDA
 10319*                GO TO 1050-EDIT-CHECK-NO.
 10320
 10321*     IF PI-GROUPED = 'Y'
 10322*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10323*           NEXT SENTENCE
 10324*        ELSE
 10325*           MOVE ER-0437        TO EMI-ERROR
 10326*           MOVE -1             TO PAYEEL
 10327**02180            MOVE AL-UABON       TO PAYEEA
 10328*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10329*
 10330*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10331*        (PI-GROUPED    = ' ')
 10332*        NEXT SENTENCE
 10333*     ELSE
 10334*
 10335     GO TO 1050-EDIT-CHECK-NO.
 10336*     IF PI-COMPANY-ID = 'CRI'
 10337*        MOVE 'N'           TO GROUPEDI
 10338*                              PI-GROUPED
 10339*                              WS-GROUPED
 10340*        MOVE AL-UANON      TO GROUPEDA.
 10341*
 10342*     IF PI-COMPANY-ID = 'CRI'
 10343*        IF PI-PAYEE-TYPE = 'B'
 10344*           IF BENE-FOUND-SW = 'Y'
 10345*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10346*                 MOVE 'Y'           TO GROUPEDI
 10347*                                       PI-GROUPED
 10348*                                       WS-GROUPED
 10349*                 MOVE AL-UANON      TO GROUPEDA
 10350*              ELSE
 10351*                 NEXT SENTENCE
 10352*           ELSE
 10353*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10354*              IF BENE-FOUND-SW = 'Y'
 10355*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10356*                    MOVE 'Y'      TO GROUPEDI
 10357*                                     PI-GROUPED
 10358*                                     WS-GROUPED
 10359*                    MOVE AL-UANON TO GROUPEDA.
 10360*
 10361
 10362     IF PI-COMPANY-ID NOT = 'CRI'
 10363        GO TO 1050-EDIT-CHECK-NO.
 10364
 10365*************** CRI CODE START ******************
 10366     IF PI-PAYEE-TYPE NOT = 'A'
 10367        GO TO 1050-EDIT-CHECK-NO.
 10368
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 195
* EL156.cbl
 10369     MOVE LOW-VALUES             TO ERACCT-KEY.
 10370     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10371     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10372     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10373     MOVE PI-STATE               TO ACCT-STATE.
 10374     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10375     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10376     MOVE 'ACCT'                 TO FILE-SWITCH.
 10377
 10378     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10379     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10380
 10381
 10382* EXEC CICS HANDLE CONDITION
 10383*         NOTFND   (1950-NOT-FOUND)
 10384*         ENDFILE  (1950-NOT-FOUND)
 10385*    END-EXEC.
 10386*    MOVE '"$I''                  ! ( #00010010' TO DFHEIV0
 10387     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10389     MOVE X'2820233030303130303130' TO DFHEIV0(25:11)
 10390     CALL 'kxdfhei1' USING DFHEIV0
 10391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10392
 10393
 10394
 10395* EXEC CICS STARTBR
 10396*         DATASET   ('ERACCT')
 10397*         RIDFLD    (ERACCT-KEY)
 10398*         GTEQ
 10399*    END-EXEC.
 10400     MOVE 'ERACCT' TO DFHEIV1
 10401     MOVE 0
 10402       TO DFHEIV11
 10403*    MOVE '&,         G          &   #00010015' TO DFHEIV0
 10404     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10406     MOVE X'2020233030303130303135' TO DFHEIV0(25:11)
 10407     CALL 'kxdfhei1' USING DFHEIV0,
 10408           DFHEIV1,
 10409           ERACCT-KEY,
 10410           DFHEIV99,
 10411           DFHEIV11,
 10412           DFHEIV99
 10413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10414
 10415
 10416 1046-READNEXT-ERACCT.
 10417
 10418
 10419* EXEC CICS READNEXT
 10420*         DATASET   ('ERACCT')
 10421*         RIDFLD    (ERACCT-KEY)
 10422*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10423*    END-EXEC.
 10424     MOVE 'ERACCT' TO DFHEIV1
 10425     MOVE 0
 10426       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 196
* EL156.cbl
 10427*    MOVE '&.S                   )   #00010023' TO DFHEIV0
 10428     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10429     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10430     MOVE X'2020233030303130303233' TO DFHEIV0(25:11)
 10431     CALL 'kxdfhei1' USING DFHEIV0,
 10432           DFHEIV1,
 10433           DFHEIV20,
 10434           DFHEIV99,
 10435           ERACCT-KEY,
 10436           DFHEIV99,
 10437           DFHEIV11,
 10438           DFHEIV99,
 10439           DFHEIV99
 10440     SET ADDRESS OF ACCOUNT-MASTER TO
 10441         DFHEIV20
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10443
 10444
 10445     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10446        IF WS-ERACCT-HOLD-RECORD = SPACES
 10447           GO TO 1950-NOT-FOUND
 10448        ELSE
 10449           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10450           GO TO 1048-CONTINUE.
 10451
 10452     IF ACCT-EXP-DT = HIGH-VALUES
 10453        NEXT SENTENCE
 10454     ELSE
 10455        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10456        GO TO 1046-READNEXT-ERACCT.
 10457
 10458 1048-CONTINUE.
 10459
 10460*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10461*       MOVE 'Y'                 TO GROUPEDI
 10462*                                   PI-GROUPED
 10463*                                   WS-GROUPED
 10464*       MOVE AL-UANON            TO GROUPEDA.
 10465*************** CRI CODE END ******************
 10466
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 197
* EL156.cbl
 10468 1050-EDIT-CHECK-NO.
 10469
 10470     IF PI-OFFLINE = 'Y'
 10471         IF PI-ECHECKNO = SPACES
 10472              MOVE ER-0439        TO EMI-ERROR
 10473              GO TO 1090-CHECK-NO-ERROR
 10474           ELSE
 10475*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10476*           IF PI-ECHECKNO-N = 'N' AND
 10477*              PI-CASH       = 'Y'
 10478*                MOVE ER-3535        TO EMI-ERROR
 10479*                GO TO 1090-CHECK-NO-ERROR
 10480*             ELSE
 10481*                MOVE AL-UANON    TO CHECKNOA
 10482*                GO TO 1100-EDIT-HOLDTIL
 10483*         ELSE
 10484            MOVE AL-UANON    TO CHECKNOA
 10485            GO TO 1100-EDIT-HOLDTIL.
 10486
 10487     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10488     MOVE '6'                    TO CNTL-REC-TYPE.
 10489
 10490     IF CONTROL-IS-ACTUAL-CARRIER
 10491         MOVE PI-CARRIER         TO WS-CARR
 10492     ELSE
 10493         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10494
 10495     IF PI-COMPANY-ID = 'FIA'
 10496         MOVE PI-CARRIER         TO WS-CARR.
 10497
 10498     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10499     MOVE 0                      TO CNTL-SEQ-NO.
 10500     MOVE 'CARR'                 TO FILE-SWITCH.
 10501
 10502     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10503
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 198
* EL156.cbl
 10505     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10506         GO TO 1051-EDIT-CHECKNO-CONT.
 10507
 10508**********************AIG LOGIC STARTS**********************
 10509     IF PI-ECHECKNO = SPACES
 10510         IF CHECK-NO-MANUAL
 10511             MOVE ER-0441        TO EMI-ERROR
 10512             GO TO 1090-CHECK-NO-ERROR
 10513         ELSE
 10514             MOVE AL-UANOF       TO CHECKNOA
 10515             GO TO 1100-EDIT-HOLDTIL.
 10516
 10517     IF PI-ECHECKNO NOT = SPACES
 10518         IF CHECK-NO-MANUAL
 10519             MOVE AL-UANON       TO CHECKNOA
 10520             GO TO 1100-EDIT-HOLDTIL.
 10521
 10522     IF PI-ECHECKNO-CR = 'CR'
 10523        IF PI-OFFLINE = 'Y'
 10524            MOVE AL-UANON       TO CHECKNOA
 10525            GO TO 1100-EDIT-HOLDTIL
 10526        ELSE
 10527            MOVE ER-3534        TO EMI-ERROR
 10528            GO TO 1090-CHECK-NO-ERROR.
 10529
 10530     IF PI-ECHECKNO-N = 'N'
 10531        IF PI-CASH = 'N'
 10532            MOVE AL-UANON       TO CHECKNOA
 10533            GO TO 1100-EDIT-HOLDTIL
 10534        ELSE
 10535            MOVE ER-3535          TO EMI-ERROR
 10536            GO TO 1090-CHECK-NO-ERROR.
 10537
 10538     MOVE ER-0442        TO EMI-ERROR
 10539     GO TO 1090-CHECK-NO-ERROR.
 10540**********************AIG LOGIC ENDS************************
 10541
 10542 1051-EDIT-CHECKNO-CONT.
 10543
 10544     IF PI-COMPANY-ID = 'DMD'
 10545        IF PI-ECHECKNO NOT = SPACES
 10546           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10547              MOVE ER-0442        TO EMI-ERROR
 10548              GO TO 1090-CHECK-NO-ERROR
 10549            ELSE
 10550              GO TO 1100-EDIT-HOLDTIL
 10551          ELSE
 10552           GO TO 1100-EDIT-HOLDTIL.
 10553
 10554     IF PI-ECHECKNO = SPACES
 10555         IF CHECK-NO-MANUAL
 10556             MOVE ER-0441        TO EMI-ERROR
 10557             GO TO 1090-CHECK-NO-ERROR
 10558         ELSE
 10559             MOVE AL-UANOF       TO CHECKNOA
 10560             GO TO 1100-EDIT-HOLDTIL
 10561     ELSE
 10562         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 199
* EL156.cbl
 10563             MOVE AL-UANON       TO CHECKNOA
 10564             GO TO 1100-EDIT-HOLDTIL
 10565         ELSE
 10566             MOVE ER-0442        TO EMI-ERROR
 10567             GO TO 1090-CHECK-NO-ERROR.
 10568
 10569 1090-CHECK-NO-ERROR.
 10570     MOVE -1                     TO CHECKNOL.
 10571     MOVE AL-UABON               TO CHECKNOA.
 10572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10573
 10574     GO TO 2000-EDIT-DONE.
 10575
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 200
* EL156.cbl
 10577 1100-EDIT-HOLDTIL.
 10578     MOVE AL-UANON               TO HOLDTILA.
 10579
 10580     IF PI-HOLDTIL = ZEROS
 10581        IF PI-OFFLINE = 'Y'
 10582           MOVE ER-0572          TO EMI-ERROR
 10583           GO TO 1105-HOLDTIL-ERROR
 10584        ELSE
 10585           GO TO 1110-EDIT-PAID-FROM.
 10586
 10587     MOVE '4'                    TO DC-OPTION-CODE.
 10588     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10589     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10590
 10591     IF DATE-CONVERSION-ERROR
 10592         MOVE ER-0446            TO EMI-ERROR
 10593         GO TO 1105-HOLDTIL-ERROR
 10594     END-IF
 10595     IF PI-OFFLINE = 'Y'
 10596        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10597           MOVE ER-0446            TO EMI-ERROR
 10598           GO TO 1105-HOLDTIL-ERROR
 10599        END-IF
 10600     END-IF
 10601
 10602     IF PI-OFFLINE = 'Y'
 10603        GO TO 1110-EDIT-PAID-FROM.
 10604
 10605     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10606     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10607     MOVE '1'                    TO DC-OPTION-CODE.
 10608     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10609
 10610     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10611         MOVE ER-0447            TO EMI-ERROR
 10612         GO TO 1105-HOLDTIL-ERROR.
 10613
 10614     GO TO 1110-EDIT-PAID-FROM.
 10615
 10616 1105-HOLDTIL-ERROR.
 10617     MOVE -1                     TO HOLDTILL.
 10618     MOVE AL-UNBON               TO HOLDTILA.
 10619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10620
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 201
* EL156.cbl
 10622 1110-EDIT-PAID-FROM.
 10623     MOVE AL-UANON               TO EPYFROMA.
 10624
 10625     IF PI-EPYFROM = ZEROS
 10626         GO TO 1120-CALCULATE-PAID-FROM.
 10627
 10628     IF PI-PMTTYPE = '5' OR '6'
 10629         MOVE ER-0448            TO EMI-ERROR
 10630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10631         MOVE AL-UNBON           TO EPYFROMA
 10632         MOVE -1                 TO EPYFROML
 10633         GO TO 1150-EDIT-PAID-THRU.
 10634
 10635     MOVE '4'                    TO DC-OPTION-CODE.
 10636     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10637     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10638
 10639     IF DATE-CONVERSION-ERROR
 10640         MOVE ER-0449            TO EMI-ERROR
 10641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10642         MOVE AL-UNBON           TO EPYFROMA
 10643         MOVE -1                 TO EPYFROML
 10644     ELSE
 10645         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10646
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 202
* EL156.cbl
 10648 1120-CALCULATE-PAID-FROM.
 10649     IF PI-PMTTYPE = '5' OR '6'
 10650         GO TO 1150-EDIT-PAID-THRU.
 10651
 10652*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10653*       IF PI-PMTTYPE = '4'
 10654*         GO TO 1150-EDIT-PAID-THRU.
 10655
 10656     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10657         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10658         MOVE ' '                TO DC-OPTION-CODE
 10659         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10660         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10661         GO TO 1145-TEST-PAID-FROM.
 10662
 10663     IF PI-PMTTYPE = '4'
 10664        GO TO 1150-EDIT-PAID-THRU.
 10665
 10666     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10667     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10668     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10669     MOVE '5'                    TO CNTL-REC-TYPE.
 10670     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10671     MOVE 'BENE'                 TO FILE-SWITCH.
 10672
 10673     IF WS-BEN-CD = ZEROS
 10674         GO TO 1950-NOT-FOUND.
 10675
 10676     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10677
 10678     IF NO-BENEFIT-FOUND
 10679         GO TO 1950-NOT-FOUND.
 10680
 10681     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10682     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10683
 10684     IF PI-BEN-DAYS NOT NUMERIC
 10685        MOVE ZEROS               TO PI-BEN-DAYS.
 10686
 10687     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10688
 10689     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10690        (CL-TOTAL-PAID-AMT > ZEROS)
 10691         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10692         MOVE '6'                 TO DC-OPTION-CODE
 10693         MOVE +0                  TO DC-ELAPSED-MONTHS
 10694         MOVE +1                  TO DC-ELAPSED-DAYS
 10695         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10696         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10697         GO TO 1145-TEST-PAID-FROM.
 10698
 10699******************************************************************
 10700****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10701****** SPECIAL ENTERED DATE.
 10702******************************************************************
 10703
 10704     IF PI-AIGFROM = ZEROS
 10705         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 203
* EL156.cbl
 10706
 10707     MOVE AL-UANON TO AIGFROMA.
 10708
 10709     MOVE '4'                    TO DC-OPTION-CODE.
 10710     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10711     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10712
 10713     IF DATE-CONVERSION-ERROR
 10714         MOVE ER-0449            TO EMI-ERROR
 10715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10716         MOVE AL-UNBON           TO AIGFROMA
 10717         MOVE -1                 TO AIGFROML
 10718         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10719     ELSE
 10720         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10721         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10722
 10723     GO TO 1140-CONTINUE-PAID-FROM.
 10724
 10725 1130-CONTINUE-PAID-FROM.
 10726
 10727     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10728        (CL-TOTAL-PAID-AMT = ZEROS)
 10729           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10730
 10731 1140-CONTINUE-PAID-FROM.
 10732
 10733     IF PI-BEN-TYPE = 'R'
 10734         IF PI-BEN-DAYS = ZEROS
 10735             NEXT SENTENCE
 10736         ELSE
 10737         IF PI-COMPANY-ID NOT = 'DMD'
 10738             SUBTRACT 1 FROM PI-BEN-DAYS.
 10739
 10740     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10741
 10742     IF PI-COMPANY-ID = 'DMD'
 10743         MOVE -1                 TO DC-ELAPSED-DAYS
 10744         MOVE +0                 TO DC-ELAPSED-MONTHS
 10745         MOVE '6'                TO DC-OPTION-CODE
 10746         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10747         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10748         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10749                               REMAINDER DC-ELAPSED-DAYS
 10750      ELSE
 10751         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10752         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10753
 10754     MOVE '6'                    TO DC-OPTION-CODE.
 10755     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10756     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10757
 10758     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10759
 10760     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10761         MOVE ER-0541            TO EMI-ERROR
 10762         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10763         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 204
* EL156.cbl
 10764         MOVE AL-UNBON           TO EPYFROMA.
 10765
 10766     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10767        (PI-BENEFIT-SAVE = '60E')
 10768        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10769           (CL-TOTAL-PAID-AMT = ZEROS)
 10770             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10771             MOVE 30                  TO DC-ELAPSED-DAYS
 10772             MOVE +0                  TO DC-ELAPSED-MONTHS
 10773             MOVE '6'                 TO DC-OPTION-CODE
 10774             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10775
 10776     IF PI-BEN-TYPE = 'R'
 10777         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10778     ELSE
 10779         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10780         IF WS-SV-EPYFROM = LOW-VALUES
 10781            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10782
 10783     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10784         IF WS-USE-AIG-PAYFROM   OR
 10785            WS-AIG-RECALC-PAYFROM
 10786              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10787                                      DC-BIN-DATE-1
 10788              MOVE ' '            TO  DC-OPTION-CODE
 10789              MOVE +0             TO  DC-ELAPSED-MONTHS
 10790                                      DC-ELAPSED-DAYS
 10791              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10792              IF NO-CONVERSION-ERROR
 10793                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10794
 10795     IF PI-CPYFROM < CL-INCURRED-DT
 10796        MOVE -1                  TO EPYFROML
 10797        MOVE ER-3542             TO EMI-ERROR
 10798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10799
 10800     IF CM-ENTRY-DT < CL-INCURRED-DT
 10801        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10802        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10803        MOVE +0                     TO DC-ELAPSED-DAYS
 10804        MOVE +0                     TO DC-ELAPSED-MONTHS
 10805        MOVE '1'                    TO DC-OPTION-CODE
 10806        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10807        ELSE
 10808        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10809
 10810     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10811         NEXT SENTENCE
 10812     ELSE
 10813         IF DC-ELAPSED-MONTHS < 2
 10814             MOVE ER-3255        TO EMI-ERROR
 10815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10816
 10817 1145-TEST-PAID-FROM.
 10818     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10819         GO TO 1150-EDIT-PAID-THRU.
 10820
 10821     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 205
* EL156.cbl
 10822         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10823         MOVE ' '                TO DC-OPTION-CODE
 10824         MOVE +0                 TO DC-ELAPSED-MONTHS
 10825                                    DC-ELAPSED-DAYS
 10826         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10827         IF NO-CONVERSION-ERROR
 10828             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10829         ELSE
 10830             MOVE SPACES             TO EMI-DATE-FIELD.
 10831
 10832     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10833         IF CL-TOTAL-PAID-AMT = ZEROS
 10834             MOVE ER-3543            TO EMI-ERROR
 10835             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10837             IF EMI-MESSAGE-FORMATTED
 10838                MOVE -1             TO EPYFROML
 10839                MOVE AL-UNBON       TO EPYFROMA
 10840             ELSE
 10841                NEXT SENTENCE
 10842         ELSE
 10843             MOVE ER-0452            TO EMI-ERROR
 10844             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846             IF EMI-MESSAGE-FORMATTED
 10847                MOVE -1             TO EPYFROML
 10848                MOVE AL-UNBON       TO EPYFROMA.
 10849
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 206
* EL156.cbl
 10851 1150-EDIT-PAID-THRU.
 10852
 10853     MOVE AL-UANON               TO EPYTHRUA.
 10854
 10855     IF PI-EPYTHRU = ZEROS
 10856*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10857         IF PI-PMTTYPE = '5' OR '6'
 10858           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10859             GO TO 1200-EDIT-FIND-TOLERANCES
 10860         ELSE
 10861            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10862               (PI-PMTTYPE = '2' AND
 10863                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10864               GO TO 1152-CHECK-TYPE
 10865            ELSE
 10866               MOVE ER-0473      TO EMI-ERROR
 10867               GO TO 1170-PAID-THRU-FATAL-ERROR
 10868     ELSE
 10869         IF PI-PMTTYPE = '5' OR '6'
 10870             MOVE ER-0474        TO EMI-ERROR
 10871             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10872
 10873     MOVE '4'                    TO DC-OPTION-CODE.
 10874     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10875     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10876
 10877     IF DATE-CONVERSION-ERROR
 10878         MOVE ER-0475            TO EMI-ERROR
 10879         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10880
 10881     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10882
 10883     IF PI-COMPANY-ID = 'DMD'
 10884         IF PI-PMTTYPE NOT = '2'
 10885                 AND
 10886            WS-EXP-DT > WS-SV-EPYTHRU
 10887             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10888             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10889             MOVE '1'              TO DC-OPTION-CODE
 10890             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10891             IF DATE-CONVERSION-ERROR
 10892                 MOVE ER-0944      TO EMI-ERROR
 10893                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10894             ELSE
 10895                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10896                    DC-ELAPSED-DAYS   = 1
 10897                     MOVE ER-0945  TO EMI-ERROR
 10898                     MOVE -1       TO EPYTHRUL
 10899                     MOVE AL-UABON TO EPYTHRUA
 10900                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10901
 10902     IF PI-PMTTYPE = '4'
 10903         NEXT SENTENCE
 10904     ELSE
 10905         IF WS-SV-EPYTHRU = WS-EXP-DT
 10906             IF PI-PMTTYPE NOT = '2' AND '3'
 10907                 MOVE ER-3541    TO EMI-ERROR
 10908                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 207
* EL156.cbl
 10909                 MOVE AL-UABON   TO PMTTYPEA
 10910                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10911
 10912     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10913         MOVE ER-0501            TO EMI-ERROR
 10914         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10915
 10916     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10917        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10918*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10919*              MOVE ER-0540         TO EMI-ERROR
 10920*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10921*              MOVE -1              TO EPYTHRUL
 10922*              MOVE AL-UNBON        TO EPYTHRUA
 10923*          ELSE
 10924*          IF PI-COMPANY-ID = 'DMD'
 10925*              MOVE ER-7540         TO EMI-ERROR
 10926*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10927*              MOVE -1              TO EPYTHRUL
 10928*              MOVE AL-UNBON        TO EPYTHRUA
 10929*          ELSE
 10930               IF PI-PMTTYPE NOT = '2' AND '3'
 10931                  IF PI-COMPANY-ID = '???'
 10932                      MOVE ER-7540  TO EMI-ERROR
 10933                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10934                      MOVE -1       TO EPYTHRUL
 10935                      MOVE AL-UNBON TO EPYTHRUA
 10936                  ELSE
 10937                      MOVE ER-0540  TO EMI-ERROR
 10938                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10939                      MOVE -1       TO EPYTHRUL
 10940                      MOVE AL-UNBON TO EPYTHRUA.
 10941
 10942     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10943            OR
 10944        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10945         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10946            OR
 10947        (PI-CPYFROM NOT = LOW-VALUES AND
 10948         PI-CPYFROM < CL-PAID-THRU-DT)
 10949        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10950
 10951 1152-CHECK-TYPE.
 10952     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10953        OR (PI-PMTTYPE = '5' OR '6')
 10954         GO TO 1160-EDIT-PAID-THRU-AH.
 10955
 10956 1155-EDIT-PAID-THRU-LIFE.
 10957     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10958     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10959     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10960     MOVE '4'                    TO CNTL-REC-TYPE.
 10961     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10962     MOVE 'BENE'                 TO FILE-SWITCH.
 10963
 10964     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10965
 10966     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 208
* EL156.cbl
 10967         GO TO 1950-NOT-FOUND.
 10968
 10969     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10970
 10971     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10972
 10973     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10974        PI-LF-COVERAGE-TYPE = 'P'
 10975         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10976         GO TO 1200-EDIT-FIND-TOLERANCES.
 10977
 10978     IF PI-EPYTHRU = ZEROS
 10979        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10980
 10981     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10982         MOVE ER-0476            TO EMI-ERROR
 10983         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10984
 10985     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10986*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10987     move cl-critical-period    to dc-elapsed-months
 10988     MOVE +0                    TO DC-ELAPSED-DAYS.
 10989     MOVE '6'                   TO DC-OPTION-CODE.
 10990     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10991
 10992     IF (NO-CONVERSION-ERROR AND
 10993         WS-SPECIAL-CALC-CD = 'C')
 10994        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10995            MOVE ER-0657 TO EMI-ERROR
 10996            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10997
 10998     IF PI-COMPANY-ID = 'NCL'
 10999         IF WS-SPECIAL-CALC-CD = 'C' AND
 11000            cl-critical-period = zeros
 11001*           CM-LF-CRITICAL-PERIOD = +0
 11002             MOVE ER-0844       TO EMI-ERROR
 11003             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11004
 11005     GO TO 1200-EDIT-FIND-TOLERANCES.
 11006
 11007 1160-EDIT-PAID-THRU-AH.
 11008     IF PI-EPYTHRU = ZEROS
 11009        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11010                                    WS-SV-EPYTHRU
 11011     ELSE
 11012        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11013
 11014     IF WS-SV-EPYTHRU < PI-CPYFROM
 11015         MOVE ER-0508            TO EMI-ERROR
 11016         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11017
 11018     perform 7975-read-acct      thru 7975-exit
 11019     move zeros                  to pi-max-ext
 11020     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11021        PERFORM 0900-GET-DDF-LIMITS
 11022                                 THRU 0900-EXIT
 11023        IF PDEF-FOUND
 11024           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 209
* EL156.cbl
 11025              (P1 > +8)
 11026              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11027           END-PERFORM
 11028           IF P1 < +9
 11029              MOVE PD-MAX-extension (P1)
 11030                                 TO pi-max-ext
 11031           else
 11032              move er-1674       to emi-error
 11033              PERFORM 9900-ERROR-FORMAT
 11034                                 THRU 9900-EXIT
 11035           END-IF
 11036        else
 11037           move er-1672          to emi-error
 11038           PERFORM 9900-ERROR-FORMAT
 11039                                 THRU 9900-EXIT
 11040        END-IF
 11041     end-if
 11042     move spaces                 to pi-max-ext-used
 11043     IF PI-PMTTYPE = '3'
 11044        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11045        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11046           MOVE ER-0477          TO EMI-ERROR
 11047           PERFORM 1165-PAID-THRU-ERROR
 11048                                 THRU 1165-EXIT
 11049        ELSE
 11050           continue
 11051        end-if
 11052     ELSE
 11053        IF WS-SV-EPYTHRU > WS-EXP-DT
 11054           move ws-exp-dt        to dc-bin-date-1
 11055           move ws-sv-epythru    to dc-bin-date-2
 11056           MOVE '1'              TO DC-OPTION-CODE
 11057           MOVE +0               TO DC-ELAPSED-DAYS
 11058                                    DC-ELAPSED-MONTHS
 11059           PERFORM 9700-LINK-DATE-CONVERT
 11060                                 THRU 9700-EXIT
 11061           if no-conversion-error
 11062              if dc-elapsed-days > zeros
 11063                 add +1 to dc-elapsed-months
 11064              end-if
 11065              if dc-elapsed-months > pi-max-ext
 11066                 MOVE ER-0557    TO EMI-ERROR
 11067                 PERFORM 1165-PAID-THRU-ERROR
 11068                                 THRU 1165-EXIT
 11069              else
 11070                 move 'Y'        to pi-max-ext-used
 11071                 move er-1670    to emi-error
 11072                 perform 9900-error-format
 11073                                 thru 9900-exit
 11074              end-if
 11075           end-if
 11076        end-if
 11077     end-if
 11078
 11079     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11080         PI-PMTTYPE NOT = '3'
 11081         MOVE ER-0541        TO EMI-ERROR
 11082         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 210
* EL156.cbl
 11083
 11084     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11085        (PI-PMTTYPE NOT = '3')
 11086         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11087             MOVE ER-0478        TO EMI-ERROR
 11088             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11089
 11090     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11091        (PI-PMTTYPE NOT = '4')
 11092         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11093             MOVE ER-0479        TO EMI-ERROR
 11094             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11095
 11096     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11097         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11098             MOVE ER-0545        TO EMI-ERROR
 11099             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11100
 11101     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11102         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11103             MOVE ER-0481        TO EMI-ERROR
 11104             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11105
 11106*    IF PI-COMPANY-ID = 'NCL'
 11107*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11108*           CM-AH-CRITICAL-PERIOD = +0
 11109*            MOVE ER-0844        TO  EMI-ERROR
 11110*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11111
 11112*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11113     if (cl-critical-period = zeros)
 11114        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11115          GO TO 1200-EDIT-FIND-TOLERANCES.
 11116
 11117     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11118     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11119     MOVE '1'        TO DC-OPTION-CODE.
 11120     MOVE +0         TO DC-ELAPSED-DAYS
 11121                        DC-ELAPSED-MONTHS.
 11122     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11123
 11124*    IF NO-CONVERSION-ERROR
 11125*       COMPUTE ws-benefits-paid =
 11126*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11127*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11128*           MOVE ER-0657 TO EMI-ERROR
 11129*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11130
 11131     GO TO 1200-EDIT-FIND-TOLERANCES.
 11132
 11133 1165-PAID-THRU-ERROR.
 11134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11135
 11136     IF EMI-MESSAGE-FORMATTED
 11137         MOVE -1                 TO EPYTHRUL
 11138         MOVE AL-UNBON           TO EPYTHRUA.
 11139
 11140 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 211
* EL156.cbl
 11141     EXIT.
 11142
 11143 1166-CHECK-ALL-TRLRS.
 11144
 11145     IF PI-PMTTYPE = '4'
 11146        GO TO 1166-TRLR-EXIT.
 11147
 11148     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11149
 11150     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11151        WS-SV-EPYFROM = LOW-VALUES
 11152          GO TO 1166-END-CHECK.
 11153
 11154
 11155* EXEC CICS HANDLE CONDITION
 11156*        ENDFILE   (1166-END-CHECK)
 11157*        NOTFND    (1166-END-CHECK)
 11158*    END-EXEC.
 11159*    MOVE '"$''I                  ! ) #00010738' TO DFHEIV0
 11160     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11162     MOVE X'2920233030303130373338' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0
 11164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11165
 11166
 11167     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11168     MOVE +100                   TO TRLR-SEQ-NO.
 11169
 11170
 11171* EXEC CICS STARTBR
 11172*         DATASET    ('ELTRLR')
 11173*         RIDFLD     (ELTRLR-KEY)
 11174*         GTEQ
 11175*    END-EXEC.
 11176     MOVE 'ELTRLR' TO DFHEIV1
 11177     MOVE 0
 11178       TO DFHEIV11
 11179*    MOVE '&,         G          &   #00010746' TO DFHEIV0
 11180     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11181     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11182     MOVE X'2020233030303130373436' TO DFHEIV0(25:11)
 11183     CALL 'kxdfhei1' USING DFHEIV0,
 11184           DFHEIV1,
 11185           ELTRLR-KEY,
 11186           DFHEIV99,
 11187           DFHEIV11,
 11188           DFHEIV99
 11189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11190
 11191
 11192     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11193
 11194 1166-READ-TRLR-NEXT.
 11195
 11196
 11197* EXEC CICS READNEXT
 11198*         DATASET    ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 212
* EL156.cbl
 11199*         RIDFLD     (ELTRLR-KEY)
 11200*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11201*    END-EXEC.
 11202     MOVE 'ELTRLR' TO DFHEIV1
 11203     MOVE 0
 11204       TO DFHEIV11
 11205*    MOVE '&.S                   )   #00010756' TO DFHEIV0
 11206     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11208     MOVE X'2020233030303130373536' TO DFHEIV0(25:11)
 11209     CALL 'kxdfhei1' USING DFHEIV0,
 11210           DFHEIV1,
 11211           DFHEIV20,
 11212           DFHEIV99,
 11213           ELTRLR-KEY,
 11214           DFHEIV99,
 11215           DFHEIV11,
 11216           DFHEIV99,
 11217           DFHEIV99
 11218     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11219         DFHEIV20
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11221
 11222
 11223     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11224        TRLR-CARRIER  = MSTR-CARRIER  AND
 11225        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11226        TRLR-CERT-NO  = MSTR-CERT-NO
 11227          NEXT SENTENCE
 11228      ELSE
 11229          GO TO 1166-END-CHECK.
 11230
 11231* **  BYPASS ALL NON-PAYMENT TRAILERS
 11232
 11233     IF AT-TRAILER-TYPE = '2'
 11234        NEXT SENTENCE
 11235     ELSE
 11236        GO TO 1166-READ-TRLR-NEXT.
 11237
 11238* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11239
 11240     IF AT-PAYMENT-TYPE = '1' OR '2'
 11241        NEXT SENTENCE
 11242     ELSE
 11243        GO TO 1166-READ-TRLR-NEXT.
 11244
 11245* **  BYPASS ALL VOID PAYMENTS
 11246
 11247     IF AT-VOID-DT NOT = LOW-VALUES
 11248        GO TO 1166-READ-TRLR-NEXT.
 11249
 11250     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11251        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11252          GO TO 1166-READ-TRLR-NEXT.
 11253
 11254     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11255         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11256            OR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 213
* EL156.cbl
 11257        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11258         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11259        NEXT SENTENCE
 11260     ELSE
 11261         IF CL-TOTAL-PAID-AMT > ZEROS
 11262             MOVE ER-0502            TO EMI-ERROR
 11263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264             MOVE -1                 TO EPYTHRUL
 11265             MOVE AL-UNBON           TO EPYTHRUA.
 11266
 11267     GO TO 1166-READ-TRLR-NEXT.
 11268
 11269 1166-END-CHECK.
 11270
 11271     IF WS-BROWSE-TRLR-SW = 'Y'
 11272
 11273* EXEC CICS ENDBR
 11274*            DATASET   ('ELTRLR')
 11275*       END-EXEC.
 11276     MOVE 'ELTRLR' TO DFHEIV1
 11277     MOVE 0
 11278       TO DFHEIV11
 11279*    MOVE '&2                    $   #00010811' TO DFHEIV0
 11280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11282     MOVE X'2020233030303130383131' TO DFHEIV0(25:11)
 11283     CALL 'kxdfhei1' USING DFHEIV0,
 11284           DFHEIV1,
 11285           DFHEIV11,
 11286           DFHEIV99
 11287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11288
 11289
 11290     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11291
 11292 1166-TRLR-EXIT.
 11293     EXIT.
 11294
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 214
* EL156.cbl
 11296 1170-PAID-THRU-FATAL-ERROR.
 11297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298
 11299     MOVE -1                     TO EPYTHRUL.
 11300     MOVE AL-UNBON               TO EPYTHRUA.
 11301
 11302 1200-EDIT-FIND-TOLERANCES.
 11303
 11304* EXEC CICS HANDLE CONDITION
 11305*        ENDFILE(1950-NOT-FOUND)
 11306*        NOTFND (1950-NOT-FOUND)
 11307*    END-EXEC.
 11308*    MOVE '"$''I                  ! * #00010828' TO DFHEIV0
 11309     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11311     MOVE X'2A20233030303130383238' TO DFHEIV0(25:11)
 11312     CALL 'kxdfhei1' USING DFHEIV0
 11313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11314
 11315
 11316     IF PI-PROCESSOR-ID = 'LGXX'
 11317        GO TO 1240-FIND-ACCT-TOLERANCES.
 11318
 11319     MOVE 'N'                    TO FOUND-TOL-SW.
 11320     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11321     MOVE '2'                    TO CNTL-REC-TYPE.
 11322     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11323     MOVE +0                     TO CNTL-SEQ-NO.
 11324     MOVE 'PROC'                 TO FILE-SWITCH.
 11325
 11326     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11327
 11328     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11329     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11330                                    PI-MAX-PMT-TOL.
 11331     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11332
 11333     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11334         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11335
 11336     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11337     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11338                                    PI-MAX-LF-PMT-TOL.
 11339
 11340     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11341         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11342
 11343     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11344                                    PI-MAX-EXP-PMT.
 11345
 11346 1240-FIND-ACCT-TOLERANCES.
 11347
 11348     IF WS-PMT-TOL NOT = +0
 11349         MOVE 'Y'                TO FOUND-TOL-SW.
 11350
 11351     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11352         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11353         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 215
* EL156.cbl
 11354         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11355         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11356         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11357         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11358     ELSE
 11359         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11360         MOVE PI-CARRIER             TO ACCT-CARRIER
 11361         MOVE PI-GROUPING            TO ACCT-GROUPING
 11362         MOVE PI-STATE               TO ACCT-STATE
 11363         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11364         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11365
 11366     MOVE 'ACCT'                 TO FILE-SWITCH.
 11367
 11368     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11369     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11370
 11371
 11372* EXEC CICS HANDLE CONDITION
 11373*         NOTFND   (1950-NOT-FOUND)
 11374*         ENDFILE  (1950-NOT-FOUND)
 11375*    END-EXEC.
 11376*    MOVE '"$I''                  ! + #00010888' TO DFHEIV0
 11377     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11379     MOVE X'2B20233030303130383838' TO DFHEIV0(25:11)
 11380     CALL 'kxdfhei1' USING DFHEIV0
 11381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11382
 11383
 11384
 11385* EXEC CICS STARTBR
 11386*        DATASET('ERACCT')
 11387*        RIDFLD (ERACCT-KEY)
 11388*        GTEQ
 11389*    END-EXEC.
 11390     MOVE 'ERACCT' TO DFHEIV1
 11391     MOVE 0
 11392       TO DFHEIV11
 11393*    MOVE '&,         G          &   #00010893' TO DFHEIV0
 11394     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11396     MOVE X'2020233030303130383933' TO DFHEIV0(25:11)
 11397     CALL 'kxdfhei1' USING DFHEIV0,
 11398           DFHEIV1,
 11399           ERACCT-KEY,
 11400           DFHEIV99,
 11401           DFHEIV11,
 11402           DFHEIV99
 11403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11404
 11405
 11406 1245-FIND-ACCT-TOLERANCES-LOOP.
 11407
 11408
 11409* EXEC CICS READNEXT
 11410*        DATASET('ERACCT')
 11411*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 216
* EL156.cbl
 11412*        RIDFLD (ERACCT-KEY)
 11413*    END-EXEC.
 11414     MOVE 'ERACCT' TO DFHEIV1
 11415     MOVE 0
 11416       TO DFHEIV11
 11417*    MOVE '&.S                   )   #00010901' TO DFHEIV0
 11418     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11419     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11420     MOVE X'2020233030303130393031' TO DFHEIV0(25:11)
 11421     CALL 'kxdfhei1' USING DFHEIV0,
 11422           DFHEIV1,
 11423           DFHEIV20,
 11424           DFHEIV99,
 11425           ERACCT-KEY,
 11426           DFHEIV99,
 11427           DFHEIV11,
 11428           DFHEIV99,
 11429           DFHEIV99
 11430     SET ADDRESS OF ACCOUNT-MASTER TO
 11431         DFHEIV20
 11432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11433
 11434
 11435     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11436        IF WS-ERACCT-HOLD-RECORD = SPACES
 11437           GO TO 1950-NOT-FOUND
 11438        ELSE
 11439           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11440           GO TO 1250-CONTINUE.
 11441
 11442     IF ACCT-EXP-DT = HIGH-VALUES
 11443        NEXT SENTENCE
 11444     ELSE
 11445        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11446        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11447
 11448 1250-CONTINUE.
 11449
 11450     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11451
 11452     IF FOUND-TOL-SW = 'N'
 11453         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11454
 11455********* 1260-FIND-STATE-TOLERANCES.
 11456
 11457     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11458     MOVE PI-STATE               TO WS-ST-ACCESS.
 11459     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11460     MOVE '3'                    TO CNTL-REC-TYPE.
 11461     MOVE +0                     TO CNTL-SEQ-NO.
 11462     MOVE 'STAT'                 TO FILE-SWITCH.
 11463
 11464     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11465
 11466     IF WS-PMT-TOL = +0
 11467         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11468
 11469     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 217
* EL156.cbl
 11470     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11471     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11472     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11473     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11474
 11475****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11476****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11477     IF PI-PAYEE-TYPE <> 'B'
 11478           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11479     END-IF.
 11480
 11481     IF PI-PMTTYPE      = '2'  AND
 11482        PI-SPLIT-PMT-SW = 'Y'  AND
 11483        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11484          MOVE ER-3530                TO EMI-ERROR
 11485          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11486
 11487********* 1280-FIND-BENEFIT-TOLERANCES.
 11488
 11489     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11490        OR (PI-PMTTYPE = '5' OR '6')
 11491         GO TO 1300-FIND-CARR-TOLERANCES.
 11492
 11493     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11494     MOVE '4'                    TO CNTL-REC-TYPE.
 11495     MOVE +0                     TO CNTL-SEQ-NO.
 11496     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11497     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11498     MOVE 'BENE'                 TO FILE-SWITCH.
 11499
 11500     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11501
 11502     IF NO-BENEFIT-FOUND
 11503         GO TO 1950-NOT-FOUND.
 11504
 11505     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11506     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11507     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11508
 11509
 11510* EXEC CICS HANDLE CONDITION
 11511*        NOTFND(1950-NOT-FOUND)
 11512*    END-EXEC.
 11513*    MOVE '"$I                   ! , #00010981' TO DFHEIV0
 11514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11516     MOVE X'2C20233030303130393831' TO DFHEIV0(25:11)
 11517     CALL 'kxdfhei1' USING DFHEIV0
 11518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11519
 11520
 11521 1300-FIND-CARR-TOLERANCES.
 11522     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11523     MOVE '6'                    TO CNTL-REC-TYPE.
 11524
 11525     IF CONTROL-IS-ACTUAL-CARRIER
 11526         MOVE PI-CARRIER               TO WS-CARR
 11527     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 218
* EL156.cbl
 11528         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11529
 11530     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11531     MOVE +0                     TO CNTL-SEQ-NO.
 11532     MOVE 'CARR'                 TO FILE-SWITCH.
 11533
 11534     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11535
 11536     IF WS-DAYS-TOL = +0
 11537         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11538
 11539     IF WS-PMT-TOL = +0
 11540         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11541
 11542     IF WS-MAX-DAYS-TOL = +0
 11543         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11544
 11545     IF WS-MAX-PMT-TOL = +0
 11546         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11547                                    PI-MAX-PMT-TOL.
 11548
 11549     IF WS-MAX-LF-PMT-TOL = +0
 11550        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11551                                    PI-MAX-LF-PMT-TOL.
 11552
 11553     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11554
 11555********* 1320-FIND-COMP-TOLERANCES.
 11556
 11557     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11558     MOVE '1'                    TO CNTL-REC-TYPE.
 11559     MOVE SPACES                 TO CNTL-ACCESS.
 11560     MOVE +0                     TO CNTL-SEQ-NO.
 11561     MOVE 'COMP'                 TO FILE-SWITCH.
 11562
 11563     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11564
 11565     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11566     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11567
 11568     IF WS-PMT-TOL NOT = +0
 11569        IF WS-TOL-SEVERITY NOT = ' '
 11570         GO TO 1360-EDIT-DAYS.
 11571
 11572     IF WS-PMT-TOL = +0
 11573         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11574
 11575     IF WS-TOL-SEVERITY = ' '
 11576         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11577
 11578 1360-EDIT-DAYS.
 11579     IF PI-PMTTYPE NOT = '4'
 11580        IF PI-EDAYS NEGATIVE OR
 11581           PI-EPYAMT NEGATIVE
 11582          MOVE ER-0513             TO EMI-ERROR
 11583          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584          MOVE -1                  TO PMTTYPEL.
 11585
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 219
* EL156.cbl
 11586     IF PI-PMTTYPE = '5' OR '6'
 11587        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11588
 11589     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11590        IF PI-PMTTYPE = '4'
 11591          MOVE PI-EDAYS          TO PI-CDAYS.
 11592
 11593     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11594         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11595
 11596     IF PI-PMTTYPE = '4'
 11597        MOVE PI-EDAYS            TO PI-CDAYS
 11598        GO TO 1400-EDIT-PAYMENT.
 11599
 11600     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11601        GO TO 1500-EDIT-EXPENSES.
 11602
 11603*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11604*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11605*          CM-AH-BENEFIT-CD = '23'              AND
 11606*          CL-CERT-STATE    = '04'              AND
 11607*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11608*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11609*            GO TO 1362-CHECK-MAX-DAYS.
 11610
 11611     IF PI-EDAYS = ZEROS
 11612*        IF PI-COMPANY-ID = 'DMD'
 11613*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11614*            MOVE -1             TO DC-ELAPSED-DAYS
 11615*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11616*            MOVE '6'            TO DC-OPTION-CODE
 11617*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11618*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11619*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11620*            MOVE '1'            TO DC-OPTION-CODE
 11621*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11622*            IF NO-CONVERSION-ERROR
 11623*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11624*                                 + DC-ODD-DAYS-OVER
 11625*               MOVE 6           TO EDAYSL
 11626*               MOVE AL-UNNON    TO EDAYSA
 11627*            ELSE
 11628*                NEXT SENTENCE
 11629*       ELSE
 11630            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11631            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11632            MOVE '1'             TO DC-OPTION-CODE
 11633            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11634            IF NO-CONVERSION-ERROR
 11635                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11636                ADD 1                 TO PI-EDAYS
 11637                MOVE AL-UNNON         TO EDAYSA.
 11638
 11639*    IF PI-COMPANY-ID = 'DMD'
 11640*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11641*        MOVE -1                 TO DC-ELAPSED-DAYS
 11642*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11643*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 220
* EL156.cbl
 11644*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11645*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11646*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11647*        MOVE '1'                TO DC-OPTION-CODE
 11648*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11649*    ELSE
 11650         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11651         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11652         MOVE '1'                TO DC-OPTION-CODE.
 11653         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11654
 11655     IF NO-CONVERSION-ERROR
 11656        IF PI-COMPANY-ID = 'DMD'
 11657            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11658                             + DC-ODD-DAYS-OVER
 11659        ELSE
 11660            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11661            ADD 1                TO PI-CDAYS.
 11662
 11663     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11664        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11665        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11666
 11667     IF PI-EDAYS NOT NUMERIC
 11668         MOVE ER-0491            TO EMI-ERROR
 11669         GO TO 1370-DAYS-ERROR.
 11670
 11671     IF CL-NO-OF-PMTS-MADE = 0
 11672        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11673        AND CL-CERT-STATE = 'MI'
 11674        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11675            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11676     END-IF.
 11677
 11678 1362-CHECK-MAX-DAYS.
 11679
 11680     IF WS-MAX-DAYS-TOL = +999
 11681         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11682
 11683     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11684         IF PI-EDAYS = ZEROS
 11685             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11686         ELSE
 11687             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11688
 11689     IF WS-MAX-DAYS-TOL NOT = ZERO
 11690        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11691           PI-CDAYS > WS-MAX-DAYS-TOL
 11692             MOVE ER-0492          TO EMI-ERROR
 11693             GO TO 1370-DAYS-ERROR.
 11694
 11695 1365-SKIP-MAX-DAYS-EDIT.
 11696     IF PI-EDAYS = ZEROS
 11697        GO TO 1400-EDIT-PAYMENT.
 11698
 11699     IF WS-DAYS-TOL NOT = ZERO
 11700        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11701           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 221
* EL156.cbl
 11702                MOVE ER-0493     TO EMI-ERROR
 11703                GO TO 1370-DAYS-ERROR.
 11704
 11705     GO TO 1400-EDIT-PAYMENT.
 11706
 11707 1370-DAYS-ERROR.
 11708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11709
 11710     IF EMI-MESSAGE-FORMATTED
 11711         MOVE -1                 TO EDAYSL
 11712         MOVE AL-UABON           TO EDAYSA.
 11713
 11714     GO TO 1400-EDIT-PAYMENT.
 11715
 11716 1380-EDIT-EXPENSE-PMT-AMT.
 11717     IF PI-PMTTYPE = '5' OR '6'
 11718         NEXT SENTENCE
 11719     ELSE
 11720         GO TO 1400-EDIT-PAYMENT.
 11721
 11722     IF WS-MAX-EXP-PMT NOT = ZEROS
 11723        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11724            MOVE ER-3529            TO EMI-ERROR
 11725            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11726
 11727     GO TO 1500-EDIT-EXPENSES.
 11728
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 222
* EL156.cbl
 11730
 11731 1390-CHECK-PAYMENT-DAYS.
 11732
 11733     IF PI-EDAYS = 0
 11734         MOVE PI-CDAYS TO WS-PD-DAYS
 11735     ELSE
 11736         MOVE PI-EDAYS TO WS-PD-DAYS
 11737     END-IF.
 11738
 11739     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11740         IF WS-PD-DAYS = 14
 11741            GO TO 1390-EXIT
 11742         END-IF
 11743     END-IF.
 11744
 11745     IF PI-COMPANY-ID = 'AHL'  AND
 11746        CM-AH-BENEFIT-CD = '1K'
 11747         IF WS-PD-DAYS = 14
 11748            GO TO 1390-EXIT
 11749         END-IF
 11750     END-IF.
 11751
 11752     IF WS-PD-DAYS < 30
 11753         MOVE ER-3549              TO EMI-ERROR
 11754         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11755     END-IF.
 11756
 11757 1390-EXIT.
 11758      EXIT.
 11759
 11760 1400-EDIT-PAYMENT.
 11761*    IF PI-COMPANY-ID = 'DMD'
 11762*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11763*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11764
 11765     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11766        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11767        MOVE PI-CARRIER          TO ACCT-CARRIER
 11768        MOVE PI-GROUPING         TO ACCT-GROUPING
 11769        MOVE PI-STATE            TO ACCT-STATE
 11770        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11771        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11772        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11773        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11774
 11775
 11776* EXEC CICS READ
 11777*          DATASET ('ERACCT')
 11778*          RIDFLD  (ERACCT-KEY)
 11779*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11780*          GTEQ
 11781*          resp    (WS-RESPONSE)
 11782*       END-EXEC
 11783     MOVE 'ERACCT' TO DFHEIV1
 11784*    MOVE '&"S        G          (  N#00011239' TO DFHEIV0
 11785     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11787     MOVE X'204E233030303131323339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 223
* EL156.cbl
 11788     CALL 'kxdfhei1' USING DFHEIV0,
 11789           DFHEIV1,
 11790           DFHEIV20,
 11791           DFHEIV99,
 11792           ERACCT-KEY,
 11793           DFHEIV99,
 11794           DFHEIV99,
 11795           DFHEIV99
 11796     SET ADDRESS OF ACCOUNT-MASTER TO
 11797         DFHEIV20
 11798     MOVE EIBRESP  TO WS-RESPONSE
 11799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11800        IF WS-RESP-NORMAL
 11801           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11802           and pi-cert-eff-dt < am-expiration-dt
 11803           and pi-cert-eff-dt >= am-effective-dt
 11804           move am-dcc-product-code to pi-dcc-product-code
 11805        else
 11806           move spaces           to pi-dcc-product-code
 11807        end-if
 11808        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11809           PERFORM 0900-GET-DDF-LIMITS
 11810                                 THRU 0900-EXIT
 11811           IF PDEF-FOUND
 11812              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11813                 (P1 > +8)
 11814                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11815              END-PERFORM
 11816              IF P1 < +9
 11817                 if pd-ben-pct (p1) not numeric
 11818                    move zeros   to pd-ben-pct (p1)
 11819                 end-if
 11820                 if pd-ben-pct (p1) = zeros
 11821                    move +1      to ws-work-ben-pct
 11822                 else
 11823                    move pd-ben-pct (p1)
 11824                                 to ws-work-ben-pct
 11825                 end-if
 11826                 compute cm-ah-benefit-amt =
 11827                    cm-ah-benefit-amt * ws-work-ben-pct
 11828                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11829                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11830                 end-if
 11831              else
 11832                 move er-1674    to emi-error
 11833                 PERFORM 9900-ERROR-FORMAT
 11834                                 THRU 9900-EXIT
 11835              END-IF
 11836           else
 11837              move er-1672       to emi-error
 11838              PERFORM 9900-ERROR-FORMAT
 11839                                 THRU 9900-EXIT
 11840           END-IF
 11841        end-if
 11842     END-IF
 11843     IF PI-PMTTYPE NOT = '4'
 11844        GO TO 1405-CALC-PAYMENT.
 11845     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 224
* EL156.cbl
 11846         MOVE PI-EPYAMT           TO PI-CPYAMT
 11847         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11848         GO TO 1430-CHECK-AH-TOLERANCE.
 11849
 11850*    IF PI-COMPANY-ID = 'FIA'
 11851*       IF CERT-ACCOUNT = '0000011043'
 11852*        COMPUTE PI-DAILY-RATE ROUNDED =
 11853*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11854*        COMPUTE PI-CPYAMT ROUNDED =
 11855*                          PI-DAILY-RATE * PI-EDAYS
 11856*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11857*        GO TO 1430-CHECK-AH-TOLERANCE.
 11858
 11859     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11860         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11861         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11862         GO TO 1420-CHECK-AIG-BENEFIT.
 11863
 11864     IF WS-CALC-METHOD = '2' OR  '5'
 11865         COMPUTE PI-DAILY-RATE ROUNDED =
 11866                        (CM-AH-BENEFIT-AMT * 12) / 365
 11867         COMPUTE PI-CPYAMT ROUNDED =
 11868                           PI-DAILY-RATE * PI-EDAYS
 11869        GO TO 1420-CHECK-AIG-BENEFIT.
 11870
 11871     IF WS-CALC-METHOD = '3'
 11872         COMPUTE PI-DAILY-RATE =
 11873                         (CM-AH-BENEFIT-AMT * 12) / 365
 11874         COMPUTE PI-CPYAMT ROUNDED =
 11875                           PI-DAILY-RATE * PI-EDAYS
 11876        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 225
* EL156.cbl
 11878*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11879
 11880****************************************************************
 11881****************************************************************
 11882*                  CALCULATED FROM      PAYMENT      PAYMENT
 11883*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11884* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11885*1-01-83  1-15-83    0    15     15        15           15
 11886*1-01-83  1-30-83    0    30     30        30           30
 11887*1-01-83  1-31-83    1     0     31        30           30
 11888*1-01-83  2-01-83    1     1     32        31           31
 11889*1-01-83  2-15-83    1    15     46        45           45
 11890*1-01-83  2-28-83    2     0     59        60           60
 11891*1-01-83  3-01-83    2     1     60        61           61
 11892*1-01-83  3-31-83    3     0     90        90           90
 11893*1-15-83  1-31-83    0    17     17        17           16
 11894*1-15-83  2-01-83    0    18     18        18           17
 11895*1-15-83  2-28-83    1    14     45        44           46
 11896*1-21-83  3-09-83    1    20     48        50           49
 11897*2-05-83  3-06-83    1     2     30        32           32
 11898*2-05-83  3-23-83    1    19     47        49           49
 11899*2-15-83  2-28-83    0    14     14        14           16
 11900*2-15-83  3-01-83    0    15     15        15           17
 11901*2-21-83  3-19-83    0    27     27        27           29
 11902*2-21-83  3-20-83    1     0     28        30           30
 11903*2-21-83  4-10-83    1    18     49        30           50
 11904*2-21-83  5-19-83    2    27     88        87           89
 11905*2-21-83  5-22-83    3     2     91        92           92
 11906*3-21-83  5-19-83    1    30     60        60           59
 11907****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 226
* EL156.cbl
 11909 1405-CALC-PAYMENT.
 11910     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11911     MOVE ' '                    TO DC-OPTION-CODE.
 11912     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11913     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11914     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11915
 11916     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11917     MOVE ' '                    TO DC-OPTION-CODE.
 11918     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11919     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11920     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11921
 11922     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11923     MOVE -1                     TO DC-ELAPSED-DAYS.
 11924     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11925     MOVE '6'                    TO DC-OPTION-CODE.
 11926     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11927     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11928
 11929     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11930     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11931     MOVE '1'                    TO DC-OPTION-CODE.
 11932     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11933
 11934     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11935     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11936     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11937
 11938******************************************************************
 11939*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11940*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11941*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11942******************************************************************
 11943
 11944     IF WS-CALC-METHOD = '1'           AND
 11945        DC-ELAPSED-MONTHS > ZERO AND
 11946        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11947        WDF-DAY > WDT-DAY
 11948          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11949          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11950          MOVE -1                  TO DC-ELAPSED-MONTHS
 11951          MOVE '6'                 TO DC-OPTION-CODE
 11952          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11953          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11954          COMPUTE WS-SAVE-ODD-DAYS =
 11955          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11956          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11957
 11958     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11959     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11960     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11961
 11962     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11963     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11964
 11965*    IF PI-COMPANY-ID = 'FIA'
 11966*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 227
* EL156.cbl
 11967*        COMPUTE PI-DAILY-RATE ROUNDED =
 11968*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11969*        COMPUTE PI-CPYAMT ROUNDED =
 11970*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11971*        GO TO 1420-CHECK-AIG-BENEFIT.
 11972
 11973*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11974*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11975*          CM-AH-BENEFIT-CD = '23'               AND
 11976*          CL-CERT-STATE    = '04'               AND
 11977*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11978*            COMPUTE WS-DAILY-RATE ROUNDED =
 11979*                               CM-AH-BENEFIT-AMT / 30
 11980*            COMPUTE PI-CPYAMT ROUNDED =
 11981*                               (WS-DAILY-RATE * PI-CDAYS)
 11982*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11983*            GO TO 1420-CHECK-AIG-BENEFIT.
 11984
 11985     IF WS-CALC-METHOD = '1'
 11986         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11987         COMPUTE PI-CPYAMT ROUNDED =
 11988             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11989             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11990         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11991         GO TO 1420-CHECK-AIG-BENEFIT.
 11992
 11993     IF WS-CALC-METHOD = '2'
 11994         COMPUTE PI-DAILY-RATE ROUNDED =
 11995                          (CM-AH-BENEFIT-AMT * 12) / 365
 11996         COMPUTE PI-CPYAMT ROUNDED =
 11997             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11998             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11999         GO TO 1420-CHECK-AIG-BENEFIT.
 12000
 12001     IF WS-CALC-METHOD = '4'
 12002         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12003         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12004         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12005         COMPUTE PI-CPYAMT ROUNDED =
 12006                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12007         GO TO 1420-CHECK-AIG-BENEFIT.
 12008
 12009     IF WS-CALC-METHOD = '5'
 12010         COMPUTE PI-DAILY-RATE ROUNDED =
 12011                            (CM-AH-BENEFIT-AMT * 12) / 365
 12012         COMPUTE PI-CPYAMT ROUNDED =
 12013                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12014         GO TO 1420-CHECK-AIG-BENEFIT.
 12015
 12016     IF WS-CALC-METHOD NOT = '3'
 12017        GO TO 1410-CHECK-PAYMENT.
 12018
 12019******   CALCULATION METHOD  3  ROUTINE
 12020     COMPUTE PI-DAILY-RATE =
 12021                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12022
 12023******CHECK TO SEE IF WITHIN SAME MONTH
 12024     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 228
* EL156.cbl
 12025        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12026                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12027         GO TO 1420-CHECK-AIG-BENEFIT.
 12028
 12029******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12030     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12031             SAVE-ODD-DAYS-OVER = ZEROS
 12032      COMPUTE PI-CPYAMT  ROUNDED =
 12033                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12034      GO TO 1420-CHECK-AIG-BENEFIT.
 12035
 12036******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12037******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12038     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12039        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12040        IF WDF-MONTH > 12
 12041           ADD 1                 TO WDF-YEAR
 12042           SUBTRACT 12         FROM WDF-MONTH.
 12043
 12044******CONVERT THE NEW FROM MONTH TO BINARY
 12045     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12046        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12047        MOVE '4'              TO DC-OPTION-CODE
 12048        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12049        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12050
 12051     IF WDF-MONTH = WDT-MONTH AND
 12052        WDF-YEAR  = WDT-YEAR
 12053          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12054                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12055                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12056        ELSE
 12057          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12058          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12059          COMPUTE PI-CPYAMT ROUNDED =
 12060       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12061       +
 12062       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12063       +
 12064       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12065
 12066     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 229
* EL156.cbl
 12068 1410-CHECK-PAYMENT.
 12069******PAYMENT OPTION 6
 12070******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12071     IF SAVE-ELAPSED-MONTHS > ZERO
 12072        IF SAVE-ODD-DAYS-OVER = ZEROS
 12073           GO TO 1412-CHECK-TO-DAY
 12074        ELSE
 12075           IF WDF-DAY > WDT-DAY
 12076              IF WDF-MONTH = 02
 12077                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12078                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12079                  GO TO 1412-CHECK-TO-DAY
 12080              ELSE
 12081                  IF FROM-DAYS-IN-MONTH = 31
 12082                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12083                     GO TO 1412-CHECK-TO-DAY
 12084                  ELSE
 12085                     GO TO 1412-CHECK-TO-DAY
 12086           ELSE
 12087               GO TO 1412-CHECK-TO-DAY.
 12088
 12089     IF WDF-MONTH NOT = WDT-MONTH
 12090        IF WDF-MONTH = 02
 12091           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12092           IF WDF-DAY = 29
 12093              ADD 1              TO SAVE-ODD-DAYS-OVER
 12094           ELSE
 12095              ADD 2              TO SAVE-ODD-DAYS-OVER
 12096        ELSE
 12097           IF FROM-DAYS-IN-MONTH = 31
 12098              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12099
 12100 1412-CHECK-TO-DAY.
 12101        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12102           IF WDT-DAY = 28
 12103              ADD 2              TO SAVE-ODD-DAYS-OVER
 12104           ELSE
 12105              IF WDT-DAY = 29
 12106                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12107              ELSE
 12108                 NEXT SENTENCE
 12109        ELSE
 12110           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12111              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12112
 12113     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12114     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12115     COMPUTE PI-CPYAMT ROUNDED =
 12116         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12117         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12118
 12119     GO TO 1420-CHECK-AIG-BENEFIT.
 12120
 12121 1415-CHECK-LEAP-YEAR.
 12122     IF FROM-DAYS-IN-MONTH = 29
 12123        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12124
 12125 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 230
* EL156.cbl
 12126     EXIT.
 12127
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 231
* EL156.cbl
 12129 1420-CHECK-AIG-BENEFIT.
 12130
 12131     IF WS-SPECIAL-CALC-CD = 'Q'
 12132         GO TO 1425-CHECK-WHOLE-MONTH.
 12133
 12134*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12135*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12136*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12137*       (PI-PMTTYPE = '1' OR '2')
 12138*        NEXT SENTENCE
 12139*    ELSE
 12140         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12141         GO TO 1430-CHECK-AH-TOLERANCE.
 12142
 12143******************AIG LOGIC STARTS**********************
 12144*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12145*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12146*    MOVE ER-3533      TO EMI-ERROR.
 12147*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12148*    GO TO 1430-CHECK-AH-TOLERANCE.
 12149******************AIG LOGIC ENDS************************
 12150
 12151 1425-CHECK-WHOLE-MONTH.
 12152******************************************************************
 12153****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12154****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12155****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12156****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12157****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12158****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12159****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12160****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12161****          PAID * MONTHLY BENEFIT.                         ****
 12162******************************************************************
 12163
 12164     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12165
 12166     IF CL-NO-OF-PMTS-MADE > +0
 12167         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12168
 12169     IF PI-CDAYS < WS-BEN-DAYS
 12170         GO TO 1430-CHECK-AH-TOLERANCE.
 12171
 12172     IF PI-CDAYS = WS-BEN-DAYS
 12173         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12174         GO TO 1430-CHECK-AH-TOLERANCE.
 12175
 12176*    IF PI-COMPANY-ID = 'ACM'
 12177*       NEXT SENTENCE
 12178*    ELSE
 12179        GO TO 1425-NOT-ACM-W15C.
 12180
 12181*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12182*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12183*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12184*    MOVE '6'                    TO  DC-OPTION-CODE.
 12185*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12186*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 232
* EL156.cbl
 12187*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12188*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12189*       MOVE '1'                 TO  DC-OPTION-CODE
 12190*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12191*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12192*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12193*       IF NO-CONVERSION-ERROR
 12194*          IF (DC-ELAPSED-MONTHS > +0) OR
 12195*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12196*             NEXT SENTENCE
 12197*          ELSE
 12198*             MOVE +0            TO  PI-CPYAMT
 12199*             MOVE ER-0846       TO  EMI-ERROR
 12200*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12201*             GO TO 1430-CHECK-AH-TOLERANCE
 12202*       ELSE
 12203*           MOVE ER-0846         TO  EMI-ERROR
 12204*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12205*           GO TO 1430-CHECK-AH-TOLERANCE.
 12206*
 12207*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12208*       ADD +1 TO DC-ELAPSED-MONTHS.
 12209*
 12210*    COMPUTE PI-CPYAMT ROUNDED =
 12211*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12212*
 12213*    GO TO 1430-CHECK-AH-TOLERANCE.
 12214
 12215 1425-NOT-ACM-W15C.
 12216
 12217     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12218     MOVE '6'                        TO  DC-OPTION-CODE.
 12219     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12220     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12221
 12222     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12223     IF NO-CONVERSION-ERROR
 12224         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12225     ELSE
 12226         MOVE ER-0846                TO  EMI-ERROR
 12227         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12228         GO TO 1430-CHECK-AH-TOLERANCE.
 12229
 12230     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12231     MOVE '1'                        TO  DC-OPTION-CODE.
 12232     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12233     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12234     IF NO-CONVERSION-ERROR
 12235         IF DC-ODD-DAYS-OVER = +0
 12236             NEXT SENTENCE
 12237         ELSE
 12238             MOVE ER-0846            TO  EMI-ERROR
 12239             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12240             GO TO 1430-CHECK-AH-TOLERANCE
 12241     ELSE
 12242         MOVE ER-0846                TO  EMI-ERROR
 12243         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12244         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 233
* EL156.cbl
 12245
 12246     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12247         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12248
 12249     GO TO 1430-CHECK-AH-TOLERANCE.
 12250
 12251 1425-CONT-WHOLE-MONTH-PMTS.
 12252******************************************************************
 12253****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12254****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12255****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12256******************************************************************
 12257
 12258     IF PI-COMPANY-ID = 'ACM'
 12259        NEXT SENTENCE
 12260     ELSE
 12261        IF DC-ODD-DAYS-OVER = +0
 12262            NEXT SENTENCE
 12263        ELSE
 12264            MOVE ER-0845            TO  EMI-ERROR
 12265            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12266            GO TO 1430-CHECK-AH-TOLERANCE.
 12267
 12268     COMPUTE PI-CPYAMT ROUNDED =
 12269                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12270
 12271 1430-CHECK-AH-TOLERANCE.
 12272     IF PI-PMT-APPR-SW = 'G'
 12273         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12274
 12275*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12276*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12277*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12278*
 12279*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12280*      IF WDF-MONTH = 02
 12281*        IF SAVE-ELAPSED-MONTHS = 0
 12282*          NEXT SENTENCE
 12283*        ELSE
 12284*          IF SAVE-ODD-DAYS-OVER > 0
 12285*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12286*            COMPUTE WS-PMT-MOS ROUNDED =
 12287*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12288*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12289*                                     WS-PMT-MOS
 12290*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12291*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12292*          ELSE
 12293*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12294*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12295*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12296*                                     WS-PMT-MOS.
 12297
 12298     IF WS-MAX-PMT-TOL NOT = ZERO
 12299        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12300           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12301            MOVE ER-0494         TO  EMI-ERROR
 12302            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 234
* EL156.cbl
 12303            GO TO 1500-EDIT-EXPENSES.
 12304
 12305 1430-CONT-CHECK-AH-TOLERANCE.
 12306
 12307     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12308        GO TO 1500-EDIT-EXPENSES.
 12309
 12310     IF CM-O-B-COVERAGE
 12311        GO TO 1500-EDIT-EXPENSES.
 12312
 12313     IF PI-COMPANY-ID = 'NCL'
 12314       IF FOUND-TOL-SW = 'Y'
 12315         IF WS-PMT-TOL NOT = ZERO
 12316           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12317              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12318                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12319                  IF WS-NCL-PMT-OPTION = SPACES
 12320                      MOVE ER-0699 TO EMI-ERROR
 12321                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12322                  ELSE
 12323                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12324                      NEXT SENTENCE
 12325                  ELSE
 12326                  IF NOT WS-VALID-NCL-OPTION
 12327                      MOVE ER-0699 TO EMI-ERROR
 12328                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12329
 12330     IF WS-PMT-TOL NOT = ZERO
 12331        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12332           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12333           MOVE ER-0495          TO EMI-ERROR
 12334           PERFORM 1490-PAYMENT-ERROR
 12335                                 THRU 1490-EXIT
 12336        end-if
 12337     end-if
 12338
 12339     GO TO 1500-EDIT-EXPENSES.
 12340
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 235
* EL156.cbl
 12342 1440-COMPUTE-LIFE-REMAINING.
 12343
 12344     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12345        IF PI-PMTTYPE = '4'
 12346          MOVE PI-EPYAMT TO PI-CPYAMT
 12347          GO TO 1460-TEST-TYPE.
 12348
 12349     IF WS-LF-COVERAGE-TYPE = 'L'
 12350        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12351                          - CL-TOTAL-PAID-AMT
 12352        GO TO 1450-CHECK-MAX.
 12353
 12354     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12355        PI-LF-COVERAGE-TYPE = 'P'
 12356          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12357                              CM-LF-ITD-DEATH-AMT
 12358          GO TO 1450-CHECK-MAX.
 12359
 12360     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12361     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12362     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12363     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12364     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12365     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12366     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12367     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12368     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12369
 12370     PERFORM 9800-LINK-REM-TERM.
 12371
 12372     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12373     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12374     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12375     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12376     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12377     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12378     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12379     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12380     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12381     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12382     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12383     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12384     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12385     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12386     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12387     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12388     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12389        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12390        MOVE PI-CARRIER          TO ACCT-CARRIER
 12391        MOVE PI-GROUPING         TO ACCT-GROUPING
 12392        MOVE PI-STATE            TO ACCT-STATE
 12393        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12394        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12395        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12396        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12397
 12398
 12399* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 236
* EL156.cbl
 12400*          DATASET ('ERACCT')
 12401*          RIDFLD  (ERACCT-KEY)
 12402*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12403*          GTEQ
 12404*          resp    (WS-RESPONSE)
 12405*       END-EXEC
 12406     MOVE 'ERACCT' TO DFHEIV1
 12407*    MOVE '&"S        G          (  N#00011844' TO DFHEIV0
 12408     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12410     MOVE X'204E233030303131383434' TO DFHEIV0(25:11)
 12411     CALL 'kxdfhei1' USING DFHEIV0,
 12412           DFHEIV1,
 12413           DFHEIV20,
 12414           DFHEIV99,
 12415           ERACCT-KEY,
 12416           DFHEIV99,
 12417           DFHEIV99,
 12418           DFHEIV99
 12419     SET ADDRESS OF ACCOUNT-MASTER TO
 12420         DFHEIV20
 12421     MOVE EIBRESP  TO WS-RESPONSE
 12422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12423        IF WS-RESP-NORMAL
 12424           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12425           and (pi-cert-eff-dt < am-expiration-dt)
 12426           and (pi-cert-eff-dt >= am-effective-dt)
 12427           move am-dcc-product-code to pi-dcc-product-code
 12428        else
 12429           move spaces           to pi-dcc-product-code
 12430        end-if
 12431        if pi-dcc-product-code not = spaces
 12432           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12433           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12434           PERFORM 0900-GET-DDF-limits
 12435                                 THRU 0900-EXIT
 12436           IF PDEF-FOUND
 12437              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12438                 (P1 > +8)
 12439                 OR (PD-PROD-CODE (P1) = 'L')
 12440              END-PERFORM
 12441              IF P1 < +9
 12442                 MOVE PD-MAX-AMT (P1)
 12443                                 TO CP-R-MAX-TOT-BEN
 12444              else
 12445                 move er-1674    to emi-error
 12446                 PERFORM 9900-ERROR-FORMAT
 12447                                 THRU 9900-EXIT
 12448              END-IF
 12449           else
 12450              move er-1672       to emi-error
 12451              PERFORM 9900-ERROR-FORMAT
 12452                                 THRU 9900-EXIT
 12453           END-IF
 12454        end-if
 12455     END-IF
 12456
 12457* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 237
* EL156.cbl
 12458*       PROGRAM  (LINK-REMAMT)
 12459*       COMMAREA (CALCULATION-PASS-AREA)
 12460*       LENGTH   (CP-COMM-LENGTH)
 12461*    END-EXEC.
 12462*    MOVE '."C                   (   #00011884' TO DFHEIV0
 12463     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12465     MOVE X'2020233030303131383834' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0,
 12467           LINK-REMAMT,
 12468           CALCULATION-PASS-AREA,
 12469           CP-COMM-LENGTH,
 12470           DFHEIV99,
 12471           DFHEIV99,
 12472           DFHEIV99,
 12473           DFHEIV99
 12474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12475
 12476
 12477     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12478
 12479     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12480     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12481
 12482     IF PI-COMPANY-ID = 'BOA' AND
 12483        PI-PMTTYPE    = '2'   AND
 12484        PI-OFFLINE    = 'N'
 12485           GO TO 1441-COMPUTE-BOA-INTEREST.
 12486
 12487     IF PI-COMPANY-ID = 'NCL' AND
 12488        PI-PMTTYPE    = '2'   AND
 12489        PI-OFFLINE    = 'N'
 12490          GO TO 1442-COMPUTE-NCL-INTEREST
 12491       ELSE
 12492          GO TO 1445-CONTINUE.
 12493
 12494 1441-COMPUTE-BOA-INTEREST.
 12495     MOVE +0             TO WS-CALC-INT.
 12496
 12497     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12498     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12499     MOVE +0             TO DC-ELAPSED-MONTHS
 12500                            DC-ELAPSED-DAYS.
 12501     MOVE '1'            TO DC-OPTION-CODE.
 12502     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12503     IF NO-CONVERSION-ERROR
 12504         NEXT SENTENCE
 12505     ELSE
 12506         GO TO 1445-CONTINUE.
 12507
 12508     IF (PI-INT-RATE NOT > ZEROS)  AND
 12509        (DC-ELAPSED-DAYS > +30)
 12510         MOVE ER-3531            TO EMI-ERROR
 12511         MOVE -1                 TO PINTL
 12512         MOVE AL-UNBON           TO PINTA
 12513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12514
 12515     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 238
* EL156.cbl
 12516         GO TO 1445-CONTINUE.
 12517
 12518     IF (PI-INT-RATE NOT > ZEROS)  OR
 12519        (DC-ELAPSED-DAYS NOT > +30)
 12520         MOVE PI-EPYAMT TO PI-CPYAMT
 12521         GO TO 1441-FORMAT-NOTE.
 12522
 12523     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12524                                 *  PI-INT-RATE
 12525                                 *  DC-ELAPSED-DAYS
 12526                                 /  365
 12527                                 /  100.
 12528
 12529     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12530
 12531 1441-FORMAT-NOTE.
 12532
 12533     MOVE SPACES        TO WS-BOANOTE1.
 12534     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12535     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12536     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12537     MOVE AL-UANON      TO NOTE1A.
 12538
 12539     IF WS-CALC-INT > ZEROS
 12540         MOVE SPACES        TO WS-BOANOTE2
 12541         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12542         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12543         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12544         MOVE AL-UANON      TO NOTE2A.
 12545
 12546     GO TO 1445-CONTINUE.
 12547
 12548 1442-COMPUTE-NCL-INTEREST.
 12549     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12550     MOVE PI-STATE               TO WS-ST-ACCESS.
 12551     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12552     MOVE '3'                    TO CNTL-REC-TYPE.
 12553     MOVE +0                     TO CNTL-SEQ-NO.
 12554     MOVE 'STAT'                 TO FILE-SWITCH.
 12555
 12556     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12557
 12558     MOVE +0                 TO WS-CALC-INT.
 12559
 12560     IF ST-STAT-FROM-INCURRED
 12561         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12562       ELSE
 12563     IF ST-STAT-FROM-REPORTED
 12564         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12565       ELSE
 12566         GO TO 1445-CONTINUE.
 12567
 12568     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12569     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12570     MOVE +0                 TO DC-ELAPSED-MONTHS
 12571                                DC-ELAPSED-DAYS.
 12572     MOVE '1'                TO DC-OPTION-CODE.
 12573     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 239
* EL156.cbl
 12574     IF NO-CONVERSION-ERROR
 12575         NEXT SENTENCE
 12576     ELSE
 12577         GO TO 1445-CONTINUE.
 12578
 12579     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12580        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12581         GO TO 1445-CONTINUE.
 12582
 12583     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12584                                 *  CF-ST-STAT-INTEREST.
 12585
 12586     MOVE SPACES              TO WS-NCLNOTE1.
 12587     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12588     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12589     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12590                                 PI-PMTNOTE1
 12591                                 NOTE1I.
 12592     MOVE AL-UANON            TO NOTE1A.
 12593
 12594     IF WS-CALC-INT > ZEROS
 12595         MOVE SPACES          TO WS-NCLNOTE2
 12596         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12597         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12598         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12599                                 PI-PMTNOTE2
 12600                                 NOTE2I
 12601         MOVE AL-UANON        TO NOTE2A.
 12602
 12603     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12604
 12605 1445-CONTINUE.
 12606
 12607     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12608        GO TO 1460-TEST-TYPE.
 12609
 12610     IF CM-O-B-COVERAGE
 12611        GO TO 1460-TEST-TYPE.
 12612
 12613     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12614         GO TO 1450-CHECK-MAX.
 12615
 12616     if (pi-company-id = 'DCC' or 'CAP')
 12617        and (pdef-found)
 12618        if pi-epyamt > pd-max-amt (p1)
 12619           move er-1657          to emi-error
 12620           perform 1490-payment-error
 12621                                 thru 1490-exit
 12622           go to 1460-test-type
 12623        end-if
 12624     else
 12625        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12626           > PI-EPYAMT)
 12627                         OR
 12628           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12629           < PI-EPYAMT)
 12630           MOVE ER-0594          TO EMI-ERROR
 12631           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 240
* EL156.cbl
 12632                                 THRU 1490-EXIT
 12633           GO TO 1460-TEST-TYPE
 12634        end-if
 12635     end-if
 12636     .
 12637 1450-CHECK-MAX.
 12638
 12639     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12640        PI-LF-COVERAGE-TYPE = 'P'
 12641         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12642                                   CM-LF-ITD-DEATH-AMT
 12643     ELSE
 12644         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12645                                   CL-TOTAL-PAID-AMT.
 12646
 12647     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12648          MOVE ER-0543           TO EMI-ERROR
 12649          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12650
 12651 1460-TEST-TYPE.
 12652
 12653     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12654        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12655           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12656                                   CM-LF-ALT-BENEFIT-AMT -
 12657                                   CL-TOTAL-PAID-AMT
 12658           IF PI-EPYAMT > WS-LF-BEN-AMT
 12659               MOVE ER-0543      TO EMI-ERROR
 12660               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12661           END-IF
 12662        END-IF
 12663     END-IF
 12664
 12665     IF PI-PMT-APPR-SW = 'G'
 12666       NEXT SENTENCE
 12667     ELSE
 12668       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12669         IF PI-EPYAMT = ZERO
 12670             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12671                 MOVE ER-0494    TO  EMI-ERROR
 12672                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12673                 GO TO 1500-EDIT-EXPENSES
 12674             ELSE
 12675                 NEXT SENTENCE
 12676         ELSE
 12677             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12678                 MOVE ER-0494    TO  EMI-ERROR
 12679                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12680                 GO TO 1500-EDIT-EXPENSES.
 12681
 12682     IF PI-PMTTYPE NOT = '2' OR
 12683        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12684         GO TO 1500-EDIT-EXPENSES.
 12685
 12686     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12687     MOVE ER-0526                TO EMI-ERROR.
 12688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12689
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 241
* EL156.cbl
 12690     IF EMI-ERROR-NUMBER (1) = '0526'
 12691        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12692
 12693     IF EMI-ERROR-NUMBER (2) = '0526'
 12694        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12695
 12696     GO TO 1500-EDIT-EXPENSES.
 12697
 12698 1490-PAYMENT-ERROR.
 12699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12700
 12701     IF EMI-MESSAGE-FORMATTED
 12702         MOVE -1                 TO EPYAMTL
 12703         MOVE AL-UNBON           TO EPYAMTA.
 12704
 12705 1490-EXIT.
 12706      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 242
* EL156.cbl
 12708 1500-EDIT-EXPENSES.
 12709     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12710         GO TO 1500-SKIP-ERROR-0556.
 12711
 12712 1500-CONTINUE-ON.
 12713
 12714     IF CM-O-B-COVERAGE
 12715        MOVE ER-0556             TO EMI-ERROR
 12716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12717
 12718 1500-SKIP-ERROR-0556.
 12719     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12720        IF PI-EEXPENS NOT = ZEROS
 12721           MOVE ER-0524          TO EMI-ERROR
 12722           GO TO 1590-EXPENSE-ERROR
 12723        ELSE
 12724           GO TO 1600-EDIT-RESERVES.
 12725
 12726     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12727     MOVE '6'                    TO CNTL-REC-TYPE.
 12728
 12729     IF CONTROL-IS-ACTUAL-CARRIER
 12730         MOVE PI-CARRIER         TO WS-CARR
 12731     ELSE
 12732         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12733
 12734     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12735     MOVE +0                     TO CNTL-SEQ-NO.
 12736     MOVE 'CARR'                 TO FILE-SWITCH.
 12737
 12738     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12739
 12740     IF EXPENSE-CALC-MANUAL
 12741        GO TO 1600-EDIT-RESERVES.
 12742
 12743     IF DOLLARS-PER-PMT
 12744        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12745        GO TO 1600-EDIT-RESERVES.
 12746
 12747     IF DOLLARS-PER-MONTH AND
 12748        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12749       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12750       GO TO 1600-EDIT-RESERVES.
 12751
 12752     IF PERCENT-OF-PAYMENT
 12753        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12754
 12755     GO TO 1600-EDIT-RESERVES.
 12756
 12757 1590-EXPENSE-ERROR.
 12758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12759
 12760     IF EMI-MESSAGE-FORMATTED
 12761        MOVE -1                  TO EEXPENSL
 12762        MOVE AL-UNBON            TO EEXPENSA.
 12763
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 243
* EL156.cbl
 12765 1600-EDIT-RESERVES.
 12766     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12767        IF PI-ERESV = ZEROS
 12768           GO TO 1700-EDIT-EXPENSE-TYPE
 12769        ELSE
 12770           MOVE ER-0525          TO EMI-ERROR
 12771           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12772           GO TO 1700-EDIT-EXPENSE-TYPE.
 12773
 12774     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12775     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12776     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12777
 12778     IF NOT AT-MANUAL-RESERVES-USED
 12779        IF PI-ERESV NOT = ZEROS
 12780           MOVE ER-0518          TO EMI-ERROR
 12781           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12782
 12783     IF AT-MANUAL-RESERVES-USED
 12784        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12785        GO TO 1700-EDIT-EXPENSE-TYPE.
 12786
 12787     IF AT-FUTURE-RESERVES-USED
 12788        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12789
 12790     IF AT-FUTURE-RESERVES-USED
 12791        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12792
 12793     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12794        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12795
 12796     IF AT-IBNR-RESERVES-USED
 12797        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12798
 12799     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12800     GO TO 1700-EDIT-EXPENSE-TYPE.
 12801
 12802 1690-RESERVE-ERROR.
 12803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805     IF EMI-MESSAGE-FORMATTED
 12806        MOVE AL-UNBON            TO ERESVA
 12807        MOVE -1                  TO ERESVL.
 12808
 12809 1690-EXIT.
 12810      EXIT.
 12811
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 244
* EL156.cbl
 12813 1700-EDIT-EXPENSE-TYPE.
 12814     IF PI-PMTTYPE NOT = '5' AND '6'
 12815        GO TO 2000-EDIT-DONE.
 12816
 12817     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12818                   '6' OR '7' OR '8' OR '9'
 12819        GO TO 2000-EDIT-DONE.
 12820
 12821 1705-EXPENSE-ERROR.
 12822     MOVE ER-0573                TO EMI-ERROR.
 12823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12824
 12825     IF EMI-MESSAGE-FORMATTED
 12826        MOVE AL-UABON            TO ETYPEA
 12827        MOVE -1                  TO ETYPEL.
 12828
 12829     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 245
* EL156.cbl
 12831 1950-NOT-FOUND.
 12832     IF FILE-SWITCH = 'MSTR'
 12833        MOVE ER-0204             TO EMI-ERROR.
 12834
 12835     IF FILE-SWITCH = 'CARR'
 12836        MOVE ER-0252             TO EMI-ERROR.
 12837
 12838     IF FILE-SWITCH = 'COMP'
 12839        MOVE ER-0254             TO EMI-ERROR.
 12840
 12841     IF FILE-SWITCH = 'STAT'
 12842        MOVE ER-0149             TO EMI-ERROR.
 12843
 12844     IF FILE-SWITCH = 'PROC'
 12845        MOVE ER-0019             TO EMI-ERROR.
 12846
 12847     IF FILE-SWITCH = 'ACCT'
 12848        MOVE ER-0198             TO EMI-ERROR.
 12849
 12850     IF FILE-SWITCH = 'BENE'
 12851        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12852           MOVE ER-0282          TO EMI-ERROR
 12853        ELSE
 12854           MOVE ER-0283          TO EMI-ERROR.
 12855
 12856     MOVE -1                     TO PMTTYPEL.
 12857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12858
 12859     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12860                                     WS-FORCE-CTR.
 12861
 12862     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12863                                     WS-FATAL-CTR.
 12864
 12865     GO TO 8200-SEND-DATAONLY.
 12866
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 246
* EL156.cbl
 12868 2000-EDIT-DONE.
 12869     perform 2210-dcc-max-benes thru 2210-exit
 12870     if pi-company-id not = 'DCC' and 'CAP'
 12871        IF (WS-SPECIAL-CALC-CD = 'C')
 12872           and (cl-critical-period > 0)
 12873           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12874              IF PI-EPYAMT > ZEROS
 12875                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12876                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12877              ELSE
 12878                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12879                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12880              END-IF
 12881              if ws-benefits-paid > cl-critical-period
 12882                 MOVE ER-0657          TO EMI-ERROR
 12883                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12884              END-IF
 12885           END-IF
 12886        END-IF
 12887     end-if
 12888     IF PI-HOLDTIL NOT = ZEROS
 12889        MOVE PI-HOLDTIL          TO HOLDTILO
 12890        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12891
 12892     IF PI-EPYFROM NOT = ZEROS
 12893        MOVE PI-EPYFROM          TO EPYFROMO
 12894        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12895
 12896     IF PI-EPYTHRU NOT = ZEROS
 12897        MOVE PI-EPYTHRU            TO EPYTHRUO
 12898        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12899        IF PI-USES-PAID-TO
 12900           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12901           MOVE '4'                TO DC-OPTION-CODE
 12902           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12903           IF NO-CONVERSION-ERROR
 12904              MOVE +1              TO DC-ELAPSED-DAYS
 12905              MOVE +0              TO DC-ELAPSED-MONTHS
 12906              MOVE '6'             TO DC-OPTION-CODE
 12907              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12908              IF NO-CONVERSION-ERROR
 12909                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12910
 12911     MOVE PI-EDAYS               TO EDAYSO.
 12912
 12913     IF PI-AIGFROM NOT = ZEROS
 12914        MOVE PI-AIGFROM          TO AIGFROMO
 12915        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12916
 12917     MOVE PI-EPYAMT              TO EPYAMTO.
 12918     MOVE PI-ERESV               TO ERESVO.
 12919     MOVE PI-EEXPENS             TO EEXPENSO.
 12920
 12921     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12922     MOVE SPACES                 TO DC-OPTION-CODE.
 12923     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12924
 12925     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 247
* EL156.cbl
 12926        MOVE SPACES              TO CPYFROMI
 12927     ELSE
 12928        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12929        IF PI-EPYFROM = ZEROS
 12930           MOVE AL-UANON             TO EPYFROMA
 12931           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12932           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12933
 12934     IF PI-USES-PAID-TO
 12935        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12936        MOVE +1                            TO DC-ELAPSED-DAYS
 12937        MOVE +0                            TO DC-ELAPSED-MONTHS
 12938        MOVE '6'                           TO DC-OPTION-CODE
 12939        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12940        IF NO-CONVERSION-ERROR
 12941           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12942           IF PI-EPYTHRU = ZEROS
 12943              MOVE AL-UANON                TO EPYTHRUA
 12944              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12945              MOVE ' '                     TO DC-OPTION-CODE
 12946              MOVE +0                      TO DC-ELAPSED-DAYS
 12947                                              DC-ELAPSED-MONTHS
 12948              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12949              IF NO-CONVERSION-ERROR
 12950                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12951                  GO TO 2001-CONTINUE
 12952              ELSE
 12953                  GO TO 2001-CONTINUE
 12954           ELSE
 12955              GO TO 2001-CONTINUE.
 12956
 12957     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12958     MOVE SPACES                 TO DC-OPTION-CODE.
 12959     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12960
 12961     IF DATE-CONVERSION-ERROR
 12962        MOVE SPACES              TO CPYTHRUI
 12963     ELSE
 12964        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12965        IF PI-EPYTHRU = ZEROS
 12966           MOVE AL-UANON TO EPYTHRUA
 12967           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12968           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12969
 12970 2001-CONTINUE.
 12971
 12972     MOVE PI-CDAYS               TO CDAYSO.
 12973
 12974     IF PI-EDAYS = ZEROS
 12975        MOVE AL-UNNON TO EDAYSA
 12976        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12977
 12978     MOVE PI-CPYAMT              TO CPYAMTO.
 12979
 12980     IF PI-EPYAMT = ZEROS
 12981        MOVE AL-UNNON            TO EPYAMTA
 12982        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12983
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 248
* EL156.cbl
 12984     MOVE PI-CRESV               TO CRESVO.
 12985     MOVE PI-CEXPENS             TO CEXPENSO.
 12986
 12987     IF PI-EEXPENS = ZEROS
 12988        MOVE AL-UNNON TO EEXPENSA
 12989        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12990
 12991     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12992        AND (CL-CLAIM-TYPE = 'L')
 12993        AND (PI-OFFLINE NOT EQUAL 'Y')
 12994        IF PI-PMTTYPE = '2' OR '4'
 12995           PERFORM 2200-CALC-INTEREST
 12996                                 THRU 2200-EXIT
 12997        END-IF
 12998     END-IF
 12999     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13000     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13001     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13002
 13003     IF EMI-FATAL-CTR = ZEROS
 13004        MOVE 'B'                 TO PI-PASS-SW.
 13005
 13006     IF NOT EMI-MESSAGE-FORMATTED
 13007         MOVE -1                 TO EPYFROML
 13008     ELSE
 13009         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13010            EMI-ERROR-NUMBER (2) = SPACES
 13011             MOVE -1             TO EPYFROML.
 13012
 13013     GO TO 8200-SEND-DATAONLY.
 13014
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 249
* EL156.cbl
 13016 2200-CALC-INTEREST.
 13017     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13018        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13019        MOVE '4'                 TO DC-OPTION-CODE
 13020        PERFORM 9700-LINK-DATE-CONVERT
 13021        IF DATE-CONVERSION-ERROR
 13022            MOVE LOW-VALUES      TO CP-PRF-DT
 13023        ELSE
 13024           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13025        END-IF
 13026     END-IF
 13027     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13028        if pi-rb-joint-coverage
 13029           move 'Y'              to pi-int-to-rem-borr
 13030        end-if
 13031     end-if
 13032     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13033        IN CLAIM-INT-PASS-AREA
 13034     MOVE CL-CERT-STATE          TO CP-STATE
 13035        IN CLAIM-INT-PASS-AREA
 13036     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13037     MOVE 'LF'                   TO CP-COVERAGE
 13038     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13039     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13040     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13041     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13042     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13043     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13044
 13045* EXEC CICS LINK
 13046*       PROGRAM   ('ELCLMI')
 13047*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13048*       LENGTH    (CP-CLAIM-LENGTH)
 13049*    END-EXEC
 13050     MOVE 'ELCLMI' TO DFHEIV1
 13051*    MOVE '."C                   (   #00012457' TO DFHEIV0
 13052     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303132343537' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           DFHEIV1,
 13057           CLAIM-INT-PASS-AREA,
 13058           CP-CLAIM-LENGTH,
 13059           DFHEIV99,
 13060           DFHEIV99,
 13061           DFHEIV99,
 13062           DFHEIV99
 13063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13064     MOVE AL-PANOF               TO PINTHA
 13065                                    PINTA
 13066     if cp-clm-int-amt = zeros
 13067        move ' ' to pi-int-to-rem-borr
 13068     end-if
 13069     IF NO-CI-ERROR
 13070        MOVE CP-CLM-INT-AMT      TO PINTO
 13071                                    PI-INT-AMT
 13072        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13073        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 250
* EL156.cbl
 13074        MOVE AL-PANOF            TO PINTHA
 13075                                    PINTA
 13076        if pi-rb-joint-coverage
 13077           and pi-int-amt > zeros
 13078           move '  INT TO'       to itrb1o
 13079           move ' REM BORR?'     to itrb2o
 13080           move pi-int-to-rem-borr
 13081                                 to itrbyno
 13082           move al-uanon         to itrbyna
 13083           move +1               to itrbynl
 13084        else
 13085           move ' '              to pi-int-to-rem-borr
 13086        end-if
 13087     ELSE
 13088        IF CI-RETURN-CODE = '8'
 13089           MOVE ER-3818          TO EMI-ERROR
 13090           MOVE -1               TO ZINTL
 13091           PERFORM 9900-ERROR-FORMAT
 13092                                 THRU 9900-EXIT
 13093           GO TO 2200-EXIT
 13094        ELSE
 13095           MOVE ZEROS            TO PINTO
 13096                                    PI-INT-AMT
 13097                                    PI-INT-DAYS
 13098                                    PI-INT-RATE-USED
 13099        END-IF
 13100     END-IF
 13101     IF PI-INT-AMT NOT = ZEROS
 13102        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13103           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13104           CONTINUE
 13105        ELSE
 13106           MOVE CL-SOC-SEC-NO (1:3)
 13107                                 TO WS-SSN (1:3)
 13108           MOVE CL-SOC-SEC-NO (5:2)
 13109                                 TO WS-SSN (4:2)
 13110           MOVE CL-SOC-SEC-NO (8:4)
 13111                                 TO WS-SSN (6:4)
 13112           IF (WS-SSN NUMERIC)
 13113              AND (WS-SSN NOT = ZEROS)
 13114              CONTINUE
 13115           ELSE
 13116              MOVE ER-2044       TO EMI-ERROR
 13117              PERFORM 9900-ERROR-FORMAT
 13118                                 THRU 9900-EXIT
 13119           END-IF
 13120        END-IF
 13121        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13122        if pi-int-to-rem-borr = 'Y'
 13123           move +61              to trlr-seq-no
 13124        else
 13125           MOVE +51              TO TRLR-SEQ-NO
 13126        end-if
 13127
 13128* EXEC CICS READ
 13129*          DATASET  ('ELTRLR')
 13130*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13131*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 251
* EL156.cbl
 13132*          RESP     (WS-RESPONSE)
 13133*       END-EXEC
 13134     MOVE 'ELTRLR' TO DFHEIV1
 13135*    MOVE '&"S        E          (  N#00012525' TO DFHEIV0
 13136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13138     MOVE X'204E233030303132353235' TO DFHEIV0(25:11)
 13139     CALL 'kxdfhei1' USING DFHEIV0,
 13140           DFHEIV1,
 13141           DFHEIV20,
 13142           DFHEIV99,
 13143           ELTRLR-KEY,
 13144           DFHEIV99,
 13145           DFHEIV99,
 13146           DFHEIV99
 13147     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13148         DFHEIV20
 13149     MOVE EIBRESP  TO WS-RESPONSE
 13150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13151        IF (NOT WS-RESP-NORMAL)
 13152                    OR
 13153           ((WS-RESP-NORMAL)
 13154           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13155           OR (AT-CITY-STATE = SPACES)))
 13156           MOVE ER-0874          TO EMI-ERROR
 13157           if pi-rb-joint-coverage
 13158              move -1            to itrbynl
 13159           end-if
 13160           PERFORM 9900-ERROR-FORMAT
 13161                                 THRU 9900-EXIT
 13162        else
 13163           move at-mail-to-name  to pi-int-payees-name
 13164        END-IF
 13165     END-IF
 13166     .
 13167 2200-EXIT.
 13168     EXIT.
 13169 2210-dcc-max-benes.
 13170
 13171     move pi-ah-term             to ws-max-bens
 13172     if cl-critical-period not = zeros and spaces
 13173        move cl-critical-period  to ws-max-bens
 13174     end-if
 13175     move cm-ah-benefit-amt      to ws-monthly-benefit
 13176     if pdef-found
 13177        and (pd-max-amt (p1) not = zeros)
 13178        if pd-ben-pct (p1) not numeric
 13179           move zeros            to pd-ben-pct (p1)
 13180        end-if
 13181        if pd-ben-pct (p1) = zeros
 13182           move +1               to ws-work-ben-pct
 13183        else
 13184           move pd-ben-pct (p1)  to ws-work-ben-pct
 13185        end-if
 13186*       compute ws-monthly-benefit =
 13187*          ws-monthly-benefit * ws-work-ben-pct
 13188*       if ws-monthly-benefit > pd-max-amt (p1)
 13189*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 252
* EL156.cbl
 13190*       end-if
 13191     end-if
 13192
 13193     move cl-cert-key-data       to elcrtt-key (2:21)
 13194     move cl-company-cd          to ctrlr-comp-cd
 13195     move cl-cert-no             to ctrlr-cert-no
 13196     move 'B'                    to ctrlr-rec-type
 13197
 13198
 13199* EXEC CICS READ
 13200*       DATASET  ('ELCRTT')
 13201*       set      (address of CERTIFICATE-TRAILERS)
 13202*       RIDFLD   (ELCRTT-KEY)
 13203*       RESP     (WS-RESPONSE)
 13204*    END-EXEC
 13205     MOVE 'ELCRTT' TO DFHEIV1
 13206*    MOVE '&"S        E          (  N#00012578' TO DFHEIV0
 13207     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13208     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13209     MOVE X'204E233030303132353738' TO DFHEIV0(25:11)
 13210     CALL 'kxdfhei1' USING DFHEIV0,
 13211           DFHEIV1,
 13212           DFHEIV20,
 13213           DFHEIV99,
 13214           ELCRTT-KEY,
 13215           DFHEIV99,
 13216           DFHEIV99,
 13217           DFHEIV99
 13218     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13219         DFHEIV20
 13220     MOVE EIBRESP  TO WS-RESPONSE
 13221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13222     IF not WS-RESP-NORMAL
 13223        go to 2210-exit
 13224     end-if
 13225
 13226*    if instypei = 'P'
 13227*       move +1 to s1
 13228*    else
 13229*       MOVE +2 to s1
 13230*    end-if
 13231
 13232*    move +1 to s1
 13233*    evaluate cl-claim-type
 13234*       when 'A'
 13235*          move +1 to s2
 13236*       when 'I'
 13237*          move +2 to s2
 13238*       when 'G'
 13239*          move +3 to s2
 13240*       when 'L'
 13241*          move +4 to s2
 13242*       when 'P'
 13243*          move +5 to s2
 13244*    end-evaluate
 13245
 13246     move zeros                  to ws-prev-days-paid
 13247                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 253
* EL156.cbl
 13248                                    ws-prev-amt-paid
 13249     perform varying s1 from +1 by +1 until
 13250        (s1 > +24)
 13251        or (cs-claim-type (s1) = spaces)
 13252        if pi-company-id not = 'DCC' and 'CAP'
 13253           if cs-claim-type (s1) = cl-claim-type
 13254              compute ws-prev-days-paid =
 13255                 ws-prev-days-paid + cs-days-paid (s1)
 13256              compute ws-prev-amt-paid =
 13257                 ws-prev-amt-paid + cs-total-paid (s1)
 13258           end-if
 13259        else
 13260           if (cs-claim-type (s1) = cl-claim-type)
 13261              and (cs-benefit-period (s1) = cl-benefit-period)
 13262              and (cs-insured-type (s1) = cl-insured-type)
 13263              compute ws-prev-days-paid =
 13264                 ws-prev-days-paid + cs-days-paid (s1)
 13265              compute ws-prev-amt-paid =
 13266                 ws-prev-amt-paid + cs-total-paid (s1)
 13267           end-if
 13268        end-if
 13269     end-perform
 13270     if pi-epyamt > zeros
 13271        compute ws-benefits-paid =
 13272           (ws-prev-amt-paid + pi-epyamt)
 13273           / ws-monthly-benefit
 13274     else
 13275        compute ws-benefits-paid =
 13276           (ws-prev-amt-paid + pi-cpyamt)
 13277           / ws-monthly-benefit
 13278     end-if
 13279*    if pi-company-id = 'DCC'
 13280     if cl-claim-type not = 'L' and 'P'
 13281        if ws-benefits-paid > ws-max-bens
 13282           move er-1658          to emi-error
 13283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13284        end-if
 13285     end-if
 13286*    end-if
 13287*     if s1 < +25
 13288*        if pi-epyamt > zeros
 13289*           compute ws-benefits-paid =
 13290*              (cs-total-paid (s1) + PI-EPYAMT)
 13291*              / ws-monthly-benefit
 13292*        else
 13293*           compute ws-benefits-paid =
 13294*              (cs-total-paid (s1) + PI-CPYAMT)
 13295*              / ws-monthly-benefit
 13296*        end-if
 13297
 13298*       if ws-benefits-paid > pd-crit-period (p1)
 13299*        if ws-benefits-paid > ws-max-bens
 13300*           move er-1658          to emi-error
 13301*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13302*        end-if
 13303*     end-if
 13304     .
 13305 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 254
* EL156.cbl
 13306     exit.
 13307
 13308 2220-update-elcrtt.
 13309
 13310
 13311* EXEC CICS GETMAIN
 13312*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13313*       LENGTH   (ELCRTT-LENGTH)
 13314*       INITIMG  (GETMAIN-SPACE)
 13315*    END-EXEC
 13316*    MOVE ',"IL                  $   #00012672' TO DFHEIV0
 13317     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13318     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13319     MOVE X'2020233030303132363732' TO DFHEIV0(25:11)
 13320     CALL 'kxdfhei1' USING DFHEIV0,
 13321           DFHEIV20,
 13322           ELCRTT-LENGTH,
 13323           GETMAIN-SPACE
 13324     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13325         DFHEIV20
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13327
 13328     move cl-cert-key-data       to elcrtt-key (2:21)
 13329     move cl-company-cd          to ctrlr-comp-cd
 13330     move cl-cert-no             to ctrlr-cert-no
 13331     move 'B'                    to ctrlr-rec-type
 13332
 13333
 13334* EXEC CICS READ
 13335*       UPDATE
 13336*       DATASET  (ELCRTT-DSID)
 13337*       into     (CERTIFICATE-TRAILERS)
 13338*       RIDFLD   (ELCRTT-KEY)
 13339*       RESP     (WS-RESPONSE)
 13340*    END-EXEC
 13341     MOVE LENGTH OF
 13342      CERTIFICATE-TRAILERS
 13343       TO DFHEIV11
 13344*    MOVE '&"IL       EU         (  N#00012683' TO DFHEIV0
 13345     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13346     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13347     MOVE X'204E233030303132363833' TO DFHEIV0(25:11)
 13348     CALL 'kxdfhei1' USING DFHEIV0,
 13349           ELCRTT-DSID,
 13350           CERTIFICATE-TRAILERS,
 13351           DFHEIV11,
 13352           ELCRTT-KEY,
 13353           DFHEIV99,
 13354           DFHEIV99,
 13355           DFHEIV99
 13356     MOVE EIBRESP  TO WS-RESPONSE
 13357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13358
 13359     IF WS-RESP-NORMAL
 13360        perform 2225-upd-crt-trlr thru 2225-exit
 13361
 13362* EXEC CICS REWRITE
 13363*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 255
* EL156.cbl
 13364*          from     (CERTIFICATE-TRAILERS)
 13365*          RESP     (WS-RESPONSE)
 13366*       END-EXEC
 13367     MOVE LENGTH OF
 13368      CERTIFICATE-TRAILERS
 13369       TO DFHEIV11
 13370*    MOVE '&& L                  %  N#00012693' TO DFHEIV0
 13371     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13373     MOVE X'204E233030303132363933' TO DFHEIV0(25:11)
 13374     CALL 'kxdfhei1' USING DFHEIV0,
 13375           ELCRTT-DSID,
 13376           CERTIFICATE-TRAILERS,
 13377           DFHEIV11,
 13378           DFHEIV99
 13379     MOVE EIBRESP  TO WS-RESPONSE
 13380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13381     else
 13382        if ws-resp-notfnd
 13383           move 'CS'             to certificate-trailers
 13384           move cl-company-cd    to cs-company-cd
 13385           move cl-cert-key-data to cs-control-primary (2:21)
 13386           move cl-cert-no       to cs-cert-no
 13387           move 'B'              to cs-trailer-type
 13388           perform varying s1 from +1 by +1 until s1 > +24
 13389              move zeros         to cs-benefit-period (s1)
 13390                                    cs-days-paid (s1)
 13391                                    cs-total-paid (s1)
 13392                                    cs-remaining-bens (s1)
 13393           end-perform
 13394           perform 2225-upd-crt-trlr
 13395                                 thru 2225-exit
 13396
 13397* EXEC CICS WRITE
 13398*             DATASET  (ELCRTT-DSID)
 13399*             from     (CERTIFICATE-TRAILERS)
 13400*             RIDFLD   (cs-control-primary)
 13401*             RESP     (WS-RESPONSE)
 13402*          END-EXEC
 13403     MOVE LENGTH OF
 13404      CERTIFICATE-TRAILERS
 13405       TO DFHEIV11
 13406*    MOVE '&$ L                  ''  N#00012713' TO DFHEIV0
 13407     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13408     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13409     MOVE X'204E233030303132373133' TO DFHEIV0(25:11)
 13410     CALL 'kxdfhei1' USING DFHEIV0,
 13411           ELCRTT-DSID,
 13412           CERTIFICATE-TRAILERS,
 13413           DFHEIV11,
 13414           cs-control-primary,
 13415           DFHEIV99,
 13416           DFHEIV99
 13417     MOVE EIBRESP  TO WS-RESPONSE
 13418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13419        end-if
 13420     END-IF
 13421
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 256
* EL156.cbl
 13422     .
 13423 2220-exit.
 13424     exit.
 13425
 13426 2225-upd-crt-trlr.
 13427
 13428*    if instypei = 'P'
 13429*       move +1 to s1
 13430*    else
 13431*       MOVE +2 to s1
 13432*    end-if
 13433
 13434*    move +1 to s1
 13435*    evaluate cl-claim-type
 13436*       when 'A'
 13437*          move +1 to s2
 13438*       when 'I'
 13439*          move +2 to s2
 13440*       when 'G'
 13441*          move +3 to s2
 13442*       when 'L'
 13443*          move +4 to s2
 13444*       when 'P'
 13445*          move +5 to s2
 13446*    end-evaluate
 13447     perform varying s1 from +1 by +1 until
 13448        (s1 > +24)
 13449        or (cl-claim-no = cs-claim-no (s1))
 13450     end-perform
 13451     if s1 < +25
 13452        compute cs-total-paid (s1) =
 13453           cs-total-paid (s1) + at-amount-paid
 13454        compute cs-days-paid (s1) =
 13455           cs-days-paid (s1) +  at-days-in-period
 13456*       compute cs-remaining-bens (s1) =
 13457*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13458        perform 2230-accum-bens-paid thru 2230-exit
 13459     end-if
 13460
 13461     .
 13462 2225-exit.
 13463     exit.
 13464 2230-accum-bens-paid.
 13465     if cl-claim-type not = 'L' and 'P'
 13466        move pi-ah-term          to ws-max-bens
 13467        if cl-critical-period not = zeros and spaces
 13468           move cl-critical-period
 13469                                 to ws-max-bens
 13470        end-if
 13471     else
 13472        move 01                  to ws-max-bens
 13473     end-if
 13474     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13475     perform varying s2 from +1 by +1 until
 13476        (s2 > +24)
 13477        or (cs-claim-no (s2) = spaces)
 13478        if pi-company-id not = 'DCC' and 'CAP'
 13479           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 257
* EL156.cbl
 13480              compute ws-tot-days-paid =
 13481                 ws-tot-days-paid + cs-days-paid (s2)
 13482              compute ws-tot-amt-paid =
 13483                 ws-tot-amt-paid + cs-total-paid (s2)
 13484           end-if
 13485        else
 13486           if (cs-benefit-period (s2) = cl-benefit-period)
 13487              and (cs-claim-type (s2) = cl-claim-type)
 13488              and (cs-insured-type (s2) = cl-insured-type)
 13489              compute ws-tot-days-paid =
 13490                 ws-tot-days-paid + cs-days-paid (s2)
 13491              compute ws-tot-amt-paid =
 13492                 ws-tot-amt-paid + cs-total-paid (s2)
 13493           end-if
 13494        end-if
 13495     end-perform
 13496     if cl-claim-type = 'L' and 'P'
 13497        if ws-tot-amt-paid > zeros
 13498           move zeros            to cs-remaining-bens (s1)
 13499        else
 13500           move 01               to cs-remaining-bens (s1)
 13501        end-if
 13502     else
 13503        compute ws-pd-bens rounded =
 13504           ws-tot-amt-paid / pi-ah-benefit-amt
 13505        compute cs-remaining-bens (s1) =
 13506           ws-max-bens - ws-pd-bens
 13507        if cs-remaining-bens (s1) < zeros
 13508           move zeros            to cs-remaining-bens (s1)
 13509        end-if
 13510     end-if
 13511     .
 13512 2230-exit.
 13513     exit.
 13514 3000-MOVE-INPUT-TO-SAVE-AREA.
 13515     IF PMTTYPEL > 0
 13516         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13517
 13518     if ws-pmttype = '4'
 13519        if pi-rb-joint-coverage
 13520           if payeel = +0
 13521              move +2            to payeel
 13522              move al-uanon      to payeea
 13523              move 'Q1'          to payeeo
 13524           else
 13525              if payeei not = 'Q1' and 'q1'
 13526                 move er-1582    to emi-error
 13527                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13528              end-if
 13529           end-if
 13530        end-if
 13531     end-if
 13532     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13533
 13534     IF WS-PMTTYPE = '9'
 13535         MOVE 'P'                TO PI-PROVISIONAL-IND
 13536         MOVE '1'                TO WS-PMTTYPE.
 13537
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 258
* EL156.cbl
 13538     IF PAYEEL > 0
 13539         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13540         MOVE PAYEEI             TO WS-PAYEE.
 13541
 13542     IF NOTE1L > +0
 13543         MOVE NOTE1I             TO WS-PMTNOTE1
 13544                                    WS-FLI-PMTNOTE
 13545                                    WS-HAN-PMTNOTE.
 13546
 13547     IF NOTE2L > +0
 13548         MOVE NOTE2I             TO WS-PMTNOTE2.
 13549
 13550     IF OFFLINEL > 0
 13551         MOVE OFFLINEI           TO WS-OFFLINE.
 13552
 13553     IF PROOFDTL > 0
 13554         MOVE PROOFDTI            TO DATE-WORK
 13555         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13556         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13557         MOVE '4'                 TO DC-OPTION-CODE
 13558         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13559         IF NO-CONVERSION-ERROR
 13560            MOVE NUM-WORK         TO PROOFDTO
 13561            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13562            MOVE NUM-WORK         TO WS-PROOF-DATE
 13563         ELSE
 13564            MOVE ZEROS            TO WS-PROOF-DATE
 13565         END-IF
 13566     END-IF.
 13567
 13568     IF EOBYNL > +0
 13569         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13570         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13571     END-IF
 13572
 13573     IF CLMFMYNL > +0
 13574         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13575         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13576     END-IF
 13577
 13578     IF SURVYYNL > +0
 13579         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13580         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13581     END-IF
 13582
 13583     IF SPRELYNL > +0
 13584         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13585         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13586     END-IF
 13587     if itrbynl <> +0
 13588        move function upper-case(itrbyni) to itrbyni
 13589        move itrbyni             to ws-int-to-rem-borr
 13590     end-if
 13591*    IF GROUPEDL > +0
 13592*        MOVE GROUPEDI           TO WS-GROUPED.
 13593*
 13594*    IF CASHL > +0
 13595*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 259
* EL156.cbl
 13596     IF LOANNOL > +0
 13597         MOVE LOANNOI            TO WS-LOAN-NO.
 13598
 13599     IF CHECKNOL > 0
 13600         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13601
 13602     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13603         IF WS-AIG-CREDIT-ENTERED
 13604             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13605             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13606             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13607             MOVE AL-UANON         TO CHECKNOA.
 13608
 13609     IF HOLDTILL > 0
 13610         MOVE HOLDTILI           TO DATE-WORK
 13611         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13612         MOVE NUM-WORK           TO WS-HOLDTIL.
 13613
 13614     IF ZINTL > +0
 13615
 13616* EXEC CICS BIF DEEDIT
 13617*           FIELD   (ZINTI)
 13618*           LENGTH  (07)
 13619*       END-EXEC
 13620     MOVE 07
 13621       TO DFHEIV11
 13622*    MOVE '@"L                   #   #00012915' TO DFHEIV0
 13623     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13624     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13625     MOVE X'2020233030303132393135' TO DFHEIV0(25:11)
 13626     CALL 'kxdfhei1' USING DFHEIV0,
 13627           ZINTI,
 13628           DFHEIV11
 13629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13630        IF ZINTI NOT NUMERIC
 13631           MOVE ER-0419          TO EMI-ERROR
 13632           PERFORM 9900-ERROR-FORMAT
 13633           MOVE AL-UABON         TO ZINTA
 13634           MOVE -1               TO ZINTL
 13635        ELSE
 13636           MOVE ZINTI            TO CP-INT-RATE
 13637                                    WS-INT-RATE
 13638           MOVE CP-INT-RATE      TO ZINTO
 13639           MOVE AL-UNNON         TO ZINTA
 13640        END-IF
 13641     ELSE
 13642        MOVE ZEROS               TO CP-INT-RATE
 13643     END-IF
 13644     IF EPYFROML > 0
 13645         MOVE EPYFROMI           TO DATE-WORK
 13646         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13647         MOVE NUM-WORK           TO WS-EPYFROM.
 13648
 13649     IF AIGFROML > 0
 13650         MOVE AIGFROMI           TO DATE-WORK
 13651         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13652         MOVE NUM-WORK           TO WS-AIGFROM
 13653     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 260
* EL156.cbl
 13654         IF (AIGFROMI = LOW-VALUES) AND
 13655            (PI-AIGFROM NOT = ZEROS)
 13656              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13657
 13658     IF EPYTHRUL > +0
 13659        MOVE EPYTHRUI           TO DATE-WORK
 13660        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13661        MOVE NUM-WORK           TO WS-EPYTHRU
 13662        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13663        MOVE '4'                TO DC-OPTION-CODE
 13664        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13665        IF NO-CONVERSION-ERROR
 13666           IF PI-USES-PAID-TO
 13667              MOVE '6'                TO DC-OPTION-CODE
 13668              MOVE -1                 TO DC-ELAPSED-DAYS
 13669              MOVE +0                 TO DC-ELAPSED-MONTHS
 13670              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13671              IF NO-CONVERSION-ERROR
 13672                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13673                 MOVE ' '             TO DC-OPTION-CODE
 13674                 MOVE +0              TO DC-ELAPSED-DAYS
 13675                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13676              IF NO-CONVERSION-ERROR
 13677                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13678
 13679*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13680*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13681     IF EDAYSL > 0
 13682
 13683* EXEC CICS BIF DEEDIT
 13684*            FIELD(EDAYSI)
 13685*            LENGTH(6)
 13686*        END-EXEC
 13687     MOVE 6
 13688       TO DFHEIV11
 13689*    MOVE '@"L                   #   #00012971' TO DFHEIV0
 13690     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13692     MOVE X'2020233030303132393731' TO DFHEIV0(25:11)
 13693     CALL 'kxdfhei1' USING DFHEIV0,
 13694           EDAYSI,
 13695           DFHEIV11
 13696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13697         MOVE EDAYSI             TO WS-DY-WORK
 13698         IF WS-DY-SIGN = SPACES
 13699            MOVE WS-DY-NUM       TO WS-EDAYS
 13700            ADD 0                TO WS-EDAYS
 13701         ELSE
 13702            MOVE EDAYSI          TO WS-EDAYS
 13703            ADD 0                TO WS-EDAYS.
 13704
 13705*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13706*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13707     IF EPYAMTL > 0
 13708
 13709* EXEC CICS BIF DEEDIT
 13710*            FIELD(EPYAMTI)
 13711*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 261
* EL156.cbl
 13712*        END-EXEC
 13713     MOVE 10
 13714       TO DFHEIV11
 13715*    MOVE '@"L                   #   #00012986' TO DFHEIV0
 13716     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13717     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13718     MOVE X'2020233030303132393836' TO DFHEIV0(25:11)
 13719     CALL 'kxdfhei1' USING DFHEIV0,
 13720           EPYAMTI,
 13721           DFHEIV11
 13722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13723         MOVE EPYAMTI            TO WS-PY-WORK
 13724         IF WS-PY-SIGN = SPACES
 13725            MOVE WS-PY-NUM       TO WS-EPYAMT
 13726            ADD 0                TO WS-EPYAMT
 13727         ELSE
 13728            MOVE EPYAMTI         TO WS-EPYAMT
 13729            ADD 0                TO WS-EPYAMT.
 13730
 13731     IF ERESVL > 0
 13732
 13733* EXEC CICS BIF DEEDIT
 13734*            FIELD(ERESVI)
 13735*            LENGTH(9)
 13736*        END-EXEC
 13737     MOVE 9
 13738       TO DFHEIV11
 13739*    MOVE '@"L                   #   #00012999' TO DFHEIV0
 13740     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13741     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13742     MOVE X'2020233030303132393939' TO DFHEIV0(25:11)
 13743     CALL 'kxdfhei1' USING DFHEIV0,
 13744           ERESVI,
 13745           DFHEIV11
 13746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13747         MOVE ERESVI TO WS-ERESV.
 13748
 13749     IF EEXPENSL > 0
 13750
 13751* EXEC CICS BIF DEEDIT
 13752*            FIELD(EEXPENSI)
 13753*            LENGTH(8)
 13754*        END-EXEC
 13755     MOVE 8
 13756       TO DFHEIV11
 13757*    MOVE '@"L                   #   #00013006' TO DFHEIV0
 13758     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13759     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13760     MOVE X'2020233030303133303036' TO DFHEIV0(25:11)
 13761     CALL 'kxdfhei1' USING DFHEIV0,
 13762           EEXPENSI,
 13763           DFHEIV11
 13764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13765         MOVE EEXPENSI           TO WS-EEXPENS.
 13766
 13767     IF ETYPEL > ZEROS
 13768         MOVE ETYPEI             TO WS-ETYPE.
 13769
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 262
* EL156.cbl
 13770     IF PI-COMPANY-ID = 'BOA'
 13771        IF PINTL > ZEROS
 13772
 13773* EXEC CICS BIF DEEDIT
 13774*            FIELD (PINTI)
 13775*            LENGTH(05)
 13776*          END-EXEC
 13777     MOVE 05
 13778       TO DFHEIV11
 13779*    MOVE '@"L                   #   #00013017' TO DFHEIV0
 13780     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13781     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13782     MOVE X'2020233030303133303137' TO DFHEIV0(25:11)
 13783     CALL 'kxdfhei1' USING DFHEIV0,
 13784           PINTI,
 13785           DFHEIV11
 13786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13787           IF PINTI NUMERIC
 13788               MOVE AL-UNNON     TO PINTA
 13789               MOVE PINTI        TO WS-INT-RATE
 13790               MOVE WS-INT-RATE  TO PINTO.
 13791
 13792 3000-EXIT.
 13793     EXIT.
 13794
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 263
* EL156.cbl
 13796 3050-REBUILD-ENTERED.
 13797
 13798     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13799
 13800     IF PI-PROV-PMT
 13801         MOVE '9'           TO PMTTYPEO
 13802     ELSE
 13803         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13804
 13805     MOVE PI-PAYEE          TO PAYEEO.
 13806     MOVE PI-PMTNOTE1       TO NOTE1O.
 13807     MOVE PI-PMTNOTE2       TO NOTE2O.
 13808     MOVE PI-OFFLINE        TO OFFLINEO.
 13809     IF PI-PROOF-DATE NOT = ZEROS
 13810         MOVE PI-PROOF-DATE TO PROOFDTO
 13811         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13812     END-IF.
 13813*    MOVE PI-GROUPED        TO GROUPEDO.
 13814
 13815*    MOVE PI-CASH           TO CASHO.
 13816
 13817     IF PI-INT-RATE > ZEROS
 13818        MOVE PI-INT-RATE         TO PINTO
 13819     end-if
 13820     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13821        IF PI-INT-AMT > ZEROS
 13822           MOVE PI-INT-AMT       TO PINTO
 13823           MOVE AL-PANOF         TO PINTA
 13824                                    PINTHA
 13825           if pi-rb-joint-coverage
 13826              move '  INT TO'    to itrb1o
 13827              move ' REM BORR?'  to itrb2o
 13828              move 'Y'           to itrbyno
 13829              move al-uanon      to itrbyna
 13830              move +1            to itrbynl
 13831           end-if
 13832        END-IF
 13833     END-IF
 13834     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13835     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13836     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13837     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13838     IF PI-HOLDTIL NOT = ZEROS
 13839        MOVE PI-HOLDTIL          TO HOLDTILO
 13840        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13841
 13842     IF PI-EPYFROM NOT = ZEROS
 13843        MOVE PI-EPYFROM          TO EPYFROMO
 13844        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13845
 13846     IF PI-AIGFROM NOT = ZEROS
 13847        MOVE PI-AIGFROM          TO AIGFROMO
 13848        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13849
 13850     IF PI-EPYTHRU NOT = ZEROS
 13851        MOVE PI-EPYTHRU          TO EPYTHRUO
 13852        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13853        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 264
* EL156.cbl
 13854           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13855           MOVE '4'                TO DC-OPTION-CODE
 13856           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13857           IF NO-CONVERSION-ERROR
 13858              MOVE +1 TO DC-ELAPSED-DAYS
 13859              MOVE +0 TO DC-ELAPSED-MONTHS
 13860              MOVE '6' TO DC-OPTION-CODE
 13861              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13862              IF NO-CONVERSION-ERROR
 13863                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13864
 13865     IF PI-EDAYS NOT = ZEROS
 13866        MOVE PI-EDAYS TO EDAYSO.
 13867
 13868     IF PI-EPYAMT NOT = ZEROS
 13869        MOVE PI-EPYAMT TO EPYAMTO.
 13870
 13871     IF PI-ERESV NOT = ZEROS
 13872        MOVE PI-ERESV TO ERESVO.
 13873
 13874     IF PI-EEXPENS NOT = ZEROS
 13875        MOVE PI-EEXPENS TO EEXPENSO.
 13876
 13877     MOVE PI-ETYPE TO ETYPEO.
 13878
 13879     IF PI-ECHECKNO NOT = SPACES
 13880        MOVE PI-ECHECKNO         TO CHECKNOO
 13881     ELSE
 13882        MOVE PI-CCHECKNO         TO CHECKNOO.
 13883
 13884     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13885     MOVE SPACES                 TO DC-OPTION-CODE.
 13886     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13887
 13888     IF DATE-CONVERSION-ERROR
 13889        MOVE SPACES              TO CPYFROMI
 13890     ELSE
 13891        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13892
 13893     IF PI-USES-PAID-TO
 13894        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13895        MOVE +1                  TO DC-ELAPSED-DAYS
 13896        MOVE +0                  TO DC-ELAPSED-MONTHS
 13897        MOVE '6'                 TO DC-OPTION-CODE
 13898        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13899        IF NO-CONVERSION-ERROR
 13900           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13901           GO TO 3051-CONTINUE.
 13902
 13903     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13904     MOVE SPACES                 TO DC-OPTION-CODE.
 13905     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13906
 13907     IF DATE-CONVERSION-ERROR
 13908        MOVE SPACES              TO CPYTHRUI
 13909     ELSE
 13910        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13911
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 265
* EL156.cbl
 13912 3051-CONTINUE.
 13913
 13914     IF PI-CDAYS NOT = ZEROS
 13915        MOVE PI-CDAYS TO CDAYSO.
 13916
 13917     IF PI-CPYAMT NOT = ZEROS
 13918        MOVE PI-CPYAMT TO CPYAMTO.
 13919
 13920     IF PI-CRESV NOT = ZEROS
 13921        MOVE PI-CRESV TO CRESVO.
 13922
 13923     IF PI-CEXPENS NOT = ZEROS
 13924        MOVE PI-CEXPENS TO CEXPENSO.
 13925
 13926 3059-EXIT.
 13927     EXIT.
 13928
 13929 3100-DEEDIT-DATE.
 13930
 13931* EXEC CICS BIF DEEDIT
 13932*        FIELD(DATE-WORK)
 13933*        LENGTH(8)
 13934*    END-EXEC.
 13935     MOVE 8
 13936       TO DFHEIV11
 13937*    MOVE '@"L                   #   #00013164' TO DFHEIV0
 13938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13940     MOVE X'2020233030303133313634' TO DFHEIV0(25:11)
 13941     CALL 'kxdfhei1' USING DFHEIV0,
 13942           DATE-WORK,
 13943           DFHEIV11
 13944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13945
 13946
 13947 3100-EXIT.
 13948     EXIT.
 13949
 13950 3200-CALC-AIG-DAYS.
 13951
 13952     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13953
 13954     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13955     MOVE ' '                    TO DC-OPTION-CODE.
 13956     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13957     IF NO-CONVERSION-ERROR
 13958         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13959     ELSE
 13960         GO TO 3290-ERROR.
 13961
 13962     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13963         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13964                                WS-BIN-FROM-DT
 13965     ELSE
 13966         IF CL-TOTAL-PAID-AMT > ZEROS
 13967             IF WS-SV-EPYFROM = LOW-VALUES
 13968                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13969                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 266
* EL156.cbl
 13970             ELSE
 13971                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13972                                        WS-BIN-FROM-DT
 13973         ELSE
 13974             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13975                                        WS-BIN-FROM-DT.
 13976
 13977 3210-CONTINUE.
 13978
 13979     MOVE ' '                    TO DC-OPTION-CODE.
 13980     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13981     IF DATE-CONVERSION-ERROR
 13982         GO TO 3290-ERROR.
 13983
 13984     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13985
 13986     IF PI-LOAN-DUE-DAY = 31
 13987         MOVE 30              TO WS-PMT-DUE-DA
 13988                                 WS-SAVE-DUE-DA
 13989     ELSE
 13990         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13991                                 WS-SAVE-DUE-DA.
 13992
 13993     IF (PI-LOAN-DUE-DAY > 28) AND
 13994        (WS-PMT-DUE-MO = 2)
 13995         MOVE 'Y'                TO WS-DUE-DAY-SW
 13996         MOVE 28                 TO WS-PMT-DUE-DA.
 13997
 13998     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13999     MOVE '4'                    TO DC-OPTION-CODE.
 14000     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14001     IF NO-CONVERSION-ERROR
 14002         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14003     ELSE
 14004         GO TO 3290-ERROR.
 14005
 14006*--------------------------------------------------------------*
 14007*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14008*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14009*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14010*                                                              *
 14011*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14012*             INCURRED DATE      - 04/15/91                    *
 14013*             PMT DUE DATE       - 04/03/91                    *
 14014*             PMT DUE DATE       - 05/03/91                    *
 14015*--------------------------------------------------------------*
 14016
 14017     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14018        (WS-SV-AIGFROM = LOW-VALUES)
 14019         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14020            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14021             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14022             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14023             IF NO-CONVERSION-ERROR
 14024                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14025                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14026             ELSE
 14027                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 267
* EL156.cbl
 14028
 14029     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14030        (WS-SV-AIGFROM = LOW-VALUES)
 14031         GO TO 3205-CONT-CALC-PMT.
 14032
 14033     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14034     MOVE ' '                    TO DC-OPTION-CODE.
 14035     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14036     IF NO-CONVERSION-ERROR
 14037         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14038     ELSE
 14039         GO TO 3290-ERROR.
 14040
 14041     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14042        (WS-PMT-DUE-DA < WS-FROM-DA)
 14043          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14044          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14045          IF NO-CONVERSION-ERROR
 14046              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14047              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14048          ELSE
 14049              GO TO 3290-ERROR.
 14050
 14051 3205-CONT-CALC-PMT.
 14052
 14053*--------------------------------------------------------------*
 14054*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14055*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14056*--------------------------------------------------------------*
 14057
 14058     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14059        PI-PMTTYPE = '2'
 14060          NEXT SENTENCE
 14061     ELSE
 14062        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14063           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14064             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14065             MOVE ER-3527            TO EMI-ERROR
 14066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14067             MOVE -1                 TO EPYTHRUL
 14068             MOVE AL-UNBON           TO EPYTHRUA
 14069                                        EPYFROMA
 14070             GO TO 3299-EXIT.
 14071
 14072*--------------------------------------------------------------*
 14073*    CALCULATE RETRO ELIMINATION DATE                          *
 14074*--------------------------------------------------------------*
 14075
 14076     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14077         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14078     ELSE
 14079         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14080
 14081     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14082     MOVE +0             TO DC-ELAPSED-MONTHS.
 14083     MOVE '6'            TO DC-OPTION-CODE.
 14084     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14085     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 268
* EL156.cbl
 14086         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14087     ELSE
 14088         GO TO 3290-ERROR.
 14089
 14090 3210-CHECK-PMT-DATE.
 14091
 14092*--------------------------------------------------------------*
 14093*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14094*    THE ENTERED PAY FROM DATE                                 *
 14095*--------------------------------------------------------------*
 14096
 14097     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14098         NEXT SENTENCE
 14099     ELSE
 14100         GO TO 3220-COMPUTE-DAYS.
 14101
 14102     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14103     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14104     IF NO-CONVERSION-ERROR
 14105         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14106         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14107         GO TO 3210-CHECK-PMT-DATE
 14108     ELSE
 14109         GO TO 3290-ERROR.
 14110
 14111 3220-COMPUTE-DAYS.
 14112
 14113     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14114     MOVE ZEROS         TO WS-CDAYS.
 14115     MOVE 'N'           TO WS-ELIMINATION-SW.
 14116
 14117*--------------------------------------------------------------*
 14118*    COMPUTE CALIFORNIA DUE DAYS                               *
 14119*--------------------------------------------------------------*
 14120
 14121     IF CL-TOTAL-PAID-AMT > ZEROS
 14122         MOVE 'Y' TO WS-ELIMINATION-SW
 14123         GO TO 3240-FIRST-PMT-DUE
 14124     ELSE
 14125        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14126            NEXT SENTENCE
 14127        ELSE
 14128            GO TO 3240-FIRST-PMT-DUE.
 14129
 14130 3230-NEXT-PMT-DUE.
 14131
 14132     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14133     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14134     IF NO-CONVERSION-ERROR
 14135         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14136         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14137     ELSE
 14138         GO TO 3290-ERROR.
 14139
 14140 3240-FIRST-PMT-DUE.
 14141
 14142     IF CL-TOTAL-PAID-AMT > ZEROS
 14143         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 269
* EL156.cbl
 14144     ELSE
 14145        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14146            GO TO 3230-NEXT-PMT-DUE.
 14147
 14148     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14149         GO TO 3250-VERIFY-ELIMINATION.
 14150
 14151     ADD +30 TO WS-CDAYS.
 14152     MOVE 'Y' TO WS-ELIMINATION-SW.
 14153     GO TO 3230-NEXT-PMT-DUE.
 14154
 14155 3250-VERIFY-ELIMINATION.
 14156
 14157     IF ELIM-SATISFIED
 14158         GO TO 3260-END-CALC.
 14159
 14160     IF PI-PMTTYPE = '1'
 14161         MOVE ZEROS TO WS-CDAYS
 14162         GO TO 3260-END-CALC.
 14163
 14164     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14165         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14166     ELSE
 14167         IF CL-TOTAL-PAID-AMT > ZEROS
 14168             IF WS-SV-EPYFROM = LOW-VALUES
 14169                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14170             ELSE
 14171                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14172         ELSE
 14173             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14174
 14175     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14176     MOVE '1'                    TO DC-OPTION-CODE.
 14177     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14178     IF NO-CONVERSION-ERROR
 14179         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14180     ELSE
 14181         GO TO 3290-ERROR.
 14182
 14183     IF CL-TOTAL-PAID-AMT > ZEROS
 14184         MOVE WS-DAYS-OFF TO WS-CDAYS
 14185     ELSE
 14186         IF PI-BEN-DAYS > WS-DAYS-OFF
 14187             MOVE ZEROS TO WS-CDAYS
 14188         ELSE
 14189             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14190
 14191 3260-END-CALC.
 14192
 14193     MOVE WS-CDAYS TO PI-CDAYS.
 14194
 14195     IF PI-EDAYS = ZEROS
 14196         MOVE PI-CDAYS TO PI-EDAYS
 14197         MOVE AL-UNNON TO EDAYSA.
 14198
 14199     GO TO 3299-EXIT.
 14200
 14201 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 270
* EL156.cbl
 14202
 14203     MOVE ER-3528            TO EMI-ERROR.
 14204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14205     MOVE -1                 TO CDAYSL.
 14206     MOVE AL-UNBON           TO CDAYSA.
 14207
 14208 3299-EXIT.
 14209     EXIT.
 14210
 14211 3300-BUMP-DATE.
 14212
 14213     IF WS-RESTORE-DUE-DAY
 14214         MOVE 'N'              TO WS-DUE-DAY-SW
 14215         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14216         ADD 1                 TO WS-PMT-DUE-MO
 14217         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14218         MOVE '4'              TO DC-OPTION-CODE
 14219         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14220         IF NO-CONVERSION-ERROR
 14221             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14222             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14223             GO TO 3399-EXIT
 14224         ELSE
 14225             MOVE '9'          TO DC-ERROR-CODE
 14226             GO TO 3399-EXIT.
 14227
 14228     IF (WS-PMT-DUE-MO = 1) AND
 14229        (WS-SAVE-DUE-DA > 28)
 14230           MOVE 'Y' TO WS-DUE-DAY-SW.
 14231
 14232     MOVE +0                 TO DC-ELAPSED-DAYS.
 14233     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14234     MOVE '6'                TO DC-OPTION-CODE.
 14235     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14236
 14237 3399-EXIT.
 14238     EXIT.
 14239
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 271
* EL156.cbl
 14241 3400-COMPUTE-EXPIRY.
 14242
 14243     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14244     MOVE +0                    TO DC-ELAPSED-DAYS
 14245                                   DC-ODD-DAYS-OVER.
 14246     MOVE '1'                   TO DC-END-OF-MONTH.
 14247     MOVE '6'                   TO DC-OPTION-CODE.
 14248
 14249     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14250         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14251     ELSE
 14252         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14253
 14254     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14255     IF NO-CONVERSION-ERROR
 14256         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14257     ELSE
 14258         GO TO 3390-CONTINUE.
 14259
 14260     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14261         GO TO 3390-CONTINUE.
 14262
 14263     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14264     MOVE '4'                    TO CNTL-REC-TYPE.
 14265     MOVE +0                     TO CNTL-SEQ-NO.
 14266     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14267     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14268     MOVE 'BENE'                 TO FILE-SWITCH.
 14269
 14270     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14271
 14272     IF NO-BENEFIT-FOUND
 14273         GO TO 3390-CONTINUE.
 14274
 14275     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14276        IF (PI-OFFLINE = 'Y') OR
 14277           (PI-PMTTYPE = '7')
 14278           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14279                                     THRU 9870-EXIT
 14280           IF ERROR-ON-OUTPUT
 14281             MOVE -1                 TO ENTERPFL
 14282             MOVE AL-UANON           TO ENTERPFA
 14283             MOVE MAP-NAMEA          TO MAP-NAME
 14284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14285             GO TO 8200-SEND-DATAONLY.
 14286
 14287     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14288        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14289        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14290          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14291          MOVE +0        TO DC-ELAPSED-DAYS
 14292          MOVE +1        TO DC-ELAPSED-MONTHS
 14293          MOVE 6         TO DC-OPTION-CODE
 14294          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14295          IF NO-CONVERSION-ERROR
 14296              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14297
 14298 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 272
* EL156.cbl
 14299
 14300      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14301         MOVE CM-AH-LOAN-EXPIRE-DT
 14302                                 TO DC-BIN-DATE-1
 14303      ELSE
 14304         MOVE CM-LF-LOAN-EXPIRE-DT
 14305                                 TO DC-BIN-DATE-1
 14306      END-IF
 14307
 14308      MOVE ' '                    TO DC-OPTION-CODE.
 14309      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14310      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14311      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14312
 14313 3499-EXIT.
 14314     EXIT.
 14315
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 273
* EL156.cbl
 14317
 14318 3600-CHECK-VERIFICATION.
 14319
 14320     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14321
 14322     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14323
 14324     IF PI-PAYEE-TYPE = 'I'
 14325        GO TO 3600-READ-TRAILER.
 14326
 14327     IF PI-PAYEE-TYPE = 'B'
 14328        ADD +10                  TO TRLR-SEQ-NO
 14329        GO TO 3600-READ-TRAILER.
 14330
 14331     IF PI-PAYEE-TYPE = 'A'
 14332        ADD +20                  TO TRLR-SEQ-NO
 14333        GO TO 3600-READ-TRAILER.
 14334
 14335     IF PI-PAYEE-TYPE = 'O'
 14336        ADD +50                  TO TRLR-SEQ-NO
 14337        GO TO 3600-READ-TRAILER.
 14338
 14339     IF PI-PAYEE-TYPE = 'Q'
 14340        ADD +60                  TO TRLR-SEQ-NO
 14341        GO TO 3600-READ-TRAILER.
 14342
 14343     IF PI-PAYEE-TYPE = 'P'
 14344        ADD +30                  TO TRLR-SEQ-NO
 14345        GO TO 3600-READ-TRAILER.
 14346
 14347     IF PI-PAYEE-TYPE = 'E'
 14348        ADD +40                  TO TRLR-SEQ-NO.
 14349
 14350 3600-READ-TRAILER.
 14351
 14352
 14353* EXEC CICS HANDLE CONDITION
 14354*         NOTFND(3600-CONTINUE)
 14355*    END-EXEC.
 14356*    MOVE '"$I                   ! - #00013574' TO DFHEIV0
 14357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14359     MOVE X'2D20233030303133353734' TO DFHEIV0(25:11)
 14360     CALL 'kxdfhei1' USING DFHEIV0
 14361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14362
 14363
 14364     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14365
 14366 3600-CONTINUE.
 14367
 14368     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14369         GO TO 3600-AH-VERIFY
 14370     END-IF.
 14371
 14372     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14373       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14374         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 274
* EL156.cbl
 14375           MOVE ER-7576            TO EMI-ERROR
 14376           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14377           MOVE -1                 TO PAYEEL
 14378           MOVE AL-UABON           TO PAYEEA
 14379           GO TO 3600-EXIT
 14380         END-IF
 14381       END-IF
 14382     END-IF.
 14383
 14384     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14385     MOVE 1 TO WS-SUB2
 14386     MOVE SPACES TO WS-PAYEE-NAME
 14387     PERFORM VARYING WS-SUB FROM 1 BY 1
 14388             UNTIL WS-SUB > 30
 14389         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14390            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14391                 WS-PAYEE-NAME-X (WS-SUB2)
 14392            ADD +1 TO WS-SUB2
 14393         END-IF
 14394     END-PERFORM.
 14395
 14396     STRING CL-INSURED-1ST-NAME
 14397            CL-INSURED-MID-INIT
 14398            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14399     MOVE 1 TO WS-SUB2
 14400     MOVE SPACES TO WS-INSURED-NAME
 14401     PERFORM VARYING WS-SUB FROM 1 BY 1
 14402             UNTIL WS-SUB > 30
 14403         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14404            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14405                 WS-INSURED-NAME-X (WS-SUB2)
 14406            ADD +1 TO WS-SUB2
 14407         END-IF
 14408     END-PERFORM.
 14409
 14410     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14411        MOVE ER-7579            TO EMI-ERROR
 14412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14413        MOVE -1                 TO PAYEEL
 14414        MOVE AL-UABON           TO PAYEEA
 14415     END-IF.
 14416
 14417     IF PI-PMTTYPE = '4'  AND
 14418        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14419        PI-PAYEE-TYPE <> 'I'
 14420          MOVE ER-7580          TO EMI-ERROR
 14421          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14422          MOVE -1               TO PAYEEL
 14423          MOVE AL-UABON         TO PAYEEA
 14424     END-IF.
 14425
 14426     GO TO 3600-EXIT.
 14427
 14428 3600-AH-VERIFY.
 14429
 14430     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14431        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14432           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 275
* EL156.cbl
 14433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14434           MOVE -1                 TO PAYEEL
 14435           MOVE AL-UABON           TO PAYEEA
 14436        END-IF
 14437     END-IF.
 14438
 14439
 14440 3600-EXIT.
 14441     EXIT.
 14442
 14443 5000-UPDATE.
 14444
 14445     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14446
 14447     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14448
 14449     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14450        PI-OFFLINE = 'Y'
 14451        NEXT SENTENCE
 14452     ELSE
 14453        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14454
 14455*    IF PI-COMPANY-ID = 'CRI'
 14456*       IF PI-PMTTYPE = '1' OR  '2'
 14457*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14458*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14459*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14460
 14461*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14462*       IF PI-PMTTYPE = '1'
 14463*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14464*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14465
 14466     IF PI-PMTTYPE      = '2' AND
 14467        PI-SPLIT-PMT-SW = 'Y' AND
 14468        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14469          MOVE ER-3530                TO EMI-ERROR
 14470          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14471
 14472     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14473        AND (CL-CLAIM-TYPE = 'L')
 14474        IF PI-PMTTYPE = '2' OR '4'
 14475           IF PI-INT-AMT NOT = ZEROS
 14476              PERFORM 7110-BUILD-PMT-TRLR
 14477                                 THRU 7130-EXIT
 14478           ELSE
 14479              IF PI-PMTTYPE = '2'
 14480                 PERFORM 7140-BUILD-NOTE-TRLR
 14481                                 THRU 7170-EXIT
 14482              END-IF
 14483           END-IF
 14484        END-IF
 14485     END-IF
 14486*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14487*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14488*            MOVE 'N'                 TO  WS-LETTER-SW.
 14489
 14490*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 276
* EL156.cbl
 14491*        IF CL-NO-OF-PMTS-MADE = +1
 14492*                OR
 14493*           PI-PMTTYPE = '2'
 14494*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14495
 14496     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14497
 14498*    IF PI-COMPANY-ID = 'DMD'
 14499*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14500*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14501
 14502
 14503* EXEC CICS REWRITE
 14504*         DATASET('ELMSTR')
 14505*         FROM(CLAIM-MASTER)
 14506*     END-EXEC.
 14507     MOVE LENGTH OF
 14508      CLAIM-MASTER
 14509       TO DFHEIV11
 14510     MOVE 'ELMSTR' TO DFHEIV1
 14511*    MOVE '&& L                  %   #00013716' TO DFHEIV0
 14512     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14513     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14514     MOVE X'2020233030303133373136' TO DFHEIV0(25:11)
 14515     CALL 'kxdfhei1' USING DFHEIV0,
 14516           DFHEIV1,
 14517           CLAIM-MASTER,
 14518           DFHEIV11,
 14519           DFHEIV99
 14520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14521
 14522
 14523     IF WS-LETTER-SW = 'N'
 14524         GO TO 5000-END-UPDATE.
 14525
 14526 5000-GENERATE-AUTO-LETTER.
 14527
 14528
 14529* EXEC CICS LINK
 14530*        PROGRAM    (LINK-1523)
 14531*        COMMAREA   (W-1523-LINKDATA)
 14532*        LENGTH     (W-1523-COMM-LENGTH)
 14533*    END-EXEC.
 14534*    MOVE '."C                   (   #00013726' TO DFHEIV0
 14535     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14537     MOVE X'2020233030303133373236' TO DFHEIV0(25:11)
 14538     CALL 'kxdfhei1' USING DFHEIV0,
 14539           LINK-1523,
 14540           W-1523-LINKDATA,
 14541           W-1523-COMM-LENGTH,
 14542           DFHEIV99,
 14543           DFHEIV99,
 14544           DFHEIV99,
 14545           DFHEIV99
 14546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14547
 14548
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 277
* EL156.cbl
 14549     IF W-1523-FATAL-ERROR
 14550         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14552         MOVE ER-0802                TO  EMI-ERROR
 14553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14554
 14555     IF W-1523-ERROR-CODE = 0191
 14556         MOVE ER-0803                TO  EMI-ERROR
 14557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14558
 14559     IF PI-COMPANY-ID      = 'HAN' AND
 14560        PI-PMTTYPE         = '1'   AND
 14561        PI-3RD-PARTY-SW    = 'Y'   AND
 14562        W-1523-FORM-NUMBER = 'EOB1'
 14563           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14564           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14565           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14566           GO TO 5000-GENERATE-AUTO-LETTER.
 14567
 14568 5000-END-UPDATE.
 14569
 14570     MOVE ER-0000                TO EMI-ERROR.
 14571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14572     GO TO 7000-SHOW-CLAIM.
 14573
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 278
* EL156.cbl
 14575 5000-MOVE-NAME.
 14576     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14577     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14578     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14579
 14580 5000-EXIT.
 14581     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 279
* EL156.cbl
 14583 5300-CREATE-DMO.
 14584
 14585     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14586     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14587     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14588
 14589
 14590* EXEC CICS HANDLE CONDITION
 14591*         NOTFND   (5300-NOTE-NOT-FOUND)
 14592*    END-EXEC.
 14593*    MOVE '"$I                   ! . #00013772' TO DFHEIV0
 14594     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14596     MOVE X'2E20233030303133373732' TO DFHEIV0(25:11)
 14597     CALL 'kxdfhei1' USING DFHEIV0
 14598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14599
 14600
 14601
 14602* EXEC CICS READ
 14603*         DATASET('ERNOTE')
 14604*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14605*         RIDFLD (W-NOTE-KEY)
 14606*    END-EXEC.
 14607     MOVE 'ERNOTE' TO DFHEIV1
 14608*    MOVE '&"S        E          (   #00013776' TO DFHEIV0
 14609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14611     MOVE X'2020233030303133373736' TO DFHEIV0(25:11)
 14612     CALL 'kxdfhei1' USING DFHEIV0,
 14613           DFHEIV1,
 14614           DFHEIV20,
 14615           DFHEIV99,
 14616           W-NOTE-KEY,
 14617           DFHEIV99,
 14618           DFHEIV99,
 14619           DFHEIV99
 14620     SET ADDRESS OF CERTIFICATE-NOTE TO
 14621         DFHEIV20
 14622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14623
 14624
 14625     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14626     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14627     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14628
 14629     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14630         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14631     ELSE
 14632         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14633
 14634     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14635     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14636     MOVE 'DLO006'               TO PGM-NAME.
 14637
 14638
 14639* EXEC CICS LINK
 14640*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 280
* EL156.cbl
 14641*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14642*        LENGTH     (DCT-RCRD-LENGTH)
 14643*    END-EXEC.
 14644*    MOVE '."C                   (   #00013795' TO DFHEIV0
 14645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14647     MOVE X'2020233030303133373935' TO DFHEIV0(25:11)
 14648     CALL 'kxdfhei1' USING DFHEIV0,
 14649           PGM-NAME,
 14650           DCT-COMMUNICATION-AREA,
 14651           DCT-RCRD-LENGTH,
 14652           DFHEIV99,
 14653           DFHEIV99,
 14654           DFHEIV99,
 14655           DFHEIV99
 14656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14657
 14658
 14659     IF DCT-RETURN-CODE = 'OK'
 14660         GO TO 5300-CONT.
 14661
 14662     IF DCT-RETURN-CODE = '01' OR '02'
 14663         GO TO 5300-EXIT.
 14664
 14665     IF DCT-RETURN-CODE = '03'
 14666         MOVE ER-0951            TO EMI-ERROR
 14667         GO TO 5300-BAD-EXIT.
 14668
 14669     IF DCT-RETURN-CODE = '04'
 14670         MOVE ER-0946            TO EMI-ERROR
 14671         GO TO 5300-BAD-EXIT.
 14672
 14673     IF DCT-RETURN-CODE = '05'
 14674         MOVE ER-0947            TO EMI-ERROR
 14675         GO TO 5300-BAD-EXIT.
 14676
 14677     IF DCT-RETURN-CODE = '06'
 14678         MOVE ER-0921            TO EMI-ERROR
 14679         GO TO 5300-BAD-EXIT.
 14680
 14681     IF DCT-RETURN-CODE = '07'
 14682         MOVE ER-0849            TO EMI-ERROR
 14683         GO TO 5300-BAD-EXIT.
 14684
 14685     IF DCT-RETURN-CODE = '08'
 14686         MOVE ER-0948            TO EMI-ERROR
 14687         GO TO 5300-BAD-EXIT.
 14688
 14689     IF DCT-RETURN-CODE = 'N1'
 14690         MOVE ER-0950            TO EMI-ERROR
 14691         GO TO 5300-BAD-EXIT.
 14692
 14693     IF DCT-RETURN-CODE = 'E1'
 14694         MOVE ER-0974            TO EMI-ERROR
 14695         GO TO 5300-BAD-EXIT.
 14696
 14697     IF DCT-RETURN-CODE = 'E2'
 14698         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 281
* EL156.cbl
 14699         GO TO 5300-BAD-EXIT.
 14700
 14701     IF DCT-RETURN-CODE NOT = 'OK'
 14702         MOVE ER-0949            TO EMI-ERROR
 14703         GO TO 5300-BAD-EXIT.
 14704
 14705 5300-CONT.
 14706
 14707     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14708     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14709     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14710     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14711     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14712     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14713     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14714     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14715
 14716     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14717     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14718     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14719     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14720     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14721
 14722     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14723
 14724     IF PI-PMTTYPE = '2'
 14725         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14726         MOVE '4'                TO DM-CLAIM-STATUS
 14727     ELSE
 14728         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14729         MOVE '2'                TO DM-CLAIM-STATUS.
 14730
 14731     MOVE 'DLO025'               TO PGM-NAME.
 14732
 14733
 14734* EXEC CICS LINK
 14735*        PROGRAM    (PGM-NAME)
 14736*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14737*        LENGTH     (DM-DMO-LENGTH)
 14738*    END-EXEC.
 14739*    MOVE '."C                   (   #00013875' TO DFHEIV0
 14740     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14742     MOVE X'2020233030303133383735' TO DFHEIV0(25:11)
 14743     CALL 'kxdfhei1' USING DFHEIV0,
 14744           PGM-NAME,
 14745           DMO-COMMUNICATION-AREA,
 14746           DM-DMO-LENGTH,
 14747           DFHEIV99,
 14748           DFHEIV99,
 14749           DFHEIV99,
 14750           DFHEIV99
 14751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14752
 14753
 14754     IF DM-RETURN-CODE = 'OK'
 14755         GO TO 5300-EXIT.
 14756
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 282
* EL156.cbl
 14757     IF DM-RETURN-CODE = '01'
 14758         MOVE ER-8051            TO EMI-ERROR
 14759         GO TO 5300-BAD-EXIT.
 14760
 14761     IF DM-RETURN-CODE = '02'
 14762         MOVE ER-8052            TO EMI-ERROR
 14763         GO TO 5300-BAD-EXIT.
 14764
 14765     IF DM-RETURN-CODE = '03'
 14766         MOVE ER-8053            TO EMI-ERROR
 14767         GO TO 5300-BAD-EXIT.
 14768
 14769     IF DM-RETURN-CODE = '04'
 14770         MOVE ER-8054            TO EMI-ERROR
 14771         GO TO 5300-BAD-EXIT.
 14772
 14773     IF DM-RETURN-CODE = '05'
 14774         MOVE ER-8055            TO EMI-ERROR
 14775         GO TO 5300-BAD-EXIT.
 14776
 14777     IF DM-RETURN-CODE = '06'
 14778         MOVE ER-8056            TO EMI-ERROR
 14779         GO TO 5300-BAD-EXIT.
 14780
 14781     IF DM-RETURN-CODE = '07'
 14782         MOVE ER-8057            TO EMI-ERROR
 14783         GO TO 5300-BAD-EXIT.
 14784
 14785     IF DM-RETURN-CODE = '08'
 14786         MOVE ER-8058            TO EMI-ERROR
 14787         GO TO 5300-BAD-EXIT.
 14788
 14789     IF DM-RETURN-CODE = '09'
 14790         MOVE ER-8059            TO EMI-ERROR
 14791         GO TO 5300-BAD-EXIT.
 14792
 14793     IF DM-RETURN-CODE = '10'
 14794         MOVE ER-8060            TO EMI-ERROR
 14795         GO TO 5300-BAD-EXIT.
 14796
 14797     IF DM-RETURN-CODE = '11'
 14798         MOVE ER-8061            TO EMI-ERROR
 14799         GO TO 5300-BAD-EXIT.
 14800
 14801     IF DM-RETURN-CODE = '12'
 14802         MOVE ER-8062            TO EMI-ERROR
 14803         GO TO 5300-BAD-EXIT.
 14804
 14805     IF DM-RETURN-CODE = '13'
 14806         MOVE ER-8063            TO EMI-ERROR
 14807         GO TO 5300-BAD-EXIT.
 14808
 14809     IF DM-RETURN-CODE = '14'
 14810         MOVE ER-8064            TO EMI-ERROR
 14811         GO TO 5300-BAD-EXIT.
 14812
 14813     IF DM-RETURN-CODE = '15'
 14814         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 283
* EL156.cbl
 14815         GO TO 5300-BAD-EXIT.
 14816
 14817     IF DM-RETURN-CODE = '16'
 14818         MOVE ER-8154            TO EMI-ERROR
 14819         GO TO 5300-BAD-EXIT.
 14820
 14821     IF DM-RETURN-CODE = '17'
 14822         MOVE ER-8155            TO EMI-ERROR
 14823         GO TO 5300-BAD-EXIT.
 14824
 14825     IF DM-RETURN-CODE = 'N1'
 14826         MOVE ER-8152            TO EMI-ERROR
 14827         GO TO 5300-BAD-EXIT.
 14828
 14829     IF DM-RETURN-CODE = 'E1'
 14830         MOVE ER-8153            TO EMI-ERROR
 14831         GO TO 5300-BAD-EXIT.
 14832
 14833     MOVE ER-8066            TO EMI-ERROR.
 14834     GO TO 5300-BAD-EXIT.
 14835
 14836 5300-NOTE-NOT-FOUND.
 14837
 14838     MOVE ER-0954                TO EMI-ERROR.
 14839     GO TO 5300-BAD-EXIT.
 14840
 14841 5300-BAD-EXIT.
 14842
 14843* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14844*    MOVE '6"R                   !   #00013969' TO DFHEIV0
 14845     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14847     MOVE X'2020233030303133393639' TO DFHEIV0(25:11)
 14848     CALL 'kxdfhei1' USING DFHEIV0
 14849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14850
 14851     IF MAP-NAME = 'EL156A'
 14852         MOVE -1             TO ENTERPFL
 14853       ELSE
 14854         MOVE LOW-VALUES     TO EL156BI
 14855         MOVE -1             TO ENTPFBL.
 14856
 14857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14858     GO TO 8200-SEND-DATAONLY.
 14859
 14860 5300-EXIT.
 14861     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 284
* EL156.cbl
 14863 5350-FORMAT-LAST-NAME-1ST.
 14864*****************************************************************
 14865*             M O V E   N A M E   R O U T I N E                 *
 14866*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14867*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14868*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14869*                  FIELD                   VALUE                *
 14870*           W-NAME-LAST    (CL15)      SMITH                    *
 14871*           W-NAME-FIRST   (CL15)      JOHN                     *
 14872*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14873*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14874*     CONTAIN                                                   *
 14875*                SMITH, JOHN ALLEN                              *
 14876*     OR                                                        *
 14877*                SMITH, JOHN A.                                 *
 14878*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14879*     COPYBOOK, ELCNWA.                                         *
 14880*****************************************************************.
 14881
 14882     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14883     MOVE ZERO                   TO  WS-NAME-SW.
 14884     SET NWA-INDEX               TO +1.
 14885
 14886     IF W-NAME-LAST   = SPACES AND
 14887        W-NAME-MIDDLE = SPACES
 14888         MOVE +1                 TO WS-NAME-SW.
 14889
 14890     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14891     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14892
 14893     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14894     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14895
 14896     SET NWA-INDEX UP BY +1.
 14897
 14898     IF W-NAME-MIDDLE NOT = SPACES
 14899         IF W-NAME-MIDDLE-2 = SPACES
 14900             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14901             SET NWA-INDEX UP BY +1
 14902             MOVE '.'            TO WS-NW (NWA-INDEX)
 14903             SET NWA-INDEX UP BY +2
 14904         ELSE
 14905             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14906             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14907
 14908 5350-EXIT.
 14909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 285
* EL156.cbl
 14911 5360-MOVE-NAME.
 14912
 14913     IF WS-NAME-SW > +1
 14914         GO TO 5360-EXIT.
 14915
 14916     IF WS-NAME-WORK2 = SPACES
 14917         GO TO 5360-EXIT.
 14918
 14919     SET NWA-INDEX2            TO +1.
 14920     SET NWA-INDEX3            TO +2.
 14921
 14922 5360-MOVE-NAME-CYCLE.
 14923
 14924     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14925
 14926     IF NWA-INDEX < +30
 14927         SET NWA-INDEX UP BY +1
 14928     ELSE
 14929         ADD +2                TO  WS-NAME-SW
 14930         GO TO 5360-EXIT.
 14931
 14932     IF NWA-INDEX2 < +20
 14933         SET NWA-INDEX3 UP BY +1
 14934         SET NWA-INDEX2 UP BY +1.
 14935
 14936     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14937        WS-NW2 (NWA-INDEX3) = SPACES
 14938         IF WS-NAME-SW = ZERO
 14939             MOVE ','            TO  WS-NW (NWA-INDEX)
 14940             SET NWA-INDEX UP BY +2
 14941             MOVE +1             TO  WS-NAME-SW
 14942             GO TO 5360-EXIT
 14943         ELSE
 14944             GO TO 5360-EXIT.
 14945
 14946     GO TO 5360-MOVE-NAME-CYCLE.
 14947
 14948 5360-EXIT.
 14949     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 286
* EL156.cbl
 14951 6000-BUILD-SCREEN-B.
 14952     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14953     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14954     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14955     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14956
 14957     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14958
 14959 6050-BUILD-SCREEN.
 14960     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14961     MOVE LOW-VALUES             TO EL156BI.
 14962     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14963
 14964     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14965
 14966     IF PI-PAYEE-TYPE = 'I'
 14967        GO TO 6060-READ-TRAILER.
 14968
 14969     IF PI-PAYEE-TYPE = 'B'
 14970        ADD +10                  TO TRLR-SEQ-NO
 14971        GO TO 6060-READ-TRAILER.
 14972
 14973     IF PI-PAYEE-TYPE = 'A'
 14974        ADD +20                  TO TRLR-SEQ-NO
 14975        GO TO 6060-READ-TRAILER.
 14976
 14977     IF PI-PAYEE-TYPE = 'O'
 14978        ADD +50                  TO TRLR-SEQ-NO
 14979        GO TO 6060-READ-TRAILER.
 14980
 14981     IF PI-PAYEE-TYPE = 'Q'
 14982        ADD +60                  TO TRLR-SEQ-NO
 14983        GO TO 6060-READ-TRAILER.
 14984
 14985     IF PI-PAYEE-TYPE = 'P'
 14986        ADD +30                  TO TRLR-SEQ-NO
 14987        GO TO 6060-READ-TRAILER.
 14988
 14989     IF PI-PAYEE-TYPE = 'E'
 14990        ADD +40                  TO TRLR-SEQ-NO.
 14991
 14992 6060-READ-TRAILER.
 14993
 14994     IF PI-PAYEE-TYPE    = 'A' AND
 14995        PI-PAYEE-SEQ-NUM = 0
 14996          GO TO 6061-READ-ACCOUNT.
 14997
 14998     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14999        (PI-PAYEE-TYPE    = 'B')             AND
 15000        (PI-PAYEE-SEQ-NUM = 9)
 15001          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15002          IF BENE-FOUND-SW = 'N'
 15003            GO TO 6065-NOT-FOUND
 15004          ELSE
 15005            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15006            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15007            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15008*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 287
* EL156.cbl
 15009            STRING BE-CITY ' ' BE-STATE
 15010               DELIMITED BY '  ' INTO CITYSTBO
 15011            END-STRING
 15012            MOVE BE-ZIP-CODE       TO ZIPBO
 15013            GO TO 6061-READ-ACCOUNT.
 15014
 15015     IF PI-PAYEE-TYPE    = 'B' AND
 15016        PI-PAYEE-SEQ-NUM = 0
 15017          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15018          IF BENE-FOUND-SW = 'N'
 15019            GO TO 6065-NOT-FOUND
 15020          ELSE
 15021            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15022            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15023            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15024*           MOVE BE-CITY-STATE     TO CITYSTBO
 15025            STRING BE-CITY ' ' BE-STATE
 15026               DELIMITED BY '  ' INTO CITYSTBO
 15027            END-STRING
 15028            MOVE BE-ZIP-CODE       TO ZIPBO
 15029            if be-ach-yes-or-no = 'Y'
 15030               move 'Y'          to pi-ach-payment
 15031            else
 15032               move 'N'          to pi-ach-payment
 15033            end-if
 15034            GO TO 6061-READ-ACCOUNT.
 15035
 15036
 15037* EXEC CICS HANDLE CONDITION
 15038*         NOTFND(6065-NOT-FOUND)
 15039*     END-EXEC.
 15040*    MOVE '"$I                   ! / #00014155' TO DFHEIV0
 15041     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15043     MOVE X'2F20233030303134313535' TO DFHEIV0(25:11)
 15044     CALL 'kxdfhei1' USING DFHEIV0
 15045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15046
 15047
 15048     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15049
 15050     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15051     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15052     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15053     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15054*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15055     STRING AT-CITY ' ' AT-STATE
 15056        DELIMITED BY '  ' INTO CITYSTBO
 15057     END-STRING
 15058     MOVE AT-ZIP-CODE            TO ZIPBO.
 15059
 15060 6061-READ-ACCOUNT.
 15061
 15062* EXEC CICS HANDLE CONDITION
 15063*         NOTFND(6068-ACCT-NOT-FND)
 15064*     END-EXEC.
 15065*    MOVE '"$I                   ! 0 #00014172' TO DFHEIV0
 15066     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 288
* EL156.cbl
 15067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15068     MOVE X'3020233030303134313732' TO DFHEIV0(25:11)
 15069     CALL 'kxdfhei1' USING DFHEIV0
 15070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15071
 15072
 15073
 15074* EXEC CICS READ
 15075*         DATASET('ERACCT')
 15076*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15077*         RIDFLD (PI-ACCT-KEY)
 15078*     END-EXEC.
 15079     MOVE 'ERACCT' TO DFHEIV1
 15080*    MOVE '&"S        E          (   #00014176' TO DFHEIV0
 15081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15083     MOVE X'2020233030303134313736' TO DFHEIV0(25:11)
 15084     CALL 'kxdfhei1' USING DFHEIV0,
 15085           DFHEIV1,
 15086           DFHEIV20,
 15087           DFHEIV99,
 15088           PI-ACCT-KEY,
 15089           DFHEIV99,
 15090           DFHEIV99,
 15091           DFHEIV99
 15092     SET ADDRESS OF ACCOUNT-MASTER TO
 15093         DFHEIV20
 15094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15095
 15096
 15097     MOVE AM-CARRIER             TO ACARRBO.
 15098     MOVE AM-GROUPING            TO GROUPBO.
 15099     MOVE AM-STATE               TO STATEBO.
 15100     MOVE AM-ACCOUNT             TO ACCTBO.
 15101     MOVE AM-NAME                TO ACCTNMBO.
 15102
 15103     IF PI-PAYEE-TYPE = 'A' AND
 15104        PI-PAYEE-SEQ-NUM = 0
 15105          MOVE AM-NAME             TO NAMEBO
 15106                                      PI-PAYEE-NAME
 15107          MOVE AM-ADDRS            TO ADDR1BO
 15108          MOVE SPACES              TO ADDR2BO
 15109*         MOVE AM-CITY             TO CITYSTBO
 15110          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15111             DELIMITED BY '  ' INTO CITYSTBO
 15112          END-STRING
 15113          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15114          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15115          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15116          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15117
 15118***  We don't really need the code below because we don't do the
 15119***  AK thing anymore.  However, we may have a state special
 15120***  of some sort in the future so why not just leave it??
 15121     IF CITYSTBO EQUAL SPACES
 15122         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15123         GO TO 6070-FORMAT-DATA
 15124     END-IF.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 289
* EL156.cbl
 15125
 15126     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15127     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15128     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15129     PERFORM VARYING WS-SUB FROM 30 BY -1
 15130          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15131        IF WS-END-SUB = 0  AND
 15132           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15133              OR LOW-VALUES  OR '.')
 15134            CONTINUE
 15135        ELSE
 15136            IF WS-END-SUB = 0
 15137                MOVE WS-SUB TO WS-END-SUB
 15138            ELSE
 15139                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15140                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15141                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15142                END-IF
 15143            END-IF
 15144        END-IF
 15145        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15146            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15147            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15148        END-IF
 15149     END-PERFORM.
 15150
 15151     IF WS-BEG-SUB > 0
 15152         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15153         IF WS-STATE-LENGTH = 2
 15154             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15155                  TO PI-CHECK-STATE-FOR-AK
 15156         ELSE
 15157             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15158                'ALASKA'
 15159                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15160             ELSE
 15161                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15162             END-IF
 15163         END-IF
 15164     ELSE
 15165         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15166     END-IF.
 15167
 15168     GO TO 6070-FORMAT-DATA.
 15169
 15170 6065-NOT-FOUND.
 15171     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15172     GO TO 6061-READ-ACCOUNT.
 15173
 15174 6068-ACCT-NOT-FND.
 15175     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15176
 15177 6070-FORMAT-DATA.
 15178     IF PI-HOLDTIL = ZEROS
 15179        MOVE SAVE-DATE           TO PAYDTBI
 15180       ELSE
 15181        MOVE PI-HOLDTIL          TO PAYDTBO
 15182        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 290
* EL156.cbl
 15183
 15184     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15185     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15186
 15187     IF EIBAID = DFHPF3 OR DFHPF4
 15188        NEXT SENTENCE
 15189     ELSE
 15190       GO TO 6071-CONTINUE.
 15191
 15192     MOVE PI-EPYFROM          TO PYFROMBO.
 15193     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15194
 15195     IF NOT PI-USES-PAID-TO
 15196        MOVE PI-EPYTHRU          TO PYTHRUBO
 15197        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15198     ELSE
 15199        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15200        MOVE '4'              TO DC-OPTION-CODE
 15201        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15202        IF NO-CONVERSION-ERROR
 15203           MOVE +1            TO DC-ELAPSED-DAYS
 15204           MOVE +0            TO DC-ELAPSED-MONTHS
 15205           MOVE '6'           TO DC-OPTION-CODE
 15206           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15207           IF NO-CONVERSION-ERROR
 15208              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15209
 15210     MOVE PI-EDAYS            TO DAYSBO.
 15211     MOVE PI-EPYAMT           TO PAYAMTBO.
 15212     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15213        IF PI-INT-AMT > ZEROS
 15214           MOVE PI-INT-AMT       TO INTAMTBO
 15215        END-IF
 15216     END-IF
 15217     GO TO 6072-SET-TYPE.
 15218
 15219 6071-CONTINUE.
 15220
 15221     IF PI-CPYFROM NOT = LOW-VALUES
 15222        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15223        MOVE SPACES              TO DC-OPTION-CODE
 15224        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15225        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15226
 15227     IF PI-CPYTHRU NOT = LOW-VALUES
 15228        IF NOT PI-USES-PAID-TO
 15229           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15230           MOVE SPACES             TO DC-OPTION-CODE
 15231           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15232           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15233        ELSE
 15234           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15235           MOVE '6'                TO DC-OPTION-CODE
 15236           MOVE +1                 TO DC-ELAPSED-DAYS
 15237           MOVE +0                 TO DC-ELAPSED-MONTHS
 15238           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15239           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15240
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 291
* EL156.cbl
 15241     MOVE PI-CDAYS               TO DAYSBO.
 15242     MOVE PI-CPYAMT              TO PAYAMTBO.
 15243     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15244        IF PI-INT-AMT > ZEROS
 15245           MOVE PI-INT-AMT       TO INTAMTBO
 15246        END-IF
 15247     END-IF
 15248     .
 15249 6072-SET-TYPE.
 15250     IF PI-PMTTYPE = '1'
 15251        MOVE 'PARTIAL'           TO PAYTYPBO.
 15252
 15253     IF PI-PMTTYPE = '2'
 15254        MOVE 'FINAL'             TO PAYTYPBO.
 15255
 15256     IF PI-PMTTYPE = '3'
 15257        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15258
 15259     IF PI-PMTTYPE = '4'
 15260        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15261
 15262     IF PI-PMTTYPE = '5'
 15263        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15264
 15265     IF PI-PMTTYPE = '6'
 15266        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15267
 15268     IF PI-PROV-PMT
 15269        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15270
 15271     IF PI-ECHECKNO NOT = SPACES
 15272        MOVE PI-ECHECKNO         TO CKNUMBO
 15273     ELSE
 15274        MOVE PI-CCHECKNO         TO CKNUMBO.
 15275
 15276     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15277        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15278        MOVE +91                 TO  TRLR-SEQ-NO
 15279
 15280* EXEC CICS READ
 15281*           DATASET  ('ELTRLR')
 15282*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15283*           RIDFLD   (ELTRLR-KEY)
 15284*           RESP     (WS-RESPONSE)
 15285*       END-EXEC
 15286     MOVE 'ELTRLR' TO DFHEIV1
 15287*    MOVE '&"S        E          (  N#00014364' TO DFHEIV0
 15288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15290     MOVE X'204E233030303134333634' TO DFHEIV0(25:11)
 15291     CALL 'kxdfhei1' USING DFHEIV0,
 15292           DFHEIV1,
 15293           DFHEIV20,
 15294           DFHEIV99,
 15295           ELTRLR-KEY,
 15296           DFHEIV99,
 15297           DFHEIV99,
 15298           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 292
* EL156.cbl
 15299     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15300         DFHEIV20
 15301     MOVE EIBRESP  TO WS-RESPONSE
 15302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15303
 15304        IF WS-RESP-NORMAL
 15305           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15306        ELSE
 15307           MOVE SPACES           TO  LOANNBO
 15308        END-IF
 15309     END-IF
 15310
 15311*       MOVE PI-LOAN-NO          TO LOANNBO
 15312
 15313     IF CKNUMBO = SPACES
 15314         MOVE SPACES             TO CKNUMHDO.
 15315
 15316     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15317     MOVE CL-CARRIER             TO CARRBO.
 15318     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15319     MOVE CL-CERT-SFX            TO SUFXBO.
 15320
 15321     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15322        EVALUATE CL-CLAIM-TYPE
 15323           WHEN 'I'
 15324              MOVE '  IU  '      TO CLMTYPBO
 15325           WHEN 'G'
 15326              MOVE ' GAP  '      TO CLMTYPBO
 15327           WHEN 'F'
 15328              MOVE ' FMLA '      TO CLMTYPBO
 15329           WHEN OTHER
 15330              MOVE PI-AH-OVERRIDE-L6
 15331                                 TO CLMTYPBO
 15332        END-EVALUATE
 15333        MOVE ZEROS               TO UNDISBO
 15334*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15335        IF PI-PMTTYPE = '5' OR '6'
 15336           GO TO 6073-GET-NOTIFY-DATA
 15337        ELSE
 15338           MOVE PI-DAILY-RATE    TO RATEBO
 15339           GO TO 6073-GET-NOTIFY-DATA.
 15340
 15341     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15342
 15343     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15344        MOVE ZEROS               TO UNDISBO
 15345     ELSE
 15346        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15347
 15348 6073-GET-NOTIFY-DATA.
 15349
 15350     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15351
 15352     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15353         MOVE SPACES             TO  NAMEB2O
 15354                                     ADDR1B2O
 15355                                     ADDR2B2O
 15356                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 293
* EL156.cbl
 15357                                     AGTHDGO
 15358         MOVE ZEROS              TO  ZIPB2O
 15359         GO TO 6080-SET-INCURRED.
 15360
 15361     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15362     MOVE +29                    TO  TRLR-SEQ-NO.
 15363
 15364
 15365* EXEC CICS HANDLE CONDITION
 15366*        NOTFND   (6074-GET-COMP-DATA)
 15367*    END-EXEC.
 15368*    MOVE '"$I                   ! 1 #00014431' TO DFHEIV0
 15369     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15371     MOVE X'3120233030303134343331' TO DFHEIV0(25:11)
 15372     CALL 'kxdfhei1' USING DFHEIV0
 15373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15374
 15375
 15376     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15377
 15378     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15379     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15380     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15381*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15382     STRING AT-CITY ' ' AT-STATE
 15383        DELIMITED BY '  ' INTO CITYST2O
 15384     END-STRING
 15385     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15386     GO TO 6080-SET-INCURRED.
 15387
 15388 6074-GET-COMP-DATA.
 15389
 15390     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15391         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15392
 15393     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15394         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15395                                         ADDR1B2O
 15396                                         ADDR2B2O
 15397                                         CITYST2O
 15398         MOVE ZEROS                  TO  ZIPB2O
 15399         GO TO 6080-SET-INCURRED.
 15400
 15401     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15402     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15403     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15404     MOVE AM-GROUPING            TO  COMP-GROUP.
 15405     MOVE 'A'                    TO  COMP-TYPE.
 15406     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15407                                 TO  COMP-FIN-RESP.
 15408
 15409     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15410         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15411                                       'G' OR 'B' or 'S'
 15412             MOVE 'G'            TO  COMP-TYPE
 15413             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15414         ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 294
* EL156.cbl
 15415             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15416                                 TO  COMP-ACCOUNT
 15417     ELSE
 15418         MOVE 'G'                TO  COMP-TYPE
 15419         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15420
 15421     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15422
 15423     IF COMP-REC-FOUND
 15424         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15425         MOVE CO-ADDR-1          TO  ADDR1B2O
 15426         MOVE CO-ADDR-2          TO  ADDR2B2O
 15427*        MOVE CO-ADDR-3          TO  CITYST2O
 15428         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15429            DELIMITED BY '  ' INTO CITYST2O
 15430         END-STRING
 15431         MOVE CO-ZIP             TO  ZIPB2O
 15432     ELSE
 15433         MOVE 'NO COMP ADDRESS AVAILABLE'
 15434                                 TO  NAMEB2O
 15435                                     ADDR1B2O
 15436                                     ADDR2B2O
 15437                                     CITYST2O
 15438         MOVE ZEROS               TO ZIPB2O.
 15439
 15440 6080-SET-INCURRED.
 15441     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15442     MOVE SPACES                 TO DC-OPTION-CODE.
 15443     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15444     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15445     MOVE PI-PROCESSOR-ID        TO BYBO.
 15446     MOVE MAP-NAMEB              TO MAP-NAME.
 15447     MOVE 'C'                    TO PI-PASS-SW.
 15448     MOVE EIBAID                 TO PI-PFKEY-USED.
 15449     MOVE -1                     TO ENTPFBL.
 15450     GO TO 8100-SEND-INITIAL-MAP.
 15451
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 295
* EL156.cbl
 15453 6100-BUILD-PAYMENT-TRAILER.
 15454
 15455     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15456     MOVE '6'                    TO CNTL-REC-TYPE.
 15457
 15458     IF CONTROL-IS-ACTUAL-CARRIER
 15459         MOVE PI-CARRIER         TO WS-CARR
 15460     ELSE
 15461         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15462
 15463     IF PI-COMPANY-ID = 'FIA'
 15464         MOVE PI-CARRIER         TO  WS-CARR.
 15465
 15466     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15467     MOVE 0                      TO CNTL-SEQ-NO.
 15468     MOVE 'CARR'                 TO FILE-SWITCH.
 15469
 15470     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15471
 15472     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15473         IF PI-OFFLINE     = 'Y' AND
 15474            PI-ECHECKNO-CR = 'CR'
 15475              GO TO 6110-READ-CONTROL
 15476         ELSE
 15477            IF PI-CASH = 'N'
 15478                GO TO 6110-READ-CONTROL.
 15479
 15480     IF CHECK-NO-MANUAL    OR
 15481        CHECK-NO-AT-PRINT  OR
 15482        PI-OFFLINE = 'Y'
 15483          GO TO 6130-BUILD-TRAILER.
 15484     IF PI-COMPANY-ID = 'FIA'
 15485         NEXT SENTENCE
 15486     ELSE
 15487         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15488             GO TO 6110-READ-CONTROL.
 15489
 15490     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15491
 15492     IF CHECK-CNT-RESET-VALUE
 15493        MOVE +1                  TO CF-CHECK-COUNTER
 15494     ELSE
 15495        ADD +1                   TO CF-CHECK-COUNTER.
 15496
 15497     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15498
 15499     IF CHECK-NO-CARR-SEQ
 15500        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15501
 15502     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15503
 15504     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15505     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15506        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15507         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15508         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15509            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15510         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 296
* EL156.cbl
 15511                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15512     END-IF.
 15513
 15514     GO TO 6120-REWRITE.
 15515
 15516 6105-STATE-CHECK-NUMBER.
 15517     IF CHECK-NO-MANUAL    OR
 15518        CHECK-NO-AT-PRINT  OR
 15519        PI-OFFLINE = 'Y'
 15520           GO TO 6130-BUILD-TRAILER
 15521     END-IF.
 15522
 15523     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15524     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15525     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15526     MOVE '3'                TO CNTL-REC-TYPE.
 15527     MOVE +0                 TO CNTL-SEQ-NO.
 15528     MOVE 'STAT'             TO FILE-SWITCH.
 15529     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15530
 15531     IF CF-ST-CHECK-CNT-RESET
 15532         MOVE +1             TO CF-ST-CHECK-COUNTER
 15533     ELSE
 15534         ADD +1              TO CF-ST-CHECK-COUNTER
 15535     END-IF.
 15536
 15537     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15538     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15539     GO TO 6120-REWRITE.
 15540
 15541 6110-READ-CONTROL.
 15542     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15543     MOVE '1'                    TO CNTL-REC-TYPE.
 15544     MOVE SPACES                 TO CNTL-ACCESS.
 15545     MOVE 0                      TO CNTL-SEQ-NO.
 15546
 15547     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15548
 15549     IF CO-CHECK-COUNT-RESET
 15550        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15551     ELSE
 15552        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15553
 15554     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15555
 15556     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15557         IF PI-OFFLINE     = 'Y'  AND
 15558            PI-ECHECKNO-CR = 'CR'
 15559              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15560              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15561              MOVE AL-UANON           TO CHECKNOA
 15562              GO TO 6120-REWRITE
 15563         ELSE
 15564         IF PI-CASH = 'N'
 15565             MOVE 'N'                TO PI-ECHECKNO-N
 15566             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15567             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15568             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 297
* EL156.cbl
 15569             GO TO 6120-REWRITE.
 15570
 15571     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15572
 15573 6120-REWRITE.
 15574
 15575* EXEC CICS REWRITE
 15576*         DATASET('ELCNTL')
 15577*         FROM(CONTROL-FILE)
 15578*     END-EXEC.
 15579     MOVE LENGTH OF
 15580      CONTROL-FILE
 15581       TO DFHEIV11
 15582     MOVE 'ELCNTL' TO DFHEIV1
 15583*    MOVE '&& L                  %   #00014633' TO DFHEIV0
 15584     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15585     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15586     MOVE X'2020233030303134363333' TO DFHEIV0(25:11)
 15587     CALL 'kxdfhei1' USING DFHEIV0,
 15588           DFHEIV1,
 15589           CONTROL-FILE,
 15590           DFHEIV11,
 15591           DFHEIV99
 15592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15593
 15594
 15595     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15596
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 298
* EL156.cbl
 15598 6130-BUILD-TRAILER.
 15599
 15600
 15601* EXEC CICS GETMAIN
 15602*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15603*         LENGTH    (200)
 15604*         INITIMG   (GETMAIN-SPACE)
 15605*     END-EXEC.
 15606     MOVE 200
 15607       TO DFHEIV11
 15608*    MOVE ',"IL                  $   #00014643' TO DFHEIV0
 15609     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15610     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15611     MOVE X'2020233030303134363433' TO DFHEIV0(25:11)
 15612     CALL 'kxdfhei1' USING DFHEIV0,
 15613           DFHEIV20,
 15614           DFHEIV11,
 15615           GETMAIN-SPACE
 15616     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15617         DFHEIV20
 15618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15619
 15620
 15621     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15622                                    AT-PREV-PAID-THRU-DT.
 15623     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15624     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15625     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15626     MOVE 'AT'                   TO AT-RECORD-ID.
 15627     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15628
 15629     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15630        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15631           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15632     ELSE
 15633           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15634           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15635
 15636     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15637         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15638             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15639             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15640           ELSE
 15641             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15642             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15643
 15644     MOVE '2'                    TO AT-TRAILER-TYPE.
 15645     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15646                                    AT-PAYMENT-LAST-MAINT-DT.
 15647     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15648                                    AT-PAYMENT-LAST-UPDATED-BY.
 15649     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15650     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15651     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15652     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15653
 15654     IF PI-PMT-APPROVED
 15655        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 299
* EL156.cbl
 15656           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15657
 15658     IF PI-PFKEY-USED = DFHPF5
 15659        GO TO 6140-PF5-ENTERED.
 15660
 15661     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15662     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15663
 15664     IF PI-AIG-SPECIAL-BENEFIT
 15665         IF WS-1ST-SPECIAL-PMT
 15666             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15667             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15668                                        AT-AMOUNT-PAID
 15669         ELSE
 15670             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15671
 15672     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15673
 15674     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15675     MOVE '4'                    TO DC-OPTION-CODE.
 15676     PERFORM 9700-LINK-DATE-CONVERT.
 15677
 15678     IF DATE-CONVERSION-ERROR
 15679        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15680     ELSE
 15681        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15682
 15683     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15684     MOVE '4'                    TO DC-OPTION-CODE.
 15685     PERFORM 9700-LINK-DATE-CONVERT.
 15686
 15687     IF DATE-CONVERSION-ERROR
 15688        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15689     ELSE
 15690        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15691
 15692     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15693     move pi-ach-payment         to at-ach-payment
 15694     GO TO 6150-FINISH-MOVE.
 15695
 15696 6140-PF5-ENTERED.
 15697     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15698     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15699
 15700     IF PI-AIG-SPECIAL-BENEFIT
 15701         IF WS-1ST-SPECIAL-PMT
 15702             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15703             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15704                                        AT-AMOUNT-PAID
 15705         ELSE
 15706             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15707
 15708     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15709     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15710     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15711
 15712 6150-FINISH-MOVE.
 15713
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 300
* EL156.cbl
 15714     IF PI-ECHECKNO = SPACES
 15715         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15716     ELSE
 15717         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15718
 15719     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15720     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15721
 15722*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15723*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15724
 15725     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15726         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15727
 15728     IF PI-OFFLINE = 'N'
 15729        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15730        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15731     ELSE
 15732        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15733        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15734
 15735     move pi-ach-payment         to at-ach-payment
 15736     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15737
 15738     IF WS-2ND-SPECIAL-PMT
 15739         MOVE 'Y'                TO AT-CASH-PAYMENT
 15740         MOVE SPACES             TO AT-CHECK-NO
 15741         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15742         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15743         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15744         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15745
 15746     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15747                                    AT-TO-BE-WRITTEN-DT.
 15748
 15749     IF PI-HOLDTIL NOT = ZEROS
 15750        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15751        MOVE '4'                 TO DC-OPTION-CODE
 15752        PERFORM 9700-LINK-DATE-CONVERT
 15753        IF PI-OFFLINE = 'N'
 15754           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15755        ELSE
 15756           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15757
 15758     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15759     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15760                                    AT-CHECK-QUE-SEQUENCE.
 15761
 15762     IF PI-PFKEY-USED = DFHPF4
 15763        MOVE '1'                 TO AT-FORCE-CONTROL.
 15764
 15765     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15766        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15767        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15768        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15769
 15770     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15771                                    AT-VOID-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 301
* EL156.cbl
 15772                                    AT-VOID-ACCEPT-DT
 15773                                    AT-VOID-DT.
 15774     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15775        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15776        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15777        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15778        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15779     ELSE
 15780        MOVE ZEROS               TO AT-DAILY-RATE
 15781                                    AT-ELIMINATION-DAYS
 15782        MOVE SPACES              TO AT-BENEFIT-TYPE
 15783     END-IF
 15784     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15785     MOVE '4'                    TO DC-OPTION-CODE.
 15786     PERFORM 9700-LINK-DATE-CONVERT.
 15787     IF DATE-CONVERSION-ERROR
 15788         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15789     ELSE
 15790         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15791     END-IF.
 15792     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15793     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15794     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15795     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15796     IF (PI-REAUDIT-NEEDED = 'Y')
 15797        or (pi-max-ext-used = 'Y')
 15798        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15799         PERFORM 6155-READ-CONTROL
 15800         PERFORM 6157-SET-APP-LEVEL
 15801         IF AT-APPROVAL-LEVEL-REQD < '4'
 15802            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15803         END-IF
 15804         MOVE 'Y' TO WS-NEED-APPROVAL
 15805         GO TO 6170-WRITE
 15806     END-IF.
 15807*******************************************************
 15808     IF NOT PI-PMT-GRADUATED
 15809         GO TO 6170-WRITE.
 15810     PERFORM 6155-READ-CONTROL.
 15811
 15812     IF PAID-FOR-LIFE
 15813         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15814             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15815                                     WS-PMT-APPROVAL-SW
 15816             GO TO 6170-WRITE.
 15817
 15818*05999      IF PAID-FOR-AH
 15819     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15820         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15821             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15822                                     WS-PMT-APPROVAL-SW
 15823             GO TO 6170-WRITE.
 15824
 15825     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15826
 15827     PERFORM 6157-SET-APP-LEVEL.
 15828
 15829     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 302
* EL156.cbl
 15830
 15831     IF NOT PI-PMT-GRADUATED
 15832         GO TO 6170-WRITE.
 15833
 15834
 15835* EXEC CICS HANDLE CONDITION
 15836*        NOTFND   (6170-WRITE)
 15837*    END-EXEC.
 15838*    MOVE '"$I                   ! 2 #00014862' TO DFHEIV0
 15839     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15841     MOVE X'3220233030303134383632' TO DFHEIV0(25:11)
 15842     CALL 'kxdfhei1' USING DFHEIV0
 15843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15844
 15845
 15846     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15847     MOVE '2'                    TO CNTL-REC-TYPE.
 15848     MOVE +0                     TO CNTL-SEQ-NO.
 15849     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15850
 15851
 15852* EXEC CICS READ
 15853*         DATASET  ('ELCNTL')
 15854*         SET      (ADDRESS OF CONTROL-FILE)
 15855*         RIDFLD   (ELCNTL-KEY)
 15856*    END-EXEC.
 15857     MOVE 'ELCNTL' TO DFHEIV1
 15858*    MOVE '&"S        E          (   #00014871' TO DFHEIV0
 15859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15861     MOVE X'2020233030303134383731' TO DFHEIV0(25:11)
 15862     CALL 'kxdfhei1' USING DFHEIV0,
 15863           DFHEIV1,
 15864           DFHEIV20,
 15865           DFHEIV99,
 15866           ELCNTL-KEY,
 15867           DFHEIV99,
 15868           DFHEIV99,
 15869           DFHEIV99
 15870     SET ADDRESS OF CONTROL-FILE TO
 15871         DFHEIV20
 15872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15873
 15874
 15875     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15876
 15877     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15878                         OR '4' OR '5'
 15879         NEXT SENTENCE
 15880     ELSE
 15881         MOVE 'Y' TO WS-NEED-APPROVAL
 15882         GO TO 6170-WRITE.
 15883
 15884     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15885         MOVE 'Y' TO WS-NEED-APPROVAL
 15886         IF WS-APPROVAL-LEVEL = '1'
 15887             MOVE '2'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 303
* EL156.cbl
 15888                            WS-SAVE-APPROVED-LEVEL
 15889             GO TO 6170-WRITE
 15890         ELSE
 15891             IF WS-APPROVAL-LEVEL = '2'
 15892                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15893                                WS-SAVE-APPROVED-LEVEL
 15894                 GO TO 6170-WRITE
 15895             ELSE IF WS-APPROVAL-LEVEL = '3'
 15896                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15897                                WS-SAVE-APPROVED-LEVEL
 15898                 GO TO 6170-WRITE
 15899             ELSE IF WS-APPROVAL-LEVEL = '4'
 15900                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15901                                WS-SAVE-APPROVED-LEVEL
 15902                 GO TO 6170-WRITE.
 15903
 15904     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15905                             WS-PMT-APPROVAL-SW.
 15906     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15907                             AT-APPROVAL-LEVEL-REQD.
 15908
 15909*******************************************************
 15910 6155-READ-CONTROL.
 15911     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15912     MOVE '1'                    TO CNTL-REC-TYPE.
 15913     MOVE SPACES                 TO CNTL-ACCESS.
 15914     MOVE +0                     TO CNTL-SEQ-NO.
 15915     MOVE 'COMP'                 TO FILE-SWITCH.
 15916
 15917     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15918 6157-SET-APP-LEVEL.
 15919******A&H Limits are set as a monthly payment.  Calculate the mont
 15920******equivalent of the amount paid today
 15921     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15922        PI-SAVE-ODD-DAYS-OVER > 0
 15923           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15924                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15925           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15926                                  WS-CALC-PMT-MONTHS
 15927     ELSE
 15928           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15929     END-IF.
 15930*06007      IF ((PAID-FOR-AH) AND
 15931     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15932*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15933        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15934              OR
 15935        ((PAID-FOR-LIFE) AND
 15936        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15937            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15938       ELSE
 15939*06014      IF ((PAID-FOR-AH)  AND
 15940         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15941*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15942           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15943              OR
 15944        ((PAID-FOR-LIFE) AND
 15945        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 304
* EL156.cbl
 15946            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15947         ELSE
 15948*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15949           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15950               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15951              OR
 15952          ((PAID-FOR-LIFE) AND
 15953          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15954            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15955       ELSE
 15956           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15957               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15958              OR
 15959          ((PAID-FOR-LIFE) AND
 15960          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15961            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15962       ELSE
 15963            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15964
 15965     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15966        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15967        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15968            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15969        END-IF
 15970     ELSE
 15971     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15972        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15973        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15974            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15975        END-IF
 15976     ELSE
 15977     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15978        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15979        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15980            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15981        END-IF
 15982     ELSE
 15983     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15984        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15985        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15986            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15987        END-IF
 15988     ELSE
 15989     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15990            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15991
 15992 6170-WRITE.
 15993
 15994     if pi-company-id = 'DCC' or 'CAP'
 15995        PERFORM 0900-GET-DDF-limits
 15996                                 THRU 0900-EXIT
 15997     end-if
 15998     perform 2220-update-elcrtt  thru 2220-exit
 15999     IF PI-COMPANY-ID = 'DMD'
 16000        IF PI-AT-EOB-CODES NOT = SPACES
 16001           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16002           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16003           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 305
* EL156.cbl
 16004           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16005           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16006
 16007
 16008* EXEC CICS HANDLE CONDITION
 16009*        DUPREC    (6180-DUPREC)
 16010*    END-EXEC.
 16011*    MOVE '"$%                   ! 3 #00015009' TO DFHEIV0
 16012     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16014     MOVE X'3320233030303135303039' TO DFHEIV0(25:11)
 16015     CALL 'kxdfhei1' USING DFHEIV0
 16016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16017
 16018
 16019
 16020* EXEC CICS WRITE
 16021*         DATASET       ('ELTRLR')
 16022*         FROM          (ACTIVITY-TRAILERS)
 16023*         RIDFLD        (AT-CONTROL-PRIMARY)
 16024*     END-EXEC.
 16025     MOVE LENGTH OF
 16026      ACTIVITY-TRAILERS
 16027       TO DFHEIV11
 16028     MOVE 'ELTRLR' TO DFHEIV1
 16029*    MOVE '&$ L                  ''   #00015013' TO DFHEIV0
 16030     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16031     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16032     MOVE X'2020233030303135303133' TO DFHEIV0(25:11)
 16033     CALL 'kxdfhei1' USING DFHEIV0,
 16034           DFHEIV1,
 16035           ACTIVITY-TRAILERS,
 16036           DFHEIV11,
 16037           AT-CONTROL-PRIMARY,
 16038           DFHEIV99,
 16039           DFHEIV99
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16044        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16045*06088           GO TO 6199-EXIT.
 16046           GO TO 6176-APPROVAL-NOTE.
 16047
 16048
 16049* EXEC CICS GETMAIN
 16050*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16051*         LENGTH    (200)
 16052*         INITIMG   (GETMAIN-SPACE)
 16053*     END-EXEC.
 16054     MOVE 200
 16055       TO DFHEIV11
 16056*    MOVE ',"IL                  $   #00015024' TO DFHEIV0
 16057     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16058     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16059     MOVE X'2020233030303135303234' TO DFHEIV0(25:11)
 16060     CALL 'kxdfhei1' USING DFHEIV0,
 16061           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 306
* EL156.cbl
 16062           DFHEIV11,
 16063           GETMAIN-SPACE
 16064     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16065         DFHEIV20
 16066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16067
 16068
 16069     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16070
 16071     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16072     MOVE 'AT'                   TO AT-RECORD-ID.
 16073     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16074     MOVE '6'                    TO AT-TRAILER-TYPE.
 16075     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16076                                    AT-GEN-INFO-LAST-MAINT-DT
 16077     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16078                                    AT-GEN-INFO-LAST-UPDATED-BY
 16079     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16080
 16081     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16082     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16083     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16084
 16085     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16086
 16087 6175-WRITE.
 16088
 16089
 16090* EXEC CICS HANDLE CONDITION
 16091*        DUPREC    (6190-DUPREC)
 16092*    END-EXEC.
 16093*    MOVE '"$%                   ! 4 #00015050' TO DFHEIV0
 16094     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16096     MOVE X'3420233030303135303530' TO DFHEIV0(25:11)
 16097     CALL 'kxdfhei1' USING DFHEIV0
 16098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16099
 16100
 16101
 16102* EXEC CICS WRITE
 16103*         DATASET     ('ELTRLR')
 16104*         FROM        (ACTIVITY-TRAILERS)
 16105*         RIDFLD      (AT-CONTROL-PRIMARY)
 16106*     END-EXEC.
 16107     MOVE LENGTH OF
 16108      ACTIVITY-TRAILERS
 16109       TO DFHEIV11
 16110     MOVE 'ELTRLR' TO DFHEIV1
 16111*    MOVE '&$ L                  ''   #00015054' TO DFHEIV0
 16112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16114     MOVE X'2020233030303135303534' TO DFHEIV0(25:11)
 16115     CALL 'kxdfhei1' USING DFHEIV0,
 16116           DFHEIV1,
 16117           ACTIVITY-TRAILERS,
 16118           DFHEIV11,
 16119           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 307
* EL156.cbl
 16120           DFHEIV99,
 16121           DFHEIV99
 16122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16123
 16124
 16125 6176-APPROVAL-NOTE.
 16126
 16127     IF NOT APPROVAL-NEEDED
 16128         GO TO 6199-EXIT.
 16129
 16130
 16131* EXEC CICS GETMAIN
 16132*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16133*        LENGTH    (200)
 16134*        INITIMG   (GETMAIN-SPACE)
 16135*    END-EXEC.
 16136     MOVE 200
 16137       TO DFHEIV11
 16138*    MOVE ',"IL                  $   #00015065' TO DFHEIV0
 16139     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16140     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16141     MOVE X'2020233030303135303635' TO DFHEIV0(25:11)
 16142     CALL 'kxdfhei1' USING DFHEIV0,
 16143           DFHEIV20,
 16144           DFHEIV11,
 16145           GETMAIN-SPACE
 16146     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16147         DFHEIV20
 16148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16149
 16150
 16151     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16152
 16153     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16154     MOVE 'AT'               TO AT-RECORD-ID
 16155     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16156     MOVE '6'                TO AT-TRAILER-TYPE
 16157     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16158                                AT-GEN-INFO-LAST-MAINT-DT
 16159     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16160                                AT-GEN-INFO-LAST-UPDATED-BY
 16161     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16162
 16163     IF PI-REAUDIT-NEEDED = 'Y'
 16164         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16165     ELSE
 16166         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16167     END-IF
 16168     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16169         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16170     END-IF
 16171     MOVE SPACES             TO AT-INFO-LINE-2
 16172
 16173     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16174 6177-WRITE.
 16175
 16176
 16177* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 308
* EL156.cbl
 16178*        DUPREC    (6185-DUPREC)
 16179*    END-EXEC.
 16180*    MOVE '"$%                   ! 5 #00015096' TO DFHEIV0
 16181     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16183     MOVE X'3520233030303135303936' TO DFHEIV0(25:11)
 16184     CALL 'kxdfhei1' USING DFHEIV0
 16185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16186
 16187
 16188
 16189* EXEC CICS WRITE
 16190*         DATASET     ('ELTRLR')
 16191*         FROM        (ACTIVITY-TRAILERS)
 16192*         RIDFLD      (AT-CONTROL-PRIMARY)
 16193*     END-EXEC.
 16194     MOVE LENGTH OF
 16195      ACTIVITY-TRAILERS
 16196       TO DFHEIV11
 16197     MOVE 'ELTRLR' TO DFHEIV1
 16198*    MOVE '&$ L                  ''   #00015100' TO DFHEIV0
 16199     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16201     MOVE X'2020233030303135313030' TO DFHEIV0(25:11)
 16202     CALL 'kxdfhei1' USING DFHEIV0,
 16203           DFHEIV1,
 16204           ACTIVITY-TRAILERS,
 16205           DFHEIV11,
 16206           AT-CONTROL-PRIMARY,
 16207           DFHEIV99,
 16208           DFHEIV99
 16209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16210
 16211
 16212
 16213     GO TO 6199-EXIT.
 16214
 16215 6180-DUPREC.
 16216
 16217     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16218     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16219     GO TO 6170-WRITE.
 16220
 16221 6185-DUPREC.
 16222     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16223     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16224     GO TO 6177-WRITE.
 16225
 16226 6190-DUPREC.
 16227     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16228     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16229     GO TO 6175-WRITE.
 16230
 16231 6199-EXIT.
 16232      EXIT.
 16233
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 309
* EL156.cbl
 16235 6200-UPDATE-CLAIM-MSTR.
 16236     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16237     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16238     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16239     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16240
 16241     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16242
 16243     MOVE ZEROS                  TO W-INTEREST.
 16244
 16245     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16246        IF (PI-OFFLINE = 'Y') OR
 16247           (PI-PMTTYPE = '7')
 16248           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16249                                 THRU 9870-EXIT
 16250        END-IF
 16251     END-IF
 16252     IF NOT ERROR-ON-OUTPUT
 16253        CONTINUE
 16254     ELSE
 16255
 16256* EXEC CICS REWRITE
 16257*          DATASET('ELMSTR')
 16258*          FROM(CLAIM-MASTER)
 16259*       END-EXEC
 16260     MOVE LENGTH OF
 16261      CLAIM-MASTER
 16262       TO DFHEIV11
 16263     MOVE 'ELMSTR' TO DFHEIV1
 16264*    MOVE '&& L                  %   #00015149' TO DFHEIV0
 16265     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16267     MOVE X'2020233030303135313439' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0,
 16269           DFHEIV1,
 16270           CLAIM-MASTER,
 16271           DFHEIV11,
 16272           DFHEIV99
 16273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16274
 16275        MOVE -1                  TO ENTPFBL
 16276        MOVE AL-UANON            TO ENTPFBA
 16277        MOVE MAP-NAMEB           TO MAP-NAME
 16278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16279        GO TO 8200-SEND-DATAONLY
 16280     END-IF
 16281
 16282     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16283
 16284     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16285
 16286     IF PI-AIG-SPECIAL-BENEFIT
 16287         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16288
 16289     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16290
 16291     IF PI-SPECIAL-BEN-SW = 'Y'
 16292         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 310
* EL156.cbl
 16293         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16294
 16295     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16296         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16297     ELSE
 16298         IF PI-PMTTYPE NOT = '4'
 16299            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16300
 16301     IF PI-PMTTYPE = '5' OR '6'
 16302        GO TO  6250-SET-MAINT.
 16303
 16304     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16305                                         CL-LAG-REPORT-CODE.
 16306
 16307     IF CL-ACTIVITY-CODE = 09
 16308         GO TO 6200-CONT-UPDATE.
 16309
 16310     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16311         IF CL-ACTIVITY-CODE = 11
 16312             GO TO 6200-CONT-UPDATE.
 16313
 16314     IF WS-ACT-REC-FOUND-SW = 'N'
 16315         GO TO 6200-CONT-UPDATE.
 16316
 16317     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16318         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16319         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16320         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16321
 16322     IF WS-UPDATE-SW = 'Y'
 16323         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16324                                         CL-NEXT-FOLLOWUP-DT.
 16325
 16326 6200-CONT-UPDATE.
 16327
 16328     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16329       IF CLAIM-IS-CLOSED
 16330         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16331           IF WS-OPEN-CLOSE-SW = '2'
 16332             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16333                                        CL-LAST-CLOSE-DT.
 16334
 16335     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16336        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16337        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16338
 16339     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16340        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16341        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16342        MOVE 'C'                 TO CL-CLAIM-STATUS
 16343        IF PI-PMTTYPE = '2'
 16344           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16345              or 'F')
 16346           CONTINUE
 16347        ELSE
 16348           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16349        END-IF
 16350     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 311
* EL156.cbl
 16351        IF PI-PMTTYPE = '2' OR '3'
 16352           IF PI-PMTTYPE = '2' AND
 16353              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16354                 or 'F')
 16355              CONTINUE
 16356           ELSE
 16357              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16358           END-IF
 16359        END-IF
 16360     END-IF
 16361
 16362     IF PI-PMTTYPE = '4'
 16363        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16364
 16365     IF PI-COMPANY-ID = 'CVL'
 16366         IF PI-LOAN-UPDATE-SW = 'Y'
 16367             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16368             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16369             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16370             MOVE CL-CERT-STATE      TO  CERT-STATE
 16371             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16372             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16373             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16374             MOVE 'CERT'             TO  FILE-SWITCH
 16375             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16376             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16377             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16378
 16379     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16380        GO TO 6220-USE-COMPUTED.
 16381
 16382     IF (PI-PMTTYPE = '4')  AND
 16383        (PI-EPYAMT < ZEROS)
 16384          COMPUTE CL-NO-OF-DAYS-PAID =
 16385                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16386          IF CL-NO-OF-DAYS-PAID < +0
 16387              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16388          ELSE
 16389              NEXT SENTENCE
 16390     ELSE
 16391          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16392
 16393     IF PI-PROCESSOR-ID = 'FIX '
 16394        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16395           NEXT SENTENCE
 16396        ELSE
 16397           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16398     ELSE
 16399        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16400
 16401     IF PI-PMTTYPE = '4'
 16402        GO TO 6250-SET-MAINT.
 16403
 16404     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16405
 16406     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16407     MOVE '4'                    TO DC-OPTION-CODE.
 16408     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 312
* EL156.cbl
 16409     IF DATE-CONVERSION-ERROR
 16410        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16411     ELSE
 16412        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16413           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16414           IF PI-AIG-SPECIAL-BENEFIT
 16415               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16416           ELSE
 16417               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16418
 16419     GO TO 6250-SET-MAINT.
 16420
 16421 6220-USE-COMPUTED.
 16422
 16423     IF (PI-PMTTYPE = '4')  AND
 16424        (PI-CPYAMT < ZEROS)
 16425          COMPUTE CL-NO-OF-DAYS-PAID =
 16426                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16427          IF CL-NO-OF-DAYS-PAID < +0
 16428              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16429          ELSE
 16430              NEXT SENTENCE
 16431     ELSE
 16432          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16433
 16434     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16435
 16436     IF PI-PMTTYPE = '4'
 16437        GO TO 6250-SET-MAINT.
 16438
 16439     IF PI-AIG-SPECIAL-BENEFIT
 16440         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16441     ELSE
 16442         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16443
 16444     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16445
 16446     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16447        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16448
 16449 6250-SET-MAINT.
 16450     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16451
 16452     IF PI-PROCESSOR-ID = 'FIX '
 16453        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16454           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16455        ELSE
 16456           NEXT SENTENCE
 16457     ELSE
 16458        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16459
 16460     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16461     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16462     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16463
 16464 6299-EXIT.
 16465      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 313
* EL156.cbl
 16467 6300-UPDATE-CERT.
 16468
 16469*  ADD CERTNOTE FOR SC NP+6
 16470     IF PI-COMPANY-ID = 'CID' AND
 16471       (PI-PMTTYPE = '2' OR '3') AND
 16472        CL-CERT-STATE = 'SC'  AND
 16473        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16474           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16475     END-IF.
 16476
 16477     IF PI-COMPANY-ID = 'AHL' AND
 16478       (PI-PMTTYPE = '2' OR '3') AND
 16479        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16480           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16481           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16482     END-IF.
 16483
 16484     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16485     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16486     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16487     MOVE CL-CERT-STATE    TO CERT-STATE.
 16488     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16489     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16490     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16491     MOVE 'CERT'           TO FILE-SWITCH.
 16492
 16493     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16494
 16495     IF CERT-NOTE-ADDED
 16496        IF CM-NOTE-SW = ' '
 16497           MOVE '4'             TO CM-NOTE-SW
 16498        ELSE
 16499           IF CM-NOTE-SW = '1'
 16500               MOVE '5'           TO CM-NOTE-SW
 16501           ELSE
 16502              IF CM-NOTE-SW = '2'
 16503                 MOVE '6'         TO CM-NOTE-SW
 16504              ELSE
 16505                 IF CM-NOTE-SW = '3'
 16506                    MOVE '7'      TO CM-NOTE-SW
 16507                 END-IF
 16508              END-IF
 16509           END-IF
 16510        END-IF
 16511     END-IF.
 16512
 16513     IF PI-COMPANY-ID = 'CVL'
 16514         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16515         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16516
 16517     IF PI-PMTTYPE NOT = '4'
 16518        GO TO 6340-UPDATE-CERT.
 16519
 16520     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16521        IF PI-PFKEY-USED = DFHPF5
 16522           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16523        ELSE
 16524           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 314
* EL156.cbl
 16525
 16526*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16527*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16528*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16529*               PI-LF-COVERAGE-TYPE = 'P'
 16530*                GO TO 6350-REWRITE-CERT.
 16531
 16532     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16533       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16534          PI-LF-COVERAGE-TYPE = 'P'
 16535           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16536                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16537                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16538                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16539                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16540                GO TO 6350-REWRITE-CERT
 16541            ELSE
 16542                GO TO 6350-REWRITE-CERT.
 16543
 16544     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16545         GO TO 6350-REWRITE-CERT.
 16546
 16547     IF NOT CM-AH-LUMP-SUM-DISAB
 16548        GO TO 6380-UNLOCK-CERT.
 16549
 16550     IF PI-PFKEY-USED = DFHPF5
 16551        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16552                                    CM-AH-ITD-AH-PMT
 16553        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16554        GO TO 6350-REWRITE-CERT
 16555     ELSE
 16556        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16557                                    CM-AH-ITD-AH-PMT
 16558        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16559        GO TO 6350-REWRITE-CERT.
 16560
 16561 6340-UPDATE-CERT.
 16562
 16563     IF CL-CLAIM-TYPE = 'L'
 16564         IF PI-PFKEY-USED = DFHPF5
 16565             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16566         ELSE
 16567             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16568
 16569     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16570         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16571             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16572                PI-LF-COVERAGE-TYPE = 'P'
 16573                 GO TO 6350-REWRITE-CERT.
 16574
 16575     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16576       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16577          PI-LF-COVERAGE-TYPE = 'P'
 16578           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16579                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16580                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16581                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16582                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 315
* EL156.cbl
 16583                GO TO 6350-REWRITE-CERT.
 16584
 16585     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16586         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16587            PI-LF-COVERAGE-TYPE NOT = 'P'
 16588             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16589             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16590             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16591             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16592             GO TO 6350-REWRITE-CERT.
 16593
 16594     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16595         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16596         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16597         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16598         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16599         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16600         IF PI-PFKEY-USED = DFHPF5
 16601             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16602                                        CM-AH-ITD-AH-PMT
 16603             GO TO 6350-REWRITE-CERT
 16604         ELSE
 16605             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16606                                        CM-AH-ITD-AH-PMT
 16607             GO TO 6350-REWRITE-CERT.
 16608
 16609 6350-REWRITE-CERT.
 16610
 16611
 16612* EXEC CICS REWRITE
 16613*         DATASET  ('ELCERT')
 16614*         FROM(CERTIFICATE-MASTER)
 16615*     END-EXEC.
 16616     MOVE LENGTH OF
 16617      CERTIFICATE-MASTER
 16618       TO DFHEIV11
 16619     MOVE 'ELCERT' TO DFHEIV1
 16620*    MOVE '&& L                  %   #00015490' TO DFHEIV0
 16621     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16622     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16623     MOVE X'2020233030303135343930' TO DFHEIV0(25:11)
 16624     CALL 'kxdfhei1' USING DFHEIV0,
 16625           DFHEIV1,
 16626           CERTIFICATE-MASTER,
 16627           DFHEIV11,
 16628           DFHEIV99
 16629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16630
 16631
 16632     GO TO 6399-EXIT.
 16633
 16634 6380-UNLOCK-CERT.
 16635
 16636* EXEC CICS UNLOCK
 16637*         DATASET  ('ELCERT')
 16638*     END-EXEC.
 16639     MOVE 'ELCERT' TO DFHEIV1
 16640*    MOVE '&*                    #   #00015498' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 316
* EL156.cbl
 16641     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16642     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16643     MOVE X'2020233030303135343938' TO DFHEIV0(25:11)
 16644     CALL 'kxdfhei1' USING DFHEIV0,
 16645           DFHEIV1,
 16646           DFHEIV99
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650 6399-EXIT.
 16651      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 317
* EL156.cbl
 16653 6400-UPDATE-ZERO-TRAILER.
 16654     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16655     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16656
 16657     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16658
 16659     IF PI-EPYAMT NOT = ZEROS
 16660         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16661     ELSE
 16662         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16663
 16664     IF PI-ERESV NOT = ZEROS
 16665        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16666
 16667     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16668        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16669
 16670     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16671        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16672     ELSE
 16673        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16674
 16675     IF PI-PMTTYPE = '5'
 16676        IF PI-EPYAMT = ZEROS
 16677           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16678        ELSE
 16679           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16680
 16681     IF PI-PMTTYPE = '6'
 16682        IF PI-EPYAMT = ZEROS
 16683           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16684        ELSE
 16685           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16686
 16687 6420-CHECK-OPEN-CLOSE.
 16688     IF PI-PMTTYPE = '5' OR '6'
 16689        GO TO 6450-REWRITE.
 16690
 16691     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16692         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16693             IF CLAIM-IS-CLOSED
 16694                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16695                 MOVE 1          TO  SUB-1
 16696                 GO TO 6440-AIG-LOOP.
 16697
 16698     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16699        GO TO 6450-REWRITE.
 16700
 16701     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16702        GO TO 6450-REWRITE.
 16703
 16704     MOVE 1                      TO SUB-1.
 16705
 16706 6430-LOOP.
 16707     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16708        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16709        IF PI-PMTTYPE = '1' OR '4'
 16710           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 318
* EL156.cbl
 16711           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16712           GO TO 6450-REWRITE
 16713        ELSE
 16714           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16715           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16716           GO TO 6450-REWRITE.
 16717
 16718     IF SUB-1 = 6
 16719      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16720      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16721      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16722      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16723      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16724      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16725      GO TO 6430-LOOP.
 16726
 16727     ADD 1                       TO SUB-1.
 16728     GO TO 6430-LOOP.
 16729
 16730
 16731 6440-AIG-LOOP.
 16732
 16733     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16734       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16735       IF WS-OPEN-CLOSE-SW = '1'
 16736         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16737         IF PI-PMTTYPE = '2'
 16738           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16739           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16740         ELSE
 16741           IF PI-PMTTYPE = '3'
 16742             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16743             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16744           ELSE
 16745             IF PI-PMTTYPE = '4'
 16746               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16747               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16748             ELSE
 16749               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16750               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16751       ELSE
 16752         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16753         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16754         GO TO 6450-REWRITE.
 16755
 16756     IF SUB-1 = 6
 16757      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16758      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16759      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16760      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16761      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16762      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16763      GO TO 6440-AIG-LOOP.
 16764
 16765     ADD 1                       TO SUB-1.
 16766     GO TO 6440-AIG-LOOP.
 16767
 16768 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 319
* EL156.cbl
 16769     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16770     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16771     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16772
 16773     IF PI-COMPANY-ID = 'DMD'
 16774         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16775         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16776         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16777         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16778         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16779
 16780
 16781* EXEC CICS REWRITE
 16782*         DATASET  ('ELTRLR')
 16783*         FROM     (ACTIVITY-TRAILERS)
 16784*     END-EXEC.
 16785     MOVE LENGTH OF
 16786      ACTIVITY-TRAILERS
 16787       TO DFHEIV11
 16788     MOVE 'ELTRLR' TO DFHEIV1
 16789*    MOVE '&& L                  %   #00015632' TO DFHEIV0
 16790     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16791     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16792     MOVE X'2020233030303135363332' TO DFHEIV0(25:11)
 16793     CALL 'kxdfhei1' USING DFHEIV0,
 16794           DFHEIV1,
 16795           ACTIVITY-TRAILERS,
 16796           DFHEIV11,
 16797           DFHEIV99
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16799
 16800
 16801 6499-EXIT.
 16802      EXIT.
 16803
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 320
* EL156.cbl
 16805 6500-READ-DLO035.
 16806     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16807     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16808     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16809     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16810
 16811
 16812* EXEC CICS LINK
 16813*        PROGRAM    ('DLO035')
 16814*        COMMAREA   (DLO035-KEY)
 16815*        LENGTH     (DL35-LENGTH)
 16816*    END-EXEC.
 16817     MOVE 'DLO035' TO DFHEIV1
 16818*    MOVE '."C                   (   #00015647' TO DFHEIV0
 16819     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303135363437' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0,
 16823           DFHEIV1,
 16824           DLO035-KEY,
 16825           DL35-LENGTH,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99,
 16829           DFHEIV99
 16830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16831
 16832
 16833     IF DL35-RETURN-CODE = 'OK'
 16834         GO TO 6500-EXIT.
 16835
 16836     IF DL35-RETURN-CODE = '01'
 16837         MOVE ER-7830            TO EMI-ERROR
 16838         GO TO 6500-BAD-EXIT.
 16839
 16840     IF DL35-RETURN-CODE = '02'
 16841         MOVE ER-7831            TO EMI-ERROR
 16842         GO TO 6500-BAD-EXIT.
 16843
 16844     IF DL35-RETURN-CODE = '03'
 16845         MOVE ER-7832            TO EMI-ERROR
 16846         GO TO 6500-BAD-EXIT.
 16847
 16848     IF DL35-RETURN-CODE = '04'
 16849         MOVE ER-7833            TO EMI-ERROR
 16850         GO TO 6500-BAD-EXIT.
 16851
 16852     IF DL35-RETURN-CODE = '05'
 16853         MOVE ER-7834            TO EMI-ERROR
 16854         GO TO 6500-BAD-EXIT.
 16855
 16856     IF DL35-RETURN-CODE = '06'
 16857         MOVE ER-7835            TO EMI-ERROR
 16858         GO TO 6500-BAD-EXIT.
 16859
 16860     IF DL35-RETURN-CODE = '07'
 16861         MOVE ER-7836            TO EMI-ERROR
 16862         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 321
* EL156.cbl
 16863
 16864     IF DL35-RETURN-CODE = 'E1'
 16865         MOVE ER-7837            TO EMI-ERROR
 16866         GO TO 6500-BAD-EXIT.
 16867
 16868     IF DL35-RETURN-CODE NOT = 'OK'
 16869         MOVE ER-7838            TO EMI-ERROR
 16870         GO TO 6500-BAD-EXIT.
 16871
 16872 6500-EXIT.
 16873      EXIT.
 16874
 16875 6500-BAD-EXIT.
 16876
 16877* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16878*    MOVE '6"R                   !   #00015696' TO DFHEIV0
 16879     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16881     MOVE X'2020233030303135363936' TO DFHEIV0(25:11)
 16882     CALL 'kxdfhei1' USING DFHEIV0
 16883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16884
 16885     MOVE -1                 TO PMTTYPEL.
 16886     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16887     GO TO 8200-SEND-DATAONLY.
 16888
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 322
* EL156.cbl
 16890 6600-UPDATE-DLO035.
 16891     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16892     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16893     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16894     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16895
 16896
 16897* EXEC CICS LINK
 16898*        PROGRAM    ('DLO035')
 16899*        COMMAREA   (DLO035-KEY)
 16900*        LENGTH     (DL35-LENGTH)
 16901*    END-EXEC.
 16902     MOVE 'DLO035' TO DFHEIV1
 16903*    MOVE '."C                   (   #00015708' TO DFHEIV0
 16904     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16906     MOVE X'2020233030303135373038' TO DFHEIV0(25:11)
 16907     CALL 'kxdfhei1' USING DFHEIV0,
 16908           DFHEIV1,
 16909           DLO035-KEY,
 16910           DL35-LENGTH,
 16911           DFHEIV99,
 16912           DFHEIV99,
 16913           DFHEIV99,
 16914           DFHEIV99
 16915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16916
 16917
 16918     IF DL35-RETURN-CODE = 'OK'
 16919         GO TO 6600-EXIT.
 16920
 16921     IF DL35-RETURN-CODE = '01'
 16922         MOVE ER-7830            TO EMI-ERROR
 16923         GO TO 6500-BAD-EXIT.
 16924
 16925     IF DL35-RETURN-CODE = '02'
 16926         MOVE ER-7831            TO EMI-ERROR
 16927         GO TO 6500-BAD-EXIT.
 16928
 16929     IF DL35-RETURN-CODE = '03'
 16930         MOVE ER-7832            TO EMI-ERROR
 16931         GO TO 6500-BAD-EXIT.
 16932
 16933     IF DL35-RETURN-CODE = '04'
 16934         MOVE ER-7833            TO EMI-ERROR
 16935         GO TO 6500-BAD-EXIT.
 16936
 16937     IF DL35-RETURN-CODE = '05'
 16938         MOVE ER-7834            TO EMI-ERROR
 16939         GO TO 6500-BAD-EXIT.
 16940
 16941     IF DL35-RETURN-CODE = '06'
 16942         MOVE ER-7835            TO EMI-ERROR
 16943         GO TO 6500-BAD-EXIT.
 16944
 16945     IF DL35-RETURN-CODE = '07'
 16946         MOVE ER-7836            TO EMI-ERROR
 16947         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 323
* EL156.cbl
 16948
 16949     IF DL35-RETURN-CODE = 'E1'
 16950         MOVE ER-7837            TO EMI-ERROR
 16951         GO TO 6500-BAD-EXIT.
 16952
 16953     IF DL35-RETURN-CODE NOT = 'OK'
 16954         MOVE ER-7838            TO EMI-ERROR
 16955         GO TO 6500-BAD-EXIT.
 16956
 16957 6600-EXIT.
 16958      EXIT.
 16959
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 324
* EL156.cbl
 16961 6700-UPDATE-ACTQ.
 16962***************************************************************
 16963*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16964*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16965*    ONE ALREADY THERE.                                       *
 16966***************************************************************
 16967
 16968
 16969* EXEC CICS HANDLE CONDITION
 16970*         NOTFND(6720-BUILD-NEW-RECORD)
 16971*     END-EXEC.
 16972*    MOVE '"$I                   ! 6 #00015764' TO DFHEIV0
 16973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16975     MOVE X'3620233030303135373634' TO DFHEIV0(25:11)
 16976     CALL 'kxdfhei1' USING DFHEIV0
 16977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16978
 16979
 16980
 16981* EXEC CICS READ
 16982*         DATASET('ELACTQ')
 16983*         RIDFLD (ELMSTR-KEY)
 16984*         SET    (ADDRESS OF ACTIVITY-QUE)
 16985*         UPDATE
 16986*     END-EXEC.
 16987     MOVE 'ELACTQ' TO DFHEIV1
 16988*    MOVE '&"S        EU         (   #00015768' TO DFHEIV0
 16989     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16990     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16991     MOVE X'2020233030303135373638' TO DFHEIV0(25:11)
 16992     CALL 'kxdfhei1' USING DFHEIV0,
 16993           DFHEIV1,
 16994           DFHEIV20,
 16995           DFHEIV99,
 16996           ELMSTR-KEY,
 16997           DFHEIV99,
 16998           DFHEIV99,
 16999           DFHEIV99
 17000     SET ADDRESS OF ACTIVITY-QUE TO
 17001         DFHEIV20
 17002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17003
 17004
 17005     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17006
 17007     IF PI-AIG-SPECIAL-BENEFIT AND
 17008        PI-CASH = 'Y'
 17009         ADD 2                   TO AQ-PAYMENT-COUNTER
 17010     ELSE
 17011         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17012
 17013     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17014         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17015
 17016     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17017
 17018     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 325
* EL156.cbl
 17019         IF WS-PMT-APPROVAL-SW = 'A'
 17020             NEXT SENTENCE
 17021         ELSE
 17022            IF PI-AIG-SPECIAL-BENEFIT AND
 17023               PI-CASH = 'Y'
 17024                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17025                                     WS-PMT-UNAPPROVED-CNT
 17026            ELSE
 17027                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17028                                     WS-PMT-UNAPPROVED-CNT
 17029     ELSE
 17030         IF PI-PMT-APPR-SW = 'Y'
 17031            IF PI-AIG-SPECIAL-BENEFIT AND
 17032               PI-CASH = 'Y'
 17033                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17034                                     WS-PMT-UNAPPROVED-CNT
 17035            ELSE
 17036                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17037                                     WS-PMT-UNAPPROVED-CNT.
 17038
 17039     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17040         MOVE ER-3536 TO EMI-ERROR
 17041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17042
 17043     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17044
 17045
 17046* EXEC CICS REWRITE
 17047*         DATASET('ELACTQ')
 17048*         FROM   (ACTIVITY-QUE)
 17049*     END-EXEC.
 17050     MOVE LENGTH OF
 17051      ACTIVITY-QUE
 17052       TO DFHEIV11
 17053     MOVE 'ELACTQ' TO DFHEIV1
 17054*    MOVE '&& L                  %   #00015815' TO DFHEIV0
 17055     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17056     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17057     MOVE X'2020233030303135383135' TO DFHEIV0(25:11)
 17058     CALL 'kxdfhei1' USING DFHEIV0,
 17059           DFHEIV1,
 17060           ACTIVITY-QUE,
 17061           DFHEIV11,
 17062           DFHEIV99
 17063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17064
 17065
 17066     GO TO 6799-EXIT.
 17067
 17068 6720-BUILD-NEW-RECORD.
 17069
 17070* EXEC CICS GETMAIN
 17071*         SET    (ADDRESS OF ACTIVITY-QUE)
 17072*         LENGTH (60)
 17073*         INITIMG(GETMAIN-SPACE)
 17074*     END-EXEC.
 17075     MOVE 60
 17076       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 326
* EL156.cbl
 17077*    MOVE ',"IL                  $   #00015823' TO DFHEIV0
 17078     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17080     MOVE X'2020233030303135383233' TO DFHEIV0(25:11)
 17081     CALL 'kxdfhei1' USING DFHEIV0,
 17082           DFHEIV20,
 17083           DFHEIV11,
 17084           GETMAIN-SPACE
 17085     SET ADDRESS OF ACTIVITY-QUE TO
 17086         DFHEIV20
 17087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17088
 17089
 17090     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17091
 17092     IF PI-AIG-SPECIAL-BENEFIT AND
 17093        PI-CASH = 'Y'
 17094         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17095     ELSE
 17096         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17097
 17098     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17099     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17100     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17101     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17102                                    AQ-FOLLOWUP-DATE.
 17103     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17104     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17105
 17106     IF PI-PMT-GRADUATED
 17107         IF WS-PMT-APPROVAL-SW = 'A'
 17108             NEXT SENTENCE
 17109         ELSE
 17110            IF PI-AIG-SPECIAL-BENEFIT AND
 17111               PI-CASH = 'Y'
 17112                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17113            ELSE
 17114                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17115     ELSE
 17116         IF PI-PMT-APPR-SW = 'Y'
 17117            IF PI-AIG-SPECIAL-BENEFIT AND
 17118               PI-CASH = 'Y'
 17119                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17120            ELSE
 17121                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17122
 17123     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17124         MOVE ER-3536 TO EMI-ERROR
 17125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17126
 17127
 17128* EXEC CICS WRITE
 17129*         DATASET('ELACTQ')
 17130*         RIDFLD (ELMSTR-KEY)
 17131*         FROM   (ACTIVITY-QUE)
 17132*     END-EXEC.
 17133     MOVE LENGTH OF
 17134      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 327
* EL156.cbl
 17135       TO DFHEIV11
 17136     MOVE 'ELACTQ' TO DFHEIV1
 17137*    MOVE '&$ L                  ''   #00015866' TO DFHEIV0
 17138     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17139     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17140     MOVE X'2020233030303135383636' TO DFHEIV0(25:11)
 17141     CALL 'kxdfhei1' USING DFHEIV0,
 17142           DFHEIV1,
 17143           ACTIVITY-QUE,
 17144           DFHEIV11,
 17145           ELMSTR-KEY,
 17146           DFHEIV99,
 17147           DFHEIV99
 17148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17149
 17150
 17151 6799-EXIT.
 17152      EXIT.
 17153
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 328
* EL156.cbl
 17155 6800-BUILD-FORM-TRAILER.
 17156
 17157
 17158* EXEC CICS GETMAIN
 17159*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17160*         LENGTH   (200)
 17161*         INITIMG  (GETMAIN-SPACE)
 17162*    END-EXEC.
 17163     MOVE 200
 17164       TO DFHEIV11
 17165*    MOVE ',"IL                  $   #00015878' TO DFHEIV0
 17166     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17167     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303135383738' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0,
 17170           DFHEIV20,
 17171           DFHEIV11,
 17172           GETMAIN-SPACE
 17173     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17174         DFHEIV20
 17175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17176
 17177
 17178     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17179
 17180     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17181     MOVE 'AT'                   TO AT-RECORD-ID.
 17182     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17183
 17184     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17185     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17186                                    AT-FORM-LAST-MAINT-DT
 17187                                    AT-FORM-SEND-ON-DT.
 17188     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17189                                    AT-FORM-LAST-UPDATED-BY.
 17190     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17191     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17192     MOVE '6'                    TO DC-OPTION-CODE.
 17193     MOVE +29                    TO DC-ELAPSED-DAYS.
 17194     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17195     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17196     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17197
 17198     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17199         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17200
 17201     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17202                                    AT-FORM-RE-SEND-DT
 17203                                    AT-EMP-FORM-ANSWERED-DT
 17204                                    AT-PHY-FORM-ANSWERED-DT
 17205                                    AT-EMP-FORM-SEND-ON-DT
 17206                                    AT-PHY-FORM-SEND-ON-DT
 17207                                    AT-FORM-PRINTED-DT
 17208                                    AT-FORM-REPRINT-DT.
 17209     MOVE '2'                    TO AT-FORM-TYPE.
 17210
 17211     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17212     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 329
* EL156.cbl
 17213
 17214     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17215         NEXT SENTENCE
 17216     ELSE
 17217         IF CL-PROG-FORM-TYPE NOT = 'S'
 17218            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17219
 17220
 17221* EXEC CICS WRITE
 17222*         DATASET  ('ELTRLR')
 17223*         FROM     (ACTIVITY-TRAILERS)
 17224*         RIDFLD   (AT-CONTROL-PRIMARY)
 17225*     END-EXEC.
 17226     MOVE LENGTH OF
 17227      ACTIVITY-TRAILERS
 17228       TO DFHEIV11
 17229     MOVE 'ELTRLR' TO DFHEIV1
 17230*    MOVE '&$ L                  ''   #00015926' TO DFHEIV0
 17231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17233     MOVE X'2020233030303135393236' TO DFHEIV0(25:11)
 17234     CALL 'kxdfhei1' USING DFHEIV0,
 17235           DFHEIV1,
 17236           ACTIVITY-TRAILERS,
 17237           DFHEIV11,
 17238           AT-CONTROL-PRIMARY,
 17239           DFHEIV99,
 17240           DFHEIV99
 17241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17242
 17243
 17244 6899-EXIT.
 17245      EXIT.
 17246
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 330
* EL156.cbl
 17248 6900-BUILD-ARCHIVE-HEADER.
 17249
 17250     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17251     MOVE '1'                    TO CNTL-REC-TYPE.
 17252     MOVE +0                     TO CNTL-SEQ-NO.
 17253     MOVE SPACES                 TO CNTL-ACCESS.
 17254
 17255
 17256* EXEC CICS READ
 17257*         DATASET  ('ELCNTL')
 17258*         SET      (ADDRESS OF CONTROL-FILE)
 17259*         RIDFLD   (ELCNTL-KEY)
 17260*         UPDATE
 17261*    END-EXEC.
 17262     MOVE 'ELCNTL' TO DFHEIV1
 17263*    MOVE '&"S        EU         (   #00015943' TO DFHEIV0
 17264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135393433' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           DFHEIV1,
 17269           DFHEIV20,
 17270           DFHEIV99,
 17271           ELCNTL-KEY,
 17272           DFHEIV99,
 17273           DFHEIV99,
 17274           DFHEIV99
 17275     SET ADDRESS OF CONTROL-FILE TO
 17276         DFHEIV20
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17281     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17282
 17283
 17284* EXEC CICS REWRITE
 17285*         FROM     (CONTROL-FILE)
 17286*         DATASET  ('ELCNTL')
 17287*    END-EXEC.
 17288     MOVE LENGTH OF
 17289      CONTROL-FILE
 17290       TO DFHEIV11
 17291     MOVE 'ELCNTL' TO DFHEIV1
 17292*    MOVE '&& L                  %   #00015953' TO DFHEIV0
 17293     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17294     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17295     MOVE X'2020233030303135393533' TO DFHEIV0(25:11)
 17296     CALL 'kxdfhei1' USING DFHEIV0,
 17297           DFHEIV1,
 17298           CONTROL-FILE,
 17299           DFHEIV11,
 17300           DFHEIV99
 17301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17302
 17303
 17304
 17305* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 331
* EL156.cbl
 17306*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17307*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17308*    END-EXEC.
 17309*    MOVE '"$$%                  ! 7 #00015958' TO DFHEIV0
 17310     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17312     MOVE X'3720233030303135393538' TO DFHEIV0(25:11)
 17313     CALL 'kxdfhei1' USING DFHEIV0
 17314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17315
 17316
 17317
 17318* EXEC CICS GETMAIN
 17319*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17320*         LENGTH  (ELARCH-LENGTH)
 17321*         INITIMG (GETMAIN-SPACE)
 17322*    END-EXEC.
 17323*    MOVE ',"IL                  $   #00015963' TO DFHEIV0
 17324     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17326     MOVE X'2020233030303135393633' TO DFHEIV0(25:11)
 17327     CALL 'kxdfhei1' USING DFHEIV0,
 17328           DFHEIV20,
 17329           ELARCH-LENGTH,
 17330           GETMAIN-SPACE
 17331     SET ADDRESS OF LETTER-ARCHIVE TO
 17332         DFHEIV20
 17333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17334
 17335
 17336     MOVE 'LA'                   TO LA-RECORD-ID.
 17337     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17338                                    LA-ARCHIVE-NO-A1.
 17339     MOVE '4'                    TO LA-RECORD-TYPE
 17340                                    LA-RECORD-TYPE-A1.
 17341     MOVE +0                     TO LA-LINE-SEQ-NO
 17342                                    LA-LINE-SEQ-NO-A1.
 17343     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17344                                    LA-COMPANY-CD-A1.
 17345     MOVE CL-CARRIER             TO LA4-CARRIER.
 17346     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17347     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17348     MOVE CL-CERT-STATE          TO LA4-STATE.
 17349     MOVE +0                     TO LA4-NO-OF-COPIES.
 17350     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17351     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17352     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17353                                    LA4-INITIAL-PRINT-DATE
 17354                                    LA4-RESEND-PRINT-DATE
 17355                                    LA4-FORM-REM-PRINT-DT.
 17356     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17357     MOVE '2'                    TO LA4-FORM-TYPE.
 17358
 17359
 17360* EXEC CICS WRITE
 17361*         DATASET  ('ELARCH')
 17362*         FROM     (LETTER-ARCHIVE)
 17363*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 332
* EL156.cbl
 17364*    END-EXEC.
 17365     MOVE LENGTH OF
 17366      LETTER-ARCHIVE
 17367       TO DFHEIV11
 17368     MOVE 'ELARCH' TO DFHEIV1
 17369*    MOVE '&$ L                  ''   #00015992' TO DFHEIV0
 17370     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17372     MOVE X'2020233030303135393932' TO DFHEIV0(25:11)
 17373     CALL 'kxdfhei1' USING DFHEIV0,
 17374           DFHEIV1,
 17375           LETTER-ARCHIVE,
 17376           DFHEIV11,
 17377           LA-CONTROL-PRIMARY,
 17378           DFHEIV99,
 17379           DFHEIV99
 17380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17381
 17382
 17383 6999-EXIT.
 17384      EXIT.
 17385
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 333
* EL156.cbl
 17387 7000-SHOW-CLAIM.
 17388     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17389     MOVE 'A'                    TO PI-PASS-SW.
 17390     MOVE LOW-VALUES             TO PI-CPYFROM
 17391                                    PI-MONTH-END-SAVE
 17392                                    PI-CPYTHRU.
 17393
 17394     MOVE ZEROS                  TO PI-FATAL-COUNT
 17395                                    PI-DAILY-RATE
 17396                                    PI-BEN-DAYS
 17397                                    PI-MANUAL-SW
 17398                                    PI-SAVE-CURSOR
 17399                                    PI-FORCE-COUNT
 17400                                    PI-HOLDTIL
 17401                                    PI-EPYFROM
 17402                                    PI-EPYTHRU
 17403                                    PI-EDAYS
 17404                                    PI-EPYAMT
 17405                                    PI-ERESV
 17406                                    PI-EEXPENS
 17407                                    PI-CDAYS
 17408                                    PI-CPYAMT
 17409                                    PI-CRESV
 17410                                    PI-CEXPENS
 17411                                    PI-INT-RATE
 17412                                    PI-AIGFROM.
 17413     MOVE ZEROS                  TO PI-PROOF-DATE.
 17414     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17415                                    PI-REM-BEN-AMT
 17416                                    PI-MO-BEN-AMT
 17417                                    pi-ah-term.
 17418
 17419     MOVE LOW-VALUES             TO EL156AI.
 17420     MOVE MAP-NAMEA              TO MAP-NAME.
 17421
 17422* EXEC CICS HANDLE CONDITION
 17423*        NOTFND   (7010-BUILD-MAP)
 17424*    END-EXEC.
 17425*    MOVE '"$I                   ! 8 #00016036' TO DFHEIV0
 17426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17428     MOVE X'3820233030303136303336' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0
 17430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17431
 17432
 17433     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17434     MOVE '2'                    TO CNTL-REC-TYPE.
 17435     MOVE +0                     TO CNTL-SEQ-NO.
 17436     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17437
 17438
 17439* EXEC CICS READ
 17440*         DATASET  ('ELCNTL')
 17441*         SET      (ADDRESS OF CONTROL-FILE)
 17442*         RIDFLD   (ELCNTL-KEY)
 17443*    END-EXEC.
 17444     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 334
* EL156.cbl
 17445*    MOVE '&"S        E          (   #00016045' TO DFHEIV0
 17446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17448     MOVE X'2020233030303136303435' TO DFHEIV0(25:11)
 17449     CALL 'kxdfhei1' USING DFHEIV0,
 17450           DFHEIV1,
 17451           DFHEIV20,
 17452           DFHEIV99,
 17453           ELCNTL-KEY,
 17454           DFHEIV99,
 17455           DFHEIV99,
 17456           DFHEIV99
 17457     SET ADDRESS OF CONTROL-FILE TO
 17458         DFHEIV20
 17459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17460
 17461
 17462     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17463
 17464     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17465         MOVE AL-UANON      TO SURVYYNA
 17466     END-IF.
 17467
 17468
 17469     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17470     MOVE '1'                    TO CNTL-REC-TYPE.
 17471     MOVE SPACES                 TO CNTL-ACCESS.
 17472     MOVE +0                     TO CNTL-SEQ-NO.
 17473
 17474
 17475* EXEC CICS READ
 17476*         DATASET  ('ELCNTL')
 17477*         SET      (ADDRESS OF CONTROL-FILE)
 17478*         RIDFLD   (ELCNTL-KEY)
 17479*    END-EXEC.
 17480     MOVE 'ELCNTL' TO DFHEIV1
 17481*    MOVE '&"S        E          (   #00016063' TO DFHEIV0
 17482     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17484     MOVE X'2020233030303136303633' TO DFHEIV0(25:11)
 17485     CALL 'kxdfhei1' USING DFHEIV0,
 17486           DFHEIV1,
 17487           DFHEIV20,
 17488           DFHEIV99,
 17489           ELCNTL-KEY,
 17490           DFHEIV99,
 17491           DFHEIV99,
 17492           DFHEIV99
 17493     SET ADDRESS OF CONTROL-FILE TO
 17494         DFHEIV20
 17495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17496
 17497
 17498     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17499
 17500 7010-BUILD-MAP.
 17501
 17502
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 335
* EL156.cbl
 17503* EXEC CICS HANDLE CONDITION
 17504*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17505*    END-EXEC.
 17506*    MOVE '"$I                   ! 9 #00016073' TO DFHEIV0
 17507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17509     MOVE X'3920233030303136303733' TO DFHEIV0(25:11)
 17510     CALL 'kxdfhei1' USING DFHEIV0
 17511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17512
 17513
 17514     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17515     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17516     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17517     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17518     MOVE 'MSTR'                 TO FILE-SWITCH.
 17519
 17520     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17521
 17522     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17523     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17524     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17525     MOVE CL-CCN                 TO PI-SV-CCN.
 17526
 17527     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17528     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17529     MOVE CL-CLAIM-NO            TO CLMNOO.
 17530     MOVE CL-CARRIER             TO CARRO.
 17531     MOVE CL-CERT-PRIME          TO CERTNOO.
 17532     MOVE CL-CERT-SFX            TO SUFXO.
 17533
 17534     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17535        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17536        CONTINUE
 17537     ELSE
 17538        MOVE AL-SADOF            TO ZINTHA
 17539                                    ZINTA
 17540                                    PINTHA
 17541                                    PINTA
 17542     END-IF
 17543     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17544     EVALUATE TRUE
 17545     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17546         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17547     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17548         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17549
 17550     WHEN CL-CLAIM-TYPE = 'I'
 17551         MOVE '  IU  '           TO CLMTYPO
 17552     WHEN CL-CLAIM-TYPE = 'G'
 17553         MOVE ' GAP  '           TO CLMTYPO
 17554     WHEN CL-CLAIM-TYPE = 'F'
 17555         MOVE ' FMLA '           TO CLMTYPO
 17556     END-EVALUATE.
 17557     IF CLAIM-IS-OPEN
 17558         MOVE ' OPEN'            TO CLMSTATO
 17559     ELSE
 17560         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 336
* EL156.cbl
 17561
 17562     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17563
 17564     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17565         MOVE SPACES             TO  PCERTNOO
 17566                                     PSUFXO
 17567                                     PRIMHDGO
 17568                                     SEQUO
 17569         MOVE AL-SADOF           TO  PCERTNOA
 17570                                     PSUFXA
 17571                                     PRIMHDGA
 17572                                     SEQUA
 17573     ELSE
 17574         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17575         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17576         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17577         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17578         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17579         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17580         MOVE AL-SANON               TO  PCERTNOA
 17581                                         PSUFXA
 17582                                         PRIMHDGA
 17583         MOVE AL-SABON               TO  SEQUA.
 17584
 17585     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17586
 17587     IF CL-NO-OF-PMTS-MADE = 0 AND
 17588        CL-TOTAL-PAID-AMT = 0
 17589         NEXT SENTENCE
 17590     ELSE
 17591         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17592             IF NOT PI-USES-PAID-TO
 17593                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17594                 MOVE ' '                 TO DC-OPTION-CODE
 17595                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17596                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17597             ELSE
 17598                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17599                 MOVE '6'                 TO DC-OPTION-CODE
 17600                 MOVE +1                  TO DC-ELAPSED-DAYS
 17601                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17602                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17603                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17604
 17605     IF MAP-NAME = 'EL156A'
 17606        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17607           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17608             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17609           end-if
 17610        end-if
 17611     end-if
 17612     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17613         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17614         MOVE ' '                TO DC-OPTION-CODE
 17615         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17616         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17617
 17618     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 337
* EL156.cbl
 17619         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17620         MOVE ' '                TO DC-OPTION-CODE
 17621         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17622         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17623
 17624     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17625
 17626     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17627         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17628         MOVE ' '                TO DC-OPTION-CODE
 17629         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17630         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17631
 17632     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17633         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17634         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17635     ELSE
 17636         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17637         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17638
 17639     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17640     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17641     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17642     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17643                                    PI-GROUPING.
 17644     MOVE CL-CERT-STATE          TO CERT-STATE
 17645                                    PI-STATE.
 17646     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17647                                    PI-ACCOUNT.
 17648     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17649     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17650     MOVE 'CERT'                 TO FILE-SWITCH.
 17651
 17652     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17653     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17654        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17655        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17656            MOVE 'N' TO PI-JOINT-INSURED-IND
 17657     ELSE
 17658            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17659     END-IF.
 17660
 17661     perform 7975-read-acct      thru 7975-exit
 17662     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17663     MOVE PI-STATE               TO WS-ST-ACCESS.
 17664     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17665     MOVE '3'                    TO CNTL-REC-TYPE.
 17666     MOVE +0                     TO CNTL-SEQ-NO.
 17667     MOVE 'STAT'                 TO FILE-SWITCH.
 17668
 17669     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17670
 17671     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17672     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17673
 17674     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17675        GO TO 7020-BYPASS-BENEFIT.
 17676
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 338
* EL156.cbl
 17677     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17678     MOVE '4'                    TO CNTL-REC-TYPE.
 17679     MOVE +0                     TO CNTL-SEQ-NO.
 17680     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17681     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17682     MOVE 'BENE'                 TO FILE-SWITCH.
 17683
 17684     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17685
 17686     IF NO-BENEFIT-FOUND
 17687        GO TO 7020-BYPASS-BENEFIT.
 17688
 17689     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17690     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17691     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17692
 17693 7020-BYPASS-BENEFIT.
 17694
 17695*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17696*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17697*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17698
 17699     move zeros                  to PI-MAX-BENEFIT-AMT
 17700     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17701     move cm-ah-orig-term        to pi-ah-term
 17702     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17703     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17704          'G' and 'F'
 17705         GO TO 7021-GO-TO-LIFE.
 17706
 17707     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17708        and (acct-found)
 17709        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17710        PERFORM 0900-GET-DDF-limits
 17711                                 THRU 0900-EXIT
 17712        IF PDEF-FOUND
 17713           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17714              (P1 > +8)
 17715              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17716           END-PERFORM
 17717           IF P1 < +9
 17718              if pd-ben-pct (p1) not numeric
 17719                 move zeros      to pd-ben-pct (p1)
 17720              end-if
 17721              if pd-ben-pct (p1) = zeros
 17722                 move +1         to ws-work-ben-pct
 17723              else
 17724                 move pd-ben-pct (p1)
 17725                                 to ws-work-ben-pct
 17726              end-if
 17727              compute cm-ah-benefit-amt =
 17728                 cm-ah-benefit-amt * ws-work-ben-pct
 17729              move pd-max-amt (p1) to pi-max-benefit-amt
 17730           END-IF
 17731        END-IF
 17732     end-if
 17733     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17734     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 339
* EL156.cbl
 17735     if (pi-max-benefit-amt not = zeros)
 17736        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17737        move pi-max-benefit-amt  to beneo
 17738     else
 17739        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17740     end-if
 17741     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17742     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17743                                    CP-ORIGINAL-TERM.
 17744     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17745
 17746*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17747*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17748*    ELSE
 17749         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17750
 17751     MOVE ' '                    TO DC-OPTION-CODE.
 17752     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17753     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17754
 17755     IF PI-COMPANY-ID = 'DMD'
 17756         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17757         GO TO 7023-BYPASS-REMAINING-TERM.
 17758
 17759     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17760     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17761     GO TO 7022-AROUND-LIFE.
 17762
 17763 7021-GO-TO-LIFE.
 17764
 17765     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17766     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17767     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17768                                    CP-ORIGINAL-TERM.
 17769     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17770     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17771     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17772     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17773
 17774     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17775         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17776     ELSE
 17777         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17778
 17779     MOVE ' '                    TO DC-OPTION-CODE.
 17780     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17781     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17782
 17783 7022-AROUND-LIFE.
 17784
 17785     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17786     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17787     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17788     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17789     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17790     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17791     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17792
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 340
* EL156.cbl
 17793     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17794
 17795     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17796        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17797           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17798
 17799     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17800        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17801           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17802
 17803 7023-BYPASS-REMAINING-TERM.
 17804     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17805       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17806          MOVE ZEROS                  TO BENEO
 17807       ELSE
 17808          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17809          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17810          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17811          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17812          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17813          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17814          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17815          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17816          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17817          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17818          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17819          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17820          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17821             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17822             PERFORM 0900-GET-DDF-limits
 17823                                 THRU 0900-EXIT
 17824             IF PDEF-FOUND
 17825                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17826                   (P1 > +8)
 17827                   OR (PD-PROD-CODE (P1) = 'L')
 17828                END-PERFORM
 17829                IF P1 < +9
 17830                   MOVE PD-MAX-AMT (P1)
 17831                                 TO CP-R-MAX-TOT-BEN
 17832                END-IF
 17833             END-IF
 17834          END-IF
 17835
 17836* EXEC CICS LINK
 17837*            PROGRAM  (LINK-REMAMT)
 17838*            COMMAREA (CALCULATION-PASS-AREA)
 17839*            LENGTH   (CP-COMM-LENGTH)
 17840*         END-EXEC
 17841*    MOVE '."C                   (   #00016398' TO DFHEIV0
 17842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17844     MOVE X'2020233030303136333938' TO DFHEIV0(25:11)
 17845     CALL 'kxdfhei1' USING DFHEIV0,
 17846           LINK-REMAMT,
 17847           CALCULATION-PASS-AREA,
 17848           CP-COMM-LENGTH,
 17849           DFHEIV99,
 17850           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 341
* EL156.cbl
 17851           DFHEIV99,
 17852           DFHEIV99
 17853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17854          MOVE CP-REMAINING-AMT       TO BENEO
 17855       end-if
 17856     end-if
 17857     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17858     MOVE +95                    TO TRLR-SEQ-NO
 17859
 17860* EXEC CICS READ
 17861*       DATASET  ('ELTRLR')
 17862*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17863*       RIDFLD   (ELTRLR-KEY)
 17864*       RESP     (WS-RESPONSE)
 17865*    END-EXEC
 17866     MOVE 'ELTRLR' TO DFHEIV1
 17867*    MOVE '&"S        E          (  N#00016408' TO DFHEIV0
 17868     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17869     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17870     MOVE X'204E233030303136343038' TO DFHEIV0(25:11)
 17871     CALL 'kxdfhei1' USING DFHEIV0,
 17872           DFHEIV1,
 17873           DFHEIV20,
 17874           DFHEIV99,
 17875           ELTRLR-KEY,
 17876           DFHEIV99,
 17877           DFHEIV99,
 17878           DFHEIV99
 17879     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17880         DFHEIV20
 17881     MOVE EIBRESP  TO WS-RESPONSE
 17882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17883
 17884     if ws-resp-normal
 17885        perform varying s1 from +1 by +1 until
 17886           at-note-error-no (s1) = spaces
 17887           move at-note-error-no (s1)
 17888                                 to emi-error
 17889           if at-note-error-no (s1) = '1653'
 17890              evaluate true
 17891                 when cl-claim-type = 'L'
 17892                    move '  LF  '
 17893                                 to emi-claim-type
 17894                 when cl-claim-type = 'I'
 17895                    move '  IU  '
 17896                                 to emi-claim-type
 17897                 when cl-claim-type = 'F'
 17898                    move ' FMLA '
 17899                                 to emi-claim-type
 17900                 when other
 17901                    move '  AH  '
 17902                                 to emi-claim-type
 17903              end-evaluate
 17904           end-if
 17905           PERFORM 9900-ERROR-FORMAT
 17906                                 THRU 9900-EXIT
 17907        end-perform
 17908     end-if
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 342
* EL156.cbl
 17909     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17910         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17911            WS-LF-COVERAGE-TYPE = 'P'
 17912             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17913                                        CM-LF-ITD-DEATH-AMT
 17914             MOVE WS-REMAINING-AMT  TO  BENEO.
 17915
 17916     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17917     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17918     MOVE WS-TERMS               TO TERMSO.
 17919
 17920     IF WS-STATUS = '6' OR '7' OR '8'
 17921         MOVE AL-SABOF           TO CRTSTATA.
 17922
 17923     IF WS-STATUS = '1' OR '4'
 17924        IF CP-REMAINING-TERM-3 = ZEROS
 17925           MOVE 'EXPIRED'        TO CRTSTATO
 17926        ELSE
 17927           MOVE 'ACTIVE  '       TO CRTSTATO.
 17928
 17929     IF WS-STATUS = '2'
 17930         MOVE 'PEND    '         TO CRTSTATO.
 17931
 17932     IF WS-STATUS = '3'
 17933         MOVE 'RESTORE '         TO CRTSTATO.
 17934
 17935     IF WS-STATUS = '5'
 17936         MOVE 'REISSUE '         TO CRTSTATO.
 17937
 17938     IF WS-STATUS = '6'
 17939         MOVE 'LMP DIS'          TO CRTSTATO.
 17940
 17941     IF WS-STATUS = '7'
 17942         MOVE 'DEATH'            TO CRTSTATO.
 17943
 17944     IF WS-STATUS = '8'
 17945         MOVE 'CANCEL'           TO CRTSTATO.
 17946
 17947     IF WS-STATUS = '9'
 17948         MOVE 'RE-ONLY '         TO CRTSTATO.
 17949
 17950     IF WS-STATUS = 'V'
 17951         MOVE 'VOID  '           TO CRTSTATO.
 17952
 17953     IF WS-STATUS = 'D'
 17954         MOVE 'DECLINE '         TO CRTSTATO.
 17955
 17956     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17957         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17958         MOVE '5'                TO CNTL-REC-TYPE
 17959     ELSE
 17960         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17961         MOVE '4'                TO CNTL-REC-TYPE.
 17962
 17963     MOVE '** NONE **'           TO COVERO.
 17964     MOVE AL-SABON               TO COVERA.
 17965
 17966     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 343
* EL156.cbl
 17967         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17968             MOVE CM-BENEFICIARY TO LOANNOO
 17969             MOVE AL-UANON       TO LOANNOA.
 17970
 17971     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 17972        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17973        MOVE +91                 TO  TRLR-SEQ-NO
 17974
 17975* EXEC CICS READ
 17976*           DATASET  ('ELTRLR')
 17977*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17978*           RIDFLD   (ELTRLR-KEY)
 17979*           RESP     (WS-RESPONSE)
 17980*       END-EXEC
 17981     MOVE 'ELTRLR' TO DFHEIV1
 17982*    MOVE '&"S        E          (  N#00016505' TO DFHEIV0
 17983     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17985     MOVE X'204E233030303136353035' TO DFHEIV0(25:11)
 17986     CALL 'kxdfhei1' USING DFHEIV0,
 17987           DFHEIV1,
 17988           DFHEIV20,
 17989           DFHEIV99,
 17990           ELTRLR-KEY,
 17991           DFHEIV99,
 17992           DFHEIV99,
 17993           DFHEIV99
 17994     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17995         DFHEIV20
 17996     MOVE EIBRESP  TO WS-RESPONSE
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17998
 17999        IF WS-RESP-NORMAL
 18000           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18001        ELSE
 18002           MOVE SPACES           TO  LOANNOO
 18003        END-IF
 18004*052506
 18005*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18006*052506
 18007     END-IF
 18008
 18009     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18010        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18011
 18012     IF WS-BEN-CD = ZEROS
 18013         GO TO 7050-SHOW-CONTINUE.
 18014
 18015     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18016     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18017     MOVE +0                     TO CNTL-SEQ-NO.
 18018     MOVE 'BENE'                 TO FILE-SWITCH.
 18019
 18020     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18021     IF BENEFIT-FOUND
 18022        MOVE CF-JOINT-INDICATOR (SUB-1)
 18023                                 TO PI-JOINT-COV-IND
 18024                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 344
* EL156.cbl
 18025        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18026                                 TO COVERO
 18027        MOVE AL-SANON            TO COVERA
 18028     END-IF
 18029     if (cntl-rec-type = '4')   *> Life claim
 18030        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18031        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18032        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18033        MOVE '5'              TO CNTL-REC-TYPE
 18034        MOVE WS-ACCESS        TO CNTL-ACCESS
 18035        MOVE +0               TO CNTL-SEQ-NO
 18036        MOVE 'BENE'           TO FILE-SWITCH
 18037        PERFORM 7200-FIND-BENEFIT
 18038                              THRU 7200-EXIT
 18039        IF (BENEFIT-FOUND)
 18040           and (pi-rb-joint-cov-ind) not = 'J'
 18041           MOVE CF-JOINT-INDICATOR (SUB-1)
 18042                              TO PI-rb-JOINT-COV-IND
 18043        end-if
 18044     end-if
 18045     .
 18046 7050-SHOW-CONTINUE.
 18047
 18048     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18049        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18050            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18051     END-IF
 18052
 18053     IF PI-COMPANY-ID = 'DMD'
 18054         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18055
 18056     MOVE -1                     TO PMTTYPEL.
 18057     GO TO 8100-SEND-INITIAL-MAP.
 18058
 18059 7100-SHOW-RECORD-NOT-FOUND.
 18060     IF FILE-SWITCH = 'MSTR'
 18061         MOVE ER-0204            TO EMI-ERROR.
 18062
 18063     IF FILE-SWITCH = 'CERT'
 18064         MOVE ER-0206            TO EMI-ERROR.
 18065
 18066     IF FILE-SWITCH = 'STAT'
 18067         MOVE ER-0149            TO EMI-ERROR.
 18068
 18069     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18070
 18071     MOVE -1                     TO PMTTYPEL.
 18072     GO TO 8100-SEND-INITIAL-MAP
 18073
 18074     .
 18075 7110-BUILD-PMT-TRLR.
 18076     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18077     MOVE +51                    TO TRLR-SEQ-NO
 18078
 18079* EXEC CICS READ
 18080*        DATASET  ('ELTRLR')
 18081*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18082*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 345
* EL156.cbl
 18083*        RESP     (WS-RESPONSE)
 18084*    END-EXEC
 18085     MOVE 'ELTRLR' TO DFHEIV1
 18086*    MOVE '&"S        E          (  N#00016591' TO DFHEIV0
 18087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18089     MOVE X'204E233030303136353931' TO DFHEIV0(25:11)
 18090     CALL 'kxdfhei1' USING DFHEIV0,
 18091           DFHEIV1,
 18092           DFHEIV20,
 18093           DFHEIV99,
 18094           ELTRLR-KEY,
 18095           DFHEIV99,
 18096           DFHEIV99,
 18097           DFHEIV99
 18098     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18099         DFHEIV20
 18100     MOVE EIBRESP  TO WS-RESPONSE
 18101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18102     IF WS-RESP-NORMAL
 18103        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18104     END-IF
 18105     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18106
 18107* EXEC CICS GETMAIN
 18108*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18109*         LENGTH    (200)
 18110*         INITIMG   (GETMAIN-SPACE)
 18111*     END-EXEC
 18112     MOVE 200
 18113       TO DFHEIV11
 18114*    MOVE ',"IL                  $   #00016601' TO DFHEIV0
 18115     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18116     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18117     MOVE X'2020233030303136363031' TO DFHEIV0(25:11)
 18118     CALL 'kxdfhei1' USING DFHEIV0,
 18119           DFHEIV20,
 18120           DFHEIV11,
 18121           GETMAIN-SPACE
 18122     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18123         DFHEIV20
 18124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18125     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18126                                    AT-PREV-PAID-THRU-DT
 18127     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18128     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18129     MOVE 'AT'                   TO AT-RECORD-ID
 18130     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18131     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18132     MOVE '2'                    TO AT-TRAILER-TYPE
 18133     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18134                                    AT-PAYMENT-LAST-MAINT-DT
 18135     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18136                                    AT-PAYMENT-LAST-UPDATED-BY
 18137     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18138     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18139     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18140     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 346
* EL156.cbl
 18141     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18142     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18143     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18144     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18145     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18146     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18147     if pi-int-to-rem-borr = 'Y'
 18148        move 'Q1'                to at-payee-type-cd
 18149     else
 18150        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18151     end-if
 18152     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18153     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18154     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18155     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18156     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18157                                    AT-TO-BE-WRITTEN-DT
 18158     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18159                                    AT-CHECK-QUE-SEQUENCE
 18160                                    AT-ADDL-RESERVE
 18161     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18162                                    AT-VOID-SELECT-DT
 18163                                    AT-VOID-ACCEPT-DT
 18164                                    AT-VOID-DT
 18165                                    AT-PMT-PROOF-DT
 18166                                    AT-INT-PMT-SELECT-DT
 18167     MOVE ZEROS                  TO AT-DAILY-RATE
 18168                                    AT-ELIMINATION-DAYS
 18169     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18170*    EXEC CICS HANDLE CONDITION
 18171*        DUPREC    (7120-DUPREC)
 18172*    END-EXEC
 18173     .
 18174 7115-WRITE-INT-TRLR.
 18175
 18176* EXEC CICS WRITE
 18177*         DATASET       ('ELTRLR')
 18178*         FROM          (ACTIVITY-TRAILERS)
 18179*         RIDFLD        (AT-CONTROL-PRIMARY)
 18180*         RESP          (WS-RESPONSE)
 18181*     END-EXEC
 18182     MOVE LENGTH OF
 18183      ACTIVITY-TRAILERS
 18184       TO DFHEIV11
 18185     MOVE 'ELTRLR' TO DFHEIV1
 18186*    MOVE '&$ L                  ''  N#00016656' TO DFHEIV0
 18187     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18189     MOVE X'204E233030303136363536' TO DFHEIV0(25:11)
 18190     CALL 'kxdfhei1' USING DFHEIV0,
 18191           DFHEIV1,
 18192           ACTIVITY-TRAILERS,
 18193           DFHEIV11,
 18194           AT-CONTROL-PRIMARY,
 18195           DFHEIV99,
 18196           DFHEIV99
 18197     MOVE EIBRESP  TO WS-RESPONSE
 18198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 347
* EL156.cbl
 18199      IF WS-RESP-DUPREC
 18200         GO TO 7120-DUPREC
 18201      END-IF
 18202     GO TO 7130-EXIT
 18203     .
 18204 7120-DUPREC.
 18205     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18206     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18207     GO TO 7115-WRITE-INT-TRLR
 18208     .
 18209 7130-EXIT.
 18210      EXIT.
 18211 7140-BUILD-NOTE-TRLR.
 18212
 18213
 18214* EXEC CICS GETMAIN
 18215*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18216*         LENGTH    (200)
 18217*         INITIMG   (GETMAIN-SPACE)
 18218*     END-EXEC
 18219     MOVE 200
 18220       TO DFHEIV11
 18221*    MOVE ',"IL                  $   #00016676' TO DFHEIV0
 18222     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18224     MOVE X'2020233030303136363736' TO DFHEIV0(25:11)
 18225     CALL 'kxdfhei1' USING DFHEIV0,
 18226           DFHEIV20,
 18227           DFHEIV11,
 18228           GETMAIN-SPACE
 18229     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18230         DFHEIV20
 18231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18232     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18233     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18234     MOVE 'AT'                   TO AT-RECORD-ID
 18235     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18236     MOVE '6'                    TO AT-TRAILER-TYPE
 18237     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18238                                    AT-GEN-INFO-LAST-MAINT-DT
 18239     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18240                                    AT-GEN-INFO-LAST-UPDATED-BY
 18241     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18242     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18243     .
 18244 7150-WRITE.
 18245
 18246* EXEC CICS HANDLE CONDITION
 18247*        DUPREC    (7160-DUPREC)
 18248*    END-EXEC
 18249*    MOVE '"$%                   ! : #00016694' TO DFHEIV0
 18250     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18252     MOVE X'3A20233030303136363934' TO DFHEIV0(25:11)
 18253     CALL 'kxdfhei1' USING DFHEIV0
 18254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18255
 18256* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 348
* EL156.cbl
 18257*         DATASET     ('ELTRLR')
 18258*         FROM        (ACTIVITY-TRAILERS)
 18259*         RIDFLD      (AT-CONTROL-PRIMARY)
 18260*         RESP        (WS-RESPONSE)
 18261*     END-EXEC
 18262     MOVE LENGTH OF
 18263      ACTIVITY-TRAILERS
 18264       TO DFHEIV11
 18265     MOVE 'ELTRLR' TO DFHEIV1
 18266*    MOVE '&$ L                  ''  N#00016697' TO DFHEIV0
 18267     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18268     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18269     MOVE X'204E233030303136363937' TO DFHEIV0(25:11)
 18270     CALL 'kxdfhei1' USING DFHEIV0,
 18271           DFHEIV1,
 18272           ACTIVITY-TRAILERS,
 18273           DFHEIV11,
 18274           AT-CONTROL-PRIMARY,
 18275           DFHEIV99,
 18276           DFHEIV99
 18277     MOVE EIBRESP  TO WS-RESPONSE
 18278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18279      IF WS-RESP-DUPREC
 18280         GO TO 7160-DUPREC
 18281      END-IF
 18282     GO TO 7170-EXIT
 18283     .
 18284 7160-DUPREC.
 18285     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18286     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18287     GO TO 7150-WRITE
 18288     .
 18289 7170-EXIT.
 18290      EXIT.
 18291
 18292 7180-ADD-CERT-NOTE.
 18293*ADD CERT NOTE FOR SC NP+6
 18294
 18295
 18296* EXEC CICS GETMAIN
 18297*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18298*         LENGTH    (150)
 18299*         INITIMG   (GETMAIN-SPACE)
 18300*     END-EXEC.
 18301     MOVE 150
 18302       TO DFHEIV11
 18303*    MOVE ',"IL                  $   #00016719' TO DFHEIV0
 18304     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18305     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18306     MOVE X'2020233030303136373139' TO DFHEIV0(25:11)
 18307     CALL 'kxdfhei1' USING DFHEIV0,
 18308           DFHEIV20,
 18309           DFHEIV11,
 18310           GETMAIN-SPACE
 18311     SET ADDRESS OF CERT-NOTE-FILE TO
 18312         DFHEIV20
 18313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18314
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 349
* EL156.cbl
 18315
 18316     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18317     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18318     MOVE +1                     TO WRK-NOTE-SEQ.
 18319     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18320     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18321     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18322     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18323     MOVE CL-CERT-STATE          TO CZ-STATE.
 18324     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18325     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18326     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18327     MOVE '2'                    TO CZ-RECORD-TYPE.
 18328     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18329     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18330     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18331     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18332     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18333     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18334     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18335     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18336     IF PI-COMPANY-ID = 'AHL'
 18337        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18338           CONTINUE
 18339        ELSE
 18340           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18341              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18342           ELSE
 18343              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18344           END-IF
 18345        END-IF
 18346     END-IF
 18347     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18348     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18349
 18350 7181-WRITE.
 18351
 18352
 18353* EXEC CICS WRITE
 18354*         DATASET     ('ERCNOT')
 18355*         FROM        (CERT-NOTE-FILE)
 18356*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18357*         RESP        (WS-RESPONSE)
 18358*    END-EXEC.
 18359     MOVE LENGTH OF
 18360      CERT-NOTE-FILE
 18361       TO DFHEIV11
 18362     MOVE 'ERCNOT' TO DFHEIV1
 18363*    MOVE '&$ L                  ''  N#00016761' TO DFHEIV0
 18364     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18366     MOVE X'204E233030303136373631' TO DFHEIV0(25:11)
 18367     CALL 'kxdfhei1' USING DFHEIV0,
 18368           DFHEIV1,
 18369           CERT-NOTE-FILE,
 18370           DFHEIV11,
 18371           CZ-CONTROL-PRIMARY,
 18372           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 350
* EL156.cbl
 18373           DFHEIV99
 18374     MOVE EIBRESP  TO WS-RESPONSE
 18375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18376
 18377
 18378     IF WS-RESP-DUPREC
 18379         GO TO 7182-DUPREC
 18380     END-IF.
 18381
 18382     SET CERT-NOTE-ADDED TO TRUE.
 18383
 18384     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18385         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18386     END-IF.
 18387
 18388     GO TO 7189-EXIT.
 18389
 18390 7182-DUPREC.
 18391
 18392     ADD +1                      TO  WRK-NOTE-SEQ.
 18393     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18394     GO TO 7181-WRITE.
 18395
 18396 7189-EXIT.
 18397      EXIT.
 18398
 18399 7190-ADD-ORIG-NOTE.
 18400
 18401
 18402* EXEC CICS GETMAIN
 18403*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18404*         LENGTH    (150)
 18405*         INITIMG   (GETMAIN-SPACE)
 18406*     END-EXEC.
 18407     MOVE 150
 18408       TO DFHEIV11
 18409*    MOVE ',"IL                  $   #00016791' TO DFHEIV0
 18410     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303136373931' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0,
 18414           DFHEIV20,
 18415           DFHEIV11,
 18416           GETMAIN-SPACE
 18417     SET ADDRESS OF CERT-NOTE-FILE TO
 18418         DFHEIV20
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18420
 18421
 18422     ADD +1                      TO WRK-NOTE-SEQ.
 18423     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18424     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18425     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18426     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18427     MOVE CL-CERT-STATE          TO CZ-STATE.
 18428     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18429     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18430     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 351
* EL156.cbl
 18431     MOVE '2'                    TO CZ-RECORD-TYPE.
 18432     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18433     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18434     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18435     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18436     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18437     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18438
 18439 7191-WRITE.
 18440
 18441
 18442* EXEC CICS WRITE
 18443*         DATASET     ('ERCNOT')
 18444*         FROM        (CERT-NOTE-FILE)
 18445*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18446*         RESP        (WS-RESPONSE)
 18447*    END-EXEC.
 18448     MOVE LENGTH OF
 18449      CERT-NOTE-FILE
 18450       TO DFHEIV11
 18451     MOVE 'ERCNOT' TO DFHEIV1
 18452*    MOVE '&$ L                  ''  N#00016816' TO DFHEIV0
 18453     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18455     MOVE X'204E233030303136383136' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0,
 18457           DFHEIV1,
 18458           CERT-NOTE-FILE,
 18459           DFHEIV11,
 18460           CZ-CONTROL-PRIMARY,
 18461           DFHEIV99,
 18462           DFHEIV99
 18463     MOVE EIBRESP  TO WS-RESPONSE
 18464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18465
 18466
 18467     IF WS-RESP-DUPREC
 18468         GO TO 7192-DUPREC
 18469     END-IF.
 18470
 18471     GO TO 7199-EXIT.
 18472
 18473 7192-DUPREC.
 18474
 18475     ADD +1                      TO  WRK-NOTE-SEQ.
 18476     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18477     GO TO 7191-WRITE.
 18478
 18479 7199-EXIT.
 18480      EXIT.
 18481 7200-FIND-BENEFIT.
 18482     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18483
 18484
 18485* EXEC CICS HANDLE CONDITION
 18486*        ENDFILE(7200-EXIT)
 18487*        NOTFND(7200-EXIT)
 18488*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 352
* EL156.cbl
 18489*    MOVE '"$''I                  ! ; #00016840' TO DFHEIV0
 18490     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18492     MOVE X'3B20233030303136383430' TO DFHEIV0(25:11)
 18493     CALL 'kxdfhei1' USING DFHEIV0
 18494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18495
 18496
 18497
 18498* EXEC CICS READ
 18499*        DATASET('ELCNTL')
 18500*        SET(ADDRESS OF CONTROL-FILE)
 18501*        RIDFLD(ELCNTL-KEY)
 18502*        GTEQ
 18503*    END-EXEC.
 18504     MOVE 'ELCNTL' TO DFHEIV1
 18505*    MOVE '&"S        G          (   #00016845' TO DFHEIV0
 18506     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18508     MOVE X'2020233030303136383435' TO DFHEIV0(25:11)
 18509     CALL 'kxdfhei1' USING DFHEIV0,
 18510           DFHEIV1,
 18511           DFHEIV20,
 18512           DFHEIV99,
 18513           ELCNTL-KEY,
 18514           DFHEIV99,
 18515           DFHEIV99,
 18516           DFHEIV99
 18517     SET ADDRESS OF CONTROL-FILE TO
 18518         DFHEIV20
 18519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18520
 18521
 18522     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18523        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18524           GO TO 7200-EXIT.
 18525
 18526     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18527         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18528            ((SUB-1 > 8) OR
 18529            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18530
 18531     IF SUB-1 NOT = 9
 18532         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18533
 18534     GO TO 7200-EXIT.
 18535
 18536 7200-BENEFIT-DUMMY.
 18537
 18538 7200-DUMMY-EXIT.
 18539     EXIT.
 18540
 18541 7200-EXIT.
 18542     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 353
* EL156.cbl
 18544*052506
 18545*052506 7250-FIND-LETTER-TRLR.
 18546*052506     EXEC CICS HANDLE CONDITION
 18547*052506         ENDFILE  (7250-END)
 18548*052506         NOTFND   (7250-END)
 18549*052506     END-EXEC.
 18550*052506
 18551*052506     EXEC CICS STARTBR
 18552*052506         DATASET   ('ELTRLR')
 18553*052506         RIDFLD    (ELTRLR-KEY)
 18554*052506         GTEQ
 18555*052506     END-EXEC.
 18556*052506
 18557*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18558*052506
 18559*052506 7250-FIND-LOOP.
 18560*052506     EXEC CICS READNEXT
 18561*052506         DATASET   ('ELTRLR')
 18562*052506         RIDFLD    (ELTRLR-KEY)
 18563*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18564*052506     END-EXEC.
 18565*052506
 18566*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18567*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18568*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18569*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18570*052506        GO TO 7250-END
 18571*052506     END-IF.
 18572*052506
 18573*052506     IF AT-TRAILER-TYPE NOT = '4'
 18574*052506         GO TO 7250-FIND-LOOP
 18575*052506     END-IF.
 18576*052506
 18577*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18578*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18579*052506     END-IF.
 18580*052506
 18581*052506     GO TO 7250-FIND-LOOP.
 18582*052506
 18583*052506 7250-END.
 18584*052506
 18585*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18586*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18587*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18588*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18589*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18590*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18591*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18592*052506     END-IF.
 18593*052506
 18594*052506     EXEC CICS ENDBR
 18595*052506          DATASET    ('ELTRLR')
 18596*052506     END-EXEC.
 18597*052506
 18598*052506 7250-EXIT.
 18599*052506     EXIT.
 18600*052506     EJECT
 18601*052506
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 354
* EL156.cbl
 18602 7300-CHECK-AUTO-ACTIVITY.
 18603
 18604     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18605         NEXT SENTENCE
 18606     ELSE
 18607         GO TO 7399-EXIT.
 18608
 18609     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18610
 18611     IF WS-ACT-REC-FOUND-SW = 'N'
 18612         GO TO 7399-EXIT.
 18613
 18614     IF PI-ACTIVITY-CODE = 09
 18615         GO TO 7300-CONT-AUTO-ACTIVITY.
 18616
 18617     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18618        (PI-ACTIVITY-CODE = 11)
 18619         GO TO 7300-CONT-AUTO-ACTIVITY.
 18620
 18621     IF PI-PROVISIONAL-IND = 'P'
 18622         IF PI-PMTTYPE = '1'
 18623             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18624                 MOVE 'N'    TO  PI-RESET-SW
 18625                 GO TO 7399-EXIT.
 18626
 18627     IF PI-PMTTYPE = '1'
 18628         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18629             MOVE 'N'        TO  PI-RESET-SW
 18630             GO TO 7399-EXIT.
 18631
 18632     IF PI-PMTTYPE = '2' OR '3'
 18633         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18634             MOVE 'N'        TO  PI-RESET-SW
 18635             GO TO 7399-EXIT.
 18636
 18637     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18638         IF PI-PROVISIONAL-IND = 'P'
 18639             NEXT SENTENCE
 18640         ELSE
 18641             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18642
 18643 7300-CONT-AUTO-ACTIVITY.
 18644
 18645     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18646         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18647         MOVE '4'            TO DC-OPTION-CODE
 18648         MOVE +0             TO DC-ELAPSED-DAYS
 18649                                DC-ELAPSED-MONTHS
 18650         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18651         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18652         IF PI-USES-PAID-TO
 18653             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18654             IF NO-CONVERSION-ERROR
 18655                 MOVE +1     TO DC-ELAPSED-DAYS
 18656                 MOVE +0     TO DC-ELAPSED-MONTHS
 18657                 MOVE '6'    TO DC-OPTION-CODE
 18658                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18659                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 355
* EL156.cbl
 18660                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18661
 18662     IF PI-PFKEY-USED = DFHPF5
 18663         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18664         IF PI-USES-PAID-TO
 18665             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18666             MOVE +1                  TO DC-ELAPSED-DAYS
 18667             MOVE +0                  TO DC-ELAPSED-MONTHS
 18668             MOVE '6'                 TO DC-OPTION-CODE
 18669             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18670             IF NO-CONVERSION-ERROR
 18671                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18672
 18673     IF WS-CHK-THRU-DT < PI-EXP-DT
 18674         NEXT SENTENCE
 18675     ELSE
 18676         MOVE 03                     TO  WS-ACTIVITY-CODE
 18677         GO TO 7390-PROCESS-ACTIVITY.
 18678
 18679     IF PI-PROV-PMT
 18680         MOVE 09                     TO  WS-ACTIVITY-CODE
 18681     ELSE
 18682        IF PI-PMTTYPE = '1'
 18683            MOVE 02                  TO  WS-ACTIVITY-CODE
 18684        ELSE
 18685        IF PI-PMTTYPE = '2' OR '3'
 18686            MOVE 07                  TO  WS-ACTIVITY-CODE
 18687        ELSE
 18688        IF PI-PMTTYPE = '4'
 18689            MOVE 00                  TO  WS-ACTIVITY-CODE
 18690        ELSE
 18691            MOVE 'N'                 TO  PI-RESET-SW
 18692            GO TO 7399-EXIT.
 18693
 18694 7390-PROCESS-ACTIVITY.
 18695
 18696     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18697
 18698 7399-EXIT.
 18699     EXIT.
 18700
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 356
* EL156.cbl
 18702 7400-CHECK-AUTO-ACTIVITY.
 18703
 18704
 18705* EXEC CICS HANDLE CONDITION
 18706*        NOTFND   (7400-NOT-FOUND)
 18707*    END-EXEC.
 18708*    MOVE '"$I                   ! < #00017034' TO DFHEIV0
 18709     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18711     MOVE X'3C20233030303137303334' TO DFHEIV0(25:11)
 18712     CALL 'kxdfhei1' USING DFHEIV0
 18713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18714
 18715
 18716     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18717     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18718     MOVE SPACES                 TO  CNTL-ACCESS.
 18719     MOVE +0                     TO  CNTL-SEQ-NO.
 18720
 18721
 18722* EXEC CICS READ
 18723*        DATASET   ('ELCNTL')
 18724*        RIDFLD    (ELCNTL-KEY)
 18725*        SET       (ADDRESS OF CONTROL-FILE)
 18726*    END-EXEC.
 18727     MOVE 'ELCNTL' TO DFHEIV1
 18728*    MOVE '&"S        E          (   #00017043' TO DFHEIV0
 18729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18731     MOVE X'2020233030303137303433' TO DFHEIV0(25:11)
 18732     CALL 'kxdfhei1' USING DFHEIV0,
 18733           DFHEIV1,
 18734           DFHEIV20,
 18735           DFHEIV99,
 18736           ELCNTL-KEY,
 18737           DFHEIV99,
 18738           DFHEIV99,
 18739           DFHEIV99
 18740     SET ADDRESS OF CONTROL-FILE TO
 18741         DFHEIV20
 18742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18743
 18744
 18745     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18746     GO TO 7400-EXIT.
 18747
 18748 7400-NOT-FOUND.
 18749     MOVE 'N'                        TO  PI-RESET-SW
 18750                                         WS-LETTER-SW
 18751                                         WS-ACT-REC-FOUND-SW.
 18752
 18753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18754
 18755 7400-EXIT.
 18756     EXIT.
 18757
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 357
* EL156.cbl
 18759 7450-FORMAT-AUTO-LETTER.
 18760
 18761     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18762         MOVE 'Y'                    TO PI-RESET-SW
 18763         GO TO 7450-CONTINUE-PROCESS.
 18764
 18765     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18766
 18767     IF SUB > 9
 18768         SUBTRACT 9 FROM SUB
 18769         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18770     ELSE
 18771         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18772
 18773 7450-CONTINUE-PROCESS.
 18774
 18775     IF WS-ACTIVITY-CODE = ZEROS
 18776         MOVE 'N'                    TO  WS-LETTER-SW
 18777         GO TO 7450-EXIT.
 18778
 18779     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18780
 18781     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18782         MOVE 'N'                    TO  PI-RESET-SW
 18783                                         WS-LETTER-SW
 18784         GO TO 7450-EXIT.
 18785
 18786     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18787         MOVE 'N'                    TO  WS-LETTER-SW
 18788         GO TO 7450-EXIT.
 18789
 18790     MOVE 'Y'                        TO  WS-LETTER-SW.
 18791     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18792     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18793
 18794     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18795
 18796     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18797         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18798         MOVE '6'                    TO  DC-OPTION-CODE
 18799         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18800         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18801         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18802         IF NO-CONVERSION-ERROR
 18803             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18804         ELSE
 18805              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18806
 18807     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18808         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18809         MOVE '6'                    TO  DC-OPTION-CODE
 18810         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18811         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18812         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18813         IF NO-CONVERSION-ERROR
 18814             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18815         ELSE
 18816             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 358
* EL156.cbl
 18817
 18818 7450-EXIT.
 18819     EXIT.
 18820
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 359
* EL156.cbl
 18822 7500-RESET-AUTO-ACTIVITY.
 18823
 18824     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18825     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18826     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18827     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18828     MOVE +100                   TO  TRLR-SEQ-NO.
 18829
 18830 7500-STARTBR-TRLR.
 18831
 18832
 18833* EXEC CICS HANDLE CONDITION
 18834*        ENDFILE  (7590-END)
 18835*        NOTFND   (7590-END)
 18836*    END-EXEC.
 18837*    MOVE '"$''I                  ! = #00017136' TO DFHEIV0
 18838     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18840     MOVE X'3D20233030303137313336' TO DFHEIV0(25:11)
 18841     CALL 'kxdfhei1' USING DFHEIV0
 18842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18843
 18844
 18845
 18846* EXEC CICS STARTBR
 18847*        DATASET   ('ELTRLR')
 18848*        RIDFLD    (ELTRLR-KEY)
 18849*        GTEQ
 18850*    END-EXEC.
 18851     MOVE 'ELTRLR' TO DFHEIV1
 18852     MOVE 0
 18853       TO DFHEIV11
 18854*    MOVE '&,         G          &   #00017141' TO DFHEIV0
 18855     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18857     MOVE X'2020233030303137313431' TO DFHEIV0(25:11)
 18858     CALL 'kxdfhei1' USING DFHEIV0,
 18859           DFHEIV1,
 18860           ELTRLR-KEY,
 18861           DFHEIV99,
 18862           DFHEIV11,
 18863           DFHEIV99
 18864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18865
 18866
 18867     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18868
 18869 7500-READ-NEXT.
 18870
 18871
 18872* EXEC CICS READNEXT
 18873*        DATASET   ('ELTRLR')
 18874*        RIDFLD    (ELTRLR-KEY)
 18875*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18876*    END-EXEC.
 18877     MOVE 'ELTRLR' TO DFHEIV1
 18878     MOVE 0
 18879       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 360
* EL156.cbl
 18880*    MOVE '&.S                   )   #00017151' TO DFHEIV0
 18881     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18882     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18883     MOVE X'2020233030303137313531' TO DFHEIV0(25:11)
 18884     CALL 'kxdfhei1' USING DFHEIV0,
 18885           DFHEIV1,
 18886           DFHEIV20,
 18887           DFHEIV99,
 18888           ELTRLR-KEY,
 18889           DFHEIV99,
 18890           DFHEIV11,
 18891           DFHEIV99,
 18892           DFHEIV99
 18893     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18894         DFHEIV20
 18895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18896
 18897
 18898     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18899        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18900        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18901        PI-CERT-NO    NOT = TRLR-CERT-NO
 18902         GO TO 7590-END.
 18903
 18904     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18905         GO TO 7500-READ-NEXT.
 18906
 18907     IF AT-TRAILER-TYPE NOT = '4'
 18908         GO TO 7500-READ-NEXT.
 18909
 18910     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18911         GO TO 7500-READ-NEXT.
 18912
 18913     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18914        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18915         GO TO 7500-READ-NEXT.
 18916
 18917     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18918        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18919        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18920         GO TO 7500-READ-NEXT.
 18921
 18922     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18923                         AND
 18924        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18925                         AND
 18926        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18927            GO TO 7500-READ-NEXT.
 18928
 18929     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18930
 18931
 18932* EXEC CICS ENDBR
 18933*        DATASET   ('ELTRLR')
 18934*    END-EXEC.
 18935     MOVE 'ELTRLR' TO DFHEIV1
 18936     MOVE 0
 18937       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 361
* EL156.cbl
 18938*    MOVE '&2                    $   #00017190' TO DFHEIV0
 18939     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18941     MOVE X'2020233030303137313930' TO DFHEIV0(25:11)
 18942     CALL 'kxdfhei1' USING DFHEIV0,
 18943           DFHEIV1,
 18944           DFHEIV11,
 18945           DFHEIV99
 18946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18947
 18948
 18949     MOVE 'N'                        TO  WS-BROWSE-SW.
 18950
 18951
 18952* EXEC CICS READ
 18953*        DATASET   ('ELTRLR')
 18954*        RIDFLD    (ELTRLR-KEY)
 18955*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18956*        UPDATE
 18957*    END-EXEC.
 18958     MOVE 'ELTRLR' TO DFHEIV1
 18959*    MOVE '&"S        EU         (   #00017196' TO DFHEIV0
 18960     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18961     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18962     MOVE X'2020233030303137313936' TO DFHEIV0(25:11)
 18963     CALL 'kxdfhei1' USING DFHEIV0,
 18964           DFHEIV1,
 18965           DFHEIV20,
 18966           DFHEIV99,
 18967           ELTRLR-KEY,
 18968           DFHEIV99,
 18969           DFHEIV99,
 18970           DFHEIV99
 18971     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18972         DFHEIV20
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18977
 18978     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18979         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18980     ELSE
 18981         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18982             NEXT SENTENCE
 18983         ELSE
 18984             GO TO 7500-REWRITE-TRLR.
 18985
 18986     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18987
 18988     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18989     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18990     MOVE '1'                        TO  ARCH-REC-TYPE.
 18991     MOVE +0                         TO  ARCH-SEQ.
 18992
 18993     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18994
 18995 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 362
* EL156.cbl
 18996
 18997
 18998* EXEC CICS REWRITE
 18999*        DATASET   ('ELTRLR')
 19000*        FROM      (ACTIVITY-TRAILERS)
 19001*    END-EXEC.
 19002     MOVE LENGTH OF
 19003      ACTIVITY-TRAILERS
 19004       TO DFHEIV11
 19005     MOVE 'ELTRLR' TO DFHEIV1
 19006*    MOVE '&& L                  %   #00017224' TO DFHEIV0
 19007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19009     MOVE X'2020233030303137323234' TO DFHEIV0(25:11)
 19010     CALL 'kxdfhei1' USING DFHEIV0,
 19011           DFHEIV1,
 19012           ACTIVITY-TRAILERS,
 19013           DFHEIV11,
 19014           DFHEIV99
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19016
 19017
 19018     GO TO 7500-STARTBR-TRLR.
 19019
 19020 7590-END.
 19021
 19022     IF WS-BROWSE-SW = 'Y'
 19023         MOVE 'N'                    TO  WS-BROWSE-SW
 19024
 19025* EXEC CICS ENDBR
 19026*            DATASET   ('ELTRLR')
 19027*        END-EXEC.
 19028     MOVE 'ELTRLR' TO DFHEIV1
 19029     MOVE 0
 19030       TO DFHEIV11
 19031*    MOVE '&2                    $   #00017235' TO DFHEIV0
 19032     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19034     MOVE X'2020233030303137323335' TO DFHEIV0(25:11)
 19035     CALL 'kxdfhei1' USING DFHEIV0,
 19036           DFHEIV1,
 19037           DFHEIV11,
 19038           DFHEIV99
 19039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19040
 19041
 19042 7599-EXIT.
 19043     EXIT.
 19044
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 363
* EL156.cbl
 19046 7600-READ-ARCH-UPDATE.
 19047
 19048
 19049* EXEC CICS HANDLE CONDITION
 19050*        NOTFND   (7699-EXIT)
 19051*    END-EXEC.
 19052*    MOVE '"$I                   ! > #00017245' TO DFHEIV0
 19053     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19055     MOVE X'3E20233030303137323435' TO DFHEIV0(25:11)
 19056     CALL 'kxdfhei1' USING DFHEIV0
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060
 19061* EXEC CICS READ
 19062*        DATASET   ('ELARCH')
 19063*        RIDFLD    (ELARCH-KEY)
 19064*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19065*        UPDATE
 19066*    END-EXEC.
 19067     MOVE 'ELARCH' TO DFHEIV1
 19068*    MOVE '&"S        EU         (   #00017249' TO DFHEIV0
 19069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19070     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19071     MOVE X'2020233030303137323439' TO DFHEIV0(25:11)
 19072     CALL 'kxdfhei1' USING DFHEIV0,
 19073           DFHEIV1,
 19074           DFHEIV20,
 19075           DFHEIV99,
 19076           ELARCH-KEY,
 19077           DFHEIV99,
 19078           DFHEIV99,
 19079           DFHEIV99
 19080     SET ADDRESS OF LETTER-ARCHIVE TO
 19081         DFHEIV20
 19082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19083
 19084
 19085     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19086
 19087
 19088* EXEC CICS REWRITE
 19089*        DATASET   ('ELARCH')
 19090*        FROM      (LETTER-ARCHIVE)
 19091*    END-EXEC.
 19092     MOVE LENGTH OF
 19093      LETTER-ARCHIVE
 19094       TO DFHEIV11
 19095     MOVE 'ELARCH' TO DFHEIV1
 19096*    MOVE '&& L                  %   #00017258' TO DFHEIV0
 19097     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303137323538' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           DFHEIV1,
 19102           LETTER-ARCHIVE,
 19103           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 364
* EL156.cbl
 19104           DFHEIV99
 19105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19106
 19107
 19108 7699-EXIT.
 19109     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 365
* EL156.cbl
 19111 7700-GET-DCT.
 19112
 19113     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19114     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19115     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19116     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19117                                    PI-MAX-BENEFIT-AMT
 19118                                    PI-MAX-BENEFIT-PYMT
 19119                                    PI-MIN-PAYMENT-AMT
 19120                                    PI-TIME-OF-LOSS-BAL.
 19121
 19122
 19123* EXEC CICS HANDLE CONDITION
 19124*         NOTFND (5300-NOTE-NOT-FOUND)
 19125*     END-EXEC.
 19126*    MOVE '"$I                   ! ? #00017277' TO DFHEIV0
 19127     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19129     MOVE X'3F20233030303137323737' TO DFHEIV0(25:11)
 19130     CALL 'kxdfhei1' USING DFHEIV0
 19131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19132
 19133
 19134
 19135* EXEC CICS READ
 19136*         DATASET('ERNOTE')
 19137*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19138*         RIDFLD (W-NOTE-KEY)
 19139*     END-EXEC.
 19140     MOVE 'ERNOTE' TO DFHEIV1
 19141*    MOVE '&"S        E          (   #00017281' TO DFHEIV0
 19142     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19144     MOVE X'2020233030303137323831' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0,
 19146           DFHEIV1,
 19147           DFHEIV20,
 19148           DFHEIV99,
 19149           W-NOTE-KEY,
 19150           DFHEIV99,
 19151           DFHEIV99,
 19152           DFHEIV99
 19153     SET ADDRESS OF CERTIFICATE-NOTE TO
 19154         DFHEIV20
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19159     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19160     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19161     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19162     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19163
 19164     IF PI-PAYEE-TYPE NOT = 'B'
 19165         GO TO 7700-EXIT.
 19166
 19167     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19168     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 366
* EL156.cbl
 19169     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19170
 19171     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19172         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19173     ELSE
 19174         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19175
 19176     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19177     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19178     MOVE 'DLO006'               TO PGM-NAME.
 19179
 19180
 19181* EXEC CICS LINK
 19182*        PROGRAM    (PGM-NAME)
 19183*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19184*        LENGTH     (DCT-RCRD-LENGTH)
 19185*    END-EXEC.
 19186*    MOVE '."C                   (   #00017309' TO DFHEIV0
 19187     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19189     MOVE X'2020233030303137333039' TO DFHEIV0(25:11)
 19190     CALL 'kxdfhei1' USING DFHEIV0,
 19191           PGM-NAME,
 19192           DCT-COMMUNICATION-AREA,
 19193           DCT-RCRD-LENGTH,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99,
 19197           DFHEIV99
 19198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19199
 19200
 19201     IF DCT-RETURN-CODE = 'OK'
 19202         GO TO 7700-CONT.
 19203
 19204     IF DCT-RETURN-CODE = '01' OR '02'
 19205         GO TO 7700-SET-TO-YES.
 19206
 19207     IF DCT-RETURN-CODE = '03'
 19208
 19209* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19210*    MOVE '6"R                   !   #00017322' TO DFHEIV0
 19211     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19213     MOVE X'2020233030303137333232' TO DFHEIV0(25:11)
 19214     CALL 'kxdfhei1' USING DFHEIV0
 19215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19216         MOVE ER-0951            TO EMI-ERROR
 19217         MOVE -1                 TO PMTTYPEL
 19218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19219         GO TO 8200-SEND-DATAONLY.
 19220
 19221     IF DCT-RETURN-CODE = '04'
 19222
 19223* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19224*    MOVE '6"R                   !   #00017329' TO DFHEIV0
 19225     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 367
* EL156.cbl
 19227     MOVE X'2020233030303137333239' TO DFHEIV0(25:11)
 19228     CALL 'kxdfhei1' USING DFHEIV0
 19229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19230         MOVE ER-0946            TO EMI-ERROR
 19231         MOVE -1                 TO PMTTYPEL
 19232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19233         GO TO 8200-SEND-DATAONLY.
 19234
 19235     IF DCT-RETURN-CODE = '05'
 19236
 19237* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19238*    MOVE '6"R                   !   #00017336' TO DFHEIV0
 19239     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19240     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19241     MOVE X'2020233030303137333336' TO DFHEIV0(25:11)
 19242     CALL 'kxdfhei1' USING DFHEIV0
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19244         MOVE ER-0947            TO EMI-ERROR
 19245         MOVE -1                 TO PMTTYPEL
 19246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19247         GO TO 8200-SEND-DATAONLY.
 19248
 19249     IF DCT-RETURN-CODE = '06'
 19250
 19251* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19252*    MOVE '6"R                   !   #00017343' TO DFHEIV0
 19253     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19255     MOVE X'2020233030303137333433' TO DFHEIV0(25:11)
 19256     CALL 'kxdfhei1' USING DFHEIV0
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19258         MOVE ER-0921            TO EMI-ERROR
 19259         MOVE -1                 TO PMTTYPEL
 19260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19261         GO TO 8200-SEND-DATAONLY.
 19262
 19263     IF DCT-RETURN-CODE = '07'
 19264
 19265* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19266*    MOVE '6"R                   !   #00017350' TO DFHEIV0
 19267     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19269     MOVE X'2020233030303137333530' TO DFHEIV0(25:11)
 19270     CALL 'kxdfhei1' USING DFHEIV0
 19271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19272         MOVE ER-0919            TO EMI-ERROR
 19273         MOVE -1                 TO PMTTYPEL
 19274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19275         GO TO 8200-SEND-DATAONLY.
 19276
 19277     IF DCT-RETURN-CODE = '08'
 19278
 19279* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19280*    MOVE '6"R                   !   #00017357' TO DFHEIV0
 19281     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19283     MOVE X'2020233030303137333537' TO DFHEIV0(25:11)
 19284     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 368
* EL156.cbl
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19286         MOVE ER-0948            TO EMI-ERROR
 19287         MOVE -1                 TO PMTTYPEL
 19288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19289         GO TO 8200-SEND-DATAONLY.
 19290
 19291     IF DCT-RETURN-CODE = 'N1'
 19292
 19293* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19294*    MOVE '6"R                   !   #00017364' TO DFHEIV0
 19295     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303137333634' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19300         MOVE ER-0950            TO EMI-ERROR
 19301         MOVE -1                 TO PMTTYPEL
 19302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19303         GO TO 8200-SEND-DATAONLY.
 19304
 19305     IF DCT-RETURN-CODE = 'E1'
 19306
 19307* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19308*    MOVE '6"R                   !   #00017371' TO DFHEIV0
 19309     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303137333731' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0
 19313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19314         MOVE ER-0974            TO EMI-ERROR
 19315         MOVE -1                 TO PMTTYPEL
 19316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19317         GO TO 8200-SEND-DATAONLY.
 19318
 19319     IF DCT-RETURN-CODE = 'E2'
 19320
 19321* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19322*    MOVE '6"R                   !   #00017378' TO DFHEIV0
 19323     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19325     MOVE X'2020233030303137333738' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0
 19327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19328         MOVE ER-0975            TO EMI-ERROR
 19329         MOVE -1                 TO PMTTYPEL
 19330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19331         GO TO 8200-SEND-DATAONLY.
 19332
 19333     IF DCT-RETURN-CODE NOT = 'OK'
 19334
 19335* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19336*    MOVE '6"R                   !   #00017385' TO DFHEIV0
 19337     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19339     MOVE X'2020233030303137333835' TO DFHEIV0(25:11)
 19340     CALL 'kxdfhei1' USING DFHEIV0
 19341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19342         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 369
* EL156.cbl
 19343         MOVE -1                 TO PMTTYPEL
 19344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19345         GO TO 8200-SEND-DATAONLY.
 19346
 19347 7700-CONT.
 19348
 19349*    MOVE 'N'                    TO CASHO.
 19350*    MOVE +1                     TO CASHL.
 19351*    MOVE AL-UANON               TO CASHA.
 19352
 19353     IF PI-OFFLINE = 'Y'
 19354         GO TO 7700-EXIT.
 19355
 19356     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19357     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19358     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19359     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19360     MOVE +7                     TO CHECKNOL.
 19361     MOVE AL-UANON               TO CHECKNOA.
 19362     GO TO 7700-EXIT.
 19363
 19364 7700-SET-TO-YES.
 19365
 19366*    MOVE 'Y'                    TO CASHO.
 19367*    MOVE +1                     TO CASHL.
 19368*    MOVE AL-UANON               TO CASHA.
 19369
 19370 7700-EXIT.
 19371     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 370
* EL156.cbl
 19373 7800-READ-COMP-MSTR.
 19374
 19375
 19376* EXEC CICS HANDLE CONDITION
 19377*        NOTFND   (7800-COMP-NOTFND)
 19378*    END-EXEC.
 19379*    MOVE '"$I                   ! @ #00017419' TO DFHEIV0
 19380     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19382     MOVE X'4020233030303137343139' TO DFHEIV0(25:11)
 19383     CALL 'kxdfhei1' USING DFHEIV0
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387
 19388* EXEC CICS READ
 19389*        DATASET   ('ERCOMP')
 19390*        RIDFLD    (ERCOMP-KEY)
 19391*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19392*    END-EXEC.
 19393     MOVE 'ERCOMP' TO DFHEIV1
 19394*    MOVE '&"S        E          (   #00017423' TO DFHEIV0
 19395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19397     MOVE X'2020233030303137343233' TO DFHEIV0(25:11)
 19398     CALL 'kxdfhei1' USING DFHEIV0,
 19399           DFHEIV1,
 19400           DFHEIV20,
 19401           DFHEIV99,
 19402           ERCOMP-KEY,
 19403           DFHEIV99,
 19404           DFHEIV99,
 19405           DFHEIV99
 19406     SET ADDRESS OF COMPENSATION-MASTER TO
 19407         DFHEIV20
 19408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19409
 19410
 19411     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19412     GO TO 7800-COMP-EXIT.
 19413
 19414 7800-COMP-NOTFND.
 19415     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19416
 19417 7800-COMP-EXIT.
 19418     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 371
* EL156.cbl
 19420 7900-READ-CLAIM.
 19421
 19422* EXEC CICS READ
 19423*        DATASET  ('ELMSTR')
 19424*        SET      (ADDRESS OF CLAIM-MASTER)
 19425*        RIDFLD   (ELMSTR-KEY)
 19426*    END-EXEC.
 19427     MOVE 'ELMSTR' TO DFHEIV1
 19428*    MOVE '&"S        E          (   #00017439' TO DFHEIV0
 19429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           DFHEIV1,
 19434           DFHEIV20,
 19435           DFHEIV99,
 19436           ELMSTR-KEY,
 19437           DFHEIV99,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     SET ADDRESS OF CLAIM-MASTER TO
 19441         DFHEIV20
 19442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19443
 19444
 19445 7900-EXIT.
 19446      EXIT.
 19447
 19448 7910-READ-CLAIM-UPDATE.
 19449
 19450* EXEC CICS READ
 19451*        DATASET  ('ELMSTR')
 19452*        SET      (ADDRESS OF CLAIM-MASTER)
 19453*        RIDFLD   (ELMSTR-KEY)
 19454*        UPDATE
 19455*    END-EXEC.
 19456     MOVE 'ELMSTR' TO DFHEIV1
 19457*    MOVE '&"S        EU         (   #00017449' TO DFHEIV0
 19458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19459     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19460     MOVE X'2020233030303137343439' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0,
 19462           DFHEIV1,
 19463           DFHEIV20,
 19464           DFHEIV99,
 19465           ELMSTR-KEY,
 19466           DFHEIV99,
 19467           DFHEIV99,
 19468           DFHEIV99
 19469     SET ADDRESS OF CLAIM-MASTER TO
 19470         DFHEIV20
 19471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19472
 19473
 19474 7910-EXIT.
 19475      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 372
* EL156.cbl
 19477 7920-READ-BENE.
 19478     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19479     MOVE 'B'                TO BENE-RECORD-TYPE.
 19480     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19481
 19482     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19483        IF PI-PAYEE-TYPE    = 'B' AND
 19484           PI-PAYEE-SEQ-NUM = 9
 19485             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19486             MOVE WS-A-BENE           TO BENE-NUMBER.
 19487
 19488
 19489* EXEC CICS HANDLE CONDITION
 19490*        NOTFND   (7920-NOT-FOUND)
 19491*    END-EXEC.
 19492*    MOVE '"$I                   ! A #00017470' TO DFHEIV0
 19493     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19495     MOVE X'4120233030303137343730' TO DFHEIV0(25:11)
 19496     CALL 'kxdfhei1' USING DFHEIV0
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19498
 19499
 19500
 19501* EXEC CICS READ
 19502*        DATASET  ('ELBENE')
 19503*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19504*        RIDFLD   (ELBENE-KEY)
 19505*    END-EXEC.
 19506     MOVE 'ELBENE' TO DFHEIV1
 19507*    MOVE '&"S        E          (   #00017474' TO DFHEIV0
 19508     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19510     MOVE X'2020233030303137343734' TO DFHEIV0(25:11)
 19511     CALL 'kxdfhei1' USING DFHEIV0,
 19512           DFHEIV1,
 19513           DFHEIV20,
 19514           DFHEIV99,
 19515           ELBENE-KEY,
 19516           DFHEIV99,
 19517           DFHEIV99,
 19518           DFHEIV99
 19519     SET ADDRESS OF BENEFICIARY-MASTER TO
 19520         DFHEIV20
 19521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19522
 19523
 19524     MOVE 'Y' TO BENE-FOUND-SW.
 19525     GO TO 7920-EXIT.
 19526
 19527 7920-NOT-FOUND.
 19528     MOVE 'N'                    TO BENE-FOUND-SW.
 19529
 19530 7920-EXIT.
 19531      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 373
* EL156.cbl
 19533 7930-READ-CONTROL.
 19534
 19535* EXEC CICS READ
 19536*        DATASET  ('ELCNTL')
 19537*        SET      (ADDRESS OF CONTROL-FILE)
 19538*        RIDFLD   (ELCNTL-KEY)
 19539*    END-EXEC.
 19540     MOVE 'ELCNTL' TO DFHEIV1
 19541*    MOVE '&"S        E          (   #00017490' TO DFHEIV0
 19542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19544     MOVE X'2020233030303137343930' TO DFHEIV0(25:11)
 19545     CALL 'kxdfhei1' USING DFHEIV0,
 19546           DFHEIV1,
 19547           DFHEIV20,
 19548           DFHEIV99,
 19549           ELCNTL-KEY,
 19550           DFHEIV99,
 19551           DFHEIV99,
 19552           DFHEIV99
 19553     SET ADDRESS OF CONTROL-FILE TO
 19554         DFHEIV20
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
 19557
 19558 7930-EXIT.
 19559      EXIT.
 19560
 19561 7940-READ-CONTROL-UPDATE.
 19562
 19563* EXEC CICS READ
 19564*        DATASET  ('ELCNTL')
 19565*        SET      (ADDRESS OF CONTROL-FILE)
 19566*        RIDFLD   (ELCNTL-KEY)
 19567*        UPDATE
 19568*    END-EXEC.
 19569     MOVE 'ELCNTL' TO DFHEIV1
 19570*    MOVE '&"S        EU         (   #00017500' TO DFHEIV0
 19571     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19572     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19573     MOVE X'2020233030303137353030' TO DFHEIV0(25:11)
 19574     CALL 'kxdfhei1' USING DFHEIV0,
 19575           DFHEIV1,
 19576           DFHEIV20,
 19577           DFHEIV99,
 19578           ELCNTL-KEY,
 19579           DFHEIV99,
 19580           DFHEIV99,
 19581           DFHEIV99
 19582     SET ADDRESS OF CONTROL-FILE TO
 19583         DFHEIV20
 19584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19585
 19586
 19587 7940-EXIT.
 19588      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 374
* EL156.cbl
 19590 7950-READ-TRAILER.
 19591
 19592* EXEC CICS READ
 19593*        DATASET  ('ELTRLR')
 19594*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19595*        RIDFLD   (ELTRLR-KEY)
 19596*    END-EXEC.
 19597     MOVE 'ELTRLR' TO DFHEIV1
 19598*    MOVE '&"S        E          (   #00017511' TO DFHEIV0
 19599     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303137353131' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0,
 19603           DFHEIV1,
 19604           DFHEIV20,
 19605           DFHEIV99,
 19606           ELTRLR-KEY,
 19607           DFHEIV99,
 19608           DFHEIV99,
 19609           DFHEIV99
 19610     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19611         DFHEIV20
 19612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19613
 19614
 19615 7950-EXIT.
 19616      EXIT.
 19617
 19618 7960-READ-TRAILER-UPDATE.
 19619
 19620* EXEC CICS READ
 19621*        DATASET  ('ELTRLR')
 19622*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19623*        RIDFLD   (ELTRLR-KEY)
 19624*        UPDATE
 19625*    END-EXEC.
 19626     MOVE 'ELTRLR' TO DFHEIV1
 19627*    MOVE '&"S        EU         (   #00017521' TO DFHEIV0
 19628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19629     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19630     MOVE X'2020233030303137353231' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0,
 19632           DFHEIV1,
 19633           DFHEIV20,
 19634           DFHEIV99,
 19635           ELTRLR-KEY,
 19636           DFHEIV99,
 19637           DFHEIV99,
 19638           DFHEIV99
 19639     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19640         DFHEIV20
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644 7960-EXIT.
 19645      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 375
* EL156.cbl
 19647 7970-READ-CERT.
 19648
 19649* EXEC CICS READ
 19650*        DATASET  ('ELCERT')
 19651*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19652*        RIDFLD   (ELCERT-KEY)
 19653*    END-EXEC.
 19654     MOVE 'ELCERT' TO DFHEIV1
 19655*    MOVE '&"S        E          (   #00017532' TO DFHEIV0
 19656     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19657     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19658     MOVE X'2020233030303137353332' TO DFHEIV0(25:11)
 19659     CALL 'kxdfhei1' USING DFHEIV0,
 19660           DFHEIV1,
 19661           DFHEIV20,
 19662           DFHEIV99,
 19663           ELCERT-KEY,
 19664           DFHEIV99,
 19665           DFHEIV99,
 19666           DFHEIV99
 19667     SET ADDRESS OF CERTIFICATE-MASTER TO
 19668         DFHEIV20
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672 7970-EXIT.
 19673      EXIT.
 19674 7975-read-acct.
 19675
 19676     move spaces              to WS-ACCT-RECORD-SW
 19677                                 pi-dcc-product-code
 19678
 19679     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19680     MOVE PI-CARRIER          TO ACCT-CARRIER
 19681     MOVE PI-GROUPING         TO ACCT-GROUPING
 19682     MOVE PI-STATE            TO ACCT-STATE
 19683     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19684     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19685     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19686     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19687
 19688
 19689* EXEC CICS READ
 19690*       DATASET ('ERACCT')
 19691*       RIDFLD  (ERACCT-KEY)
 19692*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19693*       GTEQ
 19694*       resp    (WS-RESPONSE)
 19695*    END-EXEC
 19696     MOVE 'ERACCT' TO DFHEIV1
 19697*    MOVE '&"S        G          (  N#00017554' TO DFHEIV0
 19698     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19700     MOVE X'204E233030303137353534' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           DFHEIV1,
 19703           DFHEIV20,
 19704           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 376
* EL156.cbl
 19705           ERACCT-KEY,
 19706           DFHEIV99,
 19707           DFHEIV99,
 19708           DFHEIV99
 19709     SET ADDRESS OF ACCOUNT-MASTER TO
 19710         DFHEIV20
 19711     MOVE EIBRESP  TO WS-RESPONSE
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19713     IF WS-RESP-NORMAL
 19714        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19715        and pi-cert-eff-dt < am-expiration-dt
 19716        and pi-cert-eff-dt >= am-effective-dt
 19717        move am-dcc-product-code to pi-dcc-product-code
 19718        set acct-found to true
 19719     end-if
 19720
 19721     .
 19722 7975-exit.
 19723     exit.
 19724 7980-READ-CERT-UPDATE.
 19725
 19726* EXEC CICS READ
 19727*        DATASET  ('ELCERT')
 19728*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19729*        RIDFLD   (ELCERT-KEY)
 19730*        UPDATE
 19731*    END-EXEC.
 19732     MOVE 'ELCERT' TO DFHEIV1
 19733*    MOVE '&"S        EU         (   #00017573' TO DFHEIV0
 19734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19735     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19736     MOVE X'2020233030303137353733' TO DFHEIV0(25:11)
 19737     CALL 'kxdfhei1' USING DFHEIV0,
 19738           DFHEIV1,
 19739           DFHEIV20,
 19740           DFHEIV99,
 19741           ELCERT-KEY,
 19742           DFHEIV99,
 19743           DFHEIV99,
 19744           DFHEIV99
 19745     SET ADDRESS OF CERTIFICATE-MASTER TO
 19746         DFHEIV20
 19747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19748
 19749
 19750 7980-EXIT.
 19751      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 377
* EL156.cbl
 19753 8000-LOAD-ERROR-MESSAGES.
 19754     IF PI-PASS-SW = 'C'
 19755        MOVE EMI-LINE1           TO ERMSG1BO
 19756     ELSE
 19757        MOVE EMI-LINE1           TO ERRMSG1O
 19758        MOVE EMI-LINE2           TO ERRMSG2O.
 19759
 19760 8000-EXIT.
 19761     EXIT.
 19762
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 378
* EL156.cbl
 19764
 19765 8010-DMD-ERROR-CHECKS.
 19766     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19767
 19768     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19769         GO TO 8051-ISSUE-ERROR.
 19770
 19771     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19772     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19773     MOVE '3'                    TO DC-OPTION-CODE.
 19774     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19775     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19776         GO TO 8051-ISSUE-ERROR.
 19777
 19778     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19779       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19780                           OR
 19781          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19782           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19783             MOVE ER-0851         TO EMI-ERROR
 19784             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19785       END-IF
 19786       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19787             MOVE ER-8147         TO EMI-ERROR
 19788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19789
 19790     GO TO 8090-EXIT.
 19791
 19792 8051-ISSUE-ERROR.
 19793     MOVE ER-8146            TO EMI-ERROR.
 19794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19795     GO TO 8090-EXIT.
 19796
 19797 8090-EXIT.
 19798      EXIT.
 19799
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 379
* EL156.cbl
 19801 8100-SEND-INITIAL-MAP.
 19802
 19803     MOVE SAVE-DATE              TO RUNDTEAO.
 19804     MOVE EIBTIME                TO TIME-IN.
 19805     MOVE TIME-OUT               TO RUNTIMAO.
 19806     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19807
 19808     IF MAP-NAME = 'EL156A'
 19809        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19810           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19811        END-IF
 19812        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19813           MOVE 'N'     TO SURVYYNO
 19814        END-IF
 19815     END-IF
 19816*    IF MAP-NAME = 'EL156A'
 19817*       IF PI-COMPANY-ID = 'CRI'
 19818*          NEXT SENTENCE
 19819*       ELSE
 19820*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19821
 19822     IF MAP-NAME = 'EL156A'
 19823        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19824           NEXT SENTENCE
 19825        ELSE
 19826           MOVE AL-SADOF TO  PINTA    PINTHA.
 19827
 19828     IF MAP-NAME = 'EL156A'
 19829        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19830            NEXT SENTENCE
 19831        ELSE
 19832           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19833
 19834*    IF MAP-NAME = 'EL156A'
 19835*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19836*          NEXT SENTENCE
 19837*       ELSE
 19838*          MOVE AL-SADOF TO CASHHA CASHA.
 19839
 19840     IF MAP-NAME = 'EL156A'
 19841        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19842                        or 'CAP'
 19843           NEXT SENTENCE
 19844        ELSE
 19845           MOVE AL-SADOF        TO  LOANHA
 19846                                    LOANNOA.
 19847
 19848     IF MAP-NAME = 'EL156A'
 19849        MOVE -1                 TO  ENTERPFL
 19850        IF PI-USES-PAID-TO
 19851           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19852           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19853           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19854        ELSE
 19855           NEXT SENTENCE
 19856     ELSE
 19857        IF MAP-NAME = 'EL156B'
 19858           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 380
* EL156.cbl
 19859              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19860              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19861
 19862
 19863* EXEC CICS SEND
 19864*        MAP   (MAP-NAME)
 19865*        MAPSET(MAPSET-NAME)
 19866*        FROM  (EL156AI)
 19867*        ERASE
 19868*        CURSOR
 19869*    END-EXEC.
 19870     MOVE LENGTH OF
 19871      EL156AI
 19872       TO DFHEIV12
 19873     MOVE -1
 19874       TO DFHEIV11
 19875*    MOVE '8$     CT  E    H L F ,   #00017692' TO DFHEIV0
 19876     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19877     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19878     MOVE X'2020233030303137363932' TO DFHEIV0(25:11)
 19879     CALL 'kxdfhei1' USING DFHEIV0,
 19880           MAP-NAME,
 19881           EL156AI,
 19882           DFHEIV12,
 19883           MAPSET-NAME,
 19884           DFHEIV99,
 19885           DFHEIV99,
 19886           DFHEIV99,
 19887           DFHEIV11,
 19888           DFHEIV99,
 19889           DFHEIV99,
 19890           DFHEIV99
 19891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19892
 19893
 19894     GO TO 9100-RETURN-TRAN.
 19895
 19896 8200-SEND-DATAONLY.
 19897
 19898     IF FIRST-ENTRY = 'Y'
 19899         GO TO 8100-SEND-INITIAL-MAP.
 19900
 19901     IF RETURNED-FROM-B = 'Y'
 19902         GO TO 8100-SEND-INITIAL-MAP.
 19903
 19904     MOVE SAVE-DATE              TO RUNDTEAO.
 19905     MOVE EIBTIME                TO TIME-IN.
 19906     MOVE TIME-OUT               TO RUNTIMAO.
 19907
 19908     IF EIBAID = DFHPF11
 19909        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19910        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19911        MOVE 'EL001   '          TO RETURNED-FROM
 19912        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19913        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19914        GO TO 8100-SEND-INITIAL-MAP.
 19915
 19916     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 381
* EL156.cbl
 19917
 19918     IF MAP-NAME =  'EL156A'
 19919        MOVE -1                 TO  ENTERPFL
 19920        IF PI-USES-PAID-TO
 19921           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19922           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19923           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19924        ELSE
 19925           NEXT SENTENCE
 19926     ELSE
 19927        IF MAP-NAME = 'EL156B'
 19928           IF PI-USES-PAID-TO
 19929              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19930              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19931
 19932     IF MAP-NAME =  'EL156A'
 19933        IF PI-COMPANY-ID = 'BOA'
 19934            IF PI-INT-RATE NUMERIC
 19935                MOVE PI-INT-RATE TO PINTO.
 19936     IF MAP-NAME = 'EL156A'
 19937        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19938           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19939*          MOVE 'Y'              TO EOBYNO
 19940        END-IF
 19941     END-IF
 19942
 19943
 19944* EXEC CICS SEND
 19945*        MAP   (MAP-NAME)
 19946*        MAPSET(MAPSET-NAME)
 19947*        FROM  (EL156AI)
 19948*        DATAONLY
 19949*        CURSOR
 19950*    END-EXEC.
 19951     MOVE LENGTH OF
 19952      EL156AI
 19953       TO DFHEIV12
 19954     MOVE -1
 19955       TO DFHEIV11
 19956*    MOVE '8$D    CT       H L F ,   #00017749' TO DFHEIV0
 19957     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19958     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19959     MOVE X'2020233030303137373439' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0,
 19961           MAP-NAME,
 19962           EL156AI,
 19963           DFHEIV12,
 19964           MAPSET-NAME,
 19965           DFHEIV99,
 19966           DFHEIV99,
 19967           DFHEIV99,
 19968           DFHEIV11,
 19969           DFHEIV99,
 19970           DFHEIV99,
 19971           DFHEIV99
 19972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19973
 19974
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 382
* EL156.cbl
 19975     GO TO 9100-RETURN-TRAN.
 19976
 19977 8300-SEND-TEXT.
 19978
 19979* EXEC CICS SEND TEXT
 19980*        FROM(LOGOFF-TEXT)
 19981*        LENGTH(LOGOFF-LENGTH)
 19982*        ERASE
 19983*        FREEKB
 19984*    END-EXEC.
 19985*    MOVE '8&      T  E F  H   F -   #00017760' TO DFHEIV0
 19986     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19987     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19988     MOVE X'2020233030303137373630' TO DFHEIV0(25:11)
 19989     CALL 'kxdfhei1' USING DFHEIV0,
 19990           LOGOFF-TEXT,
 19991           LOGOFF-LENGTH,
 19992           DFHEIV99,
 19993           DFHEIV99,
 19994           DFHEIV99,
 19995           DFHEIV99,
 19996           DFHEIV99,
 19997           DFHEIV99,
 19998           DFHEIV99,
 19999           DFHEIV99,
 20000           DFHEIV99,
 20001           DFHEIV99
 20002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20003
 20004
 20005
 20006* EXEC CICS RETURN
 20007*    END-EXEC.
 20008*    MOVE '.(                    ''   #00017767' TO DFHEIV0
 20009     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20011     MOVE X'2020233030303137373637' TO DFHEIV0(25:11)
 20012     CALL 'kxdfhei1' USING DFHEIV0,
 20013           DFHEIV99,
 20014           DFHEIV99,
 20015           DFHEIV99,
 20016           DFHEIV99,
 20017           DFHEIV99,
 20018           DFHEIV99
 20019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20020
 20021
 20022 8500-FILE-NOTOPEN.
 20023     IF FILE-SWITCH = 'MSTR'
 20024         MOVE ER-0154            TO EMI-ERROR.
 20025     IF FILE-SWITCH = 'TRLR'
 20026         MOVE ER-0172            TO EMI-ERROR.
 20027     IF FILE-SWITCH = 'CERT'
 20028         MOVE ER-0169            TO EMI-ERROR.
 20029     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20030                      'PROC' OR 'STAT'
 20031         MOVE ER-0042            TO EMI-ERROR.
 20032     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 383
* EL156.cbl
 20033         MOVE ER-0338            TO EMI-ERROR.
 20034     IF FILE-SWITCH = 'ACCT'
 20035         MOVE ER-0168            TO EMI-ERROR.
 20036
 20037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20038     MOVE -1                     TO PMTTYPEL.
 20039
 20040     IF FIRST-ENTRY = 'Y'
 20041         GO TO 8100-SEND-INITIAL-MAP.
 20042
 20043     GO TO 8200-SEND-DATAONLY.
 20044
 20045 8600-PGRM-NOT-FOUND.
 20046
 20047     MOVE ER-0923                TO EMI-ERROR.
 20048     MOVE -1                     TO ENTPFBL.
 20049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20050
 20051     IF FIRST-ENTRY = 'Y'
 20052         GO TO 8100-SEND-INITIAL-MAP
 20053     ELSE
 20054         GO TO 8200-SEND-DATAONLY.
 20055
 20056 8800-UNAUTHORIZED-ACCESS.
 20057     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20058     GO TO 8300-SEND-TEXT.
 20059
 20060 8810-PF23.
 20061     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20062     MOVE XCTL-005               TO PGM-NAME.
 20063     GO TO 9300-XCTL.
 20064
 20065 8820-PF7-8.
 20066     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20067     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20068                                    PI-SAVED-PROGRAM-2
 20069                                    PI-SAVED-PROGRAM-3
 20070                                    PI-SAVED-PROGRAM-4
 20071                                    PI-SAVED-PROGRAM-5
 20072                                    PI-SAVED-PROGRAM-6
 20073                                    PI-RETURN-TO-PROGRAM.
 20074     IF EIBAID = DFHPF8
 20075        MOVE XCTL-132            TO PGM-NAME
 20076     ELSE
 20077        MOVE XCTL-130            TO PGM-NAME.
 20078
 20079     GO TO 9300-XCTL.
 20080
 20081 9100-RETURN-TRAN.
 20082     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20083     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20084
 20085
 20086* EXEC CICS RETURN
 20087*        TRANSID(TRANS-ID)
 20088*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20089*        LENGTH(PI-COMM-LENGTH)
 20090*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 384
* EL156.cbl
 20091*    MOVE '.(CT                  ''   #00017833' TO DFHEIV0
 20092     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20094     MOVE X'2020233030303137383333' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0,
 20096           TRANS-ID,
 20097           PROGRAM-INTERFACE-BLOCK,
 20098           PI-COMM-LENGTH,
 20099           DFHEIV99,
 20100           DFHEIV99,
 20101           DFHEIV99
 20102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20103
 20104
 20105 9200-RETURN-MAIN-MENU.
 20106     MOVE XCTL-126               TO PGM-NAME.
 20107     GO TO 9300-XCTL.
 20108
 20109 9300-XCTL.
 20110
 20111* EXEC CICS XCTL
 20112*        PROGRAM(PGM-NAME)
 20113*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20114*        LENGTH(PI-COMM-LENGTH)
 20115*    END-EXEC.
 20116*    MOVE '.$C                   %   #00017844' TO DFHEIV0
 20117     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20118     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20119     MOVE X'2020233030303137383434' TO DFHEIV0(25:11)
 20120     CALL 'kxdfhei1' USING DFHEIV0,
 20121           PGM-NAME,
 20122           PROGRAM-INTERFACE-BLOCK,
 20123           PI-COMM-LENGTH,
 20124           DFHEIV99
 20125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20126
 20127
 20128 9400-CLEAR.
 20129     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20130     GO TO 9300-XCTL.
 20131
 20132 9500-PF12.
 20133     MOVE XCTL-010               TO PGM-NAME.
 20134     GO TO 9300-XCTL.
 20135
 20136 9700-LINK-DATE-CONVERT.
 20137     MOVE LINK-ELDATCV           TO PGM-NAME.
 20138
 20139* EXEC CICS LINK
 20140*        PROGRAM   (PGM-NAME)
 20141*        COMMAREA  (DATE-CONVERSION-DATA)
 20142*        LENGTH    (DC-COMM-LENGTH)
 20143*    END-EXEC.
 20144*    MOVE '."C                   (   #00017860' TO DFHEIV0
 20145     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20147     MOVE X'2020233030303137383630' TO DFHEIV0(25:11)
 20148     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 385
* EL156.cbl
 20149           PGM-NAME,
 20150           DATE-CONVERSION-DATA,
 20151           DC-COMM-LENGTH,
 20152           DFHEIV99,
 20153           DFHEIV99,
 20154           DFHEIV99,
 20155           DFHEIV99
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159 9700-EXIT.
 20160     EXIT.
 20161
 20162 9800-LINK-REM-TERM.
 20163     MOVE LINK-REMTERM TO PGM-NAME.
 20164
 20165
 20166* EXEC CICS LINK
 20167*        PROGRAM   (PGM-NAME)
 20168*        COMMAREA  (CALCULATION-PASS-AREA)
 20169*        LENGTH    (CP-COMM-LENGTH)
 20170*    END-EXEC.
 20171*    MOVE '."C                   (   #00017872' TO DFHEIV0
 20172     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           PGM-NAME,
 20177           CALCULATION-PASS-AREA,
 20178           CP-COMM-LENGTH,
 20179           DFHEIV99,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV99
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186 9800-EXIT.
 20187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 386
* EL156.cbl
 20189 9830-DMD-REMAINING-TERM.
 20190
 20191     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20192         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20193
 20194     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20195                              CM-PMT-EXTENSION-DAYS.
 20196
 20197     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20198                                  CL-NO-OF-DAYS-PAID.
 20199
 20200     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20201         GIVING W-REM REMAINDER W-REM-DAYS.
 20202
 20203     MOVE W-REM                  TO WST-REM.
 20204
 20205     IF W-REM-DAYS > ZEROS
 20206         MOVE '/'                TO WST-SLASH
 20207         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20208     ELSE
 20209         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20210
 20211 9830-EXIT.
 20212     EXIT.
 20213
 20214 9870-OUTPUT-ACTIVITY-RECORD.
 20215
 20216
 20217* EXEC CICS GETMAIN
 20218*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20219*         LENGTH(25)
 20220*         INITIMG(WS-BLANK)
 20221*    END-EXEC.
 20222     MOVE 25
 20223       TO DFHEIV11
 20224*    MOVE ',"IL                  $   #00017908' TO DFHEIV0
 20225     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303137393038' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           DFHEIV20,
 20230           DFHEIV11,
 20231           WS-BLANK
 20232     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20233         DFHEIV20
 20234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20235
 20236
 20237     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20238     MOVE ELMSTR-KEY             TO DA-KEY.
 20239     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20240
 20241     IF PI-PMTTYPE EQUAL '7'
 20242         MOVE 'V'                TO DA-RECORD-TYPE
 20243     ELSE
 20244         MOVE 'P'                TO DA-RECORD-TYPE.
 20245
 20246
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 387
* EL156.cbl
 20247* EXEC CICS HANDLE CONDITION
 20248*         NOTOPEN(9870-NOTOPEN)
 20249*         DUPREC(9870-EXIT)
 20250*    END-EXEC.
 20251*    MOVE '"$J%                  ! B #00017923' TO DFHEIV0
 20252     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20254     MOVE X'4220233030303137393233' TO DFHEIV0(25:11)
 20255     CALL 'kxdfhei1' USING DFHEIV0
 20256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20257
 20258
 20259
 20260* EXEC CICS WRITE
 20261*         DATASET('DLYACTV')
 20262*         RIDFLD(DA-KEY)
 20263*         FROM(DAILY-ACTIVITY-RECORD)
 20264*         LENGTH(25)
 20265*    END-EXEC.
 20266     MOVE 'DLYACTV' TO DFHEIV1
 20267     MOVE 25
 20268       TO DFHEIV11
 20269*    MOVE '&$ L                  ''   #00017928' TO DFHEIV0
 20270     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20272     MOVE X'2020233030303137393238' TO DFHEIV0(25:11)
 20273     CALL 'kxdfhei1' USING DFHEIV0,
 20274           DFHEIV1,
 20275           DAILY-ACTIVITY-RECORD,
 20276           DFHEIV11,
 20277           DA-KEY,
 20278           DFHEIV99,
 20279           DFHEIV99
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20281
 20282     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20283     GO TO 9870-EXIT.
 20284
 20285 9870-NOTOPEN.
 20286
 20287     MOVE '2955'                 TO EMI-ERROR.
 20288     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20289
 20290 9870-EXIT.
 20291     EXIT.
 20292
 20293 9900-ERROR-FORMAT.
 20294
 20295     IF EMI-ERROR = ER-0923
 20296         MOVE PGM-NAME           TO W-CALLED-NAME.
 20297
 20298     MOVE LINK-001      TO PGM-NAME.
 20299     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20300
 20301
 20302* EXEC CICS LINK
 20303*        PROGRAM (PGM-NAME)
 20304*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 388
* EL156.cbl
 20305*        LENGTH  (EMI-COMM-LENGTH)
 20306*    END-EXEC.
 20307*    MOVE '."C                   (   #00017953' TO DFHEIV0
 20308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20310     MOVE X'2020233030303137393533' TO DFHEIV0(25:11)
 20311     CALL 'kxdfhei1' USING DFHEIV0,
 20312           PGM-NAME,
 20313           ERROR-MESSAGE-INTERFACE-BLOCK,
 20314           EMI-COMM-LENGTH,
 20315           DFHEIV99,
 20316           DFHEIV99,
 20317           DFHEIV99,
 20318           DFHEIV99
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321
 20322     IF EMI-ERROR = ER-0923
 20323         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20324
 20325 9900-EXIT.
 20326     EXIT.
 20327
 20328 9990-ABEND.
 20329     MOVE LINK-004               TO PGM-NAME.
 20330     MOVE DFHEIBLK               TO EMI-LINE1.
 20331
 20332* EXEC CICS LINK
 20333*        PROGRAM   (PGM-NAME)
 20334*        COMMAREA  (EMI-LINE1)
 20335*        LENGTH    (64)
 20336*    END-EXEC.
 20337     MOVE 64
 20338       TO DFHEIV11
 20339*    MOVE '."C                   (   #00017968' TO DFHEIV0
 20340     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20341     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20342     MOVE X'2020233030303137393638' TO DFHEIV0(25:11)
 20343     CALL 'kxdfhei1' USING DFHEIV0,
 20344           PGM-NAME,
 20345           EMI-LINE1,
 20346           DFHEIV11,
 20347           DFHEIV99,
 20348           DFHEIV99,
 20349           DFHEIV99,
 20350           DFHEIV99
 20351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20352
 20353
 20354     MOVE 'EL156A'               TO  MAP-NAME.
 20355     MOVE LOW-VALUES             TO  EL156AO.
 20356     GO TO 8100-SEND-INITIAL-MAP.
 20357
 20358 9995-SECURITY-VIOLATION.
 20359*    COPY ELCSCTP.
 20360******************************************************************
 20361*                                                                *
 20362*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 389
* EL156.cbl
 20363*                            VMOD=2.001                          *
 20364*                                                                *
 20365*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20366******************************************************************
 20367
 20368
 20369     MOVE EIBDATE          TO SM-JUL-DATE.
 20370     MOVE EIBTRMID         TO SM-TERMID.
 20371     MOVE THIS-PGM         TO SM-PGM.
 20372     MOVE EIBTIME          TO TIME-IN.
 20373     MOVE TIME-OUT         TO SM-TIME.
 20374     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20375
 20376
 20377* EXEC CICS LINK
 20378*         PROGRAM  ('EL003')
 20379*         COMMAREA (SECURITY-MESSAGE)
 20380*         LENGTH   (80)
 20381*    END-EXEC.
 20382     MOVE 'EL003' TO DFHEIV1
 20383     MOVE 80
 20384       TO DFHEIV11
 20385*    MOVE '."C                   (   #00017996' TO DFHEIV0
 20386     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20388     MOVE X'2020233030303137393936' TO DFHEIV0(25:11)
 20389     CALL 'kxdfhei1' USING DFHEIV0,
 20390           DFHEIV1,
 20391           SECURITY-MESSAGE,
 20392           DFHEIV11,
 20393           DFHEIV99,
 20394           DFHEIV99,
 20395           DFHEIV99,
 20396           DFHEIV99
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400******************************************************************
 20401
 20402
 20403
 20404 9999-DFHBACK SECTION.
 20405     MOVE '9%                    "   ' TO DFHEIV0
 20406     MOVE 'EL156' TO DFHEIV1
 20407     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20408     GOBACK.
 20409 9999-DFHEXIT.
 20410     IF DFHEIGDJ EQUAL 0001
 20411         NEXT SENTENCE
 20412     ELSE IF DFHEIGDJ EQUAL 2
 20413         GO TO 9990-ABEND,
 20414               8600-PGRM-NOT-FOUND,
 20415               0400-FIRST-TIME,
 20416               6180-DUPREC,
 20417               9990-ABEND
 20418         DEPENDING ON DFHEIGDI
 20419     ELSE IF DFHEIGDJ EQUAL 3
 20420         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 390
* EL156.cbl
 20421               0380-CLAIM-END-FILE
 20422         DEPENDING ON DFHEIGDI
 20423     ELSE IF DFHEIGDJ EQUAL 4
 20424         GO TO 0380-CLAIM-END-FILE,
 20425               0380-CLAIM-END-FILE
 20426         DEPENDING ON DFHEIGDI
 20427     ELSE IF DFHEIGDJ EQUAL 5
 20428         GO TO 0800-EXIT
 20429         DEPENDING ON DFHEIGDI
 20430     ELSE IF DFHEIGDJ EQUAL 6
 20431         GO TO 1950-NOT-FOUND,
 20432               1950-NOT-FOUND
 20433         DEPENDING ON DFHEIGDI
 20434     ELSE IF DFHEIGDJ EQUAL 7
 20435         GO TO 1950-NOT-FOUND
 20436         DEPENDING ON DFHEIGDI
 20437     ELSE IF DFHEIGDJ EQUAL 8
 20438         GO TO 1950-NOT-FOUND,
 20439               1950-NOT-FOUND
 20440         DEPENDING ON DFHEIGDI
 20441     ELSE IF DFHEIGDJ EQUAL 9
 20442         GO TO 1166-END-CHECK,
 20443               1166-END-CHECK
 20444         DEPENDING ON DFHEIGDI
 20445     ELSE IF DFHEIGDJ EQUAL 10
 20446         GO TO 1950-NOT-FOUND,
 20447               1950-NOT-FOUND
 20448         DEPENDING ON DFHEIGDI
 20449     ELSE IF DFHEIGDJ EQUAL 11
 20450         GO TO 1950-NOT-FOUND,
 20451               1950-NOT-FOUND
 20452         DEPENDING ON DFHEIGDI
 20453     ELSE IF DFHEIGDJ EQUAL 12
 20454         GO TO 1950-NOT-FOUND
 20455         DEPENDING ON DFHEIGDI
 20456     ELSE IF DFHEIGDJ EQUAL 13
 20457         GO TO 3600-CONTINUE
 20458         DEPENDING ON DFHEIGDI
 20459     ELSE IF DFHEIGDJ EQUAL 14
 20460         GO TO 5300-NOTE-NOT-FOUND
 20461         DEPENDING ON DFHEIGDI
 20462     ELSE IF DFHEIGDJ EQUAL 15
 20463         GO TO 6065-NOT-FOUND
 20464         DEPENDING ON DFHEIGDI
 20465     ELSE IF DFHEIGDJ EQUAL 16
 20466         GO TO 6068-ACCT-NOT-FND
 20467         DEPENDING ON DFHEIGDI
 20468     ELSE IF DFHEIGDJ EQUAL 17
 20469         GO TO 6074-GET-COMP-DATA
 20470         DEPENDING ON DFHEIGDI
 20471     ELSE IF DFHEIGDJ EQUAL 18
 20472         GO TO 6170-WRITE
 20473         DEPENDING ON DFHEIGDI
 20474     ELSE IF DFHEIGDJ EQUAL 19
 20475         GO TO 6180-DUPREC
 20476         DEPENDING ON DFHEIGDI
 20477     ELSE IF DFHEIGDJ EQUAL 20
 20478         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 391
* EL156.cbl
 20479         DEPENDING ON DFHEIGDI
 20480     ELSE IF DFHEIGDJ EQUAL 21
 20481         GO TO 6185-DUPREC
 20482         DEPENDING ON DFHEIGDI
 20483     ELSE IF DFHEIGDJ EQUAL 22
 20484         GO TO 6720-BUILD-NEW-RECORD
 20485         DEPENDING ON DFHEIGDI
 20486     ELSE IF DFHEIGDJ EQUAL 23
 20487         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20488               6900-BUILD-ARCHIVE-HEADER
 20489         DEPENDING ON DFHEIGDI
 20490     ELSE IF DFHEIGDJ EQUAL 24
 20491         GO TO 7010-BUILD-MAP
 20492         DEPENDING ON DFHEIGDI
 20493     ELSE IF DFHEIGDJ EQUAL 25
 20494         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20495         DEPENDING ON DFHEIGDI
 20496     ELSE IF DFHEIGDJ EQUAL 26
 20497         GO TO 7160-DUPREC
 20498         DEPENDING ON DFHEIGDI
 20499     ELSE IF DFHEIGDJ EQUAL 27
 20500         GO TO 7200-EXIT,
 20501               7200-EXIT
 20502         DEPENDING ON DFHEIGDI
 20503     ELSE IF DFHEIGDJ EQUAL 28
 20504         GO TO 7400-NOT-FOUND
 20505         DEPENDING ON DFHEIGDI
 20506     ELSE IF DFHEIGDJ EQUAL 29
 20507         GO TO 7590-END,
 20508               7590-END
 20509         DEPENDING ON DFHEIGDI
 20510     ELSE IF DFHEIGDJ EQUAL 30
 20511         GO TO 7699-EXIT
 20512         DEPENDING ON DFHEIGDI
 20513     ELSE IF DFHEIGDJ EQUAL 31
 20514         GO TO 5300-NOTE-NOT-FOUND
 20515         DEPENDING ON DFHEIGDI
 20516     ELSE IF DFHEIGDJ EQUAL 32
 20517         GO TO 7800-COMP-NOTFND
 20518         DEPENDING ON DFHEIGDI
 20519     ELSE IF DFHEIGDJ EQUAL 33
 20520         GO TO 7920-NOT-FOUND
 20521         DEPENDING ON DFHEIGDI
 20522     ELSE IF DFHEIGDJ EQUAL 34
 20523         GO TO 9870-NOTOPEN,
 20524               9870-EXIT
 20525         DEPENDING ON DFHEIGDI.
 20526     MOVE '9%                    "   ' TO DFHEIV0
 20527     MOVE 'EL156' TO DFHEIV1
 20528     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20529     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12764     Code:       76279
