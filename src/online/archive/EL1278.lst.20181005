* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    61* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
    62* 072616  CR2016020400001  PEMA  ADD PF10 CONFIRMATION
    63* 032117  CR2017030300002  PEMA  ADD COMM % AND COMM AMT
    64******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   3
* EL1278.cbl
    66 ENVIRONMENT DIVISION.
    67 DATA DIVISION.
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70 77  FILLER  PIC  X(32) VALUE '********************************'.
    71 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    72 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    73 77  S1                          PIC S999 COMP-3 VALUE +0.
    74 77  P1                          PIC S999 COMP-3 VALUE +0.
    75 77  P2                          PIC S999 COMP-3 VALUE +0.
    76 77  C0                          PIC S999 COMP-3 VALUE +0.
    77 77  C1                          PIC S999 COMP-3 VALUE +0.
    78 77  C2                          PIC S999 COMP-3 VALUE +0.
    79 77  C3                          PIC S999 COMP-3 VALUE +0.
    80 77  WS-STOP-SW                  PIC X  VALUE ' '.
    81     88  I-SAY-TO-STOP      VALUE 'Y'.
    82 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    83     88  OPEN-LF-CLAIM              VALUE 'Y'.
    84 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    85     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    86 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    87     88  OPEN-AH-CLAIM              VALUE 'Y'.
    88 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    89     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    90 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    91     88  FOUND-A-CLAIM              VALUE 'Y'.
    92 77  WS-ST-REF-IND               PIC X.
    93 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    94 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    95 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    96 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    97 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    98 77  DD-IU-SW                    PIC X   VALUE ' '.
    99     88  DD-IU-PRESENT                 VALUE 'Y'.
   100 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   101 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   102 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   103 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   104 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   105 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   106 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   107 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   108 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   109     88  NO-CERT-RW                 VALUE 'N'.
   110     88  CERT-RW                    VALUE 'Y'.
   111 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   112     88  ERMAIL-FOUND                 VALUE 'Y'.
   113 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   114
   115*                            COPY ELCSCTM.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCTM                             *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   123*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   4
* EL1278.cbl
   124******************************************************************
   125 01  SECURITY-MESSAGE.
   126     12  FILLER                          PIC X(30)
   127            VALUE '** LOGIC SECURITY VIOLATION -'.
   128     12  SM-READ                         PIC X(6).
   129     12  FILLER                          PIC X(5)
   130            VALUE ' PGM='.
   131     12  SM-PGM                          PIC X(6).
   132     12  FILLER                          PIC X(5)
   133            VALUE ' OPR='.
   134     12  SM-PROCESSOR-ID                 PIC X(4).
   135     12  FILLER                          PIC X(6)
   136            VALUE ' TERM='.
   137     12  SM-TERMID                       PIC X(4).
   138     12  FILLER                          PIC XX   VALUE SPACE.
   139     12  SM-JUL-DATE                     PIC 9(5).
   140     12  FILLER                          PIC X    VALUE SPACE.
   141     12  SM-TIME                         PIC 99.99.
   142
   143
   144*                            COPY ELCSCRTY.
   145******************************************************************
   146*                                                                *
   147*                                                                *
   148*                            ELCSCRTY                            *
   149*                            VMOD=2.001                          *
   150*                                                                *
   151*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   152*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   153*        SAVED IN PI-SECURITY-ADDRESS.                           *
   154*                                                                *
   155******************************************************************
   156 01  SECURITY-CONTROL.
   157     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   158     12  FILLER                       PIC XX    VALUE 'SC'.
   159     12  SC-CREDIT-CODES.
   160         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   161             20  SC-CREDIT-DISPLAY    PIC X.
   162             20  SC-CREDIT-UPDATE     PIC X.
   163     12  SC-CLAIMS-CODES.
   164         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   165             20  SC-CLAIMS-DISPLAY    PIC X.
   166             20  SC-CLAIMS-UPDATE     PIC X.
   167
   168 01  FILLER          COMP-3.
   169     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   170     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   171     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   172     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   173     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   174     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   175     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   176     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   177     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   178
   179 01  WS-DATE-AREA.
   180     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   181     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   5
* EL1278.cbl
   182     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   183     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   184     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   185     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   186
   187 01  ERPDEF-KEY-SAVE             PIC X(18).
   188 01  ERPDEF-KEY.
   189     12  ERPDEF-COMPANY-CD       PIC X.
   190     12  ERPDEF-STATE            PIC XX.
   191     12  ERPDEF-PROD-CD          PIC XXX.
   192     12  F                       PIC X(7).
   193     12  ERPDEF-BEN-TYPE         PIC X.
   194     12  ERPDEF-BEN-CODE         PIC XX.
   195     12  ERPDEF-EXP-DT           PIC XX.
   196 01  ELMSTR-KEY.
   197     12  ELMSTR-COMP-CD          PIC X.
   198     12  ELMSTR-CERT-NO          PIC X(11).
   199 01  ELCRTT-KEY.
   200     12  ELCRTT-PRIMARY          PIC X(33).
   201     12  ELCRTT-REC-TYPE         PIC X(1).
   202
   203 01  ELCRTO-KEY.
   204     05  ELCRTO-COMPANY-CD       PIC X.
   205     05  ELCRTO-CARRIER          PIC X.
   206     05  ELCRTO-GROUPING         PIC X(6).
   207     05  ELCRTO-STATE            PIC XX.
   208     05  ELCRTO-ACCOUNT          PIC X(10).
   209     05  ELCRTO-CERT-EFF-DT      PIC XX.
   210     05  ELCRTO-CERT-NO.
   211         10  ELCRTO-CERT-PRIME   PIC X(10).
   212         10  ELCRTO-CERT-SFX     PIC X.
   213     05  ELCRTO-RECORD-TYPE      PIC X.
   214     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   215
   216 01  STANDARD-AREAS.
   217     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   218     12  SUB3                    PIC S9(04) COMP VALUE +0.
   219     12  SUB4                    PIC S9(04) COMP VALUE +0.
   220     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   221     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   222     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   223     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   224     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   225     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   226     12  PGM-NAME                PIC  X(08).
   227     12  TIME-IN                 PIC S9(07).
   228     12  TIME-OUT-R  REDEFINES  TIME-IN.
   229         16  FILLER              PIC  X(01).
   230         16  TIME-OUT            PIC  9(02)V99.
   231         16  FILLER              PIC  X(02).
   232     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   233     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   234     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   235     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   236     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   237     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   238     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   239     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   6
* EL1278.cbl
   240     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   241     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   242     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   243     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   244     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   245     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   246     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   247     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   248     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   249     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   250         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   251     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   252         88  BROWSE-STARTED                      VALUE 'Y'.
   253     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   254         88  FORM-FOUND                          VALUE 'Y'.
   255     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   256         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   257     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   258         88  WS-REDUCING                         VALUE 'R'.
   259         88  WS-LEVEL                            VALUE 'L'  'P'.
   260     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   261         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   262     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   263         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   264     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   265     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   266         'CLAIM PMTS'.
   267     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   268         'ITD REFUND'.
   269     12  WS-ACCESS.
   270         16  FILLER              PIC  X(02).
   271         16  WS-BEN-CD           PIC  X(02).
   272     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   273     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   274     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   275     12  WS-LOOKUP-TYPE          PIC  X(01).
   276     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   277     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   278     12  WS-CALC-CD              PIC  X(01).
   279     12  DEEDIT-FIELD            PIC  X(15).
   280     12  DEEDIT-FIELD-V0  REDEFINES
   281         DEEDIT-FIELD            PIC S9(15).
   282     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   283     12  RETURN-FROM             PIC  X(08).
   284     12  QID.
   285         16  QID-TERM            PIC  X(04).
   286         16  FILLER              PIC  X(04)      VALUE '127H'.
   287     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   288         88  FIRST-ENTRY                         VALUE 'Y'.
   289     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   290         88  PDEF-FOUND                          VALUE 'Y'.
   291     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   292         88  CERT-FOUND                          VALUE 'Y'.
   293         88  CERT-NOT-FOUND                      VALUE 'N'.
   294     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   295         88  CNTL-FOUND                          VALUE 'Y'.
   296         88  CNTL-NOT-FOUND                      VALUE 'N'.
   297     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   7
* EL1278.cbl
   298         88  BEN-FOUND                           VALUE 'Y'.
   299     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   300         88  STATE-FOUND                         VALUE 'Y'.
   301     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   302         88  ST-BEN-FOUND                        VALUE 'Y'.
   303     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   304         88  ACCT-FOUND                          VALUE 'Y'.
   305     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   306         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   307     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   308                                                 VALUE ZERO.
   309         88  BENEFIT-FOUND                       VALUE +1.
   310     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   311                                                 VALUE ZERO.
   312     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   313                                                 VALUE ZERO.
   314     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   315     12  WS-SUB1                 PIC S99    COMP.
   316     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   317     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   318     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   319     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   321     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   322     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   323     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   324     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   326     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   327     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   328     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   329     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   330     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   331     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   332     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   333     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   334     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   335     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   336     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   337     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   338     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   339     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   340     12  ERROR-MESSAGES.
   341         16  ER-0000             PIC  X(04)      VALUE '0000'.
   342         16  ER-0004             PIC  X(04)      VALUE '0004'.
   343         16  ER-0008             PIC  X(04)      VALUE '0008'.
   344         16  ER-0028             PIC  X(04)      VALUE '0028'.
   345         16  ER-0029             PIC  X(04)      VALUE '0029'.
   346         16  ER-0070             PIC  X(04)      VALUE '0070'.
   347         16  ER-0142             PIC  X(04)      VALUE '0142'.
   348         16  ER-0214             PIC  X(04)      VALUE '0214'.
   349         16  ER-0681             PIC  X(04)      VALUE '0681'.
   350         16  ER-0682             PIC  X(04)      VALUE '0682'.
   351         16  ER-0683             PIC  X(04)      VALUE '0683'.
   352         16  ER-0684             PIC  X(04)      VALUE '0684'.
   353         16  ER-2227             PIC  X(04)      VALUE '2227'.
   354         16  ER-2601             PIC  X(04)      VALUE '2601'.
   355         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   8
* EL1278.cbl
   356         16  ER-2617             PIC  X(04)      VALUE '2617'.
   357         16  ER-2619             PIC  X(04)      VALUE '2619'.
   358         16  ER-2740             PIC  X(04)      VALUE '2740'.
   359         16  ER-2756             PIC  X(04)      VALUE '2756'.
   360         16  ER-2768             PIC  X(04)      VALUE '2768'.
   361         16  ER-2774             PIC  X(04)      VALUE '2774'.
   362         16  ER-2775             PIC  X(04)      VALUE '2775'.
   363         16  ER-2965             PIC  X(04)      VALUE '2965'.
   364         16  ER-2966             PIC  X(04)      VALUE '2966'.
   365         16  ER-2967             PIC  X(04)      VALUE '2967'.
   366         16  ER-2968             PIC  X(04)      VALUE '2968'.
   367         16  ER-2969             PIC  X(04)      VALUE '2969'.
   368         16  ER-3037             PIC  X(04)      VALUE '3037'.
   369         16  ER-3038             PIC  X(04)      VALUE '3038'.
   370         16  ER-3039             PIC  X(04)      VALUE '3039'.
   371         16  ER-3780             PIC  X(04)      VALUE '3780'.
   372         16  ER-3781             PIC  X(04)      VALUE '3781'.
   373         16  ER-3830             PIC  X(04)      VALUE '3830'.
   374         16  er-3847             pic  x(04)      value '3847'.
   375         16  ER-8160             PIC  X(04)      VALUE '8160'.
   376         16  ER-8161             PIC  X(04)      VALUE '8161'.
   377         16  ER-9999             PIC  X(04)      VALUE '9999'.
   378     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   379     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   380     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   381     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   382
   383     12  WS-RESPONSE             PIC S9(8)       COMP.
   384         88  WS-RESP-NORMAL                      VALUE +00.
   385         88  WS-RESP-NOTFND                      VALUE +13.
   386         88  WS-RESP-DUPREC                      VALUE +14.
   387         88  WS-RESP-DUPKEY                      VALUE +15.
   388         88  WS-RESP-NOTOPEN                     VALUE +19.
   389         88  WS-RESP-ENDFILE                     VALUE +20.
   390
   391     12  WS-01-CANCEL-ERR        PIC X(25)
   392         VALUE 'CANCEL DATE ERROR'.
   393     12  WS-02-CANCEL-ERR        PIC X(25)
   394         VALUE 'CERT NOT FOUND'.
   395     12  WS-04-CANCEL-ERR        PIC X(25)
   396         VALUE 'CANCEL AMOUNT ERROR'.
   397     12  WS-05-CANCEL-ERR        PIC X(25)
   398         VALUE 'CANCEL OPTION ERROR'.
   399     12  WS-06-CANCEL-ERR        PIC X(25)
   400         VALUE 'PREVIOUSLY CANCELLED'.
   401     12  WS-07-CANCEL-ERR        PIC X(25)
   402         VALUE 'INVALID DATA'.
   403     12  WS-08-CANCEL-ERR        PIC X(25)
   404         VALUE 'NO ACCOUNT MASTER'.
   405     12  WS-09-CANCEL-ERR        PIC X(25)
   406         VALUE 'SUFFIX ALREADY EXISTS'.
   407     12  WS-99-CANCEL-ERR        PIC X(25)
   408         VALUE 'MISC CANCEL ERROR'.
   409
   410 01  WS-SAVE-ALLOWABLE-BENEFIT.
   411     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   412     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   413     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page   9
* EL1278.cbl
   414     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   415     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   416     16  FILLER                    PIC XX.
   417 01  CTBL-KEY-SAVE               PIC X(5).
   418 01  CTBL-KEY.
   419     05  CTBL-COMPANY-CD         PIC X.
   420     05  CTBL-TABLE              PIC XXX.
   421     05  CTBL-BEN-TYPE           PIC X.
   422     05  CTBL-BEN-CODE           PIC XX.
   423 01  CANCEL-GEN-PASS-AREA.
   424     05  CG-OPTION-CODE          PIC X.
   425         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   426         88  CG-FLAT-CANCEL        VALUE '1'.
   427         88  CG-CANCEL             VALUE '2'.
   428         88  CG-CANCEL-REISSUE     VALUE '3'.
   429     05  CG-ERROR-CODE           PIC 99.
   430         88  CG-SUCCESS            VALUE 00.
   431         88  CG-DATE-ERROR         VALUE 01.
   432         88  CG-CERT-NOT-FOUND     VALUE 02.
   433         88  CG-AMOUNT-ERROR       VALUE 04.
   434         88  CG-OPTION-ERROR       VALUE 05.
   435         88  CG-PREV-CAN           VALUE 06.
   436         88  CG-INVALID-DATA       VALUE 07.
   437         88  CG-NO-ACCT-MSTR       VALUE 08.
   438         88  CG-SFX-A-EXIST        VALUE 09.
   439         88  CG-MISC-ERROR         VALUE 99.
   440     05  CG-COMPANY-ID           PIC XXX.
   441     05  CG-PROC-ID              PIC XXXX.
   442     05  CG-CURRENT-DT           PIC XX.
   443     05  CG-MONTH-END-DT         PIC XX.
   444     05  CG-CERT-KEY.
   445         10  CG-CERT-COMPANY-CD  PIC X.
   446         10  CG-CERT-CARRIER     PIC X.
   447         10  CG-CERT-GROUP       PIC X(6).
   448         10  CG-CERT-STATE       PIC XX.
   449         10  CG-CERT-ACCOUNT     PIC X(10).
   450         10  CG-CERT-EFF-DT      PIC XX.
   451         10  CG-CERT-CERT-NO     PIC X(11).
   452     05  CG-LF-CAN-DATA.
   453         10  CG-LF-CAN-DT        PIC XX.
   454         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   455     05  CG-AH-CAN-DATA.
   456         10  CG-AH-CAN-DT        PIC XX.
   457         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   458     05  CG-CERT-PROFILE-DATA.
   459         10  CG-INS-LNAME        PIC X(15).
   460         10  CG-INS-FNAME        PIC X(10).
   461         10  CG-INS-MID-INIT     PIC X.
   462         10  CG-INS-AGE          PIC 99.
   463         10  CG-JNT-LNAME        PIC X(15).
   464         10  CG-JNT-FNAME        PIC X(10).
   465         10  CG-JNT-MID-INIT     PIC X.
   466         10  CG-JNT-AGE          PIC 99.
   467     05  CG-LF-ISS-DATA.
   468         10  CG-LF-BENCD         PIC XX.
   469         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   470         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   471     05  CG-AH-ISS-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  10
* EL1278.cbl
   472         10  CG-AH-BENCD         PIC XX.
   473         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   474     05  CG-BATCH-NO             PIC X(6).
   475     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   476     05  FILLER                  PIC X(306).
   477 01  WS-CAN-QUOTE-NOTE.
   478     12  WS-CN-CANCEL-DT         PIC  X(09).
   479     12  FILLER                  PIC  X(10)      VALUE
   480         'RF QUOTE: '.
   481     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   482     12  FILLER                  PIC  X(4)       VALUE
   483         ' LF '.
   484     12  WS-CN-LF-REF-METH       PIC  X.
   485     12  FILLER                  PIC  X          VALUE ','.
   486     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   487     12  FILLER                  PIC  X(5)       VALUE
   488         ' AH '.
   489     12  WS-CN-AH-REF-METH       PIC  X.
   490     12  FILLER                  PIC  XX         VALUE ','.
   491     12  FILLER                  PIC  X(6)       VALUE
   492         'TOTAL '.
   493     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   494     12  FILLER                  PIC  X(01)      VALUE ' '.
   495     12  WS-CN-DT-QUOTED         PIC  X(08).
   496     12  FILLER                  PIC  X(01)      VALUE ';'.
   497     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   498
   499 01  WS-CM-CONTROL-PRIMARY.
   500     12  WS-CM-COMPANY-CD        PIC  X(01).
   501     12  WS-CM-CARRIER           PIC  X(01).
   502     12  WS-CM-GROUPING          PIC  X(06).
   503     12  WS-CM-STATE             PIC  X(02).
   504     12  WS-CM-ACCOUNT           PIC  X(10).
   505     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   506     12  WS-CM-CERT-NO.
   507         16  WS-CM-CERT-PRIME    PIC  X(10).
   508         16  WS-CM-CERT-SFX      PIC  X(01).
   509
   510 01  WS-MA-CONTROL-PRIMARY.
   511     12  WS-MA-COMPANY-CD        PIC  X(01).
   512     12  WS-MA-CARRIER           PIC  X(01).
   513     12  WS-MA-GROUPING          PIC  X(06).
   514     12  WS-MA-STATE             PIC  X(02).
   515     12  WS-MA-ACCOUNT           PIC  X(10).
   516     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   517     12  WS-MA-CERT-NO.
   518         16  WS-MA-CERT-PRIME    PIC  X(10).
   519         16  WS-MA-CERT-SFX      PIC  X(01).
   520 01  WS-CF-CONTROL-PRIMARY.
   521     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   522     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   523*        88  COMPANY-MASTER                      VALUE '1'.
   524*        88  STATE-MASTER                        VALUE '3'.
   525*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   526*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   527     12  WS-CF-ACCESS.
   528         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   529         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  11
* EL1278.cbl
   530             20  FILLER          PIC  X(01).
   531             20  WS-CF-CARRIER   PIC  X(01).
   532     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   533
   534 01  WS-AM-CONTROL-PRIMARY.
   535     12  WS-AM-COMPANY-CD        PIC  X(01).
   536     12  WS-AM-CARRIER           PIC  X(01).
   537     12  WS-AM-GROUPING          PIC  X(06).
   538     12  WS-AM-STATE             PIC  X(02).
   539     12  WS-AM-ACCOUNT           PIC  X(10).
   540     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   541     12  WS-AM-FILLER            PIC  X(04).
   542
   543 01  WS-CN-CONTROL-PRIMARY.
   544     12  WS-CN-COMPANY-CD        PIC  X(01).
   545     12  WS-CN-CARRIER           PIC  X(01).
   546     12  WS-CN-GROUPING          PIC  X(06).
   547     12  WS-CN-STATE             PIC  X(02).
   548     12  WS-CN-ACCOUNT           PIC  X(10).
   549     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   550     12  WS-CN-CERT-NO.
   551         16  WS-CN-CERT-PRIME    PIC  X(10).
   552         16  WS-CN-CERT-SFX      PIC  X.
   553     12  WS-CN-REC-TYPE          PIC X.
   554     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   555
   556 01  WS-FO-CONTROL-PRIMARY.
   557     12  WS-FO-COMPANY-CD        PIC  X(01).
   558     12  WS-FO-STATE             PIC  X(02).
   559     12  WS-FO-FORM-ID           PIC  X(12).
   560     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  12
* EL1278.cbl
   562*                            COPY ERCCNOT.
   563******************************************************************
   564*                                                                *
   565*                            ERCCNOT                             *
   566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   567*                            VMOD=2.003                          *
   568*                                                                *
   569*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   570*                                                                *
   571*        FILE TYPE= VSAM,KSDS                                    *
   572*        RECORD SIZE = 150    RECFORM = FIXED                    *
   573*                                                                *
   574*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   575*                                                                *
   576*        LOG = YES                                               *
   577*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   578*                                                                *
   579******************************************************************
   580*                   C H A N G E   L O G
   581*
   582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   583*-----------------------------------------------------------------
   584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   585* EFFECTIVE    NUMBER
   586*-----------------------------------------------------------------
   587* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   588******************************************************************
   589
   590 01  CERT-NOTE-FILE.
   591     12  CZ-RECORD-ID                PIC  XX.
   592         88  VALID-CZ-ID                  VALUE 'CZ'.
   593
   594     12  CZ-CONTROL-PRIMARY.
   595         16  CZ-COMPANY-CD           PIC X.
   596         16  CZ-CARRIER              PIC X.
   597         16  CZ-GROUPING.
   598             20 CZ-GROUPING-PREFIX   PIC XXX.
   599             20 CZ-GROUPING-PRIME    PIC XXX.
   600         16  CZ-STATE                PIC XX.
   601         16  CZ-ACCOUNT.
   602             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   603             20 CZ-ACCOUNT-PRIME     PIC X(6).
   604         16  CZ-CERT-EFF-DT          PIC XX.
   605         16  CZ-CERT-NO.
   606             20  CZ-CERT-PRIME       PIC X(10).
   607             20  CZ-CERT-SFX         PIC X.
   608         16  CZ-RECORD-TYPE          PIC X.
   609             88  CERT-NOTE           VALUE '1'.
   610             88  CLAIM-CERT-NOTE     VALUE '2'.
   611         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   612
   613     12  CZ-LAST-MAINT-DT            PIC XX.
   614     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   615     12  CZ-LAST-MAINT-USER          PIC X(4).
   616
   617     12  CZ-NOTE-INFORMATION.
   618         16  CZ-NOTE                 PIC X(63).
   619         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  13
* EL1278.cbl
   620******************************************************************
   621*                            COPY ELCDATE.
   622******************************************************************
   623*                                                                *
   624*                                                                *
   625*                            ELCDATE.                            *
   626*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   627*                            VMOD=2.003
   628*                                                                *
   629*                                                                *
   630*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   631*                 LENGTH = 200                                   *
   632******************************************************************
   633
   634 01  DATE-CONVERSION-DATA.
   635     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   636     12  DC-OPTION-CODE                PIC X.
   637         88  BIN-TO-GREG                VALUE ' '.
   638         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   639         88  EDIT-GREG-TO-BIN           VALUE '2'.
   640         88  YMD-GREG-TO-BIN            VALUE '3'.
   641         88  MDY-GREG-TO-BIN            VALUE '4'.
   642         88  JULIAN-TO-BIN              VALUE '5'.
   643         88  BIN-PLUS-ELAPSED           VALUE '6'.
   644         88  FIND-CENTURY               VALUE '7'.
   645         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   646         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   647         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   648         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   649         88  JULIAN-TO-BIN-3            VALUE 'C'.
   650         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   651         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   652         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   653         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   654         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   655         88  CHECK-LEAP-YEAR            VALUE 'H'.
   656         88  BIN-3-TO-GREG              VALUE 'I'.
   657         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   658         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   659         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   660         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   661         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   662         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   663         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   664         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   665         88  THREE-CHARACTER-BIN
   666                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   667         88  GREGORIAN-TO-BIN
   668                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   669         88  BIN-TO-GREGORIAN
   670                  VALUES ' ' '1' 'I' '8' 'G'.
   671         88  JULIAN-TO-BINARY
   672                  VALUES '5' 'C' 'E' 'F'.
   673     12  DC-ERROR-CODE                 PIC X.
   674         88  NO-CONVERSION-ERROR        VALUE ' '.
   675         88  DATE-CONVERSION-ERROR
   676                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   677         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  14
* EL1278.cbl
   678         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   679         88  DATE-IS-INVALID            VALUE '3'.
   680         88  DATE1-GREATER-DATE2        VALUE '4'.
   681         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   682         88  DATE-INVALID-OPTION        VALUE '9'.
   683         88  INVALID-CENTURY            VALUE 'A'.
   684         88  ONLY-CENTURY               VALUE 'B'.
   685         88  ONLY-LEAP-YEAR             VALUE 'C'.
   686         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   687     12  DC-END-OF-MONTH               PIC X.
   688         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   689     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   690         88  USE-NORMAL-PROCESS         VALUE ' '.
   691         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   692         88  ADJUST-UP-100-YRS          VALUE '2'.
   693     12  FILLER                        PIC X.
   694     12  DC-CONVERSION-DATES.
   695         16  DC-BIN-DATE-1             PIC XX.
   696         16  DC-BIN-DATE-2             PIC XX.
   697         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   698         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   699                       DC-GREG-DATE-1-EDIT.
   700             20  DC-EDIT1-MONTH        PIC 99.
   701             20  SLASH1-1              PIC X.
   702             20  DC-EDIT1-DAY          PIC 99.
   703             20  SLASH1-2              PIC X.
   704             20  DC-EDIT1-YEAR         PIC 99.
   705         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   706         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   707                     DC-GREG-DATE-2-EDIT.
   708             20  DC-EDIT2-MONTH        PIC 99.
   709             20  SLASH2-1              PIC X.
   710             20  DC-EDIT2-DAY          PIC 99.
   711             20  SLASH2-2              PIC X.
   712             20  DC-EDIT2-YEAR         PIC 99.
   713         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   714         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   715                     DC-GREG-DATE-1-YMD.
   716             20  DC-YMD-YEAR           PIC 99.
   717             20  DC-YMD-MONTH          PIC 99.
   718             20  DC-YMD-DAY            PIC 99.
   719         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   720         16  DC-GREG-DATE-1-MDY-R REDEFINES
   721                      DC-GREG-DATE-1-MDY.
   722             20  DC-MDY-MONTH          PIC 99.
   723             20  DC-MDY-DAY            PIC 99.
   724             20  DC-MDY-YEAR           PIC 99.
   725         16  DC-GREG-DATE-1-ALPHA.
   726             20  DC-ALPHA-MONTH        PIC X(10).
   727             20  DC-ALPHA-DAY          PIC 99.
   728             20  FILLER                PIC XX.
   729             20  DC-ALPHA-CENTURY.
   730                 24 DC-ALPHA-CEN-N     PIC 99.
   731             20  DC-ALPHA-YEAR         PIC 99.
   732         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   733         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   734         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   735         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  15
* EL1278.cbl
   736         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   737                                       PIC 9(05).
   738         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   739             20  DC-JULIAN-YEAR        PIC 99.
   740             20  DC-JULIAN-DAYS        PIC 999.
   741         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   742         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   743         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   744     12  DATE-CONVERSION-VARIBLES.
   745         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   746         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   747             20  FILLER                PIC 9(3).
   748             20  HOLD-CEN-1-CCYY.
   749                 24  HOLD-CEN-1-CC     PIC 99.
   750                 24  HOLD-CEN-1-YY     PIC 99.
   751             20  HOLD-CEN-1-MO         PIC 99.
   752             20  HOLD-CEN-1-DA         PIC 99.
   753         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   754             20  HOLD-CEN-1-R-MO       PIC 99.
   755             20  HOLD-CEN-1-R-DA       PIC 99.
   756             20  HOLD-CEN-1-R-CCYY.
   757                 24  HOLD-CEN-1-R-CC   PIC 99.
   758                 24  HOLD-CEN-1-R-YY   PIC 99.
   759             20  FILLER                PIC 9(3).
   760         16  HOLD-CENTURY-1-X.
   761             20  FILLER                PIC X(3)  VALUE SPACES.
   762             20  HOLD-CEN-1-X-CCYY.
   763                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   764                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   765             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   766             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   767         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   768             20  HOLD-CEN-1-R-X-MO     PIC XX.
   769             20  HOLD-CEN-1-R-X-DA     PIC XX.
   770             20  HOLD-CEN-1-R-X-CCYY.
   771                 24  HOLD-CEN-1-R-X-CC PIC XX.
   772                 24  HOLD-CEN-1-R-X-YY PIC XX.
   773             20  FILLER                PIC XXX.
   774         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   775         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   776         16  DC-JULIAN-DATE-1          PIC 9(07).
   777         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   778             20  DC-JULIAN-1-CCYY.
   779                 24  DC-JULIAN-1-CC    PIC 99.
   780                 24  DC-JULIAN-1-YR    PIC 99.
   781             20  DC-JULIAN-DA-1        PIC 999.
   782         16  DC-JULIAN-DATE-2          PIC 9(07).
   783         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   784             20  DC-JULIAN-2-CCYY.
   785                 24  DC-JULIAN-2-CC    PIC 99.
   786                 24  DC-JULIAN-2-YR    PIC 99.
   787             20  DC-JULIAN-DA-2        PIC 999.
   788         16  DC-GREG-DATE-A-EDIT.
   789             20  DC-EDITA-MONTH        PIC 99.
   790             20  SLASHA-1              PIC X VALUE '/'.
   791             20  DC-EDITA-DAY          PIC 99.
   792             20  SLASHA-2              PIC X VALUE '/'.
   793             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  16
* EL1278.cbl
   794                 24  DC-EDITA-CENT     PIC 99.
   795                 24  DC-EDITA-YEAR     PIC 99.
   796         16  DC-GREG-DATE-B-EDIT.
   797             20  DC-EDITB-MONTH        PIC 99.
   798             20  SLASHB-1              PIC X VALUE '/'.
   799             20  DC-EDITB-DAY          PIC 99.
   800             20  SLASHB-2              PIC X VALUE '/'.
   801             20  DC-EDITB-CCYY.
   802                 24  DC-EDITB-CENT     PIC 99.
   803                 24  DC-EDITB-YEAR     PIC 99.
   804         16  DC-GREG-DATE-CYMD         PIC 9(08).
   805         16  DC-GREG-DATE-CYMD-R REDEFINES
   806                              DC-GREG-DATE-CYMD.
   807             20  DC-CYMD-CEN           PIC 99.
   808             20  DC-CYMD-YEAR          PIC 99.
   809             20  DC-CYMD-MONTH         PIC 99.
   810             20  DC-CYMD-DAY           PIC 99.
   811         16  DC-GREG-DATE-MDCY         PIC 9(08).
   812         16  DC-GREG-DATE-MDCY-R REDEFINES
   813                              DC-GREG-DATE-MDCY.
   814             20  DC-MDCY-MONTH         PIC 99.
   815             20  DC-MDCY-DAY           PIC 99.
   816             20  DC-MDCY-CEN           PIC 99.
   817             20  DC-MDCY-YEAR          PIC 99.
   818    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   819        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   820    12  DC-EL310-DATE                  PIC X(21).
   821    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  17
* EL1278.cbl
   823*                            COPY ELCLOGOF.
   824******************************************************************
   825*                                                                *
   826*                                                                *
   827*                            ELCLOGOF.                           *
   828*                            VMOD=2.001                          *
   829*                                                                *
   830*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   831*                                                                *
   832******************************************************************
   833 01  CLASIC-LOGOFF.
   834     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   835     12  LOGOFF-TEXT.
   836         16  FILLER          PIC X(5)    VALUE SPACES.
   837         16  LOGOFF-MSG.
   838             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   839             20  FILLER      PIC X       VALUE SPACES.
   840             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   841         16  FILLER          PIC X(80)
   842           VALUE '* YOU ARE NOW LOGGED OFF'.
   843         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   844         16  FILLER          PIC X       VALUE QUOTE.
   845         16  LOGOFF-SYS-MSG  PIC X(17)
   846           VALUE 'S CLAS-IC SYSTEM '.
   847     12  TEXT-MESSAGES.
   848         16  UNACCESS-MSG    PIC X(29)
   849             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   850         16  PGMIDERR-MSG    PIC X(17)
   851             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  18
* EL1278.cbl
   853*                            COPY ELCATTR.
   854******************************************************************
   855*                                                                *
   856*                            ELCATTR.                            *
   857*                            VMOD=2.001                          *
   858*                                                                *
   859*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   860*                                                                *
   861*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   862*                                                                *
   863*                   POS 1   P=PROTECTED                          *
   864*                           U=UNPROTECTED                        *
   865*                           S=ASKIP                              *
   866*                   POS 2   A=ALPHA/NUMERIC                      *
   867*                           N=NUMERIC                            *
   868*                   POS 3   N=NORMAL                             *
   869*                           B=BRIGHT                             *
   870*                           D=DARK                               *
   871*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   872*                           OF=MODIFIED DATA TAG OFF             *
   873*                                                                *
   874*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   875******************************************************************
   876 01  ATTRIBUTE-LIST.
   877     12  AL-PABOF            PIC X       VALUE 'Y'.
   878     12  AL-PABON            PIC X       VALUE 'Z'.
   879     12  AL-PADOF            PIC X       VALUE '%'.
   880     12  AL-PADON            PIC X       VALUE '_'.
   881     12  AL-PANOF            PIC X       VALUE '-'.
   882     12  AL-PANON            PIC X       VALUE '/'.
   883     12  AL-SABOF            PIC X       VALUE '8'.
   884     12  AL-SABON            PIC X       VALUE '9'.
   885     12  AL-SADOF            PIC X       VALUE '@'.
   886     12  AL-SADON            PIC X       VALUE QUOTE.
   887     12  AL-SANOF            PIC X       VALUE '0'.
   888     12  AL-SANON            PIC X       VALUE '1'.
   889     12  AL-UABOF            PIC X       VALUE 'H'.
   890     12  AL-UABON            PIC X       VALUE 'I'.
   891     12  AL-UADOF            PIC X       VALUE '<'.
   892     12  AL-UADON            PIC X       VALUE '('.
   893     12  AL-UANOF            PIC X       VALUE ' '.
   894     12  AL-UANON            PIC X       VALUE 'A'.
   895     12  AL-UNBOF            PIC X       VALUE 'Q'.
   896     12  AL-UNBON            PIC X       VALUE 'R'.
   897     12  AL-UNDOF            PIC X       VALUE '*'.
   898     12  AL-UNDON            PIC X       VALUE ')'.
   899     12  AL-UNNOF            PIC X       VALUE '&'.
   900     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  19
* EL1278.cbl
   902*                            COPY ELCEMIB.
   903******************************************************************
   904*                                                                *
   905*                                                                *
   906*                            ELCEMIB.                            *
   907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   908*                            VMOD=2.005                          *
   909*                                                                *
   910*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   911*                                                                *
   912******************************************************************
   913 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   914     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   915     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   916     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   917     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   918     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   919     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   920     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   921     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   922     12  EMI-SWITCH1             PIC X        VALUE '1'.
   923         88  EMI-NO-ERRORS                    VALUE '1'.
   924         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   925         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   926     12  EMI-SWITCH2             PIC X        VALUE '1'.
   927         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   928     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   929         88  EMI-AREA1-EMPTY                  VALUE '1'.
   930         88  EMI-AREA1-FULL                   VALUE '2'.
   931     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   932         88  EMI-AREA2-EMPTY                  VALUE '1'.
   933         88  EMI-AREA2-FULL                   VALUE '2'.
   934     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   935         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   936         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   937         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   938         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   939         88  EMI-BYPASS-FATALS                VALUE 'X'.
   940     12  EMI-ERROR-LINES.
   941         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   942         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   943         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   944         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   945             20  EMI-ERR-CODES OCCURS 10 TIMES.
   946                 24  EMI-ERR-NUM         PIC X(4).
   947                 24  EMI-FILLER          PIC X.
   948                 24  EMI-SEV             PIC X.
   949                 24  FILLER              PIC X.
   950             20  FILLER                  PIC X(02).
   951     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   952         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   953             20  EMI-ERROR-NUMBER    PIC X(4).
   954             20  EMI-FILL            PIC X.
   955             20  EMI-SEVERITY        PIC X.
   956             20  FILLER              PIC X.
   957             20  EMI-ERROR-TEXT.
   958                 24  EMI-TEXT-VARIABLE   PIC X(10).
   959                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  20
* EL1278.cbl
   960     12  EMI-SEVERITY-SAVE           PIC X.
   961         88  EMI-NOTE                    VALUE 'N'.
   962         88  EMI-WARNING                 VALUE 'W'.
   963         88  EMI-FORCABLE                VALUE 'F'.
   964         88  EMI-FATAL                   VALUE 'X'.
   965     12  EMI-MESSAGE-FLAG            PIC X.
   966         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   967         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   968     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   969     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   970         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   971         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   972         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   973     12  emi-claim-no                pic x(7).
   974     12  emi-claim-type              pic x(6).
   975     12  FILLER                      PIC X(124)  VALUE SPACES.
   976     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   977     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   978     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   979     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  21
* EL1278.cbl
   981 01  WS-PASS-631.
   982     12  WS-PASS-WORK-AREA         PIC X(384).
   983     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   984     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   985*        COPY ELC631PI.
   986******************************************************************
   987*                                                                *
   988*                                                                *
   989*                            ELC631PI                            *
   990*                            VMOD=2.012                          *
   991*                                                                *
   992*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   993*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   994*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   995*                                                                *
   996*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   997*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   998*    BETWEEN PROGRAMS.                                           *
   999*                                                                *
  1000*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1001*                                                                *
  1002*               EL631 - EL6311 - EL6312 - EL6313                 *
  1003*                                                                *
  1004******************************************************************
  1005*                   C H A N G E   L O G
  1006*
  1007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1008*-----------------------------------------------------------------
  1009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1010* EFFECTIVE    NUMBER
  1011*-----------------------------------------------------------------
  1012* 021414    2003053000001  PEMA  changes for auto chk request
  1013******************************************************************
  1014
  1015         16  PI-631-DATA.
  1016             20  PI-ERPNDB-KEY.
  1017                 24  PI-PB-COMPANY-CD     PIC X.
  1018                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1019                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1020                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1021
  1022             20  PI-ERPNDB-ALT-KEY.
  1023                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1024                 24  PI-PB-CARRIER        PIC X.
  1025                 24  PI-PB-GROUPING       PIC X(6).
  1026                 24  PI-PB-STATE          PIC XX.
  1027                 24  PI-PB-ACCOUNT        PIC X(10).
  1028                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1029                 24  PI-PB-CERT-NO.
  1030                     28  PI-PB-CERT-PRIME PIC X(10).
  1031                     28  PI-PB-CERT-SFX   PIC X.
  1032                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1033                 24  PI-PB-RECORD-TYPE    PIC X.
  1034
  1035             20  PI-ERPNDB-CSR-KEY.
  1036                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1037                 24  PI-PB-CSR-ID             PIC X(4).
  1038                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  22
* EL1278.cbl
  1039                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1040                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1041
  1042             20  PI-BROWSE-TYPE               PIC X.
  1043                 88  PI-FILE-BROWSE             VALUE ' '.
  1044                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1045                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1046                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1047                 88  PI-CSR-BROWSE              VALUE '4'.
  1048
  1049             20  PI-MAINT-FUNCTION            PIC X.
  1050                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1051                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1052                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1053                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1054                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1055                 88  PI-PF5-FUNCTION            VALUE '5'.
  1056                 88  PI-PF6-FUNCTION            VALUE '6'.
  1057
  1058             20  PI-FILE-SWITCHES.
  1059                 24  PI-ALL-ISSUES-SW         PIC X.
  1060                     88  ALL-ISSUES             VALUE 'Y'.
  1061                 24  PI-ALL-CANCELS-SW        PIC X.
  1062                     88  ALL-CANCELS            VALUE 'Y'.
  1063                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1064                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1065                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1066                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1067                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1068                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1069                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1070                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1071                 24  PI-HOLD-REC-SW           PIC X.
  1072                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1073                 24  PI-CHANGE-REC-SW         PIC X.
  1074                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1075                 24  PI-CHK-REQ-REC-SW        PIC X.
  1076                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1077                 24  PI-ISSUE-WARNING-SW      PIC X.
  1078                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1079                 24  PI-CANCEL-WARNING-SW     PIC X.
  1080                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1081             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1082                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1083             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1084                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1085
  1086             20  PI-MAP-NAME                  PIC X(8).
  1087
  1088             20  PI-CURSOR                    PIC S9(4) COMP.
  1089
  1090             20  PI-PREV-ALT-KEY              PIC X(36).
  1091             20  PI-PREV-CSR-KEY              PIC X(15).
  1092             20  PI-PREV-KEY.
  1093                 24  PI-PREV-COMPANY-CD       PIC X.
  1094                 24  PI-PREV-BATCH            PIC X(6).
  1095                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1096                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  23
* EL1278.cbl
  1097             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1098             20  PI-BROWSE-SW                 PIC X.
  1099                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1100                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1101             20  PI-SV-CARRIER                PIC X.
  1102             20  PI-SV-GROUPING               PIC X(6).
  1103             20  PI-SV-STATE                  PIC XX.
  1104             20  PI-EDIT-SW                   PIC X.
  1105             20  PI-DISPLAY-SW                PIC XX.
  1106                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1107                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1108             20  PI-CRITERIA-DATA             PIC X(350).
  1109             20  PI-BMODE                     PIC X.
  1110             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1111             20  PI-BPMTS                     PIC S999     COMP-3.
  1112             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1113             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1114             20  PI-CSR-SESSION-SW            PIC X.
  1115                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1116             20  PI-ERRORS-SW                 PIC X.
  1117                 88  FATAL-ERRORS               VALUE 'X'.
  1118*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1119             20  pi-unforced-sw               pic x.
  1120                 88  unforced-errors            value 'X'.
  1121             20  FILLER                       PIC X(4).
  1122
  1123         16  FILLER                PIC X(94).
  1124
  1125
  1126*                            COPY ELCINTF.
  1127******************************************************************
  1128*                                                                *
  1129*                                                                *
  1130*                            ELCINTF.                            *
  1131*                            VMOD=2.017                          *
  1132*                                                                *
  1133*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1134*                                                                *
  1135*       LENGTH = 1024                                            *
  1136*                                                                *
  1137******************************************************************
  1138*                   C H A N G E   L O G
  1139*
  1140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1141*-----------------------------------------------------------------
  1142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1143* EFFECTIVE    NUMBER
  1144*-----------------------------------------------------------------
  1145* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1146******************************************************************
  1147 01  PROGRAM-INTERFACE-BLOCK.
  1148     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1149     12  PI-CALLING-PROGRAM              PIC X(8).
  1150     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1151     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1152     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1153     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1154     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  24
* EL1278.cbl
  1155     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1156     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1157     12  PI-COMPANY-ID                   PIC XXX.
  1158     12  PI-COMPANY-CD                   PIC X.
  1159
  1160     12  PI-COMPANY-PASSWORD             PIC X(8).
  1161
  1162     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1163
  1164     12  PI-CONTROL-IN-PROGRESS.
  1165         16  PI-CARRIER                  PIC X.
  1166         16  PI-GROUPING                 PIC X(6).
  1167         16  PI-STATE                    PIC XX.
  1168         16  PI-ACCOUNT                  PIC X(10).
  1169         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1170                                         PIC X(10).
  1171         16  PI-CLAIM-CERT-GRP.
  1172             20  PI-CLAIM-NO             PIC X(7).
  1173             20  PI-CERT-NO.
  1174                 25  PI-CERT-PRIME       PIC X(10).
  1175                 25  PI-CERT-SFX         PIC X.
  1176             20  PI-CERT-EFF-DT          PIC XX.
  1177         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1178             20  PI-PLAN-CODE            PIC X(2).
  1179             20  PI-REVISION-NUMBER      PIC X(3).
  1180             20  PI-PLAN-EFF-DT          PIC X(2).
  1181             20  PI-PLAN-EXP-DT          PIC X(2).
  1182             20  FILLER                  PIC X(11).
  1183         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1184             20  PI-OE-REFERENCE-1.
  1185                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1186                 25  PI-OE-REF-1-SUFF    PIC XX.
  1187
  1188     12  PI-SESSION-IN-PROGRESS          PIC X.
  1189         88  CLAIM-SESSION                   VALUE '1'.
  1190         88  CREDIT-SESSION                  VALUE '2'.
  1191         88  WARRANTY-SESSION                VALUE '3'.
  1192         88  MORTGAGE-SESSION                VALUE '4'.
  1193         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1194
  1195
  1196*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1197
  1198     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1199     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1200
  1201     12  PI-CREDIT-USER                  PIC X.
  1202         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1203         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1204
  1205     12  PI-CLAIM-USER                   PIC X.
  1206         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1207         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1208
  1209     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1210         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1211         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1212         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  25
* EL1278.cbl
  1213         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1214         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1215
  1216     12  PI-PROCESSOR-ID                 PIC X(4).
  1217
  1218     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1219
  1220     12  PI-MEMBER-CAPTION               PIC X(10).
  1221
  1222     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1223         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1224
  1225     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1226     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1227     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1228     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1229
  1230     12  PI-AH-OVERRIDE-L1               PIC X.
  1231     12  PI-AH-OVERRIDE-L2               PIC XX.
  1232     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1233     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1234
  1235     12  PI-NEW-SYSTEM                   PIC X(2).
  1236
  1237     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1238     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1239         88  PI-USES-PAID-TO                 VALUE '1'.
  1240     12  PI-CRDTCRD-SYSTEM.
  1241         16  PI-CRDTCRD-USER             PIC X.
  1242             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1243             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1244         16  PI-CC-MONTH-END-DT          PIC XX.
  1245     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1246
  1247     12  PI-OE-REFERENCE-2.
  1248         16  PI-OE-REF-2-PRIME           PIC X(10).
  1249         16  PI-OE-REF-2-SUFF            PIC X.
  1250
  1251     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1252
  1253     12  PI-LANGUAGE-TYPE                PIC X.
  1254             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1255             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1256             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1257
  1258     12  PI-POLICY-LINKAGE-IND           PIC X.
  1259         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1260         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1261                                                   LOW-VALUES.
  1262
  1263     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1264     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1265         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1266         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1267
  1268     12  PI-PROCESSOR-CSR-IND            PIC X.
  1269         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1270         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  26
* EL1278.cbl
  1271
  1272     12  FILLER                          PIC X(3).
  1273
  1274     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1275
  1276     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1277         PI-SYSTEM-LEVEL.
  1278
  1279         16  PI-ENTRY-CODES.
  1280             20  PI-ENTRY-CD-1           PIC X.
  1281             20  PI-ENTRY-CD-2           PIC X.
  1282
  1283         16  PI-RETURN-CODES.
  1284             20  PI-RETURN-CD-1          PIC X.
  1285             20  PI-RETURN-CD-2          PIC X.
  1286
  1287         16  PI-UPDATE-STATUS-SAVE.
  1288             20  PI-UPDATE-BY            PIC X(4).
  1289             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1290
  1291         16  PI-LOWER-CASE-LETTERS       PIC X.
  1292             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1293
  1294*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1295*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1296*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1297
  1298         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1299             88  ST-ACCNT-CNTL               VALUE ' '.
  1300             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1301             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1302             88  ACCNT-CNTL                  VALUE '3'.
  1303             88  CARR-ACCNT-CNTL             VALUE '4'.
  1304
  1305         16  PI-PROCESSOR-CAP-LIST.
  1306             20  PI-SYSTEM-CONTROLS.
  1307                24 PI-SYSTEM-DISPLAY     PIC X.
  1308                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1309                24 PI-SYSTEM-MODIFY      PIC X.
  1310                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1311             20  FILLER                  PIC XX.
  1312             20  PI-DISPLAY-CAP          PIC X.
  1313                 88  DISPLAY-CAP             VALUE 'Y'.
  1314             20  PI-MODIFY-CAP           PIC X.
  1315                 88  MODIFY-CAP              VALUE 'Y'.
  1316             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1317                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1318             20  PI-FORCE-CAP            PIC X.
  1319                 88  FORCE-CAP               VALUE 'Y'.
  1320
  1321         16  PI-PROGRAM-CONTROLS.
  1322             20  PI-PGM-PRINT-OPT        PIC X.
  1323             20  PI-PGM-FORMAT-OPT       PIC X.
  1324             20  PI-PGM-PROCESS-OPT      PIC X.
  1325             20  PI-PGM-TOTALS-OPT       PIC X.
  1326
  1327         16  PI-HELP-INTERFACE.
  1328             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  27
* EL1278.cbl
  1329             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1330
  1331         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1332             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1333
  1334         16  PI-CR-CONTROL-IN-PROGRESS.
  1335             20  PI-CR-CARRIER           PIC X.
  1336             20  PI-CR-GROUPING          PIC X(6).
  1337             20  PI-CR-STATE             PIC XX.
  1338             20  PI-CR-ACCOUNT           PIC X(10).
  1339             20  PI-CR-FIN-RESP          PIC X(10).
  1340             20  PI-CR-TYPE              PIC X.
  1341
  1342         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1343
  1344         16  PI-CR-MONTH-END-DT          PIC XX.
  1345
  1346         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1347             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1348             88  PI-ZERO-CARRIER             VALUE '1'.
  1349             88  PI-ZERO-GROUPING            VALUE '2'.
  1350             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1351
  1352         16  PI-CARRIER-SECURITY         PIC X.
  1353             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1354
  1355         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1356             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1357             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1358
  1359         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1360             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1361                                         INDEXED BY PI-ACCESS-NDX
  1362                                         PIC X.
  1363
  1364         16  PI-GA-BILLING-CONTROL       PIC X.
  1365             88  PI-GA-BILLING               VALUE '1'.
  1366
  1367         16  PI-MAIL-PROCESSING          PIC X.
  1368             88  PI-MAIL-YES                 VALUE 'Y'.
  1369
  1370         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1371
  1372         16  PI-AR-SYSTEM.
  1373             20  PI-AR-PROCESSING-CNTL   PIC X.
  1374                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1375             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1376             20  PI-AR-MONTH-END-DT      PIC XX.
  1377
  1378         16  PI-MP-SYSTEM.
  1379             20  PI-MORTGAGE-USER            PIC X.
  1380                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1381                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1382             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1383                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1384                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1385                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1386                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  28
* EL1278.cbl
  1387                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1388             20  PI-MP-MONTH-END-DT          PIC XX.
  1389             20  PI-MP-REFERENCE-NO.
  1390                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1391                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1392
  1393         16  PI-LABEL-CONTROL            PIC X(01).
  1394             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1395             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1396
  1397         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1398             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1399
  1400         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1401             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1402             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1403
  1404         16  FILLER                      PIC X(14).
  1405
  1406     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1407******************************************************************
  1408     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1409         16  FILLER                PIC  X(500).
  1410         16  PI-PEND-SW            PIC  X(01).
  1411         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1412         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1413         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1414         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1415         16  PI-EARNING-METHOD-LF  PIC  X.
  1416         16  PI-EARNING-METHOD-AH  PIC  X.
  1417         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1418         16  PI-LF-REFUND-METH     PIC  X.
  1419         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1420         16  PI-AH-REFUND-METH     PIC  X.
  1421         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1422         16  PI-MODIFY-CERT-CAP    PIC  X.
  1423             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1424         16  PI-CLP-YN             PIC X.
  1425         16  PI-CANCEL-REASON      PIC X.
  1426         16  PI-PF10-OK            PIC X.
  1427         16  FILLER                PIC  X(96).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  29
* EL1278.cbl
  1429*                            COPY ELCAID.
  1430******************************************************************
  1431*                                                                *
  1432*                            ELCAID.                             *
  1433*                            VMOD=2.001                          *
  1434*                                                                *
  1435*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1436*                                                                *
  1437*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1438*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1439******************************************************************
  1440
  1441 01  DFHAID.
  1442   02  DFHNULL   PIC  X  VALUE  ' '.
  1443   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1444   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1445   02  DFHPEN    PIC  X  VALUE  '='.
  1446   02  DFHOPID   PIC  X  VALUE  'W'.
  1447   02  DFHPA1    PIC  X  VALUE  '%'.
  1448   02  DFHPA2    PIC  X  VALUE  '>'.
  1449   02  DFHPA3    PIC  X  VALUE  ','.
  1450   02  DFHPF1    PIC  X  VALUE  '1'.
  1451   02  DFHPF2    PIC  X  VALUE  '2'.
  1452   02  DFHPF3    PIC  X  VALUE  '3'.
  1453   02  DFHPF4    PIC  X  VALUE  '4'.
  1454   02  DFHPF5    PIC  X  VALUE  '5'.
  1455   02  DFHPF6    PIC  X  VALUE  '6'.
  1456   02  DFHPF7    PIC  X  VALUE  '7'.
  1457   02  DFHPF8    PIC  X  VALUE  '8'.
  1458   02  DFHPF9    PIC  X  VALUE  '9'.
  1459   02  DFHPF10   PIC  X  VALUE  ':'.
  1460   02  DFHPF11   PIC  X  VALUE  '#'.
  1461   02  DFHPF12   PIC  X  VALUE  '@'.
  1462   02  DFHPF13   PIC  X  VALUE  'A'.
  1463   02  DFHPF14   PIC  X  VALUE  'B'.
  1464   02  DFHPF15   PIC  X  VALUE  'C'.
  1465   02  DFHPF16   PIC  X  VALUE  'D'.
  1466   02  DFHPF17   PIC  X  VALUE  'E'.
  1467   02  DFHPF18   PIC  X  VALUE  'F'.
  1468   02  DFHPF19   PIC  X  VALUE  'G'.
  1469   02  DFHPF20   PIC  X  VALUE  'H'.
  1470   02  DFHPF21   PIC  X  VALUE  'I'.
  1471*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1472   02  DFHPF22   PIC  X  VALUE  '['.
  1473   02  DFHPF23   PIC  X  VALUE  '.'.
  1474   02  DFHPF24   PIC  X  VALUE  '<'.
  1475   02  DFHMSRE   PIC  X  VALUE  'X'.
  1476   02  DFHSTRF   PIC  X  VALUE  'h'.
  1477   02  DFHTRIG   PIC  X  VALUE  '"'.
  1478
  1479 01  FILLER  REDEFINES  DFHAID.
  1480     12  FILLER                  PIC  X(08).
  1481     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  30
* EL1278.cbl
  1483*                            COPY EL1278S.
  1484 01  EL127HI.
  1485     05  FILLER            PIC  X(0012).
  1486*    -------------------------------
  1487     05  HDATEL PIC S9(0004) COMP.
  1488     05  HDATEF PIC  X(0001).
  1489     05  FILLER REDEFINES HDATEF.
  1490         10  HDATEA PIC  X(0001).
  1491     05  HDATEI PIC  X(0008).
  1492*    -------------------------------
  1493     05  HTIMEL PIC S9(0004) COMP.
  1494     05  HTIMEF PIC  X(0001).
  1495     05  FILLER REDEFINES HTIMEF.
  1496         10  HTIMEA PIC  X(0001).
  1497     05  HTIMEI PIC  999V99.
  1498*    -------------------------------
  1499     05  CMPNYIDL PIC S9(0004) COMP.
  1500     05  CMPNYIDF PIC  X(0001).
  1501     05  FILLER REDEFINES CMPNYIDF.
  1502         10  CMPNYIDA PIC  X(0001).
  1503     05  CMPNYIDI PIC  X(0003).
  1504*    -------------------------------
  1505     05  USERIDL PIC S9(0004) COMP.
  1506     05  USERIDF PIC  X(0001).
  1507     05  FILLER REDEFINES USERIDF.
  1508         10  USERIDA PIC  X(0001).
  1509     05  USERIDI PIC  X(0004).
  1510*    -------------------------------
  1511     05  HCARIERL PIC S9(0004) COMP.
  1512     05  HCARIERF PIC  X(0001).
  1513     05  FILLER REDEFINES HCARIERF.
  1514         10  HCARIERA PIC  X(0001).
  1515     05  HCARIERI PIC  X(0001).
  1516*    -------------------------------
  1517     05  HGROUPL PIC S9(0004) COMP.
  1518     05  HGROUPF PIC  X(0001).
  1519     05  FILLER REDEFINES HGROUPF.
  1520         10  HGROUPA PIC  X(0001).
  1521     05  HGROUPI PIC  X(0006).
  1522*    -------------------------------
  1523     05  HSTATEL PIC S9(0004) COMP.
  1524     05  HSTATEF PIC  X(0001).
  1525     05  FILLER REDEFINES HSTATEF.
  1526         10  HSTATEA PIC  X(0001).
  1527     05  HSTATEI PIC  X(0002).
  1528*    -------------------------------
  1529     05  HACCTNOL PIC S9(0004) COMP.
  1530     05  HACCTNOF PIC  X(0001).
  1531     05  FILLER REDEFINES HACCTNOF.
  1532         10  HACCTNOA PIC  X(0001).
  1533     05  HACCTNOI PIC  X(0010).
  1534*    -------------------------------
  1535     05  HEFFDTL PIC S9(0004) COMP.
  1536     05  HEFFDTF PIC  X(0001).
  1537     05  FILLER REDEFINES HEFFDTF.
  1538         10  HEFFDTA PIC  X(0001).
  1539     05  HEFFDTI PIC  X(0008).
  1540*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  31
* EL1278.cbl
  1541     05  HCERTNOL PIC S9(0004) COMP.
  1542     05  HCERTNOF PIC  X(0001).
  1543     05  FILLER REDEFINES HCERTNOF.
  1544         10  HCERTNOA PIC  X(0001).
  1545     05  HCERTNOI PIC  X(0010).
  1546*    -------------------------------
  1547     05  HCRTSFXL PIC S9(0004) COMP.
  1548     05  HCRTSFXF PIC  X(0001).
  1549     05  FILLER REDEFINES HCRTSFXF.
  1550         10  HCRTSFXA PIC  X(0001).
  1551     05  HCRTSFXI PIC  X(0001).
  1552*    -------------------------------
  1553     05  HLNAMEL PIC S9(0004) COMP.
  1554     05  HLNAMEF PIC  X(0001).
  1555     05  FILLER REDEFINES HLNAMEF.
  1556         10  HLNAMEA PIC  X(0001).
  1557     05  HLNAMEI PIC  X(0015).
  1558*    -------------------------------
  1559     05  HFNAMEL PIC S9(0004) COMP.
  1560     05  HFNAMEF PIC  X(0001).
  1561     05  FILLER REDEFINES HFNAMEF.
  1562         10  HFNAMEA PIC  X(0001).
  1563     05  HFNAMEI PIC  X(0010).
  1564*    -------------------------------
  1565     05  HINITL PIC S9(0004) COMP.
  1566     05  HINITF PIC  X(0001).
  1567     05  FILLER REDEFINES HINITF.
  1568         10  HINITA PIC  X(0001).
  1569     05  HINITI PIC  X(0001).
  1570*    -------------------------------
  1571     05  LCLMDTHL PIC S9(0004) COMP.
  1572     05  LCLMDTHF PIC  X(0001).
  1573     05  FILLER REDEFINES LCLMDTHF.
  1574         10  LCLMDTHA PIC  X(0001).
  1575     05  LCLMDTHI PIC  X(0022).
  1576*    -------------------------------
  1577     05  LCLMDTL PIC S9(0004) COMP.
  1578     05  LCLMDTF PIC  X(0001).
  1579     05  FILLER REDEFINES LCLMDTF.
  1580         10  LCLMDTA PIC  X(0001).
  1581     05  LCLMDTI PIC  X(0008).
  1582*    -------------------------------
  1583     05  HPCYNL PIC S9(0004) COMP.
  1584     05  HPCYNF PIC  X(0001).
  1585     05  FILLER REDEFINES HPCYNF.
  1586         10  HPCYNA PIC  X(0001).
  1587     05  HPCYNI PIC  X(0001).
  1588*    -------------------------------
  1589     05  ACLMDTHL PIC S9(0004) COMP.
  1590     05  ACLMDTHF PIC  X(0001).
  1591     05  FILLER REDEFINES ACLMDTHF.
  1592         10  ACLMDTHA PIC  X(0001).
  1593     05  ACLMDTHI PIC  X(0023).
  1594*    -------------------------------
  1595     05  ACLMDTL PIC S9(0004) COMP.
  1596     05  ACLMDTF PIC  X(0001).
  1597     05  FILLER REDEFINES ACLMDTF.
  1598         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  32
* EL1278.cbl
  1599     05  ACLMDTI PIC  X(0008).
  1600*    -------------------------------
  1601     05  PMTHDL PIC S9(0004) COMP.
  1602     05  PMTHDF PIC  X(0001).
  1603     05  FILLER REDEFINES PMTHDF.
  1604         10  PMTHDA PIC  X(0001).
  1605     05  PMTHDI PIC  X(0010).
  1606*    -------------------------------
  1607     05  CNCDTHDL PIC S9(0004) COMP.
  1608     05  CNCDTHDF PIC  X(0001).
  1609     05  FILLER REDEFINES CNCDTHDF.
  1610         10  CNCDTHDA PIC  X(0001).
  1611     05  CNCDTHDI PIC  X(0007).
  1612*    -------------------------------
  1613     05  HLKINDL PIC S9(0004) COMP.
  1614     05  HLKINDF PIC  X(0001).
  1615     05  FILLER REDEFINES HLKINDF.
  1616         10  HLKINDA PIC  X(0001).
  1617     05  HLKINDI PIC  X(0002).
  1618*    -------------------------------
  1619     05  HLCDL PIC S9(0004) COMP.
  1620     05  HLCDF PIC  X(0001).
  1621     05  FILLER REDEFINES HLCDF.
  1622         10  HLCDA PIC  X(0001).
  1623     05  HLCDI PIC  X(0002).
  1624*    -------------------------------
  1625     05  HLEDESCL PIC S9(0004) COMP.
  1626     05  HLEDESCF PIC  X(0001).
  1627     05  FILLER REDEFINES HLEDESCF.
  1628         10  HLEDESCA PIC  X(0001).
  1629     05  HLEDESCI PIC  X(0003).
  1630*    -------------------------------
  1631     05  HLTERML PIC S9(0004) COMP.
  1632     05  HLTERMF PIC  X(0001).
  1633     05  FILLER REDEFINES HLTERMF.
  1634         10  HLTERMA PIC  X(0001).
  1635     05  HLTERMI PIC  9(3).
  1636*    -------------------------------
  1637     05  HLREML PIC S9(0004) COMP.
  1638     05  HLREMF PIC  X(0001).
  1639     05  FILLER REDEFINES HLREMF.
  1640         10  HLREMA PIC  X(0001).
  1641     05  HLREMI PIC  X(0003).
  1642*    -------------------------------
  1643     05  HLPREML PIC S9(0004) COMP.
  1644     05  HLPREMF PIC  X(0001).
  1645     05  FILLER REDEFINES HLPREMF.
  1646         10  HLPREMA PIC  X(0001).
  1647     05  HLPREMI PIC  X(0011).
  1648*    -------------------------------
  1649     05  HLITDRL PIC S9(0004) COMP.
  1650     05  HLITDRF PIC  X(0001).
  1651     05  FILLER REDEFINES HLITDRF.
  1652         10  HLITDRA PIC  X(0001).
  1653     05  HLITDRI PIC  X(0011).
  1654*    -------------------------------
  1655     05  HLREFNDL PIC S9(0004) COMP.
  1656     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  33
* EL1278.cbl
  1657     05  FILLER REDEFINES HLREFNDF.
  1658         10  HLREFNDA PIC  X(0001).
  1659     05  HLREFNDI PIC  X(0011).
  1660*    -------------------------------
  1661     05  HLCANCL PIC S9(0004) COMP.
  1662     05  HLCANCF PIC  X(0001).
  1663     05  FILLER REDEFINES HLCANCF.
  1664         10  HLCANCA PIC  X(0001).
  1665     05  HLCANCI PIC  X(0008).
  1666*    -------------------------------
  1667     05  HLCAL1L PIC S9(0004) COMP.
  1668     05  HLCAL1F PIC  X(0001).
  1669     05  FILLER REDEFINES HLCAL1F.
  1670         10  HLCAL1A PIC  X(0001).
  1671     05  HLCAL1I PIC  X(0001).
  1672*    -------------------------------
  1673     05  HLCALCL PIC S9(0004) COMP.
  1674     05  HLCALCF PIC  X(0001).
  1675     05  FILLER REDEFINES HLCALCF.
  1676         10  HLCALCA PIC  X(0001).
  1677     05  HLCALCI PIC  X(0012).
  1678*    -------------------------------
  1679     05  HLCPCTL PIC S9(0004) COMP.
  1680     05  HLCPCTF PIC  X(0001).
  1681     05  FILLER REDEFINES HLCPCTF.
  1682         10  HLCPCTA PIC  X(0001).
  1683     05  HLCPCTI PIC  X(0006).
  1684*    -------------------------------
  1685     05  HLCAMTL PIC S9(0004) COMP.
  1686     05  HLCAMTF PIC  X(0001).
  1687     05  FILLER REDEFINES HLCAMTF.
  1688         10  HLCAMTA PIC  X(0001).
  1689     05  HLCAMTI PIC  X(0009).
  1690*    -------------------------------
  1691     05  HAKINDL PIC S9(0004) COMP.
  1692     05  HAKINDF PIC  X(0001).
  1693     05  FILLER REDEFINES HAKINDF.
  1694         10  HAKINDA PIC  X(0001).
  1695     05  HAKINDI PIC  X(0002).
  1696*    -------------------------------
  1697     05  HACDL PIC S9(0004) COMP.
  1698     05  HACDF PIC  X(0001).
  1699     05  FILLER REDEFINES HACDF.
  1700         10  HACDA PIC  X(0001).
  1701     05  HACDI PIC  X(0002).
  1702*    -------------------------------
  1703     05  HAEDESCL PIC S9(0004) COMP.
  1704     05  HAEDESCF PIC  X(0001).
  1705     05  FILLER REDEFINES HAEDESCF.
  1706         10  HAEDESCA PIC  X(0001).
  1707     05  HAEDESCI PIC  X(0003).
  1708*    -------------------------------
  1709     05  HATERML PIC S9(0004) COMP.
  1710     05  HATERMF PIC  X(0001).
  1711     05  FILLER REDEFINES HATERMF.
  1712         10  HATERMA PIC  X(0001).
  1713     05  HATERMI PIC  9(3).
  1714*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  34
* EL1278.cbl
  1715     05  HAREML PIC S9(0004) COMP.
  1716     05  HAREMF PIC  X(0001).
  1717     05  FILLER REDEFINES HAREMF.
  1718         10  HAREMA PIC  X(0001).
  1719     05  HAREMI PIC  X(0003).
  1720*    -------------------------------
  1721     05  HAPREML PIC S9(0004) COMP.
  1722     05  HAPREMF PIC  X(0001).
  1723     05  FILLER REDEFINES HAPREMF.
  1724         10  HAPREMA PIC  X(0001).
  1725     05  HAPREMI PIC  X(0011).
  1726*    -------------------------------
  1727     05  HAITDRL PIC S9(0004) COMP.
  1728     05  HAITDRF PIC  X(0001).
  1729     05  FILLER REDEFINES HAITDRF.
  1730         10  HAITDRA PIC  X(0001).
  1731     05  HAITDRI PIC  X(0011).
  1732*    -------------------------------
  1733     05  HAREFNDL PIC S9(0004) COMP.
  1734     05  HAREFNDF PIC  X(0001).
  1735     05  FILLER REDEFINES HAREFNDF.
  1736         10  HAREFNDA PIC  X(0001).
  1737     05  HAREFNDI PIC  X(0011).
  1738*    -------------------------------
  1739     05  HACANCL PIC S9(0004) COMP.
  1740     05  HACANCF PIC  X(0001).
  1741     05  FILLER REDEFINES HACANCF.
  1742         10  HACANCA PIC  X(0001).
  1743     05  HACANCI PIC  X(0008).
  1744*    -------------------------------
  1745     05  HACAL1L PIC S9(0004) COMP.
  1746     05  HACAL1F PIC  X(0001).
  1747     05  FILLER REDEFINES HACAL1F.
  1748         10  HACAL1A PIC  X(0001).
  1749     05  HACAL1I PIC  X(0001).
  1750*    -------------------------------
  1751     05  HACALCL PIC S9(0004) COMP.
  1752     05  HACALCF PIC  X(0001).
  1753     05  FILLER REDEFINES HACALCF.
  1754         10  HACALCA PIC  X(0001).
  1755     05  HACALCI PIC  X(0012).
  1756*    -------------------------------
  1757     05  HACPCTL PIC S9(0004) COMP.
  1758     05  HACPCTF PIC  X(0001).
  1759     05  FILLER REDEFINES HACPCTF.
  1760         10  HACPCTA PIC  X(0001).
  1761     05  HACPCTI PIC  X(0006).
  1762*    -------------------------------
  1763     05  HACAMTL PIC S9(0004) COMP.
  1764     05  HACAMTF PIC  X(0001).
  1765     05  FILLER REDEFINES HACAMTF.
  1766         10  HACAMTA PIC  X(0001).
  1767     05  HACAMTI PIC  X(0009).
  1768*    -------------------------------
  1769     05  CANFEEHL PIC S9(0004) COMP.
  1770     05  CANFEEHF PIC  X(0001).
  1771     05  FILLER REDEFINES CANFEEHF.
  1772         10  CANFEEHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  35
* EL1278.cbl
  1773     05  CANFEEHI PIC  X(0012).
  1774*    -------------------------------
  1775     05  CANFEEL PIC S9(0004) COMP.
  1776     05  CANFEEF PIC  X(0001).
  1777     05  FILLER REDEFINES CANFEEF.
  1778         10  CANFEEA PIC  X(0001).
  1779     05  CANFEEI PIC  X(0006).
  1780*    -------------------------------
  1781     05  TOPREML PIC S9(0004) COMP.
  1782     05  TOPREMF PIC  X(0001).
  1783     05  FILLER REDEFINES TOPREMF.
  1784         10  TOPREMA PIC  X(0001).
  1785     05  TOPREMI PIC  X(0011).
  1786*    -------------------------------
  1787     05  TOITDRL PIC S9(0004) COMP.
  1788     05  TOITDRF PIC  X(0001).
  1789     05  FILLER REDEFINES TOITDRF.
  1790         10  TOITDRA PIC  X(0001).
  1791     05  TOITDRI PIC  X(0011).
  1792*    -------------------------------
  1793     05  TORFNDL PIC S9(0004) COMP.
  1794     05  TORFNDF PIC  X(0001).
  1795     05  FILLER REDEFINES TORFNDF.
  1796         10  TORFNDA PIC  X(0001).
  1797     05  TORFNDI PIC  X(0011).
  1798*    -------------------------------
  1799     05  CANREAHL PIC S9(0004) COMP.
  1800     05  CANREAHF PIC  X(0001).
  1801     05  FILLER REDEFINES CANREAHF.
  1802         10  CANREAHA PIC  X(0001).
  1803     05  CANREAHI PIC  X(0015).
  1804*    -------------------------------
  1805     05  CANREAL PIC S9(0004) COMP.
  1806     05  CANREAF PIC  X(0001).
  1807     05  FILLER REDEFINES CANREAF.
  1808         10  CANREAA PIC  X(0001).
  1809     05  CANREAI PIC  X(0001).
  1810*    -------------------------------
  1811     05  CLPYNHL PIC S9(0004) COMP.
  1812     05  CLPYNHF PIC  X(0001).
  1813     05  FILLER REDEFINES CLPYNHF.
  1814         10  CLPYNHA PIC  X(0001).
  1815     05  CLPYNHI PIC  X(0005).
  1816*    -------------------------------
  1817     05  CLPYNL PIC S9(0004) COMP.
  1818     05  CLPYNF PIC  X(0001).
  1819     05  FILLER REDEFINES CLPYNF.
  1820         10  CLPYNA PIC  X(0001).
  1821     05  CLPYNI PIC  X(0001).
  1822*    -------------------------------
  1823     05  REFDUEHL PIC S9(0004) COMP.
  1824     05  REFDUEHF PIC  X(0001).
  1825     05  FILLER REDEFINES REFDUEHF.
  1826         10  REFDUEHA PIC  X(0001).
  1827     05  REFDUEHI PIC  X(0018).
  1828*    -------------------------------
  1829     05  REFDUEL PIC S9(0004) COMP.
  1830     05  REFDUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  36
* EL1278.cbl
  1831     05  FILLER REDEFINES REFDUEF.
  1832         10  REFDUEA PIC  X(0001).
  1833     05  REFDUEI PIC  X(0010).
  1834*    -------------------------------
  1835     05  HLREDL PIC S9(0004) COMP.
  1836     05  HLREDF PIC  X(0001).
  1837     05  FILLER REDEFINES HLREDF.
  1838         10  HLREDA PIC  X(0001).
  1839     05  HLREDI PIC  X(0014).
  1840*    -------------------------------
  1841     05  FREMTRML PIC S9(0004) COMP.
  1842     05  FREMTRMF PIC  X(0001).
  1843     05  FILLER REDEFINES FREMTRMF.
  1844         10  FREMTRMA PIC  X(0001).
  1845     05  FREMTRMI PIC  X(0003).
  1846*    -------------------------------
  1847     05  HERMSG1L PIC S9(0004) COMP.
  1848     05  HERMSG1F PIC  X(0001).
  1849     05  FILLER REDEFINES HERMSG1F.
  1850         10  HERMSG1A PIC  X(0001).
  1851     05  HERMSG1I PIC  X(0079).
  1852*    -------------------------------
  1853     05  HERMSG2L PIC S9(0004) COMP.
  1854     05  HERMSG2F PIC  X(0001).
  1855     05  FILLER REDEFINES HERMSG2F.
  1856         10  HERMSG2A PIC  X(0001).
  1857     05  HERMSG2I PIC  X(0079).
  1858*    -------------------------------
  1859     05  HPFKEYL PIC S9(0004) COMP.
  1860     05  HPFKEYF PIC  X(0001).
  1861     05  FILLER REDEFINES HPFKEYF.
  1862         10  HPFKEYA PIC  X(0001).
  1863     05  HPFKEYI PIC  99.
  1864*    -------------------------------
  1865     05  PFKEY11L PIC S9(0004) COMP.
  1866     05  PFKEY11F PIC  X(0001).
  1867     05  FILLER REDEFINES PFKEY11F.
  1868         10  PFKEY11A PIC  X(0001).
  1869     05  PFKEY11I PIC  X(0014).
  1870 01  EL127HO REDEFINES EL127HI.
  1871     05  FILLER            PIC  X(0012).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  HDATEO PIC  X(0008).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  HTIMEO PIC  99.99.
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  CMPNYIDO PIC  X(0003).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  USERIDO PIC  X(0004).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  HCARIERO PIC  X(0001).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  37
* EL1278.cbl
  1889     05  HGROUPO PIC  X(0006).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  HSTATEO PIC  X(0002).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  HACCTNOO PIC  X(0010).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  HEFFDTO PIC  X(0008).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  HCERTNOO PIC  X(0010).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  HCRTSFXO PIC  X(0001).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  HLNAMEO PIC  X(0015).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  HFNAMEO PIC  X(0010).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  HINITO PIC  X(0001).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  LCLMDTHO PIC  X(0022).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  LCLMDTO PIC  X(0008).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  HPCYNO PIC  X(0001).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  ACLMDTHO PIC  X(0023).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  ACLMDTO PIC  X(0008).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  PMTHDO PIC  X(0010).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  CNCDTHDO PIC  X(0007).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  HLKINDO PIC  X(0002).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  HLCDO PIC  X(0002).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  HLEDESCO PIC  X(0003).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  HLTERMO PIC  ZZ9.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  38
* EL1278.cbl
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  HLREMO PIC  ZZ9.
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  HLCANCO PIC  X(0008).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  HLCAL1O PIC  X(0001).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  HLCALCO PIC  X(0012).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  HLCPCTO PIC  .99999.
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  HLCAMTO PIC  ZZ,ZZ9.99.
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  HAKINDO PIC  X(0002).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  HACDO PIC  X(0002).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  HAEDESCO PIC  X(0003).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  HATERMO PIC  ZZ9.
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  HAREMO PIC  ZZ9.
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  HACANCO PIC  X(0008).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  HACAL1O PIC  X(0001).
  2004*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  39
* EL1278.cbl
  2005     05  FILLER            PIC  X(0003).
  2006     05  HACALCO PIC  X(0012).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  HACPCTO PIC  .99999.
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  HACAMTO PIC  ZZ,ZZ9.99.
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  CANFEEHO PIC  X(0012).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  CANFEEO PIC  ZZ9.99.
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  CANREAHO PIC  X(0015).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  CANREAO PIC  X(0001).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  CLPYNHO PIC  X(0005).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  CLPYNO PIC  X(0001).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  REFDUEHO PIC  X(0018).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  REFDUEO PIC  ZZZ,ZZ9.99.
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  FREMTRMO PIC  ZZ9.
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  HERMSG1O PIC  X(0079).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  HERMSG2O PIC  X(0079).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  HPFKEYO PIC  99.
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  40
* EL1278.cbl
  2063     05  PFKEY11O PIC  X(0014).
  2064*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  41
* EL1278.cbl
  2066*                            COPY ELCCALC.
  2067******************************************************************
  2068*                                                                *
  2069*                           ELCCALC.                            *
  2070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2071*                            VMOD=2.025                          *
  2072*                                                                *
  2073*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2074*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2075*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2076*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2077*                                                                *
  2078*  PASSED TO ELRTRM                                              *
  2079*  -----------------                                             *
  2080*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2081*  ORIGINAL TERM                                                 *
  2082*  BEGINNING DATE                                                *
  2083*  ENDING DATE                                                   *
  2084*  COMPANY I.D.                                                  *
  2085*  ACCOUNT MASTER USER FIELD                                     *
  2086*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2087*  FREE LOOK DAYS                                                *
  2088*                                                                *
  2089*  RETURNED FROM ELRTRM                                          *
  2090*  ---------------------                                         *
  2091*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2092*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2093*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2094*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2095*----------------------------------------------------------------*
  2096*  PASSED TO ELRAMT                                              *
  2097*  ----------------                                              *
  2098*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2099*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2100*  ORIGINAL AMOUNT                                               *
  2101*  ALTERNATE BENEFIT (BALLON)                                    *
  2102*  A.P.R. - NET PAY ONLY                                         *
  2103*  METHOD
  2104*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2105*  COMPANY I.D.                                                  *
  2106*  BENEFIT TYPE                                                  *
  2107*                                                                *
  2108*  RETURNED FROM ELRAMT                                          *
  2109*  --------------------                                          *
  2110*  REMAINING AMOUNT 1 - CURRENT                                  *
  2111*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2112*  REMAINING AMOUNT FACTOR
  2113*----------------------------------------------------------------*
  2114*  PASSED TO ELRESV                                              *
  2115*  -----------------                                             *
  2116*  CERTIFICATE EFFECTIVE DATE                                    *
  2117*  VALUATION DATE                                                *
  2118*  PAID THRU DATE                                                *
  2119*  BENEFIT                                                       *
  2120*  INCURRED DATE                                                 *
  2121*  REPORTED DATE                                                 *
  2122*  ISSUE AGE                                                     *
  2123*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  42
* EL1278.cbl
  2124*  CDT PERCENT                                                   *
  2125*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2126* *CLAIM TYPE (LIFE, A/H)                                        *
  2127* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2128* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2129*                                                                *
  2130*  RETURNED FROM ELRESV                                          *
  2131*  --------------------                                          *
  2132*  CDT TABLE USED                                                *
  2133*  CDT FACTOR USED                                               *
  2134*  PAY TO CURRENT RESERVE                                        *
  2135*  I.B.N.R. - A/H ONLY                                           *
  2136*  FUTURE (ACCRUED) AH ONLY                                      *
  2137*----------------------------------------------------------------*
  2138*  PASSED TO ELRATE                                              *
  2139*  ----------------                                              *
  2140*  CERT ISSUE DATE                                               *
  2141*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2142*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2143*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2144*  STATE CODE (CLIENT DEFINED)                                   *
  2145*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2146*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2147*  DEVIATION CODE                                                *
  2148*  ISSUE AGE                                                     *
  2149*  ORIGINAL BENEFIT AMOUNT                                       *
  2150*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2151*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2152*  BENEFIT KIND (LIFE OR A/H)                                    *
  2153*  A.P.R.                                                        *
  2154*  METHOD
  2155*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2156*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2157*  COMPANY I.D. (3 CHARACTER)                                    *
  2158*  BENEFIT CODE                                                  *
  2159*  BENEFIT OVERRIDE CODE                                         *
  2160*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2161*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2162*  JOINT INDICATOR (CSL ONLY)                                    *
  2163*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2164*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2165*                                                                *
  2166*  RETURNED FROM ELRATE                                          *
  2167*  --------------------                                          *
  2168*  CALCULATED PREMIUM                                            *
  2169*  PREMIUM RATE                                                  *
  2170*  MORTALITY CODE                                                *
  2171*  MAX ATTAINED AGE                                              *
  2172*  MAX AGE                                                       *
  2173*  MAX TERM                                                      *
  2174*  MAX MONTHLY BENEFIT                                           *
  2175*  MAX TOTAL BENIFIT                                             *
  2176*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2177*----------------------------------------------------------------*
  2178*  PASSED TO ELRFND                                              *
  2179*  ----------------                                              *
  2180*  CERT ISSUE DATE                                               *
  2181*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  43
* EL1278.cbl
  2182*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2183*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2184*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2185*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2186*  STATE CODE (CLIENT DEFINED)                                   *
  2187*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2188*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2189*  DEVIATION CODE                                                *
  2190*  ISSUE AGE                                                     *
  2191*  ORIGINAL BENEFIT AMOUNT                                       *
  2192*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2193*  PROCESS TYPE (CANCEL)                                         *
  2194*  BENEFIT KIND (LIFE OR A/H)                                    *
  2195*  A.P.R.                                                        *
  2196*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2197*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2198*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2199*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2200*  COMPANY I.D. (3 CHARACTER)                                    *
  2201*  BENEFIT CODE                                                  *
  2202*  BENEFIT OVERRIDE CODE                                         *
  2203*                                                                *
  2204*  RETURNED FROM ELRFND                                          *
  2205*  --------------------                                          *
  2206*  CALCULATED REFUND                                             *
  2207*----------------------------------------------------------------*
  2208*  PASSED TO ELEARN                                              *
  2209*  ----------------                                              *
  2210*  CERT ISSUE DATE                                               *
  2211*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2212*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2213*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2214*  STATE CODE (CLIENT DEFINED)                                   *
  2215*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2216*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2217*  DEVIATION CODE                                                *
  2218*  ISSUE AGE                                                     *
  2219*  ORIGINAL BENEFIT AMOUNT                                       *
  2220*  BENEFIT KIND (LIFE OR A/H)                                    *
  2221*  A.P.R.                                                        *
  2222*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2223*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2224*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2225*  COMPANY I.D. (3 CHARACTER)                                    *
  2226*  BENEFIT CODE                                                  *
  2227*  BENEFIT OVERRIDE CODE                                         *
  2228*                                                                *
  2229*  RETURNED FROM ELEARN                                          *
  2230*  --------------------                                          *
  2231*  INDICATED  EARNINGS                                           *
  2232*----------------------------------------------------------------*
  2233*                 LENGTH = 450                                   *
  2234*                                                                *
  2235******************************************************************
  2236******************************************************************
  2237*                   C H A N G E   L O G
  2238*
  2239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  44
* EL1278.cbl
  2240*-----------------------------------------------------------------
  2241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2242* EFFECTIVE    NUMBER
  2243*-----------------------------------------------------------------
  2244* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2245* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2246* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2247* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2248* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2249* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2250* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2251* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2252* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2253* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2254* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2255******************************************************************
  2256
  2257 01  CALCULATION-PASS-AREA.
  2258     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2259                                     COMP.
  2260
  2261     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2262       88  NO-CP-ERROR                             VALUE ZERO.
  2263       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2264                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2265       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2266       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2267       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2268       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2269       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2270       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2271       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2272       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2273       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2274       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2275       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2276       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2277       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2278       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2279       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2280       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2281       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2282
  2283     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2284       88  NO-CP-ERROR-2                           VALUE ZERO.
  2285***********************  INPUT AREAS ****************************
  2286
  2287     12  CP-CALCULATION-AREA.
  2288         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2289         16  CP-CERT-EFF-DT        PIC XX.
  2290         16  CP-VALUATION-DT       PIC XX.
  2291         16  CP-PAID-THRU-DT       PIC XX.
  2292         16  CP-BENEFIT-TYPE       PIC X.
  2293           88  CP-AH                               VALUE 'A' 'D'
  2294                                                   'I' 'U'.
  2295           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2296           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2297         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  45
* EL1278.cbl
  2298         16  CP-REPORTED-DT        PIC XX.
  2299         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2300         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2301         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2302                                     COMP-3.
  2303         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2304                                     COMP-3.
  2305         16  CP-CDT-METHOD         PIC X.
  2306           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2307           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2308           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2309         16  CP-CLAIM-TYPE         PIC X.
  2310           88  CP-AH-CLAIM                         VALUE 'A'.
  2311           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2312         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2313                                     COMP-3.
  2314         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2315                                     COMP-3.
  2316         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2317                                     COMP-3.
  2318         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2319                                     COMP-3.
  2320         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2321                                     COMP-3.
  2322         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2323                                     COMP-3.
  2324         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2325                                     COMP-3.
  2326         16  CP-REM-TERM-METHOD    PIC X.
  2327           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2328           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2329           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2330           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2331           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2332           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2333           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2334         16  CP-EARNING-METHOD     PIC X.
  2335           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2336           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2337           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2338           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2339           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2340           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2341           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2342           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2343           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2344           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2345           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2346           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2347           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2348           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2349         16  CP-PROCESS-TYPE       PIC X.
  2350           88  CP-CLAIM                            VALUE '1'.
  2351           88  CP-CANCEL                           VALUE '2'.
  2352           88  CP-ISSUE                            VALUE '3'.
  2353         16  CP-SPECIAL-CALC-CD    PIC X.
  2354           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2355           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  46
* EL1278.cbl
  2356           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2357           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2358           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2359           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2360           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2361           88  CP-FARM-PLAN                    VALUE 'F'.
  2362           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2363           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2364           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2365           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2366           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2367           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2368           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2369           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2370           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2371           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2372                                                     'W' 'X'.
  2373           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2374           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2375           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2376           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2377           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2378           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2379           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2380           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2381           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2382           88  CP-CSL-METH-1                   VALUE '5'.
  2383           88  CP-CSL-METH-2                   VALUE '6'.
  2384           88  CP-CSL-METH-3                   VALUE '7'.
  2385           88  CP-CSL-METH-4                   VALUE '8'.
  2386
  2387         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2388                                     COMP-3.
  2389         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2390         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2391         16  CP-STATE              PIC XX          VALUE SPACE.
  2392         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2393         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2394           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2395               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2396         16  CP-R78-OPTION         PIC X.
  2397           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2398           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2399
  2400         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2401         16  CP-IBNR-RESERVE-SW    PIC X.
  2402         16  CP-CLAIM-STATUS       PIC X.
  2403         16  CP-RATE-FILE          PIC X.
  2404         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2405                                     COMP-3.
  2406
  2407         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2408         16  CP-AH-OVERRIDE-CODE   PIC X.
  2409
  2410         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2411                                     COMP-3.
  2412         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2413                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  47
* EL1278.cbl
  2414         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2415                                     COMP-3.
  2416         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2417                                     COMP-3.
  2418         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2419                                     COMP-3.
  2420         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2421                                  PIC S9(7)V99 COMP-3.
  2422
  2423         16  CP-PAID-FROM-DATE     PIC X(02).
  2424         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2425         16  CP-EXT-DAYS-CALC      PIC X.
  2426           88  CP-EXT-NO-CHG                   VALUE ' '.
  2427           88  CP-EXT-CHG-LF                   VALUE '1'.
  2428           88  CP-EXT-CHG-AH                   VALUE '2'.
  2429           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2430         16  CP-DOMICILE-STATE     PIC XX.
  2431         16  CP-CARRIER            PIC X.
  2432         16  CP-REIN-FLAG          PIC X.
  2433         16  CP-REM-TRM-CALC-OPTION PIC X.
  2434           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2435                      '2' '3' '4' '5'.
  2436           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2437           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2438           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2439           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2440           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2441           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2442           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2443           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2444         16  CP-SIG-SWITCH         PIC X.
  2445         16  CP-RATING-METHOD      PIC X.
  2446           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2447           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2448           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2449           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2450           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2451           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2452           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2453           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2454           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2455         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2456                                     COMP-3.
  2457         16  CP-BEN-CATEGORY       PIC X.
  2458         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2459         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2460                                   PIC S99V9(5) COMP-3.
  2461         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2462         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2463                                   PIC S99V9(5) COMP-3.
  2464         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2465         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2466         16  CP-EXPIRE-DT          PIC XX.
  2467         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2468         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2469         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2470         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2471         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  48
* EL1278.cbl
  2472             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2473             88  CP-CALC-CLP              VALUE 'C'.
  2474         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2475         16  CP-CANCEL-REASON      PIC X.
  2476         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2477         16  CP-PMT-MODE           PIC X.
  2478         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2479         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2480         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2481         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2482         16  FILLER                PIC X.
  2483
  2484***************    OUTPUT FROM ELRESV   ************************
  2485
  2486         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2487
  2488         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2489                                     COMP-3.
  2490         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2491                                     COMP-3.
  2492         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2493                                     COMP-3.
  2494         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2495                                     COMP-3.
  2496         16  FILLER                PIC X(09).
  2497***************    OUTPUT FROM ELRTRM   *************************
  2498
  2499         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2500                                     COMP-3.
  2501         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2502                                     COMP-3.
  2503         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2504                                     COMP-3.
  2505         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2506                                     COMP-3.
  2507         16  FILLER                PIC X(12).
  2508
  2509***************    OUTPUT FROM ELRAMT   *************************
  2510
  2511         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2512                                     COMP-3.
  2513         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2514                                     COMP-3.
  2515         16  FILLER                PIC X(12).
  2516
  2517***************    OUTPUT FROM ELRATE   *************************
  2518
  2519         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2520                                     COMP-3.
  2521         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2522                                     COMP-3.
  2523         16  CP-MORTALITY-CODE     PIC X(4).
  2524         16  CP-RATE-EDIT-FLAG     PIC X.
  2525             88  CP-RATES-NEED-APR                  VALUE '1'.
  2526         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2527                                     COMP-3.
  2528         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2529         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  49
* EL1278.cbl
  2530         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2531                                   PIC S9(7)V99 COMP-3.
  2532         16  FILLER                PIC X(07).
  2533
  2534***************    OUTPUT FROM ELRFND   *************************
  2535
  2536         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-REFUND-TYPE-USED   PIC X.
  2539           88  CP-R-AS-R78                         VALUE '1'.
  2540           88  CP-R-AS-PRORATA                     VALUE '2'.
  2541           88  CP-R-AS-CALIF                       VALUE '3'.
  2542           88  CP-R-AS-TEXAS                       VALUE '4'.
  2543           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2544           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2545           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2546           88  CP-R-AS-MEAN                        VALUE '8'.
  2547           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2548           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2549           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2550           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2551           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2552           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2553         16  FILLER                PIC X(12).
  2554
  2555***************    OUTPUT FROM ELEARN   *************************
  2556
  2557         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-EARNING-TYPE-USED  PIC X.
  2570           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2571           88  CP-E-AS-R78                         VALUE '1'.
  2572           88  CP-E-AS-PRORATA                     VALUE '2'.
  2573           88  CP-E-AS-TEXAS                       VALUE '4'.
  2574           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2575           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2576           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2577           88  CP-E-AS-MEAN                        VALUE '8'.
  2578           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2579         16  FILLER                PIC X(12).
  2580
  2581***************    OUTPUT FROM ELPMNT   *************************
  2582
  2583         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2584                                     COMP-3.
  2585         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2586                                     COMP-3.
  2587         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  50
* EL1278.cbl
  2588
  2589***************   MISC WORK AREAS    *****************************
  2590         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2591                                     COMP-3.
  2592         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2593                                     COMP-3.
  2594         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2595                                     COMP-3.
  2596         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2597                                     COMP-3.
  2598         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2599                                     COMP-3.
  2600         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2601                                     COMP-3.
  2602         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2603             88  OPEN-RATE-FILE                   VALUE 'O'.
  2604             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2605             88  IO-ERROR                         VALUE 'E'.
  2606
  2607         16  CP-FIRST-PAY-DATE     PIC XX.
  2608
  2609         16  CP-JOINT-INDICATOR    PIC X.
  2610
  2611         16  CP-RESERVE-REMAINING-TERM
  2612                                   PIC S9(4)V9    VALUE ZERO
  2613                                     COMP-3.
  2614
  2615         16  CP-INSURED-BIRTH-DT   PIC XX.
  2616
  2617         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2618                                     COMP-3.
  2619
  2620         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2621                                     COMP-3.
  2622
  2623         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2624                                     COMP-3.
  2625
  2626         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2627                                     COMP-3.
  2628
  2629         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2630                                     COMP-3.
  2631
  2632         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2633                                     COMP-3.
  2634
  2635         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2636                                     COMP-3.
  2637
  2638         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2639             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2640
  2641         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  51
* EL1278.cbl
  2646         16  cp-extra-periods      pic 9 value zeros.
  2647         16  cp-net-only-state     pic x value spaces.
  2648         16  FILLER                PIC X(13).
  2649******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  52
* EL1278.cbl
  2651*                            COPY ERCNOTE.
  2652******************************************************************
  2653*                                                                *
  2654*                                                                *
  2655*                            ERCNOTE                             *
  2656*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2657*                            VMOD=2.003                          *
  2658*                                                                *
  2659*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2660*                                                                *
  2661*        FILE TYPE= VSAM,KSDS                                    *
  2662*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2663*                                                                *
  2664*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2665*                                                                *
  2666*        LOG = YES                                               *
  2667*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2668*                                                                *
  2669******************************************************************
  2670*                   C H A N G E   L O G
  2671*
  2672* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2673*-----------------------------------------------------------------
  2674*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2675* EFFECTIVE    NUMBER
  2676*-----------------------------------------------------------------
  2677* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2678*                                FILE WILL CONTAIN BILLING NOTES O
  2679******************************************************************
  2680
  2681 01  CERTIFICATE-NOTE.
  2682     12  CN-RECORD-ID                PIC  XX.
  2683         88  VALID-CN-ID                  VALUE 'CN'.
  2684
  2685     12  CN-CONTROL-PRIMARY.
  2686         16  CN-COMPANY-CD           PIC X.
  2687         16  CN-CARRIER              PIC X.
  2688         16  CN-GROUPING.
  2689             20 CN-GROUPING-PREFIX   PIC XXX.
  2690             20 CN-GROUPING-PRIME    PIC XXX.
  2691         16  CN-STATE                PIC XX.
  2692         16  CN-ACCOUNT.
  2693             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2694             20 CN-ACCOUNT-PRIME     PIC X(6).
  2695         16  CN-CERT-EFF-DT          PIC XX.
  2696         16  CN-CERT-NO.
  2697             20  CN-CERT-PRIME       PIC X(10).
  2698             20  CN-CERT-SFX         PIC X.
  2699
  2700     12  CN-BILLING-START-LINE-NO    PIC 99.
  2701     12  CN-BILLING-END-LINE-NO      PIC 99.
  2702
  2703     12  CN-LINES.
  2704         16  CN-LINE OCCURS 10       PIC X(77).
  2705
  2706     12  CN-LAST-MAINT-DT            PIC XX.
  2707     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2708     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  53
* EL1278.cbl
  2709     12  FILLER                      PIC X(6).
  2710******************************************************************
  2711*                            COPY ERCCTBL.
  2712******************************************************************
  2713*                                                                *
  2714*                                                                *
  2715*                            ERCCTBL                             *
  2716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2717*                            VMOD=2.003
  2718*                                                                *
  2719*   ONLINE CREDIT SYSTEM                                         *
  2720*                                                                *
  2721*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2722*                                                                *
  2723*   FILE TYPE = VSAM,KSDS                                        *
  2724*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2725*                                                                *
  2726*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2727*       ALTERNATE PATH = NONE                                    *
  2728*                                                                *
  2729*   LOG = NO                                                     *
  2730*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731*                                                                *
  2732*                                                                *
  2733******************************************************************
  2734
  2735 01  COMM-TABLE-RECORD.
  2736     12  CT-RECORD-ID                      PIC XX.
  2737         88  VALID-CT-ID                      VALUE 'CT'.
  2738
  2739     12  CT-CONTROL-PRIMARY.
  2740         16  CT-COMPANY-CD                 PIC X.
  2741         16  CT-TABLE                      PIC XXX.
  2742         16  CT-CNTRL-2.
  2743             20  CT-BEN-TYPE               PIC X.
  2744             20  CT-BEN-CODE               PIC XX.
  2745
  2746     12  CT-MAINT-INFORMATION.
  2747         16  CT-LAST-MAINT-DT              PIC XX.
  2748         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2749         16  CT-LAST-MAINT-USER            PIC X(4).
  2750         16  FILLER                        PIC X(31).
  2751
  2752     12  CT-LIMITS.
  2753         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2754
  2755         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2756
  2757         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2758
  2759     12  CT-RATES.
  2760         16  CT-RTX          OCCURS 27 TIMES.
  2761             20  CT-RT                     PIC SV9(5)     COMP-3.
  2762             20  CT-RT-R   REDEFINES
  2763                 CT-RT                     PIC XXX.
  2764
  2765     12  FILLER                            PIC  X(42).
  2766
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  54
* EL1278.cbl
  2767******************************************************************
  2768
  2769****************************************************************
  2770*
  2771* Copyright (c) 2007 by Clerity Solutions, Inc.
  2772* All rights reserved.
  2773*
  2774****************************************************************
  2775 01  DFHEIV.
  2776   02  DFHEIV0               PIC X(35).
  2777   02  DFHEIV1               PIC X(08).
  2778   02  DFHEIV2               PIC X(08).
  2779   02  DFHEIV3               PIC X(08).
  2780   02  DFHEIV4               PIC X(06).
  2781   02  DFHEIV5               PIC X(04).
  2782   02  DFHEIV6               PIC X(04).
  2783   02  DFHEIV7               PIC X(02).
  2784   02  DFHEIV8               PIC X(02).
  2785   02  DFHEIV9               PIC X(01).
  2786   02  DFHEIV10              PIC S9(7) COMP-3.
  2787   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2788   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2789   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2790   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2791   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2792   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2793   02  DFHEIV17              PIC X(04).
  2794   02  DFHEIV18              PIC X(04).
  2795   02  DFHEIV19              PIC X(04).
  2796   02  DFHEIV20              USAGE IS POINTER.
  2797   02  DFHEIV21              USAGE IS POINTER.
  2798   02  DFHEIV22              USAGE IS POINTER.
  2799   02  DFHEIV23              USAGE IS POINTER.
  2800   02  DFHEIV24              USAGE IS POINTER.
  2801   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2802   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2803   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2804   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2805   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2806   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2807   02  FILLER                PIC X(02).
  2808   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2809   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2810   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2811   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2812   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2813 LINKAGE  SECTION.
  2814*****************************************************************
  2815*                                                               *
  2816* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2817* All rights reserved.                                          *
  2818*                                                               *
  2819*****************************************************************
  2820 01  dfheiblk.
  2821     02  eibtime          pic s9(7) comp-3.
  2822     02  eibdate          pic s9(7) comp-3.
  2823     02  eibtrnid         pic x(4).
  2824     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  55
* EL1278.cbl
  2825     02  eibtrmid         pic x(4).
  2826     02  dfheigdi         pic s9(4) comp.
  2827     02  eibcposn         pic s9(4) comp.
  2828     02  eibcalen         pic s9(4) comp.
  2829     02  eibaid           pic x(1).
  2830     02  eibfiller1       pic x(1).
  2831     02  eibfn            pic x(2).
  2832     02  eibfiller2       pic x(2).
  2833     02  eibrcode         pic x(6).
  2834     02  eibfiller3       pic x(2).
  2835     02  eibds            pic x(8).
  2836     02  eibreqid         pic x(8).
  2837     02  eibrsrce         pic x(8).
  2838     02  eibsync          pic x(1).
  2839     02  eibfree          pic x(1).
  2840     02  eibrecv          pic x(1).
  2841     02  eibsend          pic x(1).
  2842     02  eibatt           pic x(1).
  2843     02  eibeoc           pic x(1).
  2844     02  eibfmh           pic x(1).
  2845     02  eibcompl         pic x(1).
  2846     02  eibsig           pic x(1).
  2847     02  eibconf          pic x(1).
  2848     02  eiberr           pic x(1).
  2849     02  eibrldbk         pic x(1).
  2850     02  eiberrcd         pic x(4).
  2851     02  eibsynrb         pic x(1).
  2852     02  eibnodat         pic x(1).
  2853     02  eibfiller5       pic x(2).
  2854     02  eibresp          pic 9(09) comp.
  2855     02  eibresp2         pic 9(09) comp.
  2856     02  dfheigdj         pic s9(4) comp.
  2857     02  dfheigdk         pic s9(4) comp.
  2858
  2859 01  DFHCOMMAREA                 PIC  X(1024).
  2860
  2861*01 PARMLIST .
  2862*    12  FILLER                  PIC S9(08)      COMP.
  2863*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2864*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2865*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2866*                            COPY ELCCNTL.
  2867******************************************************************
  2868*                                                                *
  2869*                                                                *
  2870*                            ELCCNTL.                            *
  2871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2872*                            VMOD=2.059                          *
  2873*                                                                *
  2874*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2875*                                                                *
  2876*   FILE TYPE = VSAM,KSDS                                        *
  2877*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2878*                                                                *
  2879*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2880*       ALTERNATE INDEX = NONE                                   *
  2881*                                                                *
  2882*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  56
* EL1278.cbl
  2883*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2884******************************************************************
  2885*                   C H A N G E   L O G
  2886*
  2887* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2888*-----------------------------------------------------------------
  2889*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2890* EFFECTIVE    NUMBER
  2891*-----------------------------------------------------------------
  2892* 082503                   PEMA  ADD BENEFIT GROUP
  2893* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2894* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2895* 092705    2005050300006  PEMA  ADD SPP LEASES
  2896* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2897* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2898* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2899* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2900* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2901* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2902* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2903* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2904* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2905* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2906******************************************************************
  2907*
  2908 01  CONTROL-FILE.
  2909     12  CF-RECORD-ID                       PIC XX.
  2910         88  VALID-CF-ID                        VALUE 'CF'.
  2911
  2912     12  CF-CONTROL-PRIMARY.
  2913         16  CF-COMPANY-ID                  PIC XXX.
  2914         16  CF-RECORD-TYPE                 PIC X.
  2915             88  CF-COMPANY-MASTER              VALUE '1'.
  2916             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2917             88  CF-STATE-MASTER                VALUE '3'.
  2918             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2919             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2920             88  CF-CARRIER-MASTER              VALUE '6'.
  2921             88  CF-MORTALITY-MASTER            VALUE '7'.
  2922             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2923             88  CF-TERMINAL-MASTER             VALUE '9'.
  2924             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2925             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2926             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2927             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2928             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2929             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2930             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2931             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2932             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2933         16  CF-ACCESS-CD-GENL              PIC X(4).
  2934         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2935             20  CF-PROCESSOR               PIC X(4).
  2936         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2937             20  CF-STATE-CODE              PIC XX.
  2938             20  FILLER                     PIC XX.
  2939         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2940             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  57
* EL1278.cbl
  2941             20  CF-HI-BEN-IN-REC           PIC XX.
  2942         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2943             20  FILLER                     PIC XXX.
  2944             20  CF-CARRIER-CNTL            PIC X.
  2945         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2946             20  FILLER                     PIC XX.
  2947             20  CF-HI-TYPE-IN-REC          PIC 99.
  2948         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2949             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2950                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2951             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2952             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2953         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2954             20  FILLER                     PIC X.
  2955             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2956         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2957             20  FILLER                     PIC XX.
  2958             20  CF-MORTGAGE-PLAN           PIC XX.
  2959         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2960
  2961     12  CF-LAST-MAINT-DT                   PIC XX.
  2962     12  CF-LAST-MAINT-BY                   PIC X(4).
  2963     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2964
  2965     12  CF-RECORD-BODY                     PIC X(728).
  2966
  2967
  2968****************************************************************
  2969*             COMPANY MASTER RECORD                            *
  2970****************************************************************
  2971
  2972     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2973         16  CF-COMPANY-ADDRESS.
  2974             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2975             20  CF-CL-IN-CARE-OF           PIC X(30).
  2976             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2977             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2978             20  CF-CL-CITY-STATE           PIC X(30).
  2979             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2980             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2981         16  CF-COMPANY-CD                  PIC X.
  2982         16  CF-COMPANY-PASSWORD            PIC X(8).
  2983         16  CF-SECURITY-OPTION             PIC X.
  2984             88  ALL-SECURITY                   VALUE '1'.
  2985             88  COMPANY-VERIFY                 VALUE '2'.
  2986             88  PROCESSOR-VERIFY               VALUE '3'.
  2987             88  NO-SECURITY                    VALUE '4'.
  2988             88  ALL-BUT-TERM                   VALUE '5'.
  2989         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2990             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2991         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2992             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2993         16  CF-INFORCE-LOCATION            PIC X.
  2994             88  CERTS-ARE-ONLINE               VALUE '1'.
  2995             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2996             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2997         16  CF-LOWER-CASE-LETTERS          PIC X.
  2998         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  58
* EL1278.cbl
  2999             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3000             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3001             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3002             88  CF-ACCNT-CNTL                  VALUE '3'.
  3003             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3004
  3005         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3006         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3007
  3008         16  CF-LGX-CREDIT-USER             PIC X.
  3009             88  CO-IS-NOT-USER                 VALUE 'N'.
  3010             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3011
  3012         16 CF-CREDIT-CALC-CODES.
  3013             20  CF-CR-REM-TERM-CALC PIC X.
  3014               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3015               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3016               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3017               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3018               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3019               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3020               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3021             20  CF-CR-R78-METHOD           PIC X.
  3022               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3023               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3024
  3025         16  CF-CLAIM-CONTROL-COUNTS.
  3026             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3027                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3028
  3029             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3030                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3031
  3032             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3033                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3034
  3035             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3036                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3037
  3038         16  CF-CURRENT-MONTH-END           PIC XX.
  3039
  3040         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3041             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3042             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3043             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3044             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3045                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3046                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3047             20  CF-CO-PREM-REJECT-SW       PIC X.
  3048                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3049                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3050             20  CF-CO-REF-REJECT-SW        PIC X.
  3051                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3052                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3053
  3054         16  CF-CO-REPORTING-DT             PIC XX.
  3055         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3056         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  59
* EL1278.cbl
  3057           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3058           88  CF-CO-MONTH-END                  VALUE '1'.
  3059
  3060         16  CF-LGX-CLAIM-USER              PIC X.
  3061             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3062             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3063
  3064         16  CF-CREDIT-EDIT-CONTROLS.
  3065             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3066             20  CF-MIN-AGE                 PIC 99.
  3067             20  CF-DEFAULT-AGE             PIC 99.
  3068             20  CF-MIN-TERM                PIC S999      COMP-3.
  3069             20  CF-MAX-TERM                PIC S999      COMP-3.
  3070             20  CF-DEFAULT-SEX             PIC X.
  3071             20  CF-JOINT-AGE-INPUT         PIC X.
  3072                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3073             20  CF-BIRTH-DATE-INPUT        PIC X.
  3074                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3075             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3076                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3077                 88  CF-ZERO-CARRIER            VALUE '1'.
  3078                 88  CF-ZERO-GROUPING           VALUE '2'.
  3079                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3080             20  CF-EDIT-SW                 PIC X.
  3081                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3082             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3083             20  CF-CR-PR-METHOD            PIC X.
  3084               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3085               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3086             20  FILLER                     PIC X.
  3087
  3088         16  CF-CREDIT-MISC-CONTROLS.
  3089             20  CF-REIN-TABLE-SW           PIC X.
  3090                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3091             20  CF-COMP-TABLE-SW           PIC X.
  3092                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3093             20  CF-EXPERIENCE-RETENTION-AGE
  3094                                            PIC S9        COMP-3.
  3095             20  CF-CONVERSION-DT           PIC XX.
  3096             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3097             20  CF-RUN-FREQUENCY-SW        PIC X.
  3098                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3099                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3100
  3101             20  CF-CR-CHECK-NO-CONTROL.
  3102                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3103                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3104                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3105                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3106                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3107                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3108
  3109                 24  CF-CR-CHECK-COUNT       REDEFINES
  3110                     CF-CR-CHECK-COUNTER      PIC X(4).
  3111
  3112                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3113                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3114
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  60
* EL1278.cbl
  3115                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3116                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3117                 24  CF-MAIL-PROCESSING       PIC X.
  3118                     88  MAIL-PROCESSING          VALUE 'Y'.
  3119
  3120         16  CF-MISC-SYSTEM-CONTROL.
  3121             20  CF-SYSTEM-C                 PIC X.
  3122                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3123             20  CF-SYSTEM-D                 PIC X.
  3124                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3125             20  CF-SOC-SEC-NO-SW            PIC X.
  3126                 88  SOC-SEC-NO-USED             VALUE '1'.
  3127             20  CF-MEMBER-NO-SW             PIC X.
  3128                 88  MEMBER-NO-USED              VALUE '1'.
  3129             20  CF-TAX-ID-NUMBER            PIC X(11).
  3130             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3131             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3132                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3133                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3134                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3135                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3136             20  CF-SYSTEM-E                 PIC X.
  3137                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3138
  3139         16  CF-LGX-LIFE-USER               PIC X.
  3140             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3141             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3142
  3143         16  CF-CR-MONTH-END-DT             PIC XX.
  3144
  3145         16  CF-FILE-MAINT-DATES.
  3146             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3147                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3148             20  CF-LAST-BATCH       REDEFINES
  3149                 CF-LAST-BATCH-NO               PIC X(4).
  3150             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3151             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3152             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3153             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3154             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3155             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3156             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3157             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3158             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3159             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3160
  3161         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3162         16  FILLER                         PIC X.
  3163
  3164         16  CF-ALT-MORT-CODE               PIC X(4).
  3165         16  CF-MEMBER-CAPTION              PIC X(10).
  3166
  3167         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3168             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3169             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3170             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3171             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3172             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  61
* EL1278.cbl
  3173
  3174         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3175
  3176         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3177         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3178         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3179         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3180
  3181         16  CF-AH-OVERRIDE-L1              PIC X.
  3182         16  CF-AH-OVERRIDE-L2              PIC XX.
  3183         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3184         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3185
  3186         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3187         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3188
  3189         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3190         16  CF-AR-LAST-EL860-DT            PIC XX.
  3191         16  CF-MP-MONTH-END-DT             PIC XX.
  3192
  3193         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3194         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3195             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3196
  3197         16  CF-AR-MONTH-END-DT             PIC XX.
  3198
  3199         16  CF-CRDTCRD-USER                PIC X.
  3200             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3201             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3202
  3203         16  CF-CC-MONTH-END-DT             PIC XX.
  3204
  3205         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3206
  3207         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3208             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3209             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3210             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3211         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3212         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3213         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3214         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3215             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3216             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3217         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3218         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3219         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3220             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3221         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3222
  3223         16  CF-CL-ZIP-CODE.
  3224             20  CF-CL-ZIP-PRIME.
  3225                 24  CF-CL-ZIP-1ST          PIC X.
  3226                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3227                 24  FILLER                 PIC X(4).
  3228             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3229         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3230             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  62
* EL1278.cbl
  3231             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3232             20  FILLER                     PIC XXX.
  3233
  3234         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3235         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3236         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3237         16  CF-CO-OPTION-START-DATE        PIC XX.
  3238         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3239           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3240                                                      '3' '4'.
  3241           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3242           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3243           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3244           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3245           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3246           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3247
  3248         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3249
  3250         16  CF-PAYMENT-APPROVAL-LEVELS.
  3251             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3252             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3253             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3254             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3255             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3256             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3257
  3258         16  CF-END-USER-REPORTING-USER     PIC X.
  3259             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3260             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3261
  3262         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3263             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3264             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3265
  3266         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3267
  3268         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3269         16  FILLER                         PIC X.
  3270
  3271         16  CF-CREDIT-ARCHIVE-CNTL.
  3272             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3273             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3274             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3275
  3276         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3277
  3278         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3279             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3280             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3281
  3282         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3283             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3284             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3285
  3286         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3287
  3288         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  63
* EL1278.cbl
  3289             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3290             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3291             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3292         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3293         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3294         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3295         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3296         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3297         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3298         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3299         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3300         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3301                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3302         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3303                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3304
  3305         16  CF-CO-OVER-SHORT.
  3306             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3307             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3308
  3309*         16  FILLER                         PIC X(102).
  3310         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3311             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3312             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3313
  3314         16  CF-AH-APPROVAL-DAYS.
  3315             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3316             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3317             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3318             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3319
  3320         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3321
  3322         16  CF-APPROV-LEV-5.
  3323             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3324             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3325             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3326
  3327         16  FILLER                         PIC X(68).
  3328****************************************************************
  3329*             PROCESSOR/USER RECORD                            *
  3330****************************************************************
  3331
  3332     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3333         16  CF-PROCESSOR-NAME              PIC X(30).
  3334         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3335         16  CF-PROCESSOR-TITLE             PIC X(26).
  3336         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3337                 88  MESSAGE-YES                VALUE 'Y'.
  3338                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3339
  3340*****************************************************
  3341****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3342****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3343****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3344****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3345*****************************************************
  3346
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  64
* EL1278.cbl
  3347         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3348             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3349             20  CF-APPLICATION-FORCE       PIC X.
  3350             20  CF-INDIVIDUAL-APP.
  3351                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3352                     28  CF-BROWSE-APP      PIC X.
  3353                     28  CF-UPDATE-APP      PIC X.
  3354
  3355         16  CF-CURRENT-TERM-ON             PIC X(4).
  3356         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3357             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3358             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3359             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3360             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3361             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3362             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3363             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3364         16  CF-PROCESSOR-CARRIER           PIC X.
  3365             88  NO-CARRIER-SECURITY            VALUE ' '.
  3366         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3367             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3368         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3369             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3370         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3371             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3372
  3373         16  CF-PROC-SYS-ACCESS-SW.
  3374             20  CF-PROC-CREDIT-CLAIMS-SW.
  3375                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3376                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3377                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3378                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3379             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3380                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3381                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3382             20  CF-PROC-LIFE-GNRLDGR-SW.
  3383                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3384                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3385                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3386                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3387             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3388                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3389                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3390         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3391             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3392             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3393         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3394
  3395         16  CF-APPROVAL-LEVEL                  PIC X.
  3396             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3397             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3398             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3399             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3400             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3401
  3402         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3403
  3404         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  65
* EL1278.cbl
  3405             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3406             88  CF-LANG-IS-FR                      VALUE 'F'.
  3407
  3408         16  CF-CSR-IND                         PIC X.
  3409         16  FILLER                             PIC X(239).
  3410
  3411****************************************************************
  3412*             PROCESSOR/REMINDERS RECORD                       *
  3413****************************************************************
  3414
  3415     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3416         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3417             20  CF-START-REMIND-DT         PIC XX.
  3418             20  CF-END-REMIND-DT           PIC XX.
  3419             20  CF-REMINDER-TEXT           PIC X(50).
  3420         16  FILLER                         PIC X(296).
  3421
  3422
  3423****************************************************************
  3424*             STATE MASTER RECORD                              *
  3425****************************************************************
  3426
  3427     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3428         16  CF-STATE-ABBREVIATION          PIC XX.
  3429         16  CF-STATE-NAME                  PIC X(25).
  3430         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3431         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3432             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3433             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3434             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3435             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3436                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3437                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3438             20  CF-ST-PREM-REJECT-SW       PIC X.
  3439                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3440                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3441             20  CF-ST-REF-REJECT-SW        PIC X.
  3442                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3443                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3444         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3445         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3446         16  CF-ST-REFUND-RULES.
  3447             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3448             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3449             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3450         16  CF-ST-FST-PMT-EXTENSION.
  3451             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3452             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3453                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3454                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3455                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3456                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3457         16  CF-ST-STATE-CALL.
  3458             20  CF-ST-CALL-UNEARNED        PIC X.
  3459             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3460             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3461         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3462             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  66
* EL1278.cbl
  3463             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3464         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3465         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3466         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3467         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3468         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3469         16  FILLER                         PIC X.
  3470         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3471             20  CF-ST-BENEFIT-CD           PIC XX.
  3472             20  CF-ST-BENEFIT-KIND         PIC X.
  3473                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3474                 88  CF-ST-AH-KIND              VALUE 'A'.
  3475             20  CF-ST-REM-TERM-CALC        PIC X.
  3476                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3477                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3478                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3479                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3480                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3481                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3482                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3483                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3484
  3485             20  CF-ST-REFUND-CALC          PIC X.
  3486                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3487                 88  ST-REFD-BY-R78             VALUE '1'.
  3488                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3489                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3490                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3491                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3492                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3493                 88  ST-REFD-UTAH               VALUE '7'.
  3494                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3495                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3496                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3497
  3498             20  CF-ST-EARNING-CALC         PIC X.
  3499                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3500                 88  ST-EARN-BY-R78             VALUE '1'.
  3501                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3502                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3503                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3504                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3505                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3506                 88  ST-EARN-MEAN               VALUE '8'.
  3507                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3508
  3509             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3510                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3511                 88  ST-OVRD-BY-R78             VALUE '1'.
  3512                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3513                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3514                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3515                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3516                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3517                 88  ST-OVRD-MEAN               VALUE '8'.
  3518                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3519             20  cf-st-extra-periods        pic 9.
  3520*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  67
* EL1278.cbl
  3521
  3522         16  CF-ST-COMMISSION-CAPS.
  3523             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3524             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3525             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3526             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3527         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3528                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3529
  3530         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3531
  3532         16  CF-ST-STATUTORY-INTEREST.
  3533             20  CF-ST-STAT-DATE-FROM       PIC X.
  3534                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3535                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3536             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3537             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3538             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3539             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3540             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3541
  3542         16  CF-ST-OVER-SHORT.
  3543             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3544             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3545
  3546         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3547
  3548         16  CF-ST-RT-CALC                  PIC X.
  3549
  3550         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3551         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3552         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3553         16  CF-ST-RF-LR-CALC               PIC X.
  3554         16  CF-ST-RF-LL-CALC               PIC X.
  3555         16  CF-ST-RF-LN-CALC               PIC X.
  3556         16  CF-ST-RF-AH-CALC               PIC X.
  3557         16  CF-ST-RF-CP-CALC               PIC X.
  3558*        16  FILLER                         PIC X(206).
  3559*CIDMOD         16  FILLER                         PIC X(192).
  3560         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3561             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3562         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3563         16  CF-ST-VFY-2ND-BENE             PIC X.
  3564         16  CF-ST-CAUSAL-STATE             PIC X.
  3565         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3566         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3567         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3568             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3569         16  CF-ST-NET-ONLY-STATE           PIC X.
  3570             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3571         16  FILLER                         PIC X(181).
  3572
  3573****************************************************************
  3574*             BENEFIT MASTER RECORD                            *
  3575****************************************************************
  3576
  3577     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3578         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  68
* EL1278.cbl
  3579             20  CF-BENEFIT-CODE            PIC XX.
  3580             20  CF-BENEFIT-NUMERIC  REDEFINES
  3581                 CF-BENEFIT-CODE            PIC XX.
  3582             20  CF-BENEFIT-ALPHA           PIC XXX.
  3583             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3584             20  CF-BENEFIT-COMMENT         PIC X(10).
  3585
  3586             20  CF-LF-COVERAGE-TYPE        PIC X.
  3587                 88  CF-REDUCING                VALUE 'R'.
  3588                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3589
  3590             20  CF-SPECIAL-CALC-CD         PIC X.
  3591                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3592                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3593                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3594                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3595                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3596                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3597                 88  CF-FARM-PLAN               VALUE 'F'.
  3598                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3599                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3600                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3601                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3602                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3603                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3604                 88  CF-PRUDENTIAL              VALUE 'P'.
  3605                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3606                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3607                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3608                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3609                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3610                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3611
  3612             20  CF-JOINT-INDICATOR         PIC X.
  3613                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3614
  3615*            20  FILLER                     PIC X(12).
  3616             20  cf-maximum-benefits        pic s999 comp-3.
  3617             20  FILLER                     PIC X(09).
  3618             20  CF-BENEFIT-CATEGORY        PIC X.
  3619             20  CF-LOAN-TYPE               PIC X(8).
  3620
  3621             20  CF-CO-REM-TERM-CALC        PIC X.
  3622                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3623                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3624                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3625                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3626                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3627
  3628             20  CF-CO-EARNINGS-CALC        PIC X.
  3629                 88  CO-EARN-BY-R78             VALUE '1'.
  3630                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3631                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3632                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3633                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3634                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3635                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3636                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  69
* EL1278.cbl
  3637
  3638             20  CF-CO-REFUND-CALC          PIC X.
  3639                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3640                 88  CO-REFD-BY-R78             VALUE '1'.
  3641                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3642                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3643                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3644                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3645                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3646                 88  CO-REFD-MEAN               VALUE '8'.
  3647                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3648                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3649                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3650
  3651             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3652                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3653                 88  CO-OVRD-BY-R78             VALUE '1'.
  3654                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3655                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3656                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3657                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3658                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3659                 88  CO-OVRD-MEAN               VALUE '8'.
  3660                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3661
  3662             20  CF-CO-BEN-I-G-CD           PIC X.
  3663                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3664                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3665                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3666
  3667         16  FILLER                         PIC X(304).
  3668
  3669
  3670****************************************************************
  3671*             CARRIER MASTER RECORD                            *
  3672****************************************************************
  3673
  3674     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3675         16  CF-ADDRESS-DATA.
  3676             20  CF-MAIL-TO-NAME            PIC X(30).
  3677             20  CF-IN-CARE-OF              PIC X(30).
  3678             20  CF-ADDRESS-LINE-1          PIC X(30).
  3679             20  CF-ADDRESS-LINE-2          PIC X(30).
  3680             20  CF-CITY-STATE              PIC X(30).
  3681             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3682             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3683
  3684         16  CF-CLAIM-NO-CONTROL.
  3685             20  CF-CLAIM-NO-METHOD         PIC X.
  3686                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3687                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3688                 88  CLAIM-NO-SEQ               VALUE '3'.
  3689                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3690             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3691                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3692                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3693                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3694
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  70
* EL1278.cbl
  3695         16  CF-CHECK-NO-CONTROL.
  3696             20  CF-CHECK-NO-METHOD         PIC X.
  3697                 88  CHECK-NO-MANUAL            VALUE '1'.
  3698                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3699                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3700                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3701             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3702                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3703
  3704         16  CF-DOMICILE-STATE              PIC XX.
  3705
  3706         16  CF-EXPENSE-CONTROLS.
  3707             20  CF-EXPENSE-METHOD          PIC X.
  3708                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3709                 88  DOLLARS-PER-PMT            VALUE '2'.
  3710                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3711                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3712             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3713             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3714
  3715         16  CF-CORRESPONDENCE-CONTROL.
  3716             20  CF-LETTER-RESEND-OPT       PIC X.
  3717                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3718                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3719             20  FILLER                     PIC X(4).
  3720
  3721         16  CF-RESERVE-CONTROLS.
  3722             20  CF-MANUAL-SW               PIC X.
  3723                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3724             20  CF-FUTURE-SW               PIC X.
  3725                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3726             20  CF-PTC-SW                  PIC X.
  3727                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3728             20  CF-IBNR-SW                 PIC X.
  3729                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3730             20  CF-PTC-LF-SW               PIC X.
  3731                 88  CF-LF-PTC-USED             VALUE '1'.
  3732             20  CF-CDT-ACCESS-METHOD       PIC X.
  3733                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3734                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3735                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3736             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3737
  3738         16  CF-CLAIM-CALC-METHOD           PIC X.
  3739             88  360-PLUS-MONTHS                VALUE '1'.
  3740             88  365-PLUS-MONTHS                VALUE '2'.
  3741             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3742             88  360-DAILY                      VALUE '4'.
  3743             88  365-DAILY                      VALUE '5'.
  3744
  3745         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3746         16  FILLER                         PIC X(11).
  3747
  3748         16  CF-LIMIT-AMOUNTS.
  3749             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3750             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3751             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3752             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  71
* EL1278.cbl
  3753             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3754             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3755             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3756             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3757             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3758             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3759
  3760         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3761         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3762         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3763
  3764         16  CF-ZIP-CODE.
  3765             20  CF-ZIP-PRIME.
  3766                 24  CF-ZIP-1ST             PIC X.
  3767                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3768                 24  FILLER                 PIC X(4).
  3769             20  CF-ZIP-PLUS4               PIC X(4).
  3770         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3771             20  CF-CAN-POSTAL-1            PIC XXX.
  3772             20  CF-CAN-POSTAL-2            PIC XXX.
  3773             20  FILLER                     PIC XXX.
  3774
  3775         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3776         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3777         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3778
  3779         16  CF-RATING-SWITCH               PIC X.
  3780             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3781             88  CF-NO-RATING                   VALUE 'N'.
  3782
  3783         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3784
  3785         16  CF-CARRIER-OVER-SHORT.
  3786             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3787             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3788
  3789         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3790         16  CF-SECPAY-SWITCH               PIC X.
  3791             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3792             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3793         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3794         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3795         16  FILLER                         PIC X(444).
  3796*        16  FILLER                         PIC X(452).
  3797
  3798
  3799****************************************************************
  3800*             MORTALITY MASTER RECORD                          *
  3801****************************************************************
  3802
  3803     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3804         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3805                                INDEXED BY CF-MORT-NDX.
  3806             20  CF-MORT-TABLE              PIC X(5).
  3807             20  CF-MORT-TABLE-TYPE         PIC X.
  3808                 88  CF-MORT-JOINT              VALUE 'J'.
  3809                 88  CF-MORT-SINGLE             VALUE 'S'.
  3810                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  72
* EL1278.cbl
  3811                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3812                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3813             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3814             20  CF-MORT-AGE-METHOD         PIC XX.
  3815                 88  CF-AGE-LAST                VALUE 'AL'.
  3816                 88  CF-AGE-NEAR                VALUE 'AN'.
  3817             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3818             20  CF-MORT-ADJUSTMENT-DIRECTION
  3819                                            PIC X.
  3820                 88  CF-MINUS                   VALUE '-'.
  3821                 88  CF-PLUS                    VALUE '+'.
  3822             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3823             20  CF-MORT-JOINT-CODE         PIC X.
  3824                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3825             20  CF-MORT-PC-Q               PIC X.
  3826                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3827             20  CF-MORT-TABLE-CODE         PIC X(4).
  3828             20  CF-MORT-COMMENTS           PIC X(15).
  3829             20  FILLER                     PIC X(14).
  3830
  3831         16  FILLER                         PIC X(251).
  3832
  3833
  3834****************************************************************
  3835*             BUSSINESS TYPE MASTER RECORD                     *
  3836****************************************************************
  3837
  3838     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3839* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3840* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3841* AND RECORD 05 IS TYPES 81-99
  3842         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3843             20  CF-BUSINESS-TITLE          PIC  X(19).
  3844             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3845                                            PIC S9V9(4) COMP-3.
  3846             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3847             20  FILLER                     PIC  X.
  3848         16  FILLER                         PIC  X(248).
  3849
  3850
  3851****************************************************************
  3852*             TERMINAL MASTER RECORD                           *
  3853****************************************************************
  3854
  3855     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3856
  3857         16  CF-COMPANY-TERMINALS.
  3858             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3859                                  PIC X(4).
  3860         16  FILLER               PIC X(248).
  3861
  3862
  3863****************************************************************
  3864*             LIFE EDIT MASTER RECORD                          *
  3865****************************************************************
  3866
  3867     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3868         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  73
* EL1278.cbl
  3869             20  CF-LIFE-CODE-IN            PIC XX.
  3870             20  CF-LIFE-CODE-OUT           PIC XX.
  3871         16  FILLER                         PIC X(248).
  3872
  3873
  3874****************************************************************
  3875*             AH EDIT MASTER RECORD                            *
  3876****************************************************************
  3877
  3878     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3879         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3880             20  CF-AH-CODE-IN              PIC XXX.
  3881             20  CF-AH-CODE-OUT             PIC XX.
  3882         16  FILLER                         PIC X(248).
  3883
  3884
  3885****************************************************************
  3886*             CREDIBILITY TABLES                               *
  3887****************************************************************
  3888
  3889     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3890         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3891                             INDEXED BY CF-CRDB-NDX.
  3892             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3893             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3894             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3895         16  FILLER                         PIC  X(332).
  3896
  3897
  3898****************************************************************
  3899*             REPORT CUSTOMIZATION RECORD                      *
  3900****************************************************************
  3901
  3902     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3903         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3904             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3905             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3906             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3907**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3908****       A T-TRANSFER.                                   ****
  3909             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3910
  3911         16  FILLER                         PIC XX.
  3912
  3913         16  CF-CARRIER-CNTL-OPT.
  3914             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3915                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3916                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3917             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3918                                            PIC X.
  3919         16  CF-GROUP-CNTL-OPT.
  3920             20  CF-GROUP-OPT-SEQ           PIC 9.
  3921                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3922                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3923             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3924                                            PIC X(6).
  3925         16  CF-STATE-CNTL-OPT.
  3926             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  74
* EL1278.cbl
  3927                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3928                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3929             20  CF-STATE-SELECT OCCURS 3 TIMES
  3930                                            PIC XX.
  3931         16  CF-ACCOUNT-CNTL-OPT.
  3932             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3933                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3934                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3935             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3936                                            PIC X(10).
  3937         16  CF-BUS-TYP-CNTL-OPT.
  3938             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3939                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3940                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3941             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3942                                            PIC XX.
  3943         16  CF-LF-TYP-CNTL-OPT.
  3944             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3945                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3946                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3947             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3948                                            PIC XX.
  3949         16  CF-AH-TYP-CNTL-OPT.
  3950             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3951                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3952                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3953             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3954                                            PIC XX.
  3955         16  CF-REPTCD1-CNTL-OPT.
  3956             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3957                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3958                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3959             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3960                                            PIC X(10).
  3961         16  CF-REPTCD2-CNTL-OPT.
  3962             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3963                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3964                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3965             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3966                                            PIC X(10).
  3967         16  CF-USER1-CNTL-OPT.
  3968             20  CF-USER1-OPT-SEQ           PIC 9.
  3969                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3970                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3971             20  CF-USER1-SELECT OCCURS 3 TIMES
  3972                                            PIC X(10).
  3973         16  CF-USER2-CNTL-OPT.
  3974             20  CF-USER2-OPT-SEQ           PIC 9.
  3975                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3976                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3977             20  CF-USER2-SELECT OCCURS 3 TIMES
  3978                                            PIC X(10).
  3979         16  CF-USER3-CNTL-OPT.
  3980             20  CF-USER3-OPT-SEQ           PIC 9.
  3981                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3982                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3983             20  CF-USER3-SELECT OCCURS 3 TIMES
  3984                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  75
* EL1278.cbl
  3985         16  CF-USER4-CNTL-OPT.
  3986             20  CF-USER4-OPT-SEQ           PIC 9.
  3987                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3988                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3989             20  CF-USER4-SELECT OCCURS 3 TIMES
  3990                                            PIC X(10).
  3991         16  CF-USER5-CNTL-OPT.
  3992             20  CF-USER5-OPT-SEQ           PIC 9.
  3993                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3994                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3995             20  CF-USER5-SELECT OCCURS 3 TIMES
  3996                                            PIC X(10).
  3997         16  CF-REINS-CNTL-OPT.
  3998             20  CF-REINS-OPT-SEQ           PIC 9.
  3999                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4000                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4001             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4002                 24  CF-REINS-PRIME         PIC XXX.
  4003                 24  CF-REINS-SUB           PIC XXX.
  4004
  4005         16  CF-AGENT-CNTL-OPT.
  4006             20  CF-AGENT-OPT-SEQ           PIC 9.
  4007                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4008                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4009             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4010                                            PIC X(10).
  4011
  4012         16  FILLER                         PIC X(43).
  4013
  4014         16  CF-LOSS-RATIO-SELECT.
  4015             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4016             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4017         16  CF-ENTRY-DATE-SELECT.
  4018             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4019             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4020         16  CF-EFFECTIVE-DATE-SELECT.
  4021             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4022             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4023
  4024         16  CF-EXCEPTION-LIST-IND          PIC X.
  4025             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4026
  4027         16  FILLER                         PIC X(318).
  4028
  4029****************************************************************
  4030*                  EXCEPTION REPORTING RECORD                  *
  4031****************************************************************
  4032
  4033     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4034         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4035             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4036
  4037         16  CF-COMBINED-LIFE-AH-OPT.
  4038             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4039             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4040             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4041             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4042
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  76
* EL1278.cbl
  4043         16  CF-LIFE-OPT.
  4044             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4045             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4046             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4047             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4048             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4049             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4050             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4051             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4052             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4053             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4054
  4055         16  CF-AH-OPT.
  4056             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4057             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4058             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4059             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4060             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4061             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4062             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4063             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4064             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4065             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4066
  4067         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4068             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4069             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4070             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4071
  4072         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4073
  4074         16  FILLER                         PIC X(673).
  4075
  4076
  4077****************************************************************
  4078*             MORTGAGE SYSTEM PLAN RECORD                      *
  4079****************************************************************
  4080
  4081     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4082         16  CF-PLAN-TYPE                   PIC X.
  4083             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4084             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4085             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4086         16  CF-PLAN-ABBREV                 PIC XXX.
  4087         16  CF-PLAN-DESCRIPT               PIC X(10).
  4088         16  CF-PLAN-NOTES                  PIC X(20).
  4089         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4090         16  CF-PLAN-UNDERWRITING.
  4091             20  CF-PLAN-TERM-DATA.
  4092                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4093                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4094             20  CF-PLAN-AGE-DATA.
  4095                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4096                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4097                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4098             20  CF-PLAN-BENEFIT-DATA.
  4099                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4100                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  77
* EL1278.cbl
  4101                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4102                                            PIC S9(7)V99  COMP-3.
  4103         16  CF-PLAN-POLICY-FORMS.
  4104             20  CF-POLICY-FORM             PIC X(12).
  4105             20  CF-MASTER-APPLICATION      PIC X(12).
  4106             20  CF-MASTER-POLICY           PIC X(12).
  4107         16  CF-PLAN-RATING.
  4108             20  CF-RATE-CODE               PIC X(5).
  4109             20  CF-SEX-RATING              PIC X.
  4110                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4111                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4112             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4113             20  CF-SUB-STD-TYPE            PIC X.
  4114                 88  CF-PCT-OF-PREM            VALUE '1'.
  4115                 88  CF-PCT-OF-BENE            VALUE '2'.
  4116         16  CF-PLAN-PREM-TOLERANCES.
  4117             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4118             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4119         16  CF-PLAN-PYMT-TOLERANCES.
  4120             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4121             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4122         16  CF-PLAN-MISC-DATA.
  4123             20  FILLER                     PIC X.
  4124             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4125             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4126         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4127         16  CF-PLAN-IND-GRP                PIC X.
  4128             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4129                                                     '1'.
  4130             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4131                                                     '2'.
  4132         16  CF-MIB-SEARCH-SW               PIC X.
  4133             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4134             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4135             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4136             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4137         16  CF-ALPHA-SEARCH-SW             PIC X.
  4138             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4139             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4140             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4141             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4142             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4143             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4144             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4145             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4146             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4147             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4148                                                     'A' 'B' 'C'
  4149                                                     'X' 'Y' 'Z'.
  4150         16  CF-EFF-DT-RULE-SW              PIC X.
  4151             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4152             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4153             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4154             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4155             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4156         16  FILLER                         PIC X(4).
  4157         16  CF-HEALTH-QUESTIONS            PIC X.
  4158             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  78
* EL1278.cbl
  4159         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4160         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4161         16  CF-PLAN-SNGL-JNT               PIC X.
  4162             88  CF-COMBINED-PLAN              VALUE 'C'.
  4163             88  CF-JNT-PLAN                   VALUE 'J'.
  4164             88  CF-SNGL-PLAN                  VALUE 'S'.
  4165         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4166         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4167         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4168         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4169         16  CF-RERATE-CNTL                 PIC  X.
  4170             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4171             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4172             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4173             88  CF-AUTO-RECALC                 VALUE '4'.
  4174         16  CF-BENEFIT-TYPE                PIC  X.
  4175             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4176             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4177         16  CF-POLICY-FEE                  PIC S999V99
  4178                                                    COMP-3.
  4179         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4180         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4181         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4182         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4183         16  FILLER                         PIC  X(32).
  4184         16  CF-TERMINATION-FORM            PIC  X(04).
  4185         16  FILLER                         PIC  X(08).
  4186         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4187                                                       COMP-3.
  4188         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4189         16  CF-ISSUE-LETTER                PIC  X(4).
  4190         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4191         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4192             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4193             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4194         16  CF-MP-REFUND-CALC              PIC X.
  4195             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4196             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4197             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4198             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4199             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4200             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4201             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4202             88  CF-MP-REFD-MEAN                VALUE '8'.
  4203         16  CF-ALT-RATE-CODE               PIC  X(5).
  4204
  4205
  4206         16  FILLER                         PIC X(498).
  4207****************************************************************
  4208*             MORTGAGE COMPANY MASTER RECORD                   *
  4209****************************************************************
  4210
  4211     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4212         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4213         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4214             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4215             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4216             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  79
* EL1278.cbl
  4217             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4218             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4219
  4220         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4221         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4222         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4223         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4224         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4225
  4226         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4227             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4228         16  CF-MP-RECON-USE-IND            PIC X(1).
  4229             88  CF-MP-USE-RECON             VALUE 'Y'.
  4230         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4231             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4232         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4233             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4234             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4235         16  FILLER                         PIC X(1).
  4236         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4237             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4238         16  CF-MORTG-MIB-VERSION           PIC X.
  4239             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4240             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4241             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4242         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4243             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4244                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4245             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4246                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4247             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4248                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4249             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4250                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4251             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4252                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4253             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4254                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4255         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4256         16  FILLER                         PIC X(7).
  4257         16  CF-MORTG-DESTINATION-SYMBOL.
  4258             20  CF-MORTG-MIB-COMM          PIC X(5).
  4259             20  CF-MORTG-MIB-TERM          PIC X(5).
  4260         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4261             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4262         16  FILLER                         PIC X(03).
  4263         16  CF-MP-CHECK-NO-CONTROL.
  4264             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4265                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4266                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4267                                                ' ' LOW-VALUES.
  4268                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4269                                               VALUE '3'.
  4270         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4271         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4272         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4273             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4274                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  80
* EL1278.cbl
  4275             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4276                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4277             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4278                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4279             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4280                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4281             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4282                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4283             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4284                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4285         16  CF-MORTG-BILLING-AREA.
  4286             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4287                                            PIC X.
  4288         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4289         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4290         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4291         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4292             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4293             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4294         16  FILLER                         PIC X.
  4295         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4296             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4297             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4298         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4299         16  FILLER                         PIC X(8).
  4300         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4301         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4302         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4303         16  CF-ACH-COMPANY-ID.
  4304             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4305                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4306                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4307                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4308             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4309         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4310             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4311         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4312             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4313             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4314         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4315         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4316         16  FILLER                         PIC X(536).
  4317
  4318****************************************************************
  4319*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4320****************************************************************
  4321
  4322     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4323         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4324             20  CF-FEMALE-HEIGHT.
  4325                 24  CF-FEMALE-FT           PIC 99.
  4326                 24  CF-FEMALE-IN           PIC 99.
  4327             20  CF-FEMALE-MIN-WT           PIC 999.
  4328             20  CF-FEMALE-MAX-WT           PIC 999.
  4329         16  FILLER                         PIC X(428).
  4330
  4331     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4332         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  81
* EL1278.cbl
  4333             20  CF-MALE-HEIGHT.
  4334                 24  CF-MALE-FT             PIC 99.
  4335                 24  CF-MALE-IN             PIC 99.
  4336             20  CF-MALE-MIN-WT             PIC 999.
  4337             20  CF-MALE-MAX-WT             PIC 999.
  4338         16  FILLER                         PIC X(428).
  4339******************************************************************
  4340*             AUTOMATIC ACTIVITY RECORD                          *
  4341******************************************************************
  4342     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4343         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4344             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4345             20  CF-SYS-LETTER-ID           PIC X(04).
  4346             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4347             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4348             20  CF-SYS-RESET-SW            PIC X(01).
  4349             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4350             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4351
  4352         16  FILLER                         PIC X(50).
  4353
  4354         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4355             20  CF-USER-ACTIVE-SW          PIC X(01).
  4356             20  CF-USER-LETTER-ID          PIC X(04).
  4357             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4358             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4359             20  CF-USER-RESET-SW           PIC X(01).
  4360             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4361             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4362             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4363
  4364         16  FILLER                         PIC X(246).
  4365*                            COPY ERCACCT.
  4366******************************************************************
  4367*                                                                *
  4368*                                                                *
  4369*                            ERCACCT                             *
  4370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4371*                            VMOD=2.031                          *
  4372*                                                                *
  4373*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4374*                                                                *
  4375*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4376*   VSAM ACCOUNT MASTER FILES.                                   *
  4377*                                                                *
  4378*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4379*                                                                *
  4380*   FILE TYPE = VSAM,KSDS                                        *
  4381*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4382*                                                                *
  4383*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4384*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4385*                                                                *
  4386*   LOG = NO                                                     *
  4387*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4388*                                                                *
  4389*                                                                *
  4390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  82
* EL1278.cbl
  4391*                   C H A N G E   L O G
  4392*
  4393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4394*-----------------------------------------------------------------
  4395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4396* EFFECTIVE    NUMBER
  4397*-----------------------------------------------------------------
  4398* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4399* 092705    2005050300006  PEMA  ADD SPP LEASES
  4400* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4401* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4402* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4403* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4404* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4405* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4406******************************************************************
  4407
  4408 01  ACCOUNT-MASTER.
  4409     12  AM-RECORD-ID                      PIC XX.
  4410         88  VALID-AM-ID                      VALUE 'AM'.
  4411
  4412     12  AM-CONTROL-PRIMARY.
  4413         16  AM-COMPANY-CD                 PIC X.
  4414         16  AM-MSTR-CNTRL.
  4415             20  AM-CONTROL-A.
  4416                 24  AM-CARRIER            PIC X.
  4417                 24  AM-GROUPING.
  4418                     28 AM-GROUPING-PREFIX PIC XXX.
  4419                     28 AM-GROUPING-PRIME  PIC XXX.
  4420                 24  AM-STATE              PIC XX.
  4421                 24  AM-ACCOUNT.
  4422                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4423                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4424             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4425                                           PIC X(19).
  4426             20  AM-CNTRL-B.
  4427                 24  AM-EXPIRATION-DT      PIC XX.
  4428                 24  FILLER                PIC X(4).
  4429             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4430                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4431
  4432     12  AM-CONTROL-BY-VAR-GRP.
  4433         16  AM-COMPANY-CD-A1              PIC X.
  4434         16  AM-VG-CARRIER                 PIC X.
  4435         16  AM-VG-GROUPING                PIC X(6).
  4436         16  AM-VG-STATE                   PIC XX.
  4437         16  AM-VG-ACCOUNT                 PIC X(10).
  4438         16  AM-VG-DATE.
  4439             20  AM-VG-EXPIRATION-DT       PIC XX.
  4440             20  FILLER                    PIC X(4).
  4441         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4442                                           PIC 9(11)      COMP-3.
  4443     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4444         16  FILLER                        PIC X(10).
  4445         16  AM-VG-KEY3.
  4446             20  AM-VG3-ACCOUNT            PIC X(10).
  4447             20  AM-VG3-EXP-DT             PIC XX.
  4448         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  83
* EL1278.cbl
  4449     12  AM-MAINT-INFORMATION.
  4450         16  AM-LAST-MAINT-DT              PIC XX.
  4451         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4452         16  AM-LAST-MAINT-USER            PIC X(4).
  4453         16  FILLER                        PIC XX.
  4454
  4455     12  AM-EFFECTIVE-DT                   PIC XX.
  4456     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4457
  4458     12  AM-PREV-DATES  COMP-3.
  4459         16  AM-PREV-EXP-DT                PIC 9(11).
  4460         16  AM-PREV-EFF-DT                PIC 9(11).
  4461
  4462     12  AM-REPORT-CODE-1                  PIC X(10).
  4463     12  AM-REPORT-CODE-2                  PIC X(10).
  4464
  4465     12  AM-CITY-CODE                      PIC X(4).
  4466     12  AM-COUNTY-PARISH                  PIC X(6).
  4467
  4468     12  AM-NAME                           PIC X(30).
  4469     12  AM-PERSON                         PIC X(30).
  4470     12  AM-ADDRS                          PIC X(30).
  4471     12  AM-CITY.
  4472         16  AM-ADDR-CITY                  PIC X(28).
  4473         16  AM-ADDR-STATE                 PIC XX.
  4474     12  AM-ZIP.
  4475         16  AM-ZIP-PRIME.
  4476             20  AM-ZIP-PRI-1ST            PIC X.
  4477                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4478             20  FILLER                    PIC X(4).
  4479         16  AM-ZIP-PLUS4                  PIC X(4).
  4480     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4481         16  AM-CAN-POSTAL-1               PIC XXX.
  4482         16  AM-CAN-POSTAL-2               PIC XXX.
  4483         16  FILLER                        PIC XXX.
  4484     12  AM-TEL-NO.
  4485         16  AM-AREA-CODE                  PIC 999.
  4486         16  AM-TEL-PRE                    PIC 999.
  4487         16  AM-TEL-NBR                    PIC 9(4).
  4488     12  AM-TEL-LOC                        PIC X.
  4489         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4490         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4491
  4492     12  AM-COMM-STRUCTURE.
  4493         16  AM-DEFN-1.
  4494             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4495                 24  AM-AGT.
  4496                     28  AM-AGT-PREFIX     PIC X(4).
  4497                     28  AM-AGT-PRIME      PIC X(6).
  4498                 24  AM-COM-TYP            PIC X.
  4499                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4500                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4501                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4502                 24  AM-RECALC-LV-INDIC    PIC X.
  4503                 24  AM-RETRO-LV-INDIC     PIC X.
  4504                 24  AM-GL-CODES           PIC X.
  4505                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4506                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  84
* EL1278.cbl
  4507         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4508             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4509                 24  FILLER                PIC X(11).
  4510                 24  AM-L-COMA             PIC XXX.
  4511                 24  AM-J-COMA             PIC XXX.
  4512                 24  AM-A-COMA             PIC XXX.
  4513                 24  FILLER                PIC X(6).
  4514
  4515     12  AM-COMM-CHANGE-STATUS             PIC X.
  4516         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4517
  4518     12  AM-CSR-CODE                       PIC X(4).
  4519
  4520     12  AM-BILLING-STATUS                 PIC X.
  4521         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4522         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4523     12  AM-AUTO-REFUND-SW                 PIC X.
  4524         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4525         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4526     12  AM-GPCD                           PIC 99.
  4527     12  AM-IG                             PIC X.
  4528         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4529         88  AM-HAS-GROUP                     VALUE '2'.
  4530     12  AM-STATUS                         PIC X.
  4531         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4532         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4533         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4534         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4535         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4536         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4537         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4538         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4539         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4540         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4541     12  AM-REMIT-TO                       PIC 99.
  4542     12  AM-ID-NO                          PIC X(11).
  4543
  4544     12  AM-CAL-TABLE                      PIC XX.
  4545     12  AM-LF-DEVIATION                   PIC XXX.
  4546     12  AM-AH-DEVIATION                   PIC XXX.
  4547     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4548     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4549     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4550     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4551     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4552     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4553
  4554     12  AM-USER-FIELDS.
  4555         16  AM-FLD-1                      PIC XX.
  4556         16  AM-FLD-2                      PIC XX.
  4557         16  AM-FLD-3                      PIC XX.
  4558         16  AM-FLD-4                      PIC XX.
  4559         16  AM-FLD-5                      PIC XX.
  4560
  4561     12  AM-1ST-PROD-DATE.
  4562         16  AM-1ST-PROD-YR                PIC XX.
  4563         16  AM-1ST-PROD-MO                PIC XX.
  4564         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  85
* EL1278.cbl
  4565     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4566     12  AM-CERTS-PURGED-DATE.
  4567         16  AM-PUR-YR                     PIC XX.
  4568         16  AM-PUR-MO                     PIC XX.
  4569         16  AM-PUR-DA                     PIC XX.
  4570     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4571     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4572     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4573     12  AM-INACTIVE-DATE.
  4574         16  AM-INA-MO                     PIC 99.
  4575         16  AM-INA-DA                     PIC 99.
  4576         16  AM-INA-YR                     PIC 99.
  4577     12  AM-AR-HI-CERT-DATE                PIC XX.
  4578
  4579     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4580     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4581
  4582     12  AM-OB-PAYMENT-MODE                PIC X.
  4583         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4584         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4585         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4586         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4587
  4588     12  AM-AH-ONLY-INDICATOR              PIC X.
  4589         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4590         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4591
  4592     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4593
  4594     12  AM-OVER-SHORT.
  4595         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4596         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4597
  4598     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4599     12  AM-DCC-CLP-STATE                  PIC XX.
  4600
  4601     12  AM-RECALC-COMM                    PIC X.
  4602     12  AM-RECALC-REIN                    PIC X.
  4603
  4604     12  AM-REI-TABLE                      PIC XXX.
  4605     12  AM-REI-ET-LF                      PIC X.
  4606     12  AM-REI-ET-AH                      PIC X.
  4607     12  AM-REI-PE-LF                      PIC X.
  4608     12  AM-REI-PE-AH                      PIC X.
  4609     12  AM-REI-PRT-ST                     PIC X.
  4610     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4611     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4612     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4613     12  AM-REI-GROUP-A                    PIC X(6).
  4614     12  AM-REI-MORT                       PIC X(4).
  4615     12  AM-REI-PRT-OW                     PIC X.
  4616     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4617     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4618     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4619     12  AM-REI-GROUP-B                    PIC X(6).
  4620
  4621     12  AM-TRUST-TYPE                     PIC X(2).
  4622
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  86
* EL1278.cbl
  4623     12  AM-EMPLOYER-STMT-USED             PIC X.
  4624     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4625
  4626     12  AM-STD-AH-TYPE                    PIC XX.
  4627     12  AM-EARN-METHODS.
  4628         16  AM-EARN-METHOD-R              PIC X.
  4629             88 AM-REF-RL-R78                 VALUE 'R'.
  4630             88 AM-REF-RL-PR                  VALUE 'P'.
  4631             88 AM-REF-RL-MEAN                VALUE 'M'.
  4632             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4633         16  AM-EARN-METHOD-L              PIC X.
  4634             88 AM-REF-LL-R78                 VALUE 'R'.
  4635             88 AM-REF-LL-PR                  VALUE 'P'.
  4636             88 AM-REF-LL-MEAN                VALUE 'M'.
  4637             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4638         16  AM-EARN-METHOD-A              PIC X.
  4639             88 AM-REF-AH-R78                 VALUE 'R'.
  4640             88 AM-REF-AH-PR                  VALUE 'P'.
  4641             88 AM-REF-AH-MEAN                VALUE 'M'.
  4642             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4643             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4644             88 AM-REF-AH-NET                 VALUE 'N'.
  4645
  4646     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4647     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4648     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4649
  4650     12  AM-RET-Y-N                        PIC X.
  4651     12  AM-RET-P-E                        PIC X.
  4652     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4653     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4654     12  AM-RET-GRP                        PIC X(6).
  4655     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4656         16  AM-POOL-PRIME                 PIC XXX.
  4657         16  AM-POOL-SUB                   PIC XXX.
  4658     12  AM-RETRO-EARNINGS.
  4659         16  AM-RET-EARN-R                 PIC X.
  4660         16  AM-RET-EARN-L                 PIC X.
  4661         16  AM-RET-EARN-A                 PIC X.
  4662     12  AM-RET-ST-TAX-USE                 PIC X.
  4663         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4664         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4665     12  AM-RETRO-BEG-EARNINGS.
  4666         16  AM-RET-BEG-EARN-R             PIC X.
  4667         16  AM-RET-BEG-EARN-L             PIC X.
  4668         16  AM-RET-BEG-EARN-A             PIC X.
  4669     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4670     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4671
  4672     12  AM-USER-SELECT-OPTIONS.
  4673         16  AM-USER-SELECT-1              PIC X(10).
  4674         16  AM-USER-SELECT-2              PIC X(10).
  4675         16  AM-USER-SELECT-3              PIC X(10).
  4676         16  AM-USER-SELECT-4              PIC X(10).
  4677         16  AM-USER-SELECT-5              PIC X(10).
  4678
  4679     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4680
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  87
* EL1278.cbl
  4681     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4682
  4683     12  AM-RPT045A-SWITCH                 PIC X.
  4684         88  RPT045A-OFF                   VALUE 'N'.
  4685
  4686     12  AM-INSURANCE-LIMITS.
  4687         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4688         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4689
  4690     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4691         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4692
  4693     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4694         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4695         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4696
  4697     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4698
  4699     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4700     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4701     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4702     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4703     12  AM-DCC-UEF-STATE                  PIC XX.
  4704     12  FILLER                            PIC XXX.
  4705     12  AM-REPORT-CODE-3                  PIC X(10).
  4706*    12  FILLER                            PIC X(22).
  4707
  4708     12  AM-RESERVE-DATE.
  4709         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4710         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4711         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4712
  4713     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4714     12  AM-NOTIFICATION-TYPES.
  4715         16  AM-NOTIF-OF-LETTERS           PIC X.
  4716         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4717         16  AM-NOTIF-OF-REPORTS           PIC X.
  4718         16  AM-NOTIF-OF-STATUS            PIC X.
  4719
  4720     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4721         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4722         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4723         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4724         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4725
  4726     12  AM-BENEFIT-CONTROLS.
  4727         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4728             20  AM-BENEFIT-CODE           PIC XX.
  4729             20  AM-BENEFIT-TYPE           PIC X.
  4730             20  AM-BENEFIT-REVISION       PIC XXX.
  4731             20  AM-BENEFIT-REM-TERM       PIC X.
  4732             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4733             20  FILLER                    PIC XX.
  4734         16  FILLER                        PIC X(80).
  4735
  4736     12  AM-TRANSFER-DATA.
  4737         16  AM-TRANSFERRED-FROM.
  4738             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  88
* EL1278.cbl
  4739             20  AM-TRNFROM-GROUPING.
  4740                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4741                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4742             20  AM-TRNFROM-STATE          PIC XX.
  4743             20  AM-TRNFROM-ACCOUNT.
  4744                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4745                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4746             20  AM-TRNFROM-DTE            PIC XX.
  4747         16  AM-TRANSFERRED-TO.
  4748             20  AM-TRNTO-CARRIER          PIC X.
  4749             20  AM-TRNTO-GROUPING.
  4750                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4751                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4752             20  AM-TRNTO-STATE            PIC XX.
  4753             20  AM-TRNTO-ACCOUNT.
  4754                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4755                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4756             20  AM-TRNTO-DTE              PIC XX.
  4757         16  FILLER                        PIC X(10).
  4758
  4759     12  AM-SAVED-REMIT-TO                 PIC 99.
  4760
  4761     12  AM-COMM-STRUCTURE-SAVED.
  4762         16  AM-DEFN-1-SAVED.
  4763             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4764                 24  AM-AGT-SV             PIC X(10).
  4765                 24  AM-COM-TYP-SV         PIC X.
  4766                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4767                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4768                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4769                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4770                 24  FILLER                PIC X.
  4771                 24  AM-GL-CODES-SV        PIC X.
  4772                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4773                 24  FILLER                PIC X.
  4774         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4775             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4776                 24  FILLER                PIC X(11).
  4777                 24  AM-L-COMA-SV          PIC XXX.
  4778                 24  AM-J-COMA-SV          PIC XXX.
  4779                 24  AM-A-COMA-SV          PIC XXX.
  4780                 24  FILLER                PIC X(6).
  4781
  4782     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4783         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4784            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4785            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4786            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4787
  4788     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4789     12  FILLER                            PIC X(120).
  4790
  4791     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4792         16  AM-CONTROL-NAME               PIC X(30).
  4793         16  AM-EXECUTIVE-ONE.
  4794             20  AM-EXEC1-NAME             PIC X(15).
  4795             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4796                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  89
* EL1278.cbl
  4797             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4798                                                          COMP-3.
  4799         16  AM-EXECUTIVE-TWO.
  4800             20  AM-EXEC2-NAME             PIC X(15).
  4801             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4802                                                          COMP-3.
  4803             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4804                                                          COMP-3.
  4805
  4806     12  AM-RETRO-ADDITIONAL-DATA.
  4807         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4808         16  AM-RETRO-PREM-P-E             PIC X.
  4809         16  AM-RETRO-CLMS-P-I             PIC X.
  4810         16  AM-RETRO-RET-BRACKET-LF.
  4811             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4812                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4813                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4814             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4815                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4816                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4817             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4818                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4819                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4820         16  AM-RETRO-RET-BRACKET-AH.
  4821             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4822                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4823                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4824                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4825             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4826                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4827                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4828             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4829                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4830                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4831
  4832     12  AM-COMMENTS.
  4833         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4834
  4835     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4836         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4837         16  AM-FLI-BILLING-CODE           PIC X.
  4838         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4839         16  AM-FLI-UNITED-IDENT           PIC X.
  4840         16  AM-FLI-INTEREST-LOST-DATA.
  4841             20  AM-FLI-BANK-NO            PIC X(5).
  4842             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4843             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4844             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4845         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4846             20  AM-FLI-AGT                PIC X(9).
  4847             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4848             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4849         16  FILLER                        PIC X(102).
  4850
  4851     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4852         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4853             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4854             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  90
* EL1278.cbl
  4855             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4856             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4857             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4858         16  FILLER                          PIC X(10).
  4859******************************************************************
  4860*                            COPY ELCCERT.
  4861******************************************************************
  4862*                                                                *
  4863*                            ELCCERT.                            *
  4864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4865*                            VMOD=2.013                          *
  4866*                                                                *
  4867*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4868*                                                                *
  4869*   FILE TYPE = VSAM,KSDS                                        *
  4870*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4871*                                                                *
  4872*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4873*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4874*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4875*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4876*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4877*                                                                *
  4878*   LOG = YES                                                    *
  4879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4880******************************************************************
  4881*                   C H A N G E   L O G
  4882*
  4883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4884*-----------------------------------------------------------------
  4885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4886* EFFECTIVE    NUMBER
  4887*-----------------------------------------------------------------
  4888* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4889* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4890* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4891* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4892* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4893* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4894* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4895* 032612  CR2011110200001  PEMA  AHL CHANGES
  4896* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4897* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4898******************************************************************
  4899
  4900 01  CERTIFICATE-MASTER.
  4901     12  CM-RECORD-ID                      PIC XX.
  4902         88  VALID-CM-ID                      VALUE 'CM'.
  4903
  4904     12  CM-CONTROL-PRIMARY.
  4905         16  CM-COMPANY-CD                 PIC X.
  4906         16  CM-CARRIER                    PIC X.
  4907         16  CM-GROUPING.
  4908             20  CM-GROUPING-PREFIX        PIC X(3).
  4909             20  CM-GROUPING-PRIME         PIC X(3).
  4910         16  CM-STATE                      PIC XX.
  4911         16  CM-ACCOUNT.
  4912             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  91
* EL1278.cbl
  4913             20  CM-ACCOUNT-PRIME          PIC X(6).
  4914         16  CM-CERT-EFF-DT                PIC XX.
  4915         16  CM-CERT-NO.
  4916             20  CM-CERT-PRIME             PIC X(10).
  4917             20  CM-CERT-SFX               PIC X.
  4918
  4919     12  CM-CONTROL-BY-NAME.
  4920         16  CM-COMPANY-CD-A1              PIC X.
  4921         16  CM-INSURED-LAST-NAME          PIC X(15).
  4922         16  CM-INSURED-INITIALS.
  4923             20  CM-INSURED-INITIAL1       PIC X.
  4924             20  CM-INSURED-INITIAL2       PIC X.
  4925
  4926     12  CM-CONTROL-BY-SSN.
  4927         16  CM-COMPANY-CD-A2              PIC X.
  4928         16  CM-SOC-SEC-NO.
  4929             20  CM-SSN-STATE              PIC XX.
  4930             20  CM-SSN-ACCOUNT            PIC X(6).
  4931             20  CM-SSN-LN3.
  4932                 25  CM-INSURED-INITIALS-A2.
  4933                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4934                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4935                 25 CM-PART-LAST-NAME-A2         PIC X.
  4936
  4937     12  CM-CONTROL-BY-CERT-NO.
  4938         16  CM-COMPANY-CD-A4              PIC X.
  4939         16  CM-CERT-NO-A4                 PIC X(11).
  4940
  4941     12  CM-CONTROL-BY-MEMB.
  4942         16  CM-COMPANY-CD-A5              PIC X.
  4943         16  CM-MEMBER-NO.
  4944             20  CM-MEMB-STATE             PIC XX.
  4945             20  CM-MEMB-ACCOUNT           PIC X(6).
  4946             20  CM-MEMB-LN4.
  4947                 25  CM-INSURED-INITIALS-A5.
  4948                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4949                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4950                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4951
  4952     12  CM-INSURED-PROFILE-DATA.
  4953         16  CM-INSURED-FIRST-NAME.
  4954             20  CM-INSURED-1ST-INIT       PIC X.
  4955             20  FILLER                    PIC X(9).
  4956         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4957         16  CM-INSURED-SEX                PIC X.
  4958             88  CM-SEX-MALE                  VALUE 'M'.
  4959             88  CM-SEX-FEMAL                 VALUE 'F'.
  4960         16  CM-INSURED-JOINT-AGE          PIC 99.
  4961         16  CM-JOINT-INSURED-NAME.
  4962             20  CM-JT-LAST-NAME           PIC X(15).
  4963             20  CM-JT-FIRST-NAME.
  4964                 24  CM-JT-1ST-INIT        PIC X.
  4965                 24  FILLER                PIC X(9).
  4966             20  CM-JT-INITIAL             PIC X.
  4967
  4968     12  CM-LIFE-DATA.
  4969         16  CM-LF-BENEFIT-CD              PIC XX.
  4970         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  92
* EL1278.cbl
  4971         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4972         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4973         16  CM-LF-DEV-CODE                PIC XXX.
  4974         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4975         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4976         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4977         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4978         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4979         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4980         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4981         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4982         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4983         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4984         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4985         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4986         16  cm-temp-epiq                  pic xx.
  4987             88  EPIQ-CLASS                  value 'EQ'.
  4988*        16  FILLER                        PIC XX.
  4989
  4990     12  CM-AH-DATA.
  4991         16  CM-AH-BENEFIT-CD              PIC XX.
  4992         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4993         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4994         16  CM-AH-DEV-CODE                PIC XXX.
  4995         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4996         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4997         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4998         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4999         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5000         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5001         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5002         16  CM-AH-PAID-THRU-DT            PIC XX.
  5003             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5004         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5005         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5006         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5007         16  FILLER                        PIC X.
  5008
  5009     12  CM-LOAN-INFORMATION.
  5010         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5011         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5012                                           PIC S9(5)V99  COMP-3.
  5013         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5014         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5015         16  CM-PAY-FREQUENCY              PIC S99.
  5016         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5017         16  CM-RATE-CLASS                 PIC XX.
  5018         16  CM-BENEFICIARY                PIC X(25).
  5019         16  CM-POLICY-FORM-NO             PIC X(12).
  5020         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5021         16  CM-LAST-ADD-ON-DT             PIC XX.
  5022         16  CM-DEDUCTIBLE-AMOUNTS.
  5023             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5024             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5025         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5026             20  CM-RESIDENT-STATE         PIC XX.
  5027             20  CM-RATE-CODE              PIC X(4).
  5028             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  93
* EL1278.cbl
  5029         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5030             20  CM-LOAN-OFFICER           PIC X(5).
  5031             20  FILLER                    PIC XXX.
  5032         16  CM-CSR-CODE                   PIC XXX.
  5033         16  CM-UNDERWRITING-CODE          PIC X.
  5034             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5035         16  CM-POST-CARD-IND              PIC X.
  5036         16  CM-NH-INTERFACE-SW            PIC X.
  5037         16  CM-PREMIUM-TYPE               PIC X.
  5038             88  CM-SING-PRM                  VALUE '1'.
  5039             88  CM-O-B-COVERAGE              VALUE '2'.
  5040             88  CM-OPEN-END                  VALUE '3'.
  5041         16  CM-IND-GRP-TYPE               PIC X.
  5042             88  CM-INDIVIDUAL                VALUE 'I'.
  5043             88  CM-GROUP                     VALUE 'G'.
  5044         16  CM-SKIP-CODE                  PIC X.
  5045             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5046             88  SKIP-JULY                    VALUE '1'.
  5047             88  SKIP-AUGUST                  VALUE '2'.
  5048             88  SKIP-SEPTEMBER               VALUE '3'.
  5049             88  SKIP-JULY-AUG                VALUE '4'.
  5050             88  SKIP-AUG-SEPT                VALUE '5'.
  5051             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5052             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5053             88  SKIP-JUNE                    VALUE '8'.
  5054             88  SKIP-JUNE-JULY               VALUE '9'.
  5055             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5056             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5057         16  CM-PAYMENT-MODE               PIC X.
  5058             88  PAY-MONTHLY                  VALUE SPACE.
  5059             88  PAY-WEEKLY                   VALUE '1'.
  5060             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5061             88  PAY-BI-WEEKLY                VALUE '3'.
  5062             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5063         16  CM-LOAN-NUMBER                PIC X(8).
  5064         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5065         16  CM-OLD-LOF                    PIC XXX.
  5066*        16  CM-LOAN-OFFICER               PIC XXX.
  5067         16  CM-REIN-TABLE                 PIC XXX.
  5068         16  CM-SPECIAL-REIN-CODE          PIC X.
  5069         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5070         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5071         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5072
  5073     12  CM-STATUS-DATA.
  5074         16  CM-ENTRY-STATUS               PIC X.
  5075         16  CM-ENTRY-DT                   PIC XX.
  5076
  5077         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5078         16  CM-LF-CANCEL-DT               PIC XX.
  5079         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5080
  5081         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5082         16  CM-LF-DEATH-DT                PIC XX.
  5083         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5084
  5085         16  CM-LF-CURRENT-STATUS          PIC X.
  5086             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  94
* EL1278.cbl
  5087                                                'M' '4' '5' '9'.
  5088             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5089             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5090             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5091             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5092             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5093             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5094             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5095             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5096             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5097             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5098             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5099             88  CM-LF-DECLINED               VALUE 'D'.
  5100             88  CM-LF-VOIDED                 VALUE 'V'.
  5101
  5102         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5103         16  CM-AH-CANCEL-DT               PIC XX.
  5104         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5105
  5106         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5107         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5108         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5109
  5110         16  CM-AH-CURRENT-STATUS          PIC X.
  5111             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5112                                                'M' '4' '5' '9'.
  5113             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5114             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5115             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5116             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5117             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5118             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5119             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5120             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5121             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5122             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5123             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5124             88  CM-AH-DECLINED               VALUE 'D'.
  5125             88  CM-AH-VOIDED                 VALUE 'V'.
  5126
  5127         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5128             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5129             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5130             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5131         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5132
  5133         16  CM-ENTRY-BATCH                PIC X(6).
  5134         16  CM-LF-EXIT-BATCH              PIC X(6).
  5135         16  CM-AH-EXIT-BATCH              PIC X(6).
  5136         16  CM-LAST-MONTH-END             PIC XX.
  5137
  5138     12  CM-NOTE-SW                        PIC X.
  5139         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5140         88  CERT-NOTES-PRESENT               VALUE '1'.
  5141         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5142         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5143         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5144         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  95
* EL1278.cbl
  5145         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5146         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5147     12  CM-COMP-EXCP-SW                   PIC X.
  5148         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5149         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5150     12  CM-INSURED-ADDRESS-SW             PIC X.
  5151         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5152         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5153
  5154*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5155     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5156     12  FILLER                            PIC X.
  5157
  5158*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5159     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5160     12  FILLER                            PIC X.
  5161*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5162     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5163
  5164     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5165         88  CERT-ADDED-BATCH                 VALUE ' '.
  5166         88  CERT-ADDED-ONLINE                VALUE '1'.
  5167         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5168         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5169         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5170     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5171         88  CERT-AS-LOADED                   VALUE ' '.
  5172         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5173         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5174         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5175         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5176         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5177         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5178         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5179
  5180     12  CM-ACCOUNT-COMM-PCTS.
  5181         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5182         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5183
  5184     12  CM-USER-FIELD                     PIC X.
  5185     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5186     12  CM-CLP-STATE                      PIC XX.
  5187     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5188     12  CM-USER-RESERVED                  PIC XXX.
  5189     12  FILLER REDEFINES CM-USER-RESERVED.
  5190         16  CM-AH-CLASS-CD                PIC XX.
  5191         16  F                             PIC X.
  5192******************************************************************
  5193*                            COPY ERCMAIL.
  5194******************************************************************
  5195*                                                                *
  5196*                                                                *
  5197*                            ERCMAIL                             *
  5198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5199*                            VMOD=2.003                          *
  5200*                                                                *
  5201*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5202*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  96
* EL1278.cbl
  5203*   FILE TYPE = VSAM,KSDS                                        *
  5204*   RECORD SIZE = 374   RECFORM = FIX                            *
  5205*                                                                *
  5206*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5207*   ALTERNATE PATH    = NOT USED                                 *
  5208*                                                                *
  5209*   LOG = YES                                                    *
  5210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5211******************************************************************
  5212*                   C H A N G E   L O G
  5213*
  5214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5215*-----------------------------------------------------------------
  5216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5217* EFFECTIVE    NUMBER
  5218*-----------------------------------------------------------------
  5219* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5220* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5221* 111108                   PEMA  ADD CRED BENE ADDR2
  5222******************************************************************
  5223
  5224 01  MAILING-DATA.
  5225     12  MA-RECORD-ID                      PIC XX.
  5226         88  VALID-MA-ID                       VALUE 'MA'.
  5227
  5228     12  MA-CONTROL-PRIMARY.
  5229         16  MA-COMPANY-CD                 PIC X.
  5230         16  MA-CARRIER                    PIC X.
  5231         16  MA-GROUPING.
  5232             20  MA-GROUPING-PREFIX        PIC XXX.
  5233             20  MA-GROUPING-PRIME         PIC XXX.
  5234         16  MA-STATE                      PIC XX.
  5235         16  MA-ACCOUNT.
  5236             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5237             20  MA-ACCOUNT-PRIME          PIC X(6).
  5238         16  MA-CERT-EFF-DT                PIC XX.
  5239         16  MA-CERT-NO.
  5240             20  MA-CERT-PRIME             PIC X(10).
  5241             20  MA-CERT-SFX               PIC X.
  5242
  5243     12  FILLER                            PIC XX.
  5244
  5245     12  MA-ACCESS-CONTROL.
  5246         16  MA-SOURCE-SYSTEM              PIC XX.
  5247             88  MA-FROM-CREDIT                VALUE 'CR'.
  5248             88  MA-FROM-VSI                   VALUE 'VS'.
  5249             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5250             88  MA-FROM-OTHER                 VALUE 'OT'.
  5251         16  MA-RECORD-ADD-DT              PIC XX.
  5252         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5253         16  MA-LAST-MAINT-DT              PIC XX.
  5254         16  MA-LAST-MAINT-BY              PIC XXXX.
  5255         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5256
  5257     12  MA-PROFILE-INFO.
  5258         16  MA-QUALIFY-CODE-1             PIC XX.
  5259         16  MA-QUALIFY-CODE-2             PIC XX.
  5260         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  97
* EL1278.cbl
  5261         16  MA-QUALIFY-CODE-4             PIC XX.
  5262         16  MA-QUALIFY-CODE-5             PIC XX.
  5263
  5264         16  MA-INSURED-LAST-NAME          PIC X(15).
  5265         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5266         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5267         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5268         16  MA-INSURED-BIRTH-DT           PIC XX.
  5269         16  MA-INSURED-SEX                PIC X.
  5270             88  MA-SEX-MALE                   VALUE 'M'.
  5271             88  MA-SEX-FEMALE                 VALUE 'F'.
  5272         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5273
  5274         16  MA-ADDRESS-CORRECTED          PIC X.
  5275         16  MA-JOINT-BIRTH-DT             PIC XX.
  5276*        16  FILLER                        PIC X(12).
  5277
  5278         16  MA-ADDRESS-LINE-1             PIC X(30).
  5279         16  MA-ADDRESS-LINE-2             PIC X(30).
  5280         16  MA-CITY-STATE.
  5281             20  MA-CITY                   PIC X(28).
  5282             20  MA-ADDR-STATE             PIC XX.
  5283         16  MA-ZIP.
  5284             20  MA-ZIP-CODE.
  5285                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5286                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5287                 24  FILLER                PIC X(4).
  5288             20  MA-ZIP-PLUS4              PIC X(4).
  5289         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5290             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5291             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5292             20  FILLER                    PIC X(3).
  5293
  5294         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5295
  5296         16  FILLER                        PIC XXX.
  5297*        16  FILLER                        PIC X(10).
  5298
  5299     12  MA-CRED-BENE-INFO.
  5300         16  MA-CRED-BENE-NAME                 PIC X(25).
  5301         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5302         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5303         16  MA-CRED-BENE-CTYST.
  5304             20  MA-CRED-BENE-CITY             PIC X(28).
  5305             20  MA-CRED-BENE-STATE            PIC XX.
  5306         16  MA-CRED-BENE-ZIP.
  5307             20  MA-CB-ZIP-CODE.
  5308                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5309                     88  MA-CB-CANADIAN-POST-CODE
  5310                                           VALUE 'A' THRU 'Z'.
  5311                 24  FILLER                    PIC X(4).
  5312             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5313         16  MA-CB-CANADIAN-POSTAL-CODE
  5314                            REDEFINES MA-CRED-BENE-ZIP.
  5315             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5316             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5317             20  FILLER                        PIC X(3).
  5318     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  98
* EL1278.cbl
  5319         16  MA-MAIL-DATA OCCURS 7.
  5320             20  MA-MAIL-TYPE              PIC X.
  5321                 88  MA-12MO-MAILING           VALUE '1'.
  5322                 88  MA-EXP-MAILING            VALUE '2'.
  5323             20  MA-MAIL-STATUS            PIC X.
  5324                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5325                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5326                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5327             20  MA-MAIL-DATE              PIC XX.
  5328     12  FILLER                            PIC XX.
  5329     12  FILLER                            PIC XX.
  5330*    12  FILLER                            PIC X(30).
  5331******************************************************************
  5332*                            COPY ELCCRTO.
  5333******************************************************************
  5334*                                                                *
  5335*                            ELCCRTO.                            *
  5336*                                                                *
  5337*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5338*                                                                *
  5339*   FILE TYPE = VSAM,KSDS                                        *
  5340*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5341*                                                                *
  5342*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5343*                                                                *
  5344*   LOG = YES                                                    *
  5345*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5346******************************************************************
  5347*                   C H A N G E   L O G
  5348*
  5349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5350*-----------------------------------------------------------------
  5351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5352* EFFECTIVE    NUMBER
  5353*-----------------------------------------------------------------
  5354* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5355* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5356* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5357* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5358* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5359******************************************************************
  5360 01  ORIGINAL-CERTIFICATE.
  5361     12  OC-RECORD-ID                      PIC XX.
  5362         88  VALID-OC-ID                      VALUE 'OC'.
  5363     12  OC-CONTROL-PRIMARY.
  5364         16  OC-COMPANY-CD                 PIC X.
  5365         16  OC-CARRIER                    PIC X.
  5366         16  OC-GROUPING                   PIC X(6).
  5367         16  OC-STATE                      PIC XX.
  5368         16  OC-ACCOUNT                    PIC X(10).
  5369         16  OC-CERT-EFF-DT                PIC XX.
  5370         16  OC-CERT-NO.
  5371             20  OC-CERT-PRIME             PIC X(10).
  5372             20  OC-CERT-SFX               PIC X.
  5373         16  OC-RECORD-TYPE                PIC X.
  5374         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5375     12  OC-LAST-MAINT-DT                  PIC XX.
  5376     12  OC-LAST-MAINT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page  99
* EL1278.cbl
  5377     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5378     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5379     12  FILLER                            PIC X(49).
  5380     12  OC-ORIG-REC.
  5381         16  OC-INS-LAST-NAME              PIC X(15).
  5382         16  OC-INS-FIRST-NAME             PIC X(10).
  5383         16  OC-INS-MIDDLE-INIT            PIC X.
  5384         16  OC-INS-AGE                    PIC S999     COMP-3.
  5385         16  OC-JNT-LAST-NAME              PIC X(15).
  5386         16  OC-JNT-FIRST-NAME             PIC X(10).
  5387         16  OC-JNT-MIDDLE-INIT            PIC X.
  5388         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5389         16  OC-LF-BENCD                   PIC XX.
  5390         16  OC-LF-TERM                    PIC S999      COMP-3.
  5391         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5392         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5393         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5394         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5395         16  OC-LF-EXP-DT                  PIC XX.
  5396         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5397         16  OC-LF-CANCEL-DT               PIC XX.
  5398         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5399         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5400         16  OC-AH-BENCD                   PIC XX.
  5401         16  OC-AH-TERM                    PIC S999      COMP-3.
  5402         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5403         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5404         16  OC-AH-EXP-DT                  PIC XX.
  5405         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5406         16  OC-AH-CP                      PIC 99.
  5407         16  OC-AH-CANCEL-DT               PIC XX.
  5408         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5409         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5410         16  OC-CRED-BENE-NAME             PIC X(25).
  5411         16  OC-1ST-PMT-DT                 PIC XX.
  5412         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5413         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5414         16  OC-ISSUE-TRAN-IND             PIC X.
  5415         16  OC-CANCEL-TRAN-IND            PIC X.
  5416         16  FILLER                        PIC X(211).
  5417
  5418     12  FILLER                            PIC X(50).
  5419******************************************************************
  5420*                            COPY ERCFORM.
  5421******************************************************************
  5422*                                                                *
  5423*                                                                *
  5424*                            ERCFORM.                            *
  5425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5426*                            VMOD=2.003                          *
  5427*                                                                *
  5428*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5429*                                                                *
  5430*    FILE TYPE = VSAM,KSDS                                       *
  5431*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5432*                                                                *
  5433*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5434*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 100
* EL1278.cbl
  5435*    LOG = YES                                                   *
  5436*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5437******************************************************************
  5438 01  FORM-MASTER.
  5439    12  FO-RECORD-ID                 PIC X(02).
  5440        88  VALID-FO-ID                  VALUE 'FO'.
  5441
  5442    12  FO-CONTROL-PRIMARY.
  5443        16  FO-COMPANY-CD            PIC X(01).
  5444        16  FO-STATE                 PIC X(02).
  5445        16  FO-FORM-ID               PIC X(12).
  5446        16  FO-FORM-EXP-DT           PIC X(02).
  5447
  5448    12  FO-POLICY-FORM-DATA.
  5449        16  FO-IND-GRP-CD            PIC X(01).
  5450        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5451        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5452        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5453        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5454        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5455        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5456        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5457        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5458        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5459        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5460        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5461        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5462        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5463        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5464        16  FO-APP-CERT-USE-CD       PIC X(01).
  5465
  5466    12  FILLER                       PIC X(29).
  5467
  5468    12  FO-FORM-PLAN-TABLE.
  5469        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5470            20  FO-PLAN-TYPE         PIC X(01).
  5471            20  FO-PLAN-ID           PIC X(02).
  5472            20  FO-PLAN-TERM         PIC 9(03).
  5473            20  FO-PLAN-REFUND-METHOD
  5474                                     PIC X.
  5475
  5476    12  FILLER                       PIC X(30).
  5477
  5478    12  FO-COMMENTS-AREA.
  5479        16  FO-COMMENT-LINE-1        PIC X(78).
  5480
  5481    12  FILLER                       PIC X(20).
  5482
  5483    12  FO-MAINT-INFORMATION.
  5484        16  FO-LAST-MAINT-DT         PIC X(02).
  5485        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5486        16  FO-LAST-MAINT-BY         PIC X(04).
  5487*                            COPY ELCMSTR.
  5488******************************************************************
  5489*                                                                *
  5490*                            ELCMSTR.                            *
  5491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5492*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 101
* EL1278.cbl
  5493*                                                                *
  5494*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5495*                                                                *
  5496*   FILE TYPE = VSAM,KSDS                                        *
  5497*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5498*                                                                *
  5499*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5500*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5501*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5502*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5503*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5504*                                                 RKP=75,LEN=21  *
  5505*                                                                *
  5506*   **** NOTE ****                                               *
  5507*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5508*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5509*                                                                *
  5510*   LOG = YES                                                    *
  5511*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5512******************************************************************
  5513*                   C H A N G E   L O G
  5514*
  5515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5516*-----------------------------------------------------------------
  5517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5518* EFFECTIVE    NUMBER
  5519*-----------------------------------------------------------------
  5520* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5521* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5522* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5523* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5524* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5525******************************************************************
  5526 01  CLAIM-MASTER.
  5527     12  CL-RECORD-ID                PIC XX.
  5528         88  VALID-CL-ID         VALUE 'CL'.
  5529
  5530     12  CL-CONTROL-PRIMARY.
  5531         16  CL-COMPANY-CD           PIC X.
  5532         16  CL-CARRIER              PIC X.
  5533         16  CL-CLAIM-NO             PIC X(7).
  5534         16  CL-CERT-NO.
  5535             20  CL-CERT-PRIME       PIC X(10).
  5536             20  CL-CERT-SFX         PIC X.
  5537
  5538     12  CL-CONTROL-BY-NAME.
  5539         16  CL-COMPANY-CD-A1        PIC X.
  5540         16  CL-INSURED-LAST-NAME    PIC X(15).
  5541         16  CL-INSURED-NAME.
  5542             20  CL-INSURED-1ST-NAME PIC X(12).
  5543             20  CL-INSURED-MID-INIT PIC X.
  5544
  5545     12  CL-CONTROL-BY-SSN.
  5546         16  CL-COMPANY-CD-A2        PIC X.
  5547         16  CL-SOC-SEC-NO.
  5548             20  CL-SSN-STATE        PIC XX.
  5549             20  CL-SSN-ACCOUNT      PIC X(6).
  5550             20  CL-SSN-LN3          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 102
* EL1278.cbl
  5551
  5552     12  CL-CONTROL-BY-CERT-NO.
  5553         16  CL-COMPANY-CD-A4        PIC X.
  5554         16  CL-CERT-NO-A4.
  5555             20  CL-CERT-A4-PRIME    PIC X(10).
  5556             20  CL-CERT-A4-SFX      PIC X.
  5557
  5558     12  CL-CONTROL-BY-CCN.
  5559         16  CL-COMPANY-CD-A5        PIC X.
  5560         16  CL-CCN-A5.
  5561             20  CL-CCN.
  5562                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5563                 24  CL-CCN-PRIME-A5 PIC X(12).
  5564             20  CL-CCN-FILLER-A5    PIC X(4).
  5565
  5566     12  CL-INSURED-PROFILE-DATA.
  5567         16  CL-INSURED-BIRTH-DT     PIC XX.
  5568         16  CL-INSURED-SEX-CD       PIC X.
  5569             88  INSURED-IS-MALE        VALUE 'M'.
  5570             88  INSURED-IS-FEMALE      VALUE 'F'.
  5571             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5572         16  CL-INSURED-OCC-CD       PIC X(6).
  5573         16  FILLER                  PIC X(5).
  5574
  5575     12  CL-PROCESSING-INFO.
  5576         16  CL-PROCESSOR-ID         PIC X(4).
  5577         16  CL-CLAIM-STATUS         PIC X.
  5578             88  CLAIM-IS-OPEN          VALUE 'O'.
  5579             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5580         16  CL-CLAIM-TYPE           PIC X.
  5581*            88  AH-CLAIM               VALUE 'A'.
  5582*            88  LIFE-CLAIM             VALUE 'L'.
  5583*            88  PROPERTY-CLAIM         VALUE 'P'.
  5584*            88  IUI-CLAIM              VALUE 'I'.
  5585*            88  GAP-CLAIM              VALUE 'G'.
  5586*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  5587         16  CL-CLAIM-PREM-TYPE      PIC X.
  5588             88  SINGLE-PREMIUM         VALUE '1'.
  5589             88  O-B-COVERAGE           VALUE '2'.
  5590             88  OPEN-END-COVERAGE      VALUE '3'.
  5591         16  CL-INCURRED-DT          PIC XX.
  5592         16  CL-REPORTED-DT          PIC XX.
  5593         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5594         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5595         16  CL-LAST-PMT-DT          PIC XX.
  5596         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5597         16  CL-PAID-THRU-DT         PIC XX.
  5598         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5599         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5600         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5601         16  CL-PMT-CALC-METHOD      PIC X.
  5602             88  CL-360-DAY-YR          VALUE '1'.
  5603             88  CL-365-DAY-YR          VALUE '2'.
  5604             88  CL-FULL-MONTHS         VALUE '3'.
  5605         16  CL-CAUSE-CD             PIC X(6).
  5606
  5607         16  CL-PRIME-CERT-NO.
  5608             20  CL-PRIME-CERT-PRIME PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 103
* EL1278.cbl
  5609             20  CL-PRIME-CERT-SFX   PIC X.
  5610
  5611         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5612             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5613             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5614
  5615         16  CL-MICROFILM-NO         PIC X(10).
  5616         16  FILLER REDEFINES CL-MICROFILM-NO.
  5617             20  CL-BENEFIT-PERIOD   PIC 99.
  5618             20  FILLER              PIC X(8).
  5619         16  CL-PROG-FORM-TYPE       PIC X.
  5620         16  CL-LAST-ADD-ON-DT       PIC XX.
  5621
  5622         16  CL-LAST-REOPEN-DT       PIC XX.
  5623         16  CL-LAST-CLOSE-DT        PIC XX.
  5624         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5625             88  FINAL-PAID             VALUE '1'.
  5626             88  CLAIM-DENIED           VALUE '2'.
  5627             88  AUTO-CLOSE             VALUE '3'.
  5628             88  MANUAL-CLOSE           VALUE '4'.
  5629             88  BENEFITS-CHANGED       VALUE 'C'.
  5630             88  SETUP-ERRORS           VALUE 'E'.
  5631         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5632         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5633         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5634             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5635         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5636         16  FILLER                  PIC X.
  5637
  5638     12  CL-CERTIFICATE-DATA.
  5639         16  CL-CERT-ORIGIN          PIC X.
  5640             88  CERT-WAS-ONLINE        VALUE '1'.
  5641             88  CERT-WAS-CREATED       VALUE '2'.
  5642             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5643         16  CL-CERT-KEY-DATA.
  5644             20  CL-CERT-CARRIER     PIC X.
  5645             20  CL-CERT-GROUPING    PIC X(6).
  5646             20  CL-CERT-STATE       PIC XX.
  5647             20  CL-CERT-ACCOUNT.
  5648                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5649                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5650             20  CL-CERT-EFF-DT      PIC XX.
  5651
  5652     12  CL-STATUS-CONTROLS.
  5653         16  CL-PRIORITY-CD          PIC X.
  5654             88  CONFIDENTIAL-DATA      VALUE '8'.
  5655             88  HIGHEST-PRIORITY       VALUE '9'.
  5656         16  CL-SUPV-ATTN-CD         PIC X.
  5657             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5658             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5659         16  CL-PURGED-DT            PIC XX.
  5660         16  CL-RESTORED-DT          PIC XX.
  5661         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5662         16  CL-NEXT-RESEND-DT       PIC XX.
  5663         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5664         16  CL-CRITICAL-PERIOD      PIC 99.
  5665*        16  FILLER                  PIC XX.
  5666         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 104
* EL1278.cbl
  5667         16  CL-LAST-MAINT-USER      PIC X(4).
  5668         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5669         16  CL-LAST-MAINT-TYPE      PIC X.
  5670             88  CLAIM-SET-UP           VALUE ' '.
  5671             88  PAYMENT-MADE           VALUE '1'.
  5672             88  LETTER-SENT            VALUE '2'.
  5673             88  MASTER-WAS-ALTERED     VALUE '3'.
  5674             88  MASTER-WAS-RESTORED    VALUE '4'.
  5675             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5676             88  FILE-CONVERTED         VALUE '6'.
  5677             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5678             88  ERROR-CORRECTION       VALUE 'E'.
  5679         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5680         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5681         16  CL-BENEFICIARY          PIC X(10).
  5682         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5683         16  CL-DENIAL-TYPE          PIC X.
  5684             88  CL-TYPE-DENIAL          VALUE '1'.
  5685             88  CL-TYPE-RESCISSION      VALUE '2'.
  5686             88  CL-TYPE-REFORMATION     VALUE '3'.
  5687             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5688             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5689         16  filler                  pic x(5).
  5690*        16  CL-CRIT-PER-RECURRENT   PIC X.
  5691*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5692*        16  CL-RTW-DT               PIC XX.
  5693
  5694     12  CL-TRAILER-CONTROLS.
  5695         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5696             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5697             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5698             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5699         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5700         16  FILLER                  PIC XX.
  5701         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5702         16  CL-ADDRESS-TRAILER-CNT.
  5703             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5704                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5705             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5706                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5707             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5708                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5709             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5710                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5711             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5712                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5713             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5714                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5715             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5716                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5717
  5718     12  CL-CV-REFERENCE-NO.
  5719         16  CL-CV-REFNO-PRIME       PIC X(18).
  5720         16  CL-CV-REFNO-SFX         PIC XX.
  5721
  5722     12  CL-FILE-LOCATION            PIC X(4).
  5723
  5724     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 105
* EL1278.cbl
  5725         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5726             88  NO-FATAL-ERRORS        VALUE ZERO.
  5727         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5728             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5729
  5730     12  CL-PRODUCT-CD               PIC X.
  5731
  5732     12  CL-CURRENT-KEY-DATA.
  5733         16  CL-CURRENT-CARRIER      PIC X.
  5734         16  CL-CURRENT-GROUPING     PIC X(6).
  5735         16  CL-CURRENT-STATE        PIC XX.
  5736         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5737
  5738     12  CL-ASSOCIATES               PIC X.
  5739         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5740         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5741         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5742         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5743
  5744     12  CL-ACTIVITY-CODE            PIC 99.
  5745     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5746     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5747
  5748     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5749     12  CL-LAG-REPORT-CODE          PIC 9.
  5750     12  CL-LOAN-TYPE                PIC XX.
  5751     12  CL-LEGAL-STATE              PIC XX.
  5752
  5753     12  CL-YESNOSW                  PIC X.
  5754     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5755         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5756         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5757         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5758     12  cl-insured-type             pic x.
  5759         88  cl-claim-on-primary         value 'P'.
  5760         88  cl-claim-on-co-borrower     value 'C'.
  5761     12  cl-benefit-expiration-dt    PIC XX.
  5762*                            COPY ERCPDEF.
  5763******************************************************************
  5764*                                                                *
  5765*                                                                *
  5766*                            ERCPDEF.                            *
  5767*                                                                *
  5768*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5769*                                                                *
  5770*    FILE TYPE = VSAM,KSDS                                       *
  5771*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5772*                                                                *
  5773*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5774*                                                                *
  5775*    LOG = YES                                                   *
  5776*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5777******************************************************************
  5778*                   C H A N G E   L O G
  5779*
  5780* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5781*-----------------------------------------------------------------
  5782*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 106
* EL1278.cbl
  5783* EFFECTIVE    NUMBER
  5784*-----------------------------------------------------------------
  5785* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5786* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5787* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5788******************************************************************
  5789 01  PRODUCT-MASTER.
  5790    12  PD-RECORD-ID                 PIC X(02).
  5791        88  VALID-PD-ID                  VALUE 'PD'.
  5792    12  PD-CONTROL-PRIMARY.
  5793        16  PD-COMPANY-CD            PIC X.
  5794        16  PD-STATE                 PIC XX.
  5795        16  PD-PRODUCT-CD            PIC XXX.
  5796        16  PD-FILLER                PIC X(7).
  5797        16  PD-BEN-TYPE              PIC X.
  5798        16  PD-BEN-CODE              PIC XX.
  5799        16  PD-PROD-EXP-DT           PIC XX.
  5800    12  FILLER                       PIC X(50).
  5801    12  PD-PRODUCT-DATA OCCURS 8.
  5802        16  PD-PROD-CODE             PIC X.
  5803            88  PD-PROD-LIFE           VALUE 'L'.
  5804            88  PD-PROD-PROP           VALUE 'P'.
  5805            88  PD-PROD-AH             VALUE 'A'.
  5806            88  PD-PROD-IU             VALUE 'I'.
  5807            88  PD-PROD-GAP            VALUE 'G'.
  5808            88  PD-PROD-FAML           VALUE 'F'.
  5809        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5810        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5811        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5812        16  PD-MAX-TERM              PIC S999        COMP-3.
  5813        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5814        16  FILLER                   PIC X.
  5815        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5816        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5817        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5818        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5819        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5820        16  PD-REC-CRIT-PERIOD       PIC 99.
  5821        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5822            20  PD-RECURRING-YN      PIC X.
  5823            20  FILLER               PIC X.
  5824        16  PD-RTW-MOS               PIC 99.
  5825        16  PD-MAX-EXTENSION         PIC 99.
  5826        16  pd-ben-pct               pic sv999 comp-3.
  5827*       16  FILLER                   PIC XX.
  5828    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5829    12  PD-TERM-LIMITS OCCURS 15.
  5830        16  PD-LOW-TERM              PIC S999        COMP-3.
  5831        16  PD-HI-TERM               PIC S999        COMP-3.
  5832*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5833    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5834        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5835        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5836    12  PD-EARN-FACTORS.
  5837        16  FILLER OCCURS 15.
  5838            20  FILLER OCCURS 15.
  5839                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5840    12  PD-PRODUCT-DESC              PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 107
* EL1278.cbl
  5841    12  PD-TRUNCATED                 PIC X.
  5842    12  FILLER                       PIC X(59).
  5843    12  PD-MAINT-INFORMATION.
  5844        16  PD-LAST-MAINT-DT         PIC X(02).
  5845        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5846        16  PD-LAST-MAINT-BY         PIC X(04).
  5847*                            COPY ELCCRTT.
  5848******************************************************************
  5849*                                                                *
  5850*                            ELCCRTT.                            *
  5851*                                                                *
  5852*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5853*                                                                *
  5854*   FILE TYPE = VSAM,KSDS                                        *
  5855*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5856*                                                                *
  5857*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5858*                                                                *
  5859*   LOG = YES                                                    *
  5860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5861******************************************************************
  5862*                   C H A N G E   L O G
  5863*
  5864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5865*-----------------------------------------------------------------
  5866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5867* EFFECTIVE    NUMBER
  5868*-----------------------------------------------------------------
  5869* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5870* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5871* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5872* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5873* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5874* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5875* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5876* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5877* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5878******************************************************************
  5879
  5880 01  CERTIFICATE-TRAILERS.
  5881     12  CS-RECORD-ID                      PIC XX.
  5882         88  VALID-CS-ID                      VALUE 'CS'.
  5883
  5884     12  CS-CONTROL-PRIMARY.
  5885         16  CS-COMPANY-CD                 PIC X.
  5886         16  CS-CARRIER                    PIC X.
  5887         16  CS-GROUPING                   PIC X(6).
  5888         16  CS-STATE                      PIC XX.
  5889         16  CS-ACCOUNT                    PIC X(10).
  5890         16  CS-CERT-EFF-DT                PIC XX.
  5891         16  CS-CERT-NO.
  5892             20  CS-CERT-PRIME             PIC X(10).
  5893             20  CS-CERT-SFX               PIC X.
  5894         16  CS-TRAILER-TYPE               PIC X.
  5895             88  COMM-TRLR           VALUE 'A'.
  5896             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5897             88  CERT-DATA-TRLR      VALUE 'C'.
  5898
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 108
* EL1278.cbl
  5899     12  CS-DATA-AREA                      PIC X(516).
  5900
  5901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5902         16  CS-BANK-COMMISSION-AREA.
  5903             20  CS-BANK-COMMS       OCCURS 10.
  5904                 24  CS-AGT                PIC X(10).
  5905                 24  CS-COM-TYP            PIC X.
  5906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5907                 24  CS-RECALC-LV-INDIC    PIC X.
  5908                 24  FILLER                PIC X(10).
  5909         16  FILLER                        PIC X(256).
  5910
  5911     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5912****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5913         16  CS-MB-CLAIM-DATA OCCURS 24.
  5914             20  CS-CLAIM-NO               PIC X(7).
  5915             20  CS-CLAIM-TYPE             PIC X.
  5916                 88  CS-AH-CLM               VALUE 'A'.
  5917                 88  CS-IU-CLM               VALUE 'I'.
  5918                 88  CS-GP-CLM               VALUE 'G'.
  5919                 88  CS-LF-CLM               VALUE 'L'.
  5920                 88  CS-PR-CLM               VALUE 'P'.
  5921                 88  CS-FL-CLM               VALUE 'F'.
  5922             20  CS-INSURED-TYPE           PIC X.
  5923                 88  CS-PRIM-INSURED          VALUE 'P'.
  5924                 88  CS-CO-BORROWER           VALUE 'C'.
  5925             20  CS-BENEFIT-PERIOD         PIC 99.
  5926             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5927             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5928             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5929         16  FILLER                        PIC X(12).
  5930     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5931         16  CS-VIN-NUMBER                 PIC X(17).
  5932         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5933         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5934         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5935         16  cs-agent-name.
  5936             20  cs-agent-fname            pic x(20).
  5937             20  cs-agent-mi               pic x.
  5938             20  cs-agent-lname            pic x(25).
  5939         16  cs-license-no                 pic x(15).
  5940         16  cs-npn-number                 pic x(10).
  5941         16  cs-agent-edit-status          pic x.
  5942             88  cs-ae-refer-to-manager      value 'M'.
  5943             88  cs-ae-cover-sheet           value 'C'.
  5944             88  cs-ae-sig-form              value 'S'.
  5945             88  cs-ae-verified              value 'V'.
  5946             88  cs-unidentified-signature   value 'U'.
  5947             88  cs-cert-returned            value 'R'.
  5948             88  cs-accept-no-commission     value 'N'.
  5949         16  cs-year                       pic 9999.
  5950         16  cs-make                       pic x(20).
  5951         16  cs-model                      pic x(20).
  5952         16  cs-future                     pic x(20).
  5953         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5954         16  FILLER                        PIC X(356). *> was 420
  5955*        16  FILLER                        PIC X(496).
  5956 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 109
* EL1278.cbl
  5957                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5958                          MAILING-DATA ORIGINAL-CERTIFICATE
  5959                          FORM-MASTER CLAIM-MASTER
  5960                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5961 0000-DFHEXIT SECTION.
  5962     MOVE '9#                    $   ' TO DFHEIV0.
  5963     MOVE 'EL1278' TO DFHEIV1.
  5964     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5965*    SERVICE RELOAD PARMLIST.
  5966
  5967     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5968     MOVE '5'                    TO  DC-OPTION-CODE.
  5969
  5970     PERFORM 9600-DATE-LINK.
  5971
  5972     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5973     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5974     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5975     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5976     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5977     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5978     MOVE EIBTRMID               TO  QID-TERM.
  5979
  5980     IF EIBCALEN  IS EQUAL TO  ZERO
  5981         GO TO 8700-UNAUTHORIZED-ACCESS.
  5982
  5983     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5984         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5985             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5986             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5987             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5988             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5989             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5990             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5991             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5992             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5993         ELSE
  5994             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5995             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5996             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5997             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5998             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5999             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  6000             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  6001             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  6002             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  6003
  6004     IF EIBAID  IS EQUAL TO  DFHCLEAR
  6005         GO TO 9300-CLEAR.
  6006
  6007     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  6008         NEXT SENTENCE
  6009     ELSE
  6010
  6011* EXEC CICS READQ TS
  6012*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6013*            INTO    (SECURITY-CONTROL)
  6014*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 110
* EL1278.cbl
  6015*            ITEM    (SC-ITEM)
  6016*        END-EXEC
  6017*    MOVE '*$II   L              ''   #00006006' TO DFHEIV0
  6018     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6020     MOVE X'2020233030303036303036' TO DFHEIV0(25:11)
  6021     CALL 'kxdfhei1' USING DFHEIV0,
  6022           PI-SECURITY-TEMP-STORE-ID,
  6023           SECURITY-CONTROL,
  6024           SC-COMM-LENGTH,
  6025           SC-ITEM,
  6026           DFHEIV99,
  6027           DFHEIV99
  6028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6029         MOVE SC-CREDIT-DISPLAY (33)
  6030                                 TO  PI-DISPLAY-CAP
  6031         MOVE SC-CREDIT-UPDATE  (33)
  6032                                 TO  PI-MODIFY-CAP
  6033         MOVE SC-CREDIT-UPDATE  (32)
  6034                                 TO  PI-MODIFY-CERT-CAP
  6035         IF NOT  DISPLAY-CAP
  6036             MOVE 'READ'         TO  SM-READ
  6037             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6038             MOVE ER-0070        TO  EMI-ERROR
  6039             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6040             GO TO 8100-SEND-INITIAL-MAP.
  6041
  6042     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  6043         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  6044         MOVE LOW-VALUES         TO  EL127HI
  6045         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  6046                                     PI-LF-CANCEL-DATE
  6047                                     WS-AH-CANCEL-DATE
  6048                                     PI-AH-CANCEL-DATE
  6049         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  6050                                     PI-LF-CANCEL-DATE-ED
  6051                                     WS-AH-CANCEL-DATE-ED
  6052                                     PI-AH-CANCEL-DATE-ED
  6053         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  6054                                     PI-EARNING-METHOD-AH
  6055         PERFORM 0500-FORMAT-SCREEN
  6056         GO TO 8100-SEND-INITIAL-MAP.
  6057
  6058     IF NOT  MODIFY-CAP
  6059         MOVE 'UPDATE'           TO  SM-READ
  6060         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6061         MOVE ER-0070            TO  EMI-ERROR
  6062         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6063         GO TO 8100-SEND-INITIAL-MAP.
  6064
  6065
  6066* EXEC CICS HANDLE CONDITION
  6067*        PGMIDERR  (9500-PGMID-ERROR)
  6068*        ERROR     (9900-ABEND)
  6069*    END-EXEC.
  6070*    MOVE '"$L.                  ! " #00006048' TO DFHEIV0
  6071     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  6072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 111
* EL1278.cbl
  6073     MOVE X'2220233030303036303438' TO DFHEIV0(25:11)
  6074     CALL 'kxdfhei1' USING DFHEIV0
  6075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6076
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 112
* EL1278.cbl
  6078 0200-RECEIVE.
  6079     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  6080         MOVE ER-0008            TO  EMI-ERROR
  6081         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6082         MOVE -1                 TO  HLCANCL
  6083         GO TO 8200-SEND-DATAONLY.
  6084
  6085
  6086* EXEC CICS RECEIVE
  6087*        MAP     (MAP-NAME)
  6088*        MAPSET  (MAPSET-NAME)
  6089*        INTO    (EL127HI)
  6090*    END-EXEC.
  6091     MOVE LENGTH OF
  6092      EL127HI
  6093       TO DFHEIV11
  6094*    MOVE '8"T I  L              ''   #00006060' TO DFHEIV0
  6095     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6097     MOVE X'2020233030303036303630' TO DFHEIV0(25:11)
  6098     CALL 'kxdfhei1' USING DFHEIV0,
  6099           MAP-NAME,
  6100           EL127HI,
  6101           DFHEIV11,
  6102           MAPSET-NAME,
  6103           DFHEIV99,
  6104           DFHEIV99
  6105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6106
  6107
  6108     IF HPFKEYL  IS EQUAL TO  ZERO
  6109         GO TO 0300-CHECK-PFKEYS.
  6110
  6111     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  6112         MOVE ER-0004            TO  EMI-ERROR
  6113         GO TO 0320-INPUT-ERROR.
  6114
  6115     IF HPFKEYI NUMERIC
  6116         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  6117             MOVE PF-VALUES (HPFKEYI)
  6118                                 TO  EIBAID
  6119         ELSE
  6120             MOVE ER-0029        TO  EMI-ERROR
  6121             GO TO 0320-INPUT-ERROR.
  6122
  6123 0300-CHECK-PFKEYS.
  6124     IF EIBAID  IS EQUAL TO  DFHPF23
  6125         GO TO 8800-PF23.
  6126
  6127     IF EIBAID  IS EQUAL TO  DFHPF24
  6128         GO TO 9100-RETURN-MAIN-MENU.
  6129     if eibaid not = dfhpf10
  6130        move 'N'                 to pi-pf10-ok
  6131     end-if
  6132     IF EIBAID = DFHPF11
  6133        GO TO 1700-WRITE-CERT-NOTE
  6134     END-IF
  6135
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 113
* EL1278.cbl
  6136     IF EIBAID  IS EQUAL TO  DFHPF12
  6137         GO TO 9400-PF12.
  6138
  6139     IF EIBAID = DFHENTER OR DFHPF10
  6140        GO TO 0400-EDIT-INPUT-DATA
  6141     END-IF
  6142
  6143     MOVE ER-0029                TO  EMI-ERROR.
  6144
  6145 0320-INPUT-ERROR.
  6146     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6147
  6148     MOVE AL-UNBON               TO  HPFKEYA.
  6149
  6150     IF HPFKEYL  IS EQUAL TO  ZERO
  6151         MOVE -1                 TO  HLCANCL
  6152     ELSE
  6153         MOVE -1                 TO  HPFKEYL.
  6154
  6155     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 114
* EL1278.cbl
  6157 0400-EDIT-INPUT-DATA.
  6158     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6159                                     WS-NEW-LF-CANCEL-SW.
  6160
  6161     IF (HPCYNL > 0)
  6162        AND (HPCYNI = 'Y' OR 'N')
  6163        PERFORM 1800-READ-ELCERT-UPDATE
  6164                                 THRU 1800-EXIT
  6165        IF WS-RESP-NORMAL
  6166           MOVE HPCYNI           TO CM-POST-CARD-IND
  6167           PERFORM 1810-REWRITE-ELCERT
  6168                                 THRU 1810-EXIT
  6169        END-IF
  6170     END-IF
  6171     IF HLCAL1L GREATER ZERO
  6172         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6173     IF CLPYNI = 'Y'
  6174        MOVE 'Y'                   TO PI-CLP-YN
  6175        MOVE AL-UANON              TO CLPYNA
  6176     ELSE
  6177        MOVE ' '                   TO PI-CLP-YN
  6178        MOVE AL-UANON              TO CLPYNA
  6179     END-IF
  6180     IF CANREAI = 'R'
  6181        MOVE 'R'                 TO PI-CANCEL-REASON
  6182        MOVE AL-UANON            TO CANREAA
  6183     ELSE
  6184        MOVE ' '                 TO PI-CANCEL-REASON
  6185        MOVE AL-UANON            TO CANREAA
  6186     END-IF
  6187
  6188     IF HLCANCL  IS EQUAL TO  ZERO
  6189       AND HACANCL  IS EQUAL TO  ZERO
  6190         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6191         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6192         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6193         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6194         GO TO 0420-CHECK-ERRORS.
  6195
  6196     IF HLCANCL  IS EQUAL TO  ZERO
  6197         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6198         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6199         GO TO 0410-CHECK-AH-DATE.
  6200
  6201     IF HLCANCI = SPACES
  6202        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6203                                      WS-LF-CANCEL-DATE
  6204        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6205                                      WS-LF-CANCEL-DATE-ED
  6206                                      PI-LF-REFUND-METH
  6207        MOVE +0                    TO PI-LF-REFUND-AMT
  6208        GO TO 0410-CHECK-AH-DATE
  6209     END-IF
  6210
  6211     MOVE AL-UNNON               TO  HLCANCA.
  6212     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6213     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6214
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 115
* EL1278.cbl
  6215     PERFORM 8600-DEEDIT.
  6216
  6217     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6218     MOVE '4'                    TO  DC-OPTION-CODE.
  6219
  6220     PERFORM 9600-DATE-LINK.
  6221
  6222     IF DATE-CONVERSION-ERROR
  6223         MOVE -1                 TO  HLCANCL
  6224         MOVE AL-UABON           TO  HLCANCA
  6225         MOVE ER-2227            TO  EMI-ERROR
  6226         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6227     ELSE
  6228        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6229           MOVE -1               TO  HACANCL
  6230           MOVE AL-UABON         TO  HACANCA
  6231           MOVE ER-2774          TO  EMI-ERROR
  6232           PERFORM 9700-ERROR-FORMAT
  6233                                 THRU  9799-EXIT
  6234        ELSE
  6235           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6236                                    PI-LF-CANCEL-DATE
  6237           MOVE DC-GREG-DATE-1-EDIT
  6238                                 TO HLCANCO
  6239                                    WS-LF-CANCEL-DATE-ED
  6240                                    PI-LF-CANCEL-DATE-ED
  6241        END-IF
  6242     END-IF
  6243     .
  6244 0410-CHECK-AH-DATE.
  6245     IF HACAL1L GREATER ZERO
  6246         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6247
  6248     IF HACANCL  IS EQUAL TO  ZERO
  6249         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6250         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6251         GO TO 0420-CHECK-ERRORS.
  6252     IF HACANCI = SPACES
  6253        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6254                                      WS-AH-CANCEL-DATE
  6255        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6256                                      WS-AH-CANCEL-DATE-ED
  6257                                      PI-AH-REFUND-METH
  6258        MOVE +0                    TO PI-AH-REFUND-AMT
  6259        GO TO 0420-CHECK-ERRORS
  6260     END-IF
  6261
  6262     MOVE AL-UNNON               TO  HACANCA.
  6263     MOVE HACANCI                TO  DEEDIT-FIELD.
  6264     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6265
  6266     PERFORM 8600-DEEDIT.
  6267
  6268     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6269     MOVE '4'                    TO  DC-OPTION-CODE.
  6270
  6271     PERFORM 9600-DATE-LINK.
  6272
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 116
* EL1278.cbl
  6273     IF DATE-CONVERSION-ERROR
  6274         MOVE -1                 TO  HACANCL
  6275         MOVE AL-UABON           TO  HACANCA
  6276         MOVE ER-2227            TO  EMI-ERROR
  6277         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6278     ELSE
  6279        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6280           MOVE -1               TO  HACANCL
  6281           MOVE AL-UABON         TO  HACANCA
  6282           MOVE ER-2775          TO  EMI-ERROR
  6283           PERFORM 9700-ERROR-FORMAT
  6284                                 THRU  9799-EXIT
  6285        ELSE
  6286           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6287                                    PI-AH-CANCEL-DATE
  6288           MOVE DC-GREG-DATE-1-EDIT
  6289                                 TO HACANCO
  6290                                    WS-AH-CANCEL-DATE-ED
  6291                                    PI-AH-CANCEL-DATE-ED
  6292        END-IF
  6293     END-IF
  6294     .
  6295 0420-CHECK-ERRORS.
  6296     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6297         NEXT SENTENCE
  6298     ELSE
  6299         GO TO 8200-SEND-DATAONLY.
  6300
  6301     PERFORM 0500-FORMAT-SCREEN.
  6302     if eibaid = dfhpf10
  6303        if pi-pf10-ok not = 'Y'
  6304           move 'Y'              to pi-pf10-ok
  6305           move er-3847          to emi-error
  6306           move -1               to hlcancl
  6307           perform 9700-error-format
  6308                                 thru 9799-exit
  6309           go to 8200-send-dataonly
  6310        end-if
  6311     end-if
  6312     IF EIBAID = DFHPF10
  6313        perform 4000-GEN-CANCEL-TRANS
  6314                                 thru 4000-exit
  6315        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6316        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6317        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6318        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6319        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6320        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6321                               PI-ALL-CANCELS-SW
  6322        IF PI-PROCESSOR-IS-CSR
  6323            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6324        ELSE
  6325            MOVE ' '        TO PI-CSR-SESSION-SW
  6326        END-IF
  6327        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6328                               PI-CANCELS-IN-ERROR-SW
  6329                               PI-ONLY-BATCH-HEADERS-SW
  6330                               PI-ALL-OUT-OF-BAL-SW
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 117
* EL1278.cbl
  6331                               PI-HOLD-REC-SW
  6332                               PI-CHANGE-REC-SW
  6333                               PI-CHK-REQ-REC-SW
  6334                               PI-ISSUE-WARNING-SW
  6335                               PI-CANCEL-WARNING-SW
  6336        MOVE '1'            TO PI-BROWSE-TYPE
  6337        MOVE DFHENTER       TO  EIBAID
  6338
  6339
  6340* EXEC CICS XCTL
  6341*           PROGRAM    ('EL6311')
  6342*           COMMAREA   (WS-PASS-631)
  6343*           LENGTH     (1300)
  6344*       END-EXEC
  6345     MOVE 'EL6311' TO DFHEIV1
  6346     MOVE 1300
  6347       TO DFHEIV11
  6348*    MOVE '.$C                   %   #00006297' TO DFHEIV0
  6349     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6351     MOVE X'2020233030303036323937' TO DFHEIV0(25:11)
  6352     CALL 'kxdfhei1' USING DFHEIV0,
  6353           DFHEIV1,
  6354           WS-PASS-631,
  6355           DFHEIV11,
  6356           DFHEIV99
  6357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6358
  6359*        PERFORM 0500-FORMAT-SCREEN
  6360     END-IF
  6361     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 118
* EL1278.cbl
  6363 0500-FORMAT-SCREEN  SECTION.
  6364     MOVE LOW-VALUES             TO  EL127HO.
  6365     MOVE PI-CARRIER             TO  HCARIERO.
  6366     MOVE PI-GROUPING            TO  HGROUPO.
  6367     MOVE PI-STATE               TO  HSTATEO.
  6368     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6369     MOVE ' '                    TO  DC-OPTION-CODE.
  6370     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6371
  6372     PERFORM 9600-DATE-LINK.
  6373
  6374     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6375     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6376     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6377     MOVE PI-CLP-YN              TO  CLPYNO
  6378     MOVE PI-CANCEL-REASON       TO  CANREAO
  6379     .
  6380 0510-GET-CERT.
  6381     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6382     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6383     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6384     MOVE PI-STATE               TO  WS-CM-STATE.
  6385     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6386     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6387     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6388     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6389
  6390     PERFORM 0900-READ-CERT-FILE.
  6391
  6392     IF CERT-NOT-FOUND
  6393         MOVE -1                 TO  HLCANCL
  6394         MOVE AL-SANON           TO  HLCANCA
  6395         MOVE ER-0214            TO  EMI-ERROR
  6396         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6397         GO TO 8100-SEND-INITIAL-MAP.
  6398
  6399     IF CM-CLAIM-ATTACHED-COUNT = +0
  6400        GO TO 0510-SKIP-CLAIM-CHECK
  6401     END-IF
  6402*    DISPLAY ' STARTING CLAIM TEST '
  6403     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6404     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6405
  6406* EXEC CICS STARTBR
  6407*       DATASET     ('ELMSTR5')
  6408*       RIDFLD      (ELMSTR-KEY)
  6409*       RESP        (WS-RESPONSE)
  6410*    END-EXEC
  6411     MOVE 'ELMSTR5' TO DFHEIV1
  6412     MOVE 0
  6413       TO DFHEIV11
  6414*    MOVE '&,         G          &  N#00006349' TO DFHEIV0
  6415     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6417     MOVE X'204E233030303036333439' TO DFHEIV0(25:11)
  6418     CALL 'kxdfhei1' USING DFHEIV0,
  6419           DFHEIV1,
  6420           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 119
* EL1278.cbl
  6421           DFHEIV99,
  6422           DFHEIV11,
  6423           DFHEIV99
  6424     MOVE EIBRESP  TO WS-RESPONSE
  6425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6426     IF WS-RESP-NORMAL
  6427     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6428
  6429* EXEC CICS READNEXT
  6430*          DATASET   ('ELMSTR5')
  6431*          RIDFLD    (ELMSTR-KEY)
  6432*          SET       (ADDRESS OF CLAIM-MASTER)
  6433*          RESP      (WS-RESPONSE)
  6434*       END-EXEC
  6435     MOVE 'ELMSTR5' TO DFHEIV1
  6436     MOVE 0
  6437       TO DFHEIV11
  6438*    MOVE '&.S                   )  N#00006356' TO DFHEIV0
  6439     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6441     MOVE X'204E233030303036333536' TO DFHEIV0(25:11)
  6442     CALL 'kxdfhei1' USING DFHEIV0,
  6443           DFHEIV1,
  6444           DFHEIV20,
  6445           DFHEIV99,
  6446           ELMSTR-KEY,
  6447           DFHEIV99,
  6448           DFHEIV11,
  6449           DFHEIV99,
  6450           DFHEIV99
  6451     SET ADDRESS OF CLAIM-MASTER TO
  6452         DFHEIV20
  6453     MOVE EIBRESP  TO WS-RESPONSE
  6454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6455        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6456           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6457           AND (CM-CERT-NO = CL-CERT-NO)
  6458           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6459              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6460              SET FOUND-A-CLAIM  TO TRUE
  6461              IF CL-CLAIM-TYPE = 'L'
  6462                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6463                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6464                 END-IF
  6465                 IF CLAIM-IS-OPEN
  6466                    SET OPEN-LF-CLAIM TO TRUE
  6467                 ELSE
  6468                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6469                       MOVE CL-LAST-CLOSE-DT
  6470                                 TO WS-LF-LAST-CLOSE-DT
  6471                    END-IF
  6472                    SET CLOSED-LF-CLAIM TO TRUE
  6473                 END-IF
  6474              ELSE
  6475                 IF CLAIM-IS-OPEN
  6476                    MOVE CL-PAID-THRU-DT
  6477                                 TO WS-AH-PAID-THRU-DT
  6478                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 120
* EL1278.cbl
  6479                 ELSE
  6480                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6481                       MOVE CL-PAID-THRU-DT
  6482                                 TO WS-AH-PAID-THRU-DT
  6483                    END-IF
  6484                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6485                       MOVE CL-LAST-CLOSE-DT
  6486                                 TO WS-AH-LAST-CLOSE-DT
  6487                    END-IF
  6488                    SET CLOSED-AH-CLAIM TO TRUE
  6489                 END-IF
  6490              END-IF
  6491           END-IF
  6492        ELSE
  6493           SET I-SAY-TO-STOP TO TRUE
  6494        END-IF
  6495     END-PERFORM
  6496     END-IF
  6497     IF FOUND-A-CLAIM
  6498        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6499           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6500           MOVE ' '              TO DC-OPTION-CODE
  6501           PERFORM 9600-DATE-LINK
  6502           IF NO-CONVERSION-ERROR
  6503              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6504              MOVE AL-SANOF      TO LCLMDTHA
  6505           END-IF
  6506        END-IF
  6507        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6508           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6509           MOVE ' '              TO DC-OPTION-CODE
  6510           PERFORM 9600-DATE-LINK
  6511           IF NO-CONVERSION-ERROR
  6512              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6513              MOVE AL-SANOF      TO ACLMDTHA
  6514           END-IF
  6515        END-IF
  6516        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6517        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6518        MOVE CM-STATE            TO WS-CF-ACCESS
  6519        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6520
  6521* EXEC CICS READ
  6522*          DATASET  (ELCNTL-ID)
  6523*          SET      (ADDRESS OF CONTROL-FILE)
  6524*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6525*          RESP     (WS-RESPONSE)
  6526*       END-EXEC
  6527*    MOVE '&"S        E          (  N#00006427' TO DFHEIV0
  6528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6530     MOVE X'204E233030303036343237' TO DFHEIV0(25:11)
  6531     CALL 'kxdfhei1' USING DFHEIV0,
  6532           ELCNTL-ID,
  6533           DFHEIV20,
  6534           DFHEIV99,
  6535           WS-CF-CONTROL-PRIMARY,
  6536           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 121
* EL1278.cbl
  6537           DFHEIV99,
  6538           DFHEIV99
  6539     SET ADDRESS OF CONTROL-FILE TO
  6540         DFHEIV20
  6541     MOVE EIBRESP  TO WS-RESPONSE
  6542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6543        IF WS-RESP-NORMAL
  6544           MOVE CF-ST-REF-AH-DEATH-IND
  6545                                 TO WS-ST-REF-IND
  6546        END-IF
  6547     END-IF
  6548     .
  6549 0510-SKIP-CLAIM-CHECK.
  6550     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6551     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6552     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6553     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6554
  6555* EXEC CICS READ
  6556*        DATASET  (ERMAIL-ID)
  6557*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6558*        SET      (ADDRESS OF MAILING-DATA)
  6559*        RESP     (WS-RESPONSE)
  6560*    END-EXEC.
  6561*    MOVE '&"S        E          (  N#00006444' TO DFHEIV0
  6562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6564     MOVE X'204E233030303036343434' TO DFHEIV0(25:11)
  6565     CALL 'kxdfhei1' USING DFHEIV0,
  6566           ERMAIL-ID,
  6567           DFHEIV20,
  6568           DFHEIV99,
  6569           WS-MA-CONTROL-PRIMARY,
  6570           DFHEIV99,
  6571           DFHEIV99,
  6572           DFHEIV99
  6573     SET ADDRESS OF MAILING-DATA TO
  6574         DFHEIV20
  6575     MOVE EIBRESP  TO WS-RESPONSE
  6576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6577
  6578     IF WS-RESP-NORMAL
  6579        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6580           (S1 > +7)
  6581           OR (MA-MAIL-STATUS (S1) = '1')
  6582        END-PERFORM
  6583        IF S1 > +7
  6584           MOVE AL-SANOF         TO HPCYNA
  6585        END-IF
  6586     END-IF
  6587     IF CM-POST-CARD-IND = 'Y'
  6588        MOVE 'Y'                 TO HPCYNO
  6589     ELSE
  6590        MOVE 'N'                 TO HPCYNO
  6591     END-IF
  6592     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6593        OR (NOT CERT-AS-LOADED)
  6594        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 122
* EL1278.cbl
  6595     END-IF
  6596*    IF (CERT-ADDED-BATCH)
  6597*       CONTINUE
  6598*    ELSE
  6599*       MOVE AL-SANOF            TO HPCYNA
  6600*    END-IF
  6601     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6602     MOVE '5'                    TO  DC-OPTION-CODE.
  6603
  6604     PERFORM 9600-DATE-LINK.
  6605
  6606     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6607     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6608     MOVE '1'                    TO  DC-OPTION-CODE.
  6609
  6610     PERFORM 9600-DATE-LINK.
  6611
  6612     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6613
  6614     MOVE ZEROS TO WS-TOT-ITDR.
  6615     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6616
  6617 0510-CHECK-LF-STATUS.
  6618
  6619     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6620         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6621                                    PI-LF-CANCEL-DATE
  6622         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6623                                    PI-LF-CANCEL-DATE-ED
  6624                                    PI-LF-REFUND-METH
  6625         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6626         GO TO 0510-CHECK-AH-STATUS.
  6627
  6628     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6629        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6630          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6631          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6632          IF FIRST-ENTRY
  6633              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6634              MOVE SPACES               TO DC-OPTION-CODE
  6635              PERFORM 9600-DATE-LINK
  6636              IF NOT DATE-CONVERSION-ERROR
  6637                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6638                                            PI-LF-CANCEL-DATE-ED
  6639                                            WS-LF-CANCEL-DATE-ED
  6640                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6641                                            WS-LF-CANCEL-DATE.
  6642
  6643     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6644        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6645          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6646          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6647          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6648        IF FIRST-ENTRY
  6649            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6650            MOVE SPACES               TO DC-OPTION-CODE
  6651            PERFORM 9600-DATE-LINK
  6652            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 123
* EL1278.cbl
  6653                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6654                                          PI-LF-CANCEL-DATE-ED
  6655                                          WS-LF-CANCEL-DATE-ED
  6656                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6657                                          WS-LF-CANCEL-DATE.
  6658
  6659 0510-CHECK-AH-STATUS.
  6660
  6661     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6662         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6663                                    PI-AH-CANCEL-DATE
  6664         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6665                                    PI-AH-CANCEL-DATE-ED
  6666                                    PI-AH-REFUND-METH
  6667         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6668         GO TO 0510-CONT.
  6669
  6670     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6671        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6672          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6673          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6674        IF FIRST-ENTRY
  6675            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6676            MOVE SPACES               TO DC-OPTION-CODE
  6677            PERFORM 9600-DATE-LINK
  6678            IF NOT DATE-CONVERSION-ERROR
  6679                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6680                                            PI-AH-CANCEL-DATE-ED
  6681                                            WS-AH-CANCEL-DATE-ED
  6682                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6683                                            WS-AH-CANCEL-DATE.
  6684
  6685     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6686        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6687          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6688          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6689          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6690         IF FIRST-ENTRY
  6691             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6692             MOVE SPACES               TO DC-OPTION-CODE
  6693             PERFORM 9600-DATE-LINK
  6694             IF NOT DATE-CONVERSION-ERROR
  6695                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6696                                            PI-AH-CANCEL-DATE-ED
  6697                                            WS-AH-CANCEL-DATE-ED
  6698                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6699                                            WS-AH-CANCEL-DATE.
  6700
  6701     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6702         MOVE 'CANC DT'              TO  CNCDTHDO
  6703         GO TO 0510-CONT.
  6704
  6705     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6706         MOVE 'DTH DT '              TO  CNCDTHDO
  6707         IF FIRST-ENTRY
  6708             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6709             MOVE ' '                TO  DC-OPTION-CODE
  6710             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 124
* EL1278.cbl
  6711             IF NOT DATE-CONVERSION-ERROR
  6712                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6713                                             PI-AH-CANCEL-DATE-ED
  6714                                             WS-AH-CANCEL-DATE-ED
  6715                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6716                                             WS-AH-CANCEL-DATE.
  6717
  6718 0510-CONT.
  6719
  6720     IF WS-TOT-ITDR GREATER THAN ZEROS
  6721         MOVE WS-TOT-ITDR TO TOITDRO.
  6722
  6723 0520-GET-COMPANY-RECORD.
  6724     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6725     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6726     MOVE SPACES                 TO  WS-CF-ACCESS.
  6727     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6728
  6729     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6730
  6731     IF CNTL-NOT-FOUND
  6732         MOVE -1                 TO  HLCANCL
  6733         MOVE AL-SANON           TO  HLCANCA
  6734         MOVE ER-2616            TO  EMI-ERROR
  6735         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6736         GO TO 8100-SEND-INITIAL-MAP.
  6737
  6738     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6739       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6740         MOVE CF-LIFE-OVERRIDE-L1
  6741                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6742         MOVE CF-LIFE-OVERRIDE-L2
  6743                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6744         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6745         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6746         MOVE CF-CR-REM-TERM-CALC
  6747                                 TO  WS-CF-CR-REM-TERM-CALC
  6748         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6749         IF CF-DEFAULT-APR NUMERIC
  6750             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6751             GO TO 0525-GET-LF-BENEFIT
  6752         ELSE
  6753             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6754             GO TO 0525-GET-LF-BENEFIT.
  6755
  6756     MOVE -1                     TO  HLCANCL.
  6757     MOVE AL-SANON               TO  HLCANCA.
  6758     MOVE ER-2616                TO  EMI-ERROR.
  6759
  6760     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6761
  6762     GO TO 8100-SEND-INITIAL-MAP.
  6763
  6764 0525-GET-LF-BENEFIT.
  6765
  6766     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6767        GO TO 0527-GET-AH-BENEFIT
  6768     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 125
* EL1278.cbl
  6769
  6770     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6771     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6772                                     HLCDO.
  6773     MOVE WS-CF-LIFE-OVERRIDE-L2
  6774                                 TO  HLKINDO.
  6775
  6776     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6777
  6778     IF BENEFIT-FOUND
  6779         NEXT SENTENCE
  6780     ELSE
  6781         MOVE -1                 TO  HLCDL
  6782         MOVE AL-SANON           TO  HLCDA
  6783         MOVE ER-0028            TO  EMI-ERROR
  6784         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6785         GO TO 8100-SEND-INITIAL-MAP.
  6786
  6787     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6788         MOVE AL-UNNOF           TO  HLTERMA.
  6789
  6790*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6791     MOVE WS-KIND                TO WS-LF-KIND
  6792     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6793                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6794
  6795     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6796         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6797                                 TO  WS-LF-CO-REM-TERM-CALC.
  6798
  6799     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6800         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6801                                 TO  WS-LF-CO-EARNINGS-CALC
  6802                                     WS-LF-CO-REFUND-CALC.
  6803
  6804     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6805         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6806                                 TO  WS-LF-SPECIAL-CALC-CD.
  6807
  6808     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6809         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6810                                 TO  WS-LF-CO-REFUND-CALC.
  6811
  6812 0527-GET-AH-BENEFIT.
  6813
  6814     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6815        GO TO 0530-GET-STATE-RECORD
  6816     END-IF
  6817
  6818     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6819     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6820                                     HACDO.
  6821     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6822
  6823     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6824
  6825     IF BENEFIT-FOUND
  6826         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 126
* EL1278.cbl
  6827     ELSE
  6828         MOVE -1                 TO  HACDL
  6829         MOVE AL-SANON           TO  HACDA
  6830         MOVE ER-0028            TO  EMI-ERROR
  6831         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6832         GO TO 8100-SEND-INITIAL-MAP.
  6833
  6834     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6835         MOVE AL-UNNOF           TO  HATERMA.
  6836
  6837*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6838     MOVE WS-KIND                TO  WS-AH-KIND
  6839
  6840     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6841         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6842                                 TO  WS-AH-CO-REM-TERM-CALC.
  6843
  6844     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6845         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6846                                 TO  WS-AH-CO-EARNINGS-CALC
  6847                                     WS-AH-CO-REFUND-CALC.
  6848
  6849     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6850         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6851                                 TO  WS-AH-SPECIAL-CALC-CD.
  6852
  6853     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6854         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6855                                 TO  WS-AH-CO-REFUND-CALC.
  6856     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6857        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6858                                 TO WS-AH-BEN-CATEGORY
  6859     END-IF
  6860     .
  6861 0530-GET-STATE-RECORD.
  6862     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6863     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6864     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6865     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6866
  6867     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6868
  6869     IF CNTL-NOT-FOUND
  6870         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6871                                     WS-LF-ST-REM-TERM-CALC
  6872         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6873         GO TO 0560-FIND-ACCOUNT.
  6874
  6875     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6876       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6877       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6878         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6879     ELSE
  6880         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6881                                     WS-LF-ST-REM-TERM-CALC
  6882         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6883         GO TO 0560-FIND-ACCOUNT.
  6884
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 127
* EL1278.cbl
  6885     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6886     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6887
  6888     IF CM-LF-BENEFIT-CD  = '00'
  6889         GO TO 0550-GET-AH-BEN-IN-STATE.
  6890
  6891 0540-GET-LF-BEN-IN-STATE.
  6892     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6893     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6894
  6895     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6896     IF CF-ST-RT-CALC NOT = SPACES
  6897        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6898     END-IF
  6899
  6900     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6901        IF CF-ST-RF-LR-CALC > '0'
  6902           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6903        END-IF
  6904        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6905           IF CF-ST-RF-LN-CALC > '0'
  6906              MOVE CF-ST-RF-LN-CALC
  6907                                 TO WS-LF-ST-REFUND-CALC
  6908           END-IF
  6909        END-IF
  6910     ELSE
  6911        IF CF-ST-RF-LL-CALC > '0'
  6912           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6913        END-IF
  6914     END-IF
  6915
  6916     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6917
  6918     IF NO-BENEFIT-FOUND
  6919*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6920         GO TO 0550-GET-AH-BEN-IN-STATE.
  6921
  6922     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6923         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6924                                 TO  WS-LF-ST-REM-TERM-CALC.
  6925
  6926     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6927         MOVE CF-ST-REFUND-CALC (SUB3)
  6928                                 TO  WS-LF-ST-REFUND-CALC.
  6929
  6930 0550-GET-AH-BEN-IN-STATE.
  6931     IF CM-AH-BENEFIT-CD  = '00'
  6932         GO TO 0560-FIND-ACCOUNT.
  6933
  6934     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6935     IF CF-ST-RT-CALC NOT = SPACES
  6936        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6937     END-IF
  6938
  6939     IF CF-ST-RF-AH-CALC > '0'
  6940        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6941     END-IF
  6942     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 128
* EL1278.cbl
  6943        IF CF-ST-RF-CP-CALC > '0'
  6944           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6945        END-IF
  6946     END-IF
  6947
  6948     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6949     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6950
  6951     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6952
  6953     IF NO-BENEFIT-FOUND
  6954*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6955         GO TO 0560-FIND-ACCOUNT.
  6956
  6957     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6958         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6959                                 TO  WS-AH-ST-REM-TERM-CALC.
  6960
  6961     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6962         MOVE CF-ST-REFUND-CALC (SUB3)
  6963                                 TO  WS-AH-ST-REFUND-CALC.
  6964
  6965 0560-FIND-ACCOUNT.
  6966     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6967     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6968     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6969     MOVE CM-STATE               TO  WS-AM-STATE.
  6970     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6971     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6972     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6973
  6974     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6975
  6976     IF ACCT-FOUND
  6977         NEXT SENTENCE
  6978     ELSE
  6979         GO TO 0585-NO-ACCT.
  6980
  6981 0570-READ-NEXT-RANGE.
  6982     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6983
  6984     IF ACCT-FOUND
  6985         NEXT SENTENCE
  6986     ELSE
  6987         GO TO 0580-ACCT-NOT-FOUND.
  6988
  6989     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6990       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6991       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6992       AND CM-STATE  IS EQUAL TO  AM-STATE
  6993       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6994         NEXT SENTENCE
  6995     ELSE
  6996         GO TO 0580-ACCT-NOT-FOUND.
  6997
  6998     MOVE 'X'                    TO  DATE-RANGE-SW.
  6999
  7000     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 129
* EL1278.cbl
  7001         MOVE 'X'                TO  DATE-RANGE-SW
  7002         GO TO 0580-ACCT-NOT-FOUND.
  7003
  7004     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  7005         GO TO 0570-READ-NEXT-RANGE.
  7006
  7007     IF WS-BROWSE-STARTED-SW = 'Y'
  7008
  7009* EXEC CICS ENDBR
  7010*          DATASET    ('ERACCT')
  7011*       END-EXEC
  7012     MOVE 'ERACCT' TO DFHEIV1
  7013     MOVE 0
  7014       TO DFHEIV11
  7015*    MOVE '&2                    $   #00006880' TO DFHEIV0
  7016     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7017     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7018     MOVE X'2020233030303036383830' TO DFHEIV0(25:11)
  7019     CALL 'kxdfhei1' USING DFHEIV0,
  7020           DFHEIV1,
  7021           DFHEIV11,
  7022           DFHEIV99
  7023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7024        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  7025     END-IF
  7026     MOVE ' '                    TO  DATE-RANGE-SW.
  7027     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  7028
  7029     GO TO 0590-SET-ACCOUNT.
  7030
  7031 0580-ACCT-NOT-FOUND.
  7032     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  7033         MOVE ER-2601            TO  EMI-ERROR
  7034     ELSE
  7035         MOVE ER-2619            TO  EMI-ERROR.
  7036
  7037     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  7038
  7039     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7040
  7041 0585-NO-ACCT.
  7042     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  7043     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7044                                     WS-AM-EARN-METHOD-R
  7045                                     WS-AM-EARN-METHOD-A
  7046                                     WS-LF-AM-REM-TERM-CALC
  7047                                     WS-AH-AM-REM-TERM-CALC.
  7048
  7049     GO TO 0600-CHECK-FOR-LIFE.
  7050
  7051 0590-SET-ACCOUNT.
  7052******************************************************************
  7053******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  7054******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  7055******* METHODS.
  7056******************************************************************
  7057     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  7058     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 130
* EL1278.cbl
  7059     IF PI-COMPANY-ID EQUAL TO 'NCL'
  7060          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  7061                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  7062                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  7063                  IF FORM-FOUND
  7064                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  7065******************************************************************
  7066
  7067     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  7068     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7069                                     WS-AM-EARN-METHOD-R
  7070                                     WS-AM-EARN-METHOD-A.
  7071
  7072*    EVALUATE AM-EARN-METHOD-R
  7073*       WHEN 'R'
  7074*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  7075*       WHEN 'P'
  7076*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  7077*       WHEN 'C'
  7078*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  7079*       WHEN 'A'
  7080*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  7081*       WHEN 'M'
  7082*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  7083*       WHEN 'S'
  7084*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  7085*    END-EVALUATE.
  7086
  7087*    EVALUATE AM-EARN-METHOD-L
  7088*       WHEN 'R'
  7089*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  7090*       WHEN 'P'
  7091*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  7092*       WHEN 'C'
  7093*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  7094*       WHEN 'A'
  7095*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  7096*       WHEN 'M'
  7097*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  7098*       WHEN 'S'
  7099*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  7100*    END-EVALUATE.
  7101
  7102*    EVALUATE AM-EARN-METHOD-A
  7103*       WHEN 'R'
  7104*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  7105*       WHEN 'P'
  7106*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  7107*       WHEN 'C'
  7108*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  7109*       WHEN 'A'
  7110*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  7111*       WHEN 'M'
  7112*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  7113*       WHEN 'N'
  7114*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  7115*       WHEN 'S'
  7116*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 131
* EL1278.cbl
  7117*    END-EVALUATE.
  7118
  7119     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  7120                                     WS-TOT-LF-PREM
  7121                                     WS-TOT-AH-RFND
  7122                                     WS-TOT-LF-RFND.
  7123
  7124 0600-CHECK-FOR-LIFE.
  7125     IF CM-LF-BENEFIT-CD  = '00'
  7126         GO TO 0640-AH-BENEFIT.
  7127
  7128 0610-GET-LIFE-BENEFIT.
  7129
  7130     IF ACCT-FOUND
  7131         MOVE +1                 TO SUB3
  7132         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  7133     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7134     MOVE WS-LF-KIND             TO  HLEDESCO.
  7135     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7136     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7137        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7138                             + CM-LF-ALT-PREMIUM-AMT
  7139     ELSE
  7140        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7141     END-IF
  7142
  7143     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7144     EVALUATE TRUE
  7145        WHEN ((OPEN-LF-CLAIM)
  7146           OR (CLOSED-LF-CLAIM))
  7147           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7148           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  7149                                    WS-TOT-LF-RFND
  7150                                    PI-LF-REFUND-AMT
  7151           IF CM-AH-BENEFIT-CD NOT = '00'
  7152              MOVE ZEROS         TO HAREFNDO
  7153                                    WS-TOT-AH-RFND
  7154                                    PI-AH-REFUND-AMT
  7155              MOVE SPACES        TO PI-AH-REFUND-METH
  7156           END-IF
  7157           MOVE ER-2965          TO EMI-ERROR
  7158           PERFORM 9700-ERROR-FORMAT
  7159                                 THRU  9799-EXIT
  7160           GO TO 0640-AH-BENEFIT
  7161        WHEN OPEN-LF-CLAIM
  7162           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7163           AND WS-ST-REF-IND = '4'
  7164           MOVE ER-2966          TO EMI-ERROR
  7165           PERFORM 9700-ERROR-FORMAT
  7166                                 THRU  9799-EXIT
  7167        WHEN OPEN-LF-CLAIM
  7168           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7169           AND WS-ST-REF-IND NOT = '4'
  7170           MOVE ER-2967          TO EMI-ERROR
  7171           PERFORM 9700-ERROR-FORMAT
  7172                                 THRU  9799-EXIT
  7173           GO TO 0640-AH-BENEFIT
  7174        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 132
* EL1278.cbl
  7175           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7176           AND WS-ST-REF-IND = '4'
  7177           MOVE ER-2968          TO EMI-ERROR
  7178           PERFORM 9700-ERROR-FORMAT
  7179                                 THRU  9799-EXIT
  7180        WHEN CLOSED-LF-CLAIM
  7181           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7182           AND WS-ST-REF-IND NOT = '4'
  7183           MOVE ER-2969          TO EMI-ERROR
  7184           PERFORM 9700-ERROR-FORMAT
  7185                                 THRU  9799-EXIT
  7186           GO TO 0640-AH-BENEFIT
  7187        WHEN OTHER
  7188           CONTINUE
  7189     END-EVALUATE
  7190     .
  7191 0620-GET-REM-TERM.
  7192     MOVE WS-CF-LIFE-OVERRIDE-L1
  7193                                 TO  CP-LIFE-OVERRIDE-CODE.
  7194     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7195     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7196     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7197     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7198     MOVE CM-STATE               TO  CP-STATE.
  7199     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7200     MOVE WS-CF-LF-COVERAGE-TYPE
  7201                                 TO  CP-BENEFIT-TYPE.
  7202     MOVE WS-LF-KIND             TO  HLEDESCO.
  7203     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7204     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7205     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7206     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7207     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7208     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7209     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7210     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7211     MOVE WS-CF-CR-REM-TERM-CALC
  7212                                 TO  CP-REM-TERM-METHOD.
  7213
  7214     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7215         MOVE WS-LF-CO-REM-TERM-CALC
  7216                                 TO  CP-REM-TERM-METHOD.
  7217
  7218     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7219         MOVE WS-LF-ST-REM-TERM-CALC
  7220                                 TO  CP-REM-TERM-METHOD.
  7221
  7222     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7223         MOVE WS-LF-AM-REM-TERM-CALC
  7224                                 TO  CP-REM-TERM-METHOD.
  7225
  7226     IF (PI-COMPANY-ID = 'CID')
  7227        AND (CP-STATE-STD-ABBRV = 'WI')
  7228        MOVE '7'                 TO CP-REM-TERM-METHOD
  7229        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7230     END-IF
  7231     IF (PI-COMPANY-ID = 'CID')
  7232        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 133
* EL1278.cbl
  7233        AND (CM-CERT-EFF-DT >= X'9B41')
  7234        AND (CM-CERT-EFF-DT <= X'A2FB')
  7235        MOVE '7'                 TO CP-REM-TERM-METHOD
  7236        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7237     END-IF
  7238     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7239                                     CP-ORIGINAL-TERM
  7240                                     CP-LOAN-TERM.
  7241
  7242     IF CP-TRUNCATED-LIFE
  7243         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7244
  7245     IF CP-TERM-IS-DAYS
  7246         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7247             MOVE CM-LF-TERM-IN-DAYS
  7248                                 TO  CP-TERM-OR-EXT-DAYS
  7249         ELSE
  7250             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7251     ELSE
  7252         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7253             MOVE CM-PMT-EXTENSION-DAYS
  7254                                 TO  CP-TERM-OR-EXT-DAYS
  7255         ELSE
  7256             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7257
  7258*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7259     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7260     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7261     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7262     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7263
  7264
  7265* EXEC CICS READ
  7266*        DATASET  (ELCNTL-ID)
  7267*        SET      (ADDRESS OF CONTROL-FILE)
  7268*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7269*        RESP     (WS-RESPONSE)
  7270*    END-EXEC.
  7271*    MOVE '&"S        E          (  N#00007123' TO DFHEIV0
  7272     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7274     MOVE X'204E233030303037313233' TO DFHEIV0(25:11)
  7275     CALL 'kxdfhei1' USING DFHEIV0,
  7276           ELCNTL-ID,
  7277           DFHEIV20,
  7278           DFHEIV99,
  7279           WS-CF-CONTROL-PRIMARY,
  7280           DFHEIV99,
  7281           DFHEIV99,
  7282           DFHEIV99
  7283     SET ADDRESS OF CONTROL-FILE TO
  7284         DFHEIV20
  7285     MOVE EIBRESP  TO WS-RESPONSE
  7286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7287
  7288
  7289     IF WS-RESP-NOTOPEN
  7290         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 134
* EL1278.cbl
  7291         GO TO 0320-INPUT-ERROR.
  7292
  7293     IF WS-RESP-NOTFND
  7294         MOVE ZERO               TO  CP-FREE-LOOK
  7295     ELSE
  7296         MOVE CF-ST-FREE-LOOK-PERIOD
  7297                                 TO CP-FREE-LOOK.
  7298
  7299     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7300        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7301        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7302     END-IF
  7303
  7304     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7305
  7306     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7307        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7308        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7309        COMPUTE CP-REMAINING-TERM-1 =
  7310                CP-REMAINING-TERM-1 - +1
  7311        COMPUTE CP-REMAINING-TERM-2 =
  7312                CP-REMAINING-TERM-2 - +1
  7313     END-IF
  7314
  7315     IF CP-REMAINING-TERM-1 NEGATIVE
  7316        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7317     END-IF
  7318     IF CP-REMAINING-TERM-2 NEGATIVE
  7319        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7320     END-IF
  7321     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7322
  7323     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7324         GO TO 0640-AH-BENEFIT.
  7325*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7326*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7327
  7328     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7329         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7330             MOVE ER-0681        TO  EMI-ERROR
  7331             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7332
  7333     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7334         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7335             MOVE ER-0682        TO  EMI-ERROR
  7336             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7337
  7338 0630-CONTINUE-LIFE.
  7339
  7340     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7341        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7342        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7343                                    FREMTRMO
  7344     ELSE
  7345        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7346                                     FREMTRMO
  7347     END-IF
  7348     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 135
* EL1278.cbl
  7349     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7350     if pi-company-id = 'AHL'
  7351        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7352        if cp-class-code = spaces
  7353           move zeros            to cp-class-code
  7354        end-if
  7355     ELSE
  7356        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7357     END-IF
  7358     IF (PI-COMPANY-ID = 'DCC')
  7359        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7360        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7361        PERFORM 0730-GET-DDF-FACTORS
  7362                                 THRU 0730-EXIT
  7363        IF PDEF-FOUND
  7364           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7365              (P1 > +8)
  7366              OR (PD-PROD-CODE (P1) = 'L')
  7367           END-PERFORM
  7368           IF P1 < +9
  7369              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7370           END-IF
  7371        END-IF
  7372     END-IF
  7373     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7374
  7375     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7376
  7377     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7378        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7379                             + CM-LF-ALT-PREMIUM-AMT
  7380     ELSE
  7381        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7382     END-IF
  7383
  7384     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7385                                     WS-TOT-LF-PREM.
  7386
  7387     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7388        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7389        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7390     ELSE
  7391        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7392     END-IF
  7393
  7394     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7395     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7396
  7397     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7398         MOVE WS-LF-ST-REFUND-CALC
  7399                                 TO  CP-EARNING-METHOD.
  7400
  7401     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7402         MOVE WS-LF-FO-REFUND-CALC
  7403                                 TO  CP-EARNING-METHOD.
  7404
  7405     if (pi-company-id = 'CID')
  7406        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 136
* EL1278.cbl
  7407        continue
  7408     else
  7409        IF CP-RATING-METHOD = '4'
  7410           MOVE '4'              TO CP-EARNING-METHOD
  7411        END-IF
  7412     end-if
  7413*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7414*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7415*            MOVE WS-AM-EARN-METHOD-R
  7416*                                TO  CP-EARNING-METHOD
  7417*        END-IF
  7418*    ELSE
  7419*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7420*            MOVE WS-AM-EARN-METHOD-L
  7421*                                TO  CP-EARNING-METHOD.
  7422
  7423     if pi-company-id = 'AHL'
  7424        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7425        if cp-class-code = spaces
  7426           move zeros            to cp-class-code
  7427        end-if
  7428     ELSE
  7429        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7430     END-IF
  7431     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7432     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7433                                     CP-RATING-BENEFIT-AMT.
  7434     IF CP-STATE-STD-ABBRV = 'OR'
  7435         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7436                                         CM-LF-ALT-BENEFIT-AMT.
  7437****   N O T E   ****
  7438*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7439*      THE OH HARD CODING IN ELCRFNDP
  7440
  7441     IF PI-COMPANY-ID = 'CID'
  7442        IF CP-STATE-STD-ABBRV = 'OH'
  7443           MOVE WS-LF-CO-EARNINGS-CALC
  7444                                 TO CP-EARNING-METHOD
  7445        END-IF
  7446     END-IF
  7447
  7448****   N O T E   ****
  7449
  7450****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7451****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7452****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7453****     THE APPROPRIATE OPTIONS HERE
  7454*    IF PI-COMPANY-ID = 'CID'
  7455*       IF (CP-STATE-STD-ABBRV = 'MN')
  7456*          AND (CM-CERT-EFF-DT > X'A4FF')
  7457*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7458*          MOVE '5'              TO CP-EARNING-METHOD
  7459*       END-IF
  7460*    END-IF
  7461     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7462     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7463     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7464     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 137
* EL1278.cbl
  7465     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7466     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7467
  7468*    IF CP-EARN-AS-NET-PAY
  7469*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7470*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7471*               MOVE WS-CF-DEFAULT-APR
  7472*                                TO  CP-LOAN-APR
  7473*               MOVE ER-3780     TO  EMI-ERROR
  7474*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7475*           ELSE
  7476*               MOVE ER-3781     TO  EMI-ERROR
  7477*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7478
  7479*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7480*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7481*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7482*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7483*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7484*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7485*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7486*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7487*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7488*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7489*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7490*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7491*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7492*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7493*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7494*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7495*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7496*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7497     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7498
  7499     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7500
  7501     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7502
  7503     IF CP-ERROR-RATE-IS-ZERO
  7504       OR CP-ERROR-RATE-NOT-FOUND
  7505         MOVE ER-2740            TO  EMI-ERROR
  7506         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7507
  7508     IF CP-ERROR-RATE-FILE-NOTOPEN
  7509         MOVE ER-2617            TO  EMI-ERROR
  7510         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7511
  7512     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7513     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7514                                     WS-TOT-LF-RFND
  7515                                     PI-LF-REFUND-AMT.
  7516     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7517
  7518     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7519     move cm-life-comm-pct       to hlcpcto
  7520     compute hlcamto rounded =
  7521        cp-calc-refund * cm-life-comm-pct
  7522     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 138
* EL1278.cbl
  7523         GO TO 0640-AH-BENEFIT.
  7524
  7525*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7526*        ADD +1                  TO  CP-REMAINING-TERM
  7527*                                    CP-ORIGINAL-TERM.
  7528
  7529     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7530     MOVE '2'                    TO  CP-EARNING-METHOD
  7531                                     CP-RATING-METHOD.
  7532     IF PI-COMPANY-ID = 'CID'
  7533        IF (CP-STATE-STD-ABBRV = 'MN')
  7534           AND (CM-CERT-EFF-DT > X'A4FF')
  7535           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7536           MOVE '5'              TO CP-EARNING-METHOD
  7537           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7538        END-IF
  7539     END-IF
  7540     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7541                                     CP-REMAINING-BENEFIT
  7542                                     CP-RATING-BENEFIT-AMT.
  7543     IF CP-STATE-STD-ABBRV = 'OR'
  7544         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7545                                         CM-LF-ALT-BENEFIT-AMT.
  7546     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7547     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7548
  7549     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7550
  7551     IF CP-ERROR-RATE-IS-ZERO
  7552       OR CP-ERROR-RATE-NOT-FOUND
  7553         MOVE ER-2740            TO  EMI-ERROR
  7554         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7555
  7556     IF CP-ERROR-RATE-FILE-NOTOPEN
  7557         MOVE ER-2617            TO  EMI-ERROR
  7558         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7559
  7560     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7561
  7562     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7563                                     WS-TOT-LF-RFND
  7564                                     PI-LF-REFUND-AMT.
  7565
  7566     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7567
  7568 0640-AH-BENEFIT.
  7569     IF CM-AH-BENEFIT-CD = '00'
  7570         GO TO 0680-CONTINUE.
  7571
  7572 0650-GET-AH-BENEFIT.
  7573     IF ACCT-FOUND
  7574         MOVE +1                 TO SUB3
  7575         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7576     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7577     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7578     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7579     MOVE WS-AH-KIND             TO  HAEDESCO.
  7580     EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 139
* EL1278.cbl
  7581        WHEN ((OPEN-LF-CLAIM)
  7582           OR (CLOSED-LF-CLAIM))
  7583           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7584           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7585                                    WS-TOT-AH-RFND
  7586                                    PI-AH-REFUND-AMT
  7587           MOVE SPACES           TO PI-AH-REFUND-METH
  7588           MOVE ER-2965          TO EMI-ERROR
  7589           PERFORM 9700-ERROR-FORMAT
  7590                                 THRU  9799-EXIT
  7591           GO TO 0680-CONTINUE
  7592        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7593           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7594           AND (EMI-ERROR = ER-2965)
  7595           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7596           MOVE ZEROS            TO HAREFNDO
  7597                                    WS-TOT-AH-RFND
  7598                                    PI-AH-REFUND-AMT
  7599           MOVE SPACES           TO PI-AH-REFUND-METH
  7600           GO TO 0680-CONTINUE
  7601        WHEN (OPEN-AH-CLAIM)
  7602           AND (WS-ST-REF-IND = '1')
  7603           MOVE ZEROS            TO HAREFNDO
  7604                                    WS-TOT-AH-RFND
  7605                                    PI-AH-REFUND-AMT
  7606           MOVE ER-3039          TO EMI-ERROR
  7607           PERFORM 9700-ERROR-FORMAT
  7608                                 THRU  9799-EXIT
  7609           GO TO 0680-CONTINUE
  7610        WHEN (OPEN-AH-CLAIM)
  7611           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7612           MOVE ER-3037          TO EMI-ERROR
  7613           PERFORM 9700-ERROR-FORMAT
  7614                                 THRU  9799-EXIT
  7615*          CONTINUE
  7616        WHEN (OPEN-AH-CLAIM)
  7617           AND (WS-ST-REF-IND = '5')
  7618           MOVE ER-3038          TO EMI-ERROR
  7619           PERFORM 9700-ERROR-FORMAT
  7620                                 THRU  9799-EXIT
  7621*          CONTINUE
  7622        WHEN (OPEN-AH-CLAIM)
  7623           AND (WS-ST-REF-IND = ' ')
  7624           MOVE ER-2768          TO EMI-ERROR
  7625           PERFORM 9700-ERROR-FORMAT
  7626                                 THRU  9799-EXIT
  7627        WHEN (CLOSED-AH-CLAIM)
  7628           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7629           MOVE ZEROS            TO HAREFNDO
  7630                                    WS-TOT-AH-RFND
  7631                                    PI-AH-REFUND-AMT
  7632           MOVE ER-2756          TO EMI-ERROR
  7633           PERFORM 9700-ERROR-FORMAT
  7634                                 THRU  9799-EXIT
  7635           IF WS-TOT-LF-RFND > 0
  7636              MOVE ZEROS         TO HLREFNDO
  7637                                    WS-TOT-LF-RFND
  7638                                    PI-LF-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 140
* EL1278.cbl
  7639              MOVE SPACES        TO PI-LF-REFUND-METH
  7640           END-IF
  7641           GO TO 0680-CONTINUE
  7642*       WHEN OTHER
  7643*          CONTINUE
  7644     END-EVALUATE
  7645     .
  7646 0660-GET-REM-TERM.
  7647     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7648     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7649     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7650     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7651     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7652*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7653     MOVE WS-AH-KIND             TO  HAEDESCO.
  7654     MOVE CM-STATE               TO  CP-STATE.
  7655     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7656     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7657     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7658     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7659     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7660     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7661     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7662     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7663     MOVE WS-CF-CR-REM-TERM-CALC
  7664                                 TO  CP-REM-TERM-METHOD.
  7665
  7666     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7667         MOVE WS-AH-CO-REM-TERM-CALC
  7668                                 TO  CP-REM-TERM-METHOD.
  7669
  7670     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7671         MOVE WS-AH-ST-REM-TERM-CALC
  7672                                 TO  CP-REM-TERM-METHOD.
  7673
  7674     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7675         MOVE WS-AH-AM-REM-TERM-CALC
  7676                                 TO  CP-REM-TERM-METHOD.
  7677     IF (PI-COMPANY-ID = 'CID')
  7678        AND (CP-STATE-STD-ABBRV = 'WI')
  7679        MOVE '7'                 TO CP-REM-TERM-METHOD
  7680        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7681     END-IF
  7682     IF (PI-COMPANY-ID = 'CID')
  7683        AND (CP-STATE-STD-ABBRV = 'MO')
  7684        AND (CM-CERT-EFF-DT >= X'9B41')
  7685        AND (CM-CERT-EFF-DT <= X'A2FB')
  7686        MOVE '7'                 TO CP-REM-TERM-METHOD
  7687        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7688     END-IF
  7689
  7690     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7691                                     CP-ORIGINAL-TERM
  7692                                     CP-LOAN-TERM.
  7693
  7694     IF  NOT  CP-TERM-IS-DAYS
  7695         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7696             MOVE CM-PMT-EXTENSION-DAYS
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 141
* EL1278.cbl
  7697                                 TO  CP-TERM-OR-EXT-DAYS
  7698         ELSE
  7699             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7700
  7701*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7702     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7703     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7704     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7705     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7706
  7707
  7708* EXEC CICS READ
  7709*        DATASET  (ELCNTL-ID)
  7710*        SET      (ADDRESS OF CONTROL-FILE)
  7711*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7712*        RESP     (WS-RESPONSE)
  7713*    END-EXEC.
  7714*    MOVE '&"S        E          (  N#00007548' TO DFHEIV0
  7715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7717     MOVE X'204E233030303037353438' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0,
  7719           ELCNTL-ID,
  7720           DFHEIV20,
  7721           DFHEIV99,
  7722           WS-CF-CONTROL-PRIMARY,
  7723           DFHEIV99,
  7724           DFHEIV99,
  7725           DFHEIV99
  7726     SET ADDRESS OF CONTROL-FILE TO
  7727         DFHEIV20
  7728     MOVE EIBRESP  TO WS-RESPONSE
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732     IF WS-RESP-NOTOPEN
  7733         MOVE ER-2617            TO  EMI-ERROR
  7734         GO TO 0320-INPUT-ERROR.
  7735
  7736     IF WS-RESP-NOTFND
  7737         MOVE ZERO               TO CP-FREE-LOOK
  7738     ELSE
  7739         MOVE CF-ST-FREE-LOOK-PERIOD
  7740                                 TO CP-FREE-LOOK.
  7741
  7742     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7743
  7744     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7745
  7746     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7747         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7748             MOVE ER-0683        TO  EMI-ERROR
  7749             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7750
  7751     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7752         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7753             MOVE ER-0684        TO  EMI-ERROR
  7754             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 142
* EL1278.cbl
  7755
  7756 0670-CONTINUE-AH.
  7757     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7758                                     WS-TOT-AH-PREM
  7759     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7760
  7761     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7762         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7763
  7764     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7765        GO TO 0680-CONTINUE.
  7766     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7767     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7768     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7769
  7770     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7771         MOVE WS-AH-ST-REFUND-CALC
  7772                                 TO  CP-EARNING-METHOD.
  7773
  7774     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7775         MOVE WS-AH-FO-REFUND-CALC
  7776                                 TO  CP-EARNING-METHOD.
  7777
  7778*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7779*        MOVE WS-AM-EARN-METHOD-A
  7780*                                TO  CP-EARNING-METHOD.
  7781
  7782     if pi-company-id = 'AHL'
  7783        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7784        if cp-class-code = spaces
  7785           move zeros            to cp-class-code
  7786        end-if
  7787     ELSE
  7788        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7789     END-IF
  7790     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7791     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7792                                     CP-RATING-BENEFIT-AMT.
  7793     IF CP-STATE-STD-ABBRV = 'OR'
  7794         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7795                                         CM-AH-ORIG-TERM.
  7796     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7797     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7798     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7799     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7800     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7801     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7802
  7803     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7804     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7805     MOVE ' '                    TO  DC-OPTION-CODE.
  7806
  7807     PERFORM 9600-DATE-LINK.
  7808
  7809     IF CP-STATE-STD-ABBRV = 'OH'
  7810        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7811         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7812           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 143
* EL1278.cbl
  7813           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7814             MOVE '6'            TO  CP-EARNING-METHOD
  7815         END-IF
  7816        END-IF
  7817        IF PI-COMPANY-ID = 'CID'
  7818           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7819                           LOW-VALUES)
  7820              IF CP-CRITICAL-PERIOD
  7821                 MOVE '2'       TO CP-EARNING-METHOD
  7822              ELSE
  7823                 MOVE '6'       TO CP-EARNING-METHOD
  7824              END-IF
  7825           ELSE
  7826              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7827                 MOVE '2'       TO CP-EARNING-METHOD
  7828              ELSE
  7829                 IF ((CM-LF-ORIG-TERM > 60) AND
  7830                    (CM-RATE-CLASS NOT = 'L '))
  7831                               OR
  7832                    (WS-LF-CO-EARNINGS-CALC = '5')
  7833                    IF CP-CRITICAL-PERIOD
  7834                       MOVE '2'  TO CP-EARNING-METHOD
  7835                    ELSE
  7836                       MOVE '6'  TO CP-EARNING-METHOD
  7837                    END-IF
  7838                 ELSE
  7839                    MOVE '1'     TO CP-EARNING-METHOD
  7840                 END-IF
  7841              END-IF
  7842           END-IF
  7843        END-IF
  7844     END-IF
  7845
  7846     IF CP-STATE-STD-ABBRV = 'VA'
  7847       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7848         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7849            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7850                MOVE '6'            TO  CP-EARNING-METHOD
  7851            ELSE
  7852                MOVE '1'            TO  CP-EARNING-METHOD.
  7853
  7854     IF CP-EARN-AS-NET-PAY
  7855         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7856            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7857                MOVE WS-CF-DEFAULT-APR
  7858                                 TO  CP-LOAN-APR
  7859                MOVE ER-3780     TO  EMI-ERROR
  7860                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7861            ELSE
  7862                MOVE ER-3781     TO  EMI-ERROR
  7863                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7864     IF PI-COMPANY-ID = 'DCC'
  7865        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7866           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7867           MOVE 'S'              TO CP-EARNING-METHOD
  7868        END-IF
  7869     END-IF
  7870     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 144
* EL1278.cbl
  7871     IF (PI-COMPANY-ID = 'DCC')
  7872        AND (CP-EARNING-METHOD = 'D')
  7873        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7874                                    WS-DDF-CSO-ADMIN-FEE
  7875                                    WS-DDF-1ST-YR-TOT-EXP
  7876                                    WS-DDF-COMM-AND-MFEE
  7877        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7878           S1 > +10
  7879           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7880              IF (AM-A-COM (S1) NUMERIC)
  7881                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7882                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7883              ELSE
  7884                 MOVE +0         TO WS-COMM-PCT C0
  7885                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7886                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7887              END-IF
  7888              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7889                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7890                    + WS-COMM-PCT
  7891              END-IF
  7892              IF AM-COM-TYP (S1) = 'N'
  7893                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7894                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7895              END-IF
  7896              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7897                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7898                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7899              END-IF
  7900              IF AM-COM-TYP (S1) = 'I'
  7901                 COMPUTE WS-DDF-COMM-AND-MFEE
  7902                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7903              END-IF
  7904           END-IF
  7905        END-PERFORM
  7906        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7907        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7908        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7909           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7910     END-IF
  7911     IF (PI-COMPANY-ID = 'DCC')
  7912        AND (CP-EARNING-METHOD = 'D')
  7913        AND (PI-CANCEL-REASON NOT = 'R')
  7914        PERFORM 0730-GET-DDF-FACTORS
  7915                                 THRU 0730-EXIT
  7916        IF NOT PDEF-FOUND
  7917           MOVE ER-9999          TO EMI-ERROR
  7918           PERFORM 9700-ERROR-FORMAT
  7919                                 THRU 9799-EXIT
  7920           GO TO 8200-SEND-DATAONLY
  7921        END-IF
  7922        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7923                                 TO CP-DDF-LO-FACT
  7924        MOVE PD-UEP-FACTOR (P1 P2)
  7925                                 TO CP-DDF-HI-FACT
  7926        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7927        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7928        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 145
* EL1278.cbl
  7929        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7930           + PD-1ST-YR-ADMIN-ALLOW
  7931        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7932        IF PI-CLP-YN = 'Y'
  7933           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7934           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7935                                    CP-DDF-CLP
  7936           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7937        END-IF
  7938        IF DD-IU-PRESENT
  7939           MOVE 'I'              TO CP-EARNING-METHOD
  7940        END-IF
  7941        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7942                                    CP-CLP-RATE-UP
  7943        IF (CP-CALC-GROSS-FEE)
  7944           AND (CP-IU-RATE-UP NOT = ZEROS)
  7945           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7946              / CP-ORIGINAL-PREMIUM)
  7947           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7948              / (1 - TEX-FACT-8)
  7949        END-IF
  7950     END-IF
  7951     if pi-company-id = 'VPP'
  7952        IF PI-CLP-YN = 'Y'
  7953           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7954                                    hapremo
  7955                                    CP-DDF-CLP
  7956        END-IF
  7957     end-if
  7958     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7959
  7960     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7961
  7962     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7963
  7964     IF CP-ERROR-RATE-IS-ZERO
  7965       OR CP-ERROR-RATE-NOT-FOUND
  7966         MOVE ER-2740            TO  EMI-ERROR
  7967         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7968
  7969     IF CP-ERROR-RATE-FILE-NOTOPEN
  7970         MOVE ER-2617            TO  EMI-ERROR
  7971         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7972
  7973     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7974     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7975                                     WS-TOT-AH-RFND
  7976                                     PI-AH-REFUND-AMT.
  7977     move cm-ah-comm-pct         to hacpcto
  7978     compute hacamto rounded =
  7979        cp-calc-refund * cm-ah-comm-pct
  7980     if pi-company-id = 'VPP'
  7981        if cp-calc-refund < cm-cancel-fee
  7982           move cp-calc-refund   to cm-cancel-fee
  7983        end-if
  7984        if cp-calc-refund = cm-ah-premium-amt
  7985           move zeros            to cm-cancel-fee
  7986        end-if
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 146
* EL1278.cbl
  7987        move cm-cancel-fee       to canfeeo
  7988        compute refdueo =
  7989           cp-calc-refund - cm-cancel-fee
  7990     end-if
  7991
  7992     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7993
  7994     MOVE AL-UANON               TO  HACANCA.
  7995
  7996 0680-CONTINUE.
  7997     IF BROWSE-STARTED
  7998         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7999         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  8000
  8001     IF CM-LF-BENEFIT-CD = '00'
  8002         MOVE -1                 TO  HACANCL
  8003     ELSE
  8004         MOVE -1                 TO  HLCANCL.
  8005
  8006     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  8007                           WS-TOT-PREM.
  8008     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  8009                           WS-TOT-RFND.
  8010
  8011     MOVE WS-TOT-PREM            TO  TOPREMO.
  8012     MOVE WS-TOT-RFND            TO  TORFNDO.
  8013
  8014 0680-EXIT.
  8015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 147
* EL1278.cbl
  8017 0700-LINK-REM-TERM SECTION.
  8018
  8019* EXEC CICS LINK
  8020*        PROGRAM   (ELRTRM-ID)
  8021*        COMMAREA  (CALCULATION-PASS-AREA)
  8022*        LENGTH    (CP-COMM-LENGTH)
  8023*    END-EXEC.
  8024*    MOVE '."C                   (   #00007841' TO DFHEIV0
  8025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8027     MOVE X'2020233030303037383431' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0,
  8029           ELRTRM-ID,
  8030           CALCULATION-PASS-AREA,
  8031           CP-COMM-LENGTH,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99,
  8035           DFHEIV99
  8036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8037
  8038
  8039 0700-EXIT.
  8040     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 148
* EL1278.cbl
  8042 0710-LINK-REM-AMOUNT SECTION.
  8043
  8044* EXEC CICS LINK
  8045*        PROGRAM   (ELRAMT-ID)
  8046*        COMMAREA  (CALCULATION-PASS-AREA)
  8047*        LENGTH    (CP-COMM-LENGTH)
  8048*    END-EXEC.
  8049*    MOVE '."C                   (   #00007851' TO DFHEIV0
  8050     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8052     MOVE X'2020233030303037383531' TO DFHEIV0(25:11)
  8053     CALL 'kxdfhei1' USING DFHEIV0,
  8054           ELRAMT-ID,
  8055           CALCULATION-PASS-AREA,
  8056           CP-COMM-LENGTH,
  8057           DFHEIV99,
  8058           DFHEIV99,
  8059           DFHEIV99,
  8060           DFHEIV99
  8061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8062
  8063
  8064 0710-EXIT.
  8065     EXIT.
  8066 0730-GET-DDF-FACTORS.
  8067     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8068     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8069     MOVE CM-STATE               TO ERPDEF-STATE
  8070     if cm-clp-state <> cm-state and spaces
  8071                  and low-values and zeros
  8072        move cm-clp-state        to erpdef-state
  8073     end-if
  8074     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8075     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8076     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8077     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8078     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8079
  8080* EXEC CICS STARTBR
  8081*        DATASET  ('ERPDEF')
  8082*        RIDFLD   (ERPDEF-KEY)
  8083*        GTEQ
  8084*        RESP     (WS-RESPONSE)
  8085*    END-EXEC
  8086     MOVE 'ERPDEF' TO DFHEIV1
  8087     MOVE 0
  8088       TO DFHEIV11
  8089*    MOVE '&,         G          &  N#00007872' TO DFHEIV0
  8090     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8092     MOVE X'204E233030303037383732' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0,
  8094           DFHEIV1,
  8095           ERPDEF-KEY,
  8096           DFHEIV99,
  8097           DFHEIV11,
  8098           DFHEIV99
  8099     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 149
* EL1278.cbl
  8100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8101     IF NOT WS-RESP-NORMAL
  8102        GO TO 0730-EXIT
  8103     END-IF
  8104     .
  8105 0730-READNEXT.
  8106
  8107* EXEC CICS READNEXT
  8108*       DATASET  ('ERPDEF')
  8109*       SET      (ADDRESS OF PRODUCT-MASTER)
  8110*       RIDFLD   (ERPDEF-KEY)
  8111*       RESP     (WS-RESPONSE)
  8112*    END-EXEC
  8113     MOVE 'ERPDEF' TO DFHEIV1
  8114     MOVE 0
  8115       TO DFHEIV11
  8116*    MOVE '&.S                   )  N#00007883' TO DFHEIV0
  8117     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8118     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8119     MOVE X'204E233030303037383833' TO DFHEIV0(25:11)
  8120     CALL 'kxdfhei1' USING DFHEIV0,
  8121           DFHEIV1,
  8122           DFHEIV20,
  8123           DFHEIV99,
  8124           ERPDEF-KEY,
  8125           DFHEIV99,
  8126           DFHEIV11,
  8127           DFHEIV99,
  8128           DFHEIV99
  8129     SET ADDRESS OF PRODUCT-MASTER TO
  8130         DFHEIV20
  8131     MOVE EIBRESP  TO WS-RESPONSE
  8132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8133     IF NOT WS-RESP-NORMAL
  8134        GO TO 0730-ENDBR
  8135     END-IF
  8136     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8137        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8138           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8139        ELSE
  8140           GO TO 0730-READNEXT
  8141        END-IF
  8142     ELSE
  8143        GO TO 0730-ENDBR
  8144     END-IF
  8145     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8146        (P1 > +8)
  8147        OR (PD-PROD-CODE (P1) = 'I')
  8148     END-PERFORM
  8149     IF P1 < +9
  8150        SET DD-IU-PRESENT        TO TRUE
  8151     END-IF
  8152     IF CM-LOAN-TERM = ZEROS
  8153        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  8154     END-IF
  8155     IF PD-TRUNCATED = 'Y'
  8156        MOVE CM-LOAN-TERM        TO WS-TERM
  8157     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 150
* EL1278.cbl
  8158        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  8159     END-IF
  8160     EVALUATE TRUE
  8161        WHEN WS-TERM > +168
  8162           MOVE 15               TO P1
  8163        WHEN WS-TERM > +156
  8164           MOVE 14               TO P1
  8165        WHEN WS-TERM > +144
  8166           MOVE 13               TO P1
  8167        WHEN WS-TERM > +132
  8168           MOVE 12               TO P1
  8169        WHEN WS-TERM > +120
  8170           MOVE 11               TO P1
  8171        WHEN WS-TERM > +108
  8172           MOVE 10               TO P1
  8173        WHEN WS-TERM > +96
  8174           MOVE 9                TO P1
  8175        WHEN WS-TERM > +84
  8176           MOVE 8                TO P1
  8177        WHEN WS-TERM > +72
  8178           MOVE 7                TO P1
  8179        WHEN WS-TERM > +60
  8180           MOVE 6                TO P1
  8181        WHEN WS-TERM > +48
  8182           MOVE 5                TO P1
  8183        WHEN WS-TERM > +36
  8184           MOVE 4                TO P1
  8185        WHEN WS-TERM > +24
  8186           MOVE 3                TO P1
  8187        WHEN WS-TERM > +12
  8188           MOVE 2                TO P1
  8189        WHEN OTHER
  8190           MOVE 1                TO P1
  8191     END-EVALUATE
  8192     EVALUATE TRUE
  8193*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8194*          AND (DD-IU-PRESENT)
  8195*          MOVE 2                TO P2
  8196*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8197*          MOVE 1                TO P2
  8198        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8199           MOVE 2                TO P2
  8200        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8201           MOVE 3                TO P2
  8202        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8203           MOVE 4                TO P2
  8204        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8205           MOVE 5                TO P2
  8206        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8207           MOVE 6                TO P2
  8208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8209           MOVE 7                TO P2
  8210        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8211           MOVE 8                TO P2
  8212        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8213           MOVE 9                TO P2
  8214        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8215           MOVE 10               TO P2
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 151
* EL1278.cbl
  8216        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8217           MOVE 11               TO P2
  8218        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8219           MOVE 12               TO P2
  8220        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8221           MOVE 13               TO P2
  8222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8223           MOVE 14               TO P2
  8224        WHEN OTHER
  8225           MOVE 15               TO P2
  8226     END-EVALUATE
  8227     .
  8228 0730-ENDBR.
  8229
  8230* EXEC CICS ENDBR
  8231*       DATASET  ('ERPDEF')
  8232*    END-EXEC
  8233     MOVE 'ERPDEF' TO DFHEIV1
  8234     MOVE 0
  8235       TO DFHEIV11
  8236*    MOVE '&2                    $   #00007985' TO DFHEIV0
  8237     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8239     MOVE X'2020233030303037393835' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
  8241           DFHEIV1,
  8242           DFHEIV11,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8245     .
  8246 0730-EXIT.
  8247     EXIT.
  8248 0740-GET-ERCTBL.
  8249     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8250     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8251     MOVE 'A'                    TO CTBL-BEN-TYPE
  8252     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8253     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8254     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8255     IF WS-RESP-NORMAL
  8256        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8257     ELSE
  8258        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8259        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8260        MOVE 'A'                    TO CTBL-BEN-TYPE
  8261        MOVE 'AA'                   TO CTBL-BEN-CODE
  8262        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8263        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8264        IF WS-RESP-NORMAL
  8265           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8266        END-IF
  8267     END-IF
  8268     .
  8269 0740-EXIT.
  8270     EXIT.
  8271 0750-READ-ERCTBL.
  8272
  8273* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 152
* EL1278.cbl
  8274*         INTO    (COMM-TABLE-RECORD)
  8275*         DATASET ('ERCTBL')
  8276*         RIDFLD  (CTBL-KEY)
  8277*         RESP    (WS-RESPONSE)
  8278*    END-EXEC
  8279     MOVE LENGTH OF
  8280      COMM-TABLE-RECORD
  8281       TO DFHEIV11
  8282     MOVE 'ERCTBL' TO DFHEIV1
  8283*    MOVE '&"IL       E          (  N#00008015' TO DFHEIV0
  8284     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8286     MOVE X'204E233030303038303135' TO DFHEIV0(25:11)
  8287     CALL 'kxdfhei1' USING DFHEIV0,
  8288           DFHEIV1,
  8289           COMM-TABLE-RECORD,
  8290           DFHEIV11,
  8291           CTBL-KEY,
  8292           DFHEIV99,
  8293           DFHEIV99,
  8294           DFHEIV99
  8295     MOVE EIBRESP  TO WS-RESPONSE
  8296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8297     .
  8298 0750-EXIT.
  8299     EXIT.
  8300 0760-FIND-COMM.
  8301     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8302        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8303        OR (C1 > +3)
  8304     END-PERFORM
  8305     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8306        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8307        OR (C2 > +3)
  8308     END-PERFORM
  8309     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8310        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8311        OR (C3 > +3)
  8312     END-PERFORM
  8313     IF C1 > +3
  8314        MOVE +1                  TO C1
  8315     END-IF
  8316     IF C2 > +3
  8317        MOVE +1                  TO C2
  8318     END-IF
  8319     IF C3 > +3
  8320        MOVE +1                  TO C3
  8321     END-IF
  8322     IF C1 = +3
  8323        MOVE +18                 TO C0
  8324     ELSE
  8325        IF C1 = +2
  8326           MOVE +9               TO C0
  8327        END-IF
  8328     END-IF
  8329     IF C2 = +3
  8330        ADD +6                   TO C0
  8331     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 153
* EL1278.cbl
  8332        IF C2 = +2
  8333           ADD +3                TO C0
  8334        END-IF
  8335     END-IF
  8336     ADD C3                      TO C0
  8337     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8338     .
  8339 0760-EXIT.
  8340     EXIT.
  8341 0800-LINK-REFUND SECTION.
  8342     IF CP-AH
  8343       IF PI-EARNING-METHOD-AH NOT = SPACES
  8344         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8345        ELSE
  8346         NEXT SENTENCE
  8347      ELSE
  8348       IF PI-EARNING-METHOD-LF NOT = SPACES
  8349         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8350
  8351
  8352* EXEC CICS LINK
  8353*        PROGRAM   (ELRFND-ID)
  8354*        COMMAREA  (CALCULATION-PASS-AREA)
  8355*        LENGTH    (CP-COMM-LENGTH)
  8356*    END-EXEC.
  8357*    MOVE '."C                   (   #00008075' TO DFHEIV0
  8358     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303038303735' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           ELRFND-ID,
  8363           CALCULATION-PASS-AREA,
  8364           CP-COMM-LENGTH,
  8365           DFHEIV99,
  8366           DFHEIV99,
  8367           DFHEIV99,
  8368           DFHEIV99
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372 0899-EXIT.
  8373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 154
* EL1278.cbl
  8375 0900-READ-CERT-FILE  SECTION.
  8376
  8377* EXEC CICS HANDLE CONDITION
  8378*        NOTFND  (0910-NOT-FOUND)
  8379*    END-EXEC.
  8380*    MOVE '"$I                   ! # #00008085' TO DFHEIV0
  8381     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8383     MOVE X'2320233030303038303835' TO DFHEIV0(25:11)
  8384     CALL 'kxdfhei1' USING DFHEIV0
  8385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8386
  8387
  8388
  8389* EXEC CICS READ
  8390*        DATASET  (ELCERT-ID)
  8391*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8392*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8393*    END-EXEC.
  8394*    MOVE '&"S        E          (   #00008089' TO DFHEIV0
  8395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038303839' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           ELCERT-ID,
  8400           DFHEIV20,
  8401           DFHEIV99,
  8402           WS-CM-CONTROL-PRIMARY,
  8403           DFHEIV99,
  8404           DFHEIV99,
  8405           DFHEIV99
  8406     SET ADDRESS OF CERTIFICATE-MASTER TO
  8407         DFHEIV20
  8408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8409
  8410
  8411*    SERVICE RELOAD CERTIFICATE-MASTER.
  8412
  8413     GO TO 0999-EXIT.
  8414
  8415 0910-NOT-FOUND.
  8416     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8417
  8418 0999-EXIT.
  8419     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 155
* EL1278.cbl
  8421 1000-READ-CONTROL  SECTION.
  8422
  8423* EXEC CICS HANDLE CONDITION
  8424*        NOTFND   (1010-NOTFND)
  8425*        NOTOPEN  (1020-NOTOPEN)
  8426*    END-EXEC.
  8427*    MOVE '"$IJ                  ! $ #00008106' TO DFHEIV0
  8428     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8430     MOVE X'2420233030303038313036' TO DFHEIV0(25:11)
  8431     CALL 'kxdfhei1' USING DFHEIV0
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
  8434
  8435
  8436* EXEC CICS READ
  8437*        DATASET  (ELCNTL-ID)
  8438*        SET      (ADDRESS OF CONTROL-FILE)
  8439*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8440*        GTEQ
  8441*    END-EXEC.
  8442*    MOVE '&"S        G          (   #00008111' TO DFHEIV0
  8443     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8445     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  8446     CALL 'kxdfhei1' USING DFHEIV0,
  8447           ELCNTL-ID,
  8448           DFHEIV20,
  8449           DFHEIV99,
  8450           WS-CF-CONTROL-PRIMARY,
  8451           DFHEIV99,
  8452           DFHEIV99,
  8453           DFHEIV99
  8454     SET ADDRESS OF CONTROL-FILE TO
  8455         DFHEIV20
  8456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8457
  8458
  8459*    SERVICE RELOAD CONTROL-FILE.
  8460
  8461     GO TO 1099-EXIT.
  8462
  8463 1010-NOTFND.
  8464     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8465
  8466     GO TO 1099-EXIT.
  8467
  8468 1020-NOTOPEN.
  8469     MOVE ER-2617                TO  EMI-ERROR.
  8470
  8471     GO TO 0320-INPUT-ERROR.
  8472
  8473 1099-EXIT.
  8474     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 156
* EL1278.cbl
  8476 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8477     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8478
  8479     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8480         VARYING  SUB3  FROM  1  BY  1
  8481             UNTIL  ((SUB3  IS GREATER THAN  50)
  8482               OR ((CF-ST-BENEFIT-CD (SUB3)
  8483                      IS EQUAL TO  WS-BEN-CD)
  8484               AND (WS-LOOKUP-TYPE
  8485                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8486
  8487     IF SUB3  IS NOT EQUAL TO  51
  8488         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8489
  8490     GO TO 1199-EXIT.
  8491
  8492 1110-BENEFIT-DUMMY.
  8493
  8494 1119-EXIT.
  8495     EXIT.
  8496
  8497 1199-EXIT.
  8498     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 157
* EL1278.cbl
  8500 1200-START-ACCOUNT-MASTER  SECTION.
  8501
  8502* EXEC CICS HANDLE CONDITION
  8503*        NOTFND   (1290-ACCT-NOT-FOUND)
  8504*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8505*    END-EXEC.
  8506*    MOVE '"$I''                  ! % #00008160' TO DFHEIV0
  8507     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8509     MOVE X'2520233030303038313630' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8515
  8516
  8517* EXEC CICS STARTBR
  8518*        DATASET  (ERACCT-ID)
  8519*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8520*        GTEQ
  8521*    END-EXEC.
  8522     MOVE 0
  8523       TO DFHEIV11
  8524*    MOVE '&,         G          &   #00008167' TO DFHEIV0
  8525     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8527     MOVE X'2020233030303038313637' TO DFHEIV0(25:11)
  8528     CALL 'kxdfhei1' USING DFHEIV0,
  8529           ERACCT-ID,
  8530           WS-AM-CONTROL-PRIMARY,
  8531           DFHEIV99,
  8532           DFHEIV11,
  8533           DFHEIV99
  8534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8535
  8536
  8537     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8538     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8539
  8540     GO TO 1299-EXIT.
  8541
  8542 1290-ACCT-NOT-FOUND.
  8543     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8544
  8545 1299-EXIT.
  8546     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 158
* EL1278.cbl
  8548 1300-READ-ACCOUNT-MASTER  SECTION.
  8549
  8550* EXEC CICS HANDLE CONDITION
  8551*        NOTFND   (0580-ACCT-NOT-FOUND)
  8552*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8553*    END-EXEC.
  8554*    MOVE '"$I''                  ! & #00008185' TO DFHEIV0
  8555     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8557     MOVE X'2620233030303038313835' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8560
  8561
  8562
  8563* EXEC CICS READNEXT
  8564*        DATASET  (ERACCT-ID)
  8565*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8566*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8567*    END-EXEC.
  8568     MOVE 0
  8569       TO DFHEIV11
  8570*    MOVE '&.S                   )   #00008190' TO DFHEIV0
  8571     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8572     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8573     MOVE X'2020233030303038313930' TO DFHEIV0(25:11)
  8574     CALL 'kxdfhei1' USING DFHEIV0,
  8575           ERACCT-ID,
  8576           DFHEIV20,
  8577           DFHEIV99,
  8578           WS-AM-CONTROL-PRIMARY,
  8579           DFHEIV99,
  8580           DFHEIV11,
  8581           DFHEIV99,
  8582           DFHEIV99
  8583     SET ADDRESS OF ACCOUNT-MASTER TO
  8584         DFHEIV20
  8585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8586
  8587
  8588*    SERVICE RELOAD ACCOUNT-MASTER.
  8589
  8590 1399-EXIT.
  8591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 159
* EL1278.cbl
  8593 1400-GET-REFUND-TYPE  SECTION.
  8594     IF LIFE-REFUND-SEARCH
  8595         NEXT SENTENCE
  8596     ELSE
  8597         GO TO 1410-AH-REFUND-TYPE.
  8598
  8599     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8600         MOVE SPACES             TO  HLCALCO
  8601                                     HLCAL1O
  8602         GO TO 1499-EXIT.
  8603
  8604     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8605
  8606     EVALUATE TRUE
  8607        WHEN CP-R-AS-REPOSSESSION
  8608           MOVE 'REPOSSESSION'     TO  HLCALCO
  8609        WHEN CP-R-AS-R78
  8610           MOVE 'RULE 78'          TO  HLCALCO
  8611        WHEN  CP-R-AS-PRORATA
  8612           MOVE 'PRO RATA'         TO  HLCALCO
  8613        WHEN CP-R-AS-CALIF
  8614           MOVE 'CALIF'            TO  HLCALCO
  8615        WHEN CP-R-AS-TEXAS
  8616           MOVE 'IRREG'            TO  HLCALCO
  8617        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8618           MOVE 'UTAH'             TO  HLCALCO
  8619        WHEN CP-R-AS-FARM-PLAN
  8620           MOVE 'FARM PLAN'        TO  HLCALCO
  8621        WHEN CP-R-AS-NET-PAY
  8622           MOVE 'NET PAY'          TO  HLCALCO
  8623        WHEN CP-R-AS-ANTICIPATION
  8624           MOVE 'ANTICIPATION'     TO  HLCALCO
  8625        WHEN CP-R-AS-MEAN
  8626           MOVE 'MEAN'             TO  HLCALCO
  8627        WHEN CP-R-AS-SUM-OF-DIGITS
  8628           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8629        WHEN OTHER
  8630           MOVE 'UNDEFINED'        TO  HLCALCO
  8631     END-EVALUATE.
  8632
  8633     GO TO 1499-EXIT.
  8634
  8635 1410-AH-REFUND-TYPE.
  8636     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8637         MOVE SPACES             TO  HACALCO
  8638                                     HACAL1O
  8639         GO TO 1499-EXIT.
  8640
  8641     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8642
  8643     EVALUATE TRUE
  8644        WHEN CP-R-AS-REPOSSESSION
  8645           MOVE 'REPOSSESSION'     TO HACALCO
  8646        WHEN CP-R-AS-R78
  8647           MOVE 'RULE 78'          TO HACALCO
  8648        WHEN CP-R-AS-PRORATA
  8649           MOVE 'PRO RATA'         TO HACALCO
  8650        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 160
* EL1278.cbl
  8651           MOVE 'CALIF'            TO HACALCO
  8652        WHEN CP-R-AS-TEXAS
  8653           MOVE 'IRREG'            TO HACALCO
  8654        WHEN CP-R-AS-FARM-PLAN
  8655           MOVE 'FARM PLAN'        TO HACALCO
  8656        WHEN CP-R-AS-NET-PAY
  8657           MOVE 'NET PAY'          TO HACALCO
  8658        WHEN CP-R-AS-ANTICIPATION
  8659           MOVE 'ANTICIPATION'     TO HACALCO
  8660        WHEN CP-R-AS-MEAN
  8661           MOVE 'MEAN'             TO HACALCO
  8662        WHEN CP-R-AS-SUM-OF-DIGITS
  8663           MOVE 'SUM OF DIGIT'     TO HACALCO
  8664        WHEN CP-GAP-ACTUARIAL
  8665           MOVE 'SP ACTUARIAL'     TO HACALCO
  8666        WHEN CP-R-AS-SPP-DDF
  8667           MOVE 'SPEC DDF'         TO HACALCO
  8668        WHEN CP-R-AS-SPP-DDF-IU
  8669           MOVE 'SPEC DDF IU'      TO HACALCO
  8670        WHEN OTHER
  8671           MOVE 'UNKNOWN'          TO HLCALCO
  8672     END-EVALUATE
  8673     .
  8674 1499-EXIT.
  8675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 161
* EL1278.cbl
  8677 1500-END-BROWSE  SECTION.
  8678     IF BROWSE-STARTED
  8679
  8680* EXEC CICS ENDBR
  8681*            DATASET  (ERACCT-ID)
  8682*        END-EXEC.
  8683     MOVE 0
  8684       TO DFHEIV11
  8685*    MOVE '&2                    $   #00008287' TO DFHEIV0
  8686     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8687     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8688     MOVE X'2020233030303038323837' TO DFHEIV0(25:11)
  8689     CALL 'kxdfhei1' USING DFHEIV0,
  8690           ERACCT-ID,
  8691           DFHEIV11,
  8692           DFHEIV99
  8693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8694
  8695
  8696 1599-EXIT.
  8697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 162
* EL1278.cbl
  8699 1600-LOCATE-BENEFIT  SECTION.
  8700
  8701* EXEC CICS HANDLE CONDITION
  8702*        NOTFND  (1699-EXIT)
  8703*    END-EXEC.
  8704*    MOVE '"$I                   ! '' #00008295' TO DFHEIV0
  8705     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8707     MOVE X'2720233030303038323935' TO DFHEIV0(25:11)
  8708     CALL 'kxdfhei1' USING DFHEIV0
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711
  8712     MOVE SPACES                 TO  WS-KIND.
  8713     MOVE ZERO                   TO  WS-NOT-FOUND.
  8714     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8715     MOVE SPACES                 TO  WS-CF-STATE.
  8716     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8717
  8718
  8719* EXEC CICS READ
  8720*        DATASET  (ELCNTL-ID)
  8721*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8722*        SET      (ADDRESS OF CONTROL-FILE)
  8723*        GTEQ
  8724*    END-EXEC.
  8725*    MOVE '&"S        G          (   #00008305' TO DFHEIV0
  8726     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8728     MOVE X'2020233030303038333035' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           ELCNTL-ID,
  8731           DFHEIV20,
  8732           DFHEIV99,
  8733           WS-CF-CONTROL-PRIMARY,
  8734           DFHEIV99,
  8735           DFHEIV99,
  8736           DFHEIV99
  8737     SET ADDRESS OF CONTROL-FILE TO
  8738         DFHEIV20
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8740
  8741
  8742*    SERVICE RELOAD CONTROL-FILE.
  8743
  8744     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8745       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8746         GO TO 1699-EXIT.
  8747
  8748     MOVE +1                     TO  WS-INDEX.
  8749
  8750 1610-LOOKUP-BENEFIT.
  8751     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8752         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8753                                 TO  WS-KIND
  8754         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8755                                 TO  WS-CALC-CD
  8756         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 163
* EL1278.cbl
  8757                                 TO  WS-BENEFIT-DESCRIP
  8758         MOVE +1                 TO  WS-NOT-FOUND
  8759         GO TO 1699-EXIT.
  8760
  8761     IF CF-BENEFIT-CODE (WS-INDEX)
  8762             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8763         GO TO 1699-EXIT.
  8764
  8765     IF WS-INDEX  IS LESS THAN  +8
  8766         ADD +1                  TO  WS-INDEX
  8767         GO TO 1610-LOOKUP-BENEFIT.
  8768
  8769 1699-EXIT.
  8770     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 164
* EL1278.cbl
  8772 1700-WRITE-CERT-NOTE      SECTION.
  8773     IF NOT MODIFY-CERT-CAP
  8774         MOVE 'UPDATE'           TO  SM-READ
  8775         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8776         MOVE ER-0070            TO  EMI-ERROR
  8777         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8778         GO TO 8200-SEND-DATAONLY.
  8779
  8780**MOVE CANCEL QUOTE NOTE INFO
  8781     IF PI-LF-REFUND-AMT NUMERIC
  8782        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8783        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8784     ELSE
  8785        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8786                                    PI-LF-REFUND-AMT
  8787        MOVE SPACE               TO WS-CN-LF-REF-METH
  8788                                    PI-LF-REFUND-METH.
  8789
  8790     IF PI-AH-REFUND-AMT NUMERIC
  8791        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8792        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8793     ELSE
  8794        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8795                                    PI-AH-REFUND-AMT
  8796        MOVE SPACE               TO WS-CN-AH-REF-METH
  8797                                    PI-AH-REFUND-METH.
  8798
  8799     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8800                                   PI-AH-REFUND-AMT.
  8801
  8802     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8803
  8804     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8805     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8806     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8807        MOVE PI-LF-CANCEL-DATE-ED
  8808                                 TO WS-CN-CANCEL-DT
  8809     ELSE
  8810        MOVE PI-AH-CANCEL-DATE-ED
  8811                                 TO WS-CN-CANCEL-DT
  8812     END-IF
  8813     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8814     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8815     MOVE PI-CARRIER             TO CZ-CARRIER
  8816     MOVE PI-GROUPING            TO CZ-GROUPING
  8817     MOVE PI-STATE               TO CZ-STATE
  8818     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8819     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8820     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8821     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8822     MOVE '1'                    TO CZ-RECORD-TYPE
  8823     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8824     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8825     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8826     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8827     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8828     MOVE ' '                    TO WS-STOP-SW
  8829     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 165
* EL1278.cbl
  8830
  8831* EXEC CICS WRITE
  8832*           FROM      (CERT-NOTE-FILE)
  8833*           DATASET   (ERNOTE-ID)
  8834*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8835*           RESP      (WS-RESPONSE)
  8836*       END-EXEC
  8837     MOVE LENGTH OF
  8838      CERT-NOTE-FILE
  8839       TO DFHEIV11
  8840*    MOVE '&$ L                  ''  N#00008400' TO DFHEIV0
  8841     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8843     MOVE X'204E233030303038343030' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
  8845           ERNOTE-ID,
  8846           CERT-NOTE-FILE,
  8847           DFHEIV11,
  8848           CZ-CONTROL-PRIMARY,
  8849           DFHEIV99,
  8850           DFHEIV99
  8851     MOVE EIBRESP  TO WS-RESPONSE
  8852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8853        IF WS-RESP-DUPREC
  8854           ADD +1                TO CZ-NOTE-SEQUENCE
  8855        ELSE
  8856           SET I-SAY-TO-STOP     TO TRUE
  8857        END-IF
  8858     END-PERFORM
  8859     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8860     IF WS-RESP-NORMAL
  8861        EVALUATE CM-NOTE-SW
  8862           WHEN '1'
  8863           WHEN '3'
  8864           WHEN '5'
  8865           WHEN '7'
  8866              SET NO-CERT-RW     TO TRUE
  8867           WHEN ' '
  8868              MOVE '1'           TO CM-NOTE-SW
  8869           WHEN '2'
  8870              MOVE '3'           TO CM-NOTE-SW
  8871           WHEN '4'
  8872              MOVE '5'           TO CM-NOTE-SW
  8873           WHEN '6'
  8874              MOVE '7'           TO CM-NOTE-SW
  8875        END-EVALUATE
  8876     END-IF
  8877     IF NOT NO-CERT-RW
  8878        PERFORM 1810-REWRITE-ELCERT
  8879                                 THRU 1810-EXIT
  8880     ELSE
  8881
  8882* EXEC CICS UNLOCK
  8883*          DATASET    (ELCERT-ID)
  8884*       END-EXEC
  8885*    MOVE '&*                    #   #00008434' TO DFHEIV0
  8886     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 166
* EL1278.cbl
  8888     MOVE X'2020233030303038343334' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0,
  8890           ELCERT-ID,
  8891           DFHEIV99
  8892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8893     END-IF
  8894     MOVE ER-8160                TO EMI-ERROR.
  8895     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8896     GO TO 8200-SEND-DATAONLY.
  8897
  8898 1799-EXIT.
  8899     EXIT.
  8900 1800-READ-ELCERT-UPDATE.
  8901     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8902     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8903     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8904     MOVE PI-STATE               TO  WS-CM-STATE.
  8905     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8906     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8907     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8908     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8909
  8910* EXEC CICS READ
  8911*        UPDATE
  8912*        DATASET  (ELCERT-ID)
  8913*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8914*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8915*        RESP     (WS-RESPONSE)
  8916*    END-EXEC
  8917*    MOVE '&"S        EU         (  N#00008453' TO DFHEIV0
  8918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8920     MOVE X'204E233030303038343533' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
  8922           ELCERT-ID,
  8923           DFHEIV20,
  8924           DFHEIV99,
  8925           WS-CM-CONTROL-PRIMARY,
  8926           DFHEIV99,
  8927           DFHEIV99,
  8928           DFHEIV99
  8929     SET ADDRESS OF CERTIFICATE-MASTER TO
  8930         DFHEIV20
  8931     MOVE EIBRESP  TO WS-RESPONSE
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8933     .
  8934 1800-EXIT.
  8935     EXIT.
  8936 1810-REWRITE-ELCERT.
  8937
  8938* EXEC CICS REWRITE
  8939*        FROM      (CERTIFICATE-MASTER)
  8940*        DATASET   (ELCERT-ID)
  8941*        RESP     (WS-RESPONSE)
  8942*    END-EXEC.
  8943     MOVE LENGTH OF
  8944      CERTIFICATE-MASTER
  8945       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 167
* EL1278.cbl
  8946*    MOVE '&& L                  %  N#00008464' TO DFHEIV0
  8947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8949     MOVE X'204E233030303038343634' TO DFHEIV0(25:11)
  8950     CALL 'kxdfhei1' USING DFHEIV0,
  8951           ELCERT-ID,
  8952           CERTIFICATE-MASTER,
  8953           DFHEIV11,
  8954           DFHEIV99
  8955     MOVE EIBRESP  TO WS-RESPONSE
  8956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8957
  8958     .
  8959 1810-EXIT.
  8960     EXIT.
  8961 4000-GEN-CANCEL-TRANS.
  8962     IF PI-LF-REFUND-AMT NOT NUMERIC
  8963         MOVE +0 TO PI-LF-REFUND-AMT
  8964     END-IF
  8965     IF PI-AH-REFUND-AMT NOT NUMERIC
  8966         MOVE +0 TO PI-AH-REFUND-AMT
  8967     END-IF
  8968
  8969     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8970
  8971     MOVE '2'                    TO CG-OPTION-CODE
  8972     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8973     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8974     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8975     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8976     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8977     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8978     MOVE PI-STATE               TO CG-CERT-STATE
  8979     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8980     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8981     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8982     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8983     MOVE ZEROS                  TO CG-LF-BENCD
  8984                                    CG-AH-BENCD
  8985                                    CG-LF-CAN-AMT
  8986                                    CG-AH-CAN-AMT
  8987     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8988                                    CG-AH-CAN-DT
  8989     MOVE SPACES                 TO CG-BATCH-NO
  8990     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8991       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8992        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8993           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8994           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8995           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8996        END-IF
  8997     END-IF
  8998     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8999       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  9000        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  9001           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  9002           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  9003           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 168
* EL1278.cbl
  9004        END-IF
  9005     END-IF
  9006
  9007* EXEC CICS LINK
  9008*        PROGRAM  ('ELCANC')
  9009*        COMMAREA (CANCEL-GEN-PASS-AREA)
  9010*    END-EXEC
  9011     MOVE LENGTH OF
  9012      CANCEL-GEN-PASS-AREA
  9013       TO DFHEIV11
  9014     MOVE 'ELCANC' TO DFHEIV1
  9015*    MOVE '."C                   (   #00008517' TO DFHEIV0
  9016     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038353137' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           DFHEIV1,
  9021           CANCEL-GEN-PASS-AREA,
  9022           DFHEIV11,
  9023           DFHEIV99,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9028     IF CG-SUCCESS
  9029        CONTINUE
  9030     ELSE
  9031        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  9032        move '3'                 to emi-switch1
  9033        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  9034        EVALUATE TRUE
  9035           WHEN CG-DATE-ERROR
  9036             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9037           WHEN CG-CERT-NOT-FOUND
  9038             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9039           WHEN CG-AMOUNT-ERROR
  9040             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9041           WHEN CG-OPTION-ERROR
  9042             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9043           WHEN CG-PREV-CAN
  9044             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9045           WHEN CG-INVALID-DATA
  9046             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9047           WHEN CG-NO-ACCT-MSTR
  9048             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9049           WHEN CG-SFX-A-EXIST
  9050             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9051           WHEN CG-MISC-ERROR
  9052             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9053           WHEN OTHER
  9054             move ' error - elcanc - return '
  9055                                 to emi-error-text (1) (12:25)
  9056        END-EVALUATE
  9057        go to 8200-send-dataonly
  9058     end-if
  9059     .
  9060 4000-exit.
  9061     exit.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 169
* EL1278.cbl
  9062
  9063 4400-ADD-ORIG-REC.
  9064
  9065     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  9066     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  9067     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  9068     MOVE PI-STATE               TO  WS-CM-STATE.
  9069     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  9070     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  9071     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  9072     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  9073
  9074
  9075* EXEC CICS READ
  9076*        DATASET  (ELCERT-ID)
  9077*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  9078*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9079*        RESP     (WS-RESPONSE)
  9080*    END-EXEC
  9081*    MOVE '&"S        E          (  N#00008567' TO DFHEIV0
  9082     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9084     MOVE X'204E233030303038353637' TO DFHEIV0(25:11)
  9085     CALL 'kxdfhei1' USING DFHEIV0,
  9086           ELCERT-ID,
  9087           DFHEIV20,
  9088           DFHEIV99,
  9089           WS-CM-CONTROL-PRIMARY,
  9090           DFHEIV99,
  9091           DFHEIV99,
  9092           DFHEIV99
  9093     SET ADDRESS OF CERTIFICATE-MASTER TO
  9094         DFHEIV20
  9095     MOVE EIBRESP  TO WS-RESPONSE
  9096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9097     IF WS-RESP-NORMAL
  9098         CONTINUE
  9099     ELSE
  9100        MOVE ER-0142                TO EMI-ERROR
  9101        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  9102        GO TO 8100-SEND-INITIAL-MAP
  9103     END-IF
  9104
  9105******************************************************************
  9106*            A D D   O R I G   C E R T   I N F O                 *
  9107******************************************************************
  9108
  9109     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  9110
  9111     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  9112     MOVE ' '                    TO WS-ERMAIL-SW
  9113
  9114
  9115* EXEC CICS READ
  9116*       DATASET   ('ERMAIL')
  9117*       SET       (ADDRESS OF MAILING-DATA)
  9118*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9119*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 170
* EL1278.cbl
  9120*    END-EXEC
  9121     MOVE 'ERMAIL' TO DFHEIV1
  9122*    MOVE '&"S        E          (  N#00008590' TO DFHEIV0
  9123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9125     MOVE X'204E233030303038353930' TO DFHEIV0(25:11)
  9126     CALL 'kxdfhei1' USING DFHEIV0,
  9127           DFHEIV1,
  9128           DFHEIV20,
  9129           DFHEIV99,
  9130           WS-MA-CONTROL-PRIMARY,
  9131           DFHEIV99,
  9132           DFHEIV99,
  9133           DFHEIV99
  9134     SET ADDRESS OF MAILING-DATA TO
  9135         DFHEIV20
  9136     MOVE EIBRESP  TO WS-RESPONSE
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9138
  9139     IF WS-RESP-NORMAL
  9140        SET ERMAIL-FOUND TO TRUE
  9141     END-IF
  9142
  9143     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  9144     MOVE 'C'                   TO ELCRTT-REC-TYPE
  9145     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  9146
  9147
  9148* EXEC CICS READ
  9149*         DATASET  (ELCRTT-ID)
  9150*         RIDFLD   (ELCRTT-KEY)
  9151*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  9152*         RESP     (WS-RESPONSE)
  9153*    END-EXEC
  9154*    MOVE '&"S        E          (  N#00008605' TO DFHEIV0
  9155     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9157     MOVE X'204E233030303038363035' TO DFHEIV0(25:11)
  9158     CALL 'kxdfhei1' USING DFHEIV0,
  9159           ELCRTT-ID,
  9160           DFHEIV20,
  9161           DFHEIV99,
  9162           ELCRTT-KEY,
  9163           DFHEIV99,
  9164           DFHEIV99,
  9165           DFHEIV99
  9166     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  9167         DFHEIV20
  9168     MOVE EIBRESP  TO WS-RESPONSE
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9170
  9171     IF NOT WS-RESP-NORMAL
  9172        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  9173     END-IF
  9174
  9175     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  9176     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  9177     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 171
* EL1278.cbl
  9178
  9179
  9180* EXEC CICS READ
  9181*       DATASET   ('ELCRTO')
  9182*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9183*       RIDFLD    (ELCRTO-KEY)
  9184*       GTEQ
  9185*       RESP      (WS-RESPONSE)
  9186*    END-EXEC
  9187     MOVE 'ELCRTO' TO DFHEIV1
  9188*    MOVE '&"S        G          (  N#00008620' TO DFHEIV0
  9189     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9191     MOVE X'204E233030303038363230' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0,
  9193           DFHEIV1,
  9194           DFHEIV20,
  9195           DFHEIV99,
  9196           ELCRTO-KEY,
  9197           DFHEIV99,
  9198           DFHEIV99,
  9199           DFHEIV99
  9200     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9201         DFHEIV20
  9202     MOVE EIBRESP  TO WS-RESPONSE
  9203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9204
  9205     IF WS-RESP-NORMAL
  9206        AND (OC-CONTROL-PRIMARY (1:33) =
  9207                 WS-CM-CONTROL-PRIMARY)
  9208        AND (OC-RECORD-TYPE = 'I')
  9209        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9210
  9211* EXEC CICS READ
  9212*             DATASET   ('ELCRTO')
  9213*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9214*             RIDFLD    (OC-CONTROL-PRIMARY)
  9215*             UPDATE
  9216*             RESP      (WS-RESPONSE)
  9217*          END-EXEC
  9218     MOVE 'ELCRTO' TO DFHEIV1
  9219*    MOVE '&"S        EU         (  N#00008633' TO DFHEIV0
  9220     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9221     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9222     MOVE X'204E233030303038363333' TO DFHEIV0(25:11)
  9223     CALL 'kxdfhei1' USING DFHEIV0,
  9224           DFHEIV1,
  9225           DFHEIV20,
  9226           DFHEIV99,
  9227           OC-CONTROL-PRIMARY,
  9228           DFHEIV99,
  9229           DFHEIV99,
  9230           DFHEIV99
  9231     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9232         DFHEIV20
  9233     MOVE EIBRESP  TO WS-RESPONSE
  9234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9235           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 172
* EL1278.cbl
  9236           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9237           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9238           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9239           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9240           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9241           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9242           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9243           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9244            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9245               MOVE SPACES             TO OC-LF-BENCD
  9246               MOVE ZEROS              TO OC-LF-TERM
  9247                                          OC-LF-BEN-AMT
  9248                                          OC-LF-PRM-AMT
  9249                                          OC-LF-ALT-BEN-AMT
  9250                                          OC-LF-ALT-PRM-AMT
  9251                                          OC-LF-COMM-PCT
  9252                                          OC-LF-CANCEL-AMT
  9253               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9254               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9255           ELSE
  9256               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9257               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9258               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9259               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9260               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9261               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9262               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9263               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9264               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9265               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9266           END-IF
  9267           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9268           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9269            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9270               MOVE SPACES             TO OC-AH-BENCD
  9271               MOVE ZEROS              TO OC-AH-TERM
  9272                                          OC-AH-BEN-AMT
  9273                                          OC-AH-PRM-AMT
  9274                                          OC-AH-COMM-PCT
  9275                                          OC-AH-CANCEL-AMT
  9276                                          OC-AH-CP
  9277               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9278               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9279           ELSE
  9280               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9281               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9282               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9283               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9284               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9285               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9286               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9287               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9288               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9289           END-IF
  9290           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9291           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9292           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9293           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 173
* EL1278.cbl
  9294           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9295           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9296           MOVE '5'                    TO DC-OPTION-CODE
  9297           PERFORM 9600-DATE-LINK
  9298           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9299           IF ERMAIL-FOUND
  9300               MOVE MA-CRED-BENE-NAME
  9301                           TO OC-CRED-BENE-NAME
  9302           END-IF
  9303           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9304               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9305                                  OC-INS-AGE-DEFAULT-FLAG
  9306               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9307                                  OC-JNT-AGE-DEFAULT-FLAG
  9308           END-IF
  9309
  9310
  9311* EXEC CICS REWRITE
  9312*             DATASET   ('ELCRTO')
  9313*             FROM      (ORIGINAL-CERTIFICATE)
  9314*             RESP      (WS-RESPONSE)
  9315*          END-EXEC
  9316     MOVE LENGTH OF
  9317      ORIGINAL-CERTIFICATE
  9318       TO DFHEIV11
  9319     MOVE 'ELCRTO' TO DFHEIV1
  9320*    MOVE '&& L                  %  N#00008715' TO DFHEIV0
  9321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9323     MOVE X'204E233030303038373135' TO DFHEIV0(25:11)
  9324     CALL 'kxdfhei1' USING DFHEIV0,
  9325           DFHEIV1,
  9326           ORIGINAL-CERTIFICATE,
  9327           DFHEIV11,
  9328           DFHEIV99
  9329     MOVE EIBRESP  TO WS-RESPONSE
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9331           IF NOT WS-RESP-NORMAL
  9332              MOVE ER-3830          TO EMI-ERROR
  9333              PERFORM 9700-ERROR-FORMAT
  9334                                 THRU 9799-EXIT
  9335              GO TO 8200-SEND-DATAONLY
  9336           END-IF
  9337
  9338           GO TO 4400-EXIT
  9339
  9340        ELSE
  9341           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9342        END-IF
  9343     ELSE
  9344        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9345        MOVE 'OC'                TO OC-RECORD-ID
  9346        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9347        MOVE 'I'                 TO OC-RECORD-TYPE
  9348        MOVE +4096               TO OC-KEY-SEQ-NO
  9349     END-IF
  9350
  9351     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 174
* EL1278.cbl
  9352     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9353     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9354     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9355     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9356     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9357     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9358     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9359     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9360      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9361         MOVE SPACES             TO OC-LF-BENCD
  9362         MOVE ZEROS              TO OC-LF-TERM
  9363                                    OC-LF-BEN-AMT
  9364                                    OC-LF-PRM-AMT
  9365                                    OC-LF-ALT-BEN-AMT
  9366                                    OC-LF-ALT-PRM-AMT
  9367                                    OC-LF-COMM-PCT
  9368                                    OC-LF-CANCEL-AMT
  9369         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9370         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9371     ELSE
  9372         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9373         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9374         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9375         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9376         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9377         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9378         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9379         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9380         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9381         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9382     END-IF
  9383     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9384     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9385      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9386         MOVE SPACES             TO OC-AH-BENCD
  9387         MOVE ZEROS              TO OC-AH-TERM
  9388                                    OC-AH-BEN-AMT
  9389                                    OC-AH-PRM-AMT
  9390                                    OC-AH-COMM-PCT
  9391                                    OC-AH-CANCEL-AMT
  9392                                    OC-AH-CP
  9393         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9394         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9395     ELSE
  9396         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9397         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9398         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9399         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9400         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9401         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9402         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9403         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9404         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9405         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9406     END-IF
  9407     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9408     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9409     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 175
* EL1278.cbl
  9410     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9411     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9412     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9413     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9414     MOVE '5'                    TO DC-OPTION-CODE
  9415     PERFORM 9600-DATE-LINK
  9416     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9417     IF ERMAIL-FOUND
  9418         MOVE MA-CRED-BENE-NAME
  9419                     TO OC-CRED-BENE-NAME
  9420     END-IF
  9421     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9422         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9423                            OC-INS-AGE-DEFAULT-FLAG
  9424         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9425                            OC-JNT-AGE-DEFAULT-FLAG
  9426     END-IF
  9427
  9428     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9429     .
  9430 4400-WRITE-ELCRTO.
  9431
  9432
  9433* EXEC CICS WRITE
  9434*       DATASET   ('ELCRTO')
  9435*       FROM      (ORIGINAL-CERTIFICATE)
  9436*       RIDFLD    (OC-CONTROL-PRIMARY)
  9437*       RESP      (WS-RESPONSE)
  9438*    END-EXEC
  9439     MOVE LENGTH OF
  9440      ORIGINAL-CERTIFICATE
  9441       TO DFHEIV11
  9442     MOVE 'ELCRTO' TO DFHEIV1
  9443*    MOVE '&$ L                  ''  N#00008821' TO DFHEIV0
  9444     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9446     MOVE X'204E233030303038383231' TO DFHEIV0(25:11)
  9447     CALL 'kxdfhei1' USING DFHEIV0,
  9448           DFHEIV1,
  9449           ORIGINAL-CERTIFICATE,
  9450           DFHEIV11,
  9451           OC-CONTROL-PRIMARY,
  9452           DFHEIV99,
  9453           DFHEIV99
  9454     MOVE EIBRESP  TO WS-RESPONSE
  9455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9456
  9457    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9458        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9459        GO TO 4400-WRITE-ELCRTO
  9460    ELSE
  9461        IF NOT WS-RESP-NORMAL
  9462           MOVE ER-3830          TO EMI-ERROR
  9463           PERFORM 9700-ERROR-FORMAT
  9464                                 THRU 9799-EXIT
  9465           GO TO 8200-SEND-DATAONLY
  9466        END-IF
  9467    END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 176
* EL1278.cbl
  9468
  9469     .
  9470 4400-EXIT.
  9471    EXIT.
  9472
  9473
  9474 5000-GET-LF-AM-REM-TERM.
  9475     MOVE +1                     TO SUB3.
  9476
  9477 5100-GET-LF-AM-REM-TERM.
  9478     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9479        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9480           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9481                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9482           GO TO 5300-MOVE-LF-REM-TERM.
  9483
  9484     IF SUB3 LESS THAN +20
  9485        ADD +1                   TO SUB3
  9486        GO TO 5100-GET-LF-AM-REM-TERM.
  9487
  9488     MOVE +1                     TO SUB3.
  9489
  9490     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9491         GO TO 5200-EDIT-FOR-NINETY-LF.
  9492
  9493 5100-GET-LF-DMD-AM-REM-TERM.
  9494
  9495     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9496        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9497           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9498                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9499           GO TO 5300-MOVE-LF-REM-TERM.
  9500
  9501     IF SUB3 LESS THAN +30
  9502        ADD +1                   TO SUB3
  9503        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9504
  9505     MOVE +1                     TO SUB3.
  9506
  9507 5200-EDIT-FOR-NINETY-LF.
  9508
  9509***************************************************************
  9510*                                                             *
  9511*    NINETY BENEFIT PLAN TYPES:                               *
  9512*                                                             *
  9513*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9514*      92 = ALL GROUP REDUCING BENEFITS                       *
  9515*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9516*      94 = ALL GROUP LEVEL BENEFITS                          *
  9517*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9518*           BENEFIT CONTROLS.                                 *
  9519*      99 = ALL BENEFITS                                      *
  9520*                                                             *
  9521***************************************************************
  9522
  9523     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9524                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9525
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 177
* EL1278.cbl
  9526     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9527       AND
  9528        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9529           GO TO 5300-MOVE-LF-REM-TERM.
  9530
  9531     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9532       AND
  9533        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9534        IF CF-REDUCING (WS-INDEX)
  9535           IF CM-INDIVIDUAL
  9536               GO TO 5300-MOVE-LF-REM-TERM.
  9537
  9538     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9539       AND
  9540        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9541        IF CF-REDUCING (WS-INDEX)
  9542           IF CM-GROUP
  9543               GO TO 5300-MOVE-LF-REM-TERM.
  9544
  9545     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9546       AND
  9547        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9548        IF CF-LEVEL (WS-INDEX)
  9549           IF CM-INDIVIDUAL
  9550               GO TO 5300-MOVE-LF-REM-TERM.
  9551
  9552     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9553       AND
  9554        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9555        IF CF-LEVEL (WS-INDEX)
  9556           IF CM-GROUP
  9557               GO TO 5300-MOVE-LF-REM-TERM.
  9558
  9559     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9560       AND
  9561        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9562            GO TO 5300-MOVE-LF-REM-TERM.
  9563
  9564     IF SUB3 LESS THAN +20
  9565        ADD +1           TO SUB3
  9566          GO TO 5200-EDIT-FOR-NINETY-LF.
  9567
  9568     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9569
  9570     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9571         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9572         GO TO 5900-EXIT.
  9573
  9574     MOVE 1                       TO SUB3.
  9575
  9576 5200-EDIT-FOR-DMD-NINETY-LF.
  9577
  9578     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9579                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9580
  9581     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9582       AND
  9583        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 178
* EL1278.cbl
  9584           GO TO 5300-MOVE-LF-REM-TERM.
  9585
  9586     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9587       AND
  9588        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9589        IF CF-REDUCING (WS-INDEX)
  9590           IF CM-INDIVIDUAL
  9591               GO TO 5300-MOVE-LF-REM-TERM.
  9592
  9593     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9594       AND
  9595        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9596        IF CF-REDUCING (WS-INDEX)
  9597           IF CM-GROUP
  9598               GO TO 5300-MOVE-LF-REM-TERM.
  9599
  9600     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9601       AND
  9602        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9603        IF CF-LEVEL (WS-INDEX)
  9604           IF CM-INDIVIDUAL
  9605               GO TO 5300-MOVE-LF-REM-TERM.
  9606
  9607     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9608       AND
  9609        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9610        IF CF-LEVEL (WS-INDEX)
  9611           IF CM-GROUP
  9612               GO TO 5300-MOVE-LF-REM-TERM.
  9613
  9614     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9615       AND
  9616        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9617            GO TO 5300-MOVE-LF-REM-TERM.
  9618
  9619     IF SUB3 LESS THAN +30
  9620        ADD +1                   TO SUB3
  9621          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9622
  9623     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9624
  9625     GO TO 5900-EXIT.
  9626
  9627 5300-MOVE-LF-REM-TERM.
  9628     MOVE WS-SAVE-BENEFIT-REM-TERM
  9629                                 TO WS-LF-AM-REM-TERM-CALC.
  9630
  9631 5900-EXIT.
  9632      EXIT.
  9633
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 179
* EL1278.cbl
  9635
  9636 6000-GET-AH-AM-REM-TERM.
  9637     MOVE +1                     TO SUB3.
  9638
  9639 6100-GET-AH-AM-REM-TERM.
  9640
  9641     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9642        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9643           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9644                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9645           GO TO 6300-MOVE-AH-REM-TERM.
  9646
  9647     IF SUB3 LESS THAN +20
  9648        ADD +1                   TO SUB3
  9649        GO TO 6100-GET-AH-AM-REM-TERM.
  9650
  9651     MOVE +1                     TO SUB3.
  9652
  9653     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9654         GO TO 6200-EDIT-FOR-NINETY-AH.
  9655
  9656 6100-GET-AH-AM-DMD-REM-TERM.
  9657     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9658        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9659           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9660                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9661           GO TO 6300-MOVE-AH-REM-TERM.
  9662
  9663     IF SUB3 LESS THAN +30
  9664        ADD +1                   TO SUB3
  9665        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9666
  9667     MOVE +1                     TO SUB3.
  9668
  9669 6200-EDIT-FOR-NINETY-AH.
  9670
  9671***************************************************************
  9672*                                                             *
  9673*    NINETY BENEFIT PLAN TYPES:                               *
  9674*                                                             *
  9675*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9676*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9677*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9678*           BENEFIT CONTROLS.                                 *
  9679*      99 = ALL BENEFITS.                                     *
  9680*                                                             *
  9681***************************************************************
  9682
  9683     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9684                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9685
  9686     IF AM-BENEFIT-CODE (SUB3) = '99'
  9687       AND
  9688        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9689           GO TO 6300-MOVE-AH-REM-TERM.
  9690
  9691     IF AM-BENEFIT-CODE (SUB3) = '91'
  9692       AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 180
* EL1278.cbl
  9693        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9694           IF CM-INDIVIDUAL
  9695               GO TO 6300-MOVE-AH-REM-TERM.
  9696
  9697     IF AM-BENEFIT-CODE (SUB3) = '92'
  9698       AND
  9699        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9700           IF CM-GROUP
  9701               GO TO 6300-MOVE-AH-REM-TERM.
  9702
  9703     IF AM-BENEFIT-CODE (SUB3) = '98'
  9704       AND
  9705        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9706           GO TO 6300-MOVE-AH-REM-TERM.
  9707
  9708     IF SUB3 LESS THAN +20
  9709        ADD +1                    TO SUB3
  9710        GO TO 6200-EDIT-FOR-NINETY-AH.
  9711
  9712     MOVE +1                      TO SUB3.
  9713
  9714     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9715         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9716         GO TO 6900-EXIT.
  9717
  9718 6200-EDIT-FOR-DMD-NINETY-AH.
  9719
  9720     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9721                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9722
  9723     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9724       AND
  9725        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9726           GO TO 6300-MOVE-AH-REM-TERM.
  9727
  9728     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9729       AND
  9730        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9731           IF CM-INDIVIDUAL
  9732               GO TO 6300-MOVE-AH-REM-TERM.
  9733
  9734     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9735       AND
  9736        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9737           IF CM-GROUP
  9738               GO TO 6300-MOVE-AH-REM-TERM.
  9739
  9740     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9741       AND
  9742        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9743           GO TO 6300-MOVE-AH-REM-TERM.
  9744
  9745     IF SUB3 LESS THAN +30
  9746        ADD +1                   TO SUB3
  9747        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9748
  9749     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9750
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 181
* EL1278.cbl
  9751     GO TO 6900-EXIT.
  9752
  9753 6300-MOVE-AH-REM-TERM.
  9754
  9755     MOVE WS-SAVE-BENEFIT-REM-TERM
  9756                                 TO WS-AH-AM-REM-TERM-CALC.
  9757
  9758 6900-EXIT.
  9759      EXIT.
  9760
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 182
* EL1278.cbl
  9762 7000-GET-ERFORM     SECTION.
  9763
  9764* EXEC CICS HANDLE CONDITION
  9765*        NOTFND  (7000-EXIT)
  9766*    END-EXEC.
  9767*    MOVE '"$I                   ! ( #00009134' TO DFHEIV0
  9768     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9770     MOVE X'2820233030303039313334' TO DFHEIV0(25:11)
  9771     CALL 'kxdfhei1' USING DFHEIV0
  9772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9773
  9774
  9775     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9776     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9777     MOVE PI-STATE               TO  WS-FO-STATE.
  9778     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9779     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9780
  9781
  9782* EXEC CICS READ
  9783*        DATASET  (ERFORM-ID)
  9784*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9785*        SET      (ADDRESS OF FORM-MASTER)
  9786*        GTEQ
  9787*    END-EXEC.
  9788*    MOVE '&"S        G          (   #00009144' TO DFHEIV0
  9789     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9791     MOVE X'2020233030303039313434' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0,
  9793           ERFORM-ID,
  9794           DFHEIV20,
  9795           DFHEIV99,
  9796           WS-FO-CONTROL-PRIMARY,
  9797           DFHEIV99,
  9798           DFHEIV99,
  9799           DFHEIV99
  9800     SET ADDRESS OF FORM-MASTER TO
  9801         DFHEIV20
  9802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9803
  9804
  9805     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9806        PI-STATE          EQUAL FO-STATE      AND
  9807        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9808         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9809         GO TO 7000-EXIT.
  9810 7000-EXIT.
  9811     EXIT.
  9812 7100-BENEFIT-SEARCH SECTION.
  9813
  9814     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9815        MOVE +1                  TO  SUB4
  9816        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9817
  9818     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9819        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 183
* EL1278.cbl
  9820        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9821 7100-EXIT.
  9822     EXIT.
  9823 7150-BENEFIT-LIFE-SEARCH.
  9824     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9825       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9826         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9827          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9828            IF FO-PLAN-REFUND-METHOD (SUB4)
  9829                    IS GREATER THAN SPACES
  9830               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9831                                    WS-LF-FO-REFUND-CALC
  9832               GO TO 7150-EXIT.
  9833
  9834     IF SUB4 LESS THAN +40
  9835         ADD +1              TO SUB4
  9836         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9837
  9838 7150-EXIT.
  9839     EXIT.
  9840 7250-BENEFIT-AH-SEARCH.
  9841     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9842       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9843         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9844          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9845            IF FO-PLAN-REFUND-METHOD (SUB4)
  9846                    IS GREATER THAN SPACES
  9847               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9848                                    WS-AH-FO-REFUND-CALC
  9849               GO TO 7250-EXIT.
  9850
  9851     IF SUB4 LESS THAN +40
  9852         ADD +1              TO SUB4
  9853         GO TO 7250-BENEFIT-AH-SEARCH.
  9854
  9855 7250-EXIT.
  9856     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 184
* EL1278.cbl
  9858
  9859 8100-SEND-INITIAL-MAP  SECTION.
  9860     MOVE SAVE-DATE              TO  HDATEO.
  9861     MOVE EIBTIME                TO  TIME-IN.
  9862     MOVE TIME-OUT               TO  HTIMEO.
  9863     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9864     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9865     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9866     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9867
  9868     IF CM-LF-BENEFIT-CD = '00'
  9869         MOVE -1                 TO  HACANCL
  9870     ELSE
  9871         MOVE -1                 TO  HLCANCL.
  9872
  9873     if pi-company-id = 'VPP'
  9874        move al-sanof            to refdueha
  9875                                    canfeeha
  9876        move al-uanof            to refduea
  9877                                    canfeea
  9878     end-if
  9879     IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9880        MOVE AL-SADOF            TO CANREAHA
  9881                                    CLPYNHA
  9882                                    CANREAA
  9883                                    CLPYNA
  9884     END-IF
  9885
  9886
  9887* EXEC CICS SEND
  9888*        FROM    (EL127HO)
  9889*        MAPSET  (MAPSET-NAME)
  9890*        MAP     (MAP-NAME)
  9891*        CURSOR
  9892*        ERASE
  9893*    END-EXEC.
  9894     MOVE LENGTH OF
  9895      EL127HO
  9896       TO DFHEIV12
  9897     MOVE -1
  9898       TO DFHEIV11
  9899*    MOVE '8$     CT  E    H L F ,   #00009232' TO DFHEIV0
  9900     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9901     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9902     MOVE X'2020233030303039323332' TO DFHEIV0(25:11)
  9903     CALL 'kxdfhei1' USING DFHEIV0,
  9904           MAP-NAME,
  9905           EL127HO,
  9906           DFHEIV12,
  9907           MAPSET-NAME,
  9908           DFHEIV99,
  9909           DFHEIV99,
  9910           DFHEIV99,
  9911           DFHEIV11,
  9912           DFHEIV99,
  9913           DFHEIV99,
  9914           DFHEIV99
  9915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 185
* EL1278.cbl
  9916
  9917
  9918     GO TO 9000-RETURN-TRAN.
  9919
  9920 8200-SEND-DATAONLY  SECTION.
  9921     IF FIRST-ENTRY
  9922         GO TO 8100-SEND-INITIAL-MAP.
  9923
  9924     MOVE SAVE-DATE              TO  HDATEO.
  9925     MOVE EIBTIME                TO  TIME-IN.
  9926     MOVE TIME-OUT               TO  HTIMEO.
  9927     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9928     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9929     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9930     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9931     MOVE -1                     TO  HLCANCL.
  9932
  9933
  9934* EXEC CICS SEND DATAONLY
  9935*        FROM    (EL127HO)
  9936*        MAPSET  (MAPSET-NAME)
  9937*        MAP     (MAP-NAME)
  9938*        CURSOR
  9939*    END-EXEC.
  9940     MOVE LENGTH OF
  9941      EL127HO
  9942       TO DFHEIV12
  9943     MOVE -1
  9944       TO DFHEIV11
  9945*    MOVE '8$D    CT       H L F ,   #00009255' TO DFHEIV0
  9946     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9947     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9948     MOVE X'2020233030303039323535' TO DFHEIV0(25:11)
  9949     CALL 'kxdfhei1' USING DFHEIV0,
  9950           MAP-NAME,
  9951           EL127HO,
  9952           DFHEIV12,
  9953           MAPSET-NAME,
  9954           DFHEIV99,
  9955           DFHEIV99,
  9956           DFHEIV99,
  9957           DFHEIV11,
  9958           DFHEIV99,
  9959           DFHEIV99,
  9960           DFHEIV99
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9962
  9963
  9964     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 186
* EL1278.cbl
  9966 8300-SEND-TEXT  SECTION.
  9967
  9968* EXEC CICS SEND TEXT
  9969*        FROM    (LOGOFF-TEXT)
  9970*        LENGTH  (LOGOFF-LENGTH)
  9971*        ERASE
  9972*        FREEKB
  9973*    END-EXEC.
  9974*    MOVE '8&      T  E F  H   F -   #00009265' TO DFHEIV0
  9975     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9976     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9977     MOVE X'2020233030303039323635' TO DFHEIV0(25:11)
  9978     CALL 'kxdfhei1' USING DFHEIV0,
  9979           LOGOFF-TEXT,
  9980           LOGOFF-LENGTH,
  9981           DFHEIV99,
  9982           DFHEIV99,
  9983           DFHEIV99,
  9984           DFHEIV99,
  9985           DFHEIV99,
  9986           DFHEIV99,
  9987           DFHEIV99,
  9988           DFHEIV99,
  9989           DFHEIV99,
  9990           DFHEIV99
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9992
  9993
  9994
  9995* EXEC CICS RETURN
  9996*    END-EXEC.
  9997*    MOVE '.(                    ''   #00009272' TO DFHEIV0
  9998     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10000     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
 10001     CALL 'kxdfhei1' USING DFHEIV0,
 10002           DFHEIV99,
 10003           DFHEIV99,
 10004           DFHEIV99,
 10005           DFHEIV99,
 10006           DFHEIV99,
 10007           DFHEIV99
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10009
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 187
* EL1278.cbl
 10011 8600-DEEDIT  SECTION.
 10012
 10013* EXEC CICS BIF DEEDIT
 10014*        FIELD   (DEEDIT-FIELD)
 10015*        LENGTH  (15)
 10016*    END-EXEC.
 10017     MOVE 15
 10018       TO DFHEIV11
 10019*    MOVE '@"L                   #   #00009276' TO DFHEIV0
 10020     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10022     MOVE X'2020233030303039323736' TO DFHEIV0(25:11)
 10023     CALL 'kxdfhei1' USING DFHEIV0,
 10024           DEEDIT-FIELD,
 10025           DFHEIV11
 10026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10027
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 188
* EL1278.cbl
 10029 8700-UNAUTHORIZED-ACCESS  SECTION.
 10030     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10031
 10032     GO TO 8300-SEND-TEXT.
 10033
 10034 8800-PF23  SECTION.
 10035     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10036     MOVE XCTL-005               TO  PGM-NAME.
 10037
 10038     GO TO 9200-XCTL.
 10039
 10040 8900-RETURN-CICS  SECTION.
 10041
 10042* EXEC CICS RETURN
 10043*    END-EXEC.
 10044*    MOVE '.(                    ''   #00009293' TO DFHEIV0
 10045     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10047     MOVE X'2020233030303039323933' TO DFHEIV0(25:11)
 10048     CALL 'kxdfhei1' USING DFHEIV0,
 10049           DFHEIV99,
 10050           DFHEIV99,
 10051           DFHEIV99,
 10052           DFHEIV99,
 10053           DFHEIV99,
 10054           DFHEIV99
 10055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10056
 10057
 10058 9000-RETURN-TRAN  SECTION.
 10059     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10060     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10061
 10062
 10063* EXEC CICS RETURN
 10064*        TRANSID   (TRANS-ID)
 10065*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10066*        LENGTH    (PI-COMM-LENGTH)
 10067*    END-EXEC.
 10068*    MOVE '.(CT                  ''   #00009300' TO DFHEIV0
 10069     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10071     MOVE X'2020233030303039333030' TO DFHEIV0(25:11)
 10072     CALL 'kxdfhei1' USING DFHEIV0,
 10073           TRANS-ID,
 10074           PROGRAM-INTERFACE-BLOCK,
 10075           PI-COMM-LENGTH,
 10076           DFHEIV99,
 10077           DFHEIV99,
 10078           DFHEIV99
 10079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10080
 10081
 10082 9100-RETURN-MAIN-MENU  SECTION.
 10083     MOVE XCTL-126               TO  PGM-NAME.
 10084
 10085     GO TO 9200-XCTL.
 10086
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 189
* EL1278.cbl
 10087 9200-XCTL  SECTION.
 10088
 10089* EXEC CICS XCTL
 10090*        PROGRAM   (PGM-NAME)
 10091*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10092*        LENGTH    (PI-COMM-LENGTH)
 10093*    END-EXEC.
 10094*    MOVE '.$C                   %   #00009312' TO DFHEIV0
 10095     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10096     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10097     MOVE X'2020233030303039333132' TO DFHEIV0(25:11)
 10098     CALL 'kxdfhei1' USING DFHEIV0,
 10099           PGM-NAME,
 10100           PROGRAM-INTERFACE-BLOCK,
 10101           PI-COMM-LENGTH,
 10102           DFHEIV99
 10103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10104
 10105
 10106 9300-CLEAR  SECTION.
 10107     MOVE ' '                    TO  PI-PEND-SW.
 10108     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10109
 10110     GO TO 9200-XCTL.
 10111
 10112 9400-PF12  SECTION.
 10113     MOVE XCTL-010               TO  PGM-NAME.
 10114
 10115     GO TO 9200-XCTL.
 10116
 10117 9500-PGMID-ERROR  SECTION.
 10118
 10119* EXEC CICS HANDLE CONDITION
 10120*        PGMIDERR  (8300-SEND-TEXT)
 10121*    END-EXEC.
 10122*    MOVE '"$L                   ! ) #00009330' TO DFHEIV0
 10123     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10125     MOVE X'2920233030303039333330' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0
 10127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10128
 10129
 10130     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10131     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10132     MOVE XCTL-005               TO  PGM-NAME.
 10133     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10134     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10135
 10136     GO TO 9200-XCTL.
 10137
 10138 9600-DATE-LINK  SECTION.
 10139     MOVE LINK-ELDATCV           TO  PGM-NAME
 10140
 10141
 10142* EXEC CICS LINK
 10143*        PROGRAM   (PGM-NAME)
 10144*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 190
* EL1278.cbl
 10145*        LENGTH    (DC-COMM-LENGTH)
 10146*    END-EXEC.
 10147*    MOVE '."C                   (   #00009345' TO DFHEIV0
 10148     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10150     MOVE X'2020233030303039333435' TO DFHEIV0(25:11)
 10151     CALL 'kxdfhei1' USING DFHEIV0,
 10152           PGM-NAME,
 10153           DATE-CONVERSION-DATA,
 10154           DC-COMM-LENGTH,
 10155           DFHEIV99,
 10156           DFHEIV99,
 10157           DFHEIV99,
 10158           DFHEIV99
 10159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10160
 10161
 10162
 10163 9700-ERROR-FORMAT  SECTION.
 10164     IF NOT EMI-ERRORS-COMPLETE
 10165         MOVE LINK-001               TO  PGM-NAME
 10166
 10167* EXEC CICS LINK
 10168*            PROGRAM   (PGM-NAME)
 10169*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10170*            LENGTH    (EMI-COMM-LENGTH)
 10171*        END-EXEC.
 10172*    MOVE '."C                   (   #00009355' TO DFHEIV0
 10173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303039333535' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           PGM-NAME,
 10178           ERROR-MESSAGE-INTERFACE-BLOCK,
 10179           EMI-COMM-LENGTH,
 10180           DFHEIV99,
 10181           DFHEIV99,
 10182           DFHEIV99,
 10183           DFHEIV99
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187 9799-EXIT.
 10188     EXIT.
 10189
 10190 9800-SECURITY-VIOLATION  SECTION.
 10191*                            COPY ELCSCTP.
 10192******************************************************************
 10193*                                                                *
 10194*                            ELCSCTP                             *
 10195*                            VMOD=2.001                          *
 10196*                                                                *
 10197*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10198******************************************************************
 10199
 10200
 10201     MOVE EIBDATE          TO SM-JUL-DATE.
 10202     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 191
* EL1278.cbl
 10203     MOVE THIS-PGM         TO SM-PGM.
 10204     MOVE EIBTIME          TO TIME-IN.
 10205     MOVE TIME-OUT         TO SM-TIME.
 10206     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10207
 10208
 10209* EXEC CICS LINK
 10210*         PROGRAM  ('EL003')
 10211*         COMMAREA (SECURITY-MESSAGE)
 10212*         LENGTH   (80)
 10213*    END-EXEC.
 10214     MOVE 'EL003' TO DFHEIV1
 10215     MOVE 80
 10216       TO DFHEIV11
 10217*    MOVE '."C                   (   #00009382' TO DFHEIV0
 10218     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10220     MOVE X'2020233030303039333832' TO DFHEIV0(25:11)
 10221     CALL 'kxdfhei1' USING DFHEIV0,
 10222           DFHEIV1,
 10223           SECURITY-MESSAGE,
 10224           DFHEIV11,
 10225           DFHEIV99,
 10226           DFHEIV99,
 10227           DFHEIV99,
 10228           DFHEIV99
 10229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10230
 10231
 10232******************************************************************
 10233
 10234
 10235 9899-EXIT.
 10236     EXIT.
 10237
 10238 9900-ABEND  SECTION.
 10239     MOVE LINK-004               TO  PGM-NAME.
 10240     MOVE DFHEIBLK               TO  EMI-LINE1.
 10241
 10242
 10243* EXEC CICS LINK
 10244*        PROGRAM   (PGM-NAME)
 10245*        COMMAREA  (EMI-LINE1)
 10246*        LENGTH    (72)
 10247*    END-EXEC.
 10248     MOVE 72
 10249       TO DFHEIV11
 10250*    MOVE '."C                   (   #00009398' TO DFHEIV0
 10251     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10253     MOVE X'2020233030303039333938' TO DFHEIV0(25:11)
 10254     CALL 'kxdfhei1' USING DFHEIV0,
 10255           PGM-NAME,
 10256           EMI-LINE1,
 10257           DFHEIV11,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 192
* EL1278.cbl
 10261           DFHEIV99
 10262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10263
 10264
 10265     MOVE -1                     TO  HLCANCL.
 10266
 10267     GO TO 8200-SEND-DATAONLY.
 10268
 10269 9999-LAST-PARAGRAPH.
 10270
 10271* GOBACK.
 10272     MOVE '9%                    "   ' TO DFHEIV0
 10273     MOVE 'EL1278' TO DFHEIV1
 10274     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10275     GOBACK.
 10276
 10277 9999-DFHBACK SECTION.
 10278     MOVE '9%                    "   ' TO DFHEIV0
 10279     MOVE 'EL1278' TO DFHEIV1
 10280     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10281     GOBACK.
 10282 9999-DFHEXIT.
 10283     IF DFHEIGDJ EQUAL 0001
 10284         NEXT SENTENCE
 10285     ELSE IF DFHEIGDJ EQUAL 2
 10286         GO TO 9500-PGMID-ERROR,
 10287               9900-ABEND
 10288         DEPENDING ON DFHEIGDI
 10289     ELSE IF DFHEIGDJ EQUAL 3
 10290         GO TO 0910-NOT-FOUND
 10291         DEPENDING ON DFHEIGDI
 10292     ELSE IF DFHEIGDJ EQUAL 4
 10293         GO TO 1010-NOTFND,
 10294               1020-NOTOPEN
 10295         DEPENDING ON DFHEIGDI
 10296     ELSE IF DFHEIGDJ EQUAL 5
 10297         GO TO 1290-ACCT-NOT-FOUND,
 10298               1290-ACCT-NOT-FOUND
 10299         DEPENDING ON DFHEIGDI
 10300     ELSE IF DFHEIGDJ EQUAL 6
 10301         GO TO 0580-ACCT-NOT-FOUND,
 10302               0580-ACCT-NOT-FOUND
 10303         DEPENDING ON DFHEIGDI
 10304     ELSE IF DFHEIGDJ EQUAL 7
 10305         GO TO 1699-EXIT
 10306         DEPENDING ON DFHEIGDI
 10307     ELSE IF DFHEIGDJ EQUAL 8
 10308         GO TO 7000-EXIT
 10309         DEPENDING ON DFHEIGDI
 10310     ELSE IF DFHEIGDJ EQUAL 9
 10311         GO TO 8300-SEND-TEXT
 10312         DEPENDING ON DFHEIGDI.
 10313     MOVE '9%                    "   ' TO DFHEIV0
 10314     MOVE 'EL1278' TO DFHEIV1
 10315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10316     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-17 09:45 Page 193
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8696     Code:       26683
