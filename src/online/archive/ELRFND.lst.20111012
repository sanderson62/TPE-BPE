* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* ELRFND.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRFND.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* ELRFND.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66
    67 01  WS-WORK-MISC.
    68     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    69     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    70     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    71     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    72     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    74     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    75     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    76     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    77     12  WS-SAVE-EARN-METHOD PIC X.
    78     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    79     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    80     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    81     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    82     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-5            PIC S9(7)        COMP-3.
    84     12  FACTOR-6            PIC S9(7)        COMP-3.
    85     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    86     12  RATE-FACTOR-2       PIC S999         COMP-3.
    87     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    88     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    89     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    90     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    91
    92 01  TEXAS-REG-WORK-AREAS.
    93     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    94     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    95     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    96     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    97     12  TEX-FACT-5          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-6          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   101     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   102
   103 01  NET-PAY-INTERFACE.
   104     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   105     12  N-P-ORIG            PIC S9(3)       COMP-3.
   106     12  N-P-REM             PIC S9(3)       COMP-3.
   107     12  N-P-OPT             PIC X.
   108     12  N-P-LOAN            PIC S9(3)       COMP-3.
   109     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   110
   111*                        COPY ERCNETWS.
   112*****************************************************************
   113*                                                               *
   114*                                                               *
   115*                            ERCNETWS                           *
   116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   117*                            VMOD=2.014                         *
   118*                                                               *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* ELRFND.cbl
   119*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   120*                                                               *
   121*****************************************************************.
   122*                   C H A N G E   L O G
   123*
   124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   125*-----------------------------------------------------------------
   126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   127* EFFECTIVE    NUMBER
   128*-----------------------------------------------------------------
   129* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   130* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   131* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   132******************************************************************
   133
   134 01  NET-PAY-WORK-AREA.
   135     12  OPTION-SW               PIC X   VALUE 'X'.
   136        88  NPO-STD         VALUE SPACE.
   137        88  NPO-ALT         VALUE 'A'.
   138        88  NPO-SIMPLE      VALUE 'S'.
   139        88  NPO-2MO         VALUE 'I'.
   140        88  NPO-3MO         VALUE 'J'.
   141        88  NPO-4MO         VALUE 'K'.
   142        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   143        88  NPO-TRUNC-0     VALUE 'T'.
   144        88  NPO-TRUNC-1     VALUE 'U'.
   145        88  NPO-TRUNC-2     VALUE 'V'.
   146        88  NPO-TRUNC-3     VALUE 'W'.
   147        88  NPO-TRUNC-4     VALUE 'X'.
   148        88  NPO-REFUND      VALUE 'R'.
   149        88  NPO-PRUDENTIAL  VALUE 'P'.
   150
   151     12  TYPE-SW             PIC X   VALUE 'N'.
   152        88  NET-STD             VALUE 'N'.
   153        88  NET-SMP             VALUE 'S'.
   154
   155     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   156        88  NP-RATING           VALUE '1'.
   157        88  NP-REFUND           VALUE '2'.
   158        88  NP-REMAIN-AMT       VALUE '3'.
   159
   160     12  COMP-3-WORK-AREA         COMP-3.
   161         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   162         16  V               PIC SV9(13)       VALUE +.0.
   163         16  J               PIC SV9(9)        VALUE +0.
   164         16  K               PIC SV9(9)        VALUE +0.
   165         16  I               PIC SV9(10)       VALUE +.0.
   166         16  D               PIC S9(5)         VALUE +.0.
   167         16  APR100          PIC SV9(9)        VALUE +.0.
   168         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   169         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   170         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   171         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   172         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   173         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   174         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   175         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   176         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* ELRFND.cbl
   177         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   178         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   179         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   180         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   181         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   182         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   183         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   184         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   185         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   186         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   187         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   188         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   189         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   190         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   191         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   192         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   193         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   194         16  K1              PIC S999          VALUE +1.
   195         16  K12             PIC S999          VALUE +12.
   196         16  K100            PIC S999          VALUE +100.
   197         16  K1000           PIC S9(7)         VALUE +1000.
   198         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   199         16  Y REDEFINES NC-LR
   200                             PIC S99V9(5).
   201         16  TI              PIC S999V9(5)     VALUE +0.
   202         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   203         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   204         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   205         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   206         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   207         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   208         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   209         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   210
   211         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   212         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   213         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   214         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   215         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   216         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   217         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   218         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   219         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   220         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   221         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   222         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   223         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   224
   225         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   226
   227         16  ORIGINAL-TERM   PIC S999.
   228         16  M              REDEFINES ORIGINAL-TERM
   229                             PIC S999.
   230
   231         16  REMAINING-TERM  PIC S999.
   232         16  R              REDEFINES REMAINING-TERM
   233                             PIC S999.
   234
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* ELRFND.cbl
   235         16  LOAN-TERM       PIC S999.
   236         16  N              REDEFINES LOAN-TERM
   237                             PIC S999.
   238
   239         16  EXPIRED-TERM    PIC S999.
   240         16  E              REDEFINES EXPIRED-TERM
   241                             PIC S999.
   242
   243         16  PRUDENTIAL-WORK-AMT
   244                             PIC S9(7)V9(8).
   245         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   246                             PIC S9(7)V9(8).
   247
   248         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   249         16  VX              PIC S9V9(13)      VALUE +0.0.
   250         16  SV              PIC S9V9(13)      VALUE +0.0.
   251         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   252         16  SX              PIC S9V9(13)      VALUE +0.0.
   253         16  SE              PIC S9V9(10)      VALUE +0.0.
   254         16  N2              PIC S9(7)         VALUE +0.
   255         16  N3              PIC S9(7)         VALUE +0.
   256         16  K-I             PIC S9V9(8)       VALUE +0.0.
   257
   258     12  BINARY-WORK-AREA        COMP.
   259         16  X1              PIC S999        VALUE +0.
   260         16  X2              PIC S999        VALUE +0.
   261         16  MAX-X           PIC S9(5)       VALUE +0.
   262         16  B1              PIC S9(5)       VALUE +1.
   263         16  LINDX           PIC S999        VALUE ZEROS.
   264         16  AHNDX           PIC S999        VALUE ZEROS.
   265
   266     12  WS-WORK-MISC.
   267         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   268         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   269*        16  WS-AGE              PIC 99           VALUE ZEROS.
   270         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   271         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   272         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   273         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   274         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   275         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   276         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   277         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   278         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   279         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   280         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   281         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   282******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* ELRFND.cbl
   284*                        COPY ELCDATE.
   285******************************************************************
   286*                                                                *
   287*                                                                *
   288*                            ELCDATE.                            *
   289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   290*                            VMOD=2.003
   291*                                                                *
   292*                                                                *
   293*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   294*                 LENGTH = 200                                   *
   295******************************************************************
   296
   297 01  DATE-CONVERSION-DATA.
   298     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   299     12  DC-OPTION-CODE                PIC X.
   300         88  BIN-TO-GREG                VALUE ' '.
   301         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   302         88  EDIT-GREG-TO-BIN           VALUE '2'.
   303         88  YMD-GREG-TO-BIN            VALUE '3'.
   304         88  MDY-GREG-TO-BIN            VALUE '4'.
   305         88  JULIAN-TO-BIN              VALUE '5'.
   306         88  BIN-PLUS-ELAPSED           VALUE '6'.
   307         88  FIND-CENTURY               VALUE '7'.
   308         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   309         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   310         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   311         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   312         88  JULIAN-TO-BIN-3            VALUE 'C'.
   313         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   314         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   315         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   316         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   317         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   318         88  CHECK-LEAP-YEAR            VALUE 'H'.
   319         88  BIN-3-TO-GREG              VALUE 'I'.
   320         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   321         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   322         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   323         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   324         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   325         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   326         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   327         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   328         88  THREE-CHARACTER-BIN
   329                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   330         88  GREGORIAN-TO-BIN
   331                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   332         88  BIN-TO-GREGORIAN
   333                  VALUES ' ' '1' 'I' '8' 'G'.
   334         88  JULIAN-TO-BINARY
   335                  VALUES '5' 'C' 'E' 'F'.
   336     12  DC-ERROR-CODE                 PIC X.
   337         88  NO-CONVERSION-ERROR        VALUE ' '.
   338         88  DATE-CONVERSION-ERROR
   339                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   340         88  DATE-IS-ZERO               VALUE '1'.
   341         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* ELRFND.cbl
   342         88  DATE-IS-INVALID            VALUE '3'.
   343         88  DATE1-GREATER-DATE2        VALUE '4'.
   344         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   345         88  DATE-INVALID-OPTION        VALUE '9'.
   346         88  INVALID-CENTURY            VALUE 'A'.
   347         88  ONLY-CENTURY               VALUE 'B'.
   348         88  ONLY-LEAP-YEAR             VALUE 'C'.
   349         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   350     12  DC-END-OF-MONTH               PIC X.
   351         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   352     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   353         88  USE-NORMAL-PROCESS         VALUE ' '.
   354         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   355         88  ADJUST-UP-100-YRS          VALUE '2'.
   356     12  FILLER                        PIC X.
   357     12  DC-CONVERSION-DATES.
   358         16  DC-BIN-DATE-1             PIC XX.
   359         16  DC-BIN-DATE-2             PIC XX.
   360         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   361         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   362                       DC-GREG-DATE-1-EDIT.
   363             20  DC-EDIT1-MONTH        PIC 99.
   364             20  SLASH1-1              PIC X.
   365             20  DC-EDIT1-DAY          PIC 99.
   366             20  SLASH1-2              PIC X.
   367             20  DC-EDIT1-YEAR         PIC 99.
   368         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   369         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   370                     DC-GREG-DATE-2-EDIT.
   371             20  DC-EDIT2-MONTH        PIC 99.
   372             20  SLASH2-1              PIC X.
   373             20  DC-EDIT2-DAY          PIC 99.
   374             20  SLASH2-2              PIC X.
   375             20  DC-EDIT2-YEAR         PIC 99.
   376         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   377         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   378                     DC-GREG-DATE-1-YMD.
   379             20  DC-YMD-YEAR           PIC 99.
   380             20  DC-YMD-MONTH          PIC 99.
   381             20  DC-YMD-DAY            PIC 99.
   382         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   383         16  DC-GREG-DATE-1-MDY-R REDEFINES
   384                      DC-GREG-DATE-1-MDY.
   385             20  DC-MDY-MONTH          PIC 99.
   386             20  DC-MDY-DAY            PIC 99.
   387             20  DC-MDY-YEAR           PIC 99.
   388         16  DC-GREG-DATE-1-ALPHA.
   389             20  DC-ALPHA-MONTH        PIC X(10).
   390             20  DC-ALPHA-DAY          PIC 99.
   391             20  FILLER                PIC XX.
   392             20  DC-ALPHA-CENTURY.
   393                 24 DC-ALPHA-CEN-N     PIC 99.
   394             20  DC-ALPHA-YEAR         PIC 99.
   395         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   396         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   397         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   398         16  DC-JULIAN-DATE            PIC 9(05).
   399         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* ELRFND.cbl
   400                                       PIC 9(05).
   401         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   402             20  DC-JULIAN-YEAR        PIC 99.
   403             20  DC-JULIAN-DAYS        PIC 999.
   404         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   405         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   406         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   407     12  DATE-CONVERSION-VARIBLES.
   408         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   409         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   410             20  FILLER                PIC 9(3).
   411             20  HOLD-CEN-1-CCYY.
   412                 24  HOLD-CEN-1-CC     PIC 99.
   413                 24  HOLD-CEN-1-YY     PIC 99.
   414             20  HOLD-CEN-1-MO         PIC 99.
   415             20  HOLD-CEN-1-DA         PIC 99.
   416         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   417             20  HOLD-CEN-1-R-MO       PIC 99.
   418             20  HOLD-CEN-1-R-DA       PIC 99.
   419             20  HOLD-CEN-1-R-CCYY.
   420                 24  HOLD-CEN-1-R-CC   PIC 99.
   421                 24  HOLD-CEN-1-R-YY   PIC 99.
   422             20  FILLER                PIC 9(3).
   423         16  HOLD-CENTURY-1-X.
   424             20  FILLER                PIC X(3)  VALUE SPACES.
   425             20  HOLD-CEN-1-X-CCYY.
   426                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   427                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   428             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   429             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   430         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   431             20  HOLD-CEN-1-R-X-MO     PIC XX.
   432             20  HOLD-CEN-1-R-X-DA     PIC XX.
   433             20  HOLD-CEN-1-R-X-CCYY.
   434                 24  HOLD-CEN-1-R-X-CC PIC XX.
   435                 24  HOLD-CEN-1-R-X-YY PIC XX.
   436             20  FILLER                PIC XXX.
   437         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   438         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   439         16  DC-JULIAN-DATE-1          PIC 9(07).
   440         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   441             20  DC-JULIAN-1-CCYY.
   442                 24  DC-JULIAN-1-CC    PIC 99.
   443                 24  DC-JULIAN-1-YR    PIC 99.
   444             20  DC-JULIAN-DA-1        PIC 999.
   445         16  DC-JULIAN-DATE-2          PIC 9(07).
   446         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   447             20  DC-JULIAN-2-CCYY.
   448                 24  DC-JULIAN-2-CC    PIC 99.
   449                 24  DC-JULIAN-2-YR    PIC 99.
   450             20  DC-JULIAN-DA-2        PIC 999.
   451         16  DC-GREG-DATE-A-EDIT.
   452             20  DC-EDITA-MONTH        PIC 99.
   453             20  SLASHA-1              PIC X VALUE '/'.
   454             20  DC-EDITA-DAY          PIC 99.
   455             20  SLASHA-2              PIC X VALUE '/'.
   456             20  DC-EDITA-CCYY.
   457                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* ELRFND.cbl
   458                 24  DC-EDITA-YEAR     PIC 99.
   459         16  DC-GREG-DATE-B-EDIT.
   460             20  DC-EDITB-MONTH        PIC 99.
   461             20  SLASHB-1              PIC X VALUE '/'.
   462             20  DC-EDITB-DAY          PIC 99.
   463             20  SLASHB-2              PIC X VALUE '/'.
   464             20  DC-EDITB-CCYY.
   465                 24  DC-EDITB-CENT     PIC 99.
   466                 24  DC-EDITB-YEAR     PIC 99.
   467         16  DC-GREG-DATE-CYMD         PIC 9(08).
   468         16  DC-GREG-DATE-CYMD-R REDEFINES
   469                              DC-GREG-DATE-CYMD.
   470             20  DC-CYMD-CEN           PIC 99.
   471             20  DC-CYMD-YEAR          PIC 99.
   472             20  DC-CYMD-MONTH         PIC 99.
   473             20  DC-CYMD-DAY           PIC 99.
   474         16  DC-GREG-DATE-MDCY         PIC 9(08).
   475         16  DC-GREG-DATE-MDCY-R REDEFINES
   476                              DC-GREG-DATE-MDCY.
   477             20  DC-MDCY-MONTH         PIC 99.
   478             20  DC-MDCY-DAY           PIC 99.
   479             20  DC-MDCY-CEN           PIC 99.
   480             20  DC-MDCY-YEAR          PIC 99.
   481    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   482        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   483    12  DC-EL310-DATE                  PIC X(21).
   484    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* ELRFND.cbl
   486*                        COPY ELCCALC.
   487******************************************************************
   488*                                                                *
   489*                           ELCCALC.                            *
   490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   491*                            VMOD=2.025                          *
   492*                                                                *
   493*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   494*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   495*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   496*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   497*                                                                *
   498*  PASSED TO ELRTRM                                              *
   499*  -----------------                                             *
   500*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   501*  ORIGINAL TERM                                                 *
   502*  BEGINNING DATE                                                *
   503*  ENDING DATE                                                   *
   504*  COMPANY I.D.                                                  *
   505*  ACCOUNT MASTER USER FIELD                                     *
   506*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   507*  FREE LOOK DAYS                                                *
   508*                                                                *
   509*  RETURNED FROM ELRTRM                                          *
   510*  ---------------------                                         *
   511*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   512*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   513*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   514*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   515*----------------------------------------------------------------*
   516*  PASSED TO ELRAMT                                              *
   517*  ----------------                                              *
   518*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   519*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   520*  ORIGINAL AMOUNT                                               *
   521*  ALTERNATE BENEFIT (BALLON)                                    *
   522*  A.P.R. - NET PAY ONLY                                         *
   523*  METHOD
   524*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   525*  COMPANY I.D.                                                  *
   526*  BENEFIT TYPE                                                  *
   527*                                                                *
   528*  RETURNED FROM ELRAMT                                          *
   529*  --------------------                                          *
   530*  REMAINING AMOUNT 1 - CURRENT                                  *
   531*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   532*  REMAINING AMOUNT FACTOR
   533*----------------------------------------------------------------*
   534*  PASSED TO ELRESV                                              *
   535*  -----------------                                             *
   536*  CERTIFICATE EFFECTIVE DATE                                    *
   537*  VALUATION DATE                                                *
   538*  PAID THRU DATE                                                *
   539*  BENEFIT                                                       *
   540*  INCURRED DATE                                                 *
   541*  REPORTED DATE                                                 *
   542*  ISSUE AGE                                                     *
   543*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* ELRFND.cbl
   544*  CDT PERCENT                                                   *
   545*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   546* *CLAIM TYPE (LIFE, A/H)                                        *
   547* *REMAINING BENEFIT (FROM ELRAMT)                               *
   548* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   549*                                                                *
   550*  RETURNED FROM ELRESV                                          *
   551*  --------------------                                          *
   552*  CDT TABLE USED                                                *
   553*  CDT FACTOR USED                                               *
   554*  PAY TO CURRENT RESERVE                                        *
   555*  I.B.N.R. - A/H ONLY                                           *
   556*  FUTURE (ACCRUED) AH ONLY                                      *
   557*----------------------------------------------------------------*
   558*  PASSED TO ELRATE                                              *
   559*  ----------------                                              *
   560*  CERT ISSUE DATE                                               *
   561*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   562*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   563*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   564*  STATE CODE (CLIENT DEFINED)                                   *
   565*  STATE CODE (STANDARD P.O. ABBRV)                              *
   566*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   567*  DEVIATION CODE                                                *
   568*  ISSUE AGE                                                     *
   569*  ORIGINAL BENEFIT AMOUNT                                       *
   570*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   571*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   572*  BENEFIT KIND (LIFE OR A/H)                                    *
   573*  A.P.R.                                                        *
   574*  METHOD
   575*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   576*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   577*  COMPANY I.D. (3 CHARACTER)                                    *
   578*  BENEFIT CODE                                                  *
   579*  BENEFIT OVERRIDE CODE                                         *
   580*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   581*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   582*  JOINT INDICATOR (CSL ONLY)                                    *
   583*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   584*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   585*                                                                *
   586*  RETURNED FROM ELRATE                                          *
   587*  --------------------                                          *
   588*  CALCULATED PREMIUM                                            *
   589*  PREMIUM RATE                                                  *
   590*  MORTALITY CODE                                                *
   591*  MAX ATTAINED AGE                                              *
   592*  MAX AGE                                                       *
   593*  MAX TERM                                                      *
   594*  MAX MONTHLY BENEFIT                                           *
   595*  MAX TOTAL BENIFIT                                             *
   596*  COMPOSITE RATE (OPEN-END ONLY)                                *
   597*----------------------------------------------------------------*
   598*  PASSED TO ELRFND                                              *
   599*  ----------------                                              *
   600*  CERT ISSUE DATE                                               *
   601*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* ELRFND.cbl
   602*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   603*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   604*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   605*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   606*  STATE CODE (CLIENT DEFINED)                                   *
   607*  STATE CODE (STANDARD P.O. ABBRV)                              *
   608*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   609*  DEVIATION CODE                                                *
   610*  ISSUE AGE                                                     *
   611*  ORIGINAL BENEFIT AMOUNT                                       *
   612*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   613*  PROCESS TYPE (CANCEL)                                         *
   614*  BENEFIT KIND (LIFE OR A/H)                                    *
   615*  A.P.R.                                                        *
   616*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   617*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   618*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   619*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   620*  COMPANY I.D. (3 CHARACTER)                                    *
   621*  BENEFIT CODE                                                  *
   622*  BENEFIT OVERRIDE CODE                                         *
   623*                                                                *
   624*  RETURNED FROM ELRFND                                          *
   625*  --------------------                                          *
   626*  CALCULATED REFUND                                             *
   627*----------------------------------------------------------------*
   628*  PASSED TO ELEARN                                              *
   629*  ----------------                                              *
   630*  CERT ISSUE DATE                                               *
   631*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   632*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   633*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   634*  STATE CODE (CLIENT DEFINED)                                   *
   635*  STATE CODE (STANDARD P.O. ABBRV)                              *
   636*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   637*  DEVIATION CODE                                                *
   638*  ISSUE AGE                                                     *
   639*  ORIGINAL BENEFIT AMOUNT                                       *
   640*  BENEFIT KIND (LIFE OR A/H)                                    *
   641*  A.P.R.                                                        *
   642*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   643*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   644*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   645*  COMPANY I.D. (3 CHARACTER)                                    *
   646*  BENEFIT CODE                                                  *
   647*  BENEFIT OVERRIDE CODE                                         *
   648*                                                                *
   649*  RETURNED FROM ELEARN                                          *
   650*  --------------------                                          *
   651*  INDICATED  EARNINGS                                           *
   652*----------------------------------------------------------------*
   653*                 LENGTH = 450                                   *
   654*                                                                *
   655******************************************************************
   656******************************************************************
   657*                   C H A N G E   L O G
   658*
   659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* ELRFND.cbl
   660*-----------------------------------------------------------------
   661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   662* EFFECTIVE    NUMBER
   663*-----------------------------------------------------------------
   664* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   665* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   666* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   667* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   668* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   669* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   670* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   671******************************************************************
   672
   673 01  CALCULATION-PASS-AREA.
   674     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   675                                     COMP.
   676
   677     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   678       88  NO-CP-ERROR                             VALUE ZERO.
   679       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   680                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   681       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   682       88  CP-ERROR-IN-DATES                       VALUE '2'.
   683       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   684       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   685       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   686       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   687       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   688       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   689       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   690       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   691       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   692       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   693       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   694       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   695       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   696       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   697       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   698
   699     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   700       88  NO-CP-ERROR-2                           VALUE ZERO.
   701***********************  INPUT AREAS ****************************
   702
   703     12  CP-CALCULATION-AREA.
   704         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   705         16  CP-CERT-EFF-DT        PIC XX.
   706         16  CP-VALUATION-DT       PIC XX.
   707         16  CP-PAID-THRU-DT       PIC XX.
   708         16  CP-BENEFIT-TYPE       PIC X.
   709           88  CP-AH                               VALUE 'A' 'D'
   710                                                   'I' 'U'.
   711           88  CP-REDUCING-LIFE                    VALUE 'R'.
   712           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   713         16  CP-INCURRED-DT        PIC XX.
   714         16  CP-REPORTED-DT        PIC XX.
   715         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   716         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   717         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* ELRFND.cbl
   718                                     COMP-3.
   719         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   720                                     COMP-3.
   721         16  CP-CDT-METHOD         PIC X.
   722           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   723           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   724           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   725         16  CP-CLAIM-TYPE         PIC X.
   726           88  CP-AH-CLAIM                         VALUE 'A'.
   727           88  CP-LIFE-CLAIM                       VALUE 'L'.
   728         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   729                                     COMP-3.
   730         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   731                                     COMP-3.
   732         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   733                                     COMP-3.
   734         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   735                                     COMP-3.
   736         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   737                                     COMP-3.
   738         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   739                                     COMP-3.
   740         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   741                                     COMP-3.
   742         16  CP-REM-TERM-METHOD    PIC X.
   743           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   744           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   745           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   746           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   747           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   748           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   749           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   750         16  CP-EARNING-METHOD     PIC X.
   751           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   752           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   753           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   754           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   755           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   756           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   757           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   758           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   759           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   760           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   761           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   762           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   763         16  CP-PROCESS-TYPE       PIC X.
   764           88  CP-CLAIM                            VALUE '1'.
   765           88  CP-CANCEL                           VALUE '2'.
   766           88  CP-ISSUE                            VALUE '3'.
   767         16  CP-SPECIAL-CALC-CD    PIC X.
   768           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   769           88  CP-1-MTH-INTEREST               VALUE ' '.
   770           88  CP-0-MTH-INTEREST               VALUE 'A'.
   771           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   772           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   773           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   774           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   775           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* ELRFND.cbl
   776           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   777           88  CP-2-MTH-INTEREST               VALUE 'I'.
   778           88  CP-3-MTH-INTEREST               VALUE 'J'.
   779           88  CP-4-MTH-INTEREST               VALUE 'K'.
   780           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   781           88  CP-MORTGAGE-REC                 VALUE 'M'.
   782           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   783           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   784           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   785           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   786                                                     'W' 'X'.
   787           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   788           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   789           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   790           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   791           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   792           88  CP-SUMMARY-REC                  VALUE 'Z'.
   793           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   794           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   795           88  CP-AD-D-BENEFIT                 VALUE '4'.
   796           88  CP-CSL-METH-1                   VALUE '5'.
   797           88  CP-CSL-METH-2                   VALUE '6'.
   798           88  CP-CSL-METH-3                   VALUE '7'.
   799           88  CP-CSL-METH-4                   VALUE '8'.
   800
   801         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   802                                     COMP-3.
   803         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   804         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   805         16  CP-STATE              PIC XX          VALUE SPACE.
   806         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   807         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   808           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   809               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   810         16  CP-R78-OPTION         PIC X.
   811           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   812           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   813
   814         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   815         16  CP-IBNR-RESERVE-SW    PIC X.
   816         16  CP-CLAIM-STATUS       PIC X.
   817         16  CP-RATE-FILE          PIC X.
   818         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   819                                     COMP-3.
   820
   821         16  CP-LIFE-OVERRIDE-CODE PIC X.
   822         16  CP-AH-OVERRIDE-CODE   PIC X.
   823
   824         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   825                                     COMP-3.
   826         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   827                                     COMP-3.
   828         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   829                                     COMP-3.
   830         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   831                                     COMP-3.
   832
   833         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* ELRFND.cbl
   834         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   835         16  CP-EXT-DAYS-CALC      PIC X.
   836           88  CP-EXT-NO-CHG                   VALUE ' '.
   837           88  CP-EXT-CHG-LF                   VALUE '1'.
   838           88  CP-EXT-CHG-AH                   VALUE '2'.
   839           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   840         16  CP-DOMICILE-STATE     PIC XX.
   841         16  CP-CARRIER            PIC X.
   842         16  CP-REIN-FLAG          PIC X.
   843         16  CP-REM-TRM-CALC-OPTION PIC X.
   844           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   845                      '2' '3' '4' '5'.
   846           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   847           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   848           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   849           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   850           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   851           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   852           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   853           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   854         16  CP-SIG-SWITCH         PIC X.
   855         16  CP-RATING-METHOD      PIC X.
   856           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   857           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   858           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   859           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   860           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   861           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   862           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   863           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   864           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   865         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   866                                     COMP-3.
   867         16  CP-BEN-CATEGORY       PIC X.
   868         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   869         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   870                                   PIC S99V9(5) COMP-3.
   871         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   872         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   873                                   PIC S99V9(5) COMP-3.
   874         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   875         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   876         16  CP-EXPIRE-DT          PIC XX.
   877         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   878         16  FILLER                PIC X(35).
   879*        16  FILLER                PIC X(50).
   880
   881***************    OUTPUT FROM ELRESV   ************************
   882
   883         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   884
   885         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   886                                     COMP-3.
   887         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   888                                     COMP-3.
   889         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   890                                     COMP-3.
   891         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* ELRFND.cbl
   892                                     COMP-3.
   893         16  FILLER                PIC X(09).
   894***************    OUTPUT FROM ELRTRM   *************************
   895
   896         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   897                                     COMP-3.
   898         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   899                                     COMP-3.
   900         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   903                                     COMP-3.
   904         16  FILLER                PIC X(12).
   905
   906***************    OUTPUT FROM ELRAMT   *************************
   907
   908         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   909                                     COMP-3.
   910         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   911                                     COMP-3.
   912         16  FILLER                PIC X(12).
   913
   914***************    OUTPUT FROM ELRATE   *************************
   915
   916         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   917                                     COMP-3.
   918         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   919                                     COMP-3.
   920         16  CP-MORTALITY-CODE     PIC X(4).
   921         16  CP-RATE-EDIT-FLAG     PIC X.
   922             88  CP-RATES-NEED-APR                  VALUE '1'.
   923         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   924                                     COMP-3.
   925         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   926         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   927         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   928                                   PIC S9(7)V99 COMP-3.
   929         16  FILLER                PIC X(07).
   930
   931***************    OUTPUT FROM ELRFND   *************************
   932
   933         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   934                                     COMP-3.
   935         16  CP-REFUND-TYPE-USED   PIC X.
   936           88  CP-R-AS-R78                         VALUE '1'.
   937           88  CP-R-AS-PRORATA                     VALUE '2'.
   938           88  CP-R-AS-CALIF                       VALUE '3'.
   939           88  CP-R-AS-TEXAS                       VALUE '4'.
   940           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   941           88  CP-R-AS-NET-PAY                     VALUE '5'.
   942           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   943           88  CP-R-AS-MEAN                        VALUE '8'.
   944           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   945           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   946           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   947         16  FILLER                PIC X(12).
   948
   949***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* ELRFND.cbl
   950
   951         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   952                                     COMP-3.
   953         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   954                                     COMP-3.
   955         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   956                                     COMP-3.
   957         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   958                                     COMP-3.
   959         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   960                                     COMP-3.
   961         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   962                                     COMP-3.
   963         16  CP-EARNING-TYPE-USED  PIC X.
   964           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   965           88  CP-E-AS-R78                         VALUE '1'.
   966           88  CP-E-AS-PRORATA                     VALUE '2'.
   967           88  CP-E-AS-TEXAS                       VALUE '4'.
   968           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   969           88  CP-E-AS-NET-PAY                     VALUE '5'.
   970           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   971           88  CP-E-AS-MEAN                        VALUE '8'.
   972           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   973         16  FILLER                PIC X(12).
   974
   975***************    OUTPUT FROM ELPMNT   *************************
   976
   977         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   978                                     COMP-3.
   979         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   980                                     COMP-3.
   981         16  FILLER                PIC X(12).
   982
   983***************   MISC WORK AREAS    *****************************
   984         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   985                                     COMP-3.
   986         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   987                                     COMP-3.
   988         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   989                                     COMP-3.
   990         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   991                                     COMP-3.
   992         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   993                                     COMP-3.
   994         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   995                                     COMP-3.
   996         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   997             88  OPEN-RATE-FILE                   VALUE 'O'.
   998             88  CLOSE-RATE-FILE                  VALUE 'C'.
   999             88  IO-ERROR                         VALUE 'E'.
  1000
  1001         16  CP-FIRST-PAY-DATE     PIC XX.
  1002
  1003         16  CP-JOINT-INDICATOR    PIC X.
  1004
  1005         16  CP-RESERVE-REMAINING-TERM
  1006                                   PIC S9(4)V9    VALUE ZERO
  1007                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* ELRFND.cbl
  1008
  1009         16  CP-INSURED-BIRTH-DT   PIC XX.
  1010
  1011         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1012                                     COMP-3.
  1013
  1014         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1015                                     COMP-3.
  1016
  1017         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1018                                     COMP-3.
  1019
  1020         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1021                                     COMP-3.
  1022
  1023         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1024                                     COMP-3.
  1025
  1026         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1027                                     COMP-3.
  1028
  1029         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1030                                     COMP-3.
  1031
  1032         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1033             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1034
  1035         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1036                                     COMP-3.
  1037         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1038                                     COMP-3.
  1039         16  FILLER                PIC X(17).
  1040******************************************************************
  1041
  1042
  1043****************************************************************
  1044*
  1045* Copyright (c) 2007 by Clerity Solutions, Inc.
  1046* All rights reserved.
  1047*
  1048****************************************************************
  1049 01  DFHEIV.
  1050   02  DFHEIV0               PIC X(35).
  1051   02  DFHEIV1               PIC X(08).
  1052   02  DFHEIV2               PIC X(08).
  1053   02  DFHEIV3               PIC X(08).
  1054   02  DFHEIV4               PIC X(06).
  1055   02  DFHEIV5               PIC X(04).
  1056   02  DFHEIV6               PIC X(04).
  1057   02  DFHEIV7               PIC X(02).
  1058   02  DFHEIV8               PIC X(02).
  1059   02  DFHEIV9               PIC X(01).
  1060   02  DFHEIV10              PIC S9(7) COMP-3.
  1061   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1062   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1063   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1064   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1065   02  DFHEIV15              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* ELRFND.cbl
  1066   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1067   02  DFHEIV17              PIC X(04).
  1068   02  DFHEIV18              PIC X(04).
  1069   02  DFHEIV19              PIC X(04).
  1070   02  DFHEIV20              USAGE IS POINTER.
  1071   02  DFHEIV21              USAGE IS POINTER.
  1072   02  DFHEIV22              USAGE IS POINTER.
  1073   02  DFHEIV23              USAGE IS POINTER.
  1074   02  DFHEIV24              USAGE IS POINTER.
  1075   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1076   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1077   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1078   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1079   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1080   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1081   02  FILLER                PIC X(02).
  1082   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1083   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1084   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1085   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1086   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1087 LINKAGE  SECTION.
  1088*****************************************************************
  1089*                                                               *
  1090* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1091* All rights reserved.                                          *
  1092*                                                               *
  1093*****************************************************************
  1094 01  dfheiblk.
  1095     02  eibtime          pic s9(7) comp-3.
  1096     02  eibdate          pic s9(7) comp-3.
  1097     02  eibtrnid         pic x(4).
  1098     02  eibtaskn         pic s9(7) comp-3.
  1099     02  eibtrmid         pic x(4).
  1100     02  dfheigdi         pic s9(4) comp.
  1101     02  eibcposn         pic s9(4) comp.
  1102     02  eibcalen         pic s9(4) comp.
  1103     02  eibaid           pic x(1).
  1104     02  eibfiller1       pic x(1).
  1105     02  eibfn            pic x(2).
  1106     02  eibfiller2       pic x(2).
  1107     02  eibrcode         pic x(6).
  1108     02  eibfiller3       pic x(2).
  1109     02  eibds            pic x(8).
  1110     02  eibreqid         pic x(8).
  1111     02  eibrsrce         pic x(8).
  1112     02  eibsync          pic x(1).
  1113     02  eibfree          pic x(1).
  1114     02  eibrecv          pic x(1).
  1115     02  eibsend          pic x(1).
  1116     02  eibatt           pic x(1).
  1117     02  eibeoc           pic x(1).
  1118     02  eibfmh           pic x(1).
  1119     02  eibcompl         pic x(1).
  1120     02  eibsig           pic x(1).
  1121     02  eibconf          pic x(1).
  1122     02  eiberr           pic x(1).
  1123     02  eibrldbk         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* ELRFND.cbl
  1124     02  eiberrcd         pic x(4).
  1125     02  eibsynrb         pic x(1).
  1126     02  eibnodat         pic x(1).
  1127     02  eibfiller5       pic x(2).
  1128     02  eibresp          pic 9(09) comp.
  1129     02  eibresp2         pic 9(09) comp.
  1130     02  dfheigdj         pic s9(4) comp.
  1131     02  dfheigdk         pic s9(4) comp.
  1132 01  DFHCOMMAREA                PIC X(450).
  1133
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* ELRFND.cbl
  1135 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1136 0000-DFHEXIT SECTION.
  1137     MOVE '9#                    $   ' TO DFHEIV0.
  1138     MOVE 'ELRFND' TO DFHEIV1.
  1139     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1140     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1141
  1142 000-START-REFUND-CALC.
  1143*                      COPY ELCRFNDP.
  1144****************************************************************
  1145*                                                              *
  1146*                            ELCRFNDP.                         *
  1147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1148*                            VMOD=2.028                        *
  1149*                                                              *
  1150****************************************************************.
  1151*                   C H A N G E   L O G
  1152*
  1153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1154*-----------------------------------------------------------------
  1155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1156* EFFECTIVE    NUMBER
  1157*-----------------------------------------------------------------
  1158* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1159* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1160* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1161* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1162* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1163* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1164******************************************************************
  1165
  1166     MOVE ZERO                   TO  CP-RETURN-CODE
  1167                                     CP-CALC-REFUND.
  1168     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1169
  1170 0001-GET-CANCEL-TYPE.
  1171     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1172        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1173        GO TO 1999-CALC-REF-AMT-X.
  1174
  1175     IF CP-REMAINING-TERM = ZERO   OR
  1176        CP-REMAINING-TERM NEGATIVE
  1177          MOVE ZERO TO CP-CALC-REFUND
  1178          GO TO 1999-CALC-REF-AMT-X.
  1179
  1180     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1181     MOVE SPACE              TO DC-OPTION-CODE.
  1182     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1183
  1184     IF DATE-CONVERSION-ERROR
  1185         MOVE '2' TO CP-RETURN-CODE
  1186         GO TO 1999-CALC-REF-AMT-X.
  1187
  1188     IF CP-AH
  1189        GO TO 1030-GET-AH-REFUND.
  1190
  1191********************    LIFE REFUNDS    **************************
  1192
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* ELRFND.cbl
  1193     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1194         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1195
  1196     IF CP-LOAN-TERM NOT NUMERIC
  1197         MOVE +0                TO CP-LOAN-TERM.
  1198
  1199     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1200
  1201     COMPUTE R78-FACTOR =
  1202            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1203              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1204************************************************************
  1205***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1206***---------------------------------------------------------
  1207     IF CP-TRUNCATED-LIFE
  1208        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1209     ELSE
  1210        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1211***
  1212************************************************************
  1213**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1214**** FOLLOWING.
  1215****       FOR NC. LIFE..
  1216****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1217****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1218****                             TERM <= 60 USE SUM OF DIGITS.
  1219****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1220****                             TERM > 60 USE RULE OF ANTIC
  1221****                             OTHERWISE USE RULE OF 78.
  1222****
  1223****
  1224
  1225     IF (CP-COMPANY-ID = 'NCL') AND
  1226        (CP-STATE-STD-ABBRV = 'NC')
  1227        IF CP-LEVEL-LIFE
  1228           GO TO 1023-REF-PR
  1229        ELSE
  1230        IF CP-EARN-AS-NET-PAY AND
  1231           CP-TRUNCATED-LIFE
  1232           IF CP-ORIGINAL-TERM GREATER THAN 60
  1233              GO TO 1021-ANTICIPATION-REF
  1234           ELSE
  1235              GO TO 1026-REF-R78
  1236        ELSE
  1237        IF CP-REDUCING-LIFE
  1238           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1239              CP-ORIGINAL-TERM GREATER THAN 60)
  1240              GO TO 1021-ANTICIPATION-REF
  1241           ELSE
  1242              GO TO 1075-SUM-OF-DIGITS.
  1243
  1244****
  1245**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1246**** FOLLOWING.
  1247****       FOR OH. LIFE..
  1248****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1249****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1250****  GROSS DECREASING       --- RULE OF 78
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* ELRFND.cbl
  1251****
  1252****
  1253
  1254     IF (CP-COMPANY-ID = 'CID') AND
  1255        (CP-STATE-STD-ABBRV = 'OH') AND
  1256        (CP-CLASS-CODE NOT = 'L ')
  1257        IF CP-LEVEL-LIFE
  1258           GO TO 1023-REF-PR
  1259        ELSE
  1260           IF (CP-ORIGINAL-TERM > 60) OR
  1261              (CP-EARN-AS-NET-PAY)
  1262              GO TO 1028-NET-PAY-REFUND
  1263           ELSE
  1264              GO TO 1026-REF-R78
  1265           END-IF
  1266        END-IF
  1267     END-IF
  1268
  1269**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1270**** FOLLOWING.
  1271****       FOR VA. LIFE..
  1272****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1273****           NET COVERAGES --- USE RULE OF ANTIC.
  1274****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1275****                         --- EFF DATE > 123194 USE ANTIC.
  1276****                         --- EFF DATE BETWEEN 010193 AND 12319
  1277****                             WITH TERM > 61 USE RULE OF ANTIC
  1278****                             OTHERWISE USE RULE OF 78.
  1279****
  1280****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1281****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1282****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1283****            WILL FOLLOW.
  1284****
  1285****
  1286****
  1287
  1288     IF (CP-COMPANY-ID = 'NCL') AND
  1289        (CP-STATE-STD-ABBRV = 'VA')
  1290        IF CP-LEVEL-LIFE
  1291           GO TO 1023-REF-PR
  1292        ELSE
  1293        IF CP-EARN-AS-NET-PAY
  1294           GO TO 1021-ANTICIPATION-REF
  1295        ELSE
  1296        IF CP-REDUCING-LIFE
  1297           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1298              GO TO 1026-REF-R78
  1299           ELSE
  1300           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1301              GO TO 1021-ANTICIPATION-REF
  1302           ELSE
  1303           IF CP-ORIGINAL-TERM GREATER THAN 61
  1304              GO TO 1021-ANTICIPATION-REF
  1305           ELSE
  1306              GO TO 1026-REF-R78.
  1307
  1308     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* ELRFND.cbl
  1309        AND (CP-STATE-STD-ABBRV = 'IN')
  1310        AND (DC-GREG-DATE-CYMD < 20030401)
  1311        IF CP-REDUCING-LIFE
  1312           GO TO 1026-REF-R78
  1313        ELSE
  1314           IF CP-LEVEL-LIFE
  1315              GO TO 1023-REF-PR
  1316           END-IF
  1317        END-IF
  1318     END-IF
  1319
  1320     IF (CP-COMPANY-ID = 'CID')
  1321        AND (CP-STATE-STD-ABBRV = 'FL')
  1322        AND (DC-GREG-DATE-CYMD > 20030630)
  1323        IF CP-RATE-AS-NET-PAY
  1324           GO TO 1028-NET-PAY-REFUND
  1325        END-IF
  1326     END-IF
  1327     IF (CP-COMPANY-ID = 'CID')
  1328        AND (CP-STATE-STD-ABBRV = 'MN')
  1329        AND (CP-EARN-AS-NET-PAY)
  1330        AND (CP-RATE-AS-REG-BALLOON)
  1331        AND (DC-GREG-DATE-CYMD > 20091231)
  1332        GO TO 1028-NET-PAY-REFUND
  1333     END-IF
  1334     IF (CP-COMPANY-ID = 'CID')
  1335        AND (CP-STATE-STD-ABBRV = 'MN')
  1336        AND (DC-GREG-DATE-CYMD > 20091231)
  1337        AND (CP-RATE-AS-NET-PAY)
  1338        GO TO 1021-ANTICIPATION-REF
  1339     END-IF
  1340     IF (CP-COMPANY-ID = 'CID')
  1341        AND (CP-STATE-STD-ABBRV = 'MO')
  1342        AND (DC-GREG-DATE-CYMD > 20030630)
  1343        AND (CP-LOAN-TERM < +121)
  1344        IF CP-RATE-AS-NET-PAY
  1345           GO TO 1028-NET-PAY-REFUND
  1346        END-IF
  1347     END-IF
  1348
  1349     IF (CP-COMPANY-ID = 'CID')
  1350        AND (CP-STATE-STD-ABBRV = 'ND')
  1351        AND (DC-GREG-DATE-CYMD > 20011231)
  1352        AND (CP-REDUCING-LIFE)
  1353        GO TO 1021-ANTICIPATION-REF
  1354     END-IF
  1355
  1356     IF CP-CRITICAL-PERIOD
  1357        IF CP-COMPANY-ID = 'NCL'
  1358           NEXT SENTENCE
  1359        ELSE
  1360           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1361
  1362     IF CP-TERM-IS-DAYS  AND
  1363        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1364         GO TO 1024-REF-PR-DAYS.
  1365
  1366     IF CP-STATE-STD-ABBRV = 'NM'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* ELRFND.cbl
  1367       IF CP-REDUCING-LIFE
  1368*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1369         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1370             GO TO 1026-REF-R78.
  1371
  1372     IF CP-EARN-ANTICIPATION
  1373         GO TO 1021-ANTICIPATION-REF.
  1374
  1375     IF CP-STATE-STD-ABBRV = 'ME'
  1376         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1377            NEXT SENTENCE
  1378         ELSE
  1379            IF CP-REDUCING-LIFE
  1380               GO TO 1021-ANTICIPATION-REF.
  1381
  1382     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1383        IF CP-STATE-STD-ABBRV = 'TX'
  1384            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1385        END-IF
  1386     END-IF.
  1387
  1388     IF CP-STATE-STD-ABBRV = 'TX'
  1389       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1390          NEXT SENTENCE
  1391       END-IF
  1392        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1393           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1394           GO TO 1021-ANTICIPATION-REF.
  1395
  1396 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1397
  1398     IF CP-EARN-BY-PRORATA
  1399         GO TO 1023-REF-PR.
  1400
  1401     IF CP-EARN-AS-MEAN
  1402         GO TO 1025-REF-MEAN.
  1403
  1404     IF CP-EARN-AS-TEXAS
  1405         GO TO 1027-TEXAS-REFUND.
  1406
  1407     IF CP-EARN-AS-NET-PAY
  1408         GO TO 1028-NET-PAY-REFUND.
  1409
  1410     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1411         GO TO 1000-NO-NET-PAY.
  1412
  1413     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1414       IF CP-STATE-STD-ABBRV = 'NC'
  1415         IF CP-REDUCING-LIFE
  1416           IF CP-ORIGINAL-TERM GREATER 60  AND
  1417              DC-GREG-DATE-CYMD GREATER 19810930
  1418                GO TO 1028-NET-PAY-REFUND
  1419           ELSE
  1420              GO TO 1026-REF-R78.
  1421
  1422
  1423     IF CP-STATE-STD-ABBRV = 'NC'
  1424       IF CP-COMPANY-ID EQUAL 'NCL'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* ELRFND.cbl
  1425          NEXT SENTENCE
  1426       END-IF
  1427       IF CP-REDUCING-LIFE
  1428         IF CP-ORIGINAL-TERM GREATER 60  AND
  1429            DC-GREG-DATE-CYMD GREATER 19810930
  1430             GO TO 1021-ANTICIPATION-REF
  1431         ELSE
  1432             GO TO 1026-REF-R78.
  1433
  1434     IF CP-STATE-STD-ABBRV = 'UT'
  1435       IF CP-COMPANY-ID EQUAL 'NCL'
  1436          NEXT SENTENCE
  1437       END-IF
  1438         IF CP-ORIGINAL-TERM GREATER 62         AND
  1439            CP-LOAN-APR GREATER ZERO            AND
  1440            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1441            DC-GREG-DATE-CYMD LESS    19830901
  1442             GO TO 1028-NET-PAY-REFUND
  1443         ELSE
  1444             GO TO 1026-REF-R78.
  1445
  1446     IF CP-STATE-STD-ABBRV = 'OH'
  1447       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1448          NEXT SENTENCE
  1449       END-IF
  1450           IF CP-ORIGINAL-TERM GREATER 60         AND
  1451              CP-CLASS-CODE NOT = 'L '            AND
  1452              CP-LOAN-APR GREATER ZERO            AND
  1453              DC-GREG-DATE-CYMD GREATER 19831031
  1454              GO TO 1028-NET-PAY-REFUND
  1455           ELSE
  1456              GO TO 1026-REF-R78.
  1457
  1458     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1459       IF CP-STATE-STD-ABBRV = 'MT'
  1460         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1461
  1462
  1463     IF CP-STATE-STD-ABBRV = 'MT'
  1464       IF CP-COMPANY-ID EQUAL 'NCL'
  1465          NEXT SENTENCE
  1466       END-IF
  1467         IF CP-ORIGINAL-TERM GREATER 61         AND
  1468            CP-LOAN-APR GREATER ZERO            AND
  1469            DC-GREG-DATE-CYMD GREATER 19830318
  1470             GO TO 1028-NET-PAY-REFUND
  1471         ELSE
  1472             GO TO 1026-REF-R78.
  1473
  1474 SKIP-CSO-MT-LF-PROCESSING.
  1475
  1476     IF CP-STATE-STD-ABBRV = 'RI'
  1477       IF CP-COMPANY-ID EQUAL 'NCL'
  1478          NEXT SENTENCE
  1479       END-IF
  1480         IF CP-ORIGINAL-TERM GREATER 60         AND
  1481            CP-LOAN-APR GREATER ZERO            AND
  1482            DC-GREG-DATE-CYMD GREATER 19831231
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* ELRFND.cbl
  1483             GO TO 1028-NET-PAY-REFUND
  1484         ELSE
  1485             GO TO 1026-REF-R78.
  1486
  1487
  1488 1000-NO-NET-PAY.
  1489
  1490     IF CP-STATE-STD-ABBRV = 'WY'
  1491       IF CP-COMPANY-ID EQUAL 'NCL'
  1492          NEXT SENTENCE
  1493       END-IF
  1494        IF CP-COMPANY-ID = 'TMS'
  1495           GO TO 1026-REF-R78
  1496        ELSE
  1497           GO TO 1023-REF-PR.
  1498
  1499     IF CP-EARN-BY-R78
  1500         GO TO 1026-REF-R78.
  1501
  1502     IF CP-EARN-AS-SUM-OF-DIGITS
  1503         GO TO 1075-SUM-OF-DIGITS.
  1504
  1505     IF CP-LEVEL-LIFE
  1506         GO TO 1023-REF-PR
  1507     ELSE
  1508         GO TO 1026-REF-R78.
  1509
  1510*-----------------------------------------------------------------
  1511 1021-ANTICIPATION-REF.
  1512     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1513
  1514     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1515     IF CP-LOAN-TERM = ZEROS
  1516        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1517     END-IF
  1518     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1519                            CP-REMAINING-TERM.
  1520
  1521     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1522     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1523     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1524
  1525     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1526     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1527     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1528
  1529     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1530         MOVE 'N'              TO CP-ROA-REFUND
  1531     ELSE
  1532         MOVE 'Y'              TO CP-ROA-REFUND.
  1533
  1534******    TO COMPUTE PREMIUM AT REFUND DATE
  1535     PERFORM 2500-GET-RATE.
  1536
  1537     MOVE 'N'                  TO CP-ROA-REFUND.
  1538     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1539     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1540     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* ELRFND.cbl
  1541
  1542     IF CP-PREMIUM-RATE = ZEROS
  1543        MOVE '7'                 TO CP-RETURN-CODE
  1544        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1545        GO TO 1999-CALC-REF-AMT-X.
  1546
  1547     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1548
  1549******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1550     PERFORM 2500-GET-RATE.
  1551
  1552     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1553
  1554     IF CP-PREMIUM-RATE = ZEROS
  1555        MOVE '7'            TO CP-RETURN-CODE
  1556        GO TO 1999-CALC-REF-AMT-X.
  1557
  1558     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1559
  1560     IF  WS-ORIG-PREM = ZEROS
  1561         MOVE ZEROS TO WS-NP-REF-FACTOR
  1562        ELSE
  1563         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1564                                            WS-ORIG-PREM.
  1565
  1566     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1567                                        CP-ORIGINAL-PREMIUM.
  1568
  1569     GO TO 1999-CALC-REF-AMT-X.
  1570
  1571*---------------------------------------------------------------
  1572 1022-REF-CRITICAL-PERIOD-LF.
  1573     GO TO 1023-REF-PR.
  1574
  1575*---------------------------------------------------------------
  1576 1023-REF-PR.
  1577     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1578     COMPUTE CP-CALC-REFUND ROUNDED =
  1579            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1580
  1581     GO TO 1999-CALC-REF-AMT-X.
  1582
  1583*---------------------------------------------------------------
  1584 1024-REF-PR-DAYS.
  1585     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1586     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1587     MOVE '1'                TO DC-OPTION-CODE.
  1588     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1589
  1590     IF DATE-CONVERSION-ERROR
  1591         MOVE '2' TO CP-RETURN-CODE
  1592         GO TO 1999-CALC-REF-AMT-X.
  1593
  1594     COMPUTE CP-CALC-REFUND ROUNDED =
  1595         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1596                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1597
  1598     GO TO 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* ELRFND.cbl
  1599
  1600*---------------------------------------------------------------
  1601 1025-REF-MEAN.
  1602     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1603     COMPUTE CP-CALC-REFUND ROUNDED =
  1604          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1605           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1606
  1607     GO TO 1999-CALC-REF-AMT-X.
  1608
  1609*---------------------------------------------------------------
  1610 1026-REF-R78.
  1611     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1612*    IF CP-TERM-TIMES-TERM
  1613*        COMPUTE R78-FACTOR =
  1614*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1615*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1616*
  1617     COMPUTE CP-CALC-REFUND ROUNDED =
  1618        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1619
  1620     GO TO 1999-CALC-REF-AMT-X.
  1621
  1622*---------------------------------------------------------------
  1623 1027-TEXAS-REFUND.
  1624     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1625     IF CP-PAY-FREQUENCY = ZERO
  1626        MOVE ZERO TO CP-CALC-REFUND
  1627        MOVE '5'  TO CP-RETURN-CODE
  1628        GO TO 1999-CALC-REF-AMT-X.
  1629
  1630     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1631         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1632
  1633     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1634         GIVING TEX-FACT-5
  1635             REMAINDER TEX-FACT-6.
  1636
  1637     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1638
  1639     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1640         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1641         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1642
  1643     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1644
  1645     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1646                                        * TEX-FACT-8.
  1647
  1648     GO TO 1999-CALC-REF-AMT-X.
  1649
  1650*---------------------------------------------------------------
  1651 1028-NET-PAY-REFUND.
  1652     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1653     IF CP-LOAN-APR = ZERO
  1654        MOVE ZERO TO CP-CALC-REFUND
  1655        MOVE '1'  TO CP-RETURN-CODE
  1656        GO TO 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  32
* ELRFND.cbl
  1657
  1658     MOVE CP-LOAN-APR           TO N-P-APR.
  1659     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1660     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1661
  1662     IF CP-TRUNCATED-LIFE
  1663        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1664
  1665     MOVE 'R'                   TO N-P-OPT.
  1666
  1667     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1668
  1669     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1670                                        CP-ORIGINAL-PREMIUM.
  1671
  1672 1029-UTAH-REFUND.
  1673*
  1674*---------------------------------------------------------------
  1675* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1676*---------------------------------------------------------------
  1677*
  1678     GO TO 1999-CALC-REF-AMT-X.
  1679*
  1680*---------------------------------------------------------------
  1681     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1682                      OR
  1683        (CP-COMPANY-ID EQUAL 'NCL')
  1684         GO TO 1999-CALC-REF-AMT-X.
  1685     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1686
  1687     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1688        GREATER ZERO AND LESS 13
  1689         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1690                 (CP-CALC-REFUND * .05).
  1691
  1692     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1693        GREATER 12 AND LESS 25
  1694         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1695                 (CP-CALC-REFUND * .025).
  1696
  1697     GO TO 1999-CALC-REF-AMT-X.
  1698*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  33
* ELRFND.cbl
  1700*---------------------------------------------------------------
  1701 1030-GET-AH-REFUND.
  1702     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1703
  1704     COMPUTE R78-FACTOR =
  1705            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1706                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1707
  1708*    IF CP-TERM-TIMES-TERM
  1709*        COMPUTE R78-FACTOR =
  1710*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1711*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1712*
  1713
  1714**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1715**** FOLLOWING.
  1716****       FOR VA. DISABILITY
  1717****                         --- EFF DATE > 123192 AND
  1718****                             TERM > 61 USE RULE OF ANTIC
  1719****                             OTHERWISE USE RULE OF 78.
  1720****
  1721****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1722****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1723****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1724****            WILL FOLLOW.
  1725****
  1726****
  1727****
  1728     IF CP-COMPANY-ID EQUAL 'NCL'
  1729        IF CP-STATE-STD-ABBRV = 'VA'
  1730           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1731              (CP-ORIGINAL-TERM GREATER THAN 61)
  1732               MOVE '6'        TO CP-EARNING-METHOD
  1733               GO TO 1060-ANTICIPATION-REF
  1734            ELSE
  1735               MOVE '1'        TO CP-EARNING-METHOD
  1736               GO TO 1050-R78-REF.
  1737
  1738     IF CP-STATE-STD-ABBRV = 'WY'
  1739        IF CP-COMPANY-ID = 'TMS'
  1740           GO TO 1050-R78-REF.
  1741
  1742     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1743         NEXT SENTENCE
  1744     ELSE
  1745         IF CP-CRITICAL-PERIOD
  1746             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1747
  1748*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1749*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1750*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1751*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1752     IF (CP-GAP-NON-REFUNDABLE)
  1753        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1754           OR (CP-BENEFIT-CD = '55' OR '56')
  1755           MOVE ZEROS            TO CP-CALC-REFUND
  1756           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1757           GO TO 1999-CALC-REF-AMT-X
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  34
* ELRFND.cbl
  1758        END-IF
  1759     END-IF
  1760     IF CP-GAP-ACTUARIAL
  1761         GO TO 1070-NET-PAY-REFUND
  1762     END-IF
  1763     IF (CP-COMPANY-ID = 'CID')
  1764        AND (CP-STATE-STD-ABBRV = 'MN')
  1765        AND (DC-GREG-DATE-CYMD > 20091231)
  1766        IF (CP-CRITICAL-PERIOD)
  1767           GO TO 1040-PR-REF
  1768        ELSE
  1769           GO TO 1055-MEAN-REF
  1770     END-IF
  1771     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1772        IF CP-STATE-STD-ABBRV = 'NC'
  1773           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1774
  1775     IF (CP-COMPANY-ID = 'CID')
  1776        AND (CP-STATE-STD-ABBRV = 'IN')
  1777        AND (DC-GREG-DATE-CYMD < 20030401)
  1778        GO TO 1026-REF-R78
  1779     END-IF
  1780
  1781     IF (CP-COMPANY-ID = 'CID')
  1782        AND (CP-STATE-STD-ABBRV = 'FL')
  1783        AND (DC-GREG-DATE-CYMD > 20030630)
  1784        AND (CP-CRITICAL-PERIOD)
  1785        GO TO 1040-PR-REF
  1786     END-IF
  1787
  1788     IF (CP-COMPANY-ID = 'CID')
  1789        AND (CP-STATE-STD-ABBRV = 'MO')
  1790        AND (DC-GREG-DATE-CYMD > 20030630)
  1791        AND (CP-CRITICAL-PERIOD)
  1792        GO TO 1040-PR-REF
  1793     END-IF
  1794
  1795     IF (CP-COMPANY-ID = 'CID')
  1796        AND (CP-STATE-STD-ABBRV = 'ND')
  1797        AND (CP-CRITICAL-PERIOD)
  1798        AND (DC-GREG-DATE-CYMD > 20011231)
  1799        GO TO 1040-PR-REF
  1800     END-IF
  1801
  1802     IF (CP-COMPANY-ID = 'CID')
  1803        AND (CP-STATE-STD-ABBRV = 'ND')
  1804        AND (DC-GREG-DATE-CYMD > 20011231)
  1805        GO TO 1060-ANTICIPATION-REF
  1806     END-IF
  1807
  1808     IF CP-STATE-STD-ABBRV = 'NC'
  1809       IF CP-COMPANY-ID EQUAL 'NCL' OR 'NCB'
  1810          NEXT SENTENCE
  1811       END-IF
  1812         IF DC-GREG-DATE-CYMD GREATER 19810930
  1813            IF CP-EARN-ANTICIPATION
  1814                GO TO 1060-ANTICIPATION-REF
  1815            ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  35
* ELRFND.cbl
  1816                GO TO 1055-MEAN-REF.
  1817
  1818 SKIP-CSO-NC-AH-PROCESSING.
  1819
  1820     IF CP-STATE-STD-ABBRV = 'NM'
  1821       IF CP-COMPANY-ID EQUAL 'NCL'
  1822          NEXT SENTENCE
  1823       END-IF
  1824         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1825            IF CP-COMPANY-ID = 'MON'
  1826              MOVE '6'             TO CP-EARNING-METHOD
  1827              GO TO 1060-ANTICIPATION-REF
  1828             ELSE
  1829              GO TO 1055-MEAN-REF.
  1830
  1831     IF CP-STATE-STD-ABBRV = 'CT'
  1832       IF CP-COMPANY-ID EQUAL 'NCL'
  1833          NEXT SENTENCE
  1834       END-IF
  1835          MOVE '6'              TO CP-EARNING-METHOD
  1836          GO TO 1060-ANTICIPATION-REF.
  1837
  1838     IF CP-STATE-STD-ABBRV = 'ME'
  1839       IF CP-COMPANY-ID EQUAL 'NCL' OR 'CVL'
  1840          NEXT SENTENCE
  1841       END-IF
  1842           IF CP-EARN-BY-PRORATA
  1843              GO TO 1040-PR-REF
  1844           ELSE
  1845              MOVE '6'           TO CP-EARNING-METHOD
  1846              GO TO 1060-ANTICIPATION-REF.
  1847
  1848
  1849     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1850        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1851            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1852
  1853     IF CP-STATE-STD-ABBRV = 'TX'
  1854       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1855          NEXT SENTENCE
  1856       END-IF
  1857        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1858           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1859           MOVE '6'              TO CP-EARNING-METHOD
  1860           GO TO 1060-ANTICIPATION-REF.
  1861
  1862     IF CP-STATE-STD-ABBRV = 'VA'
  1863       IF CP-COMPANY-ID EQUAL 'NCL'
  1864          NEXT SENTENCE
  1865       END-IF
  1866       IF CP-COMPANY-ID = 'NCB'
  1867           MOVE '6'                TO CP-EARNING-METHOD
  1868           GO TO 1060-ANTICIPATION-REF
  1869       ELSE
  1870           IF DC-GREG-DATE-CYMD GREATER 19921231
  1871               IF CP-ORIGINAL-TERM GREATER THAN 61
  1872                   MOVE '6'        TO CP-EARNING-METHOD
  1873                   GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  36
* ELRFND.cbl
  1874               ELSE
  1875                   MOVE '1'        TO CP-EARNING-METHOD
  1876                   GO TO 1050-R78-REF.
  1877
  1878 SKIP-CSO-TX-VA-AH-PROCESSING.
  1879
  1880     IF CP-EARN-BY-PRORATA
  1881         GO TO 1040-PR-REF.
  1882
  1883     IF CP-EARN-BY-R78
  1884         GO TO 1050-R78-REF.
  1885
  1886     IF CP-EARN-AS-MEAN
  1887        GO TO 1055-MEAN-REF.
  1888
  1889     IF CP-EARN-AS-SUM-OF-DIGITS
  1890         GO TO 1075-SUM-OF-DIGITS.
  1891
  1892     IF CP-EARN-AS-CALIF
  1893         GO TO 1060-ANTICIPATION-REF.
  1894
  1895     IF CP-EARN-ANTICIPATION
  1896         GO TO 1060-ANTICIPATION-REF.
  1897
  1898     IF CP-EARN-AS-NET-PAY
  1899         GO TO 1070-NET-PAY-REFUND.
  1900
  1901     GO TO 1050-R78-REF.
  1902
  1903*---------------------------------------------------------------
  1904 1035-REF-AH-CRITICAL-PERIOD.
  1905     IF CP-REMAINING-TERM GREATER +6
  1906        COMPUTE CP-CALC-REFUND ROUNDED =
  1907          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1908                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1909      ELSE
  1910        COMPUTE CP-CALC-REFUND ROUNDED =
  1911          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1912                                           CP-REMAINING-TERM + 1)
  1913                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1914
  1915     IF CP-CALC-REFUND LESS ZERO
  1916         MOVE ZERO TO CP-CALC-REFUND.
  1917
  1918     GO TO 1999-CALC-REF-AMT-X.
  1919
  1920*---------------------------------------------------------------
  1921 1040-PR-REF.
  1922     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1923     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1924
  1925     GO TO 1999-CALC-REF-AMT-X.
  1926
  1927*---------------------------------------------------------------
  1928 1050-R78-REF.
  1929     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1930     COMPUTE CP-CALC-REFUND ROUNDED =
  1931           CP-ORIGINAL-PREMIUM * R78-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  37
* ELRFND.cbl
  1932
  1933     GO TO 1999-CALC-REF-AMT-X.
  1934
  1935*---------------------------------------------------------------
  1936 1055-MEAN-REF.
  1937     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1938     COMPUTE CP-CALC-REFUND ROUNDED =
  1939         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1940          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1941
  1942     GO TO 1999-CALC-REF-AMT-X.
  1943
  1944*---------------------------------------------------------------
  1945 1060-ANTICIPATION-REF.
  1946     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1947
  1948     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1949     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1950     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1951
  1952     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1953                               CP-LOAN-TERM.
  1954     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1955
  1956     PERFORM 2500-GET-RATE.
  1957
  1958     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1959     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1960
  1961     IF CP-PREMIUM-RATE = ZEROS
  1962        MOVE '7'                 TO CP-RETURN-CODE
  1963        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1964        GO TO 1999-CALC-REF-AMT-X.
  1965
  1966     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1967
  1968     PERFORM 2500-GET-RATE.
  1969
  1970     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1971
  1972     IF CP-PREMIUM-RATE = ZEROS
  1973        MOVE '7'            TO CP-RETURN-CODE
  1974        GO TO 1999-CALC-REF-AMT-X.
  1975
  1976     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1977
  1978     IF  WS-ORIG-PREM = ZERO
  1979         MOVE ZERO                TO WS-NP-REF-FACTOR
  1980        ELSE
  1981         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1982                                            WS-ORIG-PREM.
  1983
  1984     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1985                                        CP-ORIGINAL-PREMIUM.
  1986
  1987     IF NOT CP-EARN-AS-CALIF
  1988         GO TO 1999-CALC-REF-AMT-X.
  1989
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  38
* ELRFND.cbl
  1990*---------------------------------------------------------------
  1991 1065-CALIF-REGS.
  1992     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1993     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1994         GIVING FACTOR-5.
  1995
  1996     IF FACTOR-5 NOT GREATER +6  AND
  1997        CP-CLASS-CODE = 'A '
  1998         GO TO 1050-R78-REF.
  1999
  2000     IF FACTOR-5 = ZERO
  2001         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2002         GO TO 1999-CALC-REF-AMT-X.
  2003
  2004     IF CP-ORIGINAL-TERM LESS +014
  2005         GO TO 1999-CALC-REF-AMT-X.
  2006
  2007     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2008                                   GIVING FACTOR-5 ROUNDED.
  2009
  2010     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2011
  2012     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2013                                   GIVING FACTOR-2 ROUNDED.
  2014
  2015     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2016     ADD +0.099375 TO FACTOR-1.
  2017
  2018     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2019                                   GIVING FACTOR-5 ROUNDED.
  2020
  2021     SUBTRACT +1.00 FROM FACTOR-5.
  2022
  2023     IF CP-ORIGINAL-TERM LESS +049
  2024         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2025                                   GIVING FACTOR-6 ROUNDED
  2026     ELSE
  2027         MOVE +035 TO FACTOR-6.
  2028
  2029     MOVE +001 TO FACTOR-2.
  2030
  2031     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2032     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2033     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2034     MOVE +001 TO FACTOR-2.
  2035     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2036
  2037     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2038         GIVING CAL-RFND ROUNDED.
  2039
  2040     IF CAL-RFND LESS +0.01
  2041         MOVE ZEROS TO CAL-RFND.
  2042
  2043     IF CAL-RFND LESS CP-CALC-REFUND
  2044         MOVE CAL-RFND TO CP-CALC-REFUND.
  2045
  2046     GO TO 1999-CALC-REF-AMT-X.
  2047
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  39
* ELRFND.cbl
  2048*-----------------------------------------------------------------
  2049 1070-NET-PAY-REFUND.
  2050     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2051     IF CP-LOAN-APR = ZERO
  2052         MOVE ZEROS              TO  CP-CALC-REFUND
  2053         MOVE '1'                TO  CP-RETURN-CODE
  2054         GO TO 1999-CALC-REF-AMT-X.
  2055
  2056     MOVE CP-LOAN-APR            TO  N-P-APR.
  2057     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2058     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2059
  2060     MOVE 'R'                    TO  N-P-OPT.
  2061
  2062     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2063
  2064     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2065                                        CP-ORIGINAL-PREMIUM.
  2066
  2067     GO TO 1999-CALC-REF-AMT-X.
  2068*---------------------------------------------------------------
  2069
  2070 1075-SUM-OF-DIGITS.
  2071
  2072     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2073
  2074     COMPUTE RSUM-REMAINING-TERM =
  2075             CP-LOAN-TERM -
  2076                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2077
  2078     COMPUTE RSUM-FACTOR =
  2079        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2080               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2081                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2082            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2083               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2084                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2085
  2086     COMPUTE CP-CALC-REFUND ROUNDED =
  2087           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2088
  2089     GO TO 1999-CALC-REF-AMT-X.
  2090
  2091*-----------------------------------------------------------------
  2092 1999-CALC-REF-AMT-X.
  2093
  2094     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2095
  2096
  2097* EXEC CICS RETURN
  2098*    END-EXEC.
  2099*    MOVE '.(                    &   #00002092' TO DFHEIV0
  2100     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2101     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2102     MOVE X'2020233030303032303932' TO DFHEIV0(25:11)
  2103     CALL 'kxdfhei1' USING DFHEIV0,
  2104           DFHEIV99,
  2105           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  40
* ELRFND.cbl
  2106           DFHEIV99,
  2107           DFHEIV99,
  2108           DFHEIV99
  2109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2110
  2111
  2112* GOBACK.
  2113     MOVE '9%                    "   ' TO DFHEIV0
  2114     MOVE 'ELRFND' TO DFHEIV1
  2115     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2116     GOBACK.
  2117
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  41
* ELRFND.cbl
  2119  2500-GET-RATE.
  2120
  2121* EXEC CICS LINK
  2122*        PROGRAM    ('ELRATE')
  2123*        COMMAREA   (CALCULATION-PASS-AREA)
  2124*        LENGTH     (CP-COMM-LENGTH)
  2125*        END-EXEC.
  2126     MOVE 'ELRATE' TO DFHEIV1
  2127*    MOVE '."C                   ''   #00002098' TO DFHEIV0
  2128     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2130     MOVE X'2020233030303032303938' TO DFHEIV0(25:11)
  2131     CALL 'kxdfhei1' USING DFHEIV0,
  2132           DFHEIV1,
  2133           CALCULATION-PASS-AREA,
  2134           CP-COMM-LENGTH,
  2135           DFHEIV99,
  2136           DFHEIV99,
  2137           DFHEIV99
  2138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2139
  2140
  2141  2500-EXIT.
  2142       EXIT.
  2143
  2144  9100-CONVERT-DATE.
  2145
  2146* EXEC CICS LINK
  2147*         PROGRAM   ('ELDATCV')
  2148*         COMMAREA  (DATE-CONVERSION-DATA)
  2149*         LENGTH    (DC-COMM-LENGTH)
  2150*    END-EXEC.
  2151     MOVE 'ELDATCV' TO DFHEIV1
  2152*    MOVE '."C                   ''   #00002108' TO DFHEIV0
  2153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2155     MOVE X'2020233030303032313038' TO DFHEIV0(25:11)
  2156     CALL 'kxdfhei1' USING DFHEIV0,
  2157           DFHEIV1,
  2158           DATE-CONVERSION-DATA,
  2159           DC-COMM-LENGTH,
  2160           DFHEIV99,
  2161           DFHEIV99,
  2162           DFHEIV99
  2163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2164
  2165
  2166  9100-EXIT.
  2167       EXIT.
  2168
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  42
* ELRFND.cbl
  2170  10000-NET-TERM  SECTION.
  2171*                      COPY ERCNETP.
  2172*****************************************************************
  2173*                                                               *
  2174*                            ERCNETP                            *
  2175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2176*                            VMOD=2.029                         *
  2177*                                                               *
  2178*****************************************************************.
  2179*
  2180*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2181*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2182*                                   ORIGINAL TERM (S999)
  2183*                                   REMAINING TERM (S999)
  2184*                                   NET PAY OPTION (X)
  2185*                                   LOAN TERM (S999)
  2186*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2187*
  2188*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2189*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2190*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2191*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2192*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2193*    CHARGED.
  2194*
  2195*    OPTIONS - S = NET SIMPLE
  2196*          SPACE = NET PAY  (1 MO. INTEREST)
  2197*              A = NET PAY  (0 MO. INTEREST)
  2198*              I = NET PAY  (2 MO. INTEREST)
  2199*              J = NET PAY  (3 MO. INTEREST)
  2200*              K = NET PAY  (4 MO. INTEREST)
  2201*              T = TRUNCATED  (0 MO. INTEREST)
  2202*              U = TRUNCATED  (1 MO. INTEREST)
  2203*              V = TRUNCATED  (2 MO. INTEREST)
  2204*              W = TRUNCATED  (3 MO. INTEREST)
  2205*              X = TRUNCATED  (4 MO. INTEREST)
  2206*              R = REFUNDS (REGULAR OR TRUNCATED)
  2207******************************************************************
  2208*                   C H A N G E   L O G
  2209*
  2210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2211*-----------------------------------------------------------------
  2212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2213* EFFECTIVE    NUMBER
  2214*-----------------------------------------------------------------
  2215* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2216* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2217* 120403                   PEMA  ADD SPECIAL TX CALC
  2218* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2219* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2220* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2221* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2222* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2223* 021207                   PEMA  ADD PA NP
  2224* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2225* 032807                   PEMA  ADD VT NP PLUS 2
  2226* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2227* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  43
* ELRFND.cbl
  2228* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2229* 110207      TO 'AL' NET PAY CALC
  2230* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2231* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2232* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2233* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2234* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2235* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2236* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2237* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2238* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2239******************************************************************
  2240
  2241     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2242     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2243     MOVE N-P-LOAN    TO LOAN-TERM.
  2244     MOVE N-P-REM     TO REMAINING-TERM.
  2245     MOVE N-P-OPT     TO OPTION-SW.
  2246
  2247     MOVE +0 TO FACTOR.
  2248
  2249     IF ANNUAL-INT-RATE = ZERO
  2250         GO TO 99000-ERROR.
  2251     IF ORIGINAL-TERM = ZERO
  2252         GO TO 99999-RETURN.
  2253     IF REMAINING-TERM = ZERO
  2254         GO TO 99999-RETURN.
  2255     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2256         GO TO 99000-ERROR.
  2257     IF LOAN-TERM = ZERO
  2258         GO TO 99999-RETURN.
  2259     IF LOAN-TERM LESS ORIGINAL-TERM
  2260         GO TO 99000-ERROR.
  2261
  2262*    IF ANNUAL-INT-RATE LESS +2
  2263*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2264*    IF ANNUAL-INT-RATE LESS +2
  2265*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2266*    IF ANNUAL-INT-RATE LESS +2
  2267*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2268
  2269     IF NPO-REFUND
  2270         MOVE '2' TO NP-PROCESS-SW
  2271       ELSE
  2272         IF ORIGINAL-TERM = REMAINING-TERM
  2273            MOVE '1'   TO NP-PROCESS-SW
  2274           ELSE
  2275            MOVE '3'   TO NP-PROCESS-SW.
  2276
  2277     IF NPO-SIMPLE
  2278         MOVE 'S' TO TYPE-SW
  2279     ELSE
  2280         MOVE 'N' TO TYPE-SW.
  2281
  2282     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2283
  2284     COMPUTE V ROUNDED = K1 / (K1 + I).
  2285
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  44
* ELRFND.cbl
  2286     MOVE V     TO VX
  2287                   SV.
  2288
  2289     MOVE +1    TO X1
  2290                   SX.
  2291
  2292     MOVE LOAN-TERM TO MAX-X.
  2293
  2294     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2295
  2296     IF MAX-X = +1
  2297        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2298
  2299     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2300
  2301     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2302         OR 'DCC'        OR 'NCL') AND
  2303        (NOT NP-REFUND)
  2304        NEXT SENTENCE
  2305     ELSE
  2306     IF LOAN-TERM NOT = ORIGINAL-TERM
  2307        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2308
  2309     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2310
  2311 10500-VX-LOOP.
  2312
  2313***  VX = AMORT. LOAN TERM.
  2314***  SV = AMORT. INSURANCE TERM.
  2315***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2316***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2317***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2318
  2319     IF X2 = 1
  2320        MOVE V         TO SX
  2321     END-IF
  2322     COMPUTE VX ROUNDED = VX * V.
  2323
  2324     ADD B1 TO X1.
  2325
  2326     IF X1 = REMAINING-TERM
  2327          MOVE VX    TO SV.
  2328
  2329     IF X1 EQUAL SV-MINUS-ONE
  2330        MOVE VX      TO SV-MINUS-ONE.
  2331
  2332     IF X1 = X2
  2333          MOVE VX    TO SX.
  2334
  2335     IF X1 NOT = MAX-X
  2336          GO TO 10500-VX-LOOP.
  2337
  2338 10700-COMPUTE-REMAINING-FACTOR.
  2339*****  WK1 = LOAN TERM AMORT
  2340     COMPUTE WK1 = K1 - VX.
  2341*****  WK2 = INS TERM AMORT
  2342     COMPUTE WK2 = K1 - SV.
  2343*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  45
* ELRFND.cbl
  2344     COMPUTE WK5 = K1 - SX.
  2345*****  WK6 = INS TERM - 1
  2346     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2347
  2348     IF NP-RATING
  2349         GO TO 12000-PREMIUM-RATE.
  2350
  2351     IF NP-REFUND
  2352         GO TO 11000-REFUND-CALC.
  2353
  2354     IF NET-STD
  2355         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2356
  2357     IF NET-SMP
  2358         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2359         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2360         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2361         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2362
  2363     IF REMAINING-TERM LESS THAN X2
  2364         MOVE +0 TO WK3.
  2365
  2366     MOVE WK3 TO FACTOR.
  2367
  2368     GO TO 99999-RETURN.
  2369
  2370 11000-REFUND-CALC.
  2371     IF REMAINING-TERM NOT LESS MAX-X
  2372        MOVE +1 TO FACTOR
  2373        GO TO 99999-RETURN.
  2374
  2375     IF REMAINING-TERM LESS +1
  2376        MOVE 0 TO FACTOR
  2377        GO TO 99999-RETURN.
  2378
  2379     COMPUTE WK2 ROUNDED = WK2 / I.
  2380     COMPUTE WK5 ROUNDED = WK5 / I.
  2381     COMPUTE WK1 ROUNDED = WK1 / I.
  2382
  2383     IF (CP-COMPANY-ID EQUAL 'CID')
  2384        AND (CP-STATE-STD-ABBRV = 'MN')
  2385        AND (CP-CERT-EFF-DT > X'A4FF')
  2386        AND (CP-RATE-AS-REG-BALLOON)
  2387        AND (CP-EARN-AS-NET-PAY)
  2388        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2389        CONTINUE
  2390     ELSE
  2391        GO TO 11000-CHECK-MN-LEV-BALLOON
  2392     END-IF
  2393
  2394     COMPUTE R = M - E
  2395     COMPUTE FACTOR = (R - WK2 + WK5) /
  2396        (M - WK1 + WK5)
  2397
  2398     GO TO 99999-RETURN
  2399
  2400      .
  2401 11000-CHECK-MN-LEV-BALLOON.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  46
* ELRFND.cbl
  2402
  2403     IF (CP-COMPANY-ID EQUAL 'CID')
  2404        AND (CP-STATE-STD-ABBRV = 'MN')
  2405        AND (CP-CERT-EFF-DT > X'A4FF')
  2406        AND (CP-RATE-AS-REG-BALLOON)
  2407        AND (CP-EARN-AS-NET-PAY)
  2408        AND (CP-DEVIATION-CODE = 'LEV')
  2409        CONTINUE
  2410     ELSE
  2411        GO TO 11000-CONTINUE-REFUND
  2412     END-IF
  2413
  2414     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2415     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2416        ** (M - E)) / I
  2417
  2418     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2419
  2420     GO TO 99999-RETURN
  2421
  2422     .
  2423 11000-CONTINUE-REFUND.
  2424*    IF CP-GAP-ACTUARIAL
  2425*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2426*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2427*       COMPUTE WK3 = WK2 / ANGLEN
  2428*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2429     IF CP-GAP-ACTUARIAL
  2430        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2431           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2432        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2433     ELSE
  2434        COMPUTE WK3 ROUNDED =
  2435          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2436     END-IF
  2437
  2438     MOVE WK3  TO FACTOR.
  2439
  2440     GO TO 99999-RETURN.
  2441
  2442 12000-PREMIUM-RATE.
  2443*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2444*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2445*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2446*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2447*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2448*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2449
  2450     COMPUTE K-I = K1 + I.
  2451     MOVE K-I TO ONE-PLUS-I.
  2452
  2453     IF NPO-ALT OR NPO-TRUNC-0
  2454         MOVE K1 TO K-I.
  2455
  2456     IF NPO-2MO OR NPO-TRUNC-2
  2457         COMPUTE K-I = K1 + (2 * I).
  2458
  2459     IF NPO-3MO OR NPO-TRUNC-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  47
* ELRFND.cbl
  2460         COMPUTE K-I = K1 + (3 * I).
  2461
  2462     IF NPO-4MO OR NPO-TRUNC-4
  2463         COMPUTE K-I = K1 + (4 * I).
  2464
  2465     COMPUTE RA ROUNDED = 1 -
  2466             ((X2 * (X2 + 1)) /
  2467              (N *  (N  + 1))).
  2468
  2469     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2470        (CP-CSL-VALID-NP-BENEFIT-CD)
  2471        NEXT SENTENCE
  2472     ELSE
  2473        GO TO XXXX-CHECK-DISCOUNT-5.
  2474
  2475     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2476     MOVE ' ' TO DC-OPTION-CODE.
  2477     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2478
  2479     IF DATE-CONVERSION-ERROR
  2480        MOVE '2'                 TO CP-RETURN-CODE
  2481        MOVE ZEROS               TO FACTOR
  2482                                    CP-CALC-PREMIUM
  2483         GO TO 99999-RETURN.
  2484
  2485     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2486     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2487     MOVE ' ' TO DC-OPTION-CODE
  2488     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2489
  2490     IF DATE-CONVERSION-ERROR
  2491        MOVE '2'                 TO CP-RETURN-CODE
  2492        MOVE ZEROS               TO FACTOR
  2493                                    CP-CALC-PREMIUM
  2494         GO TO 99999-RETURN.
  2495
  2496     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  2497
  2498     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2499
  2500     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2501        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2502        CP-PAY-FREQUENCY / 365) * I
  2503     ELSE
  2504        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2505        CP-PAY-FREQUENCY / 365) * I.
  2506
  2507     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2508     13).
  2509
  2510     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2511     (N - ( ANGLEN-1 / WK3)).
  2512
  2513     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2514
  2515     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2516       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2517
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  48
* ELRFND.cbl
  2518     COMPUTE WS-Y-X-FACTOR EQUAL
  2519       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2520       WS-CALC-FREQ-RATE).
  2521
  2522     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2523       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2524
  2525     COMPUTE WS-X-Y-FACTOR EQUAL
  2526       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2527
  2528     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2529       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2530       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2531
  2532     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2533
  2534     GO TO 99999-RETURN.
  2535
  2536 XXXX-CHECK-DISCOUNT-5.
  2537
  2538     IF WS-DISCOUNT-OPTION EQUAL '5'
  2539        NEXT SENTENCE
  2540     ELSE
  2541        GO TO 12000-CHECK-CLIENT.
  2542
  2543      COMPUTE ANGLEN EQUAL WK1 / I.
  2544
  2545      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2546
  2547      COMPUTE WK3 EQUAL
  2548        (12 *
  2549        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2550        CP-ORIGINAL-BENEFIT)) /
  2551        APR100.
  2552
  2553     COMPUTE WK3 EQUAL
  2554        (WK3 * CP-PREMIUM-RATE) / +1000.
  2555
  2556     COMPUTE WK3 EQUAL
  2557        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2558
  2559      MOVE WK3 TO CP-CALC-PREMIUM.
  2560
  2561     GO TO 99999-RETURN.
  2562
  2563 12000-CHECK-CLIENT.
  2564
  2565     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2566        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2567        (CP-TRUNCATED-LIFE)
  2568        NEXT SENTENCE
  2569     ELSE
  2570        GO TO 12000-CHECK-NEXT.
  2571
  2572     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2573
  2574     COMPUTE ANGLEN EQUAL WK1 / I.
  2575     COMPUTE ANGLEM EQUAL WK2 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  49
* ELRFND.cbl
  2576
  2577     COMPUTE FM EQUAL
  2578                    (((ONE-PLUS-I ** M) * I * M) /
  2579                    ((ONE-PLUS-I ** M) - 1))
  2580                    - 1.
  2581
  2582     COMPUTE FN EQUAL
  2583                    (((ONE-PLUS-I ** N) * I * N) /
  2584                    ((ONE-PLUS-I ** N) - 1))
  2585                    - 1.
  2586
  2587     COMPUTE FNM EQUAL
  2588                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2589                    ((ONE-PLUS-I ** (N - M)) - 1))
  2590                    - 1.
  2591
  2592     COMPUTE GR EQUAL
  2593                    (WS-WORK-RATE * ANGLEM * I) /
  2594                    (M - ANGLEM).
  2595
  2596     COMPUTE ODF EQUAL
  2597                     (1 +
  2598                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2599                     360)) /
  2600                     ONE-PLUS-I.
  2601
  2602     COMPUTE OD EQUAL
  2603                    (1 + (ODF * (FN / I - 1))) +
  2604                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2605
  2606     COMPUTE WK3 EQUAL
  2607*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2608                    ((1 + FN) * ODF *
  2609                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2610                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2611                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2612
  2613     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2614     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2615
  2616     COMPUTE WK3 EQUAL
  2617                    (WK3 / (ODF * (1 + FN))) -
  2618*                   CP-ORIGINAL-BENEFIT.
  2619                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2620
  2621      MOVE WK3 TO CP-CALC-PREMIUM.
  2622
  2623     GO TO 99999-RETURN.
  2624
  2625 12000-CHECK-NEXT.
  2626
  2627     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2628        NEXT SENTENCE
  2629     ELSE
  2630        GO TO 12000-CHECK-PA-TRUNC.
  2631
  2632      IF WS-WORK-DIS-RATE EQUAL +0
  2633         MOVE '7'                TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  50
* ELRFND.cbl
  2634         MOVE ZEROS              TO FACTOR
  2635                                    CP-CALC-PREMIUM
  2636         GO TO 99999-RETURN.
  2637
  2638      COMPUTE ANGLEN EQUAL WK1 / I.
  2639
  2640      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2641
  2642      IF WS-WORK-DIS-RATE EQUAL APR100
  2643         ADD .00001 TO APR100.
  2644
  2645      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2646      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2647
  2648     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2649        / (1 + I)
  2650     COMPUTE ANGLEN-1 = ANGLEN / Y
  2651      IF CP-COMPANY-ID EQUAL 'CDL'
  2652         COMPUTE WK3 EQUAL
  2653
  2654          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2655          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2656
  2657          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2658
  2659          ((WK8 ** N) /
  2660          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2661
  2662          ((WK9 ** N) /
  2663          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2664
  2665      ELSE
  2666         COMPUTE WK3 EQUAL
  2667
  2668          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2669          (12 + WS-WORK-DIS-RATE) * 12) *
  2670
  2671          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2672
  2673          ((WK8 ** N) /
  2674          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2675
  2676          ((WK9 ** N) /
  2677          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  2678
  2679      COMPUTE WK3 EQUAL
  2680          (WK3 * CP-PREMIUM-RATE) / +1000.
  2681
  2682      MOVE WK3 TO CP-CALC-PREMIUM.
  2683
  2684     GO TO 99999-RETURN.
  2685
  2686 12000-CHECK-PA-TRUNC.
  2687
  2688     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2689        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  2690        (CP-EARN-AS-NET-PAY) AND
  2691        (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  51
* ELRFND.cbl
  2692        NEXT SENTENCE
  2693     ELSE
  2694        GO TO 12000-CHECK-MD-TRUNC.
  2695
  2696     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2697
  2698     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2699     COMPUTE ANGLEN EQUAL WK1 / I.
  2700
  2701     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2702
  2703     COMPUTE WK3 EQUAL
  2704        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  2705        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  2706
  2707     MOVE WK3 TO CP-CALC-PREMIUM.
  2708
  2709     GO TO 99999-RETURN.
  2710
  2711 12000-CHECK-MD-TRUNC.
  2712
  2713     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2714        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2715        (CP-EARN-AS-NET-PAY) AND
  2716        (CP-TRUNCATED-LIFE)
  2717        NEXT SENTENCE
  2718     ELSE
  2719        GO TO 12000-CHECK-MD.
  2720
  2721     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2722
  2723     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2724     COMPUTE ANGLEM EQUAL WK2 / I.
  2725     COMPUTE ANGLEN EQUAL WK1 / I.
  2726
  2727     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2728
  2729     COMPUTE WK3 EQUAL
  2730        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  2731        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  2732        (ANGLEN-1 * (M - ANGLEM))).
  2733
  2734     MOVE WK3 TO CP-CALC-PREMIUM.
  2735
  2736     GO TO 99999-RETURN.
  2737
  2738 12000-CHECK-MD.
  2739
  2740     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2741        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2742        (CP-EARN-AS-NET-PAY)
  2743        NEXT SENTENCE
  2744     ELSE
  2745        GO TO 12000-CHECK-ME-TRUNC.
  2746
  2747     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2748
  2749     COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  52
* ELRFND.cbl
  2750        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  2751
  2752     MOVE WK3 TO CP-CALC-PREMIUM.
  2753
  2754     GO TO 99999-RETURN.
  2755
  2756 12000-CHECK-ME-TRUNC.
  2757
  2758     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  2759        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2760        AND (CP-EARN-AS-NET-PAY)
  2761        AND (CP-TRUNCATED-LIFE)
  2762        CONTINUE
  2763     ELSE
  2764        GO TO 12000-CHECK-CID-FARMPLAN
  2765     END-IF
  2766
  2767     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  2768     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2769     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2770     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2771     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2772     COMPUTE ANGLEN-1 = ANGLEN / Y
  2773     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2774     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  2775     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  2776     COMPUTE WK3
  2777        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  2778        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  2779            * (1 / (1.0635 ** (M / 12))))
  2780*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  2781*    COMPUTE WK9 EQUAL
  2782*       1 / (1 + (.045 * (N - M) / 24))
  2783*    COMPUTE WK7 EQUAL
  2784*       WS-WORK-RATE * 20 / (M + 1).
  2785*    COMPUTE WK3 EQUAL
  2786*       ((( N - ANGLEN) * WK7 * WK8) /
  2787*       (10 * ANGLEN-1 * I)) -
  2788*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  2789*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  2790*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  2791*
  2792     MOVE WK3 TO CP-CALC-PREMIUM.
  2793
  2794     GO TO 99999-RETURN.
  2795 12000-CHECK-CID-FARMPLAN.
  2796     IF (CP-COMPANY-ID EQUAL 'CID')
  2797        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  2798           OR 'IN' OR 'AZ')
  2799        AND (CP-FARM-PLAN)
  2800        CONTINUE
  2801     ELSE
  2802        GO TO 12000-CHECK-SC-CID
  2803     END-IF
  2804     COMPUTE N = M / CP-PAY-FREQUENCY
  2805     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2806     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  2807        ** CP-PAY-FREQUENCY) - 1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  53
* ELRFND.cbl
  2808     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  2809     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2810        ** TI) / WS-WORK-DIS-RATE
  2811     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  2812     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  2813     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2814        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  2815     COMPUTE WK2 = WK2 * (1 + J)
  2816     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  2817     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  2818     COMPUTE WK3 = WK3 * (1 + J)
  2819     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  2820        ** (N - 1))) / J
  2821     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  2822        ((N * WK2) - WK5)) + (N * WK1)) *
  2823        (CP-PREMIUM-RATE / 1000)
  2824     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  2825     COMPUTE WK6 = (WK7 * GR)
  2826     MOVE WK6 TO CP-CALC-PREMIUM
  2827     GO TO 99999-RETURN
  2828     .
  2829 12000-CHECK-SC-CID.
  2830     IF (CP-COMPANY-ID EQUAL 'CID')
  2831        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  2832        AND (CP-EARN-AS-NET-PAY)
  2833        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2834        CONTINUE
  2835     ELSE
  2836        GO TO 12000-CHECK-AL-CID
  2837     END-IF
  2838     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2839     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2840     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2841     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2842     COMPUTE ANGLEN-1 = ANGLEN / Y
  2843     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  2844        / 12)) / ((M + 1) / 2)
  2845     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2846     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  2847        + 6 * M) * (WK2 / 100) * (1 + I)
  2848     MOVE WK3 TO CP-CALC-PREMIUM
  2849     GO TO 99999-RETURN
  2850     .
  2851 12000-CHECK-AL-CID.
  2852     IF (CP-COMPANY-ID EQUAL 'CID')
  2853        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  2854        AND (CP-EARN-AS-NET-PAY)
  2855        CONTINUE
  2856     ELSE
  2857        GO TO 12000-CHECK-NH-CID
  2858     END-IF
  2859     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2860     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2861     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2862     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  2863                   / (1 + I)
  2864     COMPUTE ANGLEN-1 = ANGLEN / WK8
  2865     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  54
* ELRFND.cbl
  2866     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  2867        (CP-PREMIUM-RATE / 1000)
  2868     MOVE WK3 TO CP-CALC-PREMIUM
  2869     GO TO 99999-RETURN
  2870     .
  2871 12000-CHECK-NH-CID.
  2872     IF (CP-COMPANY-ID EQUAL 'CID')
  2873        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  2874        AND (CP-EARN-AS-NET-PAY)
  2875        CONTINUE
  2876     ELSE
  2877        GO TO 12000-CHECK-PA-CID
  2878     END-IF
  2879     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2880     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2881     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  2882                   / (1 + I)
  2883     COMPUTE ANGLEN-1 = ANGLEN / WK8
  2884     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2885     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  2886        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  2887     MOVE WK3 TO CP-CALC-PREMIUM
  2888     GO TO 99999-RETURN
  2889     .
  2890 12000-CHECK-PA-CID.
  2891     IF (CP-COMPANY-ID EQUAL 'CID')
  2892        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  2893        AND (CP-EARN-AS-NET-PAY)
  2894        CONTINUE
  2895     ELSE
  2896        GO TO 12000-CHECK-ME-CID
  2897     END-IF
  2898
  2899     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2900     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2901     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2902     COMPUTE ANGLEN-1 = ANGLEN / Y
  2903     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  2904     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2905     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  2906     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  2907        * WK5
  2908     MOVE WK3 TO CP-CALC-PREMIUM
  2909     GO TO 99999-RETURN
  2910     .
  2911 12000-CHECK-ME-CID.
  2912     IF (CP-COMPANY-ID EQUAL 'CID')
  2913        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2914        AND (CP-EARN-AS-NET-PAY)
  2915        CONTINUE
  2916     ELSE
  2917        GO TO 12000-CHECK-VT-TRUNC
  2918     END-IF
  2919     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  2920     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2921     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2922     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2923     COMPUTE ANGLEN-1 = ANGLEN / Y
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  55
* ELRFND.cbl
  2924     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2925     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  2926     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  2927        * WK5
  2928     MOVE WK3 TO CP-CALC-PREMIUM
  2929     GO TO 99999-RETURN
  2930     .
  2931 12000-CHECK-VT-TRUNC.
  2932
  2933     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2934        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  2935        (CP-EARN-AS-NET-PAY) AND
  2936        (CP-TRUNCATED-LIFE)
  2937        NEXT SENTENCE
  2938     ELSE
  2939        GO TO 12000-CHECK-VT.
  2940
  2941      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  2942
  2943      COMPUTE ANGLEN EQUAL WK1 / I.
  2944
  2945      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2946
  2947      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  2948      COMPUTE WK9 EQUAL
  2949        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  2950        ((.0054 - I) / (1 + I)).
  2951      COMPUTE WK7 EQUAL
  2952        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  2953      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  2954        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  2955
  2956      MOVE WK3 TO CP-CALC-PREMIUM.
  2957
  2958     GO TO 99999-RETURN.
  2959
  2960 12000-CHECK-VT.
  2961
  2962     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2963        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  2964        (CP-EARN-AS-NET-PAY)
  2965        NEXT SENTENCE
  2966     ELSE
  2967        GO TO 12000-CHECK-MINN-WDS.
  2968
  2969      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  2970
  2971      COMPUTE ANGLEN EQUAL WK1 / I.
  2972
  2973      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2974
  2975      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  2976                        (ANGLEN-1 * I)) *
  2977
  2978                        (((1.0054 ** N - 1) /
  2979                        (1.0054 ** (N - 1) * .0054)) -
  2980
  2981                        ((V * (1 - 1.0054 ** N * VX)) /
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  56
* ELRFND.cbl
  2982                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  2983
  2984      MOVE WK3 TO CP-CALC-PREMIUM.
  2985
  2986     GO TO 99999-RETURN.
  2987
  2988 12000-CHECK-MINN-WDS.
  2989
  2990     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2991        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  2992        (CP-EARN-AS-NET-PAY)
  2993        NEXT SENTENCE
  2994     ELSE
  2995        GO TO 12000-CHECK-MINN-BALL-LEV.
  2996
  2997     COMPUTE ANGLEN EQUAL WK1 / I.
  2998     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  2999              (N / +12) * (2 / (N + 1)).
  3000     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3001         WK3 * ((N - ANGLEN) / I).
  3002
  3003      MOVE WK3 TO CP-CALC-PREMIUM.
  3004
  3005     GO TO 99999-RETURN.
  3006
  3007 12000-CHECK-MINN-BALL-LEV.
  3008
  3009     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3010        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3011        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3012        (CP-EARN-AS-REG-BALLOON)
  3013        NEXT SENTENCE
  3014     ELSE
  3015        GO TO 12000-CHECK-MINN-BALL.
  3016
  3017     COMPUTE ANGLEN EQUAL WK1 / I.
  3018
  3019     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3020
  3021     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3022        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3023
  3024     MOVE WK3 TO CP-CALC-PREMIUM.
  3025
  3026     GO TO 99999-RETURN.
  3027
  3028 12000-CHECK-MINN-BALL.
  3029
  3030     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3031        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3032        (CP-EARN-AS-REG-BALLOON)
  3033        NEXT SENTENCE
  3034     ELSE
  3035        GO TO 12000-CHECK-CID-MN-BALL.
  3036
  3037     COMPUTE ANGLEN EQUAL WK1 / I.
  3038     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3039
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  57
* ELRFND.cbl
  3040     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3041     / +100 * (N - 1) / 12 * 2 / N *
  3042     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3043
  3044      MOVE WK3 TO CP-CALC-PREMIUM.
  3045
  3046     GO TO 99999-RETURN.
  3047
  3048 12000-CHECK-CID-MN-BALL.
  3049     IF (CP-COMPANY-ID EQUAL 'CID')
  3050        AND (CP-STATE-STD-ABBRV = 'MN')
  3051        AND (CP-CERT-EFF-DT > X'A4FF')
  3052        AND (CP-EARN-AS-REG-BALLOON)
  3053        CONTINUE
  3054     ELSE
  3055        GO TO 12000-CHECK-NC-WDS
  3056     END-IF
  3057     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3058     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3059     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3060     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3061     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3062     COMPUTE V = 1 / (1 + I)
  3063     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3064     COMPUTE Y = (1 + (D * I) / +30)
  3065        / (1 + I)
  3066     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3067        * CP-PREMIUM-RATE / 1000
  3068*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3069*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3070*    ELSE
  3071*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3072*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3073*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3074*       DISPLAY ' BALLOON TOP ' WK6
  3075*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3076*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3077*          / 100
  3078*       DISPLAY ' BALLOON BOTTOM ' WK7
  3079*       COMPUTE GR = WK6 / WK7
  3080*       DISPLAY ' BALLOON PAYMENT ' GR
  3081*    END-IF
  3082     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3083     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3084        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3085     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3086     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3087        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3088           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3089           * CP-PREMIUM-RATE / 1000
  3090     MOVE WK3                    TO CP-CALC-PREMIUM
  3091     GO TO 99999-RETURN.
  3092     .
  3093 12000-CHECK-NC-WDS.
  3094
  3095     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3096        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3097        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  58
* ELRFND.cbl
  3098        NEXT SENTENCE
  3099     ELSE
  3100        GO TO 12000-CHECK-NC-BALL-LEV.
  3101
  3102     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3103     COMPUTE ANGLEN EQUAL WK1 / I.
  3104     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3105              CP-PREMIUM-RATE / +100 *
  3106              N / +12 * 2 / (N + 1) *
  3107              (WK4 - ANGLEN) / (I * ANGLEN).
  3108
  3109      MOVE WK3 TO CP-CALC-PREMIUM.
  3110
  3111     GO TO 99999-RETURN.
  3112
  3113 12000-CHECK-NC-BALL-LEV.
  3114
  3115     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3116        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3117        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3118        (CP-EARN-AS-REG-BALLOON)
  3119        NEXT SENTENCE
  3120     ELSE
  3121        GO TO 12000-CHECK-NC-BALL.
  3122
  3123     COMPUTE ANGLEN EQUAL WK1 / I.
  3124
  3125**** VX = 1 / (1 + I)**N.
  3126
  3127     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3128        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3129
  3130     MOVE WK3 TO CP-CALC-PREMIUM.
  3131
  3132     GO TO 99999-RETURN.
  3133
  3134 12000-CHECK-NC-BALL.
  3135
  3136     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3137        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3138        (CP-EARN-AS-REG-BALLOON)
  3139        NEXT SENTENCE
  3140     ELSE
  3141        GO TO 12000-CHECK-MINN-TRUNC.
  3142
  3143     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3144     COMPUTE ANGLEN EQUAL WK1 / I.
  3145     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3146**** VX = 1 / (1 + I)**N.
  3147
  3148     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3149     / +100 * (N - 1) / 12 * 2 / N *
  3150     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3151
  3152      MOVE WK3 TO CP-CALC-PREMIUM.
  3153
  3154     GO TO 99999-RETURN.
  3155
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  59
* ELRFND.cbl
  3156 12000-CHECK-MINN-TRUNC.
  3157
  3158     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3159        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3160        (M GREATER THAN +63) AND
  3161        (CP-EARN-AS-NET-PAY) AND
  3162        (CP-TRUNCATED-LIFE)
  3163        NEXT SENTENCE
  3164     ELSE
  3165        GO TO 12000-CHECK-MINN.
  3166
  3167      COMPUTE ANGLEN EQUAL WK1 / I.
  3168      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3169
  3170      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3171
  3172      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3173       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3174       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3175
  3176      MOVE WK3 TO CP-CALC-PREMIUM.
  3177
  3178     GO TO 99999-RETURN.
  3179
  3180 12000-CHECK-MINN.
  3181
  3182     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3183        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3184        (M GREATER THAN +63) AND
  3185        (CP-EARN-AS-NET-PAY)
  3186        NEXT SENTENCE
  3187     ELSE
  3188        GO TO 12000-CHECK-MONTANA-TRUNC.
  3189
  3190      COMPUTE ANGLEN EQUAL WK1 / I.
  3191
  3192      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3193
  3194      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3195       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3196       (((N - ANGLEN) / I) + (2 * N)).
  3197
  3198      MOVE WK3 TO CP-CALC-PREMIUM.
  3199
  3200     GO TO 99999-RETURN.
  3201
  3202 12000-CHECK-MONTANA-TRUNC.
  3203
  3204     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3205        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3206        (M GREATER THAN +63) AND
  3207        (CP-EARN-AS-NET-PAY) AND
  3208        (CP-TRUNCATED-LIFE)
  3209        NEXT SENTENCE
  3210     ELSE
  3211        GO TO 12000-CHECK-MONTANA.
  3212
  3213      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  60
* ELRFND.cbl
  3214      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3215
  3216      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3217
  3218      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3219      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3220       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3221
  3222      MOVE WK3 TO CP-CALC-PREMIUM.
  3223
  3224     GO TO 99999-RETURN.
  3225
  3226 12000-CHECK-MONTANA.
  3227
  3228     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3229        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3230        (M GREATER THAN +63) AND
  3231        (CP-EARN-AS-NET-PAY)
  3232        NEXT SENTENCE
  3233     ELSE
  3234        GO TO 12001-CONTINUE-NCL-TRUNC.
  3235
  3236      COMPUTE ANGLEN EQUAL WK1 / I.
  3237
  3238      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3239
  3240      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3241       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3242       (((N - ANGLEN) / I) + (4 * N)).
  3243
  3244      MOVE WK3 TO CP-CALC-PREMIUM.
  3245
  3246     GO TO 99999-RETURN.
  3247
  3248 12001-CONTINUE-NCL-TRUNC.
  3249
  3250     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3251        (CP-EARN-AS-NET-PAY) AND
  3252        (CP-TRUNCATED-LIFE)
  3253        NEXT SENTENCE
  3254     ELSE
  3255        GO TO 12001-CONTINUE-NCL.
  3256
  3257      COMPUTE ANGLEN EQUAL WK1 / I.
  3258      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3259
  3260      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3261
  3262      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3263      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3264      (ANGLEN-1 * (N + 1) * I).
  3265
  3266      MOVE WK3 TO CP-CALC-PREMIUM.
  3267
  3268     GO TO 99999-RETURN.
  3269
  3270 12001-CONTINUE-NCL.
  3271
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  61
* ELRFND.cbl
  3272     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3273        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3274        (CP-EARN-AS-NET-PAY)
  3275        GO TO 12001-CHECK-NC-NET-PLUS3.
  3276
  3277     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3278        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3279        (CP-EARN-AS-NET-PAY)
  3280        GO TO 12001-CHECK-CA.
  3281
  3282     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3283        (CP-EARN-AS-NET-PAY)
  3284        NEXT SENTENCE
  3285     ELSE
  3286        GO TO 12000-CONTINUE-NET.
  3287
  3288      COMPUTE ANGLEN EQUAL WK1 / I.
  3289      MOVE ANGLEN                TO ANGLEN-1.
  3290
  3291      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3292
  3293      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3294       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3295       ((N - ANGLEN) / I).
  3296
  3297      MOVE WK3 TO CP-CALC-PREMIUM.
  3298
  3299     GO TO 99999-RETURN.
  3300
  3301 12000-CONTINUE-NET.
  3302
  3303     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3304        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3305        (CP-EARN-AS-NET-PAY)
  3306        NEXT SENTENCE
  3307     ELSE
  3308        GO TO 12001-CONTINUE-MINN.
  3309
  3310      COMPUTE ANGLEN EQUAL WK6 / I.
  3311      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3312
  3313      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3314      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3315      COMPUTE WK3 EQUAL (WK3 / I) *
  3316       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3317
  3318      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3319         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3320
  3321      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3322
  3323      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3324         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3325         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3326
  3327      MOVE WK3 TO CP-CALC-PREMIUM.
  3328
  3329     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  62
* ELRFND.cbl
  3330
  3331 12001-CONTINUE-MINN.
  3332
  3333     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3334        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3335        (CP-TRUNCATED-LIFE)
  3336        NEXT SENTENCE
  3337     ELSE
  3338        GO TO 12001-CHECK-RI-GTL.
  3339
  3340      COMPUTE ANGLEN EQUAL WK1 / I.
  3341      COMPUTE ANGLEM EQUAL WK2 / I.
  3342
  3343      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3344       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3345       * M / 2400) * 1000 + .5) / 1000000.
  3346
  3347      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  3348       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3349
  3350     GO TO 99999-RETURN.
  3351
  3352 12001-CHECK-RI-GTL.
  3353
  3354     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3355        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3356        (CP-EARN-AS-NET-PAY)
  3357        NEXT SENTENCE
  3358     ELSE
  3359        GO TO 12001-CHECK-RI-LEASE-GTL.
  3360
  3361      COMPUTE ANGLEN EQUAL WK1 / I.
  3362*     COMPUTE ANGLEM EQUAL WK2 / I.
  3363
  3364      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  3365               (1 + WS-WORK-DIS-RATE * N).
  3366      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  3367         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  3368
  3369
  3370     GO TO 99999-RETURN.
  3371
  3372 12001-CHECK-RI-LEASE-GTL.
  3373
  3374     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3375        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3376        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3377        NEXT SENTENCE
  3378     ELSE
  3379        GO TO 12001-CHECK-OR-GTL.
  3380
  3381     COMPUTE ANGLEN EQUAL WK1 / I.
  3382
  3383     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  3384        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  3385                        /
  3386        (1000 * I * (1 + .0021 * N)).
  3387     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  63
* ELRFND.cbl
  3388       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  3389                            /
  3390       (1000 * (1 + .0027 * (N + 1))).
  3391
  3392     GO TO 99999-RETURN.
  3393
  3394 12001-CHECK-OR-GTL.
  3395
  3396     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3397        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  3398        (CP-EARN-AS-NET-PAY)
  3399        NEXT SENTENCE
  3400     ELSE
  3401        GO TO 12001-CHECK-GA-GTL.
  3402
  3403     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3404     COMPUTE ANGLEN EQUAL WK1 / I.
  3405
  3406     IF M LESS THAN +64
  3407        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3408         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  3409                   /
  3410         (I * ANGLEN * (N - (N - M) + 1) * 600)
  3411        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  3412     ELSE
  3413        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3414        CP-PREMIUM-RATE * (1 + I))
  3415                  /
  3416        (+1000 * I * ANGLEN)
  3417        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3418*    MOVE WK3 TO CP-CALC-PREMIUM.
  3419     GO TO 99999-RETURN.
  3420
  3421 12001-CHECK-GA-GTL.
  3422
  3423     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3424        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  3425        (CP-EARN-AS-NET-PAY)
  3426*       (CP-TRUNCATED-LIFE)
  3427        NEXT SENTENCE
  3428     ELSE
  3429        GO TO 12001-CHECK-MA-GTL.
  3430
  3431     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3432     COMPUTE ANGLEN EQUAL WK1 / I.
  3433
  3434     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  3435     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  3436      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  3437     MOVE WK3 TO CP-CALC-PREMIUM.
  3438
  3439     GO TO 99999-RETURN.
  3440
  3441 12001-CHECK-MA-GTL.
  3442
  3443     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3444        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  3445        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  64
* ELRFND.cbl
  3446        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3447        NEXT SENTENCE
  3448     ELSE
  3449        GO TO 12001-CHECK-NV-NET.
  3450
  3451     COMPUTE ANGLEN EQUAL WK1 / I.
  3452
  3453     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  3454      CP-ALTERNATE-BENEFIT * N.
  3455
  3456     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  3457     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  3458
  3459     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  3460     WK7 * (N - ANGLEN) / I.
  3461     MOVE WK3 TO CP-CALC-PREMIUM.
  3462
  3463     GO TO 99999-RETURN.
  3464
  3465 12001-CHECK-NV-NET.
  3466     IF (CP-COMPANY-ID EQUAL 'CID')
  3467        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3468        AND (CP-EARN-AS-NET-PAY)
  3469        CONTINUE
  3470     ELSE
  3471        GO TO 12001-CHECK-MN-NET
  3472     END-IF
  3473     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3474     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3475     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3476                   / (1 + I)
  3477     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3478     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3479     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3480        (CP-PREMIUM-RATE * K-I / 1000)
  3481     MOVE WK3                    TO CP-CALC-PREMIUM
  3482     GO TO 99999-RETURN
  3483      .
  3484 12001-CHECK-MN-NET.
  3485     IF (CP-COMPANY-ID EQUAL 'CID')
  3486        AND (CP-STATE-STD-ABBRV = 'MN')
  3487        AND (CP-EARN-AS-NET-PAY)
  3488        AND (NOT CP-LEVEL-LIFE)
  3489        AND (WS-DISCOUNT-OPTION = '1')
  3490        CONTINUE
  3491     ELSE
  3492        GO TO 12001-CHECK-NC-NET
  3493     END-IF
  3494     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3495     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3496     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3497                   / (1 + I)
  3498     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3499     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3500     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3501        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3502     MOVE WK3                    TO CP-CALC-PREMIUM
  3503     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  65
* ELRFND.cbl
  3504      .
  3505 12001-CHECK-NC-NET.
  3506
  3507     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  3508        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3509        (CP-EARN-AS-NET-PAY)
  3510        NEXT SENTENCE
  3511     ELSE
  3512        GO TO 12001-CHECK-NC-NET-PLUS3.
  3513
  3514      COMPUTE ANGLEN EQUAL WK1 / I.
  3515      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3516
  3517      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  3518          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  3519          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  3520          N * (CP-PREMIUM-RATE / 1000)).
  3521
  3522      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  3523          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  3524
  3525      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  3526          ((N - ANGLEN) / I + 3) / ANGLEN) /
  3527          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  3528          (ANGLEN * 2))
  3529
  3530      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  3531
  3532      IF ANGLEN IS NOT LESS THAN WK7
  3533          COMPUTE CP-PREMIUM-RATE ROUNDED =
  3534              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  3535          COMPUTE WK3 ROUNDED =
  3536              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  3537
  3538     MOVE WK3 TO CP-CALC-PREMIUM.
  3539
  3540     GO TO 99999-RETURN.
  3541
  3542 12001-CHECK-NC-NET-PLUS3.
  3543
  3544     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3545        (CP-EARN-AS-NET-PAY) AND
  3546        (CP-COMPANY-ID NOT = 'CID' AND 'DCC')
  3547        NEXT SENTENCE
  3548     ELSE
  3549        GO TO 12001-CHECK-CA.
  3550
  3551     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3552     MOVE ' ' TO DC-OPTION-CODE.
  3553     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3554
  3555     IF DATE-CONVERSION-ERROR
  3556        MOVE '2'                 TO CP-RETURN-CODE
  3557        MOVE ZEROS               TO FACTOR
  3558                                    CP-CALC-PREMIUM
  3559         GO TO 99999-RETURN.
  3560
  3561     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  66
* ELRFND.cbl
  3562        NEXT SENTENCE
  3563     ELSE
  3564        GO TO 12001-CONTINUE-NET.
  3565
  3566     COMPUTE ANGLEN EQUAL WK1 / I.
  3567     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3568
  3569     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  3570
  3571     COMPUTE NC-R = 20 *
  3572                    ((NC-LR * ORIGINAL-TERM) / 12)
  3573                          / (ORIGINAL-TERM + 1).
  3574
  3575     COMPUTE NC-OB = NC-R / 1000.
  3576
  3577     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  3578                    (NC-OB * ORIGINAL-TERM * 3).
  3579
  3580     IF CP-EXT-CHG-LF
  3581         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  3582     ELSE
  3583         MOVE 30                 TO  NC-BIG-D.
  3584
  3585     COMPUTE NC-LITTLE-D = (1 + I) /
  3586             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  3587
  3588     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  3589             (ANGLEN * NC-LITTLE-D ).
  3590
  3591     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  3592
  3593     GO TO 99999-RETURN.
  3594
  3595 12001-CHECK-CA.
  3596
  3597     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3598        (WS-DISCOUNT-OPTION = '6')
  3599        NEXT SENTENCE
  3600     ELSE
  3601        GO TO 12001-CHECK-GTL-IA.
  3602
  3603     COMPUTE CA-J = CA-DISCOUNT / 12.
  3604     COMPUTE ANGLEN EQUAL WK1 / I.
  3605     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  3606     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  3607     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  3608     COMPUTE CA-VI = (1 + I)** -1.
  3609     COMPUTE CP-CALC-PREMIUM =
  3610         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  3611         ((1 + CA-J) / I) *
  3612         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  3613         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  3614         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  3615
  3616     GO TO 99999-RETURN.
  3617
  3618 12001-CHECK-GTL-IA.
  3619
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  67
* ELRFND.cbl
  3620     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  3621        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  3622        (CP-EARN-AS-NET-PAY)
  3623        NEXT SENTENCE
  3624     ELSE
  3625        GO TO 12001-CHECK-CID-TRN-VA.
  3626
  3627***************************************************************
  3628
  3629     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  3630
  3631     IF GTL-IA-ODD-DAYS = ZEROS
  3632         MOVE ZERO               TO  GTL-IA-SGN
  3633     ELSE
  3634         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  3635             MOVE +1             TO  GTL-IA-SGN
  3636         ELSE
  3637             MOVE -1             TO  GTL-IA-SGN.
  3638
  3639     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  3640     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  3641
  3642     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  3643                          GTL-IA-SGN.
  3644
  3645     COMPUTE ANGLEN EQUAL WK1 / I.
  3646     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3647
  3648     IF GTL-IA-ODF NOT = ZERO
  3649         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  3650         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  3651
  3652     COMPUTE GTL-IA-DIVIDEND =
  3653           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  3654                             (ANGLEN - ANGLEN-M))) *
  3655           ((K1 + I) * CP-PREMIUM-RATE *
  3656                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  3657
  3658     COMPUTE GTL-IA-DIVISOR =
  3659      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  3660
  3661     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  3662
  3663     COMPUTE CP-CALC-PREMIUM =
  3664                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  3665     GO TO 99999-RETURN.
  3666
  3667
  3668 12001-CHECK-CID-TRN-VA.
  3669
  3670     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3671        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  3672        (CP-EARN-AS-NET-PAY) AND
  3673        (CP-TRUNCATED-LIFE) AND
  3674        (CP-STATE-STD-ABBRV = CP-STATE)
  3675        CONTINUE
  3676     ELSE
  3677        GO TO 12001-CHECK-CID-TX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  68
* ELRFND.cbl
  3678     END-IF
  3679
  3680     COMPUTE ANGLEN EQUAL WK1 / I
  3681     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3682     IF WS-WORK-DIS-RATE = ZEROS
  3683        CONTINUE
  3684     ELSE
  3685        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3686        COMPUTE WK7 = (1 / I) *
  3687              (((WK4 ** M - 1) / (WK4 - 1)) -
  3688              ((WK4 ** M * SX - VX) /
  3689              (WK4 * (1 + I) - 1))) *
  3690              (CP-PREMIUM-RATE / 1000)
  3691        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3692        COMPUTE WK8 = WK7 * 100 / ANGLEN
  3693        COMPUTE CP-CALC-PREMIUM =
  3694           WK8 *  ((WK4 * ANGLEN) / 100)
  3695     END-IF
  3696
  3697     GO TO 99999-RETURN
  3698
  3699     .
  3700
  3701 12001-CHECK-CID-TX.
  3702     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3703        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  3704        (CP-EARN-AS-NET-PAY) AND
  3705        (WS-WORK-DIS-RATE > ZEROS) AND
  3706        (CP-STATE-STD-ABBRV = CP-STATE)
  3707        CONTINUE
  3708     ELSE
  3709        GO TO 12001-CHECK-CID-LEV-MN-NEW
  3710     END-IF
  3711* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  3712     COMPUTE K-I = 1 + (1 * I)
  3713     COMPUTE ANGLEN EQUAL WK1 / I
  3714     COMPUTE ANGLEM EQUAL WK2 / I
  3715     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3716     IF WS-WORK-DIS-RATE = ZEROS
  3717        CONTINUE
  3718     ELSE
  3719        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3720        COMPUTE WK7 = (K-I / I) *
  3721              (((WK4 ** M - 1) / (WK4 - 1)) -
  3722*             ((WK4 ** M * SX - VX) /
  3723              ((WK4 ** M * SX) - VX) /
  3724*             (WK4 * (1 + I) - 1))) *
  3725              (WK4 * (1 + I) - 1)) *
  3726              (CP-PREMIUM-RATE / 1000)
  3727        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3728        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  3729        COMPUTE CP-CALC-PREMIUM =
  3730           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  3731     END-IF
  3732
  3733     GO TO 99999-RETURN
  3734     .
  3735 12001-CHECK-CID-LEV-MN-NEW.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  69
* ELRFND.cbl
  3736*    IF (CP-COMPANY-ID EQUAL 'CID')
  3737*       AND (CP-STATE-STD-ABBRV = 'MN')
  3738*       AND (CP-EARN-AS-NET-PAY)
  3739*       AND (CP-LEVEL-LIFE)
  3740*       AND (CP-CERT-EFF-DT > X'A4FF')
  3741*       CONTINUE
  3742*    ELSE
  3743*       GO TO 12001-CHECK-CID-LEV-MN
  3744*    END-IF
  3745*
  3746*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  3747*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  3748*    MOVE '1'                    TO DC-OPTION-CODE
  3749*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  3750*
  3751*    IF DATE-CONVERSION-ERROR
  3752*       MOVE '2'                 TO CP-RETURN-CODE
  3753*       MOVE ZEROS               TO FACTOR
  3754*                                   CP-CALC-PREMIUM
  3755*       GO TO 99999-RETURN
  3756*    END-IF
  3757*
  3758*    COMPUTE I = CP-LOAN-APR / 100
  3759*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  3760*
  3761*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  3762*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  3763*      * 12 / 360 * D)
  3764*
  3765*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  3766*       * 12 / 360 * D
  3767*
  3768*    GO TO 99999-RETURN
  3769      .
  3770 12001-CHECK-CID-LEV-MN.
  3771
  3772     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3773        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3774        (CP-EARN-AS-NET-PAY) AND
  3775        (CP-LEVEL-LIFE) AND
  3776        (CP-STATE-STD-ABBRV = CP-STATE)
  3777        CONTINUE
  3778     ELSE
  3779        GO TO 12001-CHECK-CID-LEV-CA
  3780     END-IF
  3781
  3782     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  3783         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  3784         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  3785
  3786     GO TO 99999-RETURN
  3787
  3788      .
  3789 12001-CHECK-CID-LEV-CA.
  3790
  3791     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3792        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3793        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  70
* ELRFND.cbl
  3794        (CP-LEVEL-LIFE) AND
  3795        (CP-STATE-STD-ABBRV = CP-STATE)
  3796        CONTINUE
  3797     ELSE
  3798        GO TO 12001-CHECK-CID-TRN-CA
  3799     END-IF
  3800
  3801     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  3802     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  3803     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  3804     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  3805     COMPUTE CP-CALC-PREMIUM =
  3806          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  3807          (CP-PREMIUM-RATE / 1000)) /
  3808          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  3809
  3810     GO TO 99999-RETURN
  3811
  3812      .
  3813 12001-CHECK-CID-TRN-CA.
  3814
  3815     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3816        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3817        (CP-EARN-AS-NET-PAY) AND
  3818        (CP-TRUNCATED-LIFE) AND
  3819        (CP-STATE-STD-ABBRV = CP-STATE) AND
  3820        (WS-DISCOUNT-OPTION NOT = ' ')
  3821        CONTINUE
  3822     ELSE
  3823        GO TO 12001-CHECK-CID-TRN-MT
  3824     END-IF
  3825
  3826     COMPUTE ANGLEN EQUAL WK1 / I
  3827     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3828     IF WS-WORK-DIS-RATE = ZEROS
  3829        CONTINUE
  3830     ELSE
  3831        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3832        COMPUTE WK7 = (1 / I) *
  3833              (((WK4 ** M - 1) / (WK4 - 1)) -
  3834              ((WK4 ** M * SX - VX) /
  3835              (WK4 * (1 + I) - 1))) *
  3836              (CP-PREMIUM-RATE / 1000)
  3837        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3838        COMPUTE CP-CALC-PREMIUM =
  3839           WK4 *  WK7
  3840     END-IF
  3841
  3842     GO TO 99999-RETURN
  3843
  3844      .
  3845 12001-CHECK-CID-TRN-MT.
  3846
  3847     IF (CP-COMPANY-ID EQUAL 'CID') AND
  3848        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  3849                   OR
  3850        ((CP-STATE-STD-ABBRV = 'IN') AND
  3851        (CP-CERT-EFF-DT > X'9A7F'))
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  71
* ELRFND.cbl
  3852                   OR
  3853        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  3854        (CP-CERT-EFF-DT > X'9ADF'))) AND
  3855        (CP-EARN-AS-NET-PAY) AND
  3856        (CP-TRUNCATED-LIFE) AND
  3857        (CP-STATE-STD-ABBRV = CP-STATE)
  3858        CONTINUE
  3859     ELSE
  3860        GO TO 12001-CHECK-CID-MT
  3861     END-IF
  3862
  3863* K-I WILL BE USED FOR EXTRA INT. PERIODS
  3864     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  3865        MOVE 0                   TO K-I
  3866     ELSE
  3867        MOVE 2                   TO K-I
  3868     END-IF
  3869     COMPUTE CP-TERM-OR-EXT-DAYS =
  3870           CP-TERM-OR-EXT-DAYS + 30
  3871
  3872     COMPUTE ANGLEN EQUAL WK1 / I
  3873     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3874     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  3875                   / (1 + I)
  3876     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3877     IF WS-WORK-DIS-RATE = ZEROS
  3878        CONTINUE
  3879     ELSE
  3880        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3881*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  3882        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  3883              (((WK4 ** M - 1) / (WK4 - 1)) -
  3884              ((WK4 ** M * SX - VX) /
  3885              (WK4 * (1 + I) - 1))) *
  3886              (CP-PREMIUM-RATE / 1000)
  3887        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3888*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  3889        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  3890        COMPUTE CP-CALC-PREMIUM =
  3891           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  3892*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  3893     END-IF
  3894
  3895     GO TO 99999-RETURN
  3896
  3897     .
  3898 12001-CHECK-CID-MT.
  3899
  3900     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3901        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  3902                                OR 'VT')
  3903                   OR
  3904        ((CP-STATE-STD-ABBRV = 'IN') AND
  3905        (CP-CERT-EFF-DT > X'9A7F'))
  3906                   OR
  3907        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  3908        (CP-CERT-EFF-DT > X'9ADF'))) AND
  3909        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  72
* ELRFND.cbl
  3910        (CP-STATE-STD-ABBRV = CP-STATE)
  3911        CONTINUE
  3912     ELSE
  3913        GO TO 12001-CHECK-DCC-DD
  3914     END-IF
  3915
  3916     COMPUTE CP-TERM-OR-EXT-DAYS =
  3917           CP-TERM-OR-EXT-DAYS + 30
  3918
  3919* K-I WILL BE USED FOR EXTRA INT. PERIODS
  3920     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  3921        MOVE 0                   TO K-I
  3922     ELSE
  3923        IF CP-STATE-STD-ABBRV = 'NJ'
  3924           MOVE 1                TO K-I
  3925        ELSE
  3926           MOVE 2                TO K-I
  3927        END-IF
  3928     END-IF
  3929     COMPUTE ANGLEN EQUAL WK1 / I
  3930     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3931     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  3932                   / (1 + I)
  3933     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3934     IF WS-WORK-DIS-RATE = ZEROS
  3935        CONTINUE
  3936     ELSE
  3937        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3938*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  3939        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  3940              (((WK4 ** N - 1) / (WK4 - 1)) -
  3941              ((WK4 ** N - SV) /
  3942              (WK4 * (1 + I) - 1))) *
  3943              (CP-PREMIUM-RATE / 1000)
  3944        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3945*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  3946        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  3947        COMPUTE CP-CALC-PREMIUM =
  3948           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  3949*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  3950     END-IF
  3951
  3952     GO TO 99999-RETURN
  3953
  3954     .
  3955 12001-CHECK-DCC-DD.
  3956     IF (CP-COMPANY-ID EQUAL 'DCC')
  3957        AND (CP-EARN-AS-NET-PAY)
  3958        AND (CP-BEN-CATEGORY = 'D')
  3959        CONTINUE
  3960     ELSE
  3961        GO TO 12001-CHECK-DCC-NET
  3962     END-IF
  3963
  3964     COMPUTE CP-TERM-OR-EXT-DAYS =
  3965           CP-TERM-OR-EXT-DAYS + 30
  3966
  3967     COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  73
* ELRFND.cbl
  3968     COMPUTE ANGLEM EQUAL WK2 / I.
  3969     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3970
  3971     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  3972           / (1 + I)
  3973     COMPUTE GR     = ANGLEN / ODF
  3974*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  3975*      CP-RATE-DEV-PCT
  3976     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  3977     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3978       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  3979     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  3980     MOVE WK3                    TO CP-CALC-PREMIUM
  3981
  3982     GO TO 99999-RETURN
  3983
  3984     .
  3985 12001-CHECK-DCC-NET.
  3986
  3987     IF (CP-COMPANY-ID EQUAL 'DCC')
  3988        AND (CP-EARN-AS-NET-PAY)
  3989        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  3990             AND 'H' AND 'S')
  3991        CONTINUE
  3992     ELSE
  3993        GO TO 12001-CHECK-DCC-MNET
  3994     END-IF
  3995
  3996     COMPUTE CP-TERM-OR-EXT-DAYS =
  3997           CP-TERM-OR-EXT-DAYS + 30
  3998
  3999     COMPUTE ANGLEN EQUAL WK1 / I.
  4000     COMPUTE ANGLEM EQUAL WK2 / I.
  4001     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4002
  4003     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4004           / (1 + I)
  4005     COMPUTE GR     = ANGLEN / ODF
  4006     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4007     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4008       CP-RATE-DEV-PCT
  4009     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4010*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4011
  4012     COMPUTE WK8 = CP-PREMIUM-RATE *
  4013        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4014     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4015     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4016     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4017       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4018     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4019     MOVE WK3                    TO CP-CALC-PREMIUM
  4020
  4021     GO TO 99999-RETURN
  4022
  4023     .
  4024 12001-CHECK-DCC-MNET.
  4025
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  74
* ELRFND.cbl
  4026     IF (CP-COMPANY-ID EQUAL 'DCC')
  4027        AND (CP-EARN-AS-NET-PAY)
  4028        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4029        CONTINUE
  4030     ELSE
  4031        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4032     END-IF
  4033
  4034*    COMPUTE ANGLEN EQUAL WK1 / I.
  4035*    COMPUTE ANGLEM EQUAL WK2 / I.
  4036*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4037
  4038     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4039     MOVE WK3                    TO CP-CALC-PREMIUM
  4040
  4041     GO TO 99999-RETURN
  4042
  4043     .
  4044 12001-CHECK-DCC-MNET-LF-BAL.
  4045
  4046     IF (CP-COMPANY-ID EQUAL 'DCC')
  4047        AND (CP-EARN-AS-NET-PAY)
  4048        AND (CP-BENEFIT-CD (1:1) = 'N')
  4049        AND (CP-BEN-CATEGORY NOT = 'N')
  4050        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4051        CONTINUE
  4052     ELSE
  4053        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4054     END-IF
  4055
  4056     IF CP-RATE-DEV-PCT NOT = ZEROS
  4057        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4058           CP-PREMIUM-RATE
  4059     END-IF
  4060*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4061     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4062        / (1 + I)
  4063     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4064     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4065     COMPUTE WK2 = (1 + J) ** (M * -1)
  4066     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4067     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4068          ** ((M - 1) * -1))) / J)
  4069     COMPUTE ANGLEM = ((1 - ((1 + J)
  4070          ** (M * -1))) / J) / OD
  4071     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4072        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4073        / ANGLEM-1
  4074     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4075          ** ((N - M) * -1))) / I)
  4076     MOVE +0                     TO WK3
  4077     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4078        (WS-COUNTER > M)
  4079        COMPUTE ANGLEM = (1 - ((1 + J)
  4080          ** ((M - WS-COUNTER) * -1))) / J
  4081        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4082        COMPUTE WK5-CSL = (RA * ANGLEM)
  4083        + (CP-ALTERNATE-BENEFIT * WK2)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  75
* ELRFND.cbl
  4084        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4085     END-PERFORM
  4086     MOVE WK3                    TO CP-CALC-PREMIUM
  4087
  4088     GO TO 99999-RETURN
  4089
  4090     .
  4091 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4092
  4093     IF (CP-COMPANY-ID EQUAL 'DCC')
  4094        AND (CP-EARN-AS-NET-PAY)
  4095        AND (CP-BENEFIT-CD (1:1) = 'S')
  4096        AND (CP-BEN-CATEGORY NOT = 'N')
  4097        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4098        CONTINUE
  4099     ELSE
  4100        GO TO 12001-CHECK-DCC-MNET-LF
  4101     END-IF
  4102
  4103     IF CP-RATE-DEV-PCT NOT = ZEROS
  4104        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4105           CP-PREMIUM-RATE
  4106     END-IF
  4107     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4108     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4109          ** ((M - 1) * -1))) / K)
  4110     COMPUTE ANGLEM = ((1 - ((1 + K)
  4111          ** (M * -1))) / K)
  4112     MOVE CP-MONTHLY-PAYMENT     TO RA
  4113     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4114        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4115        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4116        CP-PREMIUM-RATE / 1000
  4117     MOVE WK3                    TO CP-CALC-PREMIUM
  4118
  4119     GO TO 99999-RETURN
  4120
  4121     .
  4122 12001-CHECK-DCC-MNET-LF.
  4123
  4124     IF (CP-COMPANY-ID EQUAL 'DCC')
  4125        AND (CP-EARN-AS-NET-PAY)
  4126        AND (CP-BENEFIT-CD (1:1) = 'N')
  4127        AND (CP-BEN-CATEGORY NOT = 'N')
  4128        CONTINUE
  4129     ELSE
  4130        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4131     END-IF
  4132
  4133     IF CP-RATE-DEV-PCT NOT = ZEROS
  4134        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4135           CP-PREMIUM-RATE
  4136     END-IF
  4137*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4138     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4139        / (1 + I)
  4140     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4141     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  76
* ELRFND.cbl
  4142     COMPUTE WK2 = (1 + J) ** (M * -1)
  4143     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4144     COMPUTE ANGLEM = ((1 - ((1 + J)
  4145          ** (M * -1))) / J) / OD
  4146     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4147     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4148          ** ((N - M) * -1))) / I)
  4149     MOVE +0                     TO WK3
  4150     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4151        (WS-COUNTER > M)
  4152        COMPUTE ANGLEM = (1 - ((1 + J)
  4153          ** ((M - WS-COUNTER + 1) * -1))) / J
  4154        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4155        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4156        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4157     END-PERFORM
  4158     MOVE WK3                    TO CP-CALC-PREMIUM
  4159
  4160     GO TO 99999-RETURN
  4161
  4162     .
  4163 12001-CHECK-DCC-MNET-SUMLF.
  4164
  4165     IF (CP-COMPANY-ID EQUAL 'DCC')
  4166        AND (CP-EARN-AS-NET-PAY)
  4167        AND (CP-BENEFIT-CD (1:1) = 'S')
  4168        AND (CP-BEN-CATEGORY NOT = 'N')
  4169        CONTINUE
  4170     ELSE
  4171        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4172     END-IF
  4173
  4174     IF CP-RATE-DEV-PCT NOT = ZEROS
  4175        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4176           CP-PREMIUM-RATE
  4177     END-IF
  4178     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4179     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4180        / (1 + K)
  4181     COMPUTE ANGLEN-M = (WK5 / I)
  4182     COMPUTE WK2 = (1 + K) ** (M * -1)
  4183     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4184     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4185     COMPUTE ANGLEM = ((1 - ((1 + K)
  4186          ** (M * -1))) / K) / Y
  4187     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4188     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4189        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4190        - 1)) / K) * RA
  4191     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4192        + (CP-DAYS-TO-1ST-PMT - +30)
  4193        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4194        +0 / 1000 * 12 / 12)
  4195     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4196        * (12 / 12)
  4197     MOVE WK3                    TO CP-CALC-PREMIUM
  4198
  4199     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  77
* ELRFND.cbl
  4200
  4201     .
  4202 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4203
  4204     IF (CP-COMPANY-ID EQUAL 'DCC')
  4205        AND (CP-EARN-AS-NET-PAY)
  4206        AND (CP-BENEFIT-CD (1:1) = 'N')
  4207        AND (CP-BEN-CATEGORY = 'N')
  4208        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4209        CONTINUE
  4210     ELSE
  4211        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4212     END-IF
  4213
  4214*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4215     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4216        / (1 + I)
  4217     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4218     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4219     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4220     COMPUTE WK2 = (1 + J) ** (M * -1)
  4221     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4222     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4223          ** ((M - 1) * -1))) / J)
  4224     COMPUTE ANGLEM = ((1 - ((1 + J)
  4225          ** (M * -1))) / J) / OD
  4226     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4227        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4228        / ANGLEM-1
  4229     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4230          ** ((N - M) * -1))) / I)
  4231     MOVE +0                     TO WK3
  4232     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4233        (WS-COUNTER > M)
  4234        COMPUTE ANGLEM = (1 - ((1 + J)
  4235          ** ((M - WS-COUNTER) * -1))) / J
  4236        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4237        COMPUTE WK5-CSL = (RA * ANGLEM)
  4238        + (CP-ALTERNATE-BENEFIT * WK2)
  4239        COMPUTE WK3 = WK3 +
  4240         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4241        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4242          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4243          (CP-DCC-AH-RATE / 1000)
  4244     END-PERFORM
  4245     MOVE WK3                    TO CP-CALC-PREMIUM
  4246
  4247     GO TO 99999-RETURN
  4248
  4249     .
  4250 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4251
  4252     IF (CP-COMPANY-ID EQUAL 'DCC')
  4253        AND (CP-EARN-AS-NET-PAY)
  4254        AND (CP-BENEFIT-CD (1:1) = 'S')
  4255        AND (CP-BEN-CATEGORY = 'N')
  4256        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4257        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  78
* ELRFND.cbl
  4258     ELSE
  4259        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4260     END-IF
  4261
  4262     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4263     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4264          ** ((M - 1) * -1))) / K)
  4265     COMPUTE ANGLEM = ((1 - ((1 + K)
  4266          ** (M * -1))) / K)
  4267     MOVE CP-MONTHLY-PAYMENT     TO RA
  4268     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4269        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4270        * CP-DCC-AH-RATE / 1000))
  4271        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4272        CP-DCC-LF-RATE / 1000
  4273     MOVE WK3                    TO CP-LF-PREM
  4274     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4275        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4276        * CP-DCC-AH-RATE / 1000
  4277     COMPUTE WK3 = WK3 + WK5-CSL
  4278     MOVE WK3                    TO CP-CALC-PREMIUM
  4279
  4280     GO TO 99999-RETURN
  4281      .
  4282 12001-CHECK-DCC-MNET-TOT-N.
  4283
  4284     IF (CP-COMPANY-ID EQUAL 'DCC')
  4285        AND (CP-EARN-AS-NET-PAY)
  4286        AND (CP-BENEFIT-CD (1:1) = 'N')
  4287        AND (CP-BEN-CATEGORY = 'N')
  4288        CONTINUE
  4289     ELSE
  4290        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4291     END-IF
  4292
  4293*    I = APR/1200
  4294*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4295*    RA = PAYMENT AMOUNT
  4296*    WK5-CSL = THE BALANCE (PAY OFF )
  4297*    WK3 = THE ACCUMULATED PREMIUM
  4298*    WK2 = (1 + I) ^ (m * -1)
  4299*    OD  = GAMMA
  4300*
  4301*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4302     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4303        / (1 + I)
  4304     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4305     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4306        (CP-DCC-AH-RATE / +1000)
  4307     COMPUTE WK2 = (1 + J) ** (M * -1)
  4308     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4309     COMPUTE ANGLEM = ((1 - ((1 + J)
  4310          ** (M * -1))) / J) / OD
  4311     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4312     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4313          ** ((N - M) * -1))) / I)
  4314     MOVE +0                     TO WK3
  4315     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  79
* ELRFND.cbl
  4316        (WS-COUNTER > M)
  4317        COMPUTE ANGLEM = (1 - ((1 + J)
  4318          ** ((M - WS-COUNTER + 1) * -1))) / J
  4319        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4320        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4321        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4322           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4323     END-PERFORM
  4324     MOVE WK3                    TO CP-CALC-PREMIUM
  4325
  4326     GO TO 99999-RETURN
  4327
  4328     .
  4329 12001-CHECK-DCC-MNET-TOT-S.
  4330
  4331     IF (CP-COMPANY-ID EQUAL 'DCC')
  4332        AND (CP-EARN-AS-NET-PAY)
  4333        AND (CP-BENEFIT-CD (1:1) = 'S')
  4334        AND (CP-BEN-CATEGORY = 'N')
  4335        CONTINUE
  4336     ELSE
  4337        GO TO 12001-CONTINUE-NET
  4338     END-IF
  4339
  4340*    I = APR/1200
  4341*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4342*    RA = PAYMENT AMOUNT
  4343*    WK5-CSL = THE BALANCE (PAY OFF )
  4344*    WK3 = THE ACCUMULATED PREMIUM
  4345*    WK2 = (1 + I) ^ (m * -1)
  4346*    OD  = GAMMA
  4347*
  4348     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4349     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4350        / (1 + J)
  4351     COMPUTE ANGLEM = ((1 - ((1 + J)
  4352          ** (M * -1))) / J) / OD
  4353     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4354          ** ((N - M) * -1))) / I)
  4355          * (1 + J) ** (-1 * M)
  4356     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4357     MOVE CP-MONTHLY-PAYMENT     TO RA
  4358     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4359        / +30)
  4360     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4361        ** (WK1) - 1)) / J) * RA
  4362     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4363        + (CP-DAYS-TO-1ST-PMT - +30)
  4364        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4365        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4366     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4367        (12 / 12)
  4368     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4369        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4370        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4371     COMPUTE WK3 = WK3 + WK5-CSL
  4372     MOVE WK3                    TO CP-CALC-PREMIUM
  4373     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  80
* ELRFND.cbl
  4374     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4375        / (1 + K)
  4376     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4377          ** ((N - M) * -1))) / I)
  4378     COMPUTE WK2 = (1 + K) ** (M * -1)
  4379     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4380     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4381     COMPUTE ANGLEM = ((1 - ((1 + K)
  4382          ** (M * -1))) / K) / Y
  4383*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4384     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4385        ((1 + K) ** (M + 1 / Y
  4386        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4387        - 1)) / K) * RA
  4388     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4389        + (CP-DAYS-TO-1ST-PMT - +30)
  4390        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4391        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4392     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4393        * (12 / 12)
  4394     MOVE WK3                    TO CP-LF-PREM
  4395
  4396     GO TO 99999-RETURN
  4397
  4398     .
  4399 12001-CONTINUE-NET.
  4400
  4401     IF NET-STD
  4402        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  4403*          OR 'DCC'
  4404         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4405         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4406         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4407         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4408                               * ((1 + N) / (1 + M))
  4409        ELSE
  4410         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4411         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4412         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4413         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  4414
  4415     IF NET-SMP
  4416         COMPUTE N2 = N * N
  4417         COMPUTE N3 = N2 * N
  4418         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  4419         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  4420         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  4421         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  4422         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  4423
  4424     IF NPO-PRUDENTIAL
  4425       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  4426           VARYING WS-COUNTER FROM 1 BY 1
  4427               UNTIL WS-COUNTER = N
  4428       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  4429       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  4430
  4431     MOVE WK3 TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  81
* ELRFND.cbl
  4432
  4433     GO TO 99999-RETURN.
  4434
  4435 12100-PRU-CALC.
  4436     IF WS-COUNTER = 1
  4437         COMPUTE PWK = (I + 1)
  4438     ELSE
  4439         COMPUTE PWK = PWK * (I + 1).
  4440
  4441 12199-EXIT.
  4442      EXIT.
  4443
  4444 99000-ERROR.
  4445     MOVE +9999.999999999 TO N-P-FACTOR.
  4446     MOVE '4'             TO CP-RETURN-CODE.
  4447
  4448     GO TO 99999-EXIT.
  4449
  4450 99999-RETURN.
  4451     MOVE FACTOR          TO N-P-FACTOR.
  4452
  4453 99999-EXIT.
  4454      EXIT.
  4455
  4456 9999-DFHBACK SECTION.
  4457     MOVE '9%                    "   ' TO DFHEIV0
  4458     MOVE 'ELRFND' TO DFHEIV1
  4459     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4460     GOBACK.
  4461 9999-DFHEXIT.
  4462     IF DFHEIGDJ EQUAL 0001
  4463         NEXT SENTENCE.
  4464     MOVE '9%                    "   ' TO DFHEIV0
  4465     MOVE 'ELRFND' TO DFHEIV1
  4466     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4467     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        2456     Code:       35974
