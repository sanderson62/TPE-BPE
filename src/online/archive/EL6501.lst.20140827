* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   3
* EL6501.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    65 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    66                                   USAGE POINTER.
    67 77  FILLER  PIC X(32)  VALUE '********************************'.
    68 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    69 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    70 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    71     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    72 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    73     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    74 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    75 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    76 01  WS-DEGUG-AREA.
    77     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    78     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    79     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    80     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    81     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    82     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    83     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    84     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    85 01  S1                          PIC S999   VALUE +0    COMP.
    86 01  WS-WORK-FIELD.
    87     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    88 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    89 01  WS-DATE-AREA.
    90     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    91     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    92
    93***DMD CUSTOM CODE *****START
    94     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    95     12  WS-DMD-AGENT            PIC X(10).
    96     12  WS-YYYYMMDD             PIC X(8).
    97     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
    98                                 PIC 9(8).
    99***DMD CUSTOM CODE *****END
   100
   101 01  WS-ACCOUNT-NUM-AREA.
   102     12  WS-ACCOUNT-FILLER       PIC X(06).
   103     12  WS-ACCT-BRANCH-CD       PIC X(04).
   104
   105 01  WS-NAME-AREA.
   106     12  WS-NAME-1-4             PIC X(04).
   107     12  WS-NAME-FILLER          PIC X(26).
   108
   109 01  STANDARD-AREAS.
   110     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   111         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   112     12  WS-RESPONSE             PIC S9(8)   COMP.
   113         88  RESP-NORMAL                  VALUE +00.
   114         88  RESP-NOTFND                  VALUE +13.
   115         88  RESP-DUPREC                  VALUE +14.
   116         88  RESP-DUPKEY                  VALUE +15.
   117         88  RESP-NOTOPEN                 VALUE +19.
   118         88  RESP-ENDFILE                 VALUE +20.
   119
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   4
* EL6501.cbl
   120     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   121     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   122     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   123     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   124     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   125     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   126     12  PGM-NAME                PIC X(8).
   127     12  TIME-IN                 PIC S9(7).
   128     12  TIME-OUT-R REDEFINES TIME-IN.
   129         16  FILLER              PIC X.
   130         16  TIME-OUT            PIC 99V99.
   131         16  FILLER              PIC XX.
   132     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   133     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   134     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   135     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   136     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   137     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   138     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   139     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   140     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   141     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   142     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   143     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   144     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   145     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   146     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   147     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   148     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   149     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   150     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   151     12  FILE-ID                 PIC X(8).
   152     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   153     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   154     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   155     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   156     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   157     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   158     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   159     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   160     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   161     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   162     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   163     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   164     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   165     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   166     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   167     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   168     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   169     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   170     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   171     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   172     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   173*                                copy ERCGXRF.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   5
* EL6501.cbl
   178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   179*                            VMOD=2.002                          *
   180*                                                                *
   181*   ONLINE CREDIT SYSTEM                                         *
   182*                                                                *
   183*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   184*                                                                *
   185*   FILE TYPE = VSAM,KSDS                                        *
   186*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   187*                                                                *
   188*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   189*       ALTERNATE PATH = NONE                                    *
   190*                                                                *
   191*   LOG = NO                                                     *
   192*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   193*                                                                *
   194******************************************************************
   195
   196 01  AGENT-CROSS-REFERENCE.
   197     12  GX-RECORD-ID                PIC XX.
   198         88  VALID-GX-ID             VALUE 'GX'.
   199
   200     12  GX-CONTROL-PRIMARY.
   201         16  GX-COMPANY-CD           PIC X.
   202         16  GX-CARRIER              PIC X.
   203         16  GX-GROUPING             PIC X(6).
   204         16  GX-AGENT-NO             PIC X(10).
   205
   206     12  GX-MAINT-INFORMATION.
   207         16  GX-LAST-MAINT-DT        PIC XX.
   208         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   209         16  GX-LAST-MAINT-USER      PIC X(4).
   210         16  FILLER                  PIC X(9).
   211
   212     12  FILLER                      PIC X(37).
   213
   214     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   215
   216     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   217                            DEPENDING ON GX-AGENT-POINTER-CNT.
   218         16  GX-AM-CARRIER           PIC X.
   219         16  GX-AM-GROUPING          PIC X(6).
   220         16  GX-AM-STATE             PIC XX.
   221         16  GX-AM-ACCOUNT           PIC X(10).
   222         16  GX-AM-EXPIRATION-DT     PIC XX.
   223         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   224         16  GX-LAST-BILL-DT         PIC XX.
   225         16  GX-AM-EFF-DT            PIC XX.
   226         16  FILLER                  PIC X(4).
   227
   228******************************************************************
   229 01  ERPDEF-KEY-SAVE             PIC X(18).
   230 01  ERPDEF-KEY.
   231     12  ERPDEF-COMPANY-CD       PIC X.
   232     12  ERPDEF-STATE            PIC XX.
   233     12  ERPDEF-PROD-CD          PIC XXX.
   234     12  F                       PIC X(7).
   235     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   6
* EL6501.cbl
   236     12  ERPDEF-BEN-CODE         PIC XX.
   237     12  ERPDEF-EXP-DT           PIC XX.
   238 01  WORK-AREAS-AND-SWITCHES.
   239     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   240     12  filler redefines ws-comp-cd-dis.
   241         16  filler              pic x.
   242         16  ws-comp-cd          pic x.
   243     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   244     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   245     12  WS-ST-COMMISSION-CAPS.
   246         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   247         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   248         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   249         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   250     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   251     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   252         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   253
   254     12  COMMISSION-ACCUMS.
   255         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   256         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   257         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   258         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   259
   260     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   261     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   262     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   263     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   264     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   265     12  CURRENT-SAVE            PIC 9(8).
   266     12  BIN-CURRENT-SAVE        PIC XX.
   267     12  CYMD-CURRENT-SAVE       PIC 9(8).
   268     12  SUB                     PIC 99.
   269     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   270     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   271     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   272         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   273
   274     12  WS-EDIT-BEN-CODE        PIC XX.
   275         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   276                                          '90' THRU '99'.
   277
   278     12  WS-KEY-SAVE.
   279           18  WS-ACCT-CCGSA-KEY.
   280             20  WS-ACCT-CO             PIC X.
   281             20  WS-ACCT-CARRIER        PIC X.
   282             20  WS-ACCT-GROUPING       PIC X(6).
   283             20  WS-ACCT-STATE          PIC XX.
   284             20  WS-ACCT-ACCOUNT        PIC X(10).
   285           18  WS-ACCT-EXP-DT           PIC XX.
   286           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   287
   288     12  DEEDIT-FIELD                   PIC X(15).
   289     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   290     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   291     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   292     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   293     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   7
* EL6501.cbl
   294
   295     12  ELCNTL-KEY.
   296         16  CNTL-COMP-ID        PIC XXX.
   297         16  CNTL-REC-TYPE       PIC X.
   298         16  CNTL-ACCESS.
   299             20  FILLER          PIC X(4).
   300         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   301             20  FILLER          PIC XX.
   302             20  CNTL-BUS-TYPE   PIC XX.
   303         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   304             20  FILLER          PIC XX.
   305             20  CNTL-BEN-TYPE   PIC XX.
   306         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   307
   308     12  REIN-KEY.
   309         16  REIN-COMP-CD        PIC X.
   310         16  REIN-CODE           PIC X.
   311         16  REIN-TABLE          PIC X(3).
   312         16  FILLER              PIC X(3).
   313
   314     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   315     12  COMM-KEY.
   316         16  COMM-COMP-CD        PIC X.
   317         16  COMM-TABLE          PIC XXX.
   318         16  COMM-LF-AH          PIC X.
   319         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   320
   321     12  RQST-KEY.
   322         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   323         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   324
   325     12  RQST3-KEY.
   326         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   327         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   328         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   329         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   330         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   331         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   332         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   333
   334     12  SAVE-RQST3-KEY.
   335         16  FILLER              PIC X     VALUE SPACES.
   336         16  FILLER              PIC X     VALUE SPACES.
   337         16  FILLER              PIC X(6)  VALUE SPACES.
   338         16  FILLER              PIC X(10) VALUE SPACES.
   339         16  FILLER              PIC X(10) VALUE SPACES.
   340         16  FILLER              PIC X(12) VALUE SPACES.
   341         16  FILLER              PIC X(6)  VALUE SPACES.
   342
   343     12  COMP-KEY.
   344         16  COMP-COMPANY-CD     PIC X.
   345         16  COMP-CARRIER        PIC X.
   346         16  COMP-GROUPING       PIC X(6).
   347         16  COMP-RESP-NO        PIC X(10).
   348         16  COMP-ACCOUNT        PIC X(10).
   349         16  COMP-TYPE           PIC X.
   350
   351     12  WS-AXRF-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   8
* EL6501.cbl
   352         16  WS-AXRF-COMPANY-CD  PIC X.
   353         16  WS-AXRF-CARRIER     PIC X.
   354         16  WS-AXRF-GROUPING    PIC X(6).
   355         16  WS-AXRF-AGENT-NO    PIC X(10).
   356
   357     12  GX-AM-CONTROL-PRIMARY.
   358         16  GX-AM-COMPANY-CD    PIC X.
   359         16  GX-REST-OF-KEY      PIC X(20).
   360
   361     12  QID.
   362         16  QID-TERM            PIC X(4).
   363         16  FILLER              PIC X(4)    VALUE '6501'.
   364
   365     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   366         88  BROWSE-STARTED         VALUE 'Y'.
   367     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   368         88  FIRST-TIME             VALUE 'Y'.
   369
   370     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   371     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   372     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   373     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   374     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   375     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   376     12  GETMAIN-SW              PIC X       VALUE SPACES.
   377     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   378         88  GETMAIN-ACQUIRED                VALUE 'X'.
   379
   380     12  ER-0000                 PIC X(4)    VALUE '0000'.
   381     12  ER-0002                 PIC X(4)    VALUE '0002'.
   382     12  ER-0004                 PIC X(4)    VALUE '0004'.
   383     12  ER-0008                 PIC X(4)    VALUE '0008'.
   384     12  ER-0023                 PIC X(4)    VALUE '0023'.
   385     12  ER-0029                 PIC X(4)    VALUE '0029'.
   386     12  ER-0033                 PIC X(4)    VALUE '0033'.
   387     12  ER-0144                 PIC X(4)    VALUE '0144'.
   388     12  ER-0070                 PIC X(4)    VALUE '0070'.
   389     12  ER-0250                 PIC X(4)    VALUE '0250'.
   390     12  ER-0348                 PIC X(4)    VALUE '0348'.
   391     12  ER-0454                 PIC X(4)    VALUE '0454'.
   392     12  ER-0625                 PIC X(4)    VALUE '0625'.
   393     12  ER-0759                 PIC X(4)    VALUE '0759'.
   394     12  ER-0788                 PIC X(4)    VALUE '0788'.
   395     12  ER-0852                 PIC X(4)    VALUE '0852'.
   396     12  ER-0899                 PIC X(4)    VALUE '0899'.
   397     12  ER-1778                 PIC X(4)    VALUE '1778'.
   398     12  ER-1817                 PIC X(4)    VALUE '1817'.
   399     12  ER-1883                 PIC X(4)    VALUE '1883'.
   400     12  ER-1884                 PIC X(4)    VALUE '1884'.
   401     12  ER-1885                 PIC X(4)    VALUE '1885'.
   402     12  ER-1886                 PIC X(4)    VALUE '1886'.
   403     12  ER-1887                 PIC X(4)    VALUE '1887'.
   404     12  ER-2045                 PIC X(4)    VALUE '2045'.
   405     12  ER-2071                 PIC X(4)    VALUE '2071'.
   406     12  ER-2131                 PIC X(4)    VALUE '2131'.
   407*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   408     12  ER-2151                 PIC X(4)    VALUE '2151'.
   409     12  ER-2152                 PIC X(4)    VALUE '2152'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page   9
* EL6501.cbl
   410     12  ER-2153                 PIC X(4)    VALUE '2153'.
   411     12  ER-2154                 PIC X(4)    VALUE '2154'.
   412     12  ER-2155                 PIC X(4)    VALUE '2155'.
   413     12  ER-2156                 PIC X(4)    VALUE '2156'.
   414     12  ER-2157                 PIC X(4)    VALUE '2157'.
   415     12  ER-2158                 PIC X(4)    VALUE '2158'.
   416     12  ER-2159                 PIC X(4)    VALUE '2159'.
   417     12  ER-2160                 PIC X(4)    VALUE '2160'.
   418     12  ER-2165                 PIC X(4)    VALUE '2165'.
   419     12  ER-2168                 PIC X(4)    VALUE '2168'.
   420     12  ER-2169                 PIC X(4)    VALUE '2169'.
   421     12  ER-2170                 PIC X(4)    VALUE '2170'.
   422     12  ER-2172                 PIC X(4)    VALUE '2172'.
   423     12  ER-2173                 PIC X(4)    VALUE '2173'.
   424     12  ER-2174                 PIC X(4)    VALUE '2174'.
   425     12  ER-2175                 PIC X(4)    VALUE '2175'.
   426     12  ER-2176                 PIC X(4)    VALUE '2176'.
   427     12  ER-2177                 PIC X(4)    VALUE '2177'.
   428     12  ER-2178                 PIC X(4)    VALUE '2178'.
   429     12  ER-2179                 PIC X(4)    VALUE '2179'.
   430     12  ER-2180                 PIC X(4)    VALUE '2180'.
   431     12  ER-2181                 PIC X(4)    VALUE '2181'.
   432     12  ER-2182                 PIC X(4)    VALUE '2182'.
   433     12  ER-2183                 PIC X(4)    VALUE '2183'.
   434     12  ER-2189                 PIC X(4)    VALUE '2189'.
   435     12  ER-2572                 PIC X(4)    VALUE '2572'.
   436     12  ER-2615                 PIC X(4)    VALUE '2615'.
   437     12  ER-2949                 PIC X(4)    VALUE '2949'.
   438     12  ER-2970                 PIC X(4)    VALUE '2970'.
   439     12  ER-4009                 PIC X(4)    VALUE '4009'.
   440     12  ER-4010                 PIC X(4)    VALUE '4010'.
   441     12  ER-4011                 PIC X(4)    VALUE '4011'.
   442     12  ER-4012                 PIC X(4)    VALUE '4012'.
   443     12  ER-7717                 PIC X(4)    VALUE '7717'.
   444     12  er-8156                 pic x(4)    value '8156'.
   445     12  ER-9999                 PIC X(4)    VALUE '9999'.
   446     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   447
   448     12  WSS-LINE-LIAB-LIMITS.
   449         16  WSS-LF-LIMITS.
   450             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   451             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   452             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   453                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   454                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   455                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   456         16  WSS-AH-LIMITS.
   457             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   458             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   459             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   460                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   461                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   462                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   463                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   464
   465     12  WSS-COMM-STRUCTURE.
   466         16  WSS-DEFN-1.
   467             20  WSS-AGT-COMMS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  10
* EL6501.cbl
   468                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   469                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   470                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   471                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   472                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   473                 24  FILLER      PIC X(6)     VALUE SPACES.
   474
   475     12  WS-PHONE.
   476         16  WS-PH1              PIC XXX.
   477         16  WS-PH2              PIC XXX.
   478         16  WS-PH3              PIC XXXX.
   479     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   480
   481     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   482     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   483     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   484     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   485     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   486     12  WS-BUS-TYPE             PIC 99.
   487     12  WS-BUS-ENTRY            PIC 99.
   488     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   489     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   490     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   491     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   492     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   493     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   494     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   495         88  COMMISSION-ERROR    VALUE 1.
   496     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   497     12  AGENT-FIND              PIC X        VALUE SPACES.
   498         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   499         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   500         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   501
   502     12  WS-ZIP-CODE.
   503         16  WS-ZIP-1            PIC X.
   504             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   505         16  WS-ZIP-2-3          PIC XX.
   506         16  WS-ZIP-4            PIC X.
   507         16  WS-ZIP-5            PIC X.
   508         16  WS-ZIP-6            PIC X.
   509         16  FILLER              PIC X(4).
   510     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   511         16  WS-ZIP-AM-1-CODE    PIC X(5).
   512         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   513         16  FILLER              PIC X.
   514     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   515         16  WS-ZIP-AM-2-CODE    PIC X(5).
   516         16  WS-ZIP-AM-2-DASH    PIC X.
   517         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   518     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   519         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   520         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   521         16  FILLER              PIC X(4).
   522     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   523         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   524         16  FILLER              PIC X.
   525         16  WS-ZIP-CAN-2-POST2  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  11
* EL6501.cbl
   526         16  FILLER              PIC XXX.
   527     12  WS-SOC-SEC-WORK.
   528         16  WS-SS-TYPE          PIC X.
   529         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  12
* EL6501.cbl
   531*    COPY ELCSCTM.
   532******************************************************************
   533*                                                                *
   534*                                                                *
   535*                            ELCSCTM                             *
   536*                            VMOD=2.001                          *
   537*                                                                *
   538*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   539*                                                                *
   540******************************************************************
   541 01  SECURITY-MESSAGE.
   542     12  FILLER                          PIC X(30)
   543            VALUE '** LOGIC SECURITY VIOLATION -'.
   544     12  SM-READ                         PIC X(6).
   545     12  FILLER                          PIC X(5)
   546            VALUE ' PGM='.
   547     12  SM-PGM                          PIC X(6).
   548     12  FILLER                          PIC X(5)
   549            VALUE ' OPR='.
   550     12  SM-PROCESSOR-ID                 PIC X(4).
   551     12  FILLER                          PIC X(6)
   552            VALUE ' TERM='.
   553     12  SM-TERMID                       PIC X(4).
   554     12  FILLER                          PIC XX   VALUE SPACE.
   555     12  SM-JUL-DATE                     PIC 9(5).
   556     12  FILLER                          PIC X    VALUE SPACE.
   557     12  SM-TIME                         PIC 99.99.
   558
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  13
* EL6501.cbl
   560*    COPY ELCSCRTY.
   561******************************************************************
   562*                                                                *
   563*                                                                *
   564*                            ELCSCRTY                            *
   565*                            VMOD=2.001                          *
   566*                                                                *
   567*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   568*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   569*        SAVED IN PI-SECURITY-ADDRESS.                           *
   570*                                                                *
   571******************************************************************
   572 01  SECURITY-CONTROL.
   573     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   574     12  FILLER                       PIC XX    VALUE 'SC'.
   575     12  SC-CREDIT-CODES.
   576         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   577             20  SC-CREDIT-DISPLAY    PIC X.
   578             20  SC-CREDIT-UPDATE     PIC X.
   579     12  SC-CLAIMS-CODES.
   580         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   581             20  SC-CLAIMS-DISPLAY    PIC X.
   582             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  14
* EL6501.cbl
   584*    COPY ELCLOGOF.
   585******************************************************************
   586*                                                                *
   587*                                                                *
   588*                            ELCLOGOF.                           *
   589*                            VMOD=2.001                          *
   590*                                                                *
   591*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   592*                                                                *
   593******************************************************************
   594 01  CLASIC-LOGOFF.
   595     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   596     12  LOGOFF-TEXT.
   597         16  FILLER          PIC X(5)    VALUE SPACES.
   598         16  LOGOFF-MSG.
   599             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   600             20  FILLER      PIC X       VALUE SPACES.
   601             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   602         16  FILLER          PIC X(80)
   603           VALUE '* YOU ARE NOW LOGGED OFF'.
   604         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   605         16  FILLER          PIC X       VALUE QUOTE.
   606         16  LOGOFF-SYS-MSG  PIC X(17)
   607           VALUE 'S CLAS-IC SYSTEM '.
   608     12  TEXT-MESSAGES.
   609         16  UNACCESS-MSG    PIC X(29)
   610             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   611         16  PGMIDERR-MSG    PIC X(17)
   612             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  15
* EL6501.cbl
   614*    COPY ELCDATE.
   615******************************************************************
   616*                                                                *
   617*                                                                *
   618*                            ELCDATE.                            *
   619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   620*                            VMOD=2.003
   621*                                                                *
   622*                                                                *
   623*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   624*                 LENGTH = 200                                   *
   625******************************************************************
   626
   627 01  DATE-CONVERSION-DATA.
   628     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   629     12  DC-OPTION-CODE                PIC X.
   630         88  BIN-TO-GREG                VALUE ' '.
   631         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   632         88  EDIT-GREG-TO-BIN           VALUE '2'.
   633         88  YMD-GREG-TO-BIN            VALUE '3'.
   634         88  MDY-GREG-TO-BIN            VALUE '4'.
   635         88  JULIAN-TO-BIN              VALUE '5'.
   636         88  BIN-PLUS-ELAPSED           VALUE '6'.
   637         88  FIND-CENTURY               VALUE '7'.
   638         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   639         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   640         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   641         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   642         88  JULIAN-TO-BIN-3            VALUE 'C'.
   643         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   644         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   645         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   646         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   647         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   648         88  CHECK-LEAP-YEAR            VALUE 'H'.
   649         88  BIN-3-TO-GREG              VALUE 'I'.
   650         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   651         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   652         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   653         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   654         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   655         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   656         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   657         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   658         88  THREE-CHARACTER-BIN
   659                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   660         88  GREGORIAN-TO-BIN
   661                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   662         88  BIN-TO-GREGORIAN
   663                  VALUES ' ' '1' 'I' '8' 'G'.
   664         88  JULIAN-TO-BINARY
   665                  VALUES '5' 'C' 'E' 'F'.
   666     12  DC-ERROR-CODE                 PIC X.
   667         88  NO-CONVERSION-ERROR        VALUE ' '.
   668         88  DATE-CONVERSION-ERROR
   669                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   670         88  DATE-IS-ZERO               VALUE '1'.
   671         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  16
* EL6501.cbl
   672         88  DATE-IS-INVALID            VALUE '3'.
   673         88  DATE1-GREATER-DATE2        VALUE '4'.
   674         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   675         88  DATE-INVALID-OPTION        VALUE '9'.
   676         88  INVALID-CENTURY            VALUE 'A'.
   677         88  ONLY-CENTURY               VALUE 'B'.
   678         88  ONLY-LEAP-YEAR             VALUE 'C'.
   679         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   680     12  DC-END-OF-MONTH               PIC X.
   681         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   682     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   683         88  USE-NORMAL-PROCESS         VALUE ' '.
   684         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   685         88  ADJUST-UP-100-YRS          VALUE '2'.
   686     12  FILLER                        PIC X.
   687     12  DC-CONVERSION-DATES.
   688         16  DC-BIN-DATE-1             PIC XX.
   689         16  DC-BIN-DATE-2             PIC XX.
   690         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   691         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   692                       DC-GREG-DATE-1-EDIT.
   693             20  DC-EDIT1-MONTH        PIC 99.
   694             20  SLASH1-1              PIC X.
   695             20  DC-EDIT1-DAY          PIC 99.
   696             20  SLASH1-2              PIC X.
   697             20  DC-EDIT1-YEAR         PIC 99.
   698         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   699         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   700                     DC-GREG-DATE-2-EDIT.
   701             20  DC-EDIT2-MONTH        PIC 99.
   702             20  SLASH2-1              PIC X.
   703             20  DC-EDIT2-DAY          PIC 99.
   704             20  SLASH2-2              PIC X.
   705             20  DC-EDIT2-YEAR         PIC 99.
   706         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   707         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   708                     DC-GREG-DATE-1-YMD.
   709             20  DC-YMD-YEAR           PIC 99.
   710             20  DC-YMD-MONTH          PIC 99.
   711             20  DC-YMD-DAY            PIC 99.
   712         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   713         16  DC-GREG-DATE-1-MDY-R REDEFINES
   714                      DC-GREG-DATE-1-MDY.
   715             20  DC-MDY-MONTH          PIC 99.
   716             20  DC-MDY-DAY            PIC 99.
   717             20  DC-MDY-YEAR           PIC 99.
   718         16  DC-GREG-DATE-1-ALPHA.
   719             20  DC-ALPHA-MONTH        PIC X(10).
   720             20  DC-ALPHA-DAY          PIC 99.
   721             20  FILLER                PIC XX.
   722             20  DC-ALPHA-CENTURY.
   723                 24 DC-ALPHA-CEN-N     PIC 99.
   724             20  DC-ALPHA-YEAR         PIC 99.
   725         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   726         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   727         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   728         16  DC-JULIAN-DATE            PIC 9(05).
   729         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  17
* EL6501.cbl
   730                                       PIC 9(05).
   731         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   732             20  DC-JULIAN-YEAR        PIC 99.
   733             20  DC-JULIAN-DAYS        PIC 999.
   734         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   735         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   736         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   737     12  DATE-CONVERSION-VARIBLES.
   738         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   739         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   740             20  FILLER                PIC 9(3).
   741             20  HOLD-CEN-1-CCYY.
   742                 24  HOLD-CEN-1-CC     PIC 99.
   743                 24  HOLD-CEN-1-YY     PIC 99.
   744             20  HOLD-CEN-1-MO         PIC 99.
   745             20  HOLD-CEN-1-DA         PIC 99.
   746         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   747             20  HOLD-CEN-1-R-MO       PIC 99.
   748             20  HOLD-CEN-1-R-DA       PIC 99.
   749             20  HOLD-CEN-1-R-CCYY.
   750                 24  HOLD-CEN-1-R-CC   PIC 99.
   751                 24  HOLD-CEN-1-R-YY   PIC 99.
   752             20  FILLER                PIC 9(3).
   753         16  HOLD-CENTURY-1-X.
   754             20  FILLER                PIC X(3)  VALUE SPACES.
   755             20  HOLD-CEN-1-X-CCYY.
   756                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   757                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   759             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   760         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   761             20  HOLD-CEN-1-R-X-MO     PIC XX.
   762             20  HOLD-CEN-1-R-X-DA     PIC XX.
   763             20  HOLD-CEN-1-R-X-CCYY.
   764                 24  HOLD-CEN-1-R-X-CC PIC XX.
   765                 24  HOLD-CEN-1-R-X-YY PIC XX.
   766             20  FILLER                PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   768         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   769         16  DC-JULIAN-DATE-1          PIC 9(07).
   770         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   771             20  DC-JULIAN-1-CCYY.
   772                 24  DC-JULIAN-1-CC    PIC 99.
   773                 24  DC-JULIAN-1-YR    PIC 99.
   774             20  DC-JULIAN-DA-1        PIC 999.
   775         16  DC-JULIAN-DATE-2          PIC 9(07).
   776         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   777             20  DC-JULIAN-2-CCYY.
   778                 24  DC-JULIAN-2-CC    PIC 99.
   779                 24  DC-JULIAN-2-YR    PIC 99.
   780             20  DC-JULIAN-DA-2        PIC 999.
   781         16  DC-GREG-DATE-A-EDIT.
   782             20  DC-EDITA-MONTH        PIC 99.
   783             20  SLASHA-1              PIC X VALUE '/'.
   784             20  DC-EDITA-DAY          PIC 99.
   785             20  SLASHA-2              PIC X VALUE '/'.
   786             20  DC-EDITA-CCYY.
   787                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  18
* EL6501.cbl
   788                 24  DC-EDITA-YEAR     PIC 99.
   789         16  DC-GREG-DATE-B-EDIT.
   790             20  DC-EDITB-MONTH        PIC 99.
   791             20  SLASHB-1              PIC X VALUE '/'.
   792             20  DC-EDITB-DAY          PIC 99.
   793             20  SLASHB-2              PIC X VALUE '/'.
   794             20  DC-EDITB-CCYY.
   795                 24  DC-EDITB-CENT     PIC 99.
   796                 24  DC-EDITB-YEAR     PIC 99.
   797         16  DC-GREG-DATE-CYMD         PIC 9(08).
   798         16  DC-GREG-DATE-CYMD-R REDEFINES
   799                              DC-GREG-DATE-CYMD.
   800             20  DC-CYMD-CEN           PIC 99.
   801             20  DC-CYMD-YEAR          PIC 99.
   802             20  DC-CYMD-MONTH         PIC 99.
   803             20  DC-CYMD-DAY           PIC 99.
   804         16  DC-GREG-DATE-MDCY         PIC 9(08).
   805         16  DC-GREG-DATE-MDCY-R REDEFINES
   806                              DC-GREG-DATE-MDCY.
   807             20  DC-MDCY-MONTH         PIC 99.
   808             20  DC-MDCY-DAY           PIC 99.
   809             20  DC-MDCY-CEN           PIC 99.
   810             20  DC-MDCY-YEAR          PIC 99.
   811    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   812        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   813    12  DC-EL310-DATE                  PIC X(21).
   814    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  19
* EL6501.cbl
   816*    COPY ELCATTR.
   817******************************************************************
   818*                                                                *
   819*                            ELCATTR.                            *
   820*                            VMOD=2.001                          *
   821*                                                                *
   822*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   823*                                                                *
   824*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   825*                                                                *
   826*                   POS 1   P=PROTECTED                          *
   827*                           U=UNPROTECTED                        *
   828*                           S=ASKIP                              *
   829*                   POS 2   A=ALPHA/NUMERIC                      *
   830*                           N=NUMERIC                            *
   831*                   POS 3   N=NORMAL                             *
   832*                           B=BRIGHT                             *
   833*                           D=DARK                               *
   834*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   835*                           OF=MODIFIED DATA TAG OFF             *
   836*                                                                *
   837*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   838******************************************************************
   839 01  ATTRIBUTE-LIST.
   840     12  AL-PABOF            PIC X       VALUE 'Y'.
   841     12  AL-PABON            PIC X       VALUE 'Z'.
   842     12  AL-PADOF            PIC X       VALUE '%'.
   843     12  AL-PADON            PIC X       VALUE '_'.
   844     12  AL-PANOF            PIC X       VALUE '-'.
   845     12  AL-PANON            PIC X       VALUE '/'.
   846     12  AL-SABOF            PIC X       VALUE '8'.
   847     12  AL-SABON            PIC X       VALUE '9'.
   848     12  AL-SADOF            PIC X       VALUE '@'.
   849     12  AL-SADON            PIC X       VALUE QUOTE.
   850     12  AL-SANOF            PIC X       VALUE '0'.
   851     12  AL-SANON            PIC X       VALUE '1'.
   852     12  AL-UABOF            PIC X       VALUE 'H'.
   853     12  AL-UABON            PIC X       VALUE 'I'.
   854     12  AL-UADOF            PIC X       VALUE '<'.
   855     12  AL-UADON            PIC X       VALUE '('.
   856     12  AL-UANOF            PIC X       VALUE ' '.
   857     12  AL-UANON            PIC X       VALUE 'A'.
   858     12  AL-UNBOF            PIC X       VALUE 'Q'.
   859     12  AL-UNBON            PIC X       VALUE 'R'.
   860     12  AL-UNDOF            PIC X       VALUE '*'.
   861     12  AL-UNDON            PIC X       VALUE ')'.
   862     12  AL-UNNOF            PIC X       VALUE '&'.
   863     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  20
* EL6501.cbl
   865*    COPY ELCEMIB.
   866******************************************************************
   867*                                                                *
   868*                                                                *
   869*                            ELCEMIB.                            *
   870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   871*                            VMOD=2.005                          *
   872*                                                                *
   873*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   874*                                                                *
   875******************************************************************
   876 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   877     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   878     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   879     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   880     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   881     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   882     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   883     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   884     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   885     12  EMI-SWITCH1             PIC X        VALUE '1'.
   886         88  EMI-NO-ERRORS                    VALUE '1'.
   887         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   888         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   889     12  EMI-SWITCH2             PIC X        VALUE '1'.
   890         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   891     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   892         88  EMI-AREA1-EMPTY                  VALUE '1'.
   893         88  EMI-AREA1-FULL                   VALUE '2'.
   894     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   895         88  EMI-AREA2-EMPTY                  VALUE '1'.
   896         88  EMI-AREA2-FULL                   VALUE '2'.
   897     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   898         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   899         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   900         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   901         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   902         88  EMI-BYPASS-FATALS                VALUE 'X'.
   903     12  EMI-ERROR-LINES.
   904         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   905         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   906         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   907         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   908             20  EMI-ERR-CODES OCCURS 10 TIMES.
   909                 24  EMI-ERR-NUM         PIC X(4).
   910                 24  EMI-FILLER          PIC X.
   911                 24  EMI-SEV             PIC X.
   912                 24  FILLER              PIC X.
   913             20  FILLER                  PIC X(02).
   914     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   915         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   916             20  EMI-ERROR-NUMBER    PIC X(4).
   917             20  EMI-FILL            PIC X.
   918             20  EMI-SEVERITY        PIC X.
   919             20  FILLER              PIC X.
   920             20  EMI-ERROR-TEXT.
   921                 24  EMI-TEXT-VARIABLE   PIC X(10).
   922                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  21
* EL6501.cbl
   923     12  EMI-SEVERITY-SAVE           PIC X.
   924         88  EMI-NOTE                    VALUE 'N'.
   925         88  EMI-WARNING                 VALUE 'W'.
   926         88  EMI-FORCABLE                VALUE 'F'.
   927         88  EMI-FATAL                   VALUE 'X'.
   928     12  EMI-MESSAGE-FLAG            PIC X.
   929         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   930         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   931     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   932     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   933         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   934         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   935         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   936     12  emi-claim-no                pic x(7).
   937     12  emi-claim-type              pic x(6).
   938     12  FILLER                      PIC X(124)  VALUE SPACES.
   939     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   940     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   941     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   942     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  22
* EL6501.cbl
   944*    COPY ELCINTF.
   945******************************************************************
   946*                                                                *
   947*                                                                *
   948*                            ELCINTF.                            *
   949*                            VMOD=2.017                          *
   950*                                                                *
   951*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   952*                                                                *
   953*       LENGTH = 1024                                            *
   954*                                                                *
   955******************************************************************
   956*                   C H A N G E   L O G
   957*
   958* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   959*-----------------------------------------------------------------
   960*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   961* EFFECTIVE    NUMBER
   962*-----------------------------------------------------------------
   963* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   964******************************************************************
   965 01  PROGRAM-INTERFACE-BLOCK.
   966     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   967     12  PI-CALLING-PROGRAM              PIC X(8).
   968     12  PI-SAVED-PROGRAM-1              PIC X(8).
   969     12  PI-SAVED-PROGRAM-2              PIC X(8).
   970     12  PI-SAVED-PROGRAM-3              PIC X(8).
   971     12  PI-SAVED-PROGRAM-4              PIC X(8).
   972     12  PI-SAVED-PROGRAM-5              PIC X(8).
   973     12  PI-SAVED-PROGRAM-6              PIC X(8).
   974     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   975     12  PI-COMPANY-ID                   PIC XXX.
   976     12  PI-COMPANY-CD                   PIC X.
   977
   978     12  PI-COMPANY-PASSWORD             PIC X(8).
   979
   980     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   981
   982     12  PI-CONTROL-IN-PROGRESS.
   983         16  PI-CARRIER                  PIC X.
   984         16  PI-GROUPING                 PIC X(6).
   985         16  PI-STATE                    PIC XX.
   986         16  PI-ACCOUNT                  PIC X(10).
   987         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   988                                         PIC X(10).
   989         16  PI-CLAIM-CERT-GRP.
   990             20  PI-CLAIM-NO             PIC X(7).
   991             20  PI-CERT-NO.
   992                 25  PI-CERT-PRIME       PIC X(10).
   993                 25  PI-CERT-SFX         PIC X.
   994             20  PI-CERT-EFF-DT          PIC XX.
   995         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   996             20  PI-PLAN-CODE            PIC X(2).
   997             20  PI-REVISION-NUMBER      PIC X(3).
   998             20  PI-PLAN-EFF-DT          PIC X(2).
   999             20  PI-PLAN-EXP-DT          PIC X(2).
  1000             20  FILLER                  PIC X(11).
  1001         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  23
* EL6501.cbl
  1002             20  PI-OE-REFERENCE-1.
  1003                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1004                 25  PI-OE-REF-1-SUFF    PIC XX.
  1005
  1006     12  PI-SESSION-IN-PROGRESS          PIC X.
  1007         88  CLAIM-SESSION                   VALUE '1'.
  1008         88  CREDIT-SESSION                  VALUE '2'.
  1009         88  WARRANTY-SESSION                VALUE '3'.
  1010         88  MORTGAGE-SESSION                VALUE '4'.
  1011         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1012
  1013
  1014*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1015
  1016     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1017     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1018
  1019     12  PI-CREDIT-USER                  PIC X.
  1020         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1021         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1022
  1023     12  PI-CLAIM-USER                   PIC X.
  1024         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1025         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1026
  1027     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1028         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1029         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1030         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1031         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1032         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1033
  1034     12  PI-PROCESSOR-ID                 PIC X(4).
  1035
  1036     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1037
  1038     12  PI-MEMBER-CAPTION               PIC X(10).
  1039
  1040     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1041         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1042
  1043     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1044     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1045     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1046     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1047
  1048     12  PI-AH-OVERRIDE-L1               PIC X.
  1049     12  PI-AH-OVERRIDE-L2               PIC XX.
  1050     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1051     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1052
  1053     12  PI-NEW-SYSTEM                   PIC X(2).
  1054
  1055     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1056     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1057         88  PI-USES-PAID-TO                 VALUE '1'.
  1058     12  PI-CRDTCRD-SYSTEM.
  1059         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  24
* EL6501.cbl
  1060             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1061             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1062         16  PI-CC-MONTH-END-DT          PIC XX.
  1063     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1064
  1065     12  PI-OE-REFERENCE-2.
  1066         16  PI-OE-REF-2-PRIME           PIC X(10).
  1067         16  PI-OE-REF-2-SUFF            PIC X.
  1068
  1069     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1070
  1071     12  PI-LANGUAGE-TYPE                PIC X.
  1072             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1073             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1074             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1075
  1076     12  PI-POLICY-LINKAGE-IND           PIC X.
  1077         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1078         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1079                                                   LOW-VALUES.
  1080
  1081     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1082     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1083         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1084         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1085
  1086     12  PI-PROCESSOR-CSR-IND            PIC X.
  1087         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1088         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1089
  1090     12  FILLER                          PIC X(3).
  1091
  1092     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1093
  1094     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1095         PI-SYSTEM-LEVEL.
  1096
  1097         16  PI-ENTRY-CODES.
  1098             20  PI-ENTRY-CD-1           PIC X.
  1099             20  PI-ENTRY-CD-2           PIC X.
  1100
  1101         16  PI-RETURN-CODES.
  1102             20  PI-RETURN-CD-1          PIC X.
  1103             20  PI-RETURN-CD-2          PIC X.
  1104
  1105         16  PI-UPDATE-STATUS-SAVE.
  1106             20  PI-UPDATE-BY            PIC X(4).
  1107             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1108
  1109         16  PI-LOWER-CASE-LETTERS       PIC X.
  1110             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1111
  1112*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1113*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1114*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1115
  1116         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1117             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  25
* EL6501.cbl
  1118             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1119             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1120             88  ACCNT-CNTL                  VALUE '3'.
  1121             88  CARR-ACCNT-CNTL             VALUE '4'.
  1122
  1123         16  PI-PROCESSOR-CAP-LIST.
  1124             20  PI-SYSTEM-CONTROLS.
  1125                24 PI-SYSTEM-DISPLAY     PIC X.
  1126                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1127                24 PI-SYSTEM-MODIFY      PIC X.
  1128                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1129             20  FILLER                  PIC XX.
  1130             20  PI-DISPLAY-CAP          PIC X.
  1131                 88  DISPLAY-CAP             VALUE 'Y'.
  1132             20  PI-MODIFY-CAP           PIC X.
  1133                 88  MODIFY-CAP              VALUE 'Y'.
  1134             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1135                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1136             20  PI-FORCE-CAP            PIC X.
  1137                 88  FORCE-CAP               VALUE 'Y'.
  1138
  1139         16  PI-PROGRAM-CONTROLS.
  1140             20  PI-PGM-PRINT-OPT        PIC X.
  1141             20  PI-PGM-FORMAT-OPT       PIC X.
  1142             20  PI-PGM-PROCESS-OPT      PIC X.
  1143             20  PI-PGM-TOTALS-OPT       PIC X.
  1144
  1145         16  PI-HELP-INTERFACE.
  1146             20  PI-LAST-ERROR-NO        PIC X(4).
  1147             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1148
  1149         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1150             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1151
  1152         16  PI-CR-CONTROL-IN-PROGRESS.
  1153             20  PI-CR-CARRIER           PIC X.
  1154             20  PI-CR-GROUPING          PIC X(6).
  1155             20  PI-CR-STATE             PIC XX.
  1156             20  PI-CR-ACCOUNT           PIC X(10).
  1157             20  PI-CR-FIN-RESP          PIC X(10).
  1158             20  PI-CR-TYPE              PIC X.
  1159
  1160         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1161
  1162         16  PI-CR-MONTH-END-DT          PIC XX.
  1163
  1164         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1165             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1166             88  PI-ZERO-CARRIER             VALUE '1'.
  1167             88  PI-ZERO-GROUPING            VALUE '2'.
  1168             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1169
  1170         16  PI-CARRIER-SECURITY         PIC X.
  1171             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1172
  1173         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1174             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1175             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  26
* EL6501.cbl
  1176
  1177         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1178             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1179                                         INDEXED BY PI-ACCESS-NDX
  1180                                         PIC X.
  1181
  1182         16  PI-GA-BILLING-CONTROL       PIC X.
  1183             88  PI-GA-BILLING               VALUE '1'.
  1184
  1185         16  PI-MAIL-PROCESSING          PIC X.
  1186             88  PI-MAIL-YES                 VALUE 'Y'.
  1187
  1188         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1189
  1190         16  PI-AR-SYSTEM.
  1191             20  PI-AR-PROCESSING-CNTL   PIC X.
  1192                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1193             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1194             20  PI-AR-MONTH-END-DT      PIC XX.
  1195
  1196         16  PI-MP-SYSTEM.
  1197             20  PI-MORTGAGE-USER            PIC X.
  1198                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1199                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1200             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1201                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1202                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1203                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1204                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1205                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1206             20  PI-MP-MONTH-END-DT          PIC XX.
  1207             20  PI-MP-REFERENCE-NO.
  1208                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1209                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1210
  1211         16  PI-LABEL-CONTROL            PIC X(01).
  1212             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1213             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1214
  1215         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1216             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1217
  1218         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1219             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1220             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1221
  1222         16  FILLER                      PIC X(14).
  1223
  1224     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1225******************************************************************
  1226*    COPY ELC650PI.
  1227******************************************************************
  1228*
  1229*                            ELC650PI.
  1230*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1231*                            VMOD=2.007
  1232*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1233*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  27
* EL6501.cbl
  1234* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1235*
  1236******************************************************************
  1237
  1238     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1239         16  PI-MAINT                   PIC X.
  1240         16  PI-PREV-ACCOUNT            PIC X(20).
  1241         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1242         16  PI-ACCT-KEY.
  1243             20  PI-ACCT-CCGSA-KEY.
  1244                 24  PI-ACCT-CO             PIC X.
  1245                 24  PI-ACCT-CARRIER        PIC X.
  1246                 24  PI-ACCT-GROUPING       PIC X(6).
  1247                 24  PI-ACCT-STATE          PIC XX.
  1248                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1249             20  PI-ACCT-EXP-DT           PIC XX.
  1250             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1251         16  PI-ACCT-ID                 PIC X(8).
  1252         16  PI-PLAN-KEY.
  1253             20  PI-PLAN-ACCT-KEY.
  1254                 24  PI-PLAN-COMPANY-CD PIC X.
  1255                 24  PI-PLAN-CARRIER    PIC X.
  1256                 24  PI-PLAN-GROUP      PIC X(6).
  1257                 24  PI-PLAN-STATE      PIC X(2).
  1258                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1259             20  PI-PLAN-BEN-TYPE       PIC X.
  1260             20  PI-PLAN-BEN            PIC XX.
  1261             20  PI-PLAN-REVISION       PIC X(3).
  1262         16  PI-WS-STATE                PIC XX.
  1263         16  PI-WS-CLASS                PIC XX.
  1264         16  PI-WS-DEV                  PIC X(3).
  1265         16  PI-WS-TYPE                 PIC X.
  1266         16  PI-WS-PLAN                 PIC XX.
  1267
  1268         16  PI-ERPNDB-ALT-KEY.
  1269             20  PI-PB-COMPANY-CD-A1    PIC X.
  1270             20  PI-PB-CARRIER          PIC X.
  1271             20  PI-PB-GROUPING         PIC X(6).
  1272             20  PI-PB-STATE            PIC XX.
  1273             20  PI-PB-ACCOUNT          PIC X(10).
  1274             20  PI-PB-CERT-EFF-DT      PIC XX.
  1275             20  PI-PB-CERT-NO          PIC X(10).
  1276             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1277             20  PI-PB-RECORD-TYPE      PIC X.
  1278
  1279         16  PI-DATE-RANGE-TABLE.
  1280             20  PI-TABLE-ENT OCCURS 32 TIMES
  1281                            INDEXED BY T-INDEX.
  1282                 24  PI-BIN-EFF-DT          PIC XX.
  1283                 24  PI-BIN-EXP-DT          PIC XX.
  1284                 24  PI-BIN-MAINT-DT        PIC XX.
  1285                 24  PI-BIN-LO-CERT         PIC XX.
  1286                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1287                 24  PI-BIN-HI-CERT         PIC XX.
  1288         16  PI-PAGE-NUMBER             PIC S9.
  1289             88  PI-FST-PAGE               VALUE +1.
  1290             88  PI-2ND-PAGE               VALUE +2.
  1291             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  28
* EL6501.cbl
  1292             88  PI-LST-PAGE               VALUE +4.
  1293         16  PI-TOTAL-LINES             PIC S99.
  1294         16  PI-LINE-SELECTED    PIC S9.
  1295***  Y2K PROJ 7744
  1296         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1297         16  BIN-EFFCHG-SAVE     PIC XX.
  1298         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1299***  Y2K PROJ 7744
  1300         16  BIN-EXPCHG-SAVE     PIC XX.
  1301         16  PI-RECORD-ADDED-SW  PIC X.
  1302             88  PI-RECORD-ADDED            VALUE '1'.
  1303             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1304         16  PI-ACCNAME          PIC X(30).
  1305         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1306         16  PI-SV-MAINT         PIC X.
  1307         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1308         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1309         16  PI-UPDATE-SW        PIC X.
  1310             88  PI-CHANGES-MADE             VALUE '1'.
  1311         16  PI-NOTE-TYPE        PIC X.
  1312             88  PI-ACCT-NOTE                VALUE '1'.
  1313         16  PI-DMD-FILE-SW      PIC X.
  1314             88  END-OF-FILE                 VALUE 'E'.
  1315             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1316             88  FIRST-OCCURS                VALUE 'F'.
  1317         16  PI-DMD-OCCURS       PIC S999.
  1318         16  PI-DMD-SCREEN       PIC X.
  1319             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1320             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1321             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1322         16  PI-NAMEFLG          PIC X.
  1323         16  PI-EL650-DEL-SW     PIC X.
  1324         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1325         16  PI-DCC-PROD-CODE    PIC XXX.
  1326         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  29
* EL6501.cbl
  1328
  1329*    COPY ELCJPFX.
  1330******************************************************************
  1331*                                                                *
  1332*                                                                *
  1333*                            ELCJPFX.                            *
  1334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1335*                            VMOD=2.002                          *
  1336*                                                                *
  1337*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1338*                                                                *
  1339*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1340*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1341*        ELCNTL - CONTROL FILE                                   *
  1342*        ELMSTR - CLAIM MASTERS                                  *
  1343*        ELTRLR - ACTIVITY TRAILERS                              *
  1344*        ELCHKQ - CHECK QUE                                      *
  1345******************************************************************
  1346 01  JOURNAL-RECORD.
  1347     12  jp-date                     pic s9(5) comp-3.
  1348     12  jp-time                     pic s9(7) comp-3.
  1349     12  JP-USER-ID                  PIC X(4).
  1350     12  JP-FILE-ID                  PIC X(8).
  1351     12  JP-PROGRAM-ID               PIC X(8).
  1352     12  JP-RECORD-TYPE              PIC X.
  1353         88 JP-ADD              VALUE 'A'.
  1354         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1355         88 JP-AFTER-CHANGE     VALUE 'C'.
  1356         88 JP-DELETE           VALUE 'D'.
  1357         88 JP-GENERIC-DELETE   VALUE 'G'.
  1358         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1359         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1360     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1361     12  JP-RECORD-AREA
  1362
  1363
  1364         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  30
* EL6501.cbl
  1366*    COPY ELCAID.
  1367******************************************************************
  1368*                                                                *
  1369*                            ELCAID.                             *
  1370*                            VMOD=2.001                          *
  1371*                                                                *
  1372*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1373*                                                                *
  1374*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1375*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1376******************************************************************
  1377
  1378 01  DFHAID.
  1379   02  DFHNULL   PIC  X  VALUE  ' '.
  1380   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1381   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1382   02  DFHPEN    PIC  X  VALUE  '='.
  1383   02  DFHOPID   PIC  X  VALUE  'W'.
  1384   02  DFHPA1    PIC  X  VALUE  '%'.
  1385   02  DFHPA2    PIC  X  VALUE  '>'.
  1386   02  DFHPA3    PIC  X  VALUE  ','.
  1387   02  DFHPF1    PIC  X  VALUE  '1'.
  1388   02  DFHPF2    PIC  X  VALUE  '2'.
  1389   02  DFHPF3    PIC  X  VALUE  '3'.
  1390   02  DFHPF4    PIC  X  VALUE  '4'.
  1391   02  DFHPF5    PIC  X  VALUE  '5'.
  1392   02  DFHPF6    PIC  X  VALUE  '6'.
  1393   02  DFHPF7    PIC  X  VALUE  '7'.
  1394   02  DFHPF8    PIC  X  VALUE  '8'.
  1395   02  DFHPF9    PIC  X  VALUE  '9'.
  1396   02  DFHPF10   PIC  X  VALUE  ':'.
  1397   02  DFHPF11   PIC  X  VALUE  '#'.
  1398   02  DFHPF12   PIC  X  VALUE  '@'.
  1399   02  DFHPF13   PIC  X  VALUE  'A'.
  1400   02  DFHPF14   PIC  X  VALUE  'B'.
  1401   02  DFHPF15   PIC  X  VALUE  'C'.
  1402   02  DFHPF16   PIC  X  VALUE  'D'.
  1403   02  DFHPF17   PIC  X  VALUE  'E'.
  1404   02  DFHPF18   PIC  X  VALUE  'F'.
  1405   02  DFHPF19   PIC  X  VALUE  'G'.
  1406   02  DFHPF20   PIC  X  VALUE  'H'.
  1407   02  DFHPF21   PIC  X  VALUE  'I'.
  1408*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1409   02  DFHPF22   PIC  X  VALUE  '['.
  1410   02  DFHPF23   PIC  X  VALUE  '.'.
  1411   02  DFHPF24   PIC  X  VALUE  '<'.
  1412   02  DFHMSRE   PIC  X  VALUE  'X'.
  1413   02  DFHSTRF   PIC  X  VALUE  'h'.
  1414   02  DFHTRIG   PIC  X  VALUE  '"'.
  1415 01  FILLER    REDEFINES DFHAID.
  1416     12  FILLER                  PIC X(8).
  1417     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  31
* EL6501.cbl
  1419*    COPY EL6501S.
  1420 01  EL6501AI.
  1421     05  FILLER            PIC  X(0012).
  1422*    -------------------------------
  1423     05  DATEL PIC S9(0004) COMP.
  1424     05  DATEF PIC  X(0001).
  1425     05  FILLER REDEFINES DATEF.
  1426         10  DATEA PIC  X(0001).
  1427     05  DATEI PIC  X(0008).
  1428*    -------------------------------
  1429     05  TIMEL PIC S9(0004) COMP.
  1430     05  TIMEF PIC  X(0001).
  1431     05  FILLER REDEFINES TIMEF.
  1432         10  TIMEA PIC  X(0001).
  1433     05  TIMEI PIC  X(0005).
  1434*    -------------------------------
  1435     05  CMPNYIDL PIC S9(0004) COMP.
  1436     05  CMPNYIDF PIC  X(0001).
  1437     05  FILLER REDEFINES CMPNYIDF.
  1438         10  CMPNYIDA PIC  X(0001).
  1439     05  CMPNYIDI PIC  X(0003).
  1440*    -------------------------------
  1441     05  USERIDL PIC S9(0004) COMP.
  1442     05  USERIDF PIC  X(0001).
  1443     05  FILLER REDEFINES USERIDF.
  1444         10  USERIDA PIC  X(0001).
  1445     05  USERIDI PIC  X(0004).
  1446*    -------------------------------
  1447     05  MAINTL PIC S9(0004) COMP.
  1448     05  MAINTF PIC  X(0001).
  1449     05  FILLER REDEFINES MAINTF.
  1450         10  MAINTA PIC  X(0001).
  1451     05  MAINTI PIC  X(0001).
  1452*    -------------------------------
  1453     05  CARRL PIC S9(0004) COMP.
  1454     05  CARRF PIC  X(0001).
  1455     05  FILLER REDEFINES CARRF.
  1456         10  CARRA PIC  X(0001).
  1457     05  CARRI PIC  X(0001).
  1458*    -------------------------------
  1459     05  GROUPINL PIC S9(0004) COMP.
  1460     05  GROUPINF PIC  X(0001).
  1461     05  FILLER REDEFINES GROUPINF.
  1462         10  GROUPINA PIC  X(0001).
  1463     05  GROUPINI PIC  X(0006).
  1464*    -------------------------------
  1465     05  STATEL PIC S9(0004) COMP.
  1466     05  STATEF PIC  X(0001).
  1467     05  FILLER REDEFINES STATEF.
  1468         10  STATEA PIC  X(0001).
  1469     05  STATEI PIC  X(0002).
  1470*    -------------------------------
  1471     05  ACCOUNTL PIC S9(0004) COMP.
  1472     05  ACCOUNTF PIC  X(0001).
  1473     05  FILLER REDEFINES ACCOUNTF.
  1474         10  ACCOUNTA PIC  X(0001).
  1475     05  ACCOUNTI PIC  X(0010).
  1476*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  32
* EL6501.cbl
  1477     05  EFFDTEL PIC S9(0004) COMP.
  1478     05  EFFDTEF PIC  X(0001).
  1479     05  FILLER REDEFINES EFFDTEF.
  1480         10  EFFDTEA PIC  X(0001).
  1481     05  EFFDTEI PIC  X(0008).
  1482*    -------------------------------
  1483     05  EXPDTEL PIC S9(0004) COMP.
  1484     05  EXPDTEF PIC  X(0001).
  1485     05  FILLER REDEFINES EXPDTEF.
  1486         10  EXPDTEA PIC  X(0001).
  1487     05  EXPDTEI PIC  X(0008).
  1488*    -------------------------------
  1489     05  MAINTBYL PIC S9(0004) COMP.
  1490     05  MAINTBYF PIC  X(0001).
  1491     05  FILLER REDEFINES MAINTBYF.
  1492         10  MAINTBYA PIC  X(0001).
  1493     05  MAINTBYI PIC  X(0004).
  1494*    -------------------------------
  1495     05  PCONTL PIC S9(0004) COMP.
  1496     05  PCONTF PIC  X(0001).
  1497     05  FILLER REDEFINES PCONTF.
  1498         10  PCONTA PIC  X(0001).
  1499     05  PCONTI PIC  X(0030).
  1500*    -------------------------------
  1501     05  CSRL PIC S9(0004) COMP.
  1502     05  CSRF PIC  X(0001).
  1503     05  FILLER REDEFINES CSRF.
  1504         10  CSRA PIC  X(0001).
  1505     05  CSRI PIC  X(0004).
  1506*    -------------------------------
  1507     05  PDSPLYL PIC S9(0004) COMP.
  1508     05  PDSPLYF PIC  X(0001).
  1509     05  FILLER REDEFINES PDSPLYF.
  1510         10  PDSPLYA PIC  X(0001).
  1511     05  PDSPLYI PIC  X(0006).
  1512*    -------------------------------
  1513     05  PEFFDTEL PIC S9(0004) COMP.
  1514     05  PEFFDTEF PIC  X(0001).
  1515     05  FILLER REDEFINES PEFFDTEF.
  1516         10  PEFFDTEA PIC  X(0001).
  1517     05  PEFFDTEI PIC  X(0008).
  1518*    -------------------------------
  1519     05  PEXPDTEL PIC S9(0004) COMP.
  1520     05  PEXPDTEF PIC  X(0001).
  1521     05  FILLER REDEFINES PEXPDTEF.
  1522         10  PEXPDTEA PIC  X(0001).
  1523     05  PEXPDTEI PIC  X(0008).
  1524*    -------------------------------
  1525     05  NAMEL PIC S9(0004) COMP.
  1526     05  NAMEF PIC  X(0001).
  1527     05  FILLER REDEFINES NAMEF.
  1528         10  NAMEA PIC  X(0001).
  1529     05  NAMEI PIC  X(0030).
  1530*    -------------------------------
  1531     05  TAXNOL PIC S9(0004) COMP.
  1532     05  TAXNOF PIC  X(0001).
  1533     05  FILLER REDEFINES TAXNOF.
  1534         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  33
* EL6501.cbl
  1535     05  TAXNOI PIC  X(0011).
  1536*    -------------------------------
  1537     05  STATUSL PIC S9(0004) COMP.
  1538     05  STATUSF PIC  X(0001).
  1539     05  FILLER REDEFINES STATUSF.
  1540         10  STATUSA PIC  X(0001).
  1541     05  STATUSI PIC  X(0001).
  1542*    -------------------------------
  1543     05  INCAREL PIC S9(0004) COMP.
  1544     05  INCAREF PIC  X(0001).
  1545     05  FILLER REDEFINES INCAREF.
  1546         10  INCAREA PIC  X(0001).
  1547     05  INCAREI PIC  X(0030).
  1548*    -------------------------------
  1549     05  PHONEL PIC S9(0004) COMP.
  1550     05  PHONEF PIC  X(0001).
  1551     05  FILLER REDEFINES PHONEF.
  1552         10  PHONEA PIC  X(0001).
  1553     05  PHONEI PIC  X(0012).
  1554*    -------------------------------
  1555     05  INDGRPL PIC S9(0004) COMP.
  1556     05  INDGRPF PIC  X(0001).
  1557     05  FILLER REDEFINES INDGRPF.
  1558         10  INDGRPA PIC  X(0001).
  1559     05  INDGRPI PIC  X(0001).
  1560*    -------------------------------
  1561     05  ADDR1L PIC S9(0004) COMP.
  1562     05  ADDR1F PIC  X(0001).
  1563     05  FILLER REDEFINES ADDR1F.
  1564         10  ADDR1A PIC  X(0001).
  1565     05  ADDR1I PIC  X(0030).
  1566*    -------------------------------
  1567     05  CONTRL PIC S9(0004) COMP.
  1568     05  CONTRF PIC  X(0001).
  1569     05  FILLER REDEFINES CONTRF.
  1570         10  CONTRA PIC  X(0001).
  1571     05  CONTRI PIC  X(0008).
  1572*    -------------------------------
  1573     05  TYPEL PIC S9(0004) COMP.
  1574     05  TYPEF PIC  X(0001).
  1575     05  FILLER REDEFINES TYPEF.
  1576         10  TYPEA PIC  X(0001).
  1577     05  TYPEI PIC  99.
  1578*    -------------------------------
  1579     05  ACITYL PIC S9(0004) COMP.
  1580     05  ACITYF PIC  X(0001).
  1581     05  FILLER REDEFINES ACITYF.
  1582         10  ACITYA PIC  X(0001).
  1583     05  ACITYI PIC  X(0028).
  1584*    -------------------------------
  1585     05  ASTATEL PIC S9(0004) COMP.
  1586     05  ASTATEF PIC  X(0001).
  1587     05  FILLER REDEFINES ASTATEF.
  1588         10  ASTATEA PIC  X(0001).
  1589     05  ASTATEI PIC  X(0002).
  1590*    -------------------------------
  1591     05  PRODATEL PIC S9(0004) COMP.
  1592     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  34
* EL6501.cbl
  1593     05  FILLER REDEFINES PRODATEF.
  1594         10  PRODATEA PIC  X(0001).
  1595     05  PRODATEI PIC  X(0008).
  1596*    -------------------------------
  1597     05  STDBENL PIC S9(0004) COMP.
  1598     05  STDBENF PIC  X(0001).
  1599     05  FILLER REDEFINES STDBENF.
  1600         10  STDBENA PIC  X(0001).
  1601     05  STDBENI PIC  X(0002).
  1602*    -------------------------------
  1603     05  ZIPL PIC S9(0004) COMP.
  1604     05  ZIPF PIC  X(0001).
  1605     05  FILLER REDEFINES ZIPF.
  1606         10  ZIPA PIC  X(0001).
  1607     05  ZIPI PIC  X(0010).
  1608*    -------------------------------
  1609     05  CTPLABLL PIC S9(0004) COMP.
  1610     05  CTPLABLF PIC  X(0001).
  1611     05  FILLER REDEFINES CTPLABLF.
  1612         10  CTPLABLA PIC  X(0001).
  1613     05  CTPLABLI PIC  X(0010).
  1614*    -------------------------------
  1615     05  CLPTOLPL PIC S9(0004) COMP.
  1616     05  CLPTOLPF PIC  X(0001).
  1617     05  FILLER REDEFINES CLPTOLPF.
  1618         10  CLPTOLPA PIC  X(0001).
  1619     05  CLPTOLPI PIC  S9(02)V9999.
  1620*    -------------------------------
  1621     05  RETROCDL PIC S9(0004) COMP.
  1622     05  RETROCDF PIC  X(0001).
  1623     05  FILLER REDEFINES RETROCDF.
  1624         10  RETROCDA PIC  X(0001).
  1625     05  RETROCDI PIC  X(0003).
  1626*    -------------------------------
  1627     05  BILLCDL PIC S9(0004) COMP.
  1628     05  BILLCDF PIC  X(0001).
  1629     05  FILLER REDEFINES BILLCDF.
  1630         10  BILLCDA PIC  X(0001).
  1631     05  BILLCDI PIC  X(0003).
  1632*    -------------------------------
  1633     05  LCLABLL PIC S9(0004) COMP.
  1634     05  LCLABLF PIC  X(0001).
  1635     05  FILLER REDEFINES LCLABLF.
  1636         10  LCLABLA PIC  X(0001).
  1637     05  LCLABLI PIC  X(0011).
  1638*    -------------------------------
  1639     05  LCOMML PIC S9(0004) COMP.
  1640     05  LCOMMF PIC  X(0001).
  1641     05  FILLER REDEFINES LCOMMF.
  1642         10  LCOMMA PIC  X(0001).
  1643     05  LCOMMI PIC  S9(6)V9(2).
  1644*    -------------------------------
  1645     05  MAXFEEHL PIC S9(0004) COMP.
  1646     05  MAXFEEHF PIC  X(0001).
  1647     05  FILLER REDEFINES MAXFEEHF.
  1648         10  MAXFEEHA PIC  X(0001).
  1649     05  MAXFEEHI PIC  X(0013).
  1650*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  35
* EL6501.cbl
  1651     05  MAXMFEEL PIC S9(0004) COMP.
  1652     05  MAXMFEEF PIC  X(0001).
  1653     05  FILLER REDEFINES MAXMFEEF.
  1654         10  MAXMFEEA PIC  X(0001).
  1655     05  MAXMFEEI PIC  X(0005).
  1656*    -------------------------------
  1657     05  CLPSTHL PIC S9(0004) COMP.
  1658     05  CLPSTHF PIC  X(0001).
  1659     05  FILLER REDEFINES CLPSTHF.
  1660         10  CLPSTHA PIC  X(0001).
  1661     05  CLPSTHI PIC  X(0010).
  1662*    -------------------------------
  1663     05  CLPSTL PIC S9(0004) COMP.
  1664     05  CLPSTF PIC  X(0001).
  1665     05  FILLER REDEFINES CLPSTF.
  1666         10  CLPSTA PIC  X(0001).
  1667     05  CLPSTI PIC  X(0002).
  1668*    -------------------------------
  1669     05  PRODCDHL PIC S9(0004) COMP.
  1670     05  PRODCDHF PIC  X(0001).
  1671     05  FILLER REDEFINES PRODCDHF.
  1672         10  PRODCDHA PIC  X(0001).
  1673     05  PRODCDHI PIC  X(0012).
  1674*    -------------------------------
  1675     05  PRODCDL PIC S9(0004) COMP.
  1676     05  PRODCDF PIC  X(0001).
  1677     05  FILLER REDEFINES PRODCDF.
  1678         10  PRODCDA PIC  X(0001).
  1679     05  PRODCDI PIC  X(0003).
  1680*    -------------------------------
  1681     05  REMITL PIC S9(0004) COMP.
  1682     05  REMITF PIC  X(0001).
  1683     05  FILLER REDEFINES REMITF.
  1684         10  REMITA PIC  X(0001).
  1685     05  REMITI PIC  99.
  1686*    -------------------------------
  1687     05  COMMCALL PIC S9(0004) COMP.
  1688     05  COMMCALF PIC  X(0001).
  1689     05  FILLER REDEFINES COMMCALF.
  1690         10  COMMCALA PIC  X(0001).
  1691     05  COMMCALI PIC  X(0001).
  1692*    -------------------------------
  1693     05  REINTABL PIC S9(0004) COMP.
  1694     05  REINTABF PIC  X(0001).
  1695     05  FILLER REDEFINES REINTABF.
  1696         10  REINTABA PIC  X(0001).
  1697     05  REINTABI PIC  X(0003).
  1698*    -------------------------------
  1699     05  REINCALL PIC S9(0004) COMP.
  1700     05  REINCALF PIC  X(0001).
  1701     05  FILLER REDEFINES REINCALF.
  1702         10  REINCALA PIC  X(0001).
  1703     05  REINCALI PIC  X(0001).
  1704*    -------------------------------
  1705     05  AHHEADL PIC S9(0004) COMP.
  1706     05  AHHEADF PIC  X(0001).
  1707     05  FILLER REDEFINES AHHEADF.
  1708         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  36
* EL6501.cbl
  1709     05  AHHEADI PIC  X(0006).
  1710*    -------------------------------
  1711     05  AGNT1L PIC S9(0004) COMP.
  1712     05  AGNT1F PIC  X(0001).
  1713     05  FILLER REDEFINES AGNT1F.
  1714         10  AGNT1A PIC  X(0001).
  1715     05  AGNT1I PIC  X(0010).
  1716*    -------------------------------
  1717     05  TYPE1L PIC S9(0004) COMP.
  1718     05  TYPE1F PIC  X(0001).
  1719     05  FILLER REDEFINES TYPE1F.
  1720         10  TYPE1A PIC  X(0001).
  1721     05  TYPE1I PIC  X(0001).
  1722*    -------------------------------
  1723     05  SINRT1L PIC S9(0004) COMP.
  1724     05  SINRT1F PIC  X(0001).
  1725     05  FILLER REDEFINES SINRT1F.
  1726         10  SINRT1A PIC  X(0001).
  1727     05  SINRT1I PIC  X(0006).
  1728*    -------------------------------
  1729     05  JNTRT1L PIC S9(0004) COMP.
  1730     05  JNTRT1F PIC  X(0001).
  1731     05  FILLER REDEFINES JNTRT1F.
  1732         10  JNTRT1A PIC  X(0001).
  1733     05  JNTRT1I PIC  X(0006).
  1734*    -------------------------------
  1735     05  AHRT1L PIC S9(0004) COMP.
  1736     05  AHRT1F PIC  X(0001).
  1737     05  FILLER REDEFINES AHRT1F.
  1738         10  AHRT1A PIC  X(0001).
  1739     05  AHRT1I PIC  X(0006).
  1740*    -------------------------------
  1741     05  RECAL1L PIC S9(0004) COMP.
  1742     05  RECAL1F PIC  X(0001).
  1743     05  FILLER REDEFINES RECAL1F.
  1744         10  RECAL1A PIC  X(0001).
  1745     05  RECAL1I PIC  X(0001).
  1746*    -------------------------------
  1747     05  COMM1L PIC S9(0004) COMP.
  1748     05  COMM1F PIC  X(0001).
  1749     05  FILLER REDEFINES COMM1F.
  1750         10  COMM1A PIC  X(0001).
  1751     05  COMM1I PIC  X(0001).
  1752*    -------------------------------
  1753     05  CHGBK1L PIC S9(0004) COMP.
  1754     05  CHGBK1F PIC  X(0001).
  1755     05  FILLER REDEFINES CHGBK1F.
  1756         10  CHGBK1A PIC  X(0001).
  1757     05  CHGBK1I PIC  X(0002).
  1758*    -------------------------------
  1759     05  GLCDE1L PIC S9(0004) COMP.
  1760     05  GLCDE1F PIC  X(0001).
  1761     05  FILLER REDEFINES GLCDE1F.
  1762         10  GLCDE1A PIC  X(0001).
  1763     05  GLCDE1I PIC  X(0001).
  1764*    -------------------------------
  1765     05  AGNT2L PIC S9(0004) COMP.
  1766     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  37
* EL6501.cbl
  1767     05  FILLER REDEFINES AGNT2F.
  1768         10  AGNT2A PIC  X(0001).
  1769     05  AGNT2I PIC  X(0010).
  1770*    -------------------------------
  1771     05  TYPE2L PIC S9(0004) COMP.
  1772     05  TYPE2F PIC  X(0001).
  1773     05  FILLER REDEFINES TYPE2F.
  1774         10  TYPE2A PIC  X(0001).
  1775     05  TYPE2I PIC  X(0001).
  1776*    -------------------------------
  1777     05  SINRT2L PIC S9(0004) COMP.
  1778     05  SINRT2F PIC  X(0001).
  1779     05  FILLER REDEFINES SINRT2F.
  1780         10  SINRT2A PIC  X(0001).
  1781     05  SINRT2I PIC  X(0006).
  1782*    -------------------------------
  1783     05  JNTRT2L PIC S9(0004) COMP.
  1784     05  JNTRT2F PIC  X(0001).
  1785     05  FILLER REDEFINES JNTRT2F.
  1786         10  JNTRT2A PIC  X(0001).
  1787     05  JNTRT2I PIC  X(0006).
  1788*    -------------------------------
  1789     05  AHRT2L PIC S9(0004) COMP.
  1790     05  AHRT2F PIC  X(0001).
  1791     05  FILLER REDEFINES AHRT2F.
  1792         10  AHRT2A PIC  X(0001).
  1793     05  AHRT2I PIC  X(0006).
  1794*    -------------------------------
  1795     05  RECAL2L PIC S9(0004) COMP.
  1796     05  RECAL2F PIC  X(0001).
  1797     05  FILLER REDEFINES RECAL2F.
  1798         10  RECAL2A PIC  X(0001).
  1799     05  RECAL2I PIC  X(0001).
  1800*    -------------------------------
  1801     05  COMM2L PIC S9(0004) COMP.
  1802     05  COMM2F PIC  X(0001).
  1803     05  FILLER REDEFINES COMM2F.
  1804         10  COMM2A PIC  X(0001).
  1805     05  COMM2I PIC  X(0001).
  1806*    -------------------------------
  1807     05  CHGBK2L PIC S9(0004) COMP.
  1808     05  CHGBK2F PIC  X(0001).
  1809     05  FILLER REDEFINES CHGBK2F.
  1810         10  CHGBK2A PIC  X(0001).
  1811     05  CHGBK2I PIC  X(0002).
  1812*    -------------------------------
  1813     05  GLCDE2L PIC S9(0004) COMP.
  1814     05  GLCDE2F PIC  X(0001).
  1815     05  FILLER REDEFINES GLCDE2F.
  1816         10  GLCDE2A PIC  X(0001).
  1817     05  GLCDE2I PIC  X(0001).
  1818*    -------------------------------
  1819     05  AGNT3L PIC S9(0004) COMP.
  1820     05  AGNT3F PIC  X(0001).
  1821     05  FILLER REDEFINES AGNT3F.
  1822         10  AGNT3A PIC  X(0001).
  1823     05  AGNT3I PIC  X(0010).
  1824*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  38
* EL6501.cbl
  1825     05  TYPE3L PIC S9(0004) COMP.
  1826     05  TYPE3F PIC  X(0001).
  1827     05  FILLER REDEFINES TYPE3F.
  1828         10  TYPE3A PIC  X(0001).
  1829     05  TYPE3I PIC  X(0001).
  1830*    -------------------------------
  1831     05  SINRT3L PIC S9(0004) COMP.
  1832     05  SINRT3F PIC  X(0001).
  1833     05  FILLER REDEFINES SINRT3F.
  1834         10  SINRT3A PIC  X(0001).
  1835     05  SINRT3I PIC  X(0006).
  1836*    -------------------------------
  1837     05  JNTRT3L PIC S9(0004) COMP.
  1838     05  JNTRT3F PIC  X(0001).
  1839     05  FILLER REDEFINES JNTRT3F.
  1840         10  JNTRT3A PIC  X(0001).
  1841     05  JNTRT3I PIC  X(0006).
  1842*    -------------------------------
  1843     05  AHRT3L PIC S9(0004) COMP.
  1844     05  AHRT3F PIC  X(0001).
  1845     05  FILLER REDEFINES AHRT3F.
  1846         10  AHRT3A PIC  X(0001).
  1847     05  AHRT3I PIC  X(0006).
  1848*    -------------------------------
  1849     05  RECAL3L PIC S9(0004) COMP.
  1850     05  RECAL3F PIC  X(0001).
  1851     05  FILLER REDEFINES RECAL3F.
  1852         10  RECAL3A PIC  X(0001).
  1853     05  RECAL3I PIC  X(0001).
  1854*    -------------------------------
  1855     05  COMM3L PIC S9(0004) COMP.
  1856     05  COMM3F PIC  X(0001).
  1857     05  FILLER REDEFINES COMM3F.
  1858         10  COMM3A PIC  X(0001).
  1859     05  COMM3I PIC  X(0001).
  1860*    -------------------------------
  1861     05  CHGBK3L PIC S9(0004) COMP.
  1862     05  CHGBK3F PIC  X(0001).
  1863     05  FILLER REDEFINES CHGBK3F.
  1864         10  CHGBK3A PIC  X(0001).
  1865     05  CHGBK3I PIC  X(0002).
  1866*    -------------------------------
  1867     05  GLCDE3L PIC S9(0004) COMP.
  1868     05  GLCDE3F PIC  X(0001).
  1869     05  FILLER REDEFINES GLCDE3F.
  1870         10  GLCDE3A PIC  X(0001).
  1871     05  GLCDE3I PIC  X(0001).
  1872*    -------------------------------
  1873     05  AGNT4L PIC S9(0004) COMP.
  1874     05  AGNT4F PIC  X(0001).
  1875     05  FILLER REDEFINES AGNT4F.
  1876         10  AGNT4A PIC  X(0001).
  1877     05  AGNT4I PIC  X(0010).
  1878*    -------------------------------
  1879     05  TYPE4L PIC S9(0004) COMP.
  1880     05  TYPE4F PIC  X(0001).
  1881     05  FILLER REDEFINES TYPE4F.
  1882         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  39
* EL6501.cbl
  1883     05  TYPE4I PIC  X(0001).
  1884*    -------------------------------
  1885     05  SINRT4L PIC S9(0004) COMP.
  1886     05  SINRT4F PIC  X(0001).
  1887     05  FILLER REDEFINES SINRT4F.
  1888         10  SINRT4A PIC  X(0001).
  1889     05  SINRT4I PIC  X(0006).
  1890*    -------------------------------
  1891     05  JNTRT4L PIC S9(0004) COMP.
  1892     05  JNTRT4F PIC  X(0001).
  1893     05  FILLER REDEFINES JNTRT4F.
  1894         10  JNTRT4A PIC  X(0001).
  1895     05  JNTRT4I PIC  X(0006).
  1896*    -------------------------------
  1897     05  AHRT4L PIC S9(0004) COMP.
  1898     05  AHRT4F PIC  X(0001).
  1899     05  FILLER REDEFINES AHRT4F.
  1900         10  AHRT4A PIC  X(0001).
  1901     05  AHRT4I PIC  X(0006).
  1902*    -------------------------------
  1903     05  RECAL4L PIC S9(0004) COMP.
  1904     05  RECAL4F PIC  X(0001).
  1905     05  FILLER REDEFINES RECAL4F.
  1906         10  RECAL4A PIC  X(0001).
  1907     05  RECAL4I PIC  X(0001).
  1908*    -------------------------------
  1909     05  COMM4L PIC S9(0004) COMP.
  1910     05  COMM4F PIC  X(0001).
  1911     05  FILLER REDEFINES COMM4F.
  1912         10  COMM4A PIC  X(0001).
  1913     05  COMM4I PIC  X(0001).
  1914*    -------------------------------
  1915     05  CHGBK4L PIC S9(0004) COMP.
  1916     05  CHGBK4F PIC  X(0001).
  1917     05  FILLER REDEFINES CHGBK4F.
  1918         10  CHGBK4A PIC  X(0001).
  1919     05  CHGBK4I PIC  X(0002).
  1920*    -------------------------------
  1921     05  GLCDE4L PIC S9(0004) COMP.
  1922     05  GLCDE4F PIC  X(0001).
  1923     05  FILLER REDEFINES GLCDE4F.
  1924         10  GLCDE4A PIC  X(0001).
  1925     05  GLCDE4I PIC  X(0001).
  1926*    -------------------------------
  1927     05  AGNT5L PIC S9(0004) COMP.
  1928     05  AGNT5F PIC  X(0001).
  1929     05  FILLER REDEFINES AGNT5F.
  1930         10  AGNT5A PIC  X(0001).
  1931     05  AGNT5I PIC  X(0010).
  1932*    -------------------------------
  1933     05  TYPE5L PIC S9(0004) COMP.
  1934     05  TYPE5F PIC  X(0001).
  1935     05  FILLER REDEFINES TYPE5F.
  1936         10  TYPE5A PIC  X(0001).
  1937     05  TYPE5I PIC  X(0001).
  1938*    -------------------------------
  1939     05  SINRT5L PIC S9(0004) COMP.
  1940     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  40
* EL6501.cbl
  1941     05  FILLER REDEFINES SINRT5F.
  1942         10  SINRT5A PIC  X(0001).
  1943     05  SINRT5I PIC  X(0006).
  1944*    -------------------------------
  1945     05  JNTRT5L PIC S9(0004) COMP.
  1946     05  JNTRT5F PIC  X(0001).
  1947     05  FILLER REDEFINES JNTRT5F.
  1948         10  JNTRT5A PIC  X(0001).
  1949     05  JNTRT5I PIC  X(0006).
  1950*    -------------------------------
  1951     05  AHRT5L PIC S9(0004) COMP.
  1952     05  AHRT5F PIC  X(0001).
  1953     05  FILLER REDEFINES AHRT5F.
  1954         10  AHRT5A PIC  X(0001).
  1955     05  AHRT5I PIC  X(0006).
  1956*    -------------------------------
  1957     05  RECAL5L PIC S9(0004) COMP.
  1958     05  RECAL5F PIC  X(0001).
  1959     05  FILLER REDEFINES RECAL5F.
  1960         10  RECAL5A PIC  X(0001).
  1961     05  RECAL5I PIC  X(0001).
  1962*    -------------------------------
  1963     05  COMM5L PIC S9(0004) COMP.
  1964     05  COMM5F PIC  X(0001).
  1965     05  FILLER REDEFINES COMM5F.
  1966         10  COMM5A PIC  X(0001).
  1967     05  COMM5I PIC  X(0001).
  1968*    -------------------------------
  1969     05  CHGBK5L PIC S9(0004) COMP.
  1970     05  CHGBK5F PIC  X(0001).
  1971     05  FILLER REDEFINES CHGBK5F.
  1972         10  CHGBK5A PIC  X(0001).
  1973     05  CHGBK5I PIC  X(0002).
  1974*    -------------------------------
  1975     05  GLCDE5L PIC S9(0004) COMP.
  1976     05  GLCDE5F PIC  X(0001).
  1977     05  FILLER REDEFINES GLCDE5F.
  1978         10  GLCDE5A PIC  X(0001).
  1979     05  GLCDE5I PIC  X(0001).
  1980*    -------------------------------
  1981     05  AGNT6L PIC S9(0004) COMP.
  1982     05  AGNT6F PIC  X(0001).
  1983     05  FILLER REDEFINES AGNT6F.
  1984         10  AGNT6A PIC  X(0001).
  1985     05  AGNT6I PIC  X(0010).
  1986*    -------------------------------
  1987     05  TYPE6L PIC S9(0004) COMP.
  1988     05  TYPE6F PIC  X(0001).
  1989     05  FILLER REDEFINES TYPE6F.
  1990         10  TYPE6A PIC  X(0001).
  1991     05  TYPE6I PIC  X(0001).
  1992*    -------------------------------
  1993     05  SINRT6L PIC S9(0004) COMP.
  1994     05  SINRT6F PIC  X(0001).
  1995     05  FILLER REDEFINES SINRT6F.
  1996         10  SINRT6A PIC  X(0001).
  1997     05  SINRT6I PIC  X(0006).
  1998*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  41
* EL6501.cbl
  1999     05  JNTRT6L PIC S9(0004) COMP.
  2000     05  JNTRT6F PIC  X(0001).
  2001     05  FILLER REDEFINES JNTRT6F.
  2002         10  JNTRT6A PIC  X(0001).
  2003     05  JNTRT6I PIC  X(0006).
  2004*    -------------------------------
  2005     05  AHRT6L PIC S9(0004) COMP.
  2006     05  AHRT6F PIC  X(0001).
  2007     05  FILLER REDEFINES AHRT6F.
  2008         10  AHRT6A PIC  X(0001).
  2009     05  AHRT6I PIC  X(0006).
  2010*    -------------------------------
  2011     05  RECAL6L PIC S9(0004) COMP.
  2012     05  RECAL6F PIC  X(0001).
  2013     05  FILLER REDEFINES RECAL6F.
  2014         10  RECAL6A PIC  X(0001).
  2015     05  RECAL6I PIC  X(0001).
  2016*    -------------------------------
  2017     05  COMM6L PIC S9(0004) COMP.
  2018     05  COMM6F PIC  X(0001).
  2019     05  FILLER REDEFINES COMM6F.
  2020         10  COMM6A PIC  X(0001).
  2021     05  COMM6I PIC  X(0001).
  2022*    -------------------------------
  2023     05  CHGBK6L PIC S9(0004) COMP.
  2024     05  CHGBK6F PIC  X(0001).
  2025     05  FILLER REDEFINES CHGBK6F.
  2026         10  CHGBK6A PIC  X(0001).
  2027     05  CHGBK6I PIC  X(0002).
  2028*    -------------------------------
  2029     05  GLCDE6L PIC S9(0004) COMP.
  2030     05  GLCDE6F PIC  X(0001).
  2031     05  FILLER REDEFINES GLCDE6F.
  2032         10  GLCDE6A PIC  X(0001).
  2033     05  GLCDE6I PIC  X(0001).
  2034*    -------------------------------
  2035     05  AGNT7L PIC S9(0004) COMP.
  2036     05  AGNT7F PIC  X(0001).
  2037     05  FILLER REDEFINES AGNT7F.
  2038         10  AGNT7A PIC  X(0001).
  2039     05  AGNT7I PIC  X(0010).
  2040*    -------------------------------
  2041     05  TYPE7L PIC S9(0004) COMP.
  2042     05  TYPE7F PIC  X(0001).
  2043     05  FILLER REDEFINES TYPE7F.
  2044         10  TYPE7A PIC  X(0001).
  2045     05  TYPE7I PIC  X(0001).
  2046*    -------------------------------
  2047     05  SINRT7L PIC S9(0004) COMP.
  2048     05  SINRT7F PIC  X(0001).
  2049     05  FILLER REDEFINES SINRT7F.
  2050         10  SINRT7A PIC  X(0001).
  2051     05  SINRT7I PIC  X(0006).
  2052*    -------------------------------
  2053     05  JNTRT7L PIC S9(0004) COMP.
  2054     05  JNTRT7F PIC  X(0001).
  2055     05  FILLER REDEFINES JNTRT7F.
  2056         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  42
* EL6501.cbl
  2057     05  JNTRT7I PIC  X(0006).
  2058*    -------------------------------
  2059     05  AHRT7L PIC S9(0004) COMP.
  2060     05  AHRT7F PIC  X(0001).
  2061     05  FILLER REDEFINES AHRT7F.
  2062         10  AHRT7A PIC  X(0001).
  2063     05  AHRT7I PIC  X(0006).
  2064*    -------------------------------
  2065     05  RECAL7L PIC S9(0004) COMP.
  2066     05  RECAL7F PIC  X(0001).
  2067     05  FILLER REDEFINES RECAL7F.
  2068         10  RECAL7A PIC  X(0001).
  2069     05  RECAL7I PIC  X(0001).
  2070*    -------------------------------
  2071     05  COMM7L PIC S9(0004) COMP.
  2072     05  COMM7F PIC  X(0001).
  2073     05  FILLER REDEFINES COMM7F.
  2074         10  COMM7A PIC  X(0001).
  2075     05  COMM7I PIC  X(0001).
  2076*    -------------------------------
  2077     05  CHGBK7L PIC S9(0004) COMP.
  2078     05  CHGBK7F PIC  X(0001).
  2079     05  FILLER REDEFINES CHGBK7F.
  2080         10  CHGBK7A PIC  X(0001).
  2081     05  CHGBK7I PIC  X(0002).
  2082*    -------------------------------
  2083     05  GLCDE7L PIC S9(0004) COMP.
  2084     05  GLCDE7F PIC  X(0001).
  2085     05  FILLER REDEFINES GLCDE7F.
  2086         10  GLCDE7A PIC  X(0001).
  2087     05  GLCDE7I PIC  X(0001).
  2088*    -------------------------------
  2089     05  AGNT8L PIC S9(0004) COMP.
  2090     05  AGNT8F PIC  X(0001).
  2091     05  FILLER REDEFINES AGNT8F.
  2092         10  AGNT8A PIC  X(0001).
  2093     05  AGNT8I PIC  X(0010).
  2094*    -------------------------------
  2095     05  TYPE8L PIC S9(0004) COMP.
  2096     05  TYPE8F PIC  X(0001).
  2097     05  FILLER REDEFINES TYPE8F.
  2098         10  TYPE8A PIC  X(0001).
  2099     05  TYPE8I PIC  X(0001).
  2100*    -------------------------------
  2101     05  SINRT8L PIC S9(0004) COMP.
  2102     05  SINRT8F PIC  X(0001).
  2103     05  FILLER REDEFINES SINRT8F.
  2104         10  SINRT8A PIC  X(0001).
  2105     05  SINRT8I PIC  X(0006).
  2106*    -------------------------------
  2107     05  JNTRT8L PIC S9(0004) COMP.
  2108     05  JNTRT8F PIC  X(0001).
  2109     05  FILLER REDEFINES JNTRT8F.
  2110         10  JNTRT8A PIC  X(0001).
  2111     05  JNTRT8I PIC  X(0006).
  2112*    -------------------------------
  2113     05  AHRT8L PIC S9(0004) COMP.
  2114     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  43
* EL6501.cbl
  2115     05  FILLER REDEFINES AHRT8F.
  2116         10  AHRT8A PIC  X(0001).
  2117     05  AHRT8I PIC  X(0006).
  2118*    -------------------------------
  2119     05  RECAL8L PIC S9(0004) COMP.
  2120     05  RECAL8F PIC  X(0001).
  2121     05  FILLER REDEFINES RECAL8F.
  2122         10  RECAL8A PIC  X(0001).
  2123     05  RECAL8I PIC  X(0001).
  2124*    -------------------------------
  2125     05  COMM8L PIC S9(0004) COMP.
  2126     05  COMM8F PIC  X(0001).
  2127     05  FILLER REDEFINES COMM8F.
  2128         10  COMM8A PIC  X(0001).
  2129     05  COMM8I PIC  X(0001).
  2130*    -------------------------------
  2131     05  CHGBK8L PIC S9(0004) COMP.
  2132     05  CHGBK8F PIC  X(0001).
  2133     05  FILLER REDEFINES CHGBK8F.
  2134         10  CHGBK8A PIC  X(0001).
  2135     05  CHGBK8I PIC  X(0002).
  2136*    -------------------------------
  2137     05  GLCDE8L PIC S9(0004) COMP.
  2138     05  GLCDE8F PIC  X(0001).
  2139     05  FILLER REDEFINES GLCDE8F.
  2140         10  GLCDE8A PIC  X(0001).
  2141     05  GLCDE8I PIC  X(0001).
  2142*    -------------------------------
  2143     05  AGNT9L PIC S9(0004) COMP.
  2144     05  AGNT9F PIC  X(0001).
  2145     05  FILLER REDEFINES AGNT9F.
  2146         10  AGNT9A PIC  X(0001).
  2147     05  AGNT9I PIC  X(0010).
  2148*    -------------------------------
  2149     05  TYPE9L PIC S9(0004) COMP.
  2150     05  TYPE9F PIC  X(0001).
  2151     05  FILLER REDEFINES TYPE9F.
  2152         10  TYPE9A PIC  X(0001).
  2153     05  TYPE9I PIC  X(0001).
  2154*    -------------------------------
  2155     05  SINRT9L PIC S9(0004) COMP.
  2156     05  SINRT9F PIC  X(0001).
  2157     05  FILLER REDEFINES SINRT9F.
  2158         10  SINRT9A PIC  X(0001).
  2159     05  SINRT9I PIC  X(0006).
  2160*    -------------------------------
  2161     05  JNTRT9L PIC S9(0004) COMP.
  2162     05  JNTRT9F PIC  X(0001).
  2163     05  FILLER REDEFINES JNTRT9F.
  2164         10  JNTRT9A PIC  X(0001).
  2165     05  JNTRT9I PIC  X(0006).
  2166*    -------------------------------
  2167     05  AHRT9L PIC S9(0004) COMP.
  2168     05  AHRT9F PIC  X(0001).
  2169     05  FILLER REDEFINES AHRT9F.
  2170         10  AHRT9A PIC  X(0001).
  2171     05  AHRT9I PIC  X(0006).
  2172*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  44
* EL6501.cbl
  2173     05  RECAL9L PIC S9(0004) COMP.
  2174     05  RECAL9F PIC  X(0001).
  2175     05  FILLER REDEFINES RECAL9F.
  2176         10  RECAL9A PIC  X(0001).
  2177     05  RECAL9I PIC  X(0001).
  2178*    -------------------------------
  2179     05  COMM9L PIC S9(0004) COMP.
  2180     05  COMM9F PIC  X(0001).
  2181     05  FILLER REDEFINES COMM9F.
  2182         10  COMM9A PIC  X(0001).
  2183     05  COMM9I PIC  X(0001).
  2184*    -------------------------------
  2185     05  CHGBK9L PIC S9(0004) COMP.
  2186     05  CHGBK9F PIC  X(0001).
  2187     05  FILLER REDEFINES CHGBK9F.
  2188         10  CHGBK9A PIC  X(0001).
  2189     05  CHGBK9I PIC  X(0002).
  2190*    -------------------------------
  2191     05  GLCDE9L PIC S9(0004) COMP.
  2192     05  GLCDE9F PIC  X(0001).
  2193     05  FILLER REDEFINES GLCDE9F.
  2194         10  GLCDE9A PIC  X(0001).
  2195     05  GLCDE9I PIC  X(0001).
  2196*    -------------------------------
  2197     05  AGNT10L PIC S9(0004) COMP.
  2198     05  AGNT10F PIC  X(0001).
  2199     05  FILLER REDEFINES AGNT10F.
  2200         10  AGNT10A PIC  X(0001).
  2201     05  AGNT10I PIC  X(0010).
  2202*    -------------------------------
  2203     05  TYPE10L PIC S9(0004) COMP.
  2204     05  TYPE10F PIC  X(0001).
  2205     05  FILLER REDEFINES TYPE10F.
  2206         10  TYPE10A PIC  X(0001).
  2207     05  TYPE10I PIC  X(0001).
  2208*    -------------------------------
  2209     05  SINRT10L PIC S9(0004) COMP.
  2210     05  SINRT10F PIC  X(0001).
  2211     05  FILLER REDEFINES SINRT10F.
  2212         10  SINRT10A PIC  X(0001).
  2213     05  SINRT10I PIC  X(0006).
  2214*    -------------------------------
  2215     05  JNTRT10L PIC S9(0004) COMP.
  2216     05  JNTRT10F PIC  X(0001).
  2217     05  FILLER REDEFINES JNTRT10F.
  2218         10  JNTRT10A PIC  X(0001).
  2219     05  JNTRT10I PIC  X(0006).
  2220*    -------------------------------
  2221     05  AHRT10L PIC S9(0004) COMP.
  2222     05  AHRT10F PIC  X(0001).
  2223     05  FILLER REDEFINES AHRT10F.
  2224         10  AHRT10A PIC  X(0001).
  2225     05  AHRT10I PIC  X(0006).
  2226*    -------------------------------
  2227     05  RECAL10L PIC S9(0004) COMP.
  2228     05  RECAL10F PIC  X(0001).
  2229     05  FILLER REDEFINES RECAL10F.
  2230         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  45
* EL6501.cbl
  2231     05  RECAL10I PIC  X(0001).
  2232*    -------------------------------
  2233     05  COMM10L PIC S9(0004) COMP.
  2234     05  COMM10F PIC  X(0001).
  2235     05  FILLER REDEFINES COMM10F.
  2236         10  COMM10A PIC  X(0001).
  2237     05  COMM10I PIC  X(0001).
  2238*    -------------------------------
  2239     05  CHGBK10L PIC S9(0004) COMP.
  2240     05  CHGBK10F PIC  X(0001).
  2241     05  FILLER REDEFINES CHGBK10F.
  2242         10  CHGBK10A PIC  X(0001).
  2243     05  CHGBK10I PIC  X(0002).
  2244*    -------------------------------
  2245     05  GLCDE10L PIC S9(0004) COMP.
  2246     05  GLCDE10F PIC  X(0001).
  2247     05  FILLER REDEFINES GLCDE10F.
  2248         10  GLCDE10A PIC  X(0001).
  2249     05  GLCDE10I PIC  X(0001).
  2250*    -------------------------------
  2251     05  ERRMSG1L PIC S9(0004) COMP.
  2252     05  ERRMSG1F PIC  X(0001).
  2253     05  FILLER REDEFINES ERRMSG1F.
  2254         10  ERRMSG1A PIC  X(0001).
  2255     05  ERRMSG1I PIC  X(0075).
  2256*    -------------------------------
  2257     05  PFENTERL PIC S9(0004) COMP.
  2258     05  PFENTERF PIC  X(0001).
  2259     05  FILLER REDEFINES PFENTERF.
  2260         10  PFENTERA PIC  X(0001).
  2261     05  PFENTERI PIC  9(2).
  2262*    -------------------------------
  2263     05  PF1PF2L PIC S9(0004) COMP.
  2264     05  PF1PF2F PIC  X(0001).
  2265     05  FILLER REDEFINES PF1PF2F.
  2266         10  PF1PF2A PIC  X(0001).
  2267     05  PF1PF2I PIC  X(0035).
  2268 01  EL6501AO REDEFINES EL6501AI.
  2269     05  FILLER            PIC  X(0012).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  DATEO PIC  X(0008).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  TIMEO PIC  99.99.
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  CMPNYIDO PIC  X(0003).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  USERIDO PIC  X(0004).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  MAINTO PIC  X(0001).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  CARRO PIC  X(0001).
  2288*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  46
* EL6501.cbl
  2289     05  FILLER            PIC  X(0003).
  2290     05  GROUPINO PIC  X(0006).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  STATEO PIC  X(0002).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  ACCOUNTO PIC  X(0010).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  EFFDTEO PIC  X(0008).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  EXPDTEO PIC  99B99B99.
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  MAINTBYO PIC  X(0004).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  PCONTO PIC  X(0030).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  CSRO PIC  X(0004).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  PDSPLYO PIC  X(0006).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  PEFFDTEO PIC  X(0008).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  PEXPDTEO PIC  X(0008).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  NAMEO PIC  X(0030).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  TAXNOO PIC  X(0011).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  STATUSO PIC  X(0001).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  INCAREO PIC  X(0030).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  PHONEO PIC  999B999B9999.
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  INDGRPO PIC  X(0001).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  ADDR1O PIC  X(0030).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  CONTRO PIC  X(0008).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  47
* EL6501.cbl
  2347     05  TYPEO PIC  X(0002).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  ACITYO PIC  X(0028).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  ASTATEO PIC  X(0002).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  PRODATEO PIC  X(0008).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  STDBENO PIC  X(0002).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  ZIPO PIC  X(0010).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  CTPLABLO PIC  X(0010).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  CLPTOLPO PIC  Z.9999.
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  RETROCDO PIC  X(0003).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  BILLCDO PIC  X(0003).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  LCLABLO PIC  X(0011).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  LCOMMO PIC  ZZ99.99-.
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  MAXFEEHO PIC  X(0013).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  MAXMFEEO PIC  Z,Z99.
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  CLPSTHO PIC  X(0010).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  CLPSTO PIC  X(0002).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  PRODCDHO PIC  X(0012).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  PRODCDO PIC  X(0003).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  REMITO PIC  X(0002).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  48
* EL6501.cbl
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  REINTABO PIC  X(0003).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  REINCALO PIC  X(0001).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  AHHEADO PIC  X(0006).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  AGNT1O PIC  X(0010).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  TYPE1O PIC  X(0001).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  SINRT1O PIC  X(0006).
  2423*    -------------------------------
  2424     05  FILLER            PIC  X(0003).
  2425     05  JNTRT1O PIC  X(0006).
  2426*    -------------------------------
  2427     05  FILLER            PIC  X(0003).
  2428     05  AHRT1O PIC  X(0006).
  2429*    -------------------------------
  2430     05  FILLER            PIC  X(0003).
  2431     05  RECAL1O PIC  X(0001).
  2432*    -------------------------------
  2433     05  FILLER            PIC  X(0003).
  2434     05  COMM1O PIC  X(0001).
  2435*    -------------------------------
  2436     05  FILLER            PIC  X(0003).
  2437     05  CHGBK1O PIC  X(0002).
  2438*    -------------------------------
  2439     05  FILLER            PIC  X(0003).
  2440     05  GLCDE1O PIC  X(0001).
  2441*    -------------------------------
  2442     05  FILLER            PIC  X(0003).
  2443     05  AGNT2O PIC  X(0010).
  2444*    -------------------------------
  2445     05  FILLER            PIC  X(0003).
  2446     05  TYPE2O PIC  X(0001).
  2447*    -------------------------------
  2448     05  FILLER            PIC  X(0003).
  2449     05  SINRT2O PIC  X(0006).
  2450*    -------------------------------
  2451     05  FILLER            PIC  X(0003).
  2452     05  JNTRT2O PIC  X(0006).
  2453*    -------------------------------
  2454     05  FILLER            PIC  X(0003).
  2455     05  AHRT2O PIC  X(0006).
  2456*    -------------------------------
  2457     05  FILLER            PIC  X(0003).
  2458     05  RECAL2O PIC  X(0001).
  2459*    -------------------------------
  2460     05  FILLER            PIC  X(0003).
  2461     05  COMM2O PIC  X(0001).
  2462*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  49
* EL6501.cbl
  2463     05  FILLER            PIC  X(0003).
  2464     05  CHGBK2O PIC  X(0002).
  2465*    -------------------------------
  2466     05  FILLER            PIC  X(0003).
  2467     05  GLCDE2O PIC  X(0001).
  2468*    -------------------------------
  2469     05  FILLER            PIC  X(0003).
  2470     05  AGNT3O PIC  X(0010).
  2471*    -------------------------------
  2472     05  FILLER            PIC  X(0003).
  2473     05  TYPE3O PIC  X(0001).
  2474*    -------------------------------
  2475     05  FILLER            PIC  X(0003).
  2476     05  SINRT3O PIC  X(0006).
  2477*    -------------------------------
  2478     05  FILLER            PIC  X(0003).
  2479     05  JNTRT3O PIC  X(0006).
  2480*    -------------------------------
  2481     05  FILLER            PIC  X(0003).
  2482     05  AHRT3O PIC  X(0006).
  2483*    -------------------------------
  2484     05  FILLER            PIC  X(0003).
  2485     05  RECAL3O PIC  X(0001).
  2486*    -------------------------------
  2487     05  FILLER            PIC  X(0003).
  2488     05  COMM3O PIC  X(0001).
  2489*    -------------------------------
  2490     05  FILLER            PIC  X(0003).
  2491     05  CHGBK3O PIC  X(0002).
  2492*    -------------------------------
  2493     05  FILLER            PIC  X(0003).
  2494     05  GLCDE3O PIC  X(0001).
  2495*    -------------------------------
  2496     05  FILLER            PIC  X(0003).
  2497     05  AGNT4O PIC  X(0010).
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  TYPE4O PIC  X(0001).
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  SINRT4O PIC  X(0006).
  2504*    -------------------------------
  2505     05  FILLER            PIC  X(0003).
  2506     05  JNTRT4O PIC  X(0006).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  AHRT4O PIC  X(0006).
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  RECAL4O PIC  X(0001).
  2513*    -------------------------------
  2514     05  FILLER            PIC  X(0003).
  2515     05  COMM4O PIC  X(0001).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  CHGBK4O PIC  X(0002).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  50
* EL6501.cbl
  2521     05  GLCDE4O PIC  X(0001).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
  2524     05  AGNT5O PIC  X(0010).
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  TYPE5O PIC  X(0001).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  SINRT5O PIC  X(0006).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  JNTRT5O PIC  X(0006).
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  AHRT5O PIC  X(0006).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  RECAL5O PIC  X(0001).
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  COMM5O PIC  X(0001).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  CHGBK5O PIC  X(0002).
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  GLCDE5O PIC  X(0001).
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  AGNT6O PIC  X(0010).
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  TYPE6O PIC  X(0001).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  SINRT6O PIC  X(0006).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  JNTRT6O PIC  X(0006).
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
  2563     05  AHRT6O PIC  X(0006).
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  RECAL6O PIC  X(0001).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  COMM6O PIC  X(0001).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
  2572     05  CHGBK6O PIC  X(0002).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  GLCDE6O PIC  X(0001).
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  51
* EL6501.cbl
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  TYPE7O PIC  X(0001).
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  SINRT7O PIC  X(0006).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  JNTRT7O PIC  X(0006).
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  AHRT7O PIC  X(0006).
  2591*    -------------------------------
  2592     05  FILLER            PIC  X(0003).
  2593     05  RECAL7O PIC  X(0001).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  COMM7O PIC  X(0001).
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  CHGBK7O PIC  X(0002).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  GLCDE7O PIC  X(0001).
  2603*    -------------------------------
  2604     05  FILLER            PIC  X(0003).
  2605     05  AGNT8O PIC  X(0010).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  TYPE8O PIC  X(0001).
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  SINRT8O PIC  X(0006).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  JNTRT8O PIC  X(0006).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  AHRT8O PIC  X(0006).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  RECAL8O PIC  X(0001).
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  COMM8O PIC  X(0001).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  CHGBK8O PIC  X(0002).
  2627*    -------------------------------
  2628     05  FILLER            PIC  X(0003).
  2629     05  GLCDE8O PIC  X(0001).
  2630*    -------------------------------
  2631     05  FILLER            PIC  X(0003).
  2632     05  AGNT9O PIC  X(0010).
  2633*    -------------------------------
  2634     05  FILLER            PIC  X(0003).
  2635     05  TYPE9O PIC  X(0001).
  2636*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  52
* EL6501.cbl
  2637     05  FILLER            PIC  X(0003).
  2638     05  SINRT9O PIC  X(0006).
  2639*    -------------------------------
  2640     05  FILLER            PIC  X(0003).
  2641     05  JNTRT9O PIC  X(0006).
  2642*    -------------------------------
  2643     05  FILLER            PIC  X(0003).
  2644     05  AHRT9O PIC  X(0006).
  2645*    -------------------------------
  2646     05  FILLER            PIC  X(0003).
  2647     05  RECAL9O PIC  X(0001).
  2648*    -------------------------------
  2649     05  FILLER            PIC  X(0003).
  2650     05  COMM9O PIC  X(0001).
  2651*    -------------------------------
  2652     05  FILLER            PIC  X(0003).
  2653     05  CHGBK9O PIC  X(0002).
  2654*    -------------------------------
  2655     05  FILLER            PIC  X(0003).
  2656     05  GLCDE9O PIC  X(0001).
  2657*    -------------------------------
  2658     05  FILLER            PIC  X(0003).
  2659     05  AGNT10O PIC  X(0010).
  2660*    -------------------------------
  2661     05  FILLER            PIC  X(0003).
  2662     05  TYPE10O PIC  X(0001).
  2663*    -------------------------------
  2664     05  FILLER            PIC  X(0003).
  2665     05  SINRT10O PIC  X(0006).
  2666*    -------------------------------
  2667     05  FILLER            PIC  X(0003).
  2668     05  JNTRT10O PIC  X(0006).
  2669*    -------------------------------
  2670     05  FILLER            PIC  X(0003).
  2671     05  AHRT10O PIC  X(0006).
  2672*    -------------------------------
  2673     05  FILLER            PIC  X(0003).
  2674     05  RECAL10O PIC  X(0001).
  2675*    -------------------------------
  2676     05  FILLER            PIC  X(0003).
  2677     05  COMM10O PIC  X(0001).
  2678*    -------------------------------
  2679     05  FILLER            PIC  X(0003).
  2680     05  CHGBK10O PIC  X(0002).
  2681*    -------------------------------
  2682     05  FILLER            PIC  X(0003).
  2683     05  GLCDE10O PIC  X(0001).
  2684*    -------------------------------
  2685     05  FILLER            PIC  X(0003).
  2686     05  ERRMSG1O PIC  X(0075).
  2687*    -------------------------------
  2688     05  FILLER            PIC  X(0003).
  2689     05  PFENTERO PIC  X(0002).
  2690*    -------------------------------
  2691     05  FILLER            PIC  X(0003).
  2692     05  PF1PF2O PIC  X(0035).
  2693*    -------------------------------
  2694 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  53
* EL6501.cbl
  2695*    12  FILLER                  PIC X(518).
  2696*    12  FILLER                  PIC X(543).
  2697     12  FILLER                  PIC X(546).
  2698     12  MAP-AGENT-AREA.
  2699         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2700             20  AGENTL          PIC S9(4) COMP.
  2701             20  AGENTA          PIC X.
  2702             20  AGENT           PIC X(10).
  2703             20  ATYPEL          PIC S9(4) COMP.
  2704             20  ATYPEA          PIC X.
  2705             20  ATYPE           PIC X.
  2706             20  SINGLEL         PIC S9(4) COMP.
  2707             20  SINGLEA         PIC X.
  2708             20  SINGLE-COMM-T   PIC X(6).
  2709             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2710                 24  SINGLE-COMM-R PIC V9(5).
  2711                 24  SINGLE-DASH   PIC X.
  2712             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2713                                 PIC V9(5)-.
  2714             20  JOINTL          PIC S9(4) COMP.
  2715             20  JOINTA          PIC X.
  2716             20  JOINT-COMM-T    PIC X(6).
  2717             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2718                 24  JOINT-COMM-R PIC V9(5).
  2719                 24  JOINT-DASH   PIC X.
  2720             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2721                                 PIC V9(5)-.
  2722             20  A-HL            PIC S9(4) COMP.
  2723             20  A-HA            PIC X.
  2724             20  A-H-COMM-T      PIC X(6).
  2725             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2726                 24  A-H-COMM-R  PIC V9(5).
  2727                 24  A-H-DASH    PIC X.
  2728             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2729                                 PIC V9(5)-.
  2730             20  RECALL          PIC S9(4) COMP.
  2731             20  RECALA          PIC X.
  2732             20  RECAL           PIC X.
  2733             20  RCOMML          PIC S9(4) COMP.
  2734             20  RCOMMA          PIC X.
  2735             20  RCOMM           PIC X.
  2736             20  CHGBCKL         PIC S9(4) COMP.
  2737             20  CHGBCKA         PIC X.
  2738             20  CHGBCK          PIC X(02).
  2739             20  GLCODEL         PIC S9(4) COMP.
  2740             20  GLCODEA         PIC X.
  2741             20  GLCODE          PIC X.
  2742****************************************************************
  2743*
  2744* Copyright (c) 2007 by Clerity Solutions, Inc.
  2745* All rights reserved.
  2746*
  2747****************************************************************
  2748 01  DFHEIV.
  2749   02  DFHEIV0               PIC X(35).
  2750   02  DFHEIV1               PIC X(08).
  2751   02  DFHEIV2               PIC X(08).
  2752   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  54
* EL6501.cbl
  2753   02  DFHEIV4               PIC X(06).
  2754   02  DFHEIV5               PIC X(04).
  2755   02  DFHEIV6               PIC X(04).
  2756   02  DFHEIV7               PIC X(02).
  2757   02  DFHEIV8               PIC X(02).
  2758   02  DFHEIV9               PIC X(01).
  2759   02  DFHEIV10              PIC S9(7) COMP-3.
  2760   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2761   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2762   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2763   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2764   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2765   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2766   02  DFHEIV17              PIC X(04).
  2767   02  DFHEIV18              PIC X(04).
  2768   02  DFHEIV19              PIC X(04).
  2769   02  DFHEIV20              USAGE IS POINTER.
  2770   02  DFHEIV21              USAGE IS POINTER.
  2771   02  DFHEIV22              USAGE IS POINTER.
  2772   02  DFHEIV23              USAGE IS POINTER.
  2773   02  DFHEIV24              USAGE IS POINTER.
  2774   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2775   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2776   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2777   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2778   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2779   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2780   02  FILLER                PIC X(02).
  2781   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2782   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2783   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2784   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2785   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2786 LINKAGE  SECTION.
  2787*****************************************************************
  2788*                                                               *
  2789* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2790* All rights reserved.                                          *
  2791*                                                               *
  2792*****************************************************************
  2793 01  dfheiblk.
  2794     02  eibtime          pic s9(7) comp-3.
  2795     02  eibdate          pic s9(7) comp-3.
  2796     02  eibtrnid         pic x(4).
  2797     02  eibtaskn         pic s9(7) comp-3.
  2798     02  eibtrmid         pic x(4).
  2799     02  dfheigdi         pic s9(4) comp.
  2800     02  eibcposn         pic s9(4) comp.
  2801     02  eibcalen         pic s9(4) comp.
  2802     02  eibaid           pic x(1).
  2803     02  eibfiller1       pic x(1).
  2804     02  eibfn            pic x(2).
  2805     02  eibfiller2       pic x(2).
  2806     02  eibrcode         pic x(6).
  2807     02  eibfiller3       pic x(2).
  2808     02  eibds            pic x(8).
  2809     02  eibreqid         pic x(8).
  2810     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  55
* EL6501.cbl
  2811     02  eibsync          pic x(1).
  2812     02  eibfree          pic x(1).
  2813     02  eibrecv          pic x(1).
  2814     02  eibsend          pic x(1).
  2815     02  eibatt           pic x(1).
  2816     02  eibeoc           pic x(1).
  2817     02  eibfmh           pic x(1).
  2818     02  eibcompl         pic x(1).
  2819     02  eibsig           pic x(1).
  2820     02  eibconf          pic x(1).
  2821     02  eiberr           pic x(1).
  2822     02  eibrldbk         pic x(1).
  2823     02  eiberrcd         pic x(4).
  2824     02  eibsynrb         pic x(1).
  2825     02  eibnodat         pic x(1).
  2826     02  eibfiller5       pic x(2).
  2827     02  eibresp          pic 9(09) comp.
  2828     02  eibresp2         pic 9(09) comp.
  2829     02  dfheigdj         pic s9(4) comp.
  2830     02  dfheigdk         pic s9(4) comp.
  2831 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  56
* EL6501.cbl
  2833*01 PARMLIST .
  2834*    02  FILLER                  PIC S9(8)   COMP.
  2835*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2836*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2837*    02  REIN-POINTER            PIC S9(8)   COMP.
  2838*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2839*    02  COMM-POINTER            PIC S9(8)   COMP.
  2840*    02  COMP-POINTER            PIC S9(8)   COMP.
  2841*    02  NAME-POINTER            PIC S9(8)   COMP.
  2842*    02  RQST-POINTER            PIC S9(8)   COMP.
  2843*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2844*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2845*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2846*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2847*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2848*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2849*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2850*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2851*    COPY ERCACCT.
  2852******************************************************************
  2853*                                                                *
  2854*                                                                *
  2855*                            ERCACCT                             *
  2856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2857*                            VMOD=2.031                          *
  2858*                                                                *
  2859*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2860*                                                                *
  2861*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2862*   VSAM ACCOUNT MASTER FILES.                                   *
  2863*                                                                *
  2864*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2865*                                                                *
  2866*   FILE TYPE = VSAM,KSDS                                        *
  2867*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2868*                                                                *
  2869*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2870*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2871*                                                                *
  2872*   LOG = NO                                                     *
  2873*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2874*                                                                *
  2875*                                                                *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2885* 092705    2005050300006  PEMA  ADD SPP LEASES
  2886* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2887* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2888* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2889* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2890* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  57
* EL6501.cbl
  2891******************************************************************
  2892
  2893 01  ACCOUNT-MASTER.
  2894     12  AM-RECORD-ID                      PIC XX.
  2895         88  VALID-AM-ID                      VALUE 'AM'.
  2896
  2897     12  AM-CONTROL-PRIMARY.
  2898         16  AM-COMPANY-CD                 PIC X.
  2899         16  AM-MSTR-CNTRL.
  2900             20  AM-CONTROL-A.
  2901                 24  AM-CARRIER            PIC X.
  2902                 24  AM-GROUPING.
  2903                     28 AM-GROUPING-PREFIX PIC XXX.
  2904                     28 AM-GROUPING-PRIME  PIC XXX.
  2905                 24  AM-STATE              PIC XX.
  2906                 24  AM-ACCOUNT.
  2907                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2908                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2909             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2910                                           PIC X(19).
  2911             20  AM-CNTRL-B.
  2912                 24  AM-EXPIRATION-DT      PIC XX.
  2913                 24  FILLER                PIC X(4).
  2914             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2915                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2916
  2917     12  AM-CONTROL-BY-VAR-GRP.
  2918         16  AM-COMPANY-CD-A1              PIC X.
  2919         16  AM-VG-CARRIER                 PIC X.
  2920         16  AM-VG-GROUPING                PIC X(6).
  2921         16  AM-VG-STATE                   PIC XX.
  2922         16  AM-VG-ACCOUNT                 PIC X(10).
  2923         16  AM-VG-DATE.
  2924             20  AM-VG-EXPIRATION-DT       PIC XX.
  2925             20  FILLER                    PIC X(4).
  2926         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2927                                           PIC 9(11)      COMP-3.
  2928     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2929         16  FILLER                        PIC X(10).
  2930         16  AM-VG-KEY3.
  2931             20  AM-VG3-ACCOUNT            PIC X(10).
  2932             20  AM-VG3-EXP-DT             PIC XX.
  2933         16  FILLER                        PIC X(4).
  2934     12  AM-MAINT-INFORMATION.
  2935         16  AM-LAST-MAINT-DT              PIC XX.
  2936         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2937         16  AM-LAST-MAINT-USER            PIC X(4).
  2938         16  FILLER                        PIC XX.
  2939
  2940     12  AM-EFFECTIVE-DT                   PIC XX.
  2941     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2942
  2943     12  AM-PREV-DATES  COMP-3.
  2944         16  AM-PREV-EXP-DT                PIC 9(11).
  2945         16  AM-PREV-EFF-DT                PIC 9(11).
  2946
  2947     12  AM-REPORT-CODE-1                  PIC X(10).
  2948     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  58
* EL6501.cbl
  2949
  2950     12  AM-CITY-CODE                      PIC X(4).
  2951     12  AM-COUNTY-PARISH                  PIC X(6).
  2952
  2953     12  AM-NAME                           PIC X(30).
  2954     12  AM-PERSON                         PIC X(30).
  2955     12  AM-ADDRS                          PIC X(30).
  2956     12  AM-CITY.
  2957         16  AM-ADDR-CITY                  PIC X(28).
  2958         16  AM-ADDR-STATE                 PIC XX.
  2959     12  AM-ZIP.
  2960         16  AM-ZIP-PRIME.
  2961             20  AM-ZIP-PRI-1ST            PIC X.
  2962                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2963             20  FILLER                    PIC X(4).
  2964         16  AM-ZIP-PLUS4                  PIC X(4).
  2965     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2966         16  AM-CAN-POSTAL-1               PIC XXX.
  2967         16  AM-CAN-POSTAL-2               PIC XXX.
  2968         16  FILLER                        PIC XXX.
  2969     12  AM-TEL-NO.
  2970         16  AM-AREA-CODE                  PIC 999.
  2971         16  AM-TEL-PRE                    PIC 999.
  2972         16  AM-TEL-NBR                    PIC 9(4).
  2973     12  AM-TEL-LOC                        PIC X.
  2974         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2975         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2976
  2977     12  AM-COMM-STRUCTURE.
  2978         16  AM-DEFN-1.
  2979             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2980                 24  AM-AGT.
  2981                     28  AM-AGT-PREFIX     PIC X(4).
  2982                     28  AM-AGT-PRIME      PIC X(6).
  2983                 24  AM-COM-TYP            PIC X.
  2984                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2985                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2986                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2987                 24  AM-RECALC-LV-INDIC    PIC X.
  2988                 24  AM-RETRO-LV-INDIC     PIC X.
  2989                 24  AM-GL-CODES           PIC X.
  2990                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2991                 24  FILLER                PIC X(01).
  2992         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2993             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2994                 24  FILLER                PIC X(11).
  2995                 24  AM-L-COMA             PIC XXX.
  2996                 24  AM-J-COMA             PIC XXX.
  2997                 24  AM-A-COMA             PIC XXX.
  2998                 24  FILLER                PIC X(6).
  2999
  3000     12  AM-COMM-CHANGE-STATUS             PIC X.
  3001         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3002
  3003     12  AM-CSR-CODE                       PIC X(4).
  3004
  3005     12  AM-BILLING-STATUS                 PIC X.
  3006         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  59
* EL6501.cbl
  3007         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3008     12  AM-AUTO-REFUND-SW                 PIC X.
  3009         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3010         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3011     12  AM-GPCD                           PIC 99.
  3012     12  AM-IG                             PIC X.
  3013         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3014         88  AM-HAS-GROUP                     VALUE '2'.
  3015     12  AM-STATUS                         PIC X.
  3016         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3017         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3018         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3019         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3020         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3021         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3022     12  AM-REMIT-TO                       PIC 99.
  3023     12  AM-ID-NO                          PIC X(11).
  3024
  3025     12  AM-CAL-TABLE                      PIC XX.
  3026     12  AM-LF-DEVIATION                   PIC XXX.
  3027     12  AM-AH-DEVIATION                   PIC XXX.
  3028     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3029     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3030     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3031     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3032     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3033     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3034
  3035     12  AM-USER-FIELDS.
  3036         16  AM-FLD-1                      PIC XX.
  3037         16  AM-FLD-2                      PIC XX.
  3038         16  AM-FLD-3                      PIC XX.
  3039         16  AM-FLD-4                      PIC XX.
  3040         16  AM-FLD-5                      PIC XX.
  3041
  3042     12  AM-1ST-PROD-DATE.
  3043         16  AM-1ST-PROD-YR                PIC XX.
  3044         16  AM-1ST-PROD-MO                PIC XX.
  3045         16  AM-1ST-PROD-DA                PIC XX.
  3046     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3047     12  AM-CERTS-PURGED-DATE.
  3048         16  AM-PUR-YR                     PIC XX.
  3049         16  AM-PUR-MO                     PIC XX.
  3050         16  AM-PUR-DA                     PIC XX.
  3051     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3052     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3053     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3054     12  AM-INACTIVE-DATE.
  3055         16  AM-INA-MO                     PIC 99.
  3056         16  AM-INA-DA                     PIC 99.
  3057         16  AM-INA-YR                     PIC 99.
  3058     12  AM-AR-HI-CERT-DATE                PIC XX.
  3059
  3060     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3061     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3062
  3063     12  AM-OB-PAYMENT-MODE                PIC X.
  3064         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  60
* EL6501.cbl
  3065         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3066         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3067         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3068
  3069     12  AM-AH-ONLY-INDICATOR              PIC X.
  3070         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3071         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3072
  3073     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3074
  3075     12  AM-OVER-SHORT.
  3076         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3077         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3078
  3079     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3080     12  AM-DCC-CLP-STATE                  PIC XX.
  3081
  3082     12  AM-RECALC-COMM                    PIC X.
  3083     12  AM-RECALC-REIN                    PIC X.
  3084
  3085     12  AM-REI-TABLE                      PIC XXX.
  3086     12  AM-REI-ET-LF                      PIC X.
  3087     12  AM-REI-ET-AH                      PIC X.
  3088     12  AM-REI-PE-LF                      PIC X.
  3089     12  AM-REI-PE-AH                      PIC X.
  3090     12  AM-REI-PRT-ST                     PIC X.
  3091     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3092     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3093     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3094     12  AM-REI-GROUP-A                    PIC X(6).
  3095     12  AM-REI-MORT                       PIC X(4).
  3096     12  AM-REI-PRT-OW                     PIC X.
  3097     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3098     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3099     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3100     12  AM-REI-GROUP-B                    PIC X(6).
  3101
  3102     12  AM-TRUST-TYPE                     PIC X(2).
  3103
  3104     12  AM-EMPLOYER-STMT-USED             PIC X.
  3105     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3106
  3107     12  AM-STD-AH-TYPE                    PIC XX.
  3108     12  AM-EARN-METHODS.
  3109         16  AM-EARN-METHOD-R              PIC X.
  3110             88 AM-REF-RL-R78                 VALUE 'R'.
  3111             88 AM-REF-RL-PR                  VALUE 'P'.
  3112             88 AM-REF-RL-MEAN                VALUE 'M'.
  3113             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3114         16  AM-EARN-METHOD-L              PIC X.
  3115             88 AM-REF-LL-R78                 VALUE 'R'.
  3116             88 AM-REF-LL-PR                  VALUE 'P'.
  3117             88 AM-REF-LL-MEAN                VALUE 'M'.
  3118             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3119         16  AM-EARN-METHOD-A              PIC X.
  3120             88 AM-REF-AH-R78                 VALUE 'R'.
  3121             88 AM-REF-AH-PR                  VALUE 'P'.
  3122             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  61
* EL6501.cbl
  3123             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3124             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3125             88 AM-REF-AH-NET                 VALUE 'N'.
  3126
  3127     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3128     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3129     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3130
  3131     12  AM-RET-Y-N                        PIC X.
  3132     12  AM-RET-P-E                        PIC X.
  3133     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3134     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3135     12  AM-RET-GRP                        PIC X(6).
  3136     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3137         16  AM-POOL-PRIME                 PIC XXX.
  3138         16  AM-POOL-SUB                   PIC XXX.
  3139     12  AM-RETRO-EARNINGS.
  3140         16  AM-RET-EARN-R                 PIC X.
  3141         16  AM-RET-EARN-L                 PIC X.
  3142         16  AM-RET-EARN-A                 PIC X.
  3143     12  AM-RET-ST-TAX-USE                 PIC X.
  3144         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3145         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3146     12  AM-RETRO-BEG-EARNINGS.
  3147         16  AM-RET-BEG-EARN-R             PIC X.
  3148         16  AM-RET-BEG-EARN-L             PIC X.
  3149         16  AM-RET-BEG-EARN-A             PIC X.
  3150     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3151     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3152
  3153     12  AM-USER-SELECT-OPTIONS.
  3154         16  AM-USER-SELECT-1              PIC X(10).
  3155         16  AM-USER-SELECT-2              PIC X(10).
  3156         16  AM-USER-SELECT-3              PIC X(10).
  3157         16  AM-USER-SELECT-4              PIC X(10).
  3158         16  AM-USER-SELECT-5              PIC X(10).
  3159
  3160     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3161
  3162     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3163
  3164     12  AM-RPT045A-SWITCH                 PIC X.
  3165         88  RPT045A-OFF                   VALUE 'N'.
  3166
  3167     12  AM-INSURANCE-LIMITS.
  3168         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3169         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3170
  3171     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3172         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3173
  3174     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3175         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3176         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3177
  3178     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3179
  3180     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  62
* EL6501.cbl
  3181     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3182     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3183     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3184     12  AM-DCC-UEF-STATE                  PIC XX.
  3185     12  FILLER                            PIC XXX.
  3186     12  AM-REPORT-CODE-3                  PIC X(10).
  3187*    12  FILLER                            PIC X(22).
  3188
  3189     12  AM-RESERVE-DATE.
  3190         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3191         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3192         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3193
  3194     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3195     12  AM-NOTIFICATION-TYPES.
  3196         16  AM-NOTIF-OF-LETTERS           PIC X.
  3197         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3198         16  AM-NOTIF-OF-REPORTS           PIC X.
  3199         16  AM-NOTIF-OF-STATUS            PIC X.
  3200
  3201     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3202         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3203         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3204         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3205         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3206
  3207     12  AM-BENEFIT-CONTROLS.
  3208         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3209             20  AM-BENEFIT-CODE           PIC XX.
  3210             20  AM-BENEFIT-TYPE           PIC X.
  3211             20  AM-BENEFIT-REVISION       PIC XXX.
  3212             20  AM-BENEFIT-REM-TERM       PIC X.
  3213             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3214             20  FILLER                    PIC XX.
  3215         16  FILLER                        PIC X(80).
  3216
  3217     12  AM-TRANSFER-DATA.
  3218         16  AM-TRANSFERRED-FROM.
  3219             20  AM-TRNFROM-CARRIER        PIC X.
  3220             20  AM-TRNFROM-GROUPING.
  3221                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3222                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3223             20  AM-TRNFROM-STATE          PIC XX.
  3224             20  AM-TRNFROM-ACCOUNT.
  3225                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3226                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3227             20  AM-TRNFROM-DTE            PIC XX.
  3228         16  AM-TRANSFERRED-TO.
  3229             20  AM-TRNTO-CARRIER          PIC X.
  3230             20  AM-TRNTO-GROUPING.
  3231                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3232                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3233             20  AM-TRNTO-STATE            PIC XX.
  3234             20  AM-TRNTO-ACCOUNT.
  3235                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3236                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3237             20  AM-TRNTO-DTE              PIC XX.
  3238         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  63
* EL6501.cbl
  3239
  3240     12  AM-SAVED-REMIT-TO                 PIC 99.
  3241
  3242     12  AM-COMM-STRUCTURE-SAVED.
  3243         16  AM-DEFN-1-SAVED.
  3244             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3245                 24  AM-AGT-SV             PIC X(10).
  3246                 24  AM-COM-TYP-SV         PIC X.
  3247                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3248                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3249                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3250                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3251                 24  FILLER                PIC X.
  3252                 24  AM-GL-CODES-SV        PIC X.
  3253                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3254                 24  FILLER                PIC X.
  3255         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3256             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3257                 24  FILLER                PIC X(11).
  3258                 24  AM-L-COMA-SV          PIC XXX.
  3259                 24  AM-J-COMA-SV          PIC XXX.
  3260                 24  AM-A-COMA-SV          PIC XXX.
  3261                 24  FILLER                PIC X(6).
  3262
  3263     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3264         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3265            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3266            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3267            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3268
  3269     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3270     12  FILLER                            PIC X(120).
  3271
  3272     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3273         16  AM-CONTROL-NAME               PIC X(30).
  3274         16  AM-EXECUTIVE-ONE.
  3275             20  AM-EXEC1-NAME             PIC X(15).
  3276             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3277                                                          COMP-3.
  3278             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3279                                                          COMP-3.
  3280         16  AM-EXECUTIVE-TWO.
  3281             20  AM-EXEC2-NAME             PIC X(15).
  3282             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3283                                                          COMP-3.
  3284             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3285                                                          COMP-3.
  3286
  3287     12  AM-RETRO-ADDITIONAL-DATA.
  3288         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3289         16  AM-RETRO-PREM-P-E             PIC X.
  3290         16  AM-RETRO-CLMS-P-I             PIC X.
  3291         16  AM-RETRO-RET-BRACKET-LF.
  3292             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3293                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3294                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3295             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3296                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  64
* EL6501.cbl
  3297                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3298             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3299                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3300                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3301         16  AM-RETRO-RET-BRACKET-AH.
  3302             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3303                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3304                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3305                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3306             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3307                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3308                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3309             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3310                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3311                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3312
  3313     12  AM-COMMENTS.
  3314         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3315
  3316     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3317         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3318         16  AM-FLI-BILLING-CODE           PIC X.
  3319         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3320         16  AM-FLI-UNITED-IDENT           PIC X.
  3321         16  AM-FLI-INTEREST-LOST-DATA.
  3322             20  AM-FLI-BANK-NO            PIC X(5).
  3323             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3324             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3325             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3326         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3327             20  AM-FLI-AGT                PIC X(9).
  3328             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3329             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3330         16  FILLER                        PIC X(102).
  3331
  3332     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3333         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3334             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3335             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3336             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3337             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3338             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3339         16  FILLER                          PIC X(10).
  3340******************************************************************
  3341*    copy ERCPDEF.
  3342******************************************************************
  3343*                                                                *
  3344*                                                                *
  3345*                            ERCPDEF.                            *
  3346*                                                                *
  3347*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3348*                                                                *
  3349*    FILE TYPE = VSAM,KSDS                                       *
  3350*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3351*                                                                *
  3352*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3353*                                                                *
  3354*    LOG = YES                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  65
* EL6501.cbl
  3355*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3356******************************************************************
  3357*                   C H A N G E   L O G
  3358*
  3359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3360*-----------------------------------------------------------------
  3361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3362* EFFECTIVE    NUMBER
  3363*-----------------------------------------------------------------
  3364* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3365******************************************************************
  3366 01  PRODUCT-MASTER.
  3367    12  PD-RECORD-ID                 PIC X(02).
  3368        88  VALID-PD-ID                  VALUE 'PD'.
  3369    12  PD-CONTROL-PRIMARY.
  3370        16  PD-COMPANY-CD            PIC X.
  3371        16  PD-STATE                 PIC XX.
  3372        16  PD-PRODUCT-CD            PIC XXX.
  3373        16  PD-FILLER                PIC X(7).
  3374        16  PD-BEN-TYPE              PIC X.
  3375        16  PD-BEN-CODE              PIC XX.
  3376        16  PD-PROD-EXP-DT           PIC XX.
  3377    12  FILLER                       PIC X(50).
  3378    12  PD-PRODUCT-DATA OCCURS 8.
  3379        16  PD-PROD-CODE             PIC X.
  3380            88  PD-PROD-LIFE           VALUE 'L'.
  3381            88  PD-PROD-PROP           VALUE 'P'.
  3382            88  PD-PROD-AH             VALUE 'A'.
  3383            88  PD-PROD-IU             VALUE 'I'.
  3384            88  PD-PROD-GAP            VALUE 'G'.
  3385            88  PD-PROD-FMLA           VALUE 'F'.
  3386        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3387        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3388        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3389        16  PD-MAX-TERM              PIC S999        COMP-3.
  3390        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3391        16  FILLER                   PIC X.
  3392        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3393        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3394        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3395        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3396        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3397        16  PD-REC-CRIT-PERIOD       PIC 99.
  3398        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3399            20  PD-RECURRING-YN      PIC X.
  3400            20  FILLER               PIC X.
  3401        16  PD-RTW-MOS               PIC 99.
  3402        16  PD-MAX-EXTENSION         PIC 99.
  3403        16  FILLER                   PIC XX.
  3404    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3405    12  PD-TERM-LIMITS OCCURS 15.
  3406        16  PD-LOW-TERM              PIC S999        COMP-3.
  3407        16  PD-HI-TERM               PIC S999        COMP-3.
  3408*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3409    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3410        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3411        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3412    12  PD-EARN-FACTORS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  66
* EL6501.cbl
  3413        16  FILLER OCCURS 15.
  3414            20  FILLER OCCURS 15.
  3415                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3416    12  PD-PRODUCT-DESC              PIC X(80).
  3417    12  PD-TRUNCATED                 PIC X.
  3418    12  FILLER                       PIC X(59).
  3419    12  PD-MAINT-INFORMATION.
  3420        16  PD-LAST-MAINT-DT         PIC X(02).
  3421        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3422        16  PD-LAST-MAINT-BY         PIC X(04).
  3423*    COPY ELCCNTL.
  3424******************************************************************
  3425*                                                                *
  3426*                                                                *
  3427*                            ELCCNTL.                            *
  3428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3429*                            VMOD=2.059                          *
  3430*                                                                *
  3431*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3432*                                                                *
  3433*   FILE TYPE = VSAM,KSDS                                        *
  3434*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3435*                                                                *
  3436*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3437*       ALTERNATE INDEX = NONE                                   *
  3438*                                                                *
  3439*   LOG = YES                                                    *
  3440*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3441******************************************************************
  3442*                   C H A N G E   L O G
  3443*
  3444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3445*-----------------------------------------------------------------
  3446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3447* EFFECTIVE    NUMBER
  3448*-----------------------------------------------------------------
  3449* 082503                   PEMA  ADD BENEFIT GROUP
  3450* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3451* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3452* 092705    2005050300006  PEMA  ADD SPP LEASES
  3453* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3454* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3455* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3456* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3457* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3458* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3459* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3460* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3461* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3462* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3463******************************************************************
  3464*
  3465 01  CONTROL-FILE.
  3466     12  CF-RECORD-ID                       PIC XX.
  3467         88  VALID-CF-ID                        VALUE 'CF'.
  3468
  3469     12  CF-CONTROL-PRIMARY.
  3470         16  CF-COMPANY-ID                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  67
* EL6501.cbl
  3471         16  CF-RECORD-TYPE                 PIC X.
  3472             88  CF-COMPANY-MASTER              VALUE '1'.
  3473             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3474             88  CF-STATE-MASTER                VALUE '3'.
  3475             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3476             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3477             88  CF-CARRIER-MASTER              VALUE '6'.
  3478             88  CF-MORTALITY-MASTER            VALUE '7'.
  3479             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3480             88  CF-TERMINAL-MASTER             VALUE '9'.
  3481             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3482             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3483             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3484             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3485             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3486             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3487             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3488             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3489             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3490         16  CF-ACCESS-CD-GENL              PIC X(4).
  3491         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3492             20  CF-PROCESSOR               PIC X(4).
  3493         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3494             20  CF-STATE-CODE              PIC XX.
  3495             20  FILLER                     PIC XX.
  3496         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3497             20  FILLER                     PIC XX.
  3498             20  CF-HI-BEN-IN-REC           PIC XX.
  3499         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3500             20  FILLER                     PIC XXX.
  3501             20  CF-CARRIER-CNTL            PIC X.
  3502         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3503             20  FILLER                     PIC XX.
  3504             20  CF-HI-TYPE-IN-REC          PIC 99.
  3505         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3506             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3507                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3508             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3509             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3510         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3511             20  FILLER                     PIC X.
  3512             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3513         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3514             20  FILLER                     PIC XX.
  3515             20  CF-MORTGAGE-PLAN           PIC XX.
  3516         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3517
  3518     12  CF-LAST-MAINT-DT                   PIC XX.
  3519     12  CF-LAST-MAINT-BY                   PIC X(4).
  3520     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3521
  3522     12  CF-RECORD-BODY                     PIC X(728).
  3523
  3524
  3525****************************************************************
  3526*             COMPANY MASTER RECORD                            *
  3527****************************************************************
  3528
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  68
* EL6501.cbl
  3529     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3530         16  CF-COMPANY-ADDRESS.
  3531             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3532             20  CF-CL-IN-CARE-OF           PIC X(30).
  3533             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3534             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3535             20  CF-CL-CITY-STATE           PIC X(30).
  3536             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3537             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3538         16  CF-COMPANY-CD                  PIC X.
  3539         16  CF-COMPANY-PASSWORD            PIC X(8).
  3540         16  CF-SECURITY-OPTION             PIC X.
  3541             88  ALL-SECURITY                   VALUE '1'.
  3542             88  COMPANY-VERIFY                 VALUE '2'.
  3543             88  PROCESSOR-VERIFY               VALUE '3'.
  3544             88  NO-SECURITY                    VALUE '4'.
  3545             88  ALL-BUT-TERM                   VALUE '5'.
  3546         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3547             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3548         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3549             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3550         16  CF-INFORCE-LOCATION            PIC X.
  3551             88  CERTS-ARE-ONLINE               VALUE '1'.
  3552             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3553             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3554         16  CF-LOWER-CASE-LETTERS          PIC X.
  3555         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3556             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3557             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3558             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3559             88  CF-ACCNT-CNTL                  VALUE '3'.
  3560             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3561
  3562         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3563         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3564
  3565         16  CF-LGX-CREDIT-USER             PIC X.
  3566             88  CO-IS-NOT-USER                 VALUE 'N'.
  3567             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3568
  3569         16 CF-CREDIT-CALC-CODES.
  3570             20  CF-CR-REM-TERM-CALC PIC X.
  3571               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3572               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3573               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3574               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3575               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3576               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3577               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3578             20  CF-CR-R78-METHOD           PIC X.
  3579               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3580               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3581
  3582         16  CF-CLAIM-CONTROL-COUNTS.
  3583             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3584                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3585
  3586             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  69
* EL6501.cbl
  3587                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3588
  3589             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3590                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3591
  3592             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3593                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3594
  3595         16  CF-CURRENT-MONTH-END           PIC XX.
  3596
  3597         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3598             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3599             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3600             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3601             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3602                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3603                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3604             20  CF-CO-PREM-REJECT-SW       PIC X.
  3605                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3606                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3607             20  CF-CO-REF-REJECT-SW        PIC X.
  3608                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3609                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3610
  3611         16  CF-CO-REPORTING-DT             PIC XX.
  3612         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3613         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3614           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3615           88  CF-CO-MONTH-END                  VALUE '1'.
  3616
  3617         16  CF-LGX-CLAIM-USER              PIC X.
  3618             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3619             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3620
  3621         16  CF-CREDIT-EDIT-CONTROLS.
  3622             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3623             20  CF-MIN-AGE                 PIC 99.
  3624             20  CF-DEFAULT-AGE             PIC 99.
  3625             20  CF-MIN-TERM                PIC S999      COMP-3.
  3626             20  CF-MAX-TERM                PIC S999      COMP-3.
  3627             20  CF-DEFAULT-SEX             PIC X.
  3628             20  CF-JOINT-AGE-INPUT         PIC X.
  3629                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3630             20  CF-BIRTH-DATE-INPUT        PIC X.
  3631                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3632             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3633                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3634                 88  CF-ZERO-CARRIER            VALUE '1'.
  3635                 88  CF-ZERO-GROUPING           VALUE '2'.
  3636                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3637             20  CF-EDIT-SW                 PIC X.
  3638                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3639             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3640             20  CF-CR-PR-METHOD            PIC X.
  3641               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3642               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3643             20  FILLER                     PIC X.
  3644
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  70
* EL6501.cbl
  3645         16  CF-CREDIT-MISC-CONTROLS.
  3646             20  CF-REIN-TABLE-SW           PIC X.
  3647                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3648             20  CF-COMP-TABLE-SW           PIC X.
  3649                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3650             20  CF-EXPERIENCE-RETENTION-AGE
  3651                                            PIC S9        COMP-3.
  3652             20  CF-CONVERSION-DT           PIC XX.
  3653             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3654             20  CF-RUN-FREQUENCY-SW        PIC X.
  3655                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3656                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3657
  3658             20  CF-CR-CHECK-NO-CONTROL.
  3659                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3660                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3661                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3662                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3663                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3664                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3665
  3666                 24  CF-CR-CHECK-COUNT       REDEFINES
  3667                     CF-CR-CHECK-COUNTER      PIC X(4).
  3668
  3669                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3670                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3671
  3672                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3673                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3674                 24  CF-MAIL-PROCESSING       PIC X.
  3675                     88  MAIL-PROCESSING          VALUE 'Y'.
  3676
  3677         16  CF-MISC-SYSTEM-CONTROL.
  3678             20  CF-SYSTEM-C                 PIC X.
  3679                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3680             20  CF-SYSTEM-D                 PIC X.
  3681                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3682             20  CF-SOC-SEC-NO-SW            PIC X.
  3683                 88  SOC-SEC-NO-USED             VALUE '1'.
  3684             20  CF-MEMBER-NO-SW             PIC X.
  3685                 88  MEMBER-NO-USED              VALUE '1'.
  3686             20  CF-TAX-ID-NUMBER            PIC X(11).
  3687             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3688             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3689                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3690                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3691                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3692                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3693             20  CF-SYSTEM-E                 PIC X.
  3694                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3695
  3696         16  CF-LGX-LIFE-USER               PIC X.
  3697             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3698             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3699
  3700         16  CF-CR-MONTH-END-DT             PIC XX.
  3701
  3702         16  CF-FILE-MAINT-DATES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  71
* EL6501.cbl
  3703             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3704                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3705             20  CF-LAST-BATCH       REDEFINES
  3706                 CF-LAST-BATCH-NO               PIC X(4).
  3707             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3708             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3709             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3710             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3711             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3712             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3713             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3714             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3715             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3716             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3717
  3718         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3719         16  FILLER                         PIC X.
  3720
  3721         16  CF-ALT-MORT-CODE               PIC X(4).
  3722         16  CF-MEMBER-CAPTION              PIC X(10).
  3723
  3724         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3725             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3726             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3727             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3728             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3729             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3730
  3731         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3732
  3733         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3734         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3735         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3736         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3737
  3738         16  CF-AH-OVERRIDE-L1              PIC X.
  3739         16  CF-AH-OVERRIDE-L2              PIC XX.
  3740         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3741         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3742
  3743         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3744         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3745
  3746         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3747         16  CF-AR-LAST-EL860-DT            PIC XX.
  3748         16  CF-MP-MONTH-END-DT             PIC XX.
  3749
  3750         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3751         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3752             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3753
  3754         16  CF-AR-MONTH-END-DT             PIC XX.
  3755
  3756         16  CF-CRDTCRD-USER                PIC X.
  3757             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3758             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3759
  3760         16  CF-CC-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  72
* EL6501.cbl
  3761
  3762         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3763
  3764         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3765             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3766             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3767             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3768         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3769         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3770         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3771         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3772             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3773             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3774         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3775         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3776         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3777             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3778         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3779
  3780         16  CF-CL-ZIP-CODE.
  3781             20  CF-CL-ZIP-PRIME.
  3782                 24  CF-CL-ZIP-1ST          PIC X.
  3783                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3784                 24  FILLER                 PIC X(4).
  3785             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3786         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3787             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3788             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3789             20  FILLER                     PIC XXX.
  3790
  3791         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3792         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3793         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3794         16  CF-CO-OPTION-START-DATE        PIC XX.
  3795         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3796           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3797                                                      '3' '4'.
  3798           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3799           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3800           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3801           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3802           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3803           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3804
  3805         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3806
  3807         16  CF-PAYMENT-APPROVAL-LEVELS.
  3808             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3809             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3810             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3811             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3812             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3813             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3814
  3815         16  CF-END-USER-REPORTING-USER     PIC X.
  3816             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3817             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3818
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  73
* EL6501.cbl
  3819         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3820             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3821             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3822
  3823         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3824
  3825         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3826         16  FILLER                         PIC X.
  3827
  3828         16  CF-CREDIT-ARCHIVE-CNTL.
  3829             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3830             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3831             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3832
  3833         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3834
  3835         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3836             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3837             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3838
  3839         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3840             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3841             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3842
  3843         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3844
  3845         16  CF-CO-ACH-ID-CODE              PIC  X.
  3846             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3847             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3848             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3849         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3850         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3851         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3852         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3853         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3854         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3855         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3856         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3857         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3858                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3859         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3860                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3861
  3862         16  CF-CO-OVER-SHORT.
  3863             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3864             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3865
  3866*         16  FILLER                         PIC X(102).
  3867         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3868             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3869             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3870
  3871         16  CF-AH-APPROVAL-DAYS.
  3872             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3873             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3874             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3875             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3876
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  74
* EL6501.cbl
  3877         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3878
  3879         16  CF-APPROV-LEV-5.
  3880             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3881             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3882             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3883
  3884         16  FILLER                         PIC X(68).
  3885****************************************************************
  3886*             PROCESSOR/USER RECORD                            *
  3887****************************************************************
  3888
  3889     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3890         16  CF-PROCESSOR-NAME              PIC X(30).
  3891         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3892         16  CF-PROCESSOR-TITLE             PIC X(26).
  3893         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3894                 88  MESSAGE-YES                VALUE 'Y'.
  3895                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3896
  3897*****************************************************
  3898****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3899****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3900****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3901****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3902*****************************************************
  3903
  3904         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3905             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3906             20  CF-APPLICATION-FORCE       PIC X.
  3907             20  CF-INDIVIDUAL-APP.
  3908                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3909                     28  CF-BROWSE-APP      PIC X.
  3910                     28  CF-UPDATE-APP      PIC X.
  3911
  3912         16  CF-CURRENT-TERM-ON             PIC X(4).
  3913         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3914             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3915             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3916             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3917             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3918             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3919             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3920             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3921         16  CF-PROCESSOR-CARRIER           PIC X.
  3922             88  NO-CARRIER-SECURITY            VALUE ' '.
  3923         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3924             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3925         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3926             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3927         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3928             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3929
  3930         16  CF-PROC-SYS-ACCESS-SW.
  3931             20  CF-PROC-CREDIT-CLAIMS-SW.
  3932                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3933                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3934                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  75
* EL6501.cbl
  3935                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3936             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3937                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3938                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3939             20  CF-PROC-LIFE-GNRLDGR-SW.
  3940                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3941                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3942                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3943                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3944             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3945                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3946                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3947         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3948             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3949             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3950         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3951
  3952         16  CF-APPROVAL-LEVEL                  PIC X.
  3953             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3954             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3955             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3956             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3957             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3958
  3959         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3960
  3961         16  CF-LANGUAGE-TYPE                   PIC X.
  3962             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3963             88  CF-LANG-IS-FR                      VALUE 'F'.
  3964
  3965         16  CF-CSR-IND                         PIC X.
  3966         16  FILLER                             PIC X(239).
  3967
  3968****************************************************************
  3969*             PROCESSOR/REMINDERS RECORD                       *
  3970****************************************************************
  3971
  3972     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3973         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3974             20  CF-START-REMIND-DT         PIC XX.
  3975             20  CF-END-REMIND-DT           PIC XX.
  3976             20  CF-REMINDER-TEXT           PIC X(50).
  3977         16  FILLER                         PIC X(296).
  3978
  3979
  3980****************************************************************
  3981*             STATE MASTER RECORD                              *
  3982****************************************************************
  3983
  3984     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3985         16  CF-STATE-ABBREVIATION          PIC XX.
  3986         16  CF-STATE-NAME                  PIC X(25).
  3987         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3988         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3989             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3990             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3991             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3992             20  CF-ST-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  76
* EL6501.cbl
  3993                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3994                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3995             20  CF-ST-PREM-REJECT-SW       PIC X.
  3996                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3997                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3998             20  CF-ST-REF-REJECT-SW        PIC X.
  3999                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4000                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4001         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4002         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4003         16  CF-ST-REFUND-RULES.
  4004             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4005             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4006             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4007         16  CF-ST-FST-PMT-EXTENSION.
  4008             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4009             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4010                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4011                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4012                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4013                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4014         16  CF-ST-STATE-CALL.
  4015             20  CF-ST-CALL-UNEARNED        PIC X.
  4016             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4017             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4018         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4019             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4020             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4021         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4022         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4023         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4024         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4025         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4026         16  FILLER                         PIC X.
  4027         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4028             20  CF-ST-BENEFIT-CD           PIC XX.
  4029             20  CF-ST-BENEFIT-KIND         PIC X.
  4030                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4031                 88  CF-ST-AH-KIND              VALUE 'A'.
  4032             20  CF-ST-REM-TERM-CALC        PIC X.
  4033                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4034                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4035                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4036                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4037                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4038                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4039                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4040                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4041
  4042             20  CF-ST-REFUND-CALC          PIC X.
  4043                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4044                 88  ST-REFD-BY-R78             VALUE '1'.
  4045                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4046                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4047                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4048                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4049                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4050                 88  ST-REFD-UTAH               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  77
* EL6501.cbl
  4051                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4052                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4053                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4054
  4055             20  CF-ST-EARNING-CALC         PIC X.
  4056                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4057                 88  ST-EARN-BY-R78             VALUE '1'.
  4058                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4059                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4060                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4061                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4062                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4063                 88  ST-EARN-MEAN               VALUE '8'.
  4064                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4065
  4066             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4067                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4068                 88  ST-OVRD-BY-R78             VALUE '1'.
  4069                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4070                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4071                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4072                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4073                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4074                 88  ST-OVRD-MEAN               VALUE '8'.
  4075                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4076             20  FILLER                     PIC X.
  4077
  4078         16  CF-ST-COMMISSION-CAPS.
  4079             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4080             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4081             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4082             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4083         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4084                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4085
  4086         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4087
  4088         16  CF-ST-STATUTORY-INTEREST.
  4089             20  CF-ST-STAT-DATE-FROM       PIC X.
  4090                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4091                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4092             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4093             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4094             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4095             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4096             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4097
  4098         16  CF-ST-OVER-SHORT.
  4099             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4100             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4101
  4102         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4103
  4104         16  CF-ST-RT-CALC                  PIC X.
  4105
  4106         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4107         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4108         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  78
* EL6501.cbl
  4109         16  CF-ST-RF-LR-CALC               PIC X.
  4110         16  CF-ST-RF-LL-CALC               PIC X.
  4111         16  CF-ST-RF-LN-CALC               PIC X.
  4112         16  CF-ST-RF-AH-CALC               PIC X.
  4113         16  CF-ST-RF-CP-CALC               PIC X.
  4114*        16  FILLER                         PIC X(206).
  4115*CIDMOD         16  FILLER                         PIC X(192).
  4116         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4117             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4118         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4119         16  CF-ST-VFY-2ND-BENE             PIC X.
  4120         16  CF-ST-CAUSAL-STATE             PIC X.
  4121         16  FILLER                         PIC X(185).
  4122
  4123****************************************************************
  4124*             BENEFIT MASTER RECORD                            *
  4125****************************************************************
  4126
  4127     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4128         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4129             20  CF-BENEFIT-CODE            PIC XX.
  4130             20  CF-BENEFIT-NUMERIC  REDEFINES
  4131                 CF-BENEFIT-CODE            PIC XX.
  4132             20  CF-BENEFIT-ALPHA           PIC XXX.
  4133             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4134             20  CF-BENEFIT-COMMENT         PIC X(10).
  4135
  4136             20  CF-LF-COVERAGE-TYPE        PIC X.
  4137                 88  CF-REDUCING                VALUE 'R'.
  4138                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4139
  4140             20  CF-SPECIAL-CALC-CD         PIC X.
  4141                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4142                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4143                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4144                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4145                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4146                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4147                 88  CF-FARM-PLAN               VALUE 'F'.
  4148                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4149                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4150                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4151                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4152                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4153                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4154                 88  CF-PRUDENTIAL              VALUE 'P'.
  4155                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4156                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4157                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4158                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4159                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4160                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4161
  4162             20  CF-JOINT-INDICATOR         PIC X.
  4163                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4164
  4165*            20  FILLER                     PIC X(12).
  4166             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  79
* EL6501.cbl
  4167             20  FILLER                     PIC X(09).
  4168             20  CF-BENEFIT-CATEGORY        PIC X.
  4169             20  CF-LOAN-TYPE               PIC X(8).
  4170
  4171             20  CF-CO-REM-TERM-CALC        PIC X.
  4172                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4173                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4174                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4175                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4176                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4177
  4178             20  CF-CO-EARNINGS-CALC        PIC X.
  4179                 88  CO-EARN-BY-R78             VALUE '1'.
  4180                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4181                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4182                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4183                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4184                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4185                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4186                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4187
  4188             20  CF-CO-REFUND-CALC          PIC X.
  4189                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4190                 88  CO-REFD-BY-R78             VALUE '1'.
  4191                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4192                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4193                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4194                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4195                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4196                 88  CO-REFD-MEAN               VALUE '8'.
  4197                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4198                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4199                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4200
  4201             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4202                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4203                 88  CO-OVRD-BY-R78             VALUE '1'.
  4204                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4205                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4206                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4207                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4208                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4209                 88  CO-OVRD-MEAN               VALUE '8'.
  4210                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4211
  4212             20  CF-CO-BEN-I-G-CD           PIC X.
  4213                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4214                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4215                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4216
  4217         16  FILLER                         PIC X(304).
  4218
  4219
  4220****************************************************************
  4221*             CARRIER MASTER RECORD                            *
  4222****************************************************************
  4223
  4224     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  80
* EL6501.cbl
  4225         16  CF-ADDRESS-DATA.
  4226             20  CF-MAIL-TO-NAME            PIC X(30).
  4227             20  CF-IN-CARE-OF              PIC X(30).
  4228             20  CF-ADDRESS-LINE-1          PIC X(30).
  4229             20  CF-ADDRESS-LINE-2          PIC X(30).
  4230             20  CF-CITY-STATE              PIC X(30).
  4231             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4232             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4233
  4234         16  CF-CLAIM-NO-CONTROL.
  4235             20  CF-CLAIM-NO-METHOD         PIC X.
  4236                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4237                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4238                 88  CLAIM-NO-SEQ               VALUE '3'.
  4239                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4240             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4241                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4242                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4243                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4244
  4245         16  CF-CHECK-NO-CONTROL.
  4246             20  CF-CHECK-NO-METHOD         PIC X.
  4247                 88  CHECK-NO-MANUAL            VALUE '1'.
  4248                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4249                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4250                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4251             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4252                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4253
  4254         16  CF-DOMICILE-STATE              PIC XX.
  4255
  4256         16  CF-EXPENSE-CONTROLS.
  4257             20  CF-EXPENSE-METHOD          PIC X.
  4258                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4259                 88  DOLLARS-PER-PMT            VALUE '2'.
  4260                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4261                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4262             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4263             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4264
  4265         16  CF-CORRESPONDENCE-CONTROL.
  4266             20  CF-LETTER-RESEND-OPT       PIC X.
  4267                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4268                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4269             20  FILLER                     PIC X(4).
  4270
  4271         16  CF-RESERVE-CONTROLS.
  4272             20  CF-MANUAL-SW               PIC X.
  4273                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4274             20  CF-FUTURE-SW               PIC X.
  4275                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4276             20  CF-PTC-SW                  PIC X.
  4277                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4278             20  CF-IBNR-SW                 PIC X.
  4279                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4280             20  CF-PTC-LF-SW               PIC X.
  4281                 88  CF-LF-PTC-USED             VALUE '1'.
  4282             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  81
* EL6501.cbl
  4283                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4284                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4285                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4286             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4287
  4288         16  CF-CLAIM-CALC-METHOD           PIC X.
  4289             88  360-PLUS-MONTHS                VALUE '1'.
  4290             88  365-PLUS-MONTHS                VALUE '2'.
  4291             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4292             88  360-DAILY                      VALUE '4'.
  4293             88  365-DAILY                      VALUE '5'.
  4294
  4295         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4296         16  FILLER                         PIC X(11).
  4297
  4298         16  CF-LIMIT-AMOUNTS.
  4299             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4300             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4301             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4302             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4303             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4304             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4305             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4306             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4307             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4308             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4309
  4310         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4311         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4312         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4313
  4314         16  CF-ZIP-CODE.
  4315             20  CF-ZIP-PRIME.
  4316                 24  CF-ZIP-1ST             PIC X.
  4317                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4318                 24  FILLER                 PIC X(4).
  4319             20  CF-ZIP-PLUS4               PIC X(4).
  4320         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4321             20  CF-CAN-POSTAL-1            PIC XXX.
  4322             20  CF-CAN-POSTAL-2            PIC XXX.
  4323             20  FILLER                     PIC XXX.
  4324
  4325         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4326         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4327         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4328
  4329         16  CF-RATING-SWITCH               PIC X.
  4330             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4331             88  CF-NO-RATING                   VALUE 'N'.
  4332
  4333         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4334
  4335         16  CF-CARRIER-OVER-SHORT.
  4336             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4337             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4338
  4339         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4340         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  82
* EL6501.cbl
  4341             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4342             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4343         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4344         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4345         16  FILLER                         PIC X(444).
  4346*        16  FILLER                         PIC X(452).
  4347
  4348
  4349****************************************************************
  4350*             MORTALITY MASTER RECORD                          *
  4351****************************************************************
  4352
  4353     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4354         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4355                                INDEXED BY CF-MORT-NDX.
  4356             20  CF-MORT-TABLE              PIC X(5).
  4357             20  CF-MORT-TABLE-TYPE         PIC X.
  4358                 88  CF-MORT-JOINT              VALUE 'J'.
  4359                 88  CF-MORT-SINGLE             VALUE 'S'.
  4360                 88  CF-MORT-COMBINED           VALUE 'C'.
  4361                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4362                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4363             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4364             20  CF-MORT-AGE-METHOD         PIC XX.
  4365                 88  CF-AGE-LAST                VALUE 'AL'.
  4366                 88  CF-AGE-NEAR                VALUE 'AN'.
  4367             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4368             20  CF-MORT-ADJUSTMENT-DIRECTION
  4369                                            PIC X.
  4370                 88  CF-MINUS                   VALUE '-'.
  4371                 88  CF-PLUS                    VALUE '+'.
  4372             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4373             20  CF-MORT-JOINT-CODE         PIC X.
  4374                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4375             20  CF-MORT-PC-Q               PIC X.
  4376                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4377             20  CF-MORT-TABLE-CODE         PIC X(4).
  4378             20  CF-MORT-COMMENTS           PIC X(15).
  4379             20  FILLER                     PIC X(14).
  4380
  4381         16  FILLER                         PIC X(251).
  4382
  4383
  4384****************************************************************
  4385*             BUSSINESS TYPE MASTER RECORD                     *
  4386****************************************************************
  4387
  4388     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4389* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4390* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4391* AND RECORD 05 IS TYPES 81-99
  4392         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4393             20  CF-BUSINESS-TITLE          PIC  X(19).
  4394             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4395                                            PIC S9V9(4) COMP-3.
  4396             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4397             20  FILLER                     PIC  X.
  4398         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  83
* EL6501.cbl
  4399
  4400
  4401****************************************************************
  4402*             TERMINAL MASTER RECORD                           *
  4403****************************************************************
  4404
  4405     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4406
  4407         16  CF-COMPANY-TERMINALS.
  4408             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4409                                  PIC X(4).
  4410         16  FILLER               PIC X(248).
  4411
  4412
  4413****************************************************************
  4414*             LIFE EDIT MASTER RECORD                          *
  4415****************************************************************
  4416
  4417     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4418         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4419             20  CF-LIFE-CODE-IN            PIC XX.
  4420             20  CF-LIFE-CODE-OUT           PIC XX.
  4421         16  FILLER                         PIC X(248).
  4422
  4423
  4424****************************************************************
  4425*             AH EDIT MASTER RECORD                            *
  4426****************************************************************
  4427
  4428     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4429         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4430             20  CF-AH-CODE-IN              PIC XXX.
  4431             20  CF-AH-CODE-OUT             PIC XX.
  4432         16  FILLER                         PIC X(248).
  4433
  4434
  4435****************************************************************
  4436*             CREDIBILITY TABLES                               *
  4437****************************************************************
  4438
  4439     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4440         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4441                             INDEXED BY CF-CRDB-NDX.
  4442             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4443             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4444             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4445         16  FILLER                         PIC  X(332).
  4446
  4447
  4448****************************************************************
  4449*             REPORT CUSTOMIZATION RECORD                      *
  4450****************************************************************
  4451
  4452     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4453         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4454             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4455             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4456             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  84
* EL6501.cbl
  4457**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4458****       A T-TRANSFER.                                   ****
  4459             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4460
  4461         16  FILLER                         PIC XX.
  4462
  4463         16  CF-CARRIER-CNTL-OPT.
  4464             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4465                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4466                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4467             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4468                                            PIC X.
  4469         16  CF-GROUP-CNTL-OPT.
  4470             20  CF-GROUP-OPT-SEQ           PIC 9.
  4471                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4472                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4473             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4474                                            PIC X(6).
  4475         16  CF-STATE-CNTL-OPT.
  4476             20  CF-STATE-OPT-SEQ           PIC 9.
  4477                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4478                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4479             20  CF-STATE-SELECT OCCURS 3 TIMES
  4480                                            PIC XX.
  4481         16  CF-ACCOUNT-CNTL-OPT.
  4482             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4483                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4484                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4485             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4486                                            PIC X(10).
  4487         16  CF-BUS-TYP-CNTL-OPT.
  4488             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4489                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4490                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4491             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4492                                            PIC XX.
  4493         16  CF-LF-TYP-CNTL-OPT.
  4494             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4495                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4496                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4497             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4498                                            PIC XX.
  4499         16  CF-AH-TYP-CNTL-OPT.
  4500             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4501                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4502                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4503             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4504                                            PIC XX.
  4505         16  CF-REPTCD1-CNTL-OPT.
  4506             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4507                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4508                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4509             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4510                                            PIC X(10).
  4511         16  CF-REPTCD2-CNTL-OPT.
  4512             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4513                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4514                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  85
* EL6501.cbl
  4515             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4516                                            PIC X(10).
  4517         16  CF-USER1-CNTL-OPT.
  4518             20  CF-USER1-OPT-SEQ           PIC 9.
  4519                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4520                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4521             20  CF-USER1-SELECT OCCURS 3 TIMES
  4522                                            PIC X(10).
  4523         16  CF-USER2-CNTL-OPT.
  4524             20  CF-USER2-OPT-SEQ           PIC 9.
  4525                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4526                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4527             20  CF-USER2-SELECT OCCURS 3 TIMES
  4528                                            PIC X(10).
  4529         16  CF-USER3-CNTL-OPT.
  4530             20  CF-USER3-OPT-SEQ           PIC 9.
  4531                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4532                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4533             20  CF-USER3-SELECT OCCURS 3 TIMES
  4534                                            PIC X(10).
  4535         16  CF-USER4-CNTL-OPT.
  4536             20  CF-USER4-OPT-SEQ           PIC 9.
  4537                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4538                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4539             20  CF-USER4-SELECT OCCURS 3 TIMES
  4540                                            PIC X(10).
  4541         16  CF-USER5-CNTL-OPT.
  4542             20  CF-USER5-OPT-SEQ           PIC 9.
  4543                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4544                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4545             20  CF-USER5-SELECT OCCURS 3 TIMES
  4546                                            PIC X(10).
  4547         16  CF-REINS-CNTL-OPT.
  4548             20  CF-REINS-OPT-SEQ           PIC 9.
  4549                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4550                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4551             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4552                 24  CF-REINS-PRIME         PIC XXX.
  4553                 24  CF-REINS-SUB           PIC XXX.
  4554
  4555         16  CF-AGENT-CNTL-OPT.
  4556             20  CF-AGENT-OPT-SEQ           PIC 9.
  4557                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4558                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4559             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4560                                            PIC X(10).
  4561
  4562         16  FILLER                         PIC X(43).
  4563
  4564         16  CF-LOSS-RATIO-SELECT.
  4565             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4566             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4567         16  CF-ENTRY-DATE-SELECT.
  4568             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4569             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4570         16  CF-EFFECTIVE-DATE-SELECT.
  4571             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4572             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  86
* EL6501.cbl
  4573
  4574         16  CF-EXCEPTION-LIST-IND          PIC X.
  4575             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4576
  4577         16  FILLER                         PIC X(318).
  4578
  4579****************************************************************
  4580*                  EXCEPTION REPORTING RECORD                  *
  4581****************************************************************
  4582
  4583     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4584         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4585             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4586
  4587         16  CF-COMBINED-LIFE-AH-OPT.
  4588             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4589             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4590             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4591             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4592
  4593         16  CF-LIFE-OPT.
  4594             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4595             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4596             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4597             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4598             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4599             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4600             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4601             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4602             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4603             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4604
  4605         16  CF-AH-OPT.
  4606             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4607             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4608             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4609             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4610             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4611             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4612             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4613             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4614             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4615             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4616
  4617         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4618             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4619             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4620             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4621
  4622         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4623
  4624         16  FILLER                         PIC X(673).
  4625
  4626
  4627****************************************************************
  4628*             MORTGAGE SYSTEM PLAN RECORD                      *
  4629****************************************************************
  4630
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  87
* EL6501.cbl
  4631     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4632         16  CF-PLAN-TYPE                   PIC X.
  4633             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4634             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4635             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4636         16  CF-PLAN-ABBREV                 PIC XXX.
  4637         16  CF-PLAN-DESCRIPT               PIC X(10).
  4638         16  CF-PLAN-NOTES                  PIC X(20).
  4639         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4640         16  CF-PLAN-UNDERWRITING.
  4641             20  CF-PLAN-TERM-DATA.
  4642                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4643                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4644             20  CF-PLAN-AGE-DATA.
  4645                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4646                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4647                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4648             20  CF-PLAN-BENEFIT-DATA.
  4649                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4650                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4651                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4652                                            PIC S9(7)V99  COMP-3.
  4653         16  CF-PLAN-POLICY-FORMS.
  4654             20  CF-POLICY-FORM             PIC X(12).
  4655             20  CF-MASTER-APPLICATION      PIC X(12).
  4656             20  CF-MASTER-POLICY           PIC X(12).
  4657         16  CF-PLAN-RATING.
  4658             20  CF-RATE-CODE               PIC X(5).
  4659             20  CF-SEX-RATING              PIC X.
  4660                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4661                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4662             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4663             20  CF-SUB-STD-TYPE            PIC X.
  4664                 88  CF-PCT-OF-PREM            VALUE '1'.
  4665                 88  CF-PCT-OF-BENE            VALUE '2'.
  4666         16  CF-PLAN-PREM-TOLERANCES.
  4667             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4668             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4669         16  CF-PLAN-PYMT-TOLERANCES.
  4670             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4671             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4672         16  CF-PLAN-MISC-DATA.
  4673             20  FILLER                     PIC X.
  4674             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4675             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4676         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4677         16  CF-PLAN-IND-GRP                PIC X.
  4678             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4679                                                     '1'.
  4680             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4681                                                     '2'.
  4682         16  CF-MIB-SEARCH-SW               PIC X.
  4683             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4684             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4685             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4686             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4687         16  CF-ALPHA-SEARCH-SW             PIC X.
  4688             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  88
* EL6501.cbl
  4689             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4690             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4691             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4692             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4693             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4694             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4695             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4696             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4697             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4698                                                     'A' 'B' 'C'
  4699                                                     'X' 'Y' 'Z'.
  4700         16  CF-EFF-DT-RULE-SW              PIC X.
  4701             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4702             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4703             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4704             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4705             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4706         16  FILLER                         PIC X(4).
  4707         16  CF-HEALTH-QUESTIONS            PIC X.
  4708             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4709         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4710         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4711         16  CF-PLAN-SNGL-JNT               PIC X.
  4712             88  CF-COMBINED-PLAN              VALUE 'C'.
  4713             88  CF-JNT-PLAN                   VALUE 'J'.
  4714             88  CF-SNGL-PLAN                  VALUE 'S'.
  4715         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4716         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4717         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4718         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4719         16  CF-RERATE-CNTL                 PIC  X.
  4720             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4721             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4722             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4723             88  CF-AUTO-RECALC                 VALUE '4'.
  4724         16  CF-BENEFIT-TYPE                PIC  X.
  4725             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4726             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4727         16  CF-POLICY-FEE                  PIC S999V99
  4728                                                    COMP-3.
  4729         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4730         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4731         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4732         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4733         16  FILLER                         PIC  X(32).
  4734         16  CF-TERMINATION-FORM            PIC  X(04).
  4735         16  FILLER                         PIC  X(08).
  4736         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4737                                                       COMP-3.
  4738         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4739         16  CF-ISSUE-LETTER                PIC  X(4).
  4740         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4741         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4742             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4743             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4744         16  CF-MP-REFUND-CALC              PIC X.
  4745             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4746             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  89
* EL6501.cbl
  4747             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4748             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4749             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4750             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4751             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4752             88  CF-MP-REFD-MEAN                VALUE '8'.
  4753         16  CF-ALT-RATE-CODE               PIC  X(5).
  4754
  4755
  4756         16  FILLER                         PIC X(498).
  4757****************************************************************
  4758*             MORTGAGE COMPANY MASTER RECORD                   *
  4759****************************************************************
  4760
  4761     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4762         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4763         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4764             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4765             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4766             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4767             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4768             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4769
  4770         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4771         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4772         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4773         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4774         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4775
  4776         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4777             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4778         16  CF-MP-RECON-USE-IND            PIC X(1).
  4779             88  CF-MP-USE-RECON             VALUE 'Y'.
  4780         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4781             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4782         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4783             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4784             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4785         16  FILLER                         PIC X(1).
  4786         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4787             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4788         16  CF-MORTG-MIB-VERSION           PIC X.
  4789             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4790             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4791             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4792         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4793             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4794                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4795             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4796                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4797             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4798                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4799             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4800                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4801             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4802                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4803             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4804                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  90
* EL6501.cbl
  4805         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4806         16  FILLER                         PIC X(7).
  4807         16  CF-MORTG-DESTINATION-SYMBOL.
  4808             20  CF-MORTG-MIB-COMM          PIC X(5).
  4809             20  CF-MORTG-MIB-TERM          PIC X(5).
  4810         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4811             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4812         16  FILLER                         PIC X(03).
  4813         16  CF-MP-CHECK-NO-CONTROL.
  4814             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4815                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4816                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4817                                                ' ' LOW-VALUES.
  4818                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4819                                               VALUE '3'.
  4820         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4821         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4822         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4823             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4824                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4825             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4826                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4827             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4828                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4829             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4830                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4831             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4832                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4833             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4834                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4835         16  CF-MORTG-BILLING-AREA.
  4836             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4837                                            PIC X.
  4838         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4839         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4840         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4841         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4842             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4843             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4844         16  FILLER                         PIC X.
  4845         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4846             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4847             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4848         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4849         16  FILLER                         PIC X(8).
  4850         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4851         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4852         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4853         16  CF-ACH-COMPANY-ID.
  4854             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4855                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4856                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4857                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4858             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4859         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4860             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4861         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4862             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  91
* EL6501.cbl
  4863             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4864         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4865         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4866         16  FILLER                         PIC X(536).
  4867
  4868****************************************************************
  4869*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4870****************************************************************
  4871
  4872     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4873         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4874             20  CF-FEMALE-HEIGHT.
  4875                 24  CF-FEMALE-FT           PIC 99.
  4876                 24  CF-FEMALE-IN           PIC 99.
  4877             20  CF-FEMALE-MIN-WT           PIC 999.
  4878             20  CF-FEMALE-MAX-WT           PIC 999.
  4879         16  FILLER                         PIC X(428).
  4880
  4881     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4882         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4883             20  CF-MALE-HEIGHT.
  4884                 24  CF-MALE-FT             PIC 99.
  4885                 24  CF-MALE-IN             PIC 99.
  4886             20  CF-MALE-MIN-WT             PIC 999.
  4887             20  CF-MALE-MAX-WT             PIC 999.
  4888         16  FILLER                         PIC X(428).
  4889******************************************************************
  4890*             AUTOMATIC ACTIVITY RECORD                          *
  4891******************************************************************
  4892     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4893         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4894             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4895             20  CF-SYS-LETTER-ID           PIC X(04).
  4896             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4897             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4898             20  CF-SYS-RESET-SW            PIC X(01).
  4899             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4900             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4901
  4902         16  FILLER                         PIC X(50).
  4903
  4904         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4905             20  CF-USER-ACTIVE-SW          PIC X(01).
  4906             20  CF-USER-LETTER-ID          PIC X(04).
  4907             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4908             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4909             20  CF-USER-RESET-SW           PIC X(01).
  4910             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4911             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4912             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4913
  4914         16  FILLER                         PIC X(246).
  4915*    COPY ERCREIN.
  4916******************************************************************
  4917*                                                                *
  4918*                            ERCREIN                             *
  4919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4920*                            VMOD=2.010                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  92
* EL6501.cbl
  4921*                                                                *
  4922*   ONLINE CREDIT SYSTEM                                         *
  4923*                                                                *
  4924*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4925*                                                                *
  4926*   FILE TYPE = VSAM,KSDS                                        *
  4927*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4928*                                                                *
  4929*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4930*       ALTERNATE PATH = NONE                                    *
  4931*                                                                *
  4932*   LOG = NO                                                     *
  4933*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4934*                                                                *
  4935******************************************************************
  4936*                   C H A N G E   L O G
  4937*
  4938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4939*-----------------------------------------------------------------
  4940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4941* EFFECTIVE    NUMBER
  4942*-----------------------------------------------------------------
  4943* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4944* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4945******************************************************************
  4946 01  REINSURANCE-RECORD.
  4947     12  RE-RECORD-ID                      PIC XX.
  4948         88  VALID-RE-ID                      VALUE 'RE'.
  4949
  4950     12  RE-CONTROL-PRIMARY.
  4951         16  RE-COMPANY-CD                 PIC X.
  4952         16  RE-KEY.
  4953             20  RE-CODE                   PIC X.
  4954                 88  RE-TABLE-RECORD          VALUE 'A'.
  4955                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4956             20  RE-TABLE                  PIC XXX.
  4957             20  FILLER                    PIC XXX.
  4958         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4959             20  FILLER                    PIC X.
  4960             20  RE-COMPANY.
  4961                 24  RE-COMP-PRIME         PIC XXX.
  4962                 24  RE-COMP-SUB           PIC XXX.
  4963
  4964     12  RE-MAINT-INFORMATION.
  4965         16  RE-LAST-MAINT-DT              PIC XX.
  4966         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4967         16  RE-LAST-MAINT-USER            PIC X(4).
  4968         16  FILLER                        PIC X(10).
  4969
  4970     12  RE-TABLE-DATA.
  4971         16  RE-100-COMP                   PIC 99.
  4972
  4973         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4974             20  RE-REI-COMP-NO.
  4975                 24  RE-REI-COMP           PIC XXX.
  4976                 24  RE-REI-COMP-SUB       PIC XXX.
  4977             20  RE-LF-QC                  PIC X.
  4978             20  RE-AH-QC                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  93
* EL6501.cbl
  4979             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4980             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4981             20  RE-LFAGE-LO               PIC 99.
  4982             20  RE-LFAGE-HI               PIC 99.
  4983             20  RE-AHAGE-LO               PIC 99.
  4984             20  RE-AHAGE-HI               PIC 99.
  4985             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4986             20  RE-LFTRM-HI               PIC S999       COMP-3.
  4987             20  RE-AHTRM-LO               PIC S999       COMP-3.
  4988             20  RE-AHTRM-HI               PIC S999       COMP-3.
  4989             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  4990             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  4991             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  4992             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  4993             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  4994             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  4995             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  4996             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  4997             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  4998             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  4999             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5000             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5001             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5002             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5003             20  RE-LF-BEN-CODE            PIC X.
  5004             20  RE-AH-BEN-CODE            PIC X.
  5005             20  RE-INTERACTIVE            PIC X.
  5006             20  RE-REMAINING              PIC X.
  5007             20  RE-LF-RUNOFF-SW           PIC X.
  5008             20  RE-AH-RUNOFF-SW           PIC X.
  5009             20  FILLER                    PIC X(19).
  5010
  5011         16  RE-COMP-INFO-END              PIC X(6).
  5012         16  RE-NSP-ST-CD-LF               PIC XX.
  5013         16  RE-NSP-ST-CD-AH               PIC XX.
  5014         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5015             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5016
  5017         16  FILLER                        PIC X(27).
  5018
  5019     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5020         16  RE-NAME                       PIC X(30).
  5021         16  RE-LF-PE                      PIC X.
  5022         16  RE-AH-PE                      PIC X.
  5023         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5024         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5025         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5026         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5027         16  RE-PRT-ST                     PIC X.
  5028         16  RE-PRT-OW                     PIC X.
  5029         16  RE-MORT-CODE                  PIC X(4).
  5030         16  RE-CLAIM-CODE                 PIC X.
  5031         16  RE-ZERO-LF-FEE                PIC X.
  5032         16  RE-ZERO-AH-FEE                PIC X.
  5033         16  RE-CEDE-NAME                  PIC X(30).
  5034         16  RE-LF-COMM                    PIC X.
  5035         16  RE-AH-COMM                    PIC X.
  5036         16  RE-LF-TAX                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  94
* EL6501.cbl
  5037         16  RE-AH-TAX                     PIC X.
  5038         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5039         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5040         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5041
  5042         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5043             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5044
  5045         16  RE-LF-CEDING-FEE-BRACKETS.
  5046             20  RE-LF-FEE-METHOD          PIC X.
  5047                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5048                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5049                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5050                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5051             20  RE-LF-FEE-BASIS           PIC X.
  5052                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5053                 88  RE-LF-NET-CEDED               VALUE '2'.
  5054                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5055                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5056                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5057                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5058                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5059                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5060             20  FILLER                    PIC XXX.
  5061             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5062                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5063                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5064
  5065         16  RE-AH-CEDING-FEE-BRACKETS.
  5066             20  RE-AH-FEE-METHOD          PIC X.
  5067                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5068                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5069                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5070                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5071             20  RE-AH-FEE-BASIS           PIC X.
  5072                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5073                 88  RE-AH-NET-CEDED               VALUE '2'.
  5074                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5075                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5076                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5077                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5078                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5079                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  5080             20  FILLER                    PIC XXX.
  5081             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5082                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5083                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5084
  5085         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5086
  5087         16  RE-OLD-CEDING-STMT            PIC X.
  5088
  5089         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5090         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5091         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5092         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5093         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5094         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  95
* EL6501.cbl
  5095         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5096         16  RE-MORT-SW                    PIC X.
  5097         16  RE-CEDING-TYPE-FLAG           PIC X.
  5098             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5099             88  RE-CEDED                          VALUE 'C'.
  5100             88  RE-ASSUMED                        VALUE 'A'.
  5101             88  RE-PHANTOM                        VALUE 'P'.
  5102
  5103         16  RE-CEDING-STMT-OPT-A          PIC X.
  5104             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5105         16  RE-CEDING-STMT-OPT-B          PIC X.
  5106             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5107         16  RE-CEDING-STMT-OPT-C          PIC X.
  5108             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5109         16  RE-CEDING-STMT-OPT-D          PIC X.
  5110             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5111         16  RE-CEDING-STMT-OPT-E          PIC X.
  5112             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5113
  5114         16  RE-PRT-CRSV                   PIC X.
  5115
  5116         16  RE-GL-CENTER                  PIC X(4).
  5117
  5118         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5119
  5120         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5121
  5122         16  RE-EARN-STOP-CODE             PIC X.
  5123             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5124             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5125
  5126         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5127             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5128
  5129         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5130         16  FILLER                        PIC X(2281).
  5131
  5132         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5133
  5134******************************************************************
  5135*    COPY ERCCTBL.
  5136******************************************************************
  5137*                                                                *
  5138*                                                                *
  5139*                            ERCCTBL                             *
  5140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5141*                            VMOD=2.003
  5142*                                                                *
  5143*   ONLINE CREDIT SYSTEM                                         *
  5144*                                                                *
  5145*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5146*                                                                *
  5147*   FILE TYPE = VSAM,KSDS                                        *
  5148*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5149*                                                                *
  5150*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5151*       ALTERNATE PATH = NONE                                    *
  5152*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  96
* EL6501.cbl
  5153*   LOG = NO                                                     *
  5154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5155*                                                                *
  5156*                                                                *
  5157******************************************************************
  5158
  5159 01  COMM-TABLE-RECORD.
  5160     12  CT-RECORD-ID                      PIC XX.
  5161         88  VALID-CT-ID                      VALUE 'CT'.
  5162
  5163     12  CT-CONTROL-PRIMARY.
  5164         16  CT-COMPANY-CD                 PIC X.
  5165         16  CT-TABLE                      PIC XXX.
  5166         16  CT-CNTRL-2.
  5167             20  CT-BEN-TYPE               PIC X.
  5168             20  CT-BEN-CODE               PIC XX.
  5169
  5170     12  CT-MAINT-INFORMATION.
  5171         16  CT-LAST-MAINT-DT              PIC XX.
  5172         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5173         16  CT-LAST-MAINT-USER            PIC X(4).
  5174         16  FILLER                        PIC X(31).
  5175
  5176     12  CT-LIMITS.
  5177         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5178
  5179         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5180
  5181         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5182
  5183     12  CT-RATES.
  5184         16  CT-RTX          OCCURS 27 TIMES.
  5185             20  CT-RT                     PIC SV9(5)     COMP-3.
  5186             20  CT-RT-R   REDEFINES
  5187                 CT-RT                     PIC XXX.
  5188
  5189     12  FILLER                            PIC  X(42).
  5190
  5191******************************************************************
  5192*                                COPY ERCACNT.
  5193******************************************************************
  5194*                                                                *
  5195*                                                                *
  5196*                            ERCACNT.                            *
  5197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5198*                            VMOD=2.002                          *
  5199*                                                                *
  5200*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5201*                                                                *
  5202*   FILE TYPE = VSAM,KSDS                                        *
  5203*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5204*                                                                *
  5205*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5206*       ALTERNATE INDEX = NONE                                   *
  5207*                                                                *
  5208*                                                                *
  5209*   LOG = YES                                                    *
  5210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  97
* EL6501.cbl
  5211******************************************************************
  5212*                   C H A N G E   L O G
  5213*
  5214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5215*-----------------------------------------------------------------
  5216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5217* EFFECTIVE    NUMBER
  5218*-----------------------------------------------------------------
  5219* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5220*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5221******************************************************************
  5222 01  NOTE-FILE.
  5223     12  NT-FILE-ID                  PIC XX.
  5224         88  VALID-NOTE-ID              VALUE 'NT'.
  5225
  5226     12  NT-CONTROL-PRIMARY.
  5227         16  NT-COMPANY-CD           PIC X.
  5228         16  NT-ACCT-NOTE-KEY.
  5229             18  NT-CARRIER              PIC X.
  5230             18  NT-GROUPING             PIC X(06).
  5231             18  NT-STATE                PIC XX.
  5232             18  NT-ACCOUNT              PIC X(10).
  5233         16  NT-RECORD-TYPE          PIC X.
  5234              88  ACCT-NOTE          VALUE '1'.
  5235              88  ACCT-BRANCH-LOC    VALUE '2'.
  5236              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5237         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5238
  5239     12  NT-LAST-MAINT-DT            PIC XX.
  5240     12  NT-LAST-MAINT-BY            PIC X(4).
  5241     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5242
  5243*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5244*     SEQUENCE NUMBERS
  5245     12  NT-NOTE-INFORMATION.
  5246         16  NT-NOTE-LINE            PIC X(60).
  5247         16  FILLER                  PIC X(25).
  5248*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5249     12  NT-LOCATION-INFORMATION REDEFINES
  5250                         NT-NOTE-INFORMATION.
  5251         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5252         16  FILLER                  PIC X(25).
  5253*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5254*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5255*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5256*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5257*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5258*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5259*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5260     12  NT-SHIPPING-INFORMATION REDEFINES
  5261                         NT-NOTE-INFORMATION.
  5262         16  NT-SHIPPING-LINE        PIC X(60).
  5263         16  NT-SHIP-STATE           PIC XX.
  5264         16  NT-SHIP-ZIP             PIC X(10).
  5265         16  FILLER                  PIC X(13).
  5266*****************************************************************
  5267
  5268 01  COMMISSION-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  98
* EL6501.cbl
  5269     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5270         10  WK-AM-AGT           PIC X(10).
  5271         10  WK-AM-TYPE          PIC X.
  5272         10  WK-FILLER           PIC X(13).
  5273         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page  99
* EL6501.cbl
  5275*    COPY ERCCOMP.
  5276******************************************************************
  5277*                                                                *
  5278*                                                                *
  5279*                            ERCCOMP                             *
  5280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5281*                            VMOD=2.019                          *
  5282*                                                                *
  5283*   ONLINE CREDIT SYSTEM                                         *
  5284*                                                                *
  5285*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5286*                                                                *
  5287*   FILE TYPE = VSAM,KSDS                                        *
  5288*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5289*                                                                *
  5290*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5291*       ALTERNATE PATH = NONE                                    *
  5292*                                                                *
  5293*   LOG = NO                                                     *
  5294*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5295*                                                                *
  5296******************************************************************
  5297*                   C H A N G E   L O G
  5298*
  5299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5300*-----------------------------------------------------------------
  5301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5302* EFFECTIVE    NUMBER
  5303*-----------------------------------------------------------------
  5304* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5305* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5306* 092205    2005050300006  PEMA  ADD LEASE FEE
  5307* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5308* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5309* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5310* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5311* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5312* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5313******************************************************************
  5314
  5315 01  COMPENSATION-MASTER.
  5316     12  CO-RECORD-ID                          PIC XX.
  5317         88  VALID-CO-ID                          VALUE 'CO'.
  5318
  5319     12  CO-CONTROL-PRIMARY.
  5320         16  CO-COMPANY-CD                     PIC X.
  5321         16  CO-CONTROL.
  5322             20  CO-CTL-1.
  5323                 24  CO-CARR-GROUP.
  5324                     28  CO-CARRIER            PIC X.
  5325                     28  CO-GROUPING.
  5326                         32  CO-GROUP-PREFIX   PIC XXX.
  5327                         32  CO-GROUP-PRIME    PIC XXX.
  5328                 24  CO-RESP-NO.
  5329                     28  CO-RESP-PREFIX        PIC X(4).
  5330                     28  CO-RESP-PRIME         PIC X(6).
  5331             20  CO-CTL-2.
  5332                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 100
* EL6501.cbl
  5333                     28  CO-ACCT-PREFIX        PIC X(4).
  5334                     28  CO-ACCT-PRIME         PIC X(6).
  5335         16  CO-TYPE                           PIC X.
  5336             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5337             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5338             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5339
  5340     12  CO-MAINT-INFORMATION.
  5341         16  CO-LAST-MAINT-DT                  PIC XX.
  5342         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5343         16  CO-LAST-MAINT-USER                PIC X(4).
  5344     12  FILLER                                PIC XX.
  5345     12  CO-STMT-TYPE                          PIC XXX.
  5346     12  CO-COMP-TYPE                          PIC X.
  5347         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5348     12  CO-STMT-OWNER                         PIC X(4).
  5349     12  CO-BALANCE-CONTROL                    PIC X.
  5350         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5351         88  CO-NO-BALANCE                        VALUE 'N'.
  5352
  5353     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5354         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5355         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5356         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5357
  5358     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5359         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5360         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5361
  5362     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5363     12  CO-GA-DIRECT-DEP                      PIC X.
  5364     12  CO-FUTURE-SPACE                       PIC X.
  5365         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5366
  5367     12  CO-ACCT-NAME                          PIC X(30).
  5368     12  CO-MAIL-NAME                          PIC X(30).
  5369     12  CO-ADDR-1                             PIC X(30).
  5370     12  CO-ADDR-2                             PIC X(30).
  5371     12  CO-ADDR-3.
  5372         16  CO-ADDR-CITY                      PIC X(27).
  5373         16  CO-ADDR-STATE                     PIC XX.
  5374     12  CO-CSO-1099                           PIC X.
  5375     12  CO-ZIP.
  5376         16  CO-ZIP-PRIME.
  5377             20  CO-ZIP-PRI-1ST                PIC X.
  5378                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5379             20  FILLER                        PIC X(4).
  5380         16  CO-ZIP-PLUS4                      PIC X(4).
  5381     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5382         16  CO-CAN-POSTAL-1                   PIC XXX.
  5383         16  CO-CAN-POSTAL-2                   PIC XXX.
  5384         16  FILLER                            PIC XXX.
  5385     12  CO-SOC-SEC                            PIC X(13).
  5386     12  CO-TELEPHONE.
  5387         16  CO-AREA-CODE                      PIC XXX.
  5388         16  CO-PREFIX                         PIC XXX.
  5389         16  CO-PHONE                          PIC X(4).
  5390
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 101
* EL6501.cbl
  5391     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5392
  5393     12  CO-AR-BAL-LEVEL                       PIC X.
  5394         88  CO-AR-REF-LVL                        VALUE '1'.
  5395         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5396         88  CO-AR-BILL-LVL                       VALUE '2'.
  5397         88  CO-AR-AGT-LVL                        VALUE '3'.
  5398         88  CO-AR-FR-LVL                         VALUE '4'.
  5399
  5400     12  CO-AR-NORMAL-PRINT                    PIC X.
  5401         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5402         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5403
  5404     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5405
  5406     12  CO-AR-REPORTING                       PIC X.
  5407         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5408         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5409
  5410     12  CO-AR-PULL-CHECK                      PIC X.
  5411         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5412         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5413
  5414     12  CO-AR-BALANCE-PRINT                   PIC X.
  5415         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5416
  5417     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5418         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5419         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5420         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5421
  5422     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5423
  5424     12  CO-USER-CODE                          PIC X.
  5425     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5426
  5427******************************************************************
  5428*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5429*    THE LAST MONTH END RUN.
  5430******************************************************************
  5431
  5432     12  CO-LAST-ACTIVITY-DATE.
  5433         16  CO-ACT-YEAR                       PIC 99.
  5434         16  CO-ACT-MONTH                      PIC 99.
  5435         16  CO-ACT-DAY                        PIC 99.
  5436
  5437     12  CO-LAST-STMT-DT.
  5438         16  CO-LAST-STMT-YEAR                 PIC 99.
  5439         16  CO-LAST-STMT-MONTH                PIC 99.
  5440         16  CO-LAST-STMT-DAY                  PIC 99.
  5441
  5442     12  CO-MO-END-TOTALS.
  5443         16  CO-MONTHLY-TOTALS.
  5444             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5445             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5446             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5447             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5448             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 102
* EL6501.cbl
  5449
  5450         16  CO-AGING-TOTALS.
  5451             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5452             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5453             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5454             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5455
  5456         16  CO-YTD-TOTALS.
  5457             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5458             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5459
  5460         16  CO-OVER-UNDER-TOTALS.
  5461             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5462             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5463
  5464     12  CO-MISCELLANEOUS-TOTALS.
  5465         16  CO-FICA-TOTALS.
  5466             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5467             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5468
  5469         16  CO-CLAIM-TOTALS.
  5470             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5471             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5472
  5473******************************************************************
  5474*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5475*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5476******************************************************************
  5477
  5478     12  CO-CURRENT-TOTALS.
  5479         16  CO-CURRENT-LAST-STMT-DT.
  5480             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5481             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5482             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5483
  5484         16  CO-CURRENT-MONTHLY-TOTALS.
  5485             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5486             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5487             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5488             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5489             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5490
  5491         16  CO-CURRENT-AGING-TOTALS.
  5492             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5493             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5494             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5495             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5496
  5497         16  CO-CURRENT-YTD-TOTALS.
  5498             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5499             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5500
  5501     12  CO-PAID-COMM-TOTALS.
  5502         16  CO-YTD-PAID-COMMS.
  5503             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5504             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5505
  5506     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 103
* EL6501.cbl
  5507         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5508         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5509
  5510     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5511         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5512         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5513         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5514         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5515         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5516         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5517         88  CO-FINAL-LETTER                  VALUE 'F'.
  5518         88  CO-RECONCILING                   VALUE 'R'.
  5519         88  CO-PHONE-CALL                    VALUE 'P'.
  5520         88  CO-LEGAL                         VALUE 'L'.
  5521         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5522         88  CO-WRITE-OFF                     VALUE 'W'.
  5523         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5524
  5525     12  CO-CSR-CODE                       PIC X(4).
  5526
  5527     12  CO-GA-STATUS-INFO.
  5528         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5529         16  CO-GA-TERMINATION-DT          PIC XX.
  5530         16  CO-GA-STATUS-CODE             PIC X.
  5531             88  CO-GA-ACTIVE                 VALUE 'A'.
  5532             88  CO-GA-INACTIVE               VALUE 'I'.
  5533             88  CO-GA-PENDING                VALUE 'P'.
  5534         16  CO-GA-COMMENTS.
  5535             20  CO-GA-COMMENT-1           PIC X(40).
  5536             20  CO-GA-COMMENT-2           PIC X(40).
  5537             20  CO-GA-COMMENT-3           PIC X(40).
  5538             20  CO-GA-COMMENT-4           PIC X(40).
  5539
  5540     12  CO-RPTCD2                         PIC X(10).
  5541     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5542         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5543         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5544
  5545     12  CO-TYPE-AGENT                     PIC X(01).
  5546         88  CO-CORPORATION                   VALUE 'C'.
  5547         88  CO-PARTNERSHIP                   VALUE 'P'.
  5548         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5549         88  CO-TRUST                         VALUE 'T'.
  5550         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5551
  5552     12  CO-FAXNO.
  5553         16  CO-FAX-AREA-CODE                  PIC XXX.
  5554         16  CO-FAX-PREFIX                     PIC XXX.
  5555         16  CO-FAX-PHONE                      PIC X(4).
  5556
  5557     12  CO-BANK-INFORMATION.
  5558         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5559         16  CO-BANK-TRANSIT-NON REDEFINES
  5560             CO-BANK-TRANSIT-NO                PIC 9(8).
  5561
  5562         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5563     12  CO-MISC-DEDUCT-INFO REDEFINES
  5564                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 104
* EL6501.cbl
  5565         16  CO-MD-GL-ACCT                     PIC X(10).
  5566         16  CO-MD-DIV                         PIC XX.
  5567         16  CO-MD-CENTER                      PIC X(4).
  5568         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5569         16  CO-CREATE-AP-CHECK                PIC X.
  5570         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5571         16  FILLER                            PIC XXX.
  5572     12  CO-ACH-STATUS                         PIC X.
  5573         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5574         88  CO-ACH-PENDING                        VALUE 'P'.
  5575
  5576     12  CO-BILL-SW                            PIC X.
  5577     12  CO-CONTROL-NAME                       PIC X(30).
  5578     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5579     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5580     12  CO-CLP-STATE                          PIC XX.
  5581     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5582     12  CO-SPP-REFUND-EDIT                    PIC X.
  5583
  5584******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 105
* EL6501.cbl
  5586*    COPY ERCNAME.
  5587******************************************************************
  5588*                                                                *
  5589*                                                                *
  5590*                            ERCNAME                             *
  5591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5592*                            VMOD=2.003                          *
  5593*                                                                *
  5594*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5595*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5596*                                                                *
  5597*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5598*                                                                *
  5599*   FILE TYPE = VSAM,KSDS                                        *
  5600*   RECORD SIZE = 160   RECFORM = FIX                            *
  5601*                                                                *
  5602*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5603*                                                                *
  5604*   LOG = NO                                                     *
  5605*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5606*                                                                *
  5607*                                                                *
  5608******************************************************************
  5609
  5610 01  NAME-LOOKUP-MASTER.
  5611     12  NL-RECORD-ID                PIC  X(02).
  5612         88  VALID-NL-ID                         VALUE 'NL'.
  5613
  5614     12  NL-RECORD-KEY.
  5615         16  NL-CONTROL-PRIMARY.
  5616             20  NL-COMPANY-CD       PIC  X(01).
  5617             20  NL-NAME             PIC  X(30).
  5618             20  NL-RECORD-TYPE      PIC  X(01).
  5619                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5620                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5621                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5622
  5623         16  NL-ACCOUNT-MASTER.
  5624             20  NL-AM-COMPANY-CD    PIC  X(01).
  5625             20  NL-AM-CARRIER       PIC  X(01).
  5626             20  NL-AM-GROUPING      PIC  X(06).
  5627             20  NL-AM-STATE         PIC  X(02).
  5628             20  NL-AM-ACCOUNT       PIC  X(10).
  5629             20  FILLER              PIC  X(09).
  5630
  5631         16  NL-COMPENSATION-MASTER
  5632                                 REDEFINES  NL-ACCOUNT-MASTER.
  5633             20  NL-CO-COMPANY-CD    PIC  X(01).
  5634             20  NL-CO-CARRIER       PIC  X(01).
  5635             20  NL-CO-GROUPING      PIC  X(06).
  5636             20  NL-CO-RESP-NO       PIC  X(10).
  5637             20  NL-CO-ACCOUNT       PIC  X(10).
  5638             20  NL-CO-TYPE          PIC  X(01).
  5639
  5640         16  NL-REINSURANCE-RECORD
  5641                                 REDEFINES  NL-ACCOUNT-MASTER.
  5642             20  NL-RE-COMPANY-CD    PIC  X(01).
  5643             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 106
* EL6501.cbl
  5644             20  NL-RE-COMPANY.
  5645                 24  NL-RE-COMP      PIC  X(03).
  5646                 24  NL-RE-CO-SUB    PIC  X(03).
  5647             20  NL-RE-TABLE         PIC  X(03).
  5648             20  FILLER              PIC  X(18).
  5649
  5650     12  NL-MAINT-INFORMATION.
  5651         16  NL-LAST-MAINT-DT        PIC  X(02).
  5652         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5653         16  NL-LAST-MAINT-USER      PIC  X(04).
  5654         16  FILLER                  PIC  X(10).
  5655
  5656     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5657         16  NL-RE-LEVEL             PIC  9(02).
  5658
  5659     12  NL-CITY                     PIC  X(15).
  5660     12  NL-ST                       PIC  XX.
  5661
  5662******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 107
* EL6501.cbl
  5664*    COPY ERCRQST.
  5665******************************************************************
  5666*                                                                *
  5667*                                                                *
  5668*                            ERCRQST.                            *
  5669*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5670*                            VMOD=2.002                          *
  5671*                                                                *
  5672*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5673*                                                                *
  5674*   FILE TYPE = VSAM,KSDS                                        *
  5675*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5676*                                                                *
  5677*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5678*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5679*                                   ACCOUNT, REF, BATCH)         *
  5680*                                                RKP=9, LEN=38   *
  5681*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5682*                                   ACCOUNT, REF, BATCH)         *
  5683*                                                RKP=47, LEN=46  *
  5684*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5685*                                   BATCH)                       *
  5686*                                                RKP=93, LEN=24  *
  5687*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5688*                                   REF, BATCH)                  *
  5689*                                                RKP=117, LEN=35 *
  5690*   LOG = NO                                                     *
  5691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5692******************************************************************
  5693
  5694 01  AR-REQUEST-RECORD.
  5695     12  RQ-RECORD-ID                     PIC XX.
  5696         88  VALID-RQ-ID                        VALUE 'RQ'.
  5697
  5698     12  RQ-CONTROL-PRIMARY.
  5699         16  RQ-COMPANY-CD                PIC X.
  5700         16  RQ-ENTRY-BATCH               PIC X(6).
  5701
  5702     12  RQ-CONTROL-BY-ACCT-REF.
  5703         16  RQ-COMPANY-CD-A1             PIC X.
  5704         16  RQ-CARRIER-A1                PIC X.
  5705         16  RQ-GROUPING-A1               PIC X(6).
  5706         16  RQ-STATE-A1                  PIC XX.
  5707         16  RQ-ACCOUNT-A1                PIC X(10).
  5708         16  RQ-REFERENCE-A1              PIC X(12).
  5709         16  RQ-BATCH-A1                  PIC X(6).
  5710
  5711     12  RQ-CONTROL-BY-FIN-RESP.
  5712         16  RQ-COMPANY-CD-A2             PIC X.
  5713         16  RQ-CARRIER-A2                PIC X.
  5714         16  RQ-GROUPING-A2               PIC X(6).
  5715         16  RQ-FIN-RESP-A2               PIC X(10).
  5716         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5717         16  RQ-REFERENCE-A2              PIC X(12).
  5718         16  RQ-BATCH-A2                  PIC X(6).
  5719
  5720     12  RQ-CONTROL-BY-ACCT-AGENT.
  5721         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 108
* EL6501.cbl
  5722         16  RQ-CARRIER-A3                PIC X.
  5723         16  RQ-GROUPING-A3               PIC X(6).
  5724         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5725         16  RQ-BATCH-A3                  PIC X(6).
  5726
  5727     12  RQ-CONTROL-BY-SUMMARY.
  5728         16  RQ-COMPANY-CD-A4             PIC X.
  5729         16  RQ-SUMMARY-CODE              PIC X(6).
  5730         16  RQ-ACCOUNT-A4                PIC X(10).
  5731         16  RQ-REFERENCE-A4              PIC X(12).
  5732         16  RQ-BATCH-A4                  PIC X(6).
  5733
  5734     12  RQ-REQUEST-METHOD                PIC X.
  5735         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5736         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5737         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5738         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5739     12  FILLER                           PIC X.
  5740     12  RQ-STATUS                        PIC X.
  5741         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5742         88  RQ-RESUBMIT                      VALUE 'R'.
  5743     12  RQ-PROCESSOR-ID                  PIC X(4).
  5744     12  RQ-ENTRY-DT                      PIC XX.
  5745     12  RQ-MO-END-DT                     PIC XX.
  5746     12  RQ-REQUEST-DT                    PIC XX.
  5747     12  RQ-STMT-DT                       PIC XX.
  5748     12  RQ-REVERSAL-DT                   PIC XX.
  5749     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5750     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5751
  5752     12  FILLER                           PIC X(27).
  5753
  5754******************************************************************
  5755
  5756*EJECT
  5757*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 109
* EL6501.cbl
  5759 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5760                          PRODUCT-MASTER CONTROL-FILE
  5761                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5762                          NOTE-FILE COMMISSION-WORK-AREA
  5763                          COMPENSATION-MASTER
  5764                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5765 0000-DFHEXIT SECTION.
  5766     MOVE '9#                    $   ' TO DFHEIV0.
  5767     MOVE 'EL6501' TO DFHEIV1.
  5768     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5769     MOVE EIBTRMID              TO QID-TERM.
  5770
  5771     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5772     MOVE '5'                   TO DC-OPTION-CODE.
  5773     PERFORM 9700-DATE-LINK.
  5774     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5775     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5776
  5777***  Y2K PROJ 7744
  5778     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5779                                    CURRENT-SAVE
  5780     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5781                                    CURRENT-SAVE(1:2)
  5782***  Y2K PROJ 7744
  5783
  5784     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5785     IF EIBCALEN = 0
  5786         GO TO 8800-UNAUTHORIZED-ACCESS.
  5787
  5788     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5789     MOVE LOW-VALUES             TO EL6501AI.
  5790
  5791
  5792* EXEC CICS HANDLE CONDITION
  5793*        PGMIDERR  (9600-PGMID-ERROR)
  5794*        ERROR     (9990-ABEND)
  5795*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5796*    END-EXEC.
  5797*    MOVE '"$L.N                 ! " #00005787' TO DFHEIV0
  5798     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5800     MOVE X'2220233030303035373837' TO DFHEIV0(25:11)
  5801     CALL 'kxdfhei1' USING DFHEIV0
  5802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5803
  5804
  5805     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5806         IF PI-CALLING-PROGRAM = XCTL-650
  5807             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5808             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5809             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5810             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5811             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5812             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5813             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5814             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5815             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5816             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 110
* EL6501.cbl
  5817         ELSE
  5818             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5819             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5820             GO TO 0600-DISPLAY-RECORD.
  5821
  5822     IF EIBAID = DFHCLEAR
  5823         GO TO 9400-CLEAR.
  5824
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 111
* EL6501.cbl
  5826 0200-RECEIVE.
  5827     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5828         MOVE ER-0008            TO EMI-ERROR
  5829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5830         MOVE -1                 TO PFENTERL
  5831         GO TO 8200-SEND-DATAONLY.
  5832
  5833
  5834* EXEC CICS RECEIVE
  5835*        MAP      (MAP-NAME)
  5836*        MAPSET   (MAPSET-NAME)
  5837*        INTO     (EL6501AI)
  5838*    END-EXEC.
  5839     MOVE LENGTH OF
  5840      EL6501AI
  5841       TO DFHEIV11
  5842*    MOVE '8"T I  L              ''   #00005821' TO DFHEIV0
  5843     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5845     MOVE X'2020233030303035383231' TO DFHEIV0(25:11)
  5846     CALL 'kxdfhei1' USING DFHEIV0,
  5847           MAP-NAME,
  5848           EL6501AI,
  5849           DFHEIV11,
  5850           MAPSET-NAME,
  5851           DFHEIV99,
  5852           DFHEIV99
  5853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5854
  5855
  5856     IF PFENTERL = 0
  5857         GO TO 0300-CHECK-PFKEYS.
  5858     IF EIBAID NOT = DFHENTER
  5859         MOVE ER-0004            TO EMI-ERROR
  5860         GO TO 0320-INPUT-ERROR.
  5861     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5862         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5863     ELSE
  5864         MOVE ER-0029            TO EMI-ERROR
  5865         GO TO 0320-INPUT-ERROR.
  5866
  5867 0300-CHECK-PFKEYS.
  5868     IF EIBAID = DFHPF23
  5869         GO TO 8810-PF23.
  5870     IF EIBAID = DFHPF24
  5871         GO TO 9200-RETURN-MAIN-MENU.
  5872     IF EIBAID = DFHPF12
  5873         GO TO 9500-PF12.
  5874
  5875* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5876*             MASTER(ERRESC)
  5877*
  5878*    IF  EIBAID = DFHPF10
  5879*        IF PI-COMPANY-ID = 'DMD'
  5880*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5881*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5882*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5883*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 112
* EL6501.cbl
  5884*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5885*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5886*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5887*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5888*           MOVE XCTL-608           TO PGM-NAME
  5889*                                      PI-RETURN-TO-PROGRAM
  5890*                                      PI-CALLING-PROGRAM
  5891*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5892*           GO TO 9300-XCTL.
  5893
  5894     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5895                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5896                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5897         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5898             MOVE ER-0029        TO  EMI-ERROR
  5899             GO TO 0320-INPUT-ERROR
  5900         ELSE
  5901             GO TO 0800-CHECK-MAINT.
  5902
  5903     IF EIBAID = DFHENTER
  5904         GO TO 0330-EDIT-DATA.
  5905
  5906     MOVE ER-0029                TO EMI-ERROR.
  5907
  5908 0320-INPUT-ERROR.
  5909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5910     MOVE AL-UNBON               TO PFENTERA.
  5911     MOVE -1                     TO PFENTERL.
  5912     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 113
* EL6501.cbl
  5914 0330-EDIT-DATA.
  5915     IF MAINTI  = 'S'
  5916        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5917        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5918        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5919        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5920        MOVE -1                  TO MAINTL
  5921        GO TO 8100-SEND-INITIAL-MAP.
  5922
  5923     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5924     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5925
  5926     IF EMI-ERROR NOT = ZEROS
  5927         MOVE -1                 TO MAINTL
  5928         GO TO 8200-SEND-DATAONLY.
  5929
  5930     IF NOT MODIFY-CAP
  5931         MOVE 'UPDATE'           TO SM-READ
  5932         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5933         MOVE ER-0070            TO EMI-ERROR
  5934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5935         GO TO 8100-SEND-INITIAL-MAP.
  5936
  5937     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5938
  5939     IF MAINTI = 'A'
  5940        GO TO 1000-ADD-A-RECORD.
  5941
  5942     IF MAINTI = 'C'
  5943        IF PI-SV-MAINT  =  'L'
  5944            MOVE -1             TO MAINTL
  5945            MOVE AL-UABON       TO MAINTA
  5946            MOVE ER-0899        TO EMI-ERROR
  5947            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5948            GO TO 8200-SEND-DATAONLY
  5949        ELSE
  5950            GO TO 2000-CHANGE-A-RECORD.
  5951
  5952     IF MAINTI = 'L'
  5953        MOVE 'L'                TO PI-SV-MAINT
  5954        GO TO 3000-CHANGE-ALL-RECORDS.
  5955
  5956     MOVE ER-0023                TO EMI-ERROR.
  5957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5958     MOVE -1                     TO MAINTL.
  5959     MOVE AL-UABON               TO MAINTA.
  5960     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 114
* EL6501.cbl
  5962 0500-CHECK-MAINT-TYPE.
  5963     IF PI-MAINT = 'A'
  5964        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5965        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5966        MOVE -1                  TO NAMEL
  5967        GO TO 8100-SEND-INITIAL-MAP.
  5968
  5969 0600-DISPLAY-RECORD.
  5970     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5971     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5972     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5973     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5974
  5975     IF PI-MAINT = 'A'
  5976        MOVE -1                  TO NAMEL
  5977     ELSE
  5978        MOVE -1                  TO MAINTL.
  5979
  5980     GO TO 8100-SEND-INITIAL-MAP.
  5981
  5982 0700-FORMAT-KEYDATA.
  5983     MOVE PI-MAINT               TO MAINTI.
  5984
  5985     IF PI-MAINT = 'A'
  5986        MOVE AL-PANON            TO MAINTA
  5987        SET T-INDEX TO 1
  5988     ELSE
  5989        SET T-INDEX              TO PI-LINE-SELECTED
  5990        MOVE AL-UANON            TO MAINTA.
  5991
  5992     IF PI-2ND-PAGE
  5993         SET T-INDEX UP BY 8
  5994     ELSE
  5995     IF PI-3RD-PAGE
  5996         SET T-INDEX UP BY 16
  5997     ELSE
  5998     IF PI-LST-PAGE
  5999         SET T-INDEX UP BY 24.
  6000
  6001     MOVE PI-ACCT-CARRIER        TO CARRI.
  6002     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6003     MOVE PI-ACCT-STATE          TO STATEI.
  6004     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6005
  6006     IF PI-ACCT-EXP-DT = LOW-VALUES
  6007        MOVE SPACES              TO EXPDTEI
  6008     ELSE
  6009        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6010           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6011           MOVE SPACE               TO DC-OPTION-CODE
  6012           PERFORM 9700-DATE-LINK
  6013           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6014        ELSE
  6015           MOVE 999999              TO EXPDTEO
  6016           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6017
  6018***DMD CUSTOM CODE *****START
  6019     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 115
* EL6501.cbl
  6020     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6021     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6022     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6023        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6024     ELSE
  6025        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6026***DMD CUSTOM CODE *****END
  6027
  6028     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6029     MOVE SPACE                   TO DC-OPTION-CODE.
  6030     PERFORM 9700-DATE-LINK.
  6031     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6032
  6033 0700-EXIT.
  6034      EXIT.
  6035
  6036 0800-CHECK-MAINT.
  6037     IF PI-MAINT = 'A'
  6038        IF PI-RECORD-NOT-CREATED
  6039           MOVE ER-2071          TO EMI-ERROR
  6040           MOVE  -1              TO NAMEL
  6041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6042           GO TO 8200-SEND-DATAONLY.
  6043
  6044     IF  EIBAID = DFHPF1
  6045             AND
  6046         CREDIT-SESSION
  6047         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6048         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6049         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6050         MOVE PI-ACCT-STATE      TO PI-STATE
  6051         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6052         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6053         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6054         MOVE XCTL-689           TO PGM-NAME
  6055         GO TO 9300-XCTL.
  6056
  6057     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6058         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6059         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6060         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6061         MOVE PI-ACCT-STATE      TO PI-STATE
  6062         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6063         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6064         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6065         MOVE XCTL-690           TO PGM-NAME
  6066         GO TO 9300-XCTL
  6067     END-IF.
  6068
  6069     IF EIBAID = DFHPF3
  6070             AND
  6071         CREDIT-SESSION
  6072         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6073         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6074         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6075         MOVE PI-ACCT-STATE      TO PI-STATE
  6076         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6077         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 116
* EL6501.cbl
  6078         MOVE XCTL-653           TO PGM-NAME
  6079         GO TO 9300-XCTL.
  6080
  6081     IF EIBAID = DFHPF4
  6082         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6083         MOVE XCTL-652           TO PGM-NAME
  6084         GO TO 9300-XCTL.
  6085
  6086     IF EIBAID = DFHPF5
  6087         MOVE XCTL-6502          TO PGM-NAME
  6088         GO TO 9300-XCTL.
  6089
  6090     IF EIBAID = DFHPF7
  6091         MOVE XCTL-6504          TO PGM-NAME
  6092         GO TO 9300-XCTL.
  6093
  6094     IF EIBAID = DFHPF8
  6095         MOVE XCTL-6506          TO PGM-NAME
  6096         GO TO 9300-XCTL.
  6097
  6098     IF EIBAID = DFHPF9
  6099        MOVE XCTL-6505           TO PGM-NAME
  6100        GO TO 9300-XCTL.
  6101
  6102     IF EIBAID = DFHPF10
  6103        IF PI-COMPANY-ID = 'DMD'
  6104           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6105           MOVE XCTL-608         TO PGM-NAME
  6106           GO TO 9300-XCTL.
  6107
  6108     MOVE ER-0029                TO EMI-ERROR.
  6109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6110     MOVE AL-UNBON               TO PFENTERA.
  6111     MOVE -1                     TO PFENTERL.
  6112     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 117
* EL6501.cbl
  6114 1000-ADD-A-RECORD.
  6115     IF PI-MAINT = 'A'
  6116        PERFORM 4000-EDITS THRU 4900-EXIT
  6117     ELSE
  6118        MOVE ER-2180             TO EMI-ERROR
  6119        MOVE -1                  TO MAINTL
  6120        MOVE AL-UABON            TO MAINTA
  6121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6122
  6123     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6124        EMI-FATAL-CTR    GREATER ZERO
  6125         GO TO 8200-SEND-DATAONLY.
  6126
  6127
  6128* EXEC CICS GETMAIN
  6129*         LENGTH   (ACCT-REC-LEN)
  6130*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6131*         INITIMG  (GETMAIN-SPACE)
  6132*    END-EXEC.
  6133*    MOVE ',"IL                  $   #00006098' TO DFHEIV0
  6134     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6136     MOVE X'2020233030303036303938' TO DFHEIV0(25:11)
  6137     CALL 'kxdfhei1' USING DFHEIV0,
  6138           DFHEIV20,
  6139           ACCT-REC-LEN,
  6140           GETMAIN-SPACE
  6141     SET ADDRESS OF ACCOUNT-MASTER TO
  6142         DFHEIV20
  6143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6144
  6145
  6146     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6147                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6148                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6149                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6150                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6151                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6152
  6153     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6154                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6155                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6156                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6157                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6158                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6159                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6160                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6161
  6162     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6163                                    AM-AGT-COMMS (2)
  6164                                    AM-AGT-COMMS (3)
  6165                                    AM-AGT-COMMS (4)
  6166                                    AM-AGT-COMMS (5)
  6167                                    AM-AGT-COMMS (6)
  6168                                    AM-AGT-COMMS (7)
  6169                                    AM-AGT-COMMS (8)
  6170                                    AM-AGT-COMMS (9)
  6171                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 118
* EL6501.cbl
  6172
  6173     IF PI-COMPANY-ID = 'FLI'
  6174         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6175                                    AM-FLI-BANK-1ST-6-PREM
  6176                                    AM-FLI-BANK-CAP-AMT
  6177                                    AM-FLI-AGT-SHARE-PCT (1)
  6178                                    AM-FLI-AGT-SHARE-PCT (2)
  6179                                    AM-FLI-AGT-SHARE-PCT (3)
  6180                                    AM-FLI-AGT-SHARE-PCT (4)
  6181                                    AM-FLI-AGT-SHARE-PCT (5)
  6182                                    AM-FLI-AGT-SHARE-PCT (6)
  6183                                    AM-FLI-AGT-SHARE-PCT (7)
  6184                                    AM-FLI-AGT-SHARE-PCT (8)
  6185                                    AM-FLI-AGT-SHARE-PCT (9)
  6186                                    AM-FLI-AGT-SHARE-PCT (10).
  6187
  6188     MOVE ZEROS                  TO AM-GPCD
  6189                                    AM-LF-RET
  6190                                    AM-AH-RET
  6191                                    AM-LF-OB-RATE
  6192                                    AM-LF-OB-RATE-JNT
  6193                                    AM-AH-OB-RATE
  6194                                    AM-AH-OB-RATE-JNT
  6195                                    AM-REI-FEE-LF
  6196                                    AM-REI-FEE-AH
  6197                                    AM-REI-LF-TAX
  6198                                    AM-REI-PR-PCT
  6199                                    AM-REI-78-PCT
  6200                                    AM-REI-AH-TAX
  6201                                    AM-TOL-PREM
  6202                                    AM-TOL-REF
  6203                                    AM-CLP-TOL-PCT
  6204                                    AM-TOL-CLM
  6205                                    AM-CERTS-PURGED-DATE
  6206                                    AM-HI-CERT-DATE
  6207                                    AM-LO-CERT-DATE
  6208                                    AM-1ST-PROD-DATE
  6209                                    AM-GPCD
  6210                                    AM-CAL-TABLE
  6211                                    AM-LF-DEVIATION
  6212                                    AM-LF-DEVIATION-PCT
  6213                                    AM-AH-DEVIATION
  6214                                    AM-AH-DEVIATION-PCT
  6215                                    AM-ANNIVERSARY-DATE
  6216                                    AM-TEL-NO
  6217                                    AM-ENTRY-DATE
  6218                                    AM-INACTIVE-DATE
  6219                                    AM-RET-MIN-LOSS-L
  6220                                    AM-RET-MIN-LOSS-A
  6221                                    AM-LF-RPT021-EXP-PCT
  6222                                    AM-AH-RPT021-EXP-PCT
  6223                                    AM-MAX-MON-BEN
  6224                                    AM-MAX-TOT-BEN
  6225                                    AM-DCC-MAX-MARKETING-FEE
  6226                                    AM-SPP-LEASE-COMM
  6227                                    AM-RETRO-QUALIFY-LIMIT
  6228                                    AM-RETRO-RET-PCT-LF (1)
  6229                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 119
* EL6501.cbl
  6230                                    AM-RETRO-RET-PCT-LF (3)
  6231                                    AM-RETRO-RET-THRU-LF (1)
  6232                                    AM-RETRO-RET-THRU-LF (2)
  6233                                    AM-RETRO-RET-THRU-LF (3)
  6234                                    AM-RETRO-RET-PCT-AH (1)
  6235                                    AM-RETRO-RET-PCT-AH (2)
  6236                                    AM-RETRO-RET-PCT-AH (3)
  6237                                    AM-RETRO-RET-THRU-AH (1)
  6238                                    AM-RETRO-RET-THRU-AH (2)
  6239                                    AM-RETRO-RET-THRU-AH (3).
  6240
  6241     IF PI-COMPANY-ID = 'DCC'
  6242        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6243     END-IF
  6244     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6245                                    AM-AR-HI-CERT-DATE.
  6246
  6247     MOVE 'AM'                   TO AM-RECORD-ID.
  6248     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6249                                    AM-CONTROL-BY-VAR-GRP.
  6250
  6251     IF ST-ACCNT-CNTL
  6252        MOVE SPACES              TO AM-VG-CARRIER
  6253                                    AM-VG-GROUPING.
  6254     IF CARR-ST-ACCNT-CNTL
  6255        MOVE SPACES              TO AM-VG-GROUPING.
  6256
  6257     IF ACCNT-CNTL
  6258        MOVE SPACES              TO AM-VG-CARRIER
  6259                                    AM-VG-STATE
  6260                                    AM-VG-GROUPING.
  6261
  6262     IF CARR-ACCNT-CNTL
  6263        MOVE SPACES              TO AM-VG-STATE
  6264                                    AM-VG-GROUPING.
  6265
  6266     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6267     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6268     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6269
  6270     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6271     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6272     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6273
  6274     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6275
  6276     IF PI-COMPANY-ID = 'NCL'
  6277         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6278
  6279     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6280        EMI-FATAL-CTR    GREATER ZERO
  6281         GO TO 8200-SEND-DATAONLY.
  6282
  6283     IF PI-COMPANY-ID = 'DCC'
  6284        IF CLPSTL <= ZEROS
  6285           MOVE ER-0144          TO  EMI-ERROR
  6286           MOVE -1               TO  CLPSTL
  6287           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 120
* EL6501.cbl
  6288           PERFORM 9900-ERROR-FORMAT
  6289                                 THRU  9900-EXIT
  6290           GO TO 8200-SEND-DATAONLY
  6291        END-IF
  6292     END-IF
  6293     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6294     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6295
  6296     MOVE +1 TO AXRF-SUB
  6297                COMM-WORK-SUB.
  6298
  6299     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6300     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6301
  6302     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6303
  6304     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6305         NEXT SENTENCE
  6306     ELSE
  6307         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6308
  6309
  6310* EXEC CICS WRITE
  6311*        FROM      (ACCOUNT-MASTER)
  6312*        RIDFLD    (AM-CONTROL-PRIMARY)
  6313*        DATASET   (ACCT-FILE-ID)
  6314*    END-EXEC.
  6315     MOVE LENGTH OF
  6316      ACCOUNT-MASTER
  6317       TO DFHEIV11
  6318*    MOVE '&$ L                  ''   #00006267' TO DFHEIV0
  6319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6321     MOVE X'2020233030303036323637' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0,
  6323           ACCT-FILE-ID,
  6324           ACCOUNT-MASTER,
  6325           DFHEIV11,
  6326           AM-CONTROL-PRIMARY,
  6327           DFHEIV99,
  6328           DFHEIV99
  6329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6330
  6331
  6332     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6333
  6334     MOVE PI-MAINT               TO PI-SV-MAINT.
  6335     MOVE 'C'                    TO PI-MAINT.
  6336     MOVE LOW-VALUES             TO EL6501AI.
  6337
  6338     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6339     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6340     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6341
  6342     IF PI-COMPANY-ID = 'NCL'
  6343         MOVE ER-4011            TO EMI-ERROR
  6344      ELSE
  6345         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 121
* EL6501.cbl
  6346
  6347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6348
  6349     MOVE -1                     TO MAINTL.
  6350     MOVE AL-UANON               TO MAINTA.
  6351     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6352     GO TO 8100-SEND-INITIAL-MAP.
  6353
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 122
* EL6501.cbl
  6355 1500-ADD-COMP.
  6356
  6357* EXEC CICS GETMAIN
  6358*         LENGTH   (COMP-REC-LEN)
  6359*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6360*         INITIMG  (GETMAIN-SPACE)
  6361*    END-EXEC.
  6362*    MOVE ',"IL                  $   #00006297' TO DFHEIV0
  6363     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6365     MOVE X'2020233030303036323937' TO DFHEIV0(25:11)
  6366     CALL 'kxdfhei1' USING DFHEIV0,
  6367           DFHEIV20,
  6368           COMP-REC-LEN,
  6369           GETMAIN-SPACE
  6370     SET ADDRESS OF COMPENSATION-MASTER TO
  6371         DFHEIV20
  6372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6373
  6374
  6375     MOVE SPACES                 TO COMPENSATION-MASTER.
  6376     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6377                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6378                   CO-OV30         CO-OV60      CO-OV90
  6379                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6380                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6381                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6382                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6383                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6384                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6385                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6386                   CO-CURRENT-CUR-PMT
  6387                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6388                   CO-ACT-YEAR        CO-ACT-MONTH
  6389                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6390                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6391                   CO-CURRENT-LAST-STMT-YEAR
  6392                   CO-CURRENT-LAST-STMT-MONTH
  6393                   CO-CURRENT-LAST-STMT-DAY
  6394                   CO-YTD-PAID-COM
  6395                   CO-YTD-PAID-OV
  6396                   co-ov120 co-current-ov120
  6397
  6398     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6399     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6400     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6401     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6402     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6403
  6404     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6405         MOVE ZEROS              TO CO-CARRIER
  6406     ELSE
  6407         MOVE AM-CARRIER         TO CO-CARRIER.
  6408
  6409     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6410         MOVE ZEROS              TO CO-GROUPING
  6411     ELSE
  6412         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 123
* EL6501.cbl
  6413
  6414     MOVE 'CO'                   TO CO-RECORD-ID
  6415     MOVE 'A'                    TO CO-TYPE.
  6416     MOVE AM-NAME                TO CO-ACCT-NAME.
  6417     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6418     MOVE AM-ADDRS               TO CO-ADDR-1.
  6419*    MOVE AM-CITY                TO CO-ADDR-3.
  6420     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6421     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6422     MOVE AM-ZIP                 TO CO-ZIP.
  6423     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6424     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6425
  6426     IF PI-COMPANY-ID = 'NCL'
  6427         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6428         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6429                         'X' OR 'I'
  6430             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6431             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6432         ELSE
  6433             MOVE SPACE          TO  CO-TYPE-AGENT
  6434             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6435     ELSE
  6436         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6437
  6438     IF AM-REMIT-TO NOT = ZERO
  6439         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6440       ELSE
  6441         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6442
  6443     MOVE +0                      TO AGT-SUB.
  6444
  6445     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6446
  6447     IF VALID-AGT-SW = 'Y'
  6448         NEXT SENTENCE
  6449     ELSE
  6450         GO TO 1500-EXIT.
  6451
  6452     IF CO-RESP-NO = CO-ACCOUNT
  6453         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6454     ELSE
  6455         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6456
  6457     IF PI-AR-PROCESSING
  6458        MOVE 'G'                   TO CO-AR-REPORTING
  6459        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6460        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6461        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6462
  6463     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6464        MOVE 'N'                   TO CO-AR-REPORTING.
  6465
  6466     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6467        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6468
  6469     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6470
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 124
* EL6501.cbl
  6471
  6472* EXEC CICS HANDLE CONDITION
  6473*         DUPREC   (1500-EXIT)
  6474*    END-EXEC.
  6475*    MOVE '"$%                   ! # #00006399' TO DFHEIV0
  6476     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6478     MOVE X'2320233030303036333939' TO DFHEIV0(25:11)
  6479     CALL 'kxdfhei1' USING DFHEIV0
  6480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6481
  6482
  6483
  6484* EXEC CICS WRITE
  6485*        FROM      (COMPENSATION-MASTER)
  6486*        RIDFLD    (CO-CONTROL-PRIMARY)
  6487*        DATASET   (COMP-FILE-ID)
  6488*    END-EXEC.
  6489     MOVE LENGTH OF
  6490      COMPENSATION-MASTER
  6491       TO DFHEIV11
  6492*    MOVE '&$ L                  ''   #00006403' TO DFHEIV0
  6493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6495     MOVE X'2020233030303036343033' TO DFHEIV0(25:11)
  6496     CALL 'kxdfhei1' USING DFHEIV0,
  6497           COMP-FILE-ID,
  6498           COMPENSATION-MASTER,
  6499           DFHEIV11,
  6500           CO-CONTROL-PRIMARY,
  6501           DFHEIV99,
  6502           DFHEIV99
  6503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6504
  6505
  6506 1500-EXIT.
  6507      EXIT.
  6508
  6509 1600-FIND-C-AGT.
  6510     ADD 1 TO  AGT-SUB.
  6511     IF AGT-SUB GREATER 10
  6512         MOVE 'N'                TO  VALID-AGT-SW
  6513         GO TO 1600-EXIT.
  6514
  6515************************************************************
  6516**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6517************************************************************
  6518
  6519     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6520         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6521         MOVE 'Y'                TO  VALID-AGT-SW
  6522         GO TO 1600-EXIT
  6523     ELSE
  6524         GO TO 1600-FIND-C-AGT.
  6525
  6526 1600-EXIT.
  6527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 125
* EL6501.cbl
  6529 1700-CHANGE-COMP.
  6530     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6531     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6532
  6533     IF PI-ZERO-CARRIER
  6534       OR PI-ZERO-CAR-GROUP
  6535         MOVE ZEROS              TO COMP-CARRIER
  6536     ELSE
  6537         MOVE AM-CARRIER         TO COMP-CARRIER.
  6538
  6539     IF PI-ZERO-GROUPING
  6540       OR PI-ZERO-CAR-GROUP
  6541         MOVE ZEROS              TO COMP-GROUPING
  6542     ELSE
  6543         MOVE AM-GROUPING        TO COMP-GROUPING.
  6544
  6545     IF AM-REMIT-TO NOT = ZERO
  6546         MOVE AM-AGT (AM-REMIT-TO)
  6547                                 TO COMP-RESP-NO
  6548     ELSE
  6549         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6550
  6551     MOVE ZERO                   TO AGT-SUB.
  6552
  6553     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6554
  6555     IF VALID-AGT-SW = 'Y'
  6556         NEXT SENTENCE
  6557     ELSE
  6558         GO TO 1799-EXIT.
  6559
  6560     MOVE 'A'                    TO COMP-TYPE.
  6561
  6562
  6563* EXEC CICS HANDLE CONDITION
  6564*         ENDFILE     (1799-EXIT)
  6565*         NOTFND      (1799-EXIT)
  6566*    END-EXEC.
  6567*    MOVE '"$''I                  ! $ #00006465' TO DFHEIV0
  6568     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6570     MOVE X'2420233030303036343635' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0
  6572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6573
  6574
  6575
  6576* EXEC CICS READ
  6577*        UPDATE
  6578*        DATASET   (COMP-FILE-ID)
  6579*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6580*        RIDFLD    (COMP-KEY)
  6581*    END-EXEC.
  6582*    MOVE '&"S        EU         (   #00006470' TO DFHEIV0
  6583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6584     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6585     MOVE X'2020233030303036343730' TO DFHEIV0(25:11)
  6586     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 126
* EL6501.cbl
  6587           COMP-FILE-ID,
  6588           DFHEIV20,
  6589           DFHEIV99,
  6590           COMP-KEY,
  6591           DFHEIV99,
  6592           DFHEIV99,
  6593           DFHEIV99
  6594     SET ADDRESS OF COMPENSATION-MASTER TO
  6595         DFHEIV20
  6596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6597
  6598
  6599     IF (ON-LAST-DATE-RANGE)
  6600        IF NAMEL GREATER ZEROS
  6601           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6602           MOVE AM-NAME          TO CO-ACCT-NAME
  6603        END-IF
  6604        IF INCAREL GREATER ZEROS
  6605           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6606           MOVE AM-PERSON        TO CO-MAIL-NAME
  6607        END-IF
  6608        IF ADDR1L GREATER ZEROS
  6609           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6610           MOVE AM-ADDRS         TO CO-ADDR-1
  6611        END-IF
  6612        IF ACITYL  GREATER ZEROS
  6613           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6614           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6615        END-IF
  6616        IF ASTATEL  GREATER ZEROS
  6617           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6618           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6619        END-IF
  6620        IF ZIPL GREATER ZEROS
  6621           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6622           MOVE AM-ZIP           TO CO-ZIP
  6623        END-IF
  6624        IF CSRL GREATER ZEROS
  6625           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6626           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6627        END-IF
  6628        IF PHONEL GREATER ZEROS
  6629           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6630           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6631        END-IF
  6632        IF TAXNOL GREATER ZEROS
  6633           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6634           MOVE AM-ID-NO         TO CO-SOC-SEC
  6635        END-IF
  6636        IF AUTO-CANCEL-ACCOUNT
  6637           IF CO-BILL-SW = ' '
  6638              MOVE 'B'           TO CO-BILL-SW
  6639              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6640           END-IF
  6641        END-IF
  6642     END-IF
  6643
  6644     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 127
* EL6501.cbl
  6645         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6646         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6647     END-IF
  6648
  6649     IF CHANGE-WAS-MADE
  6650         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6651         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6652         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6653
  6654     IF NAMEL GREATER THAN ZERO
  6655         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6656
  6657
  6658* EXEC CICS REWRITE
  6659*        FROM      (COMPENSATION-MASTER)
  6660*        DATASET   (COMP-FILE-ID)
  6661*    END-EXEC.
  6662     MOVE LENGTH OF
  6663      COMPENSATION-MASTER
  6664       TO DFHEIV11
  6665*    MOVE '&& L                  %   #00006535' TO DFHEIV0
  6666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6668     MOVE X'2020233030303036353335' TO DFHEIV0(25:11)
  6669     CALL 'kxdfhei1' USING DFHEIV0,
  6670           COMP-FILE-ID,
  6671           COMPENSATION-MASTER,
  6672           DFHEIV11,
  6673           DFHEIV99
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6675
  6676
  6677 1799-EXIT.
  6678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 128
* EL6501.cbl
  6680 1800-FIND-C-AGT.
  6681     ADD 1                       TO  AGT-SUB.
  6682
  6683     IF AGT-SUB GREATER 10
  6684         MOVE 'N'                TO  VALID-AGT-SW
  6685         GO TO 1899-EXIT.
  6686
  6687************************************************************
  6688**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6689************************************************************
  6690
  6691     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6692         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6693         MOVE 'Y'                TO  VALID-AGT-SW
  6694         GO TO 1899-EXIT
  6695     ELSE
  6696         GO TO 1800-FIND-C-AGT.
  6697
  6698 1899-EXIT.
  6699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 129
* EL6501.cbl
  6701 2000-CHANGE-A-RECORD.
  6702     PERFORM 4000-EDITS THRU 4900-EXIT.
  6703
  6704     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6705        EMI-FATAL-CTR    GREATER ZERO
  6706         GO TO 8200-SEND-DATAONLY.
  6707
  6708
  6709* EXEC CICS READ
  6710*        UPDATE
  6711*        DATASET   (ACCT-FILE-ID)
  6712*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6713*        RIDFLD    (PI-ACCT-KEY)
  6714*    END-EXEC.
  6715*    MOVE '&"S        EU         (   #00006571' TO DFHEIV0
  6716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6717     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6718     MOVE X'2020233030303036353731' TO DFHEIV0(25:11)
  6719     CALL 'kxdfhei1' USING DFHEIV0,
  6720           ACCT-FILE-ID,
  6721           DFHEIV20,
  6722           DFHEIV99,
  6723           PI-ACCT-KEY,
  6724           DFHEIV99,
  6725           DFHEIV99,
  6726           DFHEIV99
  6727     SET ADDRESS OF ACCOUNT-MASTER TO
  6728         DFHEIV20
  6729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6730
  6731
  6732     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6733
  6734     IF NOT PI-AR-PROCESSING
  6735        GO TO 2075-PROCESS-CHANGE.
  6736
  6737     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6738     MOVE +0                     TO SUB1.
  6739
  6740 2075-PROCESS-CHANGE.
  6741     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6742
  6743     IF PI-AR-PROCESSING
  6744        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6745
  6746     IF PI-COMPANY-ID = 'DMD'
  6747     IF AM-ANNIVERSARY-DATE = ZEROS
  6748           MOVE ER-0852             TO EMI-ERROR
  6749           MOVE -1                  TO CONTRL
  6750           MOVE AL-UABON            TO CONTRA
  6751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6752
  6753     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6754        EMI-FATAL-CTR    GREATER ZERO
  6755         GO TO 8200-SEND-DATAONLY.
  6756
  6757     MOVE +1                     TO AXRF-SUB
  6758                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 130
* EL6501.cbl
  6759     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6760
  6761     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6762     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6763     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6764
  6765     IF ((PI-FST-PAGE)
  6766        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6767                      OR
  6768        ((PI-2ND-PAGE)
  6769        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6770                      OR
  6771        ((PI-3RD-PAGE)
  6772        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6773                      OR
  6774        ((PI-LST-PAGE)
  6775        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6776        SET ON-LAST-DATE-RANGE   TO TRUE
  6777     END-IF
  6778     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6779         NEXT SENTENCE
  6780     ELSE
  6781         IF (ON-LAST-DATE-RANGE)
  6782                          OR
  6783            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6784             (PCONTL > ZERO))
  6785             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6786
  6787     IF NAMEL GREATER THAN ZERO
  6788         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6789
  6790
  6791* EXEC CICS REWRITE
  6792*        FROM      (ACCOUNT-MASTER)
  6793*        DATASET   (ACCT-FILE-ID)
  6794*    END-EXEC.
  6795     MOVE LENGTH OF
  6796      ACCOUNT-MASTER
  6797       TO DFHEIV11
  6798*    MOVE '&& L                  %   #00006636' TO DFHEIV0
  6799     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6800     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6801     MOVE X'2020233030303036363336' TO DFHEIV0(25:11)
  6802     CALL 'kxdfhei1' USING DFHEIV0,
  6803           ACCT-FILE-ID,
  6804           ACCOUNT-MASTER,
  6805           DFHEIV11,
  6806           DFHEIV99
  6807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6808
  6809
  6810     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6811
  6812     IF CSRL GREATER ZEROS
  6813         GO TO 3500-CHANGE-ALL-CSR.
  6814
  6815     MOVE ER-0000                TO EMI-ERROR.
  6816     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 131
* EL6501.cbl
  6817     MOVE LOW-VALUES             TO EL6501AI.
  6818
  6819     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6820     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6821     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6822
  6823     MOVE ER-0000                TO EMI-ERROR.
  6824     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6825
  6826     MOVE -1                     TO MAINTL.
  6827     MOVE AL-UANON               TO MAINTA.
  6828     GO TO 8100-SEND-INITIAL-MAP.
  6829
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 132
* EL6501.cbl
  6831 2100-ADD-ACCOUNT-NAME.
  6832
  6833* EXEC CICS HANDLE CONDITION
  6834*         DUPREC   (2100-EXIT)
  6835*    END-EXEC.
  6836*    MOVE '"$%                   ! % #00006663' TO DFHEIV0
  6837     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6839     MOVE X'2520233030303036363633' TO DFHEIV0(25:11)
  6840     CALL 'kxdfhei1' USING DFHEIV0
  6841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6842
  6843
  6844
  6845* EXEC CICS GETMAIN
  6846*         LENGTH   (NAME-REC-LEN)
  6847*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6848*         INITIMG  (GETMAIN-SPACE)
  6849*    END-EXEC.
  6850*    MOVE ',"IL                  $   #00006667' TO DFHEIV0
  6851     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6853     MOVE X'2020233030303036363637' TO DFHEIV0(25:11)
  6854     CALL 'kxdfhei1' USING DFHEIV0,
  6855           DFHEIV20,
  6856           NAME-REC-LEN,
  6857           GETMAIN-SPACE
  6858     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6859         DFHEIV20
  6860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6861
  6862
  6863     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6864     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6865     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6866     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6867     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6868     MOVE AM-NAME                TO  NL-NAME.
  6869     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6870        MOVE NL-NAME (5:26)      TO NL-NAME
  6871     END-IF
  6872     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6873     MOVE AM-ADDR-STATE          TO  NL-ST.
  6874     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6875     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6876     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6877     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6878     MOVE AM-STATE               TO  NL-AM-STATE.
  6879     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6880
  6881
  6882* EXEC CICS WRITE
  6883*        FROM      (NAME-LOOKUP-MASTER)
  6884*        RIDFLD    (NL-CONTROL-PRIMARY)
  6885*        DATASET   (NAME-FILE-ID)
  6886*    END-EXEC.
  6887     MOVE LENGTH OF
  6888      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 133
* EL6501.cbl
  6889       TO DFHEIV11
  6890*    MOVE '&$ L                  ''   #00006691' TO DFHEIV0
  6891     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6892     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6893     MOVE X'2020233030303036363931' TO DFHEIV0(25:11)
  6894     CALL 'kxdfhei1' USING DFHEIV0,
  6895           NAME-FILE-ID,
  6896           NAME-LOOKUP-MASTER,
  6897           DFHEIV11,
  6898           NL-CONTROL-PRIMARY,
  6899           DFHEIV99,
  6900           DFHEIV99
  6901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6902
  6903
  6904 2100-EXIT.
  6905     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 134
* EL6501.cbl
  6907 2200-ADD-COMPENSATION-NAME.
  6908
  6909* EXEC CICS HANDLE CONDITION
  6910*         DUPREC   (2200-EXIT)
  6911*    END-EXEC.
  6912*    MOVE '"$%                   ! & #00006701' TO DFHEIV0
  6913     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6915     MOVE X'2620233030303036373031' TO DFHEIV0(25:11)
  6916     CALL 'kxdfhei1' USING DFHEIV0
  6917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6918
  6919
  6920
  6921* EXEC CICS GETMAIN
  6922*         LENGTH   (NAME-REC-LEN)
  6923*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6924*         INITIMG  (GETMAIN-SPACE)
  6925*    END-EXEC.
  6926*    MOVE ',"IL                  $   #00006705' TO DFHEIV0
  6927     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6928     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6929     MOVE X'2020233030303036373035' TO DFHEIV0(25:11)
  6930     CALL 'kxdfhei1' USING DFHEIV0,
  6931           DFHEIV20,
  6932           NAME-REC-LEN,
  6933           GETMAIN-SPACE
  6934     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6935         DFHEIV20
  6936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6937
  6938
  6939     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6940     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6941     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6942     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6943     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6944     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6945     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6946        MOVE NL-NAME (5:26)      TO NL-NAME
  6947     END-IF
  6948     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6949     MOVE CO-ADDR-STATE          TO  NL-ST
  6950     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6951     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6952     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6953     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6954     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6955     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6956     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6957
  6958
  6959* EXEC CICS WRITE
  6960*        FROM      (NAME-LOOKUP-MASTER)
  6961*        RIDFLD    (NL-CONTROL-PRIMARY)
  6962*        DATASET   (NAME-FILE-ID)
  6963*    END-EXEC.
  6964     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 135
* EL6501.cbl
  6965      NAME-LOOKUP-MASTER
  6966       TO DFHEIV11
  6967*    MOVE '&$ L                  ''   #00006730' TO DFHEIV0
  6968     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6970     MOVE X'2020233030303036373330' TO DFHEIV0(25:11)
  6971     CALL 'kxdfhei1' USING DFHEIV0,
  6972           NAME-FILE-ID,
  6973           NAME-LOOKUP-MASTER,
  6974           DFHEIV11,
  6975           NL-CONTROL-PRIMARY,
  6976           DFHEIV99,
  6977           DFHEIV99
  6978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6979
  6980
  6981 2200-EXIT.
  6982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 136
* EL6501.cbl
  6984 3000-CHANGE-ALL-RECORDS.
  6985     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6986     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  6987
  6988
  6989* EXEC CICS HANDLE CONDITION
  6990*         ENDFILE     (3030-END-FILE)
  6991*    END-EXEC.
  6992*    MOVE '"$''                   ! '' #00006743' TO DFHEIV0
  6993     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6995     MOVE X'2720233030303036373433' TO DFHEIV0(25:11)
  6996     CALL 'kxdfhei1' USING DFHEIV0
  6997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6998
  6999
  7000     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7001
  7002 3010-READ-NEXT.
  7003     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7004
  7005     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7006        GO TO 3030-END-FILE.
  7007
  7008
  7009* EXEC CICS ENDBR
  7010*        DATASET   (ACCT-FILE-ID)
  7011*    END-EXEC.
  7012     MOVE 0
  7013       TO DFHEIV11
  7014*    MOVE '&2                    $   #00006755' TO DFHEIV0
  7015     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7016     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7017     MOVE X'2020233030303036373535' TO DFHEIV0(25:11)
  7018     CALL 'kxdfhei1' USING DFHEIV0,
  7019           ACCT-FILE-ID,
  7020           DFHEIV11,
  7021           DFHEIV99
  7022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7023
  7024     ADD +1                      TO WS-CHANGE-ALL-CNT
  7025
  7026* EXEC CICS READ
  7027*        UPDATE
  7028*        DATASET   (ACCT-FILE-ID)
  7029*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7030*        RIDFLD    (WS-KEY-SAVE)
  7031*    END-EXEC.
  7032*    MOVE '&"S        EU         (   #00006759' TO DFHEIV0
  7033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036373539' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           ACCT-FILE-ID,
  7038           DFHEIV20,
  7039           DFHEIV99,
  7040           WS-KEY-SAVE,
  7041           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 137
* EL6501.cbl
  7042           DFHEIV99,
  7043           DFHEIV99
  7044     SET ADDRESS OF ACCOUNT-MASTER TO
  7045         DFHEIV20
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7047
  7048
  7049     IF NAMEL    GREATER THAN ZERO  OR
  7050        INCAREL  GREATER THAN ZERO  OR
  7051        ADDR1L   GREATER THAN ZERO  OR
  7052        ACITYL   GREATER THAN ZERO  OR
  7053        ASTATEL  GREATER THAN ZERO  OR
  7054        ZIPL     GREATER THAN ZERO  OR
  7055        CLPTOLPL GREATER THAN ZERO  OR
  7056        PHONEL   GREATER THAN ZERO
  7057         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7058
  7059     IF STATUSL > ZERO
  7060        EVALUATE TRUE
  7061           WHEN STATUSI = 'A'
  7062              MOVE '0'           TO AM-STATUS
  7063           WHEN STATUSI = 'I'
  7064              MOVE '1'           TO AM-STATUS
  7065           WHEN (STATUSI = 'C')
  7066              AND (AM-STATUS NOT = '3' AND 'C')
  7067              MOVE '3'           TO AM-STATUS
  7068              SET AUTO-CANCEL-ACCOUNT
  7069                                 TO TRUE
  7070           WHEN (STATUSI = 'C')
  7071              MOVE '3'           TO AM-STATUS
  7072           WHEN STATUSI = 'F'
  7073              MOVE '4'           TO AM-STATUS
  7074           WHEN STATUSI = 'S'
  7075              MOVE '5'           TO AM-STATUS
  7076           WHEN OTHER
  7077              MOVE -1            TO STATUSL
  7078              MOVE AL-UABON      TO STATUSA
  7079              MOVE ER-2153       TO EMI-ERROR
  7080              PERFORM 9900-ERROR-FORMAT
  7081                                 THRU 9900-EXIT
  7082        END-EVALUATE
  7083     END-IF
  7084*    IF STATUSL > ZERO
  7085*       IF STATUSI = 'A'
  7086*          MOVE '0'              TO AM-STATUS
  7087*       ELSE
  7088*          IF STATUSI = 'I'
  7089*             MOVE '1'           TO AM-STATUS
  7090*          ELSE
  7091*             IF STATUSI = 'C'
  7092*                IF AM-STATUS NOT = '3' AND 'C'
  7093*                   SET AUTO-CANCEL-ACCOUNT
  7094*                                TO TRUE
  7095*                END-IF
  7096*                MOVE '3'        TO AM-STATUS
  7097*             ELSE
  7098*                IF STATUSI = 'F'
  7099*                   MOVE '4'     TO AM-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 138
* EL6501.cbl
  7100*                ELSE
  7101*                   MOVE -1         TO STATUSL
  7102*                   MOVE AL-UABON   TO STATUSA
  7103*                   MOVE ER-2153    TO EMI-ERROR
  7104*                   PERFORM 9900-ERROR-FORMAT
  7105*                                THRU 9900-EXIT
  7106*                END-IF
  7107*             END-IF
  7108*          END-IF
  7109*       END-IF
  7110*    END-IF
  7111
  7112     IF CSRL GREATER ZERO
  7113        MOVE CSRI                TO AM-CSR-CODE.
  7114     IF NAMEL GREATER THAN ZERO
  7115        MOVE NAMEI               TO AM-NAME.
  7116     IF PCONTL GREATER THAN ZERO
  7117        MOVE PCONTI              TO AM-CONTROL-NAME
  7118     END-IF
  7119     IF INCAREL GREATER ZEROS
  7120        MOVE INCAREI             TO AM-PERSON.
  7121     IF ADDR1L GREATER ZEROS
  7122        MOVE ADDR1I              TO AM-ADDRS.
  7123     IF ACITYL GREATER ZEROS
  7124        MOVE ACITYI             TO AM-ADDR-CITY.
  7125     IF ASTATEL GREATER ZEROS
  7126        MOVE ASTATEI            TO AM-ADDR-STATE.
  7127     IF ZIPL NOT GREATER ZEROS
  7128         GO TO 3015-CONT-CHANGING.
  7129
  7130     MOVE ZIPI                   TO WS-ZIP-CODE.
  7131
  7132     IF WS-CANADIAN-ZIP
  7133         IF WS-ZIP-4 = SPACE  OR  '-'
  7134             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7135             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7136         ELSE
  7137             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7138             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7139     ELSE
  7140         IF WS-ZIP-6 = SPACE  OR  '-'
  7141             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7142             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7143         ELSE
  7144             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7145             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7146
  7147 3015-CONT-CHANGING.
  7148
  7149     IF CLPTOLPL GREATER ZEROS
  7150
  7151* EXEC CICS BIF
  7152*            DEEDIT
  7153*            FIELD    (CLPTOLPI)
  7154*            LENGTH   (6)
  7155*        END-EXEC
  7156     MOVE 6
  7157       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 139
* EL6501.cbl
  7158*    MOVE '@"L                   #   #00006867' TO DFHEIV0
  7159     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7160     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7161     MOVE X'2020233030303036383637' TO DFHEIV0(25:11)
  7162     CALL 'kxdfhei1' USING DFHEIV0,
  7163           CLPTOLPI,
  7164           DFHEIV11
  7165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7166         IF CLPTOLPI NUMERIC
  7167             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7168         ELSE
  7169             MOVE -1                  TO CLPTOLPL
  7170             MOVE AL-UNBON            TO CLPTOLPA
  7171             MOVE ER-1778             TO EMI-ERROR
  7172             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7173         END-IF
  7174     END-IF
  7175
  7176     IF LCOMML > ZEROS
  7177
  7178* EXEC CICS BIF
  7179*            DEEDIT
  7180*            FIELD    (LCOMMI)
  7181*            LENGTH   (8)
  7182*        END-EXEC
  7183     MOVE 8
  7184       TO DFHEIV11
  7185*    MOVE '@"L                   #   #00006883' TO DFHEIV0
  7186     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7187     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7188     MOVE X'2020233030303036383833' TO DFHEIV0(25:11)
  7189     CALL 'kxdfhei1' USING DFHEIV0,
  7190           LCOMMI,
  7191           DFHEIV11
  7192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7193         IF LCOMMI NUMERIC
  7194            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7195         ELSE
  7196            MOVE -1              TO LCOMML
  7197            MOVE AL-UNBON        TO LCOMMA
  7198            MOVE ER-1778         TO EMI-ERROR
  7199            PERFORM 9900-ERROR-FORMAT
  7200                                 THRU 9900-EXIT
  7201         END-IF
  7202     END-IF
  7203
  7204     IF PHONEL GREATER ZEROS
  7205        MOVE PHONEI              TO DEEDIT-FIELD
  7206        PERFORM 8600-DEEDIT
  7207        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7208        MOVE WS-PH1              TO AM-AREA-CODE
  7209        MOVE WS-PH2              TO AM-TEL-PRE
  7210        MOVE WS-PH3              TO AM-TEL-NBR.
  7211
  7212*    IF PSILFFL GREATER +0
  7213*       MOVE PSILFFI             TO DEEDIT-FIELD
  7214*       PERFORM 8600-DEEDIT
  7215*       IF DEEDIT-FIELD NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 140
* EL6501.cbl
  7216*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7217*
  7218*    IF PSIAHFL GREATER +0
  7219*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7220*       PERFORM 8600-DEEDIT
  7221*       IF DEEDIT-FIELD NUMERIC
  7222*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7223
  7224     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7225     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7226     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7227
  7228     IF ((PI-FST-PAGE)
  7229        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7230                      OR
  7231        ((PI-2ND-PAGE)
  7232        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7233                      OR
  7234        ((PI-3RD-PAGE)
  7235        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7236                      OR
  7237        ((PI-LST-PAGE)
  7238        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7239        SET ON-LAST-DATE-RANGE   TO TRUE
  7240     END-IF
  7241*    IF ((PI-FST-PAGE)
  7242*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7243*                     OR
  7244*       ((PI-2ND-PAGE)
  7245*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7246*                     OR
  7247*       ((PI-3RD-PAGE)
  7248*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7249*                     OR
  7250*       ((PI-LST-PAGE)
  7251*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7252*       SET ON-LAST-DATE-RANGE   TO TRUE
  7253*    END-IF
  7254     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7255     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7256     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7257*    EXEC CICS DELAY
  7258*       INTERVAL (WS-DELAY-INT)
  7259*    END-EXEC
  7260     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7261        CONTINUE
  7262     ELSE
  7263        IF (ON-LAST-DATE-RANGE)
  7264                   OR
  7265           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  7266           (PCONTL > ZERO))
  7267           PERFORM 1700-CHANGE-COMP
  7268                                 THRU 1799-EXIT
  7269        END-IF
  7270     END-IF
  7271
  7272     IF NAMEL GREATER THAN ZERO
  7273         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 141
* EL6501.cbl
  7274
  7275
  7276* EXEC CICS REWRITE
  7277*        FROM      (ACCOUNT-MASTER)
  7278*        DATASET   (ACCT-FILE-ID)
  7279*    END-EXEC.
  7280     MOVE LENGTH OF
  7281      ACCOUNT-MASTER
  7282       TO DFHEIV11
  7283*    MOVE '&& L                  %   #00006970' TO DFHEIV0
  7284     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7285     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7286     MOVE X'2020233030303036393730' TO DFHEIV0(25:11)
  7287     CALL 'kxdfhei1' USING DFHEIV0,
  7288           ACCT-FILE-ID,
  7289           ACCOUNT-MASTER,
  7290           DFHEIV11,
  7291           DFHEIV99
  7292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7293
  7294
  7295     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7296     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7297
  7298     GO TO 3010-READ-NEXT.
  7299
  7300 3030-END-FILE.
  7301     IF BROWSE-STARTED
  7302        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7303
  7304     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7305
  7306     IF AUTO-CANCEL-ACCOUNT
  7307
  7308* EXEC CICS GETMAIN
  7309*          LENGTH   (ERACNT-REC-LEN)
  7310*          SET      (ADDRESS OF NOTE-FILE)
  7311*          INITIMG  (GETMAIN-SPACE)
  7312*          RESP     (WS-RESPONSE)
  7313*       END-EXEC
  7314*    MOVE ',"IL                  $  N#00006987' TO DFHEIV0
  7315     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7317     MOVE X'204E233030303036393837' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0,
  7319           DFHEIV20,
  7320           ERACNT-REC-LEN,
  7321           GETMAIN-SPACE
  7322     SET ADDRESS OF NOTE-FILE TO
  7323         DFHEIV20
  7324     MOVE EIBRESP  TO WS-RESPONSE
  7325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7326        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7327        MOVE '1'                 TO NT-RECORD-TYPE
  7328        MOVE +1                  TO NT-LINE-SEQUENCE
  7329        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7330        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7331        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 142
* EL6501.cbl
  7332        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7333                                 TO NT-NOTE-LINE
  7334        PERFORM WITH TEST AFTER UNTIL
  7335           (NOT RESP-DUPKEY)
  7336           AND (NOT RESP-DUPREC)
  7337
  7338* EXEC CICS WRITE
  7339*             FROM      (NOTE-FILE)
  7340*             RIDFLD    (NT-CONTROL-PRIMARY)
  7341*             DATASET   (ERACNT-FILE-ID)
  7342*             RESP      (WS-RESPONSE)
  7343*          END-EXEC
  7344     MOVE LENGTH OF
  7345      NOTE-FILE
  7346       TO DFHEIV11
  7347*    MOVE '&$ L                  ''  N#00007004' TO DFHEIV0
  7348     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7350     MOVE X'204E233030303037303034' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0,
  7352           ERACNT-FILE-ID,
  7353           NOTE-FILE,
  7354           DFHEIV11,
  7355           NT-CONTROL-PRIMARY,
  7356           DFHEIV99,
  7357           DFHEIV99
  7358     MOVE EIBRESP  TO WS-RESPONSE
  7359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7360           IF RESP-DUPKEY OR RESP-DUPREC
  7361              ADD +1             TO NT-LINE-SEQUENCE
  7362           END-IF
  7363        END-PERFORM
  7364     END-IF
  7365     IF NOT EMI-NO-ERRORS
  7366         GO TO 8200-SEND-DATAONLY.
  7367
  7368     MOVE -1                     TO NAMEL.
  7369     MOVE ER-0000                TO EMI-ERROR.
  7370     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7371     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 143
* EL6501.cbl
  7373 3500-CHANGE-ALL-CSR.
  7374     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7375     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7376                                    WS-ACCT-REST-OF-EXP.
  7377
  7378
  7379* EXEC CICS HANDLE CONDITION
  7380*         ENDFILE     (3530-END-FILE)
  7381*    END-EXEC.
  7382*    MOVE '"$''                   ! ( #00007028' TO DFHEIV0
  7383     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7385     MOVE X'2820233030303037303238' TO DFHEIV0(25:11)
  7386     CALL 'kxdfhei1' USING DFHEIV0
  7387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7388
  7389
  7390     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7391
  7392 3510-READ-NEXT.
  7393     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7394
  7395     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7396        GO TO 3530-END-FILE.
  7397
  7398
  7399* EXEC CICS ENDBR
  7400*        DATASET   (ACCT-FILE-ID)
  7401*    END-EXEC.
  7402     MOVE 0
  7403       TO DFHEIV11
  7404*    MOVE '&2                    $   #00007040' TO DFHEIV0
  7405     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7407     MOVE X'2020233030303037303430' TO DFHEIV0(25:11)
  7408     CALL 'kxdfhei1' USING DFHEIV0,
  7409           ACCT-FILE-ID,
  7410           DFHEIV11,
  7411           DFHEIV99
  7412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7413
  7414
  7415
  7416* EXEC CICS READ
  7417*        UPDATE
  7418*        DATASET   (ACCT-FILE-ID)
  7419*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7420*        RIDFLD    (WS-KEY-SAVE)
  7421*    END-EXEC.
  7422*    MOVE '&"S        EU         (   #00007044' TO DFHEIV0
  7423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7424     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7425     MOVE X'2020233030303037303434' TO DFHEIV0(25:11)
  7426     CALL 'kxdfhei1' USING DFHEIV0,
  7427           ACCT-FILE-ID,
  7428           DFHEIV20,
  7429           DFHEIV99,
  7430           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 144
* EL6501.cbl
  7431           DFHEIV99,
  7432           DFHEIV99,
  7433           DFHEIV99
  7434     SET ADDRESS OF ACCOUNT-MASTER TO
  7435         DFHEIV20
  7436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7437
  7438
  7439     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7440     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7441     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7442
  7443     MOVE CSRI                   TO AM-CSR-CODE.
  7444
  7445
  7446* EXEC CICS REWRITE
  7447*        FROM      (ACCOUNT-MASTER)
  7448*        DATASET   (ACCT-FILE-ID)
  7449*    END-EXEC.
  7450     MOVE LENGTH OF
  7451      ACCOUNT-MASTER
  7452       TO DFHEIV11
  7453*    MOVE '&& L                  %   #00007057' TO DFHEIV0
  7454     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7455     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7456     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7457     CALL 'kxdfhei1' USING DFHEIV0,
  7458           ACCT-FILE-ID,
  7459           ACCOUNT-MASTER,
  7460           DFHEIV11,
  7461           DFHEIV99
  7462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7463
  7464
  7465     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7466     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7467
  7468     GO TO 3510-READ-NEXT.
  7469
  7470 3530-END-FILE.
  7471     IF BROWSE-STARTED
  7472        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7473
  7474     MOVE ER-4009                TO EMI-ERROR.
  7475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7476     MOVE LOW-VALUES             TO EL6501AI.
  7477
  7478     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7479     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7480     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7481
  7482     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7483
  7484     MOVE -1                     TO MAINTL.
  7485     MOVE AL-UANON               TO MAINTA.
  7486     GO TO 8100-SEND-INITIAL-MAP.
  7487
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 145
* EL6501.cbl
  7489 4000-EDITS.
  7490     IF PI-COMPANY-ID = 'NCL'
  7491      IF MAINTI = 'A' OR 'C'
  7492        IF CSRL GREATER ZEROS
  7493            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7494          ELSE
  7495            IF MAINTI = 'A'
  7496                MOVE ER-1883         TO EMI-ERROR
  7497                MOVE -1              TO CSRL
  7498                MOVE AL-UABON        TO CSRA
  7499                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7500
  7501     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7502        IF NAMEL NOT GREATER ZEROS
  7503           IF MAINTI = 'C'
  7504              GO TO 4070-CHECK-STATUS
  7505           ELSE
  7506              MOVE -1               TO  NAMEL
  7507              MOVE AL-UABON         TO  NAMEA
  7508              MOVE ER-2045          TO  EMI-ERROR
  7509              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7510        ELSE
  7511            GO TO 4065-CHECK-ASSOCIATES.
  7512
  7513     IF TYPEL NOT GREATER ZEROS
  7514        IF MAINTI = 'C'
  7515           GO TO 4050-CONTINUE
  7516        ELSE
  7517           GO TO 4020-BUS-TYPE-ERROR.
  7518
  7519     IF TYPEI NOT NUMERIC
  7520        GO TO 4020-BUS-TYPE-ERROR
  7521     ELSE
  7522        IF TYPEI LESS 1 OR GREATER 99
  7523           GO TO 4020-BUS-TYPE-ERROR.
  7524
  7525     MOVE SPACES                 TO ELCNTL-KEY.
  7526
  7527     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7528     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7529     MOVE '8'                    TO CNTL-REC-TYPE.
  7530     MOVE +0                     TO CNTL-SEQ-NO.
  7531
  7532
  7533* EXEC CICS HANDLE CONDITION
  7534*        NOTFND   (4020-BUS-TYPE-ERROR)
  7535*    END-EXEC.
  7536*    MOVE '"$I                   ! ) #00007129' TO DFHEIV0
  7537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7539     MOVE X'2920233030303037313239' TO DFHEIV0(25:11)
  7540     CALL 'kxdfhei1' USING DFHEIV0
  7541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7542
  7543
  7544
  7545* EXEC CICS READ
  7546*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 146
* EL6501.cbl
  7547*        DATASET   (CNTL-FILE-ID)
  7548*        SET       (ADDRESS OF CONTROL-FILE)
  7549*        RIDFLD    (ELCNTL-KEY)
  7550*    END-EXEC.
  7551*    MOVE '&"S        G          (   #00007133' TO DFHEIV0
  7552     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7554     MOVE X'2020233030303037313333' TO DFHEIV0(25:11)
  7555     CALL 'kxdfhei1' USING DFHEIV0,
  7556           CNTL-FILE-ID,
  7557           DFHEIV20,
  7558           DFHEIV99,
  7559           ELCNTL-KEY,
  7560           DFHEIV99,
  7561           DFHEIV99,
  7562           DFHEIV99
  7563     SET ADDRESS OF CONTROL-FILE TO
  7564         DFHEIV20
  7565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7566
  7567
  7568     IF TYPEI LESS 21
  7569        MOVE TYPEI               TO WS-BUS-ENTRY
  7570     ELSE
  7571        DIVIDE TYPEI BY 20
  7572            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7573        IF WS-BUS-ENTRY = ZEROS
  7574           MOVE 20               TO WS-BUS-ENTRY.
  7575
  7576     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7577        GO TO 4050-CONTINUE.
  7578
  7579 4020-BUS-TYPE-ERROR.
  7580     MOVE -1                     TO TYPEL.
  7581     MOVE AL-UNBON               TO TYPEA.
  7582     MOVE ER-2178                TO EMI-ERROR.
  7583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7584
  7585 4050-CONTINUE.
  7586     IF ASTATEL > 0
  7587        MOVE SPACES                 TO  ELCNTL-KEY
  7588        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7589        MOVE '3'                    TO  CNTL-REC-TYPE
  7590        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7591        MOVE +0                     TO  CNTL-SEQ-NO
  7592
  7593* EXEC CICS  READ
  7594*           DATASET  ('ELCNTL')
  7595*           SET      (ADDRESS OF CONTROL-FILE)
  7596*           RIDFLD   (ELCNTL-KEY)
  7597*           RESP     (WS-RESPONSE)
  7598*       END-EXEC
  7599     MOVE 'ELCNTL' TO DFHEIV1
  7600*    MOVE '&"S        E          (  N#00007164' TO DFHEIV0
  7601     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7603     MOVE X'204E233030303037313634' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 147
* EL6501.cbl
  7605           DFHEIV1,
  7606           DFHEIV20,
  7607           DFHEIV99,
  7608           ELCNTL-KEY,
  7609           DFHEIV99,
  7610           DFHEIV99,
  7611           DFHEIV99
  7612     SET ADDRESS OF CONTROL-FILE TO
  7613         DFHEIV20
  7614     MOVE EIBRESP  TO WS-RESPONSE
  7615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7616        IF NOT RESP-NORMAL
  7617           MOVE ER-0144                TO  EMI-ERROR
  7618           MOVE -1                     TO  ASTATEL
  7619           MOVE AL-UABON               TO  ASTATEA
  7620           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7621        END-IF
  7622     ELSE
  7623        IF MAINTI = 'A'
  7624           MOVE ER-0144                TO  EMI-ERROR
  7625           MOVE -1                     TO  ASTATEL
  7626           MOVE AL-UABON               TO  ASTATEA
  7627           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7628        END-IF
  7629     END-IF
  7630     IF INDGRPL NOT GREATER ZEROS
  7631        IF MAINTI = 'C'
  7632           GO TO 4070-CHECK-STATUS
  7633        ELSE
  7634           GO TO 4060-IG-ERROR.
  7635
  7636     IF INDGRPI = 'I' OR 'G'
  7637        GO TO 4070-CHECK-STATUS.
  7638
  7639 4060-IG-ERROR.
  7640     MOVE -1                     TO INDGRPL.
  7641     MOVE AL-UABON               TO INDGRPA.
  7642     MOVE ER-2152                TO EMI-ERROR.
  7643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7644
  7645 4065-CHECK-ASSOCIATES.
  7646     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7647        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7648        MOVE  NAMEI              TO  WS-NAME-AREA
  7649     ELSE
  7650        GO TO 4070-CHECK-STATUS.
  7651
  7652     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7653        NEXT SENTENCE
  7654     ELSE
  7655        MOVE -1                  TO  NAMEL
  7656        MOVE AL-UABON            TO  NAMEA
  7657        MOVE ER-0788             TO  EMI-ERROR
  7658        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7659
  7660 4070-CHECK-STATUS.
  7661     IF STATUSL NOT GREATER ZEROS
  7662        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 148
* EL6501.cbl
  7663           GO TO 4090-CHECK-STD-AH-TYPE
  7664        ELSE
  7665           MOVE 'A'              TO STATUSI
  7666           MOVE AL-UANON         TO STATUSA
  7667           GO TO 4090-CHECK-STD-AH-TYPE.
  7668
  7669     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7670        GO TO 4090-CHECK-STD-AH-TYPE.
  7671
  7672 4080-STATUS-ERROR.
  7673     MOVE -1                     TO STATUSL.
  7674     MOVE AL-UABON               TO STATUSA.
  7675     MOVE ER-2153                TO EMI-ERROR.
  7676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7677
  7678 4090-CHECK-STD-AH-TYPE.
  7679
  7680     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7681         GO TO 4900-EXIT.
  7682
  7683     IF STDBENL NOT GREATER ZEROS
  7684        IF MAINTI = 'C'
  7685*          GO TO 4110-CHECK-REMIT
  7686           GO TO 4100-CHECK-CLPTOLP
  7687        ELSE
  7688           MOVE ZEROS            TO STDBENI
  7689           MOVE AL-UANON         TO STDBENA
  7690*          GO TO 4110-CHECK-REMIT.
  7691           GO TO 4100-CHECK-CLPTOLP.
  7692
  7693     IF STDBENI = SPACES
  7694         MOVE ZEROS               TO STDBENI.
  7695     IF STDBENI = ZEROS
  7696*        GO TO 4110-CHECK-REMIT.
  7697         GO TO 4100-CHECK-CLPTOLP.
  7698
  7699     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7700     IF INVALID-BENEFIT-CODE
  7701        GO TO 4099-STD-BEN-ERROR.
  7702
  7703     MOVE SPACES                 TO ELCNTL-KEY.
  7704
  7705     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7706     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7707     MOVE '5'                    TO CNTL-REC-TYPE.
  7708     MOVE +0                     TO CNTL-SEQ-NO.
  7709
  7710
  7711* EXEC CICS HANDLE CONDITION
  7712*        NOTFND   (4099-STD-BEN-ERROR)
  7713*    END-EXEC.
  7714*    MOVE '"$I                   ! * #00007264' TO DFHEIV0
  7715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7717     MOVE X'2A20233030303037323634' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7720
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 149
* EL6501.cbl
  7721
  7722
  7723* EXEC CICS READ
  7724*        GTEQ
  7725*        DATASET   (CNTL-FILE-ID)
  7726*        SET       (ADDRESS OF CONTROL-FILE)
  7727*        RIDFLD    (ELCNTL-KEY)
  7728*    END-EXEC.
  7729*    MOVE '&"S        G          (   #00007268' TO DFHEIV0
  7730     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7732     MOVE X'2020233030303037323638' TO DFHEIV0(25:11)
  7733     CALL 'kxdfhei1' USING DFHEIV0,
  7734           CNTL-FILE-ID,
  7735           DFHEIV20,
  7736           DFHEIV99,
  7737           ELCNTL-KEY,
  7738           DFHEIV99,
  7739           DFHEIV99,
  7740           DFHEIV99
  7741     SET ADDRESS OF CONTROL-FILE TO
  7742         DFHEIV20
  7743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7744
  7745
  7746     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7747        CNTL-REC-TYPE = CF-RECORD-TYPE
  7748         MOVE 1                  TO SUB
  7749     ELSE
  7750         GO TO 4099-STD-BEN-ERROR.
  7751
  7752 4095-CHECK-BEN-TYPE.
  7753     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7754*       GO TO 4110-CHECK-REMIT.
  7755        GO TO 4100-CHECK-CLPTOLP.
  7756
  7757     IF SUB LESS 8
  7758         ADD 1 TO SUB
  7759         GO TO 4095-CHECK-BEN-TYPE.
  7760
  7761 4099-STD-BEN-ERROR.
  7762     MOVE -1                     TO STDBENL.
  7763     MOVE AL-UABON               TO STDBENA.
  7764     MOVE ER-0250                TO EMI-ERROR.
  7765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7766
  7767 4100-CHECK-CLPTOLP.
  7768
  7769     IF CLPTOLPL > ZERO
  7770
  7771* EXEC CICS BIF
  7772*            DEEDIT
  7773*            FIELD    (CLPTOLPI)
  7774*            LENGTH   (6)
  7775*        END-EXEC
  7776     MOVE 6
  7777       TO DFHEIV11
  7778*    MOVE '@"L                   #   #00007299' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 150
* EL6501.cbl
  7779     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7780     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7781     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  7782     CALL 'kxdfhei1' USING DFHEIV0,
  7783           CLPTOLPI,
  7784           DFHEIV11
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7786         IF CLPTOLPI NOT NUMERIC
  7787             MOVE ER-1778        TO EMI-ERROR
  7788             MOVE -1             TO CLPTOLPL
  7789             MOVE AL-UNBON       TO CLPTOLPA
  7790             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7791         END-IF
  7792     END-IF.
  7793     IF LCOMML > ZERO
  7794
  7795* EXEC CICS BIF
  7796*            DEEDIT
  7797*            FIELD    (LCOMMI)
  7798*            LENGTH   (8)
  7799*        END-EXEC
  7800     MOVE 8
  7801       TO DFHEIV11
  7802*    MOVE '@"L                   #   #00007312' TO DFHEIV0
  7803     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7805     MOVE X'2020233030303037333132' TO DFHEIV0(25:11)
  7806     CALL 'kxdfhei1' USING DFHEIV0,
  7807           LCOMMI,
  7808           DFHEIV11
  7809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7810         IF LCOMMI NOT NUMERIC
  7811             MOVE ER-1778        TO EMI-ERROR
  7812             MOVE -1             TO LCOMML
  7813             MOVE AL-UNBON       TO LCOMMA
  7814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7815         END-IF
  7816     END-IF
  7817     IF MAXMFEEL > ZEROS
  7818
  7819* EXEC CICS BIF DEEDIT
  7820*          FIELD   (MAXMFEEI)
  7821*          LENGTH  (5)
  7822*       END-EXEC
  7823     MOVE 5
  7824       TO DFHEIV11
  7825*    MOVE '@"L                   #   #00007325' TO DFHEIV0
  7826     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7827     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7828     MOVE X'2020233030303037333235' TO DFHEIV0(25:11)
  7829     CALL 'kxdfhei1' USING DFHEIV0,
  7830           MAXMFEEI,
  7831           DFHEIV11
  7832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7833        IF MAXMFEEI NUMERIC
  7834           MOVE MAXMFEEI         TO WS-WORK-FIELD
  7835           MOVE WS-WORK-NUM      TO MAXMFEEO
  7836        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 151
* EL6501.cbl
  7837           MOVE -1               TO MAXMFEEL
  7838           MOVE AL-UABON         TO MAXMFEEA
  7839           MOVE ER-7717          TO EMI-ERROR
  7840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7841        END-IF
  7842     END-IF
  7843     IF (CLPSTL > 0)
  7844         MOVE AL-UANON           TO CLPSTA
  7845        IF (CLPSTI NOT = SPACES)
  7846           MOVE SPACES           TO ELCNTL-KEY
  7847           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7848           MOVE '3'              TO CNTL-REC-TYPE
  7849           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7850           MOVE +0               TO CNTL-SEQ-NO
  7851
  7852* EXEC CICS  READ
  7853*              DATASET  ('ELCNTL')
  7854*              SET      (ADDRESS OF CONTROL-FILE)
  7855*              RIDFLD   (ELCNTL-KEY)
  7856*              RESP     (WS-RESPONSE)
  7857*          END-EXEC
  7858     MOVE 'ELCNTL' TO DFHEIV1
  7859*    MOVE '&"S        E          (  N#00007347' TO DFHEIV0
  7860     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7861     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7862     MOVE X'204E233030303037333437' TO DFHEIV0(25:11)
  7863     CALL 'kxdfhei1' USING DFHEIV0,
  7864           DFHEIV1,
  7865           DFHEIV20,
  7866           DFHEIV99,
  7867           ELCNTL-KEY,
  7868           DFHEIV99,
  7869           DFHEIV99,
  7870           DFHEIV99
  7871     SET ADDRESS OF CONTROL-FILE TO
  7872         DFHEIV20
  7873     MOVE EIBRESP  TO WS-RESPONSE
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7875           IF NOT RESP-NORMAL
  7876              MOVE ER-0144       TO EMI-ERROR
  7877              MOVE -1            TO CLPSTL
  7878              MOVE AL-UABON      TO CLPSTA
  7879              PERFORM 9900-ERROR-FORMAT
  7880                                 THRU  9900-EXIT
  7881           END-IF
  7882        ELSE
  7883           MOVE ER-0144          TO EMI-ERROR
  7884           MOVE -1               TO CLPSTL
  7885           MOVE AL-UABON         TO CLPSTA
  7886           PERFORM 9900-ERROR-FORMAT
  7887                                 THRU  9900-EXIT
  7888        END-IF
  7889     END-IF
  7890     IF (PRODCDL > ZEROS)
  7891        and (emi-error not = er-0144)
  7892        move low-values          to erpdef-key
  7893        move pi-company-cd       to erpdef-company-cd
  7894        move clpsti              to erpdef-state
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 152
* EL6501.cbl
  7895        move prodcdi             to erpdef-prod-cd
  7896        move erpdef-key          to erpdef-key-save
  7897
  7898* exec cics read
  7899*          dataset ('ERPDEF')
  7900*          set     (address of product-master)
  7901*          ridfld  (erpdef-key)
  7902*          length  (6)
  7903*          gteq
  7904*          resp    (ws-response)
  7905*       end-exec
  7906     MOVE 'ERPDEF' TO DFHEIV1
  7907*    MOVE '&"S        G          (  N#00007375' TO DFHEIV0
  7908     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7910     MOVE X'204E233030303037333735' TO DFHEIV0(25:11)
  7911     CALL 'kxdfhei1' USING DFHEIV0,
  7912           DFHEIV1,
  7913           DFHEIV20,
  7914           DFHEIV99,
  7915           erpdef-key,
  7916           DFHEIV99,
  7917           DFHEIV99,
  7918           DFHEIV99
  7919     SET ADDRESS OF product-master TO
  7920         DFHEIV20
  7921     MOVE EIBRESP  TO ws-response
  7922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7923        if (resp-normal)
  7924           and (pd-control-primary (1:6) = erpdef-key-save (1:6))
  7925           continue
  7926        else
  7927           move er-8156          to emi-error
  7928           MOVE -1               TO PRODCDL
  7929           MOVE AL-UABON         TO PRODCDA
  7930           PERFORM 9900-ERROR-FORMAT
  7931                                 THRU  9900-EXIT
  7932        end-if
  7933     end-if
  7934     .
  7935 4110-CHECK-REMIT.
  7936     IF REMITL NOT GREATER ZEROS
  7937        MOVE 1                   TO REMITI
  7938        MOVE AL-UNNON            TO REMITA
  7939        GO TO 4120-REMIT-ERROR.
  7940
  7941     IF (REMITI NOT NUMERIC)  OR
  7942        (REMITI LESS 1 OR GREATER 10)
  7943           GO TO 4120-REMIT-ERROR.
  7944
  7945 4115-CHECK-AGENT.
  7946     SET M-INDEX                 TO REMITI.
  7947
  7948     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7949        MOVE ER-2156             TO EMI-ERROR
  7950        GO TO 4120-R-ERROR.
  7951
  7952     GO TO 4130-CHECK-CONTRACT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 153
* EL6501.cbl
  7953
  7954 4120-REMIT-ERROR.
  7955     MOVE ER-2155                TO EMI-ERROR.
  7956
  7957 4120-R-ERROR.
  7958     MOVE -1                     TO REMITL.
  7959     MOVE AL-UABON               TO REMITA.
  7960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7961
  7962 4130-CHECK-CONTRACT.
  7963     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7964        MOVE CONTRI                TO DEEDIT-FIELD
  7965        PERFORM 8600-DEEDIT
  7966        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7967        MOVE '4'                    TO DC-OPTION-CODE
  7968        PERFORM 9700-DATE-LINK
  7969        IF DATE-CONVERSION-ERROR
  7970           MOVE ER-2157             TO EMI-ERROR
  7971           MOVE -1                  TO CONTRL
  7972           MOVE AL-UABON            TO CONTRA
  7973           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7974        ELSE
  7975***  Y2K PROJ 7744
  7976           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7977           MOVE AL-UANON            TO CONTRA
  7978           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7979           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7980        END-IF
  7981     END-IF.
  7982***  Y2K PROJ 7744
  7983
  7984     IF PI-COMPANY-ID = 'DMD'
  7985       IF PI-MAINT = 'A'
  7986        IF CONTRL = ZERO
  7987           MOVE ER-0852             TO EMI-ERROR
  7988           MOVE -1                  TO CONTRL
  7989           MOVE AL-UABON            TO CONTRA
  7990           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7991
  7992*4131-CHECK-PSI-FACTOR.
  7993*    IF PSILFFL GREATER +0
  7994*       MOVE PSILFFI             TO DEEDIT-FIELD
  7995*       PERFORM 8600-DEEDIT
  7996*       IF DEEDIT-FIELD NUMERIC
  7997*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  7998*                                   PSILFFO
  7999*       ELSE
  8000*          MOVE ER-9999          TO EMI-ERROR
  8001*          MOVE -1               TO PSILFFL
  8002*          MOVE AL-UABON         TO PSILFFA
  8003*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8004*
  8005*    IF PSIAHFL GREATER +0
  8006*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8007*       PERFORM 8600-DEEDIT
  8008*       IF DEEDIT-FIELD NUMERIC
  8009*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8010*                                   PSIAHFO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 154
* EL6501.cbl
  8011*       ELSE
  8012*          MOVE ER-9999          TO EMI-ERROR
  8013*          MOVE -1               TO PSIAHFL
  8014*          MOVE AL-UABON         TO PSIAHFA
  8015*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8016
  8017 4135-CHECK-PREVIOUS-DATES.
  8018     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8019        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8020        PERFORM 8600-DEEDIT
  8021        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8022        MOVE '4'                    TO DC-OPTION-CODE
  8023        PERFORM 9700-DATE-LINK
  8024        IF DATE-CONVERSION-ERROR
  8025           MOVE ER-0348             TO EMI-ERROR
  8026           MOVE -1                  TO PEFFDTEL
  8027           MOVE AL-UABON            TO PEFFDTEA
  8028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029        ELSE
  8030***  Y2K PROJ 7744
  8031           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8032           MOVE AL-UANON            TO PEFFDTEA
  8033           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8034           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8035        END-IF
  8036     END-IF.
  8037
  8038     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8039        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8040        PERFORM 8600-DEEDIT
  8041        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8042           MOVE '99/99/99'             TO PEXPDTEO
  8043           MOVE 99999999999            TO WS-PEXP-DT
  8044           MOVE AL-UANON               TO PEXPDTEA
  8045        ELSE
  8046           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8047           MOVE '4'                    TO DC-OPTION-CODE
  8048           PERFORM 9700-DATE-LINK
  8049           IF DATE-CONVERSION-ERROR
  8050              MOVE ER-0454             TO EMI-ERROR
  8051              MOVE -1                  TO PEXPDTEL
  8052              MOVE AL-UABON            TO PEXPDTEA
  8053              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8054           ELSE
  8055              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8056              MOVE AL-UANON            TO PEXPDTEA
  8057              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8058              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8059           END-IF
  8060        END-IF
  8061     END-IF.
  8062***  Y2K PROJ 7744
  8063
  8064     IF COMMCALL NOT GREATER ZEROS
  8065         GO TO 4150-CHECK-REINCAL.
  8066
  8067     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8068         (EFFCHG-SAVE LESS 841101)       AND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 155
* EL6501.cbl
  8069         (COMMCALI = 'Y' OR '1')         AND
  8070         (NOT MODIFY-CAP)
  8071           MOVE -1               TO COMMCALL
  8072           MOVE AL-UABON         TO COMMCALA
  8073           MOVE ER-2189          TO EMI-ERROR
  8074           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8075
  8076     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8077         GO TO 4150-CHECK-REINCAL.
  8078
  8079 4140-COMMCAL-ERROR.
  8080     MOVE -1                     TO COMMCALL.
  8081     MOVE AL-UABON               TO COMMCALA.
  8082     MOVE ER-2158                TO EMI-ERROR.
  8083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8084
  8085 4150-CHECK-REINCAL.
  8086     IF REINCALL NOT GREATER ZEROS
  8087         GO TO 4170-CHECK-REINTAB.
  8088
  8089     IF REINCALI = 'Y' OR 'N'
  8090        GO TO 4170-CHECK-REINTAB.
  8091
  8092 4160-REINCAL-ERROR.
  8093     MOVE -1                     TO REINCALL.
  8094     MOVE AL-UABON               TO REINCALA.
  8095     MOVE ER-2179                TO EMI-ERROR.
  8096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8097
  8098 4170-CHECK-REINTAB.
  8099     IF REINTABL NOT GREATER ZEROS
  8100        IF PI-COMPANY-ID = 'NCL' AND
  8101           MAINTI = 'A'
  8102                MOVE ER-4010         TO EMI-ERROR
  8103                MOVE -1              TO REINTABL
  8104                MOVE AL-UABON        TO REINTABA
  8105                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8106
  8107     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8108         GO TO 4410-CHECK-AGENTS.
  8109     IF PI-COMPANY-ID = 'CID'
  8110        IF PI-ACCT-STATE = 'KY'
  8111           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8112              MOVE -1            TO REINTABL
  8113              MOVE AL-UABON      TO REINTABA
  8114              MOVE ER-2159       TO EMI-ERROR
  8115              PERFORM 9900-ERROR-FORMAT
  8116                                 THRU 9900-EXIT
  8117           END-IF
  8118        END-IF
  8119     END-IF
  8120     MOVE LOW-VALUES             TO REIN-KEY.
  8121
  8122     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8123     MOVE 'A'                    TO REIN-CODE.
  8124     MOVE REINTABI               TO REIN-TABLE.
  8125
  8126
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 156
* EL6501.cbl
  8127* EXEC CICS HANDLE CONDITION
  8128*        NOTFND   (4180-REIN-ERROR)
  8129*    END-EXEC.
  8130*    MOVE '"$I                   ! + #00007586' TO DFHEIV0
  8131     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8133     MOVE X'2B20233030303037353836' TO DFHEIV0(25:11)
  8134     CALL 'kxdfhei1' USING DFHEIV0
  8135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8136
  8137
  8138
  8139* EXEC CICS READ
  8140*        DATASET   (REIN-FILE-ID)
  8141*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8142*        RIDFLD    (REIN-KEY)
  8143*    END-EXEC.
  8144*    MOVE '&"S        E          (   #00007590' TO DFHEIV0
  8145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8147     MOVE X'2020233030303037353930' TO DFHEIV0(25:11)
  8148     CALL 'kxdfhei1' USING DFHEIV0,
  8149           REIN-FILE-ID,
  8150           DFHEIV20,
  8151           DFHEIV99,
  8152           REIN-KEY,
  8153           DFHEIV99,
  8154           DFHEIV99,
  8155           DFHEIV99
  8156     SET ADDRESS OF REINSURANCE-RECORD TO
  8157         DFHEIV20
  8158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8159
  8160
  8161     GO TO 4410-CHECK-AGENTS.
  8162
  8163 4180-REIN-ERROR.
  8164     MOVE -1                     TO REINTABL.
  8165     MOVE AL-UABON               TO REINTABA.
  8166     MOVE ER-2615                TO EMI-ERROR.
  8167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8168
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 157
* EL6501.cbl
  8170 4410-CHECK-AGENTS.
  8171     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8172     SET M-INDEX TO 1.
  8173
  8174     IF PI-COMPANY-ID = 'NCL'
  8175       IF AGENTL (M-INDEX) GREATER ZEROS
  8176         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8177
  8178 4420-LOOP.
  8179     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8180        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8181            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8182           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8183           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8184           A-HL    (M-INDEX) GREATER ZEROS  OR
  8185           RECALL  (M-INDEX) GREATER ZEROS  OR
  8186           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8187           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8188           GLCODEL (M-INDEX) GREATER ZEROS
  8189           MOVE ER-2172          TO EMI-ERROR
  8190           MOVE -1               TO AGENTL (M-INDEX)
  8191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8192           GO TO 4450-BUMP-INDEX
  8193        ELSE
  8194           GO TO 4450-BUMP-INDEX.
  8195
  8196     IF AGENT (M-INDEX) = ZEROS
  8197         MOVE ER-2970            TO  EMI-ERROR
  8198         MOVE -1                 TO  AGENTL (M-INDEX)
  8199         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201         GO TO 4450-BUMP-INDEX.
  8202
  8203     IF ATYPEL (M-INDEX) = ZEROS
  8204        MOVE -1                  TO ATYPEL (M-INDEX)
  8205        MOVE ER-2173             TO EMI-ERROR
  8206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8207        GO TO 4430-CHECK-SINGLE.
  8208
  8209     IF ATYPE (M-INDEX) = 'C'
  8210        ADD 1                    TO WS-ACCOUNT-CTR-C
  8211       ELSE
  8212        IF ATYPE (M-INDEX) = 'R'
  8213           ADD 1                 TO WS-ACCOUNT-CTR-R
  8214          ELSE
  8215           IF ATYPE (M-INDEX) = 'D'
  8216              ADD 1                 TO WS-ACCOUNT-CTR-D
  8217             ELSE
  8218              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8219                                OR 'B' OR 'I' OR 'K' OR 'L'
  8220                                OR 'J' OR 'M' OR 'A' OR 'N'
  8221                 NEXT SENTENCE
  8222                ELSE
  8223                 IF ATYPE (M-INDEX) = SPACES
  8224                    NEXT SENTENCE
  8225                   ELSE
  8226                    MOVE ER-2175       TO EMI-ERROR
  8227                    MOVE -1            TO ATYPEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 158
* EL6501.cbl
  8228                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8229                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8230
  8231 4430-CHECK-SINGLE.
  8232     IF SINGLEL (M-INDEX) GREATER ZEROS
  8233        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8234           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8235           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8236           MOVE LOW-VALUES                 TO COMM-FILLER
  8237           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8238           IF COMMISSION-ERROR
  8239              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8240              MOVE -1            TO SINGLEL (M-INDEX)
  8241           ELSE
  8242            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8243              MOVE -1            TO MAINTL
  8244              MOVE ER-1884       TO EMI-ERROR
  8245              PERFORM 9900-ERROR-FORMAT
  8246                                 THRU 9900-EXIT
  8247            END-IF
  8248           END-IF
  8249        END-IF
  8250     END-IF
  8251
  8252     IF JOINTL (M-INDEX) GREATER ZEROS
  8253        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8254           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8255           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8256           MOVE LOW-VALUES                 TO COMM-FILLER
  8257           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8258           IF COMMISSION-ERROR
  8259              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8260              MOVE -1            TO JOINTL (M-INDEX)
  8261           ELSE
  8262            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8263              MOVE -1            TO MAINTL
  8264              MOVE ER-1885       TO EMI-ERROR
  8265              PERFORM 9900-ERROR-FORMAT
  8266                                 THRU 9900-EXIT
  8267            END-IF
  8268           END-IF
  8269        END-IF
  8270     END-IF
  8271
  8272     IF A-HL (M-INDEX) GREATER ZEROS
  8273        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8274           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8275           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8276           MOVE LOW-VALUES                 TO COMM-FILLER
  8277           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8278           IF COMMISSION-ERROR
  8279              MOVE AL-UABON      TO A-HA (M-INDEX)
  8280              MOVE -1            TO A-HL (M-INDEX)
  8281           ELSE
  8282            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8283              MOVE -1            TO MAINTL
  8284              MOVE ER-1886       TO EMI-ERROR
  8285              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 159
* EL6501.cbl
  8286                                 THRU 9900-EXIT
  8287            END-IF
  8288           END-IF
  8289        END-IF
  8290     END-IF
  8291
  8292     IF RECALL (M-INDEX) GREATER ZEROS
  8293         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8294             MOVE AL-UANON       TO RECALA (M-INDEX)
  8295         ELSE
  8296             MOVE -1             TO RECALL (M-INDEX)
  8297             MOVE AL-UABON       TO RECALA (M-INDEX)
  8298             MOVE ER-2158        TO EMI-ERROR
  8299             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8300
  8301     IF RCOMML (M-INDEX) GREATER ZEROS
  8302         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8303             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8304         ELSE
  8305             MOVE -1             TO RCOMML (M-INDEX)
  8306             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8307             MOVE ER-0625        TO EMI-ERROR
  8308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8309
  8310     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8311         IF  CHGBCK (M-INDEX)    NUMERIC
  8312             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8313         ELSE
  8314             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8315             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8316             MOVE  ER-0759         TO  EMI-ERROR
  8317             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8318
  8319     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8320         IF  GLCODE (M-INDEX)    NUMERIC
  8321             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8322         ELSE
  8323             MOVE  -1              TO  GLCODEL (M-INDEX)
  8324             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8325             MOVE  ER-0759         TO  EMI-ERROR
  8326             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8327
  8328     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8329        AND 'J'
  8330         GO TO 4450-BUMP-INDEX.
  8331
  8332     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8333         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8334
  8335     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8336         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8337
  8338     IF A-H-COMM-R (M-INDEX) NUMERIC
  8339        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8340     END-IF
  8341     .
  8342 4450-BUMP-INDEX.
  8343     SET M-INDEX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 160
* EL6501.cbl
  8344
  8345     IF M-INDEX NOT = 11
  8346        GO TO 4420-LOOP.
  8347
  8348     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8349        WS-ACCOUNT-CTR-D = ZEROS AND
  8350        WS-ACCOUNT-CTR-R = ZEROS
  8351          MOVE ER-2177             TO EMI-ERROR
  8352          MOVE -1                  TO AGENTL (1)
  8353          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8354          GO TO 4900-EXIT.
  8355
  8356     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8357         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8358        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8359         WS-ACCOUNT-CTR-D  GREATER 0)
  8360           MOVE ER-2174             TO EMI-ERROR
  8361           MOVE -1                  TO AGENTL (1)
  8362           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8363           GO TO 4900-EXIT.
  8364
  8365     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8366        WS-ACCOUNT-CTR-R GREATER 1 OR
  8367        WS-ACCOUNT-CTR-D GREATER 1
  8368          MOVE ER-2182             TO EMI-ERROR
  8369          MOVE -1                  TO AGENTL (1)
  8370          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371          GO TO 4900-EXIT.
  8372
  8373
  8374     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8375         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8376
  8377     IF WS-ST-COMM-CAP-SL = ZEROS
  8378        CONTINUE
  8379     ELSE
  8380      IF SINGLE-COMM-R (1) NUMERIC
  8381        IF (WS-LIMIT-TO-ACCOUNT AND
  8382           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8383                       OR
  8384           (NOT WS-LIMIT-TO-ACCOUNT AND
  8385           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8386           MOVE -1               TO MAINTL
  8387           MOVE ER-1884          TO EMI-ERROR
  8388           PERFORM 9900-ERROR-FORMAT
  8389                                 THRU 9900-EXIT
  8390        END-IF
  8391*     ELSE
  8392*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8393*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8394*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8395*       MOVE LOW-VALUES          TO COMM-FILLER
  8396*       PERFORM 6400-READ-COMMISSION
  8397*                                THRU 6459-EXIT
  8398*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8399*          MOVE -1               TO MAINTL
  8400*          MOVE ER-1884          TO EMI-ERROR
  8401*          PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 161
* EL6501.cbl
  8402*                                THRU 9900-EXIT
  8403*       END-IF
  8404      END-IF
  8405     END-IF
  8406
  8407     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8408        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8409     END-IF
  8410
  8411     IF WS-ST-COMM-CAP-JL = ZEROS
  8412        CONTINUE
  8413     ELSE
  8414        IF JOINT-COMM-R (1) NUMERIC
  8415           IF (WS-LIMIT-TO-ACCOUNT AND
  8416              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8417                       OR
  8418              (NOT WS-LIMIT-TO-ACCOUNT AND
  8419               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8420               MOVE -1           TO MAINTL
  8421               MOVE ER-1885      TO EMI-ERROR
  8422               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423           END-IF
  8424*       ELSE
  8425*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8426*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8427*          MOVE PI-LIFE-OVERRIDE-L1
  8428*                                TO COMM-LF-AH
  8429*          MOVE LOW-VALUES       TO COMM-FILLER
  8430*          PERFORM 6400-READ-COMMISSION
  8431*                                THRU 6459-EXIT
  8432*          IF EXCEEDS-STATE-MAX
  8433*             MOVE ER-1885       TO EMI-ERROR
  8434*             PERFORM 9900-ERROR-FORMAT
  8435*                                THRU 9900-EXIT
  8436*          END-IF
  8437        END-IF
  8438     END-IF
  8439
  8440     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8441        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8442     END-IF
  8443
  8444     IF WS-ST-COMM-CAP-SA = ZEROS
  8445        CONTINUE
  8446     ELSE
  8447        IF A-H-COMM-R (1) NUMERIC
  8448           IF (WS-LIMIT-TO-ACCOUNT AND
  8449              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8450                           OR
  8451              (NOT WS-LIMIT-TO-ACCOUNT AND
  8452              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8453              MOVE -1            TO MAINTL
  8454              MOVE ER-1886       TO EMI-ERROR
  8455              PERFORM 9900-ERROR-FORMAT
  8456                                 THRU 9900-EXIT
  8457           END-IF
  8458*       ELSE
  8459*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 162
* EL6501.cbl
  8460*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8461*          MOVE PI-AH-OVERRIDE-L1
  8462*                                TO COMM-LF-AH
  8463*          MOVE LOW-VALUES       TO COMM-FILLER
  8464*          PERFORM 6400-READ-COMMISSION
  8465*                                THRU 6459-EXIT
  8466*          IF EXCEEDS-STATE-MAX
  8467*             MOVE ER-1886       TO EMI-ERROR
  8468*             PERFORM 9900-ERROR-FORMAT
  8469*                                THRU 9900-EXIT
  8470*          END-IF
  8471        END-IF
  8472     END-IF
  8473
  8474     IF MAINTI NOT = 'C'
  8475        GO TO 4900-EXIT.
  8476
  8477     IF NOT PI-GA-BILLING
  8478        GO TO 4900-EXIT.
  8479
  8480 4460-CHECK-IF-GA-BILLED.
  8481     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8482
  8483     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8484     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8485     SET M-INDEX TO +1.
  8486     MOVE +1 TO AXRF-SUB.
  8487
  8488 4470-GA-LOOP.
  8489     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8490        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8491        SINGLEL (M-INDEX) GREATER ZERO                OR
  8492        JOINTL  (M-INDEX) GREATER ZERO                OR
  8493        A-HL    (M-INDEX) GREATER ZERO                OR
  8494        RCOMML  (M-INDEX) GREATER ZERO                OR
  8495        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8496        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8497        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8498           MOVE ER-2131   TO EMI-ERROR
  8499           MOVE -1        TO AGENTL (M-INDEX)
  8500           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8501           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8502
  8503     ADD +1 TO AXRF-SUB.
  8504     SET M-INDEX UP BY +1.
  8505
  8506     IF AXRF-SUB NOT = +11
  8507        GO TO 4470-GA-LOOP.
  8508
  8509 4900-EXIT.
  8510      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 163
* EL6501.cbl
  8512 5000-MOVE-TO-RECORD.
  8513
  8514     IF NAMEL   GREATER THAN ZERO  OR
  8515        INCAREL GREATER THAN ZERO  OR
  8516        ADDR1L  GREATER THAN ZERO  OR
  8517        ACITYL  GREATER THAN ZERO  OR
  8518        ASTATEL GREATER THAN ZERO  OR
  8519        ZIPL    GREATER THAN ZERO  OR
  8520        PHONEL  GREATER THAN ZERO  OR
  8521        TAXNOL  GREATER THAN ZERO
  8522         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8523
  8524     IF CSRL GREATER ZEROS
  8525        MOVE CSRI                TO AM-CSR-CODE.
  8526     IF NAMEL GREATER ZEROS
  8527        MOVE NAMEI               TO AM-NAME.
  8528     IF PCONTL GREATER ZEROS
  8529        MOVE PCONTI              TO AM-CONTROL-NAME
  8530     END-IF
  8531     IF INCAREL GREATER ZEROS
  8532        MOVE INCAREI             TO AM-PERSON.
  8533     IF ADDR1L GREATER ZEROS
  8534        MOVE ADDR1I              TO AM-ADDRS.
  8535     IF TAXNOL GREATER ZEROS
  8536        MOVE TAXNOI              TO AM-ID-NO.
  8537     IF PHONEL GREATER ZEROS
  8538        MOVE PHONEI              TO DEEDIT-FIELD
  8539        PERFORM 8600-DEEDIT
  8540        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8541        MOVE WS-PH1              TO AM-AREA-CODE
  8542        MOVE WS-PH2              TO AM-TEL-PRE
  8543        MOVE WS-PH3              TO AM-TEL-NBR.
  8544
  8545     IF ACITYL GREATER ZEROS
  8546        MOVE ACITYI             TO AM-ADDR-CITY.
  8547     IF ASTATEL GREATER ZEROS
  8548        MOVE ASTATEI            TO AM-ADDR-STATE.
  8549
  8550     IF ZIPL NOT GREATER ZEROS
  8551         GO TO 5010-CONT-MOVING.
  8552
  8553     MOVE ZIPI                   TO WS-ZIP-CODE.
  8554
  8555     IF WS-CANADIAN-ZIP
  8556         IF WS-ZIP-4 = SPACE  OR  '-'
  8557             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8558             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8559         ELSE
  8560             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8561             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8562     ELSE
  8563         IF WS-ZIP-6 = SPACE  OR  '-'
  8564             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8565             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8566         ELSE
  8567             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8568             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8569
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 164
* EL6501.cbl
  8570 5010-CONT-MOVING.
  8571     IF TYPEL GREATER ZEROS
  8572        MOVE TYPEI               TO AM-GPCD.
  8573
  8574     IF STDBENL GREATER ZEROS
  8575        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8576
  8577     IF INDGRPL GREATER ZEROS
  8578        MOVE INDGRPI             TO AM-IG
  8579        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8580
  8581     IF STATUSL GREATER ZEROS
  8582        MOVE STATUSI             TO AM-STATUS
  8583        INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8584     END-IF
  8585
  8586     IF CLPTOLPL GREATER ZEROS
  8587        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8588     END-IF.
  8589
  8590     IF PRODCDL > 0
  8591        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8592     END-IF
  8593     IF CLPSTL > 0
  8594        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8595     END-IF
  8596     IF MAXMFEEL > ZEROS
  8597        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8598     END-IF
  8599     IF LCOMML > ZEROS
  8600        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8601     END-IF
  8602
  8603     IF REMITL GREATER ZEROS
  8604        MOVE REMITI              TO AM-REMIT-TO.
  8605     IF CONTRL GREATER ZEROS
  8606        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8607*    IF PSILFFL GREATER +0
  8608*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8609*    IF PSIAHFL GREATER +0
  8610*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8611     IF PEFFDTEL GREATER ZEROS
  8612        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8613     IF PEXPDTEL GREATER ZEROS
  8614        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8615     IF COMMCALL GREATER ZEROS
  8616        MOVE COMMCALI            TO AM-RECALC-COMM
  8617        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8618     ELSE
  8619         IF MAINTI = 'A'
  8620             MOVE 'N'            TO AM-RECALC-COMM.
  8621
  8622     IF REINCALL GREATER ZEROS
  8623        MOVE REINCALI            TO AM-RECALC-REIN
  8624     ELSE
  8625         IF MAINTI = 'A'
  8626             MOVE 'N'            TO AM-RECALC-REIN.
  8627
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 165
* EL6501.cbl
  8628     IF REINTABL GREATER ZEROS
  8629        MOVE REINTABI            TO AM-REI-TABLE.
  8630
  8631     IF PI-MAINT = 'A'
  8632        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8633     END-IF
  8634
  8635     MOVE 1                      TO SUB.
  8636     SET M-INDEX                 TO 1.
  8637
  8638
  8639* EXEC CICS
  8640*         ASKTIME
  8641*    END-EXEC.
  8642*    MOVE '0"                    "   #00008073' TO DFHEIV0
  8643     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8644     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8645     MOVE X'2020233030303038303733' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0,
  8647           DFHEIV99
  8648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8649
  8650
  8651 5000-LOOP.
  8652*    IF PI-COMPANY-ID = 'DCC'
  8653*       IF (M-INDEX = +5)
  8654*          AND ((AGENTL (5) > ZEROS)
  8655*              OR (ATYPEL (5) > ZEROS))
  8656*             MOVE ER-3057         TO EMI-ERROR
  8657*             MOVE -1              TO AGENTL (5)
  8658*             MOVE AL-UABON        TO AGENTA (5)
  8659*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8660*             GO TO 5000-EXIT
  8661*       END-IF
  8662*    END-IF
  8663     IF MAINTI = 'C'
  8664        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8665           (COMMCALI NOT = 'Y' AND '1')                    AND
  8666            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8667           ((AM-AGT (SUB) = ZEROS AND
  8668             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8669                                     ZEROS) AND
  8670           (COMMCALI NOT = 'Y' AND '1')  AND
  8671            AM-HI-CERT-DATE NOT = ZEROS)
  8672              MOVE ER-2181         TO EMI-ERROR
  8673              MOVE -1              TO COMMCALL
  8674              MOVE AL-UABON        TO COMMCALA
  8675              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8676              GO TO 5000-EXIT.
  8677
  8678     IF MAINTI = 'C'
  8679        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8680             ATYPE (M-INDEX)) AND
  8681           (COMMCALI NOT = 'Y' AND '1') AND
  8682            AM-HI-CERT-DATE NOT = ZEROS)
  8683            OR
  8684           ((AM-COM-TYP (SUB) = SPACES AND
  8685             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 166
* EL6501.cbl
  8686           (COMMCALI NOT = 'Y' AND '1')  AND
  8687            AM-HI-CERT-DATE NOT = ZEROS)
  8688              MOVE ER-2181         TO EMI-ERROR
  8689              MOVE -1              TO COMMCALL
  8690              MOVE AL-UABON        TO COMMCALA
  8691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8692              GO TO 5000-EXIT.
  8693
  8694     IF AM-ACCOUNT-BILLED
  8695        IF COMMCALI = 'Y' OR '1'
  8696            MOVE ER-2183         TO EMI-ERROR
  8697            MOVE -1              TO COMMCALL
  8698            MOVE AL-UABON        TO COMMCALA
  8699            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8700            GO TO 5000-EXIT.
  8701
  8702     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8703        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8704        OR
  8705        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8706         ATYPE  (M-INDEX) = SPACES)
  8707           MOVE ZEROS              TO AM-AGT   (SUB)
  8708                                      AM-L-COM (SUB)
  8709                                      AM-J-COM (SUB)
  8710                                      AM-A-COM (SUB)
  8711           MOVE SPACE TO AM-COM-TYP (SUB)
  8712           SET M-INDEX UP BY 1
  8713           ADD 1 TO SUB
  8714           IF SUB = 11
  8715              GO TO 5000-CHECK-MAX-FEES
  8716            ELSE
  8717              GO TO 5000-LOOP.
  8718
  8719     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8720     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8721
  8722     IF SINGLEL (M-INDEX) GREATER ZEROS
  8723        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8724        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8725           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8726          ELSE
  8727           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8728           IF SINGLE-DASH (M-INDEX) = '-'
  8729               MULTIPLY AM-L-COM (SUB) BY -1
  8730                     GIVING AM-L-COM (SUB).
  8731
  8732     IF JOINTL (M-INDEX) GREATER ZEROS
  8733        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8734        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8735           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8736          ELSE
  8737           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8738           IF JOINT-DASH (M-INDEX) = '-'
  8739               MULTIPLY AM-J-COM (SUB) BY -1
  8740                     GIVING AM-J-COM (SUB).
  8741
  8742     IF A-HL (M-INDEX) GREATER ZEROS
  8743        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 167
* EL6501.cbl
  8744        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8745           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8746          ELSE
  8747           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8748           IF A-H-DASH (M-INDEX) = '-'
  8749               MULTIPLY AM-A-COM (SUB) BY -1
  8750                     GIVING AM-A-COM (SUB).
  8751
  8752     IF RECALL (M-INDEX) GREATER ZEROS
  8753         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8754
  8755     IF RCOMML (M-INDEX) GREATER ZEROS
  8756         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8757
  8758     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8759         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8760
  8761     IF GLCODEL (M-INDEX) GREATER ZEROS
  8762         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8763
  8764     SET M-INDEX UP BY 1.
  8765     ADD 1 TO SUB.
  8766     IF M-INDEX NOT = 11
  8767        GO TO 5000-LOOP.
  8768
  8769 5000-CHECK-MAX-FEES.
  8770     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8771        MOVE +1                     TO S1
  8772        PERFORM UNTIL S1 > +10
  8773           IF (AM-A-COM (S1) NUMERIC)
  8774              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8775                     AND 'O')
  8776              AND (AM-COM-TYP (S1) = 'J')
  8777                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8778                    + (AM-A-COM (S1) * +1000)
  8779           END-IF
  8780           ADD +1             TO S1
  8781        END-PERFORM
  8782        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8783           MOVE -1               TO MAXMFEEL
  8784           MOVE AL-UABON         TO MAXMFEEA
  8785           MOVE ER-1817          TO EMI-ERROR
  8786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787        END-IF
  8788     END-IF
  8789     .
  8790 5000-EXIT.
  8791      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 168
* EL6501.cbl
  8793
  8794 5100-WRITE-TS.
  8795     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8796
  8797     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8798         MOVE ZEROS              TO PI-CR-CARRIER
  8799     ELSE
  8800         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8801
  8802     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8803         MOVE ZEROS              TO PI-CR-GROUPING
  8804     ELSE
  8805         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8806
  8807     IF AM-REMIT-TO NOT = ZERO
  8808         MOVE AM-AGT (AM-REMIT-TO)
  8809                                 TO PI-CR-FIN-RESP
  8810       ELSE
  8811         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8812
  8813     MOVE 'A'                    TO PI-CR-TYPE.
  8814 5110-AGT-LOOP.
  8815     ADD 1                       TO  AGT-SUB.
  8816     IF AGT-SUB GREATER 10
  8817         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8818         GO TO 5120-WRITE.
  8819
  8820************************************************************
  8821**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8822************************************************************
  8823
  8824     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8825                  OR 'F' OR 'S' OR 'U'
  8826         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8827         GO TO 5120-WRITE
  8828     ELSE
  8829         GO TO 5110-AGT-LOOP.
  8830
  8831 5120-WRITE.
  8832
  8833* EXEC CICS WRITEQ TS
  8834*         QUEUE    (QID)
  8835*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8836*         LENGTH   (WS-COMM-LENGTH)
  8837*         ITEM     (W-ONE)
  8838*    END-EXEC.
  8839*    MOVE '*" I                  ''   #00008258' TO DFHEIV0
  8840     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8841     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8842     MOVE X'2020233030303038323538' TO DFHEIV0(25:11)
  8843     CALL 'kxdfhei1' USING DFHEIV0,
  8844           QID,
  8845           PROGRAM-INTERFACE-BLOCK,
  8846           WS-COMM-LENGTH,
  8847           W-ONE,
  8848           DFHEIV99,
  8849           DFHEIV99
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 169
* EL6501.cbl
  8851
  8852
  8853 5199-EXIT.
  8854     EXIT.
  8855
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 170
* EL6501.cbl
  8857
  8858 5200-RECOVER-TS.
  8859
  8860     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8861                                 XCTL-653 AND
  8862                                 XCTL-689 AND
  8863                                 XCTL-608 AND
  8864                                 XCTL-690
  8865         GO TO 5299-EXIT.
  8866
  8867
  8868* EXEC CICS HANDLE CONDITION
  8869*        QIDERR  (5250-QID-ERROR)
  8870*    END-EXEC.
  8871*    MOVE '"$N                   ! , #00008279' TO DFHEIV0
  8872     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8874     MOVE X'2C20233030303038323739' TO DFHEIV0(25:11)
  8875     CALL 'kxdfhei1' USING DFHEIV0
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8877
  8878
  8879
  8880* EXEC CICS READQ TS
  8881*        QUEUE    (QID)
  8882*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8883*        LENGTH   (WS-COMM-LENGTH)
  8884*        ITEM     (W-ONE)
  8885*    END-EXEC.
  8886*    MOVE '*$II   L              ''   #00008283' TO DFHEIV0
  8887     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8889     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  8890     CALL 'kxdfhei1' USING DFHEIV0,
  8891           QID,
  8892           PROGRAM-INTERFACE-BLOCK,
  8893           WS-COMM-LENGTH,
  8894           W-ONE,
  8895           DFHEIV99,
  8896           DFHEIV99
  8897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8898
  8899
  8900 5200-DELETE-TS.
  8901
  8902
  8903* EXEC CICS DELETEQ TS
  8904*        QUEUE    (QID)
  8905*    END-EXEC.
  8906*    MOVE '*&                    #   #00008292' TO DFHEIV0
  8907     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038323932' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           QID,
  8912           DFHEIV99
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8914
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 171
* EL6501.cbl
  8915
  8916     GO TO 5299-EXIT.
  8917
  8918 5250-QID-ERROR.
  8919     MOVE ER-0033                TO  EMI-ERROR.
  8920     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8921
  8922 5299-EXIT.
  8923     EXIT.
  8924
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 172
* EL6501.cbl
  8926
  8927 5300-UPDATE-REQUEST-FILE.
  8928     MOVE +0                     TO SUB1.
  8929
  8930 5300-FIND-ACCOUNT-AGENT.
  8931     ADD +1                      TO SUB1.
  8932
  8933     IF SUB1 GREATER THAN +10
  8934        MOVE ER-2949             TO EMI-ERROR
  8935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8936        MOVE -1                  TO AGENTL (1)
  8937
  8938* EXEC CICS SYNCPOINT ROLLBACK
  8939*       END-EXEC
  8940*    MOVE '6"R                   !   #00008317' TO DFHEIV0
  8941     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038333137' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8946        GO TO 8200-SEND-DATAONLY.
  8947
  8948     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8949
  8950************************************************************
  8951**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8952************************************************************
  8953
  8954     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
  8955        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8956           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8957
  8958     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8959        GO TO 5325-PROCESS-RQST-FILE.
  8960
  8961     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8962        GO TO 5325-PROCESS-RQST-FILE.
  8963
  8964     GO TO 5399-EXIT.
  8965
  8966 5325-PROCESS-RQST-FILE.
  8967     MOVE LOW-VALUES             TO RQST3-KEY.
  8968     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8969     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8970     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8971     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8972     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8973
  8974
  8975* EXEC CICS HANDLE CONDITION
  8976*        NOTFND(5399-EXIT)
  8977*        ENDFILE(5399-EXIT)
  8978*    END-EXEC.
  8979*    MOVE '"$I''                  ! - #00008347' TO DFHEIV0
  8980     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8982     MOVE X'2D20233030303038333437' TO DFHEIV0(25:11)
  8983     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 173
* EL6501.cbl
  8984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8985
  8986
  8987 5325-PROCESS-REQUEST-FILE.
  8988
  8989* EXEC CICS STARTBR
  8990*         DATASET   (RQST3-FILE-ID)
  8991*         RIDFLD    (RQST3-KEY)
  8992*    END-EXEC.
  8993     MOVE 0
  8994       TO DFHEIV11
  8995*    MOVE '&,         G          &   #00008353' TO DFHEIV0
  8996     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8997     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8998     MOVE X'2020233030303038333533' TO DFHEIV0(25:11)
  8999     CALL 'kxdfhei1' USING DFHEIV0,
  9000           RQST3-FILE-ID,
  9001           RQST3-KEY,
  9002           DFHEIV99,
  9003           DFHEIV11,
  9004           DFHEIV99
  9005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9006
  9007
  9008 5330-READNEXT-REQUEST.
  9009
  9010* EXEC CICS READNEXT
  9011*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9012*        DATASET(RQST3-FILE-ID)
  9013*        RIDFLD (RQST3-KEY)
  9014*    END-EXEC.
  9015     MOVE 0
  9016       TO DFHEIV11
  9017*    MOVE '&.S                   )   #00008359' TO DFHEIV0
  9018     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9019     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9020     MOVE X'2020233030303038333539' TO DFHEIV0(25:11)
  9021     CALL 'kxdfhei1' USING DFHEIV0,
  9022           RQST3-FILE-ID,
  9023           DFHEIV20,
  9024           DFHEIV99,
  9025           RQST3-KEY,
  9026           DFHEIV99,
  9027           DFHEIV11,
  9028           DFHEIV99,
  9029           DFHEIV99
  9030     SET ADDRESS OF AR-REQUEST-RECORD TO
  9031         DFHEIV20
  9032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9033
  9034
  9035     IF RQST3-KEY = SAVE-RQST3-KEY
  9036        GO TO 5330-READNEXT-REQUEST.
  9037
  9038     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9039
  9040     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9041        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 174
* EL6501.cbl
  9042
  9043     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9044        GO TO 5350-REQUESTS-FINISHED.
  9045
  9046     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9047        GO TO 5350-REQUESTS-FINISHED.
  9048
  9049     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9050
  9051
  9052* EXEC CICS ENDBR
  9053*        DATASET(RQST3-FILE-ID)
  9054*    END-EXEC.
  9055     MOVE 0
  9056       TO DFHEIV11
  9057*    MOVE '&2                    $   #00008381' TO DFHEIV0
  9058     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9060     MOVE X'2020233030303038333831' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0,
  9062           RQST3-FILE-ID,
  9063           DFHEIV11,
  9064           DFHEIV99
  9065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9066
  9067
  9068
  9069* EXEC CICS READ
  9070*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9071*        DATASET(RQST-FILE-ID)
  9072*        RIDFLD (RQST-KEY)
  9073*        UPDATE
  9074*    END-EXEC.
  9075*    MOVE '&"S        EU         (   #00008385' TO DFHEIV0
  9076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9078     MOVE X'2020233030303038333835' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           RQST-FILE-ID,
  9081           DFHEIV20,
  9082           DFHEIV99,
  9083           RQST-KEY,
  9084           DFHEIV99,
  9085           DFHEIV99,
  9086           DFHEIV99
  9087     SET ADDRESS OF AR-REQUEST-RECORD TO
  9088         DFHEIV20
  9089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9090
  9091
  9092     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9093     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9094
  9095
  9096* EXEC CICS REWRITE
  9097*        DATASET   (RQST-FILE-ID)
  9098*        FROM      (AR-REQUEST-RECORD)
  9099*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 175
* EL6501.cbl
  9100     MOVE LENGTH OF
  9101      AR-REQUEST-RECORD
  9102       TO DFHEIV11
  9103*    MOVE '&& L                  %   #00008395' TO DFHEIV0
  9104     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9105     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9106     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  9107     CALL 'kxdfhei1' USING DFHEIV0,
  9108           RQST-FILE-ID,
  9109           AR-REQUEST-RECORD,
  9110           DFHEIV11,
  9111           DFHEIV99
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9113
  9114
  9115     GO TO  5325-PROCESS-REQUEST-FILE.
  9116
  9117 5350-REQUESTS-FINISHED.
  9118
  9119* EXEC CICS ENDBR
  9120*        DATASET(RQST3-FILE-ID)
  9121*    END-EXEC.
  9122     MOVE 0
  9123       TO DFHEIV11
  9124*    MOVE '&2                    $   #00008403' TO DFHEIV0
  9125     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9126     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9127     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  9128     CALL 'kxdfhei1' USING DFHEIV0,
  9129           RQST3-FILE-ID,
  9130           DFHEIV11,
  9131           DFHEIV99
  9132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9133
  9134
  9135 5399-EXIT.
  9136     EXIT.
  9137
  9138
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 176
* EL6501.cbl
  9140
  9141 6000-MOVE-TO-SCREEN.
  9142     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9143
  9144     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9145     MOVE AM-NAME                TO NAMEO.
  9146     MOVE AM-CONTROL-NAME        TO PCONTO.
  9147     MOVE AM-CSR-CODE            TO CSRO.
  9148     MOVE AM-PERSON              TO INCAREO.
  9149     MOVE AM-ADDRS               TO ADDR1O.
  9150     MOVE AM-ID-NO               TO TAXNOO.
  9151     MOVE AM-TEL-NO              TO WS-PHONE.
  9152     MOVE WS-PHONE-NUM           TO PHONEO.
  9153     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9154     MOVE AM-ADDR-CITY           TO ACITYO
  9155     MOVE AM-ADDR-STATE          TO ASTATEO
  9156
  9157     MOVE SPACES                 TO WS-ZIP-CODE.
  9158     IF AM-CANADIAN-POST-CODE
  9159         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9160         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9161     ELSE
  9162         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9163         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9164             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9165             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9166
  9167     MOVE WS-ZIP-CODE            TO ZIPO.
  9168
  9169     MOVE AM-GPCD                TO TYPEO.
  9170     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9171
  9172     MOVE AM-IG                  TO INDGRPO.
  9173     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9174
  9175     MOVE AM-STATUS              TO STATUSO.
  9176     INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9177
  9178     MOVE AM-REMIT-TO            TO REMITO.
  9179
  9180     IF PI-AR-PROCESSING
  9181        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9182           MOVE AL-UNNON         TO REMITA
  9183        ELSE
  9184           MOVE AL-SANON         TO REMITA
  9185     ELSE
  9186        MOVE AL-UNNON            TO REMITA.
  9187
  9188***  Y2K PROJ 7744
  9189     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9190     MOVE '3'                    TO DC-OPTION-CODE.
  9191     PERFORM 9700-DATE-LINK.
  9192     IF DATE-CONVERSION-ERROR
  9193        MOVE SPACES              TO CONTRO
  9194     ELSE
  9195        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9196     END-IF.
  9197***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 177
* EL6501.cbl
  9198
  9199*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9200*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9201
  9202*    IF AM-LF-PSI-FACTOR NUMERIC
  9203*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9204*
  9205*    IF AM-AH-PSI-FACTOR NUMERIC
  9206*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9207
  9208     MOVE AM-RECALC-COMM         TO COMMCALO.
  9209     MOVE AL-UANON               TO COMMCALA.
  9210     MOVE AM-RECALC-REIN         TO REINCALO.
  9211     MOVE AM-REI-TABLE           TO REINTABO.
  9212     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9213     MOVE '3'                    TO DC-OPTION-CODE.
  9214     PERFORM 9700-DATE-LINK.
  9215     IF DATE-CONVERSION-ERROR
  9216        MOVE SPACES              TO PRODATEO
  9217     ELSE
  9218        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9219
  9220     IF PI-COMPANY-ID = 'DCC'
  9221        IF AM-CLP-TOL-PCT NOT NUMERIC
  9222           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9223        END-IF
  9224        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9225           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9226        END-IF
  9227        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9228        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9229        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9230        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9231        MOVE AL-UANON            TO CLPSTA
  9232        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9233           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9234        END-IF
  9235        MOVE AM-DCC-MAX-MARKETING-FEE
  9236                                 TO MAXMFEEO
  9237     ELSE
  9238        MOVE AL-SADOF            TO CTPLABLA
  9239                                    CLPTOLPA
  9240                                    LCLABLA
  9241                                    LCOMMA
  9242     END-IF
  9243
  9244     IF AM-RET-Y-N = ' '  OR  'N'
  9245         MOVE 'NO '              TO RETROCDO
  9246     ELSE
  9247         MOVE 'YES'              TO RETROCDO.
  9248
  9249     IF AM-ACCOUNT-BILLED
  9250         MOVE 'YES'              TO BILLCDO
  9251     ELSE
  9252         MOVE 'NO '              TO BILLCDO.
  9253
  9254     MOVE AL-UANON               TO RETROCDA.
  9255     MOVE AL-SANON               TO PRODATEA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 178
* EL6501.cbl
  9256                                    BILLCDA.
  9257     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9258     MOVE '3' TO DC-OPTION-CODE.
  9259     PERFORM 9700-DATE-LINK.
  9260     IF DATE-CONVERSION-ERROR
  9261        MOVE SPACES TO PEFFDTEO
  9262     ELSE
  9263        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9264
  9265     IF AM-PREV-EXP-DT NOT = 99999999999
  9266        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9267        MOVE '3' TO DC-OPTION-CODE
  9268        PERFORM 9700-DATE-LINK
  9269        IF DATE-CONVERSION-ERROR
  9270           MOVE SPACES TO PEXPDTEO
  9271        ELSE
  9272           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9273     ELSE
  9274        MOVE '99/99/99' TO PEXPDTEO.
  9275
  9276     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9277        MOVE AL-UANON            TO PEXPDTEA
  9278                                    PEFFDTEA
  9279        MOVE AL-SANOF TO            PDSPLYA.
  9280
  9281     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9282     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9283     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9284
  9285     MOVE 1  TO SUB.
  9286     SET M-INDEX TO 1.
  9287
  9288 6005-LOOP.
  9289     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9290        IF PI-AR-PROCESSING
  9291           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9292              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9293                                   ATYPEA (M-INDEX)
  9294                                   SINGLEA (M-INDEX)
  9295                                   JOINTA (M-INDEX)
  9296                                   A-HA    (M-INDEX)
  9297              GO TO 6010-BUMP-SUB
  9298           ELSE
  9299              GO TO 6010-BUMP-SUB
  9300        ELSE
  9301           GO TO 6010-BUMP-SUB.
  9302
  9303     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9304
  9305***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9306     IF WS-DMD-AGENT = LOW-VALUES
  9307        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9308***DMD ******************************************************
  9309
  9310     IF PI-GA-BILLING
  9311        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9312     MOVE AL-UANON               TO AGENTA (M-INDEX).
  9313
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 179
* EL6501.cbl
  9314     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9315     IF PI-GA-BILLING
  9316        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9317     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9318
  9319     IF (AM-L-COM (SUB) NOT NUMERIC)
  9320        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9321        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9322     ELSE
  9323        IF AM-L-COM (SUB) NOT = ZEROS
  9324           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9325
  9326     IF (AM-J-COM (SUB) NOT NUMERIC)
  9327        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9328        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9329     ELSE
  9330        IF AM-J-COM (SUB) NOT = ZEROS
  9331           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9332
  9333     IF (AM-A-COM (SUB) NOT NUMERIC)
  9334        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9335        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9336     ELSE
  9337        IF AM-A-COM (SUB) NOT = ZEROS
  9338           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9339
  9340************************************************************
  9341**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9342************************************************************
  9343
  9344     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9345            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9346            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9347         GO TO 6006-CONTINUE.
  9348
  9349     IF (AM-L-COM (SUB) NUMERIC)
  9350        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9351         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9352
  9353     IF (AM-J-COM (SUB) NUMERIC)
  9354        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9355         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9356
  9357     IF (AM-A-COM (SUB) NUMERIC)
  9358        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9359        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9360     END-IF
  9361     .
  9362 6006-CONTINUE.
  9363     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9364         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9365
  9366     IF WS-ST-COMM-CAP-SL = ZEROS
  9367        CONTINUE
  9368     ELSE
  9369        IF (AM-L-COM (SUB) NUMERIC)
  9370           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9371           IF (WS-LIMIT-TO-ACCOUNT AND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 180
* EL6501.cbl
  9372              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9373                       OR
  9374              (NOT WS-LIMIT-TO-ACCOUNT AND
  9375              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9376              MOVE -1            TO MAINTL
  9377              MOVE ER-1884       TO EMI-ERROR
  9378              PERFORM 9900-ERROR-FORMAT
  9379                                 THRU 9900-EXIT
  9380           END-IF
  9381        ELSE
  9382           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9383           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9384           MOVE PI-LIFE-OVERRIDE-L1
  9385                                 TO COMM-LF-AH
  9386           MOVE LOW-VALUES       TO COMM-FILLER
  9387           PERFORM 6400-READ-COMMISSION
  9388                                 THRU 6459-EXIT
  9389           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9390              MOVE -1            TO MAINTL
  9391              MOVE ER-1884       TO EMI-ERROR
  9392              PERFORM 9900-ERROR-FORMAT
  9393                                 THRU 9900-EXIT
  9394           END-IF
  9395        END-IF
  9396     END-IF
  9397
  9398     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9399         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9400
  9401     IF WS-ST-COMM-CAP-JL = ZEROS
  9402        CONTINUE
  9403     ELSE
  9404        IF (AM-J-COM (SUB) NUMERIC)
  9405           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9406           IF (WS-LIMIT-TO-ACCOUNT AND
  9407              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9408                       OR
  9409              (NOT WS-LIMIT-TO-ACCOUNT AND
  9410              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9411              MOVE -1            TO MAINTL
  9412              MOVE ER-1885       TO EMI-ERROR
  9413              PERFORM 9900-ERROR-FORMAT
  9414                                 THRU 9900-EXIT
  9415           END-IF
  9416        ELSE
  9417           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9418           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9419           MOVE PI-LIFE-OVERRIDE-L1
  9420                                 TO COMM-LF-AH
  9421           MOVE LOW-VALUES       TO COMM-FILLER
  9422           PERFORM 6400-READ-COMMISSION
  9423                                 THRU 6459-EXIT
  9424           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9425              MOVE -1            TO MAINTL
  9426              MOVE ER-1885       TO EMI-ERROR
  9427              PERFORM 9900-ERROR-FORMAT
  9428                                 THRU 9900-EXIT
  9429           END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 181
* EL6501.cbl
  9430        END-IF
  9431     END-IF
  9432
  9433     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9434         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9435
  9436     IF WS-ST-COMM-CAP-SA = ZEROS
  9437        CONTINUE
  9438     ELSE
  9439        IF (AM-A-COM (SUB) NUMERIC)
  9440           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9441           IF (WS-LIMIT-TO-ACCOUNT AND
  9442              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9443                       OR
  9444              (NOT WS-LIMIT-TO-ACCOUNT AND
  9445              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9446              MOVE -1            TO MAINTL
  9447              MOVE ER-1886       TO EMI-ERROR
  9448              PERFORM 9900-ERROR-FORMAT
  9449                                 THRU 9900-EXIT
  9450           END-IF
  9451        ELSE
  9452           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9453           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9454           MOVE PI-AH-OVERRIDE-L1
  9455                                 TO COMM-LF-AH
  9456           MOVE LOW-VALUES       TO COMM-FILLER
  9457           PERFORM 6400-READ-COMMISSION
  9458                                 THRU 6459-EXIT
  9459           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9460              MOVE -1            TO MAINTL
  9461              MOVE ER-1886       TO EMI-ERROR
  9462              PERFORM 9900-ERROR-FORMAT
  9463                                 THRU 9900-EXIT
  9464           END-IF
  9465        END-IF
  9466     END-IF
  9467
  9468     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9469         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9470
  9471     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9472         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9473
  9474     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9475        NEXT SENTENCE
  9476     ELSE
  9477        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9478
  9479     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9480         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9481
  9482     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9483         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9484
  9485     IF NOT PI-AR-PROCESSING
  9486        GO TO 6010-BUMP-SUB.
  9487
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 182
* EL6501.cbl
  9488     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9489        GO TO 6010-BUMP-SUB.
  9490
  9491     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9492                                   ATYPEA  (M-INDEX)
  9493                                   SINGLEA (M-INDEX)
  9494                                   JOINTA  (M-INDEX)
  9495                                   A-HA    (M-INDEX).
  9496
  9497 6010-BUMP-SUB.
  9498     ADD 1  TO SUB.
  9499     SET M-INDEX UP BY 1.
  9500     IF SUB LESS 11
  9501        GO TO 6005-LOOP.
  9502
  9503 6099-EXIT.
  9504      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 183
* EL6501.cbl
  9506 6300-STARTBR.
  9507
  9508* EXEC CICS STARTBR
  9509*         DATASET   (ACCT-FILE-ID)
  9510*         RIDFLD    (WS-KEY-SAVE)
  9511*    END-EXEC.
  9512     MOVE 0
  9513       TO DFHEIV11
  9514*    MOVE '&,         G          &   #00008779' TO DFHEIV0
  9515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9517     MOVE X'2020233030303038373739' TO DFHEIV0(25:11)
  9518     CALL 'kxdfhei1' USING DFHEIV0,
  9519           ACCT-FILE-ID,
  9520           WS-KEY-SAVE,
  9521           DFHEIV99,
  9522           DFHEIV11,
  9523           DFHEIV99
  9524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9525
  9526
  9527     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9528
  9529 6300-EXIT.
  9530      EXIT.
  9531
  9532 6310-READNEXT.
  9533
  9534* EXEC CICS READNEXT
  9535*         DATASET    (ACCT-FILE-ID)
  9536*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9537*         RIDFLD     (WS-KEY-SAVE)
  9538*    END-EXEC.
  9539     MOVE 0
  9540       TO DFHEIV11
  9541*    MOVE '&.S                   )   #00008790' TO DFHEIV0
  9542     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9544     MOVE X'2020233030303038373930' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           ACCT-FILE-ID,
  9547           DFHEIV20,
  9548           DFHEIV99,
  9549           WS-KEY-SAVE,
  9550           DFHEIV99,
  9551           DFHEIV11,
  9552           DFHEIV99,
  9553           DFHEIV99
  9554     SET ADDRESS OF ACCOUNT-MASTER TO
  9555         DFHEIV20
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559 6310-EXIT.
  9560      EXIT.
  9561
  9562 6320-ENDBR.
  9563     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 184
* EL6501.cbl
  9564
  9565* EXEC CICS ENDBR
  9566*        DATASET(ACCT-FILE-ID)
  9567*    END-EXEC.
  9568     MOVE 0
  9569       TO DFHEIV11
  9570*    MOVE '&2                    $   #00008801' TO DFHEIV0
  9571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9573     MOVE X'2020233030303038383031' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0,
  9575           ACCT-FILE-ID,
  9576           DFHEIV11,
  9577           DFHEIV99
  9578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9579
  9580
  9581 6320-EXIT.
  9582      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 185
* EL6501.cbl
  9584 6400-READ-COMMISSION.
  9585     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9586
  9587* EXEC CICS HANDLE CONDITION
  9588*         NOTFND   (6450-NOT-FOUND)
  9589*    END-EXEC
  9590*    MOVE '"$I                   ! . #00008810' TO DFHEIV0
  9591     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9593     MOVE X'2E20233030303038383130' TO DFHEIV0(25:11)
  9594     CALL 'kxdfhei1' USING DFHEIV0
  9595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9596
  9597
  9598* EXEC CICS READ
  9599*        GTEQ
  9600*        DATASET   (COMM-FILE-ID)
  9601*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9602*        RIDFLD    (COMM-KEY)
  9603*    END-EXEC
  9604*    MOVE '&"S        G          (   #00008814' TO DFHEIV0
  9605     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9607     MOVE X'2020233030303038383134' TO DFHEIV0(25:11)
  9608     CALL 'kxdfhei1' USING DFHEIV0,
  9609           COMM-FILE-ID,
  9610           DFHEIV20,
  9611           DFHEIV99,
  9612           COMM-KEY,
  9613           DFHEIV99,
  9614           DFHEIV99,
  9615           DFHEIV99
  9616     SET ADDRESS OF COMM-TABLE-RECORD TO
  9617         DFHEIV20
  9618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9619
  9620     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9621        CT-TABLE      = COMM-TABLE    AND
  9622        CT-BEN-TYPE   = COMM-LF-AH
  9623        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9624        GO TO 6459-EXIT
  9625     END-IF
  9626     .
  9627 6450-NOT-FOUND.
  9628     MOVE ER-2176                TO EMI-ERROR.
  9629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630     MOVE 1  TO WS-COMM-ERROR-SW.
  9631
  9632 6459-EXIT.
  9633      EXIT.
  9634
  9635 6460-CHECK-MAX.
  9636
  9637
  9638* EXEC CICS STARTBR
  9639*         DATASET   (COMM-FILE-ID)
  9640*         RIDFLD    (COMM-KEY)
  9641*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 186
* EL6501.cbl
  9642*    END-EXEC
  9643     MOVE 0
  9644       TO DFHEIV11
  9645*    MOVE '&,         G          &  N#00008838' TO DFHEIV0
  9646     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9647     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9648     MOVE X'204E233030303038383338' TO DFHEIV0(25:11)
  9649     CALL 'kxdfhei1' USING DFHEIV0,
  9650           COMM-FILE-ID,
  9651           COMM-KEY,
  9652           DFHEIV99,
  9653           DFHEIV11,
  9654           DFHEIV99
  9655     MOVE EIBRESP  TO WS-RESPONSE
  9656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9657
  9658     MOVE SPACES          TO WS-STATE-MAX-SW
  9659
  9660     IF RESP-NORMAL
  9661        MOVE LOW-VALUES          TO COMM-FILLER
  9662        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9663        MOVE ZEROS               TO WS-TABLE-MAX
  9664        PERFORM UNTIL
  9665              (NOT RESP-NORMAL) OR
  9666              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9667
  9668* EXEC CICS READNEXT
  9669*             DATASET   (COMM-FILE-ID)
  9670*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9671*             RIDFLD    (COMM-KEY)
  9672*             RESP      (WS-RESPONSE)
  9673*           END-EXEC
  9674     MOVE 0
  9675       TO DFHEIV11
  9676*    MOVE '&.S                   )  N#00008853' TO DFHEIV0
  9677     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9679     MOVE X'204E233030303038383533' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0,
  9681           COMM-FILE-ID,
  9682           DFHEIV20,
  9683           DFHEIV99,
  9684           COMM-KEY,
  9685           DFHEIV99,
  9686           DFHEIV11,
  9687           DFHEIV99,
  9688           DFHEIV99
  9689     SET ADDRESS OF COMM-TABLE-RECORD TO
  9690         DFHEIV20
  9691     MOVE EIBRESP  TO WS-RESPONSE
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9693            IF (RESP-NORMAL) AND
  9694               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9695               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9696                   (WS-NDX > +27)
  9697                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9698                      MOVE CT-RT (WS-NDX)
  9699                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 187
* EL6501.cbl
  9700                   END-IF
  9701               END-PERFORM
  9702            END-IF
  9703        END-PERFORM
  9704
  9705* EXEC CICS ENDBR
  9706*            DATASET   (COMM-FILE-ID)
  9707*       END-EXEC
  9708     MOVE 0
  9709       TO DFHEIV11
  9710*    MOVE '&2                    $   #00008870' TO DFHEIV0
  9711     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9712     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9713     MOVE X'2020233030303038383730' TO DFHEIV0(25:11)
  9714     CALL 'kxdfhei1' USING DFHEIV0,
  9715           COMM-FILE-ID,
  9716           DFHEIV11,
  9717           DFHEIV99
  9718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9719     END-IF
  9720
  9721     .
  9722 6460-EXIT.
  9723      EXIT.
  9724
  9725
  9726 6500-READ-ACCT.
  9727
  9728* EXEC CICS READ
  9729*        GTEQ
  9730*        DATASET   (ACCT-FILE-ID)
  9731*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9732*        RIDFLD    (PI-ACCT-KEY)
  9733*    END-EXEC.
  9734*    MOVE '&"S        G          (   #00008881' TO DFHEIV0
  9735     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9737     MOVE X'2020233030303038383831' TO DFHEIV0(25:11)
  9738     CALL 'kxdfhei1' USING DFHEIV0,
  9739           ACCT-FILE-ID,
  9740           DFHEIV20,
  9741           DFHEIV99,
  9742           PI-ACCT-KEY,
  9743           DFHEIV99,
  9744           DFHEIV99,
  9745           DFHEIV99
  9746     SET ADDRESS OF ACCOUNT-MASTER TO
  9747         DFHEIV20
  9748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9749
  9750
  9751 6599-EXIT.
  9752      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 188
* EL6501.cbl
  9754 6600-UPDATE-MAINT-DT.
  9755     MOVE SPACES                 TO ELCNTL-KEY.
  9756
  9757     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9758     MOVE '1'                    TO CNTL-REC-TYPE.
  9759     MOVE +0                     TO CNTL-SEQ-NO.
  9760
  9761
  9762* EXEC CICS HANDLE CONDITION
  9763*        NOTFND   (6699-EXIT)
  9764*    END-EXEC.
  9765*    MOVE '"$I                   ! / #00008898' TO DFHEIV0
  9766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9768     MOVE X'2F20233030303038383938' TO DFHEIV0(25:11)
  9769     CALL 'kxdfhei1' USING DFHEIV0
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9771
  9772
  9773
  9774* EXEC CICS READ
  9775*        UPDATE
  9776*        DATASET   (CNTL-FILE-ID)
  9777*        SET       (ADDRESS OF CONTROL-FILE)
  9778*        RIDFLD    (ELCNTL-KEY)
  9779*    END-EXEC.
  9780*    MOVE '&"S        EU         (   #00008902' TO DFHEIV0
  9781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9782     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9783     MOVE X'2020233030303038393032' TO DFHEIV0(25:11)
  9784     CALL 'kxdfhei1' USING DFHEIV0,
  9785           CNTL-FILE-ID,
  9786           DFHEIV20,
  9787           DFHEIV99,
  9788           ELCNTL-KEY,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV99
  9792     SET ADDRESS OF CONTROL-FILE TO
  9793         DFHEIV20
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9795
  9796
  9797     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9798
  9799
  9800* EXEC CICS REWRITE
  9801*        DATASET   (CNTL-FILE-ID)
  9802*        FROM      (CONTROL-FILE)
  9803*    END-EXEC.
  9804     MOVE LENGTH OF
  9805      CONTROL-FILE
  9806       TO DFHEIV11
  9807*    MOVE '&& L                  %   #00008911' TO DFHEIV0
  9808     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9809     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9810     MOVE X'2020233030303038393131' TO DFHEIV0(25:11)
  9811     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 189
* EL6501.cbl
  9812           CNTL-FILE-ID,
  9813           CONTROL-FILE,
  9814           DFHEIV11,
  9815           DFHEIV99
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
  9818
  9819 6699-EXIT.
  9820      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 190
* EL6501.cbl
  9822 6700-BUILD-COMM-WORK.
  9823     IF NOT PI-GA-BILLING
  9824         GO TO 6799-EXIT.
  9825
  9826
  9827* EXEC CICS GETMAIN
  9828*         LENGTH   (260)
  9829*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9830*         INITIMG  (GETMAIN-SPACE)
  9831*     END-EXEC.
  9832     MOVE 260
  9833       TO DFHEIV11
  9834*    MOVE ',"IL                  $   #00008923' TO DFHEIV0
  9835     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9836     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9837     MOVE X'2020233030303038393233' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0,
  9839           DFHEIV20,
  9840           DFHEIV11,
  9841           GETMAIN-SPACE
  9842     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9843         DFHEIV20
  9844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9845
  9846     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9847
  9848     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9849     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9850     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9851
  9852     IF PI-MAINT = 'A'
  9853         GO TO 6799-EXIT.
  9854
  9855     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9856     MOVE +1                TO AXRF-SUB.
  9857
  9858 6710-AXRF-LOOP.
  9859     MOVE SPACES         TO AGENT-FIND.
  9860     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9861
  9862     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9863
  9864     IF AGENT-FIND = SPACES
  9865        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9866             WK-GA-BILL-DT (AXRF-SUB)
  9867     ELSE
  9868        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9869
  9870     ADD +1 TO AXRF-SUB.
  9871
  9872     IF AXRF-SUB NOT = +11
  9873        GO TO 6710-AXRF-LOOP.
  9874
  9875 6799-EXIT.
  9876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 191
* EL6501.cbl
  9878 6800-COMPANY-REC-READ.
  9879     MOVE SPACES                 TO ELCNTL-KEY.
  9880     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9881     MOVE '1'                    TO CNTL-REC-TYPE.
  9882     MOVE +0                     TO CNTL-SEQ-NO.
  9883
  9884* EXEC CICS HANDLE CONDITION
  9885*        NOTFND   (6880-NO-COMP)
  9886*    END-EXEC.
  9887*    MOVE '"$I                   ! 0 #00008965' TO DFHEIV0
  9888     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9890     MOVE X'3020233030303038393635' TO DFHEIV0(25:11)
  9891     CALL 'kxdfhei1' USING DFHEIV0
  9892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9893
  9894
  9895
  9896* EXEC CICS READ
  9897*        DATASET   (CNTL-FILE-ID)
  9898*        SET       (ADDRESS OF CONTROL-FILE)
  9899*        RIDFLD    (ELCNTL-KEY)
  9900*    END-EXEC.
  9901*    MOVE '&"S        E          (   #00008969' TO DFHEIV0
  9902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9904     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           CNTL-FILE-ID,
  9907           DFHEIV20,
  9908           DFHEIV99,
  9909           ELCNTL-KEY,
  9910           DFHEIV99,
  9911           DFHEIV99,
  9912           DFHEIV99
  9913     SET ADDRESS OF CONTROL-FILE TO
  9914         DFHEIV20
  9915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9916
  9917
  9918     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9919         MOVE ER-2572               TO EMI-ERROR
  9920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9921
  9922     GO TO 6899-EXIT.
  9923
  9924 6880-NO-COMP.
  9925     MOVE ER-0002                TO EMI-ERROR.
  9926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9927
  9928 6899-EXIT.
  9929     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 192
* EL6501.cbl
  9931 6900-READ-AND-CHECK-AXRF.
  9932     IF NOT PI-GA-BILLING
  9933        GO TO 6999-EXIT.
  9934
  9935     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9936     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9937
  9938 6905-AGENT-LEVEL-LOOP.
  9939     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9940     MOVE SPACES TO AGENT-FIND.
  9941     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9942      OR
  9943        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9944      AND
  9945        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9946                             OR 'B' OR 'I'
  9947                             OR 'K' OR 'L' OR 'J' OR 'M'
  9948                                    OR 'A' OR 'N')
  9949                            OR
  9950        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9951                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9952                                         OR 'A' OR 'N'))
  9953            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9954            IF AGENT-RECORD-NOT-FOUND
  9955               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9956           ELSE
  9957            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9958               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9959           ELSE
  9960        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9961              AND 'B' AND 'I'
  9962              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
  9963           (AM-AGT (AXRF-SUB) NOT =
  9964                   WK-AM-AGT (AXRF-SUB))
  9965           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9966           GO TO 6910-INC-SUB.
  9967
  9968     MOVE SPACES TO AGENT-FIND.
  9969     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9970        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9971                               SPACES AND ZEROS)
  9972          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9973          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9974          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9975          IF AGENT-FIND = SPACES
  9976              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9977
  9978 6910-INC-SUB.
  9979     ADD +1                      TO AXRF-SUB.
  9980     IF AXRF-SUB NOT = +11
  9981        GO TO 6905-AGENT-LEVEL-LOOP.
  9982
  9983     GO TO 6999-EXIT.
  9984
  9985 6920-READ-AXRF-FILE.
  9986*    IF GETMAIN-SW = 'X'
  9987*       GO TO 6920-BUILD-KEY.
  9988*
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 193
* EL6501.cbl
  9989*    EXEC CICS GETMAIN
  9990*         LENGTH   (ERGXRF-REC-LEN)
  9991*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9992*         INITIMG  (GETMAIN-SPACE)
  9993*    END-EXEC.
  9994*
  9995*    MOVE 'X' TO GETMAIN-SW.
  9996
  9997 6920-BUILD-KEY.
  9998     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
  9999
 10000     IF PI-ZERO-CARRIER
 10001       OR PI-ZERO-CAR-GROUP
 10002         MOVE ZERO               TO WS-AXRF-CARRIER
 10003     ELSE
 10004         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10005
 10006     IF PI-ZERO-GROUPING
 10007       OR PI-ZERO-CAR-GROUP
 10008         MOVE ZEROS              TO WS-AXRF-GROUPING
 10009     ELSE
 10010         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10011
 10012     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10013                                              LOW-VALUES
 10014        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10015     ELSE
 10016     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10017                                              LOW-VALUES
 10018        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10019     ELSE
 10020        MOVE 'X' TO AGENT-FIND
 10021        GO TO 6929-EXIT.
 10022
 10023     MOVE +1 TO GX-AGENT-SUB.
 10024
 10025 6921-READ-AXRF.
 10026
 10027* EXEC CICS HANDLE CONDITION
 10028*         ENDFILE     (6925-NOT-FIND)
 10029*         NOTFND      (6925-NOT-FIND)
 10030*    END-EXEC.
 10031*    MOVE '"$''I                  ! 1 #00009083' TO DFHEIV0
 10032     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10034     MOVE X'3120233030303039303833' TO DFHEIV0(25:11)
 10035     CALL 'kxdfhei1' USING DFHEIV0
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10037
 10038
 10039
 10040* EXEC CICS READ
 10041*        DATASET   (ERGXRF-FILE-ID)
 10042*        LENGTH    (ERGXRF-REC-LEN)
 10043*        INTO      (AGENT-CROSS-REFERENCE)
 10044*        RIDFLD    (WS-AXRF-KEY)
 10045*        EQUAL
 10046*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 194
* EL6501.cbl
 10047*    MOVE '&"IL       E          (   #00009088' TO DFHEIV0
 10048     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10050     MOVE X'2020233030303039303838' TO DFHEIV0(25:11)
 10051     CALL 'kxdfhei1' USING DFHEIV0,
 10052           ERGXRF-FILE-ID,
 10053           AGENT-CROSS-REFERENCE,
 10054           ERGXRF-REC-LEN,
 10055           WS-AXRF-KEY,
 10056           DFHEIV99,
 10057           DFHEIV99,
 10058           DFHEIV99
 10059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10060
 10061
 10062     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10063
 10064     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10065             FROM +1 BY +1 UNTIL
 10066         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10067         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10068         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10069         AND
 10070         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10071         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10072         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10073         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10074
 10075     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10076        MOVE 'Y' TO AGENT-FIND
 10077        GO TO 6929-EXIT.
 10078
 10079     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10080        MOVE 'Z' TO AGENT-FIND.
 10081
 10082     GO TO 6929-EXIT.
 10083
 10084 6921-FIND-ACCT-LOOP.
 10085***  DUMMY PARAGRAPH  ***
 10086
 10087 6925-NOT-FIND.
 10088     MOVE 'X' TO AGENT-FIND.
 10089
 10090 6929-EXIT.
 10091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 195
* EL6501.cbl
 10093 6950-ADD-AGENT-RECORD.
 10094     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10095        GO TO 6959-EXIT.
 10096
 10097     MOVE +109                   TO ERGXRF-REC-LEN.
 10098
 10099     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10100     MOVE 'GX'                   TO GX-RECORD-ID.
 10101     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10102
 10103     IF PI-ZERO-CARRIER
 10104       OR PI-ZERO-CAR-GROUP
 10105         MOVE ZERO               TO GX-CARRIER
 10106     ELSE
 10107         MOVE AM-CARRIER         TO GX-CARRIER.
 10108
 10109     IF PI-ZERO-GROUPING
 10110       OR PI-ZERO-CAR-GROUP
 10111         MOVE ZERO               TO GX-GROUPING
 10112     ELSE
 10113         MOVE AM-GROUPING        TO GX-GROUPING.
 10114
 10115     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10116
 10117     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10118     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10119     MOVE AM-STATE               TO GX-AM-STATE (1).
 10120     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10121     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10122     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10123     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10124     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10125
 10126     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10127     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10128     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10129
 10130
 10131* EXEC CICS WRITE
 10132*        FROM      (AGENT-CROSS-REFERENCE)
 10133*        LENGTH    (ERGXRF-REC-LEN)
 10134*        RIDFLD    (GX-CONTROL-PRIMARY)
 10135*        DATASET   (ERGXRF-FILE-ID)
 10136*    END-EXEC.
 10137*    MOVE '&$ L                  ''   #00009164' TO DFHEIV0
 10138     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10139     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10140     MOVE X'2020233030303039313634' TO DFHEIV0(25:11)
 10141     CALL 'kxdfhei1' USING DFHEIV0,
 10142           ERGXRF-FILE-ID,
 10143           AGENT-CROSS-REFERENCE,
 10144           ERGXRF-REC-LEN,
 10145           GX-CONTROL-PRIMARY,
 10146           DFHEIV99,
 10147           DFHEIV99
 10148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10149
 10150
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 196
* EL6501.cbl
 10151 6959-EXIT.
 10152      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 197
* EL6501.cbl
 10154 6970-REWRITE-AGENT-RECORD.
 10155     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10156
 10157
 10158* EXEC CICS READ
 10159*        DATASET   (ERGXRF-FILE-ID)
 10160*        INTO      (AGENT-CROSS-REFERENCE)
 10161*        LENGTH    (ERGXRF-REC-LEN)
 10162*        RIDFLD    (WS-AXRF-KEY)
 10163*        EQUAL
 10164*        UPDATE
 10165*    END-EXEC.
 10166*    MOVE '&"IL       EU         (   #00009177' TO DFHEIV0
 10167     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10168     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10169     MOVE X'2020233030303039313737' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0,
 10171           ERGXRF-FILE-ID,
 10172           AGENT-CROSS-REFERENCE,
 10173           ERGXRF-REC-LEN,
 10174           WS-AXRF-KEY,
 10175           DFHEIV99,
 10176           DFHEIV99,
 10177           DFHEIV99
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10179
 10180
 10181     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10182
 10183     IF ACCT-LEVEL-DIFFERENT
 10184        GO TO 6975-UPDATE-LEVEL-NO.
 10185
 10186     IF GX-AGENT-POINTER-CNT = +1006
 10187         GO TO 6979-EXIT.
 10188
 10189     MOVE +1 TO FIND-AGENT-SUB1.
 10190
 10191 6972-FIND-REC-LOCATION.
 10192     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10193     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10194
 10195     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10196        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10197        NEXT SENTENCE
 10198     ELSE
 10199        ADD +1 TO FIND-AGENT-SUB1
 10200        GO TO 6972-FIND-REC-LOCATION.
 10201
 10202     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10203                                  FIND-AGENT-SUB3.
 10204     ADD +1 TO FIND-AGENT-SUB3.
 10205
 10206     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10207        NEXT SENTENCE
 10208     ELSE
 10209        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10210        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10211        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 198
* EL6501.cbl
 10212
 10213     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10214     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10215
 10216     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10217     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10218
 10219     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10220     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10221     MOVE AM-EXPIRATION-DT TO
 10222                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10223     MOVE AM-EFFECTIVE-DT  TO
 10224                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10225     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10226     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10227
 10228 6975-UPDATE-LEVEL-NO.
 10229     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10230     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10231     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10232     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10233     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10234     if ergxrf-rec-len > +31264
 10235        move +31264               to ergxrf-rec-len
 10236        move +1006                to gx-agent-pointer-cnt
 10237     end-if
 10238
 10239
 10240* EXEC CICS REWRITE
 10241*        FROM      (AGENT-CROSS-REFERENCE)
 10242*        LENGTH    (ERGXRF-REC-LEN)
 10243*        DATASET   (ERGXRF-FILE-ID)
 10244*    END-EXEC.
 10245*    MOVE '&& L                  %   #00009244' TO DFHEIV0
 10246     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10247     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10248     MOVE X'2020233030303039323434' TO DFHEIV0(25:11)
 10249     CALL 'kxdfhei1' USING DFHEIV0,
 10250           ERGXRF-FILE-ID,
 10251           AGENT-CROSS-REFERENCE,
 10252           ERGXRF-REC-LEN,
 10253           DFHEIV99
 10254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10255
 10256
 10257     GO TO 6979-EXIT.
 10258
 10259 6977-BUMP-AXRF-REC.
 10260     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10261          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10262
 10263     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10264
 10265 6979-EXIT.
 10266     EXIT.
 10267
 10268 6999-EXIT.
 10269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 199
* EL6501.cbl
 10271 7000-DELETE-AXRF-REC.
 10272     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10273
 10274
 10275* EXEC CICS HANDLE CONDITION
 10276*         ENDFILE     (7999-EXIT)
 10277*         NOTFND      (7999-EXIT)
 10278*    END-EXEC.
 10279*    MOVE '"$''I                  ! 2 #00009267' TO DFHEIV0
 10280     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10282     MOVE X'3220233030303039323637' TO DFHEIV0(25:11)
 10283     CALL 'kxdfhei1' USING DFHEIV0
 10284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10285
 10286
 10287
 10288* EXEC CICS READ
 10289*        DATASET   (ERGXRF-FILE-ID)
 10290*        INTO      (AGENT-CROSS-REFERENCE)
 10291*        LENGTH    (ERGXRF-REC-LEN)
 10292*        RIDFLD    (WS-AXRF-KEY)
 10293*        EQUAL
 10294*        UPDATE
 10295*    END-EXEC.
 10296*    MOVE '&"IL       EU         (   #00009272' TO DFHEIV0
 10297     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10299     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
 10300     CALL 'kxdfhei1' USING DFHEIV0,
 10301           ERGXRF-FILE-ID,
 10302           AGENT-CROSS-REFERENCE,
 10303           ERGXRF-REC-LEN,
 10304           WS-AXRF-KEY,
 10305           DFHEIV99,
 10306           DFHEIV99,
 10307           DFHEIV99
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10312
 10313     IF GX-AGENT-SUB = +0
 10314        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10315        FROM +1 BY +1 UNTIL
 10316         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10317         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10318         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10319         AND
 10320         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10321         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10322         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10323         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10324
 10325     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10326        GO TO 7999-EXIT.
 10327
 10328     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 200
* EL6501.cbl
 10329     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10330                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10331                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10332     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10333     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10334     GO TO 7020-REWRITE-AXRF-RECORD.
 10335
 10336 7010-BUMP-RECORDS.
 10337     ADD +1 TO FIND-AGENT-SUB1.
 10338     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10339          GX-AGENT-POINTER (GX-AGENT-SUB).
 10340
 10341 7020-REWRITE-AXRF-RECORD.
 10342     IF GX-AGENT-POINTER-CNT = +0
 10343
 10344* EXEC CICS DELETE
 10345*            DATASET   (ERGXRF-FILE-ID)
 10346*       END-EXEC
 10347*    MOVE '&(                    &   #00009313' TO DFHEIV0
 10348     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10350     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
 10351     CALL 'kxdfhei1' USING DFHEIV0,
 10352           ERGXRF-FILE-ID,
 10353           DFHEIV99,
 10354           DFHEIV99,
 10355           DFHEIV99,
 10356           DFHEIV99
 10357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10358     ELSE
 10359        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10360        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10361        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10362        compute ergxrf-rec-len =
 10363            (gx-agent-pointer-cnt * +31) + +78
 10364        if ergxrf-rec-len > +31264
 10365           move +31264               to ergxrf-rec-len
 10366           move +1006                to gx-agent-pointer-cnt
 10367        end-if
 10368
 10369* EXEC CICS REWRITE
 10370*            FROM      (AGENT-CROSS-REFERENCE)
 10371*            LENGTH    (ERGXRF-REC-LEN)
 10372*            DATASET   (ERGXRF-FILE-ID)
 10373*       END-EXEC.
 10374*    MOVE '&& L                  %   #00009326' TO DFHEIV0
 10375     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10376     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10377     MOVE X'2020233030303039333236' TO DFHEIV0(25:11)
 10378     CALL 'kxdfhei1' USING DFHEIV0,
 10379           ERGXRF-FILE-ID,
 10380           AGENT-CROSS-REFERENCE,
 10381           ERGXRF-REC-LEN,
 10382           DFHEIV99
 10383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10384
 10385
 10386 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 201
* EL6501.cbl
 10387     EXIT.
 10388
 10389*************************************
 10390 8000-STATE-REC-READ.
 10391     MOVE SPACES                 TO ELCNTL-KEY.
 10392     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10393     MOVE '3'                    TO CNTL-REC-TYPE.
 10394     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10395     MOVE +0                     TO CNTL-SEQ-NO.
 10396
 10397* EXEC CICS HANDLE CONDITION
 10398*        NOTFND  (8010-EXIT)
 10399*    END-EXEC.
 10400*    MOVE '"$I                   ! 3 #00009342' TO DFHEIV0
 10401     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10403     MOVE X'3320233030303039333432' TO DFHEIV0(25:11)
 10404     CALL 'kxdfhei1' USING DFHEIV0
 10405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10406
 10407
 10408
 10409* EXEC CICS READ
 10410*        DATASET   (CNTL-FILE-ID)
 10411*        SET       (ADDRESS OF CONTROL-FILE)
 10412*        RIDFLD    (ELCNTL-KEY)
 10413*    END-EXEC.
 10414*    MOVE '&"S        E          (   #00009346' TO DFHEIV0
 10415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10417     MOVE X'2020233030303039333436' TO DFHEIV0(25:11)
 10418     CALL 'kxdfhei1' USING DFHEIV0,
 10419           CNTL-FILE-ID,
 10420           DFHEIV20,
 10421           DFHEIV99,
 10422           ELCNTL-KEY,
 10423           DFHEIV99,
 10424           DFHEIV99,
 10425           DFHEIV99
 10426     SET ADDRESS OF CONTROL-FILE TO
 10427         DFHEIV20
 10428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10429
 10430
 10431     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10432     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10433
 10434 8010-EXIT.
 10435      EXIT.
 10436
 10437 8050-USER-REC-READ.
 10438     MOVE SPACES                 TO ELCNTL-KEY.
 10439     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10440     MOVE '2'                    TO CNTL-REC-TYPE.
 10441     MOVE CSRI                   TO CNTL-ACCESS.
 10442     MOVE +0                     TO CNTL-SEQ-NO.
 10443
 10444* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 202
* EL6501.cbl
 10445*        NOTFND  (8055-NOTFND)
 10446*    END-EXEC.
 10447*    MOVE '"$I                   ! 4 #00009364' TO DFHEIV0
 10448     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10450     MOVE X'3420233030303039333634' TO DFHEIV0(25:11)
 10451     CALL 'kxdfhei1' USING DFHEIV0
 10452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10453
 10454
 10455
 10456* EXEC CICS READ
 10457*        DATASET   (CNTL-FILE-ID)
 10458*        SET       (ADDRESS OF CONTROL-FILE)
 10459*        RIDFLD    (ELCNTL-KEY)
 10460*    END-EXEC.
 10461*    MOVE '&"S        E          (   #00009368' TO DFHEIV0
 10462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10464     MOVE X'2020233030303039333638' TO DFHEIV0(25:11)
 10465     CALL 'kxdfhei1' USING DFHEIV0,
 10466           CNTL-FILE-ID,
 10467           DFHEIV20,
 10468           DFHEIV99,
 10469           ELCNTL-KEY,
 10470           DFHEIV99,
 10471           DFHEIV99,
 10472           DFHEIV99
 10473     SET ADDRESS OF CONTROL-FILE TO
 10474         DFHEIV20
 10475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10476
 10477
 10478     GO TO 8060-EXIT.
 10479
 10480 8055-NOTFND.
 10481     MOVE ER-1883             TO EMI-ERROR.
 10482     MOVE -1                  TO CSRL.
 10483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10484
 10485 8060-EXIT.
 10486      EXIT.
 10487
 10488*************************************
 10489
 10490 8100-SEND-INITIAL-MAP.
 10491     MOVE SAVE-DATE              TO DATEO.
 10492     MOVE EIBTIME                TO TIME-IN.
 10493     MOVE TIME-OUT               TO TIMEO.
 10494     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10495     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10496     MOVE -1                     TO PFENTERL.
 10497     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10498
 10499     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10500
 10501*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10502*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 203
* EL6501.cbl
 10503*    ELSE
 10504*       MOVE AL-SADOF            TO PSIHEADA
 10505*                                   PSILFTA
 10506*                                   PSILFCA
 10507*                                   PSIAHTA
 10508*                                   PSIAHCA
 10509*                                   PSILFFA
 10510*                                   PSIAHFA.
 10511
 10512*    IF PI-COMPANY-ID = 'DMD'
 10513*         MOVE AL-SANOF          TO KEY10A.
 10514
 10515     IF PI-COMPANY-ID = 'DCC'
 10516        CONTINUE
 10517     ELSE
 10518        MOVE AL-SADOF            TO CTPLABLA
 10519                                    CLPTOLPA
 10520                                    LCLABLA
 10521                                    LCOMMA
 10522                                    MAXFEEHA
 10523                                    CLPSTHA
 10524                                    PRODCDHA
 10525     END-IF
 10526     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10527        MOVE -1                  TO CSRL.
 10528
 10529     IF  CLAIM-SESSION
 10530         MOVE SPACES             TO PF1PF2O
 10531         MOVE AL-SANOF           TO PF1PF2A.
 10532
 10533
 10534* EXEC CICS SEND
 10535*        MAP      (MAP-NAME)
 10536*        MAPSET   (MAPSET-NAME)
 10537*        FROM     (EL6501AO)
 10538*        ERASE
 10539*        CURSOR
 10540*    END-EXEC.
 10541     MOVE LENGTH OF
 10542      EL6501AO
 10543       TO DFHEIV12
 10544     MOVE -1
 10545       TO DFHEIV11
 10546*    MOVE '8$     CT  E    H L F ,   #00009429' TO DFHEIV0
 10547     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10548     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10549     MOVE X'2020233030303039343239' TO DFHEIV0(25:11)
 10550     CALL 'kxdfhei1' USING DFHEIV0,
 10551           MAP-NAME,
 10552           EL6501AO,
 10553           DFHEIV12,
 10554           MAPSET-NAME,
 10555           DFHEIV99,
 10556           DFHEIV99,
 10557           DFHEIV99,
 10558           DFHEIV11,
 10559           DFHEIV99,
 10560           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 204
* EL6501.cbl
 10561           DFHEIV99
 10562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10563
 10564
 10565     GO TO 9100-RETURN-TRAN.
 10566
 10567 8200-SEND-DATAONLY.
 10568     MOVE SAVE-DATE              TO DATEO.
 10569     MOVE EIBTIME                TO TIME-IN.
 10570     MOVE TIME-OUT               TO TIMEO.
 10571     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10572     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10573     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10574
 10575     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10576
 10577     IF PI-COMPANY-ID = 'DCC'
 10578        CONTINUE
 10579     ELSE
 10580        MOVE AL-SADOF            TO CTPLABLA
 10581                                    CLPTOLPA
 10582                                    LCLABLA
 10583                                    LCOMMA
 10584                                    MAXFEEHA
 10585                                    CLPSTHA
 10586                                    PRODCDHA
 10587     END-IF
 10588     IF  CLAIM-SESSION
 10589         MOVE SPACES             TO PF1PF2O
 10590         MOVE AL-SANOF           TO PF1PF2A.
 10591
 10592
 10593* EXEC CICS SEND
 10594*        MAP      (MAP-NAME)
 10595*        MAPSET   (MAPSET-NAME)
 10596*        FROM     (EL6501AO)
 10597*        DATAONLY
 10598*        CURSOR
 10599*    END-EXEC.
 10600     MOVE LENGTH OF
 10601      EL6501AO
 10602       TO DFHEIV12
 10603     MOVE -1
 10604       TO DFHEIV11
 10605*    MOVE '8$D    CT       H L F ,   #00009464' TO DFHEIV0
 10606     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10607     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10608     MOVE X'2020233030303039343634' TO DFHEIV0(25:11)
 10609     CALL 'kxdfhei1' USING DFHEIV0,
 10610           MAP-NAME,
 10611           EL6501AO,
 10612           DFHEIV12,
 10613           MAPSET-NAME,
 10614           DFHEIV99,
 10615           DFHEIV99,
 10616           DFHEIV99,
 10617           DFHEIV11,
 10618           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 205
* EL6501.cbl
 10619           DFHEIV99,
 10620           DFHEIV99
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10622
 10623
 10624     GO TO 9100-RETURN-TRAN.
 10625
 10626 8300-SEND-TEXT.
 10627
 10628* EXEC CICS SEND TEXT
 10629*        FROM     (LOGOFF-TEXT)
 10630*        LENGTH   (LOGOFF-LENGTH)
 10631*        ERASE
 10632*        FREEKB
 10633*    END-EXEC.
 10634*    MOVE '8&      T  E F  H   F -   #00009475' TO DFHEIV0
 10635     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10636     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10637     MOVE X'2020233030303039343735' TO DFHEIV0(25:11)
 10638     CALL 'kxdfhei1' USING DFHEIV0,
 10639           LOGOFF-TEXT,
 10640           LOGOFF-LENGTH,
 10641           DFHEIV99,
 10642           DFHEIV99,
 10643           DFHEIV99,
 10644           DFHEIV99,
 10645           DFHEIV99,
 10646           DFHEIV99,
 10647           DFHEIV99,
 10648           DFHEIV99,
 10649           DFHEIV99,
 10650           DFHEIV99
 10651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10652
 10653
 10654
 10655* EXEC CICS RETURN
 10656*    END-EXEC.
 10657*    MOVE '.(                    ''   #00009482' TO DFHEIV0
 10658     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10660     MOVE X'2020233030303039343832' TO DFHEIV0(25:11)
 10661     CALL 'kxdfhei1' USING DFHEIV0,
 10662           DFHEIV99,
 10663           DFHEIV99,
 10664           DFHEIV99,
 10665           DFHEIV99,
 10666           DFHEIV99,
 10667           DFHEIV99
 10668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10669
 10670
 10671 8600-DEEDIT.
 10672
 10673* EXEC CICS BIF DEEDIT
 10674*         FIELD(DEEDIT-FIELD)
 10675*         LENGTH(15)
 10676*     END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 206
* EL6501.cbl
 10677     MOVE 15
 10678       TO DFHEIV11
 10679*    MOVE '@"L                   #   #00009486' TO DFHEIV0
 10680     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10681     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10682     MOVE X'2020233030303039343836' TO DFHEIV0(25:11)
 10683     CALL 'kxdfhei1' USING DFHEIV0,
 10684           DEEDIT-FIELD,
 10685           DFHEIV11
 10686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10687
 10688
 10689 8800-UNAUTHORIZED-ACCESS.
 10690     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10691     GO TO 8300-SEND-TEXT.
 10692
 10693 8810-PF23.
 10694     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10695     MOVE XCTL-005               TO PGM-NAME.
 10696     GO TO 9300-XCTL.
 10697
 10698 9100-RETURN-TRAN.
 10699     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10700     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10701
 10702* EXEC CICS RETURN
 10703*        TRANSID    (TRANS-ID)
 10704*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10705*        LENGTH     (WS-COMM-LENGTH)
 10706*    END-EXEC.
 10707*    MOVE '.(CT                  ''   #00009503' TO DFHEIV0
 10708     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10709     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10710     MOVE X'2020233030303039353033' TO DFHEIV0(25:11)
 10711     CALL 'kxdfhei1' USING DFHEIV0,
 10712           TRANS-ID,
 10713           PROGRAM-INTERFACE-BLOCK,
 10714           WS-COMM-LENGTH,
 10715           DFHEIV99,
 10716           DFHEIV99,
 10717           DFHEIV99
 10718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10719
 10720
 10721 9200-RETURN-MAIN-MENU.
 10722     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10723         MOVE XCTL-126           TO  PGM-NAME
 10724     ELSE
 10725         MOVE XCTL-626           TO  PGM-NAME.
 10726
 10727     GO TO 9300-XCTL.
 10728
 10729 9300-XCTL.
 10730
 10731* EXEC CICS XCTL
 10732*        PROGRAM    (PGM-NAME)
 10733*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10734*        LENGTH     (WS-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 207
* EL6501.cbl
 10735*    END-EXEC.
 10736*    MOVE '.$C                   %   #00009518' TO DFHEIV0
 10737     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10738     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10739     MOVE X'2020233030303039353138' TO DFHEIV0(25:11)
 10740     CALL 'kxdfhei1' USING DFHEIV0,
 10741           PGM-NAME,
 10742           PROGRAM-INTERFACE-BLOCK,
 10743           WS-COMM-LENGTH,
 10744           DFHEIV99
 10745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10746
 10747
 10748 9400-CLEAR.
 10749     IF PI-GA-BILLING
 10750        IF GETMAIN-ACQUIRED
 10751           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10752           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10753
 10754* EXEC CICS FREEMAIN
 10755*               DATA     (COMMISSION-WORK-AREA)
 10756*          END-EXEC.
 10757*    MOVE ',$D                   "   #00009529' TO DFHEIV0
 10758     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10759     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10760     MOVE X'2020233030303039353239' TO DFHEIV0(25:11)
 10761     CALL 'kxdfhei1' USING DFHEIV0,
 10762           COMMISSION-WORK-AREA
 10763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10764
 10765
 10766     MOVE SPACES                 TO PI-SV-MAINT.
 10767     MOVE XCTL-650               TO PGM-NAME.
 10768     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10769     GO TO 9300-XCTL.
 10770
 10771 9500-PF12.
 10772     MOVE XCTL-010               TO PGM-NAME.
 10773     GO TO 9300-XCTL.
 10774
 10775 9600-PGMID-ERROR.
 10776
 10777* EXEC CICS HANDLE CONDITION
 10778*        PGMIDERR    (8300-SEND-TEXT)
 10779*    END-EXEC.
 10780*    MOVE '"$L                   ! 5 #00009543' TO DFHEIV0
 10781     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10783     MOVE X'3520233030303039353433' TO DFHEIV0(25:11)
 10784     CALL 'kxdfhei1' USING DFHEIV0
 10785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10786
 10787
 10788     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10789     MOVE ' '                    TO PI-ENTRY-CD-1.
 10790     MOVE XCTL-005               TO PGM-NAME.
 10791     MOVE PGM-NAME               TO LOGOFF-PGM.
 10792     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 208
* EL6501.cbl
 10793     GO TO 9300-XCTL.
 10794
 10795 9700-DATE-LINK.
 10796     MOVE LINK-ELDATCV           TO PGM-NAME.
 10797
 10798* EXEC CICS LINK
 10799*        PROGRAM    (PGM-NAME)
 10800*        COMMAREA   (DATE-CONVERSION-DATA)
 10801*        LENGTH     (DC-COMM-LENGTH)
 10802*    END-EXEC.
 10803*    MOVE '."C                   (   #00009556' TO DFHEIV0
 10804     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10806     MOVE X'2020233030303039353536' TO DFHEIV0(25:11)
 10807     CALL 'kxdfhei1' USING DFHEIV0,
 10808           PGM-NAME,
 10809           DATE-CONVERSION-DATA,
 10810           DC-COMM-LENGTH,
 10811           DFHEIV99,
 10812           DFHEIV99,
 10813           DFHEIV99,
 10814           DFHEIV99
 10815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10816
 10817
 10818 9900-ERROR-FORMAT.
 10819     IF NOT EMI-ERRORS-COMPLETE
 10820         MOVE LINK-001           TO PGM-NAME
 10821
 10822* EXEC CICS LINK
 10823*            PROGRAM    (PGM-NAME)
 10824*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10825*            LENGTH     (EMI-COMM-LENGTH)
 10826*        END-EXEC.
 10827*    MOVE '."C                   (   #00009565' TO DFHEIV0
 10828     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10830     MOVE X'2020233030303039353635' TO DFHEIV0(25:11)
 10831     CALL 'kxdfhei1' USING DFHEIV0,
 10832           PGM-NAME,
 10833           ERROR-MESSAGE-INTERFACE-BLOCK,
 10834           EMI-COMM-LENGTH,
 10835           DFHEIV99,
 10836           DFHEIV99,
 10837           DFHEIV99,
 10838           DFHEIV99
 10839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10840
 10841
 10842 9900-EXIT.
 10843     EXIT.
 10844
 10845 9990-ABEND.
 10846     MOVE LINK-004               TO PGM-NAME.
 10847     MOVE DFHEIBLK               TO EMI-LINE1.
 10848
 10849* EXEC CICS LINK
 10850*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 209
* EL6501.cbl
 10851*        COMMAREA  (EMI-LINE1)
 10852*        LENGTH    (72)
 10853*    END-EXEC.
 10854     MOVE 72
 10855       TO DFHEIV11
 10856*    MOVE '."C                   (   #00009577' TO DFHEIV0
 10857     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10858     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10859     MOVE X'2020233030303039353737' TO DFHEIV0(25:11)
 10860     CALL 'kxdfhei1' USING DFHEIV0,
 10861           PGM-NAME,
 10862           EMI-LINE1,
 10863           DFHEIV11,
 10864           DFHEIV99,
 10865           DFHEIV99,
 10866           DFHEIV99,
 10867           DFHEIV99
 10868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10869
 10870
 10871     MOVE -1                     TO PFENTERL.
 10872     GO TO 8200-SEND-DATAONLY.
 10873
 10874
 10875* GOBACK.
 10876     MOVE '9%                    "   ' TO DFHEIV0
 10877     MOVE 'EL6501' TO DFHEIV1
 10878     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10879     GOBACK.
 10880
 10881 9995-SECURITY-VIOLATION.
 10882*                            COPY ELCSCTP.
 10883******************************************************************
 10884*                                                                *
 10885*                            ELCSCTP                             *
 10886*                            VMOD=2.001                          *
 10887*                                                                *
 10888*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10889******************************************************************
 10890
 10891
 10892     MOVE EIBDATE          TO SM-JUL-DATE.
 10893     MOVE EIBTRMID         TO SM-TERMID.
 10894     MOVE THIS-PGM         TO SM-PGM.
 10895     MOVE EIBTIME          TO TIME-IN.
 10896     MOVE TIME-OUT         TO SM-TIME.
 10897     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10898
 10899
 10900* EXEC CICS LINK
 10901*         PROGRAM  ('EL003')
 10902*         COMMAREA (SECURITY-MESSAGE)
 10903*         LENGTH   (80)
 10904*    END-EXEC.
 10905     MOVE 'EL003' TO DFHEIV1
 10906     MOVE 80
 10907       TO DFHEIV11
 10908*    MOVE '."C                   (   #00009606' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 210
* EL6501.cbl
 10909     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10911     MOVE X'2020233030303039363036' TO DFHEIV0(25:11)
 10912     CALL 'kxdfhei1' USING DFHEIV0,
 10913           DFHEIV1,
 10914           SECURITY-MESSAGE,
 10915           DFHEIV11,
 10916           DFHEIV99,
 10917           DFHEIV99,
 10918           DFHEIV99,
 10919           DFHEIV99
 10920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10921
 10922
 10923******************************************************************
 10924
 10925
 10926 9995-EXIT.
 10927     EXIT.
 10928
 10929 9999-DFHBACK SECTION.
 10930     MOVE '9%                    "   ' TO DFHEIV0
 10931     MOVE 'EL6501' TO DFHEIV1
 10932     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10933     GOBACK.
 10934 9999-DFHEXIT.
 10935     IF DFHEIGDJ EQUAL 0001
 10936         NEXT SENTENCE
 10937     ELSE IF DFHEIGDJ EQUAL 2
 10938         GO TO 9600-PGMID-ERROR,
 10939               9990-ABEND,
 10940               0500-CHECK-MAINT-TYPE
 10941         DEPENDING ON DFHEIGDI
 10942     ELSE IF DFHEIGDJ EQUAL 3
 10943         GO TO 1500-EXIT
 10944         DEPENDING ON DFHEIGDI
 10945     ELSE IF DFHEIGDJ EQUAL 4
 10946         GO TO 1799-EXIT,
 10947               1799-EXIT
 10948         DEPENDING ON DFHEIGDI
 10949     ELSE IF DFHEIGDJ EQUAL 5
 10950         GO TO 2100-EXIT
 10951         DEPENDING ON DFHEIGDI
 10952     ELSE IF DFHEIGDJ EQUAL 6
 10953         GO TO 2200-EXIT
 10954         DEPENDING ON DFHEIGDI
 10955     ELSE IF DFHEIGDJ EQUAL 7
 10956         GO TO 3030-END-FILE
 10957         DEPENDING ON DFHEIGDI
 10958     ELSE IF DFHEIGDJ EQUAL 8
 10959         GO TO 3530-END-FILE
 10960         DEPENDING ON DFHEIGDI
 10961     ELSE IF DFHEIGDJ EQUAL 9
 10962         GO TO 4020-BUS-TYPE-ERROR
 10963         DEPENDING ON DFHEIGDI
 10964     ELSE IF DFHEIGDJ EQUAL 10
 10965         GO TO 4099-STD-BEN-ERROR
 10966         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:29 Page 211
* EL6501.cbl
 10967     ELSE IF DFHEIGDJ EQUAL 11
 10968         GO TO 4180-REIN-ERROR
 10969         DEPENDING ON DFHEIGDI
 10970     ELSE IF DFHEIGDJ EQUAL 12
 10971         GO TO 5250-QID-ERROR
 10972         DEPENDING ON DFHEIGDI
 10973     ELSE IF DFHEIGDJ EQUAL 13
 10974         GO TO 5399-EXIT,
 10975               5399-EXIT
 10976         DEPENDING ON DFHEIGDI
 10977     ELSE IF DFHEIGDJ EQUAL 14
 10978         GO TO 6450-NOT-FOUND
 10979         DEPENDING ON DFHEIGDI
 10980     ELSE IF DFHEIGDJ EQUAL 15
 10981         GO TO 6699-EXIT
 10982         DEPENDING ON DFHEIGDI
 10983     ELSE IF DFHEIGDJ EQUAL 16
 10984         GO TO 6880-NO-COMP
 10985         DEPENDING ON DFHEIGDI
 10986     ELSE IF DFHEIGDJ EQUAL 17
 10987         GO TO 6925-NOT-FIND,
 10988               6925-NOT-FIND
 10989         DEPENDING ON DFHEIGDI
 10990     ELSE IF DFHEIGDJ EQUAL 18
 10991         GO TO 7999-EXIT,
 10992               7999-EXIT
 10993         DEPENDING ON DFHEIGDI
 10994     ELSE IF DFHEIGDJ EQUAL 19
 10995         GO TO 8010-EXIT
 10996         DEPENDING ON DFHEIGDI
 10997     ELSE IF DFHEIGDJ EQUAL 20
 10998         GO TO 8055-NOTFND
 10999         DEPENDING ON DFHEIGDI
 11000     ELSE IF DFHEIGDJ EQUAL 21
 11001         GO TO 8300-SEND-TEXT
 11002         DEPENDING ON DFHEIGDI.
 11003     MOVE '9%                    "   ' TO DFHEIV0
 11004     MOVE 'EL6501' TO DFHEIV1
 11005     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11006     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39340     Code:       34941
