* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   1
* BSSRCH.cbl
* Options: int("BSSRCH.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("BSSRCH.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"BSSRCH.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"BSSRCH.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2013 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. BSSRCH.
     9*
    10*AUTHOR.    Pablo.
    11*           Colleyville, TEXAS.
    12********************************************
    13*   Balance sheet for month end balancing
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   2
* BSSRCH.cbl
    14********************************************
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 082013  CR2013060600001  PEMA  ADJ TOL TO 10% FOR NON-PROC
    24 environment division.
    25 INPUT-OUTPUT SECTION.
    26 FILE-CONTROL.
    27 SELECT CID-ECS010-IN ASSIGN TO
    28    '/data/seqfiles/cilgm15.ECS010.ME50.BAL.AMTS'
    29    FILE STATUS IS ECS010-STATUS.
    30 SELECT AHL-ECS010-IN ASSIGN TO
    31    '/data/seqfiles/ahlgm15.ECS010.ME50.BAL.AMTS'
    32    FILE STATUS IS ECS010-STATUS.
    33 SELECT DCC-ECS010-IN ASSIGN TO
    34    '/data/seqfiles/cidclgm15.ECS010.ME50.BAL.AMTS'
    35    FILE STATUS IS ECS010-STATUS.
    36 SELECT CID-CHKPOINT-OUT ASSIGN TO
    37    '/data/seqfiles/cidmechkpts.txt'
    38    FILE STATUS IS CHKPNT-STATUS
    39                            ORGANIZATION IS LINE SEQUENTIAL.
    40 SELECT ahl-CHKPOINT-OUT ASSIGN TO
    41   '/data/seqfiles/ahlmechkpts.txt'
    42    FILE STATUS IS CHKPNT-STATUS
    43                            ORGANIZATION IS LINE SEQUENTIAL.
    44 SELECT dcc-CHKPOINT-OUT ASSIGN TO
    45    '/data/seqfiles/dccmechkpts.txt'
    46    FILE STATUS IS CHKPNT-STATUS
    47                            ORGANIZATION IS LINE SEQUENTIAL.
    48 data division.
    49 FILE SECTION.
    50 FD  CID-ECS010-IN
    51     BLOCK CONTAINS 0
    52     RECORDING MODE F.
    53 01  CID-ECS010-IN-REC           pic x(94).
    54 FD  AHL-ECS010-IN
    55     BLOCK CONTAINS 0
    56     RECORDING MODE F.
    57 01  AHL-ECS010-IN-REC           pic x(94).
    58 FD  DCC-ECS010-IN
    59     BLOCK CONTAINS 0
    60     RECORDING MODE F.
    61 01  DCC-ECS010-IN-REC           pic x(94).
    62 FD  cid-CHKPOINT-OUT
    63     BLOCK CONTAINS 0
    64     RECORDING MODE F.
    65 01  cid-CHKPOINT-OUT-REC        pic x(94).
    66 FD  ahl-CHKPOINT-OUT
    67     BLOCK CONTAINS 0
    68     RECORDING MODE F.
    69 01  ahl-CHKPOINT-OUT-REC        pic x(94).
    70 FD  dcc-CHKPOINT-OUT
    71     BLOCK CONTAINS 0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   3
* BSSRCH.cbl
    72     RECORDING MODE F.
    73 01  dcc-CHKPOINT-OUT-REC        pic x(94).
    74 working-storage section.
    75 01  DFH-START PIC X(04).
    76 77  s1 pic s999 comp-3 value +0.
    77 77  s2 pic s999 comp-3 value +0.
    78 77  ws-pass-amount              pic s9(11) comp-3 value +0.
    79 77  ws-low-amount               pic s9(11) value zeros.
    80 77  ws-hi-amount                pic s9(11) value zeros.
    81 77  ws-low-pct                  pic s9v9(4) value zeros comp-3.
    82 77  ws-high-pct                 pic s9v9(4) value zeros comp-3.
    83************************************************
    84* commarea passed to the business logic
    85************************************************
    86 01  srch-commarea.
    87*                                copy BSSRCH-COMMAREA.
    88*****************************************************************
    89*                                                               *
    90* Copyright (c) 2013 by CSO.                                    *
    91* All rights reserved.                                          *
    92*                                                               *
    93*****************************************************************
    94****************************************
    95*  commarea for QUERY by eom date and company id
    96*  (business logic input & output)
    97****************************************
    98     03  bl-input.
    99         05  bl-input-eom-date   pic x(10).
   100         05  bl-input-comp-id    pic xxx.
   101         05  bl-input-lo-resv    pic 9(9).
   102         05  bl-input-hi-resv    pic 9(9).
   103         05  bl-input-bld-file   pic xxx.
   104     03  bl-output.
   105         05  bl-status           pic x.
   106             88  bl-ok                 value "p".
   107             88  bl-fail               value "f".
   108         05  bl-output-message   pic x(50).
   109         05  bl-output-record.
   110            07  bl-out-company-name
   111                                 pic x(30).
   112            07  bl-out-formated-date
   113                                 pic x(20).
   114            07  filler occurs 3.
   115                09  bl-out-lf-prem  pic s9(9)v99 comp-3 value +0.
   116                09  bl-out-ah-prem  pic s9(9)v99 comp-3 value +0.
   117                09  bl-out-lf-ref   pic s9(9)v99 comp-3 value +0.
   118                09  bl-out-ah-ref   pic s9(9)v99 comp-3 value +0.
   119                09  bl-out-lf-net   pic s9(9)v99 comp-3 value +0.
   120                09  bl-out-ah-net   pic s9(9)v99 comp-3 value +0.
   121                09  bl-out-lf-iss-com
   122                                    pic s9(9)v99 comp-3 value +0.
   123                09  bl-out-ah-iss-com
   124                                    pic s9(9)v99 comp-3 value +0.
   125                09  bl-out-lf-ref-com
   126                                    pic s9(9)v99 comp-3 value +0.
   127                09  bl-out-ah-ref-com
   128                                    pic s9(9)v99 comp-3 value +0.
   129                09  bl-out-lf-net-com
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   4
* BSSRCH.cbl
   130                                    pic s9(9)v99 comp-3 value +0.
   131                09  bl-out-ah-net-com
   132                                    pic s9(9)v99 comp-3 value +0.
   133                09  bl-out-iss-com  pic s9(9)v99 comp-3 value +0.
   134                09  bl-out-ref-com  pic s9(9)v99 comp-3 value +0.
   135                09  bl-out-net-com  pic s9(9)v99 comp-3 value +0.
   136                09  bl-out-iss-cnt  pic s9(9)    comp-3 value +0.
   137                09  bl-out-can-cnt  pic s9(9)    comp-3 value +0.
   138                09  bl-out-net-cnt  pic s9(9)    comp-3 value +0.
   139                09  bl-out-tot-prm  pic s9(9)v99 comp-3 value +0.
   140                09  bl-out-tot-ref  pic s9(9)v99 comp-3 value +0.
   141                09  bl-out-net-tot  pic s9(9)v99 comp-3 value +0.
   142            07  bl-out-cm-cnt    pic s9(9)     comp-3 value +0.
   143            07  bl-out-lf-clms-pd
   144                                 pic s9(9)v99  comp-3 value +0.
   145            07  bl-out-lf-clms-void
   146                                 pic s9(9)v99  comp-3 value +0.
   147            07  bl-out-lf-tot-clms
   148                                 pic s9(9)v99  comp-3 value +0.
   149            07  bl-out-ah-clms-pd
   150                                 pic s9(9)v99  comp-3 value +0.
   151            07  bl-out-ah-clms-void
   152                                 pic s9(9)v99  comp-3 value +0.
   153            07  bl-out-ah-tot-clms
   154                                 pic s9(9)v99  comp-3 value +0.
   155            07  bl-out-clms-pd   pic s9(9)v99  comp-3 value +0.
   156            07  bl-out-clms-void pic s9(9)v99  comp-3 value +0.
   157            07  bl-out-tot-clms  pic s9(9)v99  comp-3 value +0.
   158            07  bl-out-lf-clms-cur
   159                                 pic s9(9)v99  comp-3 value +0.
   160            07  bl-out-ah-clms-cur
   161                                 pic s9(9)v99  comp-3 value +0.
   162            07  bl-out-tot-clms-cur
   163                                 pic s9(9)v99  comp-3 value +0.
   164*                                copy ELCFUNDT.
   165*****************************************************************
   166*                                                               *
   167*                            ELCFUNDT.                          *
   168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   169*                            VMOD=2.001                         *
   170*                                                               *
   171*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   172*                                                               *
   173*****************************************************************
   174
   175
   176 01  FUNCTION-DATE.
   177     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   178     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   179         10  WS-FN-CCYR            PIC 9(4).
   180         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   181             15  WS-FN-CC          PIC 99.
   182             15  WS-FN-YR          PIC 99.
   183         10  WS-FN-MO              PIC 99.
   184         10  WS-FN-DA              PIC 99.
   185     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   186     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   187     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   5
* BSSRCH.cbl
   188     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   189     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   190         88  WS-BEHIND-GMT                     VALUE '-'.
   191         88  WS-AFTER-GMT                      VALUE '+'.
   192         88  WS-NO-GMT                         VALUE ZERO.
   193     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   194     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   195*                                COPY ELCDATE.
   196******************************************************************
   197*                                                                *
   198*                                                                *
   199*                            ELCDATE.                            *
   200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   201*                            VMOD=2.003
   202*                                                                *
   203*                                                                *
   204*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   205*                 LENGTH = 200                                   *
   206******************************************************************
   207
   208 01  DATE-CONVERSION-DATA.
   209     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   210     12  DC-OPTION-CODE                PIC X.
   211         88  BIN-TO-GREG                VALUE ' '.
   212         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   213         88  EDIT-GREG-TO-BIN           VALUE '2'.
   214         88  YMD-GREG-TO-BIN            VALUE '3'.
   215         88  MDY-GREG-TO-BIN            VALUE '4'.
   216         88  JULIAN-TO-BIN              VALUE '5'.
   217         88  BIN-PLUS-ELAPSED           VALUE '6'.
   218         88  FIND-CENTURY               VALUE '7'.
   219         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   220         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   221         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   222         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   223         88  JULIAN-TO-BIN-3            VALUE 'C'.
   224         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   225         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   226         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   227         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   228         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   229         88  CHECK-LEAP-YEAR            VALUE 'H'.
   230         88  BIN-3-TO-GREG              VALUE 'I'.
   231         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   232         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   233         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   234         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   235         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   236         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   237         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   238         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   239         88  THREE-CHARACTER-BIN
   240                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   241         88  GREGORIAN-TO-BIN
   242                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   243         88  BIN-TO-GREGORIAN
   244                  VALUES ' ' '1' 'I' '8' 'G'.
   245         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   6
* BSSRCH.cbl
   246                  VALUES '5' 'C' 'E' 'F'.
   247     12  DC-ERROR-CODE                 PIC X.
   248         88  NO-CONVERSION-ERROR        VALUE ' '.
   249         88  DATE-CONVERSION-ERROR
   250                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   251         88  DATE-IS-ZERO               VALUE '1'.
   252         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   253         88  DATE-IS-INVALID            VALUE '3'.
   254         88  DATE1-GREATER-DATE2        VALUE '4'.
   255         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   256         88  DATE-INVALID-OPTION        VALUE '9'.
   257         88  INVALID-CENTURY            VALUE 'A'.
   258         88  ONLY-CENTURY               VALUE 'B'.
   259         88  ONLY-LEAP-YEAR             VALUE 'C'.
   260         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   261     12  DC-END-OF-MONTH               PIC X.
   262         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   263     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   264         88  USE-NORMAL-PROCESS         VALUE ' '.
   265         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   266         88  ADJUST-UP-100-YRS          VALUE '2'.
   267     12  FILLER                        PIC X.
   268     12  DC-CONVERSION-DATES.
   269         16  DC-BIN-DATE-1             PIC XX.
   270         16  DC-BIN-DATE-2             PIC XX.
   271         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   272         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   273                       DC-GREG-DATE-1-EDIT.
   274             20  DC-EDIT1-MONTH        PIC 99.
   275             20  SLASH1-1              PIC X.
   276             20  DC-EDIT1-DAY          PIC 99.
   277             20  SLASH1-2              PIC X.
   278             20  DC-EDIT1-YEAR         PIC 99.
   279         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   280         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   281                     DC-GREG-DATE-2-EDIT.
   282             20  DC-EDIT2-MONTH        PIC 99.
   283             20  SLASH2-1              PIC X.
   284             20  DC-EDIT2-DAY          PIC 99.
   285             20  SLASH2-2              PIC X.
   286             20  DC-EDIT2-YEAR         PIC 99.
   287         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   288         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   289                     DC-GREG-DATE-1-YMD.
   290             20  DC-YMD-YEAR           PIC 99.
   291             20  DC-YMD-MONTH          PIC 99.
   292             20  DC-YMD-DAY            PIC 99.
   293         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   294         16  DC-GREG-DATE-1-MDY-R REDEFINES
   295                      DC-GREG-DATE-1-MDY.
   296             20  DC-MDY-MONTH          PIC 99.
   297             20  DC-MDY-DAY            PIC 99.
   298             20  DC-MDY-YEAR           PIC 99.
   299         16  DC-GREG-DATE-1-ALPHA.
   300             20  DC-ALPHA-MONTH        PIC X(10).
   301             20  DC-ALPHA-DAY          PIC 99.
   302             20  FILLER                PIC XX.
   303             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   7
* BSSRCH.cbl
   304                 24 DC-ALPHA-CEN-N     PIC 99.
   305             20  DC-ALPHA-YEAR         PIC 99.
   306         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   307         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   308         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   309         16  DC-JULIAN-DATE            PIC 9(05).
   310         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   311                                       PIC 9(05).
   312         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   313             20  DC-JULIAN-YEAR        PIC 99.
   314             20  DC-JULIAN-DAYS        PIC 999.
   315         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   316         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   317         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   318     12  DATE-CONVERSION-VARIBLES.
   319         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   320         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   321             20  FILLER                PIC 9(3).
   322             20  HOLD-CEN-1-CCYY.
   323                 24  HOLD-CEN-1-CC     PIC 99.
   324                 24  HOLD-CEN-1-YY     PIC 99.
   325             20  HOLD-CEN-1-MO         PIC 99.
   326             20  HOLD-CEN-1-DA         PIC 99.
   327         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   328             20  HOLD-CEN-1-R-MO       PIC 99.
   329             20  HOLD-CEN-1-R-DA       PIC 99.
   330             20  HOLD-CEN-1-R-CCYY.
   331                 24  HOLD-CEN-1-R-CC   PIC 99.
   332                 24  HOLD-CEN-1-R-YY   PIC 99.
   333             20  FILLER                PIC 9(3).
   334         16  HOLD-CENTURY-1-X.
   335             20  FILLER                PIC X(3)  VALUE SPACES.
   336             20  HOLD-CEN-1-X-CCYY.
   337                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   338                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   339             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   340             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   341         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   342             20  HOLD-CEN-1-R-X-MO     PIC XX.
   343             20  HOLD-CEN-1-R-X-DA     PIC XX.
   344             20  HOLD-CEN-1-R-X-CCYY.
   345                 24  HOLD-CEN-1-R-X-CC PIC XX.
   346                 24  HOLD-CEN-1-R-X-YY PIC XX.
   347             20  FILLER                PIC XXX.
   348         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   349         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   350         16  DC-JULIAN-DATE-1          PIC 9(07).
   351         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   352             20  DC-JULIAN-1-CCYY.
   353                 24  DC-JULIAN-1-CC    PIC 99.
   354                 24  DC-JULIAN-1-YR    PIC 99.
   355             20  DC-JULIAN-DA-1        PIC 999.
   356         16  DC-JULIAN-DATE-2          PIC 9(07).
   357         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   358             20  DC-JULIAN-2-CCYY.
   359                 24  DC-JULIAN-2-CC    PIC 99.
   360                 24  DC-JULIAN-2-YR    PIC 99.
   361             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   8
* BSSRCH.cbl
   362         16  DC-GREG-DATE-A-EDIT.
   363             20  DC-EDITA-MONTH        PIC 99.
   364             20  SLASHA-1              PIC X VALUE '/'.
   365             20  DC-EDITA-DAY          PIC 99.
   366             20  SLASHA-2              PIC X VALUE '/'.
   367             20  DC-EDITA-CCYY.
   368                 24  DC-EDITA-CENT     PIC 99.
   369                 24  DC-EDITA-YEAR     PIC 99.
   370         16  DC-GREG-DATE-B-EDIT.
   371             20  DC-EDITB-MONTH        PIC 99.
   372             20  SLASHB-1              PIC X VALUE '/'.
   373             20  DC-EDITB-DAY          PIC 99.
   374             20  SLASHB-2              PIC X VALUE '/'.
   375             20  DC-EDITB-CCYY.
   376                 24  DC-EDITB-CENT     PIC 99.
   377                 24  DC-EDITB-YEAR     PIC 99.
   378         16  DC-GREG-DATE-CYMD         PIC 9(08).
   379         16  DC-GREG-DATE-CYMD-R REDEFINES
   380                              DC-GREG-DATE-CYMD.
   381             20  DC-CYMD-CEN           PIC 99.
   382             20  DC-CYMD-YEAR          PIC 99.
   383             20  DC-CYMD-MONTH         PIC 99.
   384             20  DC-CYMD-DAY           PIC 99.
   385         16  DC-GREG-DATE-MDCY         PIC 9(08).
   386         16  DC-GREG-DATE-MDCY-R REDEFINES
   387                              DC-GREG-DATE-MDCY.
   388             20  DC-MDCY-MONTH         PIC 99.
   389             20  DC-MDCY-DAY           PIC 99.
   390             20  DC-MDCY-CEN           PIC 99.
   391             20  DC-MDCY-YEAR          PIC 99.
   392    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   393        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   394    12  DC-EL310-DATE                  PIC X(21).
   395    12  FILLER                         PIC X(28).
   396 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   397     'cd /apps/prod/cid1p/jcl'.
   398 01  TRAN-DATA-LINE2.
   399     05  filler                  pic x(10) value 'unikixjob '.
   400     05  tran-comp-id            pic xxx   value '   '.
   401     05  filler                 pic x(15) value 'chkpts -k cid1p'.
   402     05  filler                  pic x(52) value spaces.
   403 01  ECS010-IN-REC.
   404     05  filler                  pic x(21).
   405     05  ecs010-cert-cnt         pic x(11).
   406     05  filler                  pic x(62).
   407 01  cpo-out-record.
   408     05  cpo-jobname             pic x(10)  value spaces.
   409     05  f                       pic x value ';'.
   410     05  cpo-stepname            pic x(6)   value spaces.
   411     05  f                       pic x value ';'.
   412     05  cpo-low-amount          pic -9(9)  value zeros.
   413     05  f                       pic x value ';'.
   414     05  cpo-hi-amount           pic -9(9)  value zeros.
   415     05  f                       pic x value ';'.
   416     05  cpo-desc                pic x(50)  value spaces.
   417 01  ahl-table.
   418     05 f                        pic x(68) value
   419         'AHLGM10   ;EL524 ;Total Claims Paid
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page   9
* BSSRCH.cbl
   420-        '            '.
   421     05 f                        pic x(68) value
   422         'AHLGM10   ;EL523 ;Processable Written & Outstanding Bala
   423-        'nce         '.
   424     05 f                        pic x(68) value
   425         'AHLGM10   ;EL523 ;Non-Processable Written & Outstanding
   426-        'Balance     '.
   427     05 f                        pic x(68) value
   428         'AHLGM10   ;EL523 ;Total Written & Outstanding Balance
   429-        '            '.
   430     05 f                        pic x(68) value
   431         'AHLGM10   ;EL523 ;Processable Cancelled
   432-        '            '.
   433     05 f                        pic x(68) value
   434         'AHLGM10   ;EL523 ;Non-Processable Cancelled
   435-        '            '.
   436     05 f                        pic x(68) value
   437         'AHLGM10   ;EL523 ;Total Cancelled
   438-        '            '.
   439     05 f                        pic x(68) value
   440         'AHLGM10   ;EL523 ;Processable Net Premium
   441-        '            '.
   442     05 f                        pic x(68) value
   443         'AHLGM10   ;EL523 ;Non-Processable Net Premium
   444-        '            '.
   445     05 f                        pic x(68) value
   446         'AHLGM10   ;EL523 ;Total Net Premium
   447-        '            '.
   448     05 f                        pic x(68) value
   449         'AHLGM10   ;EL523 ;Processable Net Commission
   450-        '            '.
   451     05 f                        pic x(68) value
   452         'AHLGM10   ;EL523 ;Non-Processable Net Commission
   453-        '            '.
   454     05 f                        pic x(68) value
   455         'AHLGM10   ;EL523 ;Total Net Commission
   456-        '            '.
   457     05 f                        pic x(68) value
   458         'AHLGM15   ;ECS010;Life Claims Paid
   459-        '            '.
   460     05 f                        pic x(68) value
   461         'AHLGM15   ;ECS010;A&H Claims Paid
   462-        '            '.
   463     05 f                        pic x(68) value
   464         'AHLGM15   ;ECS010;Output Certificate Master Records Prio
   465-        'r Month     '.
   466     05 f                        pic x(68) value
   467         'AHLGM17   ;ECS080;Gross Reserve
   468-        '            '.
   469 01  dcc-table.
   470     05 f                        pic x(68) value
   471         'CIDCLGM10 ;EL524 ;Total Claims Paid
   472-        '            '.
   473     05 f                        pic x(68) value
   474         'CIDCLGM10 ;EL523 ;Processable Written & Outstanding Bala
   475-        'nce         '.
   476     05 f                        pic x(68) value
   477         'CIDCLGM10 ;EL523 ;Non-Processable Written & Outstanding
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  10
* BSSRCH.cbl
   478-        'Balance     '.
   479     05 f                        pic x(68) value
   480         'CIDCLGM10 ;EL523 ;Total Written & Outstanding Balance
   481-        '            '.
   482     05 f                        pic x(68) value
   483         'CIDCLGM10 ;EL523 ;Processable Cancelled
   484-        '            '.
   485     05 f                        pic x(68) value
   486         'CIDCLGM10 ;EL523 ;Non-Processable Cancelled
   487-        '            '.
   488     05 f                        pic x(68) value
   489         'CIDCLGM10 ;EL523 ;Total Cancelled
   490-        '            '.
   491     05 f                        pic x(68) value
   492         'CIDCLGM10 ;EL523 ;Processable Net Premium
   493-        '            '.
   494     05 f                        pic x(68) value
   495         'CIDCLGM10 ;EL523 ;Non-Processable Net Premium
   496-        '            '.
   497     05 f                        pic x(68) value
   498         'CIDCLGM10 ;EL523 ;Total Net Premium
   499-        '            '.
   500     05 f                        pic x(68) value
   501         'CIDCLGM10 ;EL523 ;Processable Net Commission
   502-        '            '.
   503     05 f                        pic x(68) value
   504         'CIDCLGM10 ;EL523 ;Non-Processable Net Commission
   505-        '            '.
   506     05 f                        pic x(68) value
   507         'CIDCLGM10 ;EL523 ;Total Net Commission
   508-        '            '.
   509     05 f                        pic x(68) value
   510         'CIDCLGM15 ;ECS010;Life Claims Paid
   511-        '            '.
   512     05 f                        pic x(68) value
   513         'CIDCLGM15 ;ECS010;A&H Claims Paid
   514-        '            '.
   515     05 f                        pic x(68) value
   516         'CIDCLGM15 ;ECS010;Output Certificate Master Records Prio
   517-        'r Month     '.
   518     05 f                        pic x(68) value
   519         'CIDCLGM17 ;ECS080;Gross Reserve
   520-        '            '.
   521 01  cid-table.
   522     05 f                        pic x(68) value
   523         'CILGM10   ;EL524 ;Total Claims Paid
   524-        '            '.
   525     05 f                        pic x(68) value
   526         'CILGM10   ;EL523 ;Processable Written & Outstanding Bala
   527-        'nce         '.
   528     05 f                        pic x(68) value
   529         'CILGM10   ;EL523 ;Non-Processable Written & Outstanding
   530-        'Balance     '.
   531     05 f                        pic x(68) value
   532         'CILGM10   ;EL523 ;Total Written & Outstanding Balance
   533-        '            '.
   534     05 f                        pic x(68) value
   535         'CILGM10   ;EL523 ;Processable Cancelled
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  11
* BSSRCH.cbl
   536-        '            '.
   537     05 f                        pic x(68) value
   538         'CILGM10   ;EL523 ;Non-Processable Cancelled
   539-        '            '.
   540     05 f                        pic x(68) value
   541         'CILGM10   ;EL523 ;Total Cancelled
   542-        '            '.
   543     05 f                        pic x(68) value
   544         'CILGM10   ;EL523 ;Processable Net Premium
   545-        '            '.
   546     05 f                        pic x(68) value
   547         'CILGM10   ;EL523 ;Non-Processable Net Premium
   548-        '            '.
   549     05 f                        pic x(68) value
   550         'CILGM10   ;EL523 ;Total Net Premium
   551-        '            '.
   552     05 f                        pic x(68) value
   553         'CILGM10   ;EL523 ;Processable Net Commission
   554-        '            '.
   555     05 f                        pic x(68) value
   556         'CILGM10   ;EL523 ;Non-Processable Net Commission
   557-        '            '.
   558     05 f                        pic x(68) value
   559         'CILGM10   ;EL523 ;Total Net Commission
   560-        '            '.
   561     05 f                        pic x(68) value
   562         'CILGM15   ;ECS010;Life Claims Paid
   563-        '            '.
   564     05 f                        pic x(68) value
   565         'CILGM15   ;ECS010;A&H Claims Paid
   566-        '            '.
   567     05 f                        pic x(68) value
   568         'CILGM15   ;ECS010;Output Certificate Master Records Prio
   569-        'r Month     '.
   570     05 f                        pic x(68) value
   571         'CILGM17   ;ECS080;Gross Reserve
   572-        '            '.
   573 01  filler redefines cid-table.
   574     05  filler occurs 17.
   575         10  tbl-jobname             pic x(10).
   576         10  f                       pic x.
   577         10  tbl-stepname            pic x(6).
   578         10  f                       pic x.
   579         10  tbl-desc                pic x(50).
   580 01  filler.
   581     05  filler occurs 17.
   582         10  tbl-low-amount      pic s9(9).
   583         10  tbl-hi-amount       pic s9(9).
   584************************************
   585* fields used to read web data
   586************************************
   587 01  w-form-name       pic x(80).
   588 01  w-form-value      pic x(80).
   589 01  w-form-name-len   pic s9(8) comp.
   590 01  w-form-value-len  pic s9(8) comp.
   591 01  w-resp            pic s9(8) comp.
   592 01  w-doctoken        pic x(16).
   593 01  filler.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  12
* BSSRCH.cbl
   594     05  ECS010-STATUS           PIC XX VALUE ZEROS.
   595     05  CHKPNT-STATUS           pic xx value zeros.
   596     05  work-cert-cnt           pic x(11).
   597     05  numeric-cert-cnt        pic 9(9).
   598     05  work-mort-resv-lo       pic x(11).
   599     05  work-mort-resv-hi       pic x(11).
   600     05  numeric-mort-resv       pic 9(9).
   601*****************************************
   602* symbol list for the BSDETAIL template
   603*****************************************
   604 01 output-data.
   605    05  filler                   pic x(7) value"COMPID=".
   606    05  out-comp-id              pic xxx.
   607    05  filler                   pic x(8) value"&EOMDTE=".
   608    05  out-eom-date             pic x(10).
   609    05  filler                   pic x(9) value"&COMPNME=".
   610    05  out-comp-name            pic x(30).
   611    05  filler                   pic x(7) value"&FDATE=".
   612    05  out-format-date          pic x(20).
   613    05  filler                   pic x(10) value"&LFISSPRM=".
   614    05  out-lf-iss-prem          pic zz,z99,999.99.
   615    05  filler                   pic x(10) value"&LFREFPRM=".
   616    05  out-lf-ref-prem          pic zz,z99,999.99.
   617    05  filler                   pic x(10) value"&LFNETPRM=".
   618    05  out-lf-net-prem          pic -zz,zz9,999.99.
   619    05  filler                   pic x(10) value"&AHISSPRM=".
   620    05  out-ah-iss-prem          pic zz,zz9,999.99.
   621    05  filler                   pic x(10) value"&AHREFPRM=".
   622    05  out-ah-ref-prem          pic zz,z99,999.99.
   623    05  filler                   pic x(10) value"&AHNETPRM=".
   624    05  out-ah-net-prem          pic -zz,z99,999.99.
   625    05  filler                   pic x(10) value"&LFISSCOM=".
   626    05  out-lf-iss-comm          pic zz,zz9,999.99.
   627    05  filler                   pic x(10) value"&LFREFCOM=".
   628    05  out-lf-ref-comm          pic zz,zz9,999.99.
   629    05  filler                   pic x(10) value"&LFNETCOM=".
   630    05  out-lf-net-comm          pic -zz,zz9,999.99.
   631    05  filler                   pic x(10) value"&AHISSCOM=".
   632    05  out-ah-iss-comm          pic zz,zzz,999.99.
   633    05  filler                   pic x(10) value"&AHREFCOM=".
   634    05  out-ah-ref-comm          pic zz,z99,999.99.
   635    05  filler                   pic x(10) value"&AHNETCOM=".
   636    05  out-ah-net-comm          pic -zz,z99,999.99.
   637    05  filler                   pic x(9) value "&TOTPREM=".
   638    05  out-tot-prem             pic zz,z99,999.99.
   639    05  filler                   pic x(9) value "&TOTREFS=".
   640    05  out-tot-refs             pic zz,z99,999.99.
   641    05  filler                   pic x(9) value"&TOTNETP=".
   642    05  out-tot-netp             pic -zz,z99,999.99.
   643    05  filler                   pic x(8) value"&ISSCOM=".
   644    05  out-iss-comm             pic zz,zz9,999.99.
   645    05  filler                   pic x(8) value"&REFCOM=".
   646    05  out-ref-comm             pic zz,z99,999.99.
   647    05  filler                   pic x(9) value"&TOTNCOM=".
   648    05  out-net-comm             pic -zz,z99,999.99.
   649    05  filler                   pic x(8) value "&ISSCNT=".
   650    05  out-iss-cnt              pic zzzz,z99.
   651    05  filler                   pic x(8) value "&REFCNT=".
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  13
* BSSRCH.cbl
   652    05  out-ref-cnt              pic zzzz,999.
   653    05  filler                   pic x(8) value "&NETCNT=".
   654    05  out-net-cnt              pic -zzzz,999.
   655    05  filler                   pic x(8) value"&LFCLMS=".
   656    05  out-lf-clms-pd           pic zz,z99,999.99.
   657    05  filler                   pic x(9) value"&LFVOIDS=".
   658    05  out-lf-clms-void         pic zz,zz9,999.99.
   659    05  filler                   pic x(11) value"&TOTLFCLMS=".
   660    05  out-lf-tot-clms          pic -zz,z99,999.99.
   661    05  filler                   pic x(8) value"&AHCLMS=".
   662    05  out-ah-clms-pd           pic zz,z99,999.99.
   663    05  filler                   pic x(9) value"&AHVOIDS=".
   664    05  out-ah-clms-void         pic zz,zz9,999.99.
   665    05  filler                   pic x(11) value"&TOTAHCLMS=".
   666    05  out-ah-tot-clms          pic -zz,z99,999.99.
   667    05  filler                   pic x(8) value"&PDCLMS=".
   668    05  out-clms-pd              pic zz,z99,999.99.
   669    05  filler                   pic x(8) value"&VDCLMS=".
   670    05  out-clms-void            pic zz,z99,999.99.
   671    05  filler                   pic x(9) value"&TOTCLMS=".
   672    05  out-tot-clms             pic -zz,z99,999.99.
   673    05  filler                   pic x(8) value"&LORESV=".
   674    05  out-lo-resv              pic zzz,z99,999.
   675    05  filler                   pic x(8) value"&HIRESV=".
   676    05  out-hi-resv              pic zzz,z99,999.
   677    05  filler                   pic x(8) value"&CRTCNT=".
   678    05  out-crt-cnt              pic z,zz9,999.
   679    05  filler                   pic x(5) value "&MSG=".
   680    05  output-msg               pic x(50).
   681 01 bl-index               pic s9(8) comp.
   682****************************************************************
   683*
   684* Copyright (c) 2007 by Clerity Solutions, Inc.
   685* All rights reserved.
   686*
   687****************************************************************
   688 01  DFHEIV.
   689   02  DFHEIV0               PIC X(35).
   690   02  DFHEIV1               PIC X(08).
   691   02  DFHEIV2               PIC X(08).
   692   02  DFHEIV3               PIC X(08).
   693   02  DFHEIV4               PIC X(06).
   694   02  DFHEIV5               PIC X(04).
   695   02  DFHEIV6               PIC X(04).
   696   02  DFHEIV7               PIC X(02).
   697   02  DFHEIV8               PIC X(02).
   698   02  DFHEIV9               PIC X(01).
   699   02  DFHEIV10              PIC S9(7) COMP-3.
   700   02  DFHEIV11              PIC S9(4) COMP SYNC.
   701   02  DFHEIV12              PIC S9(4) COMP SYNC.
   702   02  DFHEIV13              PIC S9(4) COMP SYNC.
   703   02  DFHEIV14              PIC S9(4) COMP SYNC.
   704   02  DFHEIV15              PIC S9(4) COMP SYNC.
   705   02  DFHEIV16              PIC S9(9) COMP SYNC.
   706   02  DFHEIV17              PIC X(04).
   707   02  DFHEIV18              PIC X(04).
   708   02  DFHEIV19              PIC X(04).
   709   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  14
* BSSRCH.cbl
   710   02  DFHEIV21              USAGE IS POINTER.
   711   02  DFHEIV22              USAGE IS POINTER.
   712   02  DFHEIV23              USAGE IS POINTER.
   713   02  DFHEIV24              USAGE IS POINTER.
   714   02  DFHEIV25              PIC S9(9) COMP SYNC.
   715   02  DFHEIV26              PIC S9(9) COMP SYNC.
   716   02  DFHEIV27              PIC S9(9) COMP SYNC.
   717   02  DFHEIV28              PIC S9(9) COMP SYNC.
   718   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   719   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   720   02  FILLER                PIC X(02).
   721   02  DFHEIV99              PIC X(08) VALUE SPACE.
   722   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   723   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   724   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   725   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   726 LINKAGE  SECTION.
   727*****************************************************************
   728*                                                               *
   729* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   730* All rights reserved.                                          *
   731*                                                               *
   732*****************************************************************
   733 01  dfheiblk.
   734     02  eibtime          pic s9(7) comp-3.
   735     02  eibdate          pic s9(7) comp-3.
   736     02  eibtrnid         pic x(4).
   737     02  eibtaskn         pic s9(7) comp-3.
   738     02  eibtrmid         pic x(4).
   739     02  dfheigdi         pic s9(4) comp.
   740     02  eibcposn         pic s9(4) comp.
   741     02  eibcalen         pic s9(4) comp.
   742     02  eibaid           pic x(1).
   743     02  eibfiller1       pic x(1).
   744     02  eibfn            pic x(2).
   745     02  eibfiller2       pic x(2).
   746     02  eibrcode         pic x(6).
   747     02  eibfiller3       pic x(2).
   748     02  eibds            pic x(8).
   749     02  eibreqid         pic x(8).
   750     02  eibrsrce         pic x(8).
   751     02  eibsync          pic x(1).
   752     02  eibfree          pic x(1).
   753     02  eibrecv          pic x(1).
   754     02  eibsend          pic x(1).
   755     02  eibatt           pic x(1).
   756     02  eibeoc           pic x(1).
   757     02  eibfmh           pic x(1).
   758     02  eibcompl         pic x(1).
   759     02  eibsig           pic x(1).
   760     02  eibconf          pic x(1).
   761     02  eiberr           pic x(1).
   762     02  eibrldbk         pic x(1).
   763     02  eiberrcd         pic x(4).
   764     02  eibsynrb         pic x(1).
   765     02  eibnodat         pic x(1).
   766     02  eibfiller5       pic x(2).
   767     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  15
* BSSRCH.cbl
   768     02  eibresp2         pic 9(09) comp.
   769     02  dfheigdj         pic s9(4) comp.
   770     02  dfheigdk         pic s9(4) comp.
   771 01  DFHCOMMAREA       PIC X(01).
   772 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   773 0000-DFHEXIT SECTION.
   774     MOVE '9#                    $   ' TO DFHEIV0.
   775     MOVE 'BSSRCH' TO DFHEIV1.
   776     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   777 0000-begin.
   778     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
   779
   780* exec cics web
   781*       startbr formfield resp(w-resp)
   782*    end-exec
   783*    MOVE 'X(f                   &  N#00000775' TO DFHEIV0
   784     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   785     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   786     MOVE X'204E233030303030373735' TO DFHEIV0(25:11)
   787     CALL 'kxdfhei1' USING DFHEIV0,
   788           DFHEIV99,
   789           DFHEIV99,
   790           DFHEIV99,
   791           DFHEIV99,
   792           DFHEIV99
   793     MOVE EIBRESP  TO w-resp
   794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   795     perform 0200-read-form      thru 0200-exit until
   796        w-resp not = 0
   797*   dfhresp(normal)
   798
   799* exec cics web
   800*       endbr formfield
   801*    end-exec
   802*    MOVE 'X,f                   #   #00000780' TO DFHEIV0
   803     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   805     MOVE X'2020233030303030373830' TO DFHEIV0(25:11)
   806     CALL 'kxdfhei1' USING DFHEIV0,
   807           DFHEIV99,
   808           DFHEIV99
   809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   810     display ' input date   ' bl-input-eom-date
   811     display ' comp id      ' bl-input-comp-id
   812     display ' mort resv lo ' work-mort-resv-lo
   813     display ' mort resv hi ' work-mort-resv-hi
   814     display ' build file   ' bl-input-bld-file
   815     evaluate bl-input-comp-id
   816        when 'AHL'
   817           open input AHL-ECS010-IN
   818           if ecs010-status not = '00'
   819              move ' Cant open AHL ecs010 file '
   820                                 to bl-output-message
   821              go to 0100-send-document
   822           end-if
   823           READ AHL-ECS010-IN into ecs010-in-rec
   824              display ' ecs010 cert cnt ' ecs010-cert-cnt
   825              move ecs010-cert-cnt
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  16
* BSSRCH.cbl
   826                                 to work-cert-cnt
   827           close ahl-ecs010-in
   828        when 'CID'
   829           open input CID-ECS010-IN
   830           if ecs010-status not = '00'
   831              move ' Cant open AHL ecs010 file '
   832                                 to bl-output-message
   833              go to 0100-send-document
   834           end-if
   835           READ CID-ECS010-IN into ecs010-in-rec
   836              display ' ecs010 cert cnt ' ecs010-cert-cnt
   837              move ecs010-cert-cnt
   838                                 to work-cert-cnt
   839           close cid-ecs010-in
   840        when 'DCC'
   841           open input DCC-ECS010-IN
   842           if ecs010-status not = '00'
   843              move ' Cant open AHL ecs010 file '
   844                                 to bl-output-message
   845              go to 0100-send-document
   846           end-if
   847           READ DCC-ECS010-IN into ecs010-in-rec
   848              display ' ecs010 cert cnt ' ecs010-cert-cnt
   849              move ecs010-cert-cnt
   850                                 to work-cert-cnt
   851           close dcc-ecs010-in
   852     end-evaluate
   853     move zeros                  to numeric-cert-cnt
   854     inspect work-cert-cnt replacing all spaces by zeros
   855     move +9 to s2
   856     perform varying s1 from +11 by -1 until s1 < +1
   857        if work-cert-cnt (s1:1) numeric
   858           move work-cert-cnt (s1:1)
   859                                 to numeric-cert-cnt (s2:1)
   860           subtract +1 from s2
   861        end-if
   862     end-perform
   863     move numeric-cert-cnt       to bl-out-cm-cnt
   864     move zeros                  to numeric-mort-resv
   865*    inspect work-mort-resv replacing all spaces by zeros
   866     move +9 to s2
   867     perform varying s1 from +11 by -1 until s1 < +1
   868        if work-mort-resv-lo (s1:1) numeric
   869           move work-mort-resv-lo (s1:1)
   870                                 to numeric-mort-resv (s2:1)
   871           subtract +1 from s2
   872        end-if
   873     end-perform
   874     move numeric-mort-resv      to bl-input-lo-resv
   875     display ' bl lo reserve ' bl-input-lo-resv
   876     move zeros                  to numeric-mort-resv
   877*    inspect work-mort-resv replacing all spaces by zeros
   878     move +9 to s2
   879     perform varying s1 from +11 by -1 until s1 < +1
   880        if work-mort-resv-hi (s1:1) numeric
   881           move work-mort-resv-hi (s1:1)
   882                                 to numeric-mort-resv (s2:1)
   883           subtract +1 from s2
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  17
* BSSRCH.cbl
   884        end-if
   885     end-perform
   886     move numeric-mort-resv      to bl-input-hi-resv
   887     display ' bl hi reserve ' bl-input-hi-resv
   888
   889* exec cics link
   890*       program  ('BSSRCHBL')
   891*       commarea (srch-commarea)
   892*    end-exec
   893     MOVE LENGTH OF
   894      srch-commarea
   895       TO DFHEIV11
   896     MOVE 'BSSRCHBL' TO DFHEIV1
   897*    MOVE '."C                   (   #00000861' TO DFHEIV0
   898     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   900     MOVE X'2020233030303030383631' TO DFHEIV0(25:11)
   901     CALL 'kxdfhei1' USING DFHEIV0,
   902           DFHEIV1,
   903           srch-commarea,
   904           DFHEIV11,
   905           DFHEIV99,
   906           DFHEIV99,
   907           DFHEIV99,
   908           DFHEIV99
   909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   910     .
   911 0100-send-document.
   912***********************************************************
   913* Build output document.
   914***********************************************************
   915     move bl-input-comp-id       to out-comp-id
   916     move bl-input-eom-date      to out-eom-date
   917     move bl-input-lo-resv       to out-lo-resv
   918     move bl-input-hi-resv       to out-hi-resv
   919     move bl-out-company-name    to out-comp-name
   920     move bl-out-formated-date   to out-format-date
   921     move bl-out-lf-prem (1)     to out-lf-iss-prem
   922     move bl-out-ah-prem (1)     to out-ah-iss-prem
   923     move bl-out-tot-prm (1)     to out-tot-prem
   924     move bl-out-lf-ref  (1)     to out-lf-ref-prem
   925     move bl-out-ah-ref  (1)     to out-ah-ref-prem
   926     move bl-out-tot-ref (1)     to out-tot-refs
   927     move bl-out-lf-net  (1)     to out-lf-net-prem
   928     move bl-out-ah-net  (1)     to out-ah-net-prem
   929     move bl-out-lf-iss-com (1)  to out-lf-iss-comm
   930     move bl-out-ah-iss-com (1)  to out-ah-iss-comm
   931     move bl-out-lf-ref-com (1)  to out-lf-ref-comm
   932     move bl-out-ah-ref-com (1)  to out-ah-ref-comm
   933     move bl-out-lf-net-com (1)  to out-lf-net-comm
   934     move bl-out-ah-net-com (1)  to out-ah-net-comm
   935     move bl-out-iss-com    (1)  to out-iss-comm
   936     move bl-out-ref-com    (1)  to out-ref-comm
   937     move bl-out-net-com    (1)  to out-net-comm
   938     move bl-out-iss-cnt    (1)  to out-iss-cnt
   939     move bl-out-can-cnt    (1)  to out-ref-cnt
   940     move bl-out-net-cnt    (1)  to out-net-cnt
   941     move bl-out-net-tot    (1)  to out-tot-netp
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  18
* BSSRCH.cbl
   942     move bl-out-cm-cnt          to out-crt-cnt
   943     move bl-out-lf-clms-pd      to out-lf-clms-pd
   944     move bl-out-lf-clms-void    to out-lf-clms-void
   945     move bl-out-lf-tot-clms     to out-lf-tot-clms
   946     move bl-out-ah-clms-pd      to out-ah-clms-pd
   947     move bl-out-ah-clms-void    to out-ah-clms-void
   948     move bl-out-ah-tot-clms     to out-ah-tot-clms
   949     move bl-out-clms-pd         to out-clms-pd
   950     move bl-out-clms-void       to out-clms-void
   951     move bl-out-tot-clms        to out-tot-clms
   952     move bl-output-message      to output-msg
   953     if bl-input-bld-file = 'YES'
   954        move 'Balance File Created'
   955                                 to output-msg
   956     end-if
   957
   958* exec cics document create
   959*       doctoken   (w-doctoken)
   960*       template   ('BSDETAIL')
   961*       symbollist (output-data)
   962*       listlength (length of output-data)
   963*    end-exec
   964     MOVE 'BSDETAIL'
   965      TO DFHEIVL0
   966     MOVE LENGTH OF
   967      output-data TO DFHEIV16
   968*    MOVE '\"D tSL               )   #00000912' TO DFHEIV0
   969     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
   970     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   971     MOVE X'2020233030303030393132' TO DFHEIV0(25:11)
   972     CALL 'kxdfhei1' USING DFHEIV0,
   973           w-doctoken,
   974           DFHEIV99,
   975           DFHEIVL0,
   976           output-data,
   977           DFHEIV16,
   978           DFHEIV99,
   979           DFHEIV99,
   980           DFHEIV99
   981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   982     move 1                      to bl-index
   983*    exec cics document insert
   984*       doctoken (w-doctoken)
   985*       template ('BSFTR')
   986*    end-exec
   987    if bl-fail
   988
   989* exec cics syncpoint rollback
   990*      end-exec
   991*    MOVE '6"R                   !   #00000924' TO DFHEIV0
   992     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
   993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   994     MOVE X'2020233030303030393234' TO DFHEIV0(25:11)
   995     CALL 'kxdfhei1' USING DFHEIV0
   996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   997    end-if
   998****************************************
   999* Send the document and return.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  19
* BSSRCH.cbl
  1000****************************************
  1001
  1002* exec cics web send
  1003*       doctoken(w-doctoken)
  1004*    end-exec
  1005*    MOVE 'X$D                   *   #00000930' TO DFHEIV0
  1006     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1007     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1008     MOVE X'2020233030303030393330' TO DFHEIV0(25:11)
  1009     CALL 'kxdfhei1' USING DFHEIV0,
  1010           w-doctoken,
  1011           DFHEIV99,
  1012           DFHEIV99,
  1013           DFHEIV99,
  1014           DFHEIV99,
  1015           DFHEIV99,
  1016           DFHEIV99,
  1017           DFHEIV99,
  1018           DFHEIV99
  1019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1020     if bl-input-bld-file = 'YES'
  1021        evaluate bl-input-comp-id
  1022           when 'AHL'
  1023              move ahl-table     to cid-table
  1024              perform 0300-build-cid
  1025                                 thru 0300-exit
  1026              perform 0400-write-ahl
  1027                                 thru 0400-exit
  1028           when 'CID'
  1029              perform 0300-build-cid
  1030                                 thru 0300-exit
  1031              perform 0500-write-cid
  1032                                 thru 0500-exit
  1033           when 'DCC'
  1034              move dcc-table     to cid-table
  1035              perform 0300-build-cid
  1036                                 thru 0300-exit
  1037              perform 0600-write-dcc
  1038                                 thru 0600-exit
  1039        end-evaluate
  1040     end-if
  1041
  1042* exec cics return
  1043*    end-exec
  1044*    MOVE '.(                    ''   #00000954' TO DFHEIV0
  1045     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1047     MOVE X'2020233030303030393534' TO DFHEIV0(25:11)
  1048     CALL 'kxdfhei1' USING DFHEIV0,
  1049           DFHEIV99,
  1050           DFHEIV99,
  1051           DFHEIV99,
  1052           DFHEIV99,
  1053           DFHEIV99,
  1054           DFHEIV99
  1055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1056     .
  1057 0200-read-form.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  20
* BSSRCH.cbl
  1058     move spaces                 to w-form-name
  1059     move length of w-form-name  to w-form-name-len
  1060     move spaces                 to w-form-value
  1061     move length of w-form-value to w-form-value-len
  1062
  1063* exec cics web readnext
  1064*       formfield   (w-form-name)
  1065*       namelength  (w-form-name-len)
  1066*       value       (w-form-value)
  1067*       valuelength (w-form-value-len)
  1068*       resp        (w-resp)
  1069*    end-exec
  1070*    MOVE 'X*FLVL                &  N#00000962' TO DFHEIV0
  1071     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1072     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1073     MOVE X'204E233030303030393632' TO DFHEIV0(25:11)
  1074     CALL 'kxdfhei1' USING DFHEIV0,
  1075           w-form-name,
  1076           w-form-name-len,
  1077           w-form-value,
  1078           w-form-value-len,
  1079           DFHEIV99
  1080     MOVE EIBRESP  TO w-resp
  1081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1082     evaluate w-resp
  1083        when 0
  1084*   dfhresp(normal)
  1085           evaluate w-form-name(1:w-form-name-len)
  1086              when 'eom_dte'
  1087                 if w-form-value-len not = 0
  1088                    move w-form-value(1:w-form-value-len)
  1089                                 to bl-input-eom-date
  1090                 else
  1091                    move spaces  to bl-input-eom-date
  1092                end-if
  1093              when 'comp_id'
  1094                 if w-form-value-len not = 0
  1095                    move w-form-value(1:w-form-value-len)
  1096                                 to bl-input-comp-id
  1097                 else
  1098                    move spaces  to bl-input-comp-id
  1099                end-if
  1100              when 'lo_resv'
  1101                 if w-form-value-len not = 0
  1102                    move w-form-value(1:w-form-value-len)
  1103                                 to work-mort-resv-lo
  1104                 else
  1105                    move zeros   to work-mort-resv-lo
  1106                end-if
  1107              when 'hi_resv'
  1108                 if w-form-value-len not = 0
  1109                    move w-form-value(1:w-form-value-len)
  1110                                 to work-mort-resv-hi
  1111                 else
  1112                    move zeros   to work-mort-resv-hi
  1113                end-if
  1114              when 'bld_file'
  1115                 if w-form-value-len not = 0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  21
* BSSRCH.cbl
  1116                    move w-form-value(1:w-form-value-len)
  1117                                 to bl-input-bld-file
  1118                 else
  1119                    move spaces  to bl-input-bld-file
  1120                end-if
  1121           end-evaluate
  1122        when other
  1123           continue
  1124     end-evaluate
  1125     .
  1126 0200-exit.
  1127     exit.
  1128 0300-build-cid.
  1129     move +.98                   to ws-low-pct
  1130     move +1.02                  to ws-high-pct
  1131     perform varying s1 from +1 by +1 until s1 > +17
  1132        move -999999999          to tbl-low-amount (s1)
  1133        move +999999999          to tbl-hi-amount  (s1)
  1134     end-perform
  1135     move bl-out-tot-clms        to ws-pass-amount
  1136     perform 0310-calc-tol       thru 0310-exit
  1137     move ws-low-amount          to tbl-low-amount (1)
  1138     move ws-hi-amount           to tbl-hi-amount (1)
  1139*** processable gross premium
  1140     move bl-out-tot-prm (1)     to ws-pass-amount
  1141     perform 0310-calc-tol       thru 0310-exit
  1142     move ws-low-amount          to tbl-low-amount (2)
  1143     move ws-hi-amount           to tbl-hi-amount (2)
  1144*** non-processable gross premium
  1145     move +.90                   to ws-low-pct
  1146     move +1.10                  to ws-high-pct
  1147     move bl-out-tot-prm (2)     to ws-pass-amount
  1148     perform 0310-calc-tol       thru 0310-exit
  1149     move ws-low-amount          to tbl-low-amount (3)
  1150     move ws-hi-amount           to tbl-hi-amount (3)
  1151*** total gross premium
  1152     move +.98                   to ws-low-pct
  1153     move +1.02                  to ws-high-pct
  1154     compute tbl-low-amount (4) =
  1155        tbl-low-amount (2) + tbl-low-amount (3)
  1156     compute tbl-hi-amount (4) =
  1157        tbl-hi-amount (2) + tbl-hi-amount (3)
  1158*** processable refunded premium
  1159     move bl-out-tot-ref (1)     to ws-pass-amount
  1160     perform 0310-calc-tol       thru 0310-exit
  1161     move ws-low-amount          to tbl-low-amount (5)
  1162     move ws-hi-amount           to tbl-hi-amount (5)
  1163*** non-processable refunded premium
  1164     move +.90                   to ws-low-pct
  1165     move +1.10                  to ws-high-pct
  1166     move bl-out-tot-ref (2)     to ws-pass-amount
  1167     perform 0310-calc-tol       thru 0310-exit
  1168     move ws-low-amount          to tbl-low-amount (6)
  1169     move ws-hi-amount           to tbl-hi-amount (6)
  1170*** total refunded premium
  1171     move +.98                   to ws-low-pct
  1172     move +1.02                  to ws-high-pct
  1173     compute tbl-low-amount (7) =
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  22
* BSSRCH.cbl
  1174        tbl-low-amount (5) + tbl-low-amount (6)
  1175     compute tbl-hi-amount (7) =
  1176        tbl-hi-amount (5) + tbl-hi-amount (6)
  1177*** processable net premium
  1178     move bl-out-net-tot (1)     to ws-pass-amount
  1179     perform 0310-calc-tol       thru 0310-exit
  1180     move ws-low-amount          to tbl-low-amount (8)
  1181     move ws-hi-amount           to tbl-hi-amount (8)
  1182*** non-processable net premium
  1183     move +.90                   to ws-low-pct
  1184     move +1.10                  to ws-high-pct
  1185     move bl-out-net-tot (2)     to ws-pass-amount
  1186     perform 0310-calc-tol       thru 0310-exit
  1187     move ws-low-amount          to tbl-low-amount (9)
  1188     move ws-hi-amount           to tbl-hi-amount (9)
  1189*** total net premium
  1190     move +.98                   to ws-low-pct
  1191     move +1.02                  to ws-high-pct
  1192     compute tbl-low-amount (10) =
  1193        tbl-low-amount (8) + tbl-low-amount (9)
  1194     compute tbl-hi-amount (10) =
  1195        tbl-hi-amount (8) + tbl-hi-amount (9)
  1196*** processable commission
  1197     move bl-out-net-com (1)     to ws-pass-amount
  1198     perform 0310-calc-tol       thru 0310-exit
  1199     move ws-low-amount          to tbl-low-amount (11)
  1200     move ws-hi-amount           to tbl-hi-amount (11)
  1201*** non-processable commission
  1202     move +.90                   to ws-low-pct
  1203     move +1.10                  to ws-high-pct
  1204     move bl-out-net-com (2)     to ws-pass-amount
  1205     perform 0310-calc-tol       thru 0310-exit
  1206     move ws-low-amount          to tbl-low-amount (12)
  1207     move ws-hi-amount           to tbl-hi-amount (12)
  1208*** total commission
  1209     move +.98                   to ws-low-pct
  1210     move +1.02                  to ws-high-pct
  1211     compute tbl-low-amount (13) =
  1212        tbl-low-amount (11) + tbl-low-amount (12)
  1213     compute tbl-hi-amount (13) =
  1214        tbl-hi-amount (11) + tbl-hi-amount (12)
  1215     move bl-out-lf-tot-clms     to ws-pass-amount
  1216     perform 0310-calc-tol       thru 0310-exit
  1217     move ws-low-amount          to tbl-low-amount (14)
  1218     move ws-hi-amount           to tbl-hi-amount (14)
  1219     move bl-out-ah-tot-clms     to ws-pass-amount
  1220     perform 0310-calc-tol       thru 0310-exit
  1221     move ws-low-amount          to tbl-low-amount (15)
  1222     move ws-hi-amount           to tbl-hi-amount (15)
  1223     move bl-out-cm-cnt          to tbl-low-amount (16)
  1224                                    tbl-hi-amount  (16)
  1225     move bl-input-lo-resv       to tbl-low-amount (17)
  1226     move bl-input-hi-resv       to tbl-hi-amount (17)
  1227     .
  1228 0300-exit.
  1229     exit.
  1230 0310-calc-tol.
  1231     if ws-pass-amount > zeros
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  23
* BSSRCH.cbl
  1232        compute ws-low-amount = ws-pass-amount * ws-low-pct
  1233        compute ws-hi-amount  = ws-pass-amount * ws-high-pct
  1234     else
  1235        compute ws-low-amount = ws-pass-amount * ws-high-pct
  1236        compute ws-hi-amount  = ws-pass-amount * ws-low-pct
  1237     end-if
  1238     .
  1239 0310-exit.
  1240     exit.
  1241 0400-write-ahl.
  1242     open output ahl-chkpoint-out
  1243     if chkpnt-status not = '00'
  1244        move ' Cant open AHL CHKPNT file '
  1245           to bl-output-message
  1246        go to 0100-send-document
  1247     end-if
  1248     move bl-input-eom-date      to cpo-jobname
  1249     move 'AHL'                  to cpo-stepname
  1250     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1251        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1252        delimited by size into cpo-desc
  1253     end-string
  1254     write ahl-chkpoint-out-rec  from cpo-out-record
  1255     move spaces                 to cpo-jobname
  1256                                    cpo-stepname
  1257     move 'Proc Cnt'             to cpo-desc
  1258     move bl-out-iss-cnt (1)     to cpo-low-amount
  1259     move bl-out-can-cnt (1)     to cpo-hi-amount
  1260     write ahl-chkpoint-out-rec  from cpo-out-record
  1261     move 'NonProcCnt'           to cpo-desc
  1262     move bl-out-iss-cnt (2)     to cpo-low-amount
  1263     move bl-out-can-cnt (2)     to cpo-hi-amount
  1264     write ahl-chkpoint-out-rec  from cpo-out-record
  1265     move 'Total Cnt'            to cpo-desc
  1266     move bl-out-iss-cnt (3)     to cpo-low-amount
  1267     move bl-out-can-cnt (3)     to cpo-hi-amount
  1268     write ahl-chkpoint-out-rec  from cpo-out-record
  1269     move bl-out-lf-clms-cur     to ws-pass-amount
  1270     perform 0310-calc-tol       thru 0310-exit
  1271     move 'LF Claims Paid Curr'  to cpo-desc
  1272     move ws-low-amount          to cpo-low-amount
  1273     move ws-hi-amount           to cpo-hi-amount
  1274     write ahl-chkpoint-out-rec  from cpo-out-record
  1275     move bl-out-ah-clms-cur     to ws-pass-amount
  1276     perform 0310-calc-tol       thru 0310-exit
  1277     move 'AH Claims Paid Curr'  to cpo-desc
  1278     move ws-low-amount          to cpo-low-amount
  1279     move ws-hi-amount           to cpo-hi-amount
  1280     write ahl-chkpoint-out-rec  from cpo-out-record
  1281     move bl-out-tot-clms-cur    to ws-pass-amount
  1282     perform 0310-calc-tol       thru 0310-exit
  1283     move 'TOT Claims Paid Curr' to cpo-desc
  1284     move ws-low-amount          to cpo-low-amount
  1285     move ws-hi-amount           to cpo-hi-amount
  1286     write ahl-chkpoint-out-rec  from cpo-out-record
  1287     perform varying s1 from 1 by 1 until s1 > 17
  1288        move tbl-jobname    (s1) to cpo-jobname
  1289        move tbl-stepname   (s1) to cpo-stepname
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  24
* BSSRCH.cbl
  1290        move tbl-desc       (s1) to cpo-desc
  1291        move tbl-low-amount (s1) to cpo-low-amount
  1292        move tbl-hi-amount  (s1) to cpo-hi-amount
  1293        write ahl-chkpoint-out-rec from cpo-out-record
  1294     end-perform
  1295     close ahl-chkpoint-out
  1296     perform 0700-submit-job     thru 0700-exit
  1297     .
  1298 0400-exit.
  1299     exit.
  1300 0500-write-cid.
  1301     open output cid-chkpoint-out
  1302     if chkpnt-status not = '00'
  1303        move ' Cant open CID CHKPNT file '
  1304           to bl-output-message
  1305        go to 0100-send-document
  1306     end-if
  1307     move bl-input-eom-date      to cpo-jobname
  1308     move 'CID'                  to cpo-stepname
  1309     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1310        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1311        delimited by size into cpo-desc
  1312     end-string
  1313     write cid-chkpoint-out-rec  from cpo-out-record
  1314     move spaces                 to cpo-jobname
  1315                                    cpo-stepname
  1316     move 'Proc Cnt'             to cpo-desc
  1317     move bl-out-iss-cnt (1)     to cpo-low-amount
  1318     move bl-out-can-cnt (1)     to cpo-hi-amount
  1319     write cid-chkpoint-out-rec  from cpo-out-record
  1320     move 'NonProcCnt'           to cpo-desc
  1321     move bl-out-iss-cnt (2)     to cpo-low-amount
  1322     move bl-out-can-cnt (2)     to cpo-hi-amount
  1323     write cid-chkpoint-out-rec  from cpo-out-record
  1324     move 'Total Cnt'            to cpo-desc
  1325     move bl-out-iss-cnt (3)     to cpo-low-amount
  1326     move bl-out-can-cnt (3)     to cpo-hi-amount
  1327     write cid-chkpoint-out-rec  from cpo-out-record
  1328     move bl-out-lf-clms-cur     to ws-pass-amount
  1329     perform 0310-calc-tol       thru 0310-exit
  1330     move 'LF Claims Paid Curr'  to cpo-desc
  1331     move ws-low-amount          to cpo-low-amount
  1332     move ws-hi-amount           to cpo-hi-amount
  1333     write cid-chkpoint-out-rec  from cpo-out-record
  1334     move bl-out-ah-clms-cur     to ws-pass-amount
  1335     perform 0310-calc-tol       thru 0310-exit
  1336     move 'AH Claims Paid Curr'  to cpo-desc
  1337     move ws-low-amount          to cpo-low-amount
  1338     move ws-hi-amount           to cpo-hi-amount
  1339     write cid-chkpoint-out-rec  from cpo-out-record
  1340     move bl-out-tot-clms-cur    to ws-pass-amount
  1341     perform 0310-calc-tol       thru 0310-exit
  1342     move 'TOT Claims Paid Curr' to cpo-desc
  1343     move ws-low-amount          to cpo-low-amount
  1344     move ws-hi-amount           to cpo-hi-amount
  1345     write cid-chkpoint-out-rec  from cpo-out-record
  1346     perform varying s1 from 1 by 1 until s1 > 17
  1347        move tbl-jobname    (s1) to cpo-jobname
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  25
* BSSRCH.cbl
  1348        move tbl-stepname   (s1) to cpo-stepname
  1349        move tbl-desc       (s1) to cpo-desc
  1350        move tbl-low-amount (s1) to cpo-low-amount
  1351        move tbl-hi-amount  (s1) to cpo-hi-amount
  1352        write cid-chkpoint-out-rec
  1353                                 from cpo-out-record
  1354     end-perform
  1355     close cid-chkpoint-out
  1356     perform 0700-submit-job     thru 0700-exit
  1357     .
  1358 0500-exit.
  1359     exit.
  1360 0600-write-dcc.
  1361     open output dcc-chkpoint-out
  1362     if chkpnt-status not = '00'
  1363        move ' Cant open DCC CHKPNT file '
  1364           to bl-output-message
  1365        go to 0100-send-document
  1366     end-if
  1367     move bl-input-eom-date      to cpo-jobname
  1368     move 'DCC'                  to cpo-stepname
  1369     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1370        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1371        delimited by size into cpo-desc
  1372     end-string
  1373     write dcc-chkpoint-out-rec  from cpo-out-record
  1374     move spaces                 to cpo-jobname
  1375                                    cpo-stepname
  1376     move 'Proc Cnt'             to cpo-desc
  1377     move bl-out-iss-cnt (1)     to cpo-low-amount
  1378     move bl-out-can-cnt (1)     to cpo-hi-amount
  1379     write dcc-chkpoint-out-rec  from cpo-out-record
  1380     move 'NonProcCnt'           to cpo-desc
  1381     move bl-out-iss-cnt (2)     to cpo-low-amount
  1382     move bl-out-can-cnt (2)     to cpo-hi-amount
  1383     write dcc-chkpoint-out-rec  from cpo-out-record
  1384     move 'Total Cnt'            to cpo-desc
  1385     move bl-out-iss-cnt (3)     to cpo-low-amount
  1386     move bl-out-can-cnt (3)     to cpo-hi-amount
  1387     write dcc-chkpoint-out-rec  from cpo-out-record
  1388     move bl-out-lf-clms-cur     to ws-pass-amount
  1389     perform 0310-calc-tol       thru 0310-exit
  1390     move 'LF Claims Paid Curr'  to cpo-desc
  1391     move ws-low-amount          to cpo-low-amount
  1392     move ws-hi-amount           to cpo-hi-amount
  1393     write dcc-chkpoint-out-rec  from cpo-out-record
  1394     move bl-out-ah-clms-cur     to ws-pass-amount
  1395     perform 0310-calc-tol       thru 0310-exit
  1396     move 'AH Claims Paid Curr'  to cpo-desc
  1397     move ws-low-amount          to cpo-low-amount
  1398     move ws-hi-amount           to cpo-hi-amount
  1399     write dcc-chkpoint-out-rec  from cpo-out-record
  1400     move bl-out-tot-clms-cur    to ws-pass-amount
  1401     perform 0310-calc-tol       thru 0310-exit
  1402     move 'TOT Claims Paid Curr' to cpo-desc
  1403     move ws-low-amount          to cpo-low-amount
  1404     move ws-hi-amount           to cpo-hi-amount
  1405     write dcc-chkpoint-out-rec  from cpo-out-record
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  26
* BSSRCH.cbl
  1406     perform varying s1 from 1 by 1 until s1 > 16
  1407        move tbl-jobname    (s1) to cpo-jobname
  1408        move tbl-stepname   (s1) to cpo-stepname
  1409        move tbl-desc       (s1) to cpo-desc
  1410        move tbl-low-amount (s1) to cpo-low-amount
  1411        move tbl-hi-amount  (s1) to cpo-hi-amount
  1412        write dcc-chkpoint-out-rec from cpo-out-record
  1413     end-perform
  1414     close dcc-chkpoint-out
  1415     perform 0700-submit-job     thru 0700-exit
  1416     .
  1417 0600-exit.
  1418     exit.
  1419 0700-submit-job.
  1420     move function lower-case(bl-input-comp-id)
  1421                                 to tran-comp-id
  1422
  1423* EXEC CICS WRITEQ TD
  1424*       QUEUE ('BTCH')
  1425*       FROM (TRAN-DATA-LINE1)
  1426*       LENGTH (80)
  1427*    END-EXEC
  1428     MOVE 80
  1429       TO DFHEIV11
  1430     MOVE 'BTCH' TO DFHEIV5
  1431*    MOVE '(" L                  &   #00001308' TO DFHEIV0
  1432     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1434     MOVE X'2020233030303031333038' TO DFHEIV0(25:11)
  1435     CALL 'kxdfhei1' USING DFHEIV0,
  1436           DFHEIV5,
  1437           TRAN-DATA-LINE1,
  1438           DFHEIV11,
  1439           DFHEIV99,
  1440           DFHEIV99
  1441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1442
  1443* EXEC CICS WRITEQ TD
  1444*       QUEUE ('BTCH')
  1445*       FROM (TRAN-DATA-LINE2)
  1446*       LENGTH (80)
  1447*    END-EXEC
  1448     MOVE 80
  1449       TO DFHEIV11
  1450     MOVE 'BTCH' TO DFHEIV5
  1451*    MOVE '(" L                  &   #00001313' TO DFHEIV0
  1452     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1454     MOVE X'2020233030303031333133' TO DFHEIV0(25:11)
  1455     CALL 'kxdfhei1' USING DFHEIV0,
  1456           DFHEIV5,
  1457           TRAN-DATA-LINE2,
  1458           DFHEIV11,
  1459           DFHEIV99,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1462     .
  1463 0700-exit.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 11:22 Page  27
* BSSRCH.cbl
  1464     exit.
  1465
  1466 9999-DFHBACK SECTION.
  1467     MOVE '9%                    "   ' TO DFHEIV0
  1468     MOVE 'BSSRCH' TO DFHEIV1
  1469     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1470     GOBACK.
  1471 9999-DFHEXIT.
  1472     IF DFHEIGDJ EQUAL 0001
  1473         NEXT SENTENCE.
  1474     MOVE '9%                    "   ' TO DFHEIV0
  1475     MOVE 'BSSRCH' TO DFHEIV1
  1476     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1477     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10184     Code:        7668
