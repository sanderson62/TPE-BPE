* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   1
* SOCK03.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"SOCK03.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   2
* SOCK03.cbl
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35 environment division.
    36 data division.
    37 working-storage section.
    38 01  DFH-START PIC X(04).
    39*
    40* program buffers
    41*
    42 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    43     88  ALREADY-SENT              VALUE 'Y'.
    44 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    45 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    46     88  ELCERT-FINISHED            VALUE 'Y'.
    47 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    48 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    49     88  ERACCT-FOUND               VALUE 'Y'.
    50 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    51 77 ws-send-msg-size           pic s9(8) comp value 4096.
    52 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    53 77 ws-recv-buf                pic x(4096).
    54 77 ws-send-buf                pic x(4096) VALUE SPACES.
    55 77 ws-recv-total              pic s9(8) comp value 0.
    56 77 ws-recv-left               pic s9(8) comp value 0.
    57 77 ws-seq-num                 pic s9(8) comp value 0.
    58 77 ws-flags                   pic s9(8) comp value 0.
    59 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    60 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    61 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    62 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    63 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    64 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    65 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    66 77 S1                           PIC S999 COMP-3 VALUE +0.
    67 77 S2                           PIC S999 COMP-3 VALUE +0.
    68 77 L1                           PIC S999 COMP-3 VALUE +0.
    69 77 L2                           PIC S999 COMP-3 VALUE +0.
    70 77 F1                           PIC S999 COMP-3 VALUE +0.
    71 77 WS-BUILD-SW                  PIC X.
    72    88  TIME-TO-BUILD               VALUE 'Y'.
    73 77 WS-SAVE-ERACCT               PIC X(2000).
    74 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   3
* SOCK03.cbl
    75 77 WS-STOP-SW                   PIC X  VALUE ' '.
    76    88  TOLD-TO-STOP               VALUE 'Y'.
    77 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    78    88  GET-RATES                    VALUE 'R'.
    79    88  GET-ACT-ACCTS                VALUE 'A'.
    80 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    81 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    82 77 ws-disp-rate                 pic z9.99999.
    83 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    84     88  END-OF-ERCTBL                 VALUE 'Y'.
    85 77  WS-STATUS                   PIC X.
    86 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
    87 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
    88 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
    89 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
    90 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
    91 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
    92 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
    93 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
    94 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
    95 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
    96 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
    97 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
    98     88  WS-ELCERT-FULL             VALUE '1'.
    99     88  WS-ELCERT-NAME             VALUE '2'.
   100     88  WS-ELCERT-CERT-NO          VALUE '3'.
   101     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   102 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   103 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   104     88  I-SAY-TO-STOP      VALUE 'Y'.
   105 77  WS-HEX-0A                   PIC X.
   106 77  WS-CALL-TYPE                PIC X(6).
   107 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   108 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   109 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   110 01  WS-STRING-DATA.
   111     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   112     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   113     05  WS-CARRIER              PIC X        VALUE SPACES.
   114     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   115     05  WS-STATE                PIC XX       VALUE SPACES.
   116     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   117     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   118     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   119     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   120     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   121     05  WS-MID-INIT             PIC X        VALUE SPACES.
   122     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   123     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   124     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   125     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   126     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   127     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   128     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   129     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   130     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   131     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   132     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   4
* SOCK03.cbl
   133     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   134     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   135     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   136     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   137     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   138     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   139     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   140     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   141     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   142     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   143     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   144     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   145     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   146     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   147     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   148     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   149     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   150     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   151     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   152     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   153     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   154     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   155     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   156     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   157     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   158     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   159 01  ws-work-date.
   160     05  ws-work-ccyy            pic x(4).
   161     05  ws-work-mm              pic xx.
   162     05  ws-work-dd              pic xx.
   163 01  ws-work-date-num redefines ws-work-date
   164                                 pic 9(8).
   165 01  FILLER.
   166     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   167     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   168     12  WS-STATE-ABBREVIATION   PIC XX.
   169     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   170     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   171     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   172     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   173     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   174     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   175     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   176     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   177     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   178     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   179     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   180     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   181     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   182     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   183     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   184     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   185     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   186     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   187     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   188     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   189     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   190     12  WS-LF-OVERRIDE-L1       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   5
* SOCK03.cbl
   191     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   192     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   193     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   194     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   195         88  WS-REDUCING                         VALUE 'R'.
   196         88  WS-LEVEL                            VALUE 'L'  'P'.
   197 01  ELMSTR-KEY.
   198     12  ELMSTR-COMP-CD          PIC X.
   199     12  ELMSTR-CERT-NO          PIC X(11).
   200 01  WS-AM3-KEY.
   201     12  WS-AM3-ACCOUNT          PIC X(10).
   202     12  WS-AM3-EXP-DT           PIC XX.
   203 01  WS-AM-KEY.
   204     12  WS-AM-COMPANY-CD        PIC X.
   205     12  WS-AM-CARRIER           PIC X.
   206     12  WS-AM-GROUPING          PIC X(6).
   207     12  WS-AM-STATE             PIC XX.
   208     12  WS-AM-ACCOUNT           PIC X(10).
   209     12  WS-AM-EXPIRATION-DT     PIC XX.
   210     12  WS-AM-FILLER            PIC XXXX.
   211 01  WS-CO-DATA.
   212     05  WS-CO-NUM               PIC X(10).
   213     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   214     05  WS-CO-NAME              PIC X(30).
   215     05  WS-CO-MAIL-NAME         PIC X(30).
   216     05  WS-CO-ADDR1             PIC X(30).
   217     05  WS-CO-ADDR2             PIC X(30).
   218     05  WS-CO-ADDR3             PIC X(30).
   219     05  WS-CO-ZIP               PIC X(9).
   220     05  WS-CO-PHONE             PIC X(10).
   221 01  WS-CF-KEY.
   222     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   223     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   224*        88  COMPANY-MASTER                      VALUE '1'.
   225*        88  STATE-MASTER                        VALUE '3'.
   226*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   227*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   228     12  WS-CF-ACCESS.
   229         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   230         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   231             20  FILLER          PIC  X(01).
   232             20  WS-CF-CARRIER   PIC  X(01).
   233     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   234 01  WS-CM-KEY.
   235     05  WS-CM-COMPANY-CD        PIC X.
   236     05  WS-CM-CARRIER           PIC X.
   237     05  WS-CM-GROUP             PIC X(6).
   238     05  WS-CM-STATE             PIC XX.
   239     05  WS-CM-ACCOUNT           PIC X(10).
   240     05  WS-CM-EFF-DT            PIC XX.
   241     05  WS-CM-CERT-NO           PIC X(11).
   242 01  WS-CM-KEY-A1.
   243     05  WS-CM-COMPANY-CD-A1     PIC X.
   244     05  WS-CM-LAST-NAME         PIC X(15).
   245     05  WS-CM-INITIALS          PIC XX.
   246 01  WS-CM-KEY-A4.
   247     05  WS-CM-COMPANY-CD-A4     PIC X.
   248     05  WS-CM-CERT-NO-A4        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   6
* SOCK03.cbl
   249 01  WS-CID-NO                   PIC X(8).
   250 01  WS-DISP-RESP                PIC 9(5).
   251 01  WS-RESPONSE                 PIC S9(8)   COMP.
   252     88  RESP-NORMAL                  VALUE +00.
   253     88  RESP-NOTFND                  VALUE +13.
   254     88  RESP-DUPKEY                  VALUE +15.
   255     88  RESP-NOTOPEN                 VALUE +19.
   256     88  RESP-ENDFILE                 VALUE +20.
   257*                                 COPY ELCCERT.
   258******************************************************************
   259*                                                                *
   260*                            ELCCERT.                            *
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   262*                            VMOD=2.013                          *
   263*                                                                *
   264*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   265*                                                                *
   266*   FILE TYPE = VSAM,KSDS                                        *
   267*   RECORD SIZE = 450  RECFORM = FIXED                           *
   268*                                                                *
   269*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   270*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   271*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   272*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   273*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   274*                                                                *
   275*   LOG = YES                                                    *
   276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   277******************************************************************
   278*                   C H A N G E   L O G
   279*
   280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   281*-----------------------------------------------------------------
   282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   283* EFFECTIVE    NUMBER
   284*-----------------------------------------------------------------
   285* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   286* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   287* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   288* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   289* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   290* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   291* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   292******************************************************************
   293
   294 01  CERTIFICATE-MASTER.
   295     12  CM-RECORD-ID                      PIC XX.
   296         88  VALID-CM-ID                      VALUE 'CM'.
   297
   298     12  CM-CONTROL-PRIMARY.
   299         16  CM-COMPANY-CD                 PIC X.
   300         16  CM-CARRIER                    PIC X.
   301         16  CM-GROUPING.
   302             20  CM-GROUPING-PREFIX        PIC X(3).
   303             20  CM-GROUPING-PRIME         PIC X(3).
   304         16  CM-STATE                      PIC XX.
   305         16  CM-ACCOUNT.
   306             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   7
* SOCK03.cbl
   307             20  CM-ACCOUNT-PRIME          PIC X(6).
   308         16  CM-CERT-EFF-DT                PIC XX.
   309         16  CM-CERT-NO.
   310             20  CM-CERT-PRIME             PIC X(10).
   311             20  CM-CERT-SFX               PIC X.
   312
   313     12  CM-CONTROL-BY-NAME.
   314         16  CM-COMPANY-CD-A1              PIC X.
   315         16  CM-INSURED-LAST-NAME          PIC X(15).
   316         16  CM-INSURED-INITIALS.
   317             20  CM-INSURED-INITIAL1       PIC X.
   318             20  CM-INSURED-INITIAL2       PIC X.
   319
   320     12  CM-CONTROL-BY-SSN.
   321         16  CM-COMPANY-CD-A2              PIC X.
   322         16  CM-SOC-SEC-NO.
   323             20  CM-SSN-STATE              PIC XX.
   324             20  CM-SSN-ACCOUNT            PIC X(6).
   325             20  CM-SSN-LN3.
   326                 25  CM-INSURED-INITIALS-A2.
   327                     30 CM-INSURED-INITIAL1-A2   PIC X.
   328                     30 CM-INSURED-INITIAL2-A2   PIC X.
   329                 25 CM-PART-LAST-NAME-A2         PIC X.
   330
   331     12  CM-CONTROL-BY-CERT-NO.
   332         16  CM-COMPANY-CD-A4              PIC X.
   333         16  CM-CERT-NO-A4                 PIC X(11).
   334
   335     12  CM-CONTROL-BY-MEMB.
   336         16  CM-COMPANY-CD-A5              PIC X.
   337         16  CM-MEMBER-NO.
   338             20  CM-MEMB-STATE             PIC XX.
   339             20  CM-MEMB-ACCOUNT           PIC X(6).
   340             20  CM-MEMB-LN4.
   341                 25  CM-INSURED-INITIALS-A5.
   342                     30 CM-INSURED-INITIAL1-A5   PIC X.
   343                     30 CM-INSURED-INITIAL2-A5   PIC X.
   344                 25 CM-PART-LAST-NAME-A5         PIC XX.
   345
   346     12  CM-INSURED-PROFILE-DATA.
   347         16  CM-INSURED-FIRST-NAME.
   348             20  CM-INSURED-1ST-INIT       PIC X.
   349             20  FILLER                    PIC X(9).
   350         16  CM-INSURED-ISSUE-AGE          PIC 99.
   351         16  CM-INSURED-SEX                PIC X.
   352             88  CM-SEX-MALE                  VALUE 'M'.
   353             88  CM-SEX-FEMAL                 VALUE 'F'.
   354         16  CM-INSURED-JOINT-AGE          PIC 99.
   355         16  CM-JOINT-INSURED-NAME.
   356             20  CM-JT-LAST-NAME           PIC X(15).
   357             20  CM-JT-FIRST-NAME.
   358                 24  CM-JT-1ST-INIT        PIC X.
   359                 24  FILLER                PIC X(9).
   360             20  CM-JT-INITIAL             PIC X.
   361
   362     12  CM-LIFE-DATA.
   363         16  CM-LF-BENEFIT-CD              PIC XX.
   364         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   8
* SOCK03.cbl
   365         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   366         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   367         16  CM-LF-DEV-CODE                PIC XXX.
   368         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   369         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   370         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   371         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   372         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   373         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   374         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   375         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   376         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   377         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   378         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   379         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   380         16  FILLER                        PIC XX.
   381
   382     12  CM-AH-DATA.
   383         16  CM-AH-BENEFIT-CD              PIC XX.
   384         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   385         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   386         16  CM-AH-DEV-CODE                PIC XXX.
   387         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   388         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   389         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   390         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   391         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   392         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   393         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   394         16  CM-AH-PAID-THRU-DT            PIC XX.
   395             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   396         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   397         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   398         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   399         16  FILLER                        PIC X.
   400
   401     12  CM-LOAN-INFORMATION.
   402         16  CM-LIVES                      PIC S9(7)     COMP-3.
   403         16  CM-BILLED                     PIC S9(7)     COMP-3.
   404         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   405         16  CM-PAY-FREQUENCY              PIC S99.
   406         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   407         16  CM-RATE-CLASS                 PIC XX.
   408         16  CM-BENEFICIARY                PIC X(25).
   409         16  CM-POLICY-FORM-NO             PIC X(12).
   410         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   411         16  CM-LAST-ADD-ON-DT             PIC XX.
   412         16  CM-DEDUCTIBLE-AMOUNTS.
   413             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   414             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   415         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   416             20  CM-RESIDENT-STATE         PIC XX.
   417             20  CM-RATE-CODE              PIC X(4).
   418             20  FILLER                    PIC XX.
   419         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   420             20  CM-LOAN-OFFICER           PIC X(5).
   421             20  FILLER                    PIC XXX.
   422         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page   9
* SOCK03.cbl
   423         16  CM-UNDERWRITING-CODE          PIC X.
   424             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   425         16  CM-POST-CARD-IND              PIC X.
   426         16  CM-NH-INTERFACE-SW            PIC X.
   427         16  CM-PREMIUM-TYPE               PIC X.
   428             88  CM-SING-PRM                  VALUE '1'.
   429             88  CM-O-B-COVERAGE              VALUE '2'.
   430             88  CM-OPEN-END                  VALUE '3'.
   431         16  CM-IND-GRP-TYPE               PIC X.
   432             88  CM-INDIVIDUAL                VALUE 'I'.
   433             88  CM-GROUP                     VALUE 'G'.
   434         16  CM-SKIP-CODE                  PIC X.
   435             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   436             88  SKIP-JULY                    VALUE '1'.
   437             88  SKIP-AUGUST                  VALUE '2'.
   438             88  SKIP-SEPTEMBER               VALUE '3'.
   439             88  SKIP-JULY-AUG                VALUE '4'.
   440             88  SKIP-AUG-SEPT                VALUE '5'.
   441             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   442             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   443             88  SKIP-JUNE                    VALUE '8'.
   444             88  SKIP-JUNE-JULY               VALUE '9'.
   445             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   446             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   447         16  CM-PAYMENT-MODE               PIC X.
   448             88  PAY-MONTHLY                  VALUE SPACE.
   449             88  PAY-WEEKLY                   VALUE '1'.
   450             88  PAY-SEMI-MONTHLY             VALUE '2'.
   451             88  PAY-BI-WEEKLY                VALUE '3'.
   452             88  PAY-SEMI-ANUALLY             VALUE '4'.
   453         16  CM-LOAN-NUMBER                PIC X(8).
   454         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   455         16  CM-OLD-LOF                    PIC XXX.
   456*        16  CM-LOAN-OFFICER               PIC XXX.
   457         16  CM-REIN-TABLE                 PIC XXX.
   458         16  CM-SPECIAL-REIN-CODE          PIC X.
   459         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   460         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   461         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   462
   463     12  CM-STATUS-DATA.
   464         16  CM-ENTRY-STATUS               PIC X.
   465         16  CM-ENTRY-DT                   PIC XX.
   466
   467         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   468         16  CM-LF-CANCEL-DT               PIC XX.
   469         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   470
   471         16  CM-LF-STATUS-AT-DEATH         PIC X.
   472         16  CM-LF-DEATH-DT                PIC XX.
   473         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   474
   475         16  CM-LF-CURRENT-STATUS          PIC X.
   476             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   477                                                'M' '4' '5' '9'.
   478             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   479             88  CM-LF-POLICY-PENDING         VALUE '2'.
   480             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  10
* SOCK03.cbl
   481             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   482             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   483             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   484             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   485             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   486             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   487             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   488             88  CM-LF-DECLINED               VALUE 'D'.
   489             88  CM-LF-VOIDED                 VALUE 'V'.
   490
   491         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   492         16  CM-AH-CANCEL-DT               PIC XX.
   493         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   494
   495         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   496         16  CM-AH-SETTLEMENT-DT           PIC XX.
   497         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   498
   499         16  CM-AH-CURRENT-STATUS          PIC X.
   500             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   501                                                'M' '4' '5' '9'.
   502             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   503             88  CM-AH-POLICY-PENDING         VALUE '2'.
   504             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   505             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   506             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   507             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   508             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   509             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   510             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   511             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   512             88  CM-AH-DECLINED               VALUE 'D'.
   513             88  CM-AH-VOIDED                 VALUE 'V'.
   514
   515         16  CM-CLAIM-INTERFACE-SW         PIC X.
   516             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   517             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   518             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   519         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   520
   521         16  CM-ENTRY-BATCH                PIC X(6).
   522         16  CM-LF-EXIT-BATCH              PIC X(6).
   523         16  CM-AH-EXIT-BATCH              PIC X(6).
   524         16  CM-LAST-MONTH-END             PIC XX.
   525
   526     12  CM-NOTE-SW                        PIC X.
   527         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   528         88  CERT-NOTES-PRESENT               VALUE '1'.
   529         88  BILLING-NOTES-PRESENT            VALUE '2'.
   530         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   531         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   532         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   533         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   534         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   535     12  CM-COMP-EXCP-SW                   PIC X.
   536         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   537         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   538     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  11
* SOCK03.cbl
   539         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   540         88  INSURED-ADDR-PRESENT             VALUE '1'.
   541
   542*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   543     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   544     12  FILLER                            PIC X.
   545
   546*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   547     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   548     12  FILLER                            PIC X.
   549*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   550     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   551
   552     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   553         88  CERT-ADDED-BATCH                 VALUE ' '.
   554         88  CERT-ADDED-ONLINE                VALUE '1'.
   555         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   556         88  CERT-PURGED-OFFLINE              VALUE '3'.
   557         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   558     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   559         88  CERT-AS-LOADED                   VALUE ' '.
   560         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   561         88  CERT-CLAIM-ONLINE                VALUE '2'.
   562         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   563         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   564         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   565         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   566         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   567
   568     12  CM-ACCOUNT-COMM-PCTS.
   569         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   570         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   571
   572     12  CM-USER-FIELD                     PIC X.
   573     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   574     12  CM-CLP-STATE                      PIC XX.
   575     12  CM-USER-RESERVED                  PIC XXX.
   576******************************************************************
   577*                                 COPY ELCMSTR.
   578******************************************************************
   579*                                                                *
   580*                            ELCMSTR.                            *
   581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   582*                            VMOD=2.012                          *
   583*                                                                *
   584*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   585*                                                                *
   586*   FILE TYPE = VSAM,KSDS                                        *
   587*   RECORD SIZE = 350  RECFORM = FIXED                           *
   588*                                                                *
   589*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   590*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   591*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   592*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   593*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   594*                                                 RKP=75,LEN=21  *
   595*                                                                *
   596*   **** NOTE ****                                               *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  12
* SOCK03.cbl
   597*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   598*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   599*                                                                *
   600*   LOG = YES                                                    *
   601*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   602******************************************************************
   603*                   C H A N G E   L O G
   604*
   605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   606*-----------------------------------------------------------------
   607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   608* EFFECTIVE    NUMBER
   609*-----------------------------------------------------------------
   610* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   611* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   612******************************************************************
   613 01  CLAIM-MASTER.
   614     12  CL-RECORD-ID                PIC XX.
   615         88  VALID-CL-ID         VALUE 'CL'.
   616
   617     12  CL-CONTROL-PRIMARY.
   618         16  CL-COMPANY-CD           PIC X.
   619         16  CL-CARRIER              PIC X.
   620         16  CL-CLAIM-NO             PIC X(7).
   621         16  CL-CERT-NO.
   622             20  CL-CERT-PRIME       PIC X(10).
   623             20  CL-CERT-SFX         PIC X.
   624
   625     12  CL-CONTROL-BY-NAME.
   626         16  CL-COMPANY-CD-A1        PIC X.
   627         16  CL-INSURED-LAST-NAME    PIC X(15).
   628         16  CL-INSURED-NAME.
   629             20  CL-INSURED-1ST-NAME PIC X(12).
   630             20  CL-INSURED-MID-INIT PIC X.
   631
   632     12  CL-CONTROL-BY-SSN.
   633         16  CL-COMPANY-CD-A2        PIC X.
   634         16  CL-SOC-SEC-NO.
   635             20  CL-SSN-STATE        PIC XX.
   636             20  CL-SSN-ACCOUNT      PIC X(6).
   637             20  CL-SSN-LN3          PIC X(3).
   638
   639     12  CL-CONTROL-BY-CERT-NO.
   640         16  CL-COMPANY-CD-A4        PIC X.
   641         16  CL-CERT-NO-A4.
   642             20  CL-CERT-A4-PRIME    PIC X(10).
   643             20  CL-CERT-A4-SFX      PIC X.
   644
   645     12  CL-CONTROL-BY-CCN.
   646         16  CL-COMPANY-CD-A5        PIC X.
   647         16  CL-CCN-A5.
   648             20  CL-CCN.
   649                 24  CL-CCN-PREFIX-A5 PIC X(4).
   650                 24  CL-CCN-PRIME-A5 PIC X(12).
   651             20  CL-CCN-FILLER-A5    PIC X(4).
   652
   653     12  CL-INSURED-PROFILE-DATA.
   654         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  13
* SOCK03.cbl
   655         16  CL-INSURED-SEX-CD       PIC X.
   656             88  INSURED-IS-MALE        VALUE 'M'.
   657             88  INSURED-IS-FEMALE      VALUE 'F'.
   658             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   659         16  CL-INSURED-OCC-CD       PIC X(6).
   660         16  FILLER                  PIC X(5).
   661
   662     12  CL-PROCESSING-INFO.
   663         16  CL-PROCESSOR-ID         PIC X(4).
   664         16  CL-CLAIM-STATUS         PIC X.
   665             88  CLAIM-IS-OPEN          VALUE 'O'.
   666             88  CLAIM-IS-CLOSED        VALUE 'C'.
   667         16  CL-CLAIM-TYPE           PIC X.
   668*            88  AH-CLAIM               VALUE 'A'.
   669*            88  LIFE-CLAIM             VALUE 'L'.
   670*            88  PROPERTY-CLAIM         VALUE 'P'.
   671*            88  IUI-CLAIM              VALUE 'I'.
   672*            88  GAP-CLAIM              VALUE 'G'.
   673         16  CL-CLAIM-PREM-TYPE      PIC X.
   674             88  SINGLE-PREMIUM         VALUE '1'.
   675             88  O-B-COVERAGE           VALUE '2'.
   676             88  OPEN-END-COVERAGE      VALUE '3'.
   677         16  CL-INCURRED-DT          PIC XX.
   678         16  CL-REPORTED-DT          PIC XX.
   679         16  CL-FILE-ESTABLISH-DT    PIC XX.
   680         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   681         16  CL-LAST-PMT-DT          PIC XX.
   682         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   683         16  CL-PAID-THRU-DT         PIC XX.
   684         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   685         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   686         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   687         16  CL-PMT-CALC-METHOD      PIC X.
   688             88  CL-360-DAY-YR          VALUE '1'.
   689             88  CL-365-DAY-YR          VALUE '2'.
   690             88  CL-FULL-MONTHS         VALUE '3'.
   691         16  CL-CAUSE-CD             PIC X(6).
   692
   693         16  CL-PRIME-CERT-NO.
   694             20  CL-PRIME-CERT-PRIME PIC X(10).
   695             20  CL-PRIME-CERT-SFX   PIC X.
   696
   697         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   698             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   699             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   700
   701         16  CL-MICROFILM-NO         PIC X(10).
   702         16  CL-PROG-FORM-TYPE       PIC X.
   703         16  CL-LAST-ADD-ON-DT       PIC XX.
   704
   705         16  CL-LAST-REOPEN-DT       PIC XX.
   706         16  CL-LAST-CLOSE-DT        PIC XX.
   707         16  CL-LAST-CLOSE-REASON    PIC X(01).
   708             88  FINAL-PAID             VALUE '1'.
   709             88  CLAIM-DENIED           VALUE '2'.
   710             88  AUTO-CLOSE             VALUE '3'.
   711             88  MANUAL-CLOSE           VALUE '4'.
   712             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  14
* SOCK03.cbl
   713             88  SETUP-ERRORS           VALUE 'E'.
   714         16  CL-ASSOC-CERT-SEQU      PIC S99.
   715         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   716         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   717             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   718         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   719         16  FILLER                  PIC X.
   720
   721     12  CL-CERTIFICATE-DATA.
   722         16  CL-CERT-ORIGIN          PIC X.
   723             88  CERT-WAS-ONLINE        VALUE '1'.
   724             88  CERT-WAS-CREATED       VALUE '2'.
   725             88  COVERAGE-WAS-ADDED     VALUE '3'.
   726         16  CL-CERT-KEY-DATA.
   727             20  CL-CERT-CARRIER     PIC X.
   728             20  CL-CERT-GROUPING    PIC X(6).
   729             20  CL-CERT-STATE       PIC XX.
   730             20  CL-CERT-ACCOUNT.
   731                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   732                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   733             20  CL-CERT-EFF-DT      PIC XX.
   734
   735     12  CL-STATUS-CONTROLS.
   736         16  CL-PRIORITY-CD          PIC X.
   737             88  CONFIDENTIAL-DATA      VALUE '8'.
   738             88  HIGHEST-PRIORITY       VALUE '9'.
   739         16  CL-SUPV-ATTN-CD         PIC X.
   740             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   741             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   742         16  CL-PURGED-DT            PIC XX.
   743         16  CL-RESTORED-DT          PIC XX.
   744         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   745         16  CL-NEXT-RESEND-DT       PIC XX.
   746         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   747         16  FILLER                  PIC XX.
   748         16  CL-LAST-MAINT-DT        PIC XX.
   749         16  CL-LAST-MAINT-USER      PIC X(4).
   750         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   751         16  CL-LAST-MAINT-TYPE      PIC X.
   752             88  CLAIM-SET-UP           VALUE ' '.
   753             88  PAYMENT-MADE           VALUE '1'.
   754             88  LETTER-SENT            VALUE '2'.
   755             88  MASTER-WAS-ALTERED     VALUE '3'.
   756             88  MASTER-WAS-RESTORED    VALUE '4'.
   757             88  INCURRED-DATE-CHANGED  VALUE '5'.
   758             88  FILE-CONVERTED         VALUE '6'.
   759             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   760             88  ERROR-CORRECTION       VALUE 'E'.
   761         16  CL-RELATED-CLAIM-NO     PIC X(7).
   762         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   763         16  CL-BENEFICIARY          PIC X(10).
   764         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   765         16  CL-DENIAL-TYPE          PIC X.
   766             88  CL-TYPE-DENIAL          VALUE '1'.
   767             88  CL-TYPE-RESCISSION      VALUE '2'.
   768             88  CL-TYPE-REFORMATION     VALUE '3'.
   769             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   770             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  15
* SOCK03.cbl
   771         16  FILLER                  PIC X(5).
   772
   773     12  CL-TRAILER-CONTROLS.
   774         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   775             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   776             88  CL-LAST-TRL-AVAIL      VALUE +100.
   777             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   778         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   779         16  FILLER                  PIC XX.
   780         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   781         16  CL-ADDRESS-TRAILER-CNT.
   782             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   783                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   784             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   785                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   786             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   787                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   788             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   789                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   790             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   791                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   792             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   793                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   794             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   795                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   796
   797     12  CL-CV-REFERENCE-NO.
   798         16  CL-CV-REFNO-PRIME       PIC X(18).
   799         16  CL-CV-REFNO-SFX         PIC XX.
   800
   801     12  CL-FILE-LOCATION            PIC X(4).
   802
   803     12  CL-PROCESS-ERRORS.
   804         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   805             88  NO-FATAL-ERRORS        VALUE ZERO.
   806         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   807             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   808
   809     12  CL-PRODUCT-CD               PIC X.
   810
   811     12  CL-CURRENT-KEY-DATA.
   812         16  CL-CURRENT-CARRIER      PIC X.
   813         16  CL-CURRENT-GROUPING     PIC X(6).
   814         16  CL-CURRENT-STATE        PIC XX.
   815         16  CL-CURRENT-ACCOUNT      PIC X(10).
   816
   817     12  CL-ASSOCIATES               PIC X.
   818         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   819         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   820         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   821         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   822
   823     12  CL-ACTIVITY-CODE            PIC 99.
   824     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   825     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   826
   827     12  CL-LAPSE-REPORT-CODE        PIC 9.
   828     12  CL-LAG-REPORT-CODE          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  16
* SOCK03.cbl
   829     12  CL-LOAN-TYPE                PIC XX.
   830     12  CL-LEGAL-STATE              PIC XX.
   831
   832*    12  FILLER                      PIC X(5).
   833     12  CL-YESNOSW                  PIC X.
   834     12  FILLER                      PIC X(4).
   835*                                 COPY ELCCNTL.
   836******************************************************************
   837*                                                                *
   838*                                                                *
   839*                            ELCCNTL.                            *
   840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   841*                            VMOD=2.059                          *
   842*                                                                *
   843*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   844*                                                                *
   845*   FILE TYPE = VSAM,KSDS                                        *
   846*   RECORD SIZE = 750  RECFORM = FIXED                           *
   847*                                                                *
   848*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   849*       ALTERNATE INDEX = NONE                                   *
   850*                                                                *
   851*   LOG = YES                                                    *
   852*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   853******************************************************************
   854*                   C H A N G E   L O G
   855*
   856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   857*-----------------------------------------------------------------
   858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   859* EFFECTIVE    NUMBER
   860*-----------------------------------------------------------------
   861* 082503                   PEMA  ADD BENEFIT GROUP
   862* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   863* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   864* 092705    2005050300006  PEMA  ADD SPP LEASES
   865* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   866* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   867* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   868* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   869******************************************************************
   870*
   871 01  CONTROL-FILE.
   872     12  CF-RECORD-ID                       PIC XX.
   873         88  VALID-CF-ID                        VALUE 'CF'.
   874
   875     12  CF-CONTROL-PRIMARY.
   876         16  CF-COMPANY-ID                  PIC XXX.
   877         16  CF-RECORD-TYPE                 PIC X.
   878             88  CF-COMPANY-MASTER              VALUE '1'.
   879             88  CF-PROCESSOR-MASTER            VALUE '2'.
   880             88  CF-STATE-MASTER                VALUE '3'.
   881             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   882             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   883             88  CF-CARRIER-MASTER              VALUE '6'.
   884             88  CF-MORTALITY-MASTER            VALUE '7'.
   885             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   886             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  17
* SOCK03.cbl
   887             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   888             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   889             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   890             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   891             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   892             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   893             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   894             88  CF-REMINDERS-MASTER            VALUE 'R'.
   895             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   896         16  CF-ACCESS-CD-GENL              PIC X(4).
   897         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   898             20  CF-PROCESSOR               PIC X(4).
   899         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   900             20  CF-STATE-CODE              PIC XX.
   901             20  FILLER                     PIC XX.
   902         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   903             20  FILLER                     PIC XX.
   904             20  CF-HI-BEN-IN-REC           PIC XX.
   905         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   906             20  FILLER                     PIC XXX.
   907             20  CF-CARRIER-CNTL            PIC X.
   908         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   909             20  FILLER                     PIC XX.
   910             20  CF-HI-TYPE-IN-REC          PIC 99.
   911         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   912             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   913                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   914             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   915             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   916         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   917             20  FILLER                     PIC X.
   918             20  CF-CUSTOM-REPORT-NO        PIC 999.
   919         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   920             20  FILLER                     PIC XX.
   921             20  CF-MORTGAGE-PLAN           PIC XX.
   922         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   923
   924     12  CF-LAST-MAINT-DT                   PIC XX.
   925     12  CF-LAST-MAINT-BY                   PIC X(4).
   926     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   927
   928     12  CF-RECORD-BODY                     PIC X(728).
   929
   930
   931****************************************************************
   932*             COMPANY MASTER RECORD                            *
   933****************************************************************
   934
   935     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   936         16  CF-COMPANY-ADDRESS.
   937             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   938             20  CF-CL-IN-CARE-OF           PIC X(30).
   939             20  CF-CL-ADDR-LINE-1          PIC X(30).
   940             20  CF-CL-ADDR-LINE-2          PIC X(30).
   941             20  CF-CL-CITY-STATE           PIC X(30).
   942             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   943             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   944         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  18
* SOCK03.cbl
   945         16  CF-COMPANY-PASSWORD            PIC X(8).
   946         16  CF-SECURITY-OPTION             PIC X.
   947             88  ALL-SECURITY                   VALUE '1'.
   948             88  COMPANY-VERIFY                 VALUE '2'.
   949             88  PROCESSOR-VERIFY               VALUE '3'.
   950             88  NO-SECURITY                    VALUE '4'.
   951             88  ALL-BUT-TERM                   VALUE '5'.
   952         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   953             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   954         16  CF-LGX-INTERFACE-CNTL          PIC X.
   955             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   956         16  CF-INFORCE-LOCATION            PIC X.
   957             88  CERTS-ARE-ONLINE               VALUE '1'.
   958             88  CERTS-ARE-OFFLINE              VALUE '2'.
   959             88  NO-CERTS-AVAILABLE             VALUE '3'.
   960         16  CF-LOWER-CASE-LETTERS          PIC X.
   961         16  CF-CERT-ACCESS-CONTROL         PIC X.
   962             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   963             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   964             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   965             88  CF-ACCNT-CNTL                  VALUE '3'.
   966             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   967
   968         16  CF-FORMS-PRINTER-ID            PIC X(4).
   969         16  CF-CHECK-PRINTER-ID            PIC X(4).
   970
   971         16  CF-LGX-CREDIT-USER             PIC X.
   972             88  CO-IS-NOT-USER                 VALUE 'N'.
   973             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   974
   975         16 CF-CREDIT-CALC-CODES.
   976             20  CF-CR-REM-TERM-CALC PIC X.
   977               88  CR-EARN-AFTER-15TH           VALUE '1'.
   978               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   979               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   980               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   981               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   982               88  CR-EARN-AFTER-14TH           VALUE '6'.
   983               88  CR-EARN-AFTER-16TH           VALUE '7'.
   984             20  CF-CR-R78-METHOD           PIC X.
   985               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   986               88  DONT-USE-PLUS-ONE            VALUE '1'.
   987
   988         16  CF-CLAIM-CONTROL-COUNTS.
   989             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   990                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   991
   992             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   993                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   994
   995             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   996                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   997
   998             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   999                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1000
  1001         16  CF-CURRENT-MONTH-END           PIC XX.
  1002
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  19
* SOCK03.cbl
  1003         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1004             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1005             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1006             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1007             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1008                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1009                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1010             20  CF-CO-PREM-REJECT-SW       PIC X.
  1011                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1012                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1013             20  CF-CO-REF-REJECT-SW        PIC X.
  1014                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1015                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1016
  1017         16  CF-CO-REPORTING-DT             PIC XX.
  1018         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1019         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1020           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1021           88  CF-CO-MONTH-END                  VALUE '1'.
  1022
  1023         16  CF-LGX-CLAIM-USER              PIC X.
  1024             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1025             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1026
  1027         16  CF-CREDIT-EDIT-CONTROLS.
  1028             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1029             20  CF-MIN-AGE                 PIC 99.
  1030             20  CF-DEFAULT-AGE             PIC 99.
  1031             20  CF-MIN-TERM                PIC S999      COMP-3.
  1032             20  CF-MAX-TERM                PIC S999      COMP-3.
  1033             20  CF-DEFAULT-SEX             PIC X.
  1034             20  CF-JOINT-AGE-INPUT         PIC X.
  1035                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1036             20  CF-BIRTH-DATE-INPUT        PIC X.
  1037                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1038             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1039                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1040                 88  CF-ZERO-CARRIER            VALUE '1'.
  1041                 88  CF-ZERO-GROUPING           VALUE '2'.
  1042                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1043             20  CF-EDIT-SW                 PIC X.
  1044                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1045             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1046             20  CF-CR-PR-METHOD            PIC X.
  1047               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1048               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1049             20  FILLER                     PIC X.
  1050
  1051         16  CF-CREDIT-MISC-CONTROLS.
  1052             20  CF-REIN-TABLE-SW           PIC X.
  1053                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1054             20  CF-COMP-TABLE-SW           PIC X.
  1055                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1056             20  CF-EXPERIENCE-RETENTION-AGE
  1057                                            PIC S9        COMP-3.
  1058             20  CF-CONVERSION-DT           PIC XX.
  1059             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1060             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  20
* SOCK03.cbl
  1061                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1062                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1063
  1064             20  CF-CR-CHECK-NO-CONTROL.
  1065                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1066                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1067                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1068                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1069                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1070                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1071
  1072                 24  CF-CR-CHECK-COUNT       REDEFINES
  1073                     CF-CR-CHECK-COUNTER      PIC X(4).
  1074
  1075                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1076                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1077
  1078                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1079                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1080                 24  CF-MAIL-PROCESSING       PIC X.
  1081                     88  MAIL-PROCESSING          VALUE 'Y'.
  1082
  1083         16  CF-MISC-SYSTEM-CONTROL.
  1084             20  CF-SYSTEM-C                 PIC X.
  1085                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1086             20  CF-SYSTEM-D                 PIC X.
  1087                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1088             20  CF-SOC-SEC-NO-SW            PIC X.
  1089                 88  SOC-SEC-NO-USED             VALUE '1'.
  1090             20  CF-MEMBER-NO-SW             PIC X.
  1091                 88  MEMBER-NO-USED              VALUE '1'.
  1092             20  CF-TAX-ID-NUMBER            PIC X(11).
  1093             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1094             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1095                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1096                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1097                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1098                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1099             20  CF-SYSTEM-E                 PIC X.
  1100                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1101
  1102         16  CF-LGX-LIFE-USER               PIC X.
  1103             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1104             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1105
  1106         16  CF-CR-MONTH-END-DT             PIC XX.
  1107
  1108         16  CF-FILE-MAINT-DATES.
  1109             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1110                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1111             20  CF-LAST-BATCH       REDEFINES
  1112                 CF-LAST-BATCH-NO               PIC X(4).
  1113             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1114             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1115             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1116             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1117             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1118             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  21
* SOCK03.cbl
  1119             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1120             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1121             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1122             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1123
  1124         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1125         16  FILLER                         PIC X.
  1126
  1127         16  CF-ALT-MORT-CODE               PIC X(4).
  1128         16  CF-MEMBER-CAPTION              PIC X(10).
  1129
  1130         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1131             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1132             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1133             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1134             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1135             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1136
  1137         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1138
  1139         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1140         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1141         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1142         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1143
  1144         16  CF-AH-OVERRIDE-L1              PIC X.
  1145         16  CF-AH-OVERRIDE-L2              PIC XX.
  1146         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1147         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1148
  1149         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1150         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1151
  1152         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1153         16  CF-AR-LAST-EL860-DT            PIC XX.
  1154         16  CF-MP-MONTH-END-DT             PIC XX.
  1155
  1156         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1157         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1158             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1159
  1160         16  CF-AR-MONTH-END-DT             PIC XX.
  1161
  1162         16  CF-CRDTCRD-USER                PIC X.
  1163             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1164             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1165
  1166         16  CF-CC-MONTH-END-DT             PIC XX.
  1167
  1168         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1169
  1170         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1171             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1172             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1173             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1174         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1175         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1176         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  22
* SOCK03.cbl
  1177         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1178             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1179             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1180         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1181         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1182         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1183             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1184         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1185
  1186         16  CF-CL-ZIP-CODE.
  1187             20  CF-CL-ZIP-PRIME.
  1188                 24  CF-CL-ZIP-1ST          PIC X.
  1189                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1190                 24  FILLER                 PIC X(4).
  1191             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1192         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1193             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1194             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1195             20  FILLER                     PIC XXX.
  1196
  1197         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1198         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1199         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1200         16  CF-CO-OPTION-START-DATE        PIC XX.
  1201         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1202           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1203                                                      '3' '4'.
  1204           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1205           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1206           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1207           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1208           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1209           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1210
  1211         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1212
  1213         16  CF-PAYMENT-APPROVAL-LEVELS.
  1214             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1215             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1216             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1217             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1218             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1219             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1220
  1221         16  CF-END-USER-REPORTING-USER     PIC X.
  1222             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1223             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1224
  1225         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1226             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1227             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1228
  1229         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1230
  1231         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1232         16  FILLER                         PIC X.
  1233
  1234         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  23
* SOCK03.cbl
  1235             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1236             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1237             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1238
  1239         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1240
  1241         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1242             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1243             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1244
  1245         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1246             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1247             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1248
  1249         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1250
  1251         16  CF-CO-ACH-ID-CODE              PIC  X.
  1252             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1253             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1254             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1255         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1256         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1257         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1258         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1259         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1260         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1261         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1262         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1263         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1264                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1265         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1266                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1267
  1268         16  CF-CO-OVER-SHORT.
  1269             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1270             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1271
  1272*         16  FILLER                         PIC X(102).
  1273         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1274             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1275             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1276
  1277         16  CF-AH-APPROVAL-DAYS.
  1278             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1279             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1280             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1281             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1282
  1283         16  FILLER                         PIC X(82).
  1284****************************************************************
  1285*             PROCESSOR/USER RECORD                            *
  1286****************************************************************
  1287
  1288     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1289         16  CF-PROCESSOR-NAME              PIC X(30).
  1290         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1291         16  CF-PROCESSOR-TITLE             PIC X(26).
  1292         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  24
* SOCK03.cbl
  1293                 88  MESSAGE-YES                VALUE 'Y'.
  1294                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1295
  1296*****************************************************
  1297****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1298****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1299****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1300****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1301*****************************************************
  1302
  1303         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1304             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1305             20  CF-APPLICATION-FORCE       PIC X.
  1306             20  CF-INDIVIDUAL-APP.
  1307                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1308                     28  CF-BROWSE-APP      PIC X.
  1309                     28  CF-UPDATE-APP      PIC X.
  1310
  1311         16  CF-CURRENT-TERM-ON             PIC X(4).
  1312         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1313             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1314             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1315             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1316             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1317             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1318             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1319             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1320         16  CF-PROCESSOR-CARRIER           PIC X.
  1321             88  NO-CARRIER-SECURITY            VALUE ' '.
  1322         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1323             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1324         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1325             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1326         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1327             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1328
  1329         16  CF-PROC-SYS-ACCESS-SW.
  1330             20  CF-PROC-CREDIT-CLAIMS-SW.
  1331                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1332                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1333                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1334                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1335             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1336                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1337                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1338             20  CF-PROC-LIFE-GNRLDGR-SW.
  1339                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1340                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1341                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1342                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1343             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1344                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1345                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1346         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1347             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1348             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1349         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1350
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  25
* SOCK03.cbl
  1351         16  CF-APPROVAL-LEVEL                  PIC X.
  1352             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1353             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1354             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1355             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1356
  1357         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1358
  1359         16  CF-LANGUAGE-TYPE                   PIC X.
  1360             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1361             88  CF-LANG-IS-FR                      VALUE 'F'.
  1362         16  FILLER                             PIC  X(240).
  1363
  1364****************************************************************
  1365*             PROCESSOR/REMINDERS RECORD                       *
  1366****************************************************************
  1367
  1368     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1369         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1370             20  CF-START-REMIND-DT         PIC XX.
  1371             20  CF-END-REMIND-DT           PIC XX.
  1372             20  CF-REMINDER-TEXT           PIC X(50).
  1373         16  FILLER                         PIC X(296).
  1374
  1375
  1376****************************************************************
  1377*             STATE MASTER RECORD                              *
  1378****************************************************************
  1379
  1380     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1381         16  CF-STATE-ABBREVIATION          PIC XX.
  1382         16  CF-STATE-NAME                  PIC X(25).
  1383         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1384         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1385             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1386             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1387             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1388             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1389                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1390                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1391             20  CF-ST-PREM-REJECT-SW       PIC X.
  1392                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1393                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1394             20  CF-ST-REF-REJECT-SW        PIC X.
  1395                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1396                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1397         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1398         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1399         16  CF-ST-REFUND-RULES.
  1400             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1401             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1402             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1403         16  CF-ST-FST-PMT-EXTENSION.
  1404             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1405             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1406                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1407                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1408                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  26
* SOCK03.cbl
  1409                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1410         16  CF-ST-STATE-CALL.
  1411             20  CF-ST-CALL-UNEARNED        PIC X.
  1412             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1413             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1414         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1415             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1416             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1417         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1418         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1419         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1420         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1421         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1422         16  FILLER                         PIC X.
  1423         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1424             20  CF-ST-BENEFIT-CD           PIC XX.
  1425             20  CF-ST-BENEFIT-KIND         PIC X.
  1426                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1427                 88  CF-ST-AH-KIND              VALUE 'A'.
  1428             20  CF-ST-REM-TERM-CALC        PIC X.
  1429                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1430                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1431                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1432                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1433                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1434                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1435                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1436                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1437
  1438             20  CF-ST-REFUND-CALC          PIC X.
  1439                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1440                 88  ST-REFD-BY-R78             VALUE '1'.
  1441                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1442                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1443                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1444                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1445                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1446                 88  ST-REFD-UTAH               VALUE '7'.
  1447                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1448                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1449                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1450
  1451             20  CF-ST-EARNING-CALC         PIC X.
  1452                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1453                 88  ST-EARN-BY-R78             VALUE '1'.
  1454                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1455                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1456                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1457                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1458                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1459                 88  ST-EARN-MEAN               VALUE '8'.
  1460                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1461
  1462             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1463                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1464                 88  ST-OVRD-BY-R78             VALUE '1'.
  1465                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1466                 88  ST-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  27
* SOCK03.cbl
  1467                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1468                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1469                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1470                 88  ST-OVRD-MEAN               VALUE '8'.
  1471                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1472             20  FILLER                     PIC X.
  1473
  1474         16  CF-ST-COMMISSION-CAPS.
  1475             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1476             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1477             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1478             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1479         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1480                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1481
  1482         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1483
  1484         16  CF-ST-STATUTORY-INTEREST.
  1485             20  CF-ST-STAT-DATE-FROM       PIC X.
  1486                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1487                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1488             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1489             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1490             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1491             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1492             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1493
  1494         16  CF-ST-OVER-SHORT.
  1495             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1496             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1497
  1498         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1499
  1500         16  CF-ST-RT-CALC                  PIC X.
  1501
  1502         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1503         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1504         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1505         16  CF-ST-RF-LR-CALC               PIC X.
  1506         16  CF-ST-RF-LL-CALC               PIC X.
  1507         16  CF-ST-RF-LN-CALC               PIC X.
  1508         16  CF-ST-RF-AH-CALC               PIC X.
  1509         16  CF-ST-RF-CP-CALC               PIC X.
  1510*        16  FILLER                         PIC X(206).
  1511*CIDMOD         16  FILLER                         PIC X(192).
  1512         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1513             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1514         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1515         16  FILLER                         PIC X(187).
  1516
  1517****************************************************************
  1518*             BENEFIT MASTER RECORD                            *
  1519****************************************************************
  1520
  1521     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1522         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1523             20  CF-BENEFIT-CODE            PIC XX.
  1524             20  CF-BENEFIT-NUMERIC  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  28
* SOCK03.cbl
  1525                 CF-BENEFIT-CODE            PIC XX.
  1526             20  CF-BENEFIT-ALPHA           PIC XXX.
  1527             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1528             20  CF-BENEFIT-COMMENT         PIC X(10).
  1529
  1530             20  CF-LF-COVERAGE-TYPE        PIC X.
  1531                 88  CF-REDUCING                VALUE 'R'.
  1532                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1533
  1534             20  CF-SPECIAL-CALC-CD         PIC X.
  1535                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1536                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1537                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1538                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1539                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1540                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1541                 88  CF-FARM-PLAN               VALUE 'F'.
  1542                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1543                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1544                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1545                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1546                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1547                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1548                 88  CF-PRUDENTIAL              VALUE 'P'.
  1549                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1550                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1551                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1552                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1553                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1554                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1555
  1556             20  CF-JOINT-INDICATOR         PIC X.
  1557                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1558
  1559*            20  FILLER                     PIC X(12).
  1560             20  FILLER                     PIC X(11).
  1561             20  CF-BENEFIT-CATEGORY        PIC X.
  1562             20  CF-LOAN-TYPE               PIC X(8).
  1563
  1564             20  CF-CO-REM-TERM-CALC        PIC X.
  1565                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1566                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1567                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1568                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1569                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1570
  1571             20  CF-CO-EARNINGS-CALC        PIC X.
  1572                 88  CO-EARN-BY-R78             VALUE '1'.
  1573                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1574                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1575                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1576                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1577                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1578                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1579                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1580
  1581             20  CF-CO-REFUND-CALC          PIC X.
  1582                 88  CO-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  29
* SOCK03.cbl
  1583                 88  CO-REFD-BY-R78             VALUE '1'.
  1584                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1585                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1586                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1587                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1588                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1589                 88  CO-REFD-MEAN               VALUE '8'.
  1590                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1591                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1592                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1593
  1594             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1595                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1596                 88  CO-OVRD-BY-R78             VALUE '1'.
  1597                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1598                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1599                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1600                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1601                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1602                 88  CO-OVRD-MEAN               VALUE '8'.
  1603                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1604
  1605             20  CF-CO-BEN-I-G-CD           PIC X.
  1606                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1607                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1608                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1609
  1610         16  FILLER                         PIC X(304).
  1611
  1612
  1613****************************************************************
  1614*             CARRIER MASTER RECORD                            *
  1615****************************************************************
  1616
  1617     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1618         16  CF-ADDRESS-DATA.
  1619             20  CF-MAIL-TO-NAME            PIC X(30).
  1620             20  CF-IN-CARE-OF              PIC X(30).
  1621             20  CF-ADDRESS-LINE-1          PIC X(30).
  1622             20  CF-ADDRESS-LINE-2          PIC X(30).
  1623             20  CF-CITY-STATE              PIC X(30).
  1624             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1625             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1626
  1627         16  CF-CLAIM-NO-CONTROL.
  1628             20  CF-CLAIM-NO-METHOD         PIC X.
  1629                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1630                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1631                 88  CLAIM-NO-SEQ               VALUE '3'.
  1632                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1633             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1634                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1635                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1636                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1637
  1638         16  CF-CHECK-NO-CONTROL.
  1639             20  CF-CHECK-NO-METHOD         PIC X.
  1640                 88  CHECK-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  30
* SOCK03.cbl
  1641                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1642                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1643                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1644             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1645                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1646
  1647         16  CF-DOMICILE-STATE              PIC XX.
  1648
  1649         16  CF-EXPENSE-CONTROLS.
  1650             20  CF-EXPENSE-METHOD          PIC X.
  1651                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1652                 88  DOLLARS-PER-PMT            VALUE '2'.
  1653                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1654                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1655             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1656             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1657
  1658         16  CF-CORRESPONDENCE-CONTROL.
  1659             20  CF-LETTER-RESEND-OPT       PIC X.
  1660                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1661                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1662             20  FILLER                     PIC X(4).
  1663
  1664         16  CF-RESERVE-CONTROLS.
  1665             20  CF-MANUAL-SW               PIC X.
  1666                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1667             20  CF-FUTURE-SW               PIC X.
  1668                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1669             20  CF-PTC-SW                  PIC X.
  1670                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1671             20  CF-IBNR-SW                 PIC X.
  1672                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1673             20  CF-PTC-LF-SW               PIC X.
  1674                 88  CF-LF-PTC-USED             VALUE '1'.
  1675             20  CF-CDT-ACCESS-METHOD       PIC X.
  1676                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1677                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1678                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1679             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1680
  1681         16  CF-CLAIM-CALC-METHOD           PIC X.
  1682             88  360-PLUS-MONTHS                VALUE '1'.
  1683             88  365-PLUS-MONTHS                VALUE '2'.
  1684             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1685             88  360-DAILY                      VALUE '4'.
  1686             88  365-DAILY                      VALUE '5'.
  1687
  1688         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1689         16  FILLER                         PIC X(11).
  1690
  1691         16  CF-LIMIT-AMOUNTS.
  1692             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1693             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1694             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1695             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1696             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1697             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1698             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  31
* SOCK03.cbl
  1699             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1700             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1701             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1702
  1703         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1704         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1705         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1706
  1707         16  CF-ZIP-CODE.
  1708             20  CF-ZIP-PRIME.
  1709                 24  CF-ZIP-1ST             PIC X.
  1710                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1711                 24  FILLER                 PIC X(4).
  1712             20  CF-ZIP-PLUS4               PIC X(4).
  1713         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1714             20  CF-CAN-POSTAL-1            PIC XXX.
  1715             20  CF-CAN-POSTAL-2            PIC XXX.
  1716             20  FILLER                     PIC XXX.
  1717
  1718         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1719         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1720         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1721
  1722         16  CF-RATING-SWITCH               PIC X.
  1723             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1724             88  CF-NO-RATING                   VALUE 'N'.
  1725
  1726         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1727
  1728         16  CF-CARRIER-OVER-SHORT.
  1729             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1730             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1731
  1732         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1733         16  CF-SECPAY-SWITCH               PIC X.
  1734             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1735             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1736         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1737         16  FILLER                         PIC X(448).
  1738*        16  FILLER                         PIC X(452).
  1739
  1740
  1741****************************************************************
  1742*             MORTALITY MASTER RECORD                          *
  1743****************************************************************
  1744
  1745     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1746         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1747                                INDEXED BY CF-MORT-NDX.
  1748             20  CF-MORT-TABLE              PIC X(5).
  1749             20  CF-MORT-TABLE-TYPE         PIC X.
  1750                 88  CF-MORT-JOINT              VALUE 'J'.
  1751                 88  CF-MORT-SINGLE             VALUE 'S'.
  1752                 88  CF-MORT-COMBINED           VALUE 'C'.
  1753                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1754                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1755             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1756             20  CF-MORT-AGE-METHOD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  32
* SOCK03.cbl
  1757                 88  CF-AGE-LAST                VALUE 'AL'.
  1758                 88  CF-AGE-NEAR                VALUE 'AN'.
  1759             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1760             20  CF-MORT-ADJUSTMENT-DIRECTION
  1761                                            PIC X.
  1762                 88  CF-MINUS                   VALUE '-'.
  1763                 88  CF-PLUS                    VALUE '+'.
  1764             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1765             20  CF-MORT-JOINT-CODE         PIC X.
  1766                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1767             20  CF-MORT-PC-Q               PIC X.
  1768                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1769             20  CF-MORT-TABLE-CODE         PIC X(4).
  1770             20  CF-MORT-COMMENTS           PIC X(15).
  1771             20  FILLER                     PIC X(14).
  1772
  1773         16  FILLER                         PIC X(251).
  1774
  1775
  1776****************************************************************
  1777*             BUSSINESS TYPE MASTER RECORD                     *
  1778****************************************************************
  1779
  1780     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1781* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1782* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1783* AND RECORD 05 IS TYPES 81-99
  1784         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1785             20  CF-BUSINESS-TITLE          PIC  X(19).
  1786             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1787                                            PIC S9V9(4) COMP-3.
  1788             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1789             20  FILLER                     PIC  X.
  1790         16  FILLER                         PIC  X(248).
  1791
  1792
  1793****************************************************************
  1794*             TERMINAL MASTER RECORD                           *
  1795****************************************************************
  1796
  1797     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1798
  1799         16  CF-COMPANY-TERMINALS.
  1800             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1801                                  PIC X(4).
  1802         16  FILLER               PIC X(248).
  1803
  1804
  1805****************************************************************
  1806*             LIFE EDIT MASTER RECORD                          *
  1807****************************************************************
  1808
  1809     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1810         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1811             20  CF-LIFE-CODE-IN            PIC XX.
  1812             20  CF-LIFE-CODE-OUT           PIC XX.
  1813         16  FILLER                         PIC X(248).
  1814
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  33
* SOCK03.cbl
  1815
  1816****************************************************************
  1817*             AH EDIT MASTER RECORD                            *
  1818****************************************************************
  1819
  1820     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1821         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1822             20  CF-AH-CODE-IN              PIC XXX.
  1823             20  CF-AH-CODE-OUT             PIC XX.
  1824         16  FILLER                         PIC X(248).
  1825
  1826
  1827****************************************************************
  1828*             CREDIBILITY TABLES                               *
  1829****************************************************************
  1830
  1831     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1832         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1833                             INDEXED BY CF-CRDB-NDX.
  1834             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1835             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1836             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1837         16  FILLER                         PIC  X(332).
  1838
  1839
  1840****************************************************************
  1841*             REPORT CUSTOMIZATION RECORD                      *
  1842****************************************************************
  1843
  1844     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1845         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1846             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1847             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1848             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1849**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1850****       A T-TRANSFER.                                   ****
  1851             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1852
  1853         16  FILLER                         PIC XX.
  1854
  1855         16  CF-CARRIER-CNTL-OPT.
  1856             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1857                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1858                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1859             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1860                                            PIC X.
  1861         16  CF-GROUP-CNTL-OPT.
  1862             20  CF-GROUP-OPT-SEQ           PIC 9.
  1863                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1864                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1865             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1866                                            PIC X(6).
  1867         16  CF-STATE-CNTL-OPT.
  1868             20  CF-STATE-OPT-SEQ           PIC 9.
  1869                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1870                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1871             20  CF-STATE-SELECT OCCURS 3 TIMES
  1872                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  34
* SOCK03.cbl
  1873         16  CF-ACCOUNT-CNTL-OPT.
  1874             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1875                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1876                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1877             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1878                                            PIC X(10).
  1879         16  CF-BUS-TYP-CNTL-OPT.
  1880             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1881                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1882                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1883             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1884                                            PIC XX.
  1885         16  CF-LF-TYP-CNTL-OPT.
  1886             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1887                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1888                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1889             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1890                                            PIC XX.
  1891         16  CF-AH-TYP-CNTL-OPT.
  1892             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1893                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1894                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1895             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1896                                            PIC XX.
  1897         16  CF-REPTCD1-CNTL-OPT.
  1898             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1899                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1900                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1901             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1902                                            PIC X(10).
  1903         16  CF-REPTCD2-CNTL-OPT.
  1904             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1905                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1906                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1907             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1908                                            PIC X(10).
  1909         16  CF-USER1-CNTL-OPT.
  1910             20  CF-USER1-OPT-SEQ           PIC 9.
  1911                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1912                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1913             20  CF-USER1-SELECT OCCURS 3 TIMES
  1914                                            PIC X(10).
  1915         16  CF-USER2-CNTL-OPT.
  1916             20  CF-USER2-OPT-SEQ           PIC 9.
  1917                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1918                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1919             20  CF-USER2-SELECT OCCURS 3 TIMES
  1920                                            PIC X(10).
  1921         16  CF-USER3-CNTL-OPT.
  1922             20  CF-USER3-OPT-SEQ           PIC 9.
  1923                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1924                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1925             20  CF-USER3-SELECT OCCURS 3 TIMES
  1926                                            PIC X(10).
  1927         16  CF-USER4-CNTL-OPT.
  1928             20  CF-USER4-OPT-SEQ           PIC 9.
  1929                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1930                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  35
* SOCK03.cbl
  1931             20  CF-USER4-SELECT OCCURS 3 TIMES
  1932                                            PIC X(10).
  1933         16  CF-USER5-CNTL-OPT.
  1934             20  CF-USER5-OPT-SEQ           PIC 9.
  1935                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1936                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1937             20  CF-USER5-SELECT OCCURS 3 TIMES
  1938                                            PIC X(10).
  1939         16  CF-REINS-CNTL-OPT.
  1940             20  CF-REINS-OPT-SEQ           PIC 9.
  1941                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1942                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1943             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1944                 24  CF-REINS-PRIME         PIC XXX.
  1945                 24  CF-REINS-SUB           PIC XXX.
  1946
  1947         16  CF-AGENT-CNTL-OPT.
  1948             20  CF-AGENT-OPT-SEQ           PIC 9.
  1949                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1950                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1951             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1952                                            PIC X(10).
  1953
  1954         16  FILLER                         PIC X(43).
  1955
  1956         16  CF-LOSS-RATIO-SELECT.
  1957             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1958             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1959         16  CF-ENTRY-DATE-SELECT.
  1960             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1961             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1962         16  CF-EFFECTIVE-DATE-SELECT.
  1963             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1964             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1965
  1966         16  CF-EXCEPTION-LIST-IND          PIC X.
  1967             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1968
  1969         16  FILLER                         PIC X(318).
  1970
  1971****************************************************************
  1972*                  EXCEPTION REPORTING RECORD                  *
  1973****************************************************************
  1974
  1975     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1976         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1977             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1978
  1979         16  CF-COMBINED-LIFE-AH-OPT.
  1980             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1981             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1982             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1983             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1984
  1985         16  CF-LIFE-OPT.
  1986             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1987             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1988             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  36
* SOCK03.cbl
  1989             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1990             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1991             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1992             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1993             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1994             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1995             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1996
  1997         16  CF-AH-OPT.
  1998             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1999             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2000             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2001             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2002             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2003             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2004             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2005             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2006             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2007             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2008
  2009         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2010             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2011             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2012             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2013
  2014         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2015
  2016         16  FILLER                         PIC X(673).
  2017
  2018
  2019****************************************************************
  2020*             MORTGAGE SYSTEM PLAN RECORD                      *
  2021****************************************************************
  2022
  2023     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2024         16  CF-PLAN-TYPE                   PIC X.
  2025             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2026             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2027             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2028         16  CF-PLAN-ABBREV                 PIC XXX.
  2029         16  CF-PLAN-DESCRIPT               PIC X(10).
  2030         16  CF-PLAN-NOTES                  PIC X(20).
  2031         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2032         16  CF-PLAN-UNDERWRITING.
  2033             20  CF-PLAN-TERM-DATA.
  2034                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2035                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2036             20  CF-PLAN-AGE-DATA.
  2037                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2038                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2039                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2040             20  CF-PLAN-BENEFIT-DATA.
  2041                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2042                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2043                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2044                                            PIC S9(7)V99  COMP-3.
  2045         16  CF-PLAN-POLICY-FORMS.
  2046             20  CF-POLICY-FORM             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  37
* SOCK03.cbl
  2047             20  CF-MASTER-APPLICATION      PIC X(12).
  2048             20  CF-MASTER-POLICY           PIC X(12).
  2049         16  CF-PLAN-RATING.
  2050             20  CF-RATE-CODE               PIC X(5).
  2051             20  CF-SEX-RATING              PIC X.
  2052                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2053                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2054             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2055             20  CF-SUB-STD-TYPE            PIC X.
  2056                 88  CF-PCT-OF-PREM            VALUE '1'.
  2057                 88  CF-PCT-OF-BENE            VALUE '2'.
  2058         16  CF-PLAN-PREM-TOLERANCES.
  2059             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2060             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2061         16  CF-PLAN-PYMT-TOLERANCES.
  2062             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2063             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2064         16  CF-PLAN-MISC-DATA.
  2065             20  FILLER                     PIC X.
  2066             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2067             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2068         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2069         16  CF-PLAN-IND-GRP                PIC X.
  2070             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2071                                                     '1'.
  2072             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2073                                                     '2'.
  2074         16  CF-MIB-SEARCH-SW               PIC X.
  2075             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2076             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2077             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2078             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2079         16  CF-ALPHA-SEARCH-SW             PIC X.
  2080             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2081             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2082             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2083             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2084             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2085             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2086             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2087             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2088             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2089             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2090                                                     'A' 'B' 'C'
  2091                                                     'X' 'Y' 'Z'.
  2092         16  CF-EFF-DT-RULE-SW              PIC X.
  2093             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2094             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2095             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2096             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2097             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2098         16  FILLER                         PIC X(4).
  2099         16  CF-HEALTH-QUESTIONS            PIC X.
  2100             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2101         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2102         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2103         16  CF-PLAN-SNGL-JNT               PIC X.
  2104             88  CF-COMBINED-PLAN              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  38
* SOCK03.cbl
  2105             88  CF-JNT-PLAN                   VALUE 'J'.
  2106             88  CF-SNGL-PLAN                  VALUE 'S'.
  2107         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2108         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2109         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2110         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2111         16  CF-RERATE-CNTL                 PIC  X.
  2112             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2113             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2114             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2115             88  CF-AUTO-RECALC                 VALUE '4'.
  2116         16  CF-BENEFIT-TYPE                PIC  X.
  2117             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2118             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2119         16  CF-POLICY-FEE                  PIC S999V99
  2120                                                    COMP-3.
  2121         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2122         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2123         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2124         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2125         16  FILLER                         PIC  X(32).
  2126         16  CF-TERMINATION-FORM            PIC  X(04).
  2127         16  FILLER                         PIC  X(08).
  2128         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2129                                                       COMP-3.
  2130         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2131         16  CF-ISSUE-LETTER                PIC  X(4).
  2132         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2133         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2134             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2135             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2136         16  CF-MP-REFUND-CALC              PIC X.
  2137             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2138             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2139             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2140             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2141             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2142             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2143             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2144             88  CF-MP-REFD-MEAN                VALUE '8'.
  2145         16  CF-ALT-RATE-CODE               PIC  X(5).
  2146
  2147
  2148         16  FILLER                         PIC X(498).
  2149****************************************************************
  2150*             MORTGAGE COMPANY MASTER RECORD                   *
  2151****************************************************************
  2152
  2153     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2154         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2155         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2156             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2157             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2158             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2159             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2160             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2161
  2162         16  CF-MORTG-CONVERSION-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  39
* SOCK03.cbl
  2163         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2164         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2165         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2166         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2167
  2168         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2169             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2170         16  CF-MP-RECON-USE-IND            PIC X(1).
  2171             88  CF-MP-USE-RECON             VALUE 'Y'.
  2172         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2173             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2174         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2175             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2176             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2177         16  FILLER                         PIC X(1).
  2178         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2179             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2180         16  CF-MORTG-MIB-VERSION           PIC X.
  2181             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2182             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2183             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2184         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2185             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2186                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2187             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2188                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2189             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2190                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2191             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2192                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2193             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2194                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2195             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2196                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2197         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2198         16  FILLER                         PIC X(7).
  2199         16  CF-MORTG-DESTINATION-SYMBOL.
  2200             20  CF-MORTG-MIB-COMM          PIC X(5).
  2201             20  CF-MORTG-MIB-TERM          PIC X(5).
  2202         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2203             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2204         16  FILLER                         PIC X(03).
  2205         16  CF-MP-CHECK-NO-CONTROL.
  2206             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2207                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2208                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2209                                                ' ' LOW-VALUES.
  2210                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2211                                               VALUE '3'.
  2212         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2213         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2214         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2215             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2216                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2217             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2218                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2219             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2220                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  40
* SOCK03.cbl
  2221             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2222                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2223             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2224                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2225             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2226                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2227         16  CF-MORTG-BILLING-AREA.
  2228             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2229                                            PIC X.
  2230         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2231         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2232         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2233         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2234             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2235             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2236         16  FILLER                         PIC X.
  2237         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2238             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2239             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2240         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2241         16  FILLER                         PIC X(8).
  2242         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2243         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2244         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2245         16  CF-ACH-COMPANY-ID.
  2246             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2247                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2248                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2249                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2250             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2251         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2252             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2253         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2254             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2255             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2256         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2257         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2258         16  FILLER                         PIC X(536).
  2259
  2260****************************************************************
  2261*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2262****************************************************************
  2263
  2264     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2265         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2266             20  CF-FEMALE-HEIGHT.
  2267                 24  CF-FEMALE-FT           PIC 99.
  2268                 24  CF-FEMALE-IN           PIC 99.
  2269             20  CF-FEMALE-MIN-WT           PIC 999.
  2270             20  CF-FEMALE-MAX-WT           PIC 999.
  2271         16  FILLER                         PIC X(428).
  2272
  2273     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2274         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2275             20  CF-MALE-HEIGHT.
  2276                 24  CF-MALE-FT             PIC 99.
  2277                 24  CF-MALE-IN             PIC 99.
  2278             20  CF-MALE-MIN-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  41
* SOCK03.cbl
  2279             20  CF-MALE-MAX-WT             PIC 999.
  2280         16  FILLER                         PIC X(428).
  2281******************************************************************
  2282*             AUTOMATIC ACTIVITY RECORD                          *
  2283******************************************************************
  2284     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2285         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2286             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2287             20  CF-SYS-LETTER-ID           PIC X(04).
  2288             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2289             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2290             20  CF-SYS-RESET-SW            PIC X(01).
  2291             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2292             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2293
  2294         16  FILLER                         PIC X(50).
  2295
  2296         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2297             20  CF-USER-ACTIVE-SW          PIC X(01).
  2298             20  CF-USER-LETTER-ID          PIC X(04).
  2299             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2300             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2301             20  CF-USER-RESET-SW           PIC X(01).
  2302             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2303             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2304             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2305
  2306         16  FILLER                         PIC X(246).
  2307*                                 COPY ERCACCT.
  2308******************************************************************
  2309*                                                                *
  2310*                                                                *
  2311*                            ERCACCT                             *
  2312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2313*                            VMOD=2.031                          *
  2314*                                                                *
  2315*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2316*                                                                *
  2317*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2318*   VSAM ACCOUNT MASTER FILES.                                   *
  2319*                                                                *
  2320*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2321*                                                                *
  2322*   FILE TYPE = VSAM,KSDS                                        *
  2323*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2324*                                                                *
  2325*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2326*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2327*                                                                *
  2328*   LOG = NO                                                     *
  2329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2330*                                                                *
  2331*                                                                *
  2332******************************************************************
  2333*                   C H A N G E   L O G
  2334*
  2335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2336*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  42
* SOCK03.cbl
  2337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2338* EFFECTIVE    NUMBER
  2339*-----------------------------------------------------------------
  2340* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2341* 092705    2005050300006  PEMA  ADD SPP LEASES
  2342* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2343* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2344* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2345******************************************************************
  2346
  2347 01  ACCOUNT-MASTER.
  2348     12  AM-RECORD-ID                      PIC XX.
  2349         88  VALID-AM-ID                      VALUE 'AM'.
  2350
  2351     12  AM-CONTROL-PRIMARY.
  2352         16  AM-COMPANY-CD                 PIC X.
  2353         16  AM-MSTR-CNTRL.
  2354             20  AM-CONTROL-A.
  2355                 24  AM-CARRIER            PIC X.
  2356                 24  AM-GROUPING.
  2357                     28 AM-GROUPING-PREFIX PIC XXX.
  2358                     28 AM-GROUPING-PRIME  PIC XXX.
  2359                 24  AM-STATE              PIC XX.
  2360                 24  AM-ACCOUNT.
  2361                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2362                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2363             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2364                                           PIC X(19).
  2365             20  AM-CNTRL-B.
  2366                 24  AM-EXPIRATION-DT      PIC XX.
  2367                 24  FILLER                PIC X(4).
  2368             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2369                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2370
  2371     12  AM-CONTROL-BY-VAR-GRP.
  2372         16  AM-COMPANY-CD-A1              PIC X.
  2373         16  AM-VG-CARRIER                 PIC X.
  2374         16  AM-VG-GROUPING                PIC X(6).
  2375         16  AM-VG-STATE                   PIC XX.
  2376         16  AM-VG-ACCOUNT                 PIC X(10).
  2377         16  AM-VG-DATE.
  2378             20  AM-VG-EXPIRATION-DT       PIC XX.
  2379             20  FILLER                    PIC X(4).
  2380         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2381                                           PIC 9(11)      COMP-3.
  2382     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2383         16  FILLER                        PIC X(10).
  2384         16  AM-VG-KEY3.
  2385             20  AM-VG3-ACCOUNT            PIC X(10).
  2386             20  AM-VG3-EXP-DT             PIC XX.
  2387         16  FILLER                        PIC X(4).
  2388     12  AM-MAINT-INFORMATION.
  2389         16  AM-LAST-MAINT-DT              PIC XX.
  2390         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2391         16  AM-LAST-MAINT-USER            PIC X(4).
  2392         16  FILLER                        PIC XX.
  2393
  2394     12  AM-EFFECTIVE-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  43
* SOCK03.cbl
  2395     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2396
  2397     12  AM-PREV-DATES  COMP-3.
  2398         16  AM-PREV-EXP-DT                PIC 9(11).
  2399         16  AM-PREV-EFF-DT                PIC 9(11).
  2400
  2401     12  AM-REPORT-CODE-1                  PIC X(10).
  2402     12  AM-REPORT-CODE-2                  PIC X(10).
  2403
  2404     12  AM-CITY-CODE                      PIC X(4).
  2405     12  AM-COUNTY-PARISH                  PIC X(6).
  2406
  2407     12  AM-NAME                           PIC X(30).
  2408     12  AM-PERSON                         PIC X(30).
  2409     12  AM-ADDRS                          PIC X(30).
  2410     12  AM-CITY.
  2411         16  AM-ADDR-CITY                  PIC X(28).
  2412         16  AM-ADDR-STATE                 PIC XX.
  2413     12  AM-ZIP.
  2414         16  AM-ZIP-PRIME.
  2415             20  AM-ZIP-PRI-1ST            PIC X.
  2416                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2417             20  FILLER                    PIC X(4).
  2418         16  AM-ZIP-PLUS4                  PIC X(4).
  2419     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2420         16  AM-CAN-POSTAL-1               PIC XXX.
  2421         16  AM-CAN-POSTAL-2               PIC XXX.
  2422         16  FILLER                        PIC XXX.
  2423     12  AM-TEL-NO.
  2424         16  AM-AREA-CODE                  PIC 999.
  2425         16  AM-TEL-PRE                    PIC 999.
  2426         16  AM-TEL-NBR                    PIC 9(4).
  2427     12  AM-TEL-LOC                        PIC X.
  2428         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2429         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2430
  2431     12  AM-COMM-STRUCTURE.
  2432         16  AM-DEFN-1.
  2433             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2434                 24  AM-AGT.
  2435                     28  AM-AGT-PREFIX     PIC X(4).
  2436                     28  AM-AGT-PRIME      PIC X(6).
  2437                 24  AM-COM-TYP            PIC X.
  2438                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2439                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2440                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2441                 24  AM-RECALC-LV-INDIC    PIC X.
  2442                 24  AM-RETRO-LV-INDIC     PIC X.
  2443                 24  AM-GL-CODES           PIC X.
  2444                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2445                 24  FILLER                PIC X(01).
  2446         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2447             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2448                 24  FILLER                PIC X(11).
  2449                 24  AM-L-COMA             PIC XXX.
  2450                 24  AM-J-COMA             PIC XXX.
  2451                 24  AM-A-COMA             PIC XXX.
  2452                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  44
* SOCK03.cbl
  2453
  2454     12  AM-COMM-CHANGE-STATUS             PIC X.
  2455         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2456
  2457     12  AM-CSR-CODE                       PIC X(4).
  2458
  2459     12  AM-BILLING-STATUS                 PIC X.
  2460         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2461         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2462     12  AM-AUTO-REFUND-SW                 PIC X.
  2463         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2464         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2465     12  AM-GPCD                           PIC 99.
  2466     12  AM-IG                             PIC X.
  2467         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2468         88  AM-HAS-GROUP                     VALUE '2'.
  2469     12  AM-STATUS                         PIC X.
  2470         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2471         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2472         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2473         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2474         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2475     12  AM-REMIT-TO                       PIC 99.
  2476     12  AM-ID-NO                          PIC X(11).
  2477
  2478     12  AM-CAL-TABLE                      PIC XX.
  2479     12  AM-LF-DEVIATION                   PIC XXX.
  2480     12  AM-AH-DEVIATION                   PIC XXX.
  2481     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2482     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2483     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2484     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2485     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2486     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2487
  2488     12  AM-USER-FIELDS.
  2489         16  AM-FLD-1                      PIC XX.
  2490         16  AM-FLD-2                      PIC XX.
  2491         16  AM-FLD-3                      PIC XX.
  2492         16  AM-FLD-4                      PIC XX.
  2493         16  AM-FLD-5                      PIC XX.
  2494
  2495     12  AM-1ST-PROD-DATE.
  2496         16  AM-1ST-PROD-YR                PIC XX.
  2497         16  AM-1ST-PROD-MO                PIC XX.
  2498         16  AM-1ST-PROD-DA                PIC XX.
  2499     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2500     12  AM-CERTS-PURGED-DATE.
  2501         16  AM-PUR-YR                     PIC XX.
  2502         16  AM-PUR-MO                     PIC XX.
  2503         16  AM-PUR-DA                     PIC XX.
  2504     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2505     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2506     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2507     12  AM-INACTIVE-DATE.
  2508         16  AM-INA-MO                     PIC 99.
  2509         16  AM-INA-DA                     PIC 99.
  2510         16  AM-INA-YR                     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  45
* SOCK03.cbl
  2511     12  AM-AR-HI-CERT-DATE                PIC XX.
  2512
  2513     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2514     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2515
  2516     12  AM-OB-PAYMENT-MODE                PIC X.
  2517         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2518         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2519         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2520         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2521
  2522     12  AM-AH-ONLY-INDICATOR              PIC X.
  2523         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2524         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2525
  2526     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2527
  2528     12  AM-OVER-SHORT.
  2529         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2530         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2531
  2532     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2533     12  AM-DCC-CLP-STATE                  PIC XX.
  2534
  2535     12  AM-RECALC-COMM                    PIC X.
  2536     12  AM-RECALC-REIN                    PIC X.
  2537
  2538     12  AM-REI-TABLE                      PIC XXX.
  2539     12  AM-REI-ET-LF                      PIC X.
  2540     12  AM-REI-ET-AH                      PIC X.
  2541     12  AM-REI-PE-LF                      PIC X.
  2542     12  AM-REI-PE-AH                      PIC X.
  2543     12  AM-REI-PRT-ST                     PIC X.
  2544     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2545     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2546     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2547     12  AM-REI-GROUP-A                    PIC X(6).
  2548     12  AM-REI-MORT                       PIC X(4).
  2549     12  AM-REI-PRT-OW                     PIC X.
  2550     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2551     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2552     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2553     12  AM-REI-GROUP-B                    PIC X(6).
  2554
  2555     12  AM-TRUST-TYPE                     PIC X(2).
  2556
  2557     12  AM-EMPLOYER-STMT-USED             PIC X.
  2558     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2559
  2560     12  AM-STD-AH-TYPE                    PIC XX.
  2561     12  AM-EARN-METHODS.
  2562         16  AM-EARN-METHOD-R              PIC X.
  2563             88 AM-REF-RL-R78                 VALUE 'R'.
  2564             88 AM-REF-RL-PR                  VALUE 'P'.
  2565             88 AM-REF-RL-MEAN                VALUE 'M'.
  2566             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2567         16  AM-EARN-METHOD-L              PIC X.
  2568             88 AM-REF-LL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  46
* SOCK03.cbl
  2569             88 AM-REF-LL-PR                  VALUE 'P'.
  2570             88 AM-REF-LL-MEAN                VALUE 'M'.
  2571             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2572         16  AM-EARN-METHOD-A              PIC X.
  2573             88 AM-REF-AH-R78                 VALUE 'R'.
  2574             88 AM-REF-AH-PR                  VALUE 'P'.
  2575             88 AM-REF-AH-MEAN                VALUE 'M'.
  2576             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2577             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2578             88 AM-REF-AH-NET                 VALUE 'N'.
  2579
  2580     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2581     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2582     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2583
  2584     12  AM-RET-Y-N                        PIC X.
  2585     12  AM-RET-P-E                        PIC X.
  2586     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2587     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2588     12  AM-RET-GRP                        PIC X(6).
  2589     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2590         16  AM-POOL-PRIME                 PIC XXX.
  2591         16  AM-POOL-SUB                   PIC XXX.
  2592     12  AM-RETRO-EARNINGS.
  2593         16  AM-RET-EARN-R                 PIC X.
  2594         16  AM-RET-EARN-L                 PIC X.
  2595         16  AM-RET-EARN-A                 PIC X.
  2596     12  AM-RET-ST-TAX-USE                 PIC X.
  2597         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2598         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2599     12  AM-RETRO-BEG-EARNINGS.
  2600         16  AM-RET-BEG-EARN-R             PIC X.
  2601         16  AM-RET-BEG-EARN-L             PIC X.
  2602         16  AM-RET-BEG-EARN-A             PIC X.
  2603     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2604     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2605
  2606     12  AM-USER-SELECT-OPTIONS.
  2607         16  AM-USER-SELECT-1              PIC X(10).
  2608         16  AM-USER-SELECT-2              PIC X(10).
  2609         16  AM-USER-SELECT-3              PIC X(10).
  2610         16  AM-USER-SELECT-4              PIC X(10).
  2611         16  AM-USER-SELECT-5              PIC X(10).
  2612
  2613     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2614
  2615     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2616
  2617     12  AM-RPT045A-SWITCH                 PIC X.
  2618         88  RPT045A-OFF                   VALUE 'N'.
  2619
  2620     12  AM-INSURANCE-LIMITS.
  2621         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2622         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2623
  2624     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2625         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2626
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  47
* SOCK03.cbl
  2627     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2628         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2629         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2630
  2631     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2632
  2633     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2634     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2635     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2636     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2637     12  FILLER                            PIC X(5).
  2638     12  AM-REPORT-CODE-3                  PIC X(10).
  2639*    12  FILLER                            PIC X(22).
  2640
  2641     12  AM-RESERVE-DATE.
  2642         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2643         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2644         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2645
  2646     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2647     12  AM-NOTIFICATION-TYPES.
  2648         16  AM-NOTIF-OF-LETTERS           PIC X.
  2649         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2650         16  AM-NOTIF-OF-REPORTS           PIC X.
  2651         16  AM-NOTIF-OF-STATUS            PIC X.
  2652
  2653     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2654         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2655         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2656         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2657         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2658
  2659     12  AM-BENEFIT-CONTROLS.
  2660         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2661             20  AM-BENEFIT-CODE           PIC XX.
  2662             20  AM-BENEFIT-TYPE           PIC X.
  2663             20  AM-BENEFIT-REVISION       PIC XXX.
  2664             20  AM-BENEFIT-REM-TERM       PIC X.
  2665             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2666             20  FILLER                    PIC XX.
  2667         16  FILLER                        PIC X(80).
  2668
  2669     12  AM-TRANSFER-DATA.
  2670         16  AM-TRANSFERRED-FROM.
  2671             20  AM-TRNFROM-CARRIER        PIC X.
  2672             20  AM-TRNFROM-GROUPING.
  2673                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2674                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2675             20  AM-TRNFROM-STATE          PIC XX.
  2676             20  AM-TRNFROM-ACCOUNT.
  2677                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2678                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2679             20  AM-TRNFROM-DTE            PIC XX.
  2680         16  AM-TRANSFERRED-TO.
  2681             20  AM-TRNTO-CARRIER          PIC X.
  2682             20  AM-TRNTO-GROUPING.
  2683                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2684                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  48
* SOCK03.cbl
  2685             20  AM-TRNTO-STATE            PIC XX.
  2686             20  AM-TRNTO-ACCOUNT.
  2687                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2688                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2689             20  AM-TRNTO-DTE              PIC XX.
  2690         16  FILLER                        PIC X(10).
  2691
  2692     12  AM-SAVED-REMIT-TO                 PIC 99.
  2693
  2694     12  AM-COMM-STRUCTURE-SAVED.
  2695         16  AM-DEFN-1-SAVED.
  2696             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2697                 24  AM-AGT-SV             PIC X(10).
  2698                 24  AM-COM-TYP-SV         PIC X.
  2699                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2700                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2701                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2702                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2703                 24  FILLER                PIC X.
  2704                 24  AM-GL-CODES-SV        PIC X.
  2705                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2706                 24  FILLER                PIC X.
  2707         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2708             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2709                 24  FILLER                PIC X(11).
  2710                 24  AM-L-COMA-SV          PIC XXX.
  2711                 24  AM-J-COMA-SV          PIC XXX.
  2712                 24  AM-A-COMA-SV          PIC XXX.
  2713                 24  FILLER                PIC X(6).
  2714
  2715     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2716         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2717            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2718            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2719            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2720
  2721     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2722     12  FILLER                            PIC X(120).
  2723
  2724     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2725         16  AM-CONTROL-NAME               PIC X(30).
  2726         16  AM-EXECUTIVE-ONE.
  2727             20  AM-EXEC1-NAME             PIC X(15).
  2728             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2729                                                          COMP-3.
  2730             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2731                                                          COMP-3.
  2732         16  AM-EXECUTIVE-TWO.
  2733             20  AM-EXEC2-NAME             PIC X(15).
  2734             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2735                                                          COMP-3.
  2736             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2737                                                          COMP-3.
  2738
  2739     12  AM-RETRO-ADDITIONAL-DATA.
  2740         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2741         16  AM-RETRO-PREM-P-E             PIC X.
  2742         16  AM-RETRO-CLMS-P-I             PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  49
* SOCK03.cbl
  2743         16  AM-RETRO-RET-BRACKET-LF.
  2744             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2745                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2746                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2747             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2748                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2749                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2750             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2751                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2752                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2753         16  AM-RETRO-RET-BRACKET-AH.
  2754             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2755                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2756                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2757                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2758             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2759                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2760                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2761             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2762                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2763                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2764
  2765     12  AM-COMMENTS.
  2766         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2767
  2768     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2769         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2770         16  AM-FLI-BILLING-CODE           PIC X.
  2771         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2772         16  AM-FLI-UNITED-IDENT           PIC X.
  2773         16  AM-FLI-INTEREST-LOST-DATA.
  2774             20  AM-FLI-BANK-NO            PIC X(5).
  2775             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2776             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2777             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2778         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2779             20  AM-FLI-AGT                PIC X(9).
  2780             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2781             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2782         16  FILLER                        PIC X(102).
  2783
  2784     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2785         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2786             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2787             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2788             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2789             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2790             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2791         16  FILLER                          PIC X(10).
  2792******************************************************************
  2793*                                 COPY ELCDATE.
  2794******************************************************************
  2795*                                                                *
  2796*                                                                *
  2797*                            ELCDATE.                            *
  2798*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2799*                            VMOD=2.003
  2800*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  50
* SOCK03.cbl
  2801*                                                                *
  2802*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2803*                 LENGTH = 200                                   *
  2804******************************************************************
  2805
  2806 01  DATE-CONVERSION-DATA.
  2807     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2808     12  DC-OPTION-CODE                PIC X.
  2809         88  BIN-TO-GREG                VALUE ' '.
  2810         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2811         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2812         88  YMD-GREG-TO-BIN            VALUE '3'.
  2813         88  MDY-GREG-TO-BIN            VALUE '4'.
  2814         88  JULIAN-TO-BIN              VALUE '5'.
  2815         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2816         88  FIND-CENTURY               VALUE '7'.
  2817         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2818         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2819         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2820         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2821         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2822         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2823         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2824         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2825         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2826         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2827         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2828         88  BIN-3-TO-GREG              VALUE 'I'.
  2829         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2830         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2831         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2832         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2833         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2834         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2835         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2836         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2837         88  THREE-CHARACTER-BIN
  2838                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2839         88  GREGORIAN-TO-BIN
  2840                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2841         88  BIN-TO-GREGORIAN
  2842                  VALUES ' ' '1' 'I' '8' 'G'.
  2843         88  JULIAN-TO-BINARY
  2844                  VALUES '5' 'C' 'E' 'F'.
  2845     12  DC-ERROR-CODE                 PIC X.
  2846         88  NO-CONVERSION-ERROR        VALUE ' '.
  2847         88  DATE-CONVERSION-ERROR
  2848                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2849         88  DATE-IS-ZERO               VALUE '1'.
  2850         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2851         88  DATE-IS-INVALID            VALUE '3'.
  2852         88  DATE1-GREATER-DATE2        VALUE '4'.
  2853         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2854         88  DATE-INVALID-OPTION        VALUE '9'.
  2855         88  INVALID-CENTURY            VALUE 'A'.
  2856         88  ONLY-CENTURY               VALUE 'B'.
  2857         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2858         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  51
* SOCK03.cbl
  2859     12  DC-END-OF-MONTH               PIC X.
  2860         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2861     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2862         88  USE-NORMAL-PROCESS         VALUE ' '.
  2863         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2864         88  ADJUST-UP-100-YRS          VALUE '2'.
  2865     12  FILLER                        PIC X.
  2866     12  DC-CONVERSION-DATES.
  2867         16  DC-BIN-DATE-1             PIC XX.
  2868         16  DC-BIN-DATE-2             PIC XX.
  2869         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2870         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2871                       DC-GREG-DATE-1-EDIT.
  2872             20  DC-EDIT1-MONTH        PIC 99.
  2873             20  SLASH1-1              PIC X.
  2874             20  DC-EDIT1-DAY          PIC 99.
  2875             20  SLASH1-2              PIC X.
  2876             20  DC-EDIT1-YEAR         PIC 99.
  2877         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2878         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2879                     DC-GREG-DATE-2-EDIT.
  2880             20  DC-EDIT2-MONTH        PIC 99.
  2881             20  SLASH2-1              PIC X.
  2882             20  DC-EDIT2-DAY          PIC 99.
  2883             20  SLASH2-2              PIC X.
  2884             20  DC-EDIT2-YEAR         PIC 99.
  2885         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2886         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2887                     DC-GREG-DATE-1-YMD.
  2888             20  DC-YMD-YEAR           PIC 99.
  2889             20  DC-YMD-MONTH          PIC 99.
  2890             20  DC-YMD-DAY            PIC 99.
  2891         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2892         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2893                      DC-GREG-DATE-1-MDY.
  2894             20  DC-MDY-MONTH          PIC 99.
  2895             20  DC-MDY-DAY            PIC 99.
  2896             20  DC-MDY-YEAR           PIC 99.
  2897         16  DC-GREG-DATE-1-ALPHA.
  2898             20  DC-ALPHA-MONTH        PIC X(10).
  2899             20  DC-ALPHA-DAY          PIC 99.
  2900             20  FILLER                PIC XX.
  2901             20  DC-ALPHA-CENTURY.
  2902                 24 DC-ALPHA-CEN-N     PIC 99.
  2903             20  DC-ALPHA-YEAR         PIC 99.
  2904         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2905         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2906         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2907         16  DC-JULIAN-DATE            PIC 9(05).
  2908         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2909                                       PIC 9(05).
  2910         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2911             20  DC-JULIAN-YEAR        PIC 99.
  2912             20  DC-JULIAN-DAYS        PIC 999.
  2913         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2914         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2915         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2916     12  DATE-CONVERSION-VARIBLES.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  52
* SOCK03.cbl
  2917         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2918         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2919             20  FILLER                PIC 9(3).
  2920             20  HOLD-CEN-1-CCYY.
  2921                 24  HOLD-CEN-1-CC     PIC 99.
  2922                 24  HOLD-CEN-1-YY     PIC 99.
  2923             20  HOLD-CEN-1-MO         PIC 99.
  2924             20  HOLD-CEN-1-DA         PIC 99.
  2925         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2926             20  HOLD-CEN-1-R-MO       PIC 99.
  2927             20  HOLD-CEN-1-R-DA       PIC 99.
  2928             20  HOLD-CEN-1-R-CCYY.
  2929                 24  HOLD-CEN-1-R-CC   PIC 99.
  2930                 24  HOLD-CEN-1-R-YY   PIC 99.
  2931             20  FILLER                PIC 9(3).
  2932         16  HOLD-CENTURY-1-X.
  2933             20  FILLER                PIC X(3)  VALUE SPACES.
  2934             20  HOLD-CEN-1-X-CCYY.
  2935                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2936                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2937             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2938             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2939         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2940             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2941             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2942             20  HOLD-CEN-1-R-X-CCYY.
  2943                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2944                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2945             20  FILLER                PIC XXX.
  2946         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2947         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2948         16  DC-JULIAN-DATE-1          PIC 9(07).
  2949         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2950             20  DC-JULIAN-1-CCYY.
  2951                 24  DC-JULIAN-1-CC    PIC 99.
  2952                 24  DC-JULIAN-1-YR    PIC 99.
  2953             20  DC-JULIAN-DA-1        PIC 999.
  2954         16  DC-JULIAN-DATE-2          PIC 9(07).
  2955         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2956             20  DC-JULIAN-2-CCYY.
  2957                 24  DC-JULIAN-2-CC    PIC 99.
  2958                 24  DC-JULIAN-2-YR    PIC 99.
  2959             20  DC-JULIAN-DA-2        PIC 999.
  2960         16  DC-GREG-DATE-A-EDIT.
  2961             20  DC-EDITA-MONTH        PIC 99.
  2962             20  SLASHA-1              PIC X VALUE '/'.
  2963             20  DC-EDITA-DAY          PIC 99.
  2964             20  SLASHA-2              PIC X VALUE '/'.
  2965             20  DC-EDITA-CCYY.
  2966                 24  DC-EDITA-CENT     PIC 99.
  2967                 24  DC-EDITA-YEAR     PIC 99.
  2968         16  DC-GREG-DATE-B-EDIT.
  2969             20  DC-EDITB-MONTH        PIC 99.
  2970             20  SLASHB-1              PIC X VALUE '/'.
  2971             20  DC-EDITB-DAY          PIC 99.
  2972             20  SLASHB-2              PIC X VALUE '/'.
  2973             20  DC-EDITB-CCYY.
  2974                 24  DC-EDITB-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  53
* SOCK03.cbl
  2975                 24  DC-EDITB-YEAR     PIC 99.
  2976         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2977         16  DC-GREG-DATE-CYMD-R REDEFINES
  2978                              DC-GREG-DATE-CYMD.
  2979             20  DC-CYMD-CEN           PIC 99.
  2980             20  DC-CYMD-YEAR          PIC 99.
  2981             20  DC-CYMD-MONTH         PIC 99.
  2982             20  DC-CYMD-DAY           PIC 99.
  2983         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2984         16  DC-GREG-DATE-MDCY-R REDEFINES
  2985                              DC-GREG-DATE-MDCY.
  2986             20  DC-MDCY-MONTH         PIC 99.
  2987             20  DC-MDCY-DAY           PIC 99.
  2988             20  DC-MDCY-CEN           PIC 99.
  2989             20  DC-MDCY-YEAR          PIC 99.
  2990    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2991        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2992    12  DC-EL310-DATE                  PIC X(21).
  2993    12  FILLER                         PIC X(28).
  2994*                                 COPY ELCCALC.
  2995******************************************************************
  2996*                                                                *
  2997*                           ELCCALC.                            *
  2998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2999*                            VMOD=2.025                          *
  3000*                                                                *
  3001*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3002*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3003*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3004*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3005*                                                                *
  3006*  PASSED TO ELRTRM                                              *
  3007*  -----------------                                             *
  3008*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3009*  ORIGINAL TERM                                                 *
  3010*  BEGINNING DATE                                                *
  3011*  ENDING DATE                                                   *
  3012*  COMPANY I.D.                                                  *
  3013*  ACCOUNT MASTER USER FIELD                                     *
  3014*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3015*  FREE LOOK DAYS                                                *
  3016*                                                                *
  3017*  RETURNED FROM ELRTRM                                          *
  3018*  ---------------------                                         *
  3019*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3020*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3021*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3022*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3023*----------------------------------------------------------------*
  3024*  PASSED TO ELRAMT                                              *
  3025*  ----------------                                              *
  3026*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3027*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3028*  ORIGINAL AMOUNT                                               *
  3029*  ALTERNATE BENEFIT (BALLON)                                    *
  3030*  A.P.R. - NET PAY ONLY                                         *
  3031*  METHOD
  3032*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  54
* SOCK03.cbl
  3033*  COMPANY I.D.                                                  *
  3034*  BENEFIT TYPE                                                  *
  3035*                                                                *
  3036*  RETURNED FROM ELRAMT                                          *
  3037*  --------------------                                          *
  3038*  REMAINING AMOUNT 1 - CURRENT                                  *
  3039*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3040*  REMAINING AMOUNT FACTOR
  3041*----------------------------------------------------------------*
  3042*  PASSED TO ELRESV                                              *
  3043*  -----------------                                             *
  3044*  CERTIFICATE EFFECTIVE DATE                                    *
  3045*  VALUATION DATE                                                *
  3046*  PAID THRU DATE                                                *
  3047*  BENEFIT                                                       *
  3048*  INCURRED DATE                                                 *
  3049*  REPORTED DATE                                                 *
  3050*  ISSUE AGE                                                     *
  3051*  TERM                                                          *
  3052*  CDT PERCENT                                                   *
  3053*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3054* *CLAIM TYPE (LIFE, A/H)                                        *
  3055* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3056* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3057*                                                                *
  3058*  RETURNED FROM ELRESV                                          *
  3059*  --------------------                                          *
  3060*  CDT TABLE USED                                                *
  3061*  CDT FACTOR USED                                               *
  3062*  PAY TO CURRENT RESERVE                                        *
  3063*  I.B.N.R. - A/H ONLY                                           *
  3064*  FUTURE (ACCRUED) AH ONLY                                      *
  3065*----------------------------------------------------------------*
  3066*  PASSED TO ELRATE                                              *
  3067*  ----------------                                              *
  3068*  CERT ISSUE DATE                                               *
  3069*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3070*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3071*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3072*  STATE CODE (CLIENT DEFINED)                                   *
  3073*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3074*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3075*  DEVIATION CODE                                                *
  3076*  ISSUE AGE                                                     *
  3077*  ORIGINAL BENEFIT AMOUNT                                       *
  3078*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3079*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3080*  BENEFIT KIND (LIFE OR A/H)                                    *
  3081*  A.P.R.                                                        *
  3082*  METHOD
  3083*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3084*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3085*  COMPANY I.D. (3 CHARACTER)                                    *
  3086*  BENEFIT CODE                                                  *
  3087*  BENEFIT OVERRIDE CODE                                         *
  3088*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3089*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3090*  JOINT INDICATOR (CSL ONLY)                                    *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  55
* SOCK03.cbl
  3091*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3092*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3093*                                                                *
  3094*  RETURNED FROM ELRATE                                          *
  3095*  --------------------                                          *
  3096*  CALCULATED PREMIUM                                            *
  3097*  PREMIUM RATE                                                  *
  3098*  MORTALITY CODE                                                *
  3099*  MAX ATTAINED AGE                                              *
  3100*  MAX AGE                                                       *
  3101*  MAX TERM                                                      *
  3102*  MAX MONTHLY BENEFIT                                           *
  3103*  MAX TOTAL BENIFIT                                             *
  3104*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3105*----------------------------------------------------------------*
  3106*  PASSED TO ELRFND                                              *
  3107*  ----------------                                              *
  3108*  CERT ISSUE DATE                                               *
  3109*  REFUND DATE                                                   *
  3110*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3111*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3112*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3113*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3114*  STATE CODE (CLIENT DEFINED)                                   *
  3115*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3116*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3117*  DEVIATION CODE                                                *
  3118*  ISSUE AGE                                                     *
  3119*  ORIGINAL BENEFIT AMOUNT                                       *
  3120*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3121*  PROCESS TYPE (CANCEL)                                         *
  3122*  BENEFIT KIND (LIFE OR A/H)                                    *
  3123*  A.P.R.                                                        *
  3124*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3125*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3126*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3127*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3128*  COMPANY I.D. (3 CHARACTER)                                    *
  3129*  BENEFIT CODE                                                  *
  3130*  BENEFIT OVERRIDE CODE                                         *
  3131*                                                                *
  3132*  RETURNED FROM ELRFND                                          *
  3133*  --------------------                                          *
  3134*  CALCULATED REFUND                                             *
  3135*----------------------------------------------------------------*
  3136*  PASSED TO ELEARN                                              *
  3137*  ----------------                                              *
  3138*  CERT ISSUE DATE                                               *
  3139*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3140*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3141*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3142*  STATE CODE (CLIENT DEFINED)                                   *
  3143*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3144*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3145*  DEVIATION CODE                                                *
  3146*  ISSUE AGE                                                     *
  3147*  ORIGINAL BENEFIT AMOUNT                                       *
  3148*  BENEFIT KIND (LIFE OR A/H)                                    *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  56
* SOCK03.cbl
  3149*  A.P.R.                                                        *
  3150*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3151*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3152*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3153*  COMPANY I.D. (3 CHARACTER)                                    *
  3154*  BENEFIT CODE                                                  *
  3155*  BENEFIT OVERRIDE CODE                                         *
  3156*                                                                *
  3157*  RETURNED FROM ELEARN                                          *
  3158*  --------------------                                          *
  3159*  INDICATED  EARNINGS                                           *
  3160*----------------------------------------------------------------*
  3161*                 LENGTH = 450                                   *
  3162*                                                                *
  3163******************************************************************
  3164******************************************************************
  3165*                   C H A N G E   L O G
  3166*
  3167* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3168*-----------------------------------------------------------------
  3169*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3170* EFFECTIVE    NUMBER
  3171*-----------------------------------------------------------------
  3172* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3173* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3174* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3175* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3176* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3177* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3178* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3179******************************************************************
  3180
  3181 01  CALCULATION-PASS-AREA.
  3182     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3183                                     COMP.
  3184
  3185     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3186       88  NO-CP-ERROR                             VALUE ZERO.
  3187       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3188                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3189       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3190       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3191       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3192       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3193       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3194       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3195       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3196       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3197       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3198       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3199       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3200       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3201       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3202       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3203       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3204       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3205       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3206
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  57
* SOCK03.cbl
  3207     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3208       88  NO-CP-ERROR-2                           VALUE ZERO.
  3209***********************  INPUT AREAS ****************************
  3210
  3211     12  CP-CALCULATION-AREA.
  3212         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3213         16  CP-CERT-EFF-DT        PIC XX.
  3214         16  CP-VALUATION-DT       PIC XX.
  3215         16  CP-PAID-THRU-DT       PIC XX.
  3216         16  CP-BENEFIT-TYPE       PIC X.
  3217           88  CP-AH                               VALUE 'A' 'D'
  3218                                                   'I' 'U'.
  3219           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3220           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3221         16  CP-INCURRED-DT        PIC XX.
  3222         16  CP-REPORTED-DT        PIC XX.
  3223         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3224         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3225         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3226                                     COMP-3.
  3227         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3228                                     COMP-3.
  3229         16  CP-CDT-METHOD         PIC X.
  3230           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3231           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3232           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3233         16  CP-CLAIM-TYPE         PIC X.
  3234           88  CP-AH-CLAIM                         VALUE 'A'.
  3235           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3236         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3237                                     COMP-3.
  3238         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3239                                     COMP-3.
  3240         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3241                                     COMP-3.
  3242         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3243                                     COMP-3.
  3244         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3245                                     COMP-3.
  3246         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3247                                     COMP-3.
  3248         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3249                                     COMP-3.
  3250         16  CP-REM-TERM-METHOD    PIC X.
  3251           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3252           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3253           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3254           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3255           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3256           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3257           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3258         16  CP-EARNING-METHOD     PIC X.
  3259           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3260           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3261           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3262           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3263           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3264           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  58
* SOCK03.cbl
  3265           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3266           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3267           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3268           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3269           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3270           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3271         16  CP-PROCESS-TYPE       PIC X.
  3272           88  CP-CLAIM                            VALUE '1'.
  3273           88  CP-CANCEL                           VALUE '2'.
  3274           88  CP-ISSUE                            VALUE '3'.
  3275         16  CP-SPECIAL-CALC-CD    PIC X.
  3276           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3277           88  CP-1-MTH-INTEREST               VALUE ' '.
  3278           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3279           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3280           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3281           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3282           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3283           88  CP-FARM-PLAN                    VALUE 'F'.
  3284           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3285           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3286           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3287           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3288           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3289           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3290           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3291           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3292           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3293           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3294                                                     'W' 'X'.
  3295           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3296           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3297           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3298           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3299           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3300           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3301           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3302           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3303           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3304           88  CP-CSL-METH-1                   VALUE '5'.
  3305           88  CP-CSL-METH-2                   VALUE '6'.
  3306           88  CP-CSL-METH-3                   VALUE '7'.
  3307           88  CP-CSL-METH-4                   VALUE '8'.
  3308
  3309         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3310                                     COMP-3.
  3311         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3312         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3313         16  CP-STATE              PIC XX          VALUE SPACE.
  3314         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3315         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3316           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3317               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3318         16  CP-R78-OPTION         PIC X.
  3319           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3320           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3321
  3322         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  59
* SOCK03.cbl
  3323         16  CP-IBNR-RESERVE-SW    PIC X.
  3324         16  CP-CLAIM-STATUS       PIC X.
  3325         16  CP-RATE-FILE          PIC X.
  3326         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3327                                     COMP-3.
  3328
  3329         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3330         16  CP-AH-OVERRIDE-CODE   PIC X.
  3331
  3332         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3335                                     COMP-3.
  3336         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3339                                     COMP-3.
  3340
  3341         16  CP-PAID-FROM-DATE     PIC X(02).
  3342         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3343         16  CP-EXT-DAYS-CALC      PIC X.
  3344           88  CP-EXT-NO-CHG                   VALUE ' '.
  3345           88  CP-EXT-CHG-LF                   VALUE '1'.
  3346           88  CP-EXT-CHG-AH                   VALUE '2'.
  3347           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3348         16  CP-DOMICILE-STATE     PIC XX.
  3349         16  CP-CARRIER            PIC X.
  3350         16  CP-REIN-FLAG          PIC X.
  3351         16  CP-REM-TRM-CALC-OPTION PIC X.
  3352           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3353                      '2' '3' '4' '5'.
  3354           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3355           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3356           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3357           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3358           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3359           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3360           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3361           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3362         16  CP-SIG-SWITCH         PIC X.
  3363         16  CP-RATING-METHOD      PIC X.
  3364           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3365           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3366           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3367           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3368           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3369           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3370           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3371           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3372           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3373         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3374                                     COMP-3.
  3375         16  CP-BEN-CATEGORY       PIC X.
  3376         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3377         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3378                                   PIC S99V9(5) COMP-3.
  3379         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3380         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  60
* SOCK03.cbl
  3381                                   PIC S99V9(5) COMP-3.
  3382         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3383         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3384         16  CP-EXPIRE-DT          PIC XX.
  3385         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3386         16  FILLER                PIC X(35).
  3387*        16  FILLER                PIC X(50).
  3388
  3389***************    OUTPUT FROM ELRESV   ************************
  3390
  3391         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3392
  3393         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3394                                     COMP-3.
  3395         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3396                                     COMP-3.
  3397         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3398                                     COMP-3.
  3399         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3400                                     COMP-3.
  3401         16  FILLER                PIC X(09).
  3402***************    OUTPUT FROM ELRTRM   *************************
  3403
  3404         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3405                                     COMP-3.
  3406         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3407                                     COMP-3.
  3408         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3409                                     COMP-3.
  3410         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3411                                     COMP-3.
  3412         16  FILLER                PIC X(12).
  3413
  3414***************    OUTPUT FROM ELRAMT   *************************
  3415
  3416         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3417                                     COMP-3.
  3418         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3419                                     COMP-3.
  3420         16  FILLER                PIC X(12).
  3421
  3422***************    OUTPUT FROM ELRATE   *************************
  3423
  3424         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3425                                     COMP-3.
  3426         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3427                                     COMP-3.
  3428         16  CP-MORTALITY-CODE     PIC X(4).
  3429         16  CP-RATE-EDIT-FLAG     PIC X.
  3430             88  CP-RATES-NEED-APR                  VALUE '1'.
  3431         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3432                                     COMP-3.
  3433         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3434         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3435         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3436                                   PIC S9(7)V99 COMP-3.
  3437         16  FILLER                PIC X(07).
  3438
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  61
* SOCK03.cbl
  3439***************    OUTPUT FROM ELRFND   *************************
  3440
  3441         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3442                                     COMP-3.
  3443         16  CP-REFUND-TYPE-USED   PIC X.
  3444           88  CP-R-AS-R78                         VALUE '1'.
  3445           88  CP-R-AS-PRORATA                     VALUE '2'.
  3446           88  CP-R-AS-CALIF                       VALUE '3'.
  3447           88  CP-R-AS-TEXAS                       VALUE '4'.
  3448           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3449           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3450           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3451           88  CP-R-AS-MEAN                        VALUE '8'.
  3452           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3453           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3454           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3455         16  FILLER                PIC X(12).
  3456
  3457***************    OUTPUT FROM ELEARN   *************************
  3458
  3459         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3460                                     COMP-3.
  3461         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3462                                     COMP-3.
  3463         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3464                                     COMP-3.
  3465         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3466                                     COMP-3.
  3467         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3468                                     COMP-3.
  3469         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3470                                     COMP-3.
  3471         16  CP-EARNING-TYPE-USED  PIC X.
  3472           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3473           88  CP-E-AS-R78                         VALUE '1'.
  3474           88  CP-E-AS-PRORATA                     VALUE '2'.
  3475           88  CP-E-AS-TEXAS                       VALUE '4'.
  3476           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3477           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3478           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3479           88  CP-E-AS-MEAN                        VALUE '8'.
  3480           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3481         16  FILLER                PIC X(12).
  3482
  3483***************    OUTPUT FROM ELPMNT   *************************
  3484
  3485         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3488                                     COMP-3.
  3489         16  FILLER                PIC X(12).
  3490
  3491***************   MISC WORK AREAS    *****************************
  3492         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3493                                     COMP-3.
  3494         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3495                                     COMP-3.
  3496         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  62
* SOCK03.cbl
  3497                                     COMP-3.
  3498         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3499                                     COMP-3.
  3500         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3501                                     COMP-3.
  3502         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3503                                     COMP-3.
  3504         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3505             88  OPEN-RATE-FILE                   VALUE 'O'.
  3506             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3507             88  IO-ERROR                         VALUE 'E'.
  3508
  3509         16  CP-FIRST-PAY-DATE     PIC XX.
  3510
  3511         16  CP-JOINT-INDICATOR    PIC X.
  3512
  3513         16  CP-RESERVE-REMAINING-TERM
  3514                                   PIC S9(4)V9    VALUE ZERO
  3515                                     COMP-3.
  3516
  3517         16  CP-INSURED-BIRTH-DT   PIC XX.
  3518
  3519         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3520                                     COMP-3.
  3521
  3522         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3523                                     COMP-3.
  3524
  3525         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3526                                     COMP-3.
  3527
  3528         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3529                                     COMP-3.
  3530
  3531         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3532                                     COMP-3.
  3533
  3534         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3535                                     COMP-3.
  3536
  3537         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3538                                     COMP-3.
  3539
  3540         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3541             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3542
  3543         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3546                                     COMP-3.
  3547         16  FILLER                PIC X(17).
  3548******************************************************************
  3549****************************************************************
  3550*
  3551* Copyright (c) 2007 by Clerity Solutions, Inc.
  3552* All rights reserved.
  3553*
  3554****************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  63
* SOCK03.cbl
  3555 01  DFHEIV.
  3556   02  DFHEIV0               PIC X(35).
  3557   02  DFHEIV1               PIC X(08).
  3558   02  DFHEIV2               PIC X(08).
  3559   02  DFHEIV3               PIC X(08).
  3560   02  DFHEIV4               PIC X(06).
  3561   02  DFHEIV5               PIC X(04).
  3562   02  DFHEIV6               PIC X(04).
  3563   02  DFHEIV7               PIC X(02).
  3564   02  DFHEIV8               PIC X(02).
  3565   02  DFHEIV9               PIC X(01).
  3566   02  DFHEIV10              PIC S9(7) COMP-3.
  3567   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3568   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3569   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3570   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3571   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3572   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3573   02  DFHEIV17              PIC X(04).
  3574   02  DFHEIV18              PIC X(04).
  3575   02  DFHEIV19              PIC X(04).
  3576   02  DFHEIV20              USAGE IS POINTER.
  3577   02  DFHEIV21              USAGE IS POINTER.
  3578   02  DFHEIV22              USAGE IS POINTER.
  3579   02  DFHEIV23              USAGE IS POINTER.
  3580   02  DFHEIV24              USAGE IS POINTER.
  3581   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3582   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3583   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3584   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3585   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3586   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3587   02  FILLER                PIC X(02).
  3588   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3589   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3590   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3591   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3592   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3593 LINKAGE  SECTION.
  3594*****************************************************************
  3595*                                                               *
  3596* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3597* All rights reserved.                                          *
  3598*                                                               *
  3599*****************************************************************
  3600 01  dfheiblk.
  3601     02  eibtime          pic s9(7) comp-3.
  3602     02  eibdate          pic s9(7) comp-3.
  3603     02  eibtrnid         pic x(4).
  3604     02  eibtaskn         pic s9(7) comp-3.
  3605     02  eibtrmid         pic x(4).
  3606     02  dfheigdi         pic s9(4) comp.
  3607     02  eibcposn         pic s9(4) comp.
  3608     02  eibcalen         pic s9(4) comp.
  3609     02  eibaid           pic x(1).
  3610     02  eibfiller1       pic x(1).
  3611     02  eibfn            pic x(2).
  3612     02  eibfiller2       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  64
* SOCK03.cbl
  3613     02  eibrcode         pic x(6).
  3614     02  eibfiller3       pic x(2).
  3615     02  eibds            pic x(8).
  3616     02  eibreqid         pic x(8).
  3617     02  eibrsrce         pic x(8).
  3618     02  eibsync          pic x(1).
  3619     02  eibfree          pic x(1).
  3620     02  eibrecv          pic x(1).
  3621     02  eibsend          pic x(1).
  3622     02  eibatt           pic x(1).
  3623     02  eibeoc           pic x(1).
  3624     02  eibfmh           pic x(1).
  3625     02  eibcompl         pic x(1).
  3626     02  eibsig           pic x(1).
  3627     02  eibconf          pic x(1).
  3628     02  eiberr           pic x(1).
  3629     02  eibrldbk         pic x(1).
  3630     02  eiberrcd         pic x(4).
  3631     02  eibsynrb         pic x(1).
  3632     02  eibnodat         pic x(1).
  3633     02  eibfiller5       pic x(2).
  3634     02  eibresp          pic 9(09) comp.
  3635     02  eibresp2         pic 9(09) comp.
  3636     02  dfheigdj         pic s9(4) comp.
  3637     02  dfheigdk         pic s9(4) comp.
  3638 01  DFHCOMMAREA.
  3639   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3640   05 LSTN-NAME                PIC X(8).
  3641   05 LSTN-SUBNAME             PIC X(8).
  3642   05 CLIENT-IN-DATA.
  3643      15  CLIENT-CAR           PIC X.
  3644      15  CLIENT-GRP           PIC X(6).
  3645      15  CLIENT-STATE         PIC XX.
  3646      15  CLIENT-ACCOUNT       PIC X(10).
  3647*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3648      15  CLIENT-EFF-DT        PIC X(8).
  3649      15  CLIENT-CERT-NO       PIC X(11).
  3650      15  CLIENT-LAST-NAME     PIC X(15).
  3651      15  CLIENT-FIRST-NAME    PIC X(10).
  3652      15  CLIENT-VAL-DT        PIC X(8).
  3653   05 SOCKADDR-IN-PARM.
  3654     15 SIN-FAMILY             PIC 9(4) COMP.
  3655     15 SIN-PORT               PIC 9(4) COMP.
  3656     15 SIN-ADDRESS            PIC 9(8) COMP.
  3657     15 SIN-ZERO               PIC X(8).
  3658 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3659 0000-DFHEXIT SECTION.
  3660     MOVE '9#                    $   ' TO DFHEIV0.
  3661     MOVE 'SOCK03' TO DFHEIV1.
  3662     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3663     display '  BEGIN SOCK03 '
  3664     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3665     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3666     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3667        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3668        IF CLIENT-IN-DATA (8:3) = 'DCC'
  3669           MOVE X'05'            TO WS-COMP-CD
  3670           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  65
* SOCK03.cbl
  3671                                    WS-COMP-ID
  3672        ELSE
  3673           MOVE X'04'            TO WS-COMP-CD
  3674           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3675                                    WS-COMP-ID
  3676        END-IF
  3677        move 'CSO'               to ws-send-buf (1:3)
  3678        move +25                 to ws-send-msg-size
  3679     END-IF
  3680     display 'SOCK03:sequence number  =', ws-seq-num.
  3681     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3682     call "send" using by value GIVE-TAKE-SOCKET,
  3683         by reference ws-send-buf,
  3684         by value ws-send-msg-size,
  3685         by value ws-flags.
  3686     if return-code <= zero
  3687         display 'SOCK03:send error ',
  3688         go to socket-error.
  3689     move low-values to ws-recv-buf.
  3690     set ws-recv-total to zero.
  3691     compute ws-recv-left = ws-recv-msg-size.
  3692     display 'SOCK03:About to recv '
  3693     call "recv" using by value GIVE-TAKE-SOCKET,
  3694         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3695         by value ws-recv-left,
  3696         by value ws-flags.
  3697     if return-code < zero
  3698        display 'SOCK03:recv error ',
  3699        go to socket-error.
  3700     if return-code = zero
  3701        display 'SOCK03:client disconnected',
  3702        go to socket-error.
  3703*
  3704     display 'SOCK03:Good recv  '
  3705     display 'SOCK03:return code      = ', return-code
  3706     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3707     move +4096                  to ws-send-msg-size
  3708*    move +750                   to ws-send-msg-size
  3709     move ws-recv-buf (1:71)     to client-in-data
  3710     MOVE SPACES                 TO WS-ELCERT-SW
  3711     MOVE X'0A'                  TO WS-HEX-0A
  3712     EVALUATE TRUE
  3713        WHEN (CLIENT-CAR NOT = SPACES)
  3714           AND (CLIENT-STATE NOT = SPACES)
  3715           AND (CLIENT-ACCOUNT NOT = SPACES)
  3716           AND (CLIENT-EFF-DT NOT = SPACES)
  3717           AND (CLIENT-CERT-NO NOT = SPACES)
  3718           SET WS-ELCERT-FULL    TO TRUE
  3719           DISPLAY ' SETTING FULL '
  3720        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3721           SET WS-ELCERT-CERT-NO TO TRUE
  3722           DISPLAY ' SETTING CERT NO '
  3723*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3724*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3725        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3726           AND (CLIENT-LAST-NAME NOT = SPACES)
  3727           SET WS-ELCERT-ACT-NAME TO TRUE
  3728        WHEN CLIENT-LAST-NAME NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  66
* SOCK03.cbl
  3729           SET WS-ELCERT-NAME    TO TRUE
  3730           DISPLAY ' SETTING NAME '
  3731        WHEN OTHER
  3732           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  3733           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  3734           MOVE ZEROS            TO WS-RESP
  3735           PERFORM 0030-BUILD-BUFFER
  3736                                 THRU 0030-EXIT
  3737           PERFORM 0020-SEND-BUFFER
  3738                                 THRU 0020-EXIT
  3739           PERFORM 0025-CLOSE-SOCKET
  3740                                 THRU 0025-EXIT
  3741           GO TO 0010-RETURN
  3742     END-EVALUATE
  3743     IF WS-ELCERT-KEY-SW NOT = SPACES
  3744        PERFORM 0050-BEGIN-REFUND-PROCESS
  3745                                 THRU 0050-EXIT
  3746     END-IF
  3747     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  3748     .
  3749 0010-RETURN.
  3750
  3751* exec cics return end-exec.
  3752*    MOVE '.(                    &   #00003746' TO DFHEIV0
  3753     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3755     MOVE X'2020233030303033373436' TO DFHEIV0(25:11)
  3756     CALL 'kxdfhei1' USING DFHEIV0,
  3757           DFHEIV99,
  3758           DFHEIV99,
  3759           DFHEIV99,
  3760           DFHEIV99,
  3761           DFHEIV99
  3762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3763
  3764
  3765* goback.
  3766     MOVE '9%                    "   ' TO DFHEIV0
  3767     MOVE 'SOCK03' TO DFHEIV1
  3768     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3769     goback.
  3770*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3771     .
  3772 0020-SEND-BUFFER.
  3773     display 'SOCK03:About to send      '
  3774     display 'SOCK03:sequence number  =', ws-seq-num.
  3775     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  3776     call "send" using by value GIVE-TAKE-SOCKET,
  3777         by reference ws-send-buf,
  3778         by value ws-send-msg-size,
  3779         by value ws-flags.
  3780     if return-code <= zero
  3781         display 'SOCK03:send error ' return-code,
  3782         go to socket-error.
  3783 0020-EXIT.
  3784     EXIT.
  3785 0025-CLOSE-SOCKET.
  3786     display 'SOCK03:closing socket'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  67
* SOCK03.cbl
  3787     call "close" using by value GIVE-TAKE-SOCKET .
  3788     display 'SOCK03:done'.
  3789     .
  3790 0025-EXIT.
  3791     EXIT.
  3792*
  3793* set up the receive buffer
  3794*
  3795     move low-values to ws-recv-buf.
  3796     set ws-recv-total to zero.
  3797     compute ws-recv-left = ws-recv-msg-size.
  3798*
  3799* receive data
  3800*
  3801 recv-1.
  3802     call "recv" using by value GIVE-TAKE-SOCKET,
  3803         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3804         by value ws-recv-left,
  3805         by value ws-flags.
  3806*
  3807* test what was received and decide what we should do
  3808*
  3809     if return-code < zero
  3810        display 'SOCK03:recv error ',
  3811        go to socket-error.
  3812     if return-code = zero
  3813        display 'SOCK03:client disconnected',
  3814        go to socket-error.
  3815*
  3816* have we received all the data yet?
  3817*
  3818     compute ws-recv-total = ws-recv-total + return-code.
  3819     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3820*
  3821* not yet
  3822*
  3823     if ws-recv-left > 0 go to recv-1.
  3824*
  3825* received all the data
  3826*
  3827     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  3828*
  3829* make sure what we received was what we sent
  3830*
  3831*    if ws-recv-buf <> ws-send-buf
  3832*        display "SOCK03:data doesn't match",
  3833*        go to socket-error.
  3834*
  3835* end of pass
  3836*
  3837*loop-end.
  3838*    if ws-seq-num = 5 go to socket-error.
  3839*    go to loop-1.
  3840*
  3841* program end
  3842*
  3843 socket-error.
  3844     if ws-seq-num <> 0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  68
* SOCK03.cbl
  3845         display "SOCK03:did not complete".
  3846*
  3847* flush the send buffer and deallocate
  3848*
  3849*    display 'SOCK03:closing socket'.
  3850*    call "close" using by value GIVE-TAKE-SOCKET .
  3851*
  3852* finised return to cics
  3853*
  3854 socket-fin.
  3855     display 'SOCK03:closing socket'.
  3856     call "close" using by value GIVE-TAKE-SOCKET .
  3857     display 'SOCK03:done'.
  3858
  3859* exec cics return end-exec.
  3860*    MOVE '.(                    &   #00003836' TO DFHEIV0
  3861     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3863     MOVE X'2020233030303033383336' TO DFHEIV0(25:11)
  3864     CALL 'kxdfhei1' USING DFHEIV0,
  3865           DFHEIV99,
  3866           DFHEIV99,
  3867           DFHEIV99,
  3868           DFHEIV99,
  3869           DFHEIV99
  3870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3871
  3872
  3873* goback.
  3874     MOVE '9%                    "   ' TO DFHEIV0
  3875     MOVE 'SOCK03' TO DFHEIV1
  3876     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3877     goback.
  3878 0030-BUILD-BUFFER.
  3879     MOVE SPACES                 TO WS-SEND-BUF
  3880     IF WS-CALL-TYPE = 'NEWBUS'
  3881        STRING
  3882           WS-COMMENT            ';'
  3883           WS-RESP               ';'
  3884           WS-CARRIER            ';'
  3885           WS-GROUPING           ';'
  3886           WS-STATE              ';'
  3887           WS-ACCOUNT            ';'
  3888           WS-CERT-EFF-DATE      ';'
  3889           WS-CERT-NO            ';'
  3890           WS-LAST-NAME          ';'
  3891           WS-FIRST-NAME         ';'
  3892           WS-MID-INIT           ';'
  3893           WS-LAST-JNAME         ';'
  3894           WS-FIRST-JNAME        ';'
  3895           WS-MID-JINIT          ';'
  3896           WS-POST-CARD-SW       ';'
  3897           WS-LF-STATUS          ';'
  3898           WS-LF-BEN-CODE        ';'
  3899           WS-LF-BEN-CODE-DESC   ';'
  3900           WS-LF-TERM            ';'
  3901           WS-LF-REM-TERM        ';'
  3902           WS-LF-PREM            ';'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  69
* SOCK03.cbl
  3903           WS-LF-REFUND          ';'
  3904           WS-LF-METHOD          ';'
  3905           WS-LF-ORIG-BENEFIT    ';'
  3906           WS-LF-REM-BEN         ';'
  3907           WS-LF-EXPIRE-DATE     ';'
  3908           WS-LF-COMM            ';'
  3909           WS-LF-UEC             ';'
  3910           WS-AH-STATUS          ';'
  3911           WS-AH-BEN-CODE        ';'
  3912           WS-AH-BEN-CODE-DESC   ';'
  3913           WS-AH-TERM            ';'
  3914           WS-AH-REM-TERM        ';'
  3915           WS-AH-PREM            ';'
  3916           WS-AH-REFUND          ';'
  3917           WS-AH-METHOD          ';'
  3918           WS-AH-ORIG-BENEFIT    ';'
  3919           WS-AH-REM-BEN         ';'
  3920           WS-AH-EXPIRE-DATE     ';'
  3921           WS-AH-COMM            ';'
  3922           WS-AH-UEC             ';'
  3923           WS-ACCOUNT-NAME       ';'
  3924           WS-REPORT-CODE-1      ';'
  3925           WS-REPORT-CODE-2      ';'
  3926           WS-REPORT-CODE-3      ';'
  3927           WS-CLM-PAID-THRU-DT   ';'
  3928           WS-HEX-0A
  3929            DELIMITED BY '  ' INTO WS-SEND-BUF
  3930        END-STRING
  3931     ELSE
  3932        STRING
  3933           WS-COMMENT            ';'
  3934           WS-RESP               ';'
  3935           WS-CARRIER            ';'
  3936           WS-GROUPING           ';'
  3937           WS-STATE              ';'
  3938           WS-ACCOUNT            ';'
  3939           WS-CERT-EFF-DATE      ';'
  3940           WS-CERT-NO            ';'
  3941           WS-LAST-NAME          ';'
  3942           WS-FIRST-NAME         ';'
  3943           WS-MID-INIT           ';'
  3944           WS-LAST-JNAME         ';'
  3945           WS-FIRST-JNAME        ';'
  3946           WS-MID-JINIT          ';'
  3947           WS-POST-CARD-SW       ';'
  3948           WS-LF-STATUS          ';'
  3949           WS-LF-BEN-CODE        ';'
  3950           WS-LF-BEN-CODE-DESC   ';'
  3951           WS-LF-TERM            ';'
  3952           WS-LF-REM-TERM        ';'
  3953           WS-LF-PREM            ';'
  3954           WS-LF-REFUND          ';'
  3955           WS-LF-METHOD          ';'
  3956           WS-LF-ORIG-BENEFIT    ';'
  3957           WS-LF-REM-BEN         ';'
  3958           WS-LF-EXPIRE-DATE     ';'
  3959           WS-LF-COMM            ';'
  3960           WS-LF-UEC             ';'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  70
* SOCK03.cbl
  3961           WS-AH-STATUS          ';'
  3962           WS-AH-BEN-CODE        ';'
  3963           WS-AH-BEN-CODE-DESC   ';'
  3964           WS-AH-TERM            ';'
  3965           WS-AH-REM-TERM        ';'
  3966           WS-AH-PREM            ';'
  3967           WS-AH-REFUND          ';'
  3968           WS-AH-METHOD          ';'
  3969           WS-AH-ORIG-BENEFIT    ';'
  3970           WS-AH-REM-BEN         ';'
  3971           WS-AH-EXPIRE-DATE     ';'
  3972           WS-AH-COMM            ';'
  3973           WS-AH-UEC             ';'
  3974           WS-ACCOUNT-NAME       ';'
  3975           WS-REPORT-CODE-1      ';'
  3976           WS-REPORT-CODE-2      ';'
  3977           WS-REPORT-CODE-3      ';'
  3978           WS-CLM-PAID-THRU-DT   ';'
  3979           'E'                   ';'
  3980            DELIMITED BY '  ' INTO WS-SEND-BUF
  3981        END-STRING
  3982     END-IF
  3983     .
  3984 0030-EXIT.
  3985     EXIT.
  3986 0050-BEGIN-REFUND-PROCESS.
  3987     IF WS-ELCERT-ACT-NAME
  3988        PERFORM 0060-FIND-FULL-KEY
  3989                                 THRU 0060-EXIT
  3990        MOVE AM-CARRIER          TO CLIENT-CAR
  3991        MOVE AM-GROUPING         TO CLIENT-GRP
  3992        MOVE AM-STATE            TO CLIENT-STATE
  3993     END-IF
  3994     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  3995     IF NOT RESP-NORMAL
  3996        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  3997        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  3998        MOVE WS-RESPONSE         TO WS-RESP
  3999        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4000        PERFORM 0020-SEND-BUFFER
  4001                                 THRU 0020-EXIT
  4002        PERFORM 0025-CLOSE-SOCKET
  4003                                 THRU 0025-EXIT
  4004        GO TO 0010-RETURN
  4005     END-IF
  4006     PERFORM 0150-READ-NEXT-ELCERT
  4007                                 THRU 0150-EXIT
  4008*    display ' came back from 0150 ' ws-response
  4009     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4010        DISPLAY ' CERT NOT FOUND '
  4011        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4012        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4013        MOVE WS-RESPONSE         TO WS-RESP
  4014        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4015        PERFORM 0020-SEND-BUFFER
  4016                                 THRU 0020-EXIT
  4017        PERFORM 0025-CLOSE-SOCKET
  4018                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  71
* SOCK03.cbl
  4019        GO TO 0010-RETURN
  4020     END-IF
  4021     PERFORM 0200-BEGIN-REFUND-PROCESS
  4022                                 THRU 0200-EXIT UNTIL
  4023        ELCERT-FINISHED
  4024     .
  4025 0050-EXIT.
  4026     EXIT.
  4027 0060-FIND-FULL-KEY.
  4028     MOVE ' ' TO WS-STOP-SW
  4029     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4030     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4031
  4032* EXEC CICS STARTBR
  4033*       DATASET  ('ERACCT3')
  4034*       RIDFLD   (WS-AM3-KEY)
  4035*       GTEQ
  4036*       RESP (WS-RESPONSE)
  4037*    END-EXEC
  4038     MOVE 'ERACCT3' TO DFHEIV1
  4039     MOVE 0
  4040       TO DFHEIV11
  4041*    MOVE '&,         G          &  N#00003991' TO DFHEIV0
  4042     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4043     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4044     MOVE X'204E233030303033393931' TO DFHEIV0(25:11)
  4045     CALL 'kxdfhei1' USING DFHEIV0,
  4046           DFHEIV1,
  4047           WS-AM3-KEY,
  4048           DFHEIV99,
  4049           DFHEIV11,
  4050           DFHEIV99
  4051     MOVE EIBRESP  TO WS-RESPONSE
  4052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4053     IF RESP-NORMAL
  4054        PERFORM UNTIL TOLD-TO-STOP
  4055
  4056* EXEC CICS READNEXT
  4057*             DATASET  ('ERACCT3')
  4058*             INTO     (ACCOUNT-MASTER)
  4059*             RIDFLD   (WS-AM3-KEY)
  4060*          END-EXEC
  4061     MOVE LENGTH OF
  4062      ACCOUNT-MASTER
  4063       TO DFHEIV12
  4064     MOVE 'ERACCT3' TO DFHEIV1
  4065     MOVE 0
  4066       TO DFHEIV11
  4067*    MOVE '&.IL                  )   #00003999' TO DFHEIV0
  4068     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4069     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4070     MOVE X'2020233030303033393939' TO DFHEIV0(25:11)
  4071     CALL 'kxdfhei1' USING DFHEIV0,
  4072           DFHEIV1,
  4073           ACCOUNT-MASTER,
  4074           DFHEIV12,
  4075           WS-AM3-KEY,
  4076           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  72
* SOCK03.cbl
  4077           DFHEIV11,
  4078           DFHEIV99,
  4079           DFHEIV99
  4080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4081           EVALUATE TRUE
  4082              WHEN (RESP-NORMAL)
  4083                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4084                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4085                 SET TOLD-TO-STOP TO TRUE
  4086              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4087                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4088                 CONTINUE
  4089              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4090                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4091                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4092                 MOVE ZEROS      TO WS-RESP
  4093                 PERFORM 0030-BUILD-BUFFER
  4094                                 THRU 0030-EXIT
  4095                 PERFORM 0020-SEND-BUFFER
  4096                                 THRU 0020-EXIT
  4097                 PERFORM 0025-CLOSE-SOCKET
  4098                                 THRU 0025-EXIT
  4099                 GO TO 0010-RETURN
  4100           END-EVALUATE
  4101        END-PERFORM
  4102
  4103* EXEC CICS ENDBR
  4104*          DATASET   ('ERACCT3')
  4105*       END-EXEC
  4106     MOVE 'ERACCT3' TO DFHEIV1
  4107     MOVE 0
  4108       TO DFHEIV11
  4109*    MOVE '&2                    $   #00004025' TO DFHEIV0
  4110     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4111     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4112     MOVE X'2020233030303034303235' TO DFHEIV0(25:11)
  4113     CALL 'kxdfhei1' USING DFHEIV0,
  4114           DFHEIV1,
  4115           DFHEIV11,
  4116           DFHEIV99
  4117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4118     ELSE
  4119        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4120        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4121        MOVE ZEROS      TO WS-RESP
  4122        PERFORM 0030-BUILD-BUFFER
  4123                                 THRU 0030-EXIT
  4124        PERFORM 0020-SEND-BUFFER
  4125                                 THRU 0020-EXIT
  4126        PERFORM 0025-CLOSE-SOCKET
  4127                                 THRU 0025-EXIT
  4128        GO TO 0010-RETURN
  4129     END-IF
  4130     .
  4131 0060-EXIT.
  4132     EXIT.
  4133 0100-START-ELCERT.
  4134*    DISPLAY ' MADE 0100 START '
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  73
* SOCK03.cbl
  4135     MOVE SPACES                 TO WS-SEND-BUF
  4136     INITIALIZE WS-STRING-DATA
  4137     MOVE LOW-VALUES             TO WS-CM-KEY
  4138                                    WS-CM-KEY-A1
  4139                                    WS-CM-KEY-A4
  4140     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4141                                    WS-CM-COMPANY-CD-A1
  4142                                    WS-CM-COMPANY-CD-A4
  4143     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4144     MOVE 'L'                    TO DC-OPTION-CODE
  4145     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4146     IF NO-CONVERSION-ERROR
  4147        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4148     ELSE
  4149        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4150        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4151        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4152        PERFORM 0020-SEND-BUFFER
  4153                                 THRU 0020-EXIT
  4154        PERFORM 0025-CLOSE-SOCKET
  4155                                 THRU 0025-EXIT
  4156        GO TO 0010-RETURN
  4157     END-IF
  4158     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4159        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4160        MOVE 'L'                 TO DC-OPTION-CODE
  4161        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4162        IF NO-CONVERSION-ERROR
  4163           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4164        ELSE
  4165           MOVE 'BAD EFF DT CONVERT '
  4166                                 TO WS-COMMENT
  4167           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4168           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4169           PERFORM 0020-SEND-BUFFER
  4170                                 THRU 0020-EXIT
  4171           PERFORM 0025-CLOSE-SOCKET
  4172                                 THRU 0025-EXIT
  4173           GO TO 0010-RETURN
  4174        END-IF
  4175     END-IF
  4176     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4177        (F1 > +10)
  4178        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4179     END-PERFORM
  4180     IF F1 > +1
  4181        SUBTRACT +1 FROM F1
  4182     END-IF
  4183     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4184        (L1 > +15)
  4185        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4186     END-PERFORM
  4187     IF L1 > +1
  4188        SUBTRACT +1 FROM L1
  4189     END-IF
  4190     EVALUATE TRUE
  4191        WHEN WS-ELCERT-FULL
  4192           MOVE CLIENT-CAR          TO WS-CM-CARRIER
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  74
* SOCK03.cbl
  4193           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4194           MOVE CLIENT-STATE        TO WS-CM-STATE
  4195           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4196           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4197           MOVE CLIENT-CERT-NO (1:10)
  4198                                    TO WS-CM-CERT-NO
  4199
  4200* EXEC CICS READ
  4201*             INTO    (CERTIFICATE-MASTER)
  4202*             DATASET ('ELCERT')
  4203*             RIDFLD  (WS-CM-KEY)
  4204*             RESP    (WS-RESPONSE)
  4205*          END-EXEC
  4206     MOVE LENGTH OF
  4207      CERTIFICATE-MASTER
  4208       TO DFHEIV11
  4209     MOVE 'ELCERT' TO DFHEIV1
  4210*    MOVE '&"IL       E          (  N#00004109' TO DFHEIV0
  4211     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4213     MOVE X'204E233030303034313039' TO DFHEIV0(25:11)
  4214     CALL 'kxdfhei1' USING DFHEIV0,
  4215           DFHEIV1,
  4216           CERTIFICATE-MASTER,
  4217           DFHEIV11,
  4218           WS-CM-KEY,
  4219           DFHEIV99,
  4220           DFHEIV99,
  4221           DFHEIV99
  4222     MOVE EIBRESP  TO WS-RESPONSE
  4223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4224        WHEN WS-ELCERT-ACT-NAME
  4225           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4226           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4227           MOVE CLIENT-STATE        TO WS-CM-STATE
  4228           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4229           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4230           MOVE ZEROS               TO WS-CM-CERT-NO
  4231
  4232* EXEC CICS STARTBR
  4233*             DATASET ('ELCERT')
  4234*             RIDFLD  (WS-CM-KEY)
  4235*             RESP    (WS-RESPONSE)
  4236*          END-EXEC
  4237     MOVE 'ELCERT' TO DFHEIV1
  4238     MOVE 0
  4239       TO DFHEIV11
  4240*    MOVE '&,         G          &  N#00004122' TO DFHEIV0
  4241     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4242     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4243     MOVE X'204E233030303034313232' TO DFHEIV0(25:11)
  4244     CALL 'kxdfhei1' USING DFHEIV0,
  4245           DFHEIV1,
  4246           WS-CM-KEY,
  4247           DFHEIV99,
  4248           DFHEIV11,
  4249           DFHEIV99
  4250     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  75
* SOCK03.cbl
  4251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4252        WHEN WS-ELCERT-NAME
  4253           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4254           MOVE SPACES           TO WS-CM-INITIALS
  4255           COMPUTE WS-LENGTH = L1 + +1
  4256
  4257* EXEC CICS STARTBR
  4258*             DATASET   ('ELCERT2')
  4259*             RIDFLD    (WS-CM-KEY-A1)
  4260*             GENERIC
  4261*             KEYLENGTH (WS-LENGTH)
  4262*             GTEQ
  4263*             RESP      (WS-RESPONSE)
  4264*          END-EXEC
  4265     MOVE 'ELCERT2' TO DFHEIV1
  4266     MOVE 0
  4267       TO DFHEIV11
  4268*    MOVE '&,   KG    G          &  N#00004131' TO DFHEIV0
  4269     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4271     MOVE X'204E233030303034313331' TO DFHEIV0(25:11)
  4272     CALL 'kxdfhei1' USING DFHEIV0,
  4273           DFHEIV1,
  4274           WS-CM-KEY-A1,
  4275           WS-LENGTH,
  4276           DFHEIV11,
  4277           DFHEIV99
  4278     MOVE EIBRESP  TO WS-RESPONSE
  4279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4280*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4281*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4282        WHEN WS-ELCERT-CERT-NO
  4283* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4284           MOVE +11 TO WS-LENGTH
  4285           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4286
  4287* EXEC CICS STARTBR
  4288*             DATASET   ('ELCERT5')
  4289*             RIDFLD    (WS-CM-KEY-A4)
  4290*             GENERIC
  4291*             KEYLENGTH (WS-LENGTH)
  4292*             GTEQ
  4293*             RESP      (WS-RESPONSE)
  4294*          END-EXEC
  4295     MOVE 'ELCERT5' TO DFHEIV1
  4296     MOVE 0
  4297       TO DFHEIV11
  4298*    MOVE '&,   KG    G          &  N#00004145' TO DFHEIV0
  4299     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4301     MOVE X'204E233030303034313435' TO DFHEIV0(25:11)
  4302     CALL 'kxdfhei1' USING DFHEIV0,
  4303           DFHEIV1,
  4304           WS-CM-KEY-A4,
  4305           WS-LENGTH,
  4306           DFHEIV11,
  4307           DFHEIV99
  4308     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  76
* SOCK03.cbl
  4309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4310     END-EVALUATE
  4311     .
  4312 0100-EXIT.
  4313     EXIT.
  4314 0150-READ-NEXT-ELCERT.
  4315*    DISPLAY ' MADE 0150 NEXT '
  4316     EVALUATE TRUE
  4317        WHEN WS-ELCERT-ACT-NAME
  4318*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4319
  4320* EXEC CICS READNEXT
  4321*             DATASET   ('ELCERT')
  4322*             RIDFLD    (WS-CM-KEY)
  4323*             INTO      (CERTIFICATE-MASTER)
  4324*             RESP      (WS-RESPONSE)
  4325*          END-EXEC
  4326     MOVE LENGTH OF
  4327      CERTIFICATE-MASTER
  4328       TO DFHEIV12
  4329     MOVE 'ELCERT' TO DFHEIV1
  4330     MOVE 0
  4331       TO DFHEIV11
  4332*    MOVE '&.IL                  )  N#00004162' TO DFHEIV0
  4333     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4334     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4335     MOVE X'204E233030303034313632' TO DFHEIV0(25:11)
  4336     CALL 'kxdfhei1' USING DFHEIV0,
  4337           DFHEIV1,
  4338           CERTIFICATE-MASTER,
  4339           DFHEIV12,
  4340           WS-CM-KEY,
  4341           DFHEIV99,
  4342           DFHEIV11,
  4343           DFHEIV99,
  4344           DFHEIV99
  4345     MOVE EIBRESP  TO WS-RESPONSE
  4346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4347        WHEN WS-ELCERT-NAME
  4348*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4349
  4350* EXEC CICS READNEXT
  4351*             DATASET   ('ELCERT2')
  4352*             RIDFLD    (WS-CM-KEY-A1)
  4353*             INTO      (CERTIFICATE-MASTER)
  4354*             RESP      (WS-RESPONSE)
  4355*          END-EXEC
  4356     MOVE LENGTH OF
  4357      CERTIFICATE-MASTER
  4358       TO DFHEIV12
  4359     MOVE 'ELCERT2' TO DFHEIV1
  4360     MOVE 0
  4361       TO DFHEIV11
  4362*    MOVE '&.IL                  )  N#00004170' TO DFHEIV0
  4363     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4364     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4365     MOVE X'204E233030303034313730' TO DFHEIV0(25:11)
  4366     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  77
* SOCK03.cbl
  4367           DFHEIV1,
  4368           CERTIFICATE-MASTER,
  4369           DFHEIV12,
  4370           WS-CM-KEY-A1,
  4371           DFHEIV99,
  4372           DFHEIV11,
  4373           DFHEIV99,
  4374           DFHEIV99
  4375     MOVE EIBRESP  TO WS-RESPONSE
  4376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4377        WHEN WS-ELCERT-CERT-NO
  4378
  4379* EXEC CICS READNEXT
  4380*             DATASET   ('ELCERT5')
  4381*             RIDFLD    (WS-CM-KEY-A4)
  4382*             INTO      (CERTIFICATE-MASTER)
  4383*             RESP      (WS-RESPONSE)
  4384*          END-EXEC
  4385     MOVE LENGTH OF
  4386      CERTIFICATE-MASTER
  4387       TO DFHEIV12
  4388     MOVE 'ELCERT5' TO DFHEIV1
  4389     MOVE 0
  4390       TO DFHEIV11
  4391*    MOVE '&.IL                  )  N#00004177' TO DFHEIV0
  4392     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4393     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4394     MOVE X'204E233030303034313737' TO DFHEIV0(25:11)
  4395     CALL 'kxdfhei1' USING DFHEIV0,
  4396           DFHEIV1,
  4397           CERTIFICATE-MASTER,
  4398           DFHEIV12,
  4399           WS-CM-KEY-A4,
  4400           DFHEIV99,
  4401           DFHEIV11,
  4402           DFHEIV99,
  4403           DFHEIV99
  4404     MOVE EIBRESP  TO WS-RESPONSE
  4405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4406     END-EVALUATE
  4407     .
  4408 0150-EXIT.
  4409     EXIT.
  4410 0200-BEGIN-REFUND-PROCESS.
  4411*    DISPLAY ' MADE 0200 BEGIN '
  4412     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4413                                    WS-ERACCT-SW
  4414     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4415                                    WS-NCB-DIFF-ODD-DAYS
  4416     INITIALIZE WS-STRING-DATA
  4417     IF RESP-NORMAL OR RESP-DUPKEY
  4418        EVALUATE TRUE
  4419           WHEN WS-ELCERT-ACT-NAME
  4420              EVALUATE TRUE
  4421                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4422                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4423                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4424                    OR (CM-STATE NOT = CLIENT-STATE)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  78
* SOCK03.cbl
  4425                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4426                    SET ELCERT-FINISHED TO TRUE
  4427                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4428                    CLIENT-LAST-NAME (1:L1))
  4429                    GO TO 0200-CONTINUE
  4430                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4431                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4432                    GO TO 0200-CONTINUE
  4433                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4434                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4435                     CLIENT-FIRST-NAME (1:F1)))
  4436                    GO TO 0200-CONTINUE
  4437                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4438                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4439                    GO TO 0200-CONTINUE
  4440              END-EVALUATE
  4441           WHEN WS-ELCERT-CERT-NO
  4442              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4443                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4444                 SET ELCERT-FINISHED TO TRUE
  4445              ELSE
  4446                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4447                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4448                              OR
  4449                    ((CLIENT-LAST-NAME NOT = SPACES)
  4450                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4451                        CLIENT-LAST-NAME (1:L1)))
  4452                              OR
  4453                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4454                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4455                        CLIENT-FIRST-NAME (1:F1)))
  4456                              OR
  4457                    ((CLIENT-ACCOUNT NOT = SPACES)
  4458                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4459                     GO TO 0200-CONTINUE
  4460                 END-IF
  4461              END-IF
  4462           WHEN WS-ELCERT-NAME
  4463              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4464                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4465                    CLIENT-LAST-NAME (1:L1))
  4466                  SET ELCERT-FINISHED TO TRUE
  4467              ELSE
  4468                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4469                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4470                           OR
  4471                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4472                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4473                     CLIENT-FIRST-NAME (1:F1)))
  4474                           OR
  4475                 ((CLIENT-ACCOUNT NOT = SPACES)
  4476                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4477                  GO TO 0200-CONTINUE
  4478                 END-IF
  4479              END-IF
  4480           WHEN OTHER
  4481              SET ELCERT-FINISHED   TO TRUE
  4482        END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  79
* SOCK03.cbl
  4483     ELSE
  4484        SET ELCERT-FINISHED TO TRUE
  4485     END-IF
  4486*       IF WS-ELCERT-CERT-NO
  4487*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4488*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4489*                          OR
  4490*                ((CLIENT-EFF-DT NOT = SPACES)
  4491*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4492*                          OR
  4493*                ((CLIENT-LAST-NAME NOT = SPACES)
  4494*                 AND (CM-INSURED-LAST-NAME NOT =
  4495*                    CLIENT-LAST-NAME))
  4496*                 SET ELCERT-FINISHED TO TRUE
  4497*          END-IF
  4498*          IF WS-ELCERT-NAME
  4499*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4500*                OR (CM-INSURED-LAST-NAME NOT =
  4501*                   CLIENT-LAST-NAME)
  4502*                            OR
  4503*                ((CLIENT-EFF-DT NOT = SPACES)
  4504*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4505*                 SET ELCERT-FINISHED TO TRUE
  4506*             END-IF
  4507*          ELSE
  4508*             SET ELCERT-FINISHED   TO TRUE
  4509*          END-IF
  4510     IF NOT WS-ELCERT-FULL
  4511        IF ELCERT-FINISHED
  4512           GO TO 0200-EXIT
  4513        END-IF
  4514     END-IF
  4515     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4516        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4517        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4518        PERFORM 0030-BUILD-BUFFER
  4519                                 THRU 0030-EXIT
  4520        PERFORM 0020-SEND-BUFFER
  4521                                 THRU 0020-EXIT
  4522        GO TO 0200-CONTINUE
  4523     END-IF
  4524     PERFORM 0300-GET-ELCNTL-RECORDS
  4525                                 THRU 0300-EXIT
  4526     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4527     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4528     MOVE +0                     TO DC-ELAPSED-MONTHS
  4529                                    DC-ELAPSED-DAYS
  4530     MOVE '1'                    TO DC-OPTION-CODE
  4531     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4532     IF NO-CONVERSION-ERROR
  4533        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4534        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4535     END-IF
  4536     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4537     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4538     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4539     IF NOT ALREADY-SENT
  4540        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  80
* SOCK03.cbl
  4541     END-IF
  4542     .
  4543 0200-CONTINUE.
  4544     PERFORM 0150-READ-NEXT-ELCERT
  4545                                 THRU 0150-EXIT
  4546     .
  4547 0200-EXIT.
  4548     EXIT.
  4549 0300-GET-ELCNTL-RECORDS.
  4550     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4551     IF NOT RESP-NORMAL
  4552        MOVE ' COMPANY RECORD NOT FOUND '
  4553                                 TO WS-COMMENT
  4554        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4555        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4556        PERFORM 0020-SEND-BUFFER
  4557                                 THRU 0020-EXIT
  4558        PERFORM 0025-CLOSE-SOCKET
  4559                                 THRU 0025-EXIT
  4560        GO TO 0010-RETURN
  4561     END-IF
  4562     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4563        PERFORM 0320-GET-LIFE-RECORD
  4564                                 THRU 0320-EXIT
  4565        IF NOT RESP-NORMAL
  4566           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4567                                 TO WS-COMMENT
  4568           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4569           PERFORM 0030-BUILD-BUFFER
  4570                                 THRU 0030-EXIT
  4571           PERFORM 0020-SEND-BUFFER
  4572                                 THRU 0020-EXIT
  4573           PERFORM 0025-CLOSE-SOCKET
  4574                                 THRU 0025-EXIT
  4575           GO TO 0010-RETURN
  4576        END-IF
  4577     END-IF
  4578     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4579        PERFORM 0330-GET-AH-RECORD
  4580                                 THRU 0330-EXIT
  4581        IF NOT RESP-NORMAL
  4582           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4583                                 TO WS-COMMENT
  4584           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4585           PERFORM 0030-BUILD-BUFFER
  4586                                 THRU 0030-EXIT
  4587           PERFORM 0020-SEND-BUFFER
  4588                                 THRU 0020-EXIT
  4589           PERFORM 0025-CLOSE-SOCKET
  4590                                 THRU 0025-EXIT
  4591           GO TO 0010-RETURN
  4592        END-IF
  4593     END-IF
  4594     PERFORM 0340-GET-STATE-RECORD
  4595                                 THRU 0340-EXIT
  4596     IF NOT RESP-NORMAL
  4597        MOVE ' STATE RECORD NOT FOUND '
  4598                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  81
* SOCK03.cbl
  4599        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4600        PERFORM 0030-BUILD-BUFFER
  4601                                 THRU 0030-EXIT
  4602        PERFORM 0020-SEND-BUFFER
  4603                                 THRU 0020-EXIT
  4604        PERFORM 0025-CLOSE-SOCKET
  4605                                 THRU 0025-EXIT
  4606        GO TO 0010-RETURN
  4607     END-IF
  4608     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4609     IF NOT ERACCT-FOUND
  4610        MOVE ' ACCOUNT NOT FOUND '
  4611                                 TO WS-COMMENT
  4612        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4613        PERFORM 0030-BUILD-BUFFER
  4614                                 THRU 0030-EXIT
  4615        PERFORM 0020-SEND-BUFFER
  4616                                 THRU 0020-EXIT
  4617        PERFORM 0025-CLOSE-SOCKET
  4618                                 THRU 0025-EXIT
  4619        GO TO 0010-RETURN
  4620     ELSE
  4621        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4622        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4623        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4624        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4625     END-IF
  4626     .
  4627 0300-EXIT.
  4628     EXIT.
  4629 0310-GET-COMPANY.
  4630     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4631     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4632     MOVE SPACES                 TO  WS-CF-ACCESS
  4633     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4634
  4635* EXEC CICS READ
  4636*       INTO    (CONTROL-FILE)
  4637*       DATASET ('ELCNTL')
  4638*       RIDFLD  (WS-CF-KEY)
  4639*       RESP    (WS-RESPONSE)
  4640*    END-EXEC
  4641     MOVE LENGTH OF
  4642      CONTROL-FILE
  4643       TO DFHEIV11
  4644     MOVE 'ELCNTL' TO DFHEIV1
  4645*    MOVE '&"IL       E          (  N#00004411' TO DFHEIV0
  4646     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4648     MOVE X'204E233030303034343131' TO DFHEIV0(25:11)
  4649     CALL 'kxdfhei1' USING DFHEIV0,
  4650           DFHEIV1,
  4651           CONTROL-FILE,
  4652           DFHEIV11,
  4653           WS-CF-KEY,
  4654           DFHEIV99,
  4655           DFHEIV99,
  4656           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  82
* SOCK03.cbl
  4657     MOVE EIBRESP  TO WS-RESPONSE
  4658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4659     IF (RESP-NORMAL)
  4660        AND (CF-COMPANY-ID = WS-COMP-ID)
  4661        AND (CF-RECORD-TYPE = '1')
  4662        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4663        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4664        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4665        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4666        IF CF-DEFAULT-APR NUMERIC
  4667           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4668        ELSE
  4669           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4670        END-IF
  4671        IF CF-VALID-REM-TRM-OPTION
  4672           MOVE CF-REM-TRM-CALC-OPTION
  4673                                 TO WS-CF-REM-TRM-CALC-OPTION
  4674        ELSE
  4675           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4676        END-IF
  4677     END-IF
  4678     .
  4679 0310-EXIT.
  4680     EXIT.
  4681 0320-GET-LIFE-RECORD.
  4682     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4683     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4684                                    WS-LF-BEN-CODE
  4685     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4686
  4687* EXEC CICS READ
  4688*       INTO    (CONTROL-FILE)
  4689*       DATASET ('ELCNTL')
  4690*       RIDFLD  (WS-CF-KEY)
  4691*       GTEQ
  4692*       RESP    (WS-RESPONSE)
  4693*    END-EXEC
  4694     MOVE LENGTH OF
  4695      CONTROL-FILE
  4696       TO DFHEIV11
  4697     MOVE 'ELCNTL' TO DFHEIV1
  4698*    MOVE '&"IL       G          (  N#00004444' TO DFHEIV0
  4699     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4701     MOVE X'204E233030303034343434' TO DFHEIV0(25:11)
  4702     CALL 'kxdfhei1' USING DFHEIV0,
  4703           DFHEIV1,
  4704           CONTROL-FILE,
  4705           DFHEIV11,
  4706           WS-CF-KEY,
  4707           DFHEIV99,
  4708           DFHEIV99,
  4709           DFHEIV99
  4710     MOVE EIBRESP  TO WS-RESPONSE
  4711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4712     IF RESP-NORMAL
  4713        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4714        AND (CF-RECORD-TYPE = '4')
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  83
* SOCK03.cbl
  4715        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4716           (S1 > +8)
  4717           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4718        END-PERFORM
  4719        IF S1 > +8
  4720           CONTINUE
  4721        ELSE
  4722           MOVE CF-BENEFIT-DESCRIP (S1)
  4723                                 TO WS-LF-BEN-CODE-DESC
  4724           MOVE CF-LF-COVERAGE-TYPE (S1)
  4725                                 TO WS-CF-LF-COVERAGE-TYPE
  4726           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4727               MOVE CF-CO-REM-TERM-CALC (S1)
  4728                                 TO WS-LF-CO-REM-TERM-CALC
  4729           END-IF
  4730           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  4731               MOVE CF-CO-EARNINGS-CALC (S1)
  4732                                 TO WS-LF-CO-EARNINGS-CALC
  4733                                    WS-LF-CO-REFUND-CALC
  4734           END-IF
  4735           IF CF-SPECIAL-CALC-CD (S1) > ' '
  4736               MOVE CF-SPECIAL-CALC-CD (S1)
  4737                                 TO WS-LF-SPECIAL-CALC-CD
  4738           END-IF
  4739           IF CF-CO-REFUND-CALC (S1) > '0'
  4740               MOVE CF-CO-REFUND-CALC (S1)
  4741                                 TO WS-LF-CO-REFUND-CALC
  4742        END-IF
  4743     END-IF
  4744     .
  4745 0320-EXIT.
  4746     EXIT.
  4747 0330-GET-AH-RECORD.
  4748     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4749     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4750     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4751
  4752* EXEC CICS READ
  4753*       INTO    (CONTROL-FILE)
  4754*       DATASET ('ELCNTL')
  4755*       RIDFLD  (WS-CF-KEY)
  4756*       GTEQ
  4757*       RESP    (WS-RESPONSE)
  4758*    END-EXEC
  4759     MOVE LENGTH OF
  4760      CONTROL-FILE
  4761       TO DFHEIV11
  4762     MOVE 'ELCNTL' TO DFHEIV1
  4763*    MOVE '&"IL       G          (  N#00004490' TO DFHEIV0
  4764     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4766     MOVE X'204E233030303034343930' TO DFHEIV0(25:11)
  4767     CALL 'kxdfhei1' USING DFHEIV0,
  4768           DFHEIV1,
  4769           CONTROL-FILE,
  4770           DFHEIV11,
  4771           WS-CF-KEY,
  4772           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  84
* SOCK03.cbl
  4773           DFHEIV99,
  4774           DFHEIV99
  4775     MOVE EIBRESP  TO WS-RESPONSE
  4776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4777     IF RESP-NORMAL
  4778        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4779        AND (CF-RECORD-TYPE = '5')
  4780        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4781           (S1 > +8)
  4782           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4783        END-PERFORM
  4784        IF S1 > +8
  4785           CONTINUE
  4786        ELSE
  4787           MOVE CF-BENEFIT-DESCRIP (S1)
  4788                                 TO WS-AH-BEN-CODE-DESC
  4789           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4790              MOVE CF-CO-REM-TERM-CALC (S1)
  4791                                 TO WS-AH-CO-REM-TERM-CALC
  4792           END-IF
  4793           IF CF-CO-EARNINGS-CALC (S1) > ' '
  4794              MOVE CF-CO-EARNINGS-CALC (S1)
  4795                                 TO WS-AH-CO-EARNINGS-CALC
  4796                                    WS-AH-CO-REFUND-CALC
  4797           END-IF
  4798           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  4799              MOVE CF-SPECIAL-CALC-CD (S1)
  4800                                 TO WS-AH-SPECIAL-CALC-CD
  4801           END-IF
  4802           IF CF-CO-REFUND-CALC (S1) > '0'
  4803              MOVE CF-CO-REFUND-CALC (S1)
  4804                                 TO WS-AH-CO-REFUND-CALC
  4805           END-IF
  4806           IF CF-BENEFIT-CATEGORY (S1) > ' '
  4807              MOVE CF-BENEFIT-CATEGORY (S1)
  4808                                 TO WS-AH-BEN-CATEGORY
  4809           END-IF
  4810        END-IF
  4811     END-IF
  4812     .
  4813 0330-EXIT.
  4814     EXIT.
  4815 0340-GET-STATE-RECORD.
  4816     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4817     MOVE '3'                    TO WS-CF-RECORD-TYPE
  4818     MOVE CM-STATE               TO WS-CF-ACCESS
  4819     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4820
  4821* EXEC CICS READ
  4822*       INTO    (CONTROL-FILE)
  4823*       DATASET ('ELCNTL')
  4824*       RIDFLD  (WS-CF-KEY)
  4825*       RESP    (WS-RESPONSE)
  4826*    END-EXEC
  4827     MOVE LENGTH OF
  4828      CONTROL-FILE
  4829       TO DFHEIV11
  4830     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  85
* SOCK03.cbl
  4831*    MOVE '&"IL       E          (  N#00004540' TO DFHEIV0
  4832     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4834     MOVE X'204E233030303034353430' TO DFHEIV0(25:11)
  4835     CALL 'kxdfhei1' USING DFHEIV0,
  4836           DFHEIV1,
  4837           CONTROL-FILE,
  4838           DFHEIV11,
  4839           WS-CF-KEY,
  4840           DFHEIV99,
  4841           DFHEIV99,
  4842           DFHEIV99
  4843     MOVE EIBRESP  TO WS-RESPONSE
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4845     IF (RESP-NORMAL)
  4846        AND (CF-COMPANY-ID = WS-COMP-ID)
  4847        AND (CF-RECORD-TYPE = '3')
  4848        AND (CF-STATE-CODE = CM-STATE)
  4849        MOVE CF-ST-FREE-LOOK-PERIOD
  4850                                 TO WS-FREE-LOOK
  4851        MOVE CF-STATE-ABBREVIATION
  4852                                 TO WS-STATE-ABBREVIATION
  4853        MOVE CF-ST-FST-PMT-DAYS-CHG
  4854                                 TO  WS-STATE-EXT-DAYS-CHG
  4855        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  4856           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  4857           IF CF-ST-RT-CALC NOT = SPACES
  4858              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  4859           END-IF
  4860           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  4861              IF CF-ST-RF-LR-CALC > '0'
  4862                 MOVE CF-ST-RF-LR-CALC
  4863                                 TO WS-LF-ST-REFUND-CALC
  4864              END-IF
  4865              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  4866                 IF CF-ST-RF-LN-CALC > '0'
  4867                    MOVE CF-ST-RF-LN-CALC
  4868                                 TO WS-LF-ST-REFUND-CALC
  4869                 END-IF
  4870              END-IF
  4871           ELSE
  4872              IF CF-ST-RF-LL-CALC > '0'
  4873                 MOVE CF-ST-RF-LL-CALC
  4874                                 TO WS-LF-ST-REFUND-CALC
  4875              END-IF
  4876           END-IF
  4877           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4878              (S1 > 50)
  4879              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4880                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  4881           END-PERFORM
  4882           IF S1 < +51
  4883              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4884                 MOVE CF-ST-REM-TERM-CALC (S1)
  4885                                 TO WS-LF-ST-REM-TERM-CALC
  4886              END-IF
  4887              IF CF-ST-REFUND-CALC (S1) > '0'
  4888                 MOVE CF-ST-REFUND-CALC (S1)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  86
* SOCK03.cbl
  4889                                 TO WS-LF-ST-REFUND-CALC
  4890              END-IF
  4891           END-IF
  4892        END-IF
  4893        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  4894           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  4895           IF CF-ST-RT-CALC NOT = SPACES
  4896              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  4897           END-IF
  4898           IF CF-ST-RF-AH-CALC > '0'
  4899              MOVE CF-ST-RF-AH-CALC
  4900                                 TO WS-AH-ST-REFUND-CALC
  4901           END-IF
  4902           IF WS-AH-SPECIAL-CALC-CD = 'C'
  4903              IF CF-ST-RF-CP-CALC > '0'
  4904                 MOVE CF-ST-RF-CP-CALC
  4905                                 TO WS-AH-ST-REFUND-CALC
  4906              END-IF
  4907           END-IF
  4908           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4909              (S1 > 50)
  4910              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4911                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  4912           END-PERFORM
  4913           IF S1 < +51
  4914              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4915                 MOVE CF-ST-REM-TERM-CALC (S1)
  4916                                 TO WS-AH-ST-REM-TERM-CALC
  4917              END-IF
  4918              IF CF-ST-REFUND-CALC (S1) > '0'
  4919                 MOVE CF-ST-REFUND-CALC (S1)
  4920                                 TO WS-AH-ST-REFUND-CALC
  4921              END-IF
  4922           END-IF
  4923        END-IF
  4924     END-IF
  4925     .
  4926 0340-EXIT.
  4927     EXIT.
  4928 0350-GET-ERACCT.
  4929     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  4930                                    WS-AM-EARN-METHOD-R
  4931                                    WS-AM-EARN-METHOD-A
  4932                                    WS-LF-AM-REM-TERM-CALC
  4933                                    WS-AH-AM-REM-TERM-CALC
  4934     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  4935     MOVE CM-CARRIER             TO WS-AM-CARRIER
  4936     MOVE CM-GROUPING            TO WS-AM-GROUPING
  4937     MOVE CM-STATE               TO WS-AM-STATE
  4938     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  4939     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  4940     MOVE LOW-VALUES             TO WS-AM-FILLER
  4941
  4942* EXEC CICS STARTBR
  4943*       DATASET  ('ERACCT')
  4944*       RIDFLD   (WS-AM-KEY)
  4945*       GTEQ
  4946*       RESP (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  87
* SOCK03.cbl
  4947*    END-EXEC
  4948     MOVE 'ERACCT' TO DFHEIV1
  4949     MOVE 0
  4950       TO DFHEIV11
  4951*    MOVE '&,         G          &  N#00004642' TO DFHEIV0
  4952     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4953     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4954     MOVE X'204E233030303034363432' TO DFHEIV0(25:11)
  4955     CALL 'kxdfhei1' USING DFHEIV0,
  4956           DFHEIV1,
  4957           WS-AM-KEY,
  4958           DFHEIV99,
  4959           DFHEIV11,
  4960           DFHEIV99
  4961     MOVE EIBRESP  TO WS-RESPONSE
  4962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4963     IF RESP-NORMAL
  4964
  4965* EXEC CICS READNEXT
  4966*          DATASET  ('ERACCT')
  4967*          INTO     (ACCOUNT-MASTER)
  4968*          RIDFLD   (WS-AM-KEY)
  4969*       END-EXEC
  4970     MOVE LENGTH OF
  4971      ACCOUNT-MASTER
  4972       TO DFHEIV12
  4973     MOVE 'ERACCT' TO DFHEIV1
  4974     MOVE 0
  4975       TO DFHEIV11
  4976*    MOVE '&.IL                  )   #00004649' TO DFHEIV0
  4977     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4978     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4979     MOVE X'2020233030303034363439' TO DFHEIV0(25:11)
  4980     CALL 'kxdfhei1' USING DFHEIV0,
  4981           DFHEIV1,
  4982           ACCOUNT-MASTER,
  4983           DFHEIV12,
  4984           WS-AM-KEY,
  4985           DFHEIV99,
  4986           DFHEIV11,
  4987           DFHEIV99,
  4988           DFHEIV99
  4989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4990        IF RESP-NORMAL
  4991           AND (AM-CONTROL-PRIMARY (1:20)
  4992              = CM-CONTROL-PRIMARY (1:20))
  4993           AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  4994           AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  4995           SET ERACCT-FOUND      TO TRUE
  4996        END-IF
  4997
  4998* EXEC CICS ENDBR
  4999*          DATASET   ('ERACCT')
  5000*       END-EXEC
  5001     MOVE 'ERACCT' TO DFHEIV1
  5002     MOVE 0
  5003       TO DFHEIV11
  5004*    MOVE '&2                    $   #00004661' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  88
* SOCK03.cbl
  5005     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5007     MOVE X'2020233030303034363631' TO DFHEIV0(25:11)
  5008     CALL 'kxdfhei1' USING DFHEIV0,
  5009           DFHEIV1,
  5010           DFHEIV11,
  5011           DFHEIV99
  5012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5013     END-IF
  5014     .
  5015 0350-EXIT.
  5016     EXIT.
  5017 0400-PROCESS-LIFE.
  5018     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5019     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5020     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5021     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5022     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5023     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5024     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5025     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5026     MOVE CM-CARRIER             TO WS-CARRIER
  5027     MOVE CM-GROUPING            TO WS-GROUPING
  5028     MOVE CM-STATE               TO WS-STATE
  5029     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5030     MOVE CM-CERT-NO             TO WS-CERT-NO
  5031     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5032     MOVE ' '                    TO  DC-OPTION-CODE.
  5033     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5034     IF NO-CONVERSION-ERROR
  5035        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5036     ELSE
  5037        MOVE 99999999            TO WS-CERT-EFF-DATE
  5038     END-IF
  5039     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5040        GO TO 0400-EXIT
  5041     END-IF
  5042     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5043                                    WS-TOT-LF-PREM
  5044                                    WS-TOT-LF-COMM
  5045     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5046     MOVE ' '                    TO  DC-OPTION-CODE
  5047     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5048     IF NO-CONVERSION-ERROR
  5049        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5050     ELSE
  5051        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5052     END-IF
  5053     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5054     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5055     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5056     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5057     MOVE CM-STATE               TO CP-STATE
  5058     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5059     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5060     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5061     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5062     MOVE CM-LOAN-APR            TO CP-LOAN-APR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  89
* SOCK03.cbl
  5063     MOVE '2'                    TO CP-PROCESS-TYPE
  5064     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5065     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5066     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5067     MOVE WS-CF-REM-TRM-CALC-OPTION
  5068                                 TO CP-REM-TRM-CALC-OPTION
  5069     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5070     IF WS-LF-CO-REM-TERM-CALC > '0'
  5071        MOVE WS-LF-CO-REM-TERM-CALC
  5072                                 TO CP-REM-TERM-METHOD
  5073     END-IF
  5074     IF WS-LF-ST-REM-TERM-CALC > '0'
  5075         MOVE WS-LF-ST-REM-TERM-CALC
  5076                                 TO  CP-REM-TERM-METHOD.
  5077     IF WS-LF-AM-REM-TERM-CALC > '0'
  5078         MOVE WS-LF-AM-REM-TERM-CALC
  5079                                 TO  CP-REM-TERM-METHOD.
  5080     IF (WS-COMP-ID = 'CID')
  5081        AND (CP-STATE-STD-ABBRV = 'WI')
  5082        MOVE '7'                 TO CP-REM-TERM-METHOD
  5083        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5084     END-IF
  5085     IF (WS-COMP-ID = 'CID')
  5086        AND (CP-STATE-STD-ABBRV = 'MO')
  5087        AND (CM-CERT-EFF-DT >= X'9B41')
  5088        AND (CM-CERT-EFF-DT <= X'A2FB')
  5089        MOVE '7'                 TO CP-REM-TERM-METHOD
  5090        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5091     END-IF
  5092     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5093                                    CP-LOAN-TERM
  5094                                    WS-LF-TERM
  5095     IF CP-TRUNCATED-LIFE
  5096         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5097     IF CP-TERM-IS-DAYS
  5098        IF CM-LF-TERM-IN-DAYS NUMERIC
  5099           MOVE CM-LF-TERM-IN-DAYS
  5100                                 TO CP-TERM-OR-EXT-DAYS
  5101        ELSE
  5102           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5103        END-IF
  5104     ELSE
  5105        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5106           MOVE CM-PMT-EXTENSION-DAYS
  5107                                 TO CP-TERM-OR-EXT-DAYS
  5108        ELSE
  5109           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5110        END-IF
  5111     END-IF
  5112     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5113     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5114        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5115        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5116     END-IF
  5117     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5118     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5119     MOVE ' '                    TO WS-CLM-STOP-SW
  5120     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  90
* SOCK03.cbl
  5121     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5122
  5123* EXEC CICS STARTBR
  5124*       DATASET     ('ELMSTR5')
  5125*       RIDFLD      (ELMSTR-KEY)
  5126*       RESP        (WS-RESPONSE)
  5127*    END-EXEC
  5128     MOVE 'ELMSTR5' TO DFHEIV1
  5129     MOVE 0
  5130       TO DFHEIV11
  5131*    MOVE '&,         G          &  N#00004773' TO DFHEIV0
  5132     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5134     MOVE X'204E233030303034373733' TO DFHEIV0(25:11)
  5135     CALL 'kxdfhei1' USING DFHEIV0,
  5136           DFHEIV1,
  5137           ELMSTR-KEY,
  5138           DFHEIV99,
  5139           DFHEIV11,
  5140           DFHEIV99
  5141     MOVE EIBRESP  TO WS-RESPONSE
  5142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5143     DISPLAY ' AFTER START ' WS-RESPONSE
  5144     IF RESP-NORMAL
  5145        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5146
  5147* EXEC CICS READNEXT
  5148*             DATASET   ('ELMSTR5')
  5149*             RIDFLD    (ELMSTR-KEY)
  5150*             INTO      (CLAIM-MASTER)
  5151*             RESP      (WS-RESPONSE)
  5152*          END-EXEC
  5153     MOVE LENGTH OF
  5154      CLAIM-MASTER
  5155       TO DFHEIV12
  5156     MOVE 'ELMSTR5' TO DFHEIV1
  5157     MOVE 0
  5158       TO DFHEIV11
  5159*    MOVE '&.IL                  )  N#00004781' TO DFHEIV0
  5160     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5161     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5162     MOVE X'204E233030303034373831' TO DFHEIV0(25:11)
  5163     CALL 'kxdfhei1' USING DFHEIV0,
  5164           DFHEIV1,
  5165           CLAIM-MASTER,
  5166           DFHEIV12,
  5167           ELMSTR-KEY,
  5168           DFHEIV99,
  5169           DFHEIV11,
  5170           DFHEIV99,
  5171           DFHEIV99
  5172     MOVE EIBRESP  TO WS-RESPONSE
  5173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5174        IF (RESP-NORMAL OR RESP-DUPKEY)
  5175           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5176           AND (CM-CERT-NO = CL-CERT-NO)
  5177           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5178              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  91
* SOCK03.cbl
  5179              IF CL-CLAIM-TYPE = 'L'
  5180                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5181                    MOVE 'D'     TO WS-AH-STATUS
  5182                 END-IF
  5183                 IF CLAIM-IS-OPEN
  5184                    MOVE ' OPEN LIFE CLAIM '
  5185                                 TO WS-COMMENT
  5186                    MOVE 'L'     TO WS-LF-STATUS
  5187                    GO TO 0400-EXIT
  5188                 ELSE
  5189                    MOVE ' DEATH CLAIM APPLIED '
  5190                                 TO WS-COMMENT
  5191                    MOVE 'D'     TO WS-LF-STATUS
  5192*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5193*                      MOVE CL-PAID-THRU-DT
  5194*                                TO WS-LF-BIN-PAID-THRU-DT
  5195*                   END-IF
  5196                 END-IF
  5197              END-IF
  5198           END-IF
  5199        ELSE
  5200           SET I-SAY-TO-STOP TO TRUE
  5201        END-IF
  5202        END-PERFORM
  5203
  5204* EXEC CICS ENDBR
  5205*          DATASET   ('ELMSTR5')
  5206*       END-EXEC
  5207     MOVE 'ELMSTR5' TO DFHEIV1
  5208     MOVE 0
  5209       TO DFHEIV11
  5210*    MOVE '&2                    $   #00004816' TO DFHEIV0
  5211     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5213     MOVE X'2020233030303034383136' TO DFHEIV0(25:11)
  5214     CALL 'kxdfhei1' USING DFHEIV0,
  5215           DFHEIV1,
  5216           DFHEIV11,
  5217           DFHEIV99
  5218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5219     END-IF
  5220     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5221*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5222        MOVE WS-LF-BIN-PAID-THRU-DT
  5223                                 TO DC-BIN-DATE-1
  5224        MOVE ' '                 TO DC-OPTION-CODE
  5225        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5226        IF NO-CONVERSION-ERROR
  5227           MOVE DC-GREG-DATE-CYMD
  5228                                 TO WS-CLM-PAID-THRU-DT
  5229        ELSE
  5230           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5231        END-IF
  5232*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5233*          MOVE 'CAN DT =< CLM PD THRU DT'
  5234*                                TO WS-COMMENT
  5235*          MOVE 'P'              TO WS-LF-STATUS
  5236*          GO TO 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  92
* SOCK03.cbl
  5237*       END-IF
  5238        GO TO 0400-EXIT
  5239     END-IF
  5240     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5241     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5242        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5243        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5244        COMPUTE CP-REMAINING-TERM-1 =
  5245                CP-REMAINING-TERM-1 - +1
  5246        COMPUTE CP-REMAINING-TERM-2 =
  5247                CP-REMAINING-TERM-2 - +1
  5248     END-IF
  5249     IF CP-REMAINING-TERM-1 NEGATIVE
  5250        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5251     END-IF
  5252     IF CP-REMAINING-TERM-2 NEGATIVE
  5253        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5254     END-IF
  5255     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5256        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5257     END-IF
  5258     IF CM-LIFE-COMM-PCT > ZEROS
  5259        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5260           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5261     END-IF
  5262     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5263     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5264     IF CM-LF-CURRENT-STATUS = '8'
  5265        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5266           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5267                                 TO WS-COMMENT
  5268           MOVE 'C'              TO WS-LF-STATUS
  5269*          PERFORM 0030-BUILD-BUFFER
  5270*                                THRU 0030-EXIT
  5271*          PERFORM 0020-SEND-BUFFER
  5272*                                THRU 0020-EXIT
  5273*          SET ALREADY-SENT      TO TRUE
  5274*          MOVE SPACES           TO WS-COMMENT
  5275           GO TO 0400-EXIT
  5276*          PERFORM 0025-CLOSE-SOCKET
  5277*                                THRU 0025-EXIT
  5278*          GO TO 0010-RETURN
  5279        END-IF
  5280     END-IF
  5281     IF CM-LF-CURRENT-STATUS = '7'
  5282        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5283           MOVE ' DEATH CLAIM APPLIED '
  5284                                 TO WS-COMMENT
  5285           MOVE 'D'              TO WS-LF-STATUS
  5286*          PERFORM 0030-BUILD-BUFFER
  5287*                                THRU 0030-EXIT
  5288*          IF NOT ALREADY-SENT
  5289*             PERFORM 0020-SEND-BUFFER
  5290*                                THRU 0020-EXIT
  5291*             SET ALREADY-SENT   TO TRUE
  5292*          END-IF
  5293           GO TO 0400-EXIT
  5294*          PERFORM 0025-CLOSE-SOCKET
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  93
* SOCK03.cbl
  5295*                                THRU 0025-EXIT
  5296*          GO TO 0010-RETURN
  5297        END-IF
  5298     END-IF
  5299     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5300        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5301        MOVE 'LF COVERAGE EXPIRED '
  5302                                 TO WS-COMMENT
  5303        MOVE 'E'                 TO WS-LF-STATUS
  5304        GO TO 0400-EXIT
  5305     END-IF
  5306     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5307        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5308        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5309     ELSE
  5310        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5311     END-IF
  5312     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5313     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5314     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5315     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5316*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5317     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5318        CM-LF-ALT-BENEFIT-AMT
  5319*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5320     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5321                                    WS-LF-REM-BEN
  5322     COMPUTE WS-TOT-LF-PREM = CM-LF-PREMIUM-AMT
  5323                             + CM-LF-ALT-PREMIUM-AMT
  5324     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5325     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5326        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5327        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5328     ELSE
  5329        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5330     END-IF
  5331     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5332     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5333     IF WS-LF-ST-REFUND-CALC > ZERO
  5334         MOVE WS-LF-ST-REFUND-CALC
  5335                                 TO  CP-EARNING-METHOD.
  5336     IF WS-LF-FO-REFUND-CALC > ZERO
  5337         MOVE WS-LF-FO-REFUND-CALC
  5338                                 TO  CP-EARNING-METHOD.
  5339     IF CP-RATING-METHOD = '4'
  5340        MOVE '4'                 TO CP-EARNING-METHOD
  5341     END-IF
  5342     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5343     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5344     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5345                                     CP-RATING-BENEFIT-AMT.
  5346     IF CP-STATE-STD-ABBRV = 'OR'
  5347         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5348                                         CM-LF-ALT-BENEFIT-AMT.
  5349****   N O T E   ****
  5350*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5351*      THE OH HARD CODING IN ELCRFNDP
  5352     IF WS-COMP-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  94
* SOCK03.cbl
  5353        IF CP-STATE-STD-ABBRV = 'OH'
  5354           MOVE WS-LF-CO-EARNINGS-CALC
  5355                                 TO CP-EARNING-METHOD
  5356        END-IF
  5357     END-IF
  5358****   N O T E   ****
  5359     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5360     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5361     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5362     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5363     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5364     IF CP-EARN-AS-NET-PAY
  5365        IF CP-LOAN-APR <= ZEROS
  5366           IF WS-CF-DEFAULT-APR > ZEROS
  5367              MOVE WS-CF-DEFAULT-APR
  5368                                 TO  CP-LOAN-APR
  5369           END-IF
  5370        END-IF
  5371     END-IF
  5372*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5373*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5374*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5375*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5376*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5377*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5378*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5379*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5380*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5381*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5382*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5383*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5384*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5385*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5386*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5387*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5388*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5389     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5390     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5391     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5392     DISPLAY ' MADE IT BACK FROM ELRFND '
  5393     IF (CP-ERROR-RATE-IS-ZERO)
  5394        OR (CP-ERROR-RATE-NOT-FOUND)
  5395        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5396        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5397          DELIMITED BY SIZE INTO WS-COMMENT
  5398        END-STRING
  5399        MOVE 'X'                 TO WS-LF-STATUS
  5400        GO TO 0400-EXIT
  5401*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5402*       IF NOT ALREADY-SENT
  5403*          PERFORM 0020-SEND-BUFFER
  5404*                                THRU 0020-EXIT
  5405*          SET ALREADY-SENT      TO TRUE
  5406*       END-IF
  5407*       PERFORM 0025-CLOSE-SOCKET
  5408*                                THRU 0025-EXIT
  5409*       GO TO 0010-RETURN
  5410     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  95
* SOCK03.cbl
  5411     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5412                                    WS-TOT-LF-RFND
  5413     IF (WS-LF-STATUS = SPACES)
  5414        OR (CP-CALC-REFUND > ZEROS)
  5415        MOVE 'A'                 TO WS-LF-STATUS
  5416     END-IF
  5417     EVALUATE TRUE
  5418        WHEN CP-R-AS-R78
  5419           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5420        WHEN  CP-R-AS-PRORATA
  5421           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5422        WHEN CP-R-AS-CALIF
  5423           MOVE 'CALIF'            TO  WS-LF-METHOD
  5424        WHEN CP-R-AS-TEXAS
  5425           MOVE 'IRREG'            TO  WS-LF-METHOD
  5426        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5427           MOVE 'UTAH'             TO  WS-LF-METHOD
  5428        WHEN CP-R-AS-FARM-PLAN
  5429           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5430        WHEN CP-R-AS-NET-PAY
  5431           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5432        WHEN CP-R-AS-ANTICIPATION
  5433           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5434        WHEN CP-R-AS-MEAN
  5435           MOVE 'MEAN'             TO  WS-LF-METHOD
  5436        WHEN CP-R-AS-SUM-OF-DIGITS
  5437           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5438     END-EVALUATE
  5439     IF WS-TOT-LF-RFND > ZEROS
  5440        COMPUTE WS-WORK-FACTOR ROUNDED =
  5441           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5442        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5443           WS-TOT-LF-COMM
  5444     END-IF
  5445     IF ERACCT-FOUND
  5446        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5447           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5448        END-IF
  5449        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5450           IF (AM-COMM-CHARGEBACK (1) = 99)
  5451                     OR
  5452              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5453                     OR
  5454              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5455              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5456              MOVE ZEROS         TO WS-LF-UEC
  5457           END-IF
  5458        END-IF
  5459     END-IF
  5460     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5461        GO TO 0400-EXIT
  5462     END-IF
  5463     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5464     MOVE '2'                    TO  CP-EARNING-METHOD
  5465                                     CP-RATING-METHOD.
  5466     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5467                                     CP-REMAINING-BENEFIT
  5468                                     CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  96
* SOCK03.cbl
  5469     IF CP-STATE-STD-ABBRV = 'OR'
  5470         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5471                                         CM-LF-ALT-BENEFIT-AMT.
  5472     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5473     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5474     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5475     IF (CP-ERROR-RATE-IS-ZERO)
  5476        OR (CP-ERROR-RATE-NOT-FOUND)
  5477        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5478        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5479          DELIMITED BY SIZE INTO WS-COMMENT
  5480        END-STRING
  5481        MOVE 'X'              TO WS-LF-STATUS
  5482        GO TO 0400-EXIT
  5483*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5484*       IF NOT ALREADY-SENT
  5485*          PERFORM 0020-SEND-BUFFER
  5486*                                THRU 0020-EXIT
  5487*          SET ALREADY-SENT      TO TRUE
  5488*       END-IF
  5489*       PERFORM 0025-CLOSE-SOCKET
  5490*                                THRU 0025-EXIT
  5491*       GO TO 0010-RETURN
  5492     END-IF
  5493     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5494     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5495     IF WS-TOT-LF-RFND > ZEROS
  5496        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5497           WS-TOT-LF-COMM
  5498     END-IF
  5499     IF ERACCT-FOUND
  5500        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5501           IF (AM-COMM-CHARGEBACK (1) = 99)
  5502                     OR
  5503              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5504                     OR
  5505              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5506              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5507              MOVE ZEROS         TO WS-LF-UEC
  5508           END-IF
  5509        END-IF
  5510     END-IF
  5511     .
  5512 0400-EXIT.
  5513     EXIT.
  5514 0500-PROCESS-AH.
  5515     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5516        GO TO 0500-EXIT
  5517     END-IF
  5518     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5519                                    WS-TOT-AH-PREM
  5520                                    WS-TOT-AH-COMM
  5521     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5522     MOVE ' '                    TO  DC-OPTION-CODE
  5523     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5524     IF NO-CONVERSION-ERROR
  5525        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5526     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  97
* SOCK03.cbl
  5527        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5528     END-IF
  5529     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5530     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5531     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5532     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5533     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5534     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5535     MOVE CM-STATE               TO  CP-STATE.
  5536     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5537     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5538     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5539     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5540     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5541     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5542     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5543     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5544     MOVE WS-CF-CR-REM-TERM-CALC
  5545                                 TO  CP-REM-TERM-METHOD.
  5546     IF WS-AH-CO-REM-TERM-CALC > '0'
  5547         MOVE WS-AH-CO-REM-TERM-CALC
  5548                                 TO  CP-REM-TERM-METHOD.
  5549     IF WS-AH-ST-REM-TERM-CALC > '0'
  5550         MOVE WS-AH-ST-REM-TERM-CALC
  5551                                 TO  CP-REM-TERM-METHOD.
  5552     IF WS-AH-AM-REM-TERM-CALC > '0'
  5553         MOVE WS-AH-AM-REM-TERM-CALC
  5554                                 TO  CP-REM-TERM-METHOD.
  5555     IF (WS-COMP-ID = 'CID')
  5556        AND (CP-STATE-STD-ABBRV = 'WI')
  5557        MOVE '7'                 TO CP-REM-TERM-METHOD
  5558        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5559     END-IF
  5560     IF (WS-COMP-ID = 'CID')
  5561        AND (CP-STATE-STD-ABBRV = 'MO')
  5562        AND (CM-CERT-EFF-DT >= X'9B41')
  5563        AND (CM-CERT-EFF-DT <= X'A2FB')
  5564        MOVE '7'                 TO CP-REM-TERM-METHOD
  5565        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5566     END-IF
  5567     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5568                                     CP-LOAN-TERM.
  5569     IF  NOT  CP-TERM-IS-DAYS
  5570         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5571             MOVE CM-PMT-EXTENSION-DAYS
  5572                                 TO  CP-TERM-OR-EXT-DAYS
  5573         ELSE
  5574             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5575     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5576     IF CM-AH-COMM-PCT > ZEROS
  5577        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5578           CM-AH-PREMIUM-AMT
  5579     END-IF
  5580     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5581     IF WS-AH-STATUS = 'D'
  5582        GO TO 0500-EXIT
  5583     END-IF
  5584     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  98
* SOCK03.cbl
  5585     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5586     MOVE ' '                    TO WS-CLM-STOP-SW
  5587     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5588     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5589
  5590* EXEC CICS STARTBR
  5591*       DATASET     ('ELMSTR5')
  5592*       RIDFLD      (ELMSTR-KEY)
  5593*       RESP        (WS-RESPONSE)
  5594*    END-EXEC
  5595     MOVE 'ELMSTR5' TO DFHEIV1
  5596     MOVE 0
  5597       TO DFHEIV11
  5598*    MOVE '&,         G          &  N#00005189' TO DFHEIV0
  5599     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5600     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5601     MOVE X'204E233030303035313839' TO DFHEIV0(25:11)
  5602     CALL 'kxdfhei1' USING DFHEIV0,
  5603           DFHEIV1,
  5604           ELMSTR-KEY,
  5605           DFHEIV99,
  5606           DFHEIV11,
  5607           DFHEIV99
  5608     MOVE EIBRESP  TO WS-RESPONSE
  5609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5610     DISPLAY ' AFTER START ' WS-RESPONSE
  5611     IF RESP-NORMAL
  5612        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5613           DISPLAY ' AH READNEXT '
  5614
  5615* EXEC CICS READNEXT
  5616*             DATASET   ('ELMSTR5')
  5617*             RIDFLD    (ELMSTR-KEY)
  5618*             INTO      (CLAIM-MASTER)
  5619*             RESP      (WS-RESPONSE)
  5620*          END-EXEC
  5621     MOVE LENGTH OF
  5622      CLAIM-MASTER
  5623       TO DFHEIV12
  5624     MOVE 'ELMSTR5' TO DFHEIV1
  5625     MOVE 0
  5626       TO DFHEIV11
  5627*    MOVE '&.IL                  )  N#00005198' TO DFHEIV0
  5628     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5629     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5630     MOVE X'204E233030303035313938' TO DFHEIV0(25:11)
  5631     CALL 'kxdfhei1' USING DFHEIV0,
  5632           DFHEIV1,
  5633           CLAIM-MASTER,
  5634           DFHEIV12,
  5635           ELMSTR-KEY,
  5636           DFHEIV99,
  5637           DFHEIV11,
  5638           DFHEIV99,
  5639           DFHEIV99
  5640     MOVE EIBRESP  TO WS-RESPONSE
  5641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5642        IF (RESP-NORMAL OR RESP-DUPKEY)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page  99
* SOCK03.cbl
  5643           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5644           AND (CM-CERT-NO = CL-CERT-NO)
  5645           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5646              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5647              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G')
  5648                 IF CLAIM-IS-OPEN
  5649                    DISPLAY ' FOUND OPEN AH CLAIM '
  5650                    MOVE ' OPEN HEALTH CLAIM '
  5651                                 TO WS-COMMENT
  5652                    MOVE 'H'     TO WS-AH-STATUS
  5653                 ELSE
  5654                    DISPLAY ' FOUND CLOSED AH CLAIM '
  5655                    MOVE ' CLOSED HEALTH CLAIM '
  5656                                 TO WS-COMMENT
  5657                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  5658                       MOVE CL-PAID-THRU-DT
  5659                                 TO WS-AH-BIN-PAID-THRU-DT
  5660                    END-IF
  5661                 END-IF
  5662              END-IF
  5663           END-IF
  5664        ELSE
  5665           SET I-SAY-TO-STOP TO TRUE
  5666        END-IF
  5667        END-PERFORM
  5668
  5669* EXEC CICS ENDBR
  5670*          DATASET   ('ELMSTR5')
  5671*       END-EXEC
  5672     MOVE 'ELMSTR5' TO DFHEIV1
  5673     MOVE 0
  5674       TO DFHEIV11
  5675*    MOVE '&2                    $   #00005230' TO DFHEIV0
  5676     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5678     MOVE X'2020233030303035323330' TO DFHEIV0(25:11)
  5679     CALL 'kxdfhei1' USING DFHEIV0,
  5680           DFHEIV1,
  5681           DFHEIV11,
  5682           DFHEIV99
  5683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5684     END-IF
  5685     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5686*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  5687        MOVE WS-AH-BIN-PAID-THRU-DT
  5688                                 TO DC-BIN-DATE-1
  5689        MOVE ' '                 TO DC-OPTION-CODE
  5690        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5691        IF NO-CONVERSION-ERROR
  5692           MOVE DC-GREG-DATE-CYMD
  5693                                 TO WS-CLM-PAID-THRU-DT
  5694        ELSE
  5695           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5696        END-IF
  5697        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  5698           MOVE 'CAN DT NOT > CLM CLOSE DT '
  5699                                 TO WS-COMMENT
  5700           MOVE 'P'              TO WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 100
* SOCK03.cbl
  5701           GO TO 0500-EXIT
  5702        END-IF
  5703     END-IF
  5704     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5705     IF CM-AH-CURRENT-STATUS = '8'
  5706        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  5707           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  5708                                 TO WS-COMMENT
  5709           MOVE 'C'              TO WS-AH-STATUS
  5710           GO TO 0500-EXIT
  5711        END-IF
  5712     END-IF
  5713     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  5714        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  5715           MOVE ' SETTLEMENT CLAIM APPLIED '
  5716                                 TO WS-COMMENT
  5717           MOVE 'S'              TO WS-AH-STATUS
  5718*          PERFORM 0030-BUILD-BUFFER
  5719*                                THRU 0030-EXIT
  5720*          IF NOT ALREADY-SENT
  5721*             PERFORM 0020-SEND-BUFFER
  5722*                                THRU 0020-EXIT
  5723*             SET ALREADY-SENT   TO TRUE
  5724*          END-IF
  5725           GO TO 0500-EXIT
  5726*          PERFORM 0025-CLOSE-SOCKET
  5727*                                THRU 0025-EXIT
  5728*          GO TO 0010-RETURN
  5729        END-IF
  5730     END-IF
  5731     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5732        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  5733        MOVE 'AH COVERAGE EXPIRED '
  5734                                 TO WS-COMMENT
  5735        MOVE 'E'                 TO WS-AH-STATUS
  5736        GO TO 0500-EXIT
  5737     END-IF
  5738     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  5739                                    WS-AH-PREM
  5740     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  5741     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  5742        * CP-REMAINING-TERM-1
  5743     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  5744                                     WS-AH-REM-TERM
  5745     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5746     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5747     IF WS-AH-ST-REFUND-CALC > ZERO
  5748         MOVE WS-AH-ST-REFUND-CALC
  5749                                 TO  CP-EARNING-METHOD.
  5750     IF WS-AH-FO-REFUND-CALC > ZERO
  5751         MOVE WS-AH-FO-REFUND-CALC
  5752                                 TO  CP-EARNING-METHOD.
  5753     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5754     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5755     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5756                                     CP-RATING-BENEFIT-AMT.
  5757     IF CP-STATE-STD-ABBRV = 'OR'
  5758         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 101
* SOCK03.cbl
  5759                                         CM-AH-ORIG-TERM.
  5760     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5761     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  5762     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5763     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  5764     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5765     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  5766     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5767     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5768     MOVE ' '                    TO  DC-OPTION-CODE.
  5769     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5770     IF CP-STATE-STD-ABBRV = 'OH'
  5771        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5772         IF (CP-ORIGINAL-TERM > 60)
  5773           AND (DC-GREG-DATE-1-YMD > '831101')
  5774           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  5775             MOVE '6'            TO  CP-EARNING-METHOD
  5776         END-IF
  5777        END-IF
  5778        IF WS-COMP-ID = 'CID'
  5779           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  5780                           LOW-VALUES)
  5781              IF CP-CRITICAL-PERIOD
  5782                 MOVE '2'       TO CP-EARNING-METHOD
  5783              ELSE
  5784                 MOVE '6'       TO CP-EARNING-METHOD
  5785              END-IF
  5786           ELSE
  5787              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  5788                 MOVE '2'       TO CP-EARNING-METHOD
  5789              ELSE
  5790                 IF ((CM-LF-ORIG-TERM > 60) AND
  5791                    (CM-RATE-CLASS NOT = 'L '))
  5792                               OR
  5793                    (WS-LF-CO-EARNINGS-CALC = '5')
  5794                    IF CP-CRITICAL-PERIOD
  5795                       MOVE '2'  TO CP-EARNING-METHOD
  5796                    ELSE
  5797                       MOVE '6'  TO CP-EARNING-METHOD
  5798                    END-IF
  5799                 ELSE
  5800                    MOVE '1'     TO CP-EARNING-METHOD
  5801                 END-IF
  5802              END-IF
  5803           END-IF
  5804        END-IF
  5805     END-IF
  5806     IF CP-STATE-STD-ABBRV = 'VA'
  5807       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5808         IF DC-GREG-DATE-1-YMD > '921231'
  5809            IF CP-ORIGINAL-TERM > 61
  5810                MOVE '6'            TO  CP-EARNING-METHOD
  5811            ELSE
  5812                MOVE '1'            TO  CP-EARNING-METHOD.
  5813     IF CP-EARN-AS-NET-PAY
  5814        IF CP-LOAN-APR <= ZEROS
  5815           IF WS-CF-DEFAULT-APR > ZEROS
  5816              MOVE WS-CF-DEFAULT-APR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 102
* SOCK03.cbl
  5817                                 TO  CP-LOAN-APR
  5818           END-IF
  5819        END-IF
  5820     END-IF
  5821     IF WS-COMP-ID = 'DCC'
  5822        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  5823           AND (CP-EARNING-METHOD NOT = 'G')
  5824           MOVE 'S'              TO CP-EARNING-METHOD
  5825        END-IF
  5826     END-IF
  5827     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5828     IF (CP-ERROR-RATE-IS-ZERO)
  5829        OR (CP-ERROR-RATE-NOT-FOUND)
  5830        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5831        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  5832          DELIMITED BY SIZE INTO WS-COMMENT
  5833        END-STRING
  5834        IF WS-AH-STATUS NOT = 'H'
  5835           MOVE 'X'                 TO WS-AH-STATUS
  5836        END-IF
  5837        GO TO 0500-EXIT
  5838*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5839*       IF NOT ALREADY-SENT
  5840*          PERFORM 0020-SEND-BUFFER
  5841*                                THRU 0020-EXIT
  5842*          SET ALREADY-SENT      TO TRUE
  5843*       END-IF
  5844*       PERFORM 0025-CLOSE-SOCKET
  5845*                                THRU 0025-EXIT
  5846*       GO TO 0010-RETURN
  5847     END-IF
  5848     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  5849                                    WS-TOT-AH-RFND
  5850     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  5851     IF ((WS-AH-STATUS = SPACES)
  5852        OR (CP-CALC-REFUND > ZEROS))
  5853                  AND
  5854          (WS-AH-STATUS NOT = 'H')
  5855        MOVE 'A'                 TO WS-AH-STATUS
  5856     END-IF
  5857     EVALUATE TRUE
  5858        WHEN CP-R-AS-R78
  5859           MOVE 'RULE 78'          TO  WS-AH-METHOD
  5860        WHEN CP-R-AS-PRORATA
  5861           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  5862        WHEN CP-REFUND-TYPE-USED = '3'
  5863           MOVE 'CALIF'            TO  WS-AH-METHOD
  5864        WHEN CP-R-AS-TEXAS
  5865           MOVE 'IRREG'            TO  WS-AH-METHOD
  5866        WHEN CP-R-AS-FARM-PLAN
  5867           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  5868        WHEN CP-R-AS-NET-PAY
  5869           MOVE 'NET PAY'          TO  WS-AH-METHOD
  5870        WHEN CP-R-AS-ANTICIPATION
  5871           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  5872        WHEN CP-R-AS-MEAN
  5873           MOVE 'MEAN'             TO  WS-AH-METHOD
  5874        WHEN CP-R-AS-SUM-OF-DIGITS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 103
* SOCK03.cbl
  5875           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  5876        WHEN CP-GAP-ACTUARIAL
  5877           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  5878     END-EVALUATE
  5879     IF WS-TOT-AH-RFND > ZEROS
  5880        COMPUTE WS-WORK-FACTOR ROUNDED =
  5881           WS-TOT-AH-RFND / WS-TOT-AH-PREM
  5882        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  5883           WS-TOT-AH-COMM
  5884     END-IF
  5885     IF ERACCT-FOUND
  5886        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5887           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5888        END-IF
  5889        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5890           IF (AM-COMM-CHARGEBACK (1) = 99)
  5891                     OR
  5892              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5893                     OR
  5894              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5895              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5896              MOVE ZEROS         TO WS-AH-UEC
  5897           END-IF
  5898        END-IF
  5899     END-IF
  5900     .
  5901 0500-EXIT.
  5902     EXIT.
  5903 0700-LINK-REM-TERM.
  5904
  5905* EXEC CICS LINK
  5906*        PROGRAM   ('ELRTRM')
  5907*        COMMAREA  (CALCULATION-PASS-AREA)
  5908*        LENGTH    (CP-COMM-LENGTH)
  5909*    END-EXEC.
  5910     MOVE 'ELRTRM' TO DFHEIV1
  5911*    MOVE '."C                   ''   #00005453' TO DFHEIV0
  5912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5914     MOVE X'2020233030303035343533' TO DFHEIV0(25:11)
  5915     CALL 'kxdfhei1' USING DFHEIV0,
  5916           DFHEIV1,
  5917           CALCULATION-PASS-AREA,
  5918           CP-COMM-LENGTH,
  5919           DFHEIV99,
  5920           DFHEIV99,
  5921           DFHEIV99
  5922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5923
  5924 0700-EXIT.
  5925     EXIT.
  5926 0710-LINK-REM-AMOUNT.
  5927
  5928* EXEC CICS LINK
  5929*        PROGRAM   ('ELRAMT')
  5930*        COMMAREA  (CALCULATION-PASS-AREA)
  5931*        LENGTH    (CP-COMM-LENGTH)
  5932*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 104
* SOCK03.cbl
  5933     MOVE 'ELRAMT' TO DFHEIV1
  5934*    MOVE '."C                   ''   #00005461' TO DFHEIV0
  5935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5937     MOVE X'2020233030303035343631' TO DFHEIV0(25:11)
  5938     CALL 'kxdfhei1' USING DFHEIV0,
  5939           DFHEIV1,
  5940           CALCULATION-PASS-AREA,
  5941           CP-COMM-LENGTH,
  5942           DFHEIV99,
  5943           DFHEIV99,
  5944           DFHEIV99
  5945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5946     .
  5947 0710-EXIT.
  5948     EXIT.
  5949 0720-LINK-REFUND.
  5950
  5951* EXEC CICS LINK
  5952*        PROGRAM   ('ELRFND')
  5953*        COMMAREA  (CALCULATION-PASS-AREA)
  5954*        LENGTH    (CP-COMM-LENGTH)
  5955*    END-EXEC
  5956     MOVE 'ELRFND' TO DFHEIV1
  5957*    MOVE '."C                   ''   #00005470' TO DFHEIV0
  5958     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5960     MOVE X'2020233030303035343730' TO DFHEIV0(25:11)
  5961     CALL 'kxdfhei1' USING DFHEIV0,
  5962           DFHEIV1,
  5963           CALCULATION-PASS-AREA,
  5964           CP-COMM-LENGTH,
  5965           DFHEIV99,
  5966           DFHEIV99,
  5967           DFHEIV99
  5968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5969     .
  5970 0720-EXIT.
  5971     EXIT.
  5972 9700-DATE-LINK.
  5973
  5974* EXEC CICS LINK
  5975*         PROGRAM  ('ELDATCV')
  5976*         COMMAREA (DATE-CONVERSION-DATA)
  5977*         LENGTH   (DC-COMM-LENGTH)
  5978*    END-EXEC.
  5979     MOVE 'ELDATCV' TO DFHEIV1
  5980*    MOVE '."C                   ''   #00005479' TO DFHEIV0
  5981     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5983     MOVE X'2020233030303035343739' TO DFHEIV0(25:11)
  5984     CALL 'kxdfhei1' USING DFHEIV0,
  5985           DFHEIV1,
  5986           DATE-CONVERSION-DATA,
  5987           DC-COMM-LENGTH,
  5988           DFHEIV99,
  5989           DFHEIV99,
  5990           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:57 Page 105
* SOCK03.cbl
  5991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5992
  5993 9700-EXIT.
  5994      EXIT.
  5995
  5996 9999-DFHBACK SECTION.
  5997     MOVE '9%                    "   ' TO DFHEIV0
  5998     MOVE 'SOCK03' TO DFHEIV1
  5999     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6000     GOBACK.
  6001 9999-DFHEXIT.
  6002     IF DFHEIGDJ EQUAL 0001
  6003         NEXT SENTENCE.
  6004     MOVE '9%                    "   ' TO DFHEIV0
  6005     MOVE 'SOCK03' TO DFHEIV1
  6006     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6007     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       16688     Code:       26138
