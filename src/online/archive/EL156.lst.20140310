* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49******************************************************************
    50
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   3
* EL156.cbl
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
    55
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER  PIC X(32)  VALUE '********************************'.
    60 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    61 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    62 77  WS-SSN  PIC X(9) VALUE ZEROS.
    63 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    64 77  C0                          PIC S999 COMP-3 VALUE +0.
    65 77  C1                          PIC S999 COMP-3 VALUE +0.
    66 77  C2                          PIC S999 COMP-3 VALUE +0.
    67 77  C3                          PIC S999 COMP-3 VALUE +0.
    68 77  s1                          PIC S999 COMP-3 VALUE +0.
    69 77  s2                          pic s999 comp-3 value +0.
    70 77  P1                          PIC S999 COMP-3 VALUE +0.
    71 77  DD-IU-SW                    PIC X   VALUE ' '.
    72     88  DD-IU-PRESENT                 VALUE 'Y'.
    73 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    74 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    75 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    76 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    77 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    78 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    79 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    80 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    81 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    82
    83*    COPY ELCSCTM.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCTM                             *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-MESSAGE.
    94     12  FILLER                          PIC X(30)
    95            VALUE '** LOGIC SECURITY VIOLATION -'.
    96     12  SM-READ                         PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' PGM='.
    99     12  SM-PGM                          PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' OPR='.
   102     12  SM-PROCESSOR-ID                 PIC X(4).
   103     12  FILLER                          PIC X(6)
   104            VALUE ' TERM='.
   105     12  SM-TERMID                       PIC X(4).
   106     12  FILLER                          PIC XX   VALUE SPACE.
   107     12  SM-JUL-DATE                     PIC 9(5).
   108     12  FILLER                          PIC X    VALUE SPACE.
   109     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   4
* EL156.cbl
   110
   111
   112*    COPY ELCSCRTY.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCRTY                            *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   120*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   121*        SAVED IN PI-SECURITY-ADDRESS.                           *
   122*                                                                *
   123******************************************************************
   124 01  SECURITY-CONTROL.
   125     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   126     12  FILLER                       PIC XX    VALUE 'SC'.
   127     12  SC-CREDIT-CODES.
   128         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   129             20  SC-CREDIT-DISPLAY    PIC X.
   130             20  SC-CREDIT-UPDATE     PIC X.
   131     12  SC-CLAIMS-CODES.
   132         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   133             20  SC-CLAIMS-DISPLAY    PIC X.
   134             20  SC-CLAIMS-UPDATE     PIC X.
   135
   136 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   137 01  WS-DATE-AREA.
   138     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   139     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   140     12  SAVE-DATE-CCYYMMDD.
   141         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   142         16  SAVE-DATE-YMD.
   143             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   144             20  FILLER              PIC X(04)   VALUE SPACES.
   145
   146 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   147 01  STANDARD-AREAS.
   148     12  WS-RESPONSE         PIC S9(8)   COMP.
   149         88  WS-RESP-NORMAL              VALUE +00.
   150         88  WS-RESP-ERROR               VALUE +01.
   151         88  WS-RESP-NOTFND              VALUE +13.
   152         88  WS-RESP-DUPREC              VALUE +14.
   153         88  WS-RESP-ENDFILE             VALUE +20.
   154     12  PMT-HEAD-A.
   155         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   156         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   157         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   158-        '     RESERVES  TYPE    AMOUNT'.
   159     12  PMT-HEAD-B.
   160         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   161         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   162         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   163     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   164     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   165     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   166     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   167     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   5
* EL156.cbl
   168     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   169     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   170     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   171     12  PGM-NAME            PIC X(8).
   172     12  TIME-IN             PIC S9(7).
   173     12  TIME-OUT-R  REDEFINES TIME-IN.
   174         16  FILLER          PIC X.
   175         16  TIME-OUT        PIC 99V99.
   176         16  FILLER          PIC XX.
   177     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   178     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   179     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   180     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   181     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   182     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   183     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   184     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   185     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   186     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   187     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   188     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   189     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   190     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   191     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   192     12  WS-BLANK            PIC X       VALUE ' '.
   193
   194 01  MISC-WORK-AREAS.
   195     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   196     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   197     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   198     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   199     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   200     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   201     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   202     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   203     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   204     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   205     12  W-CALLED-NAME           PIC X(08).
   206     12  W-EOB-CODES.
   207         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   208             20  W-EOB-CODE      PIC XXX.
   209             20  W-EOB-FILLER    PIC X.
   210     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   211     12  W-NAME-LAST             PIC X(15).
   212     12  W-NAME-FIRST            PIC X(15).
   213     12  W-NAME-MIDDLE.
   214         16  FILLER              PIC X.
   215         16  W-NAME-MIDDLE-2     PIC X.
   216         16  FILLER              PIC X(13).
   217     12  W-DMD-CHECK-NO.
   218         16  W-DMD-CHECK-NO-1    PIC X(4).
   219         16  W-DMD-CHECK-NO-2    PIC X.
   220         16  W-DMD-CHECK-NO-3    PIC XX.
   221
   222     12  WS-COMPUTE-FROM-DT  PIC XX.
   223     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   224     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   225     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   6
* EL156.cbl
   226     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   227     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   228     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   229         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   230         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   231     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   232         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   233     12  WS-UPDATE-SW        PIC X VALUE ' '.
   234     12  WS-GROUPING.
   235         16  WS-GROUP-1      PIC X VALUE SPACES.
   236         16  FILLER          PIC X(05) VALUE SPACES.
   237     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   238     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   239     12  WS-WORK-STATE-ACCT.
   240         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   241         16  FILLER          PIC X       VALUE '/'.
   242         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   243     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   244     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   245     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   246     12  QID.
   247         16  QID-TERM        PIC X(4)    VALUE SPACES.
   248         16  FILLER          PIC X(4)    VALUE '156A'.
   249     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   250     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   251     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   252     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   253     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   254     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   255     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   256     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   257     12  WS-STATUS           PIC X       VALUE SPACES.
   258     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   259     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   260     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   261     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   262     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   263     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   264     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   265     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   266     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   267     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   268     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   269     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   270     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   271     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   272     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   273     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   274     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   275     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   276     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   277     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   278     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   279     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   280     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   281     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   282     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   283     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   7
* EL156.cbl
   284     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   285     12  WORK-DATE-FROM.
   286         16  WDF-MONTH       PIC 99        VALUE ZERO.
   287         16  WDF-DAY         PIC 99        VALUE ZERO.
   288         16  WDF-YEAR        PIC 99        VALUE ZERO.
   289     12  WORK-DATE-THRU.
   290         16  WDT-MONTH       PIC 99        VALUE ZERO.
   291         16  WDT-DAY         PIC 99        VALUE ZERO.
   292         16  WDT-YEAR        PIC 99        VALUE ZERO.
   293     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   294     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   295     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   296     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   297     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   298     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   299     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   300     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   301     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   302     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   303     12  WS-PY-WK REDEFINES WS-PY-WORK.
   304         16  WS-PY-NUM       PIC S9(7)V99.
   305         16  WS-PY-SIGN      PIC X.
   306     12  WS-DY-WORK          PIC S9(5).
   307     12  WS-DY-WK REDEFINES WS-DY-WORK.
   308         16  WS-DY-NUM       PIC S9(4).
   309         16  WS-DY-SIGN      PIC X.
   310     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   311         88  COMP-REC-FOUND              VALUE 'Y'.
   312     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   313         88  BENEFIT-FOUND       VALUE 'Y'.
   314         88  NO-BENEFIT-FOUND    VALUE 'N'.
   315     12  WS-TERMS.
   316         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   317         16  FILLER          PIC X       VALUE '/'.
   318         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   319         16  WST-REM-DAYS-GRP.
   320             20  WST-SLASH   PIC X       VALUE '/'.
   321             20  WST-REM-DAYS
   322                             PIC --9.
   323     12  WS-ACCESS.
   324         16  FILLER          PIC XX      VALUE SPACES.
   325         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   326     12  WS-STATE-ACCESS.
   327         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   328         16  FILLER          PIC XX      VALUE SPACES.
   329     12  WS-CARR-ACCESS.
   330         16  FILLER          PIC X(3)    VALUE SPACES.
   331         16  WS-CARR         PIC X       VALUE SPACES.
   332     12  DATE-WORK.
   333         16  FILLER          PIC XX      VALUE SPACES.
   334         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   335     12  WS-SAVE-INPUT.
   336         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   337         16  WS-PAYEE        PIC XX      VALUE SPACE.
   338         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   339         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   340         16  WS-OFFLINE      PIC X       VALUE SPACE.
   341         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   8
* EL156.cbl
   342         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   343         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   344         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   345         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   346         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   347         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   348         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   349         16  WS-ETYPE        PIC X       VALUE SPACE.
   350         16  WS-CASH         PIC X       VALUE SPACE.
   351         16  WS-GROUPED      PIC X       VALUE SPACE.
   352         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   353         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   354         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   355         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   356         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   357         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   358         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   359         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   360     12  LAST-ERROR-LINE.
   361         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   362         16  FILLER              PIC X(30)
   363             VALUE ' FATAL ERRORS ENCOUNTERED'.
   364         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   365         16  FILLER              PIC X(28)
   366             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   367     12  WS-CHECK-AREA.
   368         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   369         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   370     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   371     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   372         16  FILLER              PIC XX.
   373         16  WS-A-CHECK-NUM-5    PIC 9(5).
   374     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   375         16  FILLER              PIC X.
   376         16  WS-A-CHECK-NUM-6    PIC 9(6).
   377     12  OPTION-1-SAVE-AREA.
   378         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   379         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   380     12  WS-WORK-ZIP.
   381         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   382         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   383     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   384                                 PIC 9(9).
   385     12  WS-FLI-PMTNOTE.
   386         16  WS-PMTOPTION        PIC XX.
   387         16  WS-DOCNAME          PIC X(28).
   388         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   389             20  WS-AMOUNT       PIC X(8).
   390             20  FILLER          PIC X(20).
   391         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   392             20  WS-NUM-AMT      PIC 9(6)V99.
   393             20  FILLER          PIC X(20).
   394
   395     12  WS-HAN-PMTNOTE.
   396         16  WS-HAN-PMT-CODE     PIC X.
   397         16  WS-HAN-PMT-NOTE     PIC X(39).
   398
   399     12  WS-NCL-PMT-OPTION       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   9
* EL156.cbl
   400         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   401
   402     12  WS-CLAIM-SEQUENCE.
   403         16  FILLER              PIC X VALUE '('.
   404         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   405         16  FILLER              PIC X(04) VALUE ' OF '.
   406         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   407         16  FILLER              PIC X VALUE ')'.
   408
   409     12  WS-REFUND-AMT           PIC Z(7).99.
   410     12  WS-CALC-INT             PIC S9(7)V99.
   411     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   412
   413     12  SUB                     PIC 99 VALUE ZEROS.
   414
   415     12  WS-BOANOTE1.
   416         16  WS-BOANOTE1-DESC    PIC X(11).
   417         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   418         16  FILLER              PIC X(17).
   419     12  WS-BOANOTE2.
   420         16  WS-BOANOTE2-DESC    PIC X(11).
   421         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   422         16  FILLER              PIC X(17).
   423
   424     12  WS-NCLNOTE1.
   425         16  WS-NCLNOTE1-DESC    PIC X(11).
   426         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   427         16  FILLER              PIC X(17).
   428     12  WS-NCLNOTE2.
   429         16  WS-NCLNOTE2-DESC    PIC X(11).
   430         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   431         16  FILLER              PIC X(17).
   432
   433     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   434     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   435     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   436     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   437     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   438     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   439     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   440     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   441     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   442     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   443
   444     12  WS-AIG-WORK-AREAS.
   445         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   446             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   447         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   448             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   449         16  WS-FROM-DATE-MDY.
   450             20  WS-FROM-MO      PIC 99.
   451             20  WS-FROM-DA      PIC 99.
   452             20  WS-FROM-YR      PIC 99.
   453         16  WS-TEMP-DATE-MDY.
   454             20  WS-TEMP-MO      PIC 99.
   455             20  WS-TEMP-DA      PIC 99.
   456             20  WS-TEMP-YR      PIC 99.
   457         16  WS-BIN-FROM-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  10
* EL156.cbl
   458         16  WS-TEMP-INC-MDY.
   459             20  WS-TEMP-INC-MO  PIC 99.
   460             20  WS-TEMP-INC-DA  PIC 99.
   461             20  WS-TEMP-INC-YR  PIC 99.
   462         16  WS-PMT-DUE-MDY.
   463             20  WS-PMT-DUE-MO   PIC 99.
   464             20  WS-PMT-DUE-DA   PIC 99.
   465             20  WS-PMT-DUE-YR   PIC 99.
   466         16  WS-PMT-DUE-DT       PIC XX.
   467         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   468         16  WS-RETRO-ELIM-DT    PIC XX.
   469         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   470             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   471         16  WS-SAVE-DUE-DA      PIC 99.
   472         16  WS-CDAYS            PIC S9(05).
   473         16  WS-DAYS-OFF         PIC S9(05).
   474         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   475             88  ELIM-SATISFIED            VALUE 'Y'.
   476         16  WS-AIG-CHECKNO.
   477             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   478             20  WS-A-CHECKNO-3-7.
   479                 24  FILLER              PIC X(3)    VALUE SPACES.
   480                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   481                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   482         16  WS-AIG-GROUPING.
   483             20  WS-A-BENE               PIC XXX.
   484             20  FILLER                  PIC XXX.
   485         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   486             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   487             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   488         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   489                 VALUE 'UNEMPLOYMENT PAYMENT'.
   490         16  WS-CHK-THRU-DT              PIC XX.
   491         16  WS-HOLD-BIN-DATE-1          PIC XX.
   492
   493 01  MISC-CSO-AREA.
   494     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   495     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   496     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   497         88  APPROVAL-NEEDED                        VALUE 'Y'.
   498     12  WS-APPROV-NOTE                  PIC X(43)
   499         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   500     12  WS-REAUDIT-NOTE                 PIC X(43)
   501         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   502     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   503     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   504     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   505     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   506     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   507     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   508     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   509         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   510     12  WS-PAYEE-CITY-STATE     PIC X(30).
   511     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   512         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   513     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   514     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   515     12  WS-WORK-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  11
* EL156.cbl
   516     12  FILLER  REDEFINES WS-WORK-NAME.
   517         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   518     12  WS-INSURED-NAME         PIC X(30).
   519     12  FILLER  REDEFINES WS-INSURED-NAME.
   520         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   521     12  WS-PAYEE-NAME           PIC X(30).
   522     12  FILLER  REDEFINES WS-PAYEE-NAME.
   523         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   524
   525 01  ERROR-MESSAGES.
   526     12  ER-0000                 PIC X(4)  VALUE '0000'.
   527     12  ER-0004                 PIC X(4)  VALUE '0004'.
   528     12  ER-0008                 PIC X(4)  VALUE '0008'.
   529     12  ER-0019                 PIC X(4)  VALUE '0019'.
   530     12  ER-0029                 PIC X(4)  VALUE '0029'.
   531     12  ER-0042                 PIC X(4)  VALUE '0042'.
   532     12  ER-0070                 PIC X(4)  VALUE '0070'.
   533     12  ER-0130                 PIC X(4)  VALUE '0130'.
   534     12  ER-0149                 PIC X(4)  VALUE '0149'.
   535     12  ER-0154                 PIC X(4)  VALUE '0154'.
   536     12  ER-0168                 PIC X(4)  VALUE '0168'.
   537     12  ER-0169                 PIC X(4)  VALUE '0169'.
   538     12  ER-0172                 PIC X(4)  VALUE '0174'.
   539     12  ER-0198                 PIC X(4)  VALUE '0198'.
   540     12  ER-0204                 PIC X(4)  VALUE '0204'.
   541     12  ER-0206                 PIC X(4)  VALUE '0206'.
   542     12  ER-0252                 PIC X(4)  VALUE '0252'.
   543     12  ER-0254                 PIC X(4)  VALUE '0254'.
   544     12  ER-0282                 PIC X(4)  VALUE '0282'.
   545     12  ER-0283                 PIC X(4)  VALUE '0283'.
   546     12  ER-0294                 PIC X(4)  VALUE '0294'.
   547     12  ER-0338                 PIC X(4)  VALUE '0338'.
   548     12  ER-0419                 PIC X(4)  VALUE '0419'.
   549     12  ER-0420                 PIC X(4)  VALUE '0420'.
   550     12  ER-0421                 PIC X(4)  VALUE '0421'.
   551     12  ER-0422                 PIC X(4)  VALUE '0422'.
   552     12  ER-0433                 PIC X(4)  VALUE '0433'.
   553     12  ER-0436                 PIC X(4)  VALUE '0436'.
   554     12  ER-0437                 PIC X(4)  VALUE '0437'.
   555     12  ER-0438                 PIC X(4)  VALUE '0438'.
   556     12  ER-0439                 PIC X(4)  VALUE '0439'.
   557     12  ER-0440                 PIC X(4)  VALUE '0440'.
   558     12  ER-0441                 PIC X(4)  VALUE '0441'.
   559     12  ER-0442                 PIC X(4)  VALUE '0442'.
   560     12  ER-0443                 PIC X(4)  VALUE '0443'.
   561     12  ER-0444                 PIC X(4)  VALUE '0444'.
   562     12  ER-0445                 PIC X(4)  VALUE '0445'.
   563     12  ER-0446                 PIC X(4)  VALUE '0446'.
   564     12  ER-0447                 PIC X(4)  VALUE '0447'.
   565     12  ER-0448                 PIC X(4)  VALUE '0448'.
   566     12  ER-0449                 PIC X(4)  VALUE '0449'.
   567     12  ER-0452                 PIC X(4)  VALUE '0452'.
   568     12  ER-0458                 PIC X(4)  VALUE '0458'.
   569     12  ER-0459                 PIC X(4)  VALUE '0459'.
   570     12  ER-0460                 PIC X(4)  VALUE '0460'.
   571     12  ER-0461                 PIC X(4)  VALUE '0461'.
   572     12  ER-0462                 PIC X(4)  VALUE '0462'.
   573     12  ER-0463                 PIC X(4)  VALUE '0463'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  12
* EL156.cbl
   574     12  ER-0464                 PIC X(4)  VALUE '0464'.
   575     12  ER-0465                 PIC X(4)  VALUE '0465'.
   576     12  ER-0466                 PIC X(4)  VALUE '0466'.
   577     12  ER-0467                 PIC X(4)  VALUE '0467'.
   578     12  ER-0468                 PIC X(4)  VALUE '0468'.
   579     12  ER-0469                 PIC X(4)  VALUE '0469'.
   580     12  ER-0473                 PIC X(4)  VALUE '0473'.
   581     12  ER-0474                 PIC X(4)  VALUE '0474'.
   582     12  ER-0475                 PIC X(4)  VALUE '0475'.
   583     12  ER-0476                 PIC X(4)  VALUE '0476'.
   584     12  ER-0477                 PIC X(4)  VALUE '0477'.
   585     12  ER-0478                 PIC X(4)  VALUE '0478'.
   586     12  ER-0479                 PIC X(4)  VALUE '0479'.
   587     12  ER-0481                 PIC X(4)  VALUE '0481'.
   588     12  ER-0491                 PIC X(4)  VALUE '0491'.
   589     12  ER-0492                 PIC X(4)  VALUE '0492'.
   590     12  ER-0493                 PIC X(4)  VALUE '0493'.
   591     12  ER-0494                 PIC X(4)  VALUE '0494'.
   592     12  ER-0495                 PIC X(4)  VALUE '0495'.
   593     12  ER-0499                 PIC X(4)  VALUE '0499'.
   594     12  ER-0500                 PIC X(4)  VALUE '0500'.
   595     12  ER-0501                 PIC X(4)  VALUE '0501'.
   596     12  ER-0502                 PIC X(4)  VALUE '0502'.
   597     12  ER-0508                 PIC X(4)  VALUE '0508'.
   598     12  ER-0513                 PIC X(4)  VALUE '0513'.
   599     12  ER-0518                 PIC X(4)  VALUE '0518'.
   600     12  ER-0524                 PIC X(4)  VALUE '0524'.
   601     12  ER-0525                 PIC X(4)  VALUE '0525'.
   602     12  ER-0526                 PIC X(4)  VALUE '0526'.
   603     12  ER-0530                 PIC X(4)  VALUE '0530'.
   604     12  ER-0540                 PIC X(4)  VALUE '0540'.
   605     12  ER-0541                 PIC X(4)  VALUE '0541'.
   606     12  ER-0542                 PIC X(4)  VALUE '0542'.
   607     12  ER-0543                 PIC X(4)  VALUE '0543'.
   608     12  ER-0545                 PIC X(4)  VALUE '0545'.
   609     12  ER-0552                 PIC X(4)  VALUE '0552'.
   610     12  ER-0555                 PIC X(4)  VALUE '0555'.
   611     12  ER-0556                 PIC X(4)  VALUE '0556'.
   612     12  ER-0557                 PIC X(4)  VALUE '0557'.
   613     12  ER-0572                 PIC X(4)  VALUE '0572'.
   614     12  ER-0573                 PIC X(4)  VALUE '0573'.
   615     12  ER-0594                 PIC X(4)  VALUE '0594'.
   616     12  ER-0616                 PIC X(4)  VALUE '0616'.
   617     12  ER-0617                 PIC X(4)  VALUE '0617'.
   618     12  ER-0618                 PIC X(4)  VALUE '0618'.
   619     12  ER-0657                 PIC X(4)  VALUE '0657'.
   620     12  ER-0658                 PIC X(4)  VALUE '0658'.
   621     12  ER-0699                 PIC X(4)  VALUE '0699'.
   622     12  ER-0730                 PIC X(4)  VALUE '0730'.
   623     12  ER-0737                 PIC X(4)  VALUE '0737'.
   624     12  ER-0760                 PIC X(4)  VALUE '0760'.
   625     12  ER-0768                 PIC X(4)  VALUE '0768'.
   626     12  ER-0769                 PIC X(4)  VALUE '0769'.
   627     12  ER-0770                 PIC X(4)  VALUE '0770'.
   628     12  ER-0802                 PIC X(4)  VALUE '0802'.
   629     12  ER-0803                 PIC X(4)  VALUE '0803'.
   630     12  ER-0819                 PIC X(4)  VALUE '0819'.
   631     12  ER-0834                 PIC X(4)  VALUE '0834'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  13
* EL156.cbl
   632     12  ER-0836                 PIC X(4)  VALUE '0836'.
   633     12  ER-0844                 PIC X(4)  VALUE '0844'.
   634     12  ER-0845                 PIC X(4)  VALUE '0845'.
   635     12  ER-0846                 PIC X(4)  VALUE '0846'.
   636     12  ER-0849                 PIC X(4)  VALUE '0849'.
   637     12  ER-0851                 PIC X(4)  VALUE '0851'.
   638     12  ER-0872                 PIC X(4)  VALUE '0872'.
   639     12  ER-0873                 PIC X(4)  VALUE '0873'.
   640     12  ER-0874                 PIC X(4)  VALUE '0874'.
   641     12  ER-0879                 PIC X(4)  VALUE '0879'.
   642     12  ER-0919                 PIC X(4)  VALUE '0919'.
   643     12  ER-0921                 PIC X(4)  VALUE '0921'.
   644     12  ER-0923                 PIC X(4)  VALUE '0923'.
   645     12  ER-0925                 PIC X(4)  VALUE '0925'.
   646     12  ER-0944                 PIC X(4)  VALUE '0944'.
   647     12  ER-0945                 PIC X(4)  VALUE '0945'.
   648     12  ER-0946                 PIC X(4)  VALUE '0946'.
   649     12  ER-0947                 PIC X(4)  VALUE '0947'.
   650     12  ER-0948                 PIC X(4)  VALUE '0948'.
   651     12  ER-0949                 PIC X(4)  VALUE '0949'.
   652     12  ER-0950                 PIC X(4)  VALUE '0950'.
   653     12  ER-0951                 PIC X(4)  VALUE '0951'.
   654     12  ER-0954                 PIC X(4)  VALUE '0954'.
   655     12  ER-0956                 PIC X(4)  VALUE '0956'.
   656     12  ER-0967                 PIC X(4)  VALUE '0967'.
   657     12  ER-0968                 PIC X(4)  VALUE '0968'.
   658     12  ER-0974                 PIC X(4)  VALUE '0974'.
   659     12  ER-0975                 PIC X(4)  VALUE '0975'.
   660     12  ER-1561                 PIC X(4)  VALUE '1561'.
   661     12  ER-1566                 PIC X(4)  VALUE '1566'.
   662     12  ER-1567                 PIC X(4)  VALUE '1567'.
   663     12  ER-1569                 PIC X(4)  VALUE '1569'.
   664     12  er-1657                 pic x(4)  value '1657'.
   665     12  er-1658                 pic x(4)  value '1658'.
   666     12  ER-1775                 PIC X(4)  VALUE '1775'.
   667     12  ER-1880                 PIC X(4)  VALUE '1880'.
   668     12  ER-2044                 PIC X(4)  VALUE '2044'.
   669     12  ER-3140                 PIC X(4)  VALUE '3140'.
   670     12  ER-3141                 PIC X(4)  VALUE '3141'.
   671     12  ER-3255                 PIC X(4)  VALUE '3255'.
   672     12  ER-3516                 PIC X(4)  VALUE '3516'.
   673     12  ER-3527                 PIC X(4)  VALUE '3527'.
   674     12  ER-3528                 PIC X(4)  VALUE '3528'.
   675     12  ER-3529                 PIC X(4)  VALUE '3529'.
   676     12  ER-3530                 PIC X(4)  VALUE '3530'.
   677     12  ER-3531                 PIC X(4)  VALUE '3531'.
   678     12  ER-3532                 PIC X(4)  VALUE '3532'.
   679     12  ER-3533                 PIC X(4)  VALUE '3533'.
   680     12  ER-3534                 PIC X(4)  VALUE '3534'.
   681     12  ER-3535                 PIC X(4)  VALUE '3535'.
   682     12  ER-3536                 PIC X(4)  VALUE '3536'.
   683     12  ER-3537                 PIC X(4)  VALUE '3537'.
   684     12  ER-3538                 PIC X(4)  VALUE '3538'.
   685     12  ER-3539                 PIC X(4)  VALUE '3539'.
   686     12  ER-3540                 PIC X(4)  VALUE '3540'.
   687     12  ER-3541                 PIC X(4)  VALUE '3541'.
   688     12  ER-3542                 PIC X(4)  VALUE '3542'.
   689     12  ER-3543                 PIC X(4)  VALUE '3543'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  14
* EL156.cbl
   690     12  ER-3546                 PIC X(4)  VALUE '3546'.
   691     12  ER-3549                 PIC X(4)  VALUE '3549'.
   692     12  ER-3818                 PIC X(4)  VALUE '3818'.
   693     12  ER-7540                 PIC X(4)  VALUE '7540'.
   694     12  ER-7576                 PIC X(4)  VALUE '7576'.
   695     12  ER-7579                 PIC X(4)  VALUE '7579'.
   696     12  ER-7830                 PIC X(4)  VALUE '7830'.
   697     12  ER-7831                 PIC X(4)  VALUE '7831'.
   698     12  ER-7832                 PIC X(4)  VALUE '7832'.
   699     12  ER-7833                 PIC X(4)  VALUE '7833'.
   700     12  ER-7834                 PIC X(4)  VALUE '7834'.
   701     12  ER-7835                 PIC X(4)  VALUE '7835'.
   702     12  ER-7836                 PIC X(4)  VALUE '7836'.
   703     12  ER-7837                 PIC X(4)  VALUE '7837'.
   704     12  ER-7838                 PIC X(4)  VALUE '7838'.
   705     12  ER-7841                 PIC X(4)  VALUE '7841'.
   706     12  ER-7844                 PIC X(4)  VALUE '7844'.
   707     12  ER-7845                 PIC X(4)  VALUE '7845'.
   708     12  ER-8000                 PIC X(4)  VALUE '8000'.
   709     12  ER-8051                 PIC X(4)  VALUE '8051'.
   710     12  ER-8052                 PIC X(4)  VALUE '8052'.
   711     12  ER-8053                 PIC X(4)  VALUE '8053'.
   712     12  ER-8054                 PIC X(4)  VALUE '8054'.
   713     12  ER-8055                 PIC X(4)  VALUE '8055'.
   714     12  ER-8056                 PIC X(4)  VALUE '8056'.
   715     12  ER-8057                 PIC X(4)  VALUE '8057'.
   716     12  ER-8058                 PIC X(4)  VALUE '8058'.
   717     12  ER-8059                 PIC X(4)  VALUE '8059'.
   718     12  ER-8060                 PIC X(4)  VALUE '8060'.
   719     12  ER-8061                 PIC X(4)  VALUE '8061'.
   720     12  ER-8062                 PIC X(4)  VALUE '8062'.
   721     12  ER-8063                 PIC X(4)  VALUE '8063'.
   722     12  ER-8064                 PIC X(4)  VALUE '8064'.
   723     12  ER-8065                 PIC X(4)  VALUE '8065'.
   724     12  ER-8066                 PIC X(4)  VALUE '8066'.
   725     12  ER-8146                 PIC X(4)  VALUE '8146'.
   726     12  ER-8147                 PIC X(4)  VALUE '8147'.
   727     12  ER-8152                 PIC X(4)  VALUE '8152'.
   728     12  ER-8153                 PIC X(4)  VALUE '8153'.
   729     12  ER-8154                 PIC X(4)  VALUE '8154'.
   730     12  ER-8155                 PIC X(4)  VALUE '8155'.
   731     12  ER-8310                 PIC X(4)  VALUE '8310'.
   732     12  ER-8311                 PIC X(4)  VALUE '8311'.
   733     12  ER-8312                 PIC X(4)  VALUE '8312'.
   734     12  ER-8313                 PIC X(4)  VALUE '8313'.
   735     12  ER-8314                 PIC X(4)  VALUE '8314'.
   736     12  ER-8315                 PIC X(4)  VALUE '8315'.
   737     12  ER-8316                 PIC X(4)  VALUE '8316'.
   738     12  ER-8317                 PIC X(4)  VALUE '8317'.
   739
   740 01  CSO-WORK-FIELDS.
   741     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   742       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   743
   744     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   745     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   746         88  CERT-NOTE-ADDED           VALUE 'Y'.
   747     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  15
* EL156.cbl
   748         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   749     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   750
   751     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   752
   753 01  SC-NP6-CERT-NOTE.
   754     12  FILLER                  PIC X(12)
   755               VALUE 'REM BENEFIT '.
   756     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   757     12  SC-NP6-COMM             PIC X(8)
   758               VALUE ' + 6 MO '.
   759     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   760     12  FILLER                  PIC X(12)
   761               VALUE ' = AMT PAID '.
   762     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   763
   764 01  SC-NP6-ORIG-NOTE.
   765     12  FILLER                  PIC X(63)  VALUE
   766         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   767 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   768     88  PDEF-FOUND                   VALUE 'Y'.
   769 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   770     88  ACCT-FOUND                   VALUE 'Y'.
   771 01  CTBL-KEY-SAVE               PIC X(5).
   772 01  CTBL-KEY.
   773     05  CTBL-COMPANY-CD         PIC X.
   774     05  CTBL-TABLE              PIC XXX.
   775     05  CTBL-BEN-TYPE           PIC X.
   776     05  CTBL-BEN-CODE           PIC XX.
   777 01  ERPDEF-KEY-SAVE             PIC X(18).
   778 01  ERPDEF-KEY.
   779     12  ERPDEF-COMPANY-CD       PIC X.
   780     12  ERPDEF-STATE            PIC XX.
   781     12  ERPDEF-PROD-CD          PIC XXX.
   782     12  F                       PIC X(7).
   783     12  ERPDEF-BEN-TYPE         PIC X.
   784     12  ERPDEF-BEN-CODE         PIC XX.
   785     12  ERPDEF-EXP-DT           PIC XX.
   786 01  ELCRTT-KEY.
   787     05  CTRLR-COMP-CD       PIC X.
   788     05  CTRLR-CARRIER       PIC X.
   789     05  CTRLR-GROUPING      PIC X(6).
   790     05  CTRLR-STATE         PIC X(2).
   791     05  CTRLR-ACCOUNT       PIC X(10).
   792     05  CTRLR-EFF-DT        PIC XX.
   793     05  CTRLR-CERT-NO       PIC X(11).
   794     05  CTRLR-REC-TYPE      PIC X.
   795 01  ACCESS-KEYS.
   796     12  ELARCH-KEY.
   797         16  ARCH-CO             PIC X.
   798         16  ARCH-NUMBER         PIC S9(08) COMP.
   799         16  ARCH-REC-TYPE       PIC X.
   800         16  ARCH-SEQ            PIC S9(04) COMP.
   801     12  ELMSTR-KEY.
   802         16  MSTR-COMP-CD        PIC X.
   803         16  MSTR-CARRIER        PIC X.
   804         16  MSTR-CLAIM-NO       PIC X(7).
   805         16  MSTR-CERT-NO        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  16
* EL156.cbl
   806     12  ELCNTL-KEY.
   807         16  CNTL-COMP-ID        PIC X(3).
   808         16  CNTL-REC-TYPE       PIC X.
   809         16  CNTL-ACCESS         PIC X(4).
   810         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   811     12  ELCERT-KEY.
   812         16  CERT-COMP-CD        PIC X.
   813         16  CERT-CARRIER        PIC X.
   814         16  CERT-GROUPING       PIC X(6).
   815         16  CERT-STATE          PIC XX.
   816         16  CERT-ACCOUNT        PIC X(10).
   817         16  CERT-EFF-DT         PIC XX.
   818         16  CERT-CERT-NO        PIC X(11).
   819     12  ELTRLR-KEY.
   820         16  TRLR-COMP-CD        PIC X.
   821         16  TRLR-CARRIER        PIC X.
   822         16  TRLR-CLAIM-NO       PIC X(7).
   823         16  TRLR-CERT-NO        PIC X(11).
   824         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   825     12  ELACTQ-KEY.
   826         16  ACTQ-COMP-CD        PIC X.
   827         16  ACTQ-CARRIER        PIC X.
   828         16  ACTQ-CLAIM-NO       PIC X(7).
   829         16  ACTQ-CERT-NO        PIC X(11).
   830     12  W-NOTE-KEY.
   831         16  W-NOTE-COMP-CD      PIC X.
   832         16  W-NOTE-CERT-KEY.
   833             20  W-NOTE-CARRIER  PIC X.
   834             20  W-NOTE-GROUPING PIC X(6).
   835             20  W-NOTE-STATE    PIC XX.
   836             20  W-NOTE-ACCOUNT  PIC X(10).
   837             20  W-NOTE-EFF-DT   PIC XX.
   838             20  W-NOTE-CERT-NO  PIC X(11).
   839     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   840     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   841     12  ERACCT-KEY.
   842         16  ERACCT-PARTIAL-KEY.
   843             20  ACCT-COMP-CD    PIC X.
   844             20  ACCT-CARRIER    PIC X.
   845             20  ACCT-GROUPING   PIC X(6).
   846             20  ACCT-STATE      PIC XX.
   847             20  ACCT-ACCOUNT    PIC X(10).
   848         16  ACCT-EXP-DT         PIC XX.
   849         16  FILLER              PIC X(4) VALUE SPACES.
   850     12  ELCHKQ-KEY.
   851         16  CHKQ-COMP-CD        PIC X.
   852         16  CHKQ-CONTROL        PIC S9(8) COMP.
   853         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   854     12  ELBENE-KEY.
   855         16  BENE-COMP-CD         PIC X.
   856         16  BENE-RECORD-TYPE     PIC X.
   857         16  BENE-NUMBER          PIC X(10).
   858     12  ERCOMP-KEY.
   859         16  COMP-COMP-CD        PIC X.
   860         16  COMP-CARRIER        PIC X.
   861         16  COMP-GROUP          PIC X(06).
   862         16  COMP-FIN-RESP       PIC X(10).
   863         16  COMP-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  17
* EL156.cbl
   864         16  COMP-TYPE           PIC X.
   865
   866     12  DLO035-KEY.
   867         16  DL35-PROCESS-TYPE   PIC X.
   868         16  DL35-CREDIT-CARD    PIC X(20).
   869         16  DL35-BEN-TYPE       PIC XX.
   870         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   871         16  DL35-RETURN-CODE    PIC XX.
   872
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  18
* EL156.cbl
   874*    COPY ELCDATE.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                            ELCDATE.                            *
   879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   880*                            VMOD=2.003
   881*                                                                *
   882*                                                                *
   883*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   884*                 LENGTH = 200                                   *
   885******************************************************************
   886
   887 01  DATE-CONVERSION-DATA.
   888     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   889     12  DC-OPTION-CODE                PIC X.
   890         88  BIN-TO-GREG                VALUE ' '.
   891         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   892         88  EDIT-GREG-TO-BIN           VALUE '2'.
   893         88  YMD-GREG-TO-BIN            VALUE '3'.
   894         88  MDY-GREG-TO-BIN            VALUE '4'.
   895         88  JULIAN-TO-BIN              VALUE '5'.
   896         88  BIN-PLUS-ELAPSED           VALUE '6'.
   897         88  FIND-CENTURY               VALUE '7'.
   898         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   899         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   900         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   901         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   902         88  JULIAN-TO-BIN-3            VALUE 'C'.
   903         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   904         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   905         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   906         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   907         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   908         88  CHECK-LEAP-YEAR            VALUE 'H'.
   909         88  BIN-3-TO-GREG              VALUE 'I'.
   910         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   911         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   912         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   913         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   914         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   915         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   916         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   917         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   918         88  THREE-CHARACTER-BIN
   919                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   920         88  GREGORIAN-TO-BIN
   921                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   922         88  BIN-TO-GREGORIAN
   923                  VALUES ' ' '1' 'I' '8' 'G'.
   924         88  JULIAN-TO-BINARY
   925                  VALUES '5' 'C' 'E' 'F'.
   926     12  DC-ERROR-CODE                 PIC X.
   927         88  NO-CONVERSION-ERROR        VALUE ' '.
   928         88  DATE-CONVERSION-ERROR
   929                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   930         88  DATE-IS-ZERO               VALUE '1'.
   931         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  19
* EL156.cbl
   932         88  DATE-IS-INVALID            VALUE '3'.
   933         88  DATE1-GREATER-DATE2        VALUE '4'.
   934         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   935         88  DATE-INVALID-OPTION        VALUE '9'.
   936         88  INVALID-CENTURY            VALUE 'A'.
   937         88  ONLY-CENTURY               VALUE 'B'.
   938         88  ONLY-LEAP-YEAR             VALUE 'C'.
   939         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   940     12  DC-END-OF-MONTH               PIC X.
   941         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   942     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   943         88  USE-NORMAL-PROCESS         VALUE ' '.
   944         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   945         88  ADJUST-UP-100-YRS          VALUE '2'.
   946     12  FILLER                        PIC X.
   947     12  DC-CONVERSION-DATES.
   948         16  DC-BIN-DATE-1             PIC XX.
   949         16  DC-BIN-DATE-2             PIC XX.
   950         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   951         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   952                       DC-GREG-DATE-1-EDIT.
   953             20  DC-EDIT1-MONTH        PIC 99.
   954             20  SLASH1-1              PIC X.
   955             20  DC-EDIT1-DAY          PIC 99.
   956             20  SLASH1-2              PIC X.
   957             20  DC-EDIT1-YEAR         PIC 99.
   958         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   959         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   960                     DC-GREG-DATE-2-EDIT.
   961             20  DC-EDIT2-MONTH        PIC 99.
   962             20  SLASH2-1              PIC X.
   963             20  DC-EDIT2-DAY          PIC 99.
   964             20  SLASH2-2              PIC X.
   965             20  DC-EDIT2-YEAR         PIC 99.
   966         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   967         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   968                     DC-GREG-DATE-1-YMD.
   969             20  DC-YMD-YEAR           PIC 99.
   970             20  DC-YMD-MONTH          PIC 99.
   971             20  DC-YMD-DAY            PIC 99.
   972         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   973         16  DC-GREG-DATE-1-MDY-R REDEFINES
   974                      DC-GREG-DATE-1-MDY.
   975             20  DC-MDY-MONTH          PIC 99.
   976             20  DC-MDY-DAY            PIC 99.
   977             20  DC-MDY-YEAR           PIC 99.
   978         16  DC-GREG-DATE-1-ALPHA.
   979             20  DC-ALPHA-MONTH        PIC X(10).
   980             20  DC-ALPHA-DAY          PIC 99.
   981             20  FILLER                PIC XX.
   982             20  DC-ALPHA-CENTURY.
   983                 24 DC-ALPHA-CEN-N     PIC 99.
   984             20  DC-ALPHA-YEAR         PIC 99.
   985         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   986         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   987         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   988         16  DC-JULIAN-DATE            PIC 9(05).
   989         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  20
* EL156.cbl
   990                                       PIC 9(05).
   991         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   992             20  DC-JULIAN-YEAR        PIC 99.
   993             20  DC-JULIAN-DAYS        PIC 999.
   994         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   995         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   996         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   997     12  DATE-CONVERSION-VARIBLES.
   998         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   999         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1000             20  FILLER                PIC 9(3).
  1001             20  HOLD-CEN-1-CCYY.
  1002                 24  HOLD-CEN-1-CC     PIC 99.
  1003                 24  HOLD-CEN-1-YY     PIC 99.
  1004             20  HOLD-CEN-1-MO         PIC 99.
  1005             20  HOLD-CEN-1-DA         PIC 99.
  1006         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1007             20  HOLD-CEN-1-R-MO       PIC 99.
  1008             20  HOLD-CEN-1-R-DA       PIC 99.
  1009             20  HOLD-CEN-1-R-CCYY.
  1010                 24  HOLD-CEN-1-R-CC   PIC 99.
  1011                 24  HOLD-CEN-1-R-YY   PIC 99.
  1012             20  FILLER                PIC 9(3).
  1013         16  HOLD-CENTURY-1-X.
  1014             20  FILLER                PIC X(3)  VALUE SPACES.
  1015             20  HOLD-CEN-1-X-CCYY.
  1016                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1017                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1018             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1019             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1020         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1021             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1022             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1023             20  HOLD-CEN-1-R-X-CCYY.
  1024                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1025                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1026             20  FILLER                PIC XXX.
  1027         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1028         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1029         16  DC-JULIAN-DATE-1          PIC 9(07).
  1030         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1031             20  DC-JULIAN-1-CCYY.
  1032                 24  DC-JULIAN-1-CC    PIC 99.
  1033                 24  DC-JULIAN-1-YR    PIC 99.
  1034             20  DC-JULIAN-DA-1        PIC 999.
  1035         16  DC-JULIAN-DATE-2          PIC 9(07).
  1036         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1037             20  DC-JULIAN-2-CCYY.
  1038                 24  DC-JULIAN-2-CC    PIC 99.
  1039                 24  DC-JULIAN-2-YR    PIC 99.
  1040             20  DC-JULIAN-DA-2        PIC 999.
  1041         16  DC-GREG-DATE-A-EDIT.
  1042             20  DC-EDITA-MONTH        PIC 99.
  1043             20  SLASHA-1              PIC X VALUE '/'.
  1044             20  DC-EDITA-DAY          PIC 99.
  1045             20  SLASHA-2              PIC X VALUE '/'.
  1046             20  DC-EDITA-CCYY.
  1047                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  21
* EL156.cbl
  1048                 24  DC-EDITA-YEAR     PIC 99.
  1049         16  DC-GREG-DATE-B-EDIT.
  1050             20  DC-EDITB-MONTH        PIC 99.
  1051             20  SLASHB-1              PIC X VALUE '/'.
  1052             20  DC-EDITB-DAY          PIC 99.
  1053             20  SLASHB-2              PIC X VALUE '/'.
  1054             20  DC-EDITB-CCYY.
  1055                 24  DC-EDITB-CENT     PIC 99.
  1056                 24  DC-EDITB-YEAR     PIC 99.
  1057         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1058         16  DC-GREG-DATE-CYMD-R REDEFINES
  1059                              DC-GREG-DATE-CYMD.
  1060             20  DC-CYMD-CEN           PIC 99.
  1061             20  DC-CYMD-YEAR          PIC 99.
  1062             20  DC-CYMD-MONTH         PIC 99.
  1063             20  DC-CYMD-DAY           PIC 99.
  1064         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1065         16  DC-GREG-DATE-MDCY-R REDEFINES
  1066                              DC-GREG-DATE-MDCY.
  1067             20  DC-MDCY-MONTH         PIC 99.
  1068             20  DC-MDCY-DAY           PIC 99.
  1069             20  DC-MDCY-CEN           PIC 99.
  1070             20  DC-MDCY-YEAR          PIC 99.
  1071    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1072        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1073    12  DC-EL310-DATE                  PIC X(21).
  1074    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  22
* EL156.cbl
  1076*    COPY ELCLOGOF.
  1077******************************************************************
  1078*                                                                *
  1079*                                                                *
  1080*                            ELCLOGOF.                           *
  1081*                            VMOD=2.001                          *
  1082*                                                                *
  1083*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1084*                                                                *
  1085******************************************************************
  1086 01  CLASIC-LOGOFF.
  1087     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1088     12  LOGOFF-TEXT.
  1089         16  FILLER          PIC X(5)    VALUE SPACES.
  1090         16  LOGOFF-MSG.
  1091             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1092             20  FILLER      PIC X       VALUE SPACES.
  1093             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1094         16  FILLER          PIC X(80)
  1095           VALUE '* YOU ARE NOW LOGGED OFF'.
  1096         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1097         16  FILLER          PIC X       VALUE QUOTE.
  1098         16  LOGOFF-SYS-MSG  PIC X(17)
  1099           VALUE 'S CLAS-IC SYSTEM '.
  1100     12  TEXT-MESSAGES.
  1101         16  UNACCESS-MSG    PIC X(29)
  1102             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1103         16  PGMIDERR-MSG    PIC X(17)
  1104             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  23
* EL156.cbl
  1106*    COPY ELCCALC.
  1107******************************************************************
  1108*                                                                *
  1109*                           ELCCALC.                            *
  1110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1111*                            VMOD=2.025                          *
  1112*                                                                *
  1113*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1114*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1115*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1116*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1117*                                                                *
  1118*  PASSED TO ELRTRM                                              *
  1119*  -----------------                                             *
  1120*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1121*  ORIGINAL TERM                                                 *
  1122*  BEGINNING DATE                                                *
  1123*  ENDING DATE                                                   *
  1124*  COMPANY I.D.                                                  *
  1125*  ACCOUNT MASTER USER FIELD                                     *
  1126*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1127*  FREE LOOK DAYS                                                *
  1128*                                                                *
  1129*  RETURNED FROM ELRTRM                                          *
  1130*  ---------------------                                         *
  1131*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1132*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1133*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1134*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1135*----------------------------------------------------------------*
  1136*  PASSED TO ELRAMT                                              *
  1137*  ----------------                                              *
  1138*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1139*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1140*  ORIGINAL AMOUNT                                               *
  1141*  ALTERNATE BENEFIT (BALLON)                                    *
  1142*  A.P.R. - NET PAY ONLY                                         *
  1143*  METHOD
  1144*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1145*  COMPANY I.D.                                                  *
  1146*  BENEFIT TYPE                                                  *
  1147*                                                                *
  1148*  RETURNED FROM ELRAMT                                          *
  1149*  --------------------                                          *
  1150*  REMAINING AMOUNT 1 - CURRENT                                  *
  1151*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1152*  REMAINING AMOUNT FACTOR
  1153*----------------------------------------------------------------*
  1154*  PASSED TO ELRESV                                              *
  1155*  -----------------                                             *
  1156*  CERTIFICATE EFFECTIVE DATE                                    *
  1157*  VALUATION DATE                                                *
  1158*  PAID THRU DATE                                                *
  1159*  BENEFIT                                                       *
  1160*  INCURRED DATE                                                 *
  1161*  REPORTED DATE                                                 *
  1162*  ISSUE AGE                                                     *
  1163*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  24
* EL156.cbl
  1164*  CDT PERCENT                                                   *
  1165*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1166* *CLAIM TYPE (LIFE, A/H)                                        *
  1167* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1168* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1169*                                                                *
  1170*  RETURNED FROM ELRESV                                          *
  1171*  --------------------                                          *
  1172*  CDT TABLE USED                                                *
  1173*  CDT FACTOR USED                                               *
  1174*  PAY TO CURRENT RESERVE                                        *
  1175*  I.B.N.R. - A/H ONLY                                           *
  1176*  FUTURE (ACCRUED) AH ONLY                                      *
  1177*----------------------------------------------------------------*
  1178*  PASSED TO ELRATE                                              *
  1179*  ----------------                                              *
  1180*  CERT ISSUE DATE                                               *
  1181*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1182*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1183*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1184*  STATE CODE (CLIENT DEFINED)                                   *
  1185*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1186*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1187*  DEVIATION CODE                                                *
  1188*  ISSUE AGE                                                     *
  1189*  ORIGINAL BENEFIT AMOUNT                                       *
  1190*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1191*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1192*  BENEFIT KIND (LIFE OR A/H)                                    *
  1193*  A.P.R.                                                        *
  1194*  METHOD
  1195*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1196*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1197*  COMPANY I.D. (3 CHARACTER)                                    *
  1198*  BENEFIT CODE                                                  *
  1199*  BENEFIT OVERRIDE CODE                                         *
  1200*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1201*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1202*  JOINT INDICATOR (CSL ONLY)                                    *
  1203*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1204*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1205*                                                                *
  1206*  RETURNED FROM ELRATE                                          *
  1207*  --------------------                                          *
  1208*  CALCULATED PREMIUM                                            *
  1209*  PREMIUM RATE                                                  *
  1210*  MORTALITY CODE                                                *
  1211*  MAX ATTAINED AGE                                              *
  1212*  MAX AGE                                                       *
  1213*  MAX TERM                                                      *
  1214*  MAX MONTHLY BENEFIT                                           *
  1215*  MAX TOTAL BENIFIT                                             *
  1216*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1217*----------------------------------------------------------------*
  1218*  PASSED TO ELRFND                                              *
  1219*  ----------------                                              *
  1220*  CERT ISSUE DATE                                               *
  1221*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  25
* EL156.cbl
  1222*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1223*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1224*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1225*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1226*  STATE CODE (CLIENT DEFINED)                                   *
  1227*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1228*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1229*  DEVIATION CODE                                                *
  1230*  ISSUE AGE                                                     *
  1231*  ORIGINAL BENEFIT AMOUNT                                       *
  1232*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1233*  PROCESS TYPE (CANCEL)                                         *
  1234*  BENEFIT KIND (LIFE OR A/H)                                    *
  1235*  A.P.R.                                                        *
  1236*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1237*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1238*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1239*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1240*  COMPANY I.D. (3 CHARACTER)                                    *
  1241*  BENEFIT CODE                                                  *
  1242*  BENEFIT OVERRIDE CODE                                         *
  1243*                                                                *
  1244*  RETURNED FROM ELRFND                                          *
  1245*  --------------------                                          *
  1246*  CALCULATED REFUND                                             *
  1247*----------------------------------------------------------------*
  1248*  PASSED TO ELEARN                                              *
  1249*  ----------------                                              *
  1250*  CERT ISSUE DATE                                               *
  1251*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1252*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1253*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1254*  STATE CODE (CLIENT DEFINED)                                   *
  1255*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1256*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1257*  DEVIATION CODE                                                *
  1258*  ISSUE AGE                                                     *
  1259*  ORIGINAL BENEFIT AMOUNT                                       *
  1260*  BENEFIT KIND (LIFE OR A/H)                                    *
  1261*  A.P.R.                                                        *
  1262*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1263*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1264*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1265*  COMPANY I.D. (3 CHARACTER)                                    *
  1266*  BENEFIT CODE                                                  *
  1267*  BENEFIT OVERRIDE CODE                                         *
  1268*                                                                *
  1269*  RETURNED FROM ELEARN                                          *
  1270*  --------------------                                          *
  1271*  INDICATED  EARNINGS                                           *
  1272*----------------------------------------------------------------*
  1273*                 LENGTH = 450                                   *
  1274*                                                                *
  1275******************************************************************
  1276******************************************************************
  1277*                   C H A N G E   L O G
  1278*
  1279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  26
* EL156.cbl
  1280*-----------------------------------------------------------------
  1281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1282* EFFECTIVE    NUMBER
  1283*-----------------------------------------------------------------
  1284* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1285* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1286* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1287* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1288* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1289* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1290* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1291* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1292* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1293******************************************************************
  1294
  1295 01  CALCULATION-PASS-AREA.
  1296     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1297                                     COMP.
  1298
  1299     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1300       88  NO-CP-ERROR                             VALUE ZERO.
  1301       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1302                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1303       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1304       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1305       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1306       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1307       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1308       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1309       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1310       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1311       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1312       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1313       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1314       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1315       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1316       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1317       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1318       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1319       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1320
  1321     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1322       88  NO-CP-ERROR-2                           VALUE ZERO.
  1323***********************  INPUT AREAS ****************************
  1324
  1325     12  CP-CALCULATION-AREA.
  1326         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1327         16  CP-CERT-EFF-DT        PIC XX.
  1328         16  CP-VALUATION-DT       PIC XX.
  1329         16  CP-PAID-THRU-DT       PIC XX.
  1330         16  CP-BENEFIT-TYPE       PIC X.
  1331           88  CP-AH                               VALUE 'A' 'D'
  1332                                                   'I' 'U'.
  1333           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1334           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1335         16  CP-INCURRED-DT        PIC XX.
  1336         16  CP-REPORTED-DT        PIC XX.
  1337         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  27
* EL156.cbl
  1338         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1339         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1340                                     COMP-3.
  1341         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1342                                     COMP-3.
  1343         16  CP-CDT-METHOD         PIC X.
  1344           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1345           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1346           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1347         16  CP-CLAIM-TYPE         PIC X.
  1348           88  CP-AH-CLAIM                         VALUE 'A'.
  1349           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1350         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1351                                     COMP-3.
  1352         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1353                                     COMP-3.
  1354         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1355                                     COMP-3.
  1356         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1357                                     COMP-3.
  1358         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1359                                     COMP-3.
  1360         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1361                                     COMP-3.
  1362         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1363                                     COMP-3.
  1364         16  CP-REM-TERM-METHOD    PIC X.
  1365           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1366           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1367           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1368           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1369           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1370           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1371           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1372         16  CP-EARNING-METHOD     PIC X.
  1373           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1374           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1375           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1376           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1377           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1378           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1379           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1380           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1381           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1382           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1383           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1384           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1385           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1386           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1387         16  CP-PROCESS-TYPE       PIC X.
  1388           88  CP-CLAIM                            VALUE '1'.
  1389           88  CP-CANCEL                           VALUE '2'.
  1390           88  CP-ISSUE                            VALUE '3'.
  1391         16  CP-SPECIAL-CALC-CD    PIC X.
  1392           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1393           88  CP-1-MTH-INTEREST               VALUE ' '.
  1394           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1395           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  28
* EL156.cbl
  1396           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1397           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1398           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1399           88  CP-FARM-PLAN                    VALUE 'F'.
  1400           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1401           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1402           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1403           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1404           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1405           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1406           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1407           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1408           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1409           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1410                                                     'W' 'X'.
  1411           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1412           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1413           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1414           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1415           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1416           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1417           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1418           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1419           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1420           88  CP-CSL-METH-1                   VALUE '5'.
  1421           88  CP-CSL-METH-2                   VALUE '6'.
  1422           88  CP-CSL-METH-3                   VALUE '7'.
  1423           88  CP-CSL-METH-4                   VALUE '8'.
  1424
  1425         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1426                                     COMP-3.
  1427         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1428         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1429         16  CP-STATE              PIC XX          VALUE SPACE.
  1430         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1431         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1432           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1433               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1434         16  CP-R78-OPTION         PIC X.
  1435           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1436           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1437
  1438         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1439         16  CP-IBNR-RESERVE-SW    PIC X.
  1440         16  CP-CLAIM-STATUS       PIC X.
  1441         16  CP-RATE-FILE          PIC X.
  1442         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1443                                     COMP-3.
  1444
  1445         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1446         16  CP-AH-OVERRIDE-CODE   PIC X.
  1447
  1448         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1449                                     COMP-3.
  1450         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1451                                   PIC S9(5)V99 COMP-3.
  1452         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1453                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  29
* EL156.cbl
  1454         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1455                                     COMP-3.
  1456         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1457                                     COMP-3.
  1458         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1459                                  PIC S9(7)V99 COMP-3.
  1460
  1461         16  CP-PAID-FROM-DATE     PIC X(02).
  1462         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1463         16  CP-EXT-DAYS-CALC      PIC X.
  1464           88  CP-EXT-NO-CHG                   VALUE ' '.
  1465           88  CP-EXT-CHG-LF                   VALUE '1'.
  1466           88  CP-EXT-CHG-AH                   VALUE '2'.
  1467           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1468         16  CP-DOMICILE-STATE     PIC XX.
  1469         16  CP-CARRIER            PIC X.
  1470         16  CP-REIN-FLAG          PIC X.
  1471         16  CP-REM-TRM-CALC-OPTION PIC X.
  1472           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1473                      '2' '3' '4' '5'.
  1474           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1475           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1476           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1477           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1478           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1479           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1480           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1481           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1482         16  CP-SIG-SWITCH         PIC X.
  1483         16  CP-RATING-METHOD      PIC X.
  1484           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1485           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1486           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1487           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1488           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1489           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1490           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1491           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1492           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1493         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1494                                     COMP-3.
  1495         16  CP-BEN-CATEGORY       PIC X.
  1496         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1497         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1498                                   PIC S99V9(5) COMP-3.
  1499         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1500         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1501                                   PIC S99V9(5) COMP-3.
  1502         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1503         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1504         16  CP-EXPIRE-DT          PIC XX.
  1505         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1506         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1507         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1508         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1509         16  CP-DDF-SPEC-CALC      PIC X.
  1510             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1511             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  30
* EL156.cbl
  1512         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1513         16  CP-CANCEL-REASON      PIC X.
  1514         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1515         16  CP-PMT-MODE           PIC X.
  1516         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1517         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1518         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1519         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1520         16  FILLER                PIC X.
  1521
  1522***************    OUTPUT FROM ELRESV   ************************
  1523
  1524         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1525
  1526         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1527                                     COMP-3.
  1528         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1529                                     COMP-3.
  1530         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1531                                     COMP-3.
  1532         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1533                                     COMP-3.
  1534         16  FILLER                PIC X(09).
  1535***************    OUTPUT FROM ELRTRM   *************************
  1536
  1537         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1538                                     COMP-3.
  1539         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1540                                     COMP-3.
  1541         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1542                                     COMP-3.
  1543         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1544                                     COMP-3.
  1545         16  FILLER                PIC X(12).
  1546
  1547***************    OUTPUT FROM ELRAMT   *************************
  1548
  1549         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1552                                     COMP-3.
  1553         16  FILLER                PIC X(12).
  1554
  1555***************    OUTPUT FROM ELRATE   *************************
  1556
  1557         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1558                                     COMP-3.
  1559         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-MORTALITY-CODE     PIC X(4).
  1562         16  CP-RATE-EDIT-FLAG     PIC X.
  1563             88  CP-RATES-NEED-APR                  VALUE '1'.
  1564         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1565                                     COMP-3.
  1566         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1567         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1568         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1569                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  31
* EL156.cbl
  1570         16  FILLER                PIC X(07).
  1571
  1572***************    OUTPUT FROM ELRFND   *************************
  1573
  1574         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1575                                     COMP-3.
  1576         16  CP-REFUND-TYPE-USED   PIC X.
  1577           88  CP-R-AS-R78                         VALUE '1'.
  1578           88  CP-R-AS-PRORATA                     VALUE '2'.
  1579           88  CP-R-AS-CALIF                       VALUE '3'.
  1580           88  CP-R-AS-TEXAS                       VALUE '4'.
  1581           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1582           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1583           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1584           88  CP-R-AS-MEAN                        VALUE '8'.
  1585           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1586           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1587           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1588           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1589           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1590           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1591         16  FILLER                PIC X(12).
  1592
  1593***************    OUTPUT FROM ELEARN   *************************
  1594
  1595         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1604                                     COMP-3.
  1605         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1606                                     COMP-3.
  1607         16  CP-EARNING-TYPE-USED  PIC X.
  1608           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1609           88  CP-E-AS-R78                         VALUE '1'.
  1610           88  CP-E-AS-PRORATA                     VALUE '2'.
  1611           88  CP-E-AS-TEXAS                       VALUE '4'.
  1612           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1613           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1614           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1615           88  CP-E-AS-MEAN                        VALUE '8'.
  1616           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1617         16  FILLER                PIC X(12).
  1618
  1619***************    OUTPUT FROM ELPMNT   *************************
  1620
  1621         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  FILLER                PIC X(12).
  1626
  1627***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  32
* EL156.cbl
  1628         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1631                                     COMP-3.
  1632         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1641             88  OPEN-RATE-FILE                   VALUE 'O'.
  1642             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1643             88  IO-ERROR                         VALUE 'E'.
  1644
  1645         16  CP-FIRST-PAY-DATE     PIC XX.
  1646
  1647         16  CP-JOINT-INDICATOR    PIC X.
  1648
  1649         16  CP-RESERVE-REMAINING-TERM
  1650                                   PIC S9(4)V9    VALUE ZERO
  1651                                     COMP-3.
  1652
  1653         16  CP-INSURED-BIRTH-DT   PIC XX.
  1654
  1655         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1656                                     COMP-3.
  1657
  1658         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1659                                     COMP-3.
  1660
  1661         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1662                                     COMP-3.
  1663
  1664         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1665                                     COMP-3.
  1666
  1667         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1668                                     COMP-3.
  1669
  1670         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1671                                     COMP-3.
  1672
  1673         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1674                                     COMP-3.
  1675
  1676         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1677             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1678
  1679         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1680                                     COMP-3.
  1681         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1682                                     COMP-3.
  1683         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1684         16  FILLER                PIC X(15).
  1685******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  33
* EL156.cbl
  1686*    COPY ELCICALC.
  1687******************************************************************
  1688*                                                                *
  1689*                           ELCCICALC.                           *
  1690*                            VMOD=2.001                          *
  1691*                                                                *
  1692*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1693*                 CALCULATION MODULE                             *
  1694*                                                                *
  1695*  PASSED TO ELCLMI                                              *
  1696*  -----------------                                             *
  1697*  STATE                                                         *
  1698*  PRODUCT                                                       *
  1699*  COVERAGE                                                      *
  1700*  EFFECTIVE DATE                                                *
  1701*  INCURRED DATE                                                 *
  1702*  ESTABLISHED DATE                                              *
  1703*  LAST PAID DATE                                                *
  1704*  REPORTED DATE                                                 *
  1705*  CLAIM PAYMENT AMOUNT                                          *
  1706*                                                                *
  1707*  RETURNED FROM ELRTRM                                          *
  1708*  ---------------------                                         *
  1709*  RETURN CODE                                                   *
  1710*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1711*  CLAIM INTEREST AMOUNT                                         *
  1712*----------------------------------------------------------------*
  1713*----------------------------------------------------------------*
  1714*                 LENGTH = 100                                   *
  1715*                                                                *
  1716******************************************************************
  1717******************************************************************
  1718*                   C H A N G E   L O G
  1719*
  1720* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1721*-----------------------------------------------------------------
  1722*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1723* EFFECTIVE    NUMBER
  1724*-----------------------------------------------------------------
  1725* 120905    2004040700004  PEMA  NEW COPYBOOK
  1726* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1727******************************************************************
  1728
  1729 01  CLAIM-INT-PASS-AREA.
  1730     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1731                                     COMP.
  1732
  1733     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1734       88  NO-CI-ERROR                             VALUE ZERO.
  1735       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1736       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1737       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1738       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1739       88  CP-AMT-LT-5000                          VALUE '4'.
  1740       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1741       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1742       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1743       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  34
* EL156.cbl
  1744***********************  INPUT AREAS ****************************
  1745
  1746     12  CP-CALCULATION-AREA.
  1747         16  CP-COMPANY-CD         PIC X.
  1748         16  CP-STATE              PIC XX.
  1749         16  CP-PRODUCT            PIC XX.
  1750         16  CP-COVERAGE           PIC XX.
  1751         16  CP-INC-DT             PIC XX.
  1752         16  CP-EST-DT             PIC XX.
  1753         16  CP-LSTPD-DT           PIC XX.
  1754         16  CP-RPT-DT             PIC XX.
  1755         16  CP-PRF-DT             PIC XX.
  1756         16  CP-EFF-DT             PIC XX.
  1757         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1758         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1759         16  FILLER                PIC X(37).
  1760
  1761***************    OUTPUT FROM ELCLMI   ************************
  1762
  1763         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1764
  1765         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1766         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1767         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1768         16  FILLER                PIC X(19).
  1769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  35
* EL156.cbl
  1771*    COPY ELCATTR.
  1772******************************************************************
  1773*                                                                *
  1774*                            ELCATTR.                            *
  1775*                            VMOD=2.001                          *
  1776*                                                                *
  1777*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1778*                                                                *
  1779*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1780*                                                                *
  1781*                   POS 1   P=PROTECTED                          *
  1782*                           U=UNPROTECTED                        *
  1783*                           S=ASKIP                              *
  1784*                   POS 2   A=ALPHA/NUMERIC                      *
  1785*                           N=NUMERIC                            *
  1786*                   POS 3   N=NORMAL                             *
  1787*                           B=BRIGHT                             *
  1788*                           D=DARK                               *
  1789*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1790*                           OF=MODIFIED DATA TAG OFF             *
  1791*                                                                *
  1792*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1793******************************************************************
  1794 01  ATTRIBUTE-LIST.
  1795     12  AL-PABOF            PIC X       VALUE 'Y'.
  1796     12  AL-PABON            PIC X       VALUE 'Z'.
  1797     12  AL-PADOF            PIC X       VALUE '%'.
  1798     12  AL-PADON            PIC X       VALUE '_'.
  1799     12  AL-PANOF            PIC X       VALUE '-'.
  1800     12  AL-PANON            PIC X       VALUE '/'.
  1801     12  AL-SABOF            PIC X       VALUE '8'.
  1802     12  AL-SABON            PIC X       VALUE '9'.
  1803     12  AL-SADOF            PIC X       VALUE '@'.
  1804     12  AL-SADON            PIC X       VALUE QUOTE.
  1805     12  AL-SANOF            PIC X       VALUE '0'.
  1806     12  AL-SANON            PIC X       VALUE '1'.
  1807     12  AL-UABOF            PIC X       VALUE 'H'.
  1808     12  AL-UABON            PIC X       VALUE 'I'.
  1809     12  AL-UADOF            PIC X       VALUE '<'.
  1810     12  AL-UADON            PIC X       VALUE '('.
  1811     12  AL-UANOF            PIC X       VALUE ' '.
  1812     12  AL-UANON            PIC X       VALUE 'A'.
  1813     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1814     12  AL-UNBON            PIC X       VALUE 'R'.
  1815     12  AL-UNDOF            PIC X       VALUE '*'.
  1816     12  AL-UNDON            PIC X       VALUE ')'.
  1817     12  AL-UNNOF            PIC X       VALUE '&'.
  1818     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  36
* EL156.cbl
  1820*    COPY ELCEMIB.
  1821******************************************************************
  1822*                                                                *
  1823*                                                                *
  1824*                            ELCEMIB.                            *
  1825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1826*                            VMOD=2.005                          *
  1827*                                                                *
  1828*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1829*                                                                *
  1830******************************************************************
  1831 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1832     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1833     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1834     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1835     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1836     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1837     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1838     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1839     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1840     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1841         88  EMI-NO-ERRORS                    VALUE '1'.
  1842         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1843         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1844     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1845         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1846     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1847         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1848         88  EMI-AREA1-FULL                   VALUE '2'.
  1849     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1850         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1851         88  EMI-AREA2-FULL                   VALUE '2'.
  1852     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1853         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1854         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1855         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1856         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1857         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1858     12  EMI-ERROR-LINES.
  1859         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1860         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1861         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1862         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1863             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1864                 24  EMI-ERR-NUM         PIC X(4).
  1865                 24  EMI-FILLER          PIC X.
  1866                 24  EMI-SEV             PIC X.
  1867                 24  FILLER              PIC X.
  1868             20  FILLER                  PIC X(02).
  1869     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1870         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1871             20  EMI-ERROR-NUMBER    PIC X(4).
  1872             20  EMI-FILL            PIC X.
  1873             20  EMI-SEVERITY        PIC X.
  1874             20  FILLER              PIC X.
  1875             20  EMI-ERROR-TEXT.
  1876                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1877                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  37
* EL156.cbl
  1878     12  EMI-SEVERITY-SAVE           PIC X.
  1879         88  EMI-NOTE                    VALUE 'N'.
  1880         88  EMI-WARNING                 VALUE 'W'.
  1881         88  EMI-FORCABLE                VALUE 'F'.
  1882         88  EMI-FATAL                   VALUE 'X'.
  1883     12  EMI-MESSAGE-FLAG            PIC X.
  1884         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1885         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1886     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1887     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1888         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1889         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1890         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1891     12  emi-claim-no                pic x(7).
  1892     12  emi-claim-type              pic x(6).
  1893     12  FILLER                      PIC X(124)  VALUE SPACES.
  1894     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1895     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1896     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1897     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  38
* EL156.cbl
  1899*    COPY ELCLNKLT.
  1900******************************************************************
  1901*                                                                *
  1902*                                                                *
  1903*                           ELCLNKLT                             *
  1904*                            VMOD=2.003                          *
  1905*                                                                *
  1906*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1907*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1908*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1909*                                                                *
  1910*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1911*   COMPLETING THE REQUIRED FIELDS.                              *
  1912*                                                                *
  1913*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1914*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1915*                              9999 INDICATES AN UNKNOWN ABEND   *
  1916*                                   WAS DETECTED.                *
  1917*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1918*                              CODES FOUND IN THE ERROR FILE.    *
  1919******************************************************************
  1920 01  W-1523-LINKDATA.
  1921     12  W-1523-COMMON-PI-DATA.
  1922         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1923         16  FILLER              PIC  X(67).
  1924         16  W-1523-COMPANY-CD   PIC  X(01).
  1925         16  FILLER              PIC  X(10).
  1926         16  W-1523-CONTROL-IN-PROGRESS.
  1927             20  W-1523-CARRIER  PIC  X(01).
  1928             20  W-1523-GROUPING PIC  X(06).
  1929             20  W-1523-STATE    PIC  X(02).
  1930             20  W-1523-ACCOUNT  PIC  X(10).
  1931             20  W-1523-CLAIM-CERT-GRP.
  1932                 24  W-1523-CLAIM-NO
  1933                                 PIC  X(07).
  1934                 24  W-1523-CERT-NO.
  1935                     28  W-1523-CERT-PRIME
  1936                                 PIC  X(10).
  1937                     28  W-1523-CERT-SFX
  1938                                 PIC  X(01).
  1939                 24  W-1523-CERT-EFF-DT
  1940                                 PIC  X(02).
  1941         16  FILLER              PIC X(265).
  1942
  1943     12  W-1523-WORK-AREA.
  1944         16  W-1523-FORM-NUMBER  PIC  X(04).
  1945         16  W-1523-NUMBER-COPIES
  1946                                 PIC  9(01).
  1947         16  W-1523-ADDR-TYPE    PIC  X(02).
  1948         16  W-1523-FOLLOW-UP-DATE
  1949                                 PIC  X(02).
  1950         16  W-1523-RESEND-DATE  PIC  X(02).
  1951         16  W-1523-ERROR-CODE   PIC  9(04).
  1952             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1953             88  W-1523-FATAL-ERROR
  1954                                    VALUES  0006 0013 0042
  1955                                            0154 0168 0169
  1956                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  39
* EL156.cbl
  1957                                            0179 0186 0281
  1958                                            0332 2055 3697
  1959                                            3698 3699 3770
  1960                                            3771 3772 7675
  1961                                            9106 9808 9883
  1962                                            9887.
  1963             88  W-1523-STOP-ERRORS
  1964                                    VALUES  0013 0042 0154
  1965                                            0168 0169 0172
  1966                                            0281 0332 2055
  1967                                            3698 3699 7675
  1968                                            9106 9808 9883
  1969                                            9999.
  1970         16  W-1523-REASON       PIC  X(70).
  1971         16  W-1523-ARCHIVE-NUMBER
  1972                                 PIC  9(08).
  1973     12  W-1523-POINTER-AREA.
  1974         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1975         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1976         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1977         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1978         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  40
* EL156.cbl
  1980*    COPY ELCNWA.
  1981*****************************************************************
  1982*                                                               *
  1983*                                                               *
  1984*                            ELCNWA.                            *
  1985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1986*                            VMOD=2.003                         *
  1987*                                                               *
  1988*            M O V E   N A M E   W O R K   A R E A.             *
  1989*                                                               *
  1990*****************************************************************.
  1991
  1992 01  WS-NAME-WORK-AREA.
  1993     05  WS-INSURED-LAST-NAME        PIC X(15).
  1994     05  WS-INSURED-1ST-NAME         PIC X(12).
  1995     05  WS-INSURED-MID-INIT         PIC X.
  1996
  1997     05  WS-NAME-WORK.
  1998         10  WS-NW                   PIC X
  1999             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2000
  2001     05  WS-NAME-WORK2.
  2002         10  WS-NW2                  PIC X
  2003             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2004                                        NWA-INDEX0.
  2005
  2006     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2007                                     COMP-3.
  2008
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  41
* EL156.cbl
  2010*    COPY ELCDMO.
  2011******************************************************************
  2012*                                                                *
  2013*                                                                *
  2014*                            ELCDMO.                             *
  2015*                            VMOD=2.004                          *
  2016*                                                                *
  2017*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2018*        COMMUNICATION AREA                                      *
  2019*   FILE TYPE = NA                                               *
  2020*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2021*                                                                *
  2022******************************************************************
  2023 01  DMO-COMMUNICATION-AREA.
  2024     12  DM-RECORD-TYPE                  PIC  X(02).
  2025             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2026             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2027             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2028     12  DM-DIST-CODE                    PIC  X(04).
  2029     12  DM-MAIL-CODE                    PIC  X(05).
  2030     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2031     12  DM-INSURED-NAME                 PIC  X(30).
  2032     12  DM-CLAIM-NO                     PIC  X(07).
  2033     12  DM-CLAIM-TYPE                   PIC  X.
  2034
  2035     12  DM-STATUS-DATA-AREA.
  2036         16  DM-CLAIM-STATUS             PIC  X.
  2037             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2038             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2039             88  DM-CLOSED                        VALUE '3'.
  2040             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2041             88  DM-DEFAULT                       VALUE '9'.
  2042         16  DM-STATUS-DATE              PIC  X(08).
  2043******YYYYMMDD
  2044         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2045             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2046             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2047             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2048             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2049             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2050             88  DM-RE-OPENED                     VALUE 'R'.
  2051             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2052             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2053             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2054         16  DM-STAT-CARRIER             PIC X.
  2055
  2056     12  DM-DRAFT-DATA-AREA.
  2057         16  DM-PAYMENT-TYPE             PIC  X.
  2058             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2059         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2060         16  DM-PAYMENT-DATE             PIC  X(08).
  2061******YYYYMMDD
  2062         16  DM-CERT-NO                  PIC  X(11).
  2063         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2064         16  DM-CARRIER                  PIC  X.
  2065
  2066     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  42
* EL156.cbl
  2068*    COPY ELCDMDCD.
  2069******************************************************************
  2070*                                                                *
  2071*                                                                *
  2072*                            ELCDMDCD.                           *
  2073*                            VMOD=2.001                          *
  2074*                                                                *
  2075*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2076*       COMMUNICATIONS AREA                                      *
  2077*                                                                *
  2078******************************************************************
  2079 01  CD-COMMUNICATION-AREA.
  2080     12  CD-SYSTEM-ID            PIC  X(02).
  2081         88 CD-CLAIMS                      VALUE 'CL'.
  2082         88 CD-CREDIT                      VALUE 'CR'.
  2083     12  CD-RECORD-TYPE          PIC  X(02).
  2084         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2085         88 CD-EOB-CODE                    VALUE 'EO'.
  2086         88 CD-ICD9-CODE                   VALUE 'I9'.
  2087         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2088         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2089         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2090         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2091         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2092     12  CD-RECORD-KEY           PIC  X(06).
  2093         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2094     12  CD-RETURN-CODE          PIC  X(02).
  2095     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2096     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2097     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2098     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  43
* EL156.cbl
  2100*    COPY ELCDCTB.
  2101******************************************************************
  2102*                                                                *
  2103*                                                                *
  2104*                            ELCDCTB.                            *
  2105*                            VMOD=2.002                          *
  2106*                                                                *
  2107*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2108*       COMMUNICATIONS AREA                                      *
  2109*                                                                *
  2110******************************************************************
  2111 01  DCT-COMMUNICATION-AREA.
  2112     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2113     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2114     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2115     12  DCT-PRODUCT-CODE         PIC  X(02).
  2116     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2117     12  DCT-RETURN-CODE          PIC  X(02).
  2118     12  DCT-MAIL-CODE            PIC  X(05).
  2119     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2120     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  44
* EL156.cbl
  2122 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2123 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2124 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2125 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  45
* EL156.cbl
  2127*    COPY ELCINTF.
  2128******************************************************************
  2129*                                                                *
  2130*                                                                *
  2131*                            ELCINTF.                            *
  2132*                            VMOD=2.017                          *
  2133*                                                                *
  2134*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2135*                                                                *
  2136*       LENGTH = 1024                                            *
  2137*                                                                *
  2138******************************************************************
  2139*                   C H A N G E   L O G
  2140*
  2141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2142*-----------------------------------------------------------------
  2143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2144* EFFECTIVE    NUMBER
  2145*-----------------------------------------------------------------
  2146* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2147******************************************************************
  2148 01  PROGRAM-INTERFACE-BLOCK.
  2149     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2150     12  PI-CALLING-PROGRAM              PIC X(8).
  2151     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2152     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2153     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2154     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2155     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2156     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2157     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2158     12  PI-COMPANY-ID                   PIC XXX.
  2159     12  PI-COMPANY-CD                   PIC X.
  2160
  2161     12  PI-COMPANY-PASSWORD             PIC X(8).
  2162
  2163     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2164
  2165     12  PI-CONTROL-IN-PROGRESS.
  2166         16  PI-CARRIER                  PIC X.
  2167         16  PI-GROUPING                 PIC X(6).
  2168         16  PI-STATE                    PIC XX.
  2169         16  PI-ACCOUNT                  PIC X(10).
  2170         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2171                                         PIC X(10).
  2172         16  PI-CLAIM-CERT-GRP.
  2173             20  PI-CLAIM-NO             PIC X(7).
  2174             20  PI-CERT-NO.
  2175                 25  PI-CERT-PRIME       PIC X(10).
  2176                 25  PI-CERT-SFX         PIC X.
  2177             20  PI-CERT-EFF-DT          PIC XX.
  2178         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2179             20  PI-PLAN-CODE            PIC X(2).
  2180             20  PI-REVISION-NUMBER      PIC X(3).
  2181             20  PI-PLAN-EFF-DT          PIC X(2).
  2182             20  PI-PLAN-EXP-DT          PIC X(2).
  2183             20  FILLER                  PIC X(11).
  2184         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  46
* EL156.cbl
  2185             20  PI-OE-REFERENCE-1.
  2186                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2187                 25  PI-OE-REF-1-SUFF    PIC XX.
  2188
  2189     12  PI-SESSION-IN-PROGRESS          PIC X.
  2190         88  CLAIM-SESSION                   VALUE '1'.
  2191         88  CREDIT-SESSION                  VALUE '2'.
  2192         88  WARRANTY-SESSION                VALUE '3'.
  2193         88  MORTGAGE-SESSION                VALUE '4'.
  2194         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2195
  2196
  2197*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2198
  2199     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2200     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2201
  2202     12  PI-CREDIT-USER                  PIC X.
  2203         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2204         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2205
  2206     12  PI-CLAIM-USER                   PIC X.
  2207         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2208         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2209
  2210     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2211         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2212         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2213         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2214         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2215         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2216
  2217     12  PI-PROCESSOR-ID                 PIC X(4).
  2218
  2219     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2220
  2221     12  PI-MEMBER-CAPTION               PIC X(10).
  2222
  2223     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2224         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2225
  2226     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2227     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2228     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2229     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2230
  2231     12  PI-AH-OVERRIDE-L1               PIC X.
  2232     12  PI-AH-OVERRIDE-L2               PIC XX.
  2233     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2234     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2235
  2236     12  PI-NEW-SYSTEM                   PIC X(2).
  2237
  2238     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2239     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2240         88  PI-USES-PAID-TO                 VALUE '1'.
  2241     12  PI-CRDTCRD-SYSTEM.
  2242         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  47
* EL156.cbl
  2243             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2244             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2245         16  PI-CC-MONTH-END-DT          PIC XX.
  2246     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2247
  2248     12  PI-OE-REFERENCE-2.
  2249         16  PI-OE-REF-2-PRIME           PIC X(10).
  2250         16  PI-OE-REF-2-SUFF            PIC X.
  2251
  2252     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2253
  2254     12  PI-LANGUAGE-TYPE                PIC X.
  2255             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2256             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2257             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2258
  2259     12  PI-POLICY-LINKAGE-IND           PIC X.
  2260         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2261         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2262                                                   LOW-VALUES.
  2263
  2264     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2265     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2266         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2267         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2268
  2269     12  PI-PROCESSOR-CSR-IND            PIC X.
  2270         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2271         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2272
  2273     12  FILLER                          PIC X(3).
  2274
  2275     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2276
  2277     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2278         PI-SYSTEM-LEVEL.
  2279
  2280         16  PI-ENTRY-CODES.
  2281             20  PI-ENTRY-CD-1           PIC X.
  2282             20  PI-ENTRY-CD-2           PIC X.
  2283
  2284         16  PI-RETURN-CODES.
  2285             20  PI-RETURN-CD-1          PIC X.
  2286             20  PI-RETURN-CD-2          PIC X.
  2287
  2288         16  PI-UPDATE-STATUS-SAVE.
  2289             20  PI-UPDATE-BY            PIC X(4).
  2290             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2291
  2292         16  PI-LOWER-CASE-LETTERS       PIC X.
  2293             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2294
  2295*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2296*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2297*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2298
  2299         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2300             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  48
* EL156.cbl
  2301             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2302             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2303             88  ACCNT-CNTL                  VALUE '3'.
  2304             88  CARR-ACCNT-CNTL             VALUE '4'.
  2305
  2306         16  PI-PROCESSOR-CAP-LIST.
  2307             20  PI-SYSTEM-CONTROLS.
  2308                24 PI-SYSTEM-DISPLAY     PIC X.
  2309                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2310                24 PI-SYSTEM-MODIFY      PIC X.
  2311                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2312             20  FILLER                  PIC XX.
  2313             20  PI-DISPLAY-CAP          PIC X.
  2314                 88  DISPLAY-CAP             VALUE 'Y'.
  2315             20  PI-MODIFY-CAP           PIC X.
  2316                 88  MODIFY-CAP              VALUE 'Y'.
  2317             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2318                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2319             20  PI-FORCE-CAP            PIC X.
  2320                 88  FORCE-CAP               VALUE 'Y'.
  2321
  2322         16  PI-PROGRAM-CONTROLS.
  2323             20  PI-PGM-PRINT-OPT        PIC X.
  2324             20  PI-PGM-FORMAT-OPT       PIC X.
  2325             20  PI-PGM-PROCESS-OPT      PIC X.
  2326             20  PI-PGM-TOTALS-OPT       PIC X.
  2327
  2328         16  PI-HELP-INTERFACE.
  2329             20  PI-LAST-ERROR-NO        PIC X(4).
  2330             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2331
  2332         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2333             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2334
  2335         16  PI-CR-CONTROL-IN-PROGRESS.
  2336             20  PI-CR-CARRIER           PIC X.
  2337             20  PI-CR-GROUPING          PIC X(6).
  2338             20  PI-CR-STATE             PIC XX.
  2339             20  PI-CR-ACCOUNT           PIC X(10).
  2340             20  PI-CR-FIN-RESP          PIC X(10).
  2341             20  PI-CR-TYPE              PIC X.
  2342
  2343         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2344
  2345         16  PI-CR-MONTH-END-DT          PIC XX.
  2346
  2347         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2348             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2349             88  PI-ZERO-CARRIER             VALUE '1'.
  2350             88  PI-ZERO-GROUPING            VALUE '2'.
  2351             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2352
  2353         16  PI-CARRIER-SECURITY         PIC X.
  2354             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2355
  2356         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2357             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2358             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  49
* EL156.cbl
  2359
  2360         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2361             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2362                                         INDEXED BY PI-ACCESS-NDX
  2363                                         PIC X.
  2364
  2365         16  PI-GA-BILLING-CONTROL       PIC X.
  2366             88  PI-GA-BILLING               VALUE '1'.
  2367
  2368         16  PI-MAIL-PROCESSING          PIC X.
  2369             88  PI-MAIL-YES                 VALUE 'Y'.
  2370
  2371         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2372
  2373         16  PI-AR-SYSTEM.
  2374             20  PI-AR-PROCESSING-CNTL   PIC X.
  2375                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2376             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2377             20  PI-AR-MONTH-END-DT      PIC XX.
  2378
  2379         16  PI-MP-SYSTEM.
  2380             20  PI-MORTGAGE-USER            PIC X.
  2381                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2382                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2383             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2384                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2385                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2386                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2387                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2388                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2389             20  PI-MP-MONTH-END-DT          PIC XX.
  2390             20  PI-MP-REFERENCE-NO.
  2391                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2392                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2393
  2394         16  PI-LABEL-CONTROL            PIC X(01).
  2395             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2396             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2397
  2398         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2399             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2400
  2401         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2402             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2403             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2404
  2405         16  FILLER                      PIC X(14).
  2406
  2407     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2408******************************************************************
  2409     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2410         16  PI-SAVE-FORM        PIC X(12).
  2411         16  PI-ACCT-KEY         PIC X(26).
  2412         16  PI-PAYEE-NAME       PIC X(30).
  2413         16  PI-DAILY-RATE       PIC S9(3)V99.
  2414         16  PI-MONTH-END-SAVE   PIC XX.
  2415         16  PI-BENEFIT-SAVE.
  2416             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  50
* EL156.cbl
  2417             20  PI-BEN-TYPE     PIC X.
  2418         16  PI-MANUAL-SW        PIC 9.
  2419         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2420         16  PI-PASS-SW          PIC X.
  2421         16  PI-PFKEY-USED       PIC X.
  2422         16  PI-CK-ASSIGN        PIC X.
  2423         16  PI-FATAL-COUNT      PIC 99.
  2424         16  PI-FORCE-COUNT      PIC 99.
  2425         16  PI-SAVE-INPUT.
  2426             20  PI-PMTTYPE      PIC X.
  2427             20  PI-PAYEE.
  2428                 24  PI-PAYEE-TYPE PIC X.
  2429                 24  PI-PAYEE-SEQ  PIC X.
  2430                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2431                   PI-PAYEE-SEQ    PIC S9.
  2432             20  PI-PMTNOTE1     PIC X(60).
  2433             20  PI-PMTNOTE2     PIC X(60).
  2434             20  PI-OFFLINE      PIC X.
  2435             20  PI-ECHECKNO     PIC X(7).
  2436             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2437                 28  PI-ECHECKNO-N     PIC X.
  2438                 28  PI-ECHECKNO-6     PIC X(6).
  2439             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2440                 24  PI-ECHECKNO-CR    PIC XX.
  2441                 24  PI-ECHECKNO-5     PIC X(5).
  2442             20  PI-HOLDTIL      PIC 9(6).
  2443             20  PI-EPYFROM      PIC 9(6).
  2444             20  PI-EPYTHRU      PIC 9(6).
  2445             20  PI-EDAYS        PIC S9(5).
  2446             20  PI-EPYAMT       PIC S9(7)V99.
  2447             20  PI-ERESV        PIC S9(7)V99.
  2448             20  PI-EEXPENS      PIC 9(6)V99.
  2449             20  PI-ETYPE        PIC X.
  2450             20  PI-CASH         PIC X.
  2451             20  PI-GROUPED      PIC X.
  2452             20  PI-INT-RATE     PIC S99V9(5).
  2453             20  PI-AIGFROM      PIC 9(6).
  2454             20  PI-LOAN-NO      PIC X(20).
  2455             20  PI-PROOF-DATE   PIC 9(6).
  2456             20  PI-PRINT-EOB-YN PIC X.
  2457             20  PI-PRINT-CLM-FRM-YN PIC X.
  2458             20  PI-PRINT-SURVEY-YN PIC X.
  2459             20  PI-SPECIAL-RELEASE-YN PIC X.
  2460         16  PI-SAVE-COMPUTED.
  2461             20  PI-CCHECKNO     PIC X(7).
  2462             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2463                 28  PI-CCHECKNO-N     PIC X.
  2464                 28  PI-CCHECKNO-6     PIC X(6).
  2465             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2466                 24  PI-CCHECKNO-CR    PIC XX.
  2467                 24  PI-CCHECKNO-5     PIC X(5).
  2468             20  PI-CPYFROM      PIC XX.
  2469             20  PI-CPYTHRU      PIC XX.
  2470             20  PI-CDAYS        PIC S9(5).
  2471             20  PI-CPYAMT       PIC S9(7)V99.
  2472             20  PI-CRESV        PIC 9(6)V99.
  2473             20  PI-CEXPENS      PIC 9(6)V99.
  2474             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  51
* EL156.cbl
  2475                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2476                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2477                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2478         16  PI-PREV-CLMNO       PIC X(7).
  2479         16  PI-LF-COVERAGE-TYPE PIC X.
  2480         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2481         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2482         16  PI-PROVISIONAL-IND  PIC X.
  2483             88 PI-PROV-PMT      VALUE 'P'.
  2484         16  PI-PREV-TRLR-KEY    PIC X(22).
  2485         16  PI-SPLIT-PMT-SW     PIC X.
  2486         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2487         16  PI-ACTIVITY-CODE    PIC 99.
  2488         16  PI-RESET-SW         PIC X.
  2489         16  PI-SPECIAL-BEN-SW   PIC X.
  2490             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2491         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2492         16  PI-EXP-DT           PIC XX.
  2493         16  PI-LOAN-DUE-DAY     PIC 99.
  2494         16  PI-3RD-PARTY-SW     PIC X.
  2495         16  PI-LOAN-UPDATE-SW   PIC X.
  2496
  2497         16  PI-DMD-DATA.
  2498             20  PI-SV-CERT-KEY       PIC X(21).
  2499             20  PI-SV-CERT-NO        PIC X(11).
  2500             20  PI-SV-BEN            PIC X(10).
  2501             20  PI-SV-CCN            PIC X(16).
  2502             20  PI-INTEREST-PAID-IND PIC X.
  2503                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2504             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2505             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2506             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2507             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2508         16  PI-AT-EOB-CODES.
  2509             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2510         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2511         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2512         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2513         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2514         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2515         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2516         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2517         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2518         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2519         16  PI-LF-BENEFIT-CD         PIC X(2).
  2520         16  PI-EOB-CODES-EXIST PIC X.
  2521         16  PI-SET-NOTE2-MDT   PIC X.
  2522         16  PI-VFY-2ND-BENE          PIC X.
  2523         16  PI-CLM-TYPE              PIC X.
  2524         16  PI-APPROVAL-LEVEL        PIC X.
  2525         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2526         16  PI-REAUDIT-NEEDED        PIC X.
  2527         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2528         16  PI-AH-BENEFIT-CD         PIC XX.
  2529*00781          16  FILLER                   PIC X(176).
  2530*052506         16  FILLER                   PIC X(161).
  2531*031808         16  FILLER                   PIC X(154).
  2532*091808         16  FILLER                   PIC X(152).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  52
* EL156.cbl
  2533*041710         16  FILLER                   PIC X(94).
  2534         16  FILLER                   PIC X(81).
  2535
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  53
* EL156.cbl
  2537*    COPY ELCJPFX.
  2538******************************************************************
  2539*                                                                *
  2540*                                                                *
  2541*                            ELCJPFX.                            *
  2542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2543*                            VMOD=2.002                          *
  2544*                                                                *
  2545*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2546*                                                                *
  2547*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2548*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2549*        ELCNTL - CONTROL FILE                                   *
  2550*        ELMSTR - CLAIM MASTERS                                  *
  2551*        ELTRLR - ACTIVITY TRAILERS                              *
  2552*        ELCHKQ - CHECK QUE                                      *
  2553******************************************************************
  2554 01  JOURNAL-RECORD.
  2555     12  jp-date                     pic s9(5) comp-3.
  2556     12  jp-time                     pic s9(7) comp-3.
  2557     12  JP-USER-ID                  PIC X(4).
  2558     12  JP-FILE-ID                  PIC X(8).
  2559     12  JP-PROGRAM-ID               PIC X(8).
  2560     12  JP-RECORD-TYPE              PIC X.
  2561         88 JP-ADD              VALUE 'A'.
  2562         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2563         88 JP-AFTER-CHANGE     VALUE 'C'.
  2564         88 JP-DELETE           VALUE 'D'.
  2565         88 JP-GENERIC-DELETE   VALUE 'G'.
  2566         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2567         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2568     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2569     12  JP-RECORD-AREA
  2570
  2571
  2572                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  54
* EL156.cbl
  2574*    COPY ELCAID.
  2575******************************************************************
  2576*                                                                *
  2577*                            ELCAID.                             *
  2578*                            VMOD=2.001                          *
  2579*                                                                *
  2580*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2581*                                                                *
  2582*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2583*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2584******************************************************************
  2585
  2586 01  DFHAID.
  2587   02  DFHNULL   PIC  X  VALUE  ' '.
  2588   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2589   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2590   02  DFHPEN    PIC  X  VALUE  '='.
  2591   02  DFHOPID   PIC  X  VALUE  'W'.
  2592   02  DFHPA1    PIC  X  VALUE  '%'.
  2593   02  DFHPA2    PIC  X  VALUE  '>'.
  2594   02  DFHPA3    PIC  X  VALUE  ','.
  2595   02  DFHPF1    PIC  X  VALUE  '1'.
  2596   02  DFHPF2    PIC  X  VALUE  '2'.
  2597   02  DFHPF3    PIC  X  VALUE  '3'.
  2598   02  DFHPF4    PIC  X  VALUE  '4'.
  2599   02  DFHPF5    PIC  X  VALUE  '5'.
  2600   02  DFHPF6    PIC  X  VALUE  '6'.
  2601   02  DFHPF7    PIC  X  VALUE  '7'.
  2602   02  DFHPF8    PIC  X  VALUE  '8'.
  2603   02  DFHPF9    PIC  X  VALUE  '9'.
  2604   02  DFHPF10   PIC  X  VALUE  ':'.
  2605   02  DFHPF11   PIC  X  VALUE  '#'.
  2606   02  DFHPF12   PIC  X  VALUE  '@'.
  2607   02  DFHPF13   PIC  X  VALUE  'A'.
  2608   02  DFHPF14   PIC  X  VALUE  'B'.
  2609   02  DFHPF15   PIC  X  VALUE  'C'.
  2610   02  DFHPF16   PIC  X  VALUE  'D'.
  2611   02  DFHPF17   PIC  X  VALUE  'E'.
  2612   02  DFHPF18   PIC  X  VALUE  'F'.
  2613   02  DFHPF19   PIC  X  VALUE  'G'.
  2614   02  DFHPF20   PIC  X  VALUE  'H'.
  2615   02  DFHPF21   PIC  X  VALUE  'I'.
  2616*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2617   02  DFHPF22   PIC  X  VALUE  '['.
  2618   02  DFHPF23   PIC  X  VALUE  '.'.
  2619   02  DFHPF24   PIC  X  VALUE  '<'.
  2620   02  DFHMSRE   PIC  X  VALUE  'X'.
  2621   02  DFHSTRF   PIC  X  VALUE  'h'.
  2622   02  DFHTRIG   PIC  X  VALUE  '"'.
  2623 01  FILLER    REDEFINES DFHAID.
  2624     12  FILLER              PIC X(8).
  2625     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  55
* EL156.cbl
  2627*    COPY EL156S.
  2628 01  EL156AI.
  2629     05  FILLER            PIC  X(0012).
  2630*    -------------------------------
  2631     05  RUNDTEAL PIC S9(0004) COMP.
  2632     05  RUNDTEAF PIC  X(0001).
  2633     05  FILLER REDEFINES RUNDTEAF.
  2634         10  RUNDTEAA PIC  X(0001).
  2635     05  RUNDTEAI PIC  X(0008).
  2636*    -------------------------------
  2637     05  RUNTIMAL PIC S9(0004) COMP.
  2638     05  RUNTIMAF PIC  X(0001).
  2639     05  FILLER REDEFINES RUNTIMAF.
  2640         10  RUNTIMAA PIC  X(0001).
  2641     05  RUNTIMAI PIC  X(0005).
  2642*    -------------------------------
  2643     05  SEQUL PIC S9(0004) COMP.
  2644     05  SEQUF PIC  X(0001).
  2645     05  FILLER REDEFINES SEQUF.
  2646         10  SEQUA PIC  X(0001).
  2647     05  SEQUI PIC  X(0010).
  2648*    -------------------------------
  2649     05  CLMNOL PIC S9(0004) COMP.
  2650     05  CLMNOF PIC  X(0001).
  2651     05  FILLER REDEFINES CLMNOF.
  2652         10  CLMNOA PIC  X(0001).
  2653     05  CLMNOI PIC  X(0007).
  2654*    -------------------------------
  2655     05  CARRL PIC S9(0004) COMP.
  2656     05  CARRF PIC  X(0001).
  2657     05  FILLER REDEFINES CARRF.
  2658         10  CARRA PIC  X(0001).
  2659     05  CARRI PIC  X(0001).
  2660*    -------------------------------
  2661     05  CERTNOL PIC S9(0004) COMP.
  2662     05  CERTNOF PIC  X(0001).
  2663     05  FILLER REDEFINES CERTNOF.
  2664         10  CERTNOA PIC  X(0001).
  2665     05  CERTNOI PIC  X(0010).
  2666*    -------------------------------
  2667     05  SUFXL PIC S9(0004) COMP.
  2668     05  SUFXF PIC  X(0001).
  2669     05  FILLER REDEFINES SUFXF.
  2670         10  SUFXA PIC  X(0001).
  2671     05  SUFXI PIC  X(0001).
  2672*    -------------------------------
  2673     05  CLMTYPL PIC S9(0004) COMP.
  2674     05  CLMTYPF PIC  X(0001).
  2675     05  FILLER REDEFINES CLMTYPF.
  2676         10  CLMTYPA PIC  X(0001).
  2677     05  CLMTYPI PIC  X(0006).
  2678*    -------------------------------
  2679     05  CLMSTATL PIC S9(0004) COMP.
  2680     05  CLMSTATF PIC  X(0001).
  2681     05  FILLER REDEFINES CLMSTATF.
  2682         10  CLMSTATA PIC  X(0001).
  2683     05  CLMSTATI PIC  X(0006).
  2684*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  56
* EL156.cbl
  2685     05  LSTNMEL PIC S9(0004) COMP.
  2686     05  LSTNMEF PIC  X(0001).
  2687     05  FILLER REDEFINES LSTNMEF.
  2688         10  LSTNMEA PIC  X(0001).
  2689     05  LSTNMEI PIC  X(0015).
  2690*    -------------------------------
  2691     05  FSTNMEL PIC S9(0004) COMP.
  2692     05  FSTNMEF PIC  X(0001).
  2693     05  FILLER REDEFINES FSTNMEF.
  2694         10  FSTNMEA PIC  X(0001).
  2695     05  FSTNMEI PIC  X(0012).
  2696*    -------------------------------
  2697     05  MINITL PIC S9(0004) COMP.
  2698     05  MINITF PIC  X(0001).
  2699     05  FILLER REDEFINES MINITF.
  2700         10  MINITA PIC  X(0001).
  2701     05  MINITI PIC  X(0001).
  2702*    -------------------------------
  2703     05  PRIMHDGL PIC S9(0004) COMP.
  2704     05  PRIMHDGF PIC  X(0001).
  2705     05  FILLER REDEFINES PRIMHDGF.
  2706         10  PRIMHDGA PIC  X(0001).
  2707     05  PRIMHDGI PIC  X(0012).
  2708*    -------------------------------
  2709     05  PCERTNOL PIC S9(0004) COMP.
  2710     05  PCERTNOF PIC  X(0001).
  2711     05  FILLER REDEFINES PCERTNOF.
  2712         10  PCERTNOA PIC  X(0001).
  2713     05  PCERTNOI PIC  X(0010).
  2714*    -------------------------------
  2715     05  PSUFXL PIC S9(0004) COMP.
  2716     05  PSUFXF PIC  X(0001).
  2717     05  FILLER REDEFINES PSUFXF.
  2718         10  PSUFXA PIC  X(0001).
  2719     05  PSUFXI PIC  X(0001).
  2720*    -------------------------------
  2721     05  STATUSL PIC S9(0004) COMP.
  2722     05  STATUSF PIC  X(0001).
  2723     05  FILLER REDEFINES STATUSF.
  2724         10  STATUSA PIC  X(0001).
  2725     05  STATUSI PIC  X(0010).
  2726*    -------------------------------
  2727     05  LOANHL PIC S9(0004) COMP.
  2728     05  LOANHF PIC  X(0001).
  2729     05  FILLER REDEFINES LOANHF.
  2730         10  LOANHA PIC  X(0001).
  2731     05  LOANHI PIC  X(0014).
  2732*    -------------------------------
  2733     05  LOANNOL PIC S9(0004) COMP.
  2734     05  LOANNOF PIC  X(0001).
  2735     05  FILLER REDEFINES LOANNOF.
  2736         10  LOANNOA PIC  X(0001).
  2737     05  LOANNOI PIC  X(0025).
  2738*    -------------------------------
  2739     05  DUEDAYHL PIC S9(0004) COMP.
  2740     05  DUEDAYHF PIC  X(0001).
  2741     05  FILLER REDEFINES DUEDAYHF.
  2742         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  57
* EL156.cbl
  2743     05  DUEDAYHI PIC  X(0008).
  2744*    -------------------------------
  2745     05  DUEDAYL PIC S9(0004) COMP.
  2746     05  DUEDAYF PIC  X(0001).
  2747     05  FILLER REDEFINES DUEDAYF.
  2748         10  DUEDAYA PIC  X(0001).
  2749     05  DUEDAYI PIC  X(0002).
  2750*    -------------------------------
  2751     05  ZINTHL PIC S9(0004) COMP.
  2752     05  ZINTHF PIC  X(0001).
  2753     05  FILLER REDEFINES ZINTHF.
  2754         10  ZINTHA PIC  X(0001).
  2755     05  ZINTHI PIC  X(0009).
  2756*    -------------------------------
  2757     05  ZINTL PIC S9(0004) COMP.
  2758     05  ZINTF PIC  X(0001).
  2759     05  FILLER REDEFINES ZINTF.
  2760         10  ZINTA PIC  X(0001).
  2761     05  ZINTI PIC  99V99999.
  2762*    -------------------------------
  2763     05  PTHRHDGL PIC S9(0004) COMP.
  2764     05  PTHRHDGF PIC  X(0001).
  2765     05  FILLER REDEFINES PTHRHDGF.
  2766         10  PTHRHDGA PIC  X(0001).
  2767     05  PTHRHDGI PIC  X(0014).
  2768*    -------------------------------
  2769     05  PDTHRUL PIC S9(0004) COMP.
  2770     05  PDTHRUF PIC  X(0001).
  2771     05  FILLER REDEFINES PDTHRUF.
  2772         10  PDTHRUA PIC  X(0001).
  2773     05  PDTHRUI PIC  X(0008).
  2774*    -------------------------------
  2775     05  TOTPAIDL PIC S9(0004) COMP.
  2776     05  TOTPAIDF PIC  X(0001).
  2777     05  FILLER REDEFINES TOTPAIDF.
  2778         10  TOTPAIDA PIC  X(0001).
  2779     05  TOTPAIDI PIC  X(0010).
  2780*    -------------------------------
  2781     05  COVERL PIC S9(0004) COMP.
  2782     05  COVERF PIC  X(0001).
  2783     05  FILLER REDEFINES COVERF.
  2784         10  COVERA PIC  X(0001).
  2785     05  COVERI PIC  X(0010).
  2786*    -------------------------------
  2787     05  INCURL PIC S9(0004) COMP.
  2788     05  INCURF PIC  X(0001).
  2789     05  FILLER REDEFINES INCURF.
  2790         10  INCURA PIC  X(0001).
  2791     05  INCURI PIC  X(0008).
  2792*    -------------------------------
  2793     05  LSTDTEL PIC S9(0004) COMP.
  2794     05  LSTDTEF PIC  X(0001).
  2795     05  FILLER REDEFINES LSTDTEF.
  2796         10  LSTDTEA PIC  X(0001).
  2797     05  LSTDTEI PIC  X(0008).
  2798*    -------------------------------
  2799     05  CRTSTATL PIC S9(0004) COMP.
  2800     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  58
* EL156.cbl
  2801     05  FILLER REDEFINES CRTSTATF.
  2802         10  CRTSTATA PIC  X(0001).
  2803     05  CRTSTATI PIC  X(0010).
  2804*    -------------------------------
  2805     05  EFFECTL PIC S9(0004) COMP.
  2806     05  EFFECTF PIC  X(0001).
  2807     05  FILLER REDEFINES EFFECTF.
  2808         10  EFFECTA PIC  X(0001).
  2809     05  EFFECTI PIC  X(0008).
  2810*    -------------------------------
  2811     05  TERMSL PIC S9(0004) COMP.
  2812     05  TERMSF PIC  X(0001).
  2813     05  FILLER REDEFINES TERMSF.
  2814         10  TERMSA PIC  X(0001).
  2815     05  TERMSI PIC  X(0011).
  2816*    -------------------------------
  2817     05  STACCTL PIC S9(0004) COMP.
  2818     05  STACCTF PIC  X(0001).
  2819     05  FILLER REDEFINES STACCTF.
  2820         10  STACCTA PIC  X(0001).
  2821     05  STACCTI PIC  X(0013).
  2822*    -------------------------------
  2823     05  EXPDTEHL PIC S9(0004) COMP.
  2824     05  EXPDTEHF PIC  X(0001).
  2825     05  FILLER REDEFINES EXPDTEHF.
  2826         10  EXPDTEHA PIC  X(0001).
  2827     05  EXPDTEHI PIC  X(0014).
  2828*    -------------------------------
  2829     05  EXPDTEL PIC S9(0004) COMP.
  2830     05  EXPDTEF PIC  X(0001).
  2831     05  FILLER REDEFINES EXPDTEF.
  2832         10  EXPDTEA PIC  X(0001).
  2833     05  EXPDTEI PIC  X(0008).
  2834*    -------------------------------
  2835     05  BENECAPL PIC S9(0004) COMP.
  2836     05  BENECAPF PIC  X(0001).
  2837     05  FILLER REDEFINES BENECAPF.
  2838         10  BENECAPA PIC  X(0001).
  2839     05  BENECAPI PIC  X(0013).
  2840*    -------------------------------
  2841     05  BENEL PIC S9(0004) COMP.
  2842     05  BENEF PIC  X(0001).
  2843     05  FILLER REDEFINES BENEF.
  2844         10  BENEA PIC  X(0001).
  2845     05  BENEI PIC  X(0009).
  2846*    -------------------------------
  2847     05  FORMTYPL PIC S9(0004) COMP.
  2848     05  FORMTYPF PIC  X(0001).
  2849     05  FILLER REDEFINES FORMTYPF.
  2850         10  FORMTYPA PIC  X(0001).
  2851     05  FORMTYPI PIC  X(0001).
  2852*    -------------------------------
  2853     05  PMTTYPEL PIC S9(0004) COMP.
  2854     05  PMTTYPEF PIC  X(0001).
  2855     05  FILLER REDEFINES PMTTYPEF.
  2856         10  PMTTYPEA PIC  X(0001).
  2857     05  PMTTYPEI PIC  X(0001).
  2858*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  59
* EL156.cbl
  2859     05  PAYEEL PIC S9(0004) COMP.
  2860     05  PAYEEF PIC  X(0001).
  2861     05  FILLER REDEFINES PAYEEF.
  2862         10  PAYEEA PIC  X(0001).
  2863     05  PAYEEI PIC  X(0002).
  2864*    -------------------------------
  2865     05  CHECKNOL PIC S9(0004) COMP.
  2866     05  CHECKNOF PIC  X(0001).
  2867     05  FILLER REDEFINES CHECKNOF.
  2868         10  CHECKNOA PIC  X(0001).
  2869     05  CHECKNOI PIC  X(0007).
  2870*    -------------------------------
  2871     05  OFFLINEL PIC S9(0004) COMP.
  2872     05  OFFLINEF PIC  X(0001).
  2873     05  FILLER REDEFINES OFFLINEF.
  2874         10  OFFLINEA PIC  X(0001).
  2875     05  OFFLINEI PIC  X(0001).
  2876*    -------------------------------
  2877     05  HOLDTILL PIC S9(0004) COMP.
  2878     05  HOLDTILF PIC  X(0001).
  2879     05  FILLER REDEFINES HOLDTILF.
  2880         10  HOLDTILA PIC  X(0001).
  2881     05  HOLDTILI PIC  X(0008).
  2882*    -------------------------------
  2883     05  NOTE1L PIC S9(0004) COMP.
  2884     05  NOTE1F PIC  X(0001).
  2885     05  FILLER REDEFINES NOTE1F.
  2886         10  NOTE1A PIC  X(0001).
  2887     05  NOTE1I PIC  X(0060).
  2888*    -------------------------------
  2889     05  NOTE2L PIC S9(0004) COMP.
  2890     05  NOTE2F PIC  X(0001).
  2891     05  FILLER REDEFINES NOTE2F.
  2892         10  NOTE2A PIC  X(0001).
  2893     05  NOTE2I PIC  X(0060).
  2894*    -------------------------------
  2895     05  EOBYNL PIC S9(0004) COMP.
  2896     05  EOBYNF PIC  X(0001).
  2897     05  FILLER REDEFINES EOBYNF.
  2898         10  EOBYNA PIC  X(0001).
  2899     05  EOBYNI PIC  X(0001).
  2900*    -------------------------------
  2901     05  CLMFMYNL PIC S9(0004) COMP.
  2902     05  CLMFMYNF PIC  X(0001).
  2903     05  FILLER REDEFINES CLMFMYNF.
  2904         10  CLMFMYNA PIC  X(0001).
  2905     05  CLMFMYNI PIC  X(0001).
  2906*    -------------------------------
  2907     05  SURVYYNL PIC S9(0004) COMP.
  2908     05  SURVYYNF PIC  X(0001).
  2909     05  FILLER REDEFINES SURVYYNF.
  2910         10  SURVYYNA PIC  X(0001).
  2911     05  SURVYYNI PIC  X(0001).
  2912*    -------------------------------
  2913     05  SPRELYNL PIC S9(0004) COMP.
  2914     05  SPRELYNF PIC  X(0001).
  2915     05  FILLER REDEFINES SPRELYNF.
  2916         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  60
* EL156.cbl
  2917     05  SPRELYNI PIC  X(0001).
  2918*    -------------------------------
  2919     05  PINTHL PIC S9(0004) COMP.
  2920     05  PINTHF PIC  X(0001).
  2921     05  FILLER REDEFINES PINTHF.
  2922         10  PINTHA PIC  X(0001).
  2923     05  PINTHI PIC  X(0004).
  2924*    -------------------------------
  2925     05  PINTL PIC S9(0004) COMP.
  2926     05  PINTF PIC  X(0001).
  2927     05  FILLER REDEFINES PINTF.
  2928         10  PINTA PIC  X(0001).
  2929     05  PINTI PIC  X(0008).
  2930*    -------------------------------
  2931     05  PROOFDTL PIC S9(0004) COMP.
  2932     05  PROOFDTF PIC  X(0001).
  2933     05  FILLER REDEFINES PROOFDTF.
  2934         10  PROOFDTA PIC  X(0001).
  2935     05  PROOFDTI PIC  X(0008).
  2936*    -------------------------------
  2937     05  AIGFRMHL PIC S9(0004) COMP.
  2938     05  AIGFRMHF PIC  X(0001).
  2939     05  FILLER REDEFINES AIGFRMHF.
  2940         10  AIGFRMHA PIC  X(0001).
  2941     05  AIGFRMHI PIC  X(0012).
  2942*    -------------------------------
  2943     05  AIGFROML PIC S9(0004) COMP.
  2944     05  AIGFROMF PIC  X(0001).
  2945     05  FILLER REDEFINES AIGFROMF.
  2946         10  AIGFROMA PIC  X(0001).
  2947     05  AIGFROMI PIC  X(0008).
  2948*    -------------------------------
  2949     05  PMTHDGAL PIC S9(0004) COMP.
  2950     05  PMTHDGAF PIC  X(0001).
  2951     05  FILLER REDEFINES PMTHDGAF.
  2952         10  PMTHDGAA PIC  X(0001).
  2953     05  PMTHDGAI PIC  X(0066).
  2954*    -------------------------------
  2955     05  EPYFROML PIC S9(0004) COMP.
  2956     05  EPYFROMF PIC  X(0001).
  2957     05  FILLER REDEFINES EPYFROMF.
  2958         10  EPYFROMA PIC  X(0001).
  2959     05  EPYFROMI PIC  X(0008).
  2960*    -------------------------------
  2961     05  EPYTHRUL PIC S9(0004) COMP.
  2962     05  EPYTHRUF PIC  X(0001).
  2963     05  FILLER REDEFINES EPYTHRUF.
  2964         10  EPYTHRUA PIC  X(0001).
  2965     05  EPYTHRUI PIC  X(0008).
  2966*    -------------------------------
  2967     05  EDAYSL PIC S9(0004) COMP.
  2968     05  EDAYSF PIC  X(0001).
  2969     05  FILLER REDEFINES EDAYSF.
  2970         10  EDAYSA PIC  X(0001).
  2971     05  EDAYSI PIC  S9(6).
  2972*    -------------------------------
  2973     05  EPYAMTL PIC S9(0004) COMP.
  2974     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  61
* EL156.cbl
  2975     05  FILLER REDEFINES EPYAMTF.
  2976         10  EPYAMTA PIC  X(0001).
  2977     05  EPYAMTI PIC  S9(8)V99.
  2978*    -------------------------------
  2979     05  ERESVL PIC S9(0004) COMP.
  2980     05  ERESVF PIC  X(0001).
  2981     05  FILLER REDEFINES ERESVF.
  2982         10  ERESVA PIC  X(0001).
  2983     05  ERESVI PIC  S9(7)V99.
  2984*    -------------------------------
  2985     05  ETYPEL PIC S9(0004) COMP.
  2986     05  ETYPEF PIC  X(0001).
  2987     05  FILLER REDEFINES ETYPEF.
  2988         10  ETYPEA PIC  X(0001).
  2989     05  ETYPEI PIC  X(0001).
  2990*    -------------------------------
  2991     05  EEXPENSL PIC S9(0004) COMP.
  2992     05  EEXPENSF PIC  X(0001).
  2993     05  FILLER REDEFINES EEXPENSF.
  2994         10  EEXPENSA PIC  X(0001).
  2995     05  EEXPENSI PIC  9(6)V99.
  2996*    -------------------------------
  2997     05  CPYFROML PIC S9(0004) COMP.
  2998     05  CPYFROMF PIC  X(0001).
  2999     05  FILLER REDEFINES CPYFROMF.
  3000         10  CPYFROMA PIC  X(0001).
  3001     05  CPYFROMI PIC  X(0008).
  3002*    -------------------------------
  3003     05  CPYTHRUL PIC S9(0004) COMP.
  3004     05  CPYTHRUF PIC  X(0001).
  3005     05  FILLER REDEFINES CPYTHRUF.
  3006         10  CPYTHRUA PIC  X(0001).
  3007     05  CPYTHRUI PIC  X(0008).
  3008*    -------------------------------
  3009     05  CDAYSL PIC S9(0004) COMP.
  3010     05  CDAYSF PIC  X(0001).
  3011     05  FILLER REDEFINES CDAYSF.
  3012         10  CDAYSA PIC  X(0001).
  3013     05  CDAYSI PIC  9(6).
  3014*    -------------------------------
  3015     05  CPYAMTL PIC S9(0004) COMP.
  3016     05  CPYAMTF PIC  X(0001).
  3017     05  FILLER REDEFINES CPYAMTF.
  3018         10  CPYAMTA PIC  X(0001).
  3019     05  CPYAMTI PIC  S9(8)V99.
  3020*    -------------------------------
  3021     05  CRESVL PIC S9(0004) COMP.
  3022     05  CRESVF PIC  X(0001).
  3023     05  FILLER REDEFINES CRESVF.
  3024         10  CRESVA PIC  X(0001).
  3025     05  CRESVI PIC  9(6)V99.
  3026*    -------------------------------
  3027     05  CEXPENSL PIC S9(0004) COMP.
  3028     05  CEXPENSF PIC  X(0001).
  3029     05  FILLER REDEFINES CEXPENSF.
  3030         10  CEXPENSA PIC  X(0001).
  3031     05  CEXPENSI PIC  9(6)V99.
  3032*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  62
* EL156.cbl
  3033     05  ERRMSG0L PIC S9(0004) COMP.
  3034     05  ERRMSG0F PIC  X(0001).
  3035     05  FILLER REDEFINES ERRMSG0F.
  3036         10  ERRMSG0A PIC  X(0001).
  3037     05  ERRMSG0I PIC  X(0072).
  3038*    -------------------------------
  3039     05  ERRMSG1L PIC S9(0004) COMP.
  3040     05  ERRMSG1F PIC  X(0001).
  3041     05  FILLER REDEFINES ERRMSG1F.
  3042         10  ERRMSG1A PIC  X(0001).
  3043     05  ERRMSG1I PIC  X(0072).
  3044*    -------------------------------
  3045     05  ERRMSG2L PIC S9(0004) COMP.
  3046     05  ERRMSG2F PIC  X(0001).
  3047     05  FILLER REDEFINES ERRMSG2F.
  3048         10  ERRMSG2A PIC  X(0001).
  3049     05  ERRMSG2I PIC  X(0072).
  3050*    -------------------------------
  3051     05  ENTERPFL PIC S9(0004) COMP.
  3052     05  ENTERPFF PIC  X(0001).
  3053     05  FILLER REDEFINES ENTERPFF.
  3054         10  ENTERPFA PIC  X(0001).
  3055     05  ENTERPFI PIC  99.
  3056*    -------------------------------
  3057     05  PF6TITL PIC S9(0004) COMP.
  3058     05  PF6TITF PIC  X(0001).
  3059     05  FILLER REDEFINES PF6TITF.
  3060         10  PF6TITA PIC  X(0001).
  3061     05  PF6TITI PIC  X(0016).
  3062 01  EL156AO REDEFINES EL156AI.
  3063     05  FILLER            PIC  X(0012).
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  RUNDTEAO PIC  X(0008).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
  3069     05  RUNTIMAO PIC  99.99.
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  SEQUO PIC  X(0010).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  CLMNOO PIC  X(0007).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  CARRO PIC  X(0001).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  CERTNOO PIC  X(0010).
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  SUFXO PIC  X(0001).
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  CLMTYPO PIC  X(0006).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  63
* EL156.cbl
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  LSTNMEO PIC  X(0015).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  FSTNMEO PIC  X(0012).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  MINITO PIC  X(0001).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  PRIMHDGO PIC  X(0012).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  PCERTNOO PIC  X(0010).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  PSUFXO PIC  X(0001).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  STATUSO PIC  X(0010).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  LOANHO PIC  X(0014).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  LOANNOO PIC  X(0025).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  DUEDAYHO PIC  X(0008).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  DUEDAYO PIC  X(0002).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  ZINTHO PIC  X(0009).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  ZINTO PIC  9.99999.
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  PTHRHDGO PIC  X(0014).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  PDTHRUO PIC  X(0008).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  TOTPAIDO PIC  Z(6).99-.
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  COVERO PIC  X(0010).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  INCURO PIC  X(0008).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  LSTDTEO PIC  X(0008).
  3148*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  64
* EL156.cbl
  3149     05  FILLER            PIC  X(0003).
  3150     05  CRTSTATO PIC  X(0010).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  EFFECTO PIC  X(0008).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  TERMSO PIC  X(0011).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  STACCTO PIC  X(0013).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  EXPDTEHO PIC  X(0014).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  EXPDTEO PIC  X(0008).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  BENECAPO PIC  X(0013).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  BENEO PIC  Z(6).99.
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  FORMTYPO PIC  X(0001).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  PMTTYPEO PIC  X(0001).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  PAYEEO PIC  X(0002).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  CHECKNOO PIC  X(0007).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  OFFLINEO PIC  X(0001).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  HOLDTILO PIC  99B99B99.
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  NOTE1O PIC  X(0060).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  NOTE2O PIC  X(0060).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  EOBYNO PIC  X(0001).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  CLMFMYNO PIC  X(0001).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  SURVYYNO PIC  X(0001).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  65
* EL156.cbl
  3207     05  SPRELYNO PIC  X(0001).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  PINTHO PIC  X(0004).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  PINTO PIC  Z,ZZ9.99.
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  PROOFDTO PIC  99B99B99.
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  AIGFRMHO PIC  X(0012).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  AIGFROMO PIC  99B99B99.
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  PMTHDGAO PIC  X(0066).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  EPYFROMO PIC  99B99B99.
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  EPYTHRUO PIC  99B99B99.
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  EDAYSO PIC  Z(4)9-.
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EPYAMTO PIC  Z(6).99-.
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  ERESVO PIC  Z(5).99-.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  ETYPEO PIC  X(0001).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  EEXPENSO PIC  Z(5).99.
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  CPYFROMO PIC  99B99B99.
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  CPYTHRUO PIC  99B99B99.
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  CDAYSO PIC  Z(4)9-.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  CPYAMTO PIC  Z(6).99-.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  CRESVO PIC  Z(5).99.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  66
* EL156.cbl
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  ERRMSG0O PIC  X(0072).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  ERRMSG1O PIC  X(0072).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  ERRMSG2O PIC  X(0072).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  ENTERPFO PIC  X(0002).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  PF6TITO PIC  X(0016).
  3280*    -------------------------------
  3281 01  EL156BI REDEFINES EL156AI.
  3282     05  FILLER            PIC  X(0012).
  3283*    -------------------------------
  3284     05  RUNDTEBL PIC S9(0004) COMP.
  3285     05  RUNDTEBF PIC  X(0001).
  3286     05  FILLER REDEFINES RUNDTEBF.
  3287         10  RUNDTEBA PIC  X(0001).
  3288     05  RUNDTEBI PIC  X(0008).
  3289*    -------------------------------
  3290     05  RUNTIMBL PIC S9(0004) COMP.
  3291     05  RUNTIMBF PIC  X(0001).
  3292     05  FILLER REDEFINES RUNTIMBF.
  3293         10  RUNTIMBA PIC  X(0001).
  3294     05  RUNTIMBI PIC  X(0005).
  3295*    -------------------------------
  3296     05  PAYDTBL PIC S9(0004) COMP.
  3297     05  PAYDTBF PIC  X(0001).
  3298     05  FILLER REDEFINES PAYDTBF.
  3299         10  PAYDTBA PIC  X(0001).
  3300     05  PAYDTBI PIC  X(0008).
  3301*    -------------------------------
  3302     05  PAYTYPBL PIC S9(0004) COMP.
  3303     05  PAYTYPBF PIC  X(0001).
  3304     05  FILLER REDEFINES PAYTYPBF.
  3305         10  PAYTYPBA PIC  X(0001).
  3306     05  PAYTYPBI PIC  X(0015).
  3307*    -------------------------------
  3308     05  PAYAMTBL PIC S9(0004) COMP.
  3309     05  PAYAMTBF PIC  X(0001).
  3310     05  FILLER REDEFINES PAYAMTBF.
  3311         10  PAYAMTBA PIC  X(0001).
  3312     05  PAYAMTBI PIC  X(0011).
  3313*    -------------------------------
  3314     05  LOANHBL PIC S9(0004) COMP.
  3315     05  LOANHBF PIC  X(0001).
  3316     05  FILLER REDEFINES LOANHBF.
  3317         10  LOANHBA PIC  X(0001).
  3318     05  LOANHBI PIC  X(0012).
  3319*    -------------------------------
  3320     05  LOANNBL PIC S9(0004) COMP.
  3321     05  LOANNBF PIC  X(0001).
  3322     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  67
* EL156.cbl
  3323         10  LOANNBA PIC  X(0001).
  3324     05  LOANNBI PIC  X(0025).
  3325*    -------------------------------
  3326     05  CKNUMHDL PIC S9(0004) COMP.
  3327     05  CKNUMHDF PIC  X(0001).
  3328     05  FILLER REDEFINES CKNUMHDF.
  3329         10  CKNUMHDA PIC  X(0001).
  3330     05  CKNUMHDI PIC  X(0012).
  3331*    -------------------------------
  3332     05  CKNUMBL PIC S9(0004) COMP.
  3333     05  CKNUMBF PIC  X(0001).
  3334     05  FILLER REDEFINES CKNUMBF.
  3335         10  CKNUMBA PIC  X(0001).
  3336     05  CKNUMBI PIC  X(0007).
  3337*    -------------------------------
  3338     05  AGTHDGL PIC S9(0004) COMP.
  3339     05  AGTHDGF PIC  X(0001).
  3340     05  FILLER REDEFINES AGTHDGF.
  3341         10  AGTHDGA PIC  X(0001).
  3342     05  AGTHDGI PIC  X(0016).
  3343*    -------------------------------
  3344     05  NAMEBL PIC S9(0004) COMP.
  3345     05  NAMEBF PIC  X(0001).
  3346     05  FILLER REDEFINES NAMEBF.
  3347         10  NAMEBA PIC  X(0001).
  3348     05  NAMEBI PIC  X(0030).
  3349*    -------------------------------
  3350     05  NAMEB2L PIC S9(0004) COMP.
  3351     05  NAMEB2F PIC  X(0001).
  3352     05  FILLER REDEFINES NAMEB2F.
  3353         10  NAMEB2A PIC  X(0001).
  3354     05  NAMEB2I PIC  X(0030).
  3355*    -------------------------------
  3356     05  ADDR1BL PIC S9(0004) COMP.
  3357     05  ADDR1BF PIC  X(0001).
  3358     05  FILLER REDEFINES ADDR1BF.
  3359         10  ADDR1BA PIC  X(0001).
  3360     05  ADDR1BI PIC  X(0030).
  3361*    -------------------------------
  3362     05  ADDR1B2L PIC S9(0004) COMP.
  3363     05  ADDR1B2F PIC  X(0001).
  3364     05  FILLER REDEFINES ADDR1B2F.
  3365         10  ADDR1B2A PIC  X(0001).
  3366     05  ADDR1B2I PIC  X(0030).
  3367*    -------------------------------
  3368     05  ADDR2BL PIC S9(0004) COMP.
  3369     05  ADDR2BF PIC  X(0001).
  3370     05  FILLER REDEFINES ADDR2BF.
  3371         10  ADDR2BA PIC  X(0001).
  3372     05  ADDR2BI PIC  X(0030).
  3373*    -------------------------------
  3374     05  ADDR2B2L PIC S9(0004) COMP.
  3375     05  ADDR2B2F PIC  X(0001).
  3376     05  FILLER REDEFINES ADDR2B2F.
  3377         10  ADDR2B2A PIC  X(0001).
  3378     05  ADDR2B2I PIC  X(0030).
  3379*    -------------------------------
  3380     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  68
* EL156.cbl
  3381     05  CITYSTBF PIC  X(0001).
  3382     05  FILLER REDEFINES CITYSTBF.
  3383         10  CITYSTBA PIC  X(0001).
  3384     05  CITYSTBI PIC  X(0030).
  3385*    -------------------------------
  3386     05  CITYST2L PIC S9(0004) COMP.
  3387     05  CITYST2F PIC  X(0001).
  3388     05  FILLER REDEFINES CITYST2F.
  3389         10  CITYST2A PIC  X(0001).
  3390     05  CITYST2I PIC  X(0030).
  3391*    -------------------------------
  3392     05  ZIPBL PIC S9(0004) COMP.
  3393     05  ZIPBF PIC  X(0001).
  3394     05  FILLER REDEFINES ZIPBF.
  3395         10  ZIPBA PIC  X(0001).
  3396     05  ZIPBI PIC  X(0009).
  3397*    -------------------------------
  3398     05  ZIPB2L PIC S9(0004) COMP.
  3399     05  ZIPB2F PIC  X(0001).
  3400     05  FILLER REDEFINES ZIPB2F.
  3401         10  ZIPB2A PIC  X(0001).
  3402     05  ZIPB2I PIC  X(0009).
  3403*    -------------------------------
  3404     05  INTHDBL PIC S9(0004) COMP.
  3405     05  INTHDBF PIC  X(0001).
  3406     05  FILLER REDEFINES INTHDBF.
  3407         10  INTHDBA PIC  X(0001).
  3408     05  INTHDBI PIC  X(0012).
  3409*    -------------------------------
  3410     05  INTAMTBL PIC S9(0004) COMP.
  3411     05  INTAMTBF PIC  X(0001).
  3412     05  FILLER REDEFINES INTAMTBF.
  3413         10  INTAMTBA PIC  X(0001).
  3414     05  INTAMTBI PIC  X(0011).
  3415*    -------------------------------
  3416     05  PMTHDGBL PIC S9(0004) COMP.
  3417     05  PMTHDGBF PIC  X(0001).
  3418     05  FILLER REDEFINES PMTHDGBF.
  3419         10  PMTHDGBA PIC  X(0001).
  3420     05  PMTHDGBI PIC  X(0034).
  3421*    -------------------------------
  3422     05  CLMNOBL PIC S9(0004) COMP.
  3423     05  CLMNOBF PIC  X(0001).
  3424     05  FILLER REDEFINES CLMNOBF.
  3425         10  CLMNOBA PIC  X(0001).
  3426     05  CLMNOBI PIC  X(0007).
  3427*    -------------------------------
  3428     05  CARRBL PIC S9(0004) COMP.
  3429     05  CARRBF PIC  X(0001).
  3430     05  FILLER REDEFINES CARRBF.
  3431         10  CARRBA PIC  X(0001).
  3432     05  CARRBI PIC  X(0001).
  3433*    -------------------------------
  3434     05  CERTNOBL PIC S9(0004) COMP.
  3435     05  CERTNOBF PIC  X(0001).
  3436     05  FILLER REDEFINES CERTNOBF.
  3437         10  CERTNOBA PIC  X(0001).
  3438     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  69
* EL156.cbl
  3439*    -------------------------------
  3440     05  SUFXBL PIC S9(0004) COMP.
  3441     05  SUFXBF PIC  X(0001).
  3442     05  FILLER REDEFINES SUFXBF.
  3443         10  SUFXBA PIC  X(0001).
  3444     05  SUFXBI PIC  X(0001).
  3445*    -------------------------------
  3446     05  CLMTYPBL PIC S9(0004) COMP.
  3447     05  CLMTYPBF PIC  X(0001).
  3448     05  FILLER REDEFINES CLMTYPBF.
  3449         10  CLMTYPBA PIC  X(0001).
  3450     05  CLMTYPBI PIC  X(0006).
  3451*    -------------------------------
  3452     05  INCURBL PIC S9(0004) COMP.
  3453     05  INCURBF PIC  X(0001).
  3454     05  FILLER REDEFINES INCURBF.
  3455         10  INCURBA PIC  X(0001).
  3456     05  INCURBI PIC  X(0008).
  3457*    -------------------------------
  3458     05  PYFROMBL PIC S9(0004) COMP.
  3459     05  PYFROMBF PIC  X(0001).
  3460     05  FILLER REDEFINES PYFROMBF.
  3461         10  PYFROMBA PIC  X(0001).
  3462     05  PYFROMBI PIC  X(0008).
  3463*    -------------------------------
  3464     05  PYTHRUBL PIC S9(0004) COMP.
  3465     05  PYTHRUBF PIC  X(0001).
  3466     05  FILLER REDEFINES PYTHRUBF.
  3467         10  PYTHRUBA PIC  X(0001).
  3468     05  PYTHRUBI PIC  X(0008).
  3469*    -------------------------------
  3470     05  DAYSBL PIC S9(0004) COMP.
  3471     05  DAYSBF PIC  X(0001).
  3472     05  FILLER REDEFINES DAYSBF.
  3473         10  DAYSBA PIC  X(0001).
  3474     05  DAYSBI PIC  X(0005).
  3475*    -------------------------------
  3476     05  BYBL PIC S9(0004) COMP.
  3477     05  BYBF PIC  X(0001).
  3478     05  FILLER REDEFINES BYBF.
  3479         10  BYBA PIC  X(0001).
  3480     05  BYBI PIC  X(0004).
  3481*    -------------------------------
  3482     05  PROOFDBL PIC S9(0004) COMP.
  3483     05  PROOFDBF PIC  X(0001).
  3484     05  FILLER REDEFINES PROOFDBF.
  3485         10  PROOFDBA PIC  X(0001).
  3486     05  PROOFDBI PIC  X(0008).
  3487*    -------------------------------
  3488     05  ACCTBL PIC S9(0004) COMP.
  3489     05  ACCTBF PIC  X(0001).
  3490     05  FILLER REDEFINES ACCTBF.
  3491         10  ACCTBA PIC  X(0001).
  3492     05  ACCTBI PIC  X(0010).
  3493*    -------------------------------
  3494     05  STATEBL PIC S9(0004) COMP.
  3495     05  STATEBF PIC  X(0001).
  3496     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  70
* EL156.cbl
  3497         10  STATEBA PIC  X(0001).
  3498     05  STATEBI PIC  X(0002).
  3499*    -------------------------------
  3500     05  GROUPBL PIC S9(0004) COMP.
  3501     05  GROUPBF PIC  X(0001).
  3502     05  FILLER REDEFINES GROUPBF.
  3503         10  GROUPBA PIC  X(0001).
  3504     05  GROUPBI PIC  X(0006).
  3505*    -------------------------------
  3506     05  ACARRBL PIC S9(0004) COMP.
  3507     05  ACARRBF PIC  X(0001).
  3508     05  FILLER REDEFINES ACARRBF.
  3509         10  ACARRBA PIC  X(0001).
  3510     05  ACARRBI PIC  X(0001).
  3511*    -------------------------------
  3512     05  ACCTNMBL PIC S9(0004) COMP.
  3513     05  ACCTNMBF PIC  X(0001).
  3514     05  FILLER REDEFINES ACCTNMBF.
  3515         10  ACCTNMBA PIC  X(0001).
  3516     05  ACCTNMBI PIC  X(0030).
  3517*    -------------------------------
  3518     05  UNDISBL PIC S9(0004) COMP.
  3519     05  UNDISBF PIC  X(0001).
  3520     05  FILLER REDEFINES UNDISBF.
  3521         10  UNDISBA PIC  X(0001).
  3522     05  UNDISBI PIC  X(0010).
  3523*    -------------------------------
  3524     05  RATEBL PIC S9(0004) COMP.
  3525     05  RATEBF PIC  X(0001).
  3526     05  FILLER REDEFINES RATEBF.
  3527         10  RATEBA PIC  X(0001).
  3528     05  RATEBI PIC  X(0006).
  3529*    -------------------------------
  3530     05  ERMSG1BL PIC S9(0004) COMP.
  3531     05  ERMSG1BF PIC  X(0001).
  3532     05  FILLER REDEFINES ERMSG1BF.
  3533         10  ERMSG1BA PIC  X(0001).
  3534     05  ERMSG1BI PIC  X(0072).
  3535*    -------------------------------
  3536     05  ENTPFBL PIC S9(0004) COMP.
  3537     05  ENTPFBF PIC  X(0001).
  3538     05  FILLER REDEFINES ENTPFBF.
  3539         10  ENTPFBA PIC  X(0001).
  3540     05  ENTPFBI PIC  99.
  3541 01  EL156BO REDEFINES EL156AI.
  3542     05  FILLER            PIC  X(0012).
  3543*    -------------------------------
  3544     05  FILLER            PIC  X(0003).
  3545     05  RUNDTEBO PIC  X(0008).
  3546*    -------------------------------
  3547     05  FILLER            PIC  X(0003).
  3548     05  RUNTIMBO PIC  99.99.
  3549*    -------------------------------
  3550     05  FILLER            PIC  X(0003).
  3551     05  PAYDTBO PIC  99B99B99.
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  71
* EL156.cbl
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
  3557     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  LOANHBO PIC  X(0012).
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  LOANNBO PIC  X(0025).
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  CKNUMHDO PIC  X(0012).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  CKNUMBO PIC  X(0007).
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  AGTHDGO PIC  X(0016).
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  NAMEBO PIC  X(0030).
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  NAMEB2O PIC  X(0030).
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  ADDR1BO PIC  X(0030).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  ADDR1B2O PIC  X(0030).
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  ADDR2BO PIC  X(0030).
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  ADDR2B2O PIC  X(0030).
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  CITYSTBO PIC  X(0030).
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  CITYST2O PIC  X(0030).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  ZIPBO PIC  ZZZZ99999.
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  ZIPB2O PIC  ZZZZZZZZZ.
  3603*    -------------------------------
  3604     05  FILLER            PIC  X(0003).
  3605     05  INTHDBO PIC  X(0012).
  3606*    -------------------------------
  3607     05  FILLER            PIC  X(0003).
  3608     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  PMTHDGBO PIC  X(0034).
  3612*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  72
* EL156.cbl
  3613     05  FILLER            PIC  X(0003).
  3614     05  CLMNOBO PIC  X(0007).
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  CARRBO PIC  X(0001).
  3618*    -------------------------------
  3619     05  FILLER            PIC  X(0003).
  3620     05  CERTNOBO PIC  X(0010).
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  SUFXBO PIC  X(0001).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  CLMTYPBO PIC  X(0006).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  INCURBO PIC  X(0008).
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  PYFROMBO PIC  99B99B99.
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  PYTHRUBO PIC  99B99B99.
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  DAYSBO PIC  X(0005).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  BYBO PIC  X(0004).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  PROOFDBO PIC  99B99B99.
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  ACCTBO PIC  X(0010).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  STATEBO PIC  X(0002).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  GROUPBO PIC  X(0006).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  ACARRBO PIC  X(0001).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  ACCTNMBO PIC  X(0030).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  UNDISBO PIC  ZZZ,Z99.99.
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  RATEBO PIC  ZZZ.99.
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  ERMSG1BO PIC  X(0072).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  73
* EL156.cbl
  3671     05  ENTPFBO PIC  X(0002).
  3672*    -------------------------------
  3673****************************************************************
  3674*
  3675* Copyright (c) 2007 by Clerity Solutions, Inc.
  3676* All rights reserved.
  3677*
  3678****************************************************************
  3679 01  DFHEIV.
  3680   02  DFHEIV0               PIC X(35).
  3681   02  DFHEIV1               PIC X(08).
  3682   02  DFHEIV2               PIC X(08).
  3683   02  DFHEIV3               PIC X(08).
  3684   02  DFHEIV4               PIC X(06).
  3685   02  DFHEIV5               PIC X(04).
  3686   02  DFHEIV6               PIC X(04).
  3687   02  DFHEIV7               PIC X(02).
  3688   02  DFHEIV8               PIC X(02).
  3689   02  DFHEIV9               PIC X(01).
  3690   02  DFHEIV10              PIC S9(7) COMP-3.
  3691   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3692   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3693   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3694   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3695   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3696   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3697   02  DFHEIV17              PIC X(04).
  3698   02  DFHEIV18              PIC X(04).
  3699   02  DFHEIV19              PIC X(04).
  3700   02  DFHEIV20              USAGE IS POINTER.
  3701   02  DFHEIV21              USAGE IS POINTER.
  3702   02  DFHEIV22              USAGE IS POINTER.
  3703   02  DFHEIV23              USAGE IS POINTER.
  3704   02  DFHEIV24              USAGE IS POINTER.
  3705   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3706   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3707   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3708   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3709   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3710   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3711   02  FILLER                PIC X(02).
  3712   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3713   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3714   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3715   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3716   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3717 LINKAGE  SECTION.
  3718*****************************************************************
  3719*                                                               *
  3720* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3721* All rights reserved.                                          *
  3722*                                                               *
  3723*****************************************************************
  3724 01  dfheiblk.
  3725     02  eibtime          pic s9(7) comp-3.
  3726     02  eibdate          pic s9(7) comp-3.
  3727     02  eibtrnid         pic x(4).
  3728     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  74
* EL156.cbl
  3729     02  eibtrmid         pic x(4).
  3730     02  dfheigdi         pic s9(4) comp.
  3731     02  eibcposn         pic s9(4) comp.
  3732     02  eibcalen         pic s9(4) comp.
  3733     02  eibaid           pic x(1).
  3734     02  eibfiller1       pic x(1).
  3735     02  eibfn            pic x(2).
  3736     02  eibfiller2       pic x(2).
  3737     02  eibrcode         pic x(6).
  3738     02  eibfiller3       pic x(2).
  3739     02  eibds            pic x(8).
  3740     02  eibreqid         pic x(8).
  3741     02  eibrsrce         pic x(8).
  3742     02  eibsync          pic x(1).
  3743     02  eibfree          pic x(1).
  3744     02  eibrecv          pic x(1).
  3745     02  eibsend          pic x(1).
  3746     02  eibatt           pic x(1).
  3747     02  eibeoc           pic x(1).
  3748     02  eibfmh           pic x(1).
  3749     02  eibcompl         pic x(1).
  3750     02  eibsig           pic x(1).
  3751     02  eibconf          pic x(1).
  3752     02  eiberr           pic x(1).
  3753     02  eibrldbk         pic x(1).
  3754     02  eiberrcd         pic x(4).
  3755     02  eibsynrb         pic x(1).
  3756     02  eibnodat         pic x(1).
  3757     02  eibfiller5       pic x(2).
  3758     02  eibresp          pic 9(09) comp.
  3759     02  eibresp2         pic 9(09) comp.
  3760     02  dfheigdj         pic s9(4) comp.
  3761     02  dfheigdk         pic s9(4) comp.
  3762 01  DFHCOMMAREA             PIC X(1024).
  3763
  3764*    COPY ELCMSTR.
  3765******************************************************************
  3766*                                                                *
  3767*                            ELCMSTR.                            *
  3768*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3769*                            VMOD=2.012                          *
  3770*                                                                *
  3771*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3772*                                                                *
  3773*   FILE TYPE = VSAM,KSDS                                        *
  3774*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3775*                                                                *
  3776*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3777*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3778*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3779*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3780*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3781*                                                 RKP=75,LEN=21  *
  3782*                                                                *
  3783*   **** NOTE ****                                               *
  3784*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3785*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3786*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  75
* EL156.cbl
  3787*   LOG = YES                                                    *
  3788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3789******************************************************************
  3790*                   C H A N G E   L O G
  3791*
  3792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3793*-----------------------------------------------------------------
  3794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3795* EFFECTIVE    NUMBER
  3796*-----------------------------------------------------------------
  3797* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3798* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3799* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3800******************************************************************
  3801 01  CLAIM-MASTER.
  3802     12  CL-RECORD-ID                PIC XX.
  3803         88  VALID-CL-ID         VALUE 'CL'.
  3804
  3805     12  CL-CONTROL-PRIMARY.
  3806         16  CL-COMPANY-CD           PIC X.
  3807         16  CL-CARRIER              PIC X.
  3808         16  CL-CLAIM-NO             PIC X(7).
  3809         16  CL-CERT-NO.
  3810             20  CL-CERT-PRIME       PIC X(10).
  3811             20  CL-CERT-SFX         PIC X.
  3812
  3813     12  CL-CONTROL-BY-NAME.
  3814         16  CL-COMPANY-CD-A1        PIC X.
  3815         16  CL-INSURED-LAST-NAME    PIC X(15).
  3816         16  CL-INSURED-NAME.
  3817             20  CL-INSURED-1ST-NAME PIC X(12).
  3818             20  CL-INSURED-MID-INIT PIC X.
  3819
  3820     12  CL-CONTROL-BY-SSN.
  3821         16  CL-COMPANY-CD-A2        PIC X.
  3822         16  CL-SOC-SEC-NO.
  3823             20  CL-SSN-STATE        PIC XX.
  3824             20  CL-SSN-ACCOUNT      PIC X(6).
  3825             20  CL-SSN-LN3          PIC X(3).
  3826
  3827     12  CL-CONTROL-BY-CERT-NO.
  3828         16  CL-COMPANY-CD-A4        PIC X.
  3829         16  CL-CERT-NO-A4.
  3830             20  CL-CERT-A4-PRIME    PIC X(10).
  3831             20  CL-CERT-A4-SFX      PIC X.
  3832
  3833     12  CL-CONTROL-BY-CCN.
  3834         16  CL-COMPANY-CD-A5        PIC X.
  3835         16  CL-CCN-A5.
  3836             20  CL-CCN.
  3837                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3838                 24  CL-CCN-PRIME-A5 PIC X(12).
  3839             20  CL-CCN-FILLER-A5    PIC X(4).
  3840
  3841     12  CL-INSURED-PROFILE-DATA.
  3842         16  CL-INSURED-BIRTH-DT     PIC XX.
  3843         16  CL-INSURED-SEX-CD       PIC X.
  3844             88  INSURED-IS-MALE        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  76
* EL156.cbl
  3845             88  INSURED-IS-FEMALE      VALUE 'F'.
  3846             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3847         16  CL-INSURED-OCC-CD       PIC X(6).
  3848         16  FILLER                  PIC X(5).
  3849
  3850     12  CL-PROCESSING-INFO.
  3851         16  CL-PROCESSOR-ID         PIC X(4).
  3852         16  CL-CLAIM-STATUS         PIC X.
  3853             88  CLAIM-IS-OPEN          VALUE 'O'.
  3854             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3855         16  CL-CLAIM-TYPE           PIC X.
  3856*            88  AH-CLAIM               VALUE 'A'.
  3857*            88  LIFE-CLAIM             VALUE 'L'.
  3858*            88  PROPERTY-CLAIM         VALUE 'P'.
  3859*            88  IUI-CLAIM              VALUE 'I'.
  3860*            88  GAP-CLAIM              VALUE 'G'.
  3861         16  CL-CLAIM-PREM-TYPE      PIC X.
  3862             88  SINGLE-PREMIUM         VALUE '1'.
  3863             88  O-B-COVERAGE           VALUE '2'.
  3864             88  OPEN-END-COVERAGE      VALUE '3'.
  3865         16  CL-INCURRED-DT          PIC XX.
  3866         16  CL-REPORTED-DT          PIC XX.
  3867         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3868         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3869         16  CL-LAST-PMT-DT          PIC XX.
  3870         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3871         16  CL-PAID-THRU-DT         PIC XX.
  3872         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3873         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3874         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3875         16  CL-PMT-CALC-METHOD      PIC X.
  3876             88  CL-360-DAY-YR          VALUE '1'.
  3877             88  CL-365-DAY-YR          VALUE '2'.
  3878             88  CL-FULL-MONTHS         VALUE '3'.
  3879         16  CL-CAUSE-CD             PIC X(6).
  3880
  3881         16  CL-PRIME-CERT-NO.
  3882             20  CL-PRIME-CERT-PRIME PIC X(10).
  3883             20  CL-PRIME-CERT-SFX   PIC X.
  3884
  3885         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3886             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3887             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3888
  3889         16  CL-MICROFILM-NO         PIC X(10).
  3890         16  CL-PROG-FORM-TYPE       PIC X.
  3891         16  CL-LAST-ADD-ON-DT       PIC XX.
  3892
  3893         16  CL-LAST-REOPEN-DT       PIC XX.
  3894         16  CL-LAST-CLOSE-DT        PIC XX.
  3895         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3896             88  FINAL-PAID             VALUE '1'.
  3897             88  CLAIM-DENIED           VALUE '2'.
  3898             88  AUTO-CLOSE             VALUE '3'.
  3899             88  MANUAL-CLOSE           VALUE '4'.
  3900             88  BENEFITS-CHANGED       VALUE 'C'.
  3901             88  SETUP-ERRORS           VALUE 'E'.
  3902         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  77
* EL156.cbl
  3903         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3904         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3905             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3906         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3907         16  FILLER                  PIC X.
  3908
  3909     12  CL-CERTIFICATE-DATA.
  3910         16  CL-CERT-ORIGIN          PIC X.
  3911             88  CERT-WAS-ONLINE        VALUE '1'.
  3912             88  CERT-WAS-CREATED       VALUE '2'.
  3913             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3914         16  CL-CERT-KEY-DATA.
  3915             20  CL-CERT-CARRIER     PIC X.
  3916             20  CL-CERT-GROUPING    PIC X(6).
  3917             20  CL-CERT-STATE       PIC XX.
  3918             20  CL-CERT-ACCOUNT.
  3919                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3920                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3921             20  CL-CERT-EFF-DT      PIC XX.
  3922
  3923     12  CL-STATUS-CONTROLS.
  3924         16  CL-PRIORITY-CD          PIC X.
  3925             88  CONFIDENTIAL-DATA      VALUE '8'.
  3926             88  HIGHEST-PRIORITY       VALUE '9'.
  3927         16  CL-SUPV-ATTN-CD         PIC X.
  3928             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3929             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3930         16  CL-PURGED-DT            PIC XX.
  3931         16  CL-RESTORED-DT          PIC XX.
  3932         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3933         16  CL-NEXT-RESEND-DT       PIC XX.
  3934         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3935         16  CL-CRITICAL-PERIOD      PIC 99.
  3936*        16  FILLER                  PIC XX.
  3937         16  CL-LAST-MAINT-DT        PIC XX.
  3938         16  CL-LAST-MAINT-USER      PIC X(4).
  3939         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3940         16  CL-LAST-MAINT-TYPE      PIC X.
  3941             88  CLAIM-SET-UP           VALUE ' '.
  3942             88  PAYMENT-MADE           VALUE '1'.
  3943             88  LETTER-SENT            VALUE '2'.
  3944             88  MASTER-WAS-ALTERED     VALUE '3'.
  3945             88  MASTER-WAS-RESTORED    VALUE '4'.
  3946             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3947             88  FILE-CONVERTED         VALUE '6'.
  3948             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3949             88  ERROR-CORRECTION       VALUE 'E'.
  3950         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3951         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3952         16  CL-BENEFICIARY          PIC X(10).
  3953         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3954         16  CL-DENIAL-TYPE          PIC X.
  3955             88  CL-TYPE-DENIAL          VALUE '1'.
  3956             88  CL-TYPE-RESCISSION      VALUE '2'.
  3957             88  CL-TYPE-REFORMATION     VALUE '3'.
  3958             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3959             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3960         16  CL-CRIT-PER-RECURRENT   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  78
* EL156.cbl
  3961         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3962         16  CL-RTW-DT               PIC XX.
  3963
  3964     12  CL-TRAILER-CONTROLS.
  3965         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3966             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3967             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3968             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3969         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3970         16  FILLER                  PIC XX.
  3971         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3972         16  CL-ADDRESS-TRAILER-CNT.
  3973             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3974                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3975             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3976                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3977             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3978                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3979             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3980                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3981             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3982                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3983             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3984                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3985             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3986                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3987
  3988     12  CL-CV-REFERENCE-NO.
  3989         16  CL-CV-REFNO-PRIME       PIC X(18).
  3990         16  CL-CV-REFNO-SFX         PIC XX.
  3991
  3992     12  CL-FILE-LOCATION            PIC X(4).
  3993
  3994     12  CL-PROCESS-ERRORS.
  3995         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3996             88  NO-FATAL-ERRORS        VALUE ZERO.
  3997         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3998             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3999
  4000     12  CL-PRODUCT-CD               PIC X.
  4001
  4002     12  CL-CURRENT-KEY-DATA.
  4003         16  CL-CURRENT-CARRIER      PIC X.
  4004         16  CL-CURRENT-GROUPING     PIC X(6).
  4005         16  CL-CURRENT-STATE        PIC XX.
  4006         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4007
  4008     12  CL-ASSOCIATES               PIC X.
  4009         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4010         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4011         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4012         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4013
  4014     12  CL-ACTIVITY-CODE            PIC 99.
  4015     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4016     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4017
  4018     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  79
* EL156.cbl
  4019     12  CL-LAG-REPORT-CODE          PIC 9.
  4020     12  CL-LOAN-TYPE                PIC XX.
  4021     12  CL-LEGAL-STATE              PIC XX.
  4022
  4023     12  CL-YESNOSW                  PIC X.
  4024     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4025         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4026         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4027         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4028     12  cl-insured-claim            pic x.
  4029         88  cl-claim-on-primary         value 'P'.
  4030         88  cl-claim-on-secondary       value 'S'.
  4031     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  80
* EL156.cbl
  4033*    COPY ELCCNTL.
  4034******************************************************************
  4035*                                                                *
  4036*                                                                *
  4037*                            ELCCNTL.                            *
  4038*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4039*                            VMOD=2.059                          *
  4040*                                                                *
  4041*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4042*                                                                *
  4043*   FILE TYPE = VSAM,KSDS                                        *
  4044*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4045*                                                                *
  4046*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4047*       ALTERNATE INDEX = NONE                                   *
  4048*                                                                *
  4049*   LOG = YES                                                    *
  4050*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4051******************************************************************
  4052*                   C H A N G E   L O G
  4053*
  4054* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4055*-----------------------------------------------------------------
  4056*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4057* EFFECTIVE    NUMBER
  4058*-----------------------------------------------------------------
  4059* 082503                   PEMA  ADD BENEFIT GROUP
  4060* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4061* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4062* 092705    2005050300006  PEMA  ADD SPP LEASES
  4063* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4064* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4065* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4066* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4067* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4068* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4069* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4070* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4071* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4072******************************************************************
  4073*
  4074 01  CONTROL-FILE.
  4075     12  CF-RECORD-ID                       PIC XX.
  4076         88  VALID-CF-ID                        VALUE 'CF'.
  4077
  4078     12  CF-CONTROL-PRIMARY.
  4079         16  CF-COMPANY-ID                  PIC XXX.
  4080         16  CF-RECORD-TYPE                 PIC X.
  4081             88  CF-COMPANY-MASTER              VALUE '1'.
  4082             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4083             88  CF-STATE-MASTER                VALUE '3'.
  4084             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4085             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4086             88  CF-CARRIER-MASTER              VALUE '6'.
  4087             88  CF-MORTALITY-MASTER            VALUE '7'.
  4088             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4089             88  CF-TERMINAL-MASTER             VALUE '9'.
  4090             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  81
* EL156.cbl
  4091             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4092             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4093             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4094             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4095             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4096             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4097             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4098             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4099         16  CF-ACCESS-CD-GENL              PIC X(4).
  4100         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4101             20  CF-PROCESSOR               PIC X(4).
  4102         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4103             20  CF-STATE-CODE              PIC XX.
  4104             20  FILLER                     PIC XX.
  4105         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4106             20  FILLER                     PIC XX.
  4107             20  CF-HI-BEN-IN-REC           PIC XX.
  4108         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4109             20  FILLER                     PIC XXX.
  4110             20  CF-CARRIER-CNTL            PIC X.
  4111         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4112             20  FILLER                     PIC XX.
  4113             20  CF-HI-TYPE-IN-REC          PIC 99.
  4114         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4115             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4116                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4117             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4118             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4119         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4120             20  FILLER                     PIC X.
  4121             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4122         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4123             20  FILLER                     PIC XX.
  4124             20  CF-MORTGAGE-PLAN           PIC XX.
  4125         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4126
  4127     12  CF-LAST-MAINT-DT                   PIC XX.
  4128     12  CF-LAST-MAINT-BY                   PIC X(4).
  4129     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4130
  4131     12  CF-RECORD-BODY                     PIC X(728).
  4132
  4133
  4134****************************************************************
  4135*             COMPANY MASTER RECORD                            *
  4136****************************************************************
  4137
  4138     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4139         16  CF-COMPANY-ADDRESS.
  4140             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4141             20  CF-CL-IN-CARE-OF           PIC X(30).
  4142             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4143             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4144             20  CF-CL-CITY-STATE           PIC X(30).
  4145             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4146             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4147         16  CF-COMPANY-CD                  PIC X.
  4148         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  82
* EL156.cbl
  4149         16  CF-SECURITY-OPTION             PIC X.
  4150             88  ALL-SECURITY                   VALUE '1'.
  4151             88  COMPANY-VERIFY                 VALUE '2'.
  4152             88  PROCESSOR-VERIFY               VALUE '3'.
  4153             88  NO-SECURITY                    VALUE '4'.
  4154             88  ALL-BUT-TERM                   VALUE '5'.
  4155         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4156             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4157         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4158             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4159         16  CF-INFORCE-LOCATION            PIC X.
  4160             88  CERTS-ARE-ONLINE               VALUE '1'.
  4161             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4162             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4163         16  CF-LOWER-CASE-LETTERS          PIC X.
  4164         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4165             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4166             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4167             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4168             88  CF-ACCNT-CNTL                  VALUE '3'.
  4169             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4170
  4171         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4172         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4173
  4174         16  CF-LGX-CREDIT-USER             PIC X.
  4175             88  CO-IS-NOT-USER                 VALUE 'N'.
  4176             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4177
  4178         16 CF-CREDIT-CALC-CODES.
  4179             20  CF-CR-REM-TERM-CALC PIC X.
  4180               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4181               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4182               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4183               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4184               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4185               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4186               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4187             20  CF-CR-R78-METHOD           PIC X.
  4188               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4189               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4190
  4191         16  CF-CLAIM-CONTROL-COUNTS.
  4192             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4193                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4194
  4195             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4196                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4197
  4198             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4199                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4200
  4201             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4202                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4203
  4204         16  CF-CURRENT-MONTH-END           PIC XX.
  4205
  4206         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  83
* EL156.cbl
  4207             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4208             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4209             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4210             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4211                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4212                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4213             20  CF-CO-PREM-REJECT-SW       PIC X.
  4214                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4215                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4216             20  CF-CO-REF-REJECT-SW        PIC X.
  4217                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4218                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4219
  4220         16  CF-CO-REPORTING-DT             PIC XX.
  4221         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4222         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4223           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4224           88  CF-CO-MONTH-END                  VALUE '1'.
  4225
  4226         16  CF-LGX-CLAIM-USER              PIC X.
  4227             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4228             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4229
  4230         16  CF-CREDIT-EDIT-CONTROLS.
  4231             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4232             20  CF-MIN-AGE                 PIC 99.
  4233             20  CF-DEFAULT-AGE             PIC 99.
  4234             20  CF-MIN-TERM                PIC S999      COMP-3.
  4235             20  CF-MAX-TERM                PIC S999      COMP-3.
  4236             20  CF-DEFAULT-SEX             PIC X.
  4237             20  CF-JOINT-AGE-INPUT         PIC X.
  4238                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4239             20  CF-BIRTH-DATE-INPUT        PIC X.
  4240                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4241             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4242                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4243                 88  CF-ZERO-CARRIER            VALUE '1'.
  4244                 88  CF-ZERO-GROUPING           VALUE '2'.
  4245                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4246             20  CF-EDIT-SW                 PIC X.
  4247                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4248             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4249             20  CF-CR-PR-METHOD            PIC X.
  4250               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4251               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4252             20  FILLER                     PIC X.
  4253
  4254         16  CF-CREDIT-MISC-CONTROLS.
  4255             20  CF-REIN-TABLE-SW           PIC X.
  4256                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4257             20  CF-COMP-TABLE-SW           PIC X.
  4258                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4259             20  CF-EXPERIENCE-RETENTION-AGE
  4260                                            PIC S9        COMP-3.
  4261             20  CF-CONVERSION-DT           PIC XX.
  4262             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4263             20  CF-RUN-FREQUENCY-SW        PIC X.
  4264                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  84
* EL156.cbl
  4265                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4266
  4267             20  CF-CR-CHECK-NO-CONTROL.
  4268                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4269                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4270                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4271                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4272                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4273                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4274
  4275                 24  CF-CR-CHECK-COUNT       REDEFINES
  4276                     CF-CR-CHECK-COUNTER      PIC X(4).
  4277
  4278                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4279                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4280
  4281                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4282                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4283                 24  CF-MAIL-PROCESSING       PIC X.
  4284                     88  MAIL-PROCESSING          VALUE 'Y'.
  4285
  4286         16  CF-MISC-SYSTEM-CONTROL.
  4287             20  CF-SYSTEM-C                 PIC X.
  4288                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4289             20  CF-SYSTEM-D                 PIC X.
  4290                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4291             20  CF-SOC-SEC-NO-SW            PIC X.
  4292                 88  SOC-SEC-NO-USED             VALUE '1'.
  4293             20  CF-MEMBER-NO-SW             PIC X.
  4294                 88  MEMBER-NO-USED              VALUE '1'.
  4295             20  CF-TAX-ID-NUMBER            PIC X(11).
  4296             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4297             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4298                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4299                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4300                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4301                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4302             20  CF-SYSTEM-E                 PIC X.
  4303                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4304
  4305         16  CF-LGX-LIFE-USER               PIC X.
  4306             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4307             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4308
  4309         16  CF-CR-MONTH-END-DT             PIC XX.
  4310
  4311         16  CF-FILE-MAINT-DATES.
  4312             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4313                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4314             20  CF-LAST-BATCH       REDEFINES
  4315                 CF-LAST-BATCH-NO               PIC X(4).
  4316             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4317             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4318             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4319             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4320             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4321             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4322             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  85
* EL156.cbl
  4323             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4324             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4325             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4326
  4327         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4328         16  FILLER                         PIC X.
  4329
  4330         16  CF-ALT-MORT-CODE               PIC X(4).
  4331         16  CF-MEMBER-CAPTION              PIC X(10).
  4332
  4333         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4334             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4335             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4336             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4337             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4338             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4339
  4340         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4341
  4342         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4343         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4344         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4345         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4346
  4347         16  CF-AH-OVERRIDE-L1              PIC X.
  4348         16  CF-AH-OVERRIDE-L2              PIC XX.
  4349         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4350         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4351
  4352         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4353         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4354
  4355         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4356         16  CF-AR-LAST-EL860-DT            PIC XX.
  4357         16  CF-MP-MONTH-END-DT             PIC XX.
  4358
  4359         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4360         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4361             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4362
  4363         16  CF-AR-MONTH-END-DT             PIC XX.
  4364
  4365         16  CF-CRDTCRD-USER                PIC X.
  4366             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4367             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4368
  4369         16  CF-CC-MONTH-END-DT             PIC XX.
  4370
  4371         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4372
  4373         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4374             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4375             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4376             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4377         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4378         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4379         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4380         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  86
* EL156.cbl
  4381             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4382             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4383         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4384         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4385         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4386             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4387         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4388
  4389         16  CF-CL-ZIP-CODE.
  4390             20  CF-CL-ZIP-PRIME.
  4391                 24  CF-CL-ZIP-1ST          PIC X.
  4392                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4393                 24  FILLER                 PIC X(4).
  4394             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4395         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4396             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4397             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4398             20  FILLER                     PIC XXX.
  4399
  4400         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4401         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4402         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4403         16  CF-CO-OPTION-START-DATE        PIC XX.
  4404         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4405           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4406                                                      '3' '4'.
  4407           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4408           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4409           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4410           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4411           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4412           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4413
  4414         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4415
  4416         16  CF-PAYMENT-APPROVAL-LEVELS.
  4417             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4418             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4419             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4420             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4421             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4422             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4423
  4424         16  CF-END-USER-REPORTING-USER     PIC X.
  4425             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4426             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4427
  4428         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4429             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4430             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4431
  4432         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4433
  4434         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4435         16  FILLER                         PIC X.
  4436
  4437         16  CF-CREDIT-ARCHIVE-CNTL.
  4438             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  87
* EL156.cbl
  4439             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4440             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4441
  4442         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4443
  4444         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4445             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4446             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4447
  4448         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4449             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4450             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4451
  4452         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4453
  4454         16  CF-CO-ACH-ID-CODE              PIC  X.
  4455             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4456             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4457             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4458         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4459         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4460         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4461         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4462         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4463         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4464         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4465         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4466         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4467                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4468         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4469                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4470
  4471         16  CF-CO-OVER-SHORT.
  4472             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4473             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4474
  4475*         16  FILLER                         PIC X(102).
  4476         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4477             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4478             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4479
  4480         16  CF-AH-APPROVAL-DAYS.
  4481             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4482             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4483             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4484             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4485
  4486         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4487
  4488         16  CF-APPROV-LEV-5.
  4489             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4490             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4491             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4492
  4493         16  FILLER                         PIC X(68).
  4494****************************************************************
  4495*             PROCESSOR/USER RECORD                            *
  4496****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  88
* EL156.cbl
  4497
  4498     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4499         16  CF-PROCESSOR-NAME              PIC X(30).
  4500         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4501         16  CF-PROCESSOR-TITLE             PIC X(26).
  4502         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4503                 88  MESSAGE-YES                VALUE 'Y'.
  4504                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4505
  4506*****************************************************
  4507****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4508****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4509****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4510****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4511*****************************************************
  4512
  4513         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4514             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4515             20  CF-APPLICATION-FORCE       PIC X.
  4516             20  CF-INDIVIDUAL-APP.
  4517                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4518                     28  CF-BROWSE-APP      PIC X.
  4519                     28  CF-UPDATE-APP      PIC X.
  4520
  4521         16  CF-CURRENT-TERM-ON             PIC X(4).
  4522         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4523             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4524             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4525             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4526             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4527             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4528             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4529             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4530         16  CF-PROCESSOR-CARRIER           PIC X.
  4531             88  NO-CARRIER-SECURITY            VALUE ' '.
  4532         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4533             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4534         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4535             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4536         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4537             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4538
  4539         16  CF-PROC-SYS-ACCESS-SW.
  4540             20  CF-PROC-CREDIT-CLAIMS-SW.
  4541                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4542                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4543                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4544                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4545             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4546                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4547                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4548             20  CF-PROC-LIFE-GNRLDGR-SW.
  4549                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4550                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4551                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4552                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4553             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4554                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  89
* EL156.cbl
  4555                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4556         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4557             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4558             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4559         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4560
  4561         16  CF-APPROVAL-LEVEL                  PIC X.
  4562             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4563             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4564             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4565             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4566             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4567
  4568         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4569
  4570         16  CF-LANGUAGE-TYPE                   PIC X.
  4571             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4572             88  CF-LANG-IS-FR                      VALUE 'F'.
  4573
  4574         16  CF-CSR-IND                         PIC X.
  4575         16  FILLER                             PIC X(239).
  4576
  4577****************************************************************
  4578*             PROCESSOR/REMINDERS RECORD                       *
  4579****************************************************************
  4580
  4581     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4582         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4583             20  CF-START-REMIND-DT         PIC XX.
  4584             20  CF-END-REMIND-DT           PIC XX.
  4585             20  CF-REMINDER-TEXT           PIC X(50).
  4586         16  FILLER                         PIC X(296).
  4587
  4588
  4589****************************************************************
  4590*             STATE MASTER RECORD                              *
  4591****************************************************************
  4592
  4593     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4594         16  CF-STATE-ABBREVIATION          PIC XX.
  4595         16  CF-STATE-NAME                  PIC X(25).
  4596         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4597         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4598             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4599             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4600             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4601             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4602                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4603                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4604             20  CF-ST-PREM-REJECT-SW       PIC X.
  4605                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4606                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4607             20  CF-ST-REF-REJECT-SW        PIC X.
  4608                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4609                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4610         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4611         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4612         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  90
* EL156.cbl
  4613             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4614             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4615             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4616         16  CF-ST-FST-PMT-EXTENSION.
  4617             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4618             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4619                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4620                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4621                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4622                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4623         16  CF-ST-STATE-CALL.
  4624             20  CF-ST-CALL-UNEARNED        PIC X.
  4625             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4626             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4627         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4628             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4629             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4630         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4631         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4632         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4633         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4634         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4635         16  FILLER                         PIC X.
  4636         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4637             20  CF-ST-BENEFIT-CD           PIC XX.
  4638             20  CF-ST-BENEFIT-KIND         PIC X.
  4639                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4640                 88  CF-ST-AH-KIND              VALUE 'A'.
  4641             20  CF-ST-REM-TERM-CALC        PIC X.
  4642                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4643                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4644                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4645                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4646                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4647                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4648                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4649                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4650
  4651             20  CF-ST-REFUND-CALC          PIC X.
  4652                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4653                 88  ST-REFD-BY-R78             VALUE '1'.
  4654                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4655                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4656                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4657                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4658                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4659                 88  ST-REFD-UTAH               VALUE '7'.
  4660                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4661                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4662                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4663
  4664             20  CF-ST-EARNING-CALC         PIC X.
  4665                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4666                 88  ST-EARN-BY-R78             VALUE '1'.
  4667                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4668                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4669                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4670                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  91
* EL156.cbl
  4671                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4672                 88  ST-EARN-MEAN               VALUE '8'.
  4673                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4674
  4675             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4676                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4677                 88  ST-OVRD-BY-R78             VALUE '1'.
  4678                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4679                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4680                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4681                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4682                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4683                 88  ST-OVRD-MEAN               VALUE '8'.
  4684                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4685             20  FILLER                     PIC X.
  4686
  4687         16  CF-ST-COMMISSION-CAPS.
  4688             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4689             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4690             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4691             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4692         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4693                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4694
  4695         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4696
  4697         16  CF-ST-STATUTORY-INTEREST.
  4698             20  CF-ST-STAT-DATE-FROM       PIC X.
  4699                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4700                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4701             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4702             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4703             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4704             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4705             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4706
  4707         16  CF-ST-OVER-SHORT.
  4708             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4709             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4710
  4711         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4712
  4713         16  CF-ST-RT-CALC                  PIC X.
  4714
  4715         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4716         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4717         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4718         16  CF-ST-RF-LR-CALC               PIC X.
  4719         16  CF-ST-RF-LL-CALC               PIC X.
  4720         16  CF-ST-RF-LN-CALC               PIC X.
  4721         16  CF-ST-RF-AH-CALC               PIC X.
  4722         16  CF-ST-RF-CP-CALC               PIC X.
  4723*        16  FILLER                         PIC X(206).
  4724*CIDMOD         16  FILLER                         PIC X(192).
  4725         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4726             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4727         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4728         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  92
* EL156.cbl
  4729         16  CF-ST-CAUSAL-STATE             PIC X.
  4730         16  FILLER                         PIC X(185).
  4731
  4732****************************************************************
  4733*             BENEFIT MASTER RECORD                            *
  4734****************************************************************
  4735
  4736     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4737         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4738             20  CF-BENEFIT-CODE            PIC XX.
  4739             20  CF-BENEFIT-NUMERIC  REDEFINES
  4740                 CF-BENEFIT-CODE            PIC XX.
  4741             20  CF-BENEFIT-ALPHA           PIC XXX.
  4742             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4743             20  CF-BENEFIT-COMMENT         PIC X(10).
  4744
  4745             20  CF-LF-COVERAGE-TYPE        PIC X.
  4746                 88  CF-REDUCING                VALUE 'R'.
  4747                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4748
  4749             20  CF-SPECIAL-CALC-CD         PIC X.
  4750                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4751                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4752                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4753                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4754                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4755                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4756                 88  CF-FARM-PLAN               VALUE 'F'.
  4757                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4758                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4759                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4760                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4761                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4762                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4763                 88  CF-PRUDENTIAL              VALUE 'P'.
  4764                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4765                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4766                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4767                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4768                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4769                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4770
  4771             20  CF-JOINT-INDICATOR         PIC X.
  4772                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4773
  4774*            20  FILLER                     PIC X(12).
  4775             20  FILLER                     PIC X(11).
  4776             20  CF-BENEFIT-CATEGORY        PIC X.
  4777             20  CF-LOAN-TYPE               PIC X(8).
  4778
  4779             20  CF-CO-REM-TERM-CALC        PIC X.
  4780                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4781                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4782                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4783                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4784                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4785
  4786             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  93
* EL156.cbl
  4787                 88  CO-EARN-BY-R78             VALUE '1'.
  4788                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4789                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4790                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4791                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4792                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4793                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4794                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4795
  4796             20  CF-CO-REFUND-CALC          PIC X.
  4797                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4798                 88  CO-REFD-BY-R78             VALUE '1'.
  4799                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4800                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4801                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4802                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4803                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4804                 88  CO-REFD-MEAN               VALUE '8'.
  4805                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4806                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4807                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4808
  4809             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4810                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4811                 88  CO-OVRD-BY-R78             VALUE '1'.
  4812                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4813                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4814                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4815                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4816                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4817                 88  CO-OVRD-MEAN               VALUE '8'.
  4818                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4819
  4820             20  CF-CO-BEN-I-G-CD           PIC X.
  4821                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4822                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4823                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4824
  4825         16  FILLER                         PIC X(304).
  4826
  4827
  4828****************************************************************
  4829*             CARRIER MASTER RECORD                            *
  4830****************************************************************
  4831
  4832     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4833         16  CF-ADDRESS-DATA.
  4834             20  CF-MAIL-TO-NAME            PIC X(30).
  4835             20  CF-IN-CARE-OF              PIC X(30).
  4836             20  CF-ADDRESS-LINE-1          PIC X(30).
  4837             20  CF-ADDRESS-LINE-2          PIC X(30).
  4838             20  CF-CITY-STATE              PIC X(30).
  4839             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4840             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4841
  4842         16  CF-CLAIM-NO-CONTROL.
  4843             20  CF-CLAIM-NO-METHOD         PIC X.
  4844                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  94
* EL156.cbl
  4845                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4846                 88  CLAIM-NO-SEQ               VALUE '3'.
  4847                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4848             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4849                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4850                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4851                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4852
  4853         16  CF-CHECK-NO-CONTROL.
  4854             20  CF-CHECK-NO-METHOD         PIC X.
  4855                 88  CHECK-NO-MANUAL            VALUE '1'.
  4856                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4857                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4858                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4859             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4860                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4861
  4862         16  CF-DOMICILE-STATE              PIC XX.
  4863
  4864         16  CF-EXPENSE-CONTROLS.
  4865             20  CF-EXPENSE-METHOD          PIC X.
  4866                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4867                 88  DOLLARS-PER-PMT            VALUE '2'.
  4868                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4869                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4870             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4871             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4872
  4873         16  CF-CORRESPONDENCE-CONTROL.
  4874             20  CF-LETTER-RESEND-OPT       PIC X.
  4875                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4876                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4877             20  FILLER                     PIC X(4).
  4878
  4879         16  CF-RESERVE-CONTROLS.
  4880             20  CF-MANUAL-SW               PIC X.
  4881                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4882             20  CF-FUTURE-SW               PIC X.
  4883                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4884             20  CF-PTC-SW                  PIC X.
  4885                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4886             20  CF-IBNR-SW                 PIC X.
  4887                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4888             20  CF-PTC-LF-SW               PIC X.
  4889                 88  CF-LF-PTC-USED             VALUE '1'.
  4890             20  CF-CDT-ACCESS-METHOD       PIC X.
  4891                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4892                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4893                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4894             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4895
  4896         16  CF-CLAIM-CALC-METHOD           PIC X.
  4897             88  360-PLUS-MONTHS                VALUE '1'.
  4898             88  365-PLUS-MONTHS                VALUE '2'.
  4899             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4900             88  360-DAILY                      VALUE '4'.
  4901             88  365-DAILY                      VALUE '5'.
  4902
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  95
* EL156.cbl
  4903         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4904         16  FILLER                         PIC X(11).
  4905
  4906         16  CF-LIMIT-AMOUNTS.
  4907             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4908             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4909             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4910             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4911             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4912             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4913             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4914             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4915             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4916             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4917
  4918         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4919         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4920         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4921
  4922         16  CF-ZIP-CODE.
  4923             20  CF-ZIP-PRIME.
  4924                 24  CF-ZIP-1ST             PIC X.
  4925                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4926                 24  FILLER                 PIC X(4).
  4927             20  CF-ZIP-PLUS4               PIC X(4).
  4928         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4929             20  CF-CAN-POSTAL-1            PIC XXX.
  4930             20  CF-CAN-POSTAL-2            PIC XXX.
  4931             20  FILLER                     PIC XXX.
  4932
  4933         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4934         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4935         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4936
  4937         16  CF-RATING-SWITCH               PIC X.
  4938             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4939             88  CF-NO-RATING                   VALUE 'N'.
  4940
  4941         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4942
  4943         16  CF-CARRIER-OVER-SHORT.
  4944             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4945             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4946
  4947         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4948         16  CF-SECPAY-SWITCH               PIC X.
  4949             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4950             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4951         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4952         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4953         16  FILLER                         PIC X(444).
  4954*        16  FILLER                         PIC X(452).
  4955
  4956
  4957****************************************************************
  4958*             MORTALITY MASTER RECORD                          *
  4959****************************************************************
  4960
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  96
* EL156.cbl
  4961     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4962         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4963                                INDEXED BY CF-MORT-NDX.
  4964             20  CF-MORT-TABLE              PIC X(5).
  4965             20  CF-MORT-TABLE-TYPE         PIC X.
  4966                 88  CF-MORT-JOINT              VALUE 'J'.
  4967                 88  CF-MORT-SINGLE             VALUE 'S'.
  4968                 88  CF-MORT-COMBINED           VALUE 'C'.
  4969                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4970                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4971             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4972             20  CF-MORT-AGE-METHOD         PIC XX.
  4973                 88  CF-AGE-LAST                VALUE 'AL'.
  4974                 88  CF-AGE-NEAR                VALUE 'AN'.
  4975             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4976             20  CF-MORT-ADJUSTMENT-DIRECTION
  4977                                            PIC X.
  4978                 88  CF-MINUS                   VALUE '-'.
  4979                 88  CF-PLUS                    VALUE '+'.
  4980             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4981             20  CF-MORT-JOINT-CODE         PIC X.
  4982                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4983             20  CF-MORT-PC-Q               PIC X.
  4984                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4985             20  CF-MORT-TABLE-CODE         PIC X(4).
  4986             20  CF-MORT-COMMENTS           PIC X(15).
  4987             20  FILLER                     PIC X(14).
  4988
  4989         16  FILLER                         PIC X(251).
  4990
  4991
  4992****************************************************************
  4993*             BUSSINESS TYPE MASTER RECORD                     *
  4994****************************************************************
  4995
  4996     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4997* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4998* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4999* AND RECORD 05 IS TYPES 81-99
  5000         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5001             20  CF-BUSINESS-TITLE          PIC  X(19).
  5002             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5003                                            PIC S9V9(4) COMP-3.
  5004             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5005             20  FILLER                     PIC  X.
  5006         16  FILLER                         PIC  X(248).
  5007
  5008
  5009****************************************************************
  5010*             TERMINAL MASTER RECORD                           *
  5011****************************************************************
  5012
  5013     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5014
  5015         16  CF-COMPANY-TERMINALS.
  5016             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5017                                  PIC X(4).
  5018         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  97
* EL156.cbl
  5019
  5020
  5021****************************************************************
  5022*             LIFE EDIT MASTER RECORD                          *
  5023****************************************************************
  5024
  5025     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5026         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5027             20  CF-LIFE-CODE-IN            PIC XX.
  5028             20  CF-LIFE-CODE-OUT           PIC XX.
  5029         16  FILLER                         PIC X(248).
  5030
  5031
  5032****************************************************************
  5033*             AH EDIT MASTER RECORD                            *
  5034****************************************************************
  5035
  5036     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5037         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5038             20  CF-AH-CODE-IN              PIC XXX.
  5039             20  CF-AH-CODE-OUT             PIC XX.
  5040         16  FILLER                         PIC X(248).
  5041
  5042
  5043****************************************************************
  5044*             CREDIBILITY TABLES                               *
  5045****************************************************************
  5046
  5047     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5048         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5049                             INDEXED BY CF-CRDB-NDX.
  5050             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5051             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5052             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5053         16  FILLER                         PIC  X(332).
  5054
  5055
  5056****************************************************************
  5057*             REPORT CUSTOMIZATION RECORD                      *
  5058****************************************************************
  5059
  5060     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5061         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5062             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5063             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5064             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5065**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5066****       A T-TRANSFER.                                   ****
  5067             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5068
  5069         16  FILLER                         PIC XX.
  5070
  5071         16  CF-CARRIER-CNTL-OPT.
  5072             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5073                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5074                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5075             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5076                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  98
* EL156.cbl
  5077         16  CF-GROUP-CNTL-OPT.
  5078             20  CF-GROUP-OPT-SEQ           PIC 9.
  5079                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5080                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5081             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5082                                            PIC X(6).
  5083         16  CF-STATE-CNTL-OPT.
  5084             20  CF-STATE-OPT-SEQ           PIC 9.
  5085                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5086                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5087             20  CF-STATE-SELECT OCCURS 3 TIMES
  5088                                            PIC XX.
  5089         16  CF-ACCOUNT-CNTL-OPT.
  5090             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5091                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5092                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5093             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5094                                            PIC X(10).
  5095         16  CF-BUS-TYP-CNTL-OPT.
  5096             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5097                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5098                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5099             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5100                                            PIC XX.
  5101         16  CF-LF-TYP-CNTL-OPT.
  5102             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5103                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5104                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5105             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5106                                            PIC XX.
  5107         16  CF-AH-TYP-CNTL-OPT.
  5108             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5109                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5110                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5111             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5112                                            PIC XX.
  5113         16  CF-REPTCD1-CNTL-OPT.
  5114             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5115                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5116                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5117             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5118                                            PIC X(10).
  5119         16  CF-REPTCD2-CNTL-OPT.
  5120             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5121                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5122                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5123             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5124                                            PIC X(10).
  5125         16  CF-USER1-CNTL-OPT.
  5126             20  CF-USER1-OPT-SEQ           PIC 9.
  5127                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5128                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5129             20  CF-USER1-SELECT OCCURS 3 TIMES
  5130                                            PIC X(10).
  5131         16  CF-USER2-CNTL-OPT.
  5132             20  CF-USER2-OPT-SEQ           PIC 9.
  5133                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5134                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  99
* EL156.cbl
  5135             20  CF-USER2-SELECT OCCURS 3 TIMES
  5136                                            PIC X(10).
  5137         16  CF-USER3-CNTL-OPT.
  5138             20  CF-USER3-OPT-SEQ           PIC 9.
  5139                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5140                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5141             20  CF-USER3-SELECT OCCURS 3 TIMES
  5142                                            PIC X(10).
  5143         16  CF-USER4-CNTL-OPT.
  5144             20  CF-USER4-OPT-SEQ           PIC 9.
  5145                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5146                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5147             20  CF-USER4-SELECT OCCURS 3 TIMES
  5148                                            PIC X(10).
  5149         16  CF-USER5-CNTL-OPT.
  5150             20  CF-USER5-OPT-SEQ           PIC 9.
  5151                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5152                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5153             20  CF-USER5-SELECT OCCURS 3 TIMES
  5154                                            PIC X(10).
  5155         16  CF-REINS-CNTL-OPT.
  5156             20  CF-REINS-OPT-SEQ           PIC 9.
  5157                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5158                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5159             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5160                 24  CF-REINS-PRIME         PIC XXX.
  5161                 24  CF-REINS-SUB           PIC XXX.
  5162
  5163         16  CF-AGENT-CNTL-OPT.
  5164             20  CF-AGENT-OPT-SEQ           PIC 9.
  5165                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5166                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5167             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5168                                            PIC X(10).
  5169
  5170         16  FILLER                         PIC X(43).
  5171
  5172         16  CF-LOSS-RATIO-SELECT.
  5173             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5174             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5175         16  CF-ENTRY-DATE-SELECT.
  5176             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5177             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5178         16  CF-EFFECTIVE-DATE-SELECT.
  5179             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5180             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5181
  5182         16  CF-EXCEPTION-LIST-IND          PIC X.
  5183             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5184
  5185         16  FILLER                         PIC X(318).
  5186
  5187****************************************************************
  5188*                  EXCEPTION REPORTING RECORD                  *
  5189****************************************************************
  5190
  5191     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5192         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 100
* EL156.cbl
  5193             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5194
  5195         16  CF-COMBINED-LIFE-AH-OPT.
  5196             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5197             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5198             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5199             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5200
  5201         16  CF-LIFE-OPT.
  5202             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5203             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5204             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5205             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5206             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5207             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5208             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5209             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5210             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5211             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5212
  5213         16  CF-AH-OPT.
  5214             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5215             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5216             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5217             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5218             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5219             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5220             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5221             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5222             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5223             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5224
  5225         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5226             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5227             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5228             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5229
  5230         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5231
  5232         16  FILLER                         PIC X(673).
  5233
  5234
  5235****************************************************************
  5236*             MORTGAGE SYSTEM PLAN RECORD                      *
  5237****************************************************************
  5238
  5239     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5240         16  CF-PLAN-TYPE                   PIC X.
  5241             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5242             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5243             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5244         16  CF-PLAN-ABBREV                 PIC XXX.
  5245         16  CF-PLAN-DESCRIPT               PIC X(10).
  5246         16  CF-PLAN-NOTES                  PIC X(20).
  5247         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5248         16  CF-PLAN-UNDERWRITING.
  5249             20  CF-PLAN-TERM-DATA.
  5250                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 101
* EL156.cbl
  5251                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5252             20  CF-PLAN-AGE-DATA.
  5253                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5254                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5255                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5256             20  CF-PLAN-BENEFIT-DATA.
  5257                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5258                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5259                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5260                                            PIC S9(7)V99  COMP-3.
  5261         16  CF-PLAN-POLICY-FORMS.
  5262             20  CF-POLICY-FORM             PIC X(12).
  5263             20  CF-MASTER-APPLICATION      PIC X(12).
  5264             20  CF-MASTER-POLICY           PIC X(12).
  5265         16  CF-PLAN-RATING.
  5266             20  CF-RATE-CODE               PIC X(5).
  5267             20  CF-SEX-RATING              PIC X.
  5268                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5269                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5270             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5271             20  CF-SUB-STD-TYPE            PIC X.
  5272                 88  CF-PCT-OF-PREM            VALUE '1'.
  5273                 88  CF-PCT-OF-BENE            VALUE '2'.
  5274         16  CF-PLAN-PREM-TOLERANCES.
  5275             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5276             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5277         16  CF-PLAN-PYMT-TOLERANCES.
  5278             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5279             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5280         16  CF-PLAN-MISC-DATA.
  5281             20  FILLER                     PIC X.
  5282             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5283             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5284         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5285         16  CF-PLAN-IND-GRP                PIC X.
  5286             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5287                                                     '1'.
  5288             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5289                                                     '2'.
  5290         16  CF-MIB-SEARCH-SW               PIC X.
  5291             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5292             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5293             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5294             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5295         16  CF-ALPHA-SEARCH-SW             PIC X.
  5296             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5297             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5298             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5299             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5300             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5301             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5302             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5303             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5304             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5305             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5306                                                     'A' 'B' 'C'
  5307                                                     'X' 'Y' 'Z'.
  5308         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 102
* EL156.cbl
  5309             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5310             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5311             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5312             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5313             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5314         16  FILLER                         PIC X(4).
  5315         16  CF-HEALTH-QUESTIONS            PIC X.
  5316             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5317         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5318         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5319         16  CF-PLAN-SNGL-JNT               PIC X.
  5320             88  CF-COMBINED-PLAN              VALUE 'C'.
  5321             88  CF-JNT-PLAN                   VALUE 'J'.
  5322             88  CF-SNGL-PLAN                  VALUE 'S'.
  5323         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5324         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5325         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5326         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5327         16  CF-RERATE-CNTL                 PIC  X.
  5328             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5329             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5330             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5331             88  CF-AUTO-RECALC                 VALUE '4'.
  5332         16  CF-BENEFIT-TYPE                PIC  X.
  5333             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5334             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5335         16  CF-POLICY-FEE                  PIC S999V99
  5336                                                    COMP-3.
  5337         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5338         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5339         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5340         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5341         16  FILLER                         PIC  X(32).
  5342         16  CF-TERMINATION-FORM            PIC  X(04).
  5343         16  FILLER                         PIC  X(08).
  5344         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5345                                                       COMP-3.
  5346         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5347         16  CF-ISSUE-LETTER                PIC  X(4).
  5348         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5349         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5350             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5351             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5352         16  CF-MP-REFUND-CALC              PIC X.
  5353             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5354             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5355             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5356             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5357             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5358             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5359             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5360             88  CF-MP-REFD-MEAN                VALUE '8'.
  5361         16  CF-ALT-RATE-CODE               PIC  X(5).
  5362
  5363
  5364         16  FILLER                         PIC X(498).
  5365****************************************************************
  5366*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 103
* EL156.cbl
  5367****************************************************************
  5368
  5369     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5370         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5371         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5372             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5373             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5374             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5375             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5376             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5377
  5378         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5379         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5380         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5381         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5382         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5383
  5384         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5385             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5386         16  CF-MP-RECON-USE-IND            PIC X(1).
  5387             88  CF-MP-USE-RECON             VALUE 'Y'.
  5388         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5389             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5390         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5391             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5392             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5393         16  FILLER                         PIC X(1).
  5394         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5395             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5396         16  CF-MORTG-MIB-VERSION           PIC X.
  5397             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5398             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5399             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5400         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5401             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5402                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5403             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5404                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5405             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5406                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5407             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5408                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5409             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5410                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5411             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5412                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5413         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5414         16  FILLER                         PIC X(7).
  5415         16  CF-MORTG-DESTINATION-SYMBOL.
  5416             20  CF-MORTG-MIB-COMM          PIC X(5).
  5417             20  CF-MORTG-MIB-TERM          PIC X(5).
  5418         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5419             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5420         16  FILLER                         PIC X(03).
  5421         16  CF-MP-CHECK-NO-CONTROL.
  5422             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5423                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5424                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 104
* EL156.cbl
  5425                                                ' ' LOW-VALUES.
  5426                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5427                                               VALUE '3'.
  5428         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5429         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5430         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5431             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5432                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5433             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5434                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5435             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5436                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5437             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5438                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5439             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5440                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5441             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5442                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5443         16  CF-MORTG-BILLING-AREA.
  5444             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5445                                            PIC X.
  5446         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5447         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5448         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5449         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5450             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5451             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5452         16  FILLER                         PIC X.
  5453         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5454             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5455             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5456         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5457         16  FILLER                         PIC X(8).
  5458         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5459         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5460         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5461         16  CF-ACH-COMPANY-ID.
  5462             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5463                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5464                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5465                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5466             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5467         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5468             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5469         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5470             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5471             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5472         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5473         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5474         16  FILLER                         PIC X(536).
  5475
  5476****************************************************************
  5477*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5478****************************************************************
  5479
  5480     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5481         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5482             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 105
* EL156.cbl
  5483                 24  CF-FEMALE-FT           PIC 99.
  5484                 24  CF-FEMALE-IN           PIC 99.
  5485             20  CF-FEMALE-MIN-WT           PIC 999.
  5486             20  CF-FEMALE-MAX-WT           PIC 999.
  5487         16  FILLER                         PIC X(428).
  5488
  5489     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5490         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5491             20  CF-MALE-HEIGHT.
  5492                 24  CF-MALE-FT             PIC 99.
  5493                 24  CF-MALE-IN             PIC 99.
  5494             20  CF-MALE-MIN-WT             PIC 999.
  5495             20  CF-MALE-MAX-WT             PIC 999.
  5496         16  FILLER                         PIC X(428).
  5497******************************************************************
  5498*             AUTOMATIC ACTIVITY RECORD                          *
  5499******************************************************************
  5500     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5501         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5502             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5503             20  CF-SYS-LETTER-ID           PIC X(04).
  5504             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5505             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5506             20  CF-SYS-RESET-SW            PIC X(01).
  5507             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5508             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5509
  5510         16  FILLER                         PIC X(50).
  5511
  5512         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5513             20  CF-USER-ACTIVE-SW          PIC X(01).
  5514             20  CF-USER-LETTER-ID          PIC X(04).
  5515             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5516             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5517             20  CF-USER-RESET-SW           PIC X(01).
  5518             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5519             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5520             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5521
  5522         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 106
* EL156.cbl
  5524*    COPY ELCCERT.
  5525******************************************************************
  5526*                                                                *
  5527*                            ELCCERT.                            *
  5528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5529*                            VMOD=2.013                          *
  5530*                                                                *
  5531*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5532*                                                                *
  5533*   FILE TYPE = VSAM,KSDS                                        *
  5534*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5535*                                                                *
  5536*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5537*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5538*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5539*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5540*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5541*                                                                *
  5542*   LOG = YES                                                    *
  5543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5544******************************************************************
  5545*                   C H A N G E   L O G
  5546*
  5547* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5548*-----------------------------------------------------------------
  5549*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5550* EFFECTIVE    NUMBER
  5551*-----------------------------------------------------------------
  5552* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5553* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5554* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5555* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5556* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5557* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5558* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5559* 032612  CR2011110200001  PEMA  AHL CHANGES
  5560******************************************************************
  5561
  5562 01  CERTIFICATE-MASTER.
  5563     12  CM-RECORD-ID                      PIC XX.
  5564         88  VALID-CM-ID                      VALUE 'CM'.
  5565
  5566     12  CM-CONTROL-PRIMARY.
  5567         16  CM-COMPANY-CD                 PIC X.
  5568         16  CM-CARRIER                    PIC X.
  5569         16  CM-GROUPING.
  5570             20  CM-GROUPING-PREFIX        PIC X(3).
  5571             20  CM-GROUPING-PRIME         PIC X(3).
  5572         16  CM-STATE                      PIC XX.
  5573         16  CM-ACCOUNT.
  5574             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5575             20  CM-ACCOUNT-PRIME          PIC X(6).
  5576         16  CM-CERT-EFF-DT                PIC XX.
  5577         16  CM-CERT-NO.
  5578             20  CM-CERT-PRIME             PIC X(10).
  5579             20  CM-CERT-SFX               PIC X.
  5580
  5581     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 107
* EL156.cbl
  5582         16  CM-COMPANY-CD-A1              PIC X.
  5583         16  CM-INSURED-LAST-NAME          PIC X(15).
  5584         16  CM-INSURED-INITIALS.
  5585             20  CM-INSURED-INITIAL1       PIC X.
  5586             20  CM-INSURED-INITIAL2       PIC X.
  5587
  5588     12  CM-CONTROL-BY-SSN.
  5589         16  CM-COMPANY-CD-A2              PIC X.
  5590         16  CM-SOC-SEC-NO.
  5591             20  CM-SSN-STATE              PIC XX.
  5592             20  CM-SSN-ACCOUNT            PIC X(6).
  5593             20  CM-SSN-LN3.
  5594                 25  CM-INSURED-INITIALS-A2.
  5595                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5596                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5597                 25 CM-PART-LAST-NAME-A2         PIC X.
  5598
  5599     12  CM-CONTROL-BY-CERT-NO.
  5600         16  CM-COMPANY-CD-A4              PIC X.
  5601         16  CM-CERT-NO-A4                 PIC X(11).
  5602
  5603     12  CM-CONTROL-BY-MEMB.
  5604         16  CM-COMPANY-CD-A5              PIC X.
  5605         16  CM-MEMBER-NO.
  5606             20  CM-MEMB-STATE             PIC XX.
  5607             20  CM-MEMB-ACCOUNT           PIC X(6).
  5608             20  CM-MEMB-LN4.
  5609                 25  CM-INSURED-INITIALS-A5.
  5610                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5611                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5612                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5613
  5614     12  CM-INSURED-PROFILE-DATA.
  5615         16  CM-INSURED-FIRST-NAME.
  5616             20  CM-INSURED-1ST-INIT       PIC X.
  5617             20  FILLER                    PIC X(9).
  5618         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5619         16  CM-INSURED-SEX                PIC X.
  5620             88  CM-SEX-MALE                  VALUE 'M'.
  5621             88  CM-SEX-FEMAL                 VALUE 'F'.
  5622         16  CM-INSURED-JOINT-AGE          PIC 99.
  5623         16  CM-JOINT-INSURED-NAME.
  5624             20  CM-JT-LAST-NAME           PIC X(15).
  5625             20  CM-JT-FIRST-NAME.
  5626                 24  CM-JT-1ST-INIT        PIC X.
  5627                 24  FILLER                PIC X(9).
  5628             20  CM-JT-INITIAL             PIC X.
  5629
  5630     12  CM-LIFE-DATA.
  5631         16  CM-LF-BENEFIT-CD              PIC XX.
  5632         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5633         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5634         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5635         16  CM-LF-DEV-CODE                PIC XXX.
  5636         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5637         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5638         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5639         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 108
* EL156.cbl
  5640         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5641         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5642         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5643         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5644         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5645         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5646         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5647         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5648         16  FILLER                        PIC XX.
  5649
  5650     12  CM-AH-DATA.
  5651         16  CM-AH-BENEFIT-CD              PIC XX.
  5652         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5653         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5654         16  CM-AH-DEV-CODE                PIC XXX.
  5655         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5656         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5657         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5658         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5659         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5660         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5661         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5662         16  CM-AH-PAID-THRU-DT            PIC XX.
  5663             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5664         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5665         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5666         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5667         16  FILLER                        PIC X.
  5668
  5669     12  CM-LOAN-INFORMATION.
  5670         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5671         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5672                                           PIC S9(5)V99  COMP-3.
  5673         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5674         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5675         16  CM-PAY-FREQUENCY              PIC S99.
  5676         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5677         16  CM-RATE-CLASS                 PIC XX.
  5678         16  CM-BENEFICIARY                PIC X(25).
  5679         16  CM-POLICY-FORM-NO             PIC X(12).
  5680         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5681         16  CM-LAST-ADD-ON-DT             PIC XX.
  5682         16  CM-DEDUCTIBLE-AMOUNTS.
  5683             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5684             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5685         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5686             20  CM-RESIDENT-STATE         PIC XX.
  5687             20  CM-RATE-CODE              PIC X(4).
  5688             20  FILLER                    PIC XX.
  5689         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5690             20  CM-LOAN-OFFICER           PIC X(5).
  5691             20  FILLER                    PIC XXX.
  5692         16  CM-CSR-CODE                   PIC XXX.
  5693         16  CM-UNDERWRITING-CODE          PIC X.
  5694             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5695         16  CM-POST-CARD-IND              PIC X.
  5696         16  CM-NH-INTERFACE-SW            PIC X.
  5697         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 109
* EL156.cbl
  5698             88  CM-SING-PRM                  VALUE '1'.
  5699             88  CM-O-B-COVERAGE              VALUE '2'.
  5700             88  CM-OPEN-END                  VALUE '3'.
  5701         16  CM-IND-GRP-TYPE               PIC X.
  5702             88  CM-INDIVIDUAL                VALUE 'I'.
  5703             88  CM-GROUP                     VALUE 'G'.
  5704         16  CM-SKIP-CODE                  PIC X.
  5705             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5706             88  SKIP-JULY                    VALUE '1'.
  5707             88  SKIP-AUGUST                  VALUE '2'.
  5708             88  SKIP-SEPTEMBER               VALUE '3'.
  5709             88  SKIP-JULY-AUG                VALUE '4'.
  5710             88  SKIP-AUG-SEPT                VALUE '5'.
  5711             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5712             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5713             88  SKIP-JUNE                    VALUE '8'.
  5714             88  SKIP-JUNE-JULY               VALUE '9'.
  5715             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5716             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5717         16  CM-PAYMENT-MODE               PIC X.
  5718             88  PAY-MONTHLY                  VALUE SPACE.
  5719             88  PAY-WEEKLY                   VALUE '1'.
  5720             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5721             88  PAY-BI-WEEKLY                VALUE '3'.
  5722             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5723         16  CM-LOAN-NUMBER                PIC X(8).
  5724         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5725         16  CM-OLD-LOF                    PIC XXX.
  5726*        16  CM-LOAN-OFFICER               PIC XXX.
  5727         16  CM-REIN-TABLE                 PIC XXX.
  5728         16  CM-SPECIAL-REIN-CODE          PIC X.
  5729         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5730         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5731         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5732
  5733     12  CM-STATUS-DATA.
  5734         16  CM-ENTRY-STATUS               PIC X.
  5735         16  CM-ENTRY-DT                   PIC XX.
  5736
  5737         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5738         16  CM-LF-CANCEL-DT               PIC XX.
  5739         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5740
  5741         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5742         16  CM-LF-DEATH-DT                PIC XX.
  5743         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5744
  5745         16  CM-LF-CURRENT-STATUS          PIC X.
  5746             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5747                                                'M' '4' '5' '9'.
  5748             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5749             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5750             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5751             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5752             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5753             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5754             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5755             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 110
* EL156.cbl
  5756             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5757             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5758             88  CM-LF-DECLINED               VALUE 'D'.
  5759             88  CM-LF-VOIDED                 VALUE 'V'.
  5760
  5761         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5762         16  CM-AH-CANCEL-DT               PIC XX.
  5763         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5764
  5765         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5766         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5767         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5768
  5769         16  CM-AH-CURRENT-STATUS          PIC X.
  5770             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5771                                                'M' '4' '5' '9'.
  5772             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5773             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5774             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5775             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5776             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5777             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5778             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5779             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5780             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5781             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5782             88  CM-AH-DECLINED               VALUE 'D'.
  5783             88  CM-AH-VOIDED                 VALUE 'V'.
  5784
  5785         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5786             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5787             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5788             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5789         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5790
  5791         16  CM-ENTRY-BATCH                PIC X(6).
  5792         16  CM-LF-EXIT-BATCH              PIC X(6).
  5793         16  CM-AH-EXIT-BATCH              PIC X(6).
  5794         16  CM-LAST-MONTH-END             PIC XX.
  5795
  5796     12  CM-NOTE-SW                        PIC X.
  5797         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5798         88  CERT-NOTES-PRESENT               VALUE '1'.
  5799         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5800         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5801         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5802         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5803         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5804         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5805     12  CM-COMP-EXCP-SW                   PIC X.
  5806         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5807         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5808     12  CM-INSURED-ADDRESS-SW             PIC X.
  5809         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5810         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5811
  5812*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5813     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 111
* EL156.cbl
  5814     12  FILLER                            PIC X.
  5815
  5816*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5817     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5818     12  FILLER                            PIC X.
  5819*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5820     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5821
  5822     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5823         88  CERT-ADDED-BATCH                 VALUE ' '.
  5824         88  CERT-ADDED-ONLINE                VALUE '1'.
  5825         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5826         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5827         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5828     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5829         88  CERT-AS-LOADED                   VALUE ' '.
  5830         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5831         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5832         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5833         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5834         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5835         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5836         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5837
  5838     12  CM-ACCOUNT-COMM-PCTS.
  5839         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5840         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5841
  5842     12  CM-USER-FIELD                     PIC X.
  5843     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5844     12  CM-CLP-STATE                      PIC XX.
  5845     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5846     12  CM-USER-RESERVED                  PIC XXX.
  5847     12  FILLER REDEFINES CM-USER-RESERVED.
  5848         16  CM-AH-CLASS-CD                PIC XX.
  5849         16  F                             PIC X.
  5850******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 112
* EL156.cbl
  5852*    COPY ELCTRLR.
  5853******************************************************************
  5854*                                                                *
  5855*                            ELCTRLR.                            *
  5856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5857*                            VMOD=2.014                          *
  5858*                                                                *
  5859*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5860*                                                                *
  5861*   FILE TYPE = VSAM,KSDS                                        *
  5862*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5863*                                                                *
  5864*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5865*       ALTERNATE INDEX = NONE                                   *
  5866*                                                                *
  5867*   LOG = YES                                                    *
  5868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5869******************************************************************
  5870*                   C H A N G E   L O G
  5871*
  5872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5873*-----------------------------------------------------------------
  5874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5875* EFFECTIVE    NUMBER
  5876*-----------------------------------------------------------------
  5877* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5878* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5879* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5880* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5881* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5882* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5883* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5884* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5885* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5886* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5887* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5888* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5889* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5890* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5891* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5892* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5893* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5894******************************************************************
  5895 01  ACTIVITY-TRAILERS.
  5896     12  AT-RECORD-ID                    PIC XX.
  5897         88  VALID-AT-ID                       VALUE 'AT'.
  5898
  5899     12  AT-CONTROL-PRIMARY.
  5900         16  AT-COMPANY-CD               PIC X.
  5901         16  AT-CARRIER                  PIC X.
  5902         16  AT-CLAIM-NO                 PIC X(7).
  5903         16  AT-CERT-NO.
  5904             20  AT-CERT-PRIME           PIC X(10).
  5905             20  AT-CERT-SFX             PIC X.
  5906         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5907             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5908             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5909             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 113
* EL156.cbl
  5910             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5911             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5912             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5913             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5914             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5915             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5916             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5917             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5918             88  AT-BENEFICIARY-TRL           VALUE +91.
  5919             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5920             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5921             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5922             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5923
  5924     12  AT-TRAILER-TYPE                 PIC X.
  5925         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5926         88  PAYMENT-TR                       VALUE '2'.
  5927         88  AUTO-PAY-TR                      VALUE '3'.
  5928         88  CORRESPONDENCE-TR                VALUE '4'.
  5929         88  ADDRESS-TR                       VALUE '5'.
  5930         88  GENERAL-INFO-TR                  VALUE '6'.
  5931         88  AUTO-PROMPT-TR                   VALUE '7'.
  5932         88  DENIAL-TR                        VALUE '8'.
  5933         88  INCURRED-CHG-TR                  VALUE '9'.
  5934         88  FORM-CONTROL-TR                  VALUE 'A'.
  5935
  5936     12  AT-RECORDED-DT                  PIC XX.
  5937     12  AT-RECORDED-BY                  PIC X(4).
  5938     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5939
  5940     12  AT-TRAILER-BODY                 PIC X(165).
  5941
  5942     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5943         16  AT-RESERVE-CONTROLS.
  5944             20  AT-MANUAL-SW            PIC X.
  5945                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5946             20  AT-FUTURE-SW            PIC X.
  5947                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5948             20  AT-PTC-SW               PIC X.
  5949                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5950             20  AT-IBNR-SW              PIC X.
  5951                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5952             20  AT-PTC-LF-SW            PIC X.
  5953                 88  AT-LF-PTC-USED          VALUE '1'.
  5954             20  AT-CDT-ACCESS-METHOD    PIC X.
  5955                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5956                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5957                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5958             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5959         16  AT-LAST-COMPUTED-DT         PIC XX.
  5960         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5961         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5962         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5963         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5964         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5965         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5966         16  AT-EXPENSE-CONTROLS.
  5967             20  AT-EXPENSE-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 114
* EL156.cbl
  5968                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5969                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5970                 88  PERCENT-OF-PMT           VALUE '3'.
  5971                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5972             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5973             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5974         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5975         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5976
  5977         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5978         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5979
  5980*        16  FILLER                      PIC X(53).
  5981         16  FILLER                      PIC X(47).
  5982
  5983         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5984         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5985
  5986         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5987             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5988             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5989*                    C = CLOSED
  5990*                    O = OPEN
  5991             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5992*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5993
  5994     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5995         16  AT-PAYMENT-TYPE             PIC X.
  5996             88  PARTIAL-PAYMENT                VALUE '1'.
  5997             88  FINAL-PAYMENT                  VALUE '2'.
  5998             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5999             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6000             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6001             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6002             88  VOIDED-PAYMENT                 VALUE '9'.
  6003             88  TRANSFER                       VALUE 'T'.
  6004             88  LIFE-INTEREST                  VALUE 'I'.
  6005
  6006         16  AT-CLAIM-TYPE               PIC X.
  6007             88  PAID-FOR-AH                    VALUE 'A'.
  6008             88  PAID-FOR-LIFE                  VALUE 'L'.
  6009             88  PAID-FOR-IUI                   VALUE 'I'.
  6010             88  PAID-FOR-GAP                   VALUE 'G'.
  6011         16  AT-CLAIM-PREM-TYPE          PIC X.
  6012             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6013             88  AT-O-B-COVERAGE                VALUE '2'.
  6014             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6015         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6016         16  AT-CHECK-NO                 PIC X(7).
  6017         16  AT-PAID-FROM-DT             PIC XX.
  6018         16  AT-PAID-THRU-DT             PIC XX.
  6019         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6020         16  FILLER                      PIC X.
  6021         16  AT-PAYEES-NAME              PIC X(30).
  6022         16  AT-PAYMENT-ORIGIN           PIC X.
  6023             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6024             88  ONLINE-AUTO-PMT                VALUE '2'.
  6025             88  OFFLINE-PMT                    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 115
* EL156.cbl
  6026         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6027         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6028         16  AT-VOID-DATA.
  6029             20  AT-VOID-DT              PIC XX.
  6030*00144       20  AT-VOID-REASON          PIC X(30).
  6031             20  AT-VOID-REASON          PIC X(26).
  6032         16  AT-PMT-APPROVED-BY          PIC X(04).
  6033         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6034         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6035         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6036                                         PIC S99V9(5)  COMP-3.
  6037         16  AT-CREDIT-INTERFACE.
  6038             20  AT-PMT-SELECT-DT        PIC XX.
  6039                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6040             20  AT-PMT-ACCEPT-DT        PIC XX.
  6041                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6042             20  AT-VOID-SELECT-DT       PIC XX.
  6043                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6044             20  AT-VOID-ACCEPT-DT       PIC XX.
  6045                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6046
  6047         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6048                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6049                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6050         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6051
  6052         16  AT-FORCE-CONTROL            PIC X.
  6053             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6054         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6055         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6056         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6057         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6058         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6059         16  AT-BENEFIT-TYPE             PIC X.
  6060
  6061         16  AT-EXPENSE-TYPE             PIC X.
  6062         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6063
  6064         16  AT-PAYEE-TYPE-CD.
  6065             20  AT-PAYEE-TYPE           PIC X.
  6066                 88  INSURED-PAID           VALUE 'I'.
  6067                 88  BENEFICIARY-PAID       VALUE 'B'.
  6068                 88  ACCOUNT-PAID           VALUE 'A'.
  6069                 88  OTHER-1-PAID           VALUE 'O'.
  6070                 88  OTHER-2-PAID           VALUE 'Q'.
  6071                 88  DOCTOR-PAID            VALUE 'P'.
  6072                 88  EMPLOYER-PAID          VALUE 'E'.
  6073             20  AT-PAYEE-SEQ            PIC X.
  6074
  6075         16  AT-CASH-PAYMENT             PIC X.
  6076         16  AT-GROUPED-PAYMENT          PIC X.
  6077         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6078         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6079         16  AT-APPROVED-LEVEL           PIC X.
  6080         16  AT-VOID-TYPE                PIC X.
  6081             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6082             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6083         16  AT-AIG-UNEMP-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 116
* EL156.cbl
  6084             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6085         16  AT-ASSOCIATES               PIC X.
  6086             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6087             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6088
  6089         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6090         16  AT-CV-PMT-CODE              PIC X.
  6091             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6092             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6093             88  FULL-ADD-PAYMENT           VALUE '3'.
  6094             88  HALF-ADD-PAYMENT           VALUE '4'.
  6095             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6096             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6097             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6098             88  ADDL-PAYMENT               VALUE '8'.
  6099
  6100         16  AT-EOB-CODE1                PIC XXX.
  6101         16  AT-EOB-CODE2                PIC XXX.
  6102         16  AT-EOB-CODE3                PIC XXX.
  6103         16  FILLER REDEFINES AT-EOB-CODE3.
  6104             20  AT-PRINT-CLM-FORM       PIC X.
  6105             20  AT-PRINT-SURVEY         PIC X.
  6106             20  AT-SPECIAL-RELEASE      PIC X.
  6107         16  AT-EOB-CODE4                PIC XXX.
  6108         16  FILLER REDEFINES AT-EOB-CODE4.
  6109             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6110             20  FILLER                  PIC X.
  6111         16  AT-EOB-CODE5                PIC XXX.
  6112         16  FILLER REDEFINES AT-EOB-CODE5.
  6113             20  AT-PMT-PROOF-DT         PIC XX.
  6114             20  FILLER                  PIC X.
  6115
  6116         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6117             88  AT-PRINT-EOB            VALUE 'Y'.
  6118
  6119         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6120         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6121
  6122     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6123         16  AT-SCHEDULE-START-DT        PIC XX.
  6124         16  AT-SCHEDULE-END-DT          PIC XX.
  6125         16  AT-TERMINATED-DT            PIC XX.
  6126         16  AT-LAST-PMT-TYPE            PIC X.
  6127             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6128             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6129         16  AT-FIRST-PMT-DATA.
  6130             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6131             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6132             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6133         16  AT-REGULAR-PMT-DATA.
  6134             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6135             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6136             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6137         16  AT-AUTO-PAYEE-CD.
  6138             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6139                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6140                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6141                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 117
* EL156.cbl
  6142                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6143                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6144             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6145         16  AT-AUTO-PAY-DAY             PIC 99.
  6146         16  AT-AUTO-CASH                PIC X.
  6147             88  AT-CASH                      VALUE 'Y'.
  6148             88  AT-NON-CASH                  VALUE 'N'.
  6149*        16  FILLER                      PIC X(129).
  6150         16  AT-AUTO-END-LETTER          PIC X(4).
  6151         16  FILLER                      PIC X(125).
  6152
  6153         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6154         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6155
  6156     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6157         16  AT-LETTER-SENT-DT           PIC XX.
  6158         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6159         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6160         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6161         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6162         16  AT-LETTER-ORIGIN            PIC X.
  6163             88  ONLINE-CREATION              VALUE '1' '3'.
  6164             88  OFFLINE-CREATION             VALUE '2' '4'.
  6165             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6166             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6167         16  AT-STD-LETTER-FORM          PIC X(4).
  6168         16  AT-REASON-TEXT              PIC X(70).
  6169         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6170         16  AT-ADDRESEE-TYPE            PIC X.
  6171              88  INSURED-ADDRESEE            VALUE 'I'.
  6172              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6173              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6174              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6175              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6176              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6177              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6178         16  AT-ADDRESSEE-NAME           PIC X(30).
  6179         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6180         16  AT-RESEND-PRINT-DATE        PIC XX.
  6181         16  AT-CORR-SOL-UNSOL           PIC X.
  6182         16  AT-LETTER-PURGED-DT         PIC XX.
  6183*
  6184*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6185*
  6186         16  AT-CSO-REDEFINITION.
  6187             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6188             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6189             20  AT-LETTER-TO-BENE       PIC X(1).
  6190             20  AT-STOP-LETTER-DT       PIC X(2).
  6191             20  FILLER                  PIC X(19).
  6192*             20  FILLER                  PIC X(27).
  6193             20  AT-CSO-LETTER-STATUS    PIC X.
  6194                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6195                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6196                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6197             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6198             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6199*
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 118
* EL156.cbl
  6200*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6201*
  6202*        16  FILLER                      PIC X(26).
  6203*
  6204*        16  AT-DMD-BSR-CODE             PIC X.
  6205*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6206*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6207*
  6208*        16  AT-DMD-LETTER-STATUS        PIC X.
  6209*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6210*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6211*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6212*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6213*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6214
  6215         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6216         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6217
  6218     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6219         16  AT-ADDRESS-TYPE             PIC X.
  6220             88  INSURED-ADDRESS               VALUE 'I'.
  6221             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6222             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6223             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6224             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6225             88  OTHER-ADDRESS-1               VALUE 'O'.
  6226             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6227         16  AT-MAIL-TO-NAME             PIC X(30).
  6228         16  AT-ADDRESS-LINE-1           PIC X(30).
  6229         16  AT-ADDRESS-LINE-2           PIC X(30).
  6230         16  AT-CITY-STATE.
  6231             20  AT-CITY                 PIC X(28).
  6232             20  AT-STATE                PIC XX.
  6233         16  AT-ZIP.
  6234             20  AT-ZIP-CODE.
  6235                 24  AT-ZIP-1ST          PIC X.
  6236                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6237                 24  FILLER              PIC X(4).
  6238             20  AT-ZIP-PLUS4            PIC X(4).
  6239         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6240             20  AT-CAN-POSTAL-1         PIC XXX.
  6241             20  AT-CAN-POSTAL-2         PIC XXX.
  6242             20  FILLER                  PIC XXX.
  6243         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6244*         16  FILLER                      PIC X(23).
  6245         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6246         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6247         16  FILLER                      PIC X(13).
  6248         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6249         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6250
  6251     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6252         16  AT-INFO-LINE-1              PIC X(60).
  6253         16  FILLER REDEFINES AT-INFO-LINE-1.
  6254             20  AT-NOTE-ERROR-NO OCCURS 15
  6255                                         PIC X(4).
  6256         16  AT-INFO-LINE-2              PIC X(60).
  6257         16  AT-INFO-TRAILER-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 119
* EL156.cbl
  6258             88  AT-ERRORS-NOTE          VALUE 'E'.
  6259             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6260             88  AT-CALL-NOTE            VALUE 'C'.
  6261             88  AT-MAINT-NOTE           VALUE 'M'.
  6262             88  AT-CERT-CHANGE          VALUE 'X'.
  6263             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6264             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6265         16  AT-CALL-TYPE                PIC X.
  6266             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6267             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6268         16  AT-NOTE-CONTINUATION        PIC X.
  6269             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6270         16  AT-EOB-CODES-EXIST          PIC X.
  6271             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6272         16  FILLER                      PIC X(35).
  6273         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6274         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6275
  6276     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6277         16  AT-PROMPT-LINE-1            PIC X(60).
  6278         16  AT-PROMPT-LINE-2            PIC X(60).
  6279         16  AT-PROMPT-START-DT          PIC XX.
  6280         16  AT-PROMPT-END-DT            PIC XX.
  6281         16  FILLER                      PIC X(35).
  6282         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6283         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6284
  6285     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6286         16  AT-DENIAL-INFO-1            PIC X(60).
  6287         16  AT-DENIAL-INFO-2            PIC X(60).
  6288         16  AT-DENIAL-DT                PIC XX.
  6289         16  AT-RETRACTION-DT            PIC XX.
  6290         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6291*         16  FILLER                      PIC X(31).
  6292         16  AT-DENIAL-PROOF-DT          PIC XX.
  6293         16  FILLER                      PIC X(29).
  6294         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6295         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6296
  6297     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6298         16  AT-OLD-INCURRED-DT          PIC XX.
  6299         16  AT-OLD-REPORTED-DT          PIC XX.
  6300         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6301         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6302         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6303         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6304         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6305         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6306         16  FILLER                      PIC X(26).
  6307         16  AT-OLD-DIAG-CODE            PIC X(6).
  6308         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6309         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6310         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6311         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6312         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6313         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6314         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6315         16  FILLER                      PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 120
* EL156.cbl
  6316         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6317
  6318     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6319         16  AT-FORM-SEND-ON-DT          PIC XX.
  6320         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6321         16  AT-FORM-RE-SEND-DT          PIC XX.
  6322         16  AT-FORM-ANSWERED-DT         PIC XX.
  6323         16  AT-FORM-PRINTED-DT          PIC XX.
  6324         16  AT-FORM-REPRINT-DT          PIC XX.
  6325         16  AT-FORM-TYPE                PIC X.
  6326             88  INITIAL-FORM                  VALUE '1'.
  6327             88  PROGRESS-FORM                 VALUE '2'.
  6328         16  AT-INSTRUCT-LN-1            PIC X(28).
  6329         16  AT-INSTRUCT-LN-2            PIC X(28).
  6330         16  AT-INSTRUCT-LN-3            PIC X(28).
  6331         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6332         16  AT-FORM-ADDRESS             PIC X.
  6333             88  FORM-TO-INSURED              VALUE 'I'.
  6334             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6335             88  FORM-TO-OTHER-1              VALUE 'O'.
  6336             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6337         16  AT-RELATED-1.
  6338             20 AT-REL-CARR-1            PIC X.
  6339             20 AT-REL-CLAIM-1           PIC X(7).
  6340             20 AT-REL-CERT-1            PIC X(11).
  6341         16  AT-RELATED-2.
  6342             20 AT-REL-CARR-2            PIC X.
  6343             20 AT-REL-CLAIM-2           PIC X(7).
  6344             20 AT-REL-CERT-2            PIC X(11).
  6345         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6346         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6347         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6348         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6349         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6350         16  AT-STOP-FORM-DT             PIC X(2).
  6351
  6352         16  FILLER                      PIC X(09).
  6353         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6354         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6355******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 121
* EL156.cbl
  6357*    COPY ELCACTQ.
  6358******************************************************************
  6359*                                                                *
  6360*                            ELCACTQ.                            *
  6361*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6362*                            VMOD=2.004                          *
  6363*                                                                *
  6364*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6365*                                                                *
  6366*   FILE TYPE = VSAM,KSDS                                        *
  6367*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6368*                                                                *
  6369*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6370*       ALTERNATE INDEX = NONE                                   *
  6371*                                                                *
  6372*   LOG = YES                                                    *
  6373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6374*                                                                *
  6375*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6376******************************************************************
  6377
  6378 01  ACTIVITY-QUE.
  6379     12  AQ-RECORD-ID                PIC XX.
  6380         88  VALID-AQ-ID                VALUE 'AQ'.
  6381
  6382     12  AQ-CONTROL-PRIMARY.
  6383         16  AQ-COMPANY-CD           PIC X.
  6384         16  AQ-CARRIER              PIC X.
  6385         16  AQ-CLAIM-NO             PIC X(7).
  6386         16  AQ-CERT-NO.
  6387             20  AQ-CERT-PRIME       PIC X(10).
  6388             20  AQ-CERT-SFX         PIC X.
  6389
  6390     12  AQ-PENDING-ACTIVITY-FLAGS.
  6391         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6392         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6393             88  PENDING-PAYMENTS       VALUE '1'.
  6394         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6395             88  PENDING-FULL-PRINT     VALUE '1'.
  6396             88  PENDING-PART-PRINT     VALUE '2'.
  6397         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6398             88  PENDING-LETTERS        VALUE '1'.
  6399         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6400             88  PENDING-RESTORE        VALUE 'C'.
  6401             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6402
  6403     12  FILLER                      PIC X(20).
  6404
  6405     12  AQ-RESEND-DATE              PIC XX.
  6406     12  AQ-FOLLOWUP-DATE            PIC XX.
  6407     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6408     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6409     12  AQ-AUTO-LETTER              PIC X(4).
  6410     12  FILLER                      PIC XX.
  6411     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6412*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 122
* EL156.cbl
  6414*    COPY ERCACCT.
  6415******************************************************************
  6416*                                                                *
  6417*                                                                *
  6418*                            ERCACCT                             *
  6419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6420*                            VMOD=2.031                          *
  6421*                                                                *
  6422*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6423*                                                                *
  6424*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6425*   VSAM ACCOUNT MASTER FILES.                                   *
  6426*                                                                *
  6427*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6428*                                                                *
  6429*   FILE TYPE = VSAM,KSDS                                        *
  6430*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6431*                                                                *
  6432*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6433*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6434*                                                                *
  6435*   LOG = NO                                                     *
  6436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6437*                                                                *
  6438*                                                                *
  6439******************************************************************
  6440*                   C H A N G E   L O G
  6441*
  6442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6443*-----------------------------------------------------------------
  6444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6445* EFFECTIVE    NUMBER
  6446*-----------------------------------------------------------------
  6447* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6448* 092705    2005050300006  PEMA  ADD SPP LEASES
  6449* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6450* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6451* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6452* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6453* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6454******************************************************************
  6455
  6456 01  ACCOUNT-MASTER.
  6457     12  AM-RECORD-ID                      PIC XX.
  6458         88  VALID-AM-ID                      VALUE 'AM'.
  6459
  6460     12  AM-CONTROL-PRIMARY.
  6461         16  AM-COMPANY-CD                 PIC X.
  6462         16  AM-MSTR-CNTRL.
  6463             20  AM-CONTROL-A.
  6464                 24  AM-CARRIER            PIC X.
  6465                 24  AM-GROUPING.
  6466                     28 AM-GROUPING-PREFIX PIC XXX.
  6467                     28 AM-GROUPING-PRIME  PIC XXX.
  6468                 24  AM-STATE              PIC XX.
  6469                 24  AM-ACCOUNT.
  6470                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6471                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 123
* EL156.cbl
  6472             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6473                                           PIC X(19).
  6474             20  AM-CNTRL-B.
  6475                 24  AM-EXPIRATION-DT      PIC XX.
  6476                 24  FILLER                PIC X(4).
  6477             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6478                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6479
  6480     12  AM-CONTROL-BY-VAR-GRP.
  6481         16  AM-COMPANY-CD-A1              PIC X.
  6482         16  AM-VG-CARRIER                 PIC X.
  6483         16  AM-VG-GROUPING                PIC X(6).
  6484         16  AM-VG-STATE                   PIC XX.
  6485         16  AM-VG-ACCOUNT                 PIC X(10).
  6486         16  AM-VG-DATE.
  6487             20  AM-VG-EXPIRATION-DT       PIC XX.
  6488             20  FILLER                    PIC X(4).
  6489         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6490                                           PIC 9(11)      COMP-3.
  6491     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6492         16  FILLER                        PIC X(10).
  6493         16  AM-VG-KEY3.
  6494             20  AM-VG3-ACCOUNT            PIC X(10).
  6495             20  AM-VG3-EXP-DT             PIC XX.
  6496         16  FILLER                        PIC X(4).
  6497     12  AM-MAINT-INFORMATION.
  6498         16  AM-LAST-MAINT-DT              PIC XX.
  6499         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6500         16  AM-LAST-MAINT-USER            PIC X(4).
  6501         16  FILLER                        PIC XX.
  6502
  6503     12  AM-EFFECTIVE-DT                   PIC XX.
  6504     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6505
  6506     12  AM-PREV-DATES  COMP-3.
  6507         16  AM-PREV-EXP-DT                PIC 9(11).
  6508         16  AM-PREV-EFF-DT                PIC 9(11).
  6509
  6510     12  AM-REPORT-CODE-1                  PIC X(10).
  6511     12  AM-REPORT-CODE-2                  PIC X(10).
  6512
  6513     12  AM-CITY-CODE                      PIC X(4).
  6514     12  AM-COUNTY-PARISH                  PIC X(6).
  6515
  6516     12  AM-NAME                           PIC X(30).
  6517     12  AM-PERSON                         PIC X(30).
  6518     12  AM-ADDRS                          PIC X(30).
  6519     12  AM-CITY.
  6520         16  AM-ADDR-CITY                  PIC X(28).
  6521         16  AM-ADDR-STATE                 PIC XX.
  6522     12  AM-ZIP.
  6523         16  AM-ZIP-PRIME.
  6524             20  AM-ZIP-PRI-1ST            PIC X.
  6525                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6526             20  FILLER                    PIC X(4).
  6527         16  AM-ZIP-PLUS4                  PIC X(4).
  6528     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6529         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 124
* EL156.cbl
  6530         16  AM-CAN-POSTAL-2               PIC XXX.
  6531         16  FILLER                        PIC XXX.
  6532     12  AM-TEL-NO.
  6533         16  AM-AREA-CODE                  PIC 999.
  6534         16  AM-TEL-PRE                    PIC 999.
  6535         16  AM-TEL-NBR                    PIC 9(4).
  6536     12  AM-TEL-LOC                        PIC X.
  6537         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6538         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6539
  6540     12  AM-COMM-STRUCTURE.
  6541         16  AM-DEFN-1.
  6542             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6543                 24  AM-AGT.
  6544                     28  AM-AGT-PREFIX     PIC X(4).
  6545                     28  AM-AGT-PRIME      PIC X(6).
  6546                 24  AM-COM-TYP            PIC X.
  6547                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6548                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6549                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6550                 24  AM-RECALC-LV-INDIC    PIC X.
  6551                 24  AM-RETRO-LV-INDIC     PIC X.
  6552                 24  AM-GL-CODES           PIC X.
  6553                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6554                 24  FILLER                PIC X(01).
  6555         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6556             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6557                 24  FILLER                PIC X(11).
  6558                 24  AM-L-COMA             PIC XXX.
  6559                 24  AM-J-COMA             PIC XXX.
  6560                 24  AM-A-COMA             PIC XXX.
  6561                 24  FILLER                PIC X(6).
  6562
  6563     12  AM-COMM-CHANGE-STATUS             PIC X.
  6564         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6565
  6566     12  AM-CSR-CODE                       PIC X(4).
  6567
  6568     12  AM-BILLING-STATUS                 PIC X.
  6569         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6570         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6571     12  AM-AUTO-REFUND-SW                 PIC X.
  6572         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6573         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6574     12  AM-GPCD                           PIC 99.
  6575     12  AM-IG                             PIC X.
  6576         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6577         88  AM-HAS-GROUP                     VALUE '2'.
  6578     12  AM-STATUS                         PIC X.
  6579         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6580         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6581         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6582         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6583         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6584         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6585     12  AM-REMIT-TO                       PIC 99.
  6586     12  AM-ID-NO                          PIC X(11).
  6587
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 125
* EL156.cbl
  6588     12  AM-CAL-TABLE                      PIC XX.
  6589     12  AM-LF-DEVIATION                   PIC XXX.
  6590     12  AM-AH-DEVIATION                   PIC XXX.
  6591     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6592     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6593     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6594     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6595     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6596     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6597
  6598     12  AM-USER-FIELDS.
  6599         16  AM-FLD-1                      PIC XX.
  6600         16  AM-FLD-2                      PIC XX.
  6601         16  AM-FLD-3                      PIC XX.
  6602         16  AM-FLD-4                      PIC XX.
  6603         16  AM-FLD-5                      PIC XX.
  6604
  6605     12  AM-1ST-PROD-DATE.
  6606         16  AM-1ST-PROD-YR                PIC XX.
  6607         16  AM-1ST-PROD-MO                PIC XX.
  6608         16  AM-1ST-PROD-DA                PIC XX.
  6609     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6610     12  AM-CERTS-PURGED-DATE.
  6611         16  AM-PUR-YR                     PIC XX.
  6612         16  AM-PUR-MO                     PIC XX.
  6613         16  AM-PUR-DA                     PIC XX.
  6614     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6615     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6616     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6617     12  AM-INACTIVE-DATE.
  6618         16  AM-INA-MO                     PIC 99.
  6619         16  AM-INA-DA                     PIC 99.
  6620         16  AM-INA-YR                     PIC 99.
  6621     12  AM-AR-HI-CERT-DATE                PIC XX.
  6622
  6623     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6624     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6625
  6626     12  AM-OB-PAYMENT-MODE                PIC X.
  6627         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6628         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6629         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6630         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6631
  6632     12  AM-AH-ONLY-INDICATOR              PIC X.
  6633         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6634         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6635
  6636     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6637
  6638     12  AM-OVER-SHORT.
  6639         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6640         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6641
  6642     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6643     12  AM-DCC-CLP-STATE                  PIC XX.
  6644
  6645     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 126
* EL156.cbl
  6646     12  AM-RECALC-REIN                    PIC X.
  6647
  6648     12  AM-REI-TABLE                      PIC XXX.
  6649     12  AM-REI-ET-LF                      PIC X.
  6650     12  AM-REI-ET-AH                      PIC X.
  6651     12  AM-REI-PE-LF                      PIC X.
  6652     12  AM-REI-PE-AH                      PIC X.
  6653     12  AM-REI-PRT-ST                     PIC X.
  6654     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6655     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-GROUP-A                    PIC X(6).
  6658     12  AM-REI-MORT                       PIC X(4).
  6659     12  AM-REI-PRT-OW                     PIC X.
  6660     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6661     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-GROUP-B                    PIC X(6).
  6664
  6665     12  AM-TRUST-TYPE                     PIC X(2).
  6666
  6667     12  AM-EMPLOYER-STMT-USED             PIC X.
  6668     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6669
  6670     12  AM-STD-AH-TYPE                    PIC XX.
  6671     12  AM-EARN-METHODS.
  6672         16  AM-EARN-METHOD-R              PIC X.
  6673             88 AM-REF-RL-R78                 VALUE 'R'.
  6674             88 AM-REF-RL-PR                  VALUE 'P'.
  6675             88 AM-REF-RL-MEAN                VALUE 'M'.
  6676             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6677         16  AM-EARN-METHOD-L              PIC X.
  6678             88 AM-REF-LL-R78                 VALUE 'R'.
  6679             88 AM-REF-LL-PR                  VALUE 'P'.
  6680             88 AM-REF-LL-MEAN                VALUE 'M'.
  6681             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6682         16  AM-EARN-METHOD-A              PIC X.
  6683             88 AM-REF-AH-R78                 VALUE 'R'.
  6684             88 AM-REF-AH-PR                  VALUE 'P'.
  6685             88 AM-REF-AH-MEAN                VALUE 'M'.
  6686             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6687             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6688             88 AM-REF-AH-NET                 VALUE 'N'.
  6689
  6690     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6691     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6692     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6693
  6694     12  AM-RET-Y-N                        PIC X.
  6695     12  AM-RET-P-E                        PIC X.
  6696     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6697     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6698     12  AM-RET-GRP                        PIC X(6).
  6699     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6700         16  AM-POOL-PRIME                 PIC XXX.
  6701         16  AM-POOL-SUB                   PIC XXX.
  6702     12  AM-RETRO-EARNINGS.
  6703         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 127
* EL156.cbl
  6704         16  AM-RET-EARN-L                 PIC X.
  6705         16  AM-RET-EARN-A                 PIC X.
  6706     12  AM-RET-ST-TAX-USE                 PIC X.
  6707         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6708         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6709     12  AM-RETRO-BEG-EARNINGS.
  6710         16  AM-RET-BEG-EARN-R             PIC X.
  6711         16  AM-RET-BEG-EARN-L             PIC X.
  6712         16  AM-RET-BEG-EARN-A             PIC X.
  6713     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6714     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6715
  6716     12  AM-USER-SELECT-OPTIONS.
  6717         16  AM-USER-SELECT-1              PIC X(10).
  6718         16  AM-USER-SELECT-2              PIC X(10).
  6719         16  AM-USER-SELECT-3              PIC X(10).
  6720         16  AM-USER-SELECT-4              PIC X(10).
  6721         16  AM-USER-SELECT-5              PIC X(10).
  6722
  6723     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6724
  6725     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6726
  6727     12  AM-RPT045A-SWITCH                 PIC X.
  6728         88  RPT045A-OFF                   VALUE 'N'.
  6729
  6730     12  AM-INSURANCE-LIMITS.
  6731         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6732         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6733
  6734     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6735         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6736
  6737     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6738         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6739         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6740
  6741     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6742
  6743     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6744     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6745     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6746     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6747     12  AM-DCC-UEF-STATE                  PIC XX.
  6748     12  FILLER                            PIC XXX.
  6749     12  AM-REPORT-CODE-3                  PIC X(10).
  6750*    12  FILLER                            PIC X(22).
  6751
  6752     12  AM-RESERVE-DATE.
  6753         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6754         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6755         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6756
  6757     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6758     12  AM-NOTIFICATION-TYPES.
  6759         16  AM-NOTIF-OF-LETTERS           PIC X.
  6760         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6761         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 128
* EL156.cbl
  6762         16  AM-NOTIF-OF-STATUS            PIC X.
  6763
  6764     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6765         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6766         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6767         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6768         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6769
  6770     12  AM-BENEFIT-CONTROLS.
  6771         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6772             20  AM-BENEFIT-CODE           PIC XX.
  6773             20  AM-BENEFIT-TYPE           PIC X.
  6774             20  AM-BENEFIT-REVISION       PIC XXX.
  6775             20  AM-BENEFIT-REM-TERM       PIC X.
  6776             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6777             20  FILLER                    PIC XX.
  6778         16  FILLER                        PIC X(80).
  6779
  6780     12  AM-TRANSFER-DATA.
  6781         16  AM-TRANSFERRED-FROM.
  6782             20  AM-TRNFROM-CARRIER        PIC X.
  6783             20  AM-TRNFROM-GROUPING.
  6784                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6785                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6786             20  AM-TRNFROM-STATE          PIC XX.
  6787             20  AM-TRNFROM-ACCOUNT.
  6788                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6789                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6790             20  AM-TRNFROM-DTE            PIC XX.
  6791         16  AM-TRANSFERRED-TO.
  6792             20  AM-TRNTO-CARRIER          PIC X.
  6793             20  AM-TRNTO-GROUPING.
  6794                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6795                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6796             20  AM-TRNTO-STATE            PIC XX.
  6797             20  AM-TRNTO-ACCOUNT.
  6798                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6799                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6800             20  AM-TRNTO-DTE              PIC XX.
  6801         16  FILLER                        PIC X(10).
  6802
  6803     12  AM-SAVED-REMIT-TO                 PIC 99.
  6804
  6805     12  AM-COMM-STRUCTURE-SAVED.
  6806         16  AM-DEFN-1-SAVED.
  6807             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6808                 24  AM-AGT-SV             PIC X(10).
  6809                 24  AM-COM-TYP-SV         PIC X.
  6810                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6811                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6812                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6813                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6814                 24  FILLER                PIC X.
  6815                 24  AM-GL-CODES-SV        PIC X.
  6816                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6817                 24  FILLER                PIC X.
  6818         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6819             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 129
* EL156.cbl
  6820                 24  FILLER                PIC X(11).
  6821                 24  AM-L-COMA-SV          PIC XXX.
  6822                 24  AM-J-COMA-SV          PIC XXX.
  6823                 24  AM-A-COMA-SV          PIC XXX.
  6824                 24  FILLER                PIC X(6).
  6825
  6826     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6827         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6828            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6829            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6830            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6831
  6832     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6833     12  FILLER                            PIC X(120).
  6834
  6835     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6836         16  AM-CONTROL-NAME               PIC X(30).
  6837         16  AM-EXECUTIVE-ONE.
  6838             20  AM-EXEC1-NAME             PIC X(15).
  6839             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6840                                                          COMP-3.
  6841             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6842                                                          COMP-3.
  6843         16  AM-EXECUTIVE-TWO.
  6844             20  AM-EXEC2-NAME             PIC X(15).
  6845             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6846                                                          COMP-3.
  6847             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6848                                                          COMP-3.
  6849
  6850     12  AM-RETRO-ADDITIONAL-DATA.
  6851         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6852         16  AM-RETRO-PREM-P-E             PIC X.
  6853         16  AM-RETRO-CLMS-P-I             PIC X.
  6854         16  AM-RETRO-RET-BRACKET-LF.
  6855             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6856                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6857                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6858             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6859                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6860                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6861             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6862                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6863                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6864         16  AM-RETRO-RET-BRACKET-AH.
  6865             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6866                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6867                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6868                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6869             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6870                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6871                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6872             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6873                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6874                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6875
  6876     12  AM-COMMENTS.
  6877         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 130
* EL156.cbl
  6878
  6879     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6880         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6881         16  AM-FLI-BILLING-CODE           PIC X.
  6882         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6883         16  AM-FLI-UNITED-IDENT           PIC X.
  6884         16  AM-FLI-INTEREST-LOST-DATA.
  6885             20  AM-FLI-BANK-NO            PIC X(5).
  6886             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6887             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6888             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6889         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6890             20  AM-FLI-AGT                PIC X(9).
  6891             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6892             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6893         16  FILLER                        PIC X(102).
  6894
  6895     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6896         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6897             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6898             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6899             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6900             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6901             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6902         16  FILLER                          PIC X(10).
  6903******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 131
* EL156.cbl
  6905*    COPY ELCCHKQ.
  6906******************************************************************
  6907*                                                                *
  6908*                                                                *
  6909*                            ELCCHKQ.                            *
  6910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6911*                            VMOD=2.007                          *
  6912*                                                                *
  6913*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6914*                                                                *
  6915*   FILE TYPE = VSAM,KSDS                                        *
  6916*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6917*                                                                *
  6918*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6919*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6920*                                                                *
  6921*   LOG = YES                                                    *
  6922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6923******************************************************************
  6924 01  CHECK-QUE.
  6925     12  CQ-RECORD-ID                PIC XX.
  6926         88  VALID-CQ-ID         VALUE 'CQ'.
  6927
  6928     12  CQ-CONTROL-PRIMARY.
  6929         16  CQ-COMPANY-CD           PIC X.
  6930         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6931         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6932
  6933     12  CQ-CONTROL-BY-PAYEE.
  6934         16  CQ-CONTROL-BY-NUMBER.
  6935             20  CQ-COMPANY-CD-A1     PIC X.
  6936             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6937         16  CQ-PAYEE-CARRIER        PIC X.
  6938         16  CQ-PAYEE-GROUPING       PIC X(6).
  6939         16  CQ-PAYEE-STATE          PIC XX.
  6940         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6941         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6942
  6943     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6944         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6945         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6946         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6947         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6948         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6949         16  FILLER                  PIC X(3).
  6950
  6951     12  CQ-ENTRY-TYPE               PIC X.
  6952             88  CHECK-ON-QUE           VALUE 'Q'.
  6953             88  ALIGNMENT-CHECK        VALUE 'A'.
  6954             88  SPOILED-CHECK          VALUE 'S'.
  6955             88  PAYMENT-ABORTED        VALUE 'X'.
  6956
  6957     12  CQ-CLAIM-MAST-CNTL.
  6958         16  CQ-CARRIER              PIC X.
  6959         16  CQ-CLAIM-NO             PIC X(7).
  6960         16  CQ-CERT-NO.
  6961             20  CQ-CERT-PRIME       PIC X(10).
  6962             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 132
* EL156.cbl
  6963         16  CQ-CLAIM-TYPE           PIC X.
  6964             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6965             88  CQ-AH-CLAIM            VALUE 'A'.
  6966         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6967             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6968             88  CQ-O-B-COVERAGE        VALUE '2'.
  6969             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6970
  6971     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6972     12  CQ-CHECK-NUMBER             PIC X(7).
  6973     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6974     12  CQ-PAYMENT-TYPE             PIC X.
  6975             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6976             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6977             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6978             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6979             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6980             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6981             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6982             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6983     12  CQ-VOID-INDICATOR           PIC X.
  6984             88  CHECK-IS-STOPPED          VALUE 'S'.
  6985             88  CHECK-IS-VOID             VALUE 'V'.
  6986     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6987     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6988     12  CQ-CHECK-BY-USER            PIC X(4).
  6989     12  CQ-PRE-NUMBERING-SW         PIC X.
  6990       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6991       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6992
  6993     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6994     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6995     12  CQ-LEDGER-FLAG              PIC X(01).
  6996     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6997     12  CQ-LAST-UPDATED-DT          PIC XX.
  6998     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6999     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7000
  7001     12  FILLER                      PIC X(04).
  7002
  7003******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 133
* EL156.cbl
  7005*    COPY ELCBENE.
  7006******************************************************************
  7007*                                                                *
  7008*                            ELCBENE.                            *
  7009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7010*                            VMOD=2.006                          *
  7011*                                                                *
  7012*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7013*                                                                *
  7014*   FILE TYPE = VSAM,KSDS                                        *
  7015*   RECORD SIZE = 500   RECFORM = FIX                            *
  7016*                                                                *
  7017*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7018*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7019*                                                                *
  7020*   LOG = YES                                                    *
  7021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7022*                                                                *
  7023*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7024******************************************************************
  7025
  7026 01  BENEFICIARY-MASTER.
  7027     12  BE-RECORD-ID                PIC XX.
  7028         88  VALID-BE-ID                VALUE 'BE'.
  7029
  7030     12  BE-CONTROL-PRIMARY.
  7031         16  BE-COMPANY-CD           PIC X.
  7032         16  BE-RECORD-TYPE          PIC X.
  7033             88  BENEFICIARY-RECORD  VALUE 'B'.
  7034             88  ADJUSTOR-RECORD     VALUE 'A'.
  7035         16  BE-BENEFICIARY          PIC X(10).
  7036     12  BE-CONTROL-BY-NAME.
  7037         16  BE-COMPANY-CD-A1        PIC X.
  7038         16  BE-RECORD-TYPE-A1       PIC X.
  7039         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7040         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7041
  7042     12  BE-LAST-MAINT-DT            PIC XX.
  7043     12  BE-LAST-MAINT-BY            PIC X(4).
  7044     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7045
  7046     12  BE-ADDRESS-DATA.
  7047         16  BE-MAIL-TO-NAME         PIC X(30).
  7048         16  BE-ADDRESS-LINE-1       PIC X(30).
  7049         16  BE-ADDRESS-LINE-2       PIC X(30).
  7050         16  BE-ADDRESS-LINE-3       PIC X(30).
  7051         16  BE-CITY-STATE.
  7052             20  BE-CITY             PIC X(28).
  7053             20  BE-STATE            PIC XX.
  7054         16  BE-ZIP-CODE.
  7055             20  BE-ZIP-PRIME.
  7056                 24  BE-ZIP-1ST      PIC X.
  7057                     88  BE-CANADIAN-POST-CODE
  7058                                         VALUE 'A' THRU 'Z'.
  7059                 24  FILLER          PIC X(4).
  7060             20  BE-ZIP-PLUS4        PIC X(4).
  7061         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7062             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 134
* EL156.cbl
  7063             20  BE-CAN-POSTAL-2     PIC XXX.
  7064             20  FILLER              PIC XXX.
  7065         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7066         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7067
  7068******************************************************************
  7069*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7070*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7071******************************************************************
  7072     12  BE-CARRIER                  PIC X.
  7073
  7074     12  BE-ADDRESS-DATA2.
  7075         16  BE-MAIL-TO-NAME2        PIC X(30).
  7076         16  BE-ADDRESS-LINE-12      PIC X(30).
  7077         16  BE-ADDRESS-LINE-22      PIC X(30).
  7078         16  BE-ADDRESS-LINE-32      PIC X(30).
  7079         16  BE-CITY-STATE2.
  7080             20  BE-CITY2            PIC X(28).
  7081             20  BE-STATE2           PIC XX.
  7082         16  BE-ZIP-CODE2.
  7083             20  BE-ZIP-PRIME2.
  7084                 24  BE-ZIP-1ST2     PIC X.
  7085                     88  BE-CANADIAN-POST-CODE2
  7086                                         VALUE 'A' THRU 'Z'.
  7087                 24  FILLER          PIC X(4).
  7088             20  BE-ZIP-PLUS42       PIC X(4).
  7089         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7090             20  BE-CAN-POSTAL-12    PIC XXX.
  7091             20  BE-CAN-POSTAL-22    PIC XXX.
  7092             20  FILLER              PIC XXX.
  7093         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7094         16  BE-BILLING-STMT-DATA.
  7095             20  BE-BSR              PIC X.
  7096                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7097                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7098             20  BE-BSR-FROM         PIC X(30).
  7099             20  BE-BSR-DEPT         PIC X(30).
  7100             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7101             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7102             20  BE-OUTPUT-TYPE      PIC X.
  7103                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7104                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7105
  7106     12  FILLER                      PIC X(28).
  7107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 135
* EL156.cbl
  7109*    COPY ELCARCH.
  7110******************************************************************
  7111*                                                                *
  7112*                            ELCARCH.                            *
  7113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7114*                            VMOD=2.007                          *
  7115*                                                                *
  7116*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7117*                                                                *
  7118*   FILE TYPE = VSAM,KSDS                                        *
  7119*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7120*                                                                *
  7121*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7122*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7123*                                                                *
  7124*   LOG = NO                                                     *
  7125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7126*                                                                *
  7127*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7128******************************************************************
  7129 01  LETTER-ARCHIVE.
  7130     12  LA-RECORD-ID                PIC XX.
  7131         88  VALID-LA-ID                VALUE 'LA'.
  7132
  7133     12  LA-CONTROL-PRIMARY.
  7134         16  LA-COMPANY-CD           PIC X.
  7135         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7136         16  LA-RECORD-TYPE          PIC X.
  7137             88  LA-HEADER-DATA         VALUE '1'.
  7138             88  LA-ADDRESS-DATA        VALUE '2'.
  7139             88  LA-TEXT-DATA           VALUE '3'.
  7140             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7141         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7142
  7143     12  LA-CONTROL-BY-TYPE.
  7144         16  LA-COMPANY-CD-A1        PIC X.
  7145         16  LA-RECORD-TYPE-A1       PIC X.
  7146         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7147         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7148
  7149     12  LA-TEXT-RECORD.
  7150         16  LA-SKIP-CONTROL         PIC XX.
  7151             88  NO-LINES-SKIPPED       VALUE SPACES.
  7152             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7153         16  LA-TEXT-LINE            PIC X(70).
  7154
  7155     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7156         16  FILLER                  PIC XX.
  7157         16  LA-ADDRESS-LINE         PIC X(30).
  7158         16  FILLER                  PIC X(40).
  7159
  7160     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7161         16  FILLER                  PIC XX.
  7162         16  LA-CARRIER              PIC X.
  7163         16  LA-CLAIM-NO             PIC X(7).
  7164         16  LA-CERT-NO.
  7165             20  LA-CERT-PRIME       PIC X(10).
  7166             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 136
* EL156.cbl
  7167         16  LA-NO-OF-COPIES         PIC S9.
  7168         16  LA-RESEND-DATE          PIC XX.
  7169         16  LA-PROCESSOR-CD         PIC X(4).
  7170         16  LA-CREATION-DT          PIC XX.
  7171         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7172         16  LA-RESEND-PRINT-DATE    PIC XX.
  7173         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7174         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7175*
  7176* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7177*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7178*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7179*   I        20  LA-DMD-RES-ST           PIC XX.
  7180*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7181*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7182*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7183*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7184*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7185*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7186*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7187*   I        20  LA-DMD-UND-CODE         PIC XX.
  7188*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7189*   V    16  FILLER                  PIC X(15).
  7190* -----
  7191*
  7192* REINSERTED  CSO  MODS
  7193*
  7194         16  FILLER.
  7195             20  FILLER                  PIC X(29).
  7196             20  LA-CSO-LETTER-STATUS    PIC X.
  7197                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7198                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7199                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7200             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7201             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7202*
  7203
  7204     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7205         16  FILLER                  PIC XX.
  7206         16  LA4-CARRIER             PIC X.
  7207         16  LA4-CLAIM-NO            PIC X(7).
  7208         16  LA4-CERT-NO.
  7209             20  LA4-CERT-PRIME      PIC X(10).
  7210             20  LA4-CERT-SFX        PIC X.
  7211         16  LA4-NO-OF-COPIES        PIC S9.
  7212         16  LA4-RESEND-DATE         PIC XX.
  7213         16  LA4-PROCESSOR-CD        PIC X(4).
  7214         16  LA4-CREATION-DT         PIC XX.
  7215         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7216         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7217         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7218         16  LA4-FORM-TYPE           PIC X.
  7219             88  LA4-INITIAL-FORM    VALUE '1'.
  7220             88  LA4-PROGRESS-FORM   VALUE '2'.
  7221         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7222         16  LA4-STATE               PIC X(02).
  7223         16  FILLER                  PIC X(31).
  7224******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 137
* EL156.cbl
  7226*    COPY ELCDAR.
  7227******************************************************************
  7228*                                                                *
  7229*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7230*   FILE TYPE = VSAM,KSDS                                        *
  7231*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7232*   BASE CLUSTER = DLYACTV                                       *
  7233*   LOG = YES                                                    *
  7234*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7235*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7236*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7237*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7238*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7239*               BY PROGRAM "LGINFCE".                            *
  7240*                                                                *
  7241******************************************************************
  7242 01  DAILY-ACTIVITY-RECORD.
  7243     05  DA-KEY.
  7244         10  DA-COMP-CD          PIC X.
  7245         10  DA-CARRIER          PIC X.
  7246         10  DA-CLAIM-NO         PIC X(7).
  7247         10  DA-CERT-NO.
  7248             15  DA-CERT-PRIME   PIC X(10).
  7249             15  DA-CERT-SFX     PIC X.
  7250     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7251     05  DA-RECORD-TYPE          PIC X.
  7252     05  FILLER                  PIC X(2).
  7253******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 138
* EL156.cbl
  7255*    COPY ERCCOMP.
  7256******************************************************************
  7257*                                                                *
  7258*                                                                *
  7259*                            ERCCOMP                             *
  7260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7261*                            VMOD=2.019                          *
  7262*                                                                *
  7263*   ONLINE CREDIT SYSTEM                                         *
  7264*                                                                *
  7265*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7266*                                                                *
  7267*   FILE TYPE = VSAM,KSDS                                        *
  7268*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7269*                                                                *
  7270*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7271*       ALTERNATE PATH = NONE                                    *
  7272*                                                                *
  7273*   LOG = NO                                                     *
  7274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7275*                                                                *
  7276******************************************************************
  7277*                   C H A N G E   L O G
  7278*
  7279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7280*-----------------------------------------------------------------
  7281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7282* EFFECTIVE    NUMBER
  7283*-----------------------------------------------------------------
  7284* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7285* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7286* 092205    2005050300006  PEMA  ADD LEASE FEE
  7287* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7288* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7289* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7290* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7291* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7292* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7293******************************************************************
  7294
  7295 01  COMPENSATION-MASTER.
  7296     12  CO-RECORD-ID                          PIC XX.
  7297         88  VALID-CO-ID                          VALUE 'CO'.
  7298
  7299     12  CO-CONTROL-PRIMARY.
  7300         16  CO-COMPANY-CD                     PIC X.
  7301         16  CO-CONTROL.
  7302             20  CO-CTL-1.
  7303                 24  CO-CARR-GROUP.
  7304                     28  CO-CARRIER            PIC X.
  7305                     28  CO-GROUPING.
  7306                         32  CO-GROUP-PREFIX   PIC XXX.
  7307                         32  CO-GROUP-PRIME    PIC XXX.
  7308                 24  CO-RESP-NO.
  7309                     28  CO-RESP-PREFIX        PIC X(4).
  7310                     28  CO-RESP-PRIME         PIC X(6).
  7311             20  CO-CTL-2.
  7312                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 139
* EL156.cbl
  7313                     28  CO-ACCT-PREFIX        PIC X(4).
  7314                     28  CO-ACCT-PRIME         PIC X(6).
  7315         16  CO-TYPE                           PIC X.
  7316             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7317             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7318             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7319
  7320     12  CO-MAINT-INFORMATION.
  7321         16  CO-LAST-MAINT-DT                  PIC XX.
  7322         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7323         16  CO-LAST-MAINT-USER                PIC X(4).
  7324     12  FILLER                                PIC XX.
  7325     12  CO-STMT-TYPE                          PIC XXX.
  7326     12  CO-COMP-TYPE                          PIC X.
  7327         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7328     12  CO-STMT-OWNER                         PIC X(4).
  7329     12  CO-BALANCE-CONTROL                    PIC X.
  7330         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7331         88  CO-NO-BALANCE                        VALUE 'N'.
  7332
  7333     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7334         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7335         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7336         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7337
  7338     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7339         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7340         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7341
  7342     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7343     12  CO-GA-DIRECT-DEP                      PIC X.
  7344     12  CO-FUTURE-SPACE                       PIC X.
  7345         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7346
  7347     12  CO-ACCT-NAME                          PIC X(30).
  7348     12  CO-MAIL-NAME                          PIC X(30).
  7349     12  CO-ADDR-1                             PIC X(30).
  7350     12  CO-ADDR-2                             PIC X(30).
  7351     12  CO-ADDR-3.
  7352         16  CO-ADDR-CITY                      PIC X(27).
  7353         16  CO-ADDR-STATE                     PIC XX.
  7354     12  CO-CSO-1099                           PIC X.
  7355     12  CO-ZIP.
  7356         16  CO-ZIP-PRIME.
  7357             20  CO-ZIP-PRI-1ST                PIC X.
  7358                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7359             20  FILLER                        PIC X(4).
  7360         16  CO-ZIP-PLUS4                      PIC X(4).
  7361     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7362         16  CO-CAN-POSTAL-1                   PIC XXX.
  7363         16  CO-CAN-POSTAL-2                   PIC XXX.
  7364         16  FILLER                            PIC XXX.
  7365     12  CO-SOC-SEC                            PIC X(13).
  7366     12  CO-TELEPHONE.
  7367         16  CO-AREA-CODE                      PIC XXX.
  7368         16  CO-PREFIX                         PIC XXX.
  7369         16  CO-PHONE                          PIC X(4).
  7370
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 140
* EL156.cbl
  7371     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7372
  7373     12  CO-AR-BAL-LEVEL                       PIC X.
  7374         88  CO-AR-REF-LVL                        VALUE '1'.
  7375         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7376         88  CO-AR-BILL-LVL                       VALUE '2'.
  7377         88  CO-AR-AGT-LVL                        VALUE '3'.
  7378         88  CO-AR-FR-LVL                         VALUE '4'.
  7379
  7380     12  CO-AR-NORMAL-PRINT                    PIC X.
  7381         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7382         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7383
  7384     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7385
  7386     12  CO-AR-REPORTING                       PIC X.
  7387         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7388         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7389
  7390     12  CO-AR-PULL-CHECK                      PIC X.
  7391         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7392         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7393
  7394     12  CO-AR-BALANCE-PRINT                   PIC X.
  7395         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7396
  7397     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7398         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7399         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7400         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7401
  7402     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7403
  7404     12  CO-USER-CODE                          PIC X.
  7405     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7406
  7407******************************************************************
  7408*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7409*    THE LAST MONTH END RUN.
  7410******************************************************************
  7411
  7412     12  CO-LAST-ACTIVITY-DATE.
  7413         16  CO-ACT-YEAR                       PIC 99.
  7414         16  CO-ACT-MONTH                      PIC 99.
  7415         16  CO-ACT-DAY                        PIC 99.
  7416
  7417     12  CO-LAST-STMT-DT.
  7418         16  CO-LAST-STMT-YEAR                 PIC 99.
  7419         16  CO-LAST-STMT-MONTH                PIC 99.
  7420         16  CO-LAST-STMT-DAY                  PIC 99.
  7421
  7422     12  CO-MO-END-TOTALS.
  7423         16  CO-MONTHLY-TOTALS.
  7424             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7425             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7426             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7427             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7428             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 141
* EL156.cbl
  7429
  7430         16  CO-AGING-TOTALS.
  7431             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7432             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7433             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7434             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7435
  7436         16  CO-YTD-TOTALS.
  7437             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7438             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7439
  7440         16  CO-OVER-UNDER-TOTALS.
  7441             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7442             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7443
  7444     12  CO-MISCELLANEOUS-TOTALS.
  7445         16  CO-FICA-TOTALS.
  7446             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7447             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7448
  7449         16  CO-CLAIM-TOTALS.
  7450             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7451             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7452
  7453******************************************************************
  7454*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7455*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7456******************************************************************
  7457
  7458     12  CO-CURRENT-TOTALS.
  7459         16  CO-CURRENT-LAST-STMT-DT.
  7460             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7461             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7462             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7463
  7464         16  CO-CURRENT-MONTHLY-TOTALS.
  7465             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7466             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7467             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7468             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7469             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7470
  7471         16  CO-CURRENT-AGING-TOTALS.
  7472             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7473             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7474             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7475             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7476
  7477         16  CO-CURRENT-YTD-TOTALS.
  7478             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7479             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7480
  7481     12  CO-PAID-COMM-TOTALS.
  7482         16  CO-YTD-PAID-COMMS.
  7483             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7484             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7485
  7486     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 142
* EL156.cbl
  7487         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7488         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7489
  7490     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7491         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7492         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7493         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7494         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7495         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7496         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7497         88  CO-FINAL-LETTER                  VALUE 'F'.
  7498         88  CO-RECONCILING                   VALUE 'R'.
  7499         88  CO-PHONE-CALL                    VALUE 'P'.
  7500         88  CO-LEGAL                         VALUE 'L'.
  7501         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7502         88  CO-WRITE-OFF                     VALUE 'W'.
  7503         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7504
  7505     12  CO-CSR-CODE                       PIC X(4).
  7506
  7507     12  CO-GA-STATUS-INFO.
  7508         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7509         16  CO-GA-TERMINATION-DT          PIC XX.
  7510         16  CO-GA-STATUS-CODE             PIC X.
  7511             88  CO-GA-ACTIVE                 VALUE 'A'.
  7512             88  CO-GA-INACTIVE               VALUE 'I'.
  7513             88  CO-GA-PENDING                VALUE 'P'.
  7514         16  CO-GA-COMMENTS.
  7515             20  CO-GA-COMMENT-1           PIC X(40).
  7516             20  CO-GA-COMMENT-2           PIC X(40).
  7517             20  CO-GA-COMMENT-3           PIC X(40).
  7518             20  CO-GA-COMMENT-4           PIC X(40).
  7519
  7520     12  CO-RPTCD2                         PIC X(10).
  7521     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7522         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7523         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7524
  7525     12  CO-TYPE-AGENT                     PIC X(01).
  7526         88  CO-CORPORATION                   VALUE 'C'.
  7527         88  CO-PARTNERSHIP                   VALUE 'P'.
  7528         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7529         88  CO-TRUST                         VALUE 'T'.
  7530         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7531
  7532     12  CO-FAXNO.
  7533         16  CO-FAX-AREA-CODE                  PIC XXX.
  7534         16  CO-FAX-PREFIX                     PIC XXX.
  7535         16  CO-FAX-PHONE                      PIC X(4).
  7536
  7537     12  CO-BANK-INFORMATION.
  7538         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7539         16  CO-BANK-TRANSIT-NON REDEFINES
  7540             CO-BANK-TRANSIT-NO                PIC 9(8).
  7541
  7542         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7543     12  CO-MISC-DEDUCT-INFO REDEFINES
  7544                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 143
* EL156.cbl
  7545         16  CO-MD-GL-ACCT                     PIC X(10).
  7546         16  CO-MD-DIV                         PIC XX.
  7547         16  CO-MD-CENTER                      PIC X(4).
  7548         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7549         16  CO-CREATE-AP-CHECK                PIC X.
  7550         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7551         16  FILLER                            PIC XXX.
  7552     12  CO-ACH-STATUS                         PIC X.
  7553         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7554         88  CO-ACH-PENDING                        VALUE 'P'.
  7555
  7556     12  CO-BILL-SW                            PIC X.
  7557     12  CO-CONTROL-NAME                       PIC X(30).
  7558     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7559     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7560     12  CO-CLP-STATE                          PIC XX.
  7561     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7562     12  CO-SPP-REFUND-EDIT                    PIC X.
  7563
  7564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 144
* EL156.cbl
  7566*    COPY ERCDMDNT.
  7567******************************************************************
  7568*                                                                *
  7569*                            ERCDMDNT                            *
  7570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7571*                            VMOD=2.005                          *
  7572*                                                                *
  7573*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7574*                                                                *
  7575*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7576*                                                                *
  7577*        FILE TYPE= VSAM,KSDS                                    *
  7578*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7579*                                                                *
  7580*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7581*                                                                *
  7582*        LOG = YES                                               *
  7583*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7584*                                                                *
  7585******************************************************************
  7586
  7587 01  CERTIFICATE-NOTE.
  7588     12  CN-RECORD-ID                     PIC  XX.
  7589         88  VALID-CN-ID                      VALUE 'CN'.
  7590
  7591     12  CN-CONTROL-PRIMARY.
  7592         16  CN-COMPANY-CD                PIC X.
  7593         16  CN-CERT-KEY.
  7594             20  CN-CARRIER               PIC X.
  7595             20  CN-GROUPING.
  7596                 24  CN-GROUPING-PREFIX   PIC XXX.
  7597                 24  CN-GROUPING-PRIME    PIC XXX.
  7598             20  CN-STATE                 PIC XX.
  7599             20  CN-ACCOUNT.
  7600                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7601                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7602             20  CN-CERT-EFF-DT           PIC XX.
  7603             20  CN-CERT-NO.
  7604                 24  CN-CERT-PRIME        PIC X(10).
  7605                 24  CN-CERT-SFX          PIC X.
  7606
  7607     12  CN-BILLING-START-LINE-NO         PIC 99.
  7608     12  CN-BILLING-END-LINE-NO           PIC 99.
  7609
  7610     12  CN-LINES.
  7611         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7612
  7613     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7614         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7615         16  CN-CSI-GENERAL-DATA-AREA.
  7616             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7617
  7618         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7619             CN-CSI-GENERAL-DATA-AREA.
  7620             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7621             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7622             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7623             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 145
* EL156.cbl
  7624             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7625             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7626             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7627             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7628             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7629             20  FILLER                       PIC XX.
  7630             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7631             20  FILLER                       PIC X(38).
  7632
  7633         16  CN-CSI-PRODUCT-DATA-AREA.
  7634             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7635
  7636         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7637             CN-CSI-PRODUCT-DATA-AREA.
  7638             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7639             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7640             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7641             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7642             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7643             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7644             20  FILLER                   PIC XX.
  7645             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7646             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7647             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7648             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7649             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7650             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7651             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7652             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7653             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7654             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7655             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7656             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7657             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7658             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7659             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7660             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7661             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7662             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7663             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7664             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7665             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7666             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7667             20  FILLER                   PIC X(25).
  7668
  7669         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7670             CN-CSI-CREDIT-CARD-DATA.
  7671             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7672             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7673             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7674             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7675             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7676             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7677             20  FILLER                   PIC XX.
  7678             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7679             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7680             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7681             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 146
* EL156.cbl
  7682             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7683             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7684             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7685             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7686             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7687             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7688             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7689             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7690             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7691             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7692             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7693             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7694             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7695             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7696             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7697             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7698             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7699             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7700             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7701             20  FILLER                   PIC X(17).
  7702
  7703         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7704             CN-CSI-FAMILY-LEAVE-DATA.
  7705             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7706             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7707             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7708             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7709             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7710             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7711             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7712             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7713             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7714             20  CN-CSI-SL-INT-ON-PROCEEDS
  7715                                          PIC S9(5)V99  COMP-3.
  7716             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7717             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7718             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7719             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7720             20  CN-CSI-SL-POLICY-BENEFITS
  7721                                          PIC S9(5)V99  COMP-3.
  7722             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7723             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7724             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7725             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7726             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7727             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7728             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7729             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7730             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7731             20  CN-CSI-SL-STATE-NOT      PIC X.
  7732             20  FILLER                   PIC XX.
  7733
  7734         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7735             CN-CSI-SENIOR-LIFE-DATA.
  7736             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7737             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7738             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7739                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 147
* EL156.cbl
  7740             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7741             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7742             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7743             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7744             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7745             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7746             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7747             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7748             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7749             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7750             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7751             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7752             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7753             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7754             20  CN-CSI-PP-REPAIR         PIC X.
  7755             20  CN-CSI-PP-REPLACE        PIC X.
  7756             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7757             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7758             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7759             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7760             20  FILLER                   PIC X(5).
  7761
  7762         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7763             CN-CSI-PURCH-PROP-DATA.
  7764             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7765             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7766             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7767             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7768             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7769             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7770             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7771             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7772             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7773             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7774             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7775             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7776             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7777             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7778             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7779             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7780             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7781             20  CN-CSI-EW-REPLACE        PIC X.
  7782             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7783             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7784             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7785             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7786             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7787             20  FILLER                   PIC X(4).
  7788
  7789     12  CN-LAST-MAINT-DT                 PIC XX.
  7790     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7791     12  CN-LAST-MAINT-USER               PIC X(4).
  7792     12  FILLER                           PIC X(6).
  7793
  7794******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 148
* EL156.cbl
  7796*    COPY ERCCNOT.
  7797******************************************************************
  7798*                                                                *
  7799*                            ERCCNOT                             *
  7800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7801*                            VMOD=2.003                          *
  7802*                                                                *
  7803*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7804*                                                                *
  7805*        FILE TYPE= VSAM,KSDS                                    *
  7806*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7807*                                                                *
  7808*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7809*                                                                *
  7810*        LOG = YES                                               *
  7811*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7812*                                                                *
  7813******************************************************************
  7814*                   C H A N G E   L O G
  7815*
  7816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7817*-----------------------------------------------------------------
  7818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7819* EFFECTIVE    NUMBER
  7820*-----------------------------------------------------------------
  7821* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7822******************************************************************
  7823
  7824 01  CERT-NOTE-FILE.
  7825     12  CZ-RECORD-ID                PIC  XX.
  7826         88  VALID-CZ-ID                  VALUE 'CZ'.
  7827
  7828     12  CZ-CONTROL-PRIMARY.
  7829         16  CZ-COMPANY-CD           PIC X.
  7830         16  CZ-CARRIER              PIC X.
  7831         16  CZ-GROUPING.
  7832             20 CZ-GROUPING-PREFIX   PIC XXX.
  7833             20 CZ-GROUPING-PRIME    PIC XXX.
  7834         16  CZ-STATE                PIC XX.
  7835         16  CZ-ACCOUNT.
  7836             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7837             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7838         16  CZ-CERT-EFF-DT          PIC XX.
  7839         16  CZ-CERT-NO.
  7840             20  CZ-CERT-PRIME       PIC X(10).
  7841             20  CZ-CERT-SFX         PIC X.
  7842         16  CZ-RECORD-TYPE          PIC X.
  7843             88  CERT-NOTE           VALUE '1'.
  7844             88  CLAIM-CERT-NOTE     VALUE '2'.
  7845         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7846
  7847     12  CZ-LAST-MAINT-DT            PIC XX.
  7848     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7849     12  CZ-LAST-MAINT-USER          PIC X(4).
  7850
  7851     12  CZ-NOTE-INFORMATION.
  7852         16  CZ-NOTE                 PIC X(63).
  7853         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 149
* EL156.cbl
  7854******************************************************************
  7855*                            COPY ERCPDEF.
  7856******************************************************************
  7857*                                                                *
  7858*                                                                *
  7859*                            ERCPDEF.                            *
  7860*                                                                *
  7861*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7862*                                                                *
  7863*    FILE TYPE = VSAM,KSDS                                       *
  7864*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7865*                                                                *
  7866*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7867*                                                                *
  7868*    LOG = YES                                                   *
  7869*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7870******************************************************************
  7871 01  PRODUCT-MASTER.
  7872    12  PD-RECORD-ID                 PIC X(02).
  7873        88  VALID-PD-ID                  VALUE 'PD'.
  7874    12  PD-CONTROL-PRIMARY.
  7875        16  PD-COMPANY-CD            PIC X.
  7876        16  PD-STATE                 PIC XX.
  7877        16  PD-PRODUCT-CD            PIC XXX.
  7878        16  PD-FILLER                PIC X(7).
  7879        16  PD-BEN-TYPE              PIC X.
  7880        16  PD-BEN-CODE              PIC XX.
  7881        16  PD-PROD-EXP-DT           PIC XX.
  7882    12  FILLER                       PIC X(50).
  7883    12  PD-PRODUCT-DATA OCCURS 8.
  7884        16  PD-PROD-CODE             PIC X.
  7885            88  PD-PROD-LIFE           VALUE 'L'.
  7886            88  PD-PROD-PROP           VALUE 'P'.
  7887            88  PD-PROD-AH             VALUE 'A'.
  7888            88  PD-PROD-IU             VALUE 'I'.
  7889            88  PD-PROD-GAP            VALUE 'G'.
  7890        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7891        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7892        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7893        16  PD-MAX-TERM              PIC S999        COMP-3.
  7894        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7895        16  FILLER                   PIC X.
  7896        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7897        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7898        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7899        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7900        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7901        16  PD-REC-CRIT-PERIOD       PIC X.
  7902        16  PD-RTW-MOS               PIC 99.
  7903        16  FILLER                   PIC X(5).
  7904    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7905    12  PD-TERM-LIMITS OCCURS 15.
  7906        16  PD-LOW-TERM              PIC S999        COMP-3.
  7907        16  PD-HI-TERM               PIC S999        COMP-3.
  7908*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7909    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7910        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7911        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 150
* EL156.cbl
  7912    12  PD-EARN-FACTORS.
  7913        16  FILLER OCCURS 15.
  7914            20  FILLER OCCURS 15.
  7915                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7916    12  PD-PRODUCT-DESC              PIC X(80).
  7917    12  PD-TRUNCATED                 PIC X.
  7918    12  FILLER                       PIC X(59).
  7919    12  PD-MAINT-INFORMATION.
  7920        16  PD-LAST-MAINT-DT         PIC X(02).
  7921        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7922        16  PD-LAST-MAINT-BY         PIC X(04).
  7923*                            COPY ELCCRTT.
  7924******************************************************************
  7925*                                                                *
  7926*                            ELCCRTT.                            *
  7927*                                                                *
  7928*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7929*                                                                *
  7930*   FILE TYPE = VSAM,KSDS                                        *
  7931*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7932*                                                                *
  7933*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7934*                                                                *
  7935*   LOG = YES                                                    *
  7936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7937******************************************************************
  7938*                   C H A N G E   L O G
  7939*
  7940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7941*-----------------------------------------------------------------
  7942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7943* EFFECTIVE    NUMBER
  7944*-----------------------------------------------------------------
  7945* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7946* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7947* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7948* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7949* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7950******************************************************************
  7951
  7952 01  CERTIFICATE-TRAILERS.
  7953     12  CS-RECORD-ID                      PIC XX.
  7954         88  VALID-CS-ID                      VALUE 'CS'.
  7955
  7956     12  CS-CONTROL-PRIMARY.
  7957         16  CS-COMPANY-CD                 PIC X.
  7958         16  CS-CARRIER                    PIC X.
  7959         16  CS-GROUPING                   PIC X(6).
  7960         16  CS-STATE                      PIC XX.
  7961         16  CS-ACCOUNT                    PIC X(10).
  7962         16  CS-CERT-EFF-DT                PIC XX.
  7963         16  CS-CERT-NO.
  7964             20  CS-CERT-PRIME             PIC X(10).
  7965             20  CS-CERT-SFX               PIC X.
  7966         16  CS-TRAILER-TYPE               PIC X.
  7967             88  COMM-TRLR           VALUE 'A'.
  7968             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7969             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 151
* EL156.cbl
  7970
  7971     12  CS-DATA-AREA                      PIC X(516).
  7972
  7973     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7974         16  CS-BANK-COMMISSION-AREA.
  7975             20  CS-BANK-COMMS       OCCURS 10.
  7976                 24  CS-AGT                PIC X(10).
  7977                 24  CS-COM-TYP            PIC X.
  7978                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7979                 24  CS-RECALC-LV-INDIC    PIC X.
  7980                 24  FILLER                PIC X(10).
  7981         16  FILLER                        PIC X(256).
  7982
  7983     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7984****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7985****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7986         16  CS-MB-CLAIM-DATA OCCURS 2.
  7987             20  FILLER OCCURS 10.
  7988                 24  CS-CLAIM-TYPE         PIC X.
  7989                     88  CS-AH-CLM           VALUE 'A'.
  7990                     88  CS-IU-CLM           VALUE 'I'.
  7991                     88  CS-GP-CLM           VALUE 'G'.
  7992                     88  CS-LF-CLM           VALUE 'L'.
  7993                     88  CS-PR-CLM           VALUE 'P'.
  7994                 24  CS-BANK               PIC S999 COMP-3.
  7995                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7996                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7997                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7998         16  FILLER                        PIC X(216).
  7999     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8000         16  CS-VIN-NUMBER                 PIC X(17).
  8001         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8002         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8003         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8004         16  FILLER                        PIC X(496).
  8005******************************************************************
  8006 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8007                          CONTROL-FILE CERTIFICATE-MASTER
  8008                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8009                          ACCOUNT-MASTER CHECK-QUE
  8010                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8011                          DAILY-ACTIVITY-RECORD
  8012                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8013                          CERT-NOTE-FILE PRODUCT-MASTER
  8014                          CERTIFICATE-TRAILERS.
  8015 0000-DFHEXIT SECTION.
  8016     MOVE '9#                    $   ' TO DFHEIV0.
  8017     MOVE 'EL156' TO DFHEIV1.
  8018     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8019
  8020     IF EIBCALEN = 0
  8021         GO TO 8800-UNAUTHORIZED-ACCESS.
  8022
  8023     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8024     MOVE EIBTRMID               TO QID-TERM.
  8025     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8026     MOVE '2'                    TO EMI-SWITCH2.
  8027     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 152
* EL156.cbl
  8028     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8029
  8030     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8031     MOVE '5'                    TO DC-OPTION-CODE.
  8032     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8033     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8034                                    SAVE-BIN-DATE.
  8035     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8036     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8037
  8038     IF SAVE-DATE-YY > 70
  8039         MOVE 19                 TO SAVE-DATE-CC
  8040     ELSE
  8041         MOVE 20                 TO SAVE-DATE-CC.
  8042
  8043     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8044         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8045     END-IF.
  8046
  8047     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8048        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8049     ELSE
  8050        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8051     END-IF
  8052
  8053     IF PI-PRINT-CLM-FRM-YN = 'N'
  8054         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8055     ELSE
  8056         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8057     END-IF
  8058
  8059     IF PI-PRINT-SURVEY-YN = 'N'
  8060         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8061     ELSE
  8062         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8063     END-IF
  8064
  8065     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8066         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8067     ELSE
  8068         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8069     END-IF
  8070
  8071* EXEC CICS HANDLE CONDITION
  8072*        NOTOPEN   (9990-ABEND)
  8073*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8074*        MAPFAIL   (0400-FIRST-TIME)
  8075*        DUPREC    (6180-DUPREC)
  8076*        ERROR     (9990-ABEND)
  8077*    END-EXEC.
  8078*    MOVE '"$JL?%.               ! " #00008066' TO DFHEIV0
  8079     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8081     MOVE X'2220233030303038303636' TO DFHEIV0(25:11)
  8082     CALL 'kxdfhei1' USING DFHEIV0
  8083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8084
  8085
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 153
* EL156.cbl
  8086     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8087         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8088
  8089     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8090         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8091             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8092             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8093             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8094             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8095             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8096             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8097             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8098             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8099             MOVE LOW-VALUES           TO EL156AI
  8100             MOVE 'Y'                  TO FIRST-ENTRY
  8101         ELSE
  8102             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8103             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8104             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8105             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8106             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8107             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8108             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8109             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8110
  8111     IF RETURNED-FROM NOT = SPACES
  8112        IF (RETURNED-FROM = 'EL614')
  8113           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8114           IF WS-SAVED-EOB-CODES NOT = SPACES
  8115              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8116           ELSE
  8117              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8118           END-IF
  8119        END-IF
  8120         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8121            MOVE 'Y'             TO FIRST-ENTRY
  8122            IF RETURNED-FROM = 'EL614'
  8123               AND (PI-PASS-SW NOT = 'C')
  8124               IF WS-SAVED-EOB-CODES NOT = SPACES
  8125                  MOVE WS-SAVED-EOB-CODES
  8126                                 TO PI-PMTNOTE2
  8127                                    WS-PMTNOTE2
  8128                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8129               ELSE
  8130                  MOVE SPACES    TO PI-PMTNOTE2
  8131                                    WS-PMTNOTE2
  8132                                    PI-EOB-CODES-EXIST
  8133               END-IF
  8134            END-IF
  8135            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8136            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8137            IF RETURNED-FROM = 'EL614'
  8138               GO TO 1000-EDIT-DATA
  8139            END-IF
  8140            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8141               (PAYEEI   = LOW-VALUES OR SPACES)
  8142               GO TO 8100-SEND-INITIAL-MAP
  8143            ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 154
* EL156.cbl
  8144               GO TO 1000-EDIT-DATA.
  8145
  8146     IF EIBTRNID NOT = TRANS-ID
  8147         GO TO 0400-FIRST-TIME.
  8148
  8149     IF EIBAID = DFHCLEAR
  8150        IF PI-PASS-SW = 'C'
  8151           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8152           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8153           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8154           MOVE 'Y'            TO RETURNED-FROM-B
  8155           GO TO 1000-EDIT-DATA
  8156        ELSE
  8157           GO TO 9400-CLEAR.
  8158
  8159     IF PI-PASS-SW = 'C'
  8160         MOVE MAP-NAMEB          TO MAP-NAME
  8161         IF EIBAID = DFHPF1 OR DFHPF13
  8162             GO TO 5000-UPDATE
  8163           ELSE
  8164             IF EIBAID NOT = DFHENTER
  8165                 MOVE LOW-VALUES TO EL156BI
  8166                 MOVE MAP-NAMEB  TO MAP-NAME
  8167                 MOVE ER-0029    TO EMI-ERROR
  8168                 MOVE -1         TO  ENTPFBL
  8169                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170                 GO TO 8200-SEND-DATAONLY.
  8171
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 155
* EL156.cbl
  8173 0200-RECEIVE.
  8174     MOVE LOW-VALUES             TO EL156AI.
  8175     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8176         MOVE ER-0008            TO EMI-ERROR
  8177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8178         IF PI-PASS-SW = 'C'
  8179             MOVE -1             TO ENTPFBL
  8180             GO TO 8200-SEND-DATAONLY
  8181         ELSE
  8182             MOVE -1             TO PMTTYPEL
  8183             GO TO 8200-SEND-DATAONLY.
  8184
  8185     IF PI-COMPANY-ID = 'DMD'
  8186         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8187
  8188     IF PI-PASS-SW = 'C'
  8189         MOVE MAP-NAMEB          TO MAP-NAME.
  8190
  8191
  8192* EXEC CICS RECEIVE
  8193*        MAP   (MAP-NAME)
  8194*        MAPSET(MAPSET-NAME)
  8195*        ASIS
  8196*        INTO  (EL156AI)
  8197*    END-EXEC.
  8198     MOVE LENGTH OF
  8199      EL156AI
  8200       TO DFHEIV11
  8201*    MOVE '8"TAI  L              ''   #00008179' TO DFHEIV0
  8202     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303038313739' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           MAP-NAME,
  8207           EL156AI,
  8208           DFHEIV11,
  8209           MAPSET-NAME,
  8210           DFHEIV99,
  8211           DFHEIV99
  8212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8213
  8214
  8215     IF PI-PASS-SW NOT = 'C'
  8216         GO TO 0250-MAPA.
  8217
  8218     IF ENTPFBL NOT > ZERO
  8219         MOVE MAP-NAMEB          TO MAP-NAME
  8220         MOVE ER-0029            TO EMI-ERROR
  8221         MOVE -1                 TO  ENTPFBL
  8222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8223         GO TO 8200-SEND-DATAONLY.
  8224
  8225     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8226         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8227       ELSE
  8228         MOVE MAP-NAMEB           TO MAP-NAME
  8229         MOVE ER-0029             TO EMI-ERROR
  8230         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 156
* EL156.cbl
  8231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8232         GO TO 8200-SEND-DATAONLY.
  8233
  8234     IF EIBAID = DFHPF1 OR DFHPF13
  8235         IF MODIFY-CAP
  8236            GO TO 5000-UPDATE
  8237          ELSE
  8238            MOVE 'UPDATE'           TO SM-READ
  8239            PERFORM 9995-SECURITY-VIOLATION
  8240            MOVE MAP-NAMEB          TO MAP-NAME
  8241            MOVE ER-0070            TO EMI-ERROR
  8242            MOVE -1                 TO  ENTPFBL
  8243            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8244            GO TO 8200-SEND-DATAONLY.
  8245
  8246 0250-MAPA.
  8247     IF ENTERPFL = 0
  8248         GO TO 0300-CHECK-PFKEYS.
  8249
  8250     IF EIBAID NOT = DFHENTER
  8251         MOVE ER-0004            TO EMI-ERROR
  8252         GO TO 0320-INPUT-ERROR.
  8253
  8254     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8255         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8256     ELSE
  8257         MOVE ER-0029            TO EMI-ERROR
  8258         GO TO 0320-INPUT-ERROR.
  8259
  8260 0300-CHECK-PFKEYS.
  8261     IF EIBAID = DFHPF7 OR DFHPF8
  8262         GO TO 8820-PF7-8.
  8263
  8264     IF EIBAID = DFHPF23
  8265         GO TO 8810-PF23.
  8266
  8267     IF EIBAID = DFHPF24
  8268         GO TO 9200-RETURN-MAIN-MENU.
  8269
  8270     IF EIBAID = DFHPF12
  8271         GO TO 9500-PF12.
  8272
  8273     IF EIBAID = DFHPF1
  8274        IF PI-PASS-SW = 'A' OR 'B'
  8275          GO TO 0330-BROWSE-FORWARD.
  8276
  8277     IF EIBAID = DFHPF2
  8278        IF PI-PASS-SW = 'A' OR 'B'
  8279          GO TO 0350-BROWSE-BACKWARD.
  8280
  8281     IF EIBAID = DFHPF6
  8282        IF PI-EOB-CODES-EXIST = 'Y'
  8283           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8284        ELSE
  8285           MOVE SPACES              TO WS-PMTNOTE2
  8286        END-IF
  8287         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8288         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 157
* EL156.cbl
  8289            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8290         END-IF
  8291         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8292         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8293             MOVE 'EL614'        TO PGM-NAME
  8294             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8295             GO TO 9300-XCTL
  8296         ELSE
  8297             MOVE XCTL-157       TO PGM-NAME
  8298             GO TO 9300-XCTL.
  8299
  8300     IF EIBAID = DFHPF9
  8301        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8302        MOVE XCTL-141            TO PGM-NAME
  8303        GO TO 9300-XCTL.
  8304
  8305     IF EIBAID = DFHPF10
  8306        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8307        MOVE XCTL-155            TO PGM-NAME
  8308        GO TO 9300-XCTL.
  8309
  8310     MOVE SPACES                 TO ERRMSG0O
  8311                                    ERRMSG1O
  8312                                    ERRMSG2O.
  8313
  8314     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8315         IF PI-PASS-SW NOT = 'B'
  8316             MOVE ER-0422        TO EMI-ERROR
  8317             GO TO 0320-INPUT-ERROR
  8318           ELSE
  8319             GO TO 0700-TEST-FOR-CHANGES.
  8320
  8321     IF EIBAID = DFHPF11
  8322        IF PI-PASS-SW = 'C'
  8323           MOVE ER-0029          TO EMI-ERROR
  8324           GO TO 0320-INPUT-ERROR.
  8325
  8326     IF EIBAID = DFHENTER OR DFHPF11
  8327        NEXT SENTENCE
  8328     ELSE
  8329        MOVE ER-0029             TO EMI-ERROR
  8330        GO TO 0320-INPUT-ERROR.
  8331
  8332     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8333
  8334     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8335         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8336         GO TO 1000-EDIT-DATA
  8337     ELSE
  8338         IF PI-FATAL-COUNT NOT = 0 OR
  8339            PI-FORCE-COUNT NOT = 0
  8340             GO TO 1000-EDIT-DATA
  8341         ELSE
  8342             GO TO 2000-EDIT-DONE.
  8343
  8344 0320-INPUT-ERROR.
  8345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8346
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 158
* EL156.cbl
  8347     IF ENTERPFL = 0
  8348         MOVE -1                 TO PMTTYPEL
  8349     ELSE
  8350         MOVE AL-UNBON           TO ENTERPFA
  8351         MOVE -1                 TO ENTERPFL.
  8352
  8353     GO TO 8200-SEND-DATAONLY.
  8354
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 159
* EL156.cbl
  8356 0330-BROWSE-FORWARD.
  8357
  8358     MOVE CLMNOI            TO PI-CLAIM-NO.
  8359     MOVE CARRI             TO PI-CARRIER.
  8360     MOVE CERTNOI           TO PI-CERT-PRIME.
  8361     MOVE SUFXI             TO PI-CERT-SFX.
  8362
  8363     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8364     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8365     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8366     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8367
  8368     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8369
  8370
  8371* EXEC CICS HANDLE CONDITION
  8372*         NOTFND   (0380-CLAIM-END-FILE)
  8373*         ENDFILE  (0380-CLAIM-END-FILE)
  8374*    END-EXEC.
  8375*    MOVE '"$I''                  ! # #00008341' TO DFHEIV0
  8376     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8378     MOVE X'2320233030303038333431' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383
  8384* EXEC CICS STARTBR
  8385*         DATASET    ('ELMSTR')
  8386*         RIDFLD     (ELMSTR-KEY)
  8387*         GTEQ
  8388*    END-EXEC.
  8389     MOVE 'ELMSTR' TO DFHEIV1
  8390     MOVE 0
  8391       TO DFHEIV11
  8392*    MOVE '&,         G          &   #00008346' TO DFHEIV0
  8393     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8394     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8395     MOVE X'2020233030303038333436' TO DFHEIV0(25:11)
  8396     CALL 'kxdfhei1' USING DFHEIV0,
  8397           DFHEIV1,
  8398           ELMSTR-KEY,
  8399           DFHEIV99,
  8400           DFHEIV11,
  8401           DFHEIV99
  8402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8403
  8404
  8405     MOVE 'Y' TO WS-BROWSE-START-SW.
  8406
  8407 0335-READNEXT.
  8408
  8409
  8410* EXEC CICS READNEXT
  8411*         DATASET    ('ELMSTR')
  8412*         RIDFLD     (ELMSTR-KEY)
  8413*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 160
* EL156.cbl
  8414*    END-EXEC.
  8415     MOVE 'ELMSTR' TO DFHEIV1
  8416     MOVE 0
  8417       TO DFHEIV11
  8418*    MOVE '&.S                   )   #00008356' TO DFHEIV0
  8419     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303038333536' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           DFHEIV1,
  8424           DFHEIV20,
  8425           DFHEIV99,
  8426           ELMSTR-KEY,
  8427           DFHEIV99,
  8428           DFHEIV11,
  8429           DFHEIV99,
  8430           DFHEIV99
  8431     SET ADDRESS OF CLAIM-MASTER TO
  8432         DFHEIV20
  8433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8434
  8435
  8436     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8437        GO TO 0380-CLAIM-END-FILE.
  8438
  8439     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8440        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8441        GO TO 0335-READNEXT.
  8442
  8443     IF PI-COMPANY-ID = 'CRI'
  8444         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8445            GO TO 0380-CLAIM-END-FILE.
  8446
  8447     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8448         GO TO 0335-READNEXT.
  8449
  8450     IF PI-CARRIER-SECURITY > SPACES
  8451         IF CL-CARRIER = PI-CARRIER-SECURITY
  8452             NEXT SENTENCE
  8453         ELSE
  8454             GO TO 0335-READNEXT.
  8455
  8456     IF PI-ACCOUNT-SECURITY > SPACES
  8457         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8458             NEXT SENTENCE
  8459         ELSE
  8460             GO TO 0335-READNEXT.
  8461
  8462     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8463     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8464     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8465
  8466     GO TO 0400-FIRST-TIME.
  8467
  8468 0350-BROWSE-BACKWARD.
  8469
  8470     MOVE CLMNOI            TO PI-CLAIM-NO
  8471                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 161
* EL156.cbl
  8472     MOVE CARRI             TO PI-CARRIER.
  8473     MOVE CERTNOI           TO PI-CERT-PRIME.
  8474     MOVE SUFXI             TO PI-CERT-SFX.
  8475
  8476     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8477
  8478     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8479     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8480     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8481
  8482
  8483* EXEC CICS HANDLE CONDITION
  8484*         NOTFND   (0380-CLAIM-END-FILE)
  8485*         ENDFILE  (0380-CLAIM-END-FILE)
  8486*    END-EXEC.
  8487*    MOVE '"$I''                  ! $ #00008408' TO DFHEIV0
  8488     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8490     MOVE X'2420233030303038343038' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0
  8492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8493
  8494
  8495
  8496* EXEC CICS STARTBR
  8497*         DATASET    ('ELMSTR')
  8498*         RIDFLD     (ELMSTR-KEY)
  8499*         GTEQ
  8500*    END-EXEC.
  8501     MOVE 'ELMSTR' TO DFHEIV1
  8502     MOVE 0
  8503       TO DFHEIV11
  8504*    MOVE '&,         G          &   #00008413' TO DFHEIV0
  8505     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8507     MOVE X'2020233030303038343133' TO DFHEIV0(25:11)
  8508     CALL 'kxdfhei1' USING DFHEIV0,
  8509           DFHEIV1,
  8510           ELMSTR-KEY,
  8511           DFHEIV99,
  8512           DFHEIV11,
  8513           DFHEIV99
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517     MOVE 'Y' TO WS-BROWSE-START-SW.
  8518
  8519
  8520* EXEC CICS READNEXT
  8521*         DATASET    ('ELMSTR')
  8522*         RIDFLD     (ELMSTR-KEY)
  8523*         SET        (ADDRESS OF CLAIM-MASTER)
  8524*    END-EXEC.
  8525     MOVE 'ELMSTR' TO DFHEIV1
  8526     MOVE 0
  8527       TO DFHEIV11
  8528*    MOVE '&.S                   )   #00008421' TO DFHEIV0
  8529     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 162
* EL156.cbl
  8530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8531     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  8532     CALL 'kxdfhei1' USING DFHEIV0,
  8533           DFHEIV1,
  8534           DFHEIV20,
  8535           DFHEIV99,
  8536           ELMSTR-KEY,
  8537           DFHEIV99,
  8538           DFHEIV11,
  8539           DFHEIV99,
  8540           DFHEIV99
  8541     SET ADDRESS OF CLAIM-MASTER TO
  8542         DFHEIV20
  8543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8544
  8545
  8546
  8547* EXEC CICS READPREV
  8548*         DATASET    ('ELMSTR')
  8549*         RIDFLD     (ELMSTR-KEY)
  8550*         SET        (ADDRESS OF CLAIM-MASTER)
  8551*    END-EXEC.
  8552     MOVE 'ELMSTR' TO DFHEIV1
  8553     MOVE 0
  8554       TO DFHEIV11
  8555*    MOVE '&0S                   )   #00008427' TO DFHEIV0
  8556     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8557     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8558     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8559     CALL 'kxdfhei1' USING DFHEIV0,
  8560           DFHEIV1,
  8561           DFHEIV20,
  8562           DFHEIV99,
  8563           ELMSTR-KEY,
  8564           DFHEIV99,
  8565           DFHEIV11,
  8566           DFHEIV99,
  8567           DFHEIV99
  8568     SET ADDRESS OF CLAIM-MASTER TO
  8569         DFHEIV20
  8570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8571
  8572
  8573 0360-BROWSE-BACKWARD.
  8574
  8575
  8576* EXEC CICS READPREV
  8577*         DATASET    ('ELMSTR')
  8578*         RIDFLD     (ELMSTR-KEY)
  8579*         SET        (ADDRESS OF CLAIM-MASTER)
  8580*    END-EXEC.
  8581     MOVE 'ELMSTR' TO DFHEIV1
  8582     MOVE 0
  8583       TO DFHEIV11
  8584*    MOVE '&0S                   )   #00008435' TO DFHEIV0
  8585     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8586     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8587     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 163
* EL156.cbl
  8588     CALL 'kxdfhei1' USING DFHEIV0,
  8589           DFHEIV1,
  8590           DFHEIV20,
  8591           DFHEIV99,
  8592           ELMSTR-KEY,
  8593           DFHEIV99,
  8594           DFHEIV11,
  8595           DFHEIV99,
  8596           DFHEIV99
  8597     SET ADDRESS OF CLAIM-MASTER TO
  8598         DFHEIV20
  8599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8600
  8601
  8602     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8603        GO TO 0380-CLAIM-END-FILE.
  8604
  8605     IF PI-COMPANY-ID = 'CRI'
  8606         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8607            GO TO 0380-CLAIM-END-FILE.
  8608
  8609     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8610         GO TO 0360-BROWSE-BACKWARD.
  8611
  8612     IF PI-CARRIER-SECURITY > SPACES
  8613         IF CL-CARRIER = PI-CARRIER-SECURITY
  8614             NEXT SENTENCE
  8615         ELSE
  8616             GO TO 0360-BROWSE-BACKWARD.
  8617
  8618     IF PI-ACCOUNT-SECURITY > SPACES
  8619         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8620             NEXT SENTENCE
  8621         ELSE
  8622             GO TO 0360-BROWSE-BACKWARD.
  8623
  8624     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8625     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8626     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8627
  8628     GO TO 0400-FIRST-TIME.
  8629
  8630 0380-CLAIM-END-FILE.
  8631
  8632     MOVE ER-0130     TO EMI-ERROR.
  8633     MOVE -1          TO CLMNOL.
  8634     MOVE AL-UABON    TO CARRA
  8635                         CLMNOA
  8636                         CERTNOA
  8637                         SUFXA.
  8638
  8639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8640
  8641     GO TO 8200-SEND-DATAONLY.
  8642
  8643 0400-FIRST-TIME.
  8644
  8645     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 164
* EL156.cbl
  8646        MOVE 'N'         TO WS-BROWSE-START-SW
  8647
  8648* EXEC CICS ENDBR
  8649*            DATASET    ('ELMSTR')
  8650*       END-EXEC.
  8651     MOVE 'ELMSTR' TO DFHEIV1
  8652     MOVE 0
  8653       TO DFHEIV11
  8654*    MOVE '&2                    $   #00008486' TO DFHEIV0
  8655     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8656     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8657     MOVE X'2020233030303038343836' TO DFHEIV0(25:11)
  8658     CALL 'kxdfhei1' USING DFHEIV0,
  8659           DFHEIV1,
  8660           DFHEIV11,
  8661           DFHEIV99
  8662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8663
  8664
  8665     IF PI-PROCESSOR-ID = 'LGXX'
  8666         NEXT SENTENCE
  8667     ELSE
  8668
  8669* EXEC CICS READQ TS
  8670*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8671*            INTO    (SECURITY-CONTROL)
  8672*            LENGTH  (SC-COMM-LENGTH)
  8673*            ITEM    (SC-ITEM)
  8674*        END-EXEC
  8675*    MOVE '*$II   L              ''   #00008493' TO DFHEIV0
  8676     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8678     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  8679     CALL 'kxdfhei1' USING DFHEIV0,
  8680           PI-SECURITY-TEMP-STORE-ID,
  8681           SECURITY-CONTROL,
  8682           SC-COMM-LENGTH,
  8683           SC-ITEM,
  8684           DFHEIV99,
  8685           DFHEIV99
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8687         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8688         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8689
  8690     MOVE LOW-VALUES             TO EL156AI.
  8691     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8692     MOVE 'Y'                    TO FIRST-ENTRY.
  8693     GO TO 7000-SHOW-CLAIM.
  8694
  8695 0500-CREATE-TEMP-STORAGE.
  8696     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8697
  8698
  8699* EXEC CICS WRITEQ TS
  8700*        QUEUE (QID)
  8701*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8702*        LENGTH(PI-COMM-LENGTH)
  8703*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 165
* EL156.cbl
  8704*    MOVE '*"                    ''   #00008510' TO DFHEIV0
  8705     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8707     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  8708     CALL 'kxdfhei1' USING DFHEIV0,
  8709           QID,
  8710           PROGRAM-INTERFACE-BLOCK,
  8711           PI-COMM-LENGTH,
  8712           DFHEIV99,
  8713           DFHEIV99,
  8714           DFHEIV99
  8715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8716
  8717
  8718
  8719* EXEC CICS WRITEQ TS
  8720*        QUEUE (QID)
  8721*        FROM  (EL156AI)
  8722*        LENGTH(MAP-LENGTH)
  8723*    END-EXEC.
  8724*    MOVE '*"                    ''   #00008516' TO DFHEIV0
  8725     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8726     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8727     MOVE X'2020233030303038353136' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0,
  8729           QID,
  8730           EL156AI,
  8731           MAP-LENGTH,
  8732           DFHEIV99,
  8733           DFHEIV99,
  8734           DFHEIV99
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8736
  8737
  8738 0599-EXIT.
  8739      EXIT.
  8740
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 166
* EL156.cbl
  8742 0600-RECOVER-TEMP-STORAGE.
  8743
  8744* EXEC CICS READQ TS
  8745*        QUEUE (QID)
  8746*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8747*        LENGTH(PI-COMM-LENGTH)
  8748*    END-EXEC.
  8749*    MOVE '*$I    L              ''   #00008527' TO DFHEIV0
  8750     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303038353237' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           QID,
  8755           PROGRAM-INTERFACE-BLOCK,
  8756           PI-COMM-LENGTH,
  8757           DFHEIV99,
  8758           DFHEIV99,
  8759           DFHEIV99
  8760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8761
  8762
  8763
  8764* EXEC CICS READQ TS
  8765*        QUEUE (QID)
  8766*        INTO  (EL156AI)
  8767*        LENGTH(MAP-LENGTH)
  8768*    END-EXEC.
  8769*    MOVE '*$I    L              ''   #00008533' TO DFHEIV0
  8770     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8772     MOVE X'2020233030303038353333' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           QID,
  8775           EL156AI,
  8776           MAP-LENGTH,
  8777           DFHEIV99,
  8778           DFHEIV99,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8781
  8782
  8783     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8784
  8785     IF PMTTYPEI NOT = LOW-VALUES
  8786         MOVE AL-UANON           TO PMTTYPEA.
  8787
  8788     IF PAYEEI NOT = LOW-VALUES
  8789         MOVE AL-UANON           TO PAYEEA.
  8790
  8791     IF NOTE1I NOT = LOW-VALUES
  8792         MOVE AL-UANON           TO NOTE1A.
  8793
  8794     IF (RETURNED-FROM = 'EL614')
  8795        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8796     END-IF
  8797*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8798*       AND (PI-EOB-CODES-EXIST = 'Y')
  8799*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 167
* EL156.cbl
  8800*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8801     IF PI-SET-NOTE2-MDT = 'Y'
  8802         MOVE AL-SANON           TO NOTE2A
  8803     END-IF
  8804
  8805     IF OFFLINEI NOT = LOW-VALUES
  8806         MOVE AL-UANON           TO OFFLINEA.
  8807
  8808*    IF GROUPEDI NOT = LOW-VALUES
  8809*        MOVE AL-UANON           TO GROUPEDA.
  8810
  8811*    IF CASHI NOT = LOW-VALUES
  8812*        MOVE AL-UANON           TO CASHA.
  8813
  8814     IF CHECKNOI NOT = LOW-VALUES
  8815         MOVE AL-UANON           TO CHECKNOA.
  8816
  8817     IF HOLDTILI NOT = LOW-VALUES
  8818         MOVE AL-UANON           TO HOLDTILA.
  8819
  8820     IF EPYFROMI NOT = LOW-VALUES
  8821         MOVE AL-UANON           TO EPYFROMA.
  8822
  8823     IF AIGFROMI NOT = LOW-VALUES
  8824         MOVE AL-UANON           TO AIGFROMA.
  8825
  8826     IF EPYTHRUI NOT = LOW-VALUES
  8827         MOVE AL-UANON           TO EPYTHRUA.
  8828
  8829     IF EDAYSI NOT = LOW-VALUES
  8830         MOVE AL-UNNON           TO EDAYSA.
  8831
  8832     IF EPYAMTL NOT = +0
  8833         MOVE AL-UNNON           TO EPYAMTA.
  8834
  8835     IF ERESVL NOT = +0
  8836         MOVE AL-UNNON           TO ERESVA.
  8837
  8838     IF EEXPENSL NOT = +0
  8839         MOVE AL-UNNON           TO EEXPENSA.
  8840
  8841     IF ETYPEI NOT = LOW-VALUES
  8842         MOVE AL-UNNON           TO ETYPEA.
  8843
  8844     IF PROOFDTI NOT = 0
  8845         MOVE AL-UNNON           TO PROOFDTA.
  8846
  8847     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8848        MOVE AL-UANON            TO EOBYNA
  8849     END-IF
  8850     IF CLMFMYNI = 'Y' OR 'N'
  8851        MOVE AL-UANON            TO CLMFMYNA
  8852     END-IF
  8853
  8854     IF SURVYYNI = 'Y' OR 'N'
  8855        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8856           MOVE AL-UANON         TO SURVYYNA
  8857        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 168
* EL156.cbl
  8858     END-IF
  8859
  8860     IF SPRELYNI = 'Y' OR 'N'
  8861        MOVE AL-UANON            TO SPRELYNA
  8862     END-IF
  8863
  8864     .
  8865 0699-EXIT.
  8866      EXIT.
  8867
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 169
* EL156.cbl
  8869 0700-TEST-FOR-CHANGES.
  8870     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8871         MOVE ER-0433            TO EMI-ERROR
  8872         GO TO 0750-FUNCTION-ERROR.
  8873
  8874     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8875
  8876     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8877         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8878         MOVE 'A'                TO PI-PASS-SW
  8879         GO TO 1000-EDIT-DATA.
  8880
  8881     IF PI-FATAL-COUNT NOT = 0
  8882         MOVE ER-0499            TO EMI-ERROR
  8883         GO TO 0750-FUNCTION-ERROR.
  8884
  8885     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8886         MOVE ER-0500            TO EMI-ERROR
  8887         GO TO 0750-FUNCTION-ERROR.
  8888
  8889     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8890        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8891           MOVE ER-0542          TO EMI-ERROR
  8892           MOVE -1               TO EPYAMTL
  8893           GO TO 0750-FUNCTION-ERROR.
  8894
  8895     IF PI-OFFLINE = 'Y'  OR
  8896        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8897        MOVE EIBAID              TO PI-PFKEY-USED
  8898        GO TO 5000-UPDATE.
  8899
  8900     GO TO 6000-BUILD-SCREEN-B.
  8901
  8902 0750-FUNCTION-ERROR.
  8903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8904
  8905     IF ENTERPFL > 0
  8906         MOVE -1                 TO ENTERPFL
  8907         MOVE AL-UNBON           TO ENTERPFA
  8908         GO TO 8200-SEND-DATAONLY
  8909     ELSE
  8910         MOVE -1                 TO ENTERPFL
  8911         MOVE AL-UNNOF           TO ENTERPFA
  8912         GO TO 8200-SEND-DATAONLY.
  8913
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 170
* EL156.cbl
  8915 0800-DELETE-TS.
  8916
  8917* EXEC CICS HANDLE CONDITION
  8918*        QIDERR(0800-EXIT)
  8919*    END-EXEC.
  8920*    MOVE '"$N                   ! % #00008672' TO DFHEIV0
  8921     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8923     MOVE X'2520233030303038363732' TO DFHEIV0(25:11)
  8924     CALL 'kxdfhei1' USING DFHEIV0
  8925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8926
  8927
  8928
  8929* EXEC CICS DELETEQ TS
  8930*        QUEUE(QID)
  8931*    END-EXEC.
  8932*    MOVE '*&                    #   #00008676' TO DFHEIV0
  8933     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8934     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8935     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  8936     CALL 'kxdfhei1' USING DFHEIV0,
  8937           QID,
  8938           DFHEIV99
  8939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8940
  8941
  8942 0800-EXIT.
  8943      EXIT.
  8944 0900-GET-DDF-FACTORS.
  8945
  8946     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8947     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8948     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8949     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8950     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8951     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8952     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8953
  8954     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8955     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8956
  8957
  8958* EXEC CICS STARTBR
  8959*        DATASET  ('ERPDEF')
  8960*        RIDFLD   (ERPDEF-KEY)
  8961*        GTEQ
  8962*        RESP     (WS-RESPONSE)
  8963*    END-EXEC
  8964     MOVE 'ERPDEF' TO DFHEIV1
  8965     MOVE 0
  8966       TO DFHEIV11
  8967*    MOVE '&,         G          &  N#00008695' TO DFHEIV0
  8968     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8969     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8970     MOVE X'204E233030303038363935' TO DFHEIV0(25:11)
  8971     CALL 'kxdfhei1' USING DFHEIV0,
  8972           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 171
* EL156.cbl
  8973           ERPDEF-KEY,
  8974           DFHEIV99,
  8975           DFHEIV11,
  8976           DFHEIV99
  8977     MOVE EIBRESP  TO WS-RESPONSE
  8978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8979
  8980     IF NOT WS-RESP-NORMAL
  8981        GO TO 0900-EXIT
  8982     END-IF
  8983
  8984     .
  8985 0900-READNEXT.
  8986
  8987
  8988* EXEC CICS READNEXT
  8989*       DATASET  ('ERPDEF')
  8990*       SET      (ADDRESS OF PRODUCT-MASTER)
  8991*       RIDFLD   (ERPDEF-KEY)
  8992*       RESP     (WS-RESPONSE)
  8993*    END-EXEC
  8994     MOVE 'ERPDEF' TO DFHEIV1
  8995     MOVE 0
  8996       TO DFHEIV11
  8997*    MOVE '&.S                   )  N#00008709' TO DFHEIV0
  8998     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8999     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9000     MOVE X'204E233030303038373039' TO DFHEIV0(25:11)
  9001     CALL 'kxdfhei1' USING DFHEIV0,
  9002           DFHEIV1,
  9003           DFHEIV20,
  9004           DFHEIV99,
  9005           ERPDEF-KEY,
  9006           DFHEIV99,
  9007           DFHEIV11,
  9008           DFHEIV99,
  9009           DFHEIV99
  9010     SET ADDRESS OF PRODUCT-MASTER TO
  9011         DFHEIV20
  9012     MOVE EIBRESP  TO WS-RESPONSE
  9013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9014
  9015     IF NOT WS-RESP-NORMAL
  9016        GO TO 0900-ENDBR
  9017     END-IF
  9018
  9019     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9020        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9021           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9022        ELSE
  9023           GO TO 0900-READNEXT
  9024        END-IF
  9025     ELSE
  9026        GO TO 0900-ENDBR
  9027     END-IF
  9028
  9029     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9030        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 172
* EL156.cbl
  9031        OR (PD-PROD-CODE (P1) = 'I')
  9032     END-PERFORM
  9033     IF P1 < +9
  9034        SET DD-IU-PRESENT        TO TRUE
  9035     END-IF
  9036
  9037     IF CM-LOAN-TERM = ZEROS
  9038        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9039     END-IF
  9040
  9041     .
  9042 0900-ENDBR.
  9043
  9044
  9045* EXEC CICS ENDBR
  9046*       DATASET  ('ERPDEF')
  9047*    END-EXEC
  9048     MOVE 'ERPDEF' TO DFHEIV1
  9049     MOVE 0
  9050       TO DFHEIV11
  9051*    MOVE '&2                    $   #00008745' TO DFHEIV0
  9052     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9054     MOVE X'2020233030303038373435' TO DFHEIV0(25:11)
  9055     CALL 'kxdfhei1' USING DFHEIV0,
  9056           DFHEIV1,
  9057           DFHEIV11,
  9058           DFHEIV99
  9059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9060
  9061     .
  9062 0900-EXIT.
  9063     EXIT.
  9064 1000-EDIT-DATA.
  9065
  9066     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9067         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9068         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9069
  9070     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9071
  9072     IF NOT MODIFY-CAP
  9073         MOVE ER-0070            TO EMI-ERROR
  9074         MOVE -1                 TO PMTTYPEL
  9075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9076         GO TO 2000-EDIT-DONE.
  9077
  9078     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9079                         '5' AND '6'
  9080         MOVE ER-0420            TO EMI-ERROR
  9081         MOVE -1                 TO PMTTYPEL
  9082         MOVE AL-UABON           TO PMTTYPEA
  9083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084     ELSE
  9085         MOVE AL-UANON           TO PMTTYPEA.
  9086
  9087*    IF PI-OFFLINE = 'Y'
  9088*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 173
* EL156.cbl
  9089*          MOVE ER-1880         TO EMI-ERROR
  9090*          MOVE -1              TO GROUPEDL
  9091*          MOVE AL-UABON        TO GROUPEDA
  9092*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9093*
  9094*    IF GROUPEDL > +0
  9095*       IF PI-GROUPED = 'Y' OR 'N'
  9096*          MOVE AL-UANON TO GROUPEDA
  9097*       ELSE
  9098*          MOVE ER-3140            TO EMI-ERROR
  9099*          MOVE -1                 TO GROUPEDL
  9100*          MOVE AL-UABON           TO GROUPEDA
  9101*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9102*
  9103*    IF CASHL > +0
  9104*       IF PI-CASH = 'Y' OR 'N'
  9105*          MOVE AL-UANON           TO CASHA
  9106*       ELSE
  9107*          MOVE ER-3141            TO EMI-ERROR
  9108*          MOVE -1                 TO CASHL
  9109*          MOVE AL-UABON           TO CASHA
  9110*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9111
  9112     IF LOANNOL > +0
  9113         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9114
  9115 1000-EDIT-PAYEE.
  9116
  9117     IF PI-PAYEE-SEQ NOT NUMERIC
  9118         MOVE ER-0294            TO  EMI-ERROR
  9119         MOVE -1                 TO  PAYEEL
  9120         MOVE AL-UABON           TO  PAYEEA
  9121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9122         GO TO 1000-CONT-EDIT.
  9123
  9124     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9125                         'E' OR 'O' OR 'Q'
  9126         NEXT SENTENCE
  9127     ELSE
  9128         MOVE ER-0294            TO  EMI-ERROR
  9129         MOVE -1                 TO  PAYEEL
  9130         MOVE AL-UABON           TO  PAYEEA
  9131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9132         GO TO 1000-CONT-EDIT.
  9133
  9134     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9135        (PI-PAYEE-SEQ NOT < '1' AND
  9136         PI-PAYEE-SEQ NOT > '9'))
  9137      OR
  9138        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9139         (PI-PAYEE-SEQ NOT > '9'))
  9140         MOVE AL-UANON            TO PAYEEA
  9141     ELSE
  9142         MOVE ER-0294            TO EMI-ERROR
  9143         MOVE -1                 TO PAYEEL
  9144         MOVE AL-UABON           TO PAYEEA
  9145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9146
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 174
* EL156.cbl
  9147     IF PI-COMPANY-ID = 'DMD'
  9148         IF PI-PAYEE-TYPE = 'B' AND
  9149            PI-PAYEE-SEQ NOT = '0'
  9150               MOVE ER-7841            TO EMI-ERROR
  9151               MOVE -1                 TO PAYEEL
  9152               MOVE AL-UABON           TO PAYEEA
  9153               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9154
  9155     IF PI-COMPANY-ID = 'JHL'
  9156         IF PI-PAYEE = 'B0'
  9157             NEXT SENTENCE
  9158           ELSE
  9159
  9160* EXEC CICS HANDLE CONDITION
  9161*            ENDFILE(1950-NOT-FOUND)
  9162*            NOTFND (1950-NOT-FOUND)
  9163*        END-EXEC
  9164*    MOVE '"$''I                  ! & #00008847' TO DFHEIV0
  9165     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9167     MOVE X'2620233030303038383437' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9170         MOVE 'N'                    TO FOUND-TOL-SW
  9171         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9172         MOVE '2'                    TO CNTL-REC-TYPE
  9173         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9174         MOVE +0                     TO CNTL-SEQ-NO
  9175         MOVE 'PROC'                 TO FILE-SWITCH
  9176         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9177         IF PI-PAYEE = 'I1' AND
  9178            APPROVAL-LEVEL-2
  9179             NEXT SENTENCE
  9180           ELSE
  9181         IF NOT PI-USER-ALMIGHTY-YES
  9182             MOVE ER-3546        TO EMI-ERROR
  9183             MOVE -1             TO PAYEEL
  9184             MOVE AL-UABON       TO PAYEEA
  9185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9186
  9187     IF PI-PAYEE-TYPE = 'E'
  9188        IF PI-PMTTYPE = '5' OR '6'
  9189            NEXT SENTENCE
  9190        ELSE
  9191            MOVE ER-3539            TO EMI-ERROR
  9192            MOVE -1                 TO PAYEEL
  9193            MOVE AL-UABON           TO PAYEEA
  9194            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9195
  9196 1000-CONT-EDIT.
  9197
  9198     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9199        IF PI-EPYAMT NOT NEGATIVE
  9200            MOVE ER-0421         TO EMI-ERROR
  9201            MOVE -1              TO OFFLINEL
  9202            MOVE AL-UABON        TO OFFLINEA
  9203            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9204        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 175
* EL156.cbl
  9205            MOVE AL-UANON        TO OFFLINEA.
  9206
  9207     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9208        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9209           CONTINUE
  9210        ELSE
  9211        IF PI-PRINT-EOB-YN = 'S' AND
  9212           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9213             CONTINUE
  9214        ELSE
  9215           MOVE ER-1561          TO EMI-ERROR
  9216           MOVE -1               TO EOBYNL
  9217           MOVE AL-UABON         TO EOBYNA
  9218           PERFORM 9900-ERROR-FORMAT
  9219                                 THRU 9900-EXIT
  9220        END-IF
  9221        END-IF
  9222
  9223        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9224            MOVE ER-1566        TO EMI-ERROR
  9225            MOVE -1             TO CLMFMYNL
  9226            MOVE AL-UABON       TO CLMFMYNA
  9227            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9228        END-IF
  9229
  9230        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9231            MOVE ER-1567        TO EMI-ERROR
  9232            MOVE -1             TO SURVYYNL
  9233            MOVE AL-UABON       TO SURVYYNA
  9234            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9235        END-IF
  9236
  9237        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9238            MOVE ER-1569        TO EMI-ERROR
  9239            MOVE -1             TO SPRELYNL
  9240            MOVE AL-UABON       TO SPRELYNA
  9241            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9242        END-IF
  9243
  9244     END-IF
  9245     IF PI-EPYAMT IS NEGATIVE
  9246         IF PI-OFFLINE NOT = 'Y'
  9247             MOVE ER-0836        TO  EMI-ERROR
  9248             MOVE -1             TO  OFFLINEL
  9249             MOVE AL-UABON       TO  OFFLINEA
  9250             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9251
  9252     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9253        MOVE ER-0872             TO EMI-ERROR
  9254        MOVE -1                  TO PROOFDTL
  9255        MOVE AL-UABON            TO PROOFDTA
  9256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9257     ELSE
  9258        MOVE '4'                TO DC-OPTION-CODE
  9259        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9260        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9261        IF DATE-CONVERSION-ERROR
  9262            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 176
* EL156.cbl
  9263            MOVE -1                  TO PROOFDTL
  9264            MOVE AL-UABON            TO PROOFDTA
  9265            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266        ELSE
  9267            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9268            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9269                MOVE ER-0873    TO EMI-ERROR
  9270                MOVE -1                  TO PROOFDTL
  9271                MOVE AL-UABON            TO PROOFDTA
  9272                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273            END-IF
  9274        END-IF
  9275     END-IF.
  9276
  9277     IF PI-COMPANY-ID = 'DMD'
  9278        IF NOTE1L NOT = ZEROS
  9279            MOVE ER-7844        TO  EMI-ERROR
  9280            MOVE -1             TO  NOTE1L
  9281            MOVE AL-UABON       TO  NOTE1A
  9282            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9283
  9284     IF PI-COMPANY-ID = 'DMD'
  9285        IF NOTE2L NOT = ZEROS
  9286          GO TO 1004-DMD-EOB-CHECKS.
  9287
  9288     IF NOTE1L NOT > +0
  9289         GO TO 1005-CHECK-ERRORS.
  9290
  9291     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9292         GO TO 1005-CHECK-ERRORS.
  9293
  9294     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9295         GO TO 1003-HAN-PMT-NOTES.
  9296
  9297     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9298
  9299     IF WS-PMTOPTION NUMERIC
  9300        IF WS-PMTOPTION > '00' AND < '17'
  9301           NEXT SENTENCE
  9302        ELSE
  9303           MOVE ER-0618          TO EMI-ERROR
  9304           MOVE -1               TO NOTE1L
  9305           MOVE AL-UABON         TO NOTE1A
  9306           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9307     ELSE
  9308        GO TO 1005-CHECK-ERRORS.
  9309
  9310     IF WS-PMTOPTION = '05' AND
  9311        WS-DOCNAME = SPACES
  9312          MOVE ER-0616             TO EMI-ERROR
  9313          MOVE -1                  TO NOTE1L
  9314          MOVE AL-UABON            TO NOTE1A
  9315          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9316
  9317     IF WS-PMTOPTION = '15' OR '16'
  9318
  9319* EXEC CICS BIF DEEDIT
  9320*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 177
* EL156.cbl
  9321*            LENGTH(08)
  9322*        END-EXEC
  9323     MOVE 08
  9324       TO DFHEIV11
  9325*    MOVE '@"L                   #   #00008999' TO DFHEIV0
  9326     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9327     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9328     MOVE X'2020233030303038393939' TO DFHEIV0(25:11)
  9329     CALL 'kxdfhei1' USING DFHEIV0,
  9330           WS-AMOUNT,
  9331           DFHEIV11
  9332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9333        IF (WS-NUM-AMT = ZEROS) OR
  9334           (WS-AMOUNT NOT NUMERIC)
  9335           MOVE ER-0617          TO EMI-ERROR
  9336           MOVE -1               TO NOTE1L
  9337           MOVE AL-UABON         TO NOTE1A
  9338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9339
  9340     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9341
  9342     GO TO 1005-CHECK-ERRORS.
  9343
  9344 1003-HAN-PMT-NOTES.
  9345
  9346     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9347
  9348     IF WS-HAN-PMT-CODE = SPACE
  9349         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9350     ELSE
  9351     IF WS-HAN-PMT-CODE = 'A'
  9352         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9353                                 TO WS-HAN-PMT-NOTE
  9354     ELSE
  9355     IF WS-HAN-PMT-CODE = 'B'
  9356         MOVE ':FINAL PAYMENT / DECEASED'
  9357                                 TO WS-HAN-PMT-NOTE
  9358     ELSE
  9359     IF WS-HAN-PMT-CODE = 'C'
  9360         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9361                                 TO WS-HAN-PMT-NOTE
  9362     ELSE
  9363     IF WS-HAN-PMT-CODE = 'D'
  9364         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9365                                 TO WS-HAN-PMT-NOTE
  9366     ELSE
  9367     IF WS-HAN-PMT-CODE = 'E'
  9368         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9369                                 TO WS-HAN-PMT-NOTE
  9370     ELSE
  9371     IF WS-HAN-PMT-CODE = 'F'
  9372         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9373                                 TO WS-HAN-PMT-NOTE
  9374     ELSE
  9375     IF WS-HAN-PMT-CODE = 'P'
  9376         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9377
  9378     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 178
* EL156.cbl
  9379     GO TO 1005-CHECK-ERRORS.
  9380
  9381 1004-DMD-EOB-CHECKS.
  9382
  9383     INITIALIZE PI-AT-EOB-CODES.
  9384
  9385     IF NOTE2I (20:21) > SPACES
  9386         MOVE ER-7845          TO EMI-ERROR
  9387         MOVE -1               TO NOTE2L
  9388         MOVE AL-UABON         TO NOTE2A
  9389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9390         GO TO 1005-CHECK-ERRORS
  9391      ELSE
  9392         MOVE NOTE2I             TO W-EOB-CODES.
  9393
  9394     MOVE +1                     TO W-EOB-NDX.
  9395
  9396 1004-CHECK-EACH-EOB.
  9397
  9398     IF W-EOB-NDX > +5
  9399             OR
  9400        W-EOB-CODE (W-EOB-NDX) = SPACES
  9401         GO TO 1004-CHECK-DUP-EOB.
  9402
  9403     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9404         MOVE ER-0956            TO EMI-ERROR
  9405         MOVE -1                 TO NOTE2L
  9406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9407         GO TO 1005-CHECK-ERRORS.
  9408
  9409     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9410     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9411     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9412     MOVE 'DLO023'               TO PGM-NAME.
  9413
  9414
  9415* EXEC CICS LINK
  9416*        PROGRAM    (PGM-NAME)
  9417*        COMMAREA   (CD-COMMUNICATION-AREA)
  9418*        LENGTH     (CD-RCRD-LENGTH)
  9419*    END-EXEC.
  9420*    MOVE '."C                   (   #00009084' TO DFHEIV0
  9421     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9423     MOVE X'2020233030303039303834' TO DFHEIV0(25:11)
  9424     CALL 'kxdfhei1' USING DFHEIV0,
  9425           PGM-NAME,
  9426           CD-COMMUNICATION-AREA,
  9427           CD-RCRD-LENGTH,
  9428           DFHEIV99,
  9429           DFHEIV99,
  9430           DFHEIV99,
  9431           DFHEIV99
  9432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9433
  9434
  9435     IF CD-RETURN-CODE = 'OK'
  9436         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 179
* EL156.cbl
  9437
  9438     MOVE -1                     TO NOTE2L.
  9439
  9440     IF CD-RETURN-CODE = '01'
  9441         MOVE ER-8310            TO EMI-ERROR
  9442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9443         GO TO 1005-CHECK-ERRORS.
  9444
  9445     IF CD-RETURN-CODE = '02'
  9446         MOVE ER-8311            TO EMI-ERROR
  9447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9448         GO TO 1005-CHECK-ERRORS.
  9449
  9450     IF CD-RETURN-CODE = '03'
  9451         MOVE ER-8312            TO EMI-ERROR
  9452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9453         GO TO 1005-CHECK-ERRORS.
  9454
  9455     IF CD-RETURN-CODE = '04'
  9456         MOVE ER-8313            TO EMI-ERROR
  9457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9458         GO TO 1005-CHECK-ERRORS.
  9459
  9460     IF CD-RETURN-CODE = '05'
  9461         MOVE ER-8314            TO EMI-ERROR
  9462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463         GO TO 1005-CHECK-ERRORS.
  9464
  9465     IF CD-RETURN-CODE = '06'
  9466         MOVE ER-8315            TO EMI-ERROR
  9467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9468         GO TO 1005-CHECK-ERRORS.
  9469
  9470     IF CD-RETURN-CODE = 'E1'
  9471         MOVE ER-8316            TO EMI-ERROR
  9472         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9473         GO TO 1005-CHECK-ERRORS.
  9474
  9475     IF CD-RETURN-CODE = 'N1'
  9476         MOVE ER-8317            TO EMI-ERROR
  9477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478         GO TO 1005-CHECK-ERRORS.
  9479
  9480 1004-CONT.
  9481     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9482
  9483     ADD +1 TO W-EOB-NDX.
  9484     GO TO 1004-CHECK-EACH-EOB.
  9485
  9486 1004-CHECK-DUP-EOB.
  9487     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9488         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9489                               PI-AT-EOB-CODE (3) OR
  9490                               PI-AT-EOB-CODE (4) OR
  9491                               PI-AT-EOB-CODE (5)))
  9492                  OR
  9493        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9494         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 180
* EL156.cbl
  9495                               PI-AT-EOB-CODE (4) OR
  9496                               PI-AT-EOB-CODE (5)))
  9497                  OR
  9498        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9499         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9500                               PI-AT-EOB-CODE (5)))
  9501                  OR
  9502        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9503         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9504            MOVE ER-8000            TO EMI-ERROR
  9505            MOVE AL-UABON           TO NOTE2A
  9506            MOVE -1                 TO NOTE2L
  9507            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9508            GO TO 1005-CHECK-ERRORS.
  9509
  9510 1005-CHECK-ERRORS.
  9511*    IF PI-COMPANY-ID NOT = 'DMD'
  9512        GO TO 1006-CHECK-ERRORS.
  9513
  9514*********  DMD CODE START ******************
  9515*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9516*       GO TO 1006-CHECK-ERRORS.
  9517*
  9518*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9519*
  9520*    COMPUTE W-PAYMENT-TOTAL
  9521*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9522*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9523*               AND
  9524*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9525*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9526*          MOVE ER-0967    TO EMI-ERROR
  9527*          MOVE -1         TO PMTTYPEL
  9528*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9529*
  9530*    GO TO 1006-CHECK-ERRORS.
  9531*********  DMD CODE END ******************
  9532
  9533 1006-CHECK-ERRORS.
  9534     IF NOT EMI-NO-ERRORS
  9535        GO TO 2000-EDIT-DONE.
  9536
  9537
  9538* EXEC CICS HANDLE CONDITION
  9539*        NOTFND(1950-NOT-FOUND)
  9540*    END-EXEC.
  9541*    MOVE '"$I                   ! '' #00009192' TO DFHEIV0
  9542     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9544     MOVE X'2720233030303039313932' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0
  9546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9547
  9548
  9549     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9550     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9551     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9552     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 181
* EL156.cbl
  9553     MOVE 'MSTR'                 TO FILE-SWITCH.
  9554
  9555     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9556
  9557     IF PI-COMPANY-ID = 'DMD'
  9558         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9559
  9560     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9561        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9562           MOVE ER-0873    TO EMI-ERROR
  9563           MOVE -1                  TO PROOFDTL
  9564           MOVE AL-UABON            TO PROOFDTA
  9565           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9566        END-IF
  9567     END-IF
  9568     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9569     MOVE +95                    TO TRLR-SEQ-NO
  9570
  9571* EXEC CICS READ
  9572*       DATASET  ('ELTRLR')
  9573*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9574*       RIDFLD   (ELTRLR-KEY)
  9575*       RESP     (WS-RESPONSE)
  9576*    END-EXEC
  9577     MOVE 'ELTRLR' TO DFHEIV1
  9578*    MOVE '&"S        E          (  N#00009217' TO DFHEIV0
  9579     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9581     MOVE X'204E233030303039323137' TO DFHEIV0(25:11)
  9582     CALL 'kxdfhei1' USING DFHEIV0,
  9583           DFHEIV1,
  9584           DFHEIV20,
  9585           DFHEIV99,
  9586           ELTRLR-KEY,
  9587           DFHEIV99,
  9588           DFHEIV99,
  9589           DFHEIV99
  9590     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9591         DFHEIV20
  9592     MOVE EIBRESP  TO WS-RESPONSE
  9593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9594
  9595     if ws-resp-normal
  9596        perform varying s1 from +1 by +1 until
  9597           at-note-error-no (s1) = spaces
  9598           if at-note-error-no (s1) = '1662'
  9599              continue
  9600           else
  9601              move at-note-error-no (s1)
  9602                                 to emi-error
  9603              if at-note-error-no (s1) = '1653'
  9604                 evaluate true
  9605                    when cl-claim-type = 'L'
  9606                       move '  LF  '
  9607                                 to emi-claim-type
  9608                    when cl-claim-type = 'I'
  9609                       move '  IU  '
  9610                                 to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 182
* EL156.cbl
  9611                    when other
  9612                       move '  AH  '
  9613                                 to emi-claim-type
  9614                 end-evaluate
  9615              end-if
  9616              PERFORM 9900-ERROR-FORMAT
  9617                                 THRU 9900-EXIT
  9618           end-if
  9619        end-perform
  9620     end-if
  9621     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9622         IF PI-PMTTYPE = '5' OR '6'
  9623             NEXT SENTENCE
  9624         ELSE
  9625             MOVE ER-0555             TO EMI-ERROR
  9626             MOVE -1                  TO PMTTYPEL
  9627             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9628
  9629     IF CL-LAST-CLOSE-REASON = '2'
  9630         IF CL-CLAIM-STATUS = 'C'
  9631             MOVE ER-0760        TO  EMI-ERROR
  9632             MOVE -1             TO  PMTTYPEL
  9633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9634
  9635     IF PI-ACTIVITY-CODE = 9
  9636         MOVE ER-3538            TO  EMI-ERROR
  9637         MOVE -1                 TO  PMTTYPEL
  9638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9639
  9640     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9641         GO TO 1008-READ-CERT.
  9642**********************AIG LOGIC STARTS *********************
  9643     IF CL-CERT-PRIME = 'INCOMPLETE'
  9644         MOVE ER-3540            TO  EMI-ERROR
  9645         MOVE -1                 TO  PMTTYPEL
  9646         MOVE AL-UABON           TO  PMTTYPEA
  9647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9648         GO TO 2000-EDIT-DONE.
  9649
  9650     IF PI-PMTTYPE = '4'
  9651         IF PI-EPYAMT IS NEGATIVE
  9652             IF PI-ECHECKNO-CR = 'CR'
  9653                 NEXT SENTENCE
  9654             ELSE
  9655                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9656
  9657     IF PI-PMTTYPE = '4'
  9658         IF PI-ECHECKNO-CR = 'CR'
  9659             IF PI-EPYAMT IS NEGATIVE
  9660                 NEXT SENTENCE
  9661             ELSE
  9662                 MOVE ER-0834    TO  EMI-ERROR
  9663                 MOVE -1         TO  EPYAMTL
  9664                 MOVE AL-UNBON   TO  EPYAMTA
  9665                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9666
  9667     IF PI-PMTTYPE = '4'
  9668         IF PI-EPYAMT IS NEGATIVE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 183
* EL156.cbl
  9669             IF PI-OFFLINE = 'Y'
  9670                 NEXT SENTENCE
  9671             ELSE
  9672                 MOVE 'Y'        TO  PI-OFFLINE
  9673                                     WS-OFFLINE
  9674                                     OFFLINEO
  9675                 MOVE AL-UANON   TO  OFFLINEA.
  9676
  9677*    IF PI-PMTTYPE = '4'
  9678*        IF PI-EPYAMT IS NEGATIVE
  9679*            IF PI-CASH = 'Y'
  9680*                NEXT SENTENCE
  9681*            ELSE
  9682*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9683*                MOVE AL-UANON   TO  CASHA
  9684*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9685*
  9686*    IF PI-CASH NOT = 'Y' AND 'N'
  9687*         IF PI-OFFLINE = 'Y'  AND
  9688*            PI-ECHECKNO-CR = 'CR'
  9689*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9690*              MOVE AL-UANON     TO  CASHA
  9691*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9692*
  9693*    IF PI-CASH NOT = 'Y' AND 'N'
  9694*        IF PI-PMTTYPE = '5' OR '6'
  9695*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9696*            MOVE AL-UANON       TO  CASHA
  9697*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9698*
  9699*    IF PI-CASH NOT = 'Y' AND 'N'
  9700*       IF CL-ASSOCIATES = 'N' OR 'A'
  9701*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9702*           MOVE AL-UANON        TO  CASHA
  9703*       ELSE
  9704*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9705*           MOVE AL-UANON        TO  CASHA.
  9706*
  9707*    IF PI-PMTTYPE = '5' OR '6'
  9708*        IF PI-CASH = 'N'
  9709*            MOVE ER-0819        TO  EMI-ERROR
  9710*            MOVE AL-UANON       TO  CASHA
  9711*            MOVE -1             TO  CASHL
  9712*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9713*
  9714*    IF CL-ASSOCIATES = 'N' OR 'A'
  9715*       IF CASHI = 'N'
  9716*        MOVE ER-3537            TO  EMI-ERROR
  9717*        MOVE AL-UANON           TO  CASHA
  9718*        MOVE -1                 TO  CASHL
  9719*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9720
  9721 1007-DEFAULT-AIG-CHECKNO.
  9722
  9723     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9724         MOVE ER-3532            TO  EMI-ERROR
  9725         MOVE -1                 TO  PMTTYPEL
  9726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 184
* EL156.cbl
  9727**********************AIG LOGIC ENDS ***********************
  9728
  9729 1008-READ-CERT.
  9730
  9731     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9732     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9733     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9734     MOVE CL-CERT-STATE          TO CERT-STATE.
  9735     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9736     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9737     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9738     MOVE 'CERT'                 TO FILE-SWITCH.
  9739
  9740     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9741
  9742     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9743         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9744     ELSE
  9745         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9746
  9747*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9748*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9749
  9750     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9751         MOVE ER-0458            TO EMI-ERROR
  9752         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9753
  9754     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9755         MOVE ER-0459            TO EMI-ERROR
  9756         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9757
  9758     IF CL-REPORTED-DT = LOW-VALUES
  9759        MOVE ER-0530             TO EMI-ERROR
  9760        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9761
  9762     IF PI-COMPANY-ID = 'NCL'
  9763        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9764            MOVE ER-0770            TO EMI-ERROR
  9765            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9766
  9767     IF PI-COMPANY-ID = 'NCL'
  9768        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9769            MOVE ER-0737            TO EMI-ERROR
  9770            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9771
  9772     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9773         MOVE ER-0768            TO  EMI-ERROR
  9774         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9775
  9776     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9777         MOVE ER-0769            TO  EMI-ERROR
  9778         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9779
  9780     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9781         GO TO 1020-DO-LIFE-EDITS
  9782     ELSE
  9783         GO TO 1030-DO-AH-EDITS.
  9784
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 185
* EL156.cbl
  9785 1010-GENERAL-ERROR.
  9786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9787
  9788     IF EMI-MESSAGE-FORMATTED
  9789         MOVE -1                 TO PMTTYPEL.
  9790
  9791 1010-EXIT.
  9792     EXIT.
  9793
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 186
* EL156.cbl
  9795 1020-DO-LIFE-EDITS.
  9796     IF CM-LF-BENEFIT-CD = '00'
  9797         IF PI-PMTTYPE = '5' OR '6'
  9798             MOVE ER-0658        TO EMI-ERROR
  9799             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9800         ELSE
  9801             MOVE ER-1775        TO EMI-ERROR
  9802             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9803
  9804     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9805     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9806         MOVE ER-0460            TO EMI-ERROR
  9807         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9808
  9809     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9810     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9811     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9812     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9813     MOVE '4'                    TO  CNTL-REC-TYPE.
  9814     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9815     MOVE 'BENE'                 TO  FILE-SWITCH.
  9816     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9817     IF NO-BENEFIT-FOUND
  9818         GO TO 1950-NOT-FOUND.
  9819
  9820     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9821
  9822     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9823         IF PI-PMTTYPE = '4'
  9824             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9825                PI-LF-COVERAGE-TYPE = 'P'
  9826                 NEXT SENTENCE
  9827             ELSE
  9828                 MOVE ER-0461        TO EMI-ERROR
  9829                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9830         ELSE
  9831            NEXT SENTENCE
  9832     ELSE
  9833         IF PI-PMTTYPE = '2'
  9834            IF NOT CM-O-B-COVERAGE
  9835              AND CM-LF-CURRENT-STATUS = '7'
  9836                MOVE ER-0462     TO EMI-ERROR
  9837                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9838
  9839     IF PI-PMTTYPE = '2'
  9840         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9841            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9842             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9843             MOVE ER-0730            TO  EMI-ERROR
  9844             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9845             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9846
  9847     IF PI-PMTTYPE = '2'
  9848         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9849            PI-LF-COVERAGE-TYPE = 'P'
  9850             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9851                 MOVE ER-0462    TO  EMI-ERROR
  9852                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 187
* EL156.cbl
  9853
  9854     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9855       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9856         MOVE ER-0466            TO EMI-ERROR
  9857         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9858
  9859     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9860         IF PI-PMTTYPE = '3'
  9861             MOVE 0436           TO EMI-ERROR
  9862             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9863             GO TO 1045-EDIT-PAYEE-ADDR
  9864         ELSE
  9865             GO TO 1045-EDIT-PAYEE-ADDR.
  9866
  9867     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9868        PI-LF-COVERAGE-TYPE = 'P'
  9869         IF PI-PMTTYPE = '3'
  9870             MOVE ER-0436          TO  EMI-ERROR
  9871             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9872         ELSE
  9873             NEXT SENTENCE
  9874     ELSE
  9875         IF PI-PMTTYPE = '1' OR '3'
  9876             MOVE ER-0436            TO EMI-ERROR
  9877             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9878*
  9879     IF PI-COMPANY-ID = 'CID' AND
  9880        CL-CERT-STATE = 'SC'  AND
  9881        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9882           MOVE ER-0879    TO  EMI-ERROR
  9883           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9884           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9885     END-IF.
  9886     IF PI-COMPANY-ID = 'AHL'
  9887        evaluate true
  9888           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9889              MOVE ER-0879       TO  EMI-ERROR
  9890              PERFORM 1040-PMTTYPE-ERROR
  9891                                 THRU 1040-EXIT
  9892              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9893           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9894                 '6D' OR '6H' OR '6R'
  9895              MOVE ER-0879       TO  EMI-ERROR
  9896              PERFORM 1040-PMTTYPE-ERROR
  9897                                 THRU 1040-EXIT
  9898              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9899           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9900              MOVE ER-0879       TO  EMI-ERROR
  9901              PERFORM 1040-PMTTYPE-ERROR
  9902                                 THRU 1040-EXIT
  9903              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9904        end-evaluate
  9905     END-IF
  9906     GO TO 1045-EDIT-PAYEE-ADDR.
  9907
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 188
* EL156.cbl
  9909 1030-DO-AH-EDITS.
  9910     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9911     IF CM-AH-BENEFIT-CD = '00'
  9912         IF PI-PMTTYPE = '5' OR '6'
  9913             MOVE ER-0658        TO EMI-ERROR
  9914             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9915         ELSE
  9916             MOVE ER-1775        TO EMI-ERROR
  9917             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9918
  9919     IF CL-TOTAL-PAID-AMT = ZEROS
  9920         IF PI-PMTTYPE = '4'
  9921             MOVE ER-0438        TO EMI-ERROR
  9922             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9923
  9924     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9925         IF PI-PMTTYPE = '3'
  9926             MOVE ER-0463        TO EMI-ERROR
  9927             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9928         ELSE
  9929             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9930              AND CM-LF-CURRENT-STATUS = '7'
  9931                 MOVE ER-0465    TO EMI-ERROR
  9932                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9933
  9934     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9935         IF PI-PMTTYPE = '3'
  9936             MOVE ER-0464        TO EMI-ERROR
  9937             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9938         ELSE
  9939             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9940                 MOVE ER-0469    TO EMI-ERROR
  9941                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9942
  9943     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9944         IF PI-PMTTYPE = '3'
  9945             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9946                 MOVE ER-0467    TO EMI-ERROR
  9947                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9948             ELSE
  9949                 NEXT SENTENCE
  9950         ELSE
  9951             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9952                 MOVE ER-0468    TO EMI-ERROR
  9953                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9954
  9955     GO TO 1045-EDIT-PAYEE-ADDR.
  9956
  9957 1040-PMTTYPE-ERROR.
  9958     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9959
  9960     IF EMI-MESSAGE-FORMATTED
  9961         MOVE -1                 TO PMTTYPEL
  9962         MOVE AL-UABON           TO PMTTYPEA.
  9963
  9964 1040-EXIT.
  9965     EXIT.
  9966
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 189
* EL156.cbl
  9968 1045-EDIT-PAYEE-ADDR.
  9969
  9970     IF PI-OFFLINE = 'N' AND
  9971        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9972           < PI-PAYEE-SEQ-NUM)
  9973        OR
  9974         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9975         (PI-PAYEE-TYPE = 'B')                 AND
  9976         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9977        OR
  9978         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9979           < PI-PAYEE-SEQ-NUM)
  9980        OR
  9981         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9982           < PI-PAYEE-SEQ-NUM)
  9983        OR
  9984         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9985           < PI-PAYEE-SEQ-NUM)
  9986        OR
  9987         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9988           < PI-PAYEE-SEQ-NUM)
  9989        OR
  9990         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9991           < PI-PAYEE-SEQ-NUM))
  9992             MOVE ER-0437        TO EMI-ERROR
  9993             MOVE -1             TO PAYEEL
  9994             MOVE AL-UABON       TO PAYEEA
  9995             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9996
  9997     IF PI-OFFLINE    = 'N' AND
  9998        PI-PAYEE-TYPE = 'B' AND
  9999        PI-PAYEE-SEQ  = '0'
 10000         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10001         IF BENE-FOUND-SW = 'N'
 10002             MOVE ER-0437        TO EMI-ERROR
 10003             MOVE -1             TO PAYEEL
 10004             MOVE AL-UABON       TO PAYEEA
 10005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10006
 10007     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10008        IF PI-OFFLINE    = 'N'  AND
 10009           PI-PAYEE-TYPE = 'B'  AND
 10010           PI-PAYEE-SEQ  = '9'
 10011             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10012             IF BENE-FOUND-SW = 'N'
 10013                MOVE ER-0437        TO EMI-ERROR
 10014                MOVE -1             TO PAYEEL
 10015                MOVE AL-UABON       TO PAYEEA
 10016                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10017
 10018*    IF PI-COMPANY-ID = 'CRI'
 10019*        IF CL-CLAIM-TYPE = 'L'
 10020*            MOVE 'N'                TO  WS-GROUPED
 10021*                                        PI-GROUPED
 10022*                                        GROUPEDI
 10023*            MOVE AL-UANON           TO  GROUPEDA
 10024*            GO TO 1050-EDIT-CHECK-NO
 10025*        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 190
* EL156.cbl
 10026*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10027*            IF WS-GROUP-1 = 'C'
 10028*                NEXT SENTENCE
 10029*            ELSE
 10030*                MOVE 'N'            TO  WS-GROUPED
 10031*                                        PI-GROUPED
 10032*                                        GROUPEDI
 10033*                MOVE AL-UANON       TO  GROUPEDA
 10034*                GO TO 1050-EDIT-CHECK-NO.
 10035
 10036*     IF PI-GROUPED = 'Y'
 10037*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10038*           NEXT SENTENCE
 10039*        ELSE
 10040*           MOVE ER-0437        TO EMI-ERROR
 10041*           MOVE -1             TO PAYEEL
 10042**02180            MOVE AL-UABON       TO PAYEEA
 10043*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10044*
 10045*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10046*        (PI-GROUPED    = ' ')
 10047*        NEXT SENTENCE
 10048*     ELSE
 10049*
 10050     GO TO 1050-EDIT-CHECK-NO.
 10051*     IF PI-COMPANY-ID = 'CRI'
 10052*        MOVE 'N'           TO GROUPEDI
 10053*                              PI-GROUPED
 10054*                              WS-GROUPED
 10055*        MOVE AL-UANON      TO GROUPEDA.
 10056*
 10057*     IF PI-COMPANY-ID = 'CRI'
 10058*        IF PI-PAYEE-TYPE = 'B'
 10059*           IF BENE-FOUND-SW = 'Y'
 10060*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10061*                 MOVE 'Y'           TO GROUPEDI
 10062*                                       PI-GROUPED
 10063*                                       WS-GROUPED
 10064*                 MOVE AL-UANON      TO GROUPEDA
 10065*              ELSE
 10066*                 NEXT SENTENCE
 10067*           ELSE
 10068*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10069*              IF BENE-FOUND-SW = 'Y'
 10070*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10071*                    MOVE 'Y'      TO GROUPEDI
 10072*                                     PI-GROUPED
 10073*                                     WS-GROUPED
 10074*                    MOVE AL-UANON TO GROUPEDA.
 10075*
 10076
 10077     IF PI-COMPANY-ID NOT = 'CRI'
 10078        GO TO 1050-EDIT-CHECK-NO.
 10079
 10080*************** CRI CODE START ******************
 10081     IF PI-PAYEE-TYPE NOT = 'A'
 10082        GO TO 1050-EDIT-CHECK-NO.
 10083
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 191
* EL156.cbl
 10084     MOVE LOW-VALUES             TO ERACCT-KEY.
 10085     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10086     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10087     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10088     MOVE PI-STATE               TO ACCT-STATE.
 10089     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10090     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10091     MOVE 'ACCT'                 TO FILE-SWITCH.
 10092
 10093     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10094     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10095
 10096
 10097* EXEC CICS HANDLE CONDITION
 10098*         NOTFND   (1950-NOT-FOUND)
 10099*         ENDFILE  (1950-NOT-FOUND)
 10100*    END-EXEC.
 10101*    MOVE '"$I''                  ! ( #00009725' TO DFHEIV0
 10102     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10104     MOVE X'2820233030303039373235' TO DFHEIV0(25:11)
 10105     CALL 'kxdfhei1' USING DFHEIV0
 10106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10107
 10108
 10109
 10110* EXEC CICS STARTBR
 10111*         DATASET   ('ERACCT')
 10112*         RIDFLD    (ERACCT-KEY)
 10113*         GTEQ
 10114*    END-EXEC.
 10115     MOVE 'ERACCT' TO DFHEIV1
 10116     MOVE 0
 10117       TO DFHEIV11
 10118*    MOVE '&,         G          &   #00009730' TO DFHEIV0
 10119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10121     MOVE X'2020233030303039373330' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0,
 10123           DFHEIV1,
 10124           ERACCT-KEY,
 10125           DFHEIV99,
 10126           DFHEIV11,
 10127           DFHEIV99
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131 1046-READNEXT-ERACCT.
 10132
 10133
 10134* EXEC CICS READNEXT
 10135*         DATASET   ('ERACCT')
 10136*         RIDFLD    (ERACCT-KEY)
 10137*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10138*    END-EXEC.
 10139     MOVE 'ERACCT' TO DFHEIV1
 10140     MOVE 0
 10141       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 192
* EL156.cbl
 10142*    MOVE '&.S                   )   #00009738' TO DFHEIV0
 10143     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10144     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10145     MOVE X'2020233030303039373338' TO DFHEIV0(25:11)
 10146     CALL 'kxdfhei1' USING DFHEIV0,
 10147           DFHEIV1,
 10148           DFHEIV20,
 10149           DFHEIV99,
 10150           ERACCT-KEY,
 10151           DFHEIV99,
 10152           DFHEIV11,
 10153           DFHEIV99,
 10154           DFHEIV99
 10155     SET ADDRESS OF ACCOUNT-MASTER TO
 10156         DFHEIV20
 10157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10158
 10159
 10160     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10161        IF WS-ERACCT-HOLD-RECORD = SPACES
 10162           GO TO 1950-NOT-FOUND
 10163        ELSE
 10164           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10165           GO TO 1048-CONTINUE.
 10166
 10167     IF ACCT-EXP-DT = HIGH-VALUES
 10168        NEXT SENTENCE
 10169     ELSE
 10170        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10171        GO TO 1046-READNEXT-ERACCT.
 10172
 10173 1048-CONTINUE.
 10174
 10175*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10176*       MOVE 'Y'                 TO GROUPEDI
 10177*                                   PI-GROUPED
 10178*                                   WS-GROUPED
 10179*       MOVE AL-UANON            TO GROUPEDA.
 10180*************** CRI CODE END ******************
 10181
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 193
* EL156.cbl
 10183 1050-EDIT-CHECK-NO.
 10184
 10185     IF PI-OFFLINE = 'Y'
 10186         IF PI-ECHECKNO = SPACES
 10187              MOVE ER-0439        TO EMI-ERROR
 10188              GO TO 1090-CHECK-NO-ERROR
 10189           ELSE
 10190*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10191*           IF PI-ECHECKNO-N = 'N' AND
 10192*              PI-CASH       = 'Y'
 10193*                MOVE ER-3535        TO EMI-ERROR
 10194*                GO TO 1090-CHECK-NO-ERROR
 10195*             ELSE
 10196*                MOVE AL-UANON    TO CHECKNOA
 10197*                GO TO 1100-EDIT-HOLDTIL
 10198*         ELSE
 10199            MOVE AL-UANON    TO CHECKNOA
 10200            GO TO 1100-EDIT-HOLDTIL.
 10201
 10202     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10203     MOVE '6'                    TO CNTL-REC-TYPE.
 10204
 10205     IF CONTROL-IS-ACTUAL-CARRIER
 10206         MOVE PI-CARRIER         TO WS-CARR
 10207     ELSE
 10208         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10209
 10210     IF PI-COMPANY-ID = 'FIA'
 10211         MOVE PI-CARRIER         TO WS-CARR.
 10212
 10213     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10214     MOVE 0                      TO CNTL-SEQ-NO.
 10215     MOVE 'CARR'                 TO FILE-SWITCH.
 10216
 10217     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10218
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 194
* EL156.cbl
 10220     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10221         GO TO 1051-EDIT-CHECKNO-CONT.
 10222
 10223**********************AIG LOGIC STARTS**********************
 10224     IF PI-ECHECKNO = SPACES
 10225         IF CHECK-NO-MANUAL
 10226             MOVE ER-0441        TO EMI-ERROR
 10227             GO TO 1090-CHECK-NO-ERROR
 10228         ELSE
 10229             MOVE AL-UANOF       TO CHECKNOA
 10230             GO TO 1100-EDIT-HOLDTIL.
 10231
 10232     IF PI-ECHECKNO NOT = SPACES
 10233         IF CHECK-NO-MANUAL
 10234             MOVE AL-UANON       TO CHECKNOA
 10235             GO TO 1100-EDIT-HOLDTIL.
 10236
 10237     IF PI-ECHECKNO-CR = 'CR'
 10238        IF PI-OFFLINE = 'Y'
 10239            MOVE AL-UANON       TO CHECKNOA
 10240            GO TO 1100-EDIT-HOLDTIL
 10241        ELSE
 10242            MOVE ER-3534        TO EMI-ERROR
 10243            GO TO 1090-CHECK-NO-ERROR.
 10244
 10245     IF PI-ECHECKNO-N = 'N'
 10246        IF PI-CASH = 'N'
 10247            MOVE AL-UANON       TO CHECKNOA
 10248            GO TO 1100-EDIT-HOLDTIL
 10249        ELSE
 10250            MOVE ER-3535          TO EMI-ERROR
 10251            GO TO 1090-CHECK-NO-ERROR.
 10252
 10253     MOVE ER-0442        TO EMI-ERROR
 10254     GO TO 1090-CHECK-NO-ERROR.
 10255**********************AIG LOGIC ENDS************************
 10256
 10257 1051-EDIT-CHECKNO-CONT.
 10258
 10259     IF PI-COMPANY-ID = 'DMD'
 10260        IF PI-ECHECKNO NOT = SPACES
 10261           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10262              MOVE ER-0442        TO EMI-ERROR
 10263              GO TO 1090-CHECK-NO-ERROR
 10264            ELSE
 10265              GO TO 1100-EDIT-HOLDTIL
 10266          ELSE
 10267           GO TO 1100-EDIT-HOLDTIL.
 10268
 10269     IF PI-ECHECKNO = SPACES
 10270         IF CHECK-NO-MANUAL
 10271             MOVE ER-0441        TO EMI-ERROR
 10272             GO TO 1090-CHECK-NO-ERROR
 10273         ELSE
 10274             MOVE AL-UANOF       TO CHECKNOA
 10275             GO TO 1100-EDIT-HOLDTIL
 10276     ELSE
 10277         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 195
* EL156.cbl
 10278             MOVE AL-UANON       TO CHECKNOA
 10279             GO TO 1100-EDIT-HOLDTIL
 10280         ELSE
 10281             MOVE ER-0442        TO EMI-ERROR
 10282             GO TO 1090-CHECK-NO-ERROR.
 10283
 10284 1090-CHECK-NO-ERROR.
 10285     MOVE -1                     TO CHECKNOL.
 10286     MOVE AL-UABON               TO CHECKNOA.
 10287     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10288
 10289     GO TO 2000-EDIT-DONE.
 10290
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 196
* EL156.cbl
 10292 1100-EDIT-HOLDTIL.
 10293     MOVE AL-UANON               TO HOLDTILA.
 10294
 10295     IF PI-HOLDTIL = ZEROS
 10296        IF PI-OFFLINE = 'Y'
 10297           MOVE ER-0572          TO EMI-ERROR
 10298           GO TO 1105-HOLDTIL-ERROR
 10299        ELSE
 10300           GO TO 1110-EDIT-PAID-FROM.
 10301
 10302     MOVE '4'                    TO DC-OPTION-CODE.
 10303     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10304     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10305
 10306     IF DATE-CONVERSION-ERROR
 10307         MOVE ER-0446            TO EMI-ERROR
 10308         GO TO 1105-HOLDTIL-ERROR
 10309     END-IF
 10310     IF PI-OFFLINE = 'Y'
 10311        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10312           MOVE ER-0446            TO EMI-ERROR
 10313           GO TO 1105-HOLDTIL-ERROR
 10314        END-IF
 10315     END-IF
 10316
 10317     IF PI-OFFLINE = 'Y'
 10318        GO TO 1110-EDIT-PAID-FROM.
 10319
 10320     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10321     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10322     MOVE '1'                    TO DC-OPTION-CODE.
 10323     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10324
 10325     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10326         MOVE ER-0447            TO EMI-ERROR
 10327         GO TO 1105-HOLDTIL-ERROR.
 10328
 10329     GO TO 1110-EDIT-PAID-FROM.
 10330
 10331 1105-HOLDTIL-ERROR.
 10332     MOVE -1                     TO HOLDTILL.
 10333     MOVE AL-UNBON               TO HOLDTILA.
 10334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10335
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 197
* EL156.cbl
 10337 1110-EDIT-PAID-FROM.
 10338     MOVE AL-UANON               TO EPYFROMA.
 10339
 10340     IF PI-EPYFROM = ZEROS
 10341         GO TO 1120-CALCULATE-PAID-FROM.
 10342
 10343     IF PI-PMTTYPE = '5' OR '6'
 10344         MOVE ER-0448            TO EMI-ERROR
 10345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10346         MOVE AL-UNBON           TO EPYFROMA
 10347         MOVE -1                 TO EPYFROML
 10348         GO TO 1150-EDIT-PAID-THRU.
 10349
 10350     MOVE '4'                    TO DC-OPTION-CODE.
 10351     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10352     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10353
 10354     IF DATE-CONVERSION-ERROR
 10355         MOVE ER-0449            TO EMI-ERROR
 10356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10357         MOVE AL-UNBON           TO EPYFROMA
 10358         MOVE -1                 TO EPYFROML
 10359     ELSE
 10360         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10361
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 198
* EL156.cbl
 10363 1120-CALCULATE-PAID-FROM.
 10364     IF PI-PMTTYPE = '5' OR '6'
 10365         GO TO 1150-EDIT-PAID-THRU.
 10366
 10367*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10368*       IF PI-PMTTYPE = '4'
 10369*         GO TO 1150-EDIT-PAID-THRU.
 10370
 10371     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10372         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10373         MOVE ' '                TO DC-OPTION-CODE
 10374         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10375         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10376         GO TO 1145-TEST-PAID-FROM.
 10377
 10378     IF PI-PMTTYPE = '4'
 10379        GO TO 1150-EDIT-PAID-THRU.
 10380
 10381     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10382     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10383     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10384     MOVE '5'                    TO CNTL-REC-TYPE.
 10385     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10386     MOVE 'BENE'                 TO FILE-SWITCH.
 10387
 10388     IF WS-BEN-CD = ZEROS
 10389         GO TO 1950-NOT-FOUND.
 10390
 10391     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10392
 10393     IF NO-BENEFIT-FOUND
 10394         GO TO 1950-NOT-FOUND.
 10395
 10396     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10397     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10398
 10399     IF PI-BEN-DAYS NOT NUMERIC
 10400        MOVE ZEROS               TO PI-BEN-DAYS.
 10401
 10402     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10403
 10404     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10405        (CL-TOTAL-PAID-AMT > ZEROS)
 10406         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10407         MOVE '6'                 TO DC-OPTION-CODE
 10408         MOVE +0                  TO DC-ELAPSED-MONTHS
 10409         MOVE +1                  TO DC-ELAPSED-DAYS
 10410         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10411         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10412         GO TO 1145-TEST-PAID-FROM.
 10413
 10414******************************************************************
 10415****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10416****** SPECIAL ENTERED DATE.
 10417******************************************************************
 10418
 10419     IF PI-AIGFROM = ZEROS
 10420         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 199
* EL156.cbl
 10421
 10422     MOVE AL-UANON TO AIGFROMA.
 10423
 10424     MOVE '4'                    TO DC-OPTION-CODE.
 10425     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10426     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10427
 10428     IF DATE-CONVERSION-ERROR
 10429         MOVE ER-0449            TO EMI-ERROR
 10430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10431         MOVE AL-UNBON           TO AIGFROMA
 10432         MOVE -1                 TO AIGFROML
 10433         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10434     ELSE
 10435         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10436         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10437
 10438     GO TO 1140-CONTINUE-PAID-FROM.
 10439
 10440 1130-CONTINUE-PAID-FROM.
 10441
 10442     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10443        (CL-TOTAL-PAID-AMT = ZEROS)
 10444           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10445
 10446 1140-CONTINUE-PAID-FROM.
 10447
 10448     IF PI-BEN-TYPE = 'R'
 10449         IF PI-BEN-DAYS = ZEROS
 10450             NEXT SENTENCE
 10451         ELSE
 10452         IF PI-COMPANY-ID NOT = 'DMD'
 10453             SUBTRACT 1 FROM PI-BEN-DAYS.
 10454
 10455     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10456
 10457     IF PI-COMPANY-ID = 'DMD'
 10458         MOVE -1                 TO DC-ELAPSED-DAYS
 10459         MOVE +0                 TO DC-ELAPSED-MONTHS
 10460         MOVE '6'                TO DC-OPTION-CODE
 10461         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10462         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10463         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10464                               REMAINDER DC-ELAPSED-DAYS
 10465      ELSE
 10466         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10467         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10468
 10469     MOVE '6'                    TO DC-OPTION-CODE.
 10470     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10471     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10472
 10473     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10474
 10475     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10476         MOVE ER-0541            TO EMI-ERROR
 10477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10478         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 200
* EL156.cbl
 10479         MOVE AL-UNBON           TO EPYFROMA.
 10480
 10481     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10482        (PI-BENEFIT-SAVE = '60E')
 10483        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10484           (CL-TOTAL-PAID-AMT = ZEROS)
 10485             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10486             MOVE 30                  TO DC-ELAPSED-DAYS
 10487             MOVE +0                  TO DC-ELAPSED-MONTHS
 10488             MOVE '6'                 TO DC-OPTION-CODE
 10489             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10490
 10491     IF PI-BEN-TYPE = 'R'
 10492         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10493     ELSE
 10494         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10495         IF WS-SV-EPYFROM = LOW-VALUES
 10496            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10497
 10498     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10499         IF WS-USE-AIG-PAYFROM   OR
 10500            WS-AIG-RECALC-PAYFROM
 10501              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10502                                      DC-BIN-DATE-1
 10503              MOVE ' '            TO  DC-OPTION-CODE
 10504              MOVE +0             TO  DC-ELAPSED-MONTHS
 10505                                      DC-ELAPSED-DAYS
 10506              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10507              IF NO-CONVERSION-ERROR
 10508                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10509
 10510     IF PI-CPYFROM < CL-INCURRED-DT
 10511        MOVE -1                  TO EPYFROML
 10512        MOVE ER-3542             TO EMI-ERROR
 10513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10514
 10515     IF CM-ENTRY-DT < CL-INCURRED-DT
 10516        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10517        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10518        MOVE +0                     TO DC-ELAPSED-DAYS
 10519        MOVE +0                     TO DC-ELAPSED-MONTHS
 10520        MOVE '1'                    TO DC-OPTION-CODE
 10521        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10522        ELSE
 10523        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10524
 10525     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10526         NEXT SENTENCE
 10527     ELSE
 10528         IF DC-ELAPSED-MONTHS < 2
 10529             MOVE ER-3255        TO EMI-ERROR
 10530             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10531
 10532 1145-TEST-PAID-FROM.
 10533     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10534         GO TO 1150-EDIT-PAID-THRU.
 10535
 10536     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 201
* EL156.cbl
 10537         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10538         MOVE ' '                TO DC-OPTION-CODE
 10539         MOVE +0                 TO DC-ELAPSED-MONTHS
 10540                                    DC-ELAPSED-DAYS
 10541         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10542         IF NO-CONVERSION-ERROR
 10543             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10544         ELSE
 10545             MOVE SPACES             TO EMI-DATE-FIELD.
 10546
 10547     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10548         IF CL-TOTAL-PAID-AMT = ZEROS
 10549             MOVE ER-3543            TO EMI-ERROR
 10550             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10552             IF EMI-MESSAGE-FORMATTED
 10553                MOVE -1             TO EPYFROML
 10554                MOVE AL-UNBON       TO EPYFROMA
 10555             ELSE
 10556                NEXT SENTENCE
 10557         ELSE
 10558             MOVE ER-0452            TO EMI-ERROR
 10559             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10560             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10561             IF EMI-MESSAGE-FORMATTED
 10562                MOVE -1             TO EPYFROML
 10563                MOVE AL-UNBON       TO EPYFROMA.
 10564
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 202
* EL156.cbl
 10566 1150-EDIT-PAID-THRU.
 10567
 10568     MOVE AL-UANON               TO EPYTHRUA.
 10569
 10570     IF PI-EPYTHRU = ZEROS
 10571         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10572             GO TO 1200-EDIT-FIND-TOLERANCES
 10573         ELSE
 10574            IF (PI-PMTTYPE = '3') OR
 10575               (PI-PMTTYPE = '2' AND
 10576                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10577               GO TO 1152-CHECK-TYPE
 10578            ELSE
 10579               MOVE ER-0473      TO EMI-ERROR
 10580               GO TO 1170-PAID-THRU-FATAL-ERROR
 10581     ELSE
 10582         IF PI-PMTTYPE = '5' OR '6'
 10583             MOVE ER-0474        TO EMI-ERROR
 10584             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10585
 10586     MOVE '4'                    TO DC-OPTION-CODE.
 10587     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10588     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10589
 10590     IF DATE-CONVERSION-ERROR
 10591         MOVE ER-0475            TO EMI-ERROR
 10592         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10593
 10594     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10595
 10596     IF PI-COMPANY-ID = 'DMD'
 10597         IF PI-PMTTYPE NOT = '2'
 10598                 AND
 10599            WS-EXP-DT > WS-SV-EPYTHRU
 10600             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10601             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10602             MOVE '1'              TO DC-OPTION-CODE
 10603             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10604             IF DATE-CONVERSION-ERROR
 10605                 MOVE ER-0944      TO EMI-ERROR
 10606                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10607             ELSE
 10608                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10609                    DC-ELAPSED-DAYS   = 1
 10610                     MOVE ER-0945  TO EMI-ERROR
 10611                     MOVE -1       TO EPYTHRUL
 10612                     MOVE AL-UABON TO EPYTHRUA
 10613                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10614
 10615     IF PI-PMTTYPE = '4'
 10616         NEXT SENTENCE
 10617     ELSE
 10618         IF WS-SV-EPYTHRU = WS-EXP-DT
 10619             IF PI-PMTTYPE NOT = '2' AND '3'
 10620                 MOVE ER-3541    TO EMI-ERROR
 10621                 MOVE -1         TO PMTTYPEL
 10622                 MOVE AL-UABON   TO PMTTYPEA
 10623                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 203
* EL156.cbl
 10624
 10625     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10626         MOVE ER-0501            TO EMI-ERROR
 10627         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10628
 10629     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10630        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10631*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10632*              MOVE ER-0540         TO EMI-ERROR
 10633*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10634*              MOVE -1              TO EPYTHRUL
 10635*              MOVE AL-UNBON        TO EPYTHRUA
 10636*          ELSE
 10637*          IF PI-COMPANY-ID = 'DMD'
 10638*              MOVE ER-7540         TO EMI-ERROR
 10639*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10640*              MOVE -1              TO EPYTHRUL
 10641*              MOVE AL-UNBON        TO EPYTHRUA
 10642*          ELSE
 10643               IF PI-PMTTYPE NOT = '2' AND '3'
 10644                  IF PI-COMPANY-ID = '???'
 10645                      MOVE ER-7540  TO EMI-ERROR
 10646                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10647                      MOVE -1       TO EPYTHRUL
 10648                      MOVE AL-UNBON TO EPYTHRUA
 10649                  ELSE
 10650                      MOVE ER-0540  TO EMI-ERROR
 10651                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10652                      MOVE -1       TO EPYTHRUL
 10653                      MOVE AL-UNBON TO EPYTHRUA.
 10654
 10655     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10656            OR
 10657        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10658         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10659            OR
 10660        (PI-CPYFROM NOT = LOW-VALUES AND
 10661         PI-CPYFROM < CL-PAID-THRU-DT)
 10662        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10663
 10664 1152-CHECK-TYPE.
 10665     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10666        OR (PI-PMTTYPE = '5' OR '6')
 10667         GO TO 1160-EDIT-PAID-THRU-AH.
 10668
 10669 1155-EDIT-PAID-THRU-LIFE.
 10670     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10671     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10672     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10673     MOVE '4'                    TO CNTL-REC-TYPE.
 10674     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10675     MOVE 'BENE'                 TO FILE-SWITCH.
 10676
 10677     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10678
 10679     IF NO-BENEFIT-FOUND
 10680         GO TO 1950-NOT-FOUND.
 10681
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 204
* EL156.cbl
 10682     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10683
 10684     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10685
 10686     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10687        PI-LF-COVERAGE-TYPE = 'P'
 10688         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10689         GO TO 1200-EDIT-FIND-TOLERANCES.
 10690
 10691     IF PI-EPYTHRU = ZEROS
 10692        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10693
 10694     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10695         MOVE ER-0476            TO EMI-ERROR
 10696         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10697
 10698     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10699*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10700     move cl-critical-period    to dc-elapsed-months
 10701     MOVE +0                    TO DC-ELAPSED-DAYS.
 10702     MOVE '6'                   TO DC-OPTION-CODE.
 10703     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10704
 10705     IF (NO-CONVERSION-ERROR AND
 10706         WS-SPECIAL-CALC-CD = 'C')
 10707        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10708            MOVE ER-0657 TO EMI-ERROR
 10709            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10710
 10711     IF PI-COMPANY-ID = 'NCL'
 10712         IF WS-SPECIAL-CALC-CD = 'C' AND
 10713            cl-critical-period = zeros
 10714*           CM-LF-CRITICAL-PERIOD = +0
 10715             MOVE ER-0844       TO EMI-ERROR
 10716             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10717
 10718     GO TO 1200-EDIT-FIND-TOLERANCES.
 10719
 10720 1160-EDIT-PAID-THRU-AH.
 10721     IF PI-EPYTHRU = ZEROS
 10722        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10723                                    WS-SV-EPYTHRU
 10724     ELSE
 10725        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10726
 10727     IF WS-SV-EPYTHRU < PI-CPYFROM
 10728         MOVE ER-0508            TO EMI-ERROR
 10729         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10730
 10731     IF PI-PMTTYPE = '3'
 10732        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10733         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10734             MOVE ER-0477        TO EMI-ERROR
 10735             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10736         ELSE
 10737             NEXT SENTENCE
 10738     ELSE
 10739         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 205
* EL156.cbl
 10740             MOVE ER-0557        TO EMI-ERROR
 10741             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10742
 10743     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10744         PI-PMTTYPE NOT = '3'
 10745         MOVE ER-0541        TO EMI-ERROR
 10746         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10747
 10748     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10749        (PI-PMTTYPE NOT = '3')
 10750         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10751             MOVE ER-0478        TO EMI-ERROR
 10752             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10753
 10754     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10755        (PI-PMTTYPE NOT = '4')
 10756         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10757             MOVE ER-0479        TO EMI-ERROR
 10758             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10759
 10760     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10761         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10762             MOVE ER-0545        TO EMI-ERROR
 10763             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10764
 10765     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10766         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10767             MOVE ER-0481        TO EMI-ERROR
 10768             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10769
 10770*    IF PI-COMPANY-ID = 'NCL'
 10771*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10772*           CM-AH-CRITICAL-PERIOD = +0
 10773*            MOVE ER-0844        TO  EMI-ERROR
 10774*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10775
 10776*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10777     if (cl-critical-period = zeros)
 10778        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10779          GO TO 1200-EDIT-FIND-TOLERANCES.
 10780
 10781     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10782     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10783     MOVE '1'        TO DC-OPTION-CODE.
 10784     MOVE +0         TO DC-ELAPSED-DAYS
 10785                        DC-ELAPSED-MONTHS.
 10786     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10787
 10788*    IF NO-CONVERSION-ERROR
 10789*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10790*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10791*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10792*           MOVE ER-0657 TO EMI-ERROR
 10793*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10794
 10795     GO TO 1200-EDIT-FIND-TOLERANCES.
 10796
 10797 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 206
* EL156.cbl
 10798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10799
 10800     IF EMI-MESSAGE-FORMATTED
 10801         MOVE -1                 TO EPYTHRUL
 10802         MOVE AL-UNBON           TO EPYTHRUA.
 10803
 10804 1165-EXIT.
 10805     EXIT.
 10806
 10807 1166-CHECK-ALL-TRLRS.
 10808
 10809     IF PI-PMTTYPE = '4'
 10810        GO TO 1166-TRLR-EXIT.
 10811
 10812     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10813
 10814     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10815        WS-SV-EPYFROM = LOW-VALUES
 10816          GO TO 1166-END-CHECK.
 10817
 10818
 10819* EXEC CICS HANDLE CONDITION
 10820*        ENDFILE   (1166-END-CHECK)
 10821*        NOTFND    (1166-END-CHECK)
 10822*    END-EXEC.
 10823*    MOVE '"$''I                  ! ) #00010402' TO DFHEIV0
 10824     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10826     MOVE X'2920233030303130343032' TO DFHEIV0(25:11)
 10827     CALL 'kxdfhei1' USING DFHEIV0
 10828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10829
 10830
 10831     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10832     MOVE +100                   TO TRLR-SEQ-NO.
 10833
 10834
 10835* EXEC CICS STARTBR
 10836*         DATASET    ('ELTRLR')
 10837*         RIDFLD     (ELTRLR-KEY)
 10838*         GTEQ
 10839*    END-EXEC.
 10840     MOVE 'ELTRLR' TO DFHEIV1
 10841     MOVE 0
 10842       TO DFHEIV11
 10843*    MOVE '&,         G          &   #00010410' TO DFHEIV0
 10844     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10845     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10846     MOVE X'2020233030303130343130' TO DFHEIV0(25:11)
 10847     CALL 'kxdfhei1' USING DFHEIV0,
 10848           DFHEIV1,
 10849           ELTRLR-KEY,
 10850           DFHEIV99,
 10851           DFHEIV11,
 10852           DFHEIV99
 10853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10854
 10855
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 207
* EL156.cbl
 10856     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10857
 10858 1166-READ-TRLR-NEXT.
 10859
 10860
 10861* EXEC CICS READNEXT
 10862*         DATASET    ('ELTRLR')
 10863*         RIDFLD     (ELTRLR-KEY)
 10864*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10865*    END-EXEC.
 10866     MOVE 'ELTRLR' TO DFHEIV1
 10867     MOVE 0
 10868       TO DFHEIV11
 10869*    MOVE '&.S                   )   #00010420' TO DFHEIV0
 10870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10872     MOVE X'2020233030303130343230' TO DFHEIV0(25:11)
 10873     CALL 'kxdfhei1' USING DFHEIV0,
 10874           DFHEIV1,
 10875           DFHEIV20,
 10876           DFHEIV99,
 10877           ELTRLR-KEY,
 10878           DFHEIV99,
 10879           DFHEIV11,
 10880           DFHEIV99,
 10881           DFHEIV99
 10882     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10883         DFHEIV20
 10884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10885
 10886
 10887     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10888        TRLR-CARRIER  = MSTR-CARRIER  AND
 10889        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10890        TRLR-CERT-NO  = MSTR-CERT-NO
 10891          NEXT SENTENCE
 10892      ELSE
 10893          GO TO 1166-END-CHECK.
 10894
 10895* **  BYPASS ALL NON-PAYMENT TRAILERS
 10896
 10897     IF AT-TRAILER-TYPE = '2'
 10898        NEXT SENTENCE
 10899     ELSE
 10900        GO TO 1166-READ-TRLR-NEXT.
 10901
 10902* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10903
 10904     IF AT-PAYMENT-TYPE = '1' OR '2'
 10905        NEXT SENTENCE
 10906     ELSE
 10907        GO TO 1166-READ-TRLR-NEXT.
 10908
 10909* **  BYPASS ALL VOID PAYMENTS
 10910
 10911     IF AT-VOID-DT NOT = LOW-VALUES
 10912        GO TO 1166-READ-TRLR-NEXT.
 10913
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 208
* EL156.cbl
 10914     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10915        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10916          GO TO 1166-READ-TRLR-NEXT.
 10917
 10918     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10919         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10920            OR
 10921        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10922         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10923        NEXT SENTENCE
 10924     ELSE
 10925         IF CL-TOTAL-PAID-AMT > ZEROS
 10926             MOVE ER-0502            TO EMI-ERROR
 10927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10928             MOVE -1                 TO EPYTHRUL
 10929             MOVE AL-UNBON           TO EPYTHRUA.
 10930
 10931     GO TO 1166-READ-TRLR-NEXT.
 10932
 10933 1166-END-CHECK.
 10934
 10935     IF WS-BROWSE-TRLR-SW = 'Y'
 10936
 10937* EXEC CICS ENDBR
 10938*            DATASET   ('ELTRLR')
 10939*       END-EXEC.
 10940     MOVE 'ELTRLR' TO DFHEIV1
 10941     MOVE 0
 10942       TO DFHEIV11
 10943*    MOVE '&2                    $   #00010475' TO DFHEIV0
 10944     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10945     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10946     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 10947     CALL 'kxdfhei1' USING DFHEIV0,
 10948           DFHEIV1,
 10949           DFHEIV11,
 10950           DFHEIV99
 10951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10952
 10953
 10954     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10955
 10956 1166-TRLR-EXIT.
 10957     EXIT.
 10958
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 209
* EL156.cbl
 10960 1170-PAID-THRU-FATAL-ERROR.
 10961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10962
 10963     MOVE -1                     TO EPYTHRUL.
 10964     MOVE AL-UNBON               TO EPYTHRUA.
 10965
 10966 1200-EDIT-FIND-TOLERANCES.
 10967
 10968* EXEC CICS HANDLE CONDITION
 10969*        ENDFILE(1950-NOT-FOUND)
 10970*        NOTFND (1950-NOT-FOUND)
 10971*    END-EXEC.
 10972*    MOVE '"$''I                  ! * #00010492' TO DFHEIV0
 10973     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10975     MOVE X'2A20233030303130343932' TO DFHEIV0(25:11)
 10976     CALL 'kxdfhei1' USING DFHEIV0
 10977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10978
 10979
 10980     IF PI-PROCESSOR-ID = 'LGXX'
 10981        GO TO 1240-FIND-ACCT-TOLERANCES.
 10982
 10983     MOVE 'N'                    TO FOUND-TOL-SW.
 10984     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10985     MOVE '2'                    TO CNTL-REC-TYPE.
 10986     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10987     MOVE +0                     TO CNTL-SEQ-NO.
 10988     MOVE 'PROC'                 TO FILE-SWITCH.
 10989
 10990     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10991
 10992     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10993     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10994                                    PI-MAX-PMT-TOL.
 10995     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10996
 10997     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10998         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10999
 11000     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11001     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11002                                    PI-MAX-LF-PMT-TOL.
 11003
 11004     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11005         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11006
 11007     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11008                                    PI-MAX-EXP-PMT.
 11009
 11010 1240-FIND-ACCT-TOLERANCES.
 11011
 11012     IF WS-PMT-TOL NOT = +0
 11013         MOVE 'Y'                TO FOUND-TOL-SW.
 11014
 11015     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11016         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11017         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 210
* EL156.cbl
 11018         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11019         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11020         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11021         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11022     ELSE
 11023         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11024         MOVE PI-CARRIER             TO ACCT-CARRIER
 11025         MOVE PI-GROUPING            TO ACCT-GROUPING
 11026         MOVE PI-STATE               TO ACCT-STATE
 11027         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11028         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11029
 11030     MOVE 'ACCT'                 TO FILE-SWITCH.
 11031
 11032     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11033     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11034
 11035
 11036* EXEC CICS HANDLE CONDITION
 11037*         NOTFND   (1950-NOT-FOUND)
 11038*         ENDFILE  (1950-NOT-FOUND)
 11039*    END-EXEC.
 11040*    MOVE '"$I''                  ! + #00010552' TO DFHEIV0
 11041     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11043     MOVE X'2B20233030303130353532' TO DFHEIV0(25:11)
 11044     CALL 'kxdfhei1' USING DFHEIV0
 11045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11046
 11047
 11048
 11049* EXEC CICS STARTBR
 11050*        DATASET('ERACCT')
 11051*        RIDFLD (ERACCT-KEY)
 11052*        GTEQ
 11053*    END-EXEC.
 11054     MOVE 'ERACCT' TO DFHEIV1
 11055     MOVE 0
 11056       TO DFHEIV11
 11057*    MOVE '&,         G          &   #00010557' TO DFHEIV0
 11058     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11060     MOVE X'2020233030303130353537' TO DFHEIV0(25:11)
 11061     CALL 'kxdfhei1' USING DFHEIV0,
 11062           DFHEIV1,
 11063           ERACCT-KEY,
 11064           DFHEIV99,
 11065           DFHEIV11,
 11066           DFHEIV99
 11067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11068
 11069
 11070 1245-FIND-ACCT-TOLERANCES-LOOP.
 11071
 11072
 11073* EXEC CICS READNEXT
 11074*        DATASET('ERACCT')
 11075*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 211
* EL156.cbl
 11076*        RIDFLD (ERACCT-KEY)
 11077*    END-EXEC.
 11078     MOVE 'ERACCT' TO DFHEIV1
 11079     MOVE 0
 11080       TO DFHEIV11
 11081*    MOVE '&.S                   )   #00010565' TO DFHEIV0
 11082     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11083     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11084     MOVE X'2020233030303130353635' TO DFHEIV0(25:11)
 11085     CALL 'kxdfhei1' USING DFHEIV0,
 11086           DFHEIV1,
 11087           DFHEIV20,
 11088           DFHEIV99,
 11089           ERACCT-KEY,
 11090           DFHEIV99,
 11091           DFHEIV11,
 11092           DFHEIV99,
 11093           DFHEIV99
 11094     SET ADDRESS OF ACCOUNT-MASTER TO
 11095         DFHEIV20
 11096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11097
 11098
 11099     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11100        IF WS-ERACCT-HOLD-RECORD = SPACES
 11101           GO TO 1950-NOT-FOUND
 11102        ELSE
 11103           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11104           GO TO 1250-CONTINUE.
 11105
 11106     IF ACCT-EXP-DT = HIGH-VALUES
 11107        NEXT SENTENCE
 11108     ELSE
 11109        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11110        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11111
 11112 1250-CONTINUE.
 11113
 11114     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11115
 11116     IF FOUND-TOL-SW = 'N'
 11117         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11118
 11119********* 1260-FIND-STATE-TOLERANCES.
 11120
 11121     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11122     MOVE PI-STATE               TO WS-ST-ACCESS.
 11123     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11124     MOVE '3'                    TO CNTL-REC-TYPE.
 11125     MOVE +0                     TO CNTL-SEQ-NO.
 11126     MOVE 'STAT'                 TO FILE-SWITCH.
 11127
 11128     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11129
 11130     IF WS-PMT-TOL = +0
 11131         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11132
 11133     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 212
* EL156.cbl
 11134     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11135     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11136     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11137     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11138
 11139****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 11140     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 11141*        PI-VFY-2ND-BENE = 'Y' AND
 11142        PI-PAYEE-TYPE <> 'B'
 11143           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11144     END-IF.
 11145
 11146     IF PI-PMTTYPE      = '2'  AND
 11147        PI-SPLIT-PMT-SW = 'Y'  AND
 11148        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11149          MOVE ER-3530                TO EMI-ERROR
 11150          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11151
 11152********* 1280-FIND-BENEFIT-TOLERANCES.
 11153
 11154     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11155        OR (PI-PMTTYPE = '5' OR '6')
 11156         GO TO 1300-FIND-CARR-TOLERANCES.
 11157
 11158     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11159     MOVE '4'                    TO CNTL-REC-TYPE.
 11160     MOVE +0                     TO CNTL-SEQ-NO.
 11161     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11162     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11163     MOVE 'BENE'                 TO FILE-SWITCH.
 11164
 11165     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11166
 11167     IF NO-BENEFIT-FOUND
 11168         GO TO 1950-NOT-FOUND.
 11169
 11170     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11171     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11172     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11173
 11174
 11175* EXEC CICS HANDLE CONDITION
 11176*        NOTFND(1950-NOT-FOUND)
 11177*    END-EXEC.
 11178*    MOVE '"$I                   ! , #00010646' TO DFHEIV0
 11179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11181     MOVE X'2C20233030303130363436' TO DFHEIV0(25:11)
 11182     CALL 'kxdfhei1' USING DFHEIV0
 11183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11184
 11185
 11186 1300-FIND-CARR-TOLERANCES.
 11187     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11188     MOVE '6'                    TO CNTL-REC-TYPE.
 11189
 11190     IF CONTROL-IS-ACTUAL-CARRIER
 11191         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 213
* EL156.cbl
 11192     ELSE
 11193         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11194
 11195     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11196     MOVE +0                     TO CNTL-SEQ-NO.
 11197     MOVE 'CARR'                 TO FILE-SWITCH.
 11198
 11199     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11200
 11201     IF WS-DAYS-TOL = +0
 11202         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11203
 11204     IF WS-PMT-TOL = +0
 11205         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11206
 11207     IF WS-MAX-DAYS-TOL = +0
 11208         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11209
 11210     IF WS-MAX-PMT-TOL = +0
 11211         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11212                                    PI-MAX-PMT-TOL.
 11213
 11214     IF WS-MAX-LF-PMT-TOL = +0
 11215        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11216                                    PI-MAX-LF-PMT-TOL.
 11217
 11218     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11219
 11220********* 1320-FIND-COMP-TOLERANCES.
 11221
 11222     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11223     MOVE '1'                    TO CNTL-REC-TYPE.
 11224     MOVE SPACES                 TO CNTL-ACCESS.
 11225     MOVE +0                     TO CNTL-SEQ-NO.
 11226     MOVE 'COMP'                 TO FILE-SWITCH.
 11227
 11228     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11229
 11230     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11231     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11232
 11233     IF WS-PMT-TOL NOT = +0
 11234        IF WS-TOL-SEVERITY NOT = ' '
 11235         GO TO 1360-EDIT-DAYS.
 11236
 11237     IF WS-PMT-TOL = +0
 11238         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11239
 11240     IF WS-TOL-SEVERITY = ' '
 11241         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11242
 11243 1360-EDIT-DAYS.
 11244     IF PI-PMTTYPE NOT = '4'
 11245        IF PI-EDAYS NEGATIVE OR
 11246           PI-EPYAMT NEGATIVE
 11247          MOVE ER-0513             TO EMI-ERROR
 11248          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11249          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 214
* EL156.cbl
 11250
 11251     IF PI-PMTTYPE = '5' OR '6'
 11252        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11253
 11254     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11255        IF PI-PMTTYPE = '4'
 11256          MOVE PI-EDAYS          TO PI-CDAYS.
 11257
 11258     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11259         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11260
 11261     IF PI-PMTTYPE = '4'
 11262        MOVE PI-EDAYS            TO PI-CDAYS
 11263        GO TO 1400-EDIT-PAYMENT.
 11264
 11265     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11266        GO TO 1500-EDIT-EXPENSES.
 11267
 11268*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11269*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11270*          CM-AH-BENEFIT-CD = '23'              AND
 11271*          CL-CERT-STATE    = '04'              AND
 11272*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11273*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11274*            GO TO 1362-CHECK-MAX-DAYS.
 11275
 11276     IF PI-EDAYS = ZEROS
 11277*        IF PI-COMPANY-ID = 'DMD'
 11278*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11279*            MOVE -1             TO DC-ELAPSED-DAYS
 11280*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11281*            MOVE '6'            TO DC-OPTION-CODE
 11282*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11283*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11284*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11285*            MOVE '1'            TO DC-OPTION-CODE
 11286*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11287*            IF NO-CONVERSION-ERROR
 11288*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11289*                                 + DC-ODD-DAYS-OVER
 11290*               MOVE 6           TO EDAYSL
 11291*               MOVE AL-UNNON    TO EDAYSA
 11292*            ELSE
 11293*                NEXT SENTENCE
 11294*       ELSE
 11295            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11296            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11297            MOVE '1'             TO DC-OPTION-CODE
 11298            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11299            IF NO-CONVERSION-ERROR
 11300                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11301                ADD 1                 TO PI-EDAYS
 11302                MOVE AL-UNNON         TO EDAYSA.
 11303
 11304*    IF PI-COMPANY-ID = 'DMD'
 11305*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11306*        MOVE -1                 TO DC-ELAPSED-DAYS
 11307*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 215
* EL156.cbl
 11308*        MOVE '6'                TO DC-OPTION-CODE
 11309*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11310*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11311*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11312*        MOVE '1'                TO DC-OPTION-CODE
 11313*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11314*    ELSE
 11315         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11316         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11317         MOVE '1'                TO DC-OPTION-CODE.
 11318         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11319
 11320     IF NO-CONVERSION-ERROR
 11321        IF PI-COMPANY-ID = 'DMD'
 11322            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11323                             + DC-ODD-DAYS-OVER
 11324        ELSE
 11325            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11326            ADD 1                TO PI-CDAYS.
 11327
 11328     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11329        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11330        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11331
 11332     IF PI-EDAYS NOT NUMERIC
 11333         MOVE ER-0491            TO EMI-ERROR
 11334         GO TO 1370-DAYS-ERROR.
 11335
 11336     IF CL-NO-OF-PMTS-MADE = 0
 11337        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11338        AND CL-CERT-STATE = 'MI'
 11339        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11340            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11341     END-IF.
 11342
 11343 1362-CHECK-MAX-DAYS.
 11344
 11345     IF WS-MAX-DAYS-TOL = +999
 11346         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11347
 11348     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11349         IF PI-EDAYS = ZEROS
 11350             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11351         ELSE
 11352             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11353
 11354     IF WS-MAX-DAYS-TOL NOT = ZERO
 11355        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11356           PI-CDAYS > WS-MAX-DAYS-TOL
 11357             MOVE ER-0492          TO EMI-ERROR
 11358             GO TO 1370-DAYS-ERROR.
 11359
 11360 1365-SKIP-MAX-DAYS-EDIT.
 11361     IF PI-EDAYS = ZEROS
 11362        GO TO 1400-EDIT-PAYMENT.
 11363
 11364     IF WS-DAYS-TOL NOT = ZERO
 11365        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 216
* EL156.cbl
 11366           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 11367                MOVE ER-0493     TO EMI-ERROR
 11368                GO TO 1370-DAYS-ERROR.
 11369
 11370     GO TO 1400-EDIT-PAYMENT.
 11371
 11372 1370-DAYS-ERROR.
 11373     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11374
 11375     IF EMI-MESSAGE-FORMATTED
 11376         MOVE -1                 TO EDAYSL
 11377         MOVE AL-UABON           TO EDAYSA.
 11378
 11379     GO TO 1400-EDIT-PAYMENT.
 11380
 11381 1380-EDIT-EXPENSE-PMT-AMT.
 11382     IF PI-PMTTYPE = '5' OR '6'
 11383         NEXT SENTENCE
 11384     ELSE
 11385         GO TO 1400-EDIT-PAYMENT.
 11386
 11387     IF WS-MAX-EXP-PMT NOT = ZEROS
 11388        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11389            MOVE ER-3529            TO EMI-ERROR
 11390            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11391
 11392     GO TO 1500-EDIT-EXPENSES.
 11393
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 217
* EL156.cbl
 11395
 11396 1390-CHECK-PAYMENT-DAYS.
 11397
 11398     IF PI-EDAYS = 0
 11399         MOVE PI-CDAYS TO WS-PD-DAYS
 11400     ELSE
 11401         MOVE PI-EDAYS TO WS-PD-DAYS
 11402     END-IF.
 11403
 11404     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11405         IF WS-PD-DAYS = 14
 11406            GO TO 1390-EXIT
 11407         END-IF
 11408     END-IF.
 11409
 11410     IF PI-COMPANY-ID = 'AHL'  AND
 11411        CM-AH-BENEFIT-CD = '1K'
 11412         IF WS-PD-DAYS = 14
 11413            GO TO 1390-EXIT
 11414         END-IF
 11415     END-IF.
 11416
 11417     IF WS-PD-DAYS < 30
 11418         MOVE ER-3549              TO EMI-ERROR
 11419         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11420     END-IF.
 11421
 11422 1390-EXIT.
 11423      EXIT.
 11424
 11425 1400-EDIT-PAYMENT.
 11426*    IF PI-COMPANY-ID = 'DMD'
 11427*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11428*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11429
 11430     IF PI-COMPANY-ID = 'DCC'
 11431        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11432        MOVE PI-CARRIER          TO ACCT-CARRIER
 11433        MOVE PI-GROUPING         TO ACCT-GROUPING
 11434        MOVE PI-STATE            TO ACCT-STATE
 11435        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11436        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11437        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11438        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11439
 11440
 11441* EXEC CICS READ
 11442*          DATASET ('ERACCT')
 11443*          RIDFLD  (ERACCT-KEY)
 11444*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11445*          GTEQ
 11446*          resp    (WS-RESPONSE)
 11447*       END-EXEC
 11448     MOVE 'ERACCT' TO DFHEIV1
 11449*    MOVE '&"S        G          (  N#00010904' TO DFHEIV0
 11450     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11452     MOVE X'204E233030303130393034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 218
* EL156.cbl
 11453     CALL 'kxdfhei1' USING DFHEIV0,
 11454           DFHEIV1,
 11455           DFHEIV20,
 11456           DFHEIV99,
 11457           ERACCT-KEY,
 11458           DFHEIV99,
 11459           DFHEIV99,
 11460           DFHEIV99
 11461     SET ADDRESS OF ACCOUNT-MASTER TO
 11462         DFHEIV20
 11463     MOVE EIBRESP  TO WS-RESPONSE
 11464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11465        IF WS-RESP-NORMAL
 11466           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11467           and pi-cert-eff-dt < am-expiration-dt
 11468           and pi-cert-eff-dt >= am-effective-dt
 11469           move am-dcc-product-code to pi-dcc-product-code
 11470        else
 11471           move spaces           to pi-dcc-product-code
 11472        end-if
 11473        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11474           MOVE ' '              TO WS-PDEF-RECORD-SW
 11475           PERFORM 0900-GET-DDF-FACTORS
 11476                                 THRU 0900-EXIT
 11477           IF PDEF-FOUND
 11478              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11479                 (P1 > +8)
 11480                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11481              END-PERFORM
 11482              IF P1 < +9
 11483                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11484                    MOVE PD-MAX-AMT (P1)
 11485                                 TO CM-AH-BENEFIT-AMT
 11486                 end-if
 11487              END-IF
 11488           END-IF
 11489        end-if
 11490     END-IF
 11491     IF PI-PMTTYPE NOT = '4'
 11492        GO TO 1405-CALC-PAYMENT.
 11493
 11494     IF PI-EDAYS NOT NUMERIC
 11495         MOVE PI-EPYAMT           TO PI-CPYAMT
 11496         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11497         GO TO 1430-CHECK-AH-TOLERANCE.
 11498
 11499*    IF PI-COMPANY-ID = 'FIA'
 11500*       IF CERT-ACCOUNT = '0000011043'
 11501*        COMPUTE PI-DAILY-RATE ROUNDED =
 11502*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11503*        COMPUTE PI-CPYAMT ROUNDED =
 11504*                          PI-DAILY-RATE * PI-EDAYS
 11505*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11506*        GO TO 1430-CHECK-AH-TOLERANCE.
 11507
 11508     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11509         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11510         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 219
* EL156.cbl
 11511         GO TO 1420-CHECK-AIG-BENEFIT.
 11512
 11513     IF WS-CALC-METHOD = '2' OR  '5'
 11514         COMPUTE PI-DAILY-RATE ROUNDED =
 11515                        (CM-AH-BENEFIT-AMT * 12) / 365
 11516         COMPUTE PI-CPYAMT ROUNDED =
 11517                           PI-DAILY-RATE * PI-EDAYS
 11518        GO TO 1420-CHECK-AIG-BENEFIT.
 11519
 11520     IF WS-CALC-METHOD = '3'
 11521         COMPUTE PI-DAILY-RATE =
 11522                         (CM-AH-BENEFIT-AMT * 12) / 365
 11523         COMPUTE PI-CPYAMT ROUNDED =
 11524                           PI-DAILY-RATE * PI-EDAYS
 11525        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 220
* EL156.cbl
 11527*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11528
 11529****************************************************************
 11530****************************************************************
 11531*                  CALCULATED FROM      PAYMENT      PAYMENT
 11532*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11533* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11534*1-01-83  1-15-83    0    15     15        15           15
 11535*1-01-83  1-30-83    0    30     30        30           30
 11536*1-01-83  1-31-83    1     0     31        30           30
 11537*1-01-83  2-01-83    1     1     32        31           31
 11538*1-01-83  2-15-83    1    15     46        45           45
 11539*1-01-83  2-28-83    2     0     59        60           60
 11540*1-01-83  3-01-83    2     1     60        61           61
 11541*1-01-83  3-31-83    3     0     90        90           90
 11542*1-15-83  1-31-83    0    17     17        17           16
 11543*1-15-83  2-01-83    0    18     18        18           17
 11544*1-15-83  2-28-83    1    14     45        44           46
 11545*1-21-83  3-09-83    1    20     48        50           49
 11546*2-05-83  3-06-83    1     2     30        32           32
 11547*2-05-83  3-23-83    1    19     47        49           49
 11548*2-15-83  2-28-83    0    14     14        14           16
 11549*2-15-83  3-01-83    0    15     15        15           17
 11550*2-21-83  3-19-83    0    27     27        27           29
 11551*2-21-83  3-20-83    1     0     28        30           30
 11552*2-21-83  4-10-83    1    18     49        30           50
 11553*2-21-83  5-19-83    2    27     88        87           89
 11554*2-21-83  5-22-83    3     2     91        92           92
 11555*3-21-83  5-19-83    1    30     60        60           59
 11556****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 221
* EL156.cbl
 11558 1405-CALC-PAYMENT.
 11559     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11560     MOVE ' '                    TO DC-OPTION-CODE.
 11561     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11562     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11563     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11564
 11565     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11566     MOVE ' '                    TO DC-OPTION-CODE.
 11567     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11568     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11569     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11570
 11571     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11572     MOVE -1                     TO DC-ELAPSED-DAYS.
 11573     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11574     MOVE '6'                    TO DC-OPTION-CODE.
 11575     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11576     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11577
 11578     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11579     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11580     MOVE '1'                    TO DC-OPTION-CODE.
 11581     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11582
 11583     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11584     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11585     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11586
 11587******************************************************************
 11588*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11589*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11590*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11591******************************************************************
 11592
 11593     IF WS-CALC-METHOD = '1'           AND
 11594        DC-ELAPSED-MONTHS > ZERO AND
 11595        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11596        WDF-DAY > WDT-DAY
 11597          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11598          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11599          MOVE -1                  TO DC-ELAPSED-MONTHS
 11600          MOVE '6'                 TO DC-OPTION-CODE
 11601          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11602          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11603          COMPUTE WS-SAVE-ODD-DAYS =
 11604          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11605          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11606
 11607     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11608     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11609     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11610
 11611     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11612     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11613
 11614*    IF PI-COMPANY-ID = 'FIA'
 11615*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 222
* EL156.cbl
 11616*        COMPUTE PI-DAILY-RATE ROUNDED =
 11617*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11618*        COMPUTE PI-CPYAMT ROUNDED =
 11619*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11620*        GO TO 1420-CHECK-AIG-BENEFIT.
 11621
 11622*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11623*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11624*          CM-AH-BENEFIT-CD = '23'               AND
 11625*          CL-CERT-STATE    = '04'               AND
 11626*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11627*            COMPUTE WS-DAILY-RATE ROUNDED =
 11628*                               CM-AH-BENEFIT-AMT / 30
 11629*            COMPUTE PI-CPYAMT ROUNDED =
 11630*                               (WS-DAILY-RATE * PI-CDAYS)
 11631*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11632*            GO TO 1420-CHECK-AIG-BENEFIT.
 11633
 11634     IF WS-CALC-METHOD = '1'
 11635         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11636         COMPUTE PI-CPYAMT ROUNDED =
 11637             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11638             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11639         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11640         GO TO 1420-CHECK-AIG-BENEFIT.
 11641
 11642     IF WS-CALC-METHOD = '2'
 11643         COMPUTE PI-DAILY-RATE ROUNDED =
 11644                          (CM-AH-BENEFIT-AMT * 12) / 365
 11645         COMPUTE PI-CPYAMT ROUNDED =
 11646             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11647             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11648         GO TO 1420-CHECK-AIG-BENEFIT.
 11649
 11650     IF WS-CALC-METHOD = '4'
 11651         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11652         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11653         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11654         COMPUTE PI-CPYAMT ROUNDED =
 11655                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11656         GO TO 1420-CHECK-AIG-BENEFIT.
 11657
 11658     IF WS-CALC-METHOD = '5'
 11659         COMPUTE PI-DAILY-RATE ROUNDED =
 11660                            (CM-AH-BENEFIT-AMT * 12) / 365
 11661         COMPUTE PI-CPYAMT ROUNDED =
 11662                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11663         GO TO 1420-CHECK-AIG-BENEFIT.
 11664
 11665     IF WS-CALC-METHOD NOT = '3'
 11666        GO TO 1410-CHECK-PAYMENT.
 11667
 11668******   CALCULATION METHOD  3  ROUTINE
 11669     COMPUTE PI-DAILY-RATE =
 11670                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11671
 11672******CHECK TO SEE IF WITHIN SAME MONTH
 11673     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 223
* EL156.cbl
 11674        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11675                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11676         GO TO 1420-CHECK-AIG-BENEFIT.
 11677
 11678******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11679     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11680             SAVE-ODD-DAYS-OVER = ZEROS
 11681      COMPUTE PI-CPYAMT  ROUNDED =
 11682                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11683      GO TO 1420-CHECK-AIG-BENEFIT.
 11684
 11685******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11686******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11687     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11688        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11689        IF WDF-MONTH > 12
 11690           ADD 1                 TO WDF-YEAR
 11691           SUBTRACT 12         FROM WDF-MONTH.
 11692
 11693******CONVERT THE NEW FROM MONTH TO BINARY
 11694     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11695        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11696        MOVE '4'              TO DC-OPTION-CODE
 11697        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11698        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11699
 11700     IF WDF-MONTH = WDT-MONTH AND
 11701        WDF-YEAR  = WDT-YEAR
 11702          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11703                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11704                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11705        ELSE
 11706          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11707          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11708          COMPUTE PI-CPYAMT ROUNDED =
 11709       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11710       +
 11711       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11712       +
 11713       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11714
 11715     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 224
* EL156.cbl
 11717 1410-CHECK-PAYMENT.
 11718******PAYMENT OPTION 6
 11719******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11720     IF SAVE-ELAPSED-MONTHS > ZERO
 11721        IF SAVE-ODD-DAYS-OVER = ZEROS
 11722           GO TO 1412-CHECK-TO-DAY
 11723        ELSE
 11724           IF WDF-DAY > WDT-DAY
 11725              IF WDF-MONTH = 02
 11726                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11727                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11728                  GO TO 1412-CHECK-TO-DAY
 11729              ELSE
 11730                  IF FROM-DAYS-IN-MONTH = 31
 11731                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11732                     GO TO 1412-CHECK-TO-DAY
 11733                  ELSE
 11734                     GO TO 1412-CHECK-TO-DAY
 11735           ELSE
 11736               GO TO 1412-CHECK-TO-DAY.
 11737
 11738     IF WDF-MONTH NOT = WDT-MONTH
 11739        IF WDF-MONTH = 02
 11740           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11741           IF WDF-DAY = 29
 11742              ADD 1              TO SAVE-ODD-DAYS-OVER
 11743           ELSE
 11744              ADD 2              TO SAVE-ODD-DAYS-OVER
 11745        ELSE
 11746           IF FROM-DAYS-IN-MONTH = 31
 11747              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11748
 11749 1412-CHECK-TO-DAY.
 11750        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11751           IF WDT-DAY = 28
 11752              ADD 2              TO SAVE-ODD-DAYS-OVER
 11753           ELSE
 11754              IF WDT-DAY = 29
 11755                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11756              ELSE
 11757                 NEXT SENTENCE
 11758        ELSE
 11759           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11760              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11761
 11762     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11763     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11764     COMPUTE PI-CPYAMT ROUNDED =
 11765         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11766         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11767
 11768     GO TO 1420-CHECK-AIG-BENEFIT.
 11769
 11770 1415-CHECK-LEAP-YEAR.
 11771     IF FROM-DAYS-IN-MONTH = 29
 11772        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11773
 11774 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 225
* EL156.cbl
 11775     EXIT.
 11776
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 226
* EL156.cbl
 11778 1420-CHECK-AIG-BENEFIT.
 11779
 11780     IF WS-SPECIAL-CALC-CD = 'Q'
 11781         GO TO 1425-CHECK-WHOLE-MONTH.
 11782
 11783*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11784*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11785*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11786*       (PI-PMTTYPE = '1' OR '2')
 11787*        NEXT SENTENCE
 11788*    ELSE
 11789         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11790         GO TO 1430-CHECK-AH-TOLERANCE.
 11791
 11792******************AIG LOGIC STARTS**********************
 11793*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11794*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11795*    MOVE ER-3533      TO EMI-ERROR.
 11796*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11797*    GO TO 1430-CHECK-AH-TOLERANCE.
 11798******************AIG LOGIC ENDS************************
 11799
 11800 1425-CHECK-WHOLE-MONTH.
 11801******************************************************************
 11802****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11803****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11804****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11805****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11806****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11807****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11808****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11809****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11810****          PAID * MONTHLY BENEFIT.                         ****
 11811******************************************************************
 11812
 11813     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11814
 11815     IF CL-NO-OF-PMTS-MADE > +0
 11816         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11817
 11818     IF PI-CDAYS < WS-BEN-DAYS
 11819         GO TO 1430-CHECK-AH-TOLERANCE.
 11820
 11821     IF PI-CDAYS = WS-BEN-DAYS
 11822         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11823         GO TO 1430-CHECK-AH-TOLERANCE.
 11824
 11825*    IF PI-COMPANY-ID = 'ACM'
 11826*       NEXT SENTENCE
 11827*    ELSE
 11828        GO TO 1425-NOT-ACM-W15C.
 11829
 11830*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11831*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11832*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11833*    MOVE '6'                    TO  DC-OPTION-CODE.
 11834*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11835*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 227
* EL156.cbl
 11836*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11837*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11838*       MOVE '1'                 TO  DC-OPTION-CODE
 11839*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11840*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11841*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11842*       IF NO-CONVERSION-ERROR
 11843*          IF (DC-ELAPSED-MONTHS > +0) OR
 11844*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11845*             NEXT SENTENCE
 11846*          ELSE
 11847*             MOVE +0            TO  PI-CPYAMT
 11848*             MOVE ER-0846       TO  EMI-ERROR
 11849*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11850*             GO TO 1430-CHECK-AH-TOLERANCE
 11851*       ELSE
 11852*           MOVE ER-0846         TO  EMI-ERROR
 11853*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11854*           GO TO 1430-CHECK-AH-TOLERANCE.
 11855*
 11856*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11857*       ADD +1 TO DC-ELAPSED-MONTHS.
 11858*
 11859*    COMPUTE PI-CPYAMT ROUNDED =
 11860*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11861*
 11862*    GO TO 1430-CHECK-AH-TOLERANCE.
 11863
 11864 1425-NOT-ACM-W15C.
 11865
 11866     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11867     MOVE '6'                        TO  DC-OPTION-CODE.
 11868     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11869     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11870
 11871     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11872     IF NO-CONVERSION-ERROR
 11873         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11874     ELSE
 11875         MOVE ER-0846                TO  EMI-ERROR
 11876         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11877         GO TO 1430-CHECK-AH-TOLERANCE.
 11878
 11879     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11880     MOVE '1'                        TO  DC-OPTION-CODE.
 11881     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11882     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11883     IF NO-CONVERSION-ERROR
 11884         IF DC-ODD-DAYS-OVER = +0
 11885             NEXT SENTENCE
 11886         ELSE
 11887             MOVE ER-0846            TO  EMI-ERROR
 11888             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11889             GO TO 1430-CHECK-AH-TOLERANCE
 11890     ELSE
 11891         MOVE ER-0846                TO  EMI-ERROR
 11892         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11893         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 228
* EL156.cbl
 11894
 11895     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11896         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11897
 11898     GO TO 1430-CHECK-AH-TOLERANCE.
 11899
 11900 1425-CONT-WHOLE-MONTH-PMTS.
 11901******************************************************************
 11902****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11903****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11904****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11905******************************************************************
 11906
 11907     IF PI-COMPANY-ID = 'ACM'
 11908        NEXT SENTENCE
 11909     ELSE
 11910        IF DC-ODD-DAYS-OVER = +0
 11911            NEXT SENTENCE
 11912        ELSE
 11913            MOVE ER-0845            TO  EMI-ERROR
 11914            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11915            GO TO 1430-CHECK-AH-TOLERANCE.
 11916
 11917     COMPUTE PI-CPYAMT ROUNDED =
 11918                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11919
 11920 1430-CHECK-AH-TOLERANCE.
 11921     IF PI-PMT-APPR-SW = 'G'
 11922         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11923
 11924*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11925*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11926*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11927*
 11928*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11929*      IF WDF-MONTH = 02
 11930*        IF SAVE-ELAPSED-MONTHS = 0
 11931*          NEXT SENTENCE
 11932*        ELSE
 11933*          IF SAVE-ODD-DAYS-OVER > 0
 11934*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11935*            COMPUTE WS-PMT-MOS ROUNDED =
 11936*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11937*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11938*                                     WS-PMT-MOS
 11939*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11940*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11941*          ELSE
 11942*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11943*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11944*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11945*                                     WS-PMT-MOS.
 11946
 11947     IF WS-MAX-PMT-TOL NOT = ZERO
 11948        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11949           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11950            MOVE ER-0494         TO  EMI-ERROR
 11951            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 229
* EL156.cbl
 11952            GO TO 1500-EDIT-EXPENSES.
 11953
 11954 1430-CONT-CHECK-AH-TOLERANCE.
 11955
 11956     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11957        GO TO 1500-EDIT-EXPENSES.
 11958
 11959     IF CM-O-B-COVERAGE
 11960        GO TO 1500-EDIT-EXPENSES.
 11961
 11962     IF PI-COMPANY-ID = 'NCL'
 11963       IF FOUND-TOL-SW = 'Y'
 11964         IF WS-PMT-TOL NOT = ZERO
 11965           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11966              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11967                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11968                  IF WS-NCL-PMT-OPTION = SPACES
 11969                      MOVE ER-0699 TO EMI-ERROR
 11970                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11971                  ELSE
 11972                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11973                      NEXT SENTENCE
 11974                  ELSE
 11975                  IF NOT WS-VALID-NCL-OPTION
 11976                      MOVE ER-0699 TO EMI-ERROR
 11977                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11978
 11979     if pi-company-id = 'DCC'
 11980        and pdef-found
 11981        and pi-cpyamt < pi-epyamt
 11982           move er-1657          to emi-error
 11983           perform 1490-payment-error
 11984                                 thru 1490-exit
 11985     else
 11986        IF WS-PMT-TOL NOT = ZERO
 11987           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11988              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11989              MOVE ER-0495       TO EMI-ERROR
 11990              PERFORM 1490-PAYMENT-ERROR
 11991                                 THRU 1490-EXIT
 11992           end-if
 11993        end-if
 11994     end-if
 11995
 11996     GO TO 1500-EDIT-EXPENSES.
 11997
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 230
* EL156.cbl
 11999 1440-COMPUTE-LIFE-REMAINING.
 12000
 12001     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12002        IF PI-PMTTYPE = '4'
 12003          MOVE PI-EPYAMT TO PI-CPYAMT
 12004          GO TO 1460-TEST-TYPE.
 12005
 12006     IF WS-LF-COVERAGE-TYPE = 'L'
 12007        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12008                          - CL-TOTAL-PAID-AMT
 12009        GO TO 1450-CHECK-MAX.
 12010
 12011     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12012        PI-LF-COVERAGE-TYPE = 'P'
 12013          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12014                              CM-LF-ITD-DEATH-AMT
 12015          GO TO 1450-CHECK-MAX.
 12016
 12017     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12018     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12019     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12020     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12021     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12022     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12023     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12024     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12025     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12026
 12027     PERFORM 9800-LINK-REM-TERM.
 12028
 12029     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12030     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12031     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12032     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12033     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12034     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12035     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12036     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12037     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12038     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12039     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12040     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12041     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12042     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12043     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12044     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12045     IF PI-COMPANY-ID = 'DCC'
 12046        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12047        MOVE PI-CARRIER          TO ACCT-CARRIER
 12048        MOVE PI-GROUPING         TO ACCT-GROUPING
 12049        MOVE PI-STATE            TO ACCT-STATE
 12050        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12051        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12052        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12053        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12054
 12055
 12056* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 231
* EL156.cbl
 12057*          DATASET ('ERACCT')
 12058*          RIDFLD  (ERACCT-KEY)
 12059*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12060*          GTEQ
 12061*          resp    (WS-RESPONSE)
 12062*       END-EXEC
 12063     MOVE 'ERACCT' TO DFHEIV1
 12064*    MOVE '&"S        G          (  N#00011501' TO DFHEIV0
 12065     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12067     MOVE X'204E233030303131353031' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           DFHEIV1,
 12070           DFHEIV20,
 12071           DFHEIV99,
 12072           ERACCT-KEY,
 12073           DFHEIV99,
 12074           DFHEIV99,
 12075           DFHEIV99
 12076     SET ADDRESS OF ACCOUNT-MASTER TO
 12077         DFHEIV20
 12078     MOVE EIBRESP  TO WS-RESPONSE
 12079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12080        IF WS-RESP-NORMAL
 12081           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12082           and (pi-cert-eff-dt < am-expiration-dt)
 12083           and (pi-cert-eff-dt >= am-effective-dt)
 12084           move am-dcc-product-code to pi-dcc-product-code
 12085        else
 12086           move spaces           to pi-dcc-product-code
 12087        end-if
 12088        if pi-dcc-product-code not = spaces
 12089           MOVE ' '              TO WS-PDEF-RECORD-SW
 12090           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12091           PERFORM 0900-GET-DDF-FACTORS
 12092                                 THRU 0900-EXIT
 12093           IF PDEF-FOUND
 12094              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12095                 (P1 > +8)
 12096                 OR (PD-PROD-CODE (P1) = 'L')
 12097              END-PERFORM
 12098              IF P1 < +9
 12099                 MOVE PD-MAX-AMT (P1)
 12100                                 TO CP-R-MAX-TOT-BEN
 12101              END-IF
 12102           END-IF
 12103        end-if
 12104     END-IF
 12105
 12106* EXEC CICS LINK
 12107*       PROGRAM  (LINK-REMAMT)
 12108*       COMMAREA (CALCULATION-PASS-AREA)
 12109*       LENGTH   (CP-COMM-LENGTH)
 12110*    END-EXEC.
 12111*    MOVE '."C                   (   #00011533' TO DFHEIV0
 12112     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12114     MOVE X'2020233030303131353333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 232
* EL156.cbl
 12115     CALL 'kxdfhei1' USING DFHEIV0,
 12116           LINK-REMAMT,
 12117           CALCULATION-PASS-AREA,
 12118           CP-COMM-LENGTH,
 12119           DFHEIV99,
 12120           DFHEIV99,
 12121           DFHEIV99,
 12122           DFHEIV99
 12123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12124
 12125
 12126     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12127
 12128     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12129     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12130
 12131     IF PI-COMPANY-ID = 'BOA' AND
 12132        PI-PMTTYPE    = '2'   AND
 12133        PI-OFFLINE    = 'N'
 12134           GO TO 1441-COMPUTE-BOA-INTEREST.
 12135
 12136     IF PI-COMPANY-ID = 'NCL' AND
 12137        PI-PMTTYPE    = '2'   AND
 12138        PI-OFFLINE    = 'N'
 12139          GO TO 1442-COMPUTE-NCL-INTEREST
 12140       ELSE
 12141          GO TO 1445-CONTINUE.
 12142
 12143 1441-COMPUTE-BOA-INTEREST.
 12144     MOVE +0             TO WS-CALC-INT.
 12145
 12146     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12147     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12148     MOVE +0             TO DC-ELAPSED-MONTHS
 12149                            DC-ELAPSED-DAYS.
 12150     MOVE '1'            TO DC-OPTION-CODE.
 12151     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12152     IF NO-CONVERSION-ERROR
 12153         NEXT SENTENCE
 12154     ELSE
 12155         GO TO 1445-CONTINUE.
 12156
 12157     IF (PI-INT-RATE NOT > ZEROS)  AND
 12158        (DC-ELAPSED-DAYS > +30)
 12159         MOVE ER-3531            TO EMI-ERROR
 12160         MOVE -1                 TO PINTL
 12161         MOVE AL-UNBON           TO PINTA
 12162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12163
 12164     IF PI-EPYAMT NOT > ZEROS
 12165         GO TO 1445-CONTINUE.
 12166
 12167     IF (PI-INT-RATE NOT > ZEROS)  OR
 12168        (DC-ELAPSED-DAYS NOT > +30)
 12169         MOVE PI-EPYAMT TO PI-CPYAMT
 12170         GO TO 1441-FORMAT-NOTE.
 12171
 12172     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 233
* EL156.cbl
 12173                                 *  PI-INT-RATE
 12174                                 *  DC-ELAPSED-DAYS
 12175                                 /  365
 12176                                 /  100.
 12177
 12178     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12179
 12180 1441-FORMAT-NOTE.
 12181
 12182     MOVE SPACES        TO WS-BOANOTE1.
 12183     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12184     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12185     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12186     MOVE AL-UANON      TO NOTE1A.
 12187
 12188     IF WS-CALC-INT > ZEROS
 12189         MOVE SPACES        TO WS-BOANOTE2
 12190         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12191         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12192         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12193         MOVE AL-UANON      TO NOTE2A.
 12194
 12195     GO TO 1445-CONTINUE.
 12196
 12197 1442-COMPUTE-NCL-INTEREST.
 12198     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12199     MOVE PI-STATE               TO WS-ST-ACCESS.
 12200     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12201     MOVE '3'                    TO CNTL-REC-TYPE.
 12202     MOVE +0                     TO CNTL-SEQ-NO.
 12203     MOVE 'STAT'                 TO FILE-SWITCH.
 12204
 12205     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12206
 12207     MOVE +0                 TO WS-CALC-INT.
 12208
 12209     IF ST-STAT-FROM-INCURRED
 12210         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12211       ELSE
 12212     IF ST-STAT-FROM-REPORTED
 12213         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12214       ELSE
 12215         GO TO 1445-CONTINUE.
 12216
 12217     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12218     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12219     MOVE +0                 TO DC-ELAPSED-MONTHS
 12220                                DC-ELAPSED-DAYS.
 12221     MOVE '1'                TO DC-OPTION-CODE.
 12222     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12223     IF NO-CONVERSION-ERROR
 12224         NEXT SENTENCE
 12225     ELSE
 12226         GO TO 1445-CONTINUE.
 12227
 12228     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12229        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12230         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 234
* EL156.cbl
 12231
 12232     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12233                                 *  CF-ST-STAT-INTEREST.
 12234
 12235     MOVE SPACES              TO WS-NCLNOTE1.
 12236     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12237     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12238     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12239                                 PI-PMTNOTE1
 12240                                 NOTE1I.
 12241     MOVE AL-UANON            TO NOTE1A.
 12242
 12243     IF WS-CALC-INT > ZEROS
 12244         MOVE SPACES          TO WS-NCLNOTE2
 12245         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12246         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12247         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12248                                 PI-PMTNOTE2
 12249                                 NOTE2I
 12250         MOVE AL-UANON        TO NOTE2A.
 12251
 12252     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12253
 12254 1445-CONTINUE.
 12255
 12256     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12257        GO TO 1460-TEST-TYPE.
 12258
 12259     IF CM-O-B-COVERAGE
 12260        GO TO 1460-TEST-TYPE.
 12261
 12262     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12263         GO TO 1450-CHECK-MAX.
 12264
 12265     if pi-company-id = 'DCC'
 12266        and pdef-found
 12267        and pi-epyamt > pd-max-amt (p1)
 12268        move er-1657             to emi-error
 12269        perform 1490-payment-error
 12270                                 thru 1490-exit
 12271        go to 1460-test-type
 12272     else
 12273        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12274           > PI-EPYAMT)
 12275                         OR
 12276           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12277           < PI-EPYAMT)
 12278           MOVE ER-0594          TO EMI-ERROR
 12279           PERFORM 1490-PAYMENT-ERROR
 12280                                 THRU 1490-EXIT
 12281           GO TO 1460-TEST-TYPE
 12282        end-if
 12283     end-if
 12284     .
 12285 1450-CHECK-MAX.
 12286
 12287     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12288        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 235
* EL156.cbl
 12289         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12290                                   CM-LF-ITD-DEATH-AMT
 12291     ELSE
 12292         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12293                                   CL-TOTAL-PAID-AMT.
 12294
 12295     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12296          MOVE ER-0543           TO EMI-ERROR
 12297          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12298
 12299 1460-TEST-TYPE.
 12300
 12301     IF PI-PMT-APPR-SW = 'G'
 12302       NEXT SENTENCE
 12303     ELSE
 12304       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12305         IF PI-EPYAMT = ZERO
 12306             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12307                 MOVE ER-0494    TO  EMI-ERROR
 12308                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12309                 GO TO 1500-EDIT-EXPENSES
 12310             ELSE
 12311                 NEXT SENTENCE
 12312         ELSE
 12313             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12314                 MOVE ER-0494    TO  EMI-ERROR
 12315                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12316                 GO TO 1500-EDIT-EXPENSES.
 12317
 12318     IF PI-PMTTYPE NOT = '2' OR
 12319        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12320         GO TO 1500-EDIT-EXPENSES.
 12321
 12322     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12323     MOVE ER-0526                TO EMI-ERROR.
 12324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12325
 12326     IF EMI-ERROR-NUMBER (1) = '0526'
 12327        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12328
 12329     IF EMI-ERROR-NUMBER (2) = '0526'
 12330        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12331
 12332     GO TO 1500-EDIT-EXPENSES.
 12333
 12334 1490-PAYMENT-ERROR.
 12335     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12336
 12337     IF EMI-MESSAGE-FORMATTED
 12338         MOVE -1                 TO EPYAMTL
 12339         MOVE AL-UNBON           TO EPYAMTA.
 12340
 12341 1490-EXIT.
 12342      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 236
* EL156.cbl
 12344 1500-EDIT-EXPENSES.
 12345     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12346         GO TO 1500-SKIP-ERROR-0556.
 12347
 12348 1500-CONTINUE-ON.
 12349
 12350     IF CM-O-B-COVERAGE
 12351        MOVE ER-0556             TO EMI-ERROR
 12352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12353
 12354 1500-SKIP-ERROR-0556.
 12355     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12356        IF PI-EEXPENS NOT = ZEROS
 12357           MOVE ER-0524          TO EMI-ERROR
 12358           GO TO 1590-EXPENSE-ERROR
 12359        ELSE
 12360           GO TO 1600-EDIT-RESERVES.
 12361
 12362     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12363     MOVE '6'                    TO CNTL-REC-TYPE.
 12364
 12365     IF CONTROL-IS-ACTUAL-CARRIER
 12366         MOVE PI-CARRIER         TO WS-CARR
 12367     ELSE
 12368         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12369
 12370     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12371     MOVE +0                     TO CNTL-SEQ-NO.
 12372     MOVE 'CARR'                 TO FILE-SWITCH.
 12373
 12374     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12375
 12376     IF EXPENSE-CALC-MANUAL
 12377        GO TO 1600-EDIT-RESERVES.
 12378
 12379     IF DOLLARS-PER-PMT
 12380        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12381        GO TO 1600-EDIT-RESERVES.
 12382
 12383     IF DOLLARS-PER-MONTH AND
 12384        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12385       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12386       GO TO 1600-EDIT-RESERVES.
 12387
 12388     IF PERCENT-OF-PAYMENT
 12389        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12390
 12391     GO TO 1600-EDIT-RESERVES.
 12392
 12393 1590-EXPENSE-ERROR.
 12394     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12395
 12396     IF EMI-MESSAGE-FORMATTED
 12397        MOVE -1                  TO EEXPENSL
 12398        MOVE AL-UNBON            TO EEXPENSA.
 12399
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 237
* EL156.cbl
 12401 1600-EDIT-RESERVES.
 12402     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12403        IF PI-ERESV = ZEROS
 12404           GO TO 1700-EDIT-EXPENSE-TYPE
 12405        ELSE
 12406           MOVE ER-0525          TO EMI-ERROR
 12407           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12408           GO TO 1700-EDIT-EXPENSE-TYPE.
 12409
 12410     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12411     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12412     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12413
 12414     IF NOT AT-MANUAL-RESERVES-USED
 12415        IF PI-ERESV NOT = ZEROS
 12416           MOVE ER-0518          TO EMI-ERROR
 12417           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12418
 12419     IF AT-MANUAL-RESERVES-USED
 12420        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12421        GO TO 1700-EDIT-EXPENSE-TYPE.
 12422
 12423     IF AT-FUTURE-RESERVES-USED
 12424        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12425
 12426     IF AT-FUTURE-RESERVES-USED
 12427        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12428
 12429     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12430        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12431
 12432     IF AT-IBNR-RESERVES-USED
 12433        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12434
 12435     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12436     GO TO 1700-EDIT-EXPENSE-TYPE.
 12437
 12438 1690-RESERVE-ERROR.
 12439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12440
 12441     IF EMI-MESSAGE-FORMATTED
 12442        MOVE AL-UNBON            TO ERESVA
 12443        MOVE -1                  TO ERESVL.
 12444
 12445 1690-EXIT.
 12446      EXIT.
 12447
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 238
* EL156.cbl
 12449 1700-EDIT-EXPENSE-TYPE.
 12450     IF PI-PMTTYPE NOT = '5' AND '6'
 12451        GO TO 2000-EDIT-DONE.
 12452
 12453     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12454                   '6' OR '7' OR '8' OR '9'
 12455        GO TO 2000-EDIT-DONE.
 12456
 12457 1705-EXPENSE-ERROR.
 12458     MOVE ER-0573                TO EMI-ERROR.
 12459     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12460
 12461     IF EMI-MESSAGE-FORMATTED
 12462        MOVE AL-UABON            TO ETYPEA
 12463        MOVE -1                  TO ETYPEL.
 12464
 12465     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 239
* EL156.cbl
 12467 1950-NOT-FOUND.
 12468     IF FILE-SWITCH = 'MSTR'
 12469        MOVE ER-0204             TO EMI-ERROR.
 12470
 12471     IF FILE-SWITCH = 'CARR'
 12472        MOVE ER-0252             TO EMI-ERROR.
 12473
 12474     IF FILE-SWITCH = 'COMP'
 12475        MOVE ER-0254             TO EMI-ERROR.
 12476
 12477     IF FILE-SWITCH = 'STAT'
 12478        MOVE ER-0149             TO EMI-ERROR.
 12479
 12480     IF FILE-SWITCH = 'PROC'
 12481        MOVE ER-0019             TO EMI-ERROR.
 12482
 12483     IF FILE-SWITCH = 'ACCT'
 12484        MOVE ER-0198             TO EMI-ERROR.
 12485
 12486     IF FILE-SWITCH = 'BENE'
 12487        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12488           MOVE ER-0282          TO EMI-ERROR
 12489        ELSE
 12490           MOVE ER-0283          TO EMI-ERROR.
 12491
 12492     MOVE -1                     TO PMTTYPEL.
 12493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12494
 12495     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12496                                     WS-FORCE-CTR.
 12497
 12498     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12499                                     WS-FATAL-CTR.
 12500
 12501     GO TO 8200-SEND-DATAONLY.
 12502
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 240
* EL156.cbl
 12504 2000-EDIT-DONE.
 12505     if pi-company-id = 'DCC'
 12506        and cl-critical-period > 0
 12507        perform 2210-dcc-max-benes thru 2210-exit
 12508     else
 12509     IF (WS-SPECIAL-CALC-CD = 'C')
 12510*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12511        and (cl-critical-period > 0)
 12512        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12513           IF PI-EPYAMT > ZEROS
 12514              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12515                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12516           ELSE
 12517              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12518                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12519           END-IF
 12520*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12521           if ws-crit-period-days > cl-critical-period
 12522              MOVE ER-0657          TO EMI-ERROR
 12523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12524           END-IF
 12525        END-IF
 12526     END-IF
 12527     end-if
 12528     IF PI-HOLDTIL NOT = ZEROS
 12529        MOVE PI-HOLDTIL          TO HOLDTILO
 12530        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12531
 12532     IF PI-EPYFROM NOT = ZEROS
 12533        MOVE PI-EPYFROM          TO EPYFROMO
 12534        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12535
 12536     IF PI-EPYTHRU NOT = ZEROS
 12537        MOVE PI-EPYTHRU            TO EPYTHRUO
 12538        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12539        IF PI-USES-PAID-TO
 12540           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12541           MOVE '4'                TO DC-OPTION-CODE
 12542           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12543           IF NO-CONVERSION-ERROR
 12544              MOVE +1              TO DC-ELAPSED-DAYS
 12545              MOVE +0              TO DC-ELAPSED-MONTHS
 12546              MOVE '6'             TO DC-OPTION-CODE
 12547              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12548              IF NO-CONVERSION-ERROR
 12549                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12550
 12551     MOVE PI-EDAYS               TO EDAYSO.
 12552
 12553     IF PI-AIGFROM NOT = ZEROS
 12554        MOVE PI-AIGFROM          TO AIGFROMO
 12555        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12556
 12557     MOVE PI-EPYAMT              TO EPYAMTO.
 12558     MOVE PI-ERESV               TO ERESVO.
 12559     MOVE PI-EEXPENS             TO EEXPENSO.
 12560
 12561     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 241
* EL156.cbl
 12562     MOVE SPACES                 TO DC-OPTION-CODE.
 12563     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12564
 12565     IF DATE-CONVERSION-ERROR
 12566        MOVE SPACES              TO CPYFROMI
 12567     ELSE
 12568        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12569        IF PI-EPYFROM = ZEROS
 12570           MOVE AL-UANON             TO EPYFROMA
 12571           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12572           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12573
 12574     IF PI-USES-PAID-TO
 12575        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12576        MOVE +1                            TO DC-ELAPSED-DAYS
 12577        MOVE +0                            TO DC-ELAPSED-MONTHS
 12578        MOVE '6'                           TO DC-OPTION-CODE
 12579        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12580        IF NO-CONVERSION-ERROR
 12581           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12582           IF PI-EPYTHRU = ZEROS
 12583              MOVE AL-UANON                TO EPYTHRUA
 12584              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12585              MOVE ' '                     TO DC-OPTION-CODE
 12586              MOVE +0                      TO DC-ELAPSED-DAYS
 12587                                              DC-ELAPSED-MONTHS
 12588              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12589              IF NO-CONVERSION-ERROR
 12590                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12591                  GO TO 2001-CONTINUE
 12592              ELSE
 12593                  GO TO 2001-CONTINUE
 12594           ELSE
 12595              GO TO 2001-CONTINUE.
 12596
 12597     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12598     MOVE SPACES                 TO DC-OPTION-CODE.
 12599     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12600
 12601     IF DATE-CONVERSION-ERROR
 12602        MOVE SPACES              TO CPYTHRUI
 12603     ELSE
 12604        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12605        IF PI-EPYTHRU = ZEROS
 12606           MOVE AL-UANON TO EPYTHRUA
 12607           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12608           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12609
 12610 2001-CONTINUE.
 12611
 12612     MOVE PI-CDAYS               TO CDAYSO.
 12613
 12614     IF PI-EDAYS = ZEROS
 12615        MOVE AL-UNNON TO EDAYSA
 12616        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12617
 12618     MOVE PI-CPYAMT              TO CPYAMTO.
 12619
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 242
* EL156.cbl
 12620     IF PI-EPYAMT = ZEROS
 12621        MOVE AL-UNNON            TO EPYAMTA
 12622        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12623
 12624     MOVE PI-CRESV               TO CRESVO.
 12625     MOVE PI-CEXPENS             TO CEXPENSO.
 12626
 12627     IF PI-EEXPENS = ZEROS
 12628        MOVE AL-UNNON TO EEXPENSA
 12629        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12630
 12631     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12632        AND (CL-CLAIM-TYPE = 'L')
 12633        AND (PI-OFFLINE NOT EQUAL 'Y')
 12634        IF PI-PMTTYPE = '2' OR '4'
 12635           PERFORM 2200-CALC-INTEREST
 12636                                 THRU 2200-EXIT
 12637        END-IF
 12638     END-IF
 12639     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12640     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12641     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12642
 12643     IF EMI-FATAL-CTR = ZEROS
 12644        MOVE 'B'                 TO PI-PASS-SW.
 12645
 12646     IF NOT EMI-MESSAGE-FORMATTED
 12647         MOVE -1                 TO EPYFROML
 12648     ELSE
 12649         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12650            EMI-ERROR-NUMBER (2) = SPACES
 12651             MOVE -1             TO EPYFROML.
 12652
 12653     GO TO 8200-SEND-DATAONLY.
 12654
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 243
* EL156.cbl
 12656 2200-CALC-INTEREST.
 12657     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12658        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12659        MOVE '4'                 TO DC-OPTION-CODE
 12660        PERFORM 9700-LINK-DATE-CONVERT
 12661        IF DATE-CONVERSION-ERROR
 12662            MOVE LOW-VALUES      TO CP-PRF-DT
 12663        ELSE
 12664           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12665        END-IF
 12666     END-IF
 12667     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12668        IN CLAIM-INT-PASS-AREA
 12669     MOVE CL-CERT-STATE          TO CP-STATE
 12670        IN CLAIM-INT-PASS-AREA
 12671     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12672     MOVE 'LF'                   TO CP-COVERAGE
 12673     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12674     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12675     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12676     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12677     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12678     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12679
 12680* EXEC CICS LINK
 12681*       PROGRAM   ('ELCLMI')
 12682*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12683*       LENGTH    (CP-CLAIM-LENGTH)
 12684*    END-EXEC
 12685     MOVE 'ELCLMI' TO DFHEIV1
 12686*    MOVE '."C                   (   #00012092' TO DFHEIV0
 12687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12689     MOVE X'2020233030303132303932' TO DFHEIV0(25:11)
 12690     CALL 'kxdfhei1' USING DFHEIV0,
 12691           DFHEIV1,
 12692           CLAIM-INT-PASS-AREA,
 12693           CP-CLAIM-LENGTH,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99,
 12697           DFHEIV99
 12698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12699     MOVE AL-PANOF               TO PINTHA
 12700                                    PINTA
 12701     IF NO-CI-ERROR
 12702        MOVE CP-CLM-INT-AMT      TO PINTO
 12703                                    PI-INT-AMT
 12704        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12705        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12706        MOVE AL-PANOF            TO PINTHA
 12707                                    PINTA
 12708     ELSE
 12709        IF CI-RETURN-CODE = '8'
 12710           MOVE ER-3818          TO EMI-ERROR
 12711           MOVE -1               TO ZINTL
 12712           PERFORM 9900-ERROR-FORMAT
 12713                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 244
* EL156.cbl
 12714           GO TO 2200-EXIT
 12715        ELSE
 12716           MOVE ZEROS            TO PINTO
 12717                                    PI-INT-AMT
 12718                                    PI-INT-DAYS
 12719                                    PI-INT-RATE-USED
 12720        END-IF
 12721     END-IF
 12722     IF PI-INT-AMT NOT = ZEROS
 12723        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12724           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12725           CONTINUE
 12726        ELSE
 12727           MOVE CL-SOC-SEC-NO (1:3)
 12728                                 TO WS-SSN (1:3)
 12729           MOVE CL-SOC-SEC-NO (5:2)
 12730                                 TO WS-SSN (4:2)
 12731           MOVE CL-SOC-SEC-NO (8:4)
 12732                                 TO WS-SSN (6:4)
 12733           IF (WS-SSN NUMERIC)
 12734              AND (WS-SSN NOT = ZEROS)
 12735              CONTINUE
 12736           ELSE
 12737              MOVE ER-2044       TO EMI-ERROR
 12738              PERFORM 9900-ERROR-FORMAT
 12739                                 THRU 9900-EXIT
 12740           END-IF
 12741        END-IF
 12742        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12743        MOVE +51                 TO TRLR-SEQ-NO
 12744
 12745* EXEC CICS READ
 12746*          DATASET  ('ELTRLR')
 12747*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12748*          RIDFLD   (ELTRLR-KEY)
 12749*          RESP     (WS-RESPONSE)
 12750*       END-EXEC
 12751     MOVE 'ELTRLR' TO DFHEIV1
 12752*    MOVE '&"S        E          (  N#00012142' TO DFHEIV0
 12753     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12755     MOVE X'204E233030303132313432' TO DFHEIV0(25:11)
 12756     CALL 'kxdfhei1' USING DFHEIV0,
 12757           DFHEIV1,
 12758           DFHEIV20,
 12759           DFHEIV99,
 12760           ELTRLR-KEY,
 12761           DFHEIV99,
 12762           DFHEIV99,
 12763           DFHEIV99
 12764     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12765         DFHEIV20
 12766     MOVE EIBRESP  TO WS-RESPONSE
 12767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12768        IF (NOT WS-RESP-NORMAL)
 12769                    OR
 12770           ((WS-RESP-NORMAL)
 12771           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 245
* EL156.cbl
 12772           OR (AT-CITY-STATE = SPACES)))
 12773           MOVE ER-0874          TO EMI-ERROR
 12774           PERFORM 9900-ERROR-FORMAT
 12775                                 THRU 9900-EXIT
 12776        END-IF
 12777     END-IF
 12778     .
 12779 2200-EXIT.
 12780     EXIT.
 12781 2210-dcc-max-benes.
 12782
 12783     move cm-ah-benefit-amt      to ws-monthly-benefit
 12784     if pdef-found
 12785        and pd-max-amt (p1) < ws-monthly-benefit
 12786        move pd-max-amt (p1)     to ws-monthly-benefit
 12787     end-if
 12788
 12789     move cl-cert-key-data       to elcrtt-key (2:21)
 12790     move cl-company-cd          to ctrlr-comp-cd
 12791     move cl-cert-no             to ctrlr-cert-no
 12792     move 'B'                    to ctrlr-rec-type
 12793
 12794
 12795* EXEC CICS READ
 12796*       DATASET  ('ELCRTT')
 12797*       set      (address of CERTIFICATE-TRAILERS)
 12798*       RIDFLD   (ELCRTT-KEY)
 12799*       RESP     (WS-RESPONSE)
 12800*    END-EXEC
 12801     MOVE 'ELCRTT' TO DFHEIV1
 12802*    MOVE '&"S        E          (  N#00012174' TO DFHEIV0
 12803     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12805     MOVE X'204E233030303132313734' TO DFHEIV0(25:11)
 12806     CALL 'kxdfhei1' USING DFHEIV0,
 12807           DFHEIV1,
 12808           DFHEIV20,
 12809           DFHEIV99,
 12810           ELCRTT-KEY,
 12811           DFHEIV99,
 12812           DFHEIV99,
 12813           DFHEIV99
 12814     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12815         DFHEIV20
 12816     MOVE EIBRESP  TO WS-RESPONSE
 12817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12818     IF not WS-RESP-NORMAL
 12819        go to 2210-exit
 12820     end-if
 12821
 12822*    if instypei = 'P'
 12823*       move +1 to s1
 12824*    else
 12825*       MOVE +2 to s1
 12826*    end-if
 12827
 12828     move +1 to s1
 12829     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 246
* EL156.cbl
 12830        when 'A'
 12831           move +1 to s2
 12832        when 'I'
 12833           move +2 to s2
 12834        when 'G'
 12835           move +3 to s2
 12836        when 'L'
 12837           move +4 to s2
 12838        when 'P'
 12839           move +5 to s2
 12840     end-evaluate
 12841
 12842     if pi-epyamt > zeros
 12843        compute ws-crit-period-days =
 12844           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12845           / ws-monthly-benefit
 12846     else
 12847        compute ws-crit-period-days =
 12848           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12849           / ws-monthly-benefit
 12850     end-if
 12851
 12852     if ws-crit-period-days > cl-critical-period
 12853*    if ws-crit-period-days > pd-crit-period (p1)
 12854        move er-1658             to emi-error
 12855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12856     end-if
 12857
 12858     .
 12859 2210-exit.
 12860     exit.
 12861
 12862 2220-update-elcrtt.
 12863
 12864
 12865* EXEC CICS GETMAIN
 12866*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12867*       LENGTH   (ELCRTT-LENGTH)
 12868*       INITIMG  (GETMAIN-SPACE)
 12869*    END-EXEC
 12870*    MOVE ',"IL                  $   #00012226' TO DFHEIV0
 12871     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12872     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12873     MOVE X'2020233030303132323236' TO DFHEIV0(25:11)
 12874     CALL 'kxdfhei1' USING DFHEIV0,
 12875           DFHEIV20,
 12876           ELCRTT-LENGTH,
 12877           GETMAIN-SPACE
 12878     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12879         DFHEIV20
 12880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12881
 12882     move cl-cert-key-data       to elcrtt-key (2:21)
 12883     move cl-company-cd          to ctrlr-comp-cd
 12884     move cl-cert-no             to ctrlr-cert-no
 12885     move 'B'                    to ctrlr-rec-type
 12886
 12887
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 247
* EL156.cbl
 12888* EXEC CICS READ
 12889*       UPDATE
 12890*       DATASET  (ELCRTT-DSID)
 12891*       into     (CERTIFICATE-TRAILERS)
 12892*       RIDFLD   (ELCRTT-KEY)
 12893*       RESP     (WS-RESPONSE)
 12894*    END-EXEC
 12895     MOVE LENGTH OF
 12896      CERTIFICATE-TRAILERS
 12897       TO DFHEIV11
 12898*    MOVE '&"IL       EU         (  N#00012237' TO DFHEIV0
 12899     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12900     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12901     MOVE X'204E233030303132323337' TO DFHEIV0(25:11)
 12902     CALL 'kxdfhei1' USING DFHEIV0,
 12903           ELCRTT-DSID,
 12904           CERTIFICATE-TRAILERS,
 12905           DFHEIV11,
 12906           ELCRTT-KEY,
 12907           DFHEIV99,
 12908           DFHEIV99,
 12909           DFHEIV99
 12910     MOVE EIBRESP  TO WS-RESPONSE
 12911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12912
 12913     IF WS-RESP-NORMAL
 12914        perform 2225-upd-crt-trlr thru 2225-exit
 12915
 12916* EXEC CICS REWRITE
 12917*          DATASET  (ELCRTT-DSID)
 12918*          from     (CERTIFICATE-TRAILERS)
 12919*          RESP     (WS-RESPONSE)
 12920*       END-EXEC
 12921     MOVE LENGTH OF
 12922      CERTIFICATE-TRAILERS
 12923       TO DFHEIV11
 12924*    MOVE '&& L                  %  N#00012247' TO DFHEIV0
 12925     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12926     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12927     MOVE X'204E233030303132323437' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0,
 12929           ELCRTT-DSID,
 12930           CERTIFICATE-TRAILERS,
 12931           DFHEIV11,
 12932           DFHEIV99
 12933     MOVE EIBRESP  TO WS-RESPONSE
 12934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12935     else
 12936        if ws-resp-notfnd
 12937           move 'CS'             to certificate-trailers
 12938           move cl-company-cd    to cs-company-cd
 12939           move cl-cert-key-data to cs-control-primary (2:21)
 12940           move cl-cert-no       to cs-cert-no
 12941           move 'B'              to cs-trailer-type
 12942           perform varying s1 from +1 by +1 until s1 > +2
 12943              perform varying s2 from +1 by +1 until s2 > +10
 12944                 move zeros      to cs-bank (s1 s2)
 12945                                    cs-no-of-claims (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 248
* EL156.cbl
 12946                                    cs-days-paid (s1 s2)
 12947                                    cs-total-paid (s1 s2)
 12948              end-perform
 12949           end-perform
 12950           perform 2225-upd-crt-trlr
 12951                                 thru 2225-exit
 12952
 12953* EXEC CICS WRITE
 12954*             DATASET  (ELCRTT-DSID)
 12955*             from     (CERTIFICATE-TRAILERS)
 12956*             RIDFLD   (cs-control-primary)
 12957*             RESP     (WS-RESPONSE)
 12958*          END-EXEC
 12959     MOVE LENGTH OF
 12960      CERTIFICATE-TRAILERS
 12961       TO DFHEIV11
 12962*    MOVE '&$ L                  ''  N#00012269' TO DFHEIV0
 12963     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12965     MOVE X'204E233030303132323639' TO DFHEIV0(25:11)
 12966     CALL 'kxdfhei1' USING DFHEIV0,
 12967           ELCRTT-DSID,
 12968           CERTIFICATE-TRAILERS,
 12969           DFHEIV11,
 12970           cs-control-primary,
 12971           DFHEIV99,
 12972           DFHEIV99
 12973     MOVE EIBRESP  TO WS-RESPONSE
 12974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12975        end-if
 12976     END-IF
 12977
 12978     .
 12979 2220-exit.
 12980     exit.
 12981
 12982 2225-upd-crt-trlr.
 12983
 12984*    if instypei = 'P'
 12985*       move +1 to s1
 12986*    else
 12987*       MOVE +2 to s1
 12988*    end-if
 12989
 12990     move +1 to s1
 12991     evaluate cl-claim-type
 12992        when 'A'
 12993           move +1 to s2
 12994        when 'I'
 12995           move +2 to s2
 12996        when 'G'
 12997           move +3 to s2
 12998        when 'L'
 12999           move +4 to s2
 13000        when 'P'
 13001           move +5 to s2
 13002     end-evaluate
 13003
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 249
* EL156.cbl
 13004     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
 13005        at-amount-paid
 13006     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 13007        at-days-in-period
 13008
 13009     .
 13010 2225-exit.
 13011     exit.
 13012 3000-MOVE-INPUT-TO-SAVE-AREA.
 13013     IF PMTTYPEL > 0
 13014         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13015
 13016     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13017
 13018     IF WS-PMTTYPE = '9'
 13019         MOVE 'P'                TO PI-PROVISIONAL-IND
 13020         MOVE '1'                TO WS-PMTTYPE.
 13021
 13022     IF PAYEEL > 0
 13023         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13024         MOVE PAYEEI             TO WS-PAYEE.
 13025
 13026     IF NOTE1L > +0
 13027         MOVE NOTE1I             TO WS-PMTNOTE1
 13028                                    WS-FLI-PMTNOTE
 13029                                    WS-HAN-PMTNOTE.
 13030
 13031     IF NOTE2L > +0
 13032         MOVE NOTE2I             TO WS-PMTNOTE2.
 13033
 13034     IF OFFLINEL > 0
 13035         MOVE OFFLINEI           TO WS-OFFLINE.
 13036
 13037     IF PROOFDTL > 0
 13038         MOVE PROOFDTI            TO DATE-WORK
 13039         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13040         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13041         MOVE '4'                 TO DC-OPTION-CODE
 13042         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13043         IF NO-CONVERSION-ERROR
 13044            MOVE NUM-WORK         TO PROOFDTO
 13045            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13046            MOVE NUM-WORK         TO WS-PROOF-DATE
 13047         ELSE
 13048            MOVE ZEROS            TO WS-PROOF-DATE
 13049         END-IF
 13050     END-IF.
 13051
 13052     IF EOBYNL > +0
 13053         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13054         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13055     END-IF
 13056
 13057     IF CLMFMYNL > +0
 13058         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13059         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13060     END-IF
 13061
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 250
* EL156.cbl
 13062     IF SURVYYNL > +0
 13063         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13064         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13065     END-IF
 13066
 13067     IF SPRELYNL > +0
 13068         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13069         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13070     END-IF
 13071*    IF GROUPEDL > +0
 13072*        MOVE GROUPEDI           TO WS-GROUPED.
 13073*
 13074*    IF CASHL > +0
 13075*       MOVE CASHI               TO WS-CASH.
 13076     IF LOANNOL > +0
 13077         MOVE LOANNOI            TO WS-LOAN-NO.
 13078
 13079     IF CHECKNOL > 0
 13080         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13081
 13082     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13083         IF WS-AIG-CREDIT-ENTERED
 13084             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13085             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13086             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13087             MOVE AL-UANON         TO CHECKNOA.
 13088
 13089     IF HOLDTILL > 0
 13090         MOVE HOLDTILI           TO DATE-WORK
 13091         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13092         MOVE NUM-WORK           TO WS-HOLDTIL.
 13093
 13094     IF ZINTL > +0
 13095
 13096* EXEC CICS BIF DEEDIT
 13097*           FIELD   (ZINTI)
 13098*           LENGTH  (07)
 13099*       END-EXEC
 13100     MOVE 07
 13101       TO DFHEIV11
 13102*    MOVE '@"L                   #   #00012395' TO DFHEIV0
 13103     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13104     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13105     MOVE X'2020233030303132333935' TO DFHEIV0(25:11)
 13106     CALL 'kxdfhei1' USING DFHEIV0,
 13107           ZINTI,
 13108           DFHEIV11
 13109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13110        IF ZINTI NOT NUMERIC
 13111           MOVE ER-0419          TO EMI-ERROR
 13112           PERFORM 9900-ERROR-FORMAT
 13113           MOVE AL-UABON         TO ZINTA
 13114           MOVE -1               TO ZINTL
 13115        ELSE
 13116           MOVE ZINTI            TO CP-INT-RATE
 13117                                    WS-INT-RATE
 13118           MOVE CP-INT-RATE      TO ZINTO
 13119           MOVE AL-UNNON         TO ZINTA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 251
* EL156.cbl
 13120        END-IF
 13121     ELSE
 13122        MOVE ZEROS               TO CP-INT-RATE
 13123     END-IF
 13124     IF EPYFROML > 0
 13125         MOVE EPYFROMI           TO DATE-WORK
 13126         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13127         MOVE NUM-WORK           TO WS-EPYFROM.
 13128
 13129     IF AIGFROML > 0
 13130         MOVE AIGFROMI           TO DATE-WORK
 13131         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13132         MOVE NUM-WORK           TO WS-AIGFROM
 13133     ELSE
 13134         IF (AIGFROMI = LOW-VALUES) AND
 13135            (PI-AIGFROM NOT = ZEROS)
 13136              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13137
 13138     IF EPYTHRUL > +0
 13139        MOVE EPYTHRUI           TO DATE-WORK
 13140        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13141        MOVE NUM-WORK           TO WS-EPYTHRU
 13142        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13143        MOVE '4'                TO DC-OPTION-CODE
 13144        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13145        IF NO-CONVERSION-ERROR
 13146           IF PI-USES-PAID-TO
 13147              MOVE '6'                TO DC-OPTION-CODE
 13148              MOVE -1                 TO DC-ELAPSED-DAYS
 13149              MOVE +0                 TO DC-ELAPSED-MONTHS
 13150              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13151              IF NO-CONVERSION-ERROR
 13152                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13153                 MOVE ' '             TO DC-OPTION-CODE
 13154                 MOVE +0              TO DC-ELAPSED-DAYS
 13155                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13156              IF NO-CONVERSION-ERROR
 13157                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13158
 13159*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13160*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13161     IF EDAYSL > 0
 13162
 13163* EXEC CICS BIF DEEDIT
 13164*            FIELD(EDAYSI)
 13165*            LENGTH(6)
 13166*        END-EXEC
 13167     MOVE 6
 13168       TO DFHEIV11
 13169*    MOVE '@"L                   #   #00012451' TO DFHEIV0
 13170     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13171     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13172     MOVE X'2020233030303132343531' TO DFHEIV0(25:11)
 13173     CALL 'kxdfhei1' USING DFHEIV0,
 13174           EDAYSI,
 13175           DFHEIV11
 13176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13177         MOVE EDAYSI             TO WS-DY-WORK
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 252
* EL156.cbl
 13178         IF WS-DY-SIGN = SPACES
 13179            MOVE WS-DY-NUM       TO WS-EDAYS
 13180            ADD 0                TO WS-EDAYS
 13181         ELSE
 13182            MOVE EDAYSI          TO WS-EDAYS
 13183            ADD 0                TO WS-EDAYS.
 13184
 13185*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13186*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13187     IF EPYAMTL > 0
 13188
 13189* EXEC CICS BIF DEEDIT
 13190*            FIELD(EPYAMTI)
 13191*            LENGTH(10)
 13192*        END-EXEC
 13193     MOVE 10
 13194       TO DFHEIV11
 13195*    MOVE '@"L                   #   #00012466' TO DFHEIV0
 13196     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13197     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13198     MOVE X'2020233030303132343636' TO DFHEIV0(25:11)
 13199     CALL 'kxdfhei1' USING DFHEIV0,
 13200           EPYAMTI,
 13201           DFHEIV11
 13202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13203         MOVE EPYAMTI            TO WS-PY-WORK
 13204         IF WS-PY-SIGN = SPACES
 13205            MOVE WS-PY-NUM       TO WS-EPYAMT
 13206            ADD 0                TO WS-EPYAMT
 13207         ELSE
 13208            MOVE EPYAMTI         TO WS-EPYAMT
 13209            ADD 0                TO WS-EPYAMT.
 13210
 13211     IF ERESVL > 0
 13212
 13213* EXEC CICS BIF DEEDIT
 13214*            FIELD(ERESVI)
 13215*            LENGTH(9)
 13216*        END-EXEC
 13217     MOVE 9
 13218       TO DFHEIV11
 13219*    MOVE '@"L                   #   #00012479' TO DFHEIV0
 13220     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13221     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13222     MOVE X'2020233030303132343739' TO DFHEIV0(25:11)
 13223     CALL 'kxdfhei1' USING DFHEIV0,
 13224           ERESVI,
 13225           DFHEIV11
 13226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13227         MOVE ERESVI TO WS-ERESV.
 13228
 13229     IF EEXPENSL > 0
 13230
 13231* EXEC CICS BIF DEEDIT
 13232*            FIELD(EEXPENSI)
 13233*            LENGTH(8)
 13234*        END-EXEC
 13235     MOVE 8
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 253
* EL156.cbl
 13236       TO DFHEIV11
 13237*    MOVE '@"L                   #   #00012486' TO DFHEIV0
 13238     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13239     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13240     MOVE X'2020233030303132343836' TO DFHEIV0(25:11)
 13241     CALL 'kxdfhei1' USING DFHEIV0,
 13242           EEXPENSI,
 13243           DFHEIV11
 13244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13245         MOVE EEXPENSI           TO WS-EEXPENS.
 13246
 13247     IF ETYPEL > ZEROS
 13248         MOVE ETYPEI             TO WS-ETYPE.
 13249
 13250     IF PI-COMPANY-ID = 'BOA'
 13251        IF PINTL > ZEROS
 13252
 13253* EXEC CICS BIF DEEDIT
 13254*            FIELD (PINTI)
 13255*            LENGTH(05)
 13256*          END-EXEC
 13257     MOVE 05
 13258       TO DFHEIV11
 13259*    MOVE '@"L                   #   #00012497' TO DFHEIV0
 13260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13262     MOVE X'2020233030303132343937' TO DFHEIV0(25:11)
 13263     CALL 'kxdfhei1' USING DFHEIV0,
 13264           PINTI,
 13265           DFHEIV11
 13266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13267           IF PINTI NUMERIC
 13268               MOVE AL-UNNON     TO PINTA
 13269               MOVE PINTI        TO WS-INT-RATE
 13270               MOVE WS-INT-RATE  TO PINTO.
 13271
 13272 3000-EXIT.
 13273     EXIT.
 13274
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 254
* EL156.cbl
 13276 3050-REBUILD-ENTERED.
 13277
 13278     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13279
 13280     IF PI-PROV-PMT
 13281         MOVE '9'           TO PMTTYPEO
 13282     ELSE
 13283         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13284
 13285     MOVE PI-PAYEE          TO PAYEEO.
 13286     MOVE PI-PMTNOTE1       TO NOTE1O.
 13287     MOVE PI-PMTNOTE2       TO NOTE2O.
 13288     MOVE PI-OFFLINE        TO OFFLINEO.
 13289     IF PI-PROOF-DATE NOT = ZEROS
 13290         MOVE PI-PROOF-DATE TO PROOFDTO
 13291         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13292     END-IF.
 13293*    MOVE PI-GROUPED        TO GROUPEDO.
 13294
 13295*    MOVE PI-CASH           TO CASHO.
 13296
 13297     IF PI-INT-RATE > ZEROS
 13298         MOVE PI-INT-RATE   TO PINTO.
 13299
 13300     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13301        IF PI-INT-AMT > ZEROS
 13302           MOVE PI-INT-AMT       TO PINTO
 13303           MOVE AL-PANOF         TO PINTA
 13304                                    PINTHA
 13305        END-IF
 13306     END-IF
 13307     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13308     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13309     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13310     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13311     IF PI-HOLDTIL NOT = ZEROS
 13312        MOVE PI-HOLDTIL          TO HOLDTILO
 13313        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13314
 13315     IF PI-EPYFROM NOT = ZEROS
 13316        MOVE PI-EPYFROM          TO EPYFROMO
 13317        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13318
 13319     IF PI-AIGFROM NOT = ZEROS
 13320        MOVE PI-AIGFROM          TO AIGFROMO
 13321        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13322
 13323     IF PI-EPYTHRU NOT = ZEROS
 13324        MOVE PI-EPYTHRU          TO EPYTHRUO
 13325        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13326        IF PI-USES-PAID-TO
 13327           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13328           MOVE '4'                TO DC-OPTION-CODE
 13329           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13330           IF NO-CONVERSION-ERROR
 13331              MOVE +1 TO DC-ELAPSED-DAYS
 13332              MOVE +0 TO DC-ELAPSED-MONTHS
 13333              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 255
* EL156.cbl
 13334              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13335              IF NO-CONVERSION-ERROR
 13336                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13337
 13338     IF PI-EDAYS NOT = ZEROS
 13339        MOVE PI-EDAYS TO EDAYSO.
 13340
 13341     IF PI-EPYAMT NOT = ZEROS
 13342        MOVE PI-EPYAMT TO EPYAMTO.
 13343
 13344     IF PI-ERESV NOT = ZEROS
 13345        MOVE PI-ERESV TO ERESVO.
 13346
 13347     IF PI-EEXPENS NOT = ZEROS
 13348        MOVE PI-EEXPENS TO EEXPENSO.
 13349
 13350     MOVE PI-ETYPE TO ETYPEO.
 13351
 13352     IF PI-ECHECKNO NOT = SPACES
 13353        MOVE PI-ECHECKNO         TO CHECKNOO
 13354     ELSE
 13355        MOVE PI-CCHECKNO         TO CHECKNOO.
 13356
 13357     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13358     MOVE SPACES                 TO DC-OPTION-CODE.
 13359     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13360
 13361     IF DATE-CONVERSION-ERROR
 13362        MOVE SPACES              TO CPYFROMI
 13363     ELSE
 13364        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13365
 13366     IF PI-USES-PAID-TO
 13367        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13368        MOVE +1                  TO DC-ELAPSED-DAYS
 13369        MOVE +0                  TO DC-ELAPSED-MONTHS
 13370        MOVE '6'                 TO DC-OPTION-CODE
 13371        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13372        IF NO-CONVERSION-ERROR
 13373           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13374           GO TO 3051-CONTINUE.
 13375
 13376     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13377     MOVE SPACES                 TO DC-OPTION-CODE.
 13378     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13379
 13380     IF DATE-CONVERSION-ERROR
 13381        MOVE SPACES              TO CPYTHRUI
 13382     ELSE
 13383        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13384
 13385 3051-CONTINUE.
 13386
 13387     IF PI-CDAYS NOT = ZEROS
 13388        MOVE PI-CDAYS TO CDAYSO.
 13389
 13390     IF PI-CPYAMT NOT = ZEROS
 13391        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 256
* EL156.cbl
 13392
 13393     IF PI-CRESV NOT = ZEROS
 13394        MOVE PI-CRESV TO CRESVO.
 13395
 13396     IF PI-CEXPENS NOT = ZEROS
 13397        MOVE PI-CEXPENS TO CEXPENSO.
 13398
 13399 3059-EXIT.
 13400     EXIT.
 13401
 13402 3100-DEEDIT-DATE.
 13403
 13404* EXEC CICS BIF DEEDIT
 13405*        FIELD(DATE-WORK)
 13406*        LENGTH(8)
 13407*    END-EXEC.
 13408     MOVE 8
 13409       TO DFHEIV11
 13410*    MOVE '@"L                   #   #00012637' TO DFHEIV0
 13411     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13412     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13413     MOVE X'2020233030303132363337' TO DFHEIV0(25:11)
 13414     CALL 'kxdfhei1' USING DFHEIV0,
 13415           DATE-WORK,
 13416           DFHEIV11
 13417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13418
 13419
 13420 3100-EXIT.
 13421     EXIT.
 13422
 13423 3200-CALC-AIG-DAYS.
 13424
 13425     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13426
 13427     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13428     MOVE ' '                    TO DC-OPTION-CODE.
 13429     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13430     IF NO-CONVERSION-ERROR
 13431         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13432     ELSE
 13433         GO TO 3290-ERROR.
 13434
 13435     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13436         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13437                                WS-BIN-FROM-DT
 13438     ELSE
 13439         IF CL-TOTAL-PAID-AMT > ZEROS
 13440             IF WS-SV-EPYFROM = LOW-VALUES
 13441                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13442                                        WS-BIN-FROM-DT
 13443             ELSE
 13444                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13445                                        WS-BIN-FROM-DT
 13446         ELSE
 13447             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13448                                        WS-BIN-FROM-DT.
 13449
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 257
* EL156.cbl
 13450 3210-CONTINUE.
 13451
 13452     MOVE ' '                    TO DC-OPTION-CODE.
 13453     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13454     IF DATE-CONVERSION-ERROR
 13455         GO TO 3290-ERROR.
 13456
 13457     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13458
 13459     IF PI-LOAN-DUE-DAY = 31
 13460         MOVE 30              TO WS-PMT-DUE-DA
 13461                                 WS-SAVE-DUE-DA
 13462     ELSE
 13463         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13464                                 WS-SAVE-DUE-DA.
 13465
 13466     IF (PI-LOAN-DUE-DAY > 28) AND
 13467        (WS-PMT-DUE-MO = 2)
 13468         MOVE 'Y'                TO WS-DUE-DAY-SW
 13469         MOVE 28                 TO WS-PMT-DUE-DA.
 13470
 13471     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13472     MOVE '4'                    TO DC-OPTION-CODE.
 13473     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13474     IF NO-CONVERSION-ERROR
 13475         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13476     ELSE
 13477         GO TO 3290-ERROR.
 13478
 13479*--------------------------------------------------------------*
 13480*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13481*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13482*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13483*                                                              *
 13484*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13485*             INCURRED DATE      - 04/15/91                    *
 13486*             PMT DUE DATE       - 04/03/91                    *
 13487*             PMT DUE DATE       - 05/03/91                    *
 13488*--------------------------------------------------------------*
 13489
 13490     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13491        (WS-SV-AIGFROM = LOW-VALUES)
 13492         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13493            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13494             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13495             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13496             IF NO-CONVERSION-ERROR
 13497                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13498                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13499             ELSE
 13500                 GO TO 3290-ERROR.
 13501
 13502     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13503        (WS-SV-AIGFROM = LOW-VALUES)
 13504         GO TO 3205-CONT-CALC-PMT.
 13505
 13506     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13507     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 258
* EL156.cbl
 13508     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13509     IF NO-CONVERSION-ERROR
 13510         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13511     ELSE
 13512         GO TO 3290-ERROR.
 13513
 13514     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13515        (WS-PMT-DUE-DA < WS-FROM-DA)
 13516          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13517          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13518          IF NO-CONVERSION-ERROR
 13519              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13520              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13521          ELSE
 13522              GO TO 3290-ERROR.
 13523
 13524 3205-CONT-CALC-PMT.
 13525
 13526*--------------------------------------------------------------*
 13527*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13528*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13529*--------------------------------------------------------------*
 13530
 13531     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13532        PI-PMTTYPE = '2'
 13533          NEXT SENTENCE
 13534     ELSE
 13535        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13536           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13537             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13538             MOVE ER-3527            TO EMI-ERROR
 13539             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540             MOVE -1                 TO EPYTHRUL
 13541             MOVE AL-UNBON           TO EPYTHRUA
 13542                                        EPYFROMA
 13543             GO TO 3299-EXIT.
 13544
 13545*--------------------------------------------------------------*
 13546*    CALCULATE RETRO ELIMINATION DATE                          *
 13547*--------------------------------------------------------------*
 13548
 13549     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13550         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13551     ELSE
 13552         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13553
 13554     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13555     MOVE +0             TO DC-ELAPSED-MONTHS.
 13556     MOVE '6'            TO DC-OPTION-CODE.
 13557     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13558     IF NO-CONVERSION-ERROR
 13559         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13560     ELSE
 13561         GO TO 3290-ERROR.
 13562
 13563 3210-CHECK-PMT-DATE.
 13564
 13565*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 259
* EL156.cbl
 13566*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13567*    THE ENTERED PAY FROM DATE                                 *
 13568*--------------------------------------------------------------*
 13569
 13570     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13571         NEXT SENTENCE
 13572     ELSE
 13573         GO TO 3220-COMPUTE-DAYS.
 13574
 13575     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13576     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13577     IF NO-CONVERSION-ERROR
 13578         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13579         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13580         GO TO 3210-CHECK-PMT-DATE
 13581     ELSE
 13582         GO TO 3290-ERROR.
 13583
 13584 3220-COMPUTE-DAYS.
 13585
 13586     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13587     MOVE ZEROS         TO WS-CDAYS.
 13588     MOVE 'N'           TO WS-ELIMINATION-SW.
 13589
 13590*--------------------------------------------------------------*
 13591*    COMPUTE CALIFORNIA DUE DAYS                               *
 13592*--------------------------------------------------------------*
 13593
 13594     IF CL-TOTAL-PAID-AMT > ZEROS
 13595         MOVE 'Y' TO WS-ELIMINATION-SW
 13596         GO TO 3240-FIRST-PMT-DUE
 13597     ELSE
 13598        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13599            NEXT SENTENCE
 13600        ELSE
 13601            GO TO 3240-FIRST-PMT-DUE.
 13602
 13603 3230-NEXT-PMT-DUE.
 13604
 13605     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13606     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13607     IF NO-CONVERSION-ERROR
 13608         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13609         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13610     ELSE
 13611         GO TO 3290-ERROR.
 13612
 13613 3240-FIRST-PMT-DUE.
 13614
 13615     IF CL-TOTAL-PAID-AMT > ZEROS
 13616         NEXT SENTENCE
 13617     ELSE
 13618        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13619            GO TO 3230-NEXT-PMT-DUE.
 13620
 13621     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13622         GO TO 3250-VERIFY-ELIMINATION.
 13623
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 260
* EL156.cbl
 13624     ADD +30 TO WS-CDAYS.
 13625     MOVE 'Y' TO WS-ELIMINATION-SW.
 13626     GO TO 3230-NEXT-PMT-DUE.
 13627
 13628 3250-VERIFY-ELIMINATION.
 13629
 13630     IF ELIM-SATISFIED
 13631         GO TO 3260-END-CALC.
 13632
 13633     IF PI-PMTTYPE = '1'
 13634         MOVE ZEROS TO WS-CDAYS
 13635         GO TO 3260-END-CALC.
 13636
 13637     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13638         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13639     ELSE
 13640         IF CL-TOTAL-PAID-AMT > ZEROS
 13641             IF WS-SV-EPYFROM = LOW-VALUES
 13642                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13643             ELSE
 13644                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13645         ELSE
 13646             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13647
 13648     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13649     MOVE '1'                    TO DC-OPTION-CODE.
 13650     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13651     IF NO-CONVERSION-ERROR
 13652         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13653     ELSE
 13654         GO TO 3290-ERROR.
 13655
 13656     IF CL-TOTAL-PAID-AMT > ZEROS
 13657         MOVE WS-DAYS-OFF TO WS-CDAYS
 13658     ELSE
 13659         IF PI-BEN-DAYS > WS-DAYS-OFF
 13660             MOVE ZEROS TO WS-CDAYS
 13661         ELSE
 13662             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13663
 13664 3260-END-CALC.
 13665
 13666     MOVE WS-CDAYS TO PI-CDAYS.
 13667
 13668     IF PI-EDAYS = ZEROS
 13669         MOVE PI-CDAYS TO PI-EDAYS
 13670         MOVE AL-UNNON TO EDAYSA.
 13671
 13672     GO TO 3299-EXIT.
 13673
 13674 3290-ERROR.
 13675
 13676     MOVE ER-3528            TO EMI-ERROR.
 13677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13678     MOVE -1                 TO CDAYSL.
 13679     MOVE AL-UNBON           TO CDAYSA.
 13680
 13681 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 261
* EL156.cbl
 13682     EXIT.
 13683
 13684 3300-BUMP-DATE.
 13685
 13686     IF WS-RESTORE-DUE-DAY
 13687         MOVE 'N'              TO WS-DUE-DAY-SW
 13688         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13689         ADD 1                 TO WS-PMT-DUE-MO
 13690         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13691         MOVE '4'              TO DC-OPTION-CODE
 13692         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13693         IF NO-CONVERSION-ERROR
 13694             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13695             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13696             GO TO 3399-EXIT
 13697         ELSE
 13698             MOVE '9'          TO DC-ERROR-CODE
 13699             GO TO 3399-EXIT.
 13700
 13701     IF (WS-PMT-DUE-MO = 1) AND
 13702        (WS-SAVE-DUE-DA > 28)
 13703           MOVE 'Y' TO WS-DUE-DAY-SW.
 13704
 13705     MOVE +0                 TO DC-ELAPSED-DAYS.
 13706     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13707     MOVE '6'                TO DC-OPTION-CODE.
 13708     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13709
 13710 3399-EXIT.
 13711     EXIT.
 13712
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 262
* EL156.cbl
 13714 3400-COMPUTE-EXPIRY.
 13715
 13716     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13717     MOVE +0                    TO DC-ELAPSED-DAYS
 13718                                   DC-ODD-DAYS-OVER.
 13719     MOVE '1'                   TO DC-END-OF-MONTH.
 13720     MOVE '6'                   TO DC-OPTION-CODE.
 13721
 13722     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13723         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13724     ELSE
 13725         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13726
 13727     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13728     IF NO-CONVERSION-ERROR
 13729         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13730     ELSE
 13731         GO TO 3390-CONTINUE.
 13732
 13733     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13734         GO TO 3390-CONTINUE.
 13735
 13736     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13737     MOVE '4'                    TO CNTL-REC-TYPE.
 13738     MOVE +0                     TO CNTL-SEQ-NO.
 13739     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13740     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13741     MOVE 'BENE'                 TO FILE-SWITCH.
 13742
 13743     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13744
 13745     IF NO-BENEFIT-FOUND
 13746         GO TO 3390-CONTINUE.
 13747
 13748     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13749        IF (PI-OFFLINE = 'Y') OR
 13750           (PI-PMTTYPE = '7')
 13751           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13752                                     THRU 9870-EXIT
 13753           IF ERROR-ON-OUTPUT
 13754             MOVE -1                 TO ENTERPFL
 13755             MOVE AL-UANON           TO ENTERPFA
 13756             MOVE MAP-NAMEA          TO MAP-NAME
 13757             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13758             GO TO 8200-SEND-DATAONLY.
 13759
 13760     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13761        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13762        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13763          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13764          MOVE +0        TO DC-ELAPSED-DAYS
 13765          MOVE +1        TO DC-ELAPSED-MONTHS
 13766          MOVE 6         TO DC-OPTION-CODE
 13767          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13768          IF NO-CONVERSION-ERROR
 13769              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13770
 13771 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 263
* EL156.cbl
 13772
 13773      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13774         MOVE CM-AH-LOAN-EXPIRE-DT
 13775                                 TO DC-BIN-DATE-1
 13776      ELSE
 13777         MOVE CM-LF-LOAN-EXPIRE-DT
 13778                                 TO DC-BIN-DATE-1
 13779      END-IF
 13780
 13781      MOVE ' '                    TO DC-OPTION-CODE.
 13782      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13783      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13784      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13785
 13786 3499-EXIT.
 13787     EXIT.
 13788
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 264
* EL156.cbl
 13790
 13791 3600-CHECK-VERIFICATION.
 13792
 13793     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13794
 13795     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13796
 13797     IF PI-PAYEE-TYPE = 'I'
 13798        GO TO 3600-READ-TRAILER.
 13799
 13800     IF PI-PAYEE-TYPE = 'B'
 13801        ADD +10                  TO TRLR-SEQ-NO
 13802        GO TO 3600-READ-TRAILER.
 13803
 13804     IF PI-PAYEE-TYPE = 'A'
 13805        ADD +20                  TO TRLR-SEQ-NO
 13806        GO TO 3600-READ-TRAILER.
 13807
 13808     IF PI-PAYEE-TYPE = 'O'
 13809        ADD +50                  TO TRLR-SEQ-NO
 13810        GO TO 3600-READ-TRAILER.
 13811
 13812     IF PI-PAYEE-TYPE = 'Q'
 13813        ADD +60                  TO TRLR-SEQ-NO
 13814        GO TO 3600-READ-TRAILER.
 13815
 13816     IF PI-PAYEE-TYPE = 'P'
 13817        ADD +30                  TO TRLR-SEQ-NO
 13818        GO TO 3600-READ-TRAILER.
 13819
 13820     IF PI-PAYEE-TYPE = 'E'
 13821        ADD +40                  TO TRLR-SEQ-NO.
 13822
 13823 3600-READ-TRAILER.
 13824
 13825
 13826* EXEC CICS HANDLE CONDITION
 13827*         NOTFND(3600-CONTINUE)
 13828*    END-EXEC.
 13829*    MOVE '"$I                   ! - #00013047' TO DFHEIV0
 13830     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13832     MOVE X'2D20233030303133303437' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0
 13834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13835
 13836
 13837     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13838
 13839 3600-CONTINUE.
 13840
 13841     IF PI-VFY-2ND-BENE = 'Y'
 13842       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13843         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13844           MOVE ER-7576            TO EMI-ERROR
 13845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13846           MOVE -1                 TO PAYEEL
 13847           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 265
* EL156.cbl
 13848           GO TO 3600-EXIT
 13849         END-IF
 13850       END-IF
 13851     END-IF.
 13852
 13853     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13854     MOVE 1 TO WS-SUB2
 13855     MOVE SPACES TO WS-PAYEE-NAME
 13856     PERFORM VARYING WS-SUB FROM 1 BY 1
 13857             UNTIL WS-SUB > 30
 13858         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13859            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13860                 WS-PAYEE-NAME-X (WS-SUB2)
 13861            ADD +1 TO WS-SUB2
 13862         END-IF
 13863     END-PERFORM.
 13864
 13865     STRING CL-INSURED-1ST-NAME
 13866            CL-INSURED-MID-INIT
 13867            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13868     MOVE 1 TO WS-SUB2
 13869     MOVE SPACES TO WS-INSURED-NAME
 13870     PERFORM VARYING WS-SUB FROM 1 BY 1
 13871             UNTIL WS-SUB > 30
 13872         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13873            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13874                 WS-INSURED-NAME-X (WS-SUB2)
 13875            ADD +1 TO WS-SUB2
 13876         END-IF
 13877     END-PERFORM.
 13878
 13879     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13880        MOVE ER-7579            TO EMI-ERROR
 13881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13882        MOVE -1                 TO PAYEEL
 13883        MOVE AL-UABON           TO PAYEEA
 13884     END-IF.
 13885
 13886 3600-EXIT.
 13887     EXIT.
 13888
 13889 5000-UPDATE.
 13890
 13891     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13892
 13893     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13894
 13895     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13896        PI-OFFLINE = 'Y'
 13897        NEXT SENTENCE
 13898     ELSE
 13899        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13900
 13901*    IF PI-COMPANY-ID = 'CRI'
 13902*       IF PI-PMTTYPE = '1' OR  '2'
 13903*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13904*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13905*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 266
* EL156.cbl
 13906
 13907*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13908*       IF PI-PMTTYPE = '1'
 13909*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13910*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13911
 13912     IF PI-PMTTYPE      = '2' AND
 13913        PI-SPLIT-PMT-SW = 'Y' AND
 13914        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13915          MOVE ER-3530                TO EMI-ERROR
 13916          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13917
 13918     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13919        AND (CL-CLAIM-TYPE = 'L')
 13920        IF PI-PMTTYPE = '2' OR '4'
 13921           IF PI-INT-AMT NOT = ZEROS
 13922              PERFORM 7110-BUILD-PMT-TRLR
 13923                                 THRU 7130-EXIT
 13924           ELSE
 13925              IF PI-PMTTYPE = '2'
 13926                 PERFORM 7140-BUILD-NOTE-TRLR
 13927                                 THRU 7170-EXIT
 13928              END-IF
 13929           END-IF
 13930        END-IF
 13931     END-IF
 13932*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13933*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13934*            MOVE 'N'                 TO  WS-LETTER-SW.
 13935
 13936*    IF PI-COMPANY-ID = 'DMD'
 13937*        IF CL-NO-OF-PMTS-MADE = +1
 13938*                OR
 13939*           PI-PMTTYPE = '2'
 13940*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13941
 13942     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13943
 13944*    IF PI-COMPANY-ID = 'DMD'
 13945*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13946*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13947
 13948
 13949* EXEC CICS REWRITE
 13950*         DATASET('ELMSTR')
 13951*         FROM(CLAIM-MASTER)
 13952*     END-EXEC.
 13953     MOVE LENGTH OF
 13954      CLAIM-MASTER
 13955       TO DFHEIV11
 13956     MOVE 'ELMSTR' TO DFHEIV1
 13957*    MOVE '&& L                  %   #00013162' TO DFHEIV0
 13958     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13960     MOVE X'2020233030303133313632' TO DFHEIV0(25:11)
 13961     CALL 'kxdfhei1' USING DFHEIV0,
 13962           DFHEIV1,
 13963           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 267
* EL156.cbl
 13964           DFHEIV11,
 13965           DFHEIV99
 13966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13967
 13968
 13969     IF WS-LETTER-SW = 'N'
 13970         GO TO 5000-END-UPDATE.
 13971
 13972 5000-GENERATE-AUTO-LETTER.
 13973
 13974
 13975* EXEC CICS LINK
 13976*        PROGRAM    (LINK-1523)
 13977*        COMMAREA   (W-1523-LINKDATA)
 13978*        LENGTH     (W-1523-COMM-LENGTH)
 13979*    END-EXEC.
 13980*    MOVE '."C                   (   #00013172' TO DFHEIV0
 13981     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13983     MOVE X'2020233030303133313732' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           LINK-1523,
 13986           W-1523-LINKDATA,
 13987           W-1523-COMM-LENGTH,
 13988           DFHEIV99,
 13989           DFHEIV99,
 13990           DFHEIV99,
 13991           DFHEIV99
 13992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13993
 13994
 13995     IF W-1523-FATAL-ERROR
 13996         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998         MOVE ER-0802                TO  EMI-ERROR
 13999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14000
 14001     IF W-1523-ERROR-CODE = 0191
 14002         MOVE ER-0803                TO  EMI-ERROR
 14003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14004
 14005     IF PI-COMPANY-ID      = 'HAN' AND
 14006        PI-PMTTYPE         = '1'   AND
 14007        PI-3RD-PARTY-SW    = 'Y'   AND
 14008        W-1523-FORM-NUMBER = 'EOB1'
 14009           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14010           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14011           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14012           GO TO 5000-GENERATE-AUTO-LETTER.
 14013
 14014 5000-END-UPDATE.
 14015
 14016     MOVE ER-0000                TO EMI-ERROR.
 14017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14018     GO TO 7000-SHOW-CLAIM.
 14019
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 268
* EL156.cbl
 14021 5000-MOVE-NAME.
 14022     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14023     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14024     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14025
 14026 5000-EXIT.
 14027     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 269
* EL156.cbl
 14029 5300-CREATE-DMO.
 14030
 14031     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14032     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14033     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14034
 14035
 14036* EXEC CICS HANDLE CONDITION
 14037*         NOTFND   (5300-NOTE-NOT-FOUND)
 14038*    END-EXEC.
 14039*    MOVE '"$I                   ! . #00013218' TO DFHEIV0
 14040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14042     MOVE X'2E20233030303133323138' TO DFHEIV0(25:11)
 14043     CALL 'kxdfhei1' USING DFHEIV0
 14044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14045
 14046
 14047
 14048* EXEC CICS READ
 14049*         DATASET('ERNOTE')
 14050*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14051*         RIDFLD (W-NOTE-KEY)
 14052*    END-EXEC.
 14053     MOVE 'ERNOTE' TO DFHEIV1
 14054*    MOVE '&"S        E          (   #00013222' TO DFHEIV0
 14055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14057     MOVE X'2020233030303133323232' TO DFHEIV0(25:11)
 14058     CALL 'kxdfhei1' USING DFHEIV0,
 14059           DFHEIV1,
 14060           DFHEIV20,
 14061           DFHEIV99,
 14062           W-NOTE-KEY,
 14063           DFHEIV99,
 14064           DFHEIV99,
 14065           DFHEIV99
 14066     SET ADDRESS OF CERTIFICATE-NOTE TO
 14067         DFHEIV20
 14068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14069
 14070
 14071     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14072     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14073     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14074
 14075     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14076         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14077     ELSE
 14078         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14079
 14080     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14081     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14082     MOVE 'DLO006'               TO PGM-NAME.
 14083
 14084
 14085* EXEC CICS LINK
 14086*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 270
* EL156.cbl
 14087*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14088*        LENGTH     (DCT-RCRD-LENGTH)
 14089*    END-EXEC.
 14090*    MOVE '."C                   (   #00013241' TO DFHEIV0
 14091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14093     MOVE X'2020233030303133323431' TO DFHEIV0(25:11)
 14094     CALL 'kxdfhei1' USING DFHEIV0,
 14095           PGM-NAME,
 14096           DCT-COMMUNICATION-AREA,
 14097           DCT-RCRD-LENGTH,
 14098           DFHEIV99,
 14099           DFHEIV99,
 14100           DFHEIV99,
 14101           DFHEIV99
 14102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14103
 14104
 14105     IF DCT-RETURN-CODE = 'OK'
 14106         GO TO 5300-CONT.
 14107
 14108     IF DCT-RETURN-CODE = '01' OR '02'
 14109         GO TO 5300-EXIT.
 14110
 14111     IF DCT-RETURN-CODE = '03'
 14112         MOVE ER-0951            TO EMI-ERROR
 14113         GO TO 5300-BAD-EXIT.
 14114
 14115     IF DCT-RETURN-CODE = '04'
 14116         MOVE ER-0946            TO EMI-ERROR
 14117         GO TO 5300-BAD-EXIT.
 14118
 14119     IF DCT-RETURN-CODE = '05'
 14120         MOVE ER-0947            TO EMI-ERROR
 14121         GO TO 5300-BAD-EXIT.
 14122
 14123     IF DCT-RETURN-CODE = '06'
 14124         MOVE ER-0921            TO EMI-ERROR
 14125         GO TO 5300-BAD-EXIT.
 14126
 14127     IF DCT-RETURN-CODE = '07'
 14128         MOVE ER-0849            TO EMI-ERROR
 14129         GO TO 5300-BAD-EXIT.
 14130
 14131     IF DCT-RETURN-CODE = '08'
 14132         MOVE ER-0948            TO EMI-ERROR
 14133         GO TO 5300-BAD-EXIT.
 14134
 14135     IF DCT-RETURN-CODE = 'N1'
 14136         MOVE ER-0950            TO EMI-ERROR
 14137         GO TO 5300-BAD-EXIT.
 14138
 14139     IF DCT-RETURN-CODE = 'E1'
 14140         MOVE ER-0974            TO EMI-ERROR
 14141         GO TO 5300-BAD-EXIT.
 14142
 14143     IF DCT-RETURN-CODE = 'E2'
 14144         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 271
* EL156.cbl
 14145         GO TO 5300-BAD-EXIT.
 14146
 14147     IF DCT-RETURN-CODE NOT = 'OK'
 14148         MOVE ER-0949            TO EMI-ERROR
 14149         GO TO 5300-BAD-EXIT.
 14150
 14151 5300-CONT.
 14152
 14153     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14154     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14155     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14156     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14157     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14158     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14159     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14160     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14161
 14162     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14163     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14164     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14165     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14166     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14167
 14168     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14169
 14170     IF PI-PMTTYPE = '2'
 14171         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14172         MOVE '4'                TO DM-CLAIM-STATUS
 14173     ELSE
 14174         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14175         MOVE '2'                TO DM-CLAIM-STATUS.
 14176
 14177     MOVE 'DLO025'               TO PGM-NAME.
 14178
 14179
 14180* EXEC CICS LINK
 14181*        PROGRAM    (PGM-NAME)
 14182*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14183*        LENGTH     (DM-DMO-LENGTH)
 14184*    END-EXEC.
 14185*    MOVE '."C                   (   #00013321' TO DFHEIV0
 14186     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14188     MOVE X'2020233030303133333231' TO DFHEIV0(25:11)
 14189     CALL 'kxdfhei1' USING DFHEIV0,
 14190           PGM-NAME,
 14191           DMO-COMMUNICATION-AREA,
 14192           DM-DMO-LENGTH,
 14193           DFHEIV99,
 14194           DFHEIV99,
 14195           DFHEIV99,
 14196           DFHEIV99
 14197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14198
 14199
 14200     IF DM-RETURN-CODE = 'OK'
 14201         GO TO 5300-EXIT.
 14202
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 272
* EL156.cbl
 14203     IF DM-RETURN-CODE = '01'
 14204         MOVE ER-8051            TO EMI-ERROR
 14205         GO TO 5300-BAD-EXIT.
 14206
 14207     IF DM-RETURN-CODE = '02'
 14208         MOVE ER-8052            TO EMI-ERROR
 14209         GO TO 5300-BAD-EXIT.
 14210
 14211     IF DM-RETURN-CODE = '03'
 14212         MOVE ER-8053            TO EMI-ERROR
 14213         GO TO 5300-BAD-EXIT.
 14214
 14215     IF DM-RETURN-CODE = '04'
 14216         MOVE ER-8054            TO EMI-ERROR
 14217         GO TO 5300-BAD-EXIT.
 14218
 14219     IF DM-RETURN-CODE = '05'
 14220         MOVE ER-8055            TO EMI-ERROR
 14221         GO TO 5300-BAD-EXIT.
 14222
 14223     IF DM-RETURN-CODE = '06'
 14224         MOVE ER-8056            TO EMI-ERROR
 14225         GO TO 5300-BAD-EXIT.
 14226
 14227     IF DM-RETURN-CODE = '07'
 14228         MOVE ER-8057            TO EMI-ERROR
 14229         GO TO 5300-BAD-EXIT.
 14230
 14231     IF DM-RETURN-CODE = '08'
 14232         MOVE ER-8058            TO EMI-ERROR
 14233         GO TO 5300-BAD-EXIT.
 14234
 14235     IF DM-RETURN-CODE = '09'
 14236         MOVE ER-8059            TO EMI-ERROR
 14237         GO TO 5300-BAD-EXIT.
 14238
 14239     IF DM-RETURN-CODE = '10'
 14240         MOVE ER-8060            TO EMI-ERROR
 14241         GO TO 5300-BAD-EXIT.
 14242
 14243     IF DM-RETURN-CODE = '11'
 14244         MOVE ER-8061            TO EMI-ERROR
 14245         GO TO 5300-BAD-EXIT.
 14246
 14247     IF DM-RETURN-CODE = '12'
 14248         MOVE ER-8062            TO EMI-ERROR
 14249         GO TO 5300-BAD-EXIT.
 14250
 14251     IF DM-RETURN-CODE = '13'
 14252         MOVE ER-8063            TO EMI-ERROR
 14253         GO TO 5300-BAD-EXIT.
 14254
 14255     IF DM-RETURN-CODE = '14'
 14256         MOVE ER-8064            TO EMI-ERROR
 14257         GO TO 5300-BAD-EXIT.
 14258
 14259     IF DM-RETURN-CODE = '15'
 14260         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 273
* EL156.cbl
 14261         GO TO 5300-BAD-EXIT.
 14262
 14263     IF DM-RETURN-CODE = '16'
 14264         MOVE ER-8154            TO EMI-ERROR
 14265         GO TO 5300-BAD-EXIT.
 14266
 14267     IF DM-RETURN-CODE = '17'
 14268         MOVE ER-8155            TO EMI-ERROR
 14269         GO TO 5300-BAD-EXIT.
 14270
 14271     IF DM-RETURN-CODE = 'N1'
 14272         MOVE ER-8152            TO EMI-ERROR
 14273         GO TO 5300-BAD-EXIT.
 14274
 14275     IF DM-RETURN-CODE = 'E1'
 14276         MOVE ER-8153            TO EMI-ERROR
 14277         GO TO 5300-BAD-EXIT.
 14278
 14279     MOVE ER-8066            TO EMI-ERROR.
 14280     GO TO 5300-BAD-EXIT.
 14281
 14282 5300-NOTE-NOT-FOUND.
 14283
 14284     MOVE ER-0954                TO EMI-ERROR.
 14285     GO TO 5300-BAD-EXIT.
 14286
 14287 5300-BAD-EXIT.
 14288
 14289* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14290*    MOVE '6"R                   !   #00013415' TO DFHEIV0
 14291     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14293     MOVE X'2020233030303133343135' TO DFHEIV0(25:11)
 14294     CALL 'kxdfhei1' USING DFHEIV0
 14295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14296
 14297     IF MAP-NAME = 'EL156A'
 14298         MOVE -1             TO ENTERPFL
 14299       ELSE
 14300         MOVE LOW-VALUES     TO EL156BI
 14301         MOVE -1             TO ENTPFBL.
 14302
 14303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304     GO TO 8200-SEND-DATAONLY.
 14305
 14306 5300-EXIT.
 14307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 274
* EL156.cbl
 14309 5350-FORMAT-LAST-NAME-1ST.
 14310*****************************************************************
 14311*             M O V E   N A M E   R O U T I N E                 *
 14312*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14313*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14314*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14315*                  FIELD                   VALUE                *
 14316*           W-NAME-LAST    (CL15)      SMITH                    *
 14317*           W-NAME-FIRST   (CL15)      JOHN                     *
 14318*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14319*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14320*     CONTAIN                                                   *
 14321*                SMITH, JOHN ALLEN                              *
 14322*     OR                                                        *
 14323*                SMITH, JOHN A.                                 *
 14324*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14325*     COPYBOOK, ELCNWA.                                         *
 14326*****************************************************************.
 14327
 14328     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14329     MOVE ZERO                   TO  WS-NAME-SW.
 14330     SET NWA-INDEX               TO +1.
 14331
 14332     IF W-NAME-LAST   = SPACES AND
 14333        W-NAME-MIDDLE = SPACES
 14334         MOVE +1                 TO WS-NAME-SW.
 14335
 14336     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14337     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14338
 14339     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14340     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14341
 14342     SET NWA-INDEX UP BY +1.
 14343
 14344     IF W-NAME-MIDDLE NOT = SPACES
 14345         IF W-NAME-MIDDLE-2 = SPACES
 14346             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14347             SET NWA-INDEX UP BY +1
 14348             MOVE '.'            TO WS-NW (NWA-INDEX)
 14349             SET NWA-INDEX UP BY +2
 14350         ELSE
 14351             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14352             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14353
 14354 5350-EXIT.
 14355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 275
* EL156.cbl
 14357 5360-MOVE-NAME.
 14358
 14359     IF WS-NAME-SW > +1
 14360         GO TO 5360-EXIT.
 14361
 14362     IF WS-NAME-WORK2 = SPACES
 14363         GO TO 5360-EXIT.
 14364
 14365     SET NWA-INDEX2            TO +1.
 14366     SET NWA-INDEX3            TO +2.
 14367
 14368 5360-MOVE-NAME-CYCLE.
 14369
 14370     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14371
 14372     IF NWA-INDEX < +30
 14373         SET NWA-INDEX UP BY +1
 14374     ELSE
 14375         ADD +2                TO  WS-NAME-SW
 14376         GO TO 5360-EXIT.
 14377
 14378     IF NWA-INDEX2 < +20
 14379         SET NWA-INDEX3 UP BY +1
 14380         SET NWA-INDEX2 UP BY +1.
 14381
 14382     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14383        WS-NW2 (NWA-INDEX3) = SPACES
 14384         IF WS-NAME-SW = ZERO
 14385             MOVE ','            TO  WS-NW (NWA-INDEX)
 14386             SET NWA-INDEX UP BY +2
 14387             MOVE +1             TO  WS-NAME-SW
 14388             GO TO 5360-EXIT
 14389         ELSE
 14390             GO TO 5360-EXIT.
 14391
 14392     GO TO 5360-MOVE-NAME-CYCLE.
 14393
 14394 5360-EXIT.
 14395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 276
* EL156.cbl
 14397 6000-BUILD-SCREEN-B.
 14398     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14399     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14400     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14401     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14402
 14403     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14404
 14405 6050-BUILD-SCREEN.
 14406     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14407     MOVE LOW-VALUES             TO EL156BI.
 14408     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14409
 14410     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14411
 14412     IF PI-PAYEE-TYPE = 'I'
 14413        GO TO 6060-READ-TRAILER.
 14414
 14415     IF PI-PAYEE-TYPE = 'B'
 14416        ADD +10                  TO TRLR-SEQ-NO
 14417        GO TO 6060-READ-TRAILER.
 14418
 14419     IF PI-PAYEE-TYPE = 'A'
 14420        ADD +20                  TO TRLR-SEQ-NO
 14421        GO TO 6060-READ-TRAILER.
 14422
 14423     IF PI-PAYEE-TYPE = 'O'
 14424        ADD +50                  TO TRLR-SEQ-NO
 14425        GO TO 6060-READ-TRAILER.
 14426
 14427     IF PI-PAYEE-TYPE = 'Q'
 14428        ADD +60                  TO TRLR-SEQ-NO
 14429        GO TO 6060-READ-TRAILER.
 14430
 14431     IF PI-PAYEE-TYPE = 'P'
 14432        ADD +30                  TO TRLR-SEQ-NO
 14433        GO TO 6060-READ-TRAILER.
 14434
 14435     IF PI-PAYEE-TYPE = 'E'
 14436        ADD +40                  TO TRLR-SEQ-NO.
 14437
 14438 6060-READ-TRAILER.
 14439
 14440     IF PI-PAYEE-TYPE    = 'A' AND
 14441        PI-PAYEE-SEQ-NUM = 0
 14442          GO TO 6061-READ-ACCOUNT.
 14443
 14444     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14445        (PI-PAYEE-TYPE    = 'B')             AND
 14446        (PI-PAYEE-SEQ-NUM = 9)
 14447          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14448          IF BENE-FOUND-SW = 'N'
 14449            GO TO 6065-NOT-FOUND
 14450          ELSE
 14451            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14452            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14453            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14454*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 277
* EL156.cbl
 14455            STRING BE-CITY ' ' BE-STATE
 14456               DELIMITED BY '  ' INTO CITYSTBO
 14457            END-STRING
 14458            MOVE BE-ZIP-CODE       TO ZIPBO
 14459            GO TO 6061-READ-ACCOUNT.
 14460
 14461     IF PI-PAYEE-TYPE    = 'B' AND
 14462        PI-PAYEE-SEQ-NUM = 0
 14463          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14464          IF BENE-FOUND-SW = 'N'
 14465            GO TO 6065-NOT-FOUND
 14466          ELSE
 14467            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14468            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14469            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14470*           MOVE BE-CITY-STATE     TO CITYSTBO
 14471            STRING BE-CITY ' ' BE-STATE
 14472               DELIMITED BY '  ' INTO CITYSTBO
 14473            END-STRING
 14474            MOVE BE-ZIP-CODE       TO ZIPBO
 14475            GO TO 6061-READ-ACCOUNT.
 14476
 14477
 14478* EXEC CICS HANDLE CONDITION
 14479*         NOTFND(6065-NOT-FOUND)
 14480*     END-EXEC.
 14481*    MOVE '"$I                   ! / #00013596' TO DFHEIV0
 14482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14484     MOVE X'2F20233030303133353936' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0
 14486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14487
 14488
 14489     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14490
 14491     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14492     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14493     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14494     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14495*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14496     STRING AT-CITY ' ' AT-STATE
 14497        DELIMITED BY '  ' INTO CITYSTBO
 14498     END-STRING
 14499     MOVE AT-ZIP-CODE            TO ZIPBO.
 14500
 14501 6061-READ-ACCOUNT.
 14502
 14503* EXEC CICS HANDLE CONDITION
 14504*         NOTFND(6068-ACCT-NOT-FND)
 14505*     END-EXEC.
 14506*    MOVE '"$I                   ! 0 #00013613' TO DFHEIV0
 14507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14509     MOVE X'3020233030303133363133' TO DFHEIV0(25:11)
 14510     CALL 'kxdfhei1' USING DFHEIV0
 14511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14512
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 278
* EL156.cbl
 14513
 14514
 14515* EXEC CICS READ
 14516*         DATASET('ERACCT')
 14517*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14518*         RIDFLD (PI-ACCT-KEY)
 14519*     END-EXEC.
 14520     MOVE 'ERACCT' TO DFHEIV1
 14521*    MOVE '&"S        E          (   #00013617' TO DFHEIV0
 14522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14524     MOVE X'2020233030303133363137' TO DFHEIV0(25:11)
 14525     CALL 'kxdfhei1' USING DFHEIV0,
 14526           DFHEIV1,
 14527           DFHEIV20,
 14528           DFHEIV99,
 14529           PI-ACCT-KEY,
 14530           DFHEIV99,
 14531           DFHEIV99,
 14532           DFHEIV99
 14533     SET ADDRESS OF ACCOUNT-MASTER TO
 14534         DFHEIV20
 14535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14536
 14537
 14538     MOVE AM-CARRIER             TO ACARRBO.
 14539     MOVE AM-GROUPING            TO GROUPBO.
 14540     MOVE AM-STATE               TO STATEBO.
 14541     MOVE AM-ACCOUNT             TO ACCTBO.
 14542     MOVE AM-NAME                TO ACCTNMBO.
 14543
 14544     IF PI-PAYEE-TYPE = 'A' AND
 14545        PI-PAYEE-SEQ-NUM = 0
 14546          MOVE AM-NAME             TO NAMEBO
 14547                                      PI-PAYEE-NAME
 14548          MOVE AM-ADDRS            TO ADDR1BO
 14549          MOVE SPACES              TO ADDR2BO
 14550*         MOVE AM-CITY             TO CITYSTBO
 14551          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14552             DELIMITED BY '  ' INTO CITYSTBO
 14553          END-STRING
 14554          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14555          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14556          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14557          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14558
 14559     IF CITYSTBO EQUAL SPACES
 14560         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14561         GO TO 6070-FORMAT-DATA
 14562     END-IF.
 14563
 14564     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14565     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14566     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14567     PERFORM VARYING WS-SUB FROM 30 BY -1
 14568          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14569        IF WS-END-SUB = 0  AND
 14570           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 279
* EL156.cbl
 14571              OR LOW-VALUES  OR '.')
 14572            CONTINUE
 14573        ELSE
 14574            IF WS-END-SUB = 0
 14575                MOVE WS-SUB TO WS-END-SUB
 14576            ELSE
 14577                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14578                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14579                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14580                END-IF
 14581            END-IF
 14582        END-IF
 14583        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14584            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14585            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14586        END-IF
 14587     END-PERFORM.
 14588
 14589     IF WS-BEG-SUB > 0
 14590         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14591         IF WS-STATE-LENGTH = 2
 14592             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14593                  TO PI-CHECK-STATE-FOR-AK
 14594         ELSE
 14595             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14596                'ALASKA'
 14597                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14598             ELSE
 14599                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14600             END-IF
 14601         END-IF
 14602     ELSE
 14603         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14604     END-IF.
 14605
 14606     GO TO 6070-FORMAT-DATA.
 14607
 14608 6065-NOT-FOUND.
 14609     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14610     GO TO 6061-READ-ACCOUNT.
 14611
 14612 6068-ACCT-NOT-FND.
 14613     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14614
 14615 6070-FORMAT-DATA.
 14616     IF PI-HOLDTIL = ZEROS
 14617        MOVE SAVE-DATE           TO PAYDTBI
 14618       ELSE
 14619        MOVE PI-HOLDTIL          TO PAYDTBO
 14620        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14621
 14622     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14623     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14624
 14625     IF EIBAID = DFHPF3 OR DFHPF4
 14626        NEXT SENTENCE
 14627     ELSE
 14628       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 280
* EL156.cbl
 14629
 14630     MOVE PI-EPYFROM          TO PYFROMBO.
 14631     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14632
 14633     IF NOT PI-USES-PAID-TO
 14634        MOVE PI-EPYTHRU          TO PYTHRUBO
 14635        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14636     ELSE
 14637        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14638        MOVE '4'              TO DC-OPTION-CODE
 14639        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14640        IF NO-CONVERSION-ERROR
 14641           MOVE +1            TO DC-ELAPSED-DAYS
 14642           MOVE +0            TO DC-ELAPSED-MONTHS
 14643           MOVE '6'           TO DC-OPTION-CODE
 14644           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14645           IF NO-CONVERSION-ERROR
 14646              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14647
 14648     MOVE PI-EDAYS            TO DAYSBO.
 14649     MOVE PI-EPYAMT           TO PAYAMTBO.
 14650     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14651        IF PI-INT-AMT > ZEROS
 14652           MOVE PI-INT-AMT       TO INTAMTBO
 14653        END-IF
 14654     END-IF
 14655     GO TO 6072-SET-TYPE.
 14656
 14657 6071-CONTINUE.
 14658
 14659     IF PI-CPYFROM NOT = LOW-VALUES
 14660        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14661        MOVE SPACES              TO DC-OPTION-CODE
 14662        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14663        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14664
 14665     IF PI-CPYTHRU NOT = LOW-VALUES
 14666        IF NOT PI-USES-PAID-TO
 14667           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14668           MOVE SPACES             TO DC-OPTION-CODE
 14669           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14670           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14671        ELSE
 14672           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14673           MOVE '6'                TO DC-OPTION-CODE
 14674           MOVE +1                 TO DC-ELAPSED-DAYS
 14675           MOVE +0                 TO DC-ELAPSED-MONTHS
 14676           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14677           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14678
 14679     MOVE PI-CDAYS               TO DAYSBO.
 14680     MOVE PI-CPYAMT              TO PAYAMTBO.
 14681     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14682        IF PI-INT-AMT > ZEROS
 14683           MOVE PI-INT-AMT       TO INTAMTBO
 14684        END-IF
 14685     END-IF
 14686     .
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 281
* EL156.cbl
 14687 6072-SET-TYPE.
 14688     IF PI-PMTTYPE = '1'
 14689        MOVE 'PARTIAL'           TO PAYTYPBO.
 14690
 14691     IF PI-PMTTYPE = '2'
 14692        MOVE 'FINAL'             TO PAYTYPBO.
 14693
 14694     IF PI-PMTTYPE = '3'
 14695        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14696
 14697     IF PI-PMTTYPE = '4'
 14698        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14699
 14700     IF PI-PMTTYPE = '5'
 14701        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14702
 14703     IF PI-PMTTYPE = '6'
 14704        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14705
 14706     IF PI-PROV-PMT
 14707        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14708
 14709     IF PI-ECHECKNO NOT = SPACES
 14710        MOVE PI-ECHECKNO         TO CKNUMBO
 14711     ELSE
 14712        MOVE PI-CCHECKNO         TO CKNUMBO.
 14713
 14714     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14715        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14716        MOVE +91                 TO  TRLR-SEQ-NO
 14717
 14718* EXEC CICS READ
 14719*           DATASET  ('ELTRLR')
 14720*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14721*           RIDFLD   (ELTRLR-KEY)
 14722*           RESP     (WS-RESPONSE)
 14723*       END-EXEC
 14724     MOVE 'ELTRLR' TO DFHEIV1
 14725*    MOVE '&"S        E          (  N#00013802' TO DFHEIV0
 14726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14728     MOVE X'204E233030303133383032' TO DFHEIV0(25:11)
 14729     CALL 'kxdfhei1' USING DFHEIV0,
 14730           DFHEIV1,
 14731           DFHEIV20,
 14732           DFHEIV99,
 14733           ELTRLR-KEY,
 14734           DFHEIV99,
 14735           DFHEIV99,
 14736           DFHEIV99
 14737     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14738         DFHEIV20
 14739     MOVE EIBRESP  TO WS-RESPONSE
 14740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14741
 14742        IF WS-RESP-NORMAL
 14743           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14744        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 282
* EL156.cbl
 14745           MOVE SPACES           TO  LOANNBO
 14746        END-IF
 14747     END-IF
 14748
 14749*       MOVE PI-LOAN-NO          TO LOANNBO
 14750
 14751     IF CKNUMBO = SPACES
 14752         MOVE SPACES             TO CKNUMHDO.
 14753
 14754     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14755     MOVE CL-CARRIER             TO CARRBO.
 14756     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14757     MOVE CL-CERT-SFX            TO SUFXBO.
 14758
 14759     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14760        EVALUATE CL-CLAIM-TYPE
 14761           WHEN 'I'
 14762              MOVE '  IU  '      TO CLMTYPBO
 14763           WHEN 'G'
 14764              MOVE ' GAP  '      TO CLMTYPBO
 14765           WHEN OTHER
 14766              MOVE PI-AH-OVERRIDE-L6
 14767                                 TO CLMTYPBO
 14768        END-EVALUATE
 14769        MOVE ZEROS               TO UNDISBO
 14770*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14771        IF PI-PMTTYPE = '5' OR '6'
 14772           GO TO 6073-GET-NOTIFY-DATA
 14773        ELSE
 14774           MOVE PI-DAILY-RATE    TO RATEBO
 14775           GO TO 6073-GET-NOTIFY-DATA.
 14776
 14777     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14778
 14779     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14780        MOVE ZEROS               TO UNDISBO
 14781     ELSE
 14782        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14783
 14784 6073-GET-NOTIFY-DATA.
 14785
 14786     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14787
 14788     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14789         MOVE SPACES             TO  NAMEB2O
 14790                                     ADDR1B2O
 14791                                     ADDR2B2O
 14792                                     CITYST2O
 14793                                     AGTHDGO
 14794         MOVE ZEROS              TO  ZIPB2O
 14795         GO TO 6080-SET-INCURRED.
 14796
 14797     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14798     MOVE +29                    TO  TRLR-SEQ-NO.
 14799
 14800
 14801* EXEC CICS HANDLE CONDITION
 14802*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 283
* EL156.cbl
 14803*    END-EXEC.
 14804*    MOVE '"$I                   ! 1 #00013867' TO DFHEIV0
 14805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14807     MOVE X'3120233030303133383637' TO DFHEIV0(25:11)
 14808     CALL 'kxdfhei1' USING DFHEIV0
 14809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14810
 14811
 14812     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14813
 14814     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14815     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14816     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14817*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14818     STRING AT-CITY ' ' AT-STATE
 14819        DELIMITED BY '  ' INTO CITYST2O
 14820     END-STRING
 14821     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14822     GO TO 6080-SET-INCURRED.
 14823
 14824 6074-GET-COMP-DATA.
 14825
 14826     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14827         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14828
 14829     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14830         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14831                                         ADDR1B2O
 14832                                         ADDR2B2O
 14833                                         CITYST2O
 14834         MOVE ZEROS                  TO  ZIPB2O
 14835         GO TO 6080-SET-INCURRED.
 14836
 14837     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14838     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14839     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14840     MOVE AM-GROUPING            TO  COMP-GROUP.
 14841     MOVE 'A'                    TO  COMP-TYPE.
 14842     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14843                                 TO  COMP-FIN-RESP.
 14844
 14845     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14846         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14847                                       'G' OR 'B'
 14848             MOVE 'G'            TO  COMP-TYPE
 14849             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14850         ELSE
 14851             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14852                                 TO  COMP-ACCOUNT
 14853     ELSE
 14854         MOVE 'G'                TO  COMP-TYPE
 14855         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14856
 14857     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14858
 14859     IF COMP-REC-FOUND
 14860         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 284
* EL156.cbl
 14861         MOVE CO-ADDR-1          TO  ADDR1B2O
 14862         MOVE CO-ADDR-2          TO  ADDR2B2O
 14863*        MOVE CO-ADDR-3          TO  CITYST2O
 14864         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14865            DELIMITED BY '  ' INTO CITYST2O
 14866         END-STRING
 14867         MOVE CO-ZIP             TO  ZIPB2O
 14868     ELSE
 14869         MOVE 'NO COMP ADDRESS AVAILABLE'
 14870                                 TO  NAMEB2O
 14871                                     ADDR1B2O
 14872                                     ADDR2B2O
 14873                                     CITYST2O
 14874         MOVE ZEROS               TO ZIPB2O.
 14875
 14876 6080-SET-INCURRED.
 14877     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14878     MOVE SPACES                 TO DC-OPTION-CODE.
 14879     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14880     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14881     MOVE PI-PROCESSOR-ID        TO BYBO.
 14882     MOVE MAP-NAMEB              TO MAP-NAME.
 14883     MOVE 'C'                    TO PI-PASS-SW.
 14884     MOVE EIBAID                 TO PI-PFKEY-USED.
 14885     MOVE -1                     TO ENTPFBL.
 14886     GO TO 8100-SEND-INITIAL-MAP.
 14887
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 285
* EL156.cbl
 14889 6100-BUILD-PAYMENT-TRAILER.
 14890
 14891     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14892       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14893         GO TO 6105-STATE-CHECK-NUMBER
 14894     END-IF.
 14895
 14896     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14897     MOVE '6'                    TO CNTL-REC-TYPE.
 14898
 14899     IF CONTROL-IS-ACTUAL-CARRIER
 14900         MOVE PI-CARRIER         TO WS-CARR
 14901     ELSE
 14902         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14903
 14904     IF PI-COMPANY-ID = 'FIA'
 14905         MOVE PI-CARRIER         TO  WS-CARR.
 14906
 14907     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14908     MOVE 0                      TO CNTL-SEQ-NO.
 14909     MOVE 'CARR'                 TO FILE-SWITCH.
 14910
 14911     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14912
 14913     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14914         IF PI-OFFLINE     = 'Y' AND
 14915            PI-ECHECKNO-CR = 'CR'
 14916              GO TO 6110-READ-CONTROL
 14917         ELSE
 14918            IF PI-CASH = 'N'
 14919                GO TO 6110-READ-CONTROL.
 14920
 14921     IF CHECK-NO-MANUAL    OR
 14922        CHECK-NO-AT-PRINT  OR
 14923        PI-OFFLINE = 'Y'
 14924          GO TO 6130-BUILD-TRAILER.
 14925
 14926     IF PI-COMPANY-ID = 'FIA'
 14927         NEXT SENTENCE
 14928     ELSE
 14929         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14930             GO TO 6110-READ-CONTROL.
 14931
 14932     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14933
 14934     IF CHECK-CNT-RESET-VALUE
 14935        MOVE +1                  TO CF-CHECK-COUNTER
 14936     ELSE
 14937        ADD +1                   TO CF-CHECK-COUNTER.
 14938
 14939     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14940
 14941     IF CHECK-NO-CARR-SEQ
 14942        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14943
 14944     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14945
 14946     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 286
* EL156.cbl
 14947     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14948        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14949         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14950         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14951            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14952         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14953                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14954     END-IF.
 14955
 14956     GO TO 6120-REWRITE.
 14957
 14958 6105-STATE-CHECK-NUMBER.
 14959     IF CHECK-NO-MANUAL    OR
 14960        CHECK-NO-AT-PRINT  OR
 14961        PI-OFFLINE = 'Y'
 14962           GO TO 6130-BUILD-TRAILER
 14963     END-IF.
 14964
 14965     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14966     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14967     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14968     MOVE '3'                TO CNTL-REC-TYPE.
 14969     MOVE +0                 TO CNTL-SEQ-NO.
 14970     MOVE 'STAT'             TO FILE-SWITCH.
 14971     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14972
 14973     IF CF-ST-CHECK-CNT-RESET
 14974         MOVE +1             TO CF-ST-CHECK-COUNTER
 14975     ELSE
 14976         ADD +1              TO CF-ST-CHECK-COUNTER
 14977     END-IF.
 14978
 14979     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14980     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14981     GO TO 6120-REWRITE.
 14982
 14983 6110-READ-CONTROL.
 14984     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14985     MOVE '1'                    TO CNTL-REC-TYPE.
 14986     MOVE SPACES                 TO CNTL-ACCESS.
 14987     MOVE 0                      TO CNTL-SEQ-NO.
 14988
 14989     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14990
 14991     IF CO-CHECK-COUNT-RESET
 14992        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14993     ELSE
 14994        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14995
 14996     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14997
 14998     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14999         IF PI-OFFLINE     = 'Y'  AND
 15000            PI-ECHECKNO-CR = 'CR'
 15001              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15002              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15003              MOVE AL-UANON           TO CHECKNOA
 15004              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 287
* EL156.cbl
 15005         ELSE
 15006         IF PI-CASH = 'N'
 15007             MOVE 'N'                TO PI-ECHECKNO-N
 15008             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15009             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15010             MOVE AL-UANON           TO CHECKNOA
 15011             GO TO 6120-REWRITE.
 15012
 15013     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15014
 15015 6120-REWRITE.
 15016
 15017* EXEC CICS REWRITE
 15018*         DATASET('ELCNTL')
 15019*         FROM(CONTROL-FILE)
 15020*     END-EXEC.
 15021     MOVE LENGTH OF
 15022      CONTROL-FILE
 15023       TO DFHEIV11
 15024     MOVE 'ELCNTL' TO DFHEIV1
 15025*    MOVE '&& L                  %   #00014075' TO DFHEIV0
 15026     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15027     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15028     MOVE X'2020233030303134303735' TO DFHEIV0(25:11)
 15029     CALL 'kxdfhei1' USING DFHEIV0,
 15030           DFHEIV1,
 15031           CONTROL-FILE,
 15032           DFHEIV11,
 15033           DFHEIV99
 15034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15035
 15036
 15037     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15038
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 288
* EL156.cbl
 15040 6130-BUILD-TRAILER.
 15041
 15042
 15043* EXEC CICS GETMAIN
 15044*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15045*         LENGTH    (200)
 15046*         INITIMG   (GETMAIN-SPACE)
 15047*     END-EXEC.
 15048     MOVE 200
 15049       TO DFHEIV11
 15050*    MOVE ',"IL                  $   #00014085' TO DFHEIV0
 15051     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15053     MOVE X'2020233030303134303835' TO DFHEIV0(25:11)
 15054     CALL 'kxdfhei1' USING DFHEIV0,
 15055           DFHEIV20,
 15056           DFHEIV11,
 15057           GETMAIN-SPACE
 15058     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15059         DFHEIV20
 15060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15061
 15062
 15063     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15064                                    AT-PREV-PAID-THRU-DT.
 15065     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15066     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15067     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15068     MOVE 'AT'                   TO AT-RECORD-ID.
 15069     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15070
 15071     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15072        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15073           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15074     ELSE
 15075           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15076           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15077
 15078     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15079         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15080             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15081             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15082           ELSE
 15083             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15084             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15085
 15086     MOVE '2'                    TO AT-TRAILER-TYPE.
 15087     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15088                                    AT-PAYMENT-LAST-MAINT-DT.
 15089     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15090                                    AT-PAYMENT-LAST-UPDATED-BY.
 15091     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15092     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15093     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15094     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15095
 15096     IF PI-PMT-APPROVED
 15097        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 289
* EL156.cbl
 15098           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15099
 15100     IF PI-PFKEY-USED = DFHPF5
 15101        GO TO 6140-PF5-ENTERED.
 15102
 15103     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15104     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15105
 15106     IF PI-AIG-SPECIAL-BENEFIT
 15107         IF WS-1ST-SPECIAL-PMT
 15108             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15109             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15110                                        AT-AMOUNT-PAID
 15111         ELSE
 15112             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15113
 15114     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15115
 15116     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15117     MOVE '4'                    TO DC-OPTION-CODE.
 15118     PERFORM 9700-LINK-DATE-CONVERT.
 15119
 15120     IF DATE-CONVERSION-ERROR
 15121        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15122     ELSE
 15123        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15124
 15125     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15126     MOVE '4'                    TO DC-OPTION-CODE.
 15127     PERFORM 9700-LINK-DATE-CONVERT.
 15128
 15129     IF DATE-CONVERSION-ERROR
 15130        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15131     ELSE
 15132        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15133
 15134     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15135     GO TO 6150-FINISH-MOVE.
 15136
 15137 6140-PF5-ENTERED.
 15138     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15139     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15140
 15141     IF PI-AIG-SPECIAL-BENEFIT
 15142         IF WS-1ST-SPECIAL-PMT
 15143             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15144             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15145                                        AT-AMOUNT-PAID
 15146         ELSE
 15147             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15148
 15149     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15150     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15151     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15152
 15153 6150-FINISH-MOVE.
 15154
 15155     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 290
* EL156.cbl
 15156         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15157     ELSE
 15158         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15159
 15160     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15161     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15162
 15163*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15164*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15165
 15166     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15167         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15168
 15169     IF PI-OFFLINE = 'N'
 15170        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15171        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15172     ELSE
 15173        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15174        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15175
 15176     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15177
 15178     IF WS-2ND-SPECIAL-PMT
 15179         MOVE 'Y'                TO AT-CASH-PAYMENT
 15180         MOVE SPACES             TO AT-CHECK-NO
 15181         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15182         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15183         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15184         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15185
 15186     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15187                                    AT-TO-BE-WRITTEN-DT.
 15188
 15189     IF PI-HOLDTIL NOT = ZEROS
 15190        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15191        MOVE '4'                 TO DC-OPTION-CODE
 15192        PERFORM 9700-LINK-DATE-CONVERT
 15193        IF PI-OFFLINE = 'N'
 15194           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15195        ELSE
 15196           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15197
 15198     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15199     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15200                                    AT-CHECK-QUE-SEQUENCE.
 15201
 15202     IF PI-PFKEY-USED = DFHPF4
 15203        MOVE '1'                 TO AT-FORCE-CONTROL.
 15204
 15205     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15206        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15207        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15208        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15209
 15210     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15211                                    AT-VOID-SELECT-DT
 15212                                    AT-VOID-ACCEPT-DT
 15213                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 291
* EL156.cbl
 15214     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15215        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15216        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15217        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15218        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15219     ELSE
 15220        MOVE ZEROS               TO AT-DAILY-RATE
 15221                                    AT-ELIMINATION-DAYS
 15222        MOVE SPACES              TO AT-BENEFIT-TYPE
 15223     END-IF
 15224     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15225     MOVE '4'                    TO DC-OPTION-CODE.
 15226     PERFORM 9700-LINK-DATE-CONVERT.
 15227     IF DATE-CONVERSION-ERROR
 15228         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15229     ELSE
 15230         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15231     END-IF.
 15232     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15233     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15234     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15235     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15236     IF PI-REAUDIT-NEEDED = 'Y'
 15237         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15238         MOVE 'Y' TO WS-NEED-APPROVAL
 15239         GO TO 6170-WRITE
 15240     END-IF.
 15241*******************************************************
 15242     IF NOT PI-PMT-GRADUATED
 15243         GO TO 6170-WRITE.
 15244
 15245     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15246     MOVE '1'                    TO CNTL-REC-TYPE.
 15247     MOVE SPACES                 TO CNTL-ACCESS.
 15248     MOVE +0                     TO CNTL-SEQ-NO.
 15249     MOVE 'COMP'                 TO FILE-SWITCH.
 15250
 15251     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15252
 15253     IF PAID-FOR-LIFE
 15254         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15255             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15256                                     WS-PMT-APPROVAL-SW
 15257             GO TO 6170-WRITE.
 15258
 15259*05999      IF PAID-FOR-AH
 15260     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15261         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15262             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15263                                     WS-PMT-APPROVAL-SW
 15264             GO TO 6170-WRITE.
 15265
 15266     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15267
 15268******A&H Limits are set as a monthly payment.  Calculate the mont
 15269******equivalent of the amount paid today
 15270     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15271        PI-SAVE-ODD-DAYS-OVER > 0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 292
* EL156.cbl
 15272           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15273                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15274           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15275                                  WS-CALC-PMT-MONTHS
 15276     ELSE
 15277           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15278     END-IF.
 15279*06007      IF ((PAID-FOR-AH) AND
 15280     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15281*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15282        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15283              OR
 15284        ((PAID-FOR-LIFE) AND
 15285        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15286            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15287       ELSE
 15288*06014      IF ((PAID-FOR-AH)  AND
 15289         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15290*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15291           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15292              OR
 15293        ((PAID-FOR-LIFE) AND
 15294        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15295            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15296         ELSE
 15297*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15298           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15299               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15300              OR
 15301          ((PAID-FOR-LIFE) AND
 15302          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15303            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15304       ELSE
 15305           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15306               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15307              OR
 15308          ((PAID-FOR-LIFE) AND
 15309          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15310            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15311       ELSE
 15312            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15313
 15314     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15315        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15316        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15317            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15318        END-IF
 15319     ELSE
 15320     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15321        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15322        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15323            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15324        END-IF
 15325     ELSE
 15326     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15327        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15328        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15329            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 293
* EL156.cbl
 15330        END-IF
 15331     ELSE
 15332     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15333        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15334        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15335            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15336        END-IF
 15337     ELSE
 15338     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15339            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15340
 15341     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15342
 15343     IF NOT PI-PMT-GRADUATED
 15344         GO TO 6170-WRITE.
 15345
 15346
 15347* EXEC CICS HANDLE CONDITION
 15348*        NOTFND   (6170-WRITE)
 15349*    END-EXEC.
 15350*    MOVE '"$I                   ! 2 #00014374' TO DFHEIV0
 15351     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15353     MOVE X'3220233030303134333734' TO DFHEIV0(25:11)
 15354     CALL 'kxdfhei1' USING DFHEIV0
 15355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15356
 15357
 15358     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15359     MOVE '2'                    TO CNTL-REC-TYPE.
 15360     MOVE +0                     TO CNTL-SEQ-NO.
 15361     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15362
 15363
 15364* EXEC CICS READ
 15365*         DATASET  ('ELCNTL')
 15366*         SET      (ADDRESS OF CONTROL-FILE)
 15367*         RIDFLD   (ELCNTL-KEY)
 15368*    END-EXEC.
 15369     MOVE 'ELCNTL' TO DFHEIV1
 15370*    MOVE '&"S        E          (   #00014383' TO DFHEIV0
 15371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15373     MOVE X'2020233030303134333833' TO DFHEIV0(25:11)
 15374     CALL 'kxdfhei1' USING DFHEIV0,
 15375           DFHEIV1,
 15376           DFHEIV20,
 15377           DFHEIV99,
 15378           ELCNTL-KEY,
 15379           DFHEIV99,
 15380           DFHEIV99,
 15381           DFHEIV99
 15382     SET ADDRESS OF CONTROL-FILE TO
 15383         DFHEIV20
 15384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15385
 15386
 15387     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 294
* EL156.cbl
 15388
 15389     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15390                         OR '4' OR '5'
 15391         NEXT SENTENCE
 15392     ELSE
 15393         MOVE 'Y' TO WS-NEED-APPROVAL
 15394         GO TO 6170-WRITE.
 15395
 15396     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15397         MOVE 'Y' TO WS-NEED-APPROVAL
 15398         IF WS-APPROVAL-LEVEL = '1'
 15399             MOVE '2'        TO  AT-APPROVED-LEVEL
 15400                            WS-SAVE-APPROVED-LEVEL
 15401             GO TO 6170-WRITE
 15402         ELSE
 15403             IF WS-APPROVAL-LEVEL = '2'
 15404                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15405                                WS-SAVE-APPROVED-LEVEL
 15406                 GO TO 6170-WRITE
 15407             ELSE IF WS-APPROVAL-LEVEL = '3'
 15408                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15409                                WS-SAVE-APPROVED-LEVEL
 15410                 GO TO 6170-WRITE
 15411             ELSE IF WS-APPROVAL-LEVEL = '4'
 15412                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15413                                WS-SAVE-APPROVED-LEVEL
 15414                 GO TO 6170-WRITE.
 15415
 15416     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15417                             WS-PMT-APPROVAL-SW.
 15418     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15419                             AT-APPROVAL-LEVEL-REQD.
 15420
 15421*******************************************************
 15422
 15423 6170-WRITE.
 15424
 15425     if pi-company-id = 'DCC'
 15426        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15427        PERFORM 0900-GET-DDF-FACTORS
 15428                                 THRU 0900-EXIT
 15429     end-if
 15430    perform 2220-update-elcrtt   thru 2220-exit
 15431     IF PI-COMPANY-ID = 'DMD'
 15432        IF PI-AT-EOB-CODES NOT = SPACES
 15433           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15434           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15435           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15436           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15437           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15438
 15439
 15440* EXEC CICS HANDLE CONDITION
 15441*        DUPREC    (6180-DUPREC)
 15442*    END-EXEC.
 15443*    MOVE '"$%                   ! 3 #00014441' TO DFHEIV0
 15444     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 295
* EL156.cbl
 15446     MOVE X'3320233030303134343431' TO DFHEIV0(25:11)
 15447     CALL 'kxdfhei1' USING DFHEIV0
 15448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15449
 15450
 15451
 15452* EXEC CICS WRITE
 15453*         DATASET       ('ELTRLR')
 15454*         FROM          (ACTIVITY-TRAILERS)
 15455*         RIDFLD        (AT-CONTROL-PRIMARY)
 15456*     END-EXEC.
 15457     MOVE LENGTH OF
 15458      ACTIVITY-TRAILERS
 15459       TO DFHEIV11
 15460     MOVE 'ELTRLR' TO DFHEIV1
 15461*    MOVE '&$ L                  ''   #00014445' TO DFHEIV0
 15462     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15464     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 15465     CALL 'kxdfhei1' USING DFHEIV0,
 15466           DFHEIV1,
 15467           ACTIVITY-TRAILERS,
 15468           DFHEIV11,
 15469           AT-CONTROL-PRIMARY,
 15470           DFHEIV99,
 15471           DFHEIV99
 15472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15473
 15474
 15475     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15476        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15477*06088           GO TO 6199-EXIT.
 15478           GO TO 6176-APPROVAL-NOTE.
 15479
 15480
 15481* EXEC CICS GETMAIN
 15482*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15483*         LENGTH    (200)
 15484*         INITIMG   (GETMAIN-SPACE)
 15485*     END-EXEC.
 15486     MOVE 200
 15487       TO DFHEIV11
 15488*    MOVE ',"IL                  $   #00014456' TO DFHEIV0
 15489     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15490     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15491     MOVE X'2020233030303134343536' TO DFHEIV0(25:11)
 15492     CALL 'kxdfhei1' USING DFHEIV0,
 15493           DFHEIV20,
 15494           DFHEIV11,
 15495           GETMAIN-SPACE
 15496     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15497         DFHEIV20
 15498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15499
 15500
 15501     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15502
 15503     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 296
* EL156.cbl
 15504     MOVE 'AT'                   TO AT-RECORD-ID.
 15505     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15506     MOVE '6'                    TO AT-TRAILER-TYPE.
 15507     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15508                                    AT-GEN-INFO-LAST-MAINT-DT
 15509     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15510                                    AT-GEN-INFO-LAST-UPDATED-BY
 15511     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15512
 15513     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15514     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15515     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15516
 15517     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15518
 15519 6175-WRITE.
 15520
 15521
 15522* EXEC CICS HANDLE CONDITION
 15523*        DUPREC    (6190-DUPREC)
 15524*    END-EXEC.
 15525*    MOVE '"$%                   ! 4 #00014482' TO DFHEIV0
 15526     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15528     MOVE X'3420233030303134343832' TO DFHEIV0(25:11)
 15529     CALL 'kxdfhei1' USING DFHEIV0
 15530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15531
 15532
 15533
 15534* EXEC CICS WRITE
 15535*         DATASET     ('ELTRLR')
 15536*         FROM        (ACTIVITY-TRAILERS)
 15537*         RIDFLD      (AT-CONTROL-PRIMARY)
 15538*     END-EXEC.
 15539     MOVE LENGTH OF
 15540      ACTIVITY-TRAILERS
 15541       TO DFHEIV11
 15542     MOVE 'ELTRLR' TO DFHEIV1
 15543*    MOVE '&$ L                  ''   #00014486' TO DFHEIV0
 15544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15546     MOVE X'2020233030303134343836' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           DFHEIV1,
 15549           ACTIVITY-TRAILERS,
 15550           DFHEIV11,
 15551           AT-CONTROL-PRIMARY,
 15552           DFHEIV99,
 15553           DFHEIV99
 15554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15555
 15556
 15557 6176-APPROVAL-NOTE.
 15558
 15559     IF NOT APPROVAL-NEEDED
 15560         GO TO 6199-EXIT.
 15561
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 297
* EL156.cbl
 15562
 15563* EXEC CICS GETMAIN
 15564*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15565*        LENGTH    (200)
 15566*        INITIMG   (GETMAIN-SPACE)
 15567*    END-EXEC.
 15568     MOVE 200
 15569       TO DFHEIV11
 15570*    MOVE ',"IL                  $   #00014497' TO DFHEIV0
 15571     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15573     MOVE X'2020233030303134343937' TO DFHEIV0(25:11)
 15574     CALL 'kxdfhei1' USING DFHEIV0,
 15575           DFHEIV20,
 15576           DFHEIV11,
 15577           GETMAIN-SPACE
 15578     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15579         DFHEIV20
 15580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15581
 15582
 15583     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15584
 15585     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15586     MOVE 'AT'               TO AT-RECORD-ID
 15587     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15588     MOVE '6'                TO AT-TRAILER-TYPE
 15589     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15590                                AT-GEN-INFO-LAST-MAINT-DT
 15591     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15592                                AT-GEN-INFO-LAST-UPDATED-BY
 15593     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15594
 15595     IF PI-REAUDIT-NEEDED = 'Y'
 15596         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15597     ELSE
 15598         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15599     END-IF
 15600     MOVE SPACES             TO AT-INFO-LINE-2
 15601
 15602     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15603 6177-WRITE.
 15604
 15605
 15606* EXEC CICS HANDLE CONDITION
 15607*        DUPREC    (6185-DUPREC)
 15608*    END-EXEC.
 15609*    MOVE '"$%                   ! 5 #00014525' TO DFHEIV0
 15610     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15612     MOVE X'3520233030303134353235' TO DFHEIV0(25:11)
 15613     CALL 'kxdfhei1' USING DFHEIV0
 15614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15615
 15616
 15617
 15618* EXEC CICS WRITE
 15619*         DATASET     ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 298
* EL156.cbl
 15620*         FROM        (ACTIVITY-TRAILERS)
 15621*         RIDFLD      (AT-CONTROL-PRIMARY)
 15622*     END-EXEC.
 15623     MOVE LENGTH OF
 15624      ACTIVITY-TRAILERS
 15625       TO DFHEIV11
 15626     MOVE 'ELTRLR' TO DFHEIV1
 15627*    MOVE '&$ L                  ''   #00014529' TO DFHEIV0
 15628     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15630     MOVE X'2020233030303134353239' TO DFHEIV0(25:11)
 15631     CALL 'kxdfhei1' USING DFHEIV0,
 15632           DFHEIV1,
 15633           ACTIVITY-TRAILERS,
 15634           DFHEIV11,
 15635           AT-CONTROL-PRIMARY,
 15636           DFHEIV99,
 15637           DFHEIV99
 15638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15639
 15640
 15641
 15642     GO TO 6199-EXIT.
 15643
 15644 6180-DUPREC.
 15645
 15646     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15647     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15648     GO TO 6170-WRITE.
 15649
 15650 6185-DUPREC.
 15651     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15652     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15653     GO TO 6177-WRITE.
 15654
 15655 6190-DUPREC.
 15656     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15657     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15658     GO TO 6175-WRITE.
 15659
 15660 6199-EXIT.
 15661      EXIT.
 15662
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 299
* EL156.cbl
 15664 6200-UPDATE-CLAIM-MSTR.
 15665     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15666     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15667     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15668     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15669
 15670     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15671
 15672     MOVE ZEROS                  TO W-INTEREST.
 15673
 15674     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15675        IF (PI-OFFLINE = 'Y') OR
 15676           (PI-PMTTYPE = '7')
 15677           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15678                                 THRU 9870-EXIT
 15679        END-IF
 15680     END-IF
 15681     IF NOT ERROR-ON-OUTPUT
 15682        CONTINUE
 15683     ELSE
 15684
 15685* EXEC CICS REWRITE
 15686*          DATASET('ELMSTR')
 15687*          FROM(CLAIM-MASTER)
 15688*       END-EXEC
 15689     MOVE LENGTH OF
 15690      CLAIM-MASTER
 15691       TO DFHEIV11
 15692     MOVE 'ELMSTR' TO DFHEIV1
 15693*    MOVE '&& L                  %   #00014578' TO DFHEIV0
 15694     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15695     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15696     MOVE X'2020233030303134353738' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0,
 15698           DFHEIV1,
 15699           CLAIM-MASTER,
 15700           DFHEIV11,
 15701           DFHEIV99
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15703
 15704        MOVE -1                  TO ENTPFBL
 15705        MOVE AL-UANON            TO ENTPFBA
 15706        MOVE MAP-NAMEB           TO MAP-NAME
 15707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15708        GO TO 8200-SEND-DATAONLY
 15709     END-IF
 15710
 15711     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15712
 15713     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15714
 15715     IF PI-AIG-SPECIAL-BENEFIT
 15716         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15717
 15718     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15719
 15720     IF PI-SPECIAL-BEN-SW = 'Y'
 15721         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 300
* EL156.cbl
 15722         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15723
 15724     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15725         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15726     ELSE
 15727         IF PI-PMTTYPE NOT = '4'
 15728            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15729
 15730     IF PI-PMTTYPE = '5' OR '6'
 15731        GO TO  6250-SET-MAINT.
 15732
 15733     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15734                                         CL-LAG-REPORT-CODE.
 15735
 15736     IF CL-ACTIVITY-CODE = 09
 15737         GO TO 6200-CONT-UPDATE.
 15738
 15739     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15740         IF CL-ACTIVITY-CODE = 11
 15741             GO TO 6200-CONT-UPDATE.
 15742
 15743     IF WS-ACT-REC-FOUND-SW = 'N'
 15744         GO TO 6200-CONT-UPDATE.
 15745
 15746     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15747         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15748         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15749         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15750
 15751     IF WS-UPDATE-SW = 'Y'
 15752         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15753                                         CL-NEXT-FOLLOWUP-DT.
 15754
 15755 6200-CONT-UPDATE.
 15756
 15757     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15758       IF CLAIM-IS-CLOSED
 15759         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15760           IF WS-OPEN-CLOSE-SW = '2'
 15761             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15762                                        CL-LAST-CLOSE-DT.
 15763
 15764     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15765        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15766        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15767
 15768     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15769        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15770        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15771        MOVE 'C'                 TO CL-CLAIM-STATUS
 15772        IF PI-PMTTYPE = '2'
 15773           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15774           CONTINUE
 15775        ELSE
 15776           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15777        END-IF
 15778     ELSE
 15779        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 301
* EL156.cbl
 15780           IF PI-PMTTYPE = '2' AND
 15781              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15782              CONTINUE
 15783           ELSE
 15784              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15785           END-IF
 15786        END-IF
 15787     END-IF
 15788
 15789     IF PI-PMTTYPE = '4'
 15790        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15791
 15792     IF PI-COMPANY-ID = 'CVL'
 15793         IF PI-LOAN-UPDATE-SW = 'Y'
 15794             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15795             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15796             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15797             MOVE CL-CERT-STATE      TO  CERT-STATE
 15798             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15799             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15800             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15801             MOVE 'CERT'             TO  FILE-SWITCH
 15802             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15803             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15804             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15805
 15806     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15807        GO TO 6220-USE-COMPUTED.
 15808
 15809     IF (PI-PMTTYPE = '4')  AND
 15810        (PI-EPYAMT < ZEROS)
 15811          COMPUTE CL-NO-OF-DAYS-PAID =
 15812                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15813          IF CL-NO-OF-DAYS-PAID < +0
 15814              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15815          ELSE
 15816              NEXT SENTENCE
 15817     ELSE
 15818          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15819
 15820     IF PI-PROCESSOR-ID = 'FIX '
 15821        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15822           NEXT SENTENCE
 15823        ELSE
 15824           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15825     ELSE
 15826        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15827
 15828     IF PI-PMTTYPE = '4'
 15829        GO TO 6250-SET-MAINT.
 15830
 15831     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15832
 15833     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15834     MOVE '4'                    TO DC-OPTION-CODE.
 15835     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15836     IF DATE-CONVERSION-ERROR
 15837        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 302
* EL156.cbl
 15838     ELSE
 15839        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15840           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15841           IF PI-AIG-SPECIAL-BENEFIT
 15842               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15843           ELSE
 15844               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15845
 15846     GO TO 6250-SET-MAINT.
 15847
 15848 6220-USE-COMPUTED.
 15849
 15850     IF (PI-PMTTYPE = '4')  AND
 15851        (PI-CPYAMT < ZEROS)
 15852          COMPUTE CL-NO-OF-DAYS-PAID =
 15853                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15854          IF CL-NO-OF-DAYS-PAID < +0
 15855              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15856          ELSE
 15857              NEXT SENTENCE
 15858     ELSE
 15859          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15860
 15861     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15862
 15863     IF PI-PMTTYPE = '4'
 15864        GO TO 6250-SET-MAINT.
 15865
 15866     IF PI-AIG-SPECIAL-BENEFIT
 15867         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15868     ELSE
 15869         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15870
 15871     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15872
 15873     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15874        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15875
 15876 6250-SET-MAINT.
 15877     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15878
 15879     IF PI-PROCESSOR-ID = 'FIX '
 15880        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15881           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15882        ELSE
 15883           NEXT SENTENCE
 15884     ELSE
 15885        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15886
 15887     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15888     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15889     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15890
 15891 6299-EXIT.
 15892      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 303
* EL156.cbl
 15894 6300-UPDATE-CERT.
 15895
 15896*  ADD CERTNOTE FOR SC NP+6
 15897     IF PI-COMPANY-ID = 'CID' AND
 15898       (PI-PMTTYPE = '2' OR '3') AND
 15899        CL-CERT-STATE = 'SC'  AND
 15900        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15901           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15902     END-IF.
 15903
 15904     IF PI-COMPANY-ID = 'AHL' AND
 15905       (PI-PMTTYPE = '2' OR '3') AND
 15906        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15907           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15908           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15909     END-IF.
 15910
 15911     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15912     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15913     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15914     MOVE CL-CERT-STATE    TO CERT-STATE.
 15915     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15916     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15917     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15918     MOVE 'CERT'           TO FILE-SWITCH.
 15919
 15920     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15921
 15922     IF CERT-NOTE-ADDED
 15923        IF CM-NOTE-SW = ' '
 15924           MOVE '4'             TO CM-NOTE-SW
 15925        ELSE
 15926           IF CM-NOTE-SW = '1'
 15927               MOVE '5'           TO CM-NOTE-SW
 15928           ELSE
 15929              IF CM-NOTE-SW = '2'
 15930                 MOVE '6'         TO CM-NOTE-SW
 15931              ELSE
 15932                 IF CM-NOTE-SW = '3'
 15933                    MOVE '7'      TO CM-NOTE-SW
 15934                 END-IF
 15935              END-IF
 15936           END-IF
 15937        END-IF
 15938     END-IF.
 15939
 15940     IF PI-COMPANY-ID = 'CVL'
 15941         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15942         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15943
 15944     IF PI-PMTTYPE NOT = '4'
 15945        GO TO 6340-UPDATE-CERT.
 15946
 15947     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15948        IF PI-PFKEY-USED = DFHPF5
 15949           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15950        ELSE
 15951           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 304
* EL156.cbl
 15952
 15953*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15954*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15955*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15956*               PI-LF-COVERAGE-TYPE = 'P'
 15957*                GO TO 6350-REWRITE-CERT.
 15958
 15959     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15960       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15961          PI-LF-COVERAGE-TYPE = 'P'
 15962           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15963                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15964                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15965                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15966                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15967                GO TO 6350-REWRITE-CERT
 15968            ELSE
 15969                GO TO 6350-REWRITE-CERT.
 15970
 15971     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15972         GO TO 6350-REWRITE-CERT.
 15973
 15974     IF NOT CM-AH-LUMP-SUM-DISAB
 15975        GO TO 6380-UNLOCK-CERT.
 15976
 15977     IF PI-PFKEY-USED = DFHPF5
 15978        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15979                                    CM-AH-ITD-AH-PMT
 15980        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15981        GO TO 6350-REWRITE-CERT
 15982     ELSE
 15983        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15984                                    CM-AH-ITD-AH-PMT
 15985        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15986        GO TO 6350-REWRITE-CERT.
 15987
 15988 6340-UPDATE-CERT.
 15989
 15990     IF CL-CLAIM-TYPE = 'L'
 15991         IF PI-PFKEY-USED = DFHPF5
 15992             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15993         ELSE
 15994             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15995
 15996     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15997         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15998             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15999                PI-LF-COVERAGE-TYPE = 'P'
 16000                 GO TO 6350-REWRITE-CERT.
 16001
 16002     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16003       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16004          PI-LF-COVERAGE-TYPE = 'P'
 16005           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16006                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16007                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16008                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16009                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 305
* EL156.cbl
 16010                GO TO 6350-REWRITE-CERT.
 16011
 16012     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16013         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16014            PI-LF-COVERAGE-TYPE NOT = 'P'
 16015             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16016             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16017             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16018             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16019             GO TO 6350-REWRITE-CERT.
 16020
 16021     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16022         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16023         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16024         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16025         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16026         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16027         IF PI-PFKEY-USED = DFHPF5
 16028             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16029                                        CM-AH-ITD-AH-PMT
 16030             GO TO 6350-REWRITE-CERT
 16031         ELSE
 16032             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16033                                        CM-AH-ITD-AH-PMT
 16034             GO TO 6350-REWRITE-CERT.
 16035
 16036 6350-REWRITE-CERT.
 16037
 16038
 16039* EXEC CICS REWRITE
 16040*         DATASET  ('ELCERT')
 16041*         FROM(CERTIFICATE-MASTER)
 16042*     END-EXEC.
 16043     MOVE LENGTH OF
 16044      CERTIFICATE-MASTER
 16045       TO DFHEIV11
 16046     MOVE 'ELCERT' TO DFHEIV1
 16047*    MOVE '&& L                  %   #00014917' TO DFHEIV0
 16048     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16049     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16050     MOVE X'2020233030303134393137' TO DFHEIV0(25:11)
 16051     CALL 'kxdfhei1' USING DFHEIV0,
 16052           DFHEIV1,
 16053           CERTIFICATE-MASTER,
 16054           DFHEIV11,
 16055           DFHEIV99
 16056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16057
 16058
 16059     GO TO 6399-EXIT.
 16060
 16061 6380-UNLOCK-CERT.
 16062
 16063* EXEC CICS UNLOCK
 16064*         DATASET  ('ELCERT')
 16065*     END-EXEC.
 16066     MOVE 'ELCERT' TO DFHEIV1
 16067*    MOVE '&*                    #   #00014925' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 306
* EL156.cbl
 16068     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16069     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16070     MOVE X'2020233030303134393235' TO DFHEIV0(25:11)
 16071     CALL 'kxdfhei1' USING DFHEIV0,
 16072           DFHEIV1,
 16073           DFHEIV99
 16074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16075
 16076
 16077 6399-EXIT.
 16078      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 307
* EL156.cbl
 16080 6400-UPDATE-ZERO-TRAILER.
 16081     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16082     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16083
 16084     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16085
 16086     IF PI-EPYAMT NOT = ZEROS
 16087         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16088     ELSE
 16089         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16090
 16091     IF PI-ERESV NOT = ZEROS
 16092        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16093
 16094     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16095        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16096
 16097     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16098        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16099     ELSE
 16100        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16101
 16102     IF PI-PMTTYPE = '5'
 16103        IF PI-EPYAMT = ZEROS
 16104           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16105        ELSE
 16106           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16107
 16108     IF PI-PMTTYPE = '6'
 16109        IF PI-EPYAMT = ZEROS
 16110           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16111        ELSE
 16112           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16113
 16114 6420-CHECK-OPEN-CLOSE.
 16115     IF PI-PMTTYPE = '5' OR '6'
 16116        GO TO 6450-REWRITE.
 16117
 16118     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16119         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16120             IF CLAIM-IS-CLOSED
 16121                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16122                 MOVE 1          TO  SUB-1
 16123                 GO TO 6440-AIG-LOOP.
 16124
 16125     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16126        GO TO 6450-REWRITE.
 16127
 16128     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16129        GO TO 6450-REWRITE.
 16130
 16131     MOVE 1                      TO SUB-1.
 16132
 16133 6430-LOOP.
 16134     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16135        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16136        IF PI-PMTTYPE = '1' OR '4'
 16137           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 308
* EL156.cbl
 16138           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16139           GO TO 6450-REWRITE
 16140        ELSE
 16141           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16142           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16143           GO TO 6450-REWRITE.
 16144
 16145     IF SUB-1 = 6
 16146      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16147      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16148      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16149      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16150      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16151      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16152      GO TO 6430-LOOP.
 16153
 16154     ADD 1                       TO SUB-1.
 16155     GO TO 6430-LOOP.
 16156
 16157
 16158 6440-AIG-LOOP.
 16159
 16160     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16161       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16162       IF WS-OPEN-CLOSE-SW = '1'
 16163         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16164         IF PI-PMTTYPE = '2'
 16165           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16166           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16167         ELSE
 16168           IF PI-PMTTYPE = '3'
 16169             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16170             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16171           ELSE
 16172             IF PI-PMTTYPE = '4'
 16173               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16174               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16175             ELSE
 16176               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16177               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16178       ELSE
 16179         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16180         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16181         GO TO 6450-REWRITE.
 16182
 16183     IF SUB-1 = 6
 16184      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16185      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16186      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16187      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16188      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16189      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16190      GO TO 6440-AIG-LOOP.
 16191
 16192     ADD 1                       TO SUB-1.
 16193     GO TO 6440-AIG-LOOP.
 16194
 16195 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 309
* EL156.cbl
 16196     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16197     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16198     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16199
 16200     IF PI-COMPANY-ID = 'DMD'
 16201         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16202         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16203         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16204         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16205         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16206
 16207
 16208* EXEC CICS REWRITE
 16209*         DATASET  ('ELTRLR')
 16210*         FROM     (ACTIVITY-TRAILERS)
 16211*     END-EXEC.
 16212     MOVE LENGTH OF
 16213      ACTIVITY-TRAILERS
 16214       TO DFHEIV11
 16215     MOVE 'ELTRLR' TO DFHEIV1
 16216*    MOVE '&& L                  %   #00015059' TO DFHEIV0
 16217     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16218     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16219     MOVE X'2020233030303135303539' TO DFHEIV0(25:11)
 16220     CALL 'kxdfhei1' USING DFHEIV0,
 16221           DFHEIV1,
 16222           ACTIVITY-TRAILERS,
 16223           DFHEIV11,
 16224           DFHEIV99
 16225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16226
 16227
 16228 6499-EXIT.
 16229      EXIT.
 16230
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 310
* EL156.cbl
 16232 6500-READ-DLO035.
 16233     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16234     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16235     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16236     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16237
 16238
 16239* EXEC CICS LINK
 16240*        PROGRAM    ('DLO035')
 16241*        COMMAREA   (DLO035-KEY)
 16242*        LENGTH     (DL35-LENGTH)
 16243*    END-EXEC.
 16244     MOVE 'DLO035' TO DFHEIV1
 16245*    MOVE '."C                   (   #00015074' TO DFHEIV0
 16246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16248     MOVE X'2020233030303135303734' TO DFHEIV0(25:11)
 16249     CALL 'kxdfhei1' USING DFHEIV0,
 16250           DFHEIV1,
 16251           DLO035-KEY,
 16252           DL35-LENGTH,
 16253           DFHEIV99,
 16254           DFHEIV99,
 16255           DFHEIV99,
 16256           DFHEIV99
 16257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16258
 16259
 16260     IF DL35-RETURN-CODE = 'OK'
 16261         GO TO 6500-EXIT.
 16262
 16263     IF DL35-RETURN-CODE = '01'
 16264         MOVE ER-7830            TO EMI-ERROR
 16265         GO TO 6500-BAD-EXIT.
 16266
 16267     IF DL35-RETURN-CODE = '02'
 16268         MOVE ER-7831            TO EMI-ERROR
 16269         GO TO 6500-BAD-EXIT.
 16270
 16271     IF DL35-RETURN-CODE = '03'
 16272         MOVE ER-7832            TO EMI-ERROR
 16273         GO TO 6500-BAD-EXIT.
 16274
 16275     IF DL35-RETURN-CODE = '04'
 16276         MOVE ER-7833            TO EMI-ERROR
 16277         GO TO 6500-BAD-EXIT.
 16278
 16279     IF DL35-RETURN-CODE = '05'
 16280         MOVE ER-7834            TO EMI-ERROR
 16281         GO TO 6500-BAD-EXIT.
 16282
 16283     IF DL35-RETURN-CODE = '06'
 16284         MOVE ER-7835            TO EMI-ERROR
 16285         GO TO 6500-BAD-EXIT.
 16286
 16287     IF DL35-RETURN-CODE = '07'
 16288         MOVE ER-7836            TO EMI-ERROR
 16289         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 311
* EL156.cbl
 16290
 16291     IF DL35-RETURN-CODE = 'E1'
 16292         MOVE ER-7837            TO EMI-ERROR
 16293         GO TO 6500-BAD-EXIT.
 16294
 16295     IF DL35-RETURN-CODE NOT = 'OK'
 16296         MOVE ER-7838            TO EMI-ERROR
 16297         GO TO 6500-BAD-EXIT.
 16298
 16299 6500-EXIT.
 16300      EXIT.
 16301
 16302 6500-BAD-EXIT.
 16303
 16304* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16305*    MOVE '6"R                   !   #00015123' TO DFHEIV0
 16306     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16308     MOVE X'2020233030303135313233' TO DFHEIV0(25:11)
 16309     CALL 'kxdfhei1' USING DFHEIV0
 16310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16311
 16312     MOVE -1                 TO PMTTYPEL.
 16313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16314     GO TO 8200-SEND-DATAONLY.
 16315
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 312
* EL156.cbl
 16317 6600-UPDATE-DLO035.
 16318     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16319     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16320     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16321     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16322
 16323
 16324* EXEC CICS LINK
 16325*        PROGRAM    ('DLO035')
 16326*        COMMAREA   (DLO035-KEY)
 16327*        LENGTH     (DL35-LENGTH)
 16328*    END-EXEC.
 16329     MOVE 'DLO035' TO DFHEIV1
 16330*    MOVE '."C                   (   #00015135' TO DFHEIV0
 16331     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16333     MOVE X'2020233030303135313335' TO DFHEIV0(25:11)
 16334     CALL 'kxdfhei1' USING DFHEIV0,
 16335           DFHEIV1,
 16336           DLO035-KEY,
 16337           DL35-LENGTH,
 16338           DFHEIV99,
 16339           DFHEIV99,
 16340           DFHEIV99,
 16341           DFHEIV99
 16342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16343
 16344
 16345     IF DL35-RETURN-CODE = 'OK'
 16346         GO TO 6600-EXIT.
 16347
 16348     IF DL35-RETURN-CODE = '01'
 16349         MOVE ER-7830            TO EMI-ERROR
 16350         GO TO 6500-BAD-EXIT.
 16351
 16352     IF DL35-RETURN-CODE = '02'
 16353         MOVE ER-7831            TO EMI-ERROR
 16354         GO TO 6500-BAD-EXIT.
 16355
 16356     IF DL35-RETURN-CODE = '03'
 16357         MOVE ER-7832            TO EMI-ERROR
 16358         GO TO 6500-BAD-EXIT.
 16359
 16360     IF DL35-RETURN-CODE = '04'
 16361         MOVE ER-7833            TO EMI-ERROR
 16362         GO TO 6500-BAD-EXIT.
 16363
 16364     IF DL35-RETURN-CODE = '05'
 16365         MOVE ER-7834            TO EMI-ERROR
 16366         GO TO 6500-BAD-EXIT.
 16367
 16368     IF DL35-RETURN-CODE = '06'
 16369         MOVE ER-7835            TO EMI-ERROR
 16370         GO TO 6500-BAD-EXIT.
 16371
 16372     IF DL35-RETURN-CODE = '07'
 16373         MOVE ER-7836            TO EMI-ERROR
 16374         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 313
* EL156.cbl
 16375
 16376     IF DL35-RETURN-CODE = 'E1'
 16377         MOVE ER-7837            TO EMI-ERROR
 16378         GO TO 6500-BAD-EXIT.
 16379
 16380     IF DL35-RETURN-CODE NOT = 'OK'
 16381         MOVE ER-7838            TO EMI-ERROR
 16382         GO TO 6500-BAD-EXIT.
 16383
 16384 6600-EXIT.
 16385      EXIT.
 16386
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 314
* EL156.cbl
 16388 6700-UPDATE-ACTQ.
 16389***************************************************************
 16390*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16391*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16392*    ONE ALREADY THERE.                                       *
 16393***************************************************************
 16394
 16395
 16396* EXEC CICS HANDLE CONDITION
 16397*         NOTFND(6720-BUILD-NEW-RECORD)
 16398*     END-EXEC.
 16399*    MOVE '"$I                   ! 6 #00015191' TO DFHEIV0
 16400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16402     MOVE X'3620233030303135313931' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0
 16404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16405
 16406
 16407
 16408* EXEC CICS READ
 16409*         DATASET('ELACTQ')
 16410*         RIDFLD (ELMSTR-KEY)
 16411*         SET    (ADDRESS OF ACTIVITY-QUE)
 16412*         UPDATE
 16413*     END-EXEC.
 16414     MOVE 'ELACTQ' TO DFHEIV1
 16415*    MOVE '&"S        EU         (   #00015195' TO DFHEIV0
 16416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16417     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16418     MOVE X'2020233030303135313935' TO DFHEIV0(25:11)
 16419     CALL 'kxdfhei1' USING DFHEIV0,
 16420           DFHEIV1,
 16421           DFHEIV20,
 16422           DFHEIV99,
 16423           ELMSTR-KEY,
 16424           DFHEIV99,
 16425           DFHEIV99,
 16426           DFHEIV99
 16427     SET ADDRESS OF ACTIVITY-QUE TO
 16428         DFHEIV20
 16429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16430
 16431
 16432     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16433
 16434     IF PI-AIG-SPECIAL-BENEFIT AND
 16435        PI-CASH = 'Y'
 16436         ADD 2                   TO AQ-PAYMENT-COUNTER
 16437     ELSE
 16438         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16439
 16440     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16441         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16442
 16443     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16444
 16445     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 315
* EL156.cbl
 16446         IF WS-PMT-APPROVAL-SW = 'A'
 16447             NEXT SENTENCE
 16448         ELSE
 16449            IF PI-AIG-SPECIAL-BENEFIT AND
 16450               PI-CASH = 'Y'
 16451                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16452                                     WS-PMT-UNAPPROVED-CNT
 16453            ELSE
 16454                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16455                                     WS-PMT-UNAPPROVED-CNT
 16456     ELSE
 16457         IF PI-PMT-APPR-SW = 'Y'
 16458            IF PI-AIG-SPECIAL-BENEFIT AND
 16459               PI-CASH = 'Y'
 16460                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16461                                     WS-PMT-UNAPPROVED-CNT
 16462            ELSE
 16463                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16464                                     WS-PMT-UNAPPROVED-CNT.
 16465
 16466     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16467         MOVE ER-3536 TO EMI-ERROR
 16468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16469
 16470     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16471
 16472
 16473* EXEC CICS REWRITE
 16474*         DATASET('ELACTQ')
 16475*         FROM   (ACTIVITY-QUE)
 16476*     END-EXEC.
 16477     MOVE LENGTH OF
 16478      ACTIVITY-QUE
 16479       TO DFHEIV11
 16480     MOVE 'ELACTQ' TO DFHEIV1
 16481*    MOVE '&& L                  %   #00015242' TO DFHEIV0
 16482     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16483     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16484     MOVE X'2020233030303135323432' TO DFHEIV0(25:11)
 16485     CALL 'kxdfhei1' USING DFHEIV0,
 16486           DFHEIV1,
 16487           ACTIVITY-QUE,
 16488           DFHEIV11,
 16489           DFHEIV99
 16490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16491
 16492
 16493     GO TO 6799-EXIT.
 16494
 16495 6720-BUILD-NEW-RECORD.
 16496
 16497* EXEC CICS GETMAIN
 16498*         SET    (ADDRESS OF ACTIVITY-QUE)
 16499*         LENGTH (60)
 16500*         INITIMG(GETMAIN-SPACE)
 16501*     END-EXEC.
 16502     MOVE 60
 16503       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 316
* EL156.cbl
 16504*    MOVE ',"IL                  $   #00015250' TO DFHEIV0
 16505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16507     MOVE X'2020233030303135323530' TO DFHEIV0(25:11)
 16508     CALL 'kxdfhei1' USING DFHEIV0,
 16509           DFHEIV20,
 16510           DFHEIV11,
 16511           GETMAIN-SPACE
 16512     SET ADDRESS OF ACTIVITY-QUE TO
 16513         DFHEIV20
 16514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16515
 16516
 16517     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16518
 16519     IF PI-AIG-SPECIAL-BENEFIT AND
 16520        PI-CASH = 'Y'
 16521         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16522     ELSE
 16523         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16524
 16525     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16526     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16527     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16528     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16529                                    AQ-FOLLOWUP-DATE.
 16530     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16531     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16532
 16533     IF PI-PMT-GRADUATED
 16534         IF WS-PMT-APPROVAL-SW = 'A'
 16535             NEXT SENTENCE
 16536         ELSE
 16537            IF PI-AIG-SPECIAL-BENEFIT AND
 16538               PI-CASH = 'Y'
 16539                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16540            ELSE
 16541                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16542     ELSE
 16543         IF PI-PMT-APPR-SW = 'Y'
 16544            IF PI-AIG-SPECIAL-BENEFIT AND
 16545               PI-CASH = 'Y'
 16546                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16547            ELSE
 16548                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16549
 16550     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16551         MOVE ER-3536 TO EMI-ERROR
 16552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16553
 16554
 16555* EXEC CICS WRITE
 16556*         DATASET('ELACTQ')
 16557*         RIDFLD (ELMSTR-KEY)
 16558*         FROM   (ACTIVITY-QUE)
 16559*     END-EXEC.
 16560     MOVE LENGTH OF
 16561      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 317
* EL156.cbl
 16562       TO DFHEIV11
 16563     MOVE 'ELACTQ' TO DFHEIV1
 16564*    MOVE '&$ L                  ''   #00015293' TO DFHEIV0
 16565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16567     MOVE X'2020233030303135323933' TO DFHEIV0(25:11)
 16568     CALL 'kxdfhei1' USING DFHEIV0,
 16569           DFHEIV1,
 16570           ACTIVITY-QUE,
 16571           DFHEIV11,
 16572           ELMSTR-KEY,
 16573           DFHEIV99,
 16574           DFHEIV99
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578 6799-EXIT.
 16579      EXIT.
 16580
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 318
* EL156.cbl
 16582 6800-BUILD-FORM-TRAILER.
 16583
 16584
 16585* EXEC CICS GETMAIN
 16586*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16587*         LENGTH   (200)
 16588*         INITIMG  (GETMAIN-SPACE)
 16589*    END-EXEC.
 16590     MOVE 200
 16591       TO DFHEIV11
 16592*    MOVE ',"IL                  $   #00015305' TO DFHEIV0
 16593     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16594     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16595     MOVE X'2020233030303135333035' TO DFHEIV0(25:11)
 16596     CALL 'kxdfhei1' USING DFHEIV0,
 16597           DFHEIV20,
 16598           DFHEIV11,
 16599           GETMAIN-SPACE
 16600     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16601         DFHEIV20
 16602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16603
 16604
 16605     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16606
 16607     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16608     MOVE 'AT'                   TO AT-RECORD-ID.
 16609     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16610
 16611     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16612     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16613                                    AT-FORM-LAST-MAINT-DT
 16614                                    AT-FORM-SEND-ON-DT.
 16615     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16616                                    AT-FORM-LAST-UPDATED-BY.
 16617     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16618     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16619     MOVE '6'                    TO DC-OPTION-CODE.
 16620     MOVE +29                    TO DC-ELAPSED-DAYS.
 16621     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16622     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16623     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16624
 16625     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16626         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16627
 16628     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16629                                    AT-FORM-RE-SEND-DT
 16630                                    AT-EMP-FORM-ANSWERED-DT
 16631                                    AT-PHY-FORM-ANSWERED-DT
 16632                                    AT-EMP-FORM-SEND-ON-DT
 16633                                    AT-PHY-FORM-SEND-ON-DT
 16634                                    AT-FORM-PRINTED-DT
 16635                                    AT-FORM-REPRINT-DT.
 16636     MOVE '2'                    TO AT-FORM-TYPE.
 16637
 16638     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16639     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 319
* EL156.cbl
 16640
 16641     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16642         NEXT SENTENCE
 16643     ELSE
 16644         IF CL-PROG-FORM-TYPE NOT = 'S'
 16645            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16646
 16647
 16648* EXEC CICS WRITE
 16649*         DATASET  ('ELTRLR')
 16650*         FROM     (ACTIVITY-TRAILERS)
 16651*         RIDFLD   (AT-CONTROL-PRIMARY)
 16652*     END-EXEC.
 16653     MOVE LENGTH OF
 16654      ACTIVITY-TRAILERS
 16655       TO DFHEIV11
 16656     MOVE 'ELTRLR' TO DFHEIV1
 16657*    MOVE '&$ L                  ''   #00015353' TO DFHEIV0
 16658     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16660     MOVE X'2020233030303135333533' TO DFHEIV0(25:11)
 16661     CALL 'kxdfhei1' USING DFHEIV0,
 16662           DFHEIV1,
 16663           ACTIVITY-TRAILERS,
 16664           DFHEIV11,
 16665           AT-CONTROL-PRIMARY,
 16666           DFHEIV99,
 16667           DFHEIV99
 16668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16669
 16670
 16671 6899-EXIT.
 16672      EXIT.
 16673
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 320
* EL156.cbl
 16675 6900-BUILD-ARCHIVE-HEADER.
 16676
 16677     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16678     MOVE '1'                    TO CNTL-REC-TYPE.
 16679     MOVE +0                     TO CNTL-SEQ-NO.
 16680     MOVE SPACES                 TO CNTL-ACCESS.
 16681
 16682
 16683* EXEC CICS READ
 16684*         DATASET  ('ELCNTL')
 16685*         SET      (ADDRESS OF CONTROL-FILE)
 16686*         RIDFLD   (ELCNTL-KEY)
 16687*         UPDATE
 16688*    END-EXEC.
 16689     MOVE 'ELCNTL' TO DFHEIV1
 16690*    MOVE '&"S        EU         (   #00015370' TO DFHEIV0
 16691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16692     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16693     MOVE X'2020233030303135333730' TO DFHEIV0(25:11)
 16694     CALL 'kxdfhei1' USING DFHEIV0,
 16695           DFHEIV1,
 16696           DFHEIV20,
 16697           DFHEIV99,
 16698           ELCNTL-KEY,
 16699           DFHEIV99,
 16700           DFHEIV99,
 16701           DFHEIV99
 16702     SET ADDRESS OF CONTROL-FILE TO
 16703         DFHEIV20
 16704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16705
 16706
 16707     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16708     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16709
 16710
 16711* EXEC CICS REWRITE
 16712*         FROM     (CONTROL-FILE)
 16713*         DATASET  ('ELCNTL')
 16714*    END-EXEC.
 16715     MOVE LENGTH OF
 16716      CONTROL-FILE
 16717       TO DFHEIV11
 16718     MOVE 'ELCNTL' TO DFHEIV1
 16719*    MOVE '&& L                  %   #00015380' TO DFHEIV0
 16720     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16721     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16722     MOVE X'2020233030303135333830' TO DFHEIV0(25:11)
 16723     CALL 'kxdfhei1' USING DFHEIV0,
 16724           DFHEIV1,
 16725           CONTROL-FILE,
 16726           DFHEIV11,
 16727           DFHEIV99
 16728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16729
 16730
 16731
 16732* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 321
* EL156.cbl
 16733*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16734*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16735*    END-EXEC.
 16736*    MOVE '"$$%                  ! 7 #00015385' TO DFHEIV0
 16737     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16739     MOVE X'3720233030303135333835' TO DFHEIV0(25:11)
 16740     CALL 'kxdfhei1' USING DFHEIV0
 16741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16742
 16743
 16744
 16745* EXEC CICS GETMAIN
 16746*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16747*         LENGTH  (ELARCH-LENGTH)
 16748*         INITIMG (GETMAIN-SPACE)
 16749*    END-EXEC.
 16750*    MOVE ',"IL                  $   #00015390' TO DFHEIV0
 16751     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16753     MOVE X'2020233030303135333930' TO DFHEIV0(25:11)
 16754     CALL 'kxdfhei1' USING DFHEIV0,
 16755           DFHEIV20,
 16756           ELARCH-LENGTH,
 16757           GETMAIN-SPACE
 16758     SET ADDRESS OF LETTER-ARCHIVE TO
 16759         DFHEIV20
 16760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16761
 16762
 16763     MOVE 'LA'                   TO LA-RECORD-ID.
 16764     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16765                                    LA-ARCHIVE-NO-A1.
 16766     MOVE '4'                    TO LA-RECORD-TYPE
 16767                                    LA-RECORD-TYPE-A1.
 16768     MOVE +0                     TO LA-LINE-SEQ-NO
 16769                                    LA-LINE-SEQ-NO-A1.
 16770     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16771                                    LA-COMPANY-CD-A1.
 16772     MOVE CL-CARRIER             TO LA4-CARRIER.
 16773     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16774     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16775     MOVE CL-CERT-STATE          TO LA4-STATE.
 16776     MOVE +0                     TO LA4-NO-OF-COPIES.
 16777     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16778     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16779     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16780                                    LA4-INITIAL-PRINT-DATE
 16781                                    LA4-RESEND-PRINT-DATE
 16782                                    LA4-FORM-REM-PRINT-DT.
 16783     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16784     MOVE '2'                    TO LA4-FORM-TYPE.
 16785
 16786
 16787* EXEC CICS WRITE
 16788*         DATASET  ('ELARCH')
 16789*         FROM     (LETTER-ARCHIVE)
 16790*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 322
* EL156.cbl
 16791*    END-EXEC.
 16792     MOVE LENGTH OF
 16793      LETTER-ARCHIVE
 16794       TO DFHEIV11
 16795     MOVE 'ELARCH' TO DFHEIV1
 16796*    MOVE '&$ L                  ''   #00015419' TO DFHEIV0
 16797     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16798     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16799     MOVE X'2020233030303135343139' TO DFHEIV0(25:11)
 16800     CALL 'kxdfhei1' USING DFHEIV0,
 16801           DFHEIV1,
 16802           LETTER-ARCHIVE,
 16803           DFHEIV11,
 16804           LA-CONTROL-PRIMARY,
 16805           DFHEIV99,
 16806           DFHEIV99
 16807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16808
 16809
 16810 6999-EXIT.
 16811      EXIT.
 16812
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 323
* EL156.cbl
 16814 7000-SHOW-CLAIM.
 16815     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16816     MOVE 'A'                    TO PI-PASS-SW.
 16817     MOVE LOW-VALUES             TO PI-CPYFROM
 16818                                    PI-MONTH-END-SAVE
 16819                                    PI-CPYTHRU.
 16820
 16821     MOVE ZEROS                  TO PI-FATAL-COUNT
 16822                                    PI-DAILY-RATE
 16823                                    PI-BEN-DAYS
 16824                                    PI-MANUAL-SW
 16825                                    PI-SAVE-CURSOR
 16826                                    PI-FORCE-COUNT
 16827                                    PI-HOLDTIL
 16828                                    PI-EPYFROM
 16829                                    PI-EPYTHRU
 16830                                    PI-EDAYS
 16831                                    PI-EPYAMT
 16832                                    PI-ERESV
 16833                                    PI-EEXPENS
 16834                                    PI-CDAYS
 16835                                    PI-CPYAMT
 16836                                    PI-CRESV
 16837                                    PI-CEXPENS
 16838                                    PI-INT-RATE
 16839                                    PI-AIGFROM.
 16840     MOVE ZEROS                  TO PI-PROOF-DATE.
 16841     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16842                                    PI-REM-BEN-AMT
 16843                                    PI-MO-BEN-AMT.
 16844
 16845     MOVE LOW-VALUES             TO EL156AI.
 16846     MOVE MAP-NAMEA              TO MAP-NAME.
 16847
 16848* EXEC CICS HANDLE CONDITION
 16849*        NOTFND   (7010-BUILD-MAP)
 16850*    END-EXEC.
 16851*    MOVE '"$I                   ! 8 #00015462' TO DFHEIV0
 16852     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16854     MOVE X'3820233030303135343632' TO DFHEIV0(25:11)
 16855     CALL 'kxdfhei1' USING DFHEIV0
 16856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16857
 16858
 16859     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16860     MOVE '2'                    TO CNTL-REC-TYPE.
 16861     MOVE +0                     TO CNTL-SEQ-NO.
 16862     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16863
 16864
 16865* EXEC CICS READ
 16866*         DATASET  ('ELCNTL')
 16867*         SET      (ADDRESS OF CONTROL-FILE)
 16868*         RIDFLD   (ELCNTL-KEY)
 16869*    END-EXEC.
 16870     MOVE 'ELCNTL' TO DFHEIV1
 16871*    MOVE '&"S        E          (   #00015471' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 324
* EL156.cbl
 16872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16874     MOVE X'2020233030303135343731' TO DFHEIV0(25:11)
 16875     CALL 'kxdfhei1' USING DFHEIV0,
 16876           DFHEIV1,
 16877           DFHEIV20,
 16878           DFHEIV99,
 16879           ELCNTL-KEY,
 16880           DFHEIV99,
 16881           DFHEIV99,
 16882           DFHEIV99
 16883     SET ADDRESS OF CONTROL-FILE TO
 16884         DFHEIV20
 16885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16886
 16887
 16888     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16889
 16890     IF PI-APPROVAL-LEVEL = '4' OR '5'
 16891         MOVE AL-UANON      TO SURVYYNA
 16892     END-IF.
 16893
 16894
 16895     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16896     MOVE '1'                    TO CNTL-REC-TYPE.
 16897     MOVE SPACES                 TO CNTL-ACCESS.
 16898     MOVE +0                     TO CNTL-SEQ-NO.
 16899
 16900
 16901* EXEC CICS READ
 16902*         DATASET  ('ELCNTL')
 16903*         SET      (ADDRESS OF CONTROL-FILE)
 16904*         RIDFLD   (ELCNTL-KEY)
 16905*    END-EXEC.
 16906     MOVE 'ELCNTL' TO DFHEIV1
 16907*    MOVE '&"S        E          (   #00015489' TO DFHEIV0
 16908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16910     MOVE X'2020233030303135343839' TO DFHEIV0(25:11)
 16911     CALL 'kxdfhei1' USING DFHEIV0,
 16912           DFHEIV1,
 16913           DFHEIV20,
 16914           DFHEIV99,
 16915           ELCNTL-KEY,
 16916           DFHEIV99,
 16917           DFHEIV99,
 16918           DFHEIV99
 16919     SET ADDRESS OF CONTROL-FILE TO
 16920         DFHEIV20
 16921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16922
 16923
 16924     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16925
 16926 7010-BUILD-MAP.
 16927
 16928
 16929* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 325
* EL156.cbl
 16930*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16931*    END-EXEC.
 16932*    MOVE '"$I                   ! 9 #00015499' TO DFHEIV0
 16933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16935     MOVE X'3920233030303135343939' TO DFHEIV0(25:11)
 16936     CALL 'kxdfhei1' USING DFHEIV0
 16937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16938
 16939
 16940     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16941     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16942     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16943     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16944     MOVE 'MSTR'                 TO FILE-SWITCH.
 16945
 16946     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16947
 16948     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16949     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16950     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16951     MOVE CL-CCN                 TO PI-SV-CCN.
 16952
 16953     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16954     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16955     MOVE CL-CLAIM-NO            TO CLMNOO.
 16956     MOVE CL-CARRIER             TO CARRO.
 16957     MOVE CL-CERT-PRIME          TO CERTNOO.
 16958     MOVE CL-CERT-SFX            TO SUFXO.
 16959
 16960     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16961        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16962        CONTINUE
 16963     ELSE
 16964        MOVE AL-SADOF            TO ZINTHA
 16965                                    ZINTA
 16966                                    PINTHA
 16967                                    PINTA
 16968     END-IF
 16969     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16970     EVALUATE TRUE
 16971     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16972         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16973     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16974         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16975
 16976     WHEN CL-CLAIM-TYPE = 'I'
 16977         MOVE '  IU  '           TO CLMTYPO
 16978     WHEN CL-CLAIM-TYPE = 'G'
 16979         MOVE ' GAP  '           TO CLMTYPO
 16980     END-EVALUATE.
 16981     IF CLAIM-IS-OPEN
 16982         MOVE ' OPEN'            TO CLMSTATO
 16983     ELSE
 16984         MOVE 'CLOSED'           TO CLMSTATO.
 16985
 16986     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 16987
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 326
* EL156.cbl
 16988     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16989         MOVE SPACES             TO  PCERTNOO
 16990                                     PSUFXO
 16991                                     PRIMHDGO
 16992                                     SEQUO
 16993         MOVE AL-SADOF           TO  PCERTNOA
 16994                                     PSUFXA
 16995                                     PRIMHDGA
 16996                                     SEQUA
 16997     ELSE
 16998         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16999         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17000         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17001         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17002         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17003         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17004         MOVE AL-SANON               TO  PCERTNOA
 17005                                         PSUFXA
 17006                                         PRIMHDGA
 17007         MOVE AL-SABON               TO  SEQUA.
 17008
 17009     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17010
 17011     IF CL-NO-OF-PMTS-MADE = 0 AND
 17012        CL-TOTAL-PAID-AMT = 0
 17013         NEXT SENTENCE
 17014     ELSE
 17015         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17016             IF NOT PI-USES-PAID-TO
 17017                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17018                 MOVE ' '                 TO DC-OPTION-CODE
 17019                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17020                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17021             ELSE
 17022                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17023                 MOVE '6'                 TO DC-OPTION-CODE
 17024                 MOVE +1                  TO DC-ELAPSED-DAYS
 17025                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17026                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17027                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17028
 17029     IF MAP-NAME = 'EL156A'
 17030        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17031           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17032             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17033           end-if
 17034        end-if
 17035     end-if
 17036     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17037         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17038         MOVE ' '                TO DC-OPTION-CODE
 17039         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17040         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17041
 17042     IF CL-INCURRED-DT NOT = LOW-VALUES
 17043         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17044         MOVE ' '                TO DC-OPTION-CODE
 17045         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 327
* EL156.cbl
 17046         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17047
 17048     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17049
 17050     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17051         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17052         MOVE ' '                TO DC-OPTION-CODE
 17053         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17054         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17055
 17056     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17057         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17058         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17059     ELSE
 17060         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17061         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17062
 17063     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17064     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17065     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17066     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17067                                    PI-GROUPING.
 17068     MOVE CL-CERT-STATE          TO CERT-STATE
 17069                                    PI-STATE.
 17070     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17071                                    PI-ACCOUNT.
 17072     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17073     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17074     MOVE 'CERT'                 TO FILE-SWITCH.
 17075
 17076     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17077     if pi-company-id = 'DCC'
 17078        perform 7975-read-acct   thru 7975-exit
 17079     end-if
 17080     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17081     MOVE PI-STATE               TO WS-ST-ACCESS.
 17082     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17083     MOVE '3'                    TO CNTL-REC-TYPE.
 17084     MOVE +0                     TO CNTL-SEQ-NO.
 17085     MOVE 'STAT'                 TO FILE-SWITCH.
 17086
 17087     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17088
 17089     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17090     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17091
 17092     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17093        GO TO 7020-BYPASS-BENEFIT.
 17094
 17095     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17096     MOVE '4'                    TO CNTL-REC-TYPE.
 17097     MOVE +0                     TO CNTL-SEQ-NO.
 17098     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17099     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17100     MOVE 'BENE'                 TO FILE-SWITCH.
 17101
 17102     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17103
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 328
* EL156.cbl
 17104     IF NO-BENEFIT-FOUND
 17105        GO TO 7020-BYPASS-BENEFIT.
 17106
 17107     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17108     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17109     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17110
 17111 7020-BYPASS-BENEFIT.
 17112
 17113*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17114*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17115*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17116
 17117     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17118         GO TO 7021-GO-TO-LIFE.
 17119     move zeros                  to PI-MAX-BENEFIT-AMT
 17120     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17121
 17122     IF (PI-COMPANY-ID = 'DCC')
 17123        and (acct-found)
 17124        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17125        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17126        PERFORM 0900-GET-DDF-FACTORS
 17127                                 THRU 0900-EXIT
 17128        IF PDEF-FOUND
 17129           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17130              (P1 > +8)
 17131              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17132           END-PERFORM
 17133           IF P1 < +9
 17134              MOVE PD-MAX-AMT (P1)
 17135                                 TO PI-MAX-BENEFIT-AMT
 17136           END-IF
 17137        END-IF
 17138     end-if
 17139     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17140     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17141     if (pi-max-benefit-amt not = zeros)
 17142        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17143        move pi-max-benefit-amt  to beneo
 17144     else
 17145        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17146     end-if
 17147     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17148     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17149                                    CP-ORIGINAL-TERM.
 17150     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17151
 17152*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17153*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17154*    ELSE
 17155         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17156
 17157     MOVE ' '                    TO DC-OPTION-CODE.
 17158     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17159     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17160
 17161     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 329
* EL156.cbl
 17162         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17163         GO TO 7023-BYPASS-REMAINING-TERM.
 17164
 17165     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17166     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17167     GO TO 7022-AROUND-LIFE.
 17168
 17169 7021-GO-TO-LIFE.
 17170
 17171     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17172     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17173     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17174                                    CP-ORIGINAL-TERM.
 17175     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17176     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17177     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17178     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17179
 17180     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17181         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17182     ELSE
 17183         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17184
 17185     MOVE ' '                    TO DC-OPTION-CODE.
 17186     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17187     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17188
 17189 7022-AROUND-LIFE.
 17190
 17191     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17192     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17193     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17194     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17195     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17196     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17197     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17198
 17199     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17200
 17201     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17202        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17203           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17204
 17205     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17206        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17207           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17208
 17209 7023-BYPASS-REMAINING-TERM.
 17210     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17211       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17212          MOVE ZEROS                  TO BENEO
 17213       ELSE
 17214          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17215          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17216          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17217          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17218          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17219          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 330
* EL156.cbl
 17220          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17221          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17222          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17223          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17224          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17225          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17226          IF (PI-COMPANY-ID = 'DCC')
 17227             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17228             MOVE ' '            TO WS-PDEF-RECORD-SW
 17229             PERFORM 0900-GET-DDF-FACTORS
 17230                                 THRU 0900-EXIT
 17231             IF PDEF-FOUND
 17232                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17233                   (P1 > +8)
 17234                   OR (PD-PROD-CODE (P1) = 'L')
 17235                END-PERFORM
 17236                IF P1 < +9
 17237                   MOVE PD-MAX-AMT (P1)
 17238                                 TO CP-R-MAX-TOT-BEN
 17239                END-IF
 17240             END-IF
 17241          END-IF
 17242
 17243* EXEC CICS LINK
 17244*            PROGRAM  (LINK-REMAMT)
 17245*            COMMAREA (CALCULATION-PASS-AREA)
 17246*            LENGTH   (CP-COMM-LENGTH)
 17247*         END-EXEC
 17248*    MOVE '."C                   (   #00015805' TO DFHEIV0
 17249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17251     MOVE X'2020233030303135383035' TO DFHEIV0(25:11)
 17252     CALL 'kxdfhei1' USING DFHEIV0,
 17253           LINK-REMAMT,
 17254           CALCULATION-PASS-AREA,
 17255           CP-COMM-LENGTH,
 17256           DFHEIV99,
 17257           DFHEIV99,
 17258           DFHEIV99,
 17259           DFHEIV99
 17260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17261          MOVE CP-REMAINING-AMT       TO BENEO
 17262       end-if
 17263     end-if
 17264     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17265     MOVE +95                    TO TRLR-SEQ-NO
 17266
 17267* EXEC CICS READ
 17268*       DATASET  ('ELTRLR')
 17269*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17270*       RIDFLD   (ELTRLR-KEY)
 17271*       RESP     (WS-RESPONSE)
 17272*    END-EXEC
 17273     MOVE 'ELTRLR' TO DFHEIV1
 17274*    MOVE '&"S        E          (  N#00015815' TO DFHEIV0
 17275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17277     MOVE X'204E233030303135383135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 331
* EL156.cbl
 17278     CALL 'kxdfhei1' USING DFHEIV0,
 17279           DFHEIV1,
 17280           DFHEIV20,
 17281           DFHEIV99,
 17282           ELTRLR-KEY,
 17283           DFHEIV99,
 17284           DFHEIV99,
 17285           DFHEIV99
 17286     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17287         DFHEIV20
 17288     MOVE EIBRESP  TO WS-RESPONSE
 17289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17290
 17291     if ws-resp-normal
 17292        perform varying s1 from +1 by +1 until
 17293           at-note-error-no (s1) = spaces
 17294           move at-note-error-no (s1)
 17295                                 to emi-error
 17296           if at-note-error-no (s1) = '1653'
 17297              evaluate true
 17298                 when cl-claim-type = 'L'
 17299                    move '  LF  '
 17300                                 to emi-claim-type
 17301                 when cl-claim-type = 'I'
 17302                    move '  IU  '
 17303                                 to emi-claim-type
 17304                 when other
 17305                    move '  AH  '
 17306                                 to emi-claim-type
 17307              end-evaluate
 17308           end-if
 17309           PERFORM 9900-ERROR-FORMAT
 17310                                 THRU 9900-EXIT
 17311        end-perform
 17312     end-if
 17313     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17314         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17315            WS-LF-COVERAGE-TYPE = 'P'
 17316             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17317                                        CM-LF-ITD-DEATH-AMT
 17318             MOVE WS-REMAINING-AMT  TO  BENEO.
 17319
 17320     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17321     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17322     MOVE WS-TERMS               TO TERMSO.
 17323
 17324     IF WS-STATUS = '6' OR '7' OR '8'
 17325         MOVE AL-SABOF           TO CRTSTATA.
 17326
 17327     IF WS-STATUS = '1' OR '4'
 17328        IF CP-REMAINING-TERM-3 = ZEROS
 17329           MOVE 'EXPIRED'        TO CRTSTATO
 17330        ELSE
 17331           MOVE 'ACTIVE  '       TO CRTSTATO.
 17332
 17333     IF WS-STATUS = '2'
 17334         MOVE 'PEND    '         TO CRTSTATO.
 17335
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 332
* EL156.cbl
 17336     IF WS-STATUS = '3'
 17337         MOVE 'RESTORE '         TO CRTSTATO.
 17338
 17339     IF WS-STATUS = '5'
 17340         MOVE 'REISSUE '         TO CRTSTATO.
 17341
 17342     IF WS-STATUS = '6'
 17343         MOVE 'LMP DIS'          TO CRTSTATO.
 17344
 17345     IF WS-STATUS = '7'
 17346         MOVE 'DEATH'            TO CRTSTATO.
 17347
 17348     IF WS-STATUS = '8'
 17349         MOVE 'CANCEL'           TO CRTSTATO.
 17350
 17351     IF WS-STATUS = '9'
 17352         MOVE 'RE-ONLY '         TO CRTSTATO.
 17353
 17354     IF WS-STATUS = 'V'
 17355         MOVE 'VOID  '           TO CRTSTATO.
 17356
 17357     IF WS-STATUS = 'D'
 17358         MOVE 'DECLINE '         TO CRTSTATO.
 17359
 17360     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17361         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17362         MOVE '5'                TO CNTL-REC-TYPE
 17363     ELSE
 17364         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17365         MOVE '4'                TO CNTL-REC-TYPE.
 17366
 17367     MOVE '** NONE **'           TO COVERO.
 17368     MOVE AL-SABON               TO COVERA.
 17369
 17370     IF PI-COMPANY-ID = 'CVL'
 17371         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17372             MOVE CM-BENEFICIARY TO LOANNOO
 17373             MOVE AL-UANON       TO LOANNOA.
 17374
 17375     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17376        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17377        MOVE +91                 TO  TRLR-SEQ-NO
 17378
 17379* EXEC CICS READ
 17380*           DATASET  ('ELTRLR')
 17381*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17382*           RIDFLD   (ELTRLR-KEY)
 17383*           RESP     (WS-RESPONSE)
 17384*       END-EXEC
 17385     MOVE 'ELTRLR' TO DFHEIV1
 17386*    MOVE '&"S        E          (  N#00015909' TO DFHEIV0
 17387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17389     MOVE X'204E233030303135393039' TO DFHEIV0(25:11)
 17390     CALL 'kxdfhei1' USING DFHEIV0,
 17391           DFHEIV1,
 17392           DFHEIV20,
 17393           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 333
* EL156.cbl
 17394           ELTRLR-KEY,
 17395           DFHEIV99,
 17396           DFHEIV99,
 17397           DFHEIV99
 17398     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17399         DFHEIV20
 17400     MOVE EIBRESP  TO WS-RESPONSE
 17401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17402
 17403        IF WS-RESP-NORMAL
 17404           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17405        ELSE
 17406           MOVE SPACES           TO  LOANNOO
 17407        END-IF
 17408*052506
 17409*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17410*052506
 17411     END-IF
 17412
 17413     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17414        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17415
 17416     IF WS-BEN-CD = ZEROS
 17417         GO TO 7050-SHOW-CONTINUE.
 17418
 17419     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17420     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17421     MOVE +0                     TO CNTL-SEQ-NO.
 17422     MOVE 'BENE'                 TO FILE-SWITCH.
 17423
 17424     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17425
 17426     IF BENEFIT-FOUND
 17427         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17428         MOVE AL-SANON                    TO COVERA.
 17429
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 334
* EL156.cbl
 17431 7050-SHOW-CONTINUE.
 17432
 17433     IF PI-COMPANY-ID = 'DMD'
 17434         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17435
 17436     MOVE -1                     TO PMTTYPEL.
 17437     GO TO 8100-SEND-INITIAL-MAP.
 17438
 17439 7100-SHOW-RECORD-NOT-FOUND.
 17440     IF FILE-SWITCH = 'MSTR'
 17441         MOVE ER-0204            TO EMI-ERROR.
 17442
 17443     IF FILE-SWITCH = 'CERT'
 17444         MOVE ER-0206            TO EMI-ERROR.
 17445
 17446     IF FILE-SWITCH = 'STAT'
 17447         MOVE ER-0149            TO EMI-ERROR.
 17448
 17449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17450
 17451     MOVE -1                     TO PMTTYPEL.
 17452     GO TO 8100-SEND-INITIAL-MAP
 17453
 17454     .
 17455 7110-BUILD-PMT-TRLR.
 17456     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17457     MOVE +51                    TO TRLR-SEQ-NO
 17458
 17459* EXEC CICS READ
 17460*        DATASET  ('ELTRLR')
 17461*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17462*        RIDFLD   (ELTRLR-KEY)
 17463*        RESP     (WS-RESPONSE)
 17464*    END-EXEC
 17465     MOVE 'ELTRLR' TO DFHEIV1
 17466*    MOVE '&"S        E          (  N#00015971' TO DFHEIV0
 17467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17469     MOVE X'204E233030303135393731' TO DFHEIV0(25:11)
 17470     CALL 'kxdfhei1' USING DFHEIV0,
 17471           DFHEIV1,
 17472           DFHEIV20,
 17473           DFHEIV99,
 17474           ELTRLR-KEY,
 17475           DFHEIV99,
 17476           DFHEIV99,
 17477           DFHEIV99
 17478     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17479         DFHEIV20
 17480     MOVE EIBRESP  TO WS-RESPONSE
 17481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17482     IF WS-RESP-NORMAL
 17483        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17484     END-IF
 17485     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17486
 17487* EXEC CICS GETMAIN
 17488*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 335
* EL156.cbl
 17489*         LENGTH    (200)
 17490*         INITIMG   (GETMAIN-SPACE)
 17491*     END-EXEC
 17492     MOVE 200
 17493       TO DFHEIV11
 17494*    MOVE ',"IL                  $   #00015981' TO DFHEIV0
 17495     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17497     MOVE X'2020233030303135393831' TO DFHEIV0(25:11)
 17498     CALL 'kxdfhei1' USING DFHEIV0,
 17499           DFHEIV20,
 17500           DFHEIV11,
 17501           GETMAIN-SPACE
 17502     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17503         DFHEIV20
 17504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17505     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17506                                    AT-PREV-PAID-THRU-DT
 17507     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17508     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17509     MOVE 'AT'                   TO AT-RECORD-ID
 17510     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17511     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17512     MOVE '2'                    TO AT-TRAILER-TYPE
 17513     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17514                                    AT-PAYMENT-LAST-MAINT-DT
 17515     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17516                                    AT-PAYMENT-LAST-UPDATED-BY
 17517     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17518     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17519     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17520     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17521     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17522     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17523     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17524     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17525     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17526     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17527     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17528     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17529     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17530     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17531     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17532     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17533                                    AT-TO-BE-WRITTEN-DT
 17534     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17535                                    AT-CHECK-QUE-SEQUENCE
 17536                                    AT-ADDL-RESERVE
 17537     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17538                                    AT-VOID-SELECT-DT
 17539                                    AT-VOID-ACCEPT-DT
 17540                                    AT-VOID-DT
 17541                                    AT-PMT-PROOF-DT
 17542                                    AT-INT-PMT-SELECT-DT
 17543     MOVE ZEROS                  TO AT-DAILY-RATE
 17544                                    AT-ELIMINATION-DAYS
 17545     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17546*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 336
* EL156.cbl
 17547*        DUPREC    (7120-DUPREC)
 17548*    END-EXEC
 17549     .
 17550 7115-WRITE-INT-TRLR.
 17551
 17552* EXEC CICS WRITE
 17553*         DATASET       ('ELTRLR')
 17554*         FROM          (ACTIVITY-TRAILERS)
 17555*         RIDFLD        (AT-CONTROL-PRIMARY)
 17556*         RESP          (WS-RESPONSE)
 17557*     END-EXEC
 17558     MOVE LENGTH OF
 17559      ACTIVITY-TRAILERS
 17560       TO DFHEIV11
 17561     MOVE 'ELTRLR' TO DFHEIV1
 17562*    MOVE '&$ L                  ''  N#00016032' TO DFHEIV0
 17563     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17565     MOVE X'204E233030303136303332' TO DFHEIV0(25:11)
 17566     CALL 'kxdfhei1' USING DFHEIV0,
 17567           DFHEIV1,
 17568           ACTIVITY-TRAILERS,
 17569           DFHEIV11,
 17570           AT-CONTROL-PRIMARY,
 17571           DFHEIV99,
 17572           DFHEIV99
 17573     MOVE EIBRESP  TO WS-RESPONSE
 17574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17575      IF WS-RESP-DUPREC
 17576         GO TO 7120-DUPREC
 17577      END-IF
 17578     GO TO 7130-EXIT
 17579     .
 17580 7120-DUPREC.
 17581     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17582     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17583     GO TO 7115-WRITE-INT-TRLR
 17584     .
 17585 7130-EXIT.
 17586      EXIT.
 17587 7140-BUILD-NOTE-TRLR.
 17588
 17589
 17590* EXEC CICS GETMAIN
 17591*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17592*         LENGTH    (200)
 17593*         INITIMG   (GETMAIN-SPACE)
 17594*     END-EXEC
 17595     MOVE 200
 17596       TO DFHEIV11
 17597*    MOVE ',"IL                  $   #00016052' TO DFHEIV0
 17598     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17599     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17600     MOVE X'2020233030303136303532' TO DFHEIV0(25:11)
 17601     CALL 'kxdfhei1' USING DFHEIV0,
 17602           DFHEIV20,
 17603           DFHEIV11,
 17604           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 337
* EL156.cbl
 17605     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17606         DFHEIV20
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17608     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17609     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17610     MOVE 'AT'                   TO AT-RECORD-ID
 17611     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17612     MOVE '6'                    TO AT-TRAILER-TYPE
 17613     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17614                                    AT-GEN-INFO-LAST-MAINT-DT
 17615     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17616                                    AT-GEN-INFO-LAST-UPDATED-BY
 17617     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17618     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17619     .
 17620 7150-WRITE.
 17621
 17622* EXEC CICS HANDLE CONDITION
 17623*        DUPREC    (7160-DUPREC)
 17624*    END-EXEC
 17625*    MOVE '"$%                   ! : #00016070' TO DFHEIV0
 17626     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17628     MOVE X'3A20233030303136303730' TO DFHEIV0(25:11)
 17629     CALL 'kxdfhei1' USING DFHEIV0
 17630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17631
 17632* EXEC CICS WRITE
 17633*         DATASET     ('ELTRLR')
 17634*         FROM        (ACTIVITY-TRAILERS)
 17635*         RIDFLD      (AT-CONTROL-PRIMARY)
 17636*         RESP        (WS-RESPONSE)
 17637*     END-EXEC
 17638     MOVE LENGTH OF
 17639      ACTIVITY-TRAILERS
 17640       TO DFHEIV11
 17641     MOVE 'ELTRLR' TO DFHEIV1
 17642*    MOVE '&$ L                  ''  N#00016073' TO DFHEIV0
 17643     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17645     MOVE X'204E233030303136303733' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0,
 17647           DFHEIV1,
 17648           ACTIVITY-TRAILERS,
 17649           DFHEIV11,
 17650           AT-CONTROL-PRIMARY,
 17651           DFHEIV99,
 17652           DFHEIV99
 17653     MOVE EIBRESP  TO WS-RESPONSE
 17654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17655      IF WS-RESP-DUPREC
 17656         GO TO 7160-DUPREC
 17657      END-IF
 17658     GO TO 7170-EXIT
 17659     .
 17660 7160-DUPREC.
 17661     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17662     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 338
* EL156.cbl
 17663     GO TO 7150-WRITE
 17664     .
 17665 7170-EXIT.
 17666      EXIT.
 17667
 17668 7180-ADD-CERT-NOTE.
 17669*ADD CERT NOTE FOR SC NP+6
 17670
 17671
 17672* EXEC CICS GETMAIN
 17673*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17674*         LENGTH    (150)
 17675*         INITIMG   (GETMAIN-SPACE)
 17676*     END-EXEC.
 17677     MOVE 150
 17678       TO DFHEIV11
 17679*    MOVE ',"IL                  $   #00016095' TO DFHEIV0
 17680     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17682     MOVE X'2020233030303136303935' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0,
 17684           DFHEIV20,
 17685           DFHEIV11,
 17686           GETMAIN-SPACE
 17687     SET ADDRESS OF CERT-NOTE-FILE TO
 17688         DFHEIV20
 17689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17690
 17691
 17692     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17693     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17694     MOVE +1                     TO WRK-NOTE-SEQ.
 17695     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17696     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17697     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17698     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17699     MOVE CL-CERT-STATE          TO CZ-STATE.
 17700     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17701     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17702     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17703     MOVE '2'                    TO CZ-RECORD-TYPE.
 17704     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17705     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17706     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17707     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17708     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17709     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17710     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17711     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17712     IF PI-COMPANY-ID = 'AHL'
 17713        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17714           CONTINUE
 17715        ELSE
 17716           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17717              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17718           ELSE
 17719              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17720           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 339
* EL156.cbl
 17721        END-IF
 17722     END-IF
 17723     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17724     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17725
 17726 7181-WRITE.
 17727
 17728
 17729* EXEC CICS WRITE
 17730*         DATASET     ('ERCNOT')
 17731*         FROM        (CERT-NOTE-FILE)
 17732*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17733*         RESP        (WS-RESPONSE)
 17734*    END-EXEC.
 17735     MOVE LENGTH OF
 17736      CERT-NOTE-FILE
 17737       TO DFHEIV11
 17738     MOVE 'ERCNOT' TO DFHEIV1
 17739*    MOVE '&$ L                  ''  N#00016137' TO DFHEIV0
 17740     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17742     MOVE X'204E233030303136313337' TO DFHEIV0(25:11)
 17743     CALL 'kxdfhei1' USING DFHEIV0,
 17744           DFHEIV1,
 17745           CERT-NOTE-FILE,
 17746           DFHEIV11,
 17747           CZ-CONTROL-PRIMARY,
 17748           DFHEIV99,
 17749           DFHEIV99
 17750     MOVE EIBRESP  TO WS-RESPONSE
 17751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17752
 17753
 17754     IF WS-RESP-DUPREC
 17755         GO TO 7182-DUPREC
 17756     END-IF.
 17757
 17758     SET CERT-NOTE-ADDED TO TRUE.
 17759
 17760     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17761         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17762     END-IF.
 17763
 17764     GO TO 7189-EXIT.
 17765
 17766 7182-DUPREC.
 17767
 17768     ADD +1                      TO  WRK-NOTE-SEQ.
 17769     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17770     GO TO 7181-WRITE.
 17771
 17772 7189-EXIT.
 17773      EXIT.
 17774
 17775 7190-ADD-ORIG-NOTE.
 17776
 17777
 17778* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 340
* EL156.cbl
 17779*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17780*         LENGTH    (150)
 17781*         INITIMG   (GETMAIN-SPACE)
 17782*     END-EXEC.
 17783     MOVE 150
 17784       TO DFHEIV11
 17785*    MOVE ',"IL                  $   #00016167' TO DFHEIV0
 17786     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17787     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17788     MOVE X'2020233030303136313637' TO DFHEIV0(25:11)
 17789     CALL 'kxdfhei1' USING DFHEIV0,
 17790           DFHEIV20,
 17791           DFHEIV11,
 17792           GETMAIN-SPACE
 17793     SET ADDRESS OF CERT-NOTE-FILE TO
 17794         DFHEIV20
 17795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17796
 17797
 17798     ADD +1                      TO WRK-NOTE-SEQ.
 17799     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17800     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17801     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17802     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17803     MOVE CL-CERT-STATE          TO CZ-STATE.
 17804     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17805     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17806     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17807     MOVE '2'                    TO CZ-RECORD-TYPE.
 17808     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17809     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17810     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17811     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17812     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17813     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17814
 17815 7191-WRITE.
 17816
 17817
 17818* EXEC CICS WRITE
 17819*         DATASET     ('ERCNOT')
 17820*         FROM        (CERT-NOTE-FILE)
 17821*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17822*         RESP        (WS-RESPONSE)
 17823*    END-EXEC.
 17824     MOVE LENGTH OF
 17825      CERT-NOTE-FILE
 17826       TO DFHEIV11
 17827     MOVE 'ERCNOT' TO DFHEIV1
 17828*    MOVE '&$ L                  ''  N#00016192' TO DFHEIV0
 17829     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17831     MOVE X'204E233030303136313932' TO DFHEIV0(25:11)
 17832     CALL 'kxdfhei1' USING DFHEIV0,
 17833           DFHEIV1,
 17834           CERT-NOTE-FILE,
 17835           DFHEIV11,
 17836           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 341
* EL156.cbl
 17837           DFHEIV99,
 17838           DFHEIV99
 17839     MOVE EIBRESP  TO WS-RESPONSE
 17840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17841
 17842
 17843     IF WS-RESP-DUPREC
 17844         GO TO 7192-DUPREC
 17845     END-IF.
 17846
 17847     GO TO 7199-EXIT.
 17848
 17849 7192-DUPREC.
 17850
 17851     ADD +1                      TO  WRK-NOTE-SEQ.
 17852     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17853     GO TO 7191-WRITE.
 17854
 17855 7199-EXIT.
 17856      EXIT.
 17857 7200-FIND-BENEFIT.
 17858     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17859
 17860
 17861* EXEC CICS HANDLE CONDITION
 17862*        ENDFILE(7200-EXIT)
 17863*        NOTFND(7200-EXIT)
 17864*    END-EXEC.
 17865*    MOVE '"$''I                  ! ; #00016216' TO DFHEIV0
 17866     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17868     MOVE X'3B20233030303136323136' TO DFHEIV0(25:11)
 17869     CALL 'kxdfhei1' USING DFHEIV0
 17870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17871
 17872
 17873
 17874* EXEC CICS READ
 17875*        DATASET('ELCNTL')
 17876*        SET(ADDRESS OF CONTROL-FILE)
 17877*        RIDFLD(ELCNTL-KEY)
 17878*        GTEQ
 17879*    END-EXEC.
 17880     MOVE 'ELCNTL' TO DFHEIV1
 17881*    MOVE '&"S        G          (   #00016221' TO DFHEIV0
 17882     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17884     MOVE X'2020233030303136323231' TO DFHEIV0(25:11)
 17885     CALL 'kxdfhei1' USING DFHEIV0,
 17886           DFHEIV1,
 17887           DFHEIV20,
 17888           DFHEIV99,
 17889           ELCNTL-KEY,
 17890           DFHEIV99,
 17891           DFHEIV99,
 17892           DFHEIV99
 17893     SET ADDRESS OF CONTROL-FILE TO
 17894         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 342
* EL156.cbl
 17895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17896
 17897
 17898     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17899        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17900           GO TO 7200-EXIT.
 17901
 17902     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17903         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17904            ((SUB-1 > 8) OR
 17905            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17906
 17907     IF SUB-1 NOT = 9
 17908         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17909
 17910     GO TO 7200-EXIT.
 17911
 17912 7200-BENEFIT-DUMMY.
 17913
 17914 7200-DUMMY-EXIT.
 17915     EXIT.
 17916
 17917 7200-EXIT.
 17918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 343
* EL156.cbl
 17920*052506
 17921*052506 7250-FIND-LETTER-TRLR.
 17922*052506     EXEC CICS HANDLE CONDITION
 17923*052506         ENDFILE  (7250-END)
 17924*052506         NOTFND   (7250-END)
 17925*052506     END-EXEC.
 17926*052506
 17927*052506     EXEC CICS STARTBR
 17928*052506         DATASET   ('ELTRLR')
 17929*052506         RIDFLD    (ELTRLR-KEY)
 17930*052506         GTEQ
 17931*052506     END-EXEC.
 17932*052506
 17933*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17934*052506
 17935*052506 7250-FIND-LOOP.
 17936*052506     EXEC CICS READNEXT
 17937*052506         DATASET   ('ELTRLR')
 17938*052506         RIDFLD    (ELTRLR-KEY)
 17939*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17940*052506     END-EXEC.
 17941*052506
 17942*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17943*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17944*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17945*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17946*052506        GO TO 7250-END
 17947*052506     END-IF.
 17948*052506
 17949*052506     IF AT-TRAILER-TYPE NOT = '4'
 17950*052506         GO TO 7250-FIND-LOOP
 17951*052506     END-IF.
 17952*052506
 17953*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 17954*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 17955*052506     END-IF.
 17956*052506
 17957*052506     GO TO 7250-FIND-LOOP.
 17958*052506
 17959*052506 7250-END.
 17960*052506
 17961*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 17962*051506         MOVE SPACES             TO  DC-OPTION-CODE
 17963*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 17964*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17965*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 17966*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17967*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17968*052506     END-IF.
 17969*052506
 17970*052506     EXEC CICS ENDBR
 17971*052506          DATASET    ('ELTRLR')
 17972*052506     END-EXEC.
 17973*052506
 17974*052506 7250-EXIT.
 17975*052506     EXIT.
 17976*052506     EJECT
 17977*052506
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 344
* EL156.cbl
 17978 7300-CHECK-AUTO-ACTIVITY.
 17979
 17980     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17981         NEXT SENTENCE
 17982     ELSE
 17983         GO TO 7399-EXIT.
 17984
 17985     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 17986
 17987     IF WS-ACT-REC-FOUND-SW = 'N'
 17988         GO TO 7399-EXIT.
 17989
 17990     IF PI-ACTIVITY-CODE = 09
 17991         GO TO 7300-CONT-AUTO-ACTIVITY.
 17992
 17993     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 17994        (PI-ACTIVITY-CODE = 11)
 17995         GO TO 7300-CONT-AUTO-ACTIVITY.
 17996
 17997     IF PI-PROVISIONAL-IND = 'P'
 17998         IF PI-PMTTYPE = '1'
 17999             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18000                 MOVE 'N'    TO  PI-RESET-SW
 18001                 GO TO 7399-EXIT.
 18002
 18003     IF PI-PMTTYPE = '1'
 18004         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18005             MOVE 'N'        TO  PI-RESET-SW
 18006             GO TO 7399-EXIT.
 18007
 18008     IF PI-PMTTYPE = '2' OR '3'
 18009         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18010             MOVE 'N'        TO  PI-RESET-SW
 18011             GO TO 7399-EXIT.
 18012
 18013     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18014         IF PI-PROVISIONAL-IND = 'P'
 18015             NEXT SENTENCE
 18016         ELSE
 18017             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18018
 18019 7300-CONT-AUTO-ACTIVITY.
 18020
 18021     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18022         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18023         MOVE '4'            TO DC-OPTION-CODE
 18024         MOVE +0             TO DC-ELAPSED-DAYS
 18025                                DC-ELAPSED-MONTHS
 18026         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18027         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18028         IF PI-USES-PAID-TO
 18029             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18030             IF NO-CONVERSION-ERROR
 18031                 MOVE +1     TO DC-ELAPSED-DAYS
 18032                 MOVE +0     TO DC-ELAPSED-MONTHS
 18033                 MOVE '6'    TO DC-OPTION-CODE
 18034                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18035                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 345
* EL156.cbl
 18036                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18037
 18038     IF PI-PFKEY-USED = DFHPF5
 18039         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18040         IF PI-USES-PAID-TO
 18041             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18042             MOVE +1                  TO DC-ELAPSED-DAYS
 18043             MOVE +0                  TO DC-ELAPSED-MONTHS
 18044             MOVE '6'                 TO DC-OPTION-CODE
 18045             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18046             IF NO-CONVERSION-ERROR
 18047                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18048
 18049     IF WS-CHK-THRU-DT < PI-EXP-DT
 18050         NEXT SENTENCE
 18051     ELSE
 18052         MOVE 03                     TO  WS-ACTIVITY-CODE
 18053         GO TO 7390-PROCESS-ACTIVITY.
 18054
 18055     IF PI-PROV-PMT
 18056         MOVE 09                     TO  WS-ACTIVITY-CODE
 18057     ELSE
 18058        IF PI-PMTTYPE = '1'
 18059            MOVE 02                  TO  WS-ACTIVITY-CODE
 18060        ELSE
 18061        IF PI-PMTTYPE = '2' OR '3'
 18062            MOVE 07                  TO  WS-ACTIVITY-CODE
 18063        ELSE
 18064        IF PI-PMTTYPE = '4'
 18065            MOVE 00                  TO  WS-ACTIVITY-CODE
 18066        ELSE
 18067            MOVE 'N'                 TO  PI-RESET-SW
 18068            GO TO 7399-EXIT.
 18069
 18070 7390-PROCESS-ACTIVITY.
 18071
 18072     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18073
 18074 7399-EXIT.
 18075     EXIT.
 18076
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 346
* EL156.cbl
 18078 7400-CHECK-AUTO-ACTIVITY.
 18079
 18080
 18081* EXEC CICS HANDLE CONDITION
 18082*        NOTFND   (7400-NOT-FOUND)
 18083*    END-EXEC.
 18084*    MOVE '"$I                   ! < #00016410' TO DFHEIV0
 18085     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18087     MOVE X'3C20233030303136343130' TO DFHEIV0(25:11)
 18088     CALL 'kxdfhei1' USING DFHEIV0
 18089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18090
 18091
 18092     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18093     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18094     MOVE SPACES                 TO  CNTL-ACCESS.
 18095     MOVE +0                     TO  CNTL-SEQ-NO.
 18096
 18097
 18098* EXEC CICS READ
 18099*        DATASET   ('ELCNTL')
 18100*        RIDFLD    (ELCNTL-KEY)
 18101*        SET       (ADDRESS OF CONTROL-FILE)
 18102*    END-EXEC.
 18103     MOVE 'ELCNTL' TO DFHEIV1
 18104*    MOVE '&"S        E          (   #00016419' TO DFHEIV0
 18105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18107     MOVE X'2020233030303136343139' TO DFHEIV0(25:11)
 18108     CALL 'kxdfhei1' USING DFHEIV0,
 18109           DFHEIV1,
 18110           DFHEIV20,
 18111           DFHEIV99,
 18112           ELCNTL-KEY,
 18113           DFHEIV99,
 18114           DFHEIV99,
 18115           DFHEIV99
 18116     SET ADDRESS OF CONTROL-FILE TO
 18117         DFHEIV20
 18118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18119
 18120
 18121     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18122     GO TO 7400-EXIT.
 18123
 18124 7400-NOT-FOUND.
 18125     MOVE 'N'                        TO  PI-RESET-SW
 18126                                         WS-LETTER-SW
 18127                                         WS-ACT-REC-FOUND-SW.
 18128
 18129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18130
 18131 7400-EXIT.
 18132     EXIT.
 18133
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 347
* EL156.cbl
 18135 7450-FORMAT-AUTO-LETTER.
 18136
 18137     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18138         MOVE 'Y'                    TO PI-RESET-SW
 18139         GO TO 7450-CONTINUE-PROCESS.
 18140
 18141     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18142
 18143     IF SUB > 9
 18144         SUBTRACT 9 FROM SUB
 18145         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18146     ELSE
 18147         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18148
 18149 7450-CONTINUE-PROCESS.
 18150
 18151     IF WS-ACTIVITY-CODE = ZEROS
 18152         MOVE 'N'                    TO  WS-LETTER-SW
 18153         GO TO 7499-EXIT.
 18154
 18155     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18156
 18157     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18158         MOVE 'N'                    TO  PI-RESET-SW
 18159                                         WS-LETTER-SW
 18160         GO TO 7499-EXIT.
 18161
 18162     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18163         MOVE 'N'                    TO  WS-LETTER-SW
 18164         GO TO 7499-EXIT.
 18165
 18166     MOVE 'Y'                        TO  WS-LETTER-SW.
 18167     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18168     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18169
 18170     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18171
 18172     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18173         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18174         MOVE '6'                    TO  DC-OPTION-CODE
 18175         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18176         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18177         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18178         IF NO-CONVERSION-ERROR
 18179             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18180         ELSE
 18181              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18182
 18183     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18184         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18185         MOVE '6'                    TO  DC-OPTION-CODE
 18186         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18187         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18188         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18189         IF NO-CONVERSION-ERROR
 18190             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18191         ELSE
 18192             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 348
* EL156.cbl
 18193
 18194 7499-EXIT.
 18195     EXIT.
 18196
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 349
* EL156.cbl
 18198 7500-RESET-AUTO-ACTIVITY.
 18199
 18200     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18201     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18202     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18203     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18204     MOVE +100                   TO  TRLR-SEQ-NO.
 18205
 18206 7500-STARTBR-TRLR.
 18207
 18208
 18209* EXEC CICS HANDLE CONDITION
 18210*        ENDFILE  (7590-END)
 18211*        NOTFND   (7590-END)
 18212*    END-EXEC.
 18213*    MOVE '"$''I                  ! = #00016512' TO DFHEIV0
 18214     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18216     MOVE X'3D20233030303136353132' TO DFHEIV0(25:11)
 18217     CALL 'kxdfhei1' USING DFHEIV0
 18218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18219
 18220
 18221
 18222* EXEC CICS STARTBR
 18223*        DATASET   ('ELTRLR')
 18224*        RIDFLD    (ELTRLR-KEY)
 18225*        GTEQ
 18226*    END-EXEC.
 18227     MOVE 'ELTRLR' TO DFHEIV1
 18228     MOVE 0
 18229       TO DFHEIV11
 18230*    MOVE '&,         G          &   #00016517' TO DFHEIV0
 18231     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18232     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18233     MOVE X'2020233030303136353137' TO DFHEIV0(25:11)
 18234     CALL 'kxdfhei1' USING DFHEIV0,
 18235           DFHEIV1,
 18236           ELTRLR-KEY,
 18237           DFHEIV99,
 18238           DFHEIV11,
 18239           DFHEIV99
 18240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18241
 18242
 18243     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18244
 18245 7500-READ-NEXT.
 18246
 18247
 18248* EXEC CICS READNEXT
 18249*        DATASET   ('ELTRLR')
 18250*        RIDFLD    (ELTRLR-KEY)
 18251*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18252*    END-EXEC.
 18253     MOVE 'ELTRLR' TO DFHEIV1
 18254     MOVE 0
 18255       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 350
* EL156.cbl
 18256*    MOVE '&.S                   )   #00016527' TO DFHEIV0
 18257     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18258     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18259     MOVE X'2020233030303136353237' TO DFHEIV0(25:11)
 18260     CALL 'kxdfhei1' USING DFHEIV0,
 18261           DFHEIV1,
 18262           DFHEIV20,
 18263           DFHEIV99,
 18264           ELTRLR-KEY,
 18265           DFHEIV99,
 18266           DFHEIV11,
 18267           DFHEIV99,
 18268           DFHEIV99
 18269     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18270         DFHEIV20
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18275        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18276        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18277        PI-CERT-NO    NOT = TRLR-CERT-NO
 18278         GO TO 7590-END.
 18279
 18280     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18281         GO TO 7500-READ-NEXT.
 18282
 18283     IF AT-TRAILER-TYPE NOT = '4'
 18284         GO TO 7500-READ-NEXT.
 18285
 18286     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18287         GO TO 7500-READ-NEXT.
 18288
 18289     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18290        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18291         GO TO 7500-READ-NEXT.
 18292
 18293     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18294        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18295        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18296         GO TO 7500-READ-NEXT.
 18297
 18298     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18299                         AND
 18300        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18301                         AND
 18302        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18303            GO TO 7500-READ-NEXT.
 18304
 18305     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18306
 18307
 18308* EXEC CICS ENDBR
 18309*        DATASET   ('ELTRLR')
 18310*    END-EXEC.
 18311     MOVE 'ELTRLR' TO DFHEIV1
 18312     MOVE 0
 18313       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 351
* EL156.cbl
 18314*    MOVE '&2                    $   #00016566' TO DFHEIV0
 18315     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18317     MOVE X'2020233030303136353636' TO DFHEIV0(25:11)
 18318     CALL 'kxdfhei1' USING DFHEIV0,
 18319           DFHEIV1,
 18320           DFHEIV11,
 18321           DFHEIV99
 18322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18323
 18324
 18325     MOVE 'N'                        TO  WS-BROWSE-SW.
 18326
 18327
 18328* EXEC CICS READ
 18329*        DATASET   ('ELTRLR')
 18330*        RIDFLD    (ELTRLR-KEY)
 18331*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18332*        UPDATE
 18333*    END-EXEC.
 18334     MOVE 'ELTRLR' TO DFHEIV1
 18335*    MOVE '&"S        EU         (   #00016572' TO DFHEIV0
 18336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18337     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18338     MOVE X'2020233030303136353732' TO DFHEIV0(25:11)
 18339     CALL 'kxdfhei1' USING DFHEIV0,
 18340           DFHEIV1,
 18341           DFHEIV20,
 18342           DFHEIV99,
 18343           ELTRLR-KEY,
 18344           DFHEIV99,
 18345           DFHEIV99,
 18346           DFHEIV99
 18347     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18348         DFHEIV20
 18349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18350
 18351
 18352     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18353
 18354     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18355         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18356     ELSE
 18357         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18358             NEXT SENTENCE
 18359         ELSE
 18360             GO TO 7500-REWRITE-TRLR.
 18361
 18362     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18363
 18364     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18365     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18366     MOVE '1'                        TO  ARCH-REC-TYPE.
 18367     MOVE +0                         TO  ARCH-SEQ.
 18368
 18369     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18370
 18371 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 352
* EL156.cbl
 18372
 18373
 18374* EXEC CICS REWRITE
 18375*        DATASET   ('ELTRLR')
 18376*        FROM      (ACTIVITY-TRAILERS)
 18377*    END-EXEC.
 18378     MOVE LENGTH OF
 18379      ACTIVITY-TRAILERS
 18380       TO DFHEIV11
 18381     MOVE 'ELTRLR' TO DFHEIV1
 18382*    MOVE '&& L                  %   #00016600' TO DFHEIV0
 18383     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18384     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18385     MOVE X'2020233030303136363030' TO DFHEIV0(25:11)
 18386     CALL 'kxdfhei1' USING DFHEIV0,
 18387           DFHEIV1,
 18388           ACTIVITY-TRAILERS,
 18389           DFHEIV11,
 18390           DFHEIV99
 18391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18392
 18393
 18394     GO TO 7500-STARTBR-TRLR.
 18395
 18396 7590-END.
 18397
 18398     IF WS-BROWSE-SW = 'Y'
 18399         MOVE 'N'                    TO  WS-BROWSE-SW
 18400
 18401* EXEC CICS ENDBR
 18402*            DATASET   ('ELTRLR')
 18403*        END-EXEC.
 18404     MOVE 'ELTRLR' TO DFHEIV1
 18405     MOVE 0
 18406       TO DFHEIV11
 18407*    MOVE '&2                    $   #00016611' TO DFHEIV0
 18408     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18410     MOVE X'2020233030303136363131' TO DFHEIV0(25:11)
 18411     CALL 'kxdfhei1' USING DFHEIV0,
 18412           DFHEIV1,
 18413           DFHEIV11,
 18414           DFHEIV99
 18415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18416
 18417
 18418 7599-EXIT.
 18419     EXIT.
 18420
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 353
* EL156.cbl
 18422 7600-READ-ARCH-UPDATE.
 18423
 18424
 18425* EXEC CICS HANDLE CONDITION
 18426*        NOTFND   (7699-EXIT)
 18427*    END-EXEC.
 18428*    MOVE '"$I                   ! > #00016621' TO DFHEIV0
 18429     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18431     MOVE X'3E20233030303136363231' TO DFHEIV0(25:11)
 18432     CALL 'kxdfhei1' USING DFHEIV0
 18433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18434
 18435
 18436
 18437* EXEC CICS READ
 18438*        DATASET   ('ELARCH')
 18439*        RIDFLD    (ELARCH-KEY)
 18440*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18441*        UPDATE
 18442*    END-EXEC.
 18443     MOVE 'ELARCH' TO DFHEIV1
 18444*    MOVE '&"S        EU         (   #00016625' TO DFHEIV0
 18445     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18446     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18447     MOVE X'2020233030303136363235' TO DFHEIV0(25:11)
 18448     CALL 'kxdfhei1' USING DFHEIV0,
 18449           DFHEIV1,
 18450           DFHEIV20,
 18451           DFHEIV99,
 18452           ELARCH-KEY,
 18453           DFHEIV99,
 18454           DFHEIV99,
 18455           DFHEIV99
 18456     SET ADDRESS OF LETTER-ARCHIVE TO
 18457         DFHEIV20
 18458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18459
 18460
 18461     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18462
 18463
 18464* EXEC CICS REWRITE
 18465*        DATASET   ('ELARCH')
 18466*        FROM      (LETTER-ARCHIVE)
 18467*    END-EXEC.
 18468     MOVE LENGTH OF
 18469      LETTER-ARCHIVE
 18470       TO DFHEIV11
 18471     MOVE 'ELARCH' TO DFHEIV1
 18472*    MOVE '&& L                  %   #00016634' TO DFHEIV0
 18473     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18475     MOVE X'2020233030303136363334' TO DFHEIV0(25:11)
 18476     CALL 'kxdfhei1' USING DFHEIV0,
 18477           DFHEIV1,
 18478           LETTER-ARCHIVE,
 18479           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 354
* EL156.cbl
 18480           DFHEIV99
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18482
 18483
 18484 7699-EXIT.
 18485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 355
* EL156.cbl
 18487 7700-GET-DCT.
 18488
 18489     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18490     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18491     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18492     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18493                                    PI-MAX-BENEFIT-AMT
 18494                                    PI-MAX-BENEFIT-PYMT
 18495                                    PI-MIN-PAYMENT-AMT
 18496                                    PI-TIME-OF-LOSS-BAL.
 18497
 18498
 18499* EXEC CICS HANDLE CONDITION
 18500*         NOTFND (5300-NOTE-NOT-FOUND)
 18501*     END-EXEC.
 18502*    MOVE '"$I                   ! ? #00016653' TO DFHEIV0
 18503     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18505     MOVE X'3F20233030303136363533' TO DFHEIV0(25:11)
 18506     CALL 'kxdfhei1' USING DFHEIV0
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18508
 18509
 18510
 18511* EXEC CICS READ
 18512*         DATASET('ERNOTE')
 18513*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18514*         RIDFLD (W-NOTE-KEY)
 18515*     END-EXEC.
 18516     MOVE 'ERNOTE' TO DFHEIV1
 18517*    MOVE '&"S        E          (   #00016657' TO DFHEIV0
 18518     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18520     MOVE X'2020233030303136363537' TO DFHEIV0(25:11)
 18521     CALL 'kxdfhei1' USING DFHEIV0,
 18522           DFHEIV1,
 18523           DFHEIV20,
 18524           DFHEIV99,
 18525           W-NOTE-KEY,
 18526           DFHEIV99,
 18527           DFHEIV99,
 18528           DFHEIV99
 18529     SET ADDRESS OF CERTIFICATE-NOTE TO
 18530         DFHEIV20
 18531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18532
 18533
 18534     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18535     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18536     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18537     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18538     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18539
 18540     IF PI-PAYEE-TYPE NOT = 'B'
 18541         GO TO 7700-EXIT.
 18542
 18543     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18544     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 356
* EL156.cbl
 18545     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18546
 18547     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18548         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18549     ELSE
 18550         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18551
 18552     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18553     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18554     MOVE 'DLO006'               TO PGM-NAME.
 18555
 18556
 18557* EXEC CICS LINK
 18558*        PROGRAM    (PGM-NAME)
 18559*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18560*        LENGTH     (DCT-RCRD-LENGTH)
 18561*    END-EXEC.
 18562*    MOVE '."C                   (   #00016685' TO DFHEIV0
 18563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18565     MOVE X'2020233030303136363835' TO DFHEIV0(25:11)
 18566     CALL 'kxdfhei1' USING DFHEIV0,
 18567           PGM-NAME,
 18568           DCT-COMMUNICATION-AREA,
 18569           DCT-RCRD-LENGTH,
 18570           DFHEIV99,
 18571           DFHEIV99,
 18572           DFHEIV99,
 18573           DFHEIV99
 18574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18575
 18576
 18577     IF DCT-RETURN-CODE = 'OK'
 18578         GO TO 7700-CONT.
 18579
 18580     IF DCT-RETURN-CODE = '01' OR '02'
 18581         GO TO 7700-SET-TO-YES.
 18582
 18583     IF DCT-RETURN-CODE = '03'
 18584
 18585* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18586*    MOVE '6"R                   !   #00016698' TO DFHEIV0
 18587     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18589     MOVE X'2020233030303136363938' TO DFHEIV0(25:11)
 18590     CALL 'kxdfhei1' USING DFHEIV0
 18591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18592         MOVE ER-0951            TO EMI-ERROR
 18593         MOVE -1                 TO PMTTYPEL
 18594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18595         GO TO 8200-SEND-DATAONLY.
 18596
 18597     IF DCT-RETURN-CODE = '04'
 18598
 18599* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18600*    MOVE '6"R                   !   #00016705' TO DFHEIV0
 18601     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 357
* EL156.cbl
 18603     MOVE X'2020233030303136373035' TO DFHEIV0(25:11)
 18604     CALL 'kxdfhei1' USING DFHEIV0
 18605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18606         MOVE ER-0946            TO EMI-ERROR
 18607         MOVE -1                 TO PMTTYPEL
 18608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18609         GO TO 8200-SEND-DATAONLY.
 18610
 18611     IF DCT-RETURN-CODE = '05'
 18612
 18613* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18614*    MOVE '6"R                   !   #00016712' TO DFHEIV0
 18615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18617     MOVE X'2020233030303136373132' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0
 18619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18620         MOVE ER-0947            TO EMI-ERROR
 18621         MOVE -1                 TO PMTTYPEL
 18622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18623         GO TO 8200-SEND-DATAONLY.
 18624
 18625     IF DCT-RETURN-CODE = '06'
 18626
 18627* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18628*    MOVE '6"R                   !   #00016719' TO DFHEIV0
 18629     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18631     MOVE X'2020233030303136373139' TO DFHEIV0(25:11)
 18632     CALL 'kxdfhei1' USING DFHEIV0
 18633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18634         MOVE ER-0921            TO EMI-ERROR
 18635         MOVE -1                 TO PMTTYPEL
 18636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18637         GO TO 8200-SEND-DATAONLY.
 18638
 18639     IF DCT-RETURN-CODE = '07'
 18640
 18641* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18642*    MOVE '6"R                   !   #00016726' TO DFHEIV0
 18643     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18645     MOVE X'2020233030303136373236' TO DFHEIV0(25:11)
 18646     CALL 'kxdfhei1' USING DFHEIV0
 18647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18648         MOVE ER-0919            TO EMI-ERROR
 18649         MOVE -1                 TO PMTTYPEL
 18650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18651         GO TO 8200-SEND-DATAONLY.
 18652
 18653     IF DCT-RETURN-CODE = '08'
 18654
 18655* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18656*    MOVE '6"R                   !   #00016733' TO DFHEIV0
 18657     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18659     MOVE X'2020233030303136373333' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 358
* EL156.cbl
 18661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18662         MOVE ER-0948            TO EMI-ERROR
 18663         MOVE -1                 TO PMTTYPEL
 18664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18665         GO TO 8200-SEND-DATAONLY.
 18666
 18667     IF DCT-RETURN-CODE = 'N1'
 18668
 18669* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18670*    MOVE '6"R                   !   #00016740' TO DFHEIV0
 18671     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18673     MOVE X'2020233030303136373430' TO DFHEIV0(25:11)
 18674     CALL 'kxdfhei1' USING DFHEIV0
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18676         MOVE ER-0950            TO EMI-ERROR
 18677         MOVE -1                 TO PMTTYPEL
 18678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18679         GO TO 8200-SEND-DATAONLY.
 18680
 18681     IF DCT-RETURN-CODE = 'E1'
 18682
 18683* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18684*    MOVE '6"R                   !   #00016747' TO DFHEIV0
 18685     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18687     MOVE X'2020233030303136373437' TO DFHEIV0(25:11)
 18688     CALL 'kxdfhei1' USING DFHEIV0
 18689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18690         MOVE ER-0974            TO EMI-ERROR
 18691         MOVE -1                 TO PMTTYPEL
 18692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18693         GO TO 8200-SEND-DATAONLY.
 18694
 18695     IF DCT-RETURN-CODE = 'E2'
 18696
 18697* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18698*    MOVE '6"R                   !   #00016754' TO DFHEIV0
 18699     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18701     MOVE X'2020233030303136373534' TO DFHEIV0(25:11)
 18702     CALL 'kxdfhei1' USING DFHEIV0
 18703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18704         MOVE ER-0975            TO EMI-ERROR
 18705         MOVE -1                 TO PMTTYPEL
 18706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18707         GO TO 8200-SEND-DATAONLY.
 18708
 18709     IF DCT-RETURN-CODE NOT = 'OK'
 18710
 18711* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18712*    MOVE '6"R                   !   #00016761' TO DFHEIV0
 18713     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18715     MOVE X'2020233030303136373631' TO DFHEIV0(25:11)
 18716     CALL 'kxdfhei1' USING DFHEIV0
 18717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18718         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 359
* EL156.cbl
 18719         MOVE -1                 TO PMTTYPEL
 18720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18721         GO TO 8200-SEND-DATAONLY.
 18722
 18723 7700-CONT.
 18724
 18725*    MOVE 'N'                    TO CASHO.
 18726*    MOVE +1                     TO CASHL.
 18727*    MOVE AL-UANON               TO CASHA.
 18728
 18729     IF PI-OFFLINE = 'Y'
 18730         GO TO 7700-EXIT.
 18731
 18732     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18733     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18734     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18735     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18736     MOVE +7                     TO CHECKNOL.
 18737     MOVE AL-UANON               TO CHECKNOA.
 18738     GO TO 7700-EXIT.
 18739
 18740 7700-SET-TO-YES.
 18741
 18742*    MOVE 'Y'                    TO CASHO.
 18743*    MOVE +1                     TO CASHL.
 18744*    MOVE AL-UANON               TO CASHA.
 18745
 18746 7700-EXIT.
 18747     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 360
* EL156.cbl
 18749 7800-READ-COMP-MSTR.
 18750
 18751
 18752* EXEC CICS HANDLE CONDITION
 18753*        NOTFND   (7800-COMP-NOTFND)
 18754*    END-EXEC.
 18755*    MOVE '"$I                   ! @ #00016795' TO DFHEIV0
 18756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18758     MOVE X'4020233030303136373935' TO DFHEIV0(25:11)
 18759     CALL 'kxdfhei1' USING DFHEIV0
 18760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18761
 18762
 18763
 18764* EXEC CICS READ
 18765*        DATASET   ('ERCOMP')
 18766*        RIDFLD    (ERCOMP-KEY)
 18767*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18768*    END-EXEC.
 18769     MOVE 'ERCOMP' TO DFHEIV1
 18770*    MOVE '&"S        E          (   #00016799' TO DFHEIV0
 18771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18773     MOVE X'2020233030303136373939' TO DFHEIV0(25:11)
 18774     CALL 'kxdfhei1' USING DFHEIV0,
 18775           DFHEIV1,
 18776           DFHEIV20,
 18777           DFHEIV99,
 18778           ERCOMP-KEY,
 18779           DFHEIV99,
 18780           DFHEIV99,
 18781           DFHEIV99
 18782     SET ADDRESS OF COMPENSATION-MASTER TO
 18783         DFHEIV20
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18788     GO TO 7800-COMP-EXIT.
 18789
 18790 7800-COMP-NOTFND.
 18791     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18792
 18793 7800-COMP-EXIT.
 18794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 361
* EL156.cbl
 18796 7900-READ-CLAIM.
 18797
 18798* EXEC CICS READ
 18799*        DATASET  ('ELMSTR')
 18800*        SET      (ADDRESS OF CLAIM-MASTER)
 18801*        RIDFLD   (ELMSTR-KEY)
 18802*    END-EXEC.
 18803     MOVE 'ELMSTR' TO DFHEIV1
 18804*    MOVE '&"S        E          (   #00016815' TO DFHEIV0
 18805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18807     MOVE X'2020233030303136383135' TO DFHEIV0(25:11)
 18808     CALL 'kxdfhei1' USING DFHEIV0,
 18809           DFHEIV1,
 18810           DFHEIV20,
 18811           DFHEIV99,
 18812           ELMSTR-KEY,
 18813           DFHEIV99,
 18814           DFHEIV99,
 18815           DFHEIV99
 18816     SET ADDRESS OF CLAIM-MASTER TO
 18817         DFHEIV20
 18818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18819
 18820
 18821 7900-EXIT.
 18822      EXIT.
 18823
 18824 7910-READ-CLAIM-UPDATE.
 18825
 18826* EXEC CICS READ
 18827*        DATASET  ('ELMSTR')
 18828*        SET      (ADDRESS OF CLAIM-MASTER)
 18829*        RIDFLD   (ELMSTR-KEY)
 18830*        UPDATE
 18831*    END-EXEC.
 18832     MOVE 'ELMSTR' TO DFHEIV1
 18833*    MOVE '&"S        EU         (   #00016825' TO DFHEIV0
 18834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18835     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18836     MOVE X'2020233030303136383235' TO DFHEIV0(25:11)
 18837     CALL 'kxdfhei1' USING DFHEIV0,
 18838           DFHEIV1,
 18839           DFHEIV20,
 18840           DFHEIV99,
 18841           ELMSTR-KEY,
 18842           DFHEIV99,
 18843           DFHEIV99,
 18844           DFHEIV99
 18845     SET ADDRESS OF CLAIM-MASTER TO
 18846         DFHEIV20
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850 7910-EXIT.
 18851      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 362
* EL156.cbl
 18853 7920-READ-BENE.
 18854     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18855     MOVE 'B'                TO BENE-RECORD-TYPE.
 18856     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18857
 18858     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18859        IF PI-PAYEE-TYPE    = 'B' AND
 18860           PI-PAYEE-SEQ-NUM = 9
 18861             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18862             MOVE WS-A-BENE           TO BENE-NUMBER.
 18863
 18864
 18865* EXEC CICS HANDLE CONDITION
 18866*        NOTFND   (7920-NOT-FOUND)
 18867*    END-EXEC.
 18868*    MOVE '"$I                   ! A #00016846' TO DFHEIV0
 18869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18871     MOVE X'4120233030303136383436' TO DFHEIV0(25:11)
 18872     CALL 'kxdfhei1' USING DFHEIV0
 18873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18874
 18875
 18876
 18877* EXEC CICS READ
 18878*        DATASET  ('ELBENE')
 18879*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18880*        RIDFLD   (ELBENE-KEY)
 18881*    END-EXEC.
 18882     MOVE 'ELBENE' TO DFHEIV1
 18883*    MOVE '&"S        E          (   #00016850' TO DFHEIV0
 18884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18886     MOVE X'2020233030303136383530' TO DFHEIV0(25:11)
 18887     CALL 'kxdfhei1' USING DFHEIV0,
 18888           DFHEIV1,
 18889           DFHEIV20,
 18890           DFHEIV99,
 18891           ELBENE-KEY,
 18892           DFHEIV99,
 18893           DFHEIV99,
 18894           DFHEIV99
 18895     SET ADDRESS OF BENEFICIARY-MASTER TO
 18896         DFHEIV20
 18897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18898
 18899
 18900     MOVE 'Y' TO BENE-FOUND-SW.
 18901     GO TO 7920-EXIT.
 18902
 18903 7920-NOT-FOUND.
 18904     MOVE 'N'                    TO BENE-FOUND-SW.
 18905
 18906 7920-EXIT.
 18907      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 363
* EL156.cbl
 18909 7930-READ-CONTROL.
 18910
 18911* EXEC CICS READ
 18912*        DATASET  ('ELCNTL')
 18913*        SET      (ADDRESS OF CONTROL-FILE)
 18914*        RIDFLD   (ELCNTL-KEY)
 18915*    END-EXEC.
 18916     MOVE 'ELCNTL' TO DFHEIV1
 18917*    MOVE '&"S        E          (   #00016866' TO DFHEIV0
 18918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18920     MOVE X'2020233030303136383636' TO DFHEIV0(25:11)
 18921     CALL 'kxdfhei1' USING DFHEIV0,
 18922           DFHEIV1,
 18923           DFHEIV20,
 18924           DFHEIV99,
 18925           ELCNTL-KEY,
 18926           DFHEIV99,
 18927           DFHEIV99,
 18928           DFHEIV99
 18929     SET ADDRESS OF CONTROL-FILE TO
 18930         DFHEIV20
 18931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18932
 18933
 18934 7930-EXIT.
 18935      EXIT.
 18936
 18937 7940-READ-CONTROL-UPDATE.
 18938
 18939* EXEC CICS READ
 18940*        DATASET  ('ELCNTL')
 18941*        SET      (ADDRESS OF CONTROL-FILE)
 18942*        RIDFLD   (ELCNTL-KEY)
 18943*        UPDATE
 18944*    END-EXEC.
 18945     MOVE 'ELCNTL' TO DFHEIV1
 18946*    MOVE '&"S        EU         (   #00016876' TO DFHEIV0
 18947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18949     MOVE X'2020233030303136383736' TO DFHEIV0(25:11)
 18950     CALL 'kxdfhei1' USING DFHEIV0,
 18951           DFHEIV1,
 18952           DFHEIV20,
 18953           DFHEIV99,
 18954           ELCNTL-KEY,
 18955           DFHEIV99,
 18956           DFHEIV99,
 18957           DFHEIV99
 18958     SET ADDRESS OF CONTROL-FILE TO
 18959         DFHEIV20
 18960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18961
 18962
 18963 7940-EXIT.
 18964      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 364
* EL156.cbl
 18966 7950-READ-TRAILER.
 18967
 18968* EXEC CICS READ
 18969*        DATASET  ('ELTRLR')
 18970*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18971*        RIDFLD   (ELTRLR-KEY)
 18972*    END-EXEC.
 18973     MOVE 'ELTRLR' TO DFHEIV1
 18974*    MOVE '&"S        E          (   #00016887' TO DFHEIV0
 18975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18977     MOVE X'2020233030303136383837' TO DFHEIV0(25:11)
 18978     CALL 'kxdfhei1' USING DFHEIV0,
 18979           DFHEIV1,
 18980           DFHEIV20,
 18981           DFHEIV99,
 18982           ELTRLR-KEY,
 18983           DFHEIV99,
 18984           DFHEIV99,
 18985           DFHEIV99
 18986     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18987         DFHEIV20
 18988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18989
 18990
 18991 7950-EXIT.
 18992      EXIT.
 18993
 18994 7960-READ-TRAILER-UPDATE.
 18995
 18996* EXEC CICS READ
 18997*        DATASET  ('ELTRLR')
 18998*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18999*        RIDFLD   (ELTRLR-KEY)
 19000*        UPDATE
 19001*    END-EXEC.
 19002     MOVE 'ELTRLR' TO DFHEIV1
 19003*    MOVE '&"S        EU         (   #00016897' TO DFHEIV0
 19004     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19005     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19006     MOVE X'2020233030303136383937' TO DFHEIV0(25:11)
 19007     CALL 'kxdfhei1' USING DFHEIV0,
 19008           DFHEIV1,
 19009           DFHEIV20,
 19010           DFHEIV99,
 19011           ELTRLR-KEY,
 19012           DFHEIV99,
 19013           DFHEIV99,
 19014           DFHEIV99
 19015     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19016         DFHEIV20
 19017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19018
 19019
 19020 7960-EXIT.
 19021      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 365
* EL156.cbl
 19023 7970-READ-CERT.
 19024
 19025* EXEC CICS READ
 19026*        DATASET  ('ELCERT')
 19027*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19028*        RIDFLD   (ELCERT-KEY)
 19029*    END-EXEC.
 19030     MOVE 'ELCERT' TO DFHEIV1
 19031*    MOVE '&"S        E          (   #00016908' TO DFHEIV0
 19032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19034     MOVE X'2020233030303136393038' TO DFHEIV0(25:11)
 19035     CALL 'kxdfhei1' USING DFHEIV0,
 19036           DFHEIV1,
 19037           DFHEIV20,
 19038           DFHEIV99,
 19039           ELCERT-KEY,
 19040           DFHEIV99,
 19041           DFHEIV99,
 19042           DFHEIV99
 19043     SET ADDRESS OF CERTIFICATE-MASTER TO
 19044         DFHEIV20
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048 7970-EXIT.
 19049      EXIT.
 19050 7975-read-acct.
 19051
 19052     move spaces              to WS-ACCT-RECORD-SW
 19053                                 pi-dcc-product-code
 19054
 19055     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19056     MOVE PI-CARRIER          TO ACCT-CARRIER
 19057     MOVE PI-GROUPING         TO ACCT-GROUPING
 19058     MOVE PI-STATE            TO ACCT-STATE
 19059     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19060     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19061     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19062     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19063
 19064
 19065* EXEC CICS READ
 19066*       DATASET ('ERACCT')
 19067*       RIDFLD  (ERACCT-KEY)
 19068*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19069*       GTEQ
 19070*       resp    (WS-RESPONSE)
 19071*    END-EXEC
 19072     MOVE 'ERACCT' TO DFHEIV1
 19073*    MOVE '&"S        G          (  N#00016930' TO DFHEIV0
 19074     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19076     MOVE X'204E233030303136393330' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           DFHEIV1,
 19079           DFHEIV20,
 19080           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 366
* EL156.cbl
 19081           ERACCT-KEY,
 19082           DFHEIV99,
 19083           DFHEIV99,
 19084           DFHEIV99
 19085     SET ADDRESS OF ACCOUNT-MASTER TO
 19086         DFHEIV20
 19087     MOVE EIBRESP  TO WS-RESPONSE
 19088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19089     IF WS-RESP-NORMAL
 19090        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19091        and pi-cert-eff-dt < am-expiration-dt
 19092        and pi-cert-eff-dt >= am-effective-dt
 19093        move am-dcc-product-code to pi-dcc-product-code
 19094        set acct-found to true
 19095     end-if
 19096
 19097     .
 19098 7975-exit.
 19099     exit.
 19100 7980-READ-CERT-UPDATE.
 19101
 19102* EXEC CICS READ
 19103*        DATASET  ('ELCERT')
 19104*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19105*        RIDFLD   (ELCERT-KEY)
 19106*        UPDATE
 19107*    END-EXEC.
 19108     MOVE 'ELCERT' TO DFHEIV1
 19109*    MOVE '&"S        EU         (   #00016949' TO DFHEIV0
 19110     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19111     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19112     MOVE X'2020233030303136393439' TO DFHEIV0(25:11)
 19113     CALL 'kxdfhei1' USING DFHEIV0,
 19114           DFHEIV1,
 19115           DFHEIV20,
 19116           DFHEIV99,
 19117           ELCERT-KEY,
 19118           DFHEIV99,
 19119           DFHEIV99,
 19120           DFHEIV99
 19121     SET ADDRESS OF CERTIFICATE-MASTER TO
 19122         DFHEIV20
 19123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19124
 19125
 19126 7980-EXIT.
 19127      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 367
* EL156.cbl
 19129 8000-LOAD-ERROR-MESSAGES.
 19130     IF PI-PASS-SW = 'C'
 19131        MOVE EMI-LINE1           TO ERMSG1BO
 19132     ELSE
 19133        MOVE EMI-LINE1           TO ERRMSG1O
 19134        MOVE EMI-LINE2           TO ERRMSG2O.
 19135
 19136 8000-EXIT.
 19137     EXIT.
 19138
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 368
* EL156.cbl
 19140
 19141 8010-DMD-ERROR-CHECKS.
 19142     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19143
 19144     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19145         GO TO 8051-ISSUE-ERROR.
 19146
 19147     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19148     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19149     MOVE '3'                    TO DC-OPTION-CODE.
 19150     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19151     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19152         GO TO 8051-ISSUE-ERROR.
 19153
 19154     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19155       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19156                           OR
 19157          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19158           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19159             MOVE ER-0851         TO EMI-ERROR
 19160             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19161       END-IF
 19162       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19163             MOVE ER-8147         TO EMI-ERROR
 19164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19165
 19166     GO TO 8090-EXIT.
 19167
 19168 8051-ISSUE-ERROR.
 19169     MOVE ER-8146            TO EMI-ERROR.
 19170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19171     GO TO 8090-EXIT.
 19172
 19173 8090-EXIT.
 19174      EXIT.
 19175
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 369
* EL156.cbl
 19177 8100-SEND-INITIAL-MAP.
 19178
 19179     MOVE SAVE-DATE              TO RUNDTEAO.
 19180     MOVE EIBTIME                TO TIME-IN.
 19181     MOVE TIME-OUT               TO RUNTIMAO.
 19182     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19183
 19184     IF MAP-NAME = 'EL156A'
 19185        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19186           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19187        END-IF
 19188     END-IF
 19189*    IF MAP-NAME = 'EL156A'
 19190*       IF PI-COMPANY-ID = 'CRI'
 19191*          NEXT SENTENCE
 19192*       ELSE
 19193*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19194
 19195     IF MAP-NAME = 'EL156A'
 19196        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19197           NEXT SENTENCE
 19198        ELSE
 19199           MOVE AL-SADOF TO  PINTA    PINTHA.
 19200
 19201     IF MAP-NAME = 'EL156A'
 19202        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19203            NEXT SENTENCE
 19204        ELSE
 19205           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19206
 19207*    IF MAP-NAME = 'EL156A'
 19208*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19209*          NEXT SENTENCE
 19210*       ELSE
 19211*          MOVE AL-SADOF TO CASHHA CASHA.
 19212
 19213     IF MAP-NAME = 'EL156A'
 19214        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19215           NEXT SENTENCE
 19216        ELSE
 19217           MOVE AL-SADOF        TO  LOANHA
 19218                                    LOANNOA.
 19219
 19220     IF MAP-NAME = 'EL156A'
 19221        MOVE -1                 TO  ENTERPFL
 19222        IF PI-USES-PAID-TO
 19223           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19224           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19225           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19226        ELSE
 19227           NEXT SENTENCE
 19228     ELSE
 19229        IF MAP-NAME = 'EL156B'
 19230           IF PI-USES-PAID-TO
 19231              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19232              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19233
 19234
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 370
* EL156.cbl
 19235* EXEC CICS SEND
 19236*        MAP   (MAP-NAME)
 19237*        MAPSET(MAPSET-NAME)
 19238*        FROM  (EL156AI)
 19239*        ERASE
 19240*        CURSOR
 19241*    END-EXEC.
 19242     MOVE LENGTH OF
 19243      EL156AI
 19244       TO DFHEIV12
 19245     MOVE -1
 19246       TO DFHEIV11
 19247*    MOVE '8$     CT  E    H L F ,   #00017064' TO DFHEIV0
 19248     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19249     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19250     MOVE X'2020233030303137303634' TO DFHEIV0(25:11)
 19251     CALL 'kxdfhei1' USING DFHEIV0,
 19252           MAP-NAME,
 19253           EL156AI,
 19254           DFHEIV12,
 19255           MAPSET-NAME,
 19256           DFHEIV99,
 19257           DFHEIV99,
 19258           DFHEIV99,
 19259           DFHEIV11,
 19260           DFHEIV99,
 19261           DFHEIV99,
 19262           DFHEIV99
 19263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19264
 19265
 19266     GO TO 9100-RETURN-TRAN.
 19267
 19268 8200-SEND-DATAONLY.
 19269
 19270     IF FIRST-ENTRY = 'Y'
 19271         GO TO 8100-SEND-INITIAL-MAP.
 19272
 19273     IF RETURNED-FROM-B = 'Y'
 19274         GO TO 8100-SEND-INITIAL-MAP.
 19275
 19276     MOVE SAVE-DATE              TO RUNDTEAO.
 19277     MOVE EIBTIME                TO TIME-IN.
 19278     MOVE TIME-OUT               TO RUNTIMAO.
 19279
 19280     IF EIBAID = DFHPF11
 19281        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19283        MOVE 'EL001   '          TO RETURNED-FROM
 19284        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19285        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19286        GO TO 8100-SEND-INITIAL-MAP.
 19287
 19288     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19289
 19290     IF MAP-NAME =  'EL156A'
 19291        MOVE -1                 TO  ENTERPFL
 19292        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 371
* EL156.cbl
 19293           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19294           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19295           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19296        ELSE
 19297           NEXT SENTENCE
 19298     ELSE
 19299        IF MAP-NAME = 'EL156B'
 19300           IF PI-USES-PAID-TO
 19301              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19302              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19303
 19304     IF MAP-NAME =  'EL156A'
 19305        IF PI-COMPANY-ID = 'BOA'
 19306            IF PI-INT-RATE NUMERIC
 19307                MOVE PI-INT-RATE TO PINTO.
 19308     IF MAP-NAME = 'EL156A'
 19309        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19310           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19311*          MOVE 'Y'              TO EOBYNO
 19312        END-IF
 19313     END-IF
 19314
 19315
 19316* EXEC CICS SEND
 19317*        MAP   (MAP-NAME)
 19318*        MAPSET(MAPSET-NAME)
 19319*        FROM  (EL156AI)
 19320*        DATAONLY
 19321*        CURSOR
 19322*    END-EXEC.
 19323     MOVE LENGTH OF
 19324      EL156AI
 19325       TO DFHEIV12
 19326     MOVE -1
 19327       TO DFHEIV11
 19328*    MOVE '8$D    CT       H L F ,   #00017121' TO DFHEIV0
 19329     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19330     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19331     MOVE X'2020233030303137313231' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0,
 19333           MAP-NAME,
 19334           EL156AI,
 19335           DFHEIV12,
 19336           MAPSET-NAME,
 19337           DFHEIV99,
 19338           DFHEIV99,
 19339           DFHEIV99,
 19340           DFHEIV11,
 19341           DFHEIV99,
 19342           DFHEIV99,
 19343           DFHEIV99
 19344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19345
 19346
 19347     GO TO 9100-RETURN-TRAN.
 19348
 19349 8300-SEND-TEXT.
 19350
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 372
* EL156.cbl
 19351* EXEC CICS SEND TEXT
 19352*        FROM(LOGOFF-TEXT)
 19353*        LENGTH(LOGOFF-LENGTH)
 19354*        ERASE
 19355*        FREEKB
 19356*    END-EXEC.
 19357*    MOVE '8&      T  E F  H   F -   #00017132' TO DFHEIV0
 19358     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19359     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19360     MOVE X'2020233030303137313332' TO DFHEIV0(25:11)
 19361     CALL 'kxdfhei1' USING DFHEIV0,
 19362           LOGOFF-TEXT,
 19363           LOGOFF-LENGTH,
 19364           DFHEIV99,
 19365           DFHEIV99,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99,
 19369           DFHEIV99,
 19370           DFHEIV99,
 19371           DFHEIV99,
 19372           DFHEIV99,
 19373           DFHEIV99
 19374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19375
 19376
 19377
 19378* EXEC CICS RETURN
 19379*    END-EXEC.
 19380*    MOVE '.(                    ''   #00017139' TO DFHEIV0
 19381     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19382     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19383     MOVE X'2020233030303137313339' TO DFHEIV0(25:11)
 19384     CALL 'kxdfhei1' USING DFHEIV0,
 19385           DFHEIV99,
 19386           DFHEIV99,
 19387           DFHEIV99,
 19388           DFHEIV99,
 19389           DFHEIV99,
 19390           DFHEIV99
 19391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19392
 19393
 19394 8500-FILE-NOTOPEN.
 19395     IF FILE-SWITCH = 'MSTR'
 19396         MOVE ER-0154            TO EMI-ERROR.
 19397     IF FILE-SWITCH = 'TRLR'
 19398         MOVE ER-0172            TO EMI-ERROR.
 19399     IF FILE-SWITCH = 'CERT'
 19400         MOVE ER-0169            TO EMI-ERROR.
 19401     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19402                      'PROC' OR 'STAT'
 19403         MOVE ER-0042            TO EMI-ERROR.
 19404     IF FILE-SWITCH = 'ACTQ'
 19405         MOVE ER-0338            TO EMI-ERROR.
 19406     IF FILE-SWITCH = 'ACCT'
 19407         MOVE ER-0168            TO EMI-ERROR.
 19408
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 373
* EL156.cbl
 19409     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19410     MOVE -1                     TO PMTTYPEL.
 19411
 19412     IF FIRST-ENTRY = 'Y'
 19413         GO TO 8100-SEND-INITIAL-MAP.
 19414
 19415     GO TO 8200-SEND-DATAONLY.
 19416
 19417 8600-PGRM-NOT-FOUND.
 19418
 19419     MOVE ER-0923                TO EMI-ERROR.
 19420     MOVE -1                     TO ENTPFBL.
 19421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19422
 19423     IF FIRST-ENTRY = 'Y'
 19424         GO TO 8100-SEND-INITIAL-MAP
 19425     ELSE
 19426         GO TO 8200-SEND-DATAONLY.
 19427
 19428 8800-UNAUTHORIZED-ACCESS.
 19429     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19430     GO TO 8300-SEND-TEXT.
 19431
 19432 8810-PF23.
 19433     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19434     MOVE XCTL-005               TO PGM-NAME.
 19435     GO TO 9300-XCTL.
 19436
 19437 8820-PF7-8.
 19438     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19439     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19440                                    PI-SAVED-PROGRAM-2
 19441                                    PI-SAVED-PROGRAM-3
 19442                                    PI-SAVED-PROGRAM-4
 19443                                    PI-SAVED-PROGRAM-5
 19444                                    PI-SAVED-PROGRAM-6
 19445                                    PI-RETURN-TO-PROGRAM.
 19446     IF EIBAID = DFHPF8
 19447        MOVE XCTL-132            TO PGM-NAME
 19448     ELSE
 19449        MOVE XCTL-130            TO PGM-NAME.
 19450
 19451     GO TO 9300-XCTL.
 19452
 19453 9100-RETURN-TRAN.
 19454     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19455     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19456
 19457
 19458* EXEC CICS RETURN
 19459*        TRANSID(TRANS-ID)
 19460*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19461*        LENGTH(PI-COMM-LENGTH)
 19462*    END-EXEC.
 19463*    MOVE '.(CT                  ''   #00017205' TO DFHEIV0
 19464     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19465     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19466     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 374
* EL156.cbl
 19467     CALL 'kxdfhei1' USING DFHEIV0,
 19468           TRANS-ID,
 19469           PROGRAM-INTERFACE-BLOCK,
 19470           PI-COMM-LENGTH,
 19471           DFHEIV99,
 19472           DFHEIV99,
 19473           DFHEIV99
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19475
 19476
 19477 9200-RETURN-MAIN-MENU.
 19478     MOVE XCTL-126               TO PGM-NAME.
 19479     GO TO 9300-XCTL.
 19480
 19481 9300-XCTL.
 19482
 19483* EXEC CICS XCTL
 19484*        PROGRAM(PGM-NAME)
 19485*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19486*        LENGTH(PI-COMM-LENGTH)
 19487*    END-EXEC.
 19488*    MOVE '.$C                   %   #00017216' TO DFHEIV0
 19489     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19490     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303137323136' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           PGM-NAME,
 19494           PROGRAM-INTERFACE-BLOCK,
 19495           PI-COMM-LENGTH,
 19496           DFHEIV99
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19498
 19499
 19500 9400-CLEAR.
 19501     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19502     GO TO 9300-XCTL.
 19503
 19504 9500-PF12.
 19505     MOVE XCTL-010               TO PGM-NAME.
 19506     GO TO 9300-XCTL.
 19507
 19508 9700-LINK-DATE-CONVERT.
 19509     MOVE LINK-ELDATCV           TO PGM-NAME.
 19510
 19511* EXEC CICS LINK
 19512*        PROGRAM   (PGM-NAME)
 19513*        COMMAREA  (DATE-CONVERSION-DATA)
 19514*        LENGTH    (DC-COMM-LENGTH)
 19515*    END-EXEC.
 19516*    MOVE '."C                   (   #00017232' TO DFHEIV0
 19517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303137323332' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           PGM-NAME,
 19522           DATE-CONVERSION-DATA,
 19523           DC-COMM-LENGTH,
 19524           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 375
* EL156.cbl
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99
 19528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19529
 19530
 19531 9700-EXIT.
 19532     EXIT.
 19533
 19534 9800-LINK-REM-TERM.
 19535     MOVE LINK-REMTERM TO PGM-NAME.
 19536
 19537
 19538* EXEC CICS LINK
 19539*        PROGRAM   (PGM-NAME)
 19540*        COMMAREA  (CALCULATION-PASS-AREA)
 19541*        LENGTH    (CP-COMM-LENGTH)
 19542*    END-EXEC.
 19543*    MOVE '."C                   (   #00017244' TO DFHEIV0
 19544     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19546     MOVE X'2020233030303137323434' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0,
 19548           PGM-NAME,
 19549           CALCULATION-PASS-AREA,
 19550           CP-COMM-LENGTH,
 19551           DFHEIV99,
 19552           DFHEIV99,
 19553           DFHEIV99,
 19554           DFHEIV99
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
 19557
 19558 9800-EXIT.
 19559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 376
* EL156.cbl
 19561 9830-DMD-REMAINING-TERM.
 19562
 19563     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19564         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19565
 19566     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19567                              CM-PMT-EXTENSION-DAYS.
 19568
 19569     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19570                                  CL-NO-OF-DAYS-PAID.
 19571
 19572     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19573         GIVING W-REM REMAINDER W-REM-DAYS.
 19574
 19575     MOVE W-REM                  TO WST-REM.
 19576
 19577     IF W-REM-DAYS > ZEROS
 19578         MOVE '/'                TO WST-SLASH
 19579         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19580     ELSE
 19581         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19582
 19583 9830-EXIT.
 19584     EXIT.
 19585
 19586 9870-OUTPUT-ACTIVITY-RECORD.
 19587
 19588
 19589* EXEC CICS GETMAIN
 19590*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19591*         LENGTH(25)
 19592*         INITIMG(WS-BLANK)
 19593*    END-EXEC.
 19594     MOVE 25
 19595       TO DFHEIV11
 19596*    MOVE ',"IL                  $   #00017280' TO DFHEIV0
 19597     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19599     MOVE X'2020233030303137323830' TO DFHEIV0(25:11)
 19600     CALL 'kxdfhei1' USING DFHEIV0,
 19601           DFHEIV20,
 19602           DFHEIV11,
 19603           WS-BLANK
 19604     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19605         DFHEIV20
 19606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19607
 19608
 19609     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19610     MOVE ELMSTR-KEY             TO DA-KEY.
 19611     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19612
 19613     IF PI-PMTTYPE EQUAL '7'
 19614         MOVE 'V'                TO DA-RECORD-TYPE
 19615     ELSE
 19616         MOVE 'P'                TO DA-RECORD-TYPE.
 19617
 19618
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 377
* EL156.cbl
 19619* EXEC CICS HANDLE CONDITION
 19620*         NOTOPEN(9870-NOTOPEN)
 19621*         DUPREC(9870-EXIT)
 19622*    END-EXEC.
 19623*    MOVE '"$J%                  ! B #00017295' TO DFHEIV0
 19624     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19626     MOVE X'4220233030303137323935' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0
 19628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19629
 19630
 19631
 19632* EXEC CICS WRITE
 19633*         DATASET('DLYACTV')
 19634*         RIDFLD(DA-KEY)
 19635*         FROM(DAILY-ACTIVITY-RECORD)
 19636*         LENGTH(25)
 19637*    END-EXEC.
 19638     MOVE 'DLYACTV' TO DFHEIV1
 19639     MOVE 25
 19640       TO DFHEIV11
 19641*    MOVE '&$ L                  ''   #00017300' TO DFHEIV0
 19642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19644     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 19645     CALL 'kxdfhei1' USING DFHEIV0,
 19646           DFHEIV1,
 19647           DAILY-ACTIVITY-RECORD,
 19648           DFHEIV11,
 19649           DA-KEY,
 19650           DFHEIV99,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19655     GO TO 9870-EXIT.
 19656
 19657 9870-NOTOPEN.
 19658
 19659     MOVE '2955'                 TO EMI-ERROR.
 19660     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19661
 19662 9870-EXIT.
 19663     EXIT.
 19664
 19665 9900-ERROR-FORMAT.
 19666
 19667     IF EMI-ERROR = ER-0923
 19668         MOVE PGM-NAME           TO W-CALLED-NAME.
 19669
 19670     MOVE LINK-001      TO PGM-NAME.
 19671     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19672
 19673
 19674* EXEC CICS LINK
 19675*        PROGRAM (PGM-NAME)
 19676*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 378
* EL156.cbl
 19677*        LENGTH  (EMI-COMM-LENGTH)
 19678*    END-EXEC.
 19679*    MOVE '."C                   (   #00017325' TO DFHEIV0
 19680     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19682     MOVE X'2020233030303137333235' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0,
 19684           PGM-NAME,
 19685           ERROR-MESSAGE-INTERFACE-BLOCK,
 19686           EMI-COMM-LENGTH,
 19687           DFHEIV99,
 19688           DFHEIV99,
 19689           DFHEIV99,
 19690           DFHEIV99
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
 19694     IF EMI-ERROR = ER-0923
 19695         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19696
 19697 9900-EXIT.
 19698     EXIT.
 19699
 19700 9990-ABEND.
 19701     MOVE LINK-004               TO PGM-NAME.
 19702     MOVE DFHEIBLK               TO EMI-LINE1.
 19703
 19704* EXEC CICS LINK
 19705*        PROGRAM   (PGM-NAME)
 19706*        COMMAREA  (EMI-LINE1)
 19707*        LENGTH    (64)
 19708*    END-EXEC.
 19709     MOVE 64
 19710       TO DFHEIV11
 19711*    MOVE '."C                   (   #00017340' TO DFHEIV0
 19712     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19714     MOVE X'2020233030303137333430' TO DFHEIV0(25:11)
 19715     CALL 'kxdfhei1' USING DFHEIV0,
 19716           PGM-NAME,
 19717           EMI-LINE1,
 19718           DFHEIV11,
 19719           DFHEIV99,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99
 19723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19724
 19725
 19726     MOVE 'EL156A'               TO  MAP-NAME.
 19727     MOVE LOW-VALUES             TO  EL156AO.
 19728     GO TO 8100-SEND-INITIAL-MAP.
 19729
 19730 9995-SECURITY-VIOLATION.
 19731*    COPY ELCSCTP.
 19732******************************************************************
 19733*                                                                *
 19734*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 379
* EL156.cbl
 19735*                            VMOD=2.001                          *
 19736*                                                                *
 19737*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19738******************************************************************
 19739
 19740
 19741     MOVE EIBDATE          TO SM-JUL-DATE.
 19742     MOVE EIBTRMID         TO SM-TERMID.
 19743     MOVE THIS-PGM         TO SM-PGM.
 19744     MOVE EIBTIME          TO TIME-IN.
 19745     MOVE TIME-OUT         TO SM-TIME.
 19746     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19747
 19748
 19749* EXEC CICS LINK
 19750*         PROGRAM  ('EL003')
 19751*         COMMAREA (SECURITY-MESSAGE)
 19752*         LENGTH   (80)
 19753*    END-EXEC.
 19754     MOVE 'EL003' TO DFHEIV1
 19755     MOVE 80
 19756       TO DFHEIV11
 19757*    MOVE '."C                   (   #00017368' TO DFHEIV0
 19758     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19760     MOVE X'2020233030303137333638' TO DFHEIV0(25:11)
 19761     CALL 'kxdfhei1' USING DFHEIV0,
 19762           DFHEIV1,
 19763           SECURITY-MESSAGE,
 19764           DFHEIV11,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99,
 19768           DFHEIV99
 19769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19770
 19771
 19772******************************************************************
 19773
 19774
 19775
 19776 9999-DFHBACK SECTION.
 19777     MOVE '9%                    "   ' TO DFHEIV0
 19778     MOVE 'EL156' TO DFHEIV1
 19779     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19780     GOBACK.
 19781 9999-DFHEXIT.
 19782     IF DFHEIGDJ EQUAL 0001
 19783         NEXT SENTENCE
 19784     ELSE IF DFHEIGDJ EQUAL 2
 19785         GO TO 9990-ABEND,
 19786               8600-PGRM-NOT-FOUND,
 19787               0400-FIRST-TIME,
 19788               6180-DUPREC,
 19789               9990-ABEND
 19790         DEPENDING ON DFHEIGDI
 19791     ELSE IF DFHEIGDJ EQUAL 3
 19792         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 380
* EL156.cbl
 19793               0380-CLAIM-END-FILE
 19794         DEPENDING ON DFHEIGDI
 19795     ELSE IF DFHEIGDJ EQUAL 4
 19796         GO TO 0380-CLAIM-END-FILE,
 19797               0380-CLAIM-END-FILE
 19798         DEPENDING ON DFHEIGDI
 19799     ELSE IF DFHEIGDJ EQUAL 5
 19800         GO TO 0800-EXIT
 19801         DEPENDING ON DFHEIGDI
 19802     ELSE IF DFHEIGDJ EQUAL 6
 19803         GO TO 1950-NOT-FOUND,
 19804               1950-NOT-FOUND
 19805         DEPENDING ON DFHEIGDI
 19806     ELSE IF DFHEIGDJ EQUAL 7
 19807         GO TO 1950-NOT-FOUND
 19808         DEPENDING ON DFHEIGDI
 19809     ELSE IF DFHEIGDJ EQUAL 8
 19810         GO TO 1950-NOT-FOUND,
 19811               1950-NOT-FOUND
 19812         DEPENDING ON DFHEIGDI
 19813     ELSE IF DFHEIGDJ EQUAL 9
 19814         GO TO 1166-END-CHECK,
 19815               1166-END-CHECK
 19816         DEPENDING ON DFHEIGDI
 19817     ELSE IF DFHEIGDJ EQUAL 10
 19818         GO TO 1950-NOT-FOUND,
 19819               1950-NOT-FOUND
 19820         DEPENDING ON DFHEIGDI
 19821     ELSE IF DFHEIGDJ EQUAL 11
 19822         GO TO 1950-NOT-FOUND,
 19823               1950-NOT-FOUND
 19824         DEPENDING ON DFHEIGDI
 19825     ELSE IF DFHEIGDJ EQUAL 12
 19826         GO TO 1950-NOT-FOUND
 19827         DEPENDING ON DFHEIGDI
 19828     ELSE IF DFHEIGDJ EQUAL 13
 19829         GO TO 3600-CONTINUE
 19830         DEPENDING ON DFHEIGDI
 19831     ELSE IF DFHEIGDJ EQUAL 14
 19832         GO TO 5300-NOTE-NOT-FOUND
 19833         DEPENDING ON DFHEIGDI
 19834     ELSE IF DFHEIGDJ EQUAL 15
 19835         GO TO 6065-NOT-FOUND
 19836         DEPENDING ON DFHEIGDI
 19837     ELSE IF DFHEIGDJ EQUAL 16
 19838         GO TO 6068-ACCT-NOT-FND
 19839         DEPENDING ON DFHEIGDI
 19840     ELSE IF DFHEIGDJ EQUAL 17
 19841         GO TO 6074-GET-COMP-DATA
 19842         DEPENDING ON DFHEIGDI
 19843     ELSE IF DFHEIGDJ EQUAL 18
 19844         GO TO 6170-WRITE
 19845         DEPENDING ON DFHEIGDI
 19846     ELSE IF DFHEIGDJ EQUAL 19
 19847         GO TO 6180-DUPREC
 19848         DEPENDING ON DFHEIGDI
 19849     ELSE IF DFHEIGDJ EQUAL 20
 19850         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 381
* EL156.cbl
 19851         DEPENDING ON DFHEIGDI
 19852     ELSE IF DFHEIGDJ EQUAL 21
 19853         GO TO 6185-DUPREC
 19854         DEPENDING ON DFHEIGDI
 19855     ELSE IF DFHEIGDJ EQUAL 22
 19856         GO TO 6720-BUILD-NEW-RECORD
 19857         DEPENDING ON DFHEIGDI
 19858     ELSE IF DFHEIGDJ EQUAL 23
 19859         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19860               6900-BUILD-ARCHIVE-HEADER
 19861         DEPENDING ON DFHEIGDI
 19862     ELSE IF DFHEIGDJ EQUAL 24
 19863         GO TO 7010-BUILD-MAP
 19864         DEPENDING ON DFHEIGDI
 19865     ELSE IF DFHEIGDJ EQUAL 25
 19866         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19867         DEPENDING ON DFHEIGDI
 19868     ELSE IF DFHEIGDJ EQUAL 26
 19869         GO TO 7160-DUPREC
 19870         DEPENDING ON DFHEIGDI
 19871     ELSE IF DFHEIGDJ EQUAL 27
 19872         GO TO 7200-EXIT,
 19873               7200-EXIT
 19874         DEPENDING ON DFHEIGDI
 19875     ELSE IF DFHEIGDJ EQUAL 28
 19876         GO TO 7400-NOT-FOUND
 19877         DEPENDING ON DFHEIGDI
 19878     ELSE IF DFHEIGDJ EQUAL 29
 19879         GO TO 7590-END,
 19880               7590-END
 19881         DEPENDING ON DFHEIGDI
 19882     ELSE IF DFHEIGDJ EQUAL 30
 19883         GO TO 7699-EXIT
 19884         DEPENDING ON DFHEIGDI
 19885     ELSE IF DFHEIGDJ EQUAL 31
 19886         GO TO 5300-NOTE-NOT-FOUND
 19887         DEPENDING ON DFHEIGDI
 19888     ELSE IF DFHEIGDJ EQUAL 32
 19889         GO TO 7800-COMP-NOTFND
 19890         DEPENDING ON DFHEIGDI
 19891     ELSE IF DFHEIGDJ EQUAL 33
 19892         GO TO 7920-NOT-FOUND
 19893         DEPENDING ON DFHEIGDI
 19894     ELSE IF DFHEIGDJ EQUAL 34
 19895         GO TO 9870-NOTOPEN,
 19896               9870-EXIT
 19897         DEPENDING ON DFHEIGDI.
 19898     MOVE '9%                    "   ' TO DFHEIV0
 19899     MOVE 'EL156' TO DFHEIV1
 19900     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19901     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12060     Code:       73301
