* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL601.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL601.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL601.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL601.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/06/94 08:32:30.
     7*                            VMOD=2.008.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL601.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EG1A - SYSTEM MAINTENANCE MENU.
    26
    27 ENVIRONMENT DIVISION.
    28
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL601.cbl
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL601 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '*************V/M 2.008 *********'.
    36
    37 01  WS-DATE-AREA.
    38     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    39     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    40
    41 01  MISC-WORK-AREAS.
    42
    43     12  SCREEN-SELECT-CHANGES.
    44         16  SCREEN-RESERVE-10   PIC X(32) VALUE
    45                 ' 10. RESERVED'.
    46         16  SCREEN-RESERVE-11   PIC X(32) VALUE
    47                 ' 11. RESERVED'.
    48         16  SCREEN-RESERVE-13   PIC X(32) VALUE
    49                 ' 13. RESERVED'.
    50         16  SCREEN-RESERVE-14   PIC X(32) VALUE
    51                 ' 14. RESERVED'.
    52         16  SCREEN-RESERVE-15   PIC X(32) VALUE
    53                 ' 15. RESERVED'.
    54         16  SCREEN-RESERVE-16   PIC X(32) VALUE
    55                 ' 16. RESERVED'.
    56         16  SCREEN-RESERVE-17   PIC X(32) VALUE
    57                 ' 17. RESERVED'.
    58         16  SCREEN-SELECT-10    PIC X(32) VALUE
    59                 ' 10. GENERAL LEDGER TABLE LOOKUP'.
    60         16  SCREEN-SELECT-11    PIC X(32) VALUE
    61                 ' 11. RETRO HISTORY MAINTENANCE'.
    62         16  SCREEN-SELECT-12    PIC X(32) VALUE
    63                 ' 12. BANK MASTER MAINTENANCE'.
    64*        16  SCREEN-SELECT-13    PIC X(32) VALUE
    65*                ' 13. RETRO MASTER MAINTENANCE'.
    66         16  SCREEN-SELECT-13    PIC X(32) VALUE
    67                 ' 13. LIFE CLAIM INT. MAINT   '.
    68         16  SCREEN-SELECT-14    PIC X(29) VALUE
    69                 ' 14. RESIDENT STATE TAX MAINT'.
    70         16  SCREEN-SELECT-15    PIC X(38) VALUE
    71                 ' 15. ACCOUNT RESIDENT STATE COMM MAINT'.
    72         16  SCREEN-SELECT-16    PIC X(37) VALUE
    73                 ' 16. RESIDENT ST COMMISSION CAP MAINT'.
    74         16  SCREEN-SELECT-17    PIC X(37) VALUE
    75                 ' 17. CODES TABLE MAINTENANCE'.
    76         16  SCREEN-SELECT-18    PIC X(37) VALUE
    77                 ' 18. HIERARCHY TABLE'.
    78
    79     12  MAP-EL601A          PIC X(8)    VALUE 'EL601A'.
    80     12  MAPSET-EL601S       PIC X(8)    VALUE 'EL601S'.
    81     12  TRANS-EXA1          PIC X(4)    VALUE 'EXA1'.
    82     12  PGM-EL601           PIC X(8)    VALUE 'EL601'.
    83     12  PGM-NAME            PIC X(8).
    84     12  TIME-IN             PIC S9(7).
    85     12  TIME-OUT-R  REDEFINES TIME-IN.
    86         16  FILLER          PIC X.
    87         16  TIME-OUT        PIC 99V99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL601.cbl
    88         16  FILLER          PIC X(2).
    89     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
    90     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
    91     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
    92
    93     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
    94     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
    95     12  XCTL-EL102          PIC X(8)    VALUE 'EL102'.
    96     12  XCTL-EL103          PIC X(8)    VALUE 'EL103'.
    97     12  XCTL-EL104          PIC X(8)    VALUE 'EL104'.
    98     12  XCTL-EL105          PIC X(8)    VALUE 'EL105'.
    99     12  XCTL-EL106          PIC X(8)    VALUE 'EL106'.
   100     12  XCTL-EL107          PIC X(8)    VALUE 'EL107'.
   101     12  XCTL-EL108          PIC X(8)    VALUE 'EL108'.
   102     12  XCTL-EL110          PIC X(8)    VALUE 'EL110'.
   103     12  XCTL-EL111          PIC X(8)    VALUE 'EL111'.
   104     12  XCTL-EL112          PIC X(8)    VALUE 'EL112'.
   105     12  XCTL-EL119          PIC X(8)    VALUE 'EL119'.
   106     12  XCTL-EL126          PIC X(8)    VALUE 'EL800'.
   107     12  XCTL-EL158          PIC X(8)    VALUE 'EL158'.
   108     12  XCTL-EL400          PIC X(8)    VALUE 'EL400NCB'.
   109     12  XCTL-EL602          PIC X(8)    VALUE 'EL602'.
   110     12  XCTL-EL603          PIC X(8)    VALUE 'EL603'.
   111     12  XCTL-EL604          PIC X(8)    VALUE 'EL604'.
   112     12  XCTL-EL605          PIC X(8)    VALUE 'EL605'.
   113     12  XCTL-EL606          PIC X(8)    VALUE 'EL606'.
   114     12  XCTL-EL607          PIC X(8)    VALUE 'EL607'.
   115     12  XCTL-EL608          PIC X(8)    VALUE 'EL608 '.
   116     12  XCTL-EL610          PIC X(8)    VALUE 'EL610'.
   117     12  XCTL-EL611          PIC X(8)    VALUE 'EL611'.
   118     12  XCTL-EL613          PIC X(8)    VALUE 'EL613'.
   119     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   120     12  XCTL-EL650          PIC X(8)    VALUE 'EL650'.
   121     12  XCTL-EL651          PIC X(8)    VALUE 'EL651'.
   122     12  XCTL-EL652          PIC X(8)    VALUE 'EL652'.
   123     12  XCTL-EL653          PIC X(8)    VALUE 'EL653'.
   124     12  XCTL-EL654          PIC X(8)    VALUE 'EL654'.
   125     12  XCTL-EL656          PIC X(8)    VALUE 'EL656'.
   126     12  XCTL-EL658          PIC X(8)    VALUE 'EL658'.
   127     12  XCTL-EL659          PIC X(8)    VALUE 'EL659'.
   128     12  XCTL-EL1062         PIC X(8)    VALUE 'EL1062'.
   129     12  XCTL-EL1064         PIC X(8)    VALUE 'EL1064'.
   130
   131     12  ER-0002             PIC X(4)    VALUE '0002'.
   132     12  ER-2370             PIC X(4)    VALUE '2370'.
   133     12  ER-2371             PIC X(4)    VALUE '2371'.
   134     12  ER-7000             PIC X(4)    VALUE '7000'.
   135     12  ER-7001             PIC X(4)    VALUE '7001'.
   136     12  ER-7002             PIC X(4)    VALUE '7002'.
   137     12  ER-7003             PIC X(4)    VALUE '7003'.
   138     12  ER-7008             PIC X(4)    VALUE '7008'.
   139     12  ER-7448             PIC X(4)    VALUE '7448'.
   140
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL601.cbl
   142*                            COPY ELCLOGOF.
   143******************************************************************
   144*                                                                *
   145*                                                                *
   146*                            ELCLOGOF.                           *
   147*                            VMOD=2.001                          *
   148*                                                                *
   149*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   150*                                                                *
   151******************************************************************
   152 01  CLASIC-LOGOFF.
   153     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   154     12  LOGOFF-TEXT.
   155         16  FILLER          PIC X(5)    VALUE SPACES.
   156         16  LOGOFF-MSG.
   157             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   158             20  FILLER      PIC X       VALUE SPACES.
   159             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   160         16  FILLER          PIC X(80)
   161           VALUE '* YOU ARE NOW LOGGED OFF'.
   162         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   163         16  FILLER          PIC X       VALUE QUOTE.
   164         16  LOGOFF-SYS-MSG  PIC X(17)
   165           VALUE 'S CLAS-IC SYSTEM '.
   166     12  TEXT-MESSAGES.
   167         16  UNACCESS-MSG    PIC X(29)
   168             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   169         16  PGMIDERR-MSG    PIC X(17)
   170             VALUE 'PROGRAM NOT FOUND'.
   171
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL601.cbl
   173*                            COPY ELCDATE.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ELCDATE.                            *
   178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   179*                            VMOD=2.003
   180*                                                                *
   181*                                                                *
   182*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   183*                 LENGTH = 200                                   *
   184******************************************************************
   185
   186 01  DATE-CONVERSION-DATA.
   187     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   188     12  DC-OPTION-CODE                PIC X.
   189         88  BIN-TO-GREG                VALUE ' '.
   190         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   191         88  EDIT-GREG-TO-BIN           VALUE '2'.
   192         88  YMD-GREG-TO-BIN            VALUE '3'.
   193         88  MDY-GREG-TO-BIN            VALUE '4'.
   194         88  JULIAN-TO-BIN              VALUE '5'.
   195         88  BIN-PLUS-ELAPSED           VALUE '6'.
   196         88  FIND-CENTURY               VALUE '7'.
   197         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   198         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   199         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   200         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   201         88  JULIAN-TO-BIN-3            VALUE 'C'.
   202         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   203         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   204         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   205         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   206         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   207         88  CHECK-LEAP-YEAR            VALUE 'H'.
   208         88  BIN-3-TO-GREG              VALUE 'I'.
   209         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   210         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   211         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   212         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   213         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   214         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   215         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   216         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   217         88  THREE-CHARACTER-BIN
   218                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   219         88  GREGORIAN-TO-BIN
   220                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   221         88  BIN-TO-GREGORIAN
   222                  VALUES ' ' '1' 'I' '8' 'G'.
   223         88  JULIAN-TO-BINARY
   224                  VALUES '5' 'C' 'E' 'F'.
   225     12  DC-ERROR-CODE                 PIC X.
   226         88  NO-CONVERSION-ERROR        VALUE ' '.
   227         88  DATE-CONVERSION-ERROR
   228                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   229         88  DATE-IS-ZERO               VALUE '1'.
   230         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL601.cbl
   231         88  DATE-IS-INVALID            VALUE '3'.
   232         88  DATE1-GREATER-DATE2        VALUE '4'.
   233         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   234         88  DATE-INVALID-OPTION        VALUE '9'.
   235         88  INVALID-CENTURY            VALUE 'A'.
   236         88  ONLY-CENTURY               VALUE 'B'.
   237         88  ONLY-LEAP-YEAR             VALUE 'C'.
   238         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   239     12  DC-END-OF-MONTH               PIC X.
   240         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   241     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   242         88  USE-NORMAL-PROCESS         VALUE ' '.
   243         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   244         88  ADJUST-UP-100-YRS          VALUE '2'.
   245     12  FILLER                        PIC X.
   246     12  DC-CONVERSION-DATES.
   247         16  DC-BIN-DATE-1             PIC XX.
   248         16  DC-BIN-DATE-2             PIC XX.
   249         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   250         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   251                       DC-GREG-DATE-1-EDIT.
   252             20  DC-EDIT1-MONTH        PIC 99.
   253             20  SLASH1-1              PIC X.
   254             20  DC-EDIT1-DAY          PIC 99.
   255             20  SLASH1-2              PIC X.
   256             20  DC-EDIT1-YEAR         PIC 99.
   257         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   258         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   259                     DC-GREG-DATE-2-EDIT.
   260             20  DC-EDIT2-MONTH        PIC 99.
   261             20  SLASH2-1              PIC X.
   262             20  DC-EDIT2-DAY          PIC 99.
   263             20  SLASH2-2              PIC X.
   264             20  DC-EDIT2-YEAR         PIC 99.
   265         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   266         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   267                     DC-GREG-DATE-1-YMD.
   268             20  DC-YMD-YEAR           PIC 99.
   269             20  DC-YMD-MONTH          PIC 99.
   270             20  DC-YMD-DAY            PIC 99.
   271         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   272         16  DC-GREG-DATE-1-MDY-R REDEFINES
   273                      DC-GREG-DATE-1-MDY.
   274             20  DC-MDY-MONTH          PIC 99.
   275             20  DC-MDY-DAY            PIC 99.
   276             20  DC-MDY-YEAR           PIC 99.
   277         16  DC-GREG-DATE-1-ALPHA.
   278             20  DC-ALPHA-MONTH        PIC X(10).
   279             20  DC-ALPHA-DAY          PIC 99.
   280             20  FILLER                PIC XX.
   281             20  DC-ALPHA-CENTURY.
   282                 24 DC-ALPHA-CEN-N     PIC 99.
   283             20  DC-ALPHA-YEAR         PIC 99.
   284         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   285         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   286         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   287         16  DC-JULIAN-DATE            PIC 9(05).
   288         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL601.cbl
   289                                       PIC 9(05).
   290         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   291             20  DC-JULIAN-YEAR        PIC 99.
   292             20  DC-JULIAN-DAYS        PIC 999.
   293         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   294         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   295         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   296     12  DATE-CONVERSION-VARIBLES.
   297         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   298         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   299             20  FILLER                PIC 9(3).
   300             20  HOLD-CEN-1-CCYY.
   301                 24  HOLD-CEN-1-CC     PIC 99.
   302                 24  HOLD-CEN-1-YY     PIC 99.
   303             20  HOLD-CEN-1-MO         PIC 99.
   304             20  HOLD-CEN-1-DA         PIC 99.
   305         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   306             20  HOLD-CEN-1-R-MO       PIC 99.
   307             20  HOLD-CEN-1-R-DA       PIC 99.
   308             20  HOLD-CEN-1-R-CCYY.
   309                 24  HOLD-CEN-1-R-CC   PIC 99.
   310                 24  HOLD-CEN-1-R-YY   PIC 99.
   311             20  FILLER                PIC 9(3).
   312         16  HOLD-CENTURY-1-X.
   313             20  FILLER                PIC X(3)  VALUE SPACES.
   314             20  HOLD-CEN-1-X-CCYY.
   315                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   316                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   317             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   318             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   319         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   320             20  HOLD-CEN-1-R-X-MO     PIC XX.
   321             20  HOLD-CEN-1-R-X-DA     PIC XX.
   322             20  HOLD-CEN-1-R-X-CCYY.
   323                 24  HOLD-CEN-1-R-X-CC PIC XX.
   324                 24  HOLD-CEN-1-R-X-YY PIC XX.
   325             20  FILLER                PIC XXX.
   326         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   327         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   328         16  DC-JULIAN-DATE-1          PIC 9(07).
   329         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   330             20  DC-JULIAN-1-CCYY.
   331                 24  DC-JULIAN-1-CC    PIC 99.
   332                 24  DC-JULIAN-1-YR    PIC 99.
   333             20  DC-JULIAN-DA-1        PIC 999.
   334         16  DC-JULIAN-DATE-2          PIC 9(07).
   335         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   336             20  DC-JULIAN-2-CCYY.
   337                 24  DC-JULIAN-2-CC    PIC 99.
   338                 24  DC-JULIAN-2-YR    PIC 99.
   339             20  DC-JULIAN-DA-2        PIC 999.
   340         16  DC-GREG-DATE-A-EDIT.
   341             20  DC-EDITA-MONTH        PIC 99.
   342             20  SLASHA-1              PIC X VALUE '/'.
   343             20  DC-EDITA-DAY          PIC 99.
   344             20  SLASHA-2              PIC X VALUE '/'.
   345             20  DC-EDITA-CCYY.
   346                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL601.cbl
   347                 24  DC-EDITA-YEAR     PIC 99.
   348         16  DC-GREG-DATE-B-EDIT.
   349             20  DC-EDITB-MONTH        PIC 99.
   350             20  SLASHB-1              PIC X VALUE '/'.
   351             20  DC-EDITB-DAY          PIC 99.
   352             20  SLASHB-2              PIC X VALUE '/'.
   353             20  DC-EDITB-CCYY.
   354                 24  DC-EDITB-CENT     PIC 99.
   355                 24  DC-EDITB-YEAR     PIC 99.
   356         16  DC-GREG-DATE-CYMD         PIC 9(08).
   357         16  DC-GREG-DATE-CYMD-R REDEFINES
   358                              DC-GREG-DATE-CYMD.
   359             20  DC-CYMD-CEN           PIC 99.
   360             20  DC-CYMD-YEAR          PIC 99.
   361             20  DC-CYMD-MONTH         PIC 99.
   362             20  DC-CYMD-DAY           PIC 99.
   363         16  DC-GREG-DATE-MDCY         PIC 9(08).
   364         16  DC-GREG-DATE-MDCY-R REDEFINES
   365                              DC-GREG-DATE-MDCY.
   366             20  DC-MDCY-MONTH         PIC 99.
   367             20  DC-MDCY-DAY           PIC 99.
   368             20  DC-MDCY-CEN           PIC 99.
   369             20  DC-MDCY-YEAR          PIC 99.
   370    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   371        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   372    12  DC-EL310-DATE                  PIC X(21).
   373    12  FILLER                         PIC X(28).
   374
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL601.cbl
   376*                            COPY ELCATTR.
   377******************************************************************
   378*                                                                *
   379*                            ELCATTR.                            *
   380*                            VMOD=2.001                          *
   381*                                                                *
   382*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   383*                                                                *
   384*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   385*                                                                *
   386*                   POS 1   P=PROTECTED                          *
   387*                           U=UNPROTECTED                        *
   388*                           S=ASKIP                              *
   389*                   POS 2   A=ALPHA/NUMERIC                      *
   390*                           N=NUMERIC                            *
   391*                   POS 3   N=NORMAL                             *
   392*                           B=BRIGHT                             *
   393*                           D=DARK                               *
   394*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   395*                           OF=MODIFIED DATA TAG OFF             *
   396*                                                                *
   397*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   398******************************************************************
   399 01  ATTRIBUTE-LIST.
   400     12  AL-PABOF            PIC X       VALUE 'Y'.
   401     12  AL-PABON            PIC X       VALUE 'Z'.
   402     12  AL-PADOF            PIC X       VALUE '%'.
   403     12  AL-PADON            PIC X       VALUE '_'.
   404     12  AL-PANOF            PIC X       VALUE '-'.
   405     12  AL-PANON            PIC X       VALUE '/'.
   406     12  AL-SABOF            PIC X       VALUE '8'.
   407     12  AL-SABON            PIC X       VALUE '9'.
   408     12  AL-SADOF            PIC X       VALUE '@'.
   409     12  AL-SADON            PIC X       VALUE QUOTE.
   410     12  AL-SANOF            PIC X       VALUE '0'.
   411     12  AL-SANON            PIC X       VALUE '1'.
   412     12  AL-UABOF            PIC X       VALUE 'H'.
   413     12  AL-UABON            PIC X       VALUE 'I'.
   414     12  AL-UADOF            PIC X       VALUE '<'.
   415     12  AL-UADON            PIC X       VALUE '('.
   416     12  AL-UANOF            PIC X       VALUE ' '.
   417     12  AL-UANON            PIC X       VALUE 'A'.
   418     12  AL-UNBOF            PIC X       VALUE 'Q'.
   419     12  AL-UNBON            PIC X       VALUE 'R'.
   420     12  AL-UNDOF            PIC X       VALUE '*'.
   421     12  AL-UNDON            PIC X       VALUE ')'.
   422     12  AL-UNNOF            PIC X       VALUE '&'.
   423     12  AL-UNNON            PIC X       VALUE 'J'.
   424
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL601.cbl
   426*                            COPY ELCEMIB.
   427******************************************************************
   428*                                                                *
   429*                                                                *
   430*                            ELCEMIB.                            *
   431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   432*                            VMOD=2.005                          *
   433*                                                                *
   434*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   435*                                                                *
   436******************************************************************
   437 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   438     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   439     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   440     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   441     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   442     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   443     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   444     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   445     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   446     12  EMI-SWITCH1             PIC X        VALUE '1'.
   447         88  EMI-NO-ERRORS                    VALUE '1'.
   448         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   449         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   450     12  EMI-SWITCH2             PIC X        VALUE '1'.
   451         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   452     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   453         88  EMI-AREA1-EMPTY                  VALUE '1'.
   454         88  EMI-AREA1-FULL                   VALUE '2'.
   455     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   456         88  EMI-AREA2-EMPTY                  VALUE '1'.
   457         88  EMI-AREA2-FULL                   VALUE '2'.
   458     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   459         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   460         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   461         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   462         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   463         88  EMI-BYPASS-FATALS                VALUE 'X'.
   464     12  EMI-ERROR-LINES.
   465         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   466         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   467         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   468         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   469             20  EMI-ERR-CODES OCCURS 10 TIMES.
   470                 24  EMI-ERR-NUM         PIC X(4).
   471                 24  EMI-FILLER          PIC X.
   472                 24  EMI-SEV             PIC X.
   473                 24  FILLER              PIC X.
   474             20  FILLER                  PIC X(02).
   475     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   476         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   477             20  EMI-ERROR-NUMBER    PIC X(4).
   478             20  EMI-FILL            PIC X.
   479             20  EMI-SEVERITY        PIC X.
   480             20  FILLER              PIC X.
   481             20  EMI-ERROR-TEXT.
   482                 24  EMI-TEXT-VARIABLE   PIC X(10).
   483                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL601.cbl
   484     12  EMI-SEVERITY-SAVE           PIC X.
   485         88  EMI-NOTE                    VALUE 'N'.
   486         88  EMI-WARNING                 VALUE 'W'.
   487         88  EMI-FORCABLE                VALUE 'F'.
   488         88  EMI-FATAL                   VALUE 'X'.
   489     12  EMI-MESSAGE-FLAG            PIC X.
   490         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   491         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   492     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   493     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   494         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   495         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   496         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   497     12  FILLER                      PIC X(137)  VALUE SPACES.
   498     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   499     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   500     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   501     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   502
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL601.cbl
   504*                            COPY ELCINTF.
   505******************************************************************
   506*                                                                *
   507*                                                                *
   508*                            ELCINTF.                            *
   509*                            VMOD=2.017                          *
   510*                                                                *
   511*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   512*                                                                *
   513*       LENGTH = 1024                                            *
   514*                                                                *
   515******************************************************************
   516 01  PROGRAM-INTERFACE-BLOCK.
   517     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   518     12  PI-CALLING-PROGRAM              PIC X(8).
   519     12  PI-SAVED-PROGRAM-1              PIC X(8).
   520     12  PI-SAVED-PROGRAM-2              PIC X(8).
   521     12  PI-SAVED-PROGRAM-3              PIC X(8).
   522     12  PI-SAVED-PROGRAM-4              PIC X(8).
   523     12  PI-SAVED-PROGRAM-5              PIC X(8).
   524     12  PI-SAVED-PROGRAM-6              PIC X(8).
   525     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   526     12  PI-COMPANY-ID                   PIC XXX.
   527     12  PI-COMPANY-CD                   PIC X.
   528
   529     12  PI-COMPANY-PASSWORD             PIC X(8).
   530
   531     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   532
   533     12  PI-CONTROL-IN-PROGRESS.
   534         16  PI-CARRIER                  PIC X.
   535         16  PI-GROUPING                 PIC X(6).
   536         16  PI-STATE                    PIC XX.
   537         16  PI-ACCOUNT                  PIC X(10).
   538         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   539                                         PIC X(10).
   540         16  PI-CLAIM-CERT-GRP.
   541             20  PI-CLAIM-NO             PIC X(7).
   542             20  PI-CERT-NO.
   543                 25  PI-CERT-PRIME       PIC X(10).
   544                 25  PI-CERT-SFX         PIC X.
   545             20  PI-CERT-EFF-DT          PIC XX.
   546         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   547             20  PI-PLAN-CODE            PIC X(2).
   548             20  PI-REVISION-NUMBER      PIC X(3).
   549             20  PI-PLAN-EFF-DT          PIC X(2).
   550             20  PI-PLAN-EXP-DT          PIC X(2).
   551             20  FILLER                  PIC X(11).
   552         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   553             20  PI-OE-REFERENCE-1.
   554                 25  PI-OE-REF-1-PRIME   PIC X(18).
   555                 25  PI-OE-REF-1-SUFF    PIC XX.
   556
   557     12  PI-SESSION-IN-PROGRESS          PIC X.
   558         88  CLAIM-SESSION                   VALUE '1'.
   559         88  CREDIT-SESSION                  VALUE '2'.
   560         88  WARRANTY-SESSION                VALUE '3'.
   561         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL601.cbl
   562         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   563
   564
   565*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   566
   567     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   568     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   569
   570     12  PI-CREDIT-USER                  PIC X.
   571         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   572         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   573
   574     12  PI-CLAIM-USER                   PIC X.
   575         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   576         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   577
   578     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   579         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   580         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   581         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   582         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   583         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   584
   585     12  PI-PROCESSOR-ID                 PIC X(4).
   586
   587     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   588
   589     12  PI-MEMBER-CAPTION               PIC X(10).
   590
   591     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   592         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   593
   594     12  PI-LIFE-OVERRIDE-L1             PIC X.
   595     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   596     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   597     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   598
   599     12  PI-AH-OVERRIDE-L1               PIC X.
   600     12  PI-AH-OVERRIDE-L2               PIC XX.
   601     12  PI-AH-OVERRIDE-L6               PIC X(6).
   602     12  PI-AH-OVERRIDE-L12              PIC X(12).
   603
   604     12  PI-NEW-SYSTEM                   PIC X(2).
   605
   606     12  PI-PRIMARY-CERT-NO              PIC X(11).
   607     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   608         88  PI-USES-PAID-TO                 VALUE '1'.
   609     12  PI-CRDTCRD-SYSTEM.
   610         16  PI-CRDTCRD-USER             PIC X.
   611             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   612             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   613         16  PI-CC-MONTH-END-DT          PIC XX.
   614     12  PI-PROCESSOR-PRINTER            PIC X(4).
   615
   616     12  PI-OE-REFERENCE-2.
   617         16  PI-OE-REF-2-PRIME           PIC X(10).
   618         16  PI-OE-REF-2-SUFF            PIC X.
   619
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL601.cbl
   620     12  PI-REM-TRM-CALC-OPTION          PIC X.
   621
   622     12  PI-LANGUAGE-TYPE                PIC X.
   623             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   624             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   625             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   626
   627     12  PI-POLICY-LINKAGE-IND           PIC X.
   628         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   629         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   630                                                   LOW-VALUES.
   631
   632     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   633     12  PI-CLAIM-PW-SESSION             PIC X(1).
   634         88  PI-CLAIM-CREDIT                 VALUE '1'.
   635         88  PI-CLAIM-CONVEN                 VALUE '2'.
   636     12  FILLER                          PIC X(4).
   637
   638     12  PI-SYSTEM-LEVEL                 PIC X(145).
   639
   640     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   641         PI-SYSTEM-LEVEL.
   642
   643         16  PI-ENTRY-CODES.
   644             20  PI-ENTRY-CD-1           PIC X.
   645             20  PI-ENTRY-CD-2           PIC X.
   646
   647         16  PI-RETURN-CODES.
   648             20  PI-RETURN-CD-1          PIC X.
   649             20  PI-RETURN-CD-2          PIC X.
   650
   651         16  PI-UPDATE-STATUS-SAVE.
   652             20  PI-UPDATE-BY            PIC X(4).
   653             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   654
   655         16  PI-LOWER-CASE-LETTERS       PIC X.
   656             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   657
   658*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   659*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   660*            88  CARRIER-CLM-CNTL            VALUE '2'.
   661
   662         16  PI-CERT-ACCESS-CONTROL      PIC X.
   663             88  ST-ACCNT-CNTL               VALUE ' '.
   664             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   665             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   666             88  ACCNT-CNTL                  VALUE '3'.
   667             88  CARR-ACCNT-CNTL             VALUE '4'.
   668
   669         16  PI-PROCESSOR-CAP-LIST.
   670             20  PI-SYSTEM-CONTROLS.
   671                24 PI-SYSTEM-DISPLAY     PIC X.
   672                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   673                24 PI-SYSTEM-MODIFY      PIC X.
   674                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   675             20  FILLER                  PIC XX.
   676             20  PI-DISPLAY-CAP          PIC X.
   677                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL601.cbl
   678             20  PI-MODIFY-CAP           PIC X.
   679                 88  MODIFY-CAP              VALUE 'Y'.
   680             20  PI-MSG-AT-LOGON-CAP     PIC X.
   681                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   682             20  PI-FORCE-CAP            PIC X.
   683                 88  FORCE-CAP               VALUE 'Y'.
   684
   685         16  PI-PROGRAM-CONTROLS.
   686             20  PI-PGM-PRINT-OPT        PIC X.
   687             20  PI-PGM-FORMAT-OPT       PIC X.
   688             20  PI-PGM-PROCESS-OPT      PIC X.
   689             20  PI-PGM-TOTALS-OPT       PIC X.
   690
   691         16  PI-HELP-INTERFACE.
   692             20  PI-LAST-ERROR-NO        PIC X(4).
   693             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   694
   695         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   696             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   697
   698         16  PI-CR-CONTROL-IN-PROGRESS.
   699             20  PI-CR-CARRIER           PIC X.
   700             20  PI-CR-GROUPING          PIC X(6).
   701             20  PI-CR-STATE             PIC XX.
   702             20  PI-CR-ACCOUNT           PIC X(10).
   703             20  PI-CR-FIN-RESP          PIC X(10).
   704             20  PI-CR-TYPE              PIC X.
   705
   706         16  PI-CR-BATCH-NUMBER          PIC X(6).
   707
   708         16  PI-CR-MONTH-END-DT          PIC XX.
   709
   710         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   711             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   712             88  PI-ZERO-CARRIER             VALUE '1'.
   713             88  PI-ZERO-GROUPING            VALUE '2'.
   714             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   715
   716         16  PI-CARRIER-SECURITY         PIC X.
   717             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   718
   719         16  PI-ACCOUNT-SECURITY         PIC X(10).
   720             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   721             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   722
   723         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   724             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   725                                         INDEXED BY PI-ACCESS-NDX
   726                                         PIC X.
   727
   728         16  PI-GA-BILLING-CONTROL       PIC X.
   729             88  PI-GA-BILLING               VALUE '1'.
   730
   731         16  PI-MAIL-PROCESSING          PIC X.
   732             88  PI-MAIL-YES                 VALUE 'Y'.
   733
   734         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   735
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL601.cbl
   736         16  PI-AR-SYSTEM.
   737             20  PI-AR-PROCESSING-CNTL   PIC X.
   738                 88  PI-AR-PROCESSING        VALUE 'Y'.
   739             20  PI-AR-SUMMARY-CODE      PIC X(6).
   740             20  PI-AR-MONTH-END-DT      PIC XX.
   741
   742         16  PI-MP-SYSTEM.
   743             20  PI-MORTGAGE-USER            PIC X.
   744                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   745                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   746             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   747                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   748                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   749                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   750                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   751                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   752             20  PI-MP-MONTH-END-DT          PIC XX.
   753             20  PI-MP-REFERENCE-NO.
   754                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   755                 24  PI-MP-REFERENCE-SFX     PIC XX.
   756
   757         16  PI-LABEL-CONTROL            PIC X(01).
   758             88  PI-CREATE-LABELS                    VALUE 'Y'.
   759             88  PI-BYPASS-LABELS                    VALUE 'N'.
   760
   761         16  PI-BILL-GROUPING-CODE       PIC X(01).
   762             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   763
   764         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   765             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   766             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   767
   768         16  FILLER                      PIC X(14).
   769
   770     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   771******************************************************************
   772     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   773         16  PI-FILE-ID                    PIC XX.
   774         16  FILLER                        PIC X(638).
   775
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL601.cbl
   777*                            COPY ELCAID.
   778******************************************************************
   779*                                                                *
   780*                            ELCAID.                             *
   781*                            VMOD=2.001                          *
   782*                                                                *
   783*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   784*                                                                *
   785*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   786*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   787******************************************************************
   788
   789 01  DFHAID.
   790   02  DFHNULL   PIC  X  VALUE  ' '.
   791   02  DFHENTER  PIC  X  VALUE  QUOTE.
   792   02  DFHCLEAR  PIC  X  VALUE  '_'.
   793   02  DFHPEN    PIC  X  VALUE  '='.
   794   02  DFHOPID   PIC  X  VALUE  'W'.
   795   02  DFHPA1    PIC  X  VALUE  '%'.
   796   02  DFHPA2    PIC  X  VALUE  '>'.
   797   02  DFHPA3    PIC  X  VALUE  ','.
   798   02  DFHPF1    PIC  X  VALUE  '1'.
   799   02  DFHPF2    PIC  X  VALUE  '2'.
   800   02  DFHPF3    PIC  X  VALUE  '3'.
   801   02  DFHPF4    PIC  X  VALUE  '4'.
   802   02  DFHPF5    PIC  X  VALUE  '5'.
   803   02  DFHPF6    PIC  X  VALUE  '6'.
   804   02  DFHPF7    PIC  X  VALUE  '7'.
   805   02  DFHPF8    PIC  X  VALUE  '8'.
   806   02  DFHPF9    PIC  X  VALUE  '9'.
   807   02  DFHPF10   PIC  X  VALUE  ':'.
   808   02  DFHPF11   PIC  X  VALUE  '#'.
   809   02  DFHPF12   PIC  X  VALUE  '@'.
   810   02  DFHPF13   PIC  X  VALUE  'A'.
   811   02  DFHPF14   PIC  X  VALUE  'B'.
   812   02  DFHPF15   PIC  X  VALUE  'C'.
   813   02  DFHPF16   PIC  X  VALUE  'D'.
   814   02  DFHPF17   PIC  X  VALUE  'E'.
   815   02  DFHPF18   PIC  X  VALUE  'F'.
   816   02  DFHPF19   PIC  X  VALUE  'G'.
   817   02  DFHPF20   PIC  X  VALUE  'H'.
   818   02  DFHPF21   PIC  X  VALUE  'I'.
   819*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   820   02  DFHPF22   PIC  X  VALUE  '['.
   821   02  DFHPF23   PIC  X  VALUE  '.'.
   822   02  DFHPF24   PIC  X  VALUE  '<'.
   823   02  DFHMSRE   PIC  X  VALUE  'X'.
   824   02  DFHSTRF   PIC  X  VALUE  'h'.
   825   02  DFHTRIG   PIC  X  VALUE  '"'.
   826 01  FILLER    REDEFINES DFHAID.
   827     12  FILLER              PIC X(8).
   828     12  PF-VALUES           PIC X       OCCURS 2.
   829
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL601.cbl
   831*                            COPY EL601S.
   832 01  EL601AI.
   833     05  FILLER            PIC  X(0012).
   834*    -------------------------------
   835     05  DATEL PIC S9(0004) COMP.
   836     05  DATEF PIC  X(0001).
   837     05  FILLER REDEFINES DATEF.
   838         10  DATEA PIC  X(0001).
   839     05  DATEI PIC  X(0008).
   840*    -------------------------------
   841     05  TIMEL PIC S9(0004) COMP.
   842     05  TIMEF PIC  X(0001).
   843     05  FILLER REDEFINES TIMEF.
   844         10  TIMEA PIC  X(0001).
   845     05  TIMEI PIC  X(0005).
   846*    -------------------------------
   847     05  ITEM10L PIC S9(0004) COMP.
   848     05  ITEM10F PIC  X(0001).
   849     05  FILLER REDEFINES ITEM10F.
   850         10  ITEM10A PIC  X(0001).
   851     05  ITEM10I PIC  X(0032).
   852*    -------------------------------
   853     05  ITEM11L PIC S9(0004) COMP.
   854     05  ITEM11F PIC  X(0001).
   855     05  FILLER REDEFINES ITEM11F.
   856         10  ITEM11A PIC  X(0001).
   857     05  ITEM11I PIC  X(0032).
   858*    -------------------------------
   859     05  ITEM13L PIC S9(0004) COMP.
   860     05  ITEM13F PIC  X(0001).
   861     05  FILLER REDEFINES ITEM13F.
   862         10  ITEM13A PIC  X(0001).
   863     05  ITEM13I PIC  X(0032).
   864*    -------------------------------
   865     05  ITEM14L PIC S9(0004) COMP.
   866     05  ITEM14F PIC  X(0001).
   867     05  FILLER REDEFINES ITEM14F.
   868         10  ITEM14A PIC  X(0001).
   869     05  ITEM14I PIC  X(0029).
   870*    -------------------------------
   871     05  ITEM15L PIC S9(0004) COMP.
   872     05  ITEM15F PIC  X(0001).
   873     05  FILLER REDEFINES ITEM15F.
   874         10  ITEM15A PIC  X(0001).
   875     05  ITEM15I PIC  X(0038).
   876*    -------------------------------
   877     05  ITEM16L PIC S9(0004) COMP.
   878     05  ITEM16F PIC  X(0001).
   879     05  FILLER REDEFINES ITEM16F.
   880         10  ITEM16A PIC  X(0001).
   881     05  ITEM16I PIC  X(0037).
   882*    -------------------------------
   883     05  ITEM17L PIC S9(0004) COMP.
   884     05  ITEM17F PIC  X(0001).
   885     05  FILLER REDEFINES ITEM17F.
   886         10  ITEM17A PIC  X(0001).
   887     05  ITEM17I PIC  X(0037).
   888*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL601.cbl
   889     05  ITEM18L PIC S9(0004) COMP.
   890     05  ITEM18F PIC  X(0001).
   891     05  FILLER REDEFINES ITEM18F.
   892         10  ITEM18A PIC  X(0001).
   893     05  ITEM18I PIC  X(0037).
   894*    -------------------------------
   895     05  ERRMSGL PIC S9(0004) COMP.
   896     05  ERRMSGF PIC  X(0001).
   897     05  FILLER REDEFINES ERRMSGF.
   898         10  ERRMSGA PIC  X(0001).
   899     05  ERRMSGI PIC  X(0079).
   900*    -------------------------------
   901     05  SELECTL PIC S9(0004) COMP.
   902     05  SELECTF PIC  X(0001).
   903     05  FILLER REDEFINES SELECTF.
   904         10  SELECTA PIC  X(0001).
   905     05  SELECTI PIC  X(0002).
   906*    -------------------------------
   907     05  PROGL PIC S9(0004) COMP.
   908     05  PROGF PIC  X(0001).
   909     05  FILLER REDEFINES PROGF.
   910         10  PROGA PIC  X(0001).
   911     05  PROGI PIC  X(0008).
   912*    -------------------------------
   913     05  PFKEYL PIC S9(0004) COMP.
   914     05  PFKEYF PIC  X(0001).
   915     05  FILLER REDEFINES PFKEYF.
   916         10  PFKEYA PIC  X(0001).
   917     05  PFKEYI PIC  X(0002).
   918 01  EL601AO REDEFINES EL601AI.
   919     05  FILLER            PIC  X(0012).
   920*    -------------------------------
   921     05  FILLER            PIC  X(0003).
   922     05  DATEO PIC  X(0008).
   923*    -------------------------------
   924     05  FILLER            PIC  X(0003).
   925     05  TIMEO PIC  99.99.
   926*    -------------------------------
   927     05  FILLER            PIC  X(0003).
   928     05  ITEM10O PIC  X(0032).
   929*    -------------------------------
   930     05  FILLER            PIC  X(0003).
   931     05  ITEM11O PIC  X(0032).
   932*    -------------------------------
   933     05  FILLER            PIC  X(0003).
   934     05  ITEM13O PIC  X(0032).
   935*    -------------------------------
   936     05  FILLER            PIC  X(0003).
   937     05  ITEM14O PIC  X(0029).
   938*    -------------------------------
   939     05  FILLER            PIC  X(0003).
   940     05  ITEM15O PIC  X(0038).
   941*    -------------------------------
   942     05  FILLER            PIC  X(0003).
   943     05  ITEM16O PIC  X(0037).
   944*    -------------------------------
   945     05  FILLER            PIC  X(0003).
   946     05  ITEM17O PIC  X(0037).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL601.cbl
   947*    -------------------------------
   948     05  FILLER            PIC  X(0003).
   949     05  ITEM18O PIC  X(0037).
   950*    -------------------------------
   951     05  FILLER            PIC  X(0003).
   952     05  ERRMSGO PIC  X(0079).
   953*    -------------------------------
   954     05  FILLER            PIC  X(0003).
   955     05  SELECTO PIC  X(0002).
   956*    -------------------------------
   957     05  FILLER            PIC  X(0003).
   958     05  PROGO PIC  X(0008).
   959*    -------------------------------
   960     05  FILLER            PIC  X(0003).
   961     05  PFKEYO PIC  X(0002).
   962*    -------------------------------
   963
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL601.cbl
   965****************************************************************
   966*
   967* Copyright (c) 2007 by Clerity Solutions, Inc.
   968* All rights reserved.
   969*
   970****************************************************************
   971 01  DFHEIV.
   972   02  DFHEIV0               PIC X(35).
   973   02  DFHEIV1               PIC X(08).
   974   02  DFHEIV2               PIC X(08).
   975   02  DFHEIV3               PIC X(08).
   976   02  DFHEIV4               PIC X(06).
   977   02  DFHEIV5               PIC X(04).
   978   02  DFHEIV6               PIC X(04).
   979   02  DFHEIV7               PIC X(02).
   980   02  DFHEIV8               PIC X(02).
   981   02  DFHEIV9               PIC X(01).
   982   02  DFHEIV10              PIC S9(7) COMP-3.
   983   02  DFHEIV11              PIC S9(4) COMP SYNC.
   984   02  DFHEIV12              PIC S9(4) COMP SYNC.
   985   02  DFHEIV13              PIC S9(4) COMP SYNC.
   986   02  DFHEIV14              PIC S9(4) COMP SYNC.
   987   02  DFHEIV15              PIC S9(4) COMP SYNC.
   988   02  DFHEIV16              PIC S9(9) COMP SYNC.
   989   02  DFHEIV17              PIC X(04).
   990   02  DFHEIV18              PIC X(04).
   991   02  DFHEIV19              PIC X(04).
   992   02  DFHEIV20              USAGE IS POINTER.
   993   02  DFHEIV21              USAGE IS POINTER.
   994   02  DFHEIV22              USAGE IS POINTER.
   995   02  DFHEIV23              USAGE IS POINTER.
   996   02  DFHEIV24              USAGE IS POINTER.
   997   02  DFHEIV25              PIC S9(9) COMP SYNC.
   998   02  DFHEIV26              PIC S9(9) COMP SYNC.
   999   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1000   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1001   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1002   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1003   02  FILLER                PIC X(02).
  1004   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1005   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1006   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1007   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1008   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1009 LINKAGE  SECTION.
  1010*****************************************************************
  1011*                                                               *
  1012* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1013* All rights reserved.                                          *
  1014*                                                               *
  1015*****************************************************************
  1016 01  dfheiblk.
  1017     02  eibtime          pic s9(7) comp-3.
  1018     02  eibdate          pic s9(7) comp-3.
  1019     02  eibtrnid         pic x(4).
  1020     02  eibtaskn         pic s9(7) comp-3.
  1021     02  eibtrmid         pic x(4).
  1022     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL601.cbl
  1023     02  eibcposn         pic s9(4) comp.
  1024     02  eibcalen         pic s9(4) comp.
  1025     02  eibaid           pic x(1).
  1026     02  eibfiller1       pic x(1).
  1027     02  eibfn            pic x(2).
  1028     02  eibfiller2       pic x(2).
  1029     02  eibrcode         pic x(6).
  1030     02  eibfiller3       pic x(2).
  1031     02  eibds            pic x(8).
  1032     02  eibreqid         pic x(8).
  1033     02  eibrsrce         pic x(8).
  1034     02  eibsync          pic x(1).
  1035     02  eibfree          pic x(1).
  1036     02  eibrecv          pic x(1).
  1037     02  eibsend          pic x(1).
  1038     02  eibatt           pic x(1).
  1039     02  eibeoc           pic x(1).
  1040     02  eibfmh           pic x(1).
  1041     02  eibcompl         pic x(1).
  1042     02  eibsig           pic x(1).
  1043     02  eibconf          pic x(1).
  1044     02  eiberr           pic x(1).
  1045     02  eibrldbk         pic x(1).
  1046     02  eiberrcd         pic x(4).
  1047     02  eibsynrb         pic x(1).
  1048     02  eibnodat         pic x(1).
  1049     02  eibfiller5       pic x(2).
  1050     02  eibresp          pic 9(09) comp.
  1051     02  eibresp2         pic 9(09) comp.
  1052     02  dfheigdj         pic s9(4) comp.
  1053     02  dfheigdk         pic s9(4) comp.
  1054 01  DFHCOMMAREA             PIC X(1024).
  1055
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL601.cbl
  1057 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1058 0000-DFHEXIT SECTION.
  1059     MOVE '9#                    $   ' TO DFHEIV0.
  1060     MOVE 'EL601' TO DFHEIV1.
  1061     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1062
  1063     MOVE DFHCOMMAREA   TO PROGRAM-INTERFACE-BLOCK.
  1064
  1065     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1066     MOVE '5'                    TO DC-OPTION-CODE.
  1067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1068     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1069     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1070
  1071     IF EIBCALEN = 0
  1072         GO TO 8800-UNAUTHORIZED-ACCESS.
  1073
  1074     IF PI-CALLING-PROGRAM NOT = PGM-EL601
  1075         IF PI-RETURN-TO-PROGRAM NOT = PGM-EL601
  1076             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6
  1077             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5
  1078             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4
  1079             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3
  1080             MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2
  1081             MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1
  1082             MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM
  1083             MOVE PGM-EL601              TO PI-CALLING-PROGRAM
  1084         ELSE
  1085             MOVE PI-RETURN-TO-PROGRAM   TO PI-CALLING-PROGRAM
  1086             MOVE PI-SAVED-PROGRAM-1     TO PI-RETURN-TO-PROGRAM
  1087             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-1
  1088             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-2
  1089             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-3
  1090             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-4
  1091             MOVE PI-SAVED-PROGRAM-6     TO PI-SAVED-PROGRAM-5
  1092             MOVE SPACES                 TO PI-SAVED-PROGRAM-6.
  1093
  1094
  1095* EXEC CICS HANDLE CONDITION
  1096*        PGMIDERR  (9600-PGMID-ERROR)
  1097*        ERROR     (9990-ABEND)
  1098*    END-EXEC.
  1099*    MOVE '"$L.                  ! " #00001090' TO DFHEIV0
  1100     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1102     MOVE X'2220233030303031303930' TO DFHEIV0(25:11)
  1103     CALL 'kxdfhei1' USING DFHEIV0
  1104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1105
  1106
  1107     IF EIBTRNID  = TRANS-EXA1
  1108         GO TO 0100-SAME-TRAN.
  1109
  1110     GO TO 8100-SEND-INITIAL-MAP.
  1111
  1112 0100-SAME-TRAN.
  1113     IF EIBAID = DFHCLEAR
  1114         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL601.cbl
  1115
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL601.cbl
  1117 0200-RECEIVE.
  1118     MOVE LOW-VALUES   TO EL601AI.
  1119
  1120     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1121         MOVE -1                 TO SELECTL
  1122         MOVE ER-7008         TO EMI-ERROR
  1123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1124         GO TO 8200-SEND-DATAONLY.
  1125
  1126
  1127* EXEC CICS RECEIVE
  1128*        MAP      (MAP-EL601A)
  1129*        MAPSET   (MAPSET-EL601S)
  1130*        INTO     (EL601AI)
  1131*    END-EXEC.
  1132     MOVE LENGTH OF
  1133      EL601AI
  1134       TO DFHEIV11
  1135*    MOVE '8"T I  L              ''   #00001114' TO DFHEIV0
  1136     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1138     MOVE X'2020233030303031313134' TO DFHEIV0(25:11)
  1139     CALL 'kxdfhei1' USING DFHEIV0,
  1140           MAP-EL601A,
  1141           EL601AI,
  1142           DFHEIV11,
  1143           MAPSET-EL601S,
  1144           DFHEIV99,
  1145           DFHEIV99
  1146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1147
  1148
  1149     MOVE SPACES                 TO PI-ENTRY-CD-1.
  1150
  1151     IF EIBAID = DFHPF12
  1152        GO TO 9500-HELP
  1153     ELSE
  1154        IF EIBAID = DFHPF23
  1155           GO TO 8810-PF23
  1156        ELSE
  1157           IF EIBAID = DFHPF24
  1158              GO TO 9200-PF24.
  1159
  1160     IF PFKEYL = ZEROS
  1161         NEXT SENTENCE
  1162     ELSE
  1163         IF PFKEYI = '12'
  1164            GO TO 9500-HELP
  1165         ELSE
  1166            IF PFKEYI = '23'
  1167               GO TO 8810-PF23
  1168            ELSE
  1169               IF PFKEYI = '24'
  1170                  GO TO 9200-PF24.
  1171
  1172     IF EIBAID NOT = DFHENTER
  1173         MOVE ER-0002         TO EMI-ERROR
  1174         GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL601.cbl
  1175
  1176     IF SELECTL = 0
  1177         MOVE ER-0002         TO EMI-ERROR
  1178         GO TO 0320-INPUT-ERROR.
  1179
  1180 0310-CHECK-PFKEYS.
  1181     IF SELECTI = '01'
  1182         MOVE XCTL-EL650 TO PGM-NAME
  1183         GO TO 9300-XCTL.
  1184
  1185     IF SELECTI = '02'
  1186         MOVE XCTL-EL652 TO PGM-NAME
  1187         GO TO 9300-XCTL.
  1188
  1189     IF SELECTI = '03'
  1190         MOVE XCTL-EL656 TO PGM-NAME
  1191         GO TO 9300-XCTL.
  1192
  1193     IF SELECTI = '04'
  1194         MOVE XCTL-EL651 TO PGM-NAME
  1195         GO TO 9300-XCTL.
  1196
  1197     IF SELECTI = '05'
  1198         MOVE XCTL-EL653 TO PGM-NAME
  1199         GO TO 9300-XCTL.
  1200
  1201     IF SELECTI = '06'
  1202         MOVE XCTL-EL658 TO PGM-NAME
  1203         GO TO 9300-XCTL.
  1204
  1205     IF SELECTI = '07'
  1206         MOVE XCTL-EL610 TO PGM-NAME
  1207         GO TO 9300-XCTL.
  1208
  1209     IF SELECTI = '08'
  1210         MOVE XCTL-EL659 TO PGM-NAME
  1211         GO TO 9300-XCTL.
  1212
  1213     IF SELECTI = '09'
  1214         MOVE XCTL-EL158 TO PGM-NAME
  1215         GO TO 9300-XCTL.
  1216
  1217     IF SELECTI = '10'
  1218         IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1219             MOVE XCTL-EL605 TO PGM-NAME
  1220             GO TO 9300-XCTL.
  1221
  1222     IF SELECTI = '11'
  1223         IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1224            MOVE XCTL-EL607 TO PGM-NAME
  1225            GO TO 9300-XCTL.
  1226
  1227     IF SELECTI = '12'
  1228       IF PI-AR-PROCESSING
  1229          MOVE XCTL-EL611 TO PGM-NAME
  1230          GO TO 9300-XCTL
  1231       ELSE
  1232          MOVE ER-7448   TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL601.cbl
  1233          GO TO 0320-INPUT-ERROR.
  1234
  1235     IF SELECTI = '13'
  1236        IF PI-COMPANY-ID = 'CID'
  1237           MOVE XCTL-EL605       TO PGM-NAME
  1238           GO TO 9300-XCTL
  1239        END-IF
  1240     END-IF
  1241
  1242     IF SELECTI = '13'
  1243         IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1244             MOVE XCTL-EL606 TO PGM-NAME
  1245             GO TO 9300-XCTL.
  1246
  1247     IF SELECTI = '14'
  1248         IF PI-COMPANY-ID  =  'DMD'
  1249             MOVE XCTL-EL1062 TO PGM-NAME
  1250             GO TO 9300-XCTL.
  1251
  1252     IF SELECTI = '15'
  1253         IF PI-COMPANY-ID  =  'DMD'
  1254             MOVE XCTL-EL608 TO PGM-NAME
  1255             GO TO 9300-XCTL.
  1256
  1257     IF SELECTI = '16'
  1258         IF PI-COMPANY-ID  =  'DMD'
  1259             MOVE XCTL-EL1064 TO PGM-NAME
  1260             GO TO 9300-XCTL.
  1261
  1262*    IF SELECTI = '17'
  1263*        IF PI-COMPANY-ID  =  'DMD'
  1264*            MOVE XCTL-ELXXXX TO PGM-NAME (CODES TABLE MAINT)
  1265*            GO TO 9300-XCTL.
  1266*
  1267*CODE ABOVE COMMENTED OUT PENDING SPECS APPROVAL
  1268*
  1269
  1270     IF SELECTI = '18'
  1271         IF PI-COMPANY-ID  =  'NCB'
  1272             MOVE XCTL-EL400 TO PGM-NAME
  1273             GO TO 9300-XCTL.
  1274
  1275     IF SELECTI = '21'
  1276         MOVE XCTL-EL102 TO PGM-NAME
  1277         GO TO 9300-XCTL.
  1278
  1279     IF SELECTI = '22'
  1280         MOVE XCTL-EL105 TO PGM-NAME
  1281         GO TO 9300-XCTL.
  1282
  1283     IF SELECTI = '23'
  1284       IF PI-AR-PROCESSING
  1285          MOVE XCTL-EL613 TO PGM-NAME
  1286          GO TO 9300-XCTL
  1287       ELSE
  1288          MOVE ER-7448   TO EMI-ERROR
  1289          GO TO 0320-INPUT-ERROR.
  1290
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL601.cbl
  1291     IF SELECTI = '24'
  1292         MOVE XCTL-EL106 TO PGM-NAME
  1293         GO TO 9300-XCTL.
  1294
  1295     IF SELECTI = '26'
  1296         MOVE XCTL-EL107 TO PGM-NAME
  1297         GO TO 9300-XCTL.
  1298
  1299     IF SELECTI = '27'
  1300         MOVE XCTL-EL604 TO PGM-NAME
  1301         GO TO 9300-XCTL.
  1302
  1303     IF SELECTI = '28'
  1304         MOVE XCTL-EL602 TO PGM-NAME
  1305         GO TO 9300-XCTL.
  1306
  1307     IF SELECTI = '29'
  1308         MOVE XCTL-EL603 TO PGM-NAME
  1309         GO TO 9300-XCTL.
  1310
  1311     IF SELECTI = '30'
  1312         MOVE XCTL-EL654 TO PGM-NAME
  1313         GO TO 9300-XCTL.
  1314
  1315     IF SELECTI = '31'
  1316         MOVE XCTL-EL103 TO PGM-NAME
  1317         GO TO 9300-XCTL.
  1318
  1319     IF SELECTI = '32'
  1320         MOVE XCTL-EL119 TO PGM-NAME
  1321         GO TO 9300-XCTL.
  1322
  1323     IF SELECTI = '33'
  1324         MOVE XCTL-EL108 TO PGM-NAME
  1325         GO TO 9300-XCTL.
  1326
  1327     IF SELECTI = '34'
  1328         MOVE XCTL-EL104 TO PGM-NAME
  1329         GO TO 9300-XCTL.
  1330
  1331     IF SELECTI = '35'
  1332         MOVE XCTL-EL110 TO PGM-NAME
  1333         GO TO 9300-XCTL.
  1334
  1335     IF SELECTI = '36'
  1336         MOVE XCTL-EL111 TO PGM-NAME
  1337         GO TO 9300-XCTL.
  1338
  1339     IF SELECTI = '37'
  1340         MOVE XCTL-EL112 TO PGM-NAME
  1341         GO TO 9300-XCTL.
  1342
  1343     MOVE ER-7002                TO EMI-ERROR.
  1344
  1345 0320-INPUT-ERROR.
  1346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1347     MOVE AL-UNBON               TO SELECTA.
  1348     MOVE -1                     TO SELECTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL601.cbl
  1349     GO TO 8200-SEND-DATAONLY.
  1350
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL601.cbl
  1352 8100-SEND-INITIAL-MAP.
  1353     MOVE LOW-VALUES             TO EL601AO.
  1354     MOVE EIBTIME                TO TIME-IN.
  1355     MOVE TIME-OUT               TO TIMEO.
  1356     MOVE SAVE-DATE              TO DATEO.
  1357
  1358     MOVE SCREEN-RESERVE-10      TO ITEM10O.
  1359     MOVE SCREEN-RESERVE-11      TO ITEM11O.
  1360
  1361     MOVE SCREEN-SELECT-12       TO ITEM13O.
  1362
  1363     IF PI-COMPANY-ID  =  'CID'
  1364        MOVE SCREEN-SELECT-13    TO ITEM14O
  1365     END-IF
  1366
  1367     IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1368         MOVE SCREEN-SELECT-10   TO ITEM10O
  1369         MOVE SCREEN-SELECT-11   TO ITEM11O
  1370         MOVE SCREEN-SELECT-13   TO ITEM14O
  1371         MOVE SPACES             TO ITEM15O ITEM16O
  1372                                    ITEM17O ITEM18O.
  1373
  1374     IF PI-COMPANY-ID  =  'DMD'
  1375         MOVE SCREEN-RESERVE-13  TO  ITEM14O
  1376         MOVE SCREEN-SELECT-14   TO  ITEM15O
  1377         MOVE SCREEN-SELECT-15   TO  ITEM16O
  1378         MOVE SCREEN-SELECT-16   TO  ITEM17O
  1379         MOVE SPACES             TO  ITEM18O.
  1380*        MOVE SCREEN-SELECT-17   TO  ITEM17O.
  1381
  1382     IF PI-COMPANY-ID  =  'NCB'
  1383         MOVE SCREEN-RESERVE-13  TO ITEM14O
  1384         MOVE SCREEN-RESERVE-14  TO ITEM15O
  1385         MOVE SCREEN-RESERVE-15  TO ITEM16O
  1386         MOVE SCREEN-RESERVE-16  TO ITEM17O
  1387         MOVE SCREEN-SELECT-18   TO ITEM18O.
  1388
  1389     MOVE -1                     TO SELECTL.
  1390
  1391
  1392* EXEC CICS SEND
  1393*        MAP     (MAP-EL601A)
  1394*        MAPSET  (MAPSET-EL601S)
  1395*        FROM    (EL601AO)
  1396*        ERASE
  1397*        CURSOR
  1398*    END-EXEC.
  1399     MOVE LENGTH OF
  1400      EL601AO
  1401       TO DFHEIV12
  1402     MOVE -1
  1403       TO DFHEIV11
  1404*    MOVE '8$     CT  E    H L F ,   #00001362' TO DFHEIV0
  1405     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1406     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1407     MOVE X'2020233030303031333632' TO DFHEIV0(25:11)
  1408     CALL 'kxdfhei1' USING DFHEIV0,
  1409           MAP-EL601A,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL601.cbl
  1410           EL601AO,
  1411           DFHEIV12,
  1412           MAPSET-EL601S,
  1413           DFHEIV99,
  1414           DFHEIV99,
  1415           DFHEIV99,
  1416           DFHEIV11,
  1417           DFHEIV99,
  1418           DFHEIV99,
  1419           DFHEIV99
  1420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1421
  1422
  1423     GO TO 9100-RETURN-TRAN.
  1424
  1425 8200-SEND-DATAONLY.
  1426     MOVE SAVE-DATE              TO DATEO.
  1427     MOVE EIBTIME                TO TIME-IN.
  1428     MOVE TIME-OUT               TO TIMEO.
  1429     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1430
  1431     MOVE SCREEN-RESERVE-10      TO ITEM10O.
  1432     MOVE SCREEN-RESERVE-11      TO ITEM11O.
  1433
  1434     MOVE SCREEN-SELECT-12       TO ITEM13O.
  1435
  1436     IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1437         MOVE SCREEN-SELECT-10   TO  ITEM10O
  1438         MOVE SCREEN-SELECT-11   TO  ITEM11O
  1439         MOVE SCREEN-SELECT-13   TO  ITEM14O
  1440         MOVE SPACES             TO ITEM15O ITEM16O
  1441                                    ITEM17O ITEM18O.
  1442
  1443     IF PI-COMPANY-ID  =  'DMD'
  1444         MOVE SCREEN-RESERVE-13  TO  ITEM14O
  1445         MOVE SCREEN-SELECT-14   TO  ITEM15O
  1446         MOVE SCREEN-SELECT-15   TO  ITEM16O
  1447         MOVE SCREEN-SELECT-16   TO  ITEM17O
  1448         MOVE SPACES             TO  ITEM18O.
  1449*        MOVE SCREEN-SELECT-17   TO  ITEM17O.
  1450
  1451     IF PI-COMPANY-ID  =  'NCB'
  1452         MOVE SCREEN-RESERVE-13  TO ITEM14O
  1453         MOVE SCREEN-RESERVE-14  TO ITEM15O
  1454         MOVE SCREEN-RESERVE-15  TO ITEM16O
  1455         MOVE SCREEN-RESERVE-16  TO ITEM17O
  1456         MOVE SCREEN-SELECT-18   TO ITEM18O.
  1457
  1458
  1459* EXEC CICS SEND
  1460*        MAP      (MAP-EL601A)
  1461*        MAPSET   (MAPSET-EL601S)
  1462*        FROM     (EL601AO)
  1463*        DATAONLY
  1464*        CURSOR
  1465*    END-EXEC.
  1466     MOVE LENGTH OF
  1467      EL601AO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL601.cbl
  1468       TO DFHEIV12
  1469     MOVE -1
  1470       TO DFHEIV11
  1471*    MOVE '8$D    CT       H L F ,   #00001405' TO DFHEIV0
  1472     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1473     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1474     MOVE X'2020233030303031343035' TO DFHEIV0(25:11)
  1475     CALL 'kxdfhei1' USING DFHEIV0,
  1476           MAP-EL601A,
  1477           EL601AO,
  1478           DFHEIV12,
  1479           MAPSET-EL601S,
  1480           DFHEIV99,
  1481           DFHEIV99,
  1482           DFHEIV99,
  1483           DFHEIV11,
  1484           DFHEIV99,
  1485           DFHEIV99,
  1486           DFHEIV99
  1487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1488
  1489
  1490     GO TO 9100-RETURN-TRAN.
  1491
  1492 8300-SEND-TEXT.
  1493
  1494* EXEC CICS SEND TEXT
  1495*        FROM     (LOGOFF-TEXT)
  1496*        LENGTH   (LOGOFF-LENGTH)
  1497*        ERASE
  1498*        FREEKB
  1499*    END-EXEC.
  1500*    MOVE '8&      T  E F  H   F -   #00001416' TO DFHEIV0
  1501     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1502     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1503     MOVE X'2020233030303031343136' TO DFHEIV0(25:11)
  1504     CALL 'kxdfhei1' USING DFHEIV0,
  1505           LOGOFF-TEXT,
  1506           LOGOFF-LENGTH,
  1507           DFHEIV99,
  1508           DFHEIV99,
  1509           DFHEIV99,
  1510           DFHEIV99,
  1511           DFHEIV99,
  1512           DFHEIV99,
  1513           DFHEIV99,
  1514           DFHEIV99,
  1515           DFHEIV99,
  1516           DFHEIV99
  1517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1518
  1519
  1520
  1521* EXEC CICS RETURN
  1522*    END-EXEC.
  1523*    MOVE '.(                    &   #00001423' TO DFHEIV0
  1524     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL601.cbl
  1526     MOVE X'2020233030303031343233' TO DFHEIV0(25:11)
  1527     CALL 'kxdfhei1' USING DFHEIV0,
  1528           DFHEIV99,
  1529           DFHEIV99,
  1530           DFHEIV99,
  1531           DFHEIV99,
  1532           DFHEIV99
  1533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1534
  1535
  1536 8800-UNAUTHORIZED-ACCESS.
  1537     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1538     GO TO 8300-SEND-TEXT.
  1539
  1540 8810-PF23.
  1541     MOVE DFHPF23                TO PI-ENTRY-CD-1.
  1542     MOVE XCTL-EL005             TO PGM-NAME.
  1543     GO TO 9300-XCTL.
  1544
  1545 9100-RETURN-TRAN.
  1546     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1547     MOVE '601A'                 TO PI-CURRENT-SCREEN-NO.
  1548
  1549
  1550* EXEC CICS RETURN
  1551*        TRANSID   (TRANS-EXA1)
  1552*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1553*        LENGTH    (PI-COMM-LENGTH)
  1554*    END-EXEC.
  1555*    MOVE '.(CT                  &   #00001439' TO DFHEIV0
  1556     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1558     MOVE X'2020233030303031343339' TO DFHEIV0(25:11)
  1559     CALL 'kxdfhei1' USING DFHEIV0,
  1560           TRANS-EXA1,
  1561           PROGRAM-INTERFACE-BLOCK,
  1562           PI-COMM-LENGTH,
  1563           DFHEIV99,
  1564           DFHEIV99
  1565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1566
  1567
  1568 9200-PF24.
  1569     MOVE XCTL-EL626             TO PGM-NAME.
  1570     GO TO 9300-XCTL.
  1571
  1572 9300-XCTL.
  1573     MOVE SPACES                 TO PI-ENTRY-CD-2
  1574                                    PI-RETURN-CODES
  1575                                    PI-UPDATE-BY
  1576                                    PI-PROGRAM-WORK-AREA.
  1577     MOVE ZEROS                  TO PI-UPDATE-HHMMSS.
  1578
  1579
  1580* EXEC CICS XCTL
  1581*        PROGRAM    (PGM-NAME)
  1582*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  1583*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL601.cbl
  1584*    END-EXEC.
  1585*    MOVE '.$C                   $   #00001456' TO DFHEIV0
  1586     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1588     MOVE X'2020233030303031343536' TO DFHEIV0(25:11)
  1589     CALL 'kxdfhei1' USING DFHEIV0,
  1590           PGM-NAME,
  1591           PROGRAM-INTERFACE-BLOCK,
  1592           PI-COMM-LENGTH
  1593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1594
  1595
  1596 9400-CLEAR.
  1597     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  1598     GO TO 9300-XCTL.
  1599
  1600 9500-HELP.
  1601     MOVE XCTL-EL010             TO PGM-NAME.
  1602     GO TO 9300-XCTL.
  1603
  1604 9600-PGMID-ERROR.
  1605     MOVE PGM-NAME               TO PROGO.
  1606     MOVE AL-UNBON               TO SELECTA.
  1607     MOVE ER-7003                TO EMI-ERROR.
  1608
  1609
  1610* EXEC CICS HANDLE CONDITION
  1611*        PGMIDERR  (8300-SEND-TEXT)
  1612*    END-EXEC.
  1613*    MOVE '"$L                   ! # #00001475' TO DFHEIV0
  1614     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1616     MOVE X'2320233030303031343735' TO DFHEIV0(25:11)
  1617     CALL 'kxdfhei1' USING DFHEIV0
  1618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1619
  1620
  1621     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1622     MOVE ' '                    TO PI-ENTRY-CD-1.
  1623     MOVE XCTL-EL005             TO PGM-NAME.
  1624     MOVE PGM-NAME               TO LOGOFF-PGM.
  1625     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1626     GO TO 9300-XCTL.
  1627
  1628 9700-LINK-DATE-CONVERT.
  1629
  1630* EXEC CICS LINK
  1631*        PROGRAM    (LINK-ELDATCV)
  1632*        COMMAREA   (DATE-CONVERSION-DATA)
  1633*        LENGTH     (DC-COMM-LENGTH)
  1634*    END-EXEC.
  1635*    MOVE '."C                   ''   #00001487' TO DFHEIV0
  1636     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1638     MOVE X'2020233030303031343837' TO DFHEIV0(25:11)
  1639     CALL 'kxdfhei1' USING DFHEIV0,
  1640           LINK-ELDATCV,
  1641           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL601.cbl
  1642           DC-COMM-LENGTH,
  1643           DFHEIV99,
  1644           DFHEIV99,
  1645           DFHEIV99
  1646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1647
  1648
  1649 9700-EXIT.
  1650     EXIT.
  1651
  1652 9900-ERROR-FORMAT.
  1653     IF NOT EMI-ERRORS-COMPLETE
  1654         MOVE LINK-EL001         TO PGM-NAME
  1655
  1656* EXEC CICS LINK
  1657*            PROGRAM    (PGM-NAME)
  1658*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  1659*            LENGTH     (EMI-COMM-LENGTH)
  1660*        END-EXEC.
  1661*    MOVE '."C                   ''   #00001499' TO DFHEIV0
  1662     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1664     MOVE X'2020233030303031343939' TO DFHEIV0(25:11)
  1665     CALL 'kxdfhei1' USING DFHEIV0,
  1666           PGM-NAME,
  1667           ERROR-MESSAGE-INTERFACE-BLOCK,
  1668           EMI-COMM-LENGTH,
  1669           DFHEIV99,
  1670           DFHEIV99,
  1671           DFHEIV99
  1672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1673
  1674
  1675 9900-EXIT.
  1676     EXIT.
  1677
  1678 9990-ABEND.
  1679     MOVE LINK-EL004             TO PGM-NAME.
  1680     MOVE DFHEIBLK               TO EMI-LINE1.
  1681
  1682
  1683* EXEC CICS LINK
  1684*        PROGRAM   (PGM-NAME)
  1685*        COMMAREA  (EMI-LINE1)
  1686*        LENGTH    (72)
  1687*    END-EXEC.
  1688     MOVE 72
  1689       TO DFHEIV11
  1690*    MOVE '."C                   ''   #00001512' TO DFHEIV0
  1691     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1693     MOVE X'2020233030303031353132' TO DFHEIV0(25:11)
  1694     CALL 'kxdfhei1' USING DFHEIV0,
  1695           PGM-NAME,
  1696           EMI-LINE1,
  1697           DFHEIV11,
  1698           DFHEIV99,
  1699           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL601.cbl
  1700           DFHEIV99
  1701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1702
  1703
  1704     GO TO 8200-SEND-DATAONLY.
  1705
  1706
  1707 9999-DFHBACK SECTION.
  1708     MOVE '9%                    "   ' TO DFHEIV0
  1709     MOVE 'EL601' TO DFHEIV1
  1710     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1711     GOBACK.
  1712 9999-DFHEXIT.
  1713     IF DFHEIGDJ EQUAL 0001
  1714         NEXT SENTENCE
  1715     ELSE IF DFHEIGDJ EQUAL 2
  1716         GO TO 9600-PGMID-ERROR,
  1717               9990-ABEND
  1718         DEPENDING ON DFHEIGDI
  1719     ELSE IF DFHEIGDJ EQUAL 3
  1720         GO TO 8300-SEND-TEXT
  1721         DEPENDING ON DFHEIGDI.
  1722     MOVE '9%                    "   ' TO DFHEIV0
  1723     MOVE 'EL601' TO DFHEIV1
  1724     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1725     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        4364     Code:        4198
