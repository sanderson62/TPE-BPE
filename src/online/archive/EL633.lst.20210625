* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58* 021716  CR2016021000003  PEMA  ADD NEW G/L FOR MACHENS ACCTS
    59* 111016  CR2016110900002  TANA  REPLACE GL NUMBERS FOR CCC
    60* 060817  CR2017060700005  PEMA  ADD NEW G/L FOR VPP
    61******************************************************************
    62
    63 ENVIRONMENT DIVISION.
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   3
* EL633.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68 77  FILLER  PIC X(32)  VALUE '********************************'.
    69 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    70 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    71
    72*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    73*77  SV-COFA PIC X(42)  VALUE SPACES.
    74*77  K-SPACE PIC X(11)  VALUE SPACES.
    75
    76 01  DATE-WORK-AREAS.
    77     05  WS-GREG-STORE.
    78         10  WS-GS-MM  PIC XX.
    79         10  FILLER    PIC X.
    80         10  WS-GS-DD  PIC XX.
    81         10  FILLER    PIC X.
    82         10  WS-GS-YY  PIC XX.
    83     05  WS-SDTE-STORE.
    84         10  WS-SS-MM  PIC XX.
    85         10  WS-SS-DD  PIC XX.
    86         10  WS-SS-YY  PIC XX.
    87*                            COPY ELCSCTM.
    88******************************************************************
    89*                                                                *
    90*                                                                *
    91*                            ELCSCTM                             *
    92*                            VMOD=2.001                          *
    93*                                                                *
    94*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-MESSAGE.
    98     12  FILLER                          PIC X(30)
    99            VALUE '** LOGIC SECURITY VIOLATION -'.
   100     12  SM-READ                         PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' PGM='.
   103     12  SM-PGM                          PIC X(6).
   104     12  FILLER                          PIC X(5)
   105            VALUE ' OPR='.
   106     12  SM-PROCESSOR-ID                 PIC X(4).
   107     12  FILLER                          PIC X(6)
   108            VALUE ' TERM='.
   109     12  SM-TERMID                       PIC X(4).
   110     12  FILLER                          PIC XX   VALUE SPACE.
   111     12  SM-JUL-DATE                     PIC 9(5).
   112     12  FILLER                          PIC X    VALUE SPACE.
   113     12  SM-TIME                         PIC 99.99.
   114
   115*                            COPY ELCSCRTY.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCRTY                            *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   123*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   4
* EL633.cbl
   124*        SAVED IN PI-SECURITY-ADDRESS.                           *
   125*                                                                *
   126******************************************************************
   127 01  SECURITY-CONTROL.
   128     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   129     12  FILLER                       PIC XX    VALUE 'SC'.
   130     12  SC-CREDIT-CODES.
   131         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   132             20  SC-CREDIT-DISPLAY    PIC X.
   133             20  SC-CREDIT-UPDATE     PIC X.
   134     12  SC-CLAIMS-CODES.
   135         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   136             20  SC-CLAIMS-DISPLAY    PIC X.
   137             20  SC-CLAIMS-UPDATE     PIC X.
   138
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   5
* EL633.cbl
   140
   141 01  STANDARD-AREAS.
   142     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   143     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   144     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   145     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   146     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   147     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   148     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   149     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   150     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   151     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   152     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   153     12  PGM-NAME            PIC  X(8).
   154     12  TIME-IN             PIC S9(7).
   155     12  TIME-OUT-R  REDEFINES  TIME-IN.
   156         16  FILLER          PIC  X.
   157         16  TIME-OUT        PIC  99V99.
   158         16  FILLER          PIC  X(2).
   159     12  EL640               PIC  X(8)       VALUE 'EL640'.
   160     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   161     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   162     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   163     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   164     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   165     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   166     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   167     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   168     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   169     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   170     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   171     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   172     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   173     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   174     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   175     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   176     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   177         88  PYAJ-1ST-READ                   VALUE 'Y'.
   178     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   179         88  FIRST-ADD                       VALUE 'Y'.
   180     12  ZERO-NDX            PIC  9          VALUE ZERO.
   181     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   182     12  WORK-SEQ-TIME       PIC  9(6).
   183     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   184         16  WORK-SEQ-HHMMS  PIC  9(5).
   185         16  FILLER          PIC  9.
   186     12  WORK-DATE-JULIAN.
   187         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   188         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   189     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   190     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   191         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   192                                                    'S' 'T' 'U'
   193                                                    'X' 'Y' 'Z'
   194                                                    'F'.
   195     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   196         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   197     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   6
* EL633.cbl
   198         88  FORCE-SHOW                      VALUE  'Y'.
   199
   200     12  WS-EOM-DTS OCCURS 13  TIMES
   201                              INDEXED BY PINDEX.
   202         16  WS-EOM-DT               PIC XX.
   203*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   204
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   7
* EL633.cbl
   206     12  WS-ERROR-CODES.
   207         16  ER-0000         PIC  X(4)       VALUE '0000'.
   208         16  ER-0008         PIC  X(4)       VALUE '0008'.
   209         16  ER-0023         PIC  X(4)       VALUE '0023'.
   210         16  ER-0029         PIC  X(4)       VALUE '0029'.
   211         16  ER-0070         PIC  X(4)       VALUE '0070'.
   212         16  ER-0587         PIC  X(4)       VALUE '0587'.
   213         16  ER-2056         PIC  X(4)       VALUE '2056'.
   214         16  ER-2230         PIC  X(4)       VALUE '2230'.
   215         16  ER-2231         PIC  X(4)       VALUE '2231'.
   216         16  ER-2232         PIC  X(4)       VALUE '2232'.
   217         16  ER-2233         PIC  X(4)       VALUE '2233'.
   218         16  ER-2234         PIC  X(4)       VALUE '2234'.
   219         16  ER-2235         PIC  X(4)       VALUE '2235'.
   220         16  ER-2236         PIC  X(4)       VALUE '2236'.
   221         16  ER-2237         PIC  X(4)       VALUE '2237'.
   222         16  ER-2238         PIC  X(4)       VALUE '2238'.
   223         16  ER-2239         PIC  X(4)       VALUE '2239'.
   224         16  ER-2244         PIC  X(4)       VALUE '2244'.
   225         16  ER-2245         PIC  X(4)       VALUE '2245'.
   226         16  ER-2246         PIC  X(4)       VALUE '2246'.
   227         16  ER-2370         PIC  X(4)       VALUE '2370'.
   228         16  ER-2432         PIC  X(4)       VALUE '2432'.
   229         16  ER-2449         PIC  X(4)       VALUE '2449'.
   230         16  ER-2587         PIC  X(4)       VALUE '2587'.
   231         16  ER-2588         PIC  X(4)       VALUE '2588'.
   232         16  ER-2595         PIC  X(4)       VALUE '2595'.
   233         16  ER-2596         PIC  X(4)       VALUE '2596'.
   234         16  ER-2763         PIC  X(4)       VALUE '2763'.
   235         16  ER-2929         PIC  X(4)       VALUE '2929'.
   236         16  ER-2957         PIC  X(4)       VALUE '2957'.
   237         16  ER-2958         PIC  X(4)       VALUE '2958'.
   238*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   239         16  ER-2960         PIC  X(4)       VALUE '2960'.
   240         16  ER-3020         PIC  X(4)       VALUE '3020'.
   241
   242*************************************************************
   243*                      TABLE OF STATE NAMES
   244*************************************************************
   245
   246 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   247     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   248                                   'CD' 'CO' 'CT' 'DC' 'DE'
   249                                   'FL' 'GA' 'GM' 'HI' 'IA'
   250                                   'ID' 'IL' 'IN' 'KS' 'KY'
   251                                   'LA' 'MA' 'MD' 'ME' 'MI'
   252                                   'MN' 'MO' 'MS' 'MT' 'MX'
   253                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   254                                   'NM' 'NV' 'NY' 'OF' 'OH'
   255                                   'OK' 'OR' 'PA' 'PI' 'PR'
   256                                   'RI' 'SC' 'SD' 'TN' 'TX'
   257                                   'UT' 'VA' 'VI' 'VT' 'WA'
   258                                   'WI' 'WV' 'WY'.
   259
   260 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   261     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   262                                 '1108124700'
   263                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   8
* EL633.cbl
   264                                 '1721211400'
   265                                 '1825011200'
   266                                 '1825011300'
   267                                 '1825091000'
   268                                 '1825099050'
   269                                 '8505700033'
   270                                 '8506400030'
   271                                 '8507200020'
   272                                 '8507200010'
   273                                 '2725010160'.
   274     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   275                                     '2725040320'
   276                                     '2725040330'
   277                                     '2725040310'
   278                                     '8506400030'
   279                                     '8507200010'
   280                                     '1108121250'.
   281*    88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   282*                                    '2725040110'
   283*                                    '2725040120'
   284*                                    '2725040130'
   285*                                    '2725020400'.
   286     88  VALID-CSI-GL-ACCOUNT  VALUE '1108121010'
   287                                     '1825013200'
   288                                     '1825013300'
   289                                     '1825013400'.
   290
   291     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   292                                     '1825013200'
   293                                     '1825013300'
   294                                     '1825013400'
   295                                     '8506400030'
   296                                     '8507200010'
   297                                     '8507200020'
   298                                     '1108121010'.
   299     88  VALID-VPP-GL-ACCOUNT  VALUE '2725040510'
   300                                     '2725040520'
   301                                     '7206100400'
   302                                     '7206104100'.
   303
   304*01  WS-ACCT-BREAK.
   305*    05  WS-ACCT-1               PIC X.
   306*    05  FILLER                  PIC X(6).
   307*
   308 01  WORK-AREA.
   309     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   310     12  QID.
   311         16  QID-TERM        PIC X(04).
   312         16  FILLER          PIC X(04)       VALUE '633A'.
   313     12  DEEDIT-FIELD        PIC X(11).
   314     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   315     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   316     12  DATE-TEST-AREA      PIC  9(6).
   317     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   318         16  DATE-TEST-MM    PIC  99.
   319         16  DATE-TEST-DD    PIC  99.
   320         16  DATE-TEST-YY    PIC  99.
   321     12  DIVIDE-RESULT       PIC  99.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page   9
* EL633.cbl
   322     12  DIVIDE-REMAINDER    PIC  9.
   323     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   324     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   325     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   326     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   327     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   328     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   329     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   330     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   331
   332 01  ACCESS-KEYS.
   333     12  ERPYAJ-KEY.
   334         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   335         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   336         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   337         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   338         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   339         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   340         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   341
   342     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   343     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   344
   345     12  ERCHKQ-KEY.
   346         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   347         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   348         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   349     12  ERCOMP-KEY.
   350         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   351         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   352         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   353         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   354         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   355         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   356*    12  COFA-KEY-X.
   357*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   358*        16  COFA-ACCOUNT.
   359*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   360*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   361*
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  10
* EL633.cbl
   363*                                    COPY ELCDATE.
   364******************************************************************
   365*                                                                *
   366*                                                                *
   367*                            ELCDATE.                            *
   368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   369*                            VMOD=2.003
   370*                                                                *
   371*                                                                *
   372*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   373*                 LENGTH = 200                                   *
   374******************************************************************
   375
   376 01  DATE-CONVERSION-DATA.
   377     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   378     12  DC-OPTION-CODE                PIC X.
   379         88  BIN-TO-GREG                VALUE ' '.
   380         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   381         88  EDIT-GREG-TO-BIN           VALUE '2'.
   382         88  YMD-GREG-TO-BIN            VALUE '3'.
   383         88  MDY-GREG-TO-BIN            VALUE '4'.
   384         88  JULIAN-TO-BIN              VALUE '5'.
   385         88  BIN-PLUS-ELAPSED           VALUE '6'.
   386         88  FIND-CENTURY               VALUE '7'.
   387         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   388         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   389         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   390         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   391         88  JULIAN-TO-BIN-3            VALUE 'C'.
   392         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   393         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   394         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   395         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   396         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   397         88  CHECK-LEAP-YEAR            VALUE 'H'.
   398         88  BIN-3-TO-GREG              VALUE 'I'.
   399         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   400         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   401         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   402         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   403         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   404         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   405         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   406         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   407         88  THREE-CHARACTER-BIN
   408                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   409         88  GREGORIAN-TO-BIN
   410                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   411         88  BIN-TO-GREGORIAN
   412                  VALUES ' ' '1' 'I' '8' 'G'.
   413         88  JULIAN-TO-BINARY
   414                  VALUES '5' 'C' 'E' 'F'.
   415     12  DC-ERROR-CODE                 PIC X.
   416         88  NO-CONVERSION-ERROR        VALUE ' '.
   417         88  DATE-CONVERSION-ERROR
   418                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   419         88  DATE-IS-ZERO               VALUE '1'.
   420         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  11
* EL633.cbl
   421         88  DATE-IS-INVALID            VALUE '3'.
   422         88  DATE1-GREATER-DATE2        VALUE '4'.
   423         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   424         88  DATE-INVALID-OPTION        VALUE '9'.
   425         88  INVALID-CENTURY            VALUE 'A'.
   426         88  ONLY-CENTURY               VALUE 'B'.
   427         88  ONLY-LEAP-YEAR             VALUE 'C'.
   428         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   429     12  DC-END-OF-MONTH               PIC X.
   430         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   431     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   432         88  USE-NORMAL-PROCESS         VALUE ' '.
   433         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   434         88  ADJUST-UP-100-YRS          VALUE '2'.
   435     12  FILLER                        PIC X.
   436     12  DC-CONVERSION-DATES.
   437         16  DC-BIN-DATE-1             PIC XX.
   438         16  DC-BIN-DATE-2             PIC XX.
   439         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   440         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   441                       DC-GREG-DATE-1-EDIT.
   442             20  DC-EDIT1-MONTH        PIC 99.
   443             20  SLASH1-1              PIC X.
   444             20  DC-EDIT1-DAY          PIC 99.
   445             20  SLASH1-2              PIC X.
   446             20  DC-EDIT1-YEAR         PIC 99.
   447         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   448         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   449                     DC-GREG-DATE-2-EDIT.
   450             20  DC-EDIT2-MONTH        PIC 99.
   451             20  SLASH2-1              PIC X.
   452             20  DC-EDIT2-DAY          PIC 99.
   453             20  SLASH2-2              PIC X.
   454             20  DC-EDIT2-YEAR         PIC 99.
   455         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   456         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   457                     DC-GREG-DATE-1-YMD.
   458             20  DC-YMD-YEAR           PIC 99.
   459             20  DC-YMD-MONTH          PIC 99.
   460             20  DC-YMD-DAY            PIC 99.
   461         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   462         16  DC-GREG-DATE-1-MDY-R REDEFINES
   463                      DC-GREG-DATE-1-MDY.
   464             20  DC-MDY-MONTH          PIC 99.
   465             20  DC-MDY-DAY            PIC 99.
   466             20  DC-MDY-YEAR           PIC 99.
   467         16  DC-GREG-DATE-1-ALPHA.
   468             20  DC-ALPHA-MONTH        PIC X(10).
   469             20  DC-ALPHA-DAY          PIC 99.
   470             20  FILLER                PIC XX.
   471             20  DC-ALPHA-CENTURY.
   472                 24 DC-ALPHA-CEN-N     PIC 99.
   473             20  DC-ALPHA-YEAR         PIC 99.
   474         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   475         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   476         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   477         16  DC-JULIAN-DATE            PIC 9(05).
   478         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  12
* EL633.cbl
   479                                       PIC 9(05).
   480         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   481             20  DC-JULIAN-YEAR        PIC 99.
   482             20  DC-JULIAN-DAYS        PIC 999.
   483         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   484         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   485         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   486     12  DATE-CONVERSION-VARIBLES.
   487         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   488         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   489             20  FILLER                PIC 9(3).
   490             20  HOLD-CEN-1-CCYY.
   491                 24  HOLD-CEN-1-CC     PIC 99.
   492                 24  HOLD-CEN-1-YY     PIC 99.
   493             20  HOLD-CEN-1-MO         PIC 99.
   494             20  HOLD-CEN-1-DA         PIC 99.
   495         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   496             20  HOLD-CEN-1-R-MO       PIC 99.
   497             20  HOLD-CEN-1-R-DA       PIC 99.
   498             20  HOLD-CEN-1-R-CCYY.
   499                 24  HOLD-CEN-1-R-CC   PIC 99.
   500                 24  HOLD-CEN-1-R-YY   PIC 99.
   501             20  FILLER                PIC 9(3).
   502         16  HOLD-CENTURY-1-X.
   503             20  FILLER                PIC X(3)  VALUE SPACES.
   504             20  HOLD-CEN-1-X-CCYY.
   505                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   506                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   507             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   508             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   509         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   510             20  HOLD-CEN-1-R-X-MO     PIC XX.
   511             20  HOLD-CEN-1-R-X-DA     PIC XX.
   512             20  HOLD-CEN-1-R-X-CCYY.
   513                 24  HOLD-CEN-1-R-X-CC PIC XX.
   514                 24  HOLD-CEN-1-R-X-YY PIC XX.
   515             20  FILLER                PIC XXX.
   516         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   517         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   518         16  DC-JULIAN-DATE-1          PIC 9(07).
   519         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   520             20  DC-JULIAN-1-CCYY.
   521                 24  DC-JULIAN-1-CC    PIC 99.
   522                 24  DC-JULIAN-1-YR    PIC 99.
   523             20  DC-JULIAN-DA-1        PIC 999.
   524         16  DC-JULIAN-DATE-2          PIC 9(07).
   525         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   526             20  DC-JULIAN-2-CCYY.
   527                 24  DC-JULIAN-2-CC    PIC 99.
   528                 24  DC-JULIAN-2-YR    PIC 99.
   529             20  DC-JULIAN-DA-2        PIC 999.
   530         16  DC-GREG-DATE-A-EDIT.
   531             20  DC-EDITA-MONTH        PIC 99.
   532             20  SLASHA-1              PIC X VALUE '/'.
   533             20  DC-EDITA-DAY          PIC 99.
   534             20  SLASHA-2              PIC X VALUE '/'.
   535             20  DC-EDITA-CCYY.
   536                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  13
* EL633.cbl
   537                 24  DC-EDITA-YEAR     PIC 99.
   538         16  DC-GREG-DATE-B-EDIT.
   539             20  DC-EDITB-MONTH        PIC 99.
   540             20  SLASHB-1              PIC X VALUE '/'.
   541             20  DC-EDITB-DAY          PIC 99.
   542             20  SLASHB-2              PIC X VALUE '/'.
   543             20  DC-EDITB-CCYY.
   544                 24  DC-EDITB-CENT     PIC 99.
   545                 24  DC-EDITB-YEAR     PIC 99.
   546         16  DC-GREG-DATE-CYMD         PIC 9(08).
   547         16  DC-GREG-DATE-CYMD-R REDEFINES
   548                              DC-GREG-DATE-CYMD.
   549             20  DC-CYMD-CEN           PIC 99.
   550             20  DC-CYMD-YEAR          PIC 99.
   551             20  DC-CYMD-MONTH         PIC 99.
   552             20  DC-CYMD-DAY           PIC 99.
   553         16  DC-GREG-DATE-MDCY         PIC 9(08).
   554         16  DC-GREG-DATE-MDCY-R REDEFINES
   555                              DC-GREG-DATE-MDCY.
   556             20  DC-MDCY-MONTH         PIC 99.
   557             20  DC-MDCY-DAY           PIC 99.
   558             20  DC-MDCY-CEN           PIC 99.
   559             20  DC-MDCY-YEAR          PIC 99.
   560    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   561        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   562    12  DC-EL310-DATE                  PIC X(21).
   563    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  14
* EL633.cbl
   565*                                    COPY ELCLOGOF.
   566******************************************************************
   567*                                                                *
   568*                                                                *
   569*                            ELCLOGOF.                           *
   570*                            VMOD=2.001                          *
   571*                                                                *
   572*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   573*                                                                *
   574******************************************************************
   575 01  CLASIC-LOGOFF.
   576     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   577     12  LOGOFF-TEXT.
   578         16  FILLER          PIC X(5)    VALUE SPACES.
   579         16  LOGOFF-MSG.
   580             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   581             20  FILLER      PIC X       VALUE SPACES.
   582             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   583         16  FILLER          PIC X(80)
   584           VALUE '* YOU ARE NOW LOGGED OFF'.
   585         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   586         16  FILLER          PIC X       VALUE QUOTE.
   587         16  LOGOFF-SYS-MSG  PIC X(17)
   588           VALUE 'S CLAS-IC SYSTEM '.
   589     12  TEXT-MESSAGES.
   590         16  UNACCESS-MSG    PIC X(29)
   591             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   592         16  PGMIDERR-MSG    PIC X(17)
   593             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  15
* EL633.cbl
   595*                                    COPY ELCATTR.
   596******************************************************************
   597*                                                                *
   598*                            ELCATTR.                            *
   599*                            VMOD=2.001                          *
   600*                                                                *
   601*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   602*                                                                *
   603*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   604*                                                                *
   605*                   POS 1   P=PROTECTED                          *
   606*                           U=UNPROTECTED                        *
   607*                           S=ASKIP                              *
   608*                   POS 2   A=ALPHA/NUMERIC                      *
   609*                           N=NUMERIC                            *
   610*                   POS 3   N=NORMAL                             *
   611*                           B=BRIGHT                             *
   612*                           D=DARK                               *
   613*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   614*                           OF=MODIFIED DATA TAG OFF             *
   615*                                                                *
   616*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   617******************************************************************
   618 01  ATTRIBUTE-LIST.
   619     12  AL-PABOF            PIC X       VALUE 'Y'.
   620     12  AL-PABON            PIC X       VALUE 'Z'.
   621     12  AL-PADOF            PIC X       VALUE '%'.
   622     12  AL-PADON            PIC X       VALUE '_'.
   623     12  AL-PANOF            PIC X       VALUE '-'.
   624     12  AL-PANON            PIC X       VALUE '/'.
   625     12  AL-SABOF            PIC X       VALUE '8'.
   626     12  AL-SABON            PIC X       VALUE '9'.
   627     12  AL-SADOF            PIC X       VALUE '@'.
   628     12  AL-SADON            PIC X       VALUE QUOTE.
   629     12  AL-SANOF            PIC X       VALUE '0'.
   630     12  AL-SANON            PIC X       VALUE '1'.
   631     12  AL-UABOF            PIC X       VALUE 'H'.
   632     12  AL-UABON            PIC X       VALUE 'I'.
   633     12  AL-UADOF            PIC X       VALUE '<'.
   634     12  AL-UADON            PIC X       VALUE '('.
   635     12  AL-UANOF            PIC X       VALUE ' '.
   636     12  AL-UANON            PIC X       VALUE 'A'.
   637     12  AL-UNBOF            PIC X       VALUE 'Q'.
   638     12  AL-UNBON            PIC X       VALUE 'R'.
   639     12  AL-UNDOF            PIC X       VALUE '*'.
   640     12  AL-UNDON            PIC X       VALUE ')'.
   641     12  AL-UNNOF            PIC X       VALUE '&'.
   642     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  16
* EL633.cbl
   644*                                    COPY ELCEMIB.
   645******************************************************************
   646*                                                                *
   647*                                                                *
   648*                            ELCEMIB.                            *
   649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   650*                            VMOD=2.005                          *
   651*                                                                *
   652*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   653*                                                                *
   654******************************************************************
   655 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   656     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   657     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   658     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   659     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   660     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   661     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   662     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   663     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   664     12  EMI-SWITCH1             PIC X        VALUE '1'.
   665         88  EMI-NO-ERRORS                    VALUE '1'.
   666         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   667         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   668     12  EMI-SWITCH2             PIC X        VALUE '1'.
   669         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   670     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   671         88  EMI-AREA1-EMPTY                  VALUE '1'.
   672         88  EMI-AREA1-FULL                   VALUE '2'.
   673     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   674         88  EMI-AREA2-EMPTY                  VALUE '1'.
   675         88  EMI-AREA2-FULL                   VALUE '2'.
   676     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   677         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   678         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   679         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   680         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   681         88  EMI-BYPASS-FATALS                VALUE 'X'.
   682     12  EMI-ERROR-LINES.
   683         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   684         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   685         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   686         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   687             20  EMI-ERR-CODES OCCURS 10 TIMES.
   688                 24  EMI-ERR-NUM         PIC X(4).
   689                 24  EMI-FILLER          PIC X.
   690                 24  EMI-SEV             PIC X.
   691                 24  FILLER              PIC X.
   692             20  FILLER                  PIC X(02).
   693     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   694         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   695             20  EMI-ERROR-NUMBER    PIC X(4).
   696             20  EMI-FILL            PIC X.
   697             20  EMI-SEVERITY        PIC X.
   698             20  FILLER              PIC X.
   699             20  EMI-ERROR-TEXT.
   700                 24  EMI-TEXT-VARIABLE   PIC X(10).
   701                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  17
* EL633.cbl
   702     12  EMI-SEVERITY-SAVE           PIC X.
   703         88  EMI-NOTE                    VALUE 'N'.
   704         88  EMI-WARNING                 VALUE 'W'.
   705         88  EMI-FORCABLE                VALUE 'F'.
   706         88  EMI-FATAL                   VALUE 'X'.
   707     12  EMI-MESSAGE-FLAG            PIC X.
   708         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   709         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   710     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   711     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   712         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   713         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   714         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   715     12  emi-claim-no                pic x(7).
   716     12  emi-claim-type              pic x(6).
   717     12  FILLER                      PIC X(124)  VALUE SPACES.
   718     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   719     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   720     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   721     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  18
* EL633.cbl
   723*                                    COPY ELCINTF.
   724******************************************************************
   725*                                                                *
   726*                                                                *
   727*                            ELCINTF.                            *
   728*                            VMOD=2.017                          *
   729*                                                                *
   730*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   731*                                                                *
   732*       LENGTH = 1024                                            *
   733*                                                                *
   734******************************************************************
   735*                   C H A N G E   L O G
   736*
   737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   738*-----------------------------------------------------------------
   739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   740* EFFECTIVE    NUMBER
   741*-----------------------------------------------------------------
   742* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   743******************************************************************
   744 01  PROGRAM-INTERFACE-BLOCK.
   745     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   746     12  PI-CALLING-PROGRAM              PIC X(8).
   747     12  PI-SAVED-PROGRAM-1              PIC X(8).
   748     12  PI-SAVED-PROGRAM-2              PIC X(8).
   749     12  PI-SAVED-PROGRAM-3              PIC X(8).
   750     12  PI-SAVED-PROGRAM-4              PIC X(8).
   751     12  PI-SAVED-PROGRAM-5              PIC X(8).
   752     12  PI-SAVED-PROGRAM-6              PIC X(8).
   753     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   754     12  PI-COMPANY-ID                   PIC XXX.
   755     12  PI-COMPANY-CD                   PIC X.
   756
   757     12  PI-COMPANY-PASSWORD             PIC X(8).
   758
   759     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   760
   761     12  PI-CONTROL-IN-PROGRESS.
   762         16  PI-CARRIER                  PIC X.
   763         16  PI-GROUPING                 PIC X(6).
   764         16  PI-STATE                    PIC XX.
   765         16  PI-ACCOUNT                  PIC X(10).
   766         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   767                                         PIC X(10).
   768         16  PI-CLAIM-CERT-GRP.
   769             20  PI-CLAIM-NO             PIC X(7).
   770             20  PI-CERT-NO.
   771                 25  PI-CERT-PRIME       PIC X(10).
   772                 25  PI-CERT-SFX         PIC X.
   773             20  PI-CERT-EFF-DT          PIC XX.
   774         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   775             20  PI-PLAN-CODE            PIC X(2).
   776             20  PI-REVISION-NUMBER      PIC X(3).
   777             20  PI-PLAN-EFF-DT          PIC X(2).
   778             20  PI-PLAN-EXP-DT          PIC X(2).
   779             20  FILLER                  PIC X(11).
   780         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  19
* EL633.cbl
   781             20  PI-OE-REFERENCE-1.
   782                 25  PI-OE-REF-1-PRIME   PIC X(18).
   783                 25  PI-OE-REF-1-SUFF    PIC XX.
   784
   785     12  PI-SESSION-IN-PROGRESS          PIC X.
   786         88  CLAIM-SESSION                   VALUE '1'.
   787         88  CREDIT-SESSION                  VALUE '2'.
   788         88  WARRANTY-SESSION                VALUE '3'.
   789         88  MORTGAGE-SESSION                VALUE '4'.
   790         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   791
   792
   793*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   794
   795     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   796     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   797
   798     12  PI-CREDIT-USER                  PIC X.
   799         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   800         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   801
   802     12  PI-CLAIM-USER                   PIC X.
   803         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   804         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   805
   806     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   807         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   808         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   809         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   810         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   811         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   812
   813     12  PI-PROCESSOR-ID                 PIC X(4).
   814
   815     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   816
   817     12  PI-MEMBER-CAPTION               PIC X(10).
   818
   819     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   820         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   821
   822     12  PI-LIFE-OVERRIDE-L1             PIC X.
   823     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   824     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   825     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   826
   827     12  PI-AH-OVERRIDE-L1               PIC X.
   828     12  PI-AH-OVERRIDE-L2               PIC XX.
   829     12  PI-AH-OVERRIDE-L6               PIC X(6).
   830     12  PI-AH-OVERRIDE-L12              PIC X(12).
   831
   832     12  PI-NEW-SYSTEM                   PIC X(2).
   833
   834     12  PI-PRIMARY-CERT-NO              PIC X(11).
   835     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   836         88  PI-USES-PAID-TO                 VALUE '1'.
   837     12  PI-CRDTCRD-SYSTEM.
   838         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  20
* EL633.cbl
   839             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   840             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   841         16  PI-CC-MONTH-END-DT          PIC XX.
   842     12  PI-PROCESSOR-PRINTER            PIC X(4).
   843
   844     12  PI-OE-REFERENCE-2.
   845         16  PI-OE-REF-2-PRIME           PIC X(10).
   846         16  PI-OE-REF-2-SUFF            PIC X.
   847
   848     12  PI-REM-TRM-CALC-OPTION          PIC X.
   849
   850     12  PI-LANGUAGE-TYPE                PIC X.
   851             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   852             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   853             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   854
   855     12  PI-POLICY-LINKAGE-IND           PIC X.
   856         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   857         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   858                                                   LOW-VALUES.
   859
   860     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   861     12  PI-CLAIM-PW-SESSION             PIC X(1).
   862         88  PI-CLAIM-CREDIT                 VALUE '1'.
   863         88  PI-CLAIM-CONVEN                 VALUE '2'.
   864
   865     12  PI-PROCESSOR-CSR-IND            PIC X.
   866         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   867         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   868
   869     12  FILLER                          PIC X(3).
   870
   871     12  PI-SYSTEM-LEVEL                 PIC X(145).
   872
   873     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   874         PI-SYSTEM-LEVEL.
   875
   876         16  PI-ENTRY-CODES.
   877             20  PI-ENTRY-CD-1           PIC X.
   878             20  PI-ENTRY-CD-2           PIC X.
   879
   880         16  PI-RETURN-CODES.
   881             20  PI-RETURN-CD-1          PIC X.
   882             20  PI-RETURN-CD-2          PIC X.
   883
   884         16  PI-UPDATE-STATUS-SAVE.
   885             20  PI-UPDATE-BY            PIC X(4).
   886             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   887
   888         16  PI-LOWER-CASE-LETTERS       PIC X.
   889             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   890
   891*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   892*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   893*            88  CARRIER-CLM-CNTL            VALUE '2'.
   894
   895         16  PI-CERT-ACCESS-CONTROL      PIC X.
   896             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  21
* EL633.cbl
   897             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   898             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   899             88  ACCNT-CNTL                  VALUE '3'.
   900             88  CARR-ACCNT-CNTL             VALUE '4'.
   901
   902         16  PI-PROCESSOR-CAP-LIST.
   903             20  PI-SYSTEM-CONTROLS.
   904                24 PI-SYSTEM-DISPLAY     PIC X.
   905                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   906                24 PI-SYSTEM-MODIFY      PIC X.
   907                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   908             20  FILLER                  PIC XX.
   909             20  PI-DISPLAY-CAP          PIC X.
   910                 88  DISPLAY-CAP             VALUE 'Y'.
   911             20  PI-MODIFY-CAP           PIC X.
   912                 88  MODIFY-CAP              VALUE 'Y'.
   913             20  PI-MSG-AT-LOGON-CAP     PIC X.
   914                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   915             20  PI-FORCE-CAP            PIC X.
   916                 88  FORCE-CAP               VALUE 'Y'.
   917
   918         16  PI-PROGRAM-CONTROLS.
   919             20  PI-PGM-PRINT-OPT        PIC X.
   920             20  PI-PGM-FORMAT-OPT       PIC X.
   921             20  PI-PGM-PROCESS-OPT      PIC X.
   922             20  PI-PGM-TOTALS-OPT       PIC X.
   923
   924         16  PI-HELP-INTERFACE.
   925             20  PI-LAST-ERROR-NO        PIC X(4).
   926             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   927
   928         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   929             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   930
   931         16  PI-CR-CONTROL-IN-PROGRESS.
   932             20  PI-CR-CARRIER           PIC X.
   933             20  PI-CR-GROUPING          PIC X(6).
   934             20  PI-CR-STATE             PIC XX.
   935             20  PI-CR-ACCOUNT           PIC X(10).
   936             20  PI-CR-FIN-RESP          PIC X(10).
   937             20  PI-CR-TYPE              PIC X.
   938
   939         16  PI-CR-BATCH-NUMBER          PIC X(6).
   940
   941         16  PI-CR-MONTH-END-DT          PIC XX.
   942
   943         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   944             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   945             88  PI-ZERO-CARRIER             VALUE '1'.
   946             88  PI-ZERO-GROUPING            VALUE '2'.
   947             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   948
   949         16  PI-CARRIER-SECURITY         PIC X.
   950             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   951
   952         16  PI-ACCOUNT-SECURITY         PIC X(10).
   953             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   954             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  22
* EL633.cbl
   955
   956         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   957             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   958                                         INDEXED BY PI-ACCESS-NDX
   959                                         PIC X.
   960
   961         16  PI-GA-BILLING-CONTROL       PIC X.
   962             88  PI-GA-BILLING               VALUE '1'.
   963
   964         16  PI-MAIL-PROCESSING          PIC X.
   965             88  PI-MAIL-YES                 VALUE 'Y'.
   966
   967         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   968
   969         16  PI-AR-SYSTEM.
   970             20  PI-AR-PROCESSING-CNTL   PIC X.
   971                 88  PI-AR-PROCESSING        VALUE 'Y'.
   972             20  PI-AR-SUMMARY-CODE      PIC X(6).
   973             20  PI-AR-MONTH-END-DT      PIC XX.
   974
   975         16  PI-MP-SYSTEM.
   976             20  PI-MORTGAGE-USER            PIC X.
   977                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   978                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   979             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   980                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   981                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   982                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   983                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   984                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   985             20  PI-MP-MONTH-END-DT          PIC XX.
   986             20  PI-MP-REFERENCE-NO.
   987                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   988                 24  PI-MP-REFERENCE-SFX     PIC XX.
   989
   990         16  PI-LABEL-CONTROL            PIC X(01).
   991             88  PI-CREATE-LABELS                    VALUE 'Y'.
   992             88  PI-BYPASS-LABELS                    VALUE 'N'.
   993
   994         16  PI-BILL-GROUPING-CODE       PIC X(01).
   995             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   996
   997         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   998             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   999             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1000
  1001         16  FILLER                      PIC X(14).
  1002
  1003     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1004******************************************************************
  1005     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1006         16  PI-PYAJ-FILE-SW             PIC  X.
  1007             88  END-OF-ACCT                 VALUE 'A'.
  1008             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
  1009             88  END-OF-FILE                 VALUE 'X'.
  1010             88  TOP-OF-FILE                 VALUE 'T'.
  1011             88  PAGE-FULL                   VALUE 'F'.
  1012             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  23
* EL633.cbl
  1013             88  NOT-OPEN                    VALUE 'Z'.
  1014         16  PI-PREV-FUNCTION            PIC  X.
  1015         16  PI-SAV-FUNCTION             PIC  X.
  1016         16  PI-PREV-PFKEY               PIC  X.
  1017         16  PI-SEQ-NOS.
  1018             20  FILLER  OCCURS 13 TIMES
  1019                             INDEXED BY NDX.
  1020                 24  PI-REC-TYPE         PIC  X.
  1021                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1022         16  PI-SAV-ENDING-PYAJ-KEY.
  1023             20  PI-SAV-COMP-CD          PIC  X.
  1024             20  PI-SAV-COMP-CONTROL.
  1025                 24  PI-SAV-CARRIER      PIC  X.
  1026                 24  PI-SAV-GROUPING     PIC  X(6).
  1027                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1028                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1029                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1030                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1031         16  PI-START-PYAJ-KEY           PIC  X(33).
  1032         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1033         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1034         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1035         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1036         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1037             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1038         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1039         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1040         16  PI-FRST-RECORD-TYPE         PIC  X.
  1041         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1042         16  PI-PREV-RECORD-TYPE         PIC  X.
  1043         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1044         16  PI-LAST-RECORD-TYPE         PIC  X.
  1045         16  PI-PAGE-SW                  PIC  X.
  1046             88  FIRST-PAGE                          VALUE 'Y'.
  1047         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  24
* EL633.cbl
  1049*                            COPY ELCJPFX.
  1050******************************************************************
  1051*                                                                *
  1052*                                                                *
  1053*                            ELCJPFX.                            *
  1054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1055*                            VMOD=2.002                          *
  1056*                                                                *
  1057*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1058*                                                                *
  1059*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1060*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1061*        ELCNTL - CONTROL FILE                                   *
  1062*        ELMSTR - CLAIM MASTERS                                  *
  1063*        ELTRLR - ACTIVITY TRAILERS                              *
  1064*        ELCHKQ - CHECK QUE                                      *
  1065******************************************************************
  1066 01  JOURNAL-RECORD.
  1067     12  jp-date                     pic s9(5) comp-3.
  1068     12  jp-time                     pic s9(7) comp-3.
  1069     12  JP-USER-ID                  PIC X(4).
  1070     12  JP-FILE-ID                  PIC X(8).
  1071     12  JP-PROGRAM-ID               PIC X(8).
  1072     12  JP-RECORD-TYPE              PIC X.
  1073         88 JP-ADD              VALUE 'A'.
  1074         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1075         88 JP-AFTER-CHANGE     VALUE 'C'.
  1076         88 JP-DELETE           VALUE 'D'.
  1077         88 JP-GENERIC-DELETE   VALUE 'G'.
  1078         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1079         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1080     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1081     12  JP-RECORD-AREA
  1082
  1083
  1084                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  25
* EL633.cbl
  1086*                            COPY ELCAID.
  1087******************************************************************
  1088*                                                                *
  1089*                            ELCAID.                             *
  1090*                            VMOD=2.001                          *
  1091*                                                                *
  1092*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1093*                                                                *
  1094*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1095*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1096******************************************************************
  1097
  1098 01  DFHAID.
  1099   02  DFHNULL   PIC  X  VALUE  ' '.
  1100   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1101   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1102   02  DFHPEN    PIC  X  VALUE  '='.
  1103   02  DFHOPID   PIC  X  VALUE  'W'.
  1104   02  DFHPA1    PIC  X  VALUE  '%'.
  1105   02  DFHPA2    PIC  X  VALUE  '>'.
  1106   02  DFHPA3    PIC  X  VALUE  ','.
  1107   02  DFHPF1    PIC  X  VALUE  '1'.
  1108   02  DFHPF2    PIC  X  VALUE  '2'.
  1109   02  DFHPF3    PIC  X  VALUE  '3'.
  1110   02  DFHPF4    PIC  X  VALUE  '4'.
  1111   02  DFHPF5    PIC  X  VALUE  '5'.
  1112   02  DFHPF6    PIC  X  VALUE  '6'.
  1113   02  DFHPF7    PIC  X  VALUE  '7'.
  1114   02  DFHPF8    PIC  X  VALUE  '8'.
  1115   02  DFHPF9    PIC  X  VALUE  '9'.
  1116   02  DFHPF10   PIC  X  VALUE  ':'.
  1117   02  DFHPF11   PIC  X  VALUE  '#'.
  1118   02  DFHPF12   PIC  X  VALUE  '@'.
  1119   02  DFHPF13   PIC  X  VALUE  'A'.
  1120   02  DFHPF14   PIC  X  VALUE  'B'.
  1121   02  DFHPF15   PIC  X  VALUE  'C'.
  1122   02  DFHPF16   PIC  X  VALUE  'D'.
  1123   02  DFHPF17   PIC  X  VALUE  'E'.
  1124   02  DFHPF18   PIC  X  VALUE  'F'.
  1125   02  DFHPF19   PIC  X  VALUE  'G'.
  1126   02  DFHPF20   PIC  X  VALUE  'H'.
  1127   02  DFHPF21   PIC  X  VALUE  'I'.
  1128*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1129   02  DFHPF22   PIC  X  VALUE  '['.
  1130   02  DFHPF23   PIC  X  VALUE  '.'.
  1131   02  DFHPF24   PIC  X  VALUE  '<'.
  1132   02  DFHMSRE   PIC  X  VALUE  'X'.
  1133   02  DFHSTRF   PIC  X  VALUE  'h'.
  1134   02  DFHTRIG   PIC  X  VALUE  '"'.
  1135
  1136 01  FILLER  REDEFINES  DFHAID.
  1137     12  FILLER              PIC  X(8).
  1138     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  26
* EL633.cbl
  1140*                            COPY EL633S.
  1141 01  EL633AI.
  1142     05  FILLER            PIC  X(0012).
  1143*    -------------------------------
  1144     05  DATEL PIC S9(0004) COMP.
  1145     05  DATEF PIC  X(0001).
  1146     05  FILLER REDEFINES DATEF.
  1147         10  DATEA PIC  X(0001).
  1148     05  DATEI PIC  X(0008).
  1149*    -------------------------------
  1150     05  TIMEL PIC S9(0004) COMP.
  1151     05  TIMEF PIC  X(0001).
  1152     05  FILLER REDEFINES TIMEF.
  1153         10  TIMEA PIC  X(0001).
  1154     05  TIMEI PIC  X(0005).
  1155*    -------------------------------
  1156     05  CMPNYIDL PIC S9(0004) COMP.
  1157     05  CMPNYIDF PIC  X(0001).
  1158     05  FILLER REDEFINES CMPNYIDF.
  1159         10  CMPNYIDA PIC  X(0001).
  1160     05  CMPNYIDI PIC  X(0003).
  1161*    -------------------------------
  1162     05  USERIDL PIC S9(0004) COMP.
  1163     05  USERIDF PIC  X(0001).
  1164     05  FILLER REDEFINES USERIDF.
  1165         10  USERIDA PIC  X(0001).
  1166     05  USERIDI PIC  X(0004).
  1167*    -------------------------------
  1168     05  MAINTL PIC S9(0004) COMP.
  1169     05  MAINTF PIC  X(0001).
  1170     05  FILLER REDEFINES MAINTF.
  1171         10  MAINTA PIC  X(0001).
  1172     05  MAINTI PIC  X(0001).
  1173*    -------------------------------
  1174     05  CARRIERL PIC S9(0004) COMP.
  1175     05  CARRIERF PIC  X(0001).
  1176     05  FILLER REDEFINES CARRIERF.
  1177         10  CARRIERA PIC  X(0001).
  1178     05  CARRIERI PIC  X(0001).
  1179*    -------------------------------
  1180     05  GROUPL PIC S9(0004) COMP.
  1181     05  GROUPF PIC  X(0001).
  1182     05  FILLER REDEFINES GROUPF.
  1183         10  GROUPA PIC  X(0001).
  1184     05  GROUPI PIC  X(0006).
  1185*    -------------------------------
  1186     05  FINRESPL PIC S9(0004) COMP.
  1187     05  FINRESPF PIC  X(0001).
  1188     05  FILLER REDEFINES FINRESPF.
  1189         10  FINRESPA PIC  X(0001).
  1190     05  FINRESPI PIC  X(0010).
  1191*    -------------------------------
  1192     05  ACCTL PIC S9(0004) COMP.
  1193     05  ACCTF PIC  X(0001).
  1194     05  FILLER REDEFINES ACCTF.
  1195         10  ACCTA PIC  X(0001).
  1196     05  ACCTI PIC  X(0010).
  1197*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  27
* EL633.cbl
  1198     05  MSAAC1L PIC S9(0004) COMP.
  1199     05  MSAAC1F PIC  X(0001).
  1200     05  FILLER REDEFINES MSAAC1F.
  1201         10  MSAAC1A PIC  X(0001).
  1202     05  MSAAC1I PIC  X(0010).
  1203*    -------------------------------
  1204     05  MSAST1L PIC S9(0004) COMP.
  1205     05  MSAST1F PIC  X(0001).
  1206     05  FILLER REDEFINES MSAST1F.
  1207         10  MSAST1A PIC  X(0001).
  1208     05  MSAST1I PIC  X(0002).
  1209*    -------------------------------
  1210     05  MSACN1L PIC S9(0004) COMP.
  1211     05  MSACN1F PIC  X(0001).
  1212     05  FILLER REDEFINES MSACN1F.
  1213         10  MSACN1A PIC  X(0001).
  1214     05  MSACN1I PIC  X(0001).
  1215*    -------------------------------
  1216     05  MSACM1L PIC S9(0004) COMP.
  1217     05  MSACM1F PIC  X(0001).
  1218     05  FILLER REDEFINES MSACM1F.
  1219         10  MSACM1A PIC  X(0001).
  1220     05  MSACM1I PIC  X(0010).
  1221*    -------------------------------
  1222     05  TYPE1L PIC S9(0004) COMP.
  1223     05  TYPE1F PIC  X(0001).
  1224     05  FILLER REDEFINES TYPE1F.
  1225         10  TYPE1A PIC  X(0001).
  1226     05  TYPE1I PIC  X(0001).
  1227*    -------------------------------
  1228     05  AMT1L PIC S9(0004) COMP.
  1229     05  AMT1F PIC  X(0001).
  1230     05  FILLER REDEFINES AMT1F.
  1231         10  AMT1A PIC  X(0001).
  1232     05  AMT1I PIC  X(0011).
  1233*    -------------------------------
  1234     05  VOID1L PIC S9(0004) COMP.
  1235     05  VOID1F PIC  X(0001).
  1236     05  FILLER REDEFINES VOID1F.
  1237         10  VOID1A PIC  X(0001).
  1238     05  VOID1I PIC  X(0001).
  1239*    -------------------------------
  1240     05  MDT1L PIC S9(0004) COMP.
  1241     05  MDT1F PIC  X(0001).
  1242     05  FILLER REDEFINES MDT1F.
  1243         10  MDT1A PIC  X(0001).
  1244     05  MDT1I PIC  X(0006).
  1245*    -------------------------------
  1246     05  BDT1L PIC S9(0004) COMP.
  1247     05  BDT1F PIC  X(0001).
  1248     05  FILLER REDEFINES BDT1F.
  1249         10  BDT1A PIC  X(0001).
  1250     05  BDT1I PIC  X(0006).
  1251*    -------------------------------
  1252     05  SDT1L PIC S9(0004) COMP.
  1253     05  SDT1F PIC  X(0001).
  1254     05  FILLER REDEFINES SDT1F.
  1255         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  28
* EL633.cbl
  1256     05  SDT1I PIC  X(0006).
  1257*    -------------------------------
  1258     05  MSAAC2L PIC S9(0004) COMP.
  1259     05  MSAAC2F PIC  X(0001).
  1260     05  FILLER REDEFINES MSAAC2F.
  1261         10  MSAAC2A PIC  X(0001).
  1262     05  MSAAC2I PIC  X(0010).
  1263*    -------------------------------
  1264     05  MSAST2L PIC S9(0004) COMP.
  1265     05  MSAST2F PIC  X(0001).
  1266     05  FILLER REDEFINES MSAST2F.
  1267         10  MSAST2A PIC  X(0001).
  1268     05  MSAST2I PIC  X(0002).
  1269*    -------------------------------
  1270     05  MSACN2L PIC S9(0004) COMP.
  1271     05  MSACN2F PIC  X(0001).
  1272     05  FILLER REDEFINES MSACN2F.
  1273         10  MSACN2A PIC  X(0001).
  1274     05  MSACN2I PIC  X(0001).
  1275*    -------------------------------
  1276     05  MSACM2L PIC S9(0004) COMP.
  1277     05  MSACM2F PIC  X(0001).
  1278     05  FILLER REDEFINES MSACM2F.
  1279         10  MSACM2A PIC  X(0001).
  1280     05  MSACM2I PIC  X(0010).
  1281*    -------------------------------
  1282     05  TYPE2L PIC S9(0004) COMP.
  1283     05  TYPE2F PIC  X(0001).
  1284     05  FILLER REDEFINES TYPE2F.
  1285         10  TYPE2A PIC  X(0001).
  1286     05  TYPE2I PIC  X(0001).
  1287*    -------------------------------
  1288     05  AMT2L PIC S9(0004) COMP.
  1289     05  AMT2F PIC  X(0001).
  1290     05  FILLER REDEFINES AMT2F.
  1291         10  AMT2A PIC  X(0001).
  1292     05  AMT2I PIC  X(0011).
  1293*    -------------------------------
  1294     05  VOID2L PIC S9(0004) COMP.
  1295     05  VOID2F PIC  X(0001).
  1296     05  FILLER REDEFINES VOID2F.
  1297         10  VOID2A PIC  X(0001).
  1298     05  VOID2I PIC  X(0001).
  1299*    -------------------------------
  1300     05  MDT2L PIC S9(0004) COMP.
  1301     05  MDT2F PIC  X(0001).
  1302     05  FILLER REDEFINES MDT2F.
  1303         10  MDT2A PIC  X(0001).
  1304     05  MDT2I PIC  X(0006).
  1305*    -------------------------------
  1306     05  BDT2L PIC S9(0004) COMP.
  1307     05  BDT2F PIC  X(0001).
  1308     05  FILLER REDEFINES BDT2F.
  1309         10  BDT2A PIC  X(0001).
  1310     05  BDT2I PIC  X(0006).
  1311*    -------------------------------
  1312     05  SDT2L PIC S9(0004) COMP.
  1313     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  29
* EL633.cbl
  1314     05  FILLER REDEFINES SDT2F.
  1315         10  SDT2A PIC  X(0001).
  1316     05  SDT2I PIC  X(0006).
  1317*    -------------------------------
  1318     05  MSAAC3L PIC S9(0004) COMP.
  1319     05  MSAAC3F PIC  X(0001).
  1320     05  FILLER REDEFINES MSAAC3F.
  1321         10  MSAAC3A PIC  X(0001).
  1322     05  MSAAC3I PIC  X(0010).
  1323*    -------------------------------
  1324     05  MSAST3L PIC S9(0004) COMP.
  1325     05  MSAST3F PIC  X(0001).
  1326     05  FILLER REDEFINES MSAST3F.
  1327         10  MSAST3A PIC  X(0001).
  1328     05  MSAST3I PIC  X(0002).
  1329*    -------------------------------
  1330     05  MSACN3L PIC S9(0004) COMP.
  1331     05  MSACN3F PIC  X(0001).
  1332     05  FILLER REDEFINES MSACN3F.
  1333         10  MSACN3A PIC  X(0001).
  1334     05  MSACN3I PIC  X(0001).
  1335*    -------------------------------
  1336     05  MSACM3L PIC S9(0004) COMP.
  1337     05  MSACM3F PIC  X(0001).
  1338     05  FILLER REDEFINES MSACM3F.
  1339         10  MSACM3A PIC  X(0001).
  1340     05  MSACM3I PIC  X(0010).
  1341*    -------------------------------
  1342     05  TYPE3L PIC S9(0004) COMP.
  1343     05  TYPE3F PIC  X(0001).
  1344     05  FILLER REDEFINES TYPE3F.
  1345         10  TYPE3A PIC  X(0001).
  1346     05  TYPE3I PIC  X(0001).
  1347*    -------------------------------
  1348     05  AMT3L PIC S9(0004) COMP.
  1349     05  AMT3F PIC  X(0001).
  1350     05  FILLER REDEFINES AMT3F.
  1351         10  AMT3A PIC  X(0001).
  1352     05  AMT3I PIC  X(0011).
  1353*    -------------------------------
  1354     05  VOID3L PIC S9(0004) COMP.
  1355     05  VOID3F PIC  X(0001).
  1356     05  FILLER REDEFINES VOID3F.
  1357         10  VOID3A PIC  X(0001).
  1358     05  VOID3I PIC  X(0001).
  1359*    -------------------------------
  1360     05  MDT3L PIC S9(0004) COMP.
  1361     05  MDT3F PIC  X(0001).
  1362     05  FILLER REDEFINES MDT3F.
  1363         10  MDT3A PIC  X(0001).
  1364     05  MDT3I PIC  X(0006).
  1365*    -------------------------------
  1366     05  BDT3L PIC S9(0004) COMP.
  1367     05  BDT3F PIC  X(0001).
  1368     05  FILLER REDEFINES BDT3F.
  1369         10  BDT3A PIC  X(0001).
  1370     05  BDT3I PIC  X(0006).
  1371*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  30
* EL633.cbl
  1372     05  SDT3L PIC S9(0004) COMP.
  1373     05  SDT3F PIC  X(0001).
  1374     05  FILLER REDEFINES SDT3F.
  1375         10  SDT3A PIC  X(0001).
  1376     05  SDT3I PIC  X(0006).
  1377*    -------------------------------
  1378     05  MSAAC4L PIC S9(0004) COMP.
  1379     05  MSAAC4F PIC  X(0001).
  1380     05  FILLER REDEFINES MSAAC4F.
  1381         10  MSAAC4A PIC  X(0001).
  1382     05  MSAAC4I PIC  X(0010).
  1383*    -------------------------------
  1384     05  MSAST4L PIC S9(0004) COMP.
  1385     05  MSAST4F PIC  X(0001).
  1386     05  FILLER REDEFINES MSAST4F.
  1387         10  MSAST4A PIC  X(0001).
  1388     05  MSAST4I PIC  X(0002).
  1389*    -------------------------------
  1390     05  MSACN4L PIC S9(0004) COMP.
  1391     05  MSACN4F PIC  X(0001).
  1392     05  FILLER REDEFINES MSACN4F.
  1393         10  MSACN4A PIC  X(0001).
  1394     05  MSACN4I PIC  X(0001).
  1395*    -------------------------------
  1396     05  MSACM4L PIC S9(0004) COMP.
  1397     05  MSACM4F PIC  X(0001).
  1398     05  FILLER REDEFINES MSACM4F.
  1399         10  MSACM4A PIC  X(0001).
  1400     05  MSACM4I PIC  X(0010).
  1401*    -------------------------------
  1402     05  TYPE4L PIC S9(0004) COMP.
  1403     05  TYPE4F PIC  X(0001).
  1404     05  FILLER REDEFINES TYPE4F.
  1405         10  TYPE4A PIC  X(0001).
  1406     05  TYPE4I PIC  X(0001).
  1407*    -------------------------------
  1408     05  AMT4L PIC S9(0004) COMP.
  1409     05  AMT4F PIC  X(0001).
  1410     05  FILLER REDEFINES AMT4F.
  1411         10  AMT4A PIC  X(0001).
  1412     05  AMT4I PIC  X(0011).
  1413*    -------------------------------
  1414     05  VOID4L PIC S9(0004) COMP.
  1415     05  VOID4F PIC  X(0001).
  1416     05  FILLER REDEFINES VOID4F.
  1417         10  VOID4A PIC  X(0001).
  1418     05  VOID4I PIC  X(0001).
  1419*    -------------------------------
  1420     05  MDT4L PIC S9(0004) COMP.
  1421     05  MDT4F PIC  X(0001).
  1422     05  FILLER REDEFINES MDT4F.
  1423         10  MDT4A PIC  X(0001).
  1424     05  MDT4I PIC  X(0006).
  1425*    -------------------------------
  1426     05  BDT4L PIC S9(0004) COMP.
  1427     05  BDT4F PIC  X(0001).
  1428     05  FILLER REDEFINES BDT4F.
  1429         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  31
* EL633.cbl
  1430     05  BDT4I PIC  X(0006).
  1431*    -------------------------------
  1432     05  SDT4L PIC S9(0004) COMP.
  1433     05  SDT4F PIC  X(0001).
  1434     05  FILLER REDEFINES SDT4F.
  1435         10  SDT4A PIC  X(0001).
  1436     05  SDT4I PIC  X(0006).
  1437*    -------------------------------
  1438     05  MSAAC5L PIC S9(0004) COMP.
  1439     05  MSAAC5F PIC  X(0001).
  1440     05  FILLER REDEFINES MSAAC5F.
  1441         10  MSAAC5A PIC  X(0001).
  1442     05  MSAAC5I PIC  X(0010).
  1443*    -------------------------------
  1444     05  MSAST5L PIC S9(0004) COMP.
  1445     05  MSAST5F PIC  X(0001).
  1446     05  FILLER REDEFINES MSAST5F.
  1447         10  MSAST5A PIC  X(0001).
  1448     05  MSAST5I PIC  X(0002).
  1449*    -------------------------------
  1450     05  MSACN5L PIC S9(0004) COMP.
  1451     05  MSACN5F PIC  X(0001).
  1452     05  FILLER REDEFINES MSACN5F.
  1453         10  MSACN5A PIC  X(0001).
  1454     05  MSACN5I PIC  X(0001).
  1455*    -------------------------------
  1456     05  MSACM5L PIC S9(0004) COMP.
  1457     05  MSACM5F PIC  X(0001).
  1458     05  FILLER REDEFINES MSACM5F.
  1459         10  MSACM5A PIC  X(0001).
  1460     05  MSACM5I PIC  X(0010).
  1461*    -------------------------------
  1462     05  TYPE5L PIC S9(0004) COMP.
  1463     05  TYPE5F PIC  X(0001).
  1464     05  FILLER REDEFINES TYPE5F.
  1465         10  TYPE5A PIC  X(0001).
  1466     05  TYPE5I PIC  X(0001).
  1467*    -------------------------------
  1468     05  AMT5L PIC S9(0004) COMP.
  1469     05  AMT5F PIC  X(0001).
  1470     05  FILLER REDEFINES AMT5F.
  1471         10  AMT5A PIC  X(0001).
  1472     05  AMT5I PIC  X(0011).
  1473*    -------------------------------
  1474     05  VOID5L PIC S9(0004) COMP.
  1475     05  VOID5F PIC  X(0001).
  1476     05  FILLER REDEFINES VOID5F.
  1477         10  VOID5A PIC  X(0001).
  1478     05  VOID5I PIC  X(0001).
  1479*    -------------------------------
  1480     05  MDT5L PIC S9(0004) COMP.
  1481     05  MDT5F PIC  X(0001).
  1482     05  FILLER REDEFINES MDT5F.
  1483         10  MDT5A PIC  X(0001).
  1484     05  MDT5I PIC  X(0006).
  1485*    -------------------------------
  1486     05  BDT5L PIC S9(0004) COMP.
  1487     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  32
* EL633.cbl
  1488     05  FILLER REDEFINES BDT5F.
  1489         10  BDT5A PIC  X(0001).
  1490     05  BDT5I PIC  X(0006).
  1491*    -------------------------------
  1492     05  SDT5L PIC S9(0004) COMP.
  1493     05  SDT5F PIC  X(0001).
  1494     05  FILLER REDEFINES SDT5F.
  1495         10  SDT5A PIC  X(0001).
  1496     05  SDT5I PIC  X(0006).
  1497*    -------------------------------
  1498     05  MSAAC6L PIC S9(0004) COMP.
  1499     05  MSAAC6F PIC  X(0001).
  1500     05  FILLER REDEFINES MSAAC6F.
  1501         10  MSAAC6A PIC  X(0001).
  1502     05  MSAAC6I PIC  X(0010).
  1503*    -------------------------------
  1504     05  MSAST6L PIC S9(0004) COMP.
  1505     05  MSAST6F PIC  X(0001).
  1506     05  FILLER REDEFINES MSAST6F.
  1507         10  MSAST6A PIC  X(0001).
  1508     05  MSAST6I PIC  X(0002).
  1509*    -------------------------------
  1510     05  MSACN6L PIC S9(0004) COMP.
  1511     05  MSACN6F PIC  X(0001).
  1512     05  FILLER REDEFINES MSACN6F.
  1513         10  MSACN6A PIC  X(0001).
  1514     05  MSACN6I PIC  X(0001).
  1515*    -------------------------------
  1516     05  MSACM6L PIC S9(0004) COMP.
  1517     05  MSACM6F PIC  X(0001).
  1518     05  FILLER REDEFINES MSACM6F.
  1519         10  MSACM6A PIC  X(0001).
  1520     05  MSACM6I PIC  X(0010).
  1521*    -------------------------------
  1522     05  TYPE6L PIC S9(0004) COMP.
  1523     05  TYPE6F PIC  X(0001).
  1524     05  FILLER REDEFINES TYPE6F.
  1525         10  TYPE6A PIC  X(0001).
  1526     05  TYPE6I PIC  X(0001).
  1527*    -------------------------------
  1528     05  AMT6L PIC S9(0004) COMP.
  1529     05  AMT6F PIC  X(0001).
  1530     05  FILLER REDEFINES AMT6F.
  1531         10  AMT6A PIC  X(0001).
  1532     05  AMT6I PIC  X(0011).
  1533*    -------------------------------
  1534     05  VOID6L PIC S9(0004) COMP.
  1535     05  VOID6F PIC  X(0001).
  1536     05  FILLER REDEFINES VOID6F.
  1537         10  VOID6A PIC  X(0001).
  1538     05  VOID6I PIC  X(0001).
  1539*    -------------------------------
  1540     05  MDT6L PIC S9(0004) COMP.
  1541     05  MDT6F PIC  X(0001).
  1542     05  FILLER REDEFINES MDT6F.
  1543         10  MDT6A PIC  X(0001).
  1544     05  MDT6I PIC  X(0006).
  1545*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  33
* EL633.cbl
  1546     05  BDT6L PIC S9(0004) COMP.
  1547     05  BDT6F PIC  X(0001).
  1548     05  FILLER REDEFINES BDT6F.
  1549         10  BDT6A PIC  X(0001).
  1550     05  BDT6I PIC  X(0006).
  1551*    -------------------------------
  1552     05  SDT6L PIC S9(0004) COMP.
  1553     05  SDT6F PIC  X(0001).
  1554     05  FILLER REDEFINES SDT6F.
  1555         10  SDT6A PIC  X(0001).
  1556     05  SDT6I PIC  X(0006).
  1557*    -------------------------------
  1558     05  MSAAC7L PIC S9(0004) COMP.
  1559     05  MSAAC7F PIC  X(0001).
  1560     05  FILLER REDEFINES MSAAC7F.
  1561         10  MSAAC7A PIC  X(0001).
  1562     05  MSAAC7I PIC  X(0010).
  1563*    -------------------------------
  1564     05  MSAST7L PIC S9(0004) COMP.
  1565     05  MSAST7F PIC  X(0001).
  1566     05  FILLER REDEFINES MSAST7F.
  1567         10  MSAST7A PIC  X(0001).
  1568     05  MSAST7I PIC  X(0002).
  1569*    -------------------------------
  1570     05  MSACN7L PIC S9(0004) COMP.
  1571     05  MSACN7F PIC  X(0001).
  1572     05  FILLER REDEFINES MSACN7F.
  1573         10  MSACN7A PIC  X(0001).
  1574     05  MSACN7I PIC  X(0001).
  1575*    -------------------------------
  1576     05  MSACM7L PIC S9(0004) COMP.
  1577     05  MSACM7F PIC  X(0001).
  1578     05  FILLER REDEFINES MSACM7F.
  1579         10  MSACM7A PIC  X(0001).
  1580     05  MSACM7I PIC  X(0010).
  1581*    -------------------------------
  1582     05  TYPE7L PIC S9(0004) COMP.
  1583     05  TYPE7F PIC  X(0001).
  1584     05  FILLER REDEFINES TYPE7F.
  1585         10  TYPE7A PIC  X(0001).
  1586     05  TYPE7I PIC  X(0001).
  1587*    -------------------------------
  1588     05  AMT7L PIC S9(0004) COMP.
  1589     05  AMT7F PIC  X(0001).
  1590     05  FILLER REDEFINES AMT7F.
  1591         10  AMT7A PIC  X(0001).
  1592     05  AMT7I PIC  X(0011).
  1593*    -------------------------------
  1594     05  VOID7L PIC S9(0004) COMP.
  1595     05  VOID7F PIC  X(0001).
  1596     05  FILLER REDEFINES VOID7F.
  1597         10  VOID7A PIC  X(0001).
  1598     05  VOID7I PIC  X(0001).
  1599*    -------------------------------
  1600     05  MDT7L PIC S9(0004) COMP.
  1601     05  MDT7F PIC  X(0001).
  1602     05  FILLER REDEFINES MDT7F.
  1603         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  34
* EL633.cbl
  1604     05  MDT7I PIC  X(0006).
  1605*    -------------------------------
  1606     05  BDT7L PIC S9(0004) COMP.
  1607     05  BDT7F PIC  X(0001).
  1608     05  FILLER REDEFINES BDT7F.
  1609         10  BDT7A PIC  X(0001).
  1610     05  BDT7I PIC  X(0006).
  1611*    -------------------------------
  1612     05  SDT7L PIC S9(0004) COMP.
  1613     05  SDT7F PIC  X(0001).
  1614     05  FILLER REDEFINES SDT7F.
  1615         10  SDT7A PIC  X(0001).
  1616     05  SDT7I PIC  X(0006).
  1617*    -------------------------------
  1618     05  MSAAC8L PIC S9(0004) COMP.
  1619     05  MSAAC8F PIC  X(0001).
  1620     05  FILLER REDEFINES MSAAC8F.
  1621         10  MSAAC8A PIC  X(0001).
  1622     05  MSAAC8I PIC  X(0010).
  1623*    -------------------------------
  1624     05  MSAST8L PIC S9(0004) COMP.
  1625     05  MSAST8F PIC  X(0001).
  1626     05  FILLER REDEFINES MSAST8F.
  1627         10  MSAST8A PIC  X(0001).
  1628     05  MSAST8I PIC  X(0002).
  1629*    -------------------------------
  1630     05  MSACN8L PIC S9(0004) COMP.
  1631     05  MSACN8F PIC  X(0001).
  1632     05  FILLER REDEFINES MSACN8F.
  1633         10  MSACN8A PIC  X(0001).
  1634     05  MSACN8I PIC  X(0001).
  1635*    -------------------------------
  1636     05  MSACM8L PIC S9(0004) COMP.
  1637     05  MSACM8F PIC  X(0001).
  1638     05  FILLER REDEFINES MSACM8F.
  1639         10  MSACM8A PIC  X(0001).
  1640     05  MSACM8I PIC  X(0010).
  1641*    -------------------------------
  1642     05  TYPE8L PIC S9(0004) COMP.
  1643     05  TYPE8F PIC  X(0001).
  1644     05  FILLER REDEFINES TYPE8F.
  1645         10  TYPE8A PIC  X(0001).
  1646     05  TYPE8I PIC  X(0001).
  1647*    -------------------------------
  1648     05  AMT8L PIC S9(0004) COMP.
  1649     05  AMT8F PIC  X(0001).
  1650     05  FILLER REDEFINES AMT8F.
  1651         10  AMT8A PIC  X(0001).
  1652     05  AMT8I PIC  X(0011).
  1653*    -------------------------------
  1654     05  VOID8L PIC S9(0004) COMP.
  1655     05  VOID8F PIC  X(0001).
  1656     05  FILLER REDEFINES VOID8F.
  1657         10  VOID8A PIC  X(0001).
  1658     05  VOID8I PIC  X(0001).
  1659*    -------------------------------
  1660     05  MDT8L PIC S9(0004) COMP.
  1661     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  35
* EL633.cbl
  1662     05  FILLER REDEFINES MDT8F.
  1663         10  MDT8A PIC  X(0001).
  1664     05  MDT8I PIC  X(0006).
  1665*    -------------------------------
  1666     05  BDT8L PIC S9(0004) COMP.
  1667     05  BDT8F PIC  X(0001).
  1668     05  FILLER REDEFINES BDT8F.
  1669         10  BDT8A PIC  X(0001).
  1670     05  BDT8I PIC  X(0006).
  1671*    -------------------------------
  1672     05  SDT8L PIC S9(0004) COMP.
  1673     05  SDT8F PIC  X(0001).
  1674     05  FILLER REDEFINES SDT8F.
  1675         10  SDT8A PIC  X(0001).
  1676     05  SDT8I PIC  X(0006).
  1677*    -------------------------------
  1678     05  MSAAC9L PIC S9(0004) COMP.
  1679     05  MSAAC9F PIC  X(0001).
  1680     05  FILLER REDEFINES MSAAC9F.
  1681         10  MSAAC9A PIC  X(0001).
  1682     05  MSAAC9I PIC  X(0010).
  1683*    -------------------------------
  1684     05  MSAST9L PIC S9(0004) COMP.
  1685     05  MSAST9F PIC  X(0001).
  1686     05  FILLER REDEFINES MSAST9F.
  1687         10  MSAST9A PIC  X(0001).
  1688     05  MSAST9I PIC  X(0002).
  1689*    -------------------------------
  1690     05  MSACN9L PIC S9(0004) COMP.
  1691     05  MSACN9F PIC  X(0001).
  1692     05  FILLER REDEFINES MSACN9F.
  1693         10  MSACN9A PIC  X(0001).
  1694     05  MSACN9I PIC  X(0001).
  1695*    -------------------------------
  1696     05  MSACM9L PIC S9(0004) COMP.
  1697     05  MSACM9F PIC  X(0001).
  1698     05  FILLER REDEFINES MSACM9F.
  1699         10  MSACM9A PIC  X(0001).
  1700     05  MSACM9I PIC  X(0010).
  1701*    -------------------------------
  1702     05  TYPE9L PIC S9(0004) COMP.
  1703     05  TYPE9F PIC  X(0001).
  1704     05  FILLER REDEFINES TYPE9F.
  1705         10  TYPE9A PIC  X(0001).
  1706     05  TYPE9I PIC  X(0001).
  1707*    -------------------------------
  1708     05  AMT9L PIC S9(0004) COMP.
  1709     05  AMT9F PIC  X(0001).
  1710     05  FILLER REDEFINES AMT9F.
  1711         10  AMT9A PIC  X(0001).
  1712     05  AMT9I PIC  X(0011).
  1713*    -------------------------------
  1714     05  VOID9L PIC S9(0004) COMP.
  1715     05  VOID9F PIC  X(0001).
  1716     05  FILLER REDEFINES VOID9F.
  1717         10  VOID9A PIC  X(0001).
  1718     05  VOID9I PIC  X(0001).
  1719*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  36
* EL633.cbl
  1720     05  MDT9L PIC S9(0004) COMP.
  1721     05  MDT9F PIC  X(0001).
  1722     05  FILLER REDEFINES MDT9F.
  1723         10  MDT9A PIC  X(0001).
  1724     05  MDT9I PIC  X(0006).
  1725*    -------------------------------
  1726     05  BDT9L PIC S9(0004) COMP.
  1727     05  BDT9F PIC  X(0001).
  1728     05  FILLER REDEFINES BDT9F.
  1729         10  BDT9A PIC  X(0001).
  1730     05  BDT9I PIC  X(0006).
  1731*    -------------------------------
  1732     05  SDT9L PIC S9(0004) COMP.
  1733     05  SDT9F PIC  X(0001).
  1734     05  FILLER REDEFINES SDT9F.
  1735         10  SDT9A PIC  X(0001).
  1736     05  SDT9I PIC  X(0006).
  1737*    -------------------------------
  1738     05  MSAAC10L PIC S9(0004) COMP.
  1739     05  MSAAC10F PIC  X(0001).
  1740     05  FILLER REDEFINES MSAAC10F.
  1741         10  MSAAC10A PIC  X(0001).
  1742     05  MSAAC10I PIC  X(0010).
  1743*    -------------------------------
  1744     05  MSAST10L PIC S9(0004) COMP.
  1745     05  MSAST10F PIC  X(0001).
  1746     05  FILLER REDEFINES MSAST10F.
  1747         10  MSAST10A PIC  X(0001).
  1748     05  MSAST10I PIC  X(0002).
  1749*    -------------------------------
  1750     05  MSACN10L PIC S9(0004) COMP.
  1751     05  MSACN10F PIC  X(0001).
  1752     05  FILLER REDEFINES MSACN10F.
  1753         10  MSACN10A PIC  X(0001).
  1754     05  MSACN10I PIC  X(0001).
  1755*    -------------------------------
  1756     05  MSACM10L PIC S9(0004) COMP.
  1757     05  MSACM10F PIC  X(0001).
  1758     05  FILLER REDEFINES MSACM10F.
  1759         10  MSACM10A PIC  X(0001).
  1760     05  MSACM10I PIC  X(0010).
  1761*    -------------------------------
  1762     05  TYPE10L PIC S9(0004) COMP.
  1763     05  TYPE10F PIC  X(0001).
  1764     05  FILLER REDEFINES TYPE10F.
  1765         10  TYPE10A PIC  X(0001).
  1766     05  TYPE10I PIC  X(0001).
  1767*    -------------------------------
  1768     05  AMT10L PIC S9(0004) COMP.
  1769     05  AMT10F PIC  X(0001).
  1770     05  FILLER REDEFINES AMT10F.
  1771         10  AMT10A PIC  X(0001).
  1772     05  AMT10I PIC  X(0011).
  1773*    -------------------------------
  1774     05  VOID10L PIC S9(0004) COMP.
  1775     05  VOID10F PIC  X(0001).
  1776     05  FILLER REDEFINES VOID10F.
  1777         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  37
* EL633.cbl
  1778     05  VOID10I PIC  X(0001).
  1779*    -------------------------------
  1780     05  MDT10L PIC S9(0004) COMP.
  1781     05  MDT10F PIC  X(0001).
  1782     05  FILLER REDEFINES MDT10F.
  1783         10  MDT10A PIC  X(0001).
  1784     05  MDT10I PIC  X(0006).
  1785*    -------------------------------
  1786     05  BDT10L PIC S9(0004) COMP.
  1787     05  BDT10F PIC  X(0001).
  1788     05  FILLER REDEFINES BDT10F.
  1789         10  BDT10A PIC  X(0001).
  1790     05  BDT10I PIC  X(0006).
  1791*    -------------------------------
  1792     05  SDT10L PIC S9(0004) COMP.
  1793     05  SDT10F PIC  X(0001).
  1794     05  FILLER REDEFINES SDT10F.
  1795         10  SDT10A PIC  X(0001).
  1796     05  SDT10I PIC  X(0006).
  1797*    -------------------------------
  1798     05  MSAAC11L PIC S9(0004) COMP.
  1799     05  MSAAC11F PIC  X(0001).
  1800     05  FILLER REDEFINES MSAAC11F.
  1801         10  MSAAC11A PIC  X(0001).
  1802     05  MSAAC11I PIC  X(0010).
  1803*    -------------------------------
  1804     05  MSAST11L PIC S9(0004) COMP.
  1805     05  MSAST11F PIC  X(0001).
  1806     05  FILLER REDEFINES MSAST11F.
  1807         10  MSAST11A PIC  X(0001).
  1808     05  MSAST11I PIC  X(0002).
  1809*    -------------------------------
  1810     05  MSACN11L PIC S9(0004) COMP.
  1811     05  MSACN11F PIC  X(0001).
  1812     05  FILLER REDEFINES MSACN11F.
  1813         10  MSACN11A PIC  X(0001).
  1814     05  MSACN11I PIC  X(0001).
  1815*    -------------------------------
  1816     05  MSACM11L PIC S9(0004) COMP.
  1817     05  MSACM11F PIC  X(0001).
  1818     05  FILLER REDEFINES MSACM11F.
  1819         10  MSACM11A PIC  X(0001).
  1820     05  MSACM11I PIC  X(0010).
  1821*    -------------------------------
  1822     05  TYPE11L PIC S9(0004) COMP.
  1823     05  TYPE11F PIC  X(0001).
  1824     05  FILLER REDEFINES TYPE11F.
  1825         10  TYPE11A PIC  X(0001).
  1826     05  TYPE11I PIC  X(0001).
  1827*    -------------------------------
  1828     05  AMT11L PIC S9(0004) COMP.
  1829     05  AMT11F PIC  X(0001).
  1830     05  FILLER REDEFINES AMT11F.
  1831         10  AMT11A PIC  X(0001).
  1832     05  AMT11I PIC  X(0011).
  1833*    -------------------------------
  1834     05  VOID11L PIC S9(0004) COMP.
  1835     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  38
* EL633.cbl
  1836     05  FILLER REDEFINES VOID11F.
  1837         10  VOID11A PIC  X(0001).
  1838     05  VOID11I PIC  X(0001).
  1839*    -------------------------------
  1840     05  MDT11L PIC S9(0004) COMP.
  1841     05  MDT11F PIC  X(0001).
  1842     05  FILLER REDEFINES MDT11F.
  1843         10  MDT11A PIC  X(0001).
  1844     05  MDT11I PIC  X(0006).
  1845*    -------------------------------
  1846     05  BDT11L PIC S9(0004) COMP.
  1847     05  BDT11F PIC  X(0001).
  1848     05  FILLER REDEFINES BDT11F.
  1849         10  BDT11A PIC  X(0001).
  1850     05  BDT11I PIC  X(0006).
  1851*    -------------------------------
  1852     05  SDT11L PIC S9(0004) COMP.
  1853     05  SDT11F PIC  X(0001).
  1854     05  FILLER REDEFINES SDT11F.
  1855         10  SDT11A PIC  X(0001).
  1856     05  SDT11I PIC  X(0006).
  1857*    -------------------------------
  1858     05  MSAAC12L PIC S9(0004) COMP.
  1859     05  MSAAC12F PIC  X(0001).
  1860     05  FILLER REDEFINES MSAAC12F.
  1861         10  MSAAC12A PIC  X(0001).
  1862     05  MSAAC12I PIC  X(0010).
  1863*    -------------------------------
  1864     05  MSAST12L PIC S9(0004) COMP.
  1865     05  MSAST12F PIC  X(0001).
  1866     05  FILLER REDEFINES MSAST12F.
  1867         10  MSAST12A PIC  X(0001).
  1868     05  MSAST12I PIC  X(0002).
  1869*    -------------------------------
  1870     05  MSACN12L PIC S9(0004) COMP.
  1871     05  MSACN12F PIC  X(0001).
  1872     05  FILLER REDEFINES MSACN12F.
  1873         10  MSACN12A PIC  X(0001).
  1874     05  MSACN12I PIC  X(0001).
  1875*    -------------------------------
  1876     05  MSACM12L PIC S9(0004) COMP.
  1877     05  MSACM12F PIC  X(0001).
  1878     05  FILLER REDEFINES MSACM12F.
  1879         10  MSACM12A PIC  X(0001).
  1880     05  MSACM12I PIC  X(0010).
  1881*    -------------------------------
  1882     05  TYPE12L PIC S9(0004) COMP.
  1883     05  TYPE12F PIC  X(0001).
  1884     05  FILLER REDEFINES TYPE12F.
  1885         10  TYPE12A PIC  X(0001).
  1886     05  TYPE12I PIC  X(0001).
  1887*    -------------------------------
  1888     05  AMT12L PIC S9(0004) COMP.
  1889     05  AMT12F PIC  X(0001).
  1890     05  FILLER REDEFINES AMT12F.
  1891         10  AMT12A PIC  X(0001).
  1892     05  AMT12I PIC  X(0011).
  1893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  39
* EL633.cbl
  1894     05  VOID12L PIC S9(0004) COMP.
  1895     05  VOID12F PIC  X(0001).
  1896     05  FILLER REDEFINES VOID12F.
  1897         10  VOID12A PIC  X(0001).
  1898     05  VOID12I PIC  X(0001).
  1899*    -------------------------------
  1900     05  MDT12L PIC S9(0004) COMP.
  1901     05  MDT12F PIC  X(0001).
  1902     05  FILLER REDEFINES MDT12F.
  1903         10  MDT12A PIC  X(0001).
  1904     05  MDT12I PIC  X(0006).
  1905*    -------------------------------
  1906     05  BDT12L PIC S9(0004) COMP.
  1907     05  BDT12F PIC  X(0001).
  1908     05  FILLER REDEFINES BDT12F.
  1909         10  BDT12A PIC  X(0001).
  1910     05  BDT12I PIC  X(0006).
  1911*    -------------------------------
  1912     05  SDT12L PIC S9(0004) COMP.
  1913     05  SDT12F PIC  X(0001).
  1914     05  FILLER REDEFINES SDT12F.
  1915         10  SDT12A PIC  X(0001).
  1916     05  SDT12I PIC  X(0006).
  1917*    -------------------------------
  1918     05  MSAAC13L PIC S9(0004) COMP.
  1919     05  MSAAC13F PIC  X(0001).
  1920     05  FILLER REDEFINES MSAAC13F.
  1921         10  MSAAC13A PIC  X(0001).
  1922     05  MSAAC13I PIC  X(0010).
  1923*    -------------------------------
  1924     05  MSAST13L PIC S9(0004) COMP.
  1925     05  MSAST13F PIC  X(0001).
  1926     05  FILLER REDEFINES MSAST13F.
  1927         10  MSAST13A PIC  X(0001).
  1928     05  MSAST13I PIC  X(0002).
  1929*    -------------------------------
  1930     05  MSACN13L PIC S9(0004) COMP.
  1931     05  MSACN13F PIC  X(0001).
  1932     05  FILLER REDEFINES MSACN13F.
  1933         10  MSACN13A PIC  X(0001).
  1934     05  MSACN13I PIC  X(0001).
  1935*    -------------------------------
  1936     05  MSACM13L PIC S9(0004) COMP.
  1937     05  MSACM13F PIC  X(0001).
  1938     05  FILLER REDEFINES MSACM13F.
  1939         10  MSACM13A PIC  X(0001).
  1940     05  MSACM13I PIC  X(0010).
  1941*    -------------------------------
  1942     05  TYPE13L PIC S9(0004) COMP.
  1943     05  TYPE13F PIC  X(0001).
  1944     05  FILLER REDEFINES TYPE13F.
  1945         10  TYPE13A PIC  X(0001).
  1946     05  TYPE13I PIC  X(0001).
  1947*    -------------------------------
  1948     05  AMT13L PIC S9(0004) COMP.
  1949     05  AMT13F PIC  X(0001).
  1950     05  FILLER REDEFINES AMT13F.
  1951         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  40
* EL633.cbl
  1952     05  AMT13I PIC  X(0011).
  1953*    -------------------------------
  1954     05  VOID13L PIC S9(0004) COMP.
  1955     05  VOID13F PIC  X(0001).
  1956     05  FILLER REDEFINES VOID13F.
  1957         10  VOID13A PIC  X(0001).
  1958     05  VOID13I PIC  X(0001).
  1959*    -------------------------------
  1960     05  MDT13L PIC S9(0004) COMP.
  1961     05  MDT13F PIC  X(0001).
  1962     05  FILLER REDEFINES MDT13F.
  1963         10  MDT13A PIC  X(0001).
  1964     05  MDT13I PIC  X(0006).
  1965*    -------------------------------
  1966     05  BDT13L PIC S9(0004) COMP.
  1967     05  BDT13F PIC  X(0001).
  1968     05  FILLER REDEFINES BDT13F.
  1969         10  BDT13A PIC  X(0001).
  1970     05  BDT13I PIC  X(0006).
  1971*    -------------------------------
  1972     05  SDT13L PIC S9(0004) COMP.
  1973     05  SDT13F PIC  X(0001).
  1974     05  FILLER REDEFINES SDT13F.
  1975         10  SDT13A PIC  X(0001).
  1976     05  SDT13I PIC  X(0006).
  1977*    -------------------------------
  1978     05  ERRMSG1L PIC S9(0004) COMP.
  1979     05  ERRMSG1F PIC  X(0001).
  1980     05  FILLER REDEFINES ERRMSG1F.
  1981         10  ERRMSG1A PIC  X(0001).
  1982     05  ERRMSG1I PIC  X(0079).
  1983*    -------------------------------
  1984     05  ERRMSG2L PIC S9(0004) COMP.
  1985     05  ERRMSG2F PIC  X(0001).
  1986     05  FILLER REDEFINES ERRMSG2F.
  1987         10  ERRMSG2A PIC  X(0001).
  1988     05  ERRMSG2I PIC  X(0079).
  1989*    -------------------------------
  1990     05  PFENTERL PIC S9(0004) COMP.
  1991     05  PFENTERF PIC  X(0001).
  1992     05  FILLER REDEFINES PFENTERF.
  1993         10  PFENTERA PIC  X(0001).
  1994     05  PFENTERI PIC  9(2).
  1995 01  EL633AO REDEFINES EL633AI.
  1996     05  FILLER            PIC  X(0012).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  DATEO PIC  X(0008).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  TIMEO PIC  99.99.
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  CMPNYIDO PIC  X(0003).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  USERIDO PIC  X(0004).
  2009*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  41
* EL633.cbl
  2010     05  FILLER            PIC  X(0003).
  2011     05  MAINTO PIC  X(0001).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  CARRIERO PIC  X(0001).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  GROUPO PIC  X(0006).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  FINRESPO PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  ACCTO PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  MSAAC1O PIC  X(0010).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  MSAST1O PIC  X(0002).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  MSACN1O PIC  X(0001).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  MSACM1O PIC  X(0010).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  TYPE1O PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  AMT1O PIC  X(0011).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  VOID1O PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  MDT1O PIC  X(0006).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  BDT1O PIC  X(0006).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  SDT1O PIC  X(0006).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  MSAAC2O PIC  X(0010).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  MSAST2O PIC  X(0002).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  MSACN2O PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  MSACM2O PIC  X(0010).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  42
* EL633.cbl
  2068     05  TYPE2O PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  AMT2O PIC  X(0011).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  VOID2O PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  MDT2O PIC  X(0006).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  BDT2O PIC  X(0006).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  SDT2O PIC  X(0006).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  MSAAC3O PIC  X(0010).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  MSAST3O PIC  X(0002).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  MSACN3O PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  MSACM3O PIC  X(0010).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  TYPE3O PIC  X(0001).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  AMT3O PIC  X(0011).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  VOID3O PIC  X(0001).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MDT3O PIC  X(0006).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  BDT3O PIC  X(0006).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  SDT3O PIC  X(0006).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MSAAC4O PIC  X(0010).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  MSAST4O PIC  X(0002).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  MSACN4O PIC  X(0001).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  43
* EL633.cbl
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  TYPE4O PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  AMT4O PIC  X(0011).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  VOID4O PIC  X(0001).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  MDT4O PIC  X(0006).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  BDT4O PIC  X(0006).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  SDT4O PIC  X(0006).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  MSAAC5O PIC  X(0010).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  MSAST5O PIC  X(0002).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  MSACN5O PIC  X(0001).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  MSACM5O PIC  X(0010).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  TYPE5O PIC  X(0001).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  AMT5O PIC  X(0011).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  VOID5O PIC  X(0001).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  MDT5O PIC  X(0006).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  BDT5O PIC  X(0006).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  SDT5O PIC  X(0006).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  MSAAC6O PIC  X(0010).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  MSAST6O PIC  X(0002).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  MSACN6O PIC  X(0001).
  2183*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  44
* EL633.cbl
  2184     05  FILLER            PIC  X(0003).
  2185     05  MSACM6O PIC  X(0010).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  TYPE6O PIC  X(0001).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  AMT6O PIC  X(0011).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  VOID6O PIC  X(0001).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  MDT6O PIC  X(0006).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  BDT6O PIC  X(0006).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  SDT6O PIC  X(0006).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  MSAAC7O PIC  X(0010).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  MSAST7O PIC  X(0002).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  MSACN7O PIC  X(0001).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  MSACM7O PIC  X(0010).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  TYPE7O PIC  X(0001).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  AMT7O PIC  X(0011).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  VOID7O PIC  X(0001).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  MDT7O PIC  X(0006).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  BDT7O PIC  X(0006).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  SDT7O PIC  X(0006).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  MSAAC8O PIC  X(0010).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  MSAST8O PIC  X(0002).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  45
* EL633.cbl
  2242     05  MSACN8O PIC  X(0001).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  MSACM8O PIC  X(0010).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  TYPE8O PIC  X(0001).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  AMT8O PIC  X(0011).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  VOID8O PIC  X(0001).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  MDT8O PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  BDT8O PIC  X(0006).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  SDT8O PIC  X(0006).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MSAAC9O PIC  X(0010).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  MSAST9O PIC  X(0002).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  MSACN9O PIC  X(0001).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  MSACM9O PIC  X(0010).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  TYPE9O PIC  X(0001).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  AMT9O PIC  X(0011).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  VOID9O PIC  X(0001).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  MDT9O PIC  X(0006).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  BDT9O PIC  X(0006).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  SDT9O PIC  X(0006).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  MSAAC10O PIC  X(0010).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  46
* EL633.cbl
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  MSACN10O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  MSACM10O PIC  X(0010).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  TYPE10O PIC  X(0001).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  AMT10O PIC  X(0011).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  VOID10O PIC  X(0001).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  MDT10O PIC  X(0006).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BDT10O PIC  X(0006).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  SDT10O PIC  X(0006).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSAAC11O PIC  X(0010).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  MSAST11O PIC  X(0002).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  MSACN11O PIC  X(0001).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  MSACM11O PIC  X(0010).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  TYPE11O PIC  X(0001).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  AMT11O PIC  X(0011).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  VOID11O PIC  X(0001).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  MDT11O PIC  X(0006).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  BDT11O PIC  X(0006).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  SDT11O PIC  X(0006).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  MSAAC12O PIC  X(0010).
  2357*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  47
* EL633.cbl
  2358     05  FILLER            PIC  X(0003).
  2359     05  MSAST12O PIC  X(0002).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  MSACN12O PIC  X(0001).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  MSACM12O PIC  X(0010).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  TYPE12O PIC  X(0001).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  AMT12O PIC  X(0011).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  VOID12O PIC  X(0001).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  MDT12O PIC  X(0006).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  BDT12O PIC  X(0006).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  SDT12O PIC  X(0006).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  MSAAC13O PIC  X(0010).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  MSAST13O PIC  X(0002).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  MSACN13O PIC  X(0001).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  MSACM13O PIC  X(0010).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  TYPE13O PIC  X(0001).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  AMT13O PIC  X(0011).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  VOID13O PIC  X(0001).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  MDT13O PIC  X(0006).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  BDT13O PIC  X(0006).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  SDT13O PIC  X(0006).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  48
* EL633.cbl
  2416     05  ERRMSG1O PIC  X(0079).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  ERRMSG2O PIC  X(0079).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  PFENTERO PIC  X(0002).
  2423*    -------------------------------
  2424
  2425 01  MAP-EL633A  REDEFINES  EL633AI.
  2426     12  FILLER                  PIC  X(87).
  2427     12  DATA-AREA       OCCURS 13 TIMES
  2428                             INDEXED BY PINDX.
  2429         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2430         16  GL-ACCT-ATTRB       PIC  X.
  2431         16  GL-ACCT             PIC  X(10).
  2432         16  WSL-COMM  REDEFINES GL-ACCT.
  2433             20  WSL-COMM-DTE.
  2434                 24  WSL-MO      PIC  X(2).
  2435                 24  WSL-DA      PIC  X(2).
  2436                 24  WSL-YR      PIC  X(2).
  2437             20  WSL-COMM-REST   PIC  X(4).
  2438         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2439         16  GL-STATE-ATTRB      PIC  X.
  2440         16  GL-STATE            PIC  X(02).
  2441         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2442         16  GL-CANC-ATTRB       PIC  X.
  2443         16  GL-CANC             PIC  X.
  2444         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2445         16  GL-COMM-ATTRB       PIC  X.
  2446         16  GL-COMM             PIC  X(10).
  2447         16  RTYPE-LEN           PIC S9(4)              COMP.
  2448         16  RTYPE-ATTRB         PIC  X.
  2449         16  RTYPE               PIC  X.
  2450         16  AMT-LEN             PIC S9(4)              COMP.
  2451         16  AMT-ATTRB           PIC  X.
  2452         16  AMT                 PIC S9(9)V9(2).
  2453         16  AMTO  REDEFINES
  2454             AMT                 PIC Z(7).9(2)-.
  2455         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2456         16  VOID-SW-ATTRB       PIC  X.
  2457         16  VOID-SW             PIC  X.
  2458         16  MDTE-LEN            PIC S9(4)              COMP.
  2459         16  MDTE-ATTRB          PIC  X.
  2460         16  MDTE                PIC  X(6).
  2461         16  BDTE-LEN            PIC S9(4)              COMP.
  2462         16  BDTE-ATTRB          PIC  X.
  2463         16  BDTE                PIC  X(6).
  2464         16  SDTE-LEN            PIC S9(4)              COMP.
  2465         16  SDTE-ATTRB          PIC  X.
  2466         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  49
* EL633.cbl
  2468****************************************************************
  2469*
  2470* Copyright (c) 2007-2013 Dell Inc.
  2471* All rights reserved.
  2472*
  2473****************************************************************
  2474 01  DFHEIV.
  2475   02  DFHEIV0               PIC X(35).
  2476   02  DFHEIV1               PIC X(08).
  2477   02  DFHEIV2               PIC X(08).
  2478   02  DFHEIV3               PIC X(08).
  2479   02  DFHEIV4               PIC X(06).
  2480   02  DFHEIV5               PIC X(04).
  2481   02  DFHEIV6               PIC X(04).
  2482   02  DFHEIV7               PIC X(02).
  2483   02  DFHEIV8               PIC X(02).
  2484   02  DFHEIV9               PIC X(01).
  2485   02  DFHEIV10              PIC S9(7) COMP-3.
  2486   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2487   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2488   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2489   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2490   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2491   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2492   02  DFHEIV17              PIC X(04).
  2493   02  DFHEIV18              PIC X(04).
  2494   02  DFHEIV19              PIC X(04).
  2495   02  DFHEIV20              USAGE IS POINTER.
  2496   02  DFHEIV21              USAGE IS POINTER.
  2497   02  DFHEIV22              USAGE IS POINTER.
  2498   02  DFHEIV23              USAGE IS POINTER.
  2499   02  DFHEIV24              USAGE IS POINTER.
  2500   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2501   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2502   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2503   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2504   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2505   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2506   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2507   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2508   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2509   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2510   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2511   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2512   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2513   02  FILLER                PIC X(02).
  2514   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2515   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2516   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2517   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2518   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2519   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2520   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2521 LINKAGE  SECTION.
  2522*****************************************************************
  2523*                                                               *
  2524* Copyright (c) 2007-2013 Dell Inc.                             *
  2525* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  50
* EL633.cbl
  2526*                                                               *
  2527*****************************************************************
  2528 01  dfheiblk.
  2529     02  eibtime          pic s9(7) comp-3.
  2530     02  eibdate          pic s9(7) comp-3.
  2531     02  eibtrnid         pic x(4).
  2532     02  eibtaskn         pic s9(7) comp-3.
  2533     02  eibtrmid         pic x(4).
  2534     02  dfheigdi         pic s9(4) comp.
  2535     02  eibcposn         pic s9(4) comp.
  2536     02  eibcalen         pic s9(4) comp.
  2537     02  eibaid           pic x(1).
  2538     02  eibfiller1       pic x(1).
  2539     02  eibfn            pic x(2).
  2540     02  eibfiller2       pic x(2).
  2541     02  eibrcode         pic x(6).
  2542     02  eibfiller3       pic x(2).
  2543     02  eibds            pic x(8).
  2544     02  eibreqid         pic x(8).
  2545     02  eibrsrce         pic x(8).
  2546     02  eibsync          pic x(1).
  2547     02  eibfree          pic x(1).
  2548     02  eibrecv          pic x(1).
  2549     02  eibsend          pic x(1).
  2550     02  eibatt           pic x(1).
  2551     02  eibeoc           pic x(1).
  2552     02  eibfmh           pic x(1).
  2553     02  eibcompl         pic x(1).
  2554     02  eibsig           pic x(1).
  2555     02  eibconf          pic x(1).
  2556     02  eiberr           pic x(1).
  2557     02  eibrldbk         pic x(1).
  2558     02  eiberrcd         pic x(4).
  2559     02  eibsynrb         pic x(1).
  2560     02  eibnodat         pic x(1).
  2561     02  eibfiller5       pic x(2).
  2562     02  eibresp          pic s9(8) comp.
  2563     02  eibresp2         pic s9(8) comp.
  2564     02  dfheigdj         pic s9(4) comp.
  2565     02  dfheigdk         pic s9(4) comp.
  2566 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  51
* EL633.cbl
  2567/
  2568*                            COPY ERCCHKQ.
  2569******************************************************************
  2570*                                                                *
  2571*                                                                *
  2572*                            ERCCHKQ                             *
  2573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2574*                            VMOD=2.005                          *
  2575*                                                                *
  2576*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2577*                                                                *
  2578*   FILE TYPE = VSAM,KSDS                                        *
  2579*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2580*                                                                *
  2581*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2582*       ALTERNATE PATH  = NONE                                   *
  2583*                                                                *
  2584*   LOG = YES                                                    *
  2585*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2586******************************************************************
  2587 01  CHECK-QUE.
  2588     12  CQ-RECORD-ID                PIC XX.
  2589         88  VALID-CQ-ID                     VALUE 'CQ'.
  2590
  2591     12  CQ-CONTROL-PRIMARY.
  2592         16  CQ-COMPANY-CD           PIC X.
  2593         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2594         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2595
  2596     12  CQ-ENTRY-TYPE               PIC X.
  2597             88  CHECK-ON-QUE           VALUE 'Q'.
  2598             88  ALIGNMENT-CHECK        VALUE 'A'.
  2599             88  MANUAL-CHECK           VALUE 'M'.
  2600             88  SPOILED-CHECK          VALUE 'S'.
  2601             88  VOIDED-CHECK           VALUE 'V'.
  2602             88  PAYMENT-ABORTED        VALUE 'X'.
  2603
  2604     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2605
  2606     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2607         CQ-CREDIT-MASTER-CNTL.
  2608         16  CQ-PYAJ-CARRIER         PIC X.
  2609         16  CQ-PYAJ-GROUPING        PIC X(6).
  2610         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2611         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2612         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2613         16  CQ-PYAJ-REC-TYPE        PIC X.
  2614         16  FILLER                  PIC X(18).
  2615
  2616     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2617         CQ-CREDIT-MASTER-CNTL.
  2618         16  CQ-CHEK-CARRIER         PIC X.
  2619         16  CQ-CHEK-GROUPING        PIC X(6).
  2620         16  CQ-CHEK-STATE           PIC XX.
  2621         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2622         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2623         16  CQ-CHEK-CERT-NO.
  2624             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  52
* EL633.cbl
  2625             20  CQ-CHEK-CERT-SFX    PIC X.
  2626         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2627         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2628         16  FILLER                  PIC X(06).
  2629
  2630     12  CQ-CHECK-NUMBER             PIC X(7).
  2631     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2632     12  CQ-PAYMENT-TYPE             PIC X.
  2633             88  CQ-BILLING-CREDIT         VALUE '1'.
  2634             88  CQ-REFUND-PMT             VALUE '2'.
  2635             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2636     12  CQ-VOID-INDICATOR           PIC X.
  2637             88  CHECK-IS-VOID             VALUE 'V'.
  2638     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2639     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2640     12  CQ-CHECK-BY-USER            PIC X(4).
  2641     12  CQ-PRE-NUMBERING-SW         PIC X.
  2642       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2643       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2644
  2645     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2646     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2647     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2648     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2649
  2650     12  CQ-LETTERS-IND              PIC X.
  2651         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2652
  2653******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  53
* EL633.cbl
  2654/
  2655*                            COPY ERCPYAJ.
  2656******************************************************************
  2657*                                                                *
  2658*                            ERCPYAJ                             *
  2659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2660*                            VMOD=2.015                          *
  2661*                                                                *
  2662*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2663*                                                                *
  2664*                                                                *
  2665*   FILE TYPE = VSAM,KSDS                                        *
  2666*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2667*                                                                *
  2668*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2669*       ALTERNATE PATHS = NONE                                   *
  2670*                                                                *
  2671*   LOG = YES                                                    *
  2672*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2673******************************************************************
  2674******************************************************************
  2675*                   C H A N G E   L O G
  2676*
  2677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2678*-----------------------------------------------------------------
  2679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2680* EFFECTIVE    NUMBER
  2681*-----------------------------------------------------------------
  2682* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2683* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2684******************************************************************
  2685
  2686 01  PENDING-PAY-ADJ.
  2687     12  PY-RECORD-ID                     PIC XX.
  2688         88  VALID-PY-ID                        VALUE 'PY'.
  2689
  2690     12  PY-CONTROL-PRIMARY.
  2691         16  PY-COMPANY-CD                PIC X.
  2692         16  PY-CARRIER                   PIC X.
  2693         16  PY-GROUPING                  PIC X(6).
  2694         16  PY-FIN-RESP                  PIC X(10).
  2695         16  PY-ACCOUNT                   PIC X(10).
  2696         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2697                                          PIC X(10).
  2698         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2699         16  PY-RECORD-TYPE               PIC X.
  2700             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2701             88  PY-DEPOSIT                   VALUE 'D'.
  2702             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2703             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2704             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2705             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2706             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2707             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2708             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2709             88  PY-FICA-ENTRY                VALUE 'F'.
  2710             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2711             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  54
* EL633.cbl
  2712             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2713
  2714     12  PY-PYMT-TYPE                     PIC X.
  2715             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2716             88  PY-REINS-PYMT                VALUE 'R'.
  2717             88  PY-EXP-PYMT                  VALUE 'E'.
  2718
  2719     12  PY-BIL-INV                       PIC X(6).
  2720     12  PY-REF-NO                        PIC X(12).
  2721
  2722     12  PY-LAST-MAINT-DT                 PIC XX.
  2723     12  PY-LAST-MAINT-BY                 PIC X(4).
  2724     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2725
  2726     12  PY-PYADJ-RECORD.
  2727         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2728         16  PY-ENTRY-COMMENT             PIC X(30).
  2729         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2730             20  PY-GL-ACCOUNT            PIC X(10).
  2731             20  PY-GL-STATE              PIC X(02).
  2732             20  PY-GL-CANC-SW            PIC X(01).
  2733                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2734                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2735             20  PY-GL-COMMENT            PIC X(10).
  2736             20  FILLER      REDEFINES PY-GL-COMMENT.
  2737                 24  PY-GL-CHECK-NO       PIC 9(06).
  2738                 24  FILLER               PIC X(04).
  2739             20  FILLER                   PIC X(07).
  2740         16  PY-SAVE-ACCOUNT              PIC X(10).
  2741         16  PY-SAVE-TYPE                 PIC X(01).
  2742
  2743         16  PY-LETTERS.
  2744             20  PY-LETTER OCCURS 3 TIMES
  2745                           INDEXED BY PY-LET-NDX
  2746                                          PIC X(04).
  2747
  2748         16  PY-ERCOMP-TYPE               PIC X.
  2749             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2750             88  PY-GA-TYPE                   VALUE 'G'.
  2751             88  PY-BANK-TYPE                 VALUE 'B'.
  2752         16  FILLER                       PIC X(05).
  2753
  2754     12  PY-RECORD-STATUS.
  2755         16  PY-CREDIT-SELECT-DT          PIC XX.
  2756         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2757         16  PY-BILLED-DATE               PIC XX.
  2758         16  PY-REPORTED-DT               PIC XX.
  2759         16  PY-PMT-APPLIED               PIC X.
  2760             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2761             88  PY-GA-PMT                    VALUE 'G'.
  2762             88  PY-OVWRITE-PMT               VALUE 'O'.
  2763             88  PY-NON-AR-PMT                VALUE 'N'.
  2764         16  FILLER                       PIC X(5).
  2765         16  PY-INPUT-DT                  PIC XX.
  2766         16  PY-CHECK-NUMBER              PIC X(6).
  2767         16  PY-VOID-SW                   PIC X.
  2768             88  PY-CHECK-VOIDED              VALUE 'V'.
  2769         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  55
* EL633.cbl
  2770             88  PY-BILLING-CHECK             VALUE 'B'.
  2771             88  PY-REFUND-CHECK              VALUE 'R'.
  2772             88  PY-GA-CHECK                  VALUE 'G'.
  2773             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2774             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2775         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2776         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2777         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2778         16  PY-BILL-FLAG                 PIC X.
  2779             88  PY-BILLED                    VALUE 'B'.
  2780         16  PY-AR-FLAG                   PIC X.
  2781             88  PY-AR-CYCLE                  VALUE 'C'.
  2782             88  PY-AR-MONTH-END              VALUE 'M'.
  2783         16  PY-AR-DATE                   PIC XX.
  2784
  2785     12  PY-GL-CODES.
  2786         16  PY-GL-DB                     PIC X(14).
  2787         16  PY-GL-CR                     PIC X(14).
  2788         16  PY-GL-FLAG                   PIC X.
  2789         16  PY-GL-DATE                   PIC XX.
  2790
  2791     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2792     12  FILLER                           PIC X(3).
  2793******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  56
* EL633.cbl
  2794/
  2795*                            COPY ERCCOMP.
  2796******************************************************************
  2797*                                                                *
  2798*                                                                *
  2799*                            ERCCOMP                             *
  2800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2801*                            VMOD=2.019                          *
  2802*                                                                *
  2803*   ONLINE CREDIT SYSTEM                                         *
  2804*                                                                *
  2805*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2806*                                                                *
  2807*   FILE TYPE = VSAM,KSDS                                        *
  2808*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2809*                                                                *
  2810*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2811*       ALTERNATE PATH = NONE                                    *
  2812*                                                                *
  2813*   LOG = NO                                                     *
  2814*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2815*                                                                *
  2816******************************************************************
  2817*                   C H A N G E   L O G
  2818*
  2819* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2820*-----------------------------------------------------------------
  2821*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2822* EFFECTIVE    NUMBER
  2823*-----------------------------------------------------------------
  2824* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2825* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2826* 092205    2005050300006  PEMA  ADD LEASE FEE
  2827* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2828* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2829* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2830* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2831* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2832* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2833******************************************************************
  2834
  2835 01  COMPENSATION-MASTER.
  2836     12  CO-RECORD-ID                          PIC XX.
  2837         88  VALID-CO-ID                          VALUE 'CO'.
  2838
  2839     12  CO-CONTROL-PRIMARY.
  2840         16  CO-COMPANY-CD                     PIC X.
  2841         16  CO-CONTROL.
  2842             20  CO-CTL-1.
  2843                 24  CO-CARR-GROUP.
  2844                     28  CO-CARRIER            PIC X.
  2845                     28  CO-GROUPING.
  2846                         32  CO-GROUP-PREFIX   PIC XXX.
  2847                         32  CO-GROUP-PRIME    PIC XXX.
  2848                 24  CO-RESP-NO.
  2849                     28  CO-RESP-PREFIX        PIC X(4).
  2850                     28  CO-RESP-PRIME         PIC X(6).
  2851             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  57
* EL633.cbl
  2852                 24  CO-ACCOUNT.
  2853                     28  CO-ACCT-PREFIX        PIC X(4).
  2854                     28  CO-ACCT-PRIME         PIC X(6).
  2855         16  CO-TYPE                           PIC X.
  2856             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2857             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2858             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2859
  2860     12  CO-MAINT-INFORMATION.
  2861         16  CO-LAST-MAINT-DT                  PIC XX.
  2862         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2863         16  CO-LAST-MAINT-USER                PIC X(4).
  2864     12  FILLER                                PIC XX.
  2865     12  CO-STMT-TYPE                          PIC XXX.
  2866     12  CO-COMP-TYPE                          PIC X.
  2867         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2868     12  CO-STMT-OWNER                         PIC X(4).
  2869     12  CO-BALANCE-CONTROL                    PIC X.
  2870         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2871         88  CO-NO-BALANCE                        VALUE 'N'.
  2872
  2873     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2874         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2875         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2876         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2877
  2878     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2879         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2880         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2881
  2882     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2883     12  CO-GA-DIRECT-DEP                      PIC X.
  2884     12  CO-FUTURE-SPACE                       PIC X.
  2885         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2886
  2887     12  CO-ACCT-NAME                          PIC X(30).
  2888     12  CO-MAIL-NAME                          PIC X(30).
  2889     12  CO-ADDR-1                             PIC X(30).
  2890     12  CO-ADDR-2                             PIC X(30).
  2891     12  CO-ADDR-3.
  2892         16  CO-ADDR-CITY                      PIC X(27).
  2893         16  CO-ADDR-STATE                     PIC XX.
  2894     12  CO-CSO-1099                           PIC X.
  2895     12  CO-ZIP.
  2896         16  CO-ZIP-PRIME.
  2897             20  CO-ZIP-PRI-1ST                PIC X.
  2898                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2899             20  FILLER                        PIC X(4).
  2900         16  CO-ZIP-PLUS4                      PIC X(4).
  2901     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2902         16  CO-CAN-POSTAL-1                   PIC XXX.
  2903         16  CO-CAN-POSTAL-2                   PIC XXX.
  2904         16  FILLER                            PIC XXX.
  2905     12  CO-SOC-SEC                            PIC X(13).
  2906     12  CO-TELEPHONE.
  2907         16  CO-AREA-CODE                      PIC XXX.
  2908         16  CO-PREFIX                         PIC XXX.
  2909         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  58
* EL633.cbl
  2910
  2911     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2912
  2913     12  CO-AR-BAL-LEVEL                       PIC X.
  2914         88  CO-AR-REF-LVL                        VALUE '1'.
  2915         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2916         88  CO-AR-BILL-LVL                       VALUE '2'.
  2917         88  CO-AR-AGT-LVL                        VALUE '3'.
  2918         88  CO-AR-FR-LVL                         VALUE '4'.
  2919
  2920     12  CO-AR-NORMAL-PRINT                    PIC X.
  2921         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2922         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2923
  2924     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2925
  2926     12  CO-AR-REPORTING                       PIC X.
  2927         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2928         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2929
  2930     12  CO-AR-PULL-CHECK                      PIC X.
  2931         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2932         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2933
  2934     12  CO-AR-BALANCE-PRINT                   PIC X.
  2935         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2936
  2937     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2938         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2939         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2940         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2941
  2942     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2943
  2944     12  CO-USER-CODE                          PIC X.
  2945     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2946
  2947******************************************************************
  2948*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2949*    THE LAST MONTH END RUN.
  2950******************************************************************
  2951
  2952     12  CO-LAST-ACTIVITY-DATE.
  2953         16  CO-ACT-YEAR                       PIC 99.
  2954         16  CO-ACT-MONTH                      PIC 99.
  2955         16  CO-ACT-DAY                        PIC 99.
  2956
  2957     12  CO-LAST-STMT-DT.
  2958         16  CO-LAST-STMT-YEAR                 PIC 99.
  2959         16  CO-LAST-STMT-MONTH                PIC 99.
  2960         16  CO-LAST-STMT-DAY                  PIC 99.
  2961
  2962     12  CO-MO-END-TOTALS.
  2963         16  CO-MONTHLY-TOTALS.
  2964             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2965             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2966             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2967             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  59
* EL633.cbl
  2968             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2969
  2970         16  CO-AGING-TOTALS.
  2971             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2972             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2973             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2974             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2975
  2976         16  CO-YTD-TOTALS.
  2977             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2978             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2979
  2980         16  CO-OVER-UNDER-TOTALS.
  2981             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2982             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2983
  2984     12  CO-MISCELLANEOUS-TOTALS.
  2985         16  CO-FICA-TOTALS.
  2986             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2987             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2988
  2989         16  CO-CLAIM-TOTALS.
  2990             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2991             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2992
  2993******************************************************************
  2994*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2995*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2996******************************************************************
  2997
  2998     12  CO-CURRENT-TOTALS.
  2999         16  CO-CURRENT-LAST-STMT-DT.
  3000             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  3001             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  3002             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3003
  3004         16  CO-CURRENT-MONTHLY-TOTALS.
  3005             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3006             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3007             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3008             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3009             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3010
  3011         16  CO-CURRENT-AGING-TOTALS.
  3012             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3013             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3014             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3015             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3016
  3017         16  CO-CURRENT-YTD-TOTALS.
  3018             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3019             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3020
  3021     12  CO-PAID-COMM-TOTALS.
  3022         16  CO-YTD-PAID-COMMS.
  3023             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3024             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3025
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  60
* EL633.cbl
  3026     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3027         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3028         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3029
  3030     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3031         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3032         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3033         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3034         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3035         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3036         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3037         88  CO-FINAL-LETTER                  VALUE 'F'.
  3038         88  CO-RECONCILING                   VALUE 'R'.
  3039         88  CO-PHONE-CALL                    VALUE 'P'.
  3040         88  CO-LEGAL                         VALUE 'L'.
  3041         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3042         88  CO-WRITE-OFF                     VALUE 'W'.
  3043         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3044
  3045     12  CO-CSR-CODE                       PIC X(4).
  3046
  3047     12  CO-GA-STATUS-INFO.
  3048         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3049         16  CO-GA-TERMINATION-DT          PIC XX.
  3050         16  CO-GA-STATUS-CODE             PIC X.
  3051             88  CO-GA-ACTIVE                 VALUE 'A'.
  3052             88  CO-GA-INACTIVE               VALUE 'I'.
  3053             88  CO-GA-PENDING                VALUE 'P'.
  3054         16  CO-GA-COMMENTS.
  3055             20  CO-GA-COMMENT-1           PIC X(40).
  3056             20  CO-GA-COMMENT-2           PIC X(40).
  3057             20  CO-GA-COMMENT-3           PIC X(40).
  3058             20  CO-GA-COMMENT-4           PIC X(40).
  3059
  3060     12  CO-RPTCD2                         PIC X(10).
  3061     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3062         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3063         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3064
  3065     12  CO-TYPE-AGENT                     PIC X(01).
  3066         88  CO-CORPORATION                   VALUE 'C'.
  3067         88  CO-PARTNERSHIP                   VALUE 'P'.
  3068         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3069         88  CO-TRUST                         VALUE 'T'.
  3070         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3071
  3072     12  CO-FAXNO.
  3073         16  CO-FAX-AREA-CODE                  PIC XXX.
  3074         16  CO-FAX-PREFIX                     PIC XXX.
  3075         16  CO-FAX-PHONE                      PIC X(4).
  3076
  3077     12  CO-BANK-INFORMATION.
  3078         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3079         16  CO-BANK-TRANSIT-NON REDEFINES
  3080             CO-BANK-TRANSIT-NO                PIC 9(8).
  3081
  3082         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3083     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  61
* EL633.cbl
  3084                  CO-BANK-INFORMATION.
  3085         16  CO-MD-GL-ACCT                     PIC X(10).
  3086         16  CO-MD-DIV                         PIC XX.
  3087         16  CO-MD-CENTER                      PIC X(4).
  3088         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3089         16  CO-CREATE-AP-CHECK                PIC X.
  3090         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3091         16  FILLER                            PIC XXX.
  3092     12  CO-ACH-STATUS                         PIC X.
  3093         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3094         88  CO-ACH-PENDING                        VALUE 'P'.
  3095
  3096     12  CO-BILL-SW                            PIC X.
  3097     12  CO-CONTROL-NAME                       PIC X(30).
  3098     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3099     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3100     12  CO-CLP-STATE                          PIC XX.
  3101     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3102     12  CO-SPP-REFUND-EDIT                    PIC X.
  3103
  3104******************************************************************
  3105*
  3106*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  62
* EL633.cbl
  3107/
  3108 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3109                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3110 0000-DFHEXIT SECTION.
  3111     MOVE '9#                    $   ' TO DFHEIV0.
  3112     MOVE 'EL633' TO DFHEIV1.
  3113     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3114
  3115     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3116     MOVE EIBTRMID               TO  QID-TERM.
  3117     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3118
  3119     IF EIBCALEN = ZERO
  3120         GO TO 8800-UNAUTHORIZED-ACCESS.
  3121
  3122     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3123         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3124
  3125     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3126     MOVE '5'                    TO  DC-OPTION-CODE.
  3127
  3128     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3129
  3130     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3131     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3132
  3133     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3134         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3135             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3136             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3137             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3138             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3139             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3140             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3141             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3142             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3143         ELSE
  3144             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3145             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3146             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3147             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3148             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3149             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3150             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3151             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3152
  3153     MOVE LOW-VALUES             TO  EL633AI.
  3154
  3155     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3156     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3157     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3158     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3159
  3160     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3161                                     TOTAL-ACCT-NET.
  3162
  3163     IF RETURNED-FROM = XCTL-6331 OR
  3164                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  63
* EL633.cbl
  3165                        XCTL-642  OR
  3166                        XCTL-652
  3167         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3168
  3169     IF EIBTRNID NOT = TRANS-ID
  3170         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3171         MOVE 'Y'                TO  PI-PAGE-SW
  3172         MOVE ZEROS              TO  PI-SEQ-NOS
  3173         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3174                                     PI-SAV-ACCT-NET
  3175                                     PI-SAV-PREV-AMT
  3176                                     PI-SAV-PREV-NET
  3177         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3178             EIBTRNID NOT = EL642-TRANS-ID  AND
  3179             EIBTRNID NOT = EL652-TRANS-ID) OR
  3180             PI-CR-FIN-RESP = SPACES
  3181             GO TO 8100-SEND-INITIAL-MAP
  3182         ELSE
  3183             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3184                            EL640-TRANS-ID   OR
  3185                            EL642-TRANS-ID)  AND
  3186                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3187                GO TO 8100-SEND-INITIAL-MAP
  3188             ELSE
  3189                 MOVE DFHENTER   TO  EIBAID
  3190                 MOVE 'S'        TO  MAINTI
  3191                 MOVE PI-CR-CARRIER
  3192                                 TO  CARRIERI
  3193                 MOVE PI-CR-GROUPING
  3194                                 TO  GROUPI
  3195                 MOVE PI-CR-FIN-RESP
  3196                                 TO  FINRESPI
  3197                 MOVE PI-CR-ACCOUNT
  3198                                 TO  ACCTI
  3199                 MOVE 1          TO  CARRIERL  MAINTA
  3200                 MOVE 3          TO  GROUPL
  3201                 MOVE 6          TO  FINRESPL  ACCTL
  3202                 GO TO 0400-VALIDATE-KEY-DATA.
  3203
  3204
  3205* EXEC CICS HANDLE CONDITION
  3206*        PGMIDERR  (9600-PGMID-ERROR)
  3207*        ERROR     (9990-ABEND)
  3208*    END-EXEC.
  3209*    MOVE '"$L.                  ! " #00003200' TO DFHEIV0
  3210     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3212     MOVE X'2220233030303033323030' TO DFHEIV0(25:11)
  3213     CALL 'kxdfhei1' USING DFHEIV0
  3214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3215
  3216
  3217     IF EIBAID = DFHCLEAR
  3218         GO TO 9400-CLEAR.
  3219
  3220     IF PI-PROCESSOR-ID = 'LGXX'
  3221         GO TO 0200-RECEIVE.
  3222
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  64
* EL633.cbl
  3223
  3224* EXEC CICS READQ TS
  3225*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3226*        INTO   (SECURITY-CONTROL)
  3227*        LENGTH (SC-COMM-LENGTH)
  3228*        ITEM   (SC-ITEM)
  3229*    END-EXEC.
  3230*    MOVE '*$II   L              ''   #00003211' TO DFHEIV0
  3231     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3233     MOVE X'2020233030303033323131' TO DFHEIV0(25:11)
  3234     CALL 'kxdfhei1' USING DFHEIV0,
  3235           PI-SECURITY-TEMP-STORE-ID,
  3236           SECURITY-CONTROL,
  3237           SC-COMM-LENGTH,
  3238           SC-ITEM,
  3239           DFHEIV99,
  3240           DFHEIV99
  3241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3242
  3243
  3244     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3245     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3246
  3247     IF NOT DISPLAY-CAP
  3248         MOVE 'READ'          TO SM-READ
  3249         PERFORM 9995-SECURITY-VIOLATION
  3250         MOVE ER-0070         TO  EMI-ERROR
  3251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3252         GO TO 8100-SEND-INITIAL-MAP.
  3253
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  65
* EL633.cbl
  3255 0200-RECEIVE.
  3256
  3257     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3258         MOVE ER-0008            TO  EMI-ERROR
  3259         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3260         MOVE -1                 TO  MAINTL
  3261         GO TO 8200-SEND-DATAONLY.
  3262
  3263
  3264* EXEC CICS RECEIVE
  3265*        MAP     (MAP-NAME)
  3266*        MAPSET  (MAPSET-NAME)
  3267*        INTO    (EL633AI)
  3268*    END-EXEC.
  3269     MOVE LENGTH OF
  3270      EL633AI
  3271       TO DFHEIV11
  3272*    MOVE '8"T I  L              ''   #00003237' TO DFHEIV0
  3273     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3275     MOVE X'2020233030303033323337' TO DFHEIV0(25:11)
  3276     CALL 'kxdfhei1' USING DFHEIV0,
  3277           MAP-NAME,
  3278           EL633AI,
  3279           DFHEIV11,
  3280           MAPSET-NAME,
  3281           DFHEIV99,
  3282           DFHEIV99
  3283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3284
  3285
  3286     IF MAINTI = 'S' AND
  3287        EIBAID = DFHENTER
  3288         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3289                                     PI-SAV-ACCT-NET
  3290                                     PI-SAV-PREV-AMT
  3291                                     PI-SAV-PREV-NET
  3292                                     PI-FRST-FILE-SEQ-NO
  3293         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3294
  3295     IF PFENTERL = ZERO
  3296         GO TO 0300-CHECK-PFKEYS.
  3297
  3298     IF (PFENTERI  IS NUMERIC)
  3299       AND (PFENTERI GREATER 0 AND LESS 25)
  3300         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3301     ELSE
  3302         MOVE ER-0029               TO  EMI-ERROR
  3303         GO TO 0320-INPUT-ERROR.
  3304
  3305 0300-CHECK-PFKEYS.
  3306     IF EIBAID = DFHPF23
  3307         GO TO 8810-PF23.
  3308
  3309     IF EIBAID = DFHPF24
  3310         GO TO 9200-RETURN-MAIN-MENU.
  3311
  3312     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  66
* EL633.cbl
  3313         GO TO 9500-PF12.
  3314
  3315     IF EIBAID = DFHPF3
  3316         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3317             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3318             MOVE XCTL-652       TO  PGM-NAME
  3319             IF ERCOMP-KEY  NOT =      SPACES
  3320                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3321                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3322                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3323                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3324             END-IF
  3325
  3326             IF PI-CR-ACCOUNT = LOW-VALUES
  3327                 MOVE 'G'        TO  PI-CR-TYPE
  3328                 GO TO 9300-XCTL
  3329             ELSE
  3330                 MOVE 'A'        TO  PI-CR-TYPE
  3331                 GO TO 9300-XCTL
  3332         ELSE
  3333            MOVE ER-3020         TO  EMI-ERROR
  3334            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3335            GO TO 8100-SEND-INITIAL-MAP.
  3336
  3337     IF EIBAID = DFHPF4
  3338         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3339         MOVE XCTL-6331          TO  PGM-NAME
  3340         GO TO 9300-XCTL.
  3341
  3342     IF EIBAID = DFHPF5
  3343         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3344         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3345         MOVE XCTL-640           TO  PGM-NAME
  3346         IF PI-CR-ACCOUNT = LOW-VALUES
  3347             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3348             IF ACCTI = LOW-VALUES
  3349                MOVE 'G'         TO  PI-CR-TYPE
  3350             END-IF
  3351             GO TO 9300-XCTL
  3352         ELSE
  3353             MOVE 'A'        TO  PI-CR-TYPE
  3354             GO TO 9300-XCTL.
  3355
  3356     IF EIBAID = DFHPF6
  3357        IF PI-GA-BILLING
  3358            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3359            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3360            MOVE XCTL-642        TO  PGM-NAME
  3361            IF PI-CR-ACCOUNT = LOW-VALUES
  3362                 MOVE 'G'        TO  PI-CR-TYPE
  3363                 GO TO 9300-XCTL
  3364             ELSE
  3365                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3366                 GO TO 9300-XCTL
  3367        ELSE
  3368            MOVE ER-2929         TO  EMI-ERROR
  3369            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3370            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  67
* EL633.cbl
  3371            IF PFENTERL = ZERO
  3372                MOVE -1          TO  MAINTL
  3373                GO TO 8200-SEND-DATAONLY
  3374            ELSE
  3375                MOVE -1          TO  PFENTERL
  3376                GO TO 8200-SEND-DATAONLY.
  3377
  3378     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3379         GO TO 0400-VALIDATE-KEY-DATA.
  3380
  3381 0320-INPUT-ERROR.
  3382     MOVE ER-0029                TO  EMI-ERROR.
  3383
  3384     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3385
  3386     MOVE AL-UNBON               TO  PFENTERA.
  3387
  3388     IF PFENTERL = ZERO
  3389         MOVE -1                 TO  MAINTL
  3390     ELSE
  3391         MOVE -1                 TO  PFENTERL.
  3392
  3393     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  68
* EL633.cbl
  3395 0400-VALIDATE-KEY-DATA.
  3396     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3397         NEXT SENTENCE
  3398       ELSE
  3399        IF MAINTI NOT = 'S'
  3400         MOVE 'UPDATE'       TO SM-READ
  3401         PERFORM 9995-SECURITY-VIOLATION
  3402         MOVE ER-0070        TO EMI-ERROR
  3403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3404         GO TO 8100-SEND-INITIAL-MAP.
  3405
  3406     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3407
  3408     IF EIBAID = DFHPF1
  3409         GO TO 4000-BROWSE-FRWD.
  3410
  3411     IF EIBAID   = DFHPF1   AND
  3412        CARRIERL = ZEROS    AND
  3413        GROUPL   = ZEROS    AND
  3414        FINRESPL = ZEROS    AND
  3415        ACCTL    = ZEROS
  3416         GO TO 4000-BROWSE-FRWD.
  3417
  3418     IF PI-PROCESSOR-ID = 'LGXX'
  3419         IF MAINTI = 'C'
  3420             MOVE AL-UANON       TO MAINTA
  3421             MOVE MAINTI         TO PI-SAV-FUNCTION
  3422             GO TO CSO-BRANCH
  3423         END-IF
  3424     END-IF.
  3425
  3426     IF MAINTI = 'C' OR  'S'
  3427         MOVE AL-UANON           TO  MAINTA
  3428         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3429     ELSE
  3430         MOVE -1                 TO  MAINTL
  3431         MOVE ER-0023            TO  EMI-ERROR
  3432         MOVE AL-UABON           TO  MAINTA
  3433         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3434
  3435 CSO-BRANCH.
  3436
  3437     IF MAINTI = 'C'
  3438       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3439         MOVE -1                 TO  MAINTL
  3440         MOVE ER-2056            TO  EMI-ERROR
  3441         MOVE AL-UABON           TO  MAINTA
  3442         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3443
  3444     IF CARRIERL = ZEROS  AND
  3445        GROUPL   = ZEROS  AND
  3446        FINRESPL = ZEROS  AND
  3447        ACCTL    = ZEROS
  3448         MOVE -1                 TO  CARRIERL
  3449         MOVE ER-2231            TO  EMI-ERROR
  3450         MOVE AL-UABON           TO  CARRIERA
  3451                                     GROUPA
  3452                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  69
* EL633.cbl
  3453                                     ACCTA
  3454         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3455         GO TO 8200-SEND-DATAONLY.
  3456
  3457     IF CARRIERL NOT = ZEROS
  3458         MOVE AL-UANON           TO  CARRIERA
  3459         MOVE CARRIERI           TO  COMP-CARRIER
  3460                                     PI-SAV-CARRIER
  3461                                     PI-CR-CARRIER
  3462         IF CARRIERI NOT = ZEROS
  3463           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3464             MOVE ER-2587        TO  EMI-ERROR
  3465             MOVE -1             TO  CARRIERL
  3466             MOVE AL-UABON       TO  CARRIERA
  3467             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3468         ELSE
  3469             NEXT SENTENCE
  3470     ELSE
  3471         MOVE LOW-VALUES          TO  COMP-CARRIER
  3472                                      PI-SAV-CARRIER.
  3473
  3474     IF CARRIERL NOT = ZEROS
  3475         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3476             IF PI-CARRIER-SECURITY = CARRIERI
  3477                 NEXT SENTENCE
  3478             ELSE
  3479                 MOVE -1         TO  CARRIERL
  3480                 MOVE ER-2370    TO  EMI-ERROR
  3481                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3482
  3483     IF GROUPL NOT = ZEROS
  3484         MOVE AL-UANON           TO  GROUPA
  3485         MOVE GROUPI             TO  COMP-GROUPING
  3486                                     PI-SAV-GROUPING
  3487                                     PI-CR-GROUPING
  3488         IF GROUPI NOT = ZEROS
  3489           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3490             MOVE ER-2588        TO  EMI-ERROR
  3491             MOVE -1             TO  GROUPL
  3492             MOVE AL-UABON       TO  GROUPA
  3493             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3494         ELSE
  3495             NEXT SENTENCE
  3496     ELSE
  3497         MOVE LOW-VALUES         TO  COMP-GROUPING
  3498                                     PI-SAV-GROUPING.
  3499
  3500     IF FINRESPL NOT = ZEROS
  3501         MOVE AL-UANON           TO  FINRESPA
  3502         MOVE FINRESPI           TO  COMP-FIN-RESP
  3503                                     PI-SAV-FIN-RESP
  3504                                     PI-CR-FIN-RESP
  3505     ELSE
  3506         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3507                                     PI-SAV-FIN-RESP.
  3508
  3509     IF ACCTL NOT = ZEROS
  3510         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  70
* EL633.cbl
  3511         MOVE ACCTI              TO  COMP-ACCOUNT
  3512                                     PI-SAV-ACCOUNT
  3513                                     PI-CR-ACCOUNT
  3514     ELSE
  3515         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3516                                     PI-SAV-ACCOUNT
  3517                                     PI-CR-ACCOUNT.
  3518
  3519     IF EMI-ERROR = ZEROS
  3520         NEXT SENTENCE
  3521     ELSE
  3522         IF EIBTRNID = EL640-TRANS-ID OR
  3523            EIBTRNID = EL642-TRANS-ID OR
  3524            EIBTRNID = EL6331-TRANS-ID
  3525             GO TO 8100-SEND-INITIAL-MAP
  3526         ELSE
  3527             GO TO 8200-SEND-DATAONLY.
  3528
  3529     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3530
  3531     IF MAINTI = 'S'
  3532         IF EIBAID = DFHPF1              OR  DFHENTER
  3533             GO TO 4000-BROWSE-FRWD
  3534         ELSE
  3535             GO TO 4100-BROWSE-BKWD.
  3536
  3537     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3538     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3539
  3540
  3541* EXEC CICS HANDLE CONDITION
  3542*        NOTFND   (0410-NO-COMP-MSTR)
  3543*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3544*        END-EXEC.
  3545*    MOVE '"$IJ                  ! # #00003497' TO DFHEIV0
  3546     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3548     MOVE X'2320233030303033343937' TO DFHEIV0(25:11)
  3549     CALL 'kxdfhei1' USING DFHEIV0
  3550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3551
  3552
  3553
  3554* EXEC CICS READ
  3555*        DATASET  (COMP-FILE-ID)
  3556*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3557*        RIDFLD   (ERCOMP-KEY)
  3558*        GTEQ
  3559*        END-EXEC.
  3560*    MOVE '&"S        G          (   #00003502' TO DFHEIV0
  3561     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3563     MOVE X'2020233030303033353032' TO DFHEIV0(25:11)
  3564     CALL 'kxdfhei1' USING DFHEIV0,
  3565           COMP-FILE-ID,
  3566           DFHEIV20,
  3567           DFHEIV99,
  3568           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  71
* EL633.cbl
  3569           DFHEIV99,
  3570           DFHEIV99,
  3571           DFHEIV99
  3572     SET ADDRESS OF COMPENSATION-MASTER TO
  3573         DFHEIV20
  3574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3575
  3576
  3577     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3578        COMP-CARRIER  = CO-CARRIER     AND
  3579        COMP-GROUPING = CO-GROUPING    AND
  3580        COMP-FIN-RESP = CO-RESP-NO    AND
  3581        COMP-ACCOUNT  = CO-ACCOUNT
  3582         NEXT SENTENCE
  3583     ELSE
  3584         GO TO 0410-NO-COMP-MSTR.
  3585
  3586     IF PI-COMPANY-ID = 'NCL'
  3587         IF CO-GA-INACTIVE
  3588             GO TO 0420-INACTIVE-COMP.
  3589
  3590     IF MAINTI = 'C'
  3591         GO TO 1000-EDIT-DATA.
  3592
  3593     IF EIBAID = DFHPF1
  3594       OR DFHENTER
  3595         GO TO 4000-BROWSE-FRWD.
  3596
  3597     IF EIBAID = DFHPF2
  3598         GO TO 4100-BROWSE-BKWD.
  3599
  3600 0410-NO-COMP-MSTR.
  3601     MOVE ER-2230                TO  EMI-ERROR.
  3602     MOVE -1                     TO  CARRIERL.
  3603     MOVE AL-UABON               TO  CARRIERA
  3604                                     GROUPA
  3605                                     FINRESPA
  3606                                     ACCTA.
  3607
  3608     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3609
  3610     GO TO 8200-SEND-DATAONLY.
  3611
  3612 0420-INACTIVE-COMP.
  3613     MOVE ER-2763                TO  EMI-ERROR.
  3614     MOVE -1                     TO  CARRIERL.
  3615     MOVE AL-UABON               TO  CARRIERA
  3616                                     GROUPA
  3617                                     FINRESPA
  3618                                     ACCTA.
  3619
  3620     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3621
  3622     GO TO 8200-SEND-DATAONLY.
  3623
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  72
* EL633.cbl
  3625 0500-CREATE-TEMP-STORAGE.
  3626
  3627     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3628
  3629
  3630* EXEC CICS WRITEQ TS
  3631*        QUEUE  (QID)
  3632*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3633*        LENGTH (PI-COMM-LENGTH)
  3634*    END-EXEC.
  3635*    MOVE '*"     L              ''   #00003561' TO DFHEIV0
  3636     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  3637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3638     MOVE X'2020233030303033353631' TO DFHEIV0(25:11)
  3639     CALL 'kxdfhei1' USING DFHEIV0,
  3640           QID,
  3641           PROGRAM-INTERFACE-BLOCK,
  3642           PI-COMM-LENGTH,
  3643           DFHEIV99,
  3644           DFHEIV99,
  3645           DFHEIV99
  3646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3647
  3648
  3649 0590-EXIT.
  3650      EXIT.
  3651
  3652 0600-RECOVER-TEMP-STORAGE.
  3653
  3654* EXEC CICS READQ TS
  3655*        QUEUE  (QID)
  3656*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3657*        LENGTH (PI-COMM-LENGTH)
  3658*    END-EXEC.
  3659*    MOVE '*$I    L              ''   #00003571' TO DFHEIV0
  3660     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3661     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3662     MOVE X'2020233030303033353731' TO DFHEIV0(25:11)
  3663     CALL 'kxdfhei1' USING DFHEIV0,
  3664           QID,
  3665           PROGRAM-INTERFACE-BLOCK,
  3666           PI-COMM-LENGTH,
  3667           DFHEIV99,
  3668           DFHEIV99,
  3669           DFHEIV99
  3670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3671
  3672
  3673     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3674
  3675 0690-EXIT.
  3676      EXIT.
  3677
  3678 0800-DELETE-TS.
  3679
  3680* EXEC CICS HANDLE CONDITION
  3681*        QIDERR (0890-EXIT)
  3682*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  73
* EL633.cbl
  3683*    MOVE '"$N                   ! $ #00003583' TO DFHEIV0
  3684     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3686     MOVE X'2420233030303033353833' TO DFHEIV0(25:11)
  3687     CALL 'kxdfhei1' USING DFHEIV0
  3688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3689
  3690
  3691
  3692* EXEC CICS DELETEQ TS
  3693*        QUEUE  (QID)
  3694*    END-EXEC.
  3695*    MOVE '*&                    #   #00003587' TO DFHEIV0
  3696     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3697     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3698     MOVE X'2020233030303033353837' TO DFHEIV0(25:11)
  3699     CALL 'kxdfhei1' USING DFHEIV0,
  3700           QID,
  3701           DFHEIV99
  3702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3703
  3704
  3705
  3706* EXEC CICS SYNCPOINT
  3707*    END-EXEC.
  3708*    MOVE '6"                    !   #00003591' TO DFHEIV0
  3709     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3711     MOVE X'2020233030303033353931' TO DFHEIV0(25:11)
  3712     CALL 'kxdfhei1' USING DFHEIV0
  3713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3714
  3715
  3716 0890-EXIT.
  3717      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  74
* EL633.cbl
  3719
  3720 1000-EDIT-DATA.
  3721     SET PINDX                   TO  1.
  3722
  3723     .
  3724 1010-EDIT-LOOP.
  3725     SET NDX                     TO  PINDX.
  3726     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3727        GL-STATE-LEN (PINDX) = ZEROS   AND
  3728        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3729        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3730        RTYPE-LEN (PINDX)     = ZEROS  AND
  3731        AMT-LEN (PINDX)       = ZEROS  AND
  3732        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3733        SDTE-LEN (PINDX)      = ZEROS
  3734         GO TO 1020-INCREMENT-PINDX.
  3735
  3736     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3737         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3738         IF PI-COMPANY-ID NOT = 'WSL'
  3739             NEXT SENTENCE
  3740         ELSE
  3741             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3742             MOVE '4'                   TO  DC-OPTION-CODE
  3743             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3744             IF NO-CONVERSION-ERROR
  3745                 NEXT SENTENCE
  3746             ELSE
  3747                 MOVE ER-2595    TO  EMI-ERROR
  3748                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3749                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3750                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3751     ELSE
  3752         IF PI-COMPANY-ID = 'WSL'
  3753           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3754             MOVE ER-2596        TO  EMI-ERROR
  3755             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3756             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3757             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3758
  3759
  3760     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3761*        MOVE K-SPACE            TO COFA-FILLER
  3762*        MOVE '0001'             TO COFA-COMPANY-X
  3763*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3764         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3765     ELSE
  3766         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3767             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3768             MOVE ER-2957        TO EMI-ERROR
  3769             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3770             PERFORM 9900-ERROR-FORMAT THRU
  3771                     9900-EXIT
  3772             GO TO 1040-CONTINUE-EDIT
  3773         ELSE
  3774             GO TO 1040-CONTINUE-EDIT
  3775         END-IF
  3776     END-IF.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  75
* EL633.cbl
  3777
  3778     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3779        AND (RTYPE (PINDX) = 'P')
  3780        GO TO 1040-CONTINUE-EDIT
  3781     END-IF
  3782     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3783        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3784     ELSE
  3785        MOVE SPACES              TO CHECK-GL-ACCT
  3786     END-IF
  3787
  3788     EVALUATE TRUE
  3789        WHEN (PI-COMPANY-ID = 'DCC')
  3790           AND (CO-CARRIER = '1' OR '2' or '9')
  3791           AND (VALID-DCC-GL-ACCOUNT)
  3792           GO TO 1040-CONTINUE-EDIT
  3793        WHEN (PI-COMPANY-ID = 'DCC')
  3794           AND (CO-CARRIER = '3' OR '4')
  3795           AND VALID-CSI-GL-ACCOUNT
  3796           GO TO 1040-CONTINUE-EDIT
  3797        WHEN (PI-COMPANY-ID = 'DCC')
  3798           AND (CO-CARRIER = '5' OR '6' or '7')
  3799           AND (VALID-CCC-GL-ACCOUNT)
  3800           GO TO 1040-CONTINUE-EDIT
  3801        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3802           AND (VALID-GL-ACCOUNT)
  3803           GO TO 1040-CONTINUE-EDIT
  3804        WHEN (PI-COMPANY-ID = 'VPP')
  3805           AND (VALID-VPP-GL-ACCOUNT)
  3806           GO TO 1040-CONTINUE-EDIT
  3807     END-EVALUATE
  3808*    EXEC CICS HANDLE CONDITION
  3809*         NOTFND (1040-NO-COFA-MSTR)
  3810*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3811*    END-EXEC.
  3812*
  3813*    EXEC CICS READ
  3814*         DATASET (COFA-FILE-ID)
  3815*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3816*         RIDFLD  (COFA-KEY-X)
  3817*    END-EXEC.
  3818*
  3819*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3820*    GO TO 1040-CONTINUE-EDIT.
  3821*
  3822*1040-NO-COFA-MSTR.
  3823
  3824     MOVE ER-2960                TO EMI-ERROR.
  3825     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3826     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3827     PERFORM 9900-ERROR-FORMAT THRU
  3828             9900-EXIT.
  3829
  3830 1040-CONTINUE-EDIT.
  3831
  3832*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3833     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3834         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  76
* EL633.cbl
  3835         IF NOT VALID-STATE-CODE
  3836             MOVE -1             TO GL-STATE-LEN (PINDX)
  3837             MOVE ER-2957        TO EMI-ERROR
  3838             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3839             PERFORM 9900-ERROR-FORMAT THRU
  3840                     9900-EXIT
  3841         ELSE
  3842             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3843         END-IF
  3844     END-IF.
  3845
  3846 1040-CSO-SKIP.
  3847
  3848     IF GL-CANC (PINDX) = LOW-VALUES
  3849         MOVE SPACES             TO GL-CANC (PINDX)
  3850     END-IF.
  3851
  3852     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3853         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3854         IF NOT VALID-CANC-TYPE
  3855             MOVE -1             TO GL-CANC-LEN (PINDX)
  3856             MOVE ER-2958        TO EMI-ERROR
  3857             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3858             PERFORM 9900-ERROR-FORMAT THRU
  3859                     9900-EXIT
  3860         ELSE
  3861             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3862         END-IF
  3863     END-IF.
  3864
  3865     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3866        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3867        IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3868           AND (RTYPE (PINDX) = 'P')
  3869           SET VALID-REC-TYPE   TO TRUE
  3870        END-IF
  3871         IF NOT VALID-REC-TYPE
  3872             MOVE -1             TO  RTYPE-LEN (PINDX)
  3873             MOVE ER-2234        TO  EMI-ERROR
  3874             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3875             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3876         ELSE
  3877             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3878     ELSE
  3879         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3880             MOVE -1             TO  RTYPE-LEN (PINDX)
  3881             MOVE ER-2235        TO  EMI-ERROR
  3882             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3883             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3884
  3885     IF AMT-LEN (PINDX) NOT = ZEROS
  3886
  3887* EXEC CICS BIF DEEDIT
  3888*           FIELD (AMT (PINDX))
  3889*           LENGTH (11)
  3890*       END-EXEC
  3891     MOVE 11
  3892       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  77
* EL633.cbl
  3893*    MOVE '@"L                   #   #00003764' TO DFHEIV0
  3894     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3895     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3896     MOVE X'2020233030303033373634' TO DFHEIV0(25:11)
  3897     CALL 'kxdfhei1' USING DFHEIV0,
  3898           AMT(PINDX),
  3899           DFHEIV11
  3900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3901         IF AMT (PINDX) = ZEROS
  3902             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3903                 NEXT SENTENCE
  3904             ELSE
  3905                 MOVE ER-2245    TO  EMI-ERROR
  3906                 MOVE -1         TO  AMT-LEN(PINDX)
  3907                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3908                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3909         ELSE
  3910             IF AMT (PINDX) NUMERIC
  3911                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3912             ELSE
  3913                 MOVE ER-2245    TO  EMI-ERROR
  3914                 MOVE -1         TO  AMT-LEN(PINDX)
  3915                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3916                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3917     ELSE
  3918         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3919             MOVE -1             TO  AMT-LEN (PINDX)
  3920             MOVE ER-2236        TO  EMI-ERROR
  3921             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3922             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3923
  3924     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3925         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3926           AND (PI-REC-TYPE (NDX) = 'C')
  3927             IF VOID-SW (PINDX) = 'V'
  3928                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3929             ELSE
  3930                 MOVE ER-2246    TO  EMI-ERROR
  3931                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3932                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3933                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3934         ELSE
  3935             MOVE ER-2449        TO  EMI-ERROR
  3936             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3937             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3938             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3939
  3940     IF SDTE-LEN (PINDX) = ZEROS
  3941        GO TO 1020-INCREMENT-PINDX.
  3942
  3943     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3944
  3945     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3946     PERFORM 8600-DEEDIT.
  3947
  3948     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3949        GO TO 1015-DAY-ERROR.
  3950
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  78
* EL633.cbl
  3951     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3952     MOVE '4'                    TO  DC-OPTION-CODE.
  3953     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3954
  3955     IF NO-CONVERSION-ERROR
  3956        SET PINDEX               TO  PINDX
  3957        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3958     ELSE
  3959        GO TO 1015-DAY-ERROR.
  3960
  3961     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3962
  3963     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3964         IF DATE-TEST-DD  NOT = 30
  3965             GO TO 1015-DAY-ERROR
  3966         ELSE
  3967             GO TO 1020-INCREMENT-PINDX.
  3968
  3969     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3970                             8  OR  10  OR  12
  3971         IF DATE-TEST-DD  NOT = 31
  3972             GO TO 1015-DAY-ERROR
  3973         ELSE
  3974             GO TO 1020-INCREMENT-PINDX.
  3975
  3976     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3977         REMAINDER  DIVIDE-REMAINDER.
  3978
  3979     IF (DATE-TEST-YY = ZERO)
  3980       OR (DIVIDE-REMAINDER NOT = ZERO)
  3981         IF DATE-TEST-DD  NOT = 28
  3982             GO TO 1015-DAY-ERROR
  3983         ELSE
  3984             GO TO 1020-INCREMENT-PINDX
  3985     ELSE
  3986         IF DATE-TEST-DD = 29
  3987             GO TO 1020-INCREMENT-PINDX.
  3988
  3989 1015-DAY-ERROR.
  3990     MOVE -1                     TO  SDTE-LEN (PINDX).
  3991     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3992     MOVE ER-0587                TO  EMI-ERROR.
  3993
  3994     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3995
  3996 1020-INCREMENT-PINDX.
  3997     SET PINDX  UP  BY  1.
  3998
  3999     IF PINDX  IS NOT GREATER THAN  13
  4000         GO TO 1010-EDIT-LOOP.
  4001
  4002     IF EMI-ERROR = ZEROS
  4003         NEXT SENTENCE
  4004     ELSE
  4005         MOVE 'S'                TO  PI-PREV-FUNCTION
  4006         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  79
* EL633.cbl
  4008 2000-UPDATE-THE-FILE.
  4009     SET PINDX                   TO  ZERO-NDX.
  4010*    SET NDX                     TO  ZERO-NDX.
  4011*    SET NDX  UP  BY  1.
  4012
  4013     IF PI-PYAJ-FILE-SW = 'B'
  4014         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  4015         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  4016     ELSE
  4017         MOVE PI-LAST-FILE-SEQ-NO
  4018                                 TO  PI-SAV-FILE-SEQ-NO
  4019         MOVE PI-LAST-RECORD-TYPE
  4020                                 TO  PI-SAV-RECORD-TYPE.
  4021
  4022 2100-UPDATE-LOOP.
  4023     SET PINDX  UP  BY  1.
  4024     SET NDX                     TO  PINDX.
  4025
  4026     IF PINDX  IS GREATER THAN  13
  4027         GO TO 2200-UPDATE-COMPLETE.
  4028
  4029     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4030        GL-STATE-LEN (PINDX) = ZEROS AND
  4031        GL-CANC-LEN (PINDX)   = ZEROS AND
  4032        GL-COMM-LEN (PINDX)   = ZEROS AND
  4033        RTYPE-LEN (PINDX)   = ZEROS  AND
  4034        AMT-LEN (PINDX)     = ZEROS  AND
  4035        VOID-SW-LEN (PINDX) = ZEROS  AND
  4036        SDTE-LEN (PINDX)    = ZEROS
  4037         GO TO 2100-UPDATE-LOOP.
  4038
  4039
  4040* EXEC CICS BIF DEEDIT
  4041*         FIELD (AMT (PINDX))
  4042*         LENGTH (11)
  4043*    END-EXEC.
  4044     MOVE 11
  4045       TO DFHEIV11
  4046*    MOVE '@"L                   #   #00003906' TO DFHEIV0
  4047     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4048     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4049     MOVE X'2020233030303033393036' TO DFHEIV0(25:11)
  4050     CALL 'kxdfhei1' USING DFHEIV0,
  4051           AMT(PINDX),
  4052           DFHEIV11
  4053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4054
  4055
  4056     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4057         NEXT SENTENCE
  4058     ELSE
  4059         GO TO 2110-ADD-RECORD.
  4060
  4061
  4062* EXEC CICS HANDLE CONDITION
  4063*        NOTFND  (2110-ADD-RECORD)
  4064*    END-EXEC.
  4065*    MOVE '"$I                   ! % #00003916' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  80
* EL633.cbl
  4066     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4068     MOVE X'2520233030303033393136' TO DFHEIV0(25:11)
  4069     CALL 'kxdfhei1' USING DFHEIV0
  4070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4071
  4072
  4073     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4074     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4075     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4076
  4077
  4078* EXEC CICS READ
  4079*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4080*        DATASET  (PYAJ-FILE-ID)
  4081*        RIDFLD   (ERPYAJ-KEY)
  4082*        UPDATE
  4083*    END-EXEC.
  4084*    MOVE '&"S        EU         (   #00003924' TO DFHEIV0
  4085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4086     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4087     MOVE X'2020233030303033393234' TO DFHEIV0(25:11)
  4088     CALL 'kxdfhei1' USING DFHEIV0,
  4089           PYAJ-FILE-ID,
  4090           DFHEIV20,
  4091           DFHEIV99,
  4092           ERPYAJ-KEY,
  4093           DFHEIV99,
  4094           DFHEIV99,
  4095           DFHEIV99
  4096     SET ADDRESS OF PENDING-PAY-ADJ TO
  4097         DFHEIV20
  4098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4099
  4100
  4101
  4102     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4103        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4104            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4105            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4106            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4107
  4108     IF AMT-LEN (PINDX) NOT = ZEROS
  4109         IF AMT (PINDX) = ZEROS
  4110             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4111                 GO TO 2120-DELETE-RECORD
  4112             ELSE
  4113                 MOVE ER-2244       TO  EMI-ERROR
  4114                 MOVE -1            TO  AMT-LEN (PINDX)
  4115                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4116                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4117                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4118
  4119* EXEC CICS UNLOCK
  4120*                    DATASET  (PYAJ-FILE-ID)
  4121*                END-EXEC
  4122*    MOVE '&*                    #   #00003948' TO DFHEIV0
  4123     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  81
* EL633.cbl
  4124     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4125     MOVE X'2020233030303033393438' TO DFHEIV0(25:11)
  4126     CALL 'kxdfhei1' USING DFHEIV0,
  4127           PYAJ-FILE-ID,
  4128           DFHEIV99
  4129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4130                 GO TO 8200-SEND-DATAONLY.
  4131
  4132     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4133     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4134     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4135
  4136     PERFORM 8400-LOG-JOURNAL-RECORD.
  4137
  4138     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4139     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4140     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4141
  4142     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4143         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4144     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4145         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4146     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4147         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4148     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4149         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4150     IF AMT-LEN (PINDX) NOT = ZEROS
  4151         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4152
  4153     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4154         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4155
  4156     IF SDTE-LEN (PINDX) NOT = ZEROS
  4157        SET PINDEX               TO  PINDX
  4158        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4159
  4160     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4161     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4162     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4163
  4164
  4165* EXEC CICS REWRITE
  4166*        DATASET  (PYAJ-FILE-ID)
  4167*        FROM     (PENDING-PAY-ADJ)
  4168*    END-EXEC.
  4169     MOVE LENGTH OF
  4170      PENDING-PAY-ADJ
  4171       TO DFHEIV11
  4172*    MOVE '&& L                  %   #00003985' TO DFHEIV0
  4173     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4174     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4175     MOVE X'2020233030303033393835' TO DFHEIV0(25:11)
  4176     CALL 'kxdfhei1' USING DFHEIV0,
  4177           PYAJ-FILE-ID,
  4178           PENDING-PAY-ADJ,
  4179           DFHEIV11,
  4180           DFHEIV99
  4181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  82
* EL633.cbl
  4182
  4183
  4184     PERFORM 8400-LOG-JOURNAL-RECORD.
  4185
  4186     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  83
* EL633.cbl
  4188 2110-ADD-RECORD.
  4189
  4190* EXEC CICS GETMAIN
  4191*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4192*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4193*        INITIMG  (GETMAIN-SPACE)
  4194*    END-EXEC.
  4195*    MOVE ',"IL                  $   #00003995' TO DFHEIV0
  4196     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4197     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4198     MOVE X'2020233030303033393935' TO DFHEIV0(25:11)
  4199     CALL 'kxdfhei1' USING DFHEIV0,
  4200           DFHEIV20,
  4201           ERPYAJ-RECORD-LENGTH,
  4202           GETMAIN-SPACE
  4203     SET ADDRESS OF PENDING-PAY-ADJ TO
  4204         DFHEIV20
  4205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4206
  4207
  4208     MOVE 'PY'                   TO  PY-RECORD-ID.
  4209     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4210     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4211     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4212     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4213     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4214
  4215     ADD +1                      TO  WORK-SEQ-NO.
  4216     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4217
  4218     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4219     if gl-state-len (pindx) <> zeros
  4220        MOVE GL-STATE (PINDX)    TO  PY-GL-STATE
  4221     end-if
  4222     if gl-canc-len (pindx) <> zeros
  4223        MOVE GL-CANC (PINDX)     TO  PY-GL-CANC-SW
  4224     end-if
  4225     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4226
  4227     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4228     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4229     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4230        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4231     END-IF
  4232     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4233     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4234     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4235                                     PY-INPUT-DT.
  4236     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4237                                     PY-CHECK-QUE-SEQUENCE.
  4238     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4239                                     PY-BILLED-DATE
  4240                                     PY-AR-DATE
  4241                                     PY-REPORTED-DT
  4242                                     PY-CHECK-WRITTEN-DT.
  4243     IF SDTE-LEN (PINDX) = ZEROS
  4244         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4245         GO TO 2115-WRITE-REC
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  84
* EL633.cbl
  4246     END-IF.
  4247
  4248     IF SDTE (PINDX) IS NUMERIC
  4249         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
  4250         MOVE '4'            TO  DC-OPTION-CODE
  4251         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4252         IF DATE-CONVERSION-ERROR
  4253             MOVE PI-CR-MONTH-END-DT
  4254                             TO  PY-CREDIT-SELECT-DT
  4255         ELSE
  4256             MOVE DC-BIN-DATE-1
  4257                             TO  PY-CREDIT-SELECT-DT
  4258         END-IF
  4259     ELSE
  4260         MOVE PI-CR-MONTH-END-DT
  4261                             TO  PY-CREDIT-SELECT-DT
  4262     END-IF
  4263
  4264     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4265         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4266         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4267
  4268     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4269         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4270         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4271
  4272     MOVE 'N'                    TO  FIRST-ADD-SW.
  4273
  4274     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4275     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4276     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4277 2115-WRITE-REC.
  4278
  4279* EXEC CICS WRITE
  4280*        DATASET  (PYAJ-FILE-ID)
  4281*        FROM     (PENDING-PAY-ADJ)
  4282*        RIDFLD   (PY-CONTROL-PRIMARY)
  4283*    END-EXEC.
  4284     MOVE LENGTH OF
  4285      PENDING-PAY-ADJ
  4286       TO DFHEIV11
  4287*    MOVE '&$ L                  ''   #00004071' TO DFHEIV0
  4288     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4289     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4290     MOVE X'2020233030303034303731' TO DFHEIV0(25:11)
  4291     CALL 'kxdfhei1' USING DFHEIV0,
  4292           PYAJ-FILE-ID,
  4293           PENDING-PAY-ADJ,
  4294           DFHEIV11,
  4295           PY-CONTROL-PRIMARY,
  4296           DFHEIV99,
  4297           DFHEIV99
  4298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4299
  4300
  4301     PERFORM 8400-LOG-JOURNAL-RECORD.
  4302
  4303     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  85
* EL633.cbl
  4304
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  86
* EL633.cbl
  4306 2120-DELETE-RECORD.
  4307     IF PY-RECORD-TYPE NOT = 'C'
  4308         GO TO 2120-DELETE-CONT.
  4309
  4310     IF PY-CHECK-QUE-CONTROL = ZEROS
  4311       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4312         GO TO 2120-DELETE-CONT.
  4313
  4314
  4315* EXEC CICS HANDLE CONDITION
  4316*        NOTFND  (2120-DELETE-CONT)
  4317*    END-EXEC.
  4318*    MOVE '"$I                   ! & #00004090' TO DFHEIV0
  4319     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4321     MOVE X'2620233030303034303930' TO DFHEIV0(25:11)
  4322     CALL 'kxdfhei1' USING DFHEIV0
  4323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4324
  4325
  4326     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4327     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4328     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4329
  4330
  4331* EXEC CICS READ
  4332*        SET      (ADDRESS OF CHECK-QUE)
  4333*        DATASET  (CHKQ-FILE-ID)
  4334*        RIDFLD   (ERCHKQ-KEY)
  4335*        UPDATE
  4336*    END-EXEC.
  4337*    MOVE '&"S        EU         (   #00004098' TO DFHEIV0
  4338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4340     MOVE X'2020233030303034303938' TO DFHEIV0(25:11)
  4341     CALL 'kxdfhei1' USING DFHEIV0,
  4342           CHKQ-FILE-ID,
  4343           DFHEIV20,
  4344           DFHEIV99,
  4345           ERCHKQ-KEY,
  4346           DFHEIV99,
  4347           DFHEIV99,
  4348           DFHEIV99
  4349     SET ADDRESS OF CHECK-QUE TO
  4350         DFHEIV20
  4351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4352
  4353
  4354*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4355*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4356*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4357*
  4358*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4359
  4360
  4361* EXEC CICS DELETE
  4362*        DATASET  (CHKQ-FILE-ID)
  4363*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  87
* EL633.cbl
  4364*    MOVE '&(                    &   #00004111' TO DFHEIV0
  4365     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4366     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4367     MOVE X'2020233030303034313131' TO DFHEIV0(25:11)
  4368     CALL 'kxdfhei1' USING DFHEIV0,
  4369           CHKQ-FILE-ID,
  4370           DFHEIV99,
  4371           DFHEIV99,
  4372           DFHEIV99,
  4373           DFHEIV99
  4374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4375
  4376
  4377 2120-DELETE-CONT.
  4378*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4379*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4380*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4381*
  4382*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4383
  4384     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4385         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4386         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4387         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4388                                     PI-SAV-ACCT-NET
  4389                                     PI-SAV-PREV-AMT
  4390                                     PI-SAV-PREV-NET.
  4391
  4392
  4393* EXEC CICS DELETE
  4394*        DATASET(PYAJ-FILE-ID)
  4395*    END-EXEC.
  4396*    MOVE '&(                    &   #00004130' TO DFHEIV0
  4397     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4399     MOVE X'2020233030303034313330' TO DFHEIV0(25:11)
  4400     CALL 'kxdfhei1' USING DFHEIV0,
  4401           PYAJ-FILE-ID,
  4402           DFHEIV99,
  4403           DFHEIV99,
  4404           DFHEIV99,
  4405           DFHEIV99
  4406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4407
  4408
  4409     GO TO 2100-UPDATE-LOOP.
  4410
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  88
* EL633.cbl
  4412
  4413 2190-CHANGE-RECORD-TYPE.
  4414
  4415*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4416*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4417*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4418*
  4419*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4420
  4421
  4422* EXEC CICS DELETE
  4423*        DATASET(PYAJ-FILE-ID)
  4424*    END-EXEC.
  4425*    MOVE '&(                    &   #00004146' TO DFHEIV0
  4426     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4427     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4428     MOVE X'2020233030303034313436' TO DFHEIV0(25:11)
  4429     CALL 'kxdfhei1' USING DFHEIV0,
  4430           PYAJ-FILE-ID,
  4431           DFHEIV99,
  4432           DFHEIV99,
  4433           DFHEIV99,
  4434           DFHEIV99
  4435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4436
  4437
  4438
  4439* EXEC CICS GETMAIN
  4440*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4441*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4442*        INITIMG  (GETMAIN-SPACE)
  4443*    END-EXEC.
  4444*    MOVE ',"IL                  $   #00004150' TO DFHEIV0
  4445     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4446     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4447     MOVE X'2020233030303034313530' TO DFHEIV0(25:11)
  4448     CALL 'kxdfhei1' USING DFHEIV0,
  4449           DFHEIV20,
  4450           ERPYAJ-RECORD-LENGTH,
  4451           GETMAIN-SPACE
  4452     SET ADDRESS OF PENDING-PAY-ADJ TO
  4453         DFHEIV20
  4454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4455
  4456
  4457*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4458*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4459
  4460     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4461     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4462                                    PYAJ-RECORD-TYPE.
  4463
  4464
  4465* EXEC CICS HANDLE CONDITION
  4466*        DUPREC (2190-DUP-RECORD)
  4467*    END-EXEC.
  4468*    MOVE '"$%                   ! '' #00004163' TO DFHEIV0
  4469     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  89
* EL633.cbl
  4470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4471     MOVE X'2720233030303034313633' TO DFHEIV0(25:11)
  4472     CALL 'kxdfhei1' USING DFHEIV0
  4473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4474
  4475
  4476*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4477*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4478*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4479
  4480 2190-RETRY-WRITE.
  4481
  4482
  4483* EXEC CICS WRITE
  4484*        DATASET  (PYAJ-FILE-ID)
  4485*        FROM     (PENDING-PAY-ADJ)
  4486*        RIDFLD   (PY-CONTROL-PRIMARY)
  4487*    END-EXEC.
  4488     MOVE LENGTH OF
  4489      PENDING-PAY-ADJ
  4490       TO DFHEIV11
  4491*    MOVE '&$ L                  ''   #00004173' TO DFHEIV0
  4492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4494     MOVE X'2020233030303034313733' TO DFHEIV0(25:11)
  4495     CALL 'kxdfhei1' USING DFHEIV0,
  4496           PYAJ-FILE-ID,
  4497           PENDING-PAY-ADJ,
  4498           DFHEIV11,
  4499           PY-CONTROL-PRIMARY,
  4500           DFHEIV99,
  4501           DFHEIV99
  4502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4503
  4504
  4505*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4506
  4507
  4508* EXEC CICS READ
  4509*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4510*        DATASET  (PYAJ-FILE-ID)
  4511*        RIDFLD   (ERPYAJ-KEY)
  4512*        UPDATE
  4513*    END-EXEC.
  4514*    MOVE '&"S        EU         (   #00004181' TO DFHEIV0
  4515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4516     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4517     MOVE X'2020233030303034313831' TO DFHEIV0(25:11)
  4518     CALL 'kxdfhei1' USING DFHEIV0,
  4519           PYAJ-FILE-ID,
  4520           DFHEIV20,
  4521           DFHEIV99,
  4522           ERPYAJ-KEY,
  4523           DFHEIV99,
  4524           DFHEIV99,
  4525           DFHEIV99
  4526     SET ADDRESS OF PENDING-PAY-ADJ TO
  4527         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  90
* EL633.cbl
  4528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4529
  4530
  4531     GO TO 2190-EXIT.
  4532
  4533 2190-DUP-RECORD.
  4534
  4535     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4536
  4537     GO TO 2190-RETRY-WRITE.
  4538
  4539 2190-EXIT.
  4540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  91
* EL633.cbl
  4542
  4543 2200-UPDATE-COMPLETE.
  4544     IF EIBAID = DFHPF1
  4545         GO TO 4000-BROWSE-FRWD.
  4546
  4547     IF EIBAID = DFHPF2
  4548         GO TO 4100-BROWSE-BKWD.
  4549
  4550     MOVE LOW-VALUES             TO  EL633AI.
  4551
  4552     MOVE ER-0000                TO  EMI-ERROR.
  4553     MOVE -1                     TO  MAINTL.
  4554
  4555     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4556
  4557     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4558     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4559
  4560*    GO TO 4000-BROWSE-FRWD.
  4561
  4562*    GO TO 8100-SEND-INITIAL-MAP.
  4563
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  92
* EL633.cbl
  4565 4000-BROWSE-FRWD.
  4566     MOVE '1'                     TO  PI-PREV-PFKEY.
  4567     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4568
  4569     IF EIBAID = DFHPF1
  4570         IF PAGE-FULL
  4571             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4572                                      TO  PYAJ-FILE-SEQ-NO
  4573             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4574             MOVE 'N'                 TO  PYAJ-READ-SW
  4575             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4576             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4577             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4578             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4579         ELSE
  4580             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4581                                          PI-SAV-ACCT-NET
  4582                                          PI-SAV-PREV-AMT
  4583                                          PI-SAV-PREV-NET
  4584             MOVE 'Y'                 TO  PI-PAGE-SW
  4585             IF NOT END-OF-FILE
  4586                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4587                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4588             END-IF
  4589             IF TOP-OF-FILE
  4590                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4591                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4592                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4593             ELSE
  4594                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4595                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4596     ELSE
  4597         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4598         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4599         IF MAINTI = 'S'
  4600             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4601             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4602
  4603
  4604     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4605
  4606     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4607         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4608
  4609 4000-BROWSE-FRWD-FOR-PREV.
  4610*    IF END-OF-FILE
  4611*        IF EIBAID = DFHPF1
  4612*           IF PI-TOTAL-DISPLAYED
  4613*              NEXT SENTENCE
  4614*           ELSE
  4615*              MOVE -1                 TO  MAINTL
  4616*              MOVE ER-2237            TO  EMI-ERROR
  4617*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4618*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4619*              SET PINDX               TO  +2
  4620*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4621*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4622*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  93
* EL633.cbl
  4623*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4624*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4625*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4626*                                          PI-SAV-ACCT-NET
  4627*              GO TO 8100-SEND-INITIAL-MAP.
  4628*
  4629*     IF END-OF-FILE
  4630*        IF EIBAID = DFHPF1
  4631*           MOVE -1             TO  MAINTL
  4632*           MOVE ER-2237        TO  EMI-ERROR
  4633*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4634*           GO TO 8200-SEND-DATAONLY.
  4635*
  4636     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4637
  4638     IF NO-RECORDS
  4639        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4640        MOVE LOW-VALUES         TO  EL633AO
  4641        MOVE ER-2239            TO  EMI-ERROR
  4642        MOVE -1                 TO  MAINTL
  4643        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4644        GO TO 8100-SEND-INITIAL-MAP.
  4645
  4646     IF NOT-OPEN
  4647         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4648
  4649     MOVE LOW-VALUES             TO  EL633AO.
  4650     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4651
  4652     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4653          VARYING  PINDX  FROM  1  BY  1
  4654             UNTIL  END-OF-ACCT
  4655                 OR  END-OF-FILE
  4656                     OR  PAGE-FULL
  4657                         OR  NO-RECORDS.
  4658
  4659     IF NO-RECORDS
  4660         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4661         MOVE LOW-VALUES         TO  EL633AO
  4662         MOVE ER-2239            TO  EMI-ERROR
  4663         MOVE -1                 TO  MAINTL
  4664         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4665         GO TO 8100-SEND-INITIAL-MAP.
  4666
  4667     IF END-OF-FILE
  4668         IF EIBAID = DFHPF2
  4669             MOVE ER-2238        TO  EMI-ERROR
  4670             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4671             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4672         ELSE
  4673             MOVE ER-2237        TO  EMI-ERROR
  4674             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4675
  4676     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4677                                     PI-SAV-FUNCTION.
  4678
  4679     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  94
* EL633.cbl
  4681 4100-BROWSE-BKWD.
  4682     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4683                                      PI-TOTAL-DISPLAYED-SW.
  4684     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4685     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4686     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4687     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4688                                      PI-SAV-ACCT-NET
  4689                                      PI-SAV-PREV-AMT
  4690                                      PI-SAV-PREV-NET.
  4691
  4692     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4693
  4694     IF NO-RECORDS
  4695         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4696         MOVE LOW-VALUES         TO  EL633AO
  4697         MOVE ER-2239            TO  EMI-ERROR
  4698         MOVE -1                 TO  MAINTL
  4699         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4700         GO TO 8100-SEND-INITIAL-MAP.
  4701
  4702     IF NOT-OPEN
  4703         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4704
  4705
  4706* EXEC CICS READNEXT
  4707*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4708*        DATASET  (PYAJ-FILE-ID)
  4709*        RIDFLD   (ERPYAJ-KEY)
  4710*    END-EXEC.
  4711     MOVE 0
  4712       TO DFHEIV11
  4713*    MOVE '&.S                   )   #00004362' TO DFHEIV0
  4714     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4716     MOVE X'2020233030303034333632' TO DFHEIV0(25:11)
  4717     CALL 'kxdfhei1' USING DFHEIV0,
  4718           PYAJ-FILE-ID,
  4719           DFHEIV20,
  4720           DFHEIV99,
  4721           ERPYAJ-KEY,
  4722           DFHEIV99,
  4723           DFHEIV11,
  4724           DFHEIV99,
  4725           DFHEIV99
  4726     SET ADDRESS OF PENDING-PAY-ADJ TO
  4727         DFHEIV20
  4728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4729
  4730
  4731     IF FIRST-PAGE OR
  4732        PI-PREV-PFKEY = '2'
  4733         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4734         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4735
  4736     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4737
  4738     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  95
* EL633.cbl
  4739     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4740     MOVE '2'                     TO  PI-PREV-PFKEY.
  4741
  4742     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  96
* EL633.cbl
  4744 5000-START-BROWSE.
  4745
  4746* EXEC CICS HANDLE CONDITION
  4747*        NOTOPEN  (5010-NOT-OPEN)
  4748*        NOTFND   (5020-NO-RECORDS)
  4749*        ENDFILE  (5020-NO-RECORDS)
  4750*    END-EXEC.
  4751*    MOVE '"$JI''                 ! ( #00004382' TO DFHEIV0
  4752     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4754     MOVE X'2820233030303034333832' TO DFHEIV0(25:11)
  4755     CALL 'kxdfhei1' USING DFHEIV0
  4756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4757
  4758
  4759
  4760* EXEC CICS STARTBR
  4761*        DATASET  (PYAJ-FILE-ID)
  4762*        RIDFLD   (ERPYAJ-KEY)
  4763*    END-EXEC.
  4764     MOVE 0
  4765       TO DFHEIV11
  4766*    MOVE '&,         G          &   #00004388' TO DFHEIV0
  4767     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4768     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4769     MOVE X'2020233030303034333838' TO DFHEIV0(25:11)
  4770     CALL 'kxdfhei1' USING DFHEIV0,
  4771           PYAJ-FILE-ID,
  4772           ERPYAJ-KEY,
  4773           DFHEIV99,
  4774           DFHEIV11,
  4775           DFHEIV99
  4776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4777
  4778
  4779     GO TO 5030-EXIT.
  4780
  4781 5010-NOT-OPEN.
  4782     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4783
  4784     GO TO 5030-EXIT.
  4785
  4786 5020-NO-RECORDS.
  4787     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4788     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4789
  4790 5030-EXIT.
  4791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  97
* EL633.cbl
  4793 5100-READ-PREVIOUS.
  4794
  4795* EXEC CICS HANDLE CONDITION
  4796*        ENDFILE  (5110-END-OF-FILE)
  4797*        NOTFND   (5110-END-OF-FILE)
  4798*    END-EXEC.
  4799*    MOVE '"$''I                  ! ) #00004408' TO DFHEIV0
  4800     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4802     MOVE X'2920233030303034343038' TO DFHEIV0(25:11)
  4803     CALL 'kxdfhei1' USING DFHEIV0
  4804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4805
  4806
  4807
  4808* EXEC CICS READPREV
  4809*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4810*        DATASET  (PYAJ-FILE-ID)
  4811*        RIDFLD   (ERPYAJ-KEY)
  4812*    END-EXEC.
  4813     MOVE 0
  4814       TO DFHEIV11
  4815*    MOVE '&0S                   )   #00004413' TO DFHEIV0
  4816     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4818     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4819     CALL 'kxdfhei1' USING DFHEIV0,
  4820           PYAJ-FILE-ID,
  4821           DFHEIV20,
  4822           DFHEIV99,
  4823           ERPYAJ-KEY,
  4824           DFHEIV99,
  4825           DFHEIV11,
  4826           DFHEIV99,
  4827           DFHEIV99
  4828     SET ADDRESS OF PENDING-PAY-ADJ TO
  4829         DFHEIV20
  4830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4831
  4832
  4833     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4834         IF PI-CARRIER-SECURITY = PY-CARRIER
  4835             NEXT SENTENCE
  4836         ELSE
  4837             GO TO 5110-END-OF-FILE.
  4838
  4839     GO TO 5120-EXIT.
  4840
  4841 5110-END-OF-FILE.
  4842     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4843     MOVE ER-2238                TO  EMI-ERROR.
  4844     MOVE -1                     TO  PFENTERL.
  4845
  4846     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4847
  4848     GO TO 8200-SEND-DATAONLY.
  4849
  4850 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  98
* EL633.cbl
  4851     EXIT.
  4852
  4853 5200-END-BROWSE.
  4854
  4855* EXEC CICS ENDBR
  4856*        DATASET  (PYAJ-FILE-ID)
  4857*    END-EXEC.
  4858     MOVE 0
  4859       TO DFHEIV11
  4860*    MOVE '&2                    $   #00004440' TO DFHEIV0
  4861     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4863     MOVE X'2020233030303034343430' TO DFHEIV0(25:11)
  4864     CALL 'kxdfhei1' USING DFHEIV0,
  4865           PYAJ-FILE-ID,
  4866           DFHEIV11,
  4867           DFHEIV99
  4868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4869
  4870
  4871 5200-EXIT.
  4872     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page  99
* EL633.cbl
  4874 6000-READ-AND-FORMAT-SCREEN.
  4875
  4876* EXEC CICS HANDLE CONDITION
  4877*        ENDFILE  (6100-END-OF-FILE)
  4878*        NOTFND   (6100-END-OF-FILE)
  4879*    END-EXEC.
  4880*    MOVE '"$''I                  ! * #00004448' TO DFHEIV0
  4881     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4883     MOVE X'2A20233030303034343438' TO DFHEIV0(25:11)
  4884     CALL 'kxdfhei1' USING DFHEIV0
  4885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4886
  4887
  4888*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4889*    INITIALIZE  PI-SEQ-NOS.
  4890
  4891 6010-READ-NEXT.
  4892
  4893
  4894* EXEC CICS READNEXT
  4895*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4896*        DATASET  (PYAJ-FILE-ID)
  4897*        RIDFLD   (ERPYAJ-KEY)
  4898*    END-EXEC.
  4899     MOVE 0
  4900       TO DFHEIV11
  4901*    MOVE '&.S                   )   #00004458' TO DFHEIV0
  4902     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4903     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4904     MOVE X'2020233030303034343538' TO DFHEIV0(25:11)
  4905     CALL 'kxdfhei1' USING DFHEIV0,
  4906           PYAJ-FILE-ID,
  4907           DFHEIV20,
  4908           DFHEIV99,
  4909           ERPYAJ-KEY,
  4910           DFHEIV99,
  4911           DFHEIV11,
  4912           DFHEIV99,
  4913           DFHEIV99
  4914     SET ADDRESS OF PENDING-PAY-ADJ TO
  4915         DFHEIV20
  4916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4917
  4918
  4919     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4920       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4921         GO TO 6100-END-OF-FILE.
  4922
  4923     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4924         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4925             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4926                 GO TO 6100-END-OF-FILE.
  4927
  4928     IF PYAJ-1ST-READ
  4929       AND EIBAID NOT = DFHENTER
  4930       AND NOT PAGE-FULL
  4931         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 100
* EL633.cbl
  4932         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4933         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4934         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4935         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4936
  4937     IF PYAJ-1ST-READ
  4938         MOVE PI-SAV-ENDING-PYAJ-KEY
  4939                                 TO  PI-START-PYAJ-KEY.
  4940
  4941     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4942        PI-SAV-CARRIER  = PY-CARRIER     AND
  4943        PI-SAV-GROUPING = PY-GROUPING    AND
  4944        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4945        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4946         NEXT SENTENCE
  4947     ELSE
  4948         IF PYAJ-1ST-READ
  4949             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4950             MOVE SPACE          TO  PYAJ-READ-SW
  4951             GO TO 6200-EXIT
  4952         ELSE
  4953             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4954             IF PINDX  IS LESS THAN  12
  4955                 SET PINDX  UP  BY  1
  4956                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4957                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4958                 SET PINDX  UP  BY  1
  4959                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4960                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4961                     GO TO 6200-EXIT
  4962             ELSE
  4963                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4964                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4965                 SET PINDX  UP  BY  1
  4966                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4967                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4968                 GO TO 6200-EXIT.
  4969
  4970*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4971
  4972     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4973         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4974
  4975*    SET PINDX  UP  BY +1.
  4976
  4977     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4978
  4979     IF PINDX  IS GREATER THAN  13
  4980         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4981         MOVE +13                TO  PI-FULL-INDX
  4982         MOVE PI-FRST-FILE-SEQ-NO
  4983                                 TO  PI-LAST-FILE-SEQ-NO
  4984         MOVE PI-FRST-RECORD-TYPE
  4985                                 TO  PI-LAST-RECORD-TYPE
  4986         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4987         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4988         GO TO 6200-EXIT.
  4989
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 101
* EL633.cbl
  4990     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4991     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4992
  4993     IF PYAJ-1ST-READ
  4994         MOVE SPACE              TO  PYAJ-READ-SW.
  4995
  4996     IF PINDX = 1
  4997         MOVE PI-PREV-FILE-SEQ-NO
  4998                                 TO  PI-FRST-FILE-SEQ-NO
  4999         MOVE PI-PREV-RECORD-TYPE
  5000                                 TO  PI-FRST-RECORD-TYPE
  5001         MOVE PI-PREV-FILE-SEQ-NO
  5002                                 TO  PI-LAST-FILE-SEQ-NO
  5003         MOVE PI-PREV-RECORD-TYPE
  5004                                 TO  PI-LAST-RECORD-TYPE.
  5005
  5006     SET NDX                     TO  PINDX.
  5007     SET WS-SAVE-NDX-VALUE       TO  NDX.
  5008
  5009     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  5010
  5011     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  5012     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  5013     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  5014     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  5015     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  5016
  5017     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  5018
  5019     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  5020         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  5021     ELSE
  5022         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5023
  5024     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5025                                     PI-REC-TYPE (NDX).
  5026
  5027     IF PY-VOID-SW NOT = SPACE
  5028         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5029
  5030     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5031         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5032     ELSE
  5033         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5034                                     PREV-BIN-MAINT-DT
  5035         MOVE SPACE              TO  DC-OPTION-CODE
  5036         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5037* DAN    MOVE DC-GREG-DATE-1-EDIT
  5038         MOVE DC-GREG-DATE-1-MDY
  5039                                 TO  MDTE (PINDX)
  5040                                     PREV-MAINT-DT.
  5041
  5042*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5043     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5044         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5045         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5046*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5047*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 102
* EL633.cbl
  5048     END-IF.
  5049
  5050     IF PY-BILLED-DATE NOT = LOW-VALUES
  5051         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5052                                     AMT-ATTRB (PINDX)
  5053                                     VOID-SW-ATTRB (PINDX)
  5054         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5055             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5056         ELSE
  5057             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5058                                     PREV-BIN-BL-DT
  5059             MOVE SPACE          TO  DC-OPTION-CODE
  5060             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5061* DAN        MOVE DC-GREG-DATE-1-EDIT
  5062             MOVE DC-GREG-DATE-1-MDY
  5063                                 TO  BDTE (PINDX)
  5064                                     PREV-BL-DT.
  5065
  5066     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5067         NEXT SENTENCE
  5068     ELSE
  5069         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5070                                     AMT-ATTRB     (PINDX).
  5071
  5072     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5073         MOVE PY-CREDIT-SELECT-DT
  5074                                 TO  DC-BIN-DATE-1
  5075         MOVE SPACE              TO  DC-OPTION-CODE
  5076         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5077
  5078         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5079         MOVE WS-GS-MM             TO  WS-SS-MM
  5080         MOVE WS-GS-DD             TO  WS-SS-DD
  5081         MOVE WS-GS-YY             TO  WS-SS-YY
  5082         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5083     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5084        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5085         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5086                                    AMT-ATTRB      (PINDX)
  5087                                    GL-ACCT-ATTRB  (PINDX)
  5088                                    GL-COMM-ATTRB  (PINDX)
  5089                                    VOID-SW-ATTRB  (PINDX)
  5090                                    GL-STATE-ATTRB (PINDX)
  5091                                    GL-CANC-ATTRB  (PINDX)
  5092                                    SDTE-ATTRB     (PINDX)
  5093
  5094     END-IF
  5095
  5096*    GO TO 6010-READ-NEXT.
  5097     GO TO 6200-EXIT.
  5098
  5099 6100-END-OF-FILE.
  5100     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5101
  5102     IF PINDX  IS LESS THAN  12
  5103         SET PINDX  UP  BY  1
  5104         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5105         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 103
* EL633.cbl
  5106         SET PINDX  UP  BY  1
  5107         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5108         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5109         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5110     ELSE
  5111         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5112         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5113         SET PINDX  UP  BY  1
  5114         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5115         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5116
  5117 6200-EXIT.
  5118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 104
* EL633.cbl
  5120 7000-PYAJ-FILE-NOTOPEN.
  5121     MOVE -1                     TO  MAINTL.
  5122     MOVE ER-2232                TO  EMI-ERROR.
  5123
  5124     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5125
  5126     GO TO 8200-SEND-DATAONLY.
  5127
  5128 7100-COMP-FILE-NOTOPEN.
  5129     MOVE -1                     TO  MAINTL.
  5130     MOVE ER-2233                TO  EMI-ERROR.
  5131
  5132     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5133
  5134     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 105
* EL633.cbl
  5136*
  5137*7100-COFA-FILE-NOTOPEN.
  5138*    MOVE -1                     TO PFENTERL.
  5139*    MOVE ER-2959                TO EMI-ERROR.
  5140*    PERFORM 9900-ERROR-FORMAT THRU
  5141*            9900-EXIT.
  5142*    GO TO 8200-SEND-DATAONLY.
  5143*
  5144 8100-SEND-INITIAL-MAP.
  5145     MOVE WS-CURRENT-DT          TO  DATEO.
  5146     MOVE EIBTIME                TO  TIME-IN.
  5147     MOVE TIME-OUT               TO  TIMEO.
  5148     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5149     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5150     MOVE -1                     TO  MAINTL.
  5151     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5152     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5153
  5154     IF EIBTRNID = TRANS-ID
  5155       OR EL640-TRANS-ID
  5156       OR EL642-TRANS-ID
  5157       OR EL652-TRANS-ID
  5158       OR EL6331-TRANS-ID
  5159         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5160             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5161             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5162             MOVE PI-SAV-GROUPING  TO  GROUPO
  5163             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5164             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5165             MOVE AL-UANON         TO  MAINTA
  5166                                       CARRIERA
  5167                                       GROUPA
  5168                                       FINRESPA
  5169                                       ACCTA
  5170         ELSE
  5171             NEXT SENTENCE.
  5172
  5173
  5174* EXEC CICS SEND
  5175*        MAP     (MAP-NAME)
  5176*        MAPSET  (MAPSET-NAME)
  5177*        FROM    (EL633AO)
  5178*        ERASE
  5179*        CURSOR
  5180*        END-EXEC.
  5181     MOVE LENGTH OF
  5182      EL633AO
  5183       TO DFHEIV12
  5184     MOVE -1
  5185       TO DFHEIV11
  5186*    MOVE '8$     CT  E    H L F ,   #00004718' TO DFHEIV0
  5187     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5188     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5189     MOVE X'2020233030303034373138' TO DFHEIV0(25:11)
  5190     CALL 'kxdfhei1' USING DFHEIV0,
  5191           MAP-NAME,
  5192           EL633AO,
  5193           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 106
* EL633.cbl
  5194           MAPSET-NAME,
  5195           DFHEIV99,
  5196           DFHEIV99,
  5197           DFHEIV99,
  5198           DFHEIV11,
  5199           DFHEIV99,
  5200           DFHEIV99,
  5201           DFHEIV99
  5202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5203
  5204
  5205     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 107
* EL633.cbl
  5207 8200-SEND-DATAONLY.
  5208     MOVE WS-CURRENT-DT          TO  DATEO.
  5209     MOVE EIBTIME                TO  TIME-IN.
  5210     MOVE TIME-OUT               TO  TIMEO.
  5211     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5212     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5213     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5214     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5215
  5216
  5217* EXEC CICS SEND
  5218*        MAP     (MAP-NAME)
  5219*        MAPSET  (MAPSET-NAME)
  5220*        FROM    (EL633AO)
  5221*        DATAONLY
  5222*        CURSOR
  5223*    END-EXEC.
  5224     MOVE LENGTH OF
  5225      EL633AO
  5226       TO DFHEIV12
  5227     MOVE -1
  5228       TO DFHEIV11
  5229*    MOVE '8$D    CT       H L F ,   #00004737' TO DFHEIV0
  5230     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5231     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5232     MOVE X'2020233030303034373337' TO DFHEIV0(25:11)
  5233     CALL 'kxdfhei1' USING DFHEIV0,
  5234           MAP-NAME,
  5235           EL633AO,
  5236           DFHEIV12,
  5237           MAPSET-NAME,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV11,
  5242           DFHEIV99,
  5243           DFHEIV99,
  5244           DFHEIV99
  5245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5246
  5247
  5248     GO TO 9100-RETURN-TRAN.
  5249
  5250 8300-SEND-TEXT.
  5251
  5252* EXEC CICS SEND TEXT
  5253*        FROM    (LOGOFF-TEXT)
  5254*        LENGTH  (LOGOFF-LENGTH)
  5255*        ERASE
  5256*        FREEKB
  5257*    END-EXEC.
  5258*    MOVE '8&      T  E F  H   F -   #00004748' TO DFHEIV0
  5259     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5260     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5261     MOVE X'2020233030303034373438' TO DFHEIV0(25:11)
  5262     CALL 'kxdfhei1' USING DFHEIV0,
  5263           LOGOFF-TEXT,
  5264           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 108
* EL633.cbl
  5265           DFHEIV99,
  5266           DFHEIV99,
  5267           DFHEIV99,
  5268           DFHEIV99,
  5269           DFHEIV99,
  5270           DFHEIV99,
  5271           DFHEIV99,
  5272           DFHEIV99,
  5273           DFHEIV99,
  5274           DFHEIV99
  5275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5276
  5277
  5278
  5279* EXEC CICS RETURN
  5280*    END-EXEC.
  5281*    MOVE '.(                    ''   #00004755' TO DFHEIV0
  5282     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5283     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5284     MOVE X'2020233030303034373535' TO DFHEIV0(25:11)
  5285     CALL 'kxdfhei1' USING DFHEIV0,
  5286           DFHEIV99,
  5287           DFHEIV99,
  5288           DFHEIV99,
  5289           DFHEIV99,
  5290           DFHEIV99,
  5291           DFHEIV99
  5292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5293
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 109
* EL633.cbl
  5295 8400-LOG-JOURNAL-RECORD.
  5296*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5297*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5298
  5299*    EXEC CICS JOURNAL
  5300*        JFILEID  (PI-JOURNAL-FILE-ID)
  5301*        JTYPEID  ('EL')
  5302*        FROM     (JOURNAL-RECORD)
  5303*        LENGTH   (223)
  5304*        END-EXEC.
  5305
  5306 8500-DATE-CONVERT.
  5307
  5308* EXEC CICS LINK
  5309*        PROGRAM   (LINK-CLDATCV)
  5310*        COMMAREA  (DATE-CONVERSION-DATA)
  5311*        LENGTH    (DC-COMM-LENGTH)
  5312*    END-EXEC.
  5313*    MOVE '."C                   (   #00004770' TO DFHEIV0
  5314     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5315     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5316     MOVE X'2020233030303034373730' TO DFHEIV0(25:11)
  5317     CALL 'kxdfhei1' USING DFHEIV0,
  5318           LINK-CLDATCV,
  5319           DATE-CONVERSION-DATA,
  5320           DC-COMM-LENGTH,
  5321           DFHEIV99,
  5322           DFHEIV99,
  5323           DFHEIV99,
  5324           DFHEIV99
  5325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5326
  5327
  5328 8500-EXIT.
  5329     EXIT.
  5330
  5331 8600-DEEDIT.
  5332
  5333* EXEC CICS BIF DEEDIT
  5334*        FIELD   (DEEDIT-FIELD)
  5335*        LENGTH  (11)
  5336*    END-EXEC.
  5337     MOVE 11
  5338       TO DFHEIV11
  5339*    MOVE '@"L                   #   #00004780' TO DFHEIV0
  5340     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5341     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5342     MOVE X'2020233030303034373830' TO DFHEIV0(25:11)
  5343     CALL 'kxdfhei1' USING DFHEIV0,
  5344           DEEDIT-FIELD,
  5345           DFHEIV11
  5346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5347
  5348
  5349 8600-EXIT.
  5350     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 110
* EL633.cbl
  5352 8800-UNAUTHORIZED-ACCESS.
  5353     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5354
  5355     GO TO 8300-SEND-TEXT.
  5356
  5357 8810-PF23.
  5358     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5359     MOVE XCTL-005               TO  PGM-NAME.
  5360
  5361     GO TO 9300-XCTL.
  5362
  5363 9100-RETURN-TRAN.
  5364     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5365     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5366
  5367
  5368* EXEC CICS RETURN
  5369*        TRANSID   (TRANS-ID)
  5370*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5371*        LENGTH    (PI-COMM-LENGTH)
  5372*    END-EXEC.
  5373*    MOVE '.(CT                  ''   #00004803' TO DFHEIV0
  5374     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5376     MOVE X'2020233030303034383033' TO DFHEIV0(25:11)
  5377     CALL 'kxdfhei1' USING DFHEIV0,
  5378           TRANS-ID,
  5379           PROGRAM-INTERFACE-BLOCK,
  5380           PI-COMM-LENGTH,
  5381           DFHEIV99,
  5382           DFHEIV99,
  5383           DFHEIV99
  5384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5385
  5386
  5387 9200-RETURN-MAIN-MENU.
  5388     MOVE XCTL-626               TO  PGM-NAME.
  5389
  5390     GO TO 9300-XCTL.
  5391
  5392 9300-XCTL.
  5393
  5394* EXEC CICS XCTL
  5395*        PROGRAM   (PGM-NAME)
  5396*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5397*        LENGTH    (PI-COMM-LENGTH)
  5398*    END-EXEC.
  5399*    MOVE '.$C                   %   #00004815' TO DFHEIV0
  5400     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5401     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5402     MOVE X'2020233030303034383135' TO DFHEIV0(25:11)
  5403     CALL 'kxdfhei1' USING DFHEIV0,
  5404           PGM-NAME,
  5405           PROGRAM-INTERFACE-BLOCK,
  5406           PI-COMM-LENGTH,
  5407           DFHEIV99
  5408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5409
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 111
* EL633.cbl
  5410
  5411 9400-CLEAR.
  5412     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5413
  5414     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5415     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5416                                     PI-SAV-COMP-CONTROL.
  5417
  5418     GO TO 9300-XCTL.
  5419
  5420 9500-PF12.
  5421     MOVE XCTL-010               TO  PGM-NAME.
  5422
  5423     GO TO 9300-XCTL.
  5424
  5425 9600-PGMID-ERROR.
  5426
  5427* EXEC CICS HANDLE CONDITION
  5428*        PGMIDERR  (8300-SEND-TEXT)
  5429*    END-EXEC.
  5430*    MOVE '"$L                   ! + #00004836' TO DFHEIV0
  5431     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5433     MOVE X'2B20233030303034383336' TO DFHEIV0(25:11)
  5434     CALL 'kxdfhei1' USING DFHEIV0
  5435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5436
  5437
  5438     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5439     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5440     MOVE XCTL-005               TO  PGM-NAME.
  5441     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5442     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5443
  5444     GO TO 9300-XCTL.
  5445
  5446 9900-ERROR-FORMAT.
  5447     IF NOT EMI-ERRORS-COMPLETE
  5448         MOVE LINK-001           TO  PGM-NAME
  5449
  5450* EXEC CICS LINK
  5451*            PROGRAM   (PGM-NAME)
  5452*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5453*            LENGTH    (EMI-COMM-LENGTH)
  5454*        END-EXEC.
  5455*    MOVE '."C                   (   #00004851' TO DFHEIV0
  5456     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5458     MOVE X'2020233030303034383531' TO DFHEIV0(25:11)
  5459     CALL 'kxdfhei1' USING DFHEIV0,
  5460           PGM-NAME,
  5461           ERROR-MESSAGE-INTERFACE-BLOCK,
  5462           EMI-COMM-LENGTH,
  5463           DFHEIV99,
  5464           DFHEIV99,
  5465           DFHEIV99,
  5466           DFHEIV99
  5467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 112
* EL633.cbl
  5468
  5469
  5470 9900-EXIT.
  5471     EXIT.
  5472
  5473 9990-ABEND.
  5474     MOVE LINK-004               TO  PGM-NAME.
  5475     MOVE DFHEIBLK               TO  EMI-LINE1.
  5476
  5477
  5478* EXEC CICS LINK
  5479*        PROGRAM   (PGM-NAME)
  5480*        COMMAREA  (EMI-LINE1)
  5481*        LENGTH    (72)
  5482*    END-EXEC.
  5483     MOVE 72
  5484       TO DFHEIV11
  5485*    MOVE '."C                   (   #00004864' TO DFHEIV0
  5486     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5488     MOVE X'2020233030303034383634' TO DFHEIV0(25:11)
  5489     CALL 'kxdfhei1' USING DFHEIV0,
  5490           PGM-NAME,
  5491           EMI-LINE1,
  5492           DFHEIV11,
  5493           DFHEIV99,
  5494           DFHEIV99,
  5495           DFHEIV99,
  5496           DFHEIV99
  5497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5498
  5499
  5500     MOVE -1                     TO  PFENTERL.
  5501
  5502     GO TO 8200-SEND-DATAONLY.
  5503
  5504 9995-SECURITY-VIOLATION.
  5505*                            COPY ELCSCTP.
  5506******************************************************************
  5507*                                                                *
  5508*                            ELCSCTP                             *
  5509*                            VMOD=2.001                          *
  5510*                                                                *
  5511*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5512******************************************************************
  5513
  5514
  5515     MOVE EIBDATE          TO SM-JUL-DATE.
  5516     MOVE EIBTRMID         TO SM-TERMID.
  5517     MOVE THIS-PGM         TO SM-PGM.
  5518     MOVE EIBTIME          TO TIME-IN.
  5519     MOVE TIME-OUT         TO SM-TIME.
  5520     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5521
  5522
  5523* EXEC CICS LINK
  5524*         PROGRAM  ('EL003')
  5525*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 113
* EL633.cbl
  5526*         LENGTH   (80)
  5527*    END-EXEC.
  5528     MOVE 'EL003' TO DFHEIV1
  5529     MOVE 80
  5530       TO DFHEIV11
  5531*    MOVE '."C                   (   #00004892' TO DFHEIV0
  5532     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5534     MOVE X'2020233030303034383932' TO DFHEIV0(25:11)
  5535     CALL 'kxdfhei1' USING DFHEIV0,
  5536           DFHEIV1,
  5537           SECURITY-MESSAGE,
  5538           DFHEIV11,
  5539           DFHEIV99,
  5540           DFHEIV99,
  5541           DFHEIV99,
  5542           DFHEIV99
  5543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5544
  5545
  5546******************************************************************
  5547
  5548
  5549 9995-EXIT.
  5550     EXIT.
  5551
  5552
  5553 9999-DFHBACK SECTION.
  5554     MOVE '9%                    "   ' TO DFHEIV0
  5555     MOVE 'EL633' TO DFHEIV1
  5556     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5557     GOBACK.
  5558 9999-DFHEXIT.
  5559     IF DFHEIGDJ EQUAL 0001
  5560         NEXT SENTENCE
  5561     ELSE IF DFHEIGDJ EQUAL 2
  5562         GO TO 9600-PGMID-ERROR,
  5563               9990-ABEND
  5564         DEPENDING ON DFHEIGDI
  5565     ELSE IF DFHEIGDJ EQUAL 3
  5566         GO TO 0410-NO-COMP-MSTR,
  5567               7100-COMP-FILE-NOTOPEN
  5568         DEPENDING ON DFHEIGDI
  5569     ELSE IF DFHEIGDJ EQUAL 4
  5570         GO TO 0890-EXIT
  5571         DEPENDING ON DFHEIGDI
  5572     ELSE IF DFHEIGDJ EQUAL 5
  5573         GO TO 2110-ADD-RECORD
  5574         DEPENDING ON DFHEIGDI
  5575     ELSE IF DFHEIGDJ EQUAL 6
  5576         GO TO 2120-DELETE-CONT
  5577         DEPENDING ON DFHEIGDI
  5578     ELSE IF DFHEIGDJ EQUAL 7
  5579         GO TO 2190-DUP-RECORD
  5580         DEPENDING ON DFHEIGDI
  5581     ELSE IF DFHEIGDJ EQUAL 8
  5582         GO TO 5010-NOT-OPEN,
  5583               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 09-Jun-17 10:47 Page 114
* EL633.cbl
  5584               5020-NO-RECORDS
  5585         DEPENDING ON DFHEIGDI
  5586     ELSE IF DFHEIGDJ EQUAL 9
  5587         GO TO 5110-END-OF-FILE,
  5588               5110-END-OF-FILE
  5589         DEPENDING ON DFHEIGDI
  5590     ELSE IF DFHEIGDJ EQUAL 10
  5591         GO TO 6100-END-OF-FILE,
  5592               6100-END-OF-FILE
  5593         DEPENDING ON DFHEIGDI
  5594     ELSE IF DFHEIGDJ EQUAL 11
  5595         GO TO 8300-SEND-TEXT
  5596         DEPENDING ON DFHEIGDI.
  5597     MOVE '9%                    "   ' TO DFHEIV0
  5598     MOVE 'EL633' TO DFHEIV1
  5599     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5600     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6176     Code:       16920
