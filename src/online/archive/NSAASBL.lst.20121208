* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* NSAASBL.cbl
* Options: int("NSAASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSAASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSAASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSAASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSAASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSAASLTR.cl2
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* NSAASBL.cbl
    14* 071111    2011022800001  PEMA  NEW PROGRAM
    15******************************************************************
    16 ENVIRONMENT DIVISION.
    17 DATA DIVISION.
    18 working-storage section.
    19 01  DFH-START PIC X(04).
    20 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    21 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    22 77  S1                          PIC S999 COMP-3 VALUE +0.
    23 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    24 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    25 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    26 01 response-code         pic s9(8) comp.
    27 01 display-response      pic 9(8).
    28 01 bl-index              pic 9(8) comp.
    29 01 max-last-name         pic x(18).
    30 01 first-initial         pic x.
    31 01 name-in-range-flag    pic 9.
    32 01 max-entries           pic s9(8) comp value 100.
    33 01 lower-case    pic x(26) value
    34            "abcdefghijklmnopqrstuvwxyz".
    35 01 upper-case    pic x(26) value
    36            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    37 01  MISC.
    38     12  WS-RESPONSE             PIC S9(8)   COMP.
    39         88  RESP-NORMAL                  VALUE +00.
    40         88  RESP-NOTFND                  VALUE +13.
    41         88  RESP-DUPREC                  VALUE +14.
    42         88  RESP-DUPKEY                  VALUE +15.
    43         88  RESP-NOTOPEN                 VALUE +19.
    44         88  RESP-ENDFILE                 VALUE +20.
    45*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
    46*                         COPY ELCZREC.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCZREC.                            *
    51*                                                                *
    52*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
    53*                                                                *
    54******************************************************************
    55*-----------------------------------------------------------------
    56*                   C H A N G E   L O G
    57*
    58* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    59*-----------------------------------------------------------------
    60*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    61* EFFECTIVE    NUMBER
    62*-----------------------------------------------------------------
    63* 122011    2011022800001  AJRA  NEW FILE
    64* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    65*-----------------------------------------------------------------
    66 01  W-Z-CONTROL-DATA.
    67     05  W-NUMBER-OF-COPIES      PIC  9.
    68     05  FILLER                  PIC  X.
    69     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    70     05  FILLER                  PIC  X.
    71     05  W-DAYS-TO-RESEND        PIC  999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* NSAASBL.cbl
    72     05  FILLER                  PIC  X.
    73     05  W-FORM-TO-RESEND        PIC  X(4).
    74     05  FILLER                  PIC  X.
    75     05  W-PROMPT-LETTER         PIC  X.
    76     05  FILLER                  PIC  X.
    77     05  W-ENCLOSURE-CD          PIC  XXX.
    78     05  FILLER                  PIC  X.
    79     05  W-AUTO-CLOSE-IND        PIC  X.
    80     05  FILLER                  PIC  X.
    81     05  W-LETTER-TO-BENE        PIC  X.
    82     05  FILLER                  PIC  X.
    83     05  W-LETTER-TO-ACCT        PIC  X.
    84     05  FILLER                  PIC  X.
    85     05  W-LETTER-TYPE           PIC  X.
    86     05  FILLER                  PIC  X.
    87     05  W-PRINT-CERTIFICATE     PIC  X.
    88     05  FILLER                  PIC  X.
    89     05  W-REFUND-REQUIRED       PIC  X.
    90     05  FILLER                  PIC  X.
    91     05  W-ONBASE-CODE           PIC  XX.
    92     05  FILLER                  PIC  X.
    93     05  W-ACCT-SUMM             PIC  X.
    94     05  FILLER                  PIC  X.
    95     05  W-CSO-SUMM              PIC  X.
    96     05  FILLER                  PIC  X(31).
    97 01  WS-ERARCH-KEY.
    98     05  WS-ERARCH-COMPANY-CD    PIC X.
    99     05  WS-ERARCH-ARCH-NO       PIC S9(8) BINARY.
   100 01  WS-ERENDT2-KEY.
   101     05  WS-ERENDT-COMPANY-CD    PIC X.
   102     05  WS-ERENDT-ARCH-NO       PIC 9(8) BINARY.
   103 01  WS-NSASEXTR-KEY.
   104     05  WS-EXTR-COMPANY-CD    PIC X.
   105     05  WS-EXTR-ARCH-NO       PIC 9(8) BINARY.
   106     05  WS-EXTR-SEQ-NO        PIC 9(4) BINARY.
   107 01  WS-ELLETR-KEY.
   108     05  WS-ELLETR-COMPANY-CD    PIC X.
   109     05  WS-ELLETR-LETTER-ID     PIC X(12).
   110     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   111 01 srch-commarea.
   112*                                copy ELCADLTRSPI.
   113******************************************************************
   114*                   C H A N G E   L O G
   115*
   116* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   117*-----------------------------------------------------------------
   118*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   119* EFFECTIVE    NUMBER
   120*-----------------------------------------------------------------
   121* 060611    2011022800001  PEMA  NEW COPYBOOK
   122******************************************************************
   123****************************************
   124*  commarea for NaperSoft On Demand Admin services letters
   125*  (business logic input & output)
   126****************************************
   127     03  BL-INPUT.
   128         05  BL-DATA-SRCE        PIC X.
   129         05  BL-LETTER-ID        PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* NSAASBL.cbl
   130         05  BL-CARRIER          PIC X.
   131         05  BL-GROUP            PIC X(6).
   132         05  BL-STATE            PIC XX.
   133         05  BL-ACCOUNT          PIC X(10).
   134         05  BL-EFF-DT           PIC X(10).
   135         05  BL-CERT-NO          PIC X(11).
   136         05  BL-BATCH-NO         PIC X(6).
   137         05  BL-BATCH-SEQ        PIC 9(8).
   138         05  BL-RESP-NO          PIC X(10).
   139         05  BL-NO-OF-COPIES     PIC 99.
   140         05  BL-PROC-ID          PIC XXXX.
   141         05  BL-COMP-ID          PIC XXX.
   142         05  BL-PRINT-NOW-SW     PIC X.
   143         05  BL-ENC-CD           PIC XXX.
   144         05  BL-RESEND-DT        PIC X(10).
   145         05  BL-FOLLOW-UP-DT     PIC X(10).
   146         05  BL-ARCHIVE-NO       PIC 9(8).
   147         05  BL-FUNC             PIC X(8).
   148         05  BL-COMMENTS         PIC X(70).
   149         05  FILLER REDEFINES BL-COMMENTS.
   150             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   151             10  BL-LETTER-TO-ACCT PIC X.
   152             10  BL-LETTER-TO-BENE PIC X.
   153             10  BL-WRITE-ERARCH   PIC X.
   154                 88  ERARCH-QWS      VALUE 'Q'.
   155                 88  ERARCH-BATCH    VALUE 'B'.
   156                 88  ERARCH-TEMP     VALUE 'T'.
   157             10  BL-PROCESS-TYPE PIC X(07).
   158             10  BL-CERT-FORM-ID PIC X(05).
   159             10  FILLER          PIC X(07).
   160     03  BL-OUTPUT.
   161         05  BL-STATUS                   PIC X.
   162             88  BL-OK                      VALUE "P".
   163             88  BL-FAIL                  VALUE "F".
   164         05  BL-MESSAGE          PIC X(50).
   165     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   166*                                COPY ELCDATE.
   167******************************************************************
   168*                                                                *
   169*                                                                *
   170*                            ELCDATE.                            *
   171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   172*                            VMOD=2.003
   173*                                                                *
   174*                                                                *
   175*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   176*                 LENGTH = 200                                   *
   177******************************************************************
   178
   179 01  DATE-CONVERSION-DATA.
   180     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   181     12  DC-OPTION-CODE                PIC X.
   182         88  BIN-TO-GREG                VALUE ' '.
   183         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   184         88  EDIT-GREG-TO-BIN           VALUE '2'.
   185         88  YMD-GREG-TO-BIN            VALUE '3'.
   186         88  MDY-GREG-TO-BIN            VALUE '4'.
   187         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* NSAASBL.cbl
   188         88  BIN-PLUS-ELAPSED           VALUE '6'.
   189         88  FIND-CENTURY               VALUE '7'.
   190         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   191         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   192         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   193         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   194         88  JULIAN-TO-BIN-3            VALUE 'C'.
   195         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   196         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   197         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   198         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   199         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   200         88  CHECK-LEAP-YEAR            VALUE 'H'.
   201         88  BIN-3-TO-GREG              VALUE 'I'.
   202         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   203         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   204         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   205         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   206         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   207         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   208         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   209         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   210         88  THREE-CHARACTER-BIN
   211                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   212         88  GREGORIAN-TO-BIN
   213                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   214         88  BIN-TO-GREGORIAN
   215                  VALUES ' ' '1' 'I' '8' 'G'.
   216         88  JULIAN-TO-BINARY
   217                  VALUES '5' 'C' 'E' 'F'.
   218     12  DC-ERROR-CODE                 PIC X.
   219         88  NO-CONVERSION-ERROR        VALUE ' '.
   220         88  DATE-CONVERSION-ERROR
   221                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   222         88  DATE-IS-ZERO               VALUE '1'.
   223         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   224         88  DATE-IS-INVALID            VALUE '3'.
   225         88  DATE1-GREATER-DATE2        VALUE '4'.
   226         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   227         88  DATE-INVALID-OPTION        VALUE '9'.
   228         88  INVALID-CENTURY            VALUE 'A'.
   229         88  ONLY-CENTURY               VALUE 'B'.
   230         88  ONLY-LEAP-YEAR             VALUE 'C'.
   231         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   232     12  DC-END-OF-MONTH               PIC X.
   233         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   234     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   235         88  USE-NORMAL-PROCESS         VALUE ' '.
   236         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   237         88  ADJUST-UP-100-YRS          VALUE '2'.
   238     12  FILLER                        PIC X.
   239     12  DC-CONVERSION-DATES.
   240         16  DC-BIN-DATE-1             PIC XX.
   241         16  DC-BIN-DATE-2             PIC XX.
   242         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   243         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   244                       DC-GREG-DATE-1-EDIT.
   245             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* NSAASBL.cbl
   246             20  SLASH1-1              PIC X.
   247             20  DC-EDIT1-DAY          PIC 99.
   248             20  SLASH1-2              PIC X.
   249             20  DC-EDIT1-YEAR         PIC 99.
   250         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   251         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   252                     DC-GREG-DATE-2-EDIT.
   253             20  DC-EDIT2-MONTH        PIC 99.
   254             20  SLASH2-1              PIC X.
   255             20  DC-EDIT2-DAY          PIC 99.
   256             20  SLASH2-2              PIC X.
   257             20  DC-EDIT2-YEAR         PIC 99.
   258         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   259         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   260                     DC-GREG-DATE-1-YMD.
   261             20  DC-YMD-YEAR           PIC 99.
   262             20  DC-YMD-MONTH          PIC 99.
   263             20  DC-YMD-DAY            PIC 99.
   264         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   265         16  DC-GREG-DATE-1-MDY-R REDEFINES
   266                      DC-GREG-DATE-1-MDY.
   267             20  DC-MDY-MONTH          PIC 99.
   268             20  DC-MDY-DAY            PIC 99.
   269             20  DC-MDY-YEAR           PIC 99.
   270         16  DC-GREG-DATE-1-ALPHA.
   271             20  DC-ALPHA-MONTH        PIC X(10).
   272             20  DC-ALPHA-DAY          PIC 99.
   273             20  FILLER                PIC XX.
   274             20  DC-ALPHA-CENTURY.
   275                 24 DC-ALPHA-CEN-N     PIC 99.
   276             20  DC-ALPHA-YEAR         PIC 99.
   277         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   278         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   279         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   280         16  DC-JULIAN-DATE            PIC 9(05).
   281         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   282                                       PIC 9(05).
   283         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   284             20  DC-JULIAN-YEAR        PIC 99.
   285             20  DC-JULIAN-DAYS        PIC 999.
   286         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   287         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   288         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   289     12  DATE-CONVERSION-VARIBLES.
   290         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   291         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   292             20  FILLER                PIC 9(3).
   293             20  HOLD-CEN-1-CCYY.
   294                 24  HOLD-CEN-1-CC     PIC 99.
   295                 24  HOLD-CEN-1-YY     PIC 99.
   296             20  HOLD-CEN-1-MO         PIC 99.
   297             20  HOLD-CEN-1-DA         PIC 99.
   298         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   299             20  HOLD-CEN-1-R-MO       PIC 99.
   300             20  HOLD-CEN-1-R-DA       PIC 99.
   301             20  HOLD-CEN-1-R-CCYY.
   302                 24  HOLD-CEN-1-R-CC   PIC 99.
   303                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* NSAASBL.cbl
   304             20  FILLER                PIC 9(3).
   305         16  HOLD-CENTURY-1-X.
   306             20  FILLER                PIC X(3)  VALUE SPACES.
   307             20  HOLD-CEN-1-X-CCYY.
   308                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   309                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   310             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   311             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   312         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   313             20  HOLD-CEN-1-R-X-MO     PIC XX.
   314             20  HOLD-CEN-1-R-X-DA     PIC XX.
   315             20  HOLD-CEN-1-R-X-CCYY.
   316                 24  HOLD-CEN-1-R-X-CC PIC XX.
   317                 24  HOLD-CEN-1-R-X-YY PIC XX.
   318             20  FILLER                PIC XXX.
   319         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   320         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   321         16  DC-JULIAN-DATE-1          PIC 9(07).
   322         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   323             20  DC-JULIAN-1-CCYY.
   324                 24  DC-JULIAN-1-CC    PIC 99.
   325                 24  DC-JULIAN-1-YR    PIC 99.
   326             20  DC-JULIAN-DA-1        PIC 999.
   327         16  DC-JULIAN-DATE-2          PIC 9(07).
   328         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   329             20  DC-JULIAN-2-CCYY.
   330                 24  DC-JULIAN-2-CC    PIC 99.
   331                 24  DC-JULIAN-2-YR    PIC 99.
   332             20  DC-JULIAN-DA-2        PIC 999.
   333         16  DC-GREG-DATE-A-EDIT.
   334             20  DC-EDITA-MONTH        PIC 99.
   335             20  SLASHA-1              PIC X VALUE '/'.
   336             20  DC-EDITA-DAY          PIC 99.
   337             20  SLASHA-2              PIC X VALUE '/'.
   338             20  DC-EDITA-CCYY.
   339                 24  DC-EDITA-CENT     PIC 99.
   340                 24  DC-EDITA-YEAR     PIC 99.
   341         16  DC-GREG-DATE-B-EDIT.
   342             20  DC-EDITB-MONTH        PIC 99.
   343             20  SLASHB-1              PIC X VALUE '/'.
   344             20  DC-EDITB-DAY          PIC 99.
   345             20  SLASHB-2              PIC X VALUE '/'.
   346             20  DC-EDITB-CCYY.
   347                 24  DC-EDITB-CENT     PIC 99.
   348                 24  DC-EDITB-YEAR     PIC 99.
   349         16  DC-GREG-DATE-CYMD         PIC 9(08).
   350         16  DC-GREG-DATE-CYMD-R REDEFINES
   351                              DC-GREG-DATE-CYMD.
   352             20  DC-CYMD-CEN           PIC 99.
   353             20  DC-CYMD-YEAR          PIC 99.
   354             20  DC-CYMD-MONTH         PIC 99.
   355             20  DC-CYMD-DAY           PIC 99.
   356         16  DC-GREG-DATE-MDCY         PIC 9(08).
   357         16  DC-GREG-DATE-MDCY-R REDEFINES
   358                              DC-GREG-DATE-MDCY.
   359             20  DC-MDCY-MONTH         PIC 99.
   360             20  DC-MDCY-DAY           PIC 99.
   361             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* NSAASBL.cbl
   362             20  DC-MDCY-YEAR          PIC 99.
   363    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   364        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   365    12  DC-EL310-DATE                  PIC X(21).
   366    12  FILLER                         PIC X(28).
   367*                                COPY ERCARCH.
   368******************************************************************
   369*                                                                *
   370*                            ERCARCH.                            *
   371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   372*                            VMOD=2.002                          *
   373*                                                                *
   374*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
   375*                                                                *
   376*   FILE TYPE = VSAM,KSDS                                        *
   377*   RECORD SIZE = 250  RECFORM = FIXED                           *
   378*                                                                *
   379*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
   380*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
   381*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
   382*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
   383*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
   384*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
   385*                                                                *
   386*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   387******************************************************************
   388*                   C H A N G E   L O G
   389*
   390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   391*-----------------------------------------------------------------
   392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   393* EFFECTIVE    NUMBER
   394*-----------------------------------------------------------------
   395* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   396* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   397******************************************************************
   398 01  LETTER-ARCHIVE.
   399     12  LA-RECORD-ID                PIC  X(02).
   400         88  LA-VALID-ID                VALUE 'LA'.
   401
   402     12  LA-CONTROL-PRIMARY.
   403         16  LA-COMPANY-CD           PIC  X(01).
   404         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
   405
   406     12  LA-CONTROL-BY-CERT-RESP.
   407         16  LA-COMPANY-CD-A2        PIC  X(01).
   408         16  LA-CERT-NO-A2.
   409             20  LA-CERT-PRIME-A2    PIC  X(10).
   410             20  LA-CERT-SUFFIX-A2   PIC  X(01).
   411         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
   412             20  LA-RESP-PERSON-A2   PIC  X(10).
   413             20  LA-TYPE-A2          PIC  X(01).
   414         16  LA-CARRIER-A2           PIC  X(01).
   415         16  LA-GROUPING-A2          PIC  X(06).
   416         16  LA-STATE-A2             PIC  X(02).
   417         16  LA-ACCOUNT-A2           PIC  X(10).
   418         16  LA-EFFECT-DATE-A2       PIC  X(02).
   419         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* NSAASBL.cbl
   420
   421     12  LA-CONTROL-BY-FORM.
   422         16  LA-COMPANY-CD-A3        PIC  X(01).
   423         16  LA-FORM-A3              PIC  X(04).
   424         16  LA-CARRIER-A3           PIC  X(01).
   425         16  LA-GROUPING-A3          PIC  X(06).
   426         16  LA-STATE-A3             PIC  X(02).
   427         16  LA-ACCOUNT-A3           PIC  X(10).
   428         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
   429
   430     12  LA-CONTROL-BY-PROCESSOR.
   431         16  LA-COMPANY-CD-A4        PIC  X(01).
   432         16  LA-PROCESSOR-CD         PIC  X(04).
   433         16  LA-CARRIER-A4           PIC  X(01).
   434         16  LA-GROUPING-A4          PIC  X(06).
   435         16  LA-STATE-A4             PIC  X(02).
   436         16  LA-ACCOUNT-A4           PIC  X(10).
   437         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
   438
   439     12  LA-CONTROL-BY-KEY-FIELDS.
   440         16  LA-COMPANY-CD-A5        PIC  X(01).
   441         16  LA-CARRIER-A5           PIC  X(01).
   442         16  LA-GROUPING-A5          PIC  X(06).
   443         16  LA-STATE-A5             PIC  X(02).
   444         16  LA-ACCOUNT-A5           PIC  X(10).
   445         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
   446
   447     12  LA-CONTROL-BY-GROUP-CODE.
   448         16  LA-COMPANY-CD-A6        PIC  X(01).
   449         16  LA-ENTRY-A6.
   450             20  LA-FILLER           PIC  X(02).
   451             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
   452         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
   453
   454     12  FILLER                      PIC  X(09).
   455
   456     12  LA-HEADER-RECORD.
   457         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
   458         16  LA-CREATION-DATE        PIC  X(02).
   459         16  LA-FOLLOW-UP-DATE       PIC  X(02).
   460         16  LA-FINAL-ACT-DATE       REDEFINES
   461               LA-FOLLOW-UP-DATE     PIC  X(02).
   462         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
   463         16  LA-NO-OF-COPIES         PIC S9(01).
   464         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
   465         16  LA-REPLY-DATE           PIC  X(02).
   466         16  LA-RESEND-DATES.
   467             20  LA-RESEND-DATE      PIC  X(02).
   468             20  LA-SENT-DATE        PIC  X(02).
   469             20  FILLER              PIC  X(08).
   470         16  LA-SOURCE-INFORMATION.
   471             20  LA-DATA-SOURCE      PIC  X(01).
   472             20  LA-ADDR-SOURCE      PIC  X(01).
   473         16  LA-STATUS               PIC  X(01).
   474             88  LA-STATUS-ACTIVE         VALUE 'A'.
   475             88  LA-STATUS-COMPLETED      VALUE 'C'.
   476             88  LA-STATUS-ON-HOLD        VALUE 'H'.
   477             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* NSAASBL.cbl
   478             88  LA-STATUS-PURGED         VALUE 'P'.
   479             88  LA-STATUS-VOIDED         VALUE 'V'.
   480         16  LA-LAST-RESENT-PRINT-DATE
   481                                     PIC  X(02).
   482         16  LA-PRINT-RESTRICTION    PIC  X(01).
   483             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
   484                                          VALUE 'C'.
   485             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
   486                                          VALUE 'F'.
   487             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
   488                                          VALUE 'P'.
   489         16  LA-PURGED-DATE          PIC  X(02).
   490         16  LA-VOIDED-DATE          PIC  X(02).
   491         16  LA-RESEND-LETR          PIC  X(4).
   492         16  FILLER                  PIC  X(08).
   493*        16  LA-RESEND-LETR-2        PIC  X(4).
   494*        16  LA-RESEND-LETR-3        PIC  X(4).
   495*        16  FILLER                  PIC  X(59).
   496         16  LA-ARCHIVE-STATUS       PIC  X.
   497             88  LA-TEMP                VALUE 'T'.
   498             88  LA-QWS                 VALUE 'Q'.
   499             88  LA-BATCH               VALUE 'B'.
   500         16  LA-FINAL-ACT-IND        PIC  X(1).
   501         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   502         16  FILLER                  PIC  X(46).
   503*        16  FILLER                  PIC  X(71).
   504         16  LA-LAST-MAINT-DATE      PIC  X(2).
   505         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   506         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   507                                     PIC  X(4).
   508         16  LA-LAST-UPDATED-BY      PIC  X(4).
   509
   510******************************************************************
   511*                                COPY ERCENDT.
   512******************************************************************
   513*                                                                *
   514*                                                                *
   515*                            ERCENDT.                            *
   516*                            VMOD=2.001                          *
   517*                                                                *
   518*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
   519*                                                                *
   520*   FILE TYPE = VSAM,KSDS                                        *
   521*   RECORD SIZE = 579  RECFORM = FIXED                           *
   522*                                                                *
   523*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
   524*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
   525*                                                                *
   526*   LOG = NO                                                     *
   527*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   528******************************************************************
   529*-----------------------------------------------------------------
   530*                   C H A N G E   L O G
   531*
   532* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   533*-----------------------------------------------------------------
   534*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   535* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* NSAASBL.cbl
   536*-----------------------------------------------------------------
   537* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
   538*                                WITH OPEN CLAIMS
   539* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
   540*-----------------------------------------------------------------
   541 01  ENDORSEMENT-RECORD.
   542     12  EN-RECORD-ID                PIC XX.
   543         88  VALID-EN-ID                VALUE 'EN'.
   544     12  EN-CONTROL-PRIMARY.
   545         16  EN-COMPANY-CD           PIC X.
   546         16  EN-CARRIER              PIC X.
   547         16  EN-GROUPING             PIC X(6).
   548         16  EN-STATE                PIC XX.
   549         16  EN-ACCOUNT              PIC X(10).
   550         16  EN-CERT-EFF-DT          PIC XX.
   551         16  EN-CERT-NO.
   552             20  EN-CERT-PRIME       PIC X(10).
   553             20  EN-CERT-SFX         PIC X.
   554         16  EN-REC-TYPE             PIC X.
   555             88  EN-ISSUE               VALUE 'I'.
   556             88  EN-CANCELLATION        VALUE 'C'.
   557         16  EN-SEQ-NO               PIC 9(04) BINARY.
   558     12  EN-CONTROL-BY-ARCH-NO.
   559         16  EN-COMPANY-CD-A1              PIC X.
   560         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
   561     12  EN-LAST-MAINT-DT            PIC XX.
   562     12  EN-LAST-MAINT-BY            PIC X(4).
   563     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
   564     12  EN-ENDORSEMENT-RECORD       PIC X(329).
   565     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   566         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
   567         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
   568         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
   569         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
   570         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
   571         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
   572         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
   573         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
   574         16  EN-LF-ORIG-BENCD        PIC XX.
   575         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
   576         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   577         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   578         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   579         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   580         16  EN-LF-ORIG-EXP-DT       PIC XX.
   581*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
   582         16  EN-ORIG-CRED-BENE       PIC X(25).
   583         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   584         16  FILLER                  PIC X.
   585         16  EN-AH-ORIG-BENCD        PIC XX.
   586         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
   587         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   588         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   589         16  EN-AH-ORIG-EXP-DT       PIC XX.
   590*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
   591*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
   592         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   593         16  F                       PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* NSAASBL.cbl
   594         16  EN-AH-ORIG-CP           PIC 99.
   595         16  EN-INS-NEW-LAST-NAME    PIC X(15).
   596         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
   597         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
   598         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
   599         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
   600         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
   601         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
   602         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
   603         16  EN-LF-NEW-BENCD         PIC XX.
   604         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
   605         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   606         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   607         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
   608         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
   609         16  EN-LF-NEW-EXP-DT        PIC XX.
   610         16  EN-NEW-CRED-BENE        PIC X(25).
   611         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   612         16  FILLER                  PIC X.
   613         16  EN-AH-NEW-BENCD         PIC XX.
   614         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
   615         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   616         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   617         16  EN-AH-NEW-EXP-DT        PIC XX.
   618*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
   619*        16  EN-AH-NEW-WAIT-PER      PIC 99.
   620*        16  F                       PIC X(12).
   621         16  EN-AH-NEW-CP            PIC 99.
   622         16  EN-SIG-SW               PIC X.
   623         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   624         16  FILLER                  PIC X(37).
   625     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   626         16  EN-LF-ORIG-REF-DT       PIC XX.
   627         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   628         16  EN-AH-ORIG-REF-DT       PIC XX.
   629         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   630         16  EN-LF-NEW-REF-DT        PIC XX.
   631         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   632         16  EN-AH-NEW-REF-DT        PIC XX.
   633         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   634         16  EN-FLAG-CERT            PIC X.
   635         16  EN-INS-LAST-NAME        PIC X(15).
   636         16  EN-INS-FIRST-NAME       PIC X(10).
   637         16  EN-INS-MIDDLE-INIT      PIC X.
   638         16  FILLER                  PIC X(274).
   639     12  EN-MONEY-SW             PIC X.
   640     12  EN-HEALTH-APP           PIC X.
   641     12  EN-VOUCHER-SW           PIC X.
   642     12  EN-PAYEE                PIC X(14).
   643     12  EN-INPUT-DT             PIC XX.
   644     12  EN-PROCESS-DT           PIC XX.
   645     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
   646     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
   647     12  EN-REASON-CODES.
   648         16  F OCCURS 12.
   649             20  EN-REASON-CODE  PIC X(4).
   650     12  EN-TEMPLATE-USED        PIC X(8).
   651     12  EN-DOCU-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* NSAASBL.cbl
   652         88  EN-VERI-DOCU          VALUE 'V'.
   653         88  EN-GCE-DOCU           VALUE 'G'.
   654         88  EN-CANC-DOCU          VALUE 'C'.
   655     12  EN-COMMENTS1            PIC X(13).
   656     12  EN-COMMENTS2            PIC X(70).
   657     12  EN-COMM-CHGBK           PIC X.
   658         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
   659         88  EN-CHG-ACCT           VALUE 'Y'.
   660     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
   661     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
   662     12  EN-BATCH-NUMBER         PIC X(6).
   663     12  EN-ACCT-SUMM            PIC X.
   664     12  EN-CSO-SUMM             PIC X.
   665     12  FILLER                  PIC X(13).
   666******************************************************************
   667*                                COPY NSCASEXTR.
   668******************************************************************
   669*                                                                *
   670*                                                                *
   671*                            NSCASEXTR.                          *
   672*                            VMOD=2.001                          *
   673*                                                                *
   674*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   675*                                                                *
   676*   FILE TYPE = VSAM,KSDS                                        *
   677*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   678*                                                                *
   679*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   680*                                                                *
   681*   LOG = NO                                                     *
   682*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   683******************************************************************
   684*-----------------------------------------------------------------
   685*                   C H A N G E   L O G
   686*
   687* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   688*-----------------------------------------------------------------
   689*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   690* EFFECTIVE    NUMBER
   691*-----------------------------------------------------------------
   692* 072211    2011022800001  PEMA  NEW FILE
   693*-----------------------------------------------------------------
   694 01 NSAS-EXTRACT-RECORD.
   695    05  NSAS-CONTROL-PRIMARY.
   696        10  NSAS-COMPANY-CD      PIC X.
   697        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   698        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   699    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   700    05  FILLER                   PIC X(143).
   701****************************************************************
   702*
   703* Copyright (c) 2007 by Clerity Solutions, Inc.
   704* All rights reserved.
   705*
   706****************************************************************
   707 01  DFHEIV.
   708   02  DFHEIV0               PIC X(35).
   709   02  DFHEIV1               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* NSAASBL.cbl
   710   02  DFHEIV2               PIC X(08).
   711   02  DFHEIV3               PIC X(08).
   712   02  DFHEIV4               PIC X(06).
   713   02  DFHEIV5               PIC X(04).
   714   02  DFHEIV6               PIC X(04).
   715   02  DFHEIV7               PIC X(02).
   716   02  DFHEIV8               PIC X(02).
   717   02  DFHEIV9               PIC X(01).
   718   02  DFHEIV10              PIC S9(7) COMP-3.
   719   02  DFHEIV11              PIC S9(4) COMP SYNC.
   720   02  DFHEIV12              PIC S9(4) COMP SYNC.
   721   02  DFHEIV13              PIC S9(4) COMP SYNC.
   722   02  DFHEIV14              PIC S9(4) COMP SYNC.
   723   02  DFHEIV15              PIC S9(4) COMP SYNC.
   724   02  DFHEIV16              PIC S9(9) COMP SYNC.
   725   02  DFHEIV17              PIC X(04).
   726   02  DFHEIV18              PIC X(04).
   727   02  DFHEIV19              PIC X(04).
   728   02  DFHEIV20              USAGE IS POINTER.
   729   02  DFHEIV21              USAGE IS POINTER.
   730   02  DFHEIV22              USAGE IS POINTER.
   731   02  DFHEIV23              USAGE IS POINTER.
   732   02  DFHEIV24              USAGE IS POINTER.
   733   02  DFHEIV25              PIC S9(9) COMP SYNC.
   734   02  DFHEIV26              PIC S9(9) COMP SYNC.
   735   02  DFHEIV27              PIC S9(9) COMP SYNC.
   736   02  DFHEIV28              PIC S9(9) COMP SYNC.
   737   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   738   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   739   02  FILLER                PIC X(02).
   740   02  DFHEIV99              PIC X(08) VALUE SPACE.
   741   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   742   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   743   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   744   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   745 LINKAGE  SECTION.
   746*****************************************************************
   747*                                                               *
   748* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   749* All rights reserved.                                          *
   750*                                                               *
   751*****************************************************************
   752 01  dfheiblk.
   753     02  eibtime          pic s9(7) comp-3.
   754     02  eibdate          pic s9(7) comp-3.
   755     02  eibtrnid         pic x(4).
   756     02  eibtaskn         pic s9(7) comp-3.
   757     02  eibtrmid         pic x(4).
   758     02  dfheigdi         pic s9(4) comp.
   759     02  eibcposn         pic s9(4) comp.
   760     02  eibcalen         pic s9(4) comp.
   761     02  eibaid           pic x(1).
   762     02  eibfiller1       pic x(1).
   763     02  eibfn            pic x(2).
   764     02  eibfiller2       pic x(2).
   765     02  eibrcode         pic x(6).
   766     02  eibfiller3       pic x(2).
   767     02  eibds            pic x(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* NSAASBL.cbl
   768     02  eibreqid         pic x(8).
   769     02  eibrsrce         pic x(8).
   770     02  eibsync          pic x(1).
   771     02  eibfree          pic x(1).
   772     02  eibrecv          pic x(1).
   773     02  eibsend          pic x(1).
   774     02  eibatt           pic x(1).
   775     02  eibeoc           pic x(1).
   776     02  eibfmh           pic x(1).
   777     02  eibcompl         pic x(1).
   778     02  eibsig           pic x(1).
   779     02  eibconf          pic x(1).
   780     02  eiberr           pic x(1).
   781     02  eibrldbk         pic x(1).
   782     02  eiberrcd         pic x(4).
   783     02  eibsynrb         pic x(1).
   784     02  eibnodat         pic x(1).
   785     02  eibfiller5       pic x(2).
   786     02  eibresp          pic 9(09) comp.
   787     02  eibresp2         pic 9(09) comp.
   788     02  dfheigdj         pic s9(4) comp.
   789     02  dfheigdk         pic s9(4) comp.
   790 01 dfhcommarea                  pic x(200).
   791 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   792 0000-DFHEXIT SECTION.
   793     MOVE '9#                    $   ' TO DFHEIV0.
   794     MOVE 'NSAASBL' TO DFHEIV1.
   795     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   796     display ' entering nsaasbl '
   797     MOVE EIBDATE                TO DC-JULIAN-YYDDD
   798     MOVE '5'                    TO DC-OPTION-CODE
   799     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
   800     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
   801     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
   802     MOVE DFHCOMMAREA            TO BL-INPUT
   803*****************************************************
   804* Using the information passed to this program,
   805* it will update the erarch record with a "Q"
   806* in the status field
   807*****************************************************
   808*    DISPLAY ' BL INPUT ' BL-INPUT
   809     IF BL-COMP-ID = 'DCC'
   810        MOVE X'05'               TO WS-ERARCH-COMPANY-CD
   811     ELSE
   812        IF BL-COMP-ID = 'AHL'
   813           MOVE X'06'               TO WS-ERARCH-COMPANY-CD
   814        ELSE
   815           MOVE X'04'               TO WS-ERARCH-COMPANY-CD
   816        END-IF
   817     END-IF
   818     MOVE WS-ERARCH-COMPANY-CD   TO WS-ERENDT-COMPANY-CD
   819                                    WS-EXTR-COMPANY-CD
   820     MOVE BL-ARCHIVE-NO          TO WS-ERARCH-ARCH-NO
   821                                    WS-ERENDT-ARCH-NO
   822                                    WS-EXTR-ARCH-NO
   823     SET BL-FAIL TO TRUE
   824
   825* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* NSAASBL.cbl
   826*         DATASET    ('ERARCH')
   827*         INTO       (LETTER-ARCHIVE)
   828*         RIDFLD     (WS-ERARCH-KEY)
   829*         UPDATE
   830*         RESP       (WS-RESPONSE)
   831*    END-EXEC
   832     MOVE LENGTH OF
   833      LETTER-ARCHIVE
   834       TO DFHEIV11
   835     MOVE 'ERARCH' TO DFHEIV1
   836*    MOVE '&"IL       EU         (  N#00000820' TO DFHEIV0
   837     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   838     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
   839     MOVE X'204E233030303030383230' TO DFHEIV0(25:11)
   840     CALL 'kxdfhei1' USING DFHEIV0,
   841           DFHEIV1,
   842           LETTER-ARCHIVE,
   843           DFHEIV11,
   844           WS-ERARCH-KEY,
   845           DFHEIV99,
   846           DFHEIV99,
   847           DFHEIV99
   848     MOVE EIBRESP  TO WS-RESPONSE
   849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   850     IF RESP-NORMAL
   851        SET BL-OK TO TRUE
   852        IF (BL-PRINT-NOW-SW = 'P')
   853           or (bl-process-type = 'cancel')
   854           PERFORM 0050-DELETE-RECORDS
   855                                 THRU 0050-EXIT
   856        ELSE
   857           IF BL-PROCESS-TYPE = 'process'
   858              MOVE 'Q'           TO LA-ARCHIVE-STATUS
   859              IF BL-PRINT-NOW-SW = 'Y'
   860                 MOVE SAVE-BIN-DATE TO LA-INITIAL-PRINT-DATE
   861                 IF (LA-RESEND-DATE EQUAL LOW-VALUES OR SPACES)
   862                  AND (LA-FOLLOW-UP-DATE EQUAL
   863                                 LOW-VALUES OR SPACES)
   864                    MOVE 'C'             TO LA-STATUS
   865                 END-IF
   866              END-IF
   867           ELSE
   868              MOVE 'T'           TO LA-ARCHIVE-STATUS
   869           END-IF
   870        END-IF
   871
   872* EXEC CICS REWRITE
   873*          FROM      (LETTER-ARCHIVE)
   874*          DATASET   ('ERARCH')
   875*          RESP       (WS-RESPONSE)
   876*       END-EXEC
   877     MOVE LENGTH OF
   878      LETTER-ARCHIVE
   879       TO DFHEIV11
   880     MOVE 'ERARCH' TO DFHEIV1
   881*    MOVE '&& L                  %  N#00000848' TO DFHEIV0
   882     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
   883     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* NSAASBL.cbl
   884     MOVE X'204E233030303030383438' TO DFHEIV0(25:11)
   885     CALL 'kxdfhei1' USING DFHEIV0,
   886           DFHEIV1,
   887           LETTER-ARCHIVE,
   888           DFHEIV11,
   889           DFHEIV99
   890     MOVE EIBRESP  TO WS-RESPONSE
   891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   892     ELSE
   893        MOVE ' BAD READ UPDATE ON ERARCH '
   894                                 TO BL-MESSAGE
   895        display ' bad read on erarch ' ws-response
   896          ' ' bl-archive-no
   897     END-IF
   898     MOVE BL-INPUT               TO DFHCOMMAREA
   899
   900* exec cics return end-exec.
   901*    MOVE '.(                    &   #00000860' TO DFHEIV0
   902     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   904     MOVE X'2020233030303030383630' TO DFHEIV0(25:11)
   905     CALL 'kxdfhei1' USING DFHEIV0,
   906           DFHEIV99,
   907           DFHEIV99,
   908           DFHEIV99,
   909           DFHEIV99,
   910           DFHEIV99
   911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   912
   913 0050-DELETE-RECORDS.
   914     DISPLAY ' ABOUT TO DELETE RECS ' BL-ARCHIVE-NO ' ' BL-FUNC
   915     IF BL-FUNC = 'ClmResc' or 'ClmRefo'
   916        display ' bypass delete ' bl-func
   917        go to 0050-exit
   918     end-if
   919
   920* EXEC CICS DELETE
   921*       DATASET    ('ERARCH')
   922*       RESP       (WS-RESPONSE)
   923*    END-EXEC
   924     MOVE 'ERARCH' TO DFHEIV1
   925*    MOVE '&(                    &  N#00000867' TO DFHEIV0
   926     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
   927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   928     MOVE X'204E233030303030383637' TO DFHEIV0(25:11)
   929     CALL 'kxdfhei1' USING DFHEIV0,
   930           DFHEIV1,
   931           DFHEIV99,
   932           DFHEIV99,
   933           DFHEIV99,
   934           DFHEIV99
   935     MOVE EIBRESP  TO WS-RESPONSE
   936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   937     IF NOT RESP-NORMAL
   938        DISPLAY ' BAD DELETE ERARCH ' WS-RESPONSE
   939        GO TO 0050-EXIT
   940     END-IF
   941
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* NSAASBL.cbl
   942* EXEC CICS READ
   943*         DATASET    ('ERENDT2')
   944*         INTO       (ENDORSEMENT-RECORD)
   945*         RIDFLD     (WS-ERENDT2-KEY)
   946*         UPDATE
   947*         RESP       (WS-RESPONSE)
   948*    END-EXEC
   949     MOVE LENGTH OF
   950      ENDORSEMENT-RECORD
   951       TO DFHEIV11
   952     MOVE 'ERENDT2' TO DFHEIV1
   953*    MOVE '&"IL       EU         (  N#00000875' TO DFHEIV0
   954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
   956     MOVE X'204E233030303030383735' TO DFHEIV0(25:11)
   957     CALL 'kxdfhei1' USING DFHEIV0,
   958           DFHEIV1,
   959           ENDORSEMENT-RECORD,
   960           DFHEIV11,
   961           WS-ERENDT2-KEY,
   962           DFHEIV99,
   963           DFHEIV99,
   964           DFHEIV99
   965     MOVE EIBRESP  TO WS-RESPONSE
   966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   967     IF NOT RESP-NORMAL
   968        DISPLAY ' BAD READ ON ERENDT2 ' WS-RESPONSE
   969     ELSE
   970
   971* EXEC CICS DELETE
   972*          DATASET    ('ERENDT2')
   973*          RESP       (WS-RESPONSE)
   974*       END-EXEC
   975     MOVE 'ERENDT2' TO DFHEIV1
   976*    MOVE '&(                    &  N#00000885' TO DFHEIV0
   977     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
   978     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   979     MOVE X'204E233030303030383835' TO DFHEIV0(25:11)
   980     CALL 'kxdfhei1' USING DFHEIV0,
   981           DFHEIV1,
   982           DFHEIV99,
   983           DFHEIV99,
   984           DFHEIV99,
   985           DFHEIV99
   986     MOVE EIBRESP  TO WS-RESPONSE
   987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   988        IF NOT RESP-NORMAL
   989           DISPLAY ' BAD DELETE ON ERENDT2 ' WS-RESPONSE
   990        END-IF
   991     END-IF
   992     MOVE 0                      TO WS-EXTR-SEQ-NO
   993
   994* EXEC CICS READ
   995*         DATASET    ('NSASEXTR')
   996*         INTO       (NSAS-EXTRACT-RECORD)
   997*         RIDFLD     (WS-NSASEXTR-KEY)
   998*         UPDATE
   999*         RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* NSAASBL.cbl
  1000*    END-EXEC
  1001     MOVE LENGTH OF
  1002      NSAS-EXTRACT-RECORD
  1003       TO DFHEIV11
  1004     MOVE 'NSASEXTR' TO DFHEIV1
  1005*    MOVE '&"IL       EU         (  N#00000894' TO DFHEIV0
  1006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1007     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1008     MOVE X'204E233030303030383934' TO DFHEIV0(25:11)
  1009     CALL 'kxdfhei1' USING DFHEIV0,
  1010           DFHEIV1,
  1011           NSAS-EXTRACT-RECORD,
  1012           DFHEIV11,
  1013           WS-NSASEXTR-KEY,
  1014           DFHEIV99,
  1015           DFHEIV99,
  1016           DFHEIV99
  1017     MOVE EIBRESP  TO WS-RESPONSE
  1018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1019     IF NOT RESP-NORMAL
  1020        DISPLAY ' BAD READ ON 0 NSASEXTR ' WS-RESPONSE
  1021        GO TO 0050-EXIT
  1022     ELSE
  1023
  1024* EXEC CICS DELETE
  1025*          DATASET    ('NSASEXTR')
  1026*          RESP       (WS-RESPONSE)
  1027*       END-EXEC
  1028     MOVE 'NSASEXTR' TO DFHEIV1
  1029*    MOVE '&(                    &  N#00000905' TO DFHEIV0
  1030     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1031     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1032     MOVE X'204E233030303030393035' TO DFHEIV0(25:11)
  1033     CALL 'kxdfhei1' USING DFHEIV0,
  1034           DFHEIV1,
  1035           DFHEIV99,
  1036           DFHEIV99,
  1037           DFHEIV99,
  1038           DFHEIV99
  1039     MOVE EIBRESP  TO WS-RESPONSE
  1040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1041        IF NOT RESP-NORMAL
  1042           DISPLAY ' BAD DELETE ON 0 NSASEXTR ' WS-RESPONSE
  1043           GO TO 0050-EXIT
  1044        END-IF
  1045     END-IF
  1046     MOVE 1                      TO WS-EXTR-SEQ-NO
  1047
  1048* EXEC CICS READ
  1049*         DATASET    ('NSASEXTR')
  1050*         INTO       (NSAS-EXTRACT-RECORD)
  1051*         RIDFLD     (WS-NSASEXTR-KEY)
  1052*         UPDATE
  1053*         RESP       (WS-RESPONSE)
  1054*    END-EXEC
  1055     MOVE LENGTH OF
  1056      NSAS-EXTRACT-RECORD
  1057       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* NSAASBL.cbl
  1058     MOVE 'NSASEXTR' TO DFHEIV1
  1059*    MOVE '&"IL       EU         (  N#00000915' TO DFHEIV0
  1060     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1061     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1062     MOVE X'204E233030303030393135' TO DFHEIV0(25:11)
  1063     CALL 'kxdfhei1' USING DFHEIV0,
  1064           DFHEIV1,
  1065           NSAS-EXTRACT-RECORD,
  1066           DFHEIV11,
  1067           WS-NSASEXTR-KEY,
  1068           DFHEIV99,
  1069           DFHEIV99,
  1070           DFHEIV99
  1071     MOVE EIBRESP  TO WS-RESPONSE
  1072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1073     IF NOT RESP-NORMAL
  1074        DISPLAY ' BAD READ ON 1 NSASEXTR ' WS-RESPONSE
  1075     ELSE
  1076
  1077* EXEC CICS DELETE
  1078*          DATASET    ('NSASEXTR')
  1079*          RESP       (WS-RESPONSE)
  1080*       END-EXEC
  1081     MOVE 'NSASEXTR' TO DFHEIV1
  1082*    MOVE '&(                    &  N#00000925' TO DFHEIV0
  1083     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1085     MOVE X'204E233030303030393235' TO DFHEIV0(25:11)
  1086     CALL 'kxdfhei1' USING DFHEIV0,
  1087           DFHEIV1,
  1088           DFHEIV99,
  1089           DFHEIV99,
  1090           DFHEIV99,
  1091           DFHEIV99
  1092     MOVE EIBRESP  TO WS-RESPONSE
  1093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1094        IF NOT RESP-NORMAL
  1095           DISPLAY ' BAD DELETE ON 1 NSASEXTR ' WS-RESPONSE
  1096        END-IF
  1097     END-IF
  1098     MOVE 2                      TO WS-EXTR-SEQ-NO
  1099
  1100* EXEC CICS READ
  1101*         DATASET    ('NSASEXTR')
  1102*         INTO       (NSAS-EXTRACT-RECORD)
  1103*         RIDFLD     (WS-NSASEXTR-KEY)
  1104*         UPDATE
  1105*         RESP       (WS-RESPONSE)
  1106*    END-EXEC
  1107     MOVE LENGTH OF
  1108      NSAS-EXTRACT-RECORD
  1109       TO DFHEIV11
  1110     MOVE 'NSASEXTR' TO DFHEIV1
  1111*    MOVE '&"IL       EU         (  N#00000934' TO DFHEIV0
  1112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1113     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1114     MOVE X'204E233030303030393334' TO DFHEIV0(25:11)
  1115     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* NSAASBL.cbl
  1116           DFHEIV1,
  1117           NSAS-EXTRACT-RECORD,
  1118           DFHEIV11,
  1119           WS-NSASEXTR-KEY,
  1120           DFHEIV99,
  1121           DFHEIV99,
  1122           DFHEIV99
  1123     MOVE EIBRESP  TO WS-RESPONSE
  1124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1125     IF NOT RESP-NORMAL
  1126        DISPLAY ' BAD READ ON 2 NSASEXTR ' WS-RESPONSE
  1127     ELSE
  1128
  1129* EXEC CICS DELETE
  1130*          DATASET    ('NSASEXTR')
  1131*          RESP       (WS-RESPONSE)
  1132*       END-EXEC
  1133     MOVE 'NSASEXTR' TO DFHEIV1
  1134*    MOVE '&(                    &  N#00000944' TO DFHEIV0
  1135     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1137     MOVE X'204E233030303030393434' TO DFHEIV0(25:11)
  1138     CALL 'kxdfhei1' USING DFHEIV0,
  1139           DFHEIV1,
  1140           DFHEIV99,
  1141           DFHEIV99,
  1142           DFHEIV99,
  1143           DFHEIV99
  1144     MOVE EIBRESP  TO WS-RESPONSE
  1145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1146        IF NOT RESP-NORMAL
  1147           DISPLAY ' BAD DELETE ON 2 NSASEXTR ' WS-RESPONSE
  1148        END-IF
  1149     END-IF
  1150     .
  1151 0050-EXIT.
  1152     EXIT.
  1153 9700-DATE-LINK.
  1154
  1155* EXEC CICS LINK
  1156*        PROGRAM   ('ELDATCV')
  1157*        COMMAREA  (DATE-CONVERSION-DATA)
  1158*        LENGTH    (DC-COMM-LENGTH)
  1159*    END-EXEC.
  1160     MOVE 'ELDATCV' TO DFHEIV1
  1161*    MOVE '."C                   ''   #00000956' TO DFHEIV0
  1162     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1163     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1164     MOVE X'2020233030303030393536' TO DFHEIV0(25:11)
  1165     CALL 'kxdfhei1' USING DFHEIV0,
  1166           DFHEIV1,
  1167           DATE-CONVERSION-DATA,
  1168           DC-COMM-LENGTH,
  1169           DFHEIV99,
  1170           DFHEIV99,
  1171           DFHEIV99
  1172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1173
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* NSAASBL.cbl
  1174 9700-EXIT.
  1175      EXIT.
  1176
  1177 9999-DFHBACK SECTION.
  1178     MOVE '9%                    "   ' TO DFHEIV0
  1179     MOVE 'NSAASBL' TO DFHEIV1
  1180     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1181     GOBACK.
  1182 9999-DFHEXIT.
  1183     IF DFHEIGDJ EQUAL 0001
  1184         NEXT SENTENCE.
  1185     MOVE '9%                    "   ' TO DFHEIV0
  1186     MOVE 'NSAASBL' TO DFHEIV1
  1187     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1188     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11792     Code:        3225
